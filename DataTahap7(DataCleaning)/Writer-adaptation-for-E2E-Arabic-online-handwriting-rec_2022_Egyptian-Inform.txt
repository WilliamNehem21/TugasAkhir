one solution to reduce the mismatch between training data and unseen samples of a specific writer is to modify the model into a wd model. writer adaptation is a process of converting the wi model to the wd model, given adaptation data from a specific writer. the main challenge to writer adaptation is having limited data. a wi model with a large number of parameters can easily get overfitted if adapted with limited adaptation data. adaptation in deep learning is closely related to such techniques as domain adaptation, transfer learning and fine-tuning.



in this paper, we propose a novel writer model-based adaptation method that utilizes a ctc-based model to achieve optimal arabic online handwriting recognition. our method employs adversarial multi-task learning(mtl). adversarial mtl techniques alleviate deep features mismatch between distributions of features generated by the wi model and the wd model. in adversarial learning, two tasks are involved: a primary task of label classification and a secondary task deep features discrimination. we evaluated the proposed method using two datasets; the chaw and online-kahtt datasets. the proposed method has both consistently and significantly shown superior performance in comparison to the wi and fine-tuned wi models with the same data of target writers.



the paper is organized as follows: section 2 explores previous work done in writer adaptation for online handwriting recognition. in section 3, we explain the architecture of our proposed method. section 4 details the results and provides a comparison of the proposed architecture against the original wi with both supervised and unsupervised adaptation settings. lastly, section 5 details our conclusions and recommendations for possible future work.



several approaches to model adaptation have been proposed. in, matic et al. designed a writer dependent system based on a pre-trained time-delay neural network(tdnn) character-based recognition system. adaptation is conducted by altering the last layer of tdnn, which acts as an optimal hyperplane classifier. this last layer is retrained to a new writing style. in, authors placed an output adaptation module(oam) on top of wi neural networks. oam is a radial basis function(rbf) network that maps the output of the wi module into a writer-adapted output.



that adaptation could be performed deeply on multiple layers of the model, including the cnn and fully connected layers, rather than exclusively on the top layers. the authors referred to their method as deep transfer mapping(dtm), entirely run in an unsupervised manner. adaptation is achieved through the capturing of additional information from different abstraction levels. during the adaption procedure, adaptation layers serve as the linear transformation.



deep learning methods were also utilized in features transformation adaptation. in, researchers used deep learning features to perform writer adaptation for online chinese handwriting recognition. in this method, dnns and cnns are utilized to extract these features(called tandems). extracted features are then fed into the prototype-based classifier. a linear transformation of the deeply learned features is used to perform adaptation.



designers of the aforementioned writer adaptation methods for online handwriting recognition systems primarily utilized traditional techniques such as hmms, svm, tdnn and prototype classifiers. despite that a small number of these methods did incorporate deep learning in their features representation, none of their creators tackled the use of e2e model-based writer adaptation. languages addressed were primarily either latin or chinese languages.



is created and initialized by cloning wi, then divided into features extraction and label classification sub-networks. in the secondary task, a discriminative sub-network is attached on top of the features extraction sub-network in parallel with a label classification sub-network of the primary task. the two tasks are jointly optimized in a minimax manner with multi-task learning, where features extraction layers are shared among the tasks. the goal of a minimax game is to minimize label classification loss while jointly maximizing features discrimination loss. by the end of this game, the regularized wd model should reach a higher recognition rate against the test data of the target writer than that of the wi model. the wi is kept fixed during adaptation and discarded with the discriminative sub-network during the test.



assuming that x is a sample instance that represents input data, then d(x) is the discriminator. d(x) is a binary classifier that produces a probability with x as a real instance from the training data. d(x) should output a high probability with respect to real instances and a low probability with respect to synthesized instances. similarly, assuming that z is a latent vector sampled from gaussian distribution, then g(z) is the generator that transforms z to the data space.



for the purposes of evaluating our method, we used standard metrics character error rate(cer) and word error rate(wer). we used the same handwriting samples from the online-khatt and chaw datasets(see section 4.1) that were used to train the baseline model. samples used in the adaptation process were not used in the training of the wi model.



for evaluation, selected handwritings of 84 writers from the test sets of both datasets; 42 writers from each dataset. for each writer, we split his/her samples into training and test sets. from the chaw dataset, we selected 40 samples(words) for training and 80 samples for testing(to be used in all experiments). the online-khatt dataset is comprised of sentence-based samples. from that dataset, we choose four samples per writer for adaptation training and an average of 10 samples for testing.



to the improvement of results compared with the use of the basic characters only. in arabic script, character shape not only differs according to position in a word, but is also influenced by both the preceding and succeeding letters. character with position carries contextual information which helps in the decoding phase. adaptation training data would not however cover all 160 target units for each individual writer. the proposed adaptation method works on features representation and performs the distribution shift based on the features detected. thus, our model is able to satisfactorily generalize, despite possibly not covering all target units of a specific writer.



in all our experiments, we used greedy decoding for the model outputs. it selects the most probable character over characters distribution for each time step as described in section 3.1. using decoding techniques like beam search decoder with lm or dictionary integration could improve the recognition rate. in our case of data availability. then, we can apply adversarial multi-task learning adaptation to these models in the same manner as was done in this work. in addition, data augmentation is used to increase the training data. thus, synthetic data generation for writers with style transfer would increase the adaptation samples for writers, resulting in increased overall performance.



our work is the first work that tackles writer adaptation for online handwriting recognition for e2e models. it will contribute to opening more doors for arabic language applications which could be used in different domains. also, the proposed method can be applied to other languages as well such as latin languages. adversarial multi-task learning adaptation is not limited to ctcbased models and it can be applied to other e2e models in the same manner such as attention and self-attention models. in the future, we will explore the possibility of applying adversarial multi-task learning on attention-based models. in addition, we will explore the effects of synthesized adaptation training data on the performance of adaptation.



