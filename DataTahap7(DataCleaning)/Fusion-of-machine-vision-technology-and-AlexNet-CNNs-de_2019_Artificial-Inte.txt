according to food and agriculture organization statistics from 2013, the production of apples ranks second in the world(czernyszewicz, 2016). although pesticides can increase the yield of apples, they also increase the risk to the safety of food(jiyun et al., 2014). pesticide residues in apples are one of the most important factors affecting their safety(liang and xie, 2017; jia et al., 2017). a great deal of attention has been paid to the problem of pesticide residues in apples, and effective pesticide residue detection methods are important in restricting fast, efficient and non-destructive method for detecting apple pesticide residues under hyperspectral conditions. by taking the advantage of the numerous sample bands in hyperspectral technology, a method is proposed for the detection of hyperspectral pesticide residues in apples based on machine vision technology and cnns. based on a collection of high-spectrum apple pesticide residues, a hyperspectral image of an apple was analyzed to extract a mask image corresponding to the type of pesticide residue. the structure and parameters for a cnn network



the data samples for the four pesticide residues were labeled as a(chlorpyrifos), ab(two mixed pesticides), b(carbendazim), and k(inactive control). each pesticide residue contained three different samples of data, each of which contained 256 bands of spectral data, giving 768 spectral data images in total for each pesticide residue. in order to increase the diversity of the samples, gaussian white noise with signalto-noise ratios of 1, 2, 3, 4 and 5 db was added to the hyperspectral image of the apple for each pesticide residue. this increased the number of samples from 12 in four categories to 72 in four categories, giving 4608 spectral data images in each category. using a bootstrap sampling method, the sample set was randomly divided into a training set and test set. the training set sample contained 66.7% of the data, with 48 training samples, that is, 12 samples for each type of pesticide residue sample. the test set sample was 33.3% of the data, with 24 samples, giving a total of 48 training samples, that is, six samples for each kind of pesticide residue sample. there was no overlap between the training and the testing sample sets.



parameters and stronger expressive power, and can automatically extract effective feature structures from complex spectral data(lawrence et al., 1997). alexnet is a cnn network with a relatively shallow network structure, and is capable of extracting rich features from images(yuan and zhang, 2016).



since no problems such as deformation of the position of the apple in the hyperspectral image are encountered, a framework of five convolutional layers and three fully connected layers was used in this work. in addition, a three-layer max-pooling layer was also adopted to improve the network's utilization rate of the feature information for the hyperspectral data images for the different types of apple pesticide residues. when pooling, the output matrix of the previous layer is maximized based on the superparameters of the pooled layer, and the pooled layer has no weight or offset value. i information matching was realized using the softmax function. in this study, there are four different apple pesticide residues, and softmax therefore contains four perceptrons.



methods, we carry out a comparison of this approach with two common image classification methods, svm(hearst et al., 2002) and knn(cost and salzberg, 1993). in this paper, the brightness feature was extracted from the hyperspectral data and used as the basis of image classification, before svm and knn classification were used to classify the apple pesticide residues in the data.



in order to further improve the accuracy of detection for hyperspectral images of apples with similar appearance in the same band, the number of specific features in the convolution kernel can be increased, i.e. the individual feature information of the apples in the hyperspectral images is increased to ensure that there are larger differences between similar apples in the same band.



in the knn and svm classification algorithms, classification is based on information in the brightness feature of hyperspectral images. due to the use of hyperspectral data images, the brightness information of images in the same band is very similar. the euclidean distance(mesquita et al., 2017), which is used to calculate the brightness feature information of each image, is also very close, so the correct rate for hyperspectral apple pesticide residue detection is as low as 43.75%, and the time consumption is 0.7645 s. using its non-linear mapping characteristics, svm divides the brightness feature space for the hyperspectral images into optimal hyperplanes and maximizes the classification boundary, and the classification detection accuracy of svm is therefore higher than that of knn. in summary, a cnn using the alexnet framework has robust anti-interference ability, and the detection process has a low time cost; at the same time, it also has high robustness to the image brightness characteristics.



compared with the svm and knn methods, the cnn has the advantages of low time cost and high robustness. however, when two hyperspectral images are in the same band and have a similar appearance, the network is prone to detection errors. in future research, the number of specific feature parameters of the convolution kernel could be increased as the basis of network classification, in order to improve the feature extraction ability of the network for similar hyperspectral images of apples in the same band, and to further improve the accuracy of pesticide residue detection.



bo jiang declares that he has no conflict of interest. jinrong he declares that he has no conflict of interest. hongfei fu declares that he has no conflict of interest. tong li declares that he has no conflict of interest. huaibo song declares that he has no conflict of interest. dongjian he declares that he has no conflict of interest. yun zhao declares that she has no conflict of interest.



