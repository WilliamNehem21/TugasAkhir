a malware distribution network (mdn) is a set of connected fully qualified domain names (fqdn) used to globally disperse malicious files for the purpose of infecting and compromising systems. in this paper, we perform a temporal topological analysis of an mdn with malware attribution focusing on subsets of connected fqdns which we refer to as a malicious cluster (m-cluster). we used fqdns consisting of second and top-level domains such as example.com. we created a novel data set over two continuous quadrimesters from 19 january to 25 september of 2017. we queried the transparency report repository of google safe bridge and hub, which facilitate the obfuscation of servers hosting malware while simultaneously facilitating the flow of malicious traffic. our temporal analysis revealed the persistent existence of large clusters involved in malware distribution. these large clusters preserved their topological structures for extended time periods with only some sub-structural changes which contrast with other work suggesting smaller time period persistence [8]. this implies a potential continuous effort by malicious actors to preserve such structures that could facilitate long-term data flow monitoring upon initial malicious fqdn identifi- cation. this critical observation is due to our novel temporal analysis approach, and is likely not appreciable with static analysis methods that



the result of this data fusion was the creation of new observable knowledge. these observations led to unique and novel temporal in- sights on the structure, tendencies, and data flows of an mdn. in our review of current work, we did not find a previous example of our novel data fusion, and we further discovered our temporal insights presented here would not have been observed without our data fusion imple- mentation, as the insights could not be appreciated from the static data provided by gsb and vt in isolation. observed bridge and hub structural and temporal insights provided the foundation for suggested prevention approaches to sustained malware distribution in an mdn.



a large corpus of publications related to web-based malware delivery which explore their mechanics, structure, and usage context exists in the current literature, we reference here the most relevant to this research. our temporal graph analysis approach is inspired by the work presented in [10,11]. in these approaches, analyzing a graph includes topological properties such as topological metrics of the degree distribution, con- nected components, clustering coefficient, rich-club connectivity, all-pairs-shortest paths, betweenness centrality, node stability, dynamic anomalies, and future behavior prediction.



most using captured traffic flows as the source data for their research. the source data was analyzed in a multitude of ways, focusing on detecting malicious data flows. others used virtual environments with specially-instrumented browsers collecting relevant metadata of visited webpages known to download malware onto victim machines. some used synthetic data, which is researcher-created data representing real malicious traffic as seen in real time. other relevant papers exploring diverse perspectives including risk, detection, and malicious campaigns



the majority of these works demonstrated success in analyzing previously-occurred malware related events, and provided rules of risk to prevent future outbreaks. these works also provided insights on the relationships between domains, ip addresses, and other network com- ponents used in malware distribution. our research presented in this document enhances the current literature by using a unique data fusion implementation of public data sources, leading to the creation of new observable temporal-based knowledge, which facilitates insights into temporal evolutions of fqdn topological structures actively hosting and transmitting malware. most of the related work presented here used either static data sets, synthetic data sets, or data captured in real time during a malicious cyber event from the past. our data set, collected in real time, represented malicious events happening at that moment. our daily collecting routine allowed for temporal analysis which enhances the related work. an important enhancement to the related work was our ability to attribute time intervals of active distribution and hosting of multiple malware files in multiple fqdns, along with subnet struc- tural changes. this provided insight into the operational characteristics and infrastructure of the mdns.



the mdn was built from a novel data set which we created by implementing a fusion of static data collected from gsb and vt. the data set spans a period of eight months from 19 january to 25 september of 2017. the end date resulted from the removal of fqdn details rele- vant to this research in gsb api services. the gsb service is used to warn users not to visit potentially unsafe urls. a blacklist is provided of urls determined by gsb to have content related to phishing or malware. our collected data is the particular class of urls deemed malicious by gsb. the gsb transparency report is an online resource providing statistics in [ ], of fqdns that was the recipient of malicious traffic sent from this fqdn. an outbound edge was created between this fqdn and each entry in as. the same process was applied to is. the fqdns listed in the set for rt were the senders of malicious traffic to this fqdn. an inbound edge was created from each fqdn listed in rt to this fqdn.



the evolution of c2 was seemingly ordinary with a consistent rise in node size upon its first appearance in the mdn. this was followed by a period of node size stability from 3 to 10 march. the node size for c2 started to gradually decrease beginning on 10 march lasting until the end of life on 16 march.



the evolution of c3 occurred similarly to c2 with the exception of two instances of node size persistence during the period of gradual decrease to the end of life. all three clusters achieved sizes of over 100 nodes with c1 increasing past 200 and these large sizes were sustained for a minimum of 2 days for c2 to a maximum of 11 days for c1. note that c1 appeared at a node size of 120 on our first day of collection. since our data set starts on 19 january, we cannot definitively determine the creation date of c1 and node size evolution from that creation date to 19 january.



same labels, we assumed vt internally resolves or maps fqdns to ip addresses and produces the relevant report. an mdn provides the network infrastructure facilitating malicious traffic movement across the internet. it is reasonable to assume that malicious files being trans- mitted across an mdn would reside on a portion of the servers associ- ated with a malicious fqdn. this reasoning is supported by gsb reports



the key insight from this research is the observation of the long-term existence and preservation of fqdn-based topological structures involved in the transmission of multiple malicious data flows. this suggested a focused effort to sustain such infrastructures, and lends to the long-term monitoring of data flows traversing through these struc- tures. this evidentiary insight is in contrast to previous studies sug- gesting that malware distribution structures exist only for short time periods. the insights of our work may suggest a shift in approach to malware distribution, favoring long-term sustainment of large topolog- ical structures by constantly-changing malware hosting and immediate node degree fqdns while preserving fqdns in more distanced degrees from a detected leaf node. the majority of fqdns appear only once as the source of a unique malicious file download. only a handful of fqdns appeared in vt reports as the source of two or more unique malicious file downloads. once vt reported an fqdn as hosting a file that was downloaded and detected malicious on a specific date, the fqdn no longer appeared in a vt report as hosting any malicious file. the implication is that an fqdn, according to vt, is used by malicious actors very few times, or potentially only once, to host downloadable malicious files on its servers. this lends itself to the idea of mdn operators constantly changing fqdns in the degrees around leaf nodes, while preserving those in the sub-structures connected to root nodes, most notably bridge and hub implementations.



an mdn is composed of several isolated clusters of interconnected fqdns. as opposed to our initial assumption of one large network, our mdn graph revealed that multiple isolated clusters are preva- lent. cluster survivability beyond termination attempts by security defenders is increased if multiple clusters are in use.



a bridge and hub construct are key distribution points of malicious traffic. our visualizations clearly showed the critical usage of bridges and hubs to route traffic from root nodes to leaf nodes within a cluster. termination or use of a dns sinkhole [59] on fqdns serving as bridges and hubs can shut down large portions of an mdn.



malware distributed across a cluster seems to be composed of a large number of unique individual samples from a smaller number of malware families. the majority of the malware were html pages with javascript. the script is accessed when visiting a webpage, and can potentially perform automated tasks such as downloading or installing other malware on host machines. other discovered mal- ware were html pages attempting social engineering and fqdns with a link to a publicly accessible directory within a storage system which contained malware.



node. given the observed one-to-many relationship discussed above, the interruption of data flows from these nodes could reduce the flow of malicious traffic to a larger, and potentially undiscovered, number of bridge nodes beyond the detected node. these nodes serving the malicious traffic are considered the entry points to the mdn by malicious actors. their disablement results in actors consuming more resources to reestablish the blocked nodes.



connector between sources of malicious traffic and hubs. blocking this node, for example by blacklisting, stops all traffic to the con- nected downstream hubs. the nodes acting as sources of malicious traffic to the blocked bridge node could continue streaming to other not-yet-discovered bridge nodes. the impact of blocking the bridge node is the removal of traffic to the subnet of hubs, both discovered and not, that are downstream.



servers allows long-term persistent observation and attribution of mdn structural evolutions over time. it was not clear in this work if any of these nodes had the ability to detect if their data flows were blocked and not being received by downstream nodes. if that were the case, redirection is a very good option. the data flows continue as expected by malicious actors, and simultaneously allow defenders to analyze and observe over long periods of time.



the analysis and results are limited to data made publicly-accessible by gsb and vt. this data may be just a slice of much larger internally held data sets. we believe this limitation does not negatively impact our findings discussed in this research due to strong evidence in our data supporting mdn existence and occurrence. however, the internal data analysis and public dissemination practices of gsb and vt may affect our temporal analysis. our collected data is based primarily on dates of malicious event occurrences publicly released by the aforementioned sustainment of malicious data flow transmission in an mdn. the orig- inal google safe browsing data collection has been made publicly- available to encourage continued research. our future work with mal- ware distribution networks will include: further enrichment of the cur- rent data set by leveraging more public data, continuing analysis to determine usage of our data as an indicator of malicious cyber events, continued research to enumerate novel discernible insights achievable with our collected data, and the creation of new temporal mdn data sets with publicly available data.



