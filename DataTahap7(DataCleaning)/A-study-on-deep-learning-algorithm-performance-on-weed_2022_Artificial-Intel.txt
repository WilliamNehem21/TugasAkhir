of machine learning, which is inspired by the artificial neural network algorithm. it is one of the breakthroughs in the area of computer vision for image classification, object detection, and localization, which has been effectively used in weed detection for robotic weed control research(hasan et al., 2021).



study is important because, during the deep learning computer vision model training, crop and weeds pixels along with soil background pixels are used by convolutional neural network architecture to generalize the weed detection model(kulawardhana, 2011). the changes in image pixels between the model training images and testing images might lead to the model performance degradation(velumani et al., 2021).



a recent study cross evaluated the deep learning model in different background condition in disease detection area of agriculture(ferentinos, 2018). in a previous study by ferentinos(2018), model built from labrotory condition images was tested on images obtained in field, which caused decline in model performance due to having completely different background image pixel than that of labrotory images.there is higher probability of having different background in disease detection studies images than weed detection images, because weed detection images capture whole plant images whereas, disease detection images capture s specific region of plant affected by disease. similar studies are important to fill the existing gap on research about effects of background in weed identification which could assist toward the development of robust real time deep learning weed detection model in agriculture industries.



after images were acquired, the next step was extracting the individual weed and crop species from the single image. a python(python software foundation, wilmington, de) script was developed to label a single image of a day using an opencv library(bradski, 2000), which saves the bounding box coordinate in order to perform automatic cropping of the remaining images for the same day. before applying the python script, images were manually checked if there were any disturbances, such as human intervention, external objects in the image, and changed illumination. the images that included disturbances-uniform background scenario(s1) and uniform background scenario(s2). vgg16 architecture already trained on imagenet 1000 classes was used to finetune the model with weed and crop image datasets(abdalla et al., 2019; espejo-garcia et al., 2020). vgg16 model was trained up to 50 epochs with 32 steps in each epoch. this technique is called transfer learning, where convolution and pooling layers were frozen and fully connected layers were modified for new sets of problems. instead of training and optimizing frozen layers, weights and biases,



similar to vgg16, cnn based residual networks 50(resnet50) deep learning architecture was also used to train the non-uniform background scenario(s1) data, uniform background scenario(s2) data, and combined-datasets scenario(c) obtained after merging both scenarios' data. for this training, a resnet50 model already trained on the deepweeds image dataset by olsen et al.(2019) was used. a transfer learning technique was used for resnet50, where only 20,488 parameters were trained, and the remaining 23,583,616 parameters were frozen. resnet50 was trained for 70 epochs, with 32 steps in each epoch. an outermost layer with 9 output classes and sigmoid activation function was removed and a new outer layer was added for 8 output classes a with softmax activation function. softmax assigns the decimal



in this study, to see the effects of background scenarios on model performance, models were tested with images with different background than the images used for building the model. test datasets from both s1 and s2 were tested on three models trained and validated with s1 model, s2 model, and c model datasets. this helped to cross-check the model performance when the test dataset's background scenario was completely different from the scenario on which the model was developed.



data instances over the total number of data instances. accuracy may not be a good measure when datasets are imbalanced because it might not show a clear picture of model performance. however, the f1-score, which is also the geometric mean of the precision and recall depict clear pictures of model performance in terms of each class. precision is the percentage of correctly predicted images out of the total number of predicted images, whereas recall is the percentage of correctly predicted images out of the total number of images in the actual class. ideally, for good classifiers, both precision and recall values should be 1, but they counter each other, and increasing one usually reduces the other(arya et al., 2020). the macro and weighted average were calculated for the precision, recall, and f1-score. a confusion matrix was also used to visualize the summary of the prediction results of the model. for calculating all the metrics and visualizing the confusion matrix, python sklearn api was used(pedregosa et al., 2011).



the decline in model performance for s1 and s2 was obtained by calculating the percentage of error(pe). it was calculated by finding the difference between the f1-score or accuracy value of the model when it was tested on the same background scenario test datasets and the different background scenario test data sets. furthermore, the percentage of improvement(pi) was calculated for both background scenario models when the models were built with combined datasets. the significance of the percentage of error pe and pi was also tested with a onetailed paired t-test.



perform well for s1tedata with macro and weighted average f1-score value of 78% and 75%, respectively. for s2models1tedata testing, redroot pigweed, sugar beet, and palmer amaranth had the lowest f1 score value of 57%, 57%, and 66% respectively. f1-score value was lower in redroot pigweed and sugar beet due to low recall values of 45% and 40%, respectively; however, palmer amaranth had lower f1score value due to low precision value of 54%.



23.37% and 28.40%, respectively. this means s1model was more generalized than that of s2model in both vgg16 and resnet50 because of its higher performance on unseen test data with a different background. moreover, the paired-t-test results shows that the differences in f1scores between models vgg16-s1(t(7)= 2.95, p= 0.01), vgg16-s2(t(7)= 3.99, p= 0.0026), resnet50-s1(t(7)= 3.689, p= 0.0039),



in this research article, an applications of deep learning architecture to study the performance of the model with different image background conditions under greenhouse condition was performed on weed and crop classification task. same crop and weed plants were planted in pots and two different image backgrounds scenarios as non-uniform background scenario(s1) and uniform background scenario(s2) was created. the deep learning(dl) models that were developed from the two scenarios was compared in terms of developing a more robust model and to understand how the models perform on different image analysis conditions than the condition the model was created. the dl robustness was checked for completely unseen images with different image background than that of images used for model training. the results confirmed that model performance declined in both types of background scenarios when model was cross-tested on images with different background scenario than that of images used during model training. in weed classification study, espejo-garcia et al.(2020) performed plant segmentation to check if deep learning model after background removal performs better and found that result did not improve. the study performed in this article is different from the study performed by espejo-garcia et al.(2020), where different background condition was created by the application of the black pebble on the top of the promix mixture. in this study, two different background images was created by application of black gravels in same crop and weed plants which is different from espejo-garcia et al.(2020) study. beside the background in image, black gravel also affects the lighting around the plant due to more absorption of light by black surfaces than other color surfaces(stuart-fox et al., 2017). the study's results performed for plant disease detection by ferentinos(2018) was in correspondence to our study results in weed classification. in their research, model performance decline from 99% to 68% when model trained with field condition image was tested with laboratoryconditions images. the performance decline even more to 33% when types of images for model training and testing was reversed.



the vgg16s1 model(model trained on non-uniform(s1) data) in terms of f1-score declined by 16.83% when tested with s2tedata(uniform(s2) test data), whereas the vgg16 s2model(model trained on uniform(s2) data) performance declined by 21%, when the model was tested with s1tedata(non-uniform(s1) test data). similar pattern of declination was observed in resnet50, where resnet50-s1 model performance in terms of f1-score declined by 23.37% and resnet50-s2 model performance declined by 28.40%. this decline in performance was due to testing the models on image sets with different backgrounds than that of images used in model training. this result also shows the cause of difficulty of the implementation of deep learning models in real time weed detection applications due to different soil background conditions such as color and texture. the model's performance was improved by 18% to 35% in both cnn architectures when both types of images were used to build a model. this suggests to used wider variety of training weed and training data collected from different geographical area, cultivation condition, imaging sensors, and image capturing mode as suggested by ferentinos(2018) in plant disease detection study.



weed identification performance by 16% to 28% in the vgg16 and resnet50 model, when models were tested on images with different background than that of model training. however, a model trained with combined datasets of two background scenarios, was able to achieve the f1-score value of 92% to 99% with eight classes of weed and crop images. the performance parameters for each weed and crop species in terms of accuracy, f1-score, and confusion matrix were greater than expected. the findings of this study suggest that dl models developed from uniform image background could not improve the performance of deep learning models to identify weeds in unseen environmental conditions. from this study we suggest that similar kind of background soil environment as that of field should be created inside the greenhouse to be able to apply the deep learning-based weed detection model in field. in addition, it seems including greater variances in image background for the models seems working better when tested in individual conditions(when there is single variable such as non-uniform, or uniform, or clay, or sandy soil, or volcanic ash) than just developing the model in same condition and testing in same condition. future work will focus on fusion of greenhouse and field images to create a field environment background condition to build robust weed detection deep learning model with localization.



this material is based upon work partially supported by the usdaagricultural research service, agreement number 58-6064-8-023. any opinions, findings, conclusions or recommendations expressed in this publication are those of the author(s) and do not necessarily reflect the view of the u.s. department of agriculture. this work is/was supported by the usda-national institute of food and agriculture, hatch project number nd01487. in addition, we want to thank ndsu plant science department's research specialists and agricultural and biosystems engineering department graduate students(arjun upadhyay and billy ram) for helping with some of the greenhouse sample processes in this study.



