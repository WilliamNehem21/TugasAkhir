in the last years, artificial intelligence methods have been increas- ingly used to complement numerical models in the prediction of complex phenomena (schmidhuber, 2015). such methods are typically based on a machine learning algorithm, which is ad-justed/trained using known observational data of a given phenomenon in order to detect it from new data. one of the most commonly employed algorithms are neural net- works. as an example in meteorology (aoki, 2017), used a convolutional



this work proposes the very nowcasting of heavy rainfall events by mean of a deep learning approach, a machine learning algorithm using weather radar data. according to the world meteorological organiza- tion1, nowcasting refers to up to 6 h forecast. these rainfall events have a high spatio-temporal variability, being difficult to predict by standard numerical models. weather radars allow the real-time monitoring of convective rainfall, thus providing time series of images that can be employed by the machine learning algorithm, in this case, a convolu- tional recurrent neural network.



rainfall nowcasting, using weather radar data as input data for a con- volutional recurrent neural network. the recurrent part of it is a long short-term memory (lstm) neural network. the area of study is the city of campinas, in the southeastern brazil, and its surrounding areas. weather radar data was processed to yield a time series of 2d images of precipitation rate. m5images is a predictive algorithm intended to pre- dict rainfall rate values above a defined threshold for the pixels of the considered grid. the use of a rainfall rate threshold was suggested by (mason and graham, 1999), and adopted here with a value of 5 mm/h, similarly as in (caseri et al., 2020). the proposed approach differs from previous ones by using only data of heavy and very heavy rainfall events in the training phase of the neural network, besides proposing a new correction factor to improve the predictions.



in addition, a correction scheme for the rainfall forecasts is also proposed in order to deal with the rainfall forecast underestimation observed in the tests, providing more reliable forecasts. the scheme employs a multiplicative correction factor derived from the fist observed image, as follows. considering predictions for 10, 20 and 30 min, the mean absolute percentage error (mape) is calculated for all pixels be- tween observation and the first prediction (10 min). the mape is then used to derive the correction factor to be applied for the further 20 and 30 min predictions, being applied to all the pixels. this study was per- formed using the r language with the following packages: keras, ten- sorflow, raster, metrics, mlmetrics.



these twelve events were divided into training and test sets, with 9 and 3 events, respectively. considering the training events, 95% of the images were taken for training and the remaining 5% for validation. the validation phase is intended to optimize the neural network hyper- parameters, in this case, the loss function (given by the mse), batch size and number of epochs. the training/validation set includes a total of 133 h or 798 images sampled with 10 min resolution, resulting by the sliding for prediction times of 10, 20 and 30 min, compared to the observed data, for a particular instant of time (2016/11/28 20:10 h), considering the area of study. it shows that the prediction performance worsen with the increase of prediction time. although the 10-min prediction is very similar to the observed rainfall, the predictions for 20-min and 30-min were not able to identify the rainfall zone and rainfall intensity for the corresponding pixels. the high variability of these rainfall events and their low spatio-temporal correlation render the prediction difficult for higher prediction times (caseri et al., 2020).



resulting forecast given by averaging pixel-to-pixel these images. as an example, a set of different predictors can be obtained using a drop-out technique that randomly erases one of the fully-connected output layers that render the network output. another ensembles can result from using different network architecture or different weight initialization scheme for each predictor. in addition, the prediction performance of the m5images method performance will be evaluated for prediction times longer than 30 min, since for nowcasting, the higher the prediction time, the better the usefulness for early warning systems.



