proverif is an efficient automated tool used during the verification testing stage of the security protocols[5,6]. it is based on pi calculus and it has the ability to verify the authenticity and the secrecy properties of the cryptographic security protocols. it can handle an unbounded number of sessions for the protocol under test. besides, using proverif, the intruder has the power to vigorously monitor the communication channel between the communicating parties where he can capture, modify, inject, and resend messages to maliciously attack the system. furthermore, proverif provides a tracing for the adversary attack to the system to clarify whether the protocol has security problems or not.



the rest of the paper is organized in the following sections: section 2 summarizes the previous work done to enhance the security aspects of the mqtt protocol. after that, section 3 presents the proposed pmqtt protocol and its suggested cryptographic primitives to offer security services in iot platforms. then, section 4 discusses the details of the formal verification for pmqtt to prove that it securely offers the intended security services. finally, section 5 summarizes the conclusions of the conducted work in conjunction with the future research directions to clarify the added values of using pmqtt in real mqtt based iot platforms.



conducting careful investigations for the proposed authentication protocol, one can deduce that the modified_mqtt_connect_packet has only the username and it has no password field. although the password is used at the client side in the generation of the digital signature when hashing the mqtt_connect_packet using sha-1 in step 5. moreover, the client password is used at the broker side when hashing the mqtt_connect_packet at step 8 where the client password is retrieved from the broker internal database and the username is extracted from the received modified_mqtt_connect_packet. accordingly, the username may be transferred from the client to the broker in plain text without the need for the burden of the secure socket layer(ssl) in the transport layer.



the second stage of the proposed secured protocol for the pmqtt based iot platforms is the key establishment and distribution stage. through this phase, the pc and the dr are going to share in the establishment of a symmetric secret session key based on the elliptic curve diffie hellman(ecdh) key agreement protocol. this shared secret key will be used in encrypting and decrypting the specific data related to the patient to whom this pc is attached.



the third stage of the proposed protocol for the pmqtt based iot platforms is the end-to-end encrypted data exchange stage. during this phase, the dr and the pc are interchanging ciphered details related to the status of the patient through the broker. the dr and the pc are using symmetric cipher advanced encryption standard(aes) encryption scheme based on the established shared secret key of the key establishment and distribution stage of the suggested secure protocol.



it comes up with an authentication approach without introducing extra server for the mqtt based iot network. so, there is no server dedicated for the authentication process. instead, the already found broker of the mqtt system can handle the proposed authentication scheme.



it comes up with an authentication scheme in which a signature is attached to the username to construct a new modified mqtt connect packet. the payload of this modified connect packet has no user password and this password is used in the production of the digital signature. accordingly, the username of the payload can securely transferred from the client to the broker in plain text without the need for the burden of the ssl in the transport layer.



