shape analysis of cell nuclei is becoming increasingly important in biology and medicine. recent results have identified that large variability in shape and size of nuclei has an important impact on many biological processes. current analysis techniques involve automatic methods for detection and segmentation of histology and microscopy images, but are mostly performed in 2d. methods for 3d shape analysis, made possible by emerging acquisition methods capable to provide nanometric-scale 3d reconstructions, are still at an early stage, and often assume a simple spherical shape. we introduce here a framework for analyzing 3d nanoscale reconstructions of nuclei of brain cells(mostly neurons), obtained by semiautomatic segmentation of electron micrographs. our method considers two parametric representations: the first one customizes the implicit hyperquadrics formulation and it is particularly suited for convex shapes, while the latter considers a spherical harmonics decomposition of the explicit radial representation. point clouds of nuclear envelopes, extracted from image data, are fitted to the parameterized models which are then used for performing statistical analysis and shape comparisons. we report on the analysis of a collection of 121 nuclei of brain cells obtained from the somatosensory cortex of a juvenile rat.



in biology, the nucleus is a membrane-enclosed organelle found in eukaryotic cells, including the ones composing the brain. it is considered the control center of the cell, since, in particular, it organizes activities by regulating gene expression. the nuclear envelope, consisting of an inner and outer membrane separated by peri-nuclear space and perforated by nuclear pores, encloses the nucleus and separates it from the cytoplasm. all active and passive



recently, the analysis of proteins associated with the nuclear envelope in rat hippocampal neurons provided evidence that the shape of nuclei is an important factor influencing the nucleocytoplasmic exchange of macromolecules and ions, in particular calcium, which is a key regulator of neuronal gene expression. moreover, the size and shape of nuclear envelopes can vary not only among species, but also within species and even within a single individual, depending on cell types and other, even transient, conditions. geometrically, the cell nucleus has been often studied as a spherical structure, but this approximation is increasingly proving way too coarse for a number of applications. the analysis of shape properties is thus gaining importance in biology and medicine, since shape variability can provide indicators of different conditions and can provide hints for classifying cells.



a series of methods have been developed for automated 2d detection and segmentation on microscopy images, with the aim of providing support for various quantitative analyses, including calculating cellular morphology, including size, shape, or texture. however, most of nuclear analysis is performed directly on 2d images and only few efforts have used 3d reconstruction, in particular for studying the dynamics of nuclear infoldings in response to neuronal activity. it is only very recently, with the emergence of digital acquisition methods capable to provide 3d reconstructions at nanometric resolution scale, that collections of 3d shape measurements of nuclei are starting to become available. there is a clear need to develop shape analysis frameworks to support domain scientists in performing 3d quantitative measures, classification and clustering operations, e.g., for associating different shapes to different nuclear conditions.



this article is an invited extended version of our stag 2018 contribution, which was limited to the presentation of the hyperquadric approach. we here provide a more thorough exposition, but also significant new material, including the description of the acquisition method, the presentation of a refined pipeline supporting multiple fitting models, a generalized spherical harmonics solution, and additional qualitative and quantitative results. also, we extended the classification options by comparing and evaluating the accuracy of different machine learning dimension reduction techniques.



here, we demonstrate the method on a collection of 121 brain cell nuclear envelopes. the input data came from semiautomatic segmentation of electron micrographs of a sample of somatosensory cortex of a juvenile rat coming from layers vi and ii/iii. we provide preliminary results of fitting performance of the proposed parametric models, as well as a discussion of a preliminary shape analysis performed by domain scientists with our framework.



accurate detection of individual cell nuclei in microscopy images is an essential and fundamental task for many biological studies. a comprehensive review of cell detection and segmentation algorithms can be found in. the accuracy of segmentation and reconstruction determines the quality of morphology features extracted and is in some cases crucial for identifying and grading diseases. broadly, three popular strategies are used for nucleus/cell segmentation:



very recently, ram and rodriguez presented a cell nucleus detection system using the fast radial symmetry transform(frst), to be used in fluorescence in-situ hybridization(fish) images obtained via confocal microscopy. to the best of our knowledge, all published models are based on 2d segmentation of cell nuclei. our method fits parametric representations to 3d reconstructions of cell nuclear envelopes. it extends a generic implicit surface model in a way that proves to be a simple but effective 3d parametric representation, expressive enough to perform statistical analysis and shape comparisons of rodent brain cell nuclear shapes.



prior knowledge. because implicit surfaces can be designed so that the algebraic distance to them can be quickly computed by evaluating a simple differentiable function, they are better suited to fitting 2d and 3d data that the most common explicit models. implicit geometry has been used extensively for various applications, ranging from constructive solid geometry, to geometric modeling, to real time ray tracing[22,23], to molecular dynamics[24,25]. one of the most common implicit representations is the superquadric, introduced by barr and then widely applied to many problems, such as object representation, shape recovery, image segmentation, and object modeling. superquadrics are, however, constrained to represent symmetrical-section volumes. this limitation was removed by hanson with the introduction of the hyperquadric primitives, which include quadrics and superquadrics as special cases. hyperquadrics are not symmetric and support taperings and distortions that are not normally present within the conventional superquadric framework. the application of hyperquadrics can be mainly found in shape recovery, but also in fitting models to sparse data. their 2d versions were used for 2d segmentation of nuclei shapes in nuclei observed with an epi-fluorescence



the availability of 3d reconstructions of brain structures is driving the development of various frameworks for shape analysis in order to classify and account for variability to be associated to different structures and conditions. for a recent overview of the main methods employed in the analysis of brain structures, we refer reader to. in general, shape analysis methods are mainly targeted to the full cortex acquired with mri methods. recently, a study for 3d morphological analysis of asymmetric neuronal morphogenesis in developing zebrafish has been proposed, but wider application of shape analysis studies of brain structures at nanometric resolution are still lacking.



a number of automated serial electron microscopy techniques have recently been developed, driven by the need of imaging large portions of the brain from different species. state-of-the-art em setups can nowadays automatically cut serial sections and image them to produce aligned stacks with minimal human supervision. the use of electron micrographs also makes it possible to visualize even the finest lamelliform processes.



many neuroscientists take advantage of commercial or free software solutions[44,45] to perform the reconstruction. in our case, we currently rely on available semi-automatic solutions, such as ilastik that aims for a segmentation accuracy comparable to what is obtainable with manual tools. the specific pipeline employed to generate the data used in this work was designed by combining the complementary strengths of ilastik and trakem2, since ilastik is good for quickly finding the gross features and processes of a cell, while the manual approach of trakem2 is good for specifying exact boundaries and finer details. a practical solution was also designed for dealing with large datasets on a single machine by subdividing them in piecewise chunks to fit with the ilastik semi-automated segmentation module called carving, which was accordingly refactored. the semiautomatic segmentation method was used to label em images, while surface reconstruction was performed on labelled masks by using marching tetrahedra. finally, for each reconstructed nuclear envelope surface, the vertices were collected as input point clouds for the shape analysis framework.



domain scientists traditionally classify cells and their nuclear envelopes through visual assessment of morphological features visible in electron micrographs. even when cell morphology is not visible, the plain nuclei have characteristic features that indicate the probable cell type. the nuclei of neurons tend to be almost spherical and are typically largest among all brains cells.



we also performed a preliminary evaluation of the proposed parameterizations as predictive models by using standard machine learning(support vector machines) and dimension reduction methods(principal component analysis, multidimensional scaling and t-distributed stochastic neighbor embedding). the preliminary analysis showed that both parameterizations can be considered reliable for discriminating neural nuclei shapes, and that, with the same fitting accuracy, a more accurate classification is obtained by considering spherical harmonics energy descriptors. in the future, we plan to explore different surface parameterizations to provide a better description of more complicated shapes. furthermore, we plan to extend the analysis to other 3d nuclear envelope collections from different conditions, and will try classifying neurons into subtypes. furthermore, since nuclear classification is still done by domain scientists through visual assessment of the morphology features around cells, we plan to incorporate this domain knowledge[65,66] for creating more sophisticated and accurate classifiers.



this work was supported by the crg grant no. 2313 from king abdullah university of science and technology kaust-epfl alliance for integrative modeling of brain energy metabolism. we also acknowledge the contribution of sardinian regional authorities under project vigeclab. we finally thank helmut pottmann(king abdullah university of science and technology) for useful comments and suggestions.



agus m, cal c, morales at, lehvslaiho ho, magistretti pj, gobbetti e, et al. hyperquadrics for shape analysis of 3d nanoscale reconstructions of brain cell nuclear envelopes. in: livesu m, pintore g, signoroni a, editors. proceedings of the smart tools and apps for graphicseurographics italian chapter conference. the eurographics association; 2018.



