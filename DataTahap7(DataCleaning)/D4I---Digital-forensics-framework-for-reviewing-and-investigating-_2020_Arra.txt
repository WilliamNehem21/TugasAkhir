the paper is organized as follows: section 2 presents related work and introduces the theoretical background of this research. section 3 de- scribes the proposed framework, while section 4 illustrates an application example of the d4i framework on a typical case of a spear phishing attack. section 5 interprets, describes the work and compares it to existing ones and finally, section 6 summarizes and discusses future work.



the cyber forensic field triage process model (cfftpm) proposes an approach for identifying, analyzing and interpreting digital evidence in a short time frame [36]. the model focuses on decreasing the time needed to investigate a crime on scene which is considered to be a critical factor. the model proposes a series of phases that should be conducted to gather information from a windows system. the phases include: planning, triage, usage/user profiles, chronology/timeline, internet activity, and case specific evidence. the phases relevant to our work are the usa- ge/user profiles, chronology/timeline, internet activity. the name of each phase is derived from the information that can be gained by examining and analysis specific artifacts of a windows system belonging to this phase. although it seems to be an artifact categorization it is not clearly defined and it is a work relevant to work of sans (subsection 2.2). also, cfftpm does not specify how the artifacts and the categorization of them can be leveraged into investigation. finally, the phases seem to provide details on what is needed to be examined but not on how a case can be investigated by utilizing them.



the ckc model serves two purposes [6]. it can be used for actionable intelligence so that defensive capabilities can be aligned to the steps an adversary follows and for analyzing intrusions. the analysis of intrusion, however, assumes that the detection of a cyber-attack was based on an ioc. once an ioc is found, then the analysis should start from the phase that this ioc belongs to (since stix iocs can contain the ckc) and going back to prior phases as it is assumed that they have been executed already. hence, it is evident that ckc and iocs can be used together in investigation provided that there is prior-knowledge about a cyber-attack, i.e. at least one ioc needs to be found. moreover, iocs are not a framework to be used in conducting an investigation so they can no guide it but only support it.



in this section, the d4i framework is applied on a case of a spear phishing attack in which an email containing a document attachment infected by a malicious code was sent to the victim. according to fireeye [45], spear phishing is a targeted form of a phishing email attack. at- tackers focus their effort on carefully selected victims, disguising them- selves to appear as a trustworthy party that they can persuade their victims about the legitimacy of an email [45]. doing so they can trick their victim into visiting a link or downloading/opening an attachment of the email so that they can gain access to the computer system or steal sensitive information [45].



starting the investigation from the installation ckc phase (d4i - choose), artifacts belonging to this phase are identified based on the proposed categorization and mapping (d4i - identify). among them, it is determined that there is a run registry key created that starts a code located into an ads. the key and the ads stream were created at x1 timestamp (d4i - correlate). at this point, the chain of correlated artifacts contains a registry key and an ads belonging to the instal- lation ckc phase (d4i - construct coa).



afterwards, the artifacts belonging to exploitation ckc phase (d4i - choose) are identified (d4i - identify). having the x1 timestamp, it is found that almost the same time an xls file was run by examining the folder where microsoft office creates temporary files (d4i - corre- late). at this point, the chain of correlated artifacts contains a registry key, an ads and an xls file (d4i - construct coa).



artifacts belonging to the command and control phase (d4i - choose) are identified (d4i - identify). a covert communication channel with the ip1 address using dns protocol to transfer image screenshots is revealed based on the ads code existing in the coa. pcap files extracted from ram revealed image files sent from the compromised system to the ip1 address (d4i - correlate). at this point, the chain of correlated artifacts contains a registry key, an ads, an xls file, an email, and an ip address (pcap) (d4i - construct coa).



this section showed that the attack was investigated in a step-by-step way applying the d4i framework. it was found that a phishing email attack took place with the purpose of exfiltrating data by taking screen- shots of the compromised system. the described procedure can be accomplished automatically by implementing an algorithm finding cor- relations and visualizing the results to help forensics examiners.



