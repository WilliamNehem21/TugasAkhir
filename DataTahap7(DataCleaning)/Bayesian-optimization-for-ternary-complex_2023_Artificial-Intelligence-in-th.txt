for one structure (7khh), no pdb entry fulfilling the first criterion was available. here we estimated the structure of the bound warhead by docking the warhead into the binding pocket, using the gnina docking tool [40] with default parameters. the quality of the resulting complex structure was ascertained by visual inspection and comparison to the corresponding portion of the ternary complex structure. the resulting warhead and binder molecules (only non-hydrogen atoms) were saved in sdf format for usage as inputs to the bo method. each of the ten individual single structures of e3 ligase or poi were then preprocessed using the following steps:



details of the protein structures used in this work. columns show the pdb id for each ternary complex as well as the chain identifiers (complex), the gene name, the pdb id of the structure used as input for prediction (template), the chain ids of e3 ligase and poi, the first and last residue number included into the used models (n-term, c-term). for the protac, the colums show the residue id, the nature of any ionizable group, and the net charge used in molecular models.



in order to determine the structure of the ternary complex, we first recognize that the two proteins can interact in a variety of poses. the first step in our pipeline is to sample a set of such poses that are viable candidates for the ternary complex. to do so we consider the input poi and e3 ligase as rigid structures. in this case, each pose is characterised by the relative position and orientation of the poi with respect to the e3 ligase. we then search through the space of poses, and sample poses that are viable structures for the ternary complex.



is a relatively unbiased estimate of the validity of the protein-protein interaction while allowing rapid evaluation. the ppi fitness serves to filter out infeasible protein-protein orientations by assigning a low score to rrts that result in steric clashes or the proteins being too far apart. however, manual inspection of the native ternary complex structures show that the poses corresponding to the crystal structure do not cor- respond to high surface contact between the proteins. this means that optimizing the dfire score is likely to bias us away from sampling near- native poses. hence we choose to cutoff the value of dfire score at 6



of the uff molecular forcefield [48] (using rdkit [49]). however, we additionally constrain the atoms of the binder and warhead at their re- spective docked coordinates. we then sample linker conformations by minimizing the uff energy [48] starting from a random (unconstrained) initial conformer generated using distance geometry. the choice of the



after generating 4 candidate conformers, we choose the output to be the conformer with the lowest uff energy. the choice of 4 conformers is because it is the smallest number of conformers we find is needed to reliably report the minimum energy constrained conformer. the pro- tac fitness is defined as the negative square-root of the minimized uff energy of this conformer.



note that when calculating the protac score above, we do not con- sider the interactions of the protac with the proteins, thus, it cannot be used to filter out cases with steric clashes between the linker and the proteins. these cases are taken into account by the protac stability score (see section 2.3).



the protac fitness for a particular rrt is a function of the energy obtained after minimization of the uff force-field energy. this mini- mization is computationally expensive, and the result of the minimiza- tion is not an analytic function of the rrt, which means that it is ex- pensive to optimize the rrt with respect to this score. as a solution, we have found that we can train a neural network model that can effectively approximate the protac fitness for a specific rrt.



values generated using rdkit (as described above). the model consists of two components: a simple model which learns to predict asymptotic component of the energy, which is asymptotically linear w.r.t the dis- tance between the binding pockets of the protac fragments for the particular rrt, and a 3-hidden layer neural network which learns to predict the residual component, capturing the more complex aspects of the score such as self-collisions that may arise due to the rrts bringing the binding pockets too close.



function has no analytical form, i.e. we do not have any information about the gradient, thus becoming a problem of gradient-free or black- box optimization. in this work, we choose to approach this problem via the technique of bayesian optimization [51,52] as it is known to be



proposed method, we used the ucb acquisition function to determine the next sampling points. this iterative process continues until the end of some bayesian optimization steps. the number of iterations is a hyperparameter that controls when do we get the list of final valid complexes.



from the above points, we filter out rrts with infeasible protac scores or ppi scores, i.e. we select only complexes that have ppi scores that are at-least 6.0 (the clipped value), and protac scores that corre- spond to a uff energy lesser than 1.5 times the minimum uff energy. we next locally optimized the remaining rrts using a combination of the ppi score and a protac stability score. we performed the optimiza- tion with the simulated annealing.



changes from quadratic to linear. these parameters need to be specified for each ternary complex separately since each structure has different distances between two active sites of the proteins (due to the space oc- cupied by the protac molecule). to set the values, we calculated the average distances of each active residue of one protein with the active and passive residues of the other protein, resulting in two distances for each candidate. we considered all of our samples with protac stabil-



the refined structures (1000 of them) were clustered by the fraction of common contact (fcc) clustering method [68]. afterwards, the clus- ters were ranked based on size (the cluster with the highest number of elements being the first-ranked). the clustering threshold was set to 0.5 and minimum number of elements in a cluster was set to 2. the rest of non-clustered structures were not taken into consideration.



protein. both rmsd values are calculated between the candidate and native model (after aligning the receptor structures, i.e., the e3 ligase). the dockq score combines these measures into a single scalar value between 0 and 1 (which is the score of the reference structure), with higher values corresponding to ternary complexes which resemble the original structure more closely. the distribution of the dockq scores has



dockq score with rigid docking (we align an unbound target to a native complex and calculate the dockq score). for each ternary complex, we selected a cluster which includes an rrt with a high dockq score. none indicates there were no near-native complexes found and an empty field that a method was not run for that complex. the columns also show the pdb id and characterization of the best rrt in terms of dockq score (see text).



selected a cluster which includes an rrt with a high dockq score. none indicates there were no near-native complexes found and an empty field that a method was not run for that complex. the columns also show the pdb id and characterization of the best rrt in terms of dockq score (see text).



tural refinement of the structures provided from the botcp module cur- rently takes about 25 h but could be further optimized. for instance by running the structural refinement for less than 1000 poses or by using a smaller number of protac conformations per structure. while the structural refinement is still computationally intensive, we see that the results without structural refinement suggest that the current scores and sampling technique can be beneficial in assessing the interactions for a given ternary complex.



as mentioned in the introduction, the current work predicts the ternary complex structure most effectively under a set of specific as- sumptions, i.e. that the proteins do not undergo significant backbone conformational changes, and that we have information regarding the e3-ligase binder, the warhead and the respective binding pockets. cur- rently, the protac stability score and the ppi score are affected because the side-chains are misaligned with the side chains as in the original crystal structure. these limitations affect us for instance in the case of 7khh and 6w8i_2, where misaligned binders and side-chains in the in- put impact performance.



future work can incorporate more informative ppi and constraint scores in the bo loop which will improve the filteration of non-native poses. our simulations show that the native structure consistently has a protac stability fitness that is among the highest observed for that complex, which promises significant improvements if this score includes side-chain flexibility (e.g., using autodock-vina).



