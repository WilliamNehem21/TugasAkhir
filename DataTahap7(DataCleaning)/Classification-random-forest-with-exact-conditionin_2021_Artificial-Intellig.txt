the spatial prediction of a categorical target variable when auxiliary spatial information is available everywhere within the region under study has become ubiquitous in geosciences. typical examples include predicting land use classes, land cover categories, drainage classes, vegetation species, landslide types, rock types, soil types, lithofacies, hydrofacies, and geological units. the mapping of categorical variables plays an essential role in a wide variety of geoscience applications. it is used to aid in riskaware decision-making in many areas, such as environmental studies within the region under study include indicator kriging with external drift(iked), regression-kriging of indicators(rki), and regressionkriging of memberships(rkfm). indicator kriging with external drift(iked) assumes that auxiliary variables are linearly related to the class occurrence of the categorical target variable(goovaerts, 2001). the auxiliary variables are incorporated into the indicator kriging system as deterministic linear functions. its implementation is challenging since it is often problematic to simultaneously estimate the parameters of external drift and the covariance function of the stochastic component. regression-kriging of indicators(rki) combines multinomial logistic regression of the categorical target variable on predictor variables with kriging of the regression residuals. thus, the regression modeling is supplemented with the modeling of variograms for regression residuals, which are then interpolated and added back to the regression estimate. rki has been adapted to regression-kriging of memberships(rkfm) by substituting crisp indicator values with continuous membership values. indeed,



another alternative for spatially predicting a categorical response variable in the context of spatially exhaustive auxiliary information available within the spatial domain of interest consists of using generalized linear mixed models-based approaches. cao et al.(2011) propose a spatial multinomial logistic mixed model in which spatially correlated latent variables are assumed to account for the spatial dependency in the categorical target variable. the proposed model is represented as a multinomial logistic function of spatial covariances between target and sampling locations. the sought-after class occurrence probability function for a target location is written as a multinomial logistic linear combination of covariance values between the target and source data locations, which can be analogous to the dual form of kriging methods. this method was later extended to incorporate heterogeneous auxiliary information for spatial prediction of categorical variables. these generalized linear mixed models-based approaches are free of the aforementioned inherent problems of indicator kriging-based methods. however, they are computationally intensive compared to indicator kriging-based methods.



locations. finally, the majority vote is used to aggregate the ensemble of categorical outputs. the final output also matches the target variable's observed values at sampling locations by construction. on the one hand, the proposed method's effectiveness is illustrated on a simulated dataset for which the ground truth is available. on the other hand, the proposed technique is exhibited on a real-world dataset comprising geochemicaldata. a comparison is also made with geostatistical and classical machine learning methods(regression-kriging of indicators, random forest, and support vector machines).



the first step of the proposed method consists of training the traditional random forest(rf) classifier on the data. random forest classifier is an ensemble method where several individual decision trees are trained on various subsets of the training dataset(bootstrap samples) using different subsets of available predictor variables, followed by an aggregation(breiman, 2001). the bootstrapping of the training data and the random selection of subsets of predictor variables ensure that each decision tree in the random forest is unique, which reduces the overall variance of the random forest classifier. for the final decision, the rf classifier aggregates the decisions of individual trees through a voting scheme such as the majority voting, i.e., for each observation, each decision tree votes for one category, and rf chooses the category with the highest number of votes.



illustrated using simulated and real-world datasets. a prediction performance comparison is carried out with a geostatistical method(regression-kriging of indicators) and traditional machine learning techniques(random forest and support vector machines). hyper-parameters associated with each machine learning method have been optimized through cross-validation. the proposed classification random forest with exact conditioning uses the same ensemble of decision trees generated by the classical random forest.



the predictive performance of each method is assessed on a testing dataset using the first evaluation statistic, i.e., the accuracy. the accuracy corresponds to the percentage of observations that are correctly classified. it has a value between 0 and 1. the higher is the accuracy, the better is the model. in addition to the accuracy, the rand index is calculated. the rand index measures the similarity between the predicted classification and true classification on the testing data by considering all pairs of points and counting pairs that are assigned in the same or different category in the predicted and true classifications. the rand index has a value between 0 and 1, with 0 indicating that the two classifications do not agree on any pair of points and 1 indicating the same classifications.



in this real case study, the categorical target variable is tl(thallium) geochemical concentration transformed into five categories through quantiles and observed at 568 locations over the study region in southwest england. predictor variables include elevation, gravity, magnetic, landsat, radiometric, and their derivatives, totaling 26 predictor variables. some predictor variables are displayed in training locations and those predicted by the classical random forest and support vector machines. there is a considerable disagreement between the observed values and the predicted values of categorical target variable at training locations. the misclassification rate in the training data is 33.80% and 52.58%, respectively, for the classical random forest and support vector machines. for the classical random forest, the number of decisions trees has been set to 10 000, and the hyper-parameters have been optimized through cross-validation. regarding the support vector machines, the kernel function and the hyper-parameters have been selected using cross-validation.



this paper proposed a classification random forest-based method for the spatial prediction of categorical variables in which the categorical target variable is exactly conditioned to the data. the exact conditioning means that the predicted values of the categorical target variable at sampling locations are the same as those observed at sampling locations. this property is well-known in geostatistical methods. the proposed method combines classification random forest, signed distance functions, principal component analysis, and randomized quadratic programming to achieve the exact conditioning of the categorical target variable to the data. the effectiveness of the proposed method has been demonstrated on simulated and real datasets.



sampling locations while achieving good out-of-sample predictive performance compared to competitor geostatistical methods such as regression-kriging of indicators. it is easy to implement since it combines well-known existing statistical and machine learning methods. it can easily handle a large number of categories consistently through the signed distance representation. the proposed method can provide realistic prediction uncertainties of the categorical target variable. it has the advantage of not producing noisy spatial prediction maps, as one can observe for regression-kriging of indicators. the proposed method is free of the inherent problems of regression-kriging of indicators such as the predicted probabilities of the target variable's categories that are not guaranteed to belong to the[0, 1] interval and sum up to one. updating the categorical target variable predictive map when few observations are added can be carried out quickly. only the last part of the proposed method, i.e., the randomized quadratic programming, should be performed.



