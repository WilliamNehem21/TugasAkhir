when compared to other meteorologically driven natural disasters, flooding is one of the most disastrous phenomena as it can lead to massive damage to both properties and fatalities worldwide(hinkel, 2020; tehrany et al., 2015). indonesia is a country that has significant flood risk in most of its provinces, with the islands of java, bali, and sumatera as the largest at-risk areas(bappenas, 2010). jakarta, officially called special capital region of jakarta, is the capital city of indonesia and is located on java island. jakarta has a population of over 10 million inhabitants(as of 2019) within a 662.2 km2 area, as a result jakarta is the most densely populated province in indonesia(bps jakarta, 2019).



jakarta has been known to flood since the 5th century ad(widyaningrum, 2019) and modern jakarta is still at risk due to being located on a deltaic plain crisscrossed by 13 natural rivers and more than 1400 km of man-made waterways. about 40 percent of the city is below sea level, which contributes to flood risk(baker, 2012). a range of factors including climate change accelerated sea-level rise, extreme meteorological events, along with land subsidence from multiple causes are worsening the flood risk in jakarta(abidin et al., 2011; world bank, 2019).



on january 1, 2020, jakarta was hit by the most intense rainfall event(peaking at 377 mm/day) since records began in 1866(bmkg, 2020). this several-day rainfall event resulted in widespread flooding causing 16 deaths, and displacing more than 30,000 people(bnpb, 2020). the severity of the flood event caught city officials off-guard, with the huge number of affected persons paralyzing indonesia's main economic and political hub. therefore, to mitigate such incidents and allow a timely preparation, it is paramount to develop an ability to predict and evaluate the areas of jakarta that are most susceptible to flooding.



in recent years, machine-learning models, particularly artificial neural networks(ann), have been increasingly used for flood susceptibility modelling. previous research has used precipitation and other environmental factors as input to anns and to output water levels and an inferred flood map(kia et al., 2012). although the previously mentioned flood events were mainly caused by the heavy rainfall(bmkg, 2020), a range of researchers have proven that several other factors have contributed to the disastrous flooding in the area. these include elevation, curvature, stream power index(spi), topographic wetness index(twi), soil type, distance from rivers, and others(kia et al., 2012; tehrany et al., 2015).



there are several factors that could cause flood which have been used as both fixed and temporal attributes to predict flood susceptibility. however, it is still unknown if those factors combined and inputted into an ann model will be able to create a reliable result that could predict flood susceptibility in jakarta. therefore, the authors of this work seek to develop a suite of machine learning models that uses as inputs these environmental factors to predict flood susceptibility in jakarta but in a novel manner with a temporal aspect.



this work aims to create a tool which can be used to prioritize allocation of flood defense resources for city officials and inform civilians of flood risk when extreme rainfall is forecasted. this research will also aim to find an optimal model through comparing: anns, k-nn, and svm models against a random baseline. novel approaches such as those presented in this work are encouraged in natural hazard susceptibility modelling(chen et al., 2019a) as there is no universal consensus about what the best modelling tool is(chen et al., 2019b). an overview of models previously employed in flood susceptibility studies can be found in islam et al.(2021). the work comprises three key topics; the



slope degree. it is calculated as the first-order derivative of elevation and it is another key terrain-derived factor affecting flood risk(tehrany et al., 2015). as ground slopes increase and runoff travels faster downhill this results in a decrease in the time available for surface infiltration(schillaci et al., 2015). the decrease in surface infiltration allows more runoff to enter the rivers and drainage systems and can be the most critical factor in determining flood risk(vojtek, 2019).





factors, the final factor of precipitation is a temporal factor. according to indonesian national atlas(ani), java has the most extreme precipitation rates of up to 400 mm/month(bappenas, 2010). as mentioned earlier the january 2020 floods occurred during the most extreme rainfall in the city since 1866(bmkg, 2020). furthermore, monthly rainfall intensity in



distance from rivers. across natural catchments, the distance from rivers or waterbodies has been proven to be the most dominating factor that influences flood-susceptibility(giovannettone et al., 2018). in urbanized catchments with more complex drainage, the distance from waterbodies is still the second-most important factor behind elevation(giovannettone et al., 2018). the flood susceptibility mechanism relates to the planar distance the waterbody must grow by to encroach on land, where the closer to an area is to a river or a body of water, the more likely that area is to flood(glenn et al., 2012).



imagery from the sentinel-1 c-band radar imaging satellite has been used to provide flood extent information during the january 2020 flood event. this active remote sensing system provides regular coverage through both day and night, and it is not affected by atmospheric processes such as cloud cover and so has been widely used to monitor flood events(conde and munoz, 2019; tsyganskaya et al., 2019; martinis et al., 2018; qiu et al., 2021).



machine learning(ml) is a group of computational algorithms and statistical models which are designed to learn from their environment(naqa and murphy, 2015). under a supervised learning paradigm, a model learns to improve its performance at a given task through experience. the following models are commonly used in predictive classification tasks and a brief overview of their learning mechanisms are provided. these models are support vector machines(svms), k-nearest neighbors algorithms(k-nns), and artificial neural networks(anns).



the tunable hyperparameter k, the number of neighboring data points to consult, is commonly determined by using the square root of n, where n is the number of points in the dataset. the other hyperparameter that needs to be tuned is the distance metric used to find the nearest data points. four distance metrics have been tested. they are the euclidean, manhattan, cosine, and minkowski distances. an overview of these metrics is provided in alfeilat et al.(2019).



anns are complex ml models which are comprised of networks of interconnected nodes(or neurons). each neuron takes a vector of feature values as input. then, it multipies a column-verctor of weights to this input vector and adds an additional weight named bias. finally, the result of this multiplication is input to an activation function and its result returned as output. in a network of connected neurons information flows between each neuron from the model inputs to the model classification output. by incorporating multiple neurons to build networks of arbitrary width and depth, anns of arbitrary complexity can be built in response to the complexity of the problem. the network structure is only one of the tunable hyperparameters(atkinson and tatnall, 1997). other hyperparameters include the activation function used within each neuron to combine the inputs into an output(kia et al., 2012). the sigmoid function is commonly used(bishop, 1994). other activation functions which



to prove that the models are better than random, they will be compared against a random baseline, i.e., that randomly guesses whether a location was flooded or not. this model represents the theoretical worst performance a ml model can attain on a binary classification task.



the labels for the dataset were provided through private communication with the bmkg. each administrative village area is classified as flooded or not flooded in each month. the centroids of the 260 villages were matched up with the static environmental flood risk factors to assign attributes to each village. the temporal rainfall values and spatiotemporal composite sentinel-1 values at each village centroid were added to create a monthly time series for each village. the 10-attribute time series for each village has been combined into a single dataset with an example shown below.



as the models used cannot handle missing values, records which did not have full attribute values have been dropped. this has led to underrepresentation in 2014 where only two months(november and december) contained full data. this resulted in a slightly smaller dataset(~ 0.08%).



the f1-score is the harmonic mean of precision and recall with 0 being the worst value and 1 the best value. precision is defined as the proportion of predicted positive samples that are true positive. recall is proportion of true positive that have been correctly predicted as positive class.



the following results are reported on models trained on both the original imbalanced dataset and the balanced dataset using smote. this has been done to assess the effect of smote on the three models. model results are presented on the training, validation, and test sets. the results for the random baselines have also been presented alongside.



the effects of the smote to rebalance the training datasets is important when predicting floods. the effect of this technique is clear when comparing the ann trained with the imbalanced set vs. the balanced set. however, this contrasts with the svm and k-nn models in which rebalancing the training data did not have any significant effect. the k-nn model performed minimally better in predicting flood when trained on the rebalanced data, while the k-nn model's score for the nonflood class remained the same. in the svm model the scores for both classes remained unchanged when training on the balanced dataset.



2020 was higher than experienced previously. ml models struggle to extrapolate outside of their known range of their training data if the data distribution used for testing is different from the one used for training. should ml models be used in a real scenario, it is important to recognize this limitation and retrain the model periodically.



overall, only the ann was able to perform better than random when predicting floods demonstrating that by using this model we could predict which villages are susceptible to flooding in the upcoming month. the novel nature of this work unfortunately limits its comparability to the wider literature. while the environmental input factors used are common throughout the ml flood susceptibility literature(e.g., kia, et al., 2012; shahabi, 2020; tehrany et al., 2015) the setup of predicting flood susceptibility classification across time is novel. the higher performance of the ann is suspected to be due to the complexity of the classification problem faced:



firstly, the problem is non-linear and suited to a mixed-effects model where the relationships between input variables and output vary across space(each village) and across time(month during the monsoon cycle). secondly, when predicting flood status in month t+ 1 using environmental flood risk factors in month t, the strength of the relationship to the following month's flood status will vary depending on the month's position in the monsoon cycle. in months heading towards the monsoon peak the same volume of rainfall would be expected to be correlated with greater flooding than the same rainfall volume in a month heading towards the dry season peak.



the model might be improved in the future; this exercise offered an overview of the ann application with selected attributes that are strictly related with floods in an area that suffered in the past for similar events. in jakarta, the flood is predicted yearly with flooding risk rating all the villages together. the data shows that all villages have a medium risk for all month in year 2020. using a model that can give predictions for each of the village on a monthly basis, government, firms, civilians can be on alert and prepare the disaster recovery plan.



this analysis shows the importance of rebalancing the dataset. the best scores were obtained in the ann model. the svm and k-nn models performed similarly poorly across both imbalanced and balanced datasets. the novelty of the approaches used in this study limits its comparability to the literature but the context-specific spatial and temporal patterns within the problem are theorized to be the reason why the ann model had the highest performance. the svm and k-nn models are suspected to suffer from the curse of dimensionality.



