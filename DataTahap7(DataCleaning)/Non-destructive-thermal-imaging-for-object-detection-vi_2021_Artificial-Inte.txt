due to its lightly pungent, crisp, and smoky taste, the new mexico chili pepper(capsicum annuum) is widely popular in the southwest region of the usa. sometimes referred to as chiles, the pepper in new mexico is a cash crop with an annual harvesting of approximately 8000 to 10,000 acres and is used for consumption, processing into dried spice, or decorations(strung on ristras)(bosland et al., 1991).



where zi, j, k is the input of the activation function located at(i, j). other variants include leaky relu(and many other variants), elu, maxout, and probout. we refer the reader to the following reference for an indepth analysis of cnn components(gu et al., 2018).



object detection has a rich history of literature with vast improvements made recently that utilize computer vision to identify where and what an object is in space. literature generally accepts the notation that two eras exist for the progression of object detection; traditional object detection before 2014 and the introduction of deep learning(dl) for object detection after 2014(zou et al., 2019). before dl was utilized for object detection, many investigations were limited due to computation power and trainable image representation. we refer the reader to(zou et al., 2019) for a comprehensive survey on object detection.



viola and jones(2001), introduced the viola-jones detector with the purpose of robust rapid and real-time detection. in this work, the authors focus on simple features rather than pixels to speed the detection process up. three main contributions were made in the study. 1) integral image which is a method for using intermediate image representation for rapid rectangle computation, 2) an algorithm based on adaboost for feature extraction by combing some features to form an effective classifier, and 3) a cascade method for classification to discard or pass on viable information for further analysis and ultimately, increased detection performance. viola and jones(2004) demonstrated the robustness of this method by applying the techniques to facial recognition. viola et al.(2005), utilized the cascade method for moving person detection along with adaboost for increasingly complex rejection regions based on a rule system.



another cornerstone in object detection was introducing the histograms of oriented gradient(hog) detection system presented in dalal and triggs(2005). in this investigation, dalal et al. created a method that utilizes edge direction and gradient intensity to determine the appearance of an image. this task is accomplished by separating the



the deformable part-based model(dpm) was developed by felzenszwalb et al.(2008) and builds off of the architecture from(dalal and triggs, 2005). using the underlying blocks, the model establishes hog descriptors via histogram gradient magnitudes within each 1d pixel. filters are used to dictate weights in the detection window. learning is accomplished on the pascal training data with a latent svm. using dpm, the authors won 2007, 2008, and 2009 pascal visual object classes(voc) detection challenge(everingham et al., 2007).



for a comprehensive survey of convolutional neural networks(cnn), we refer the reader to(gu et al., 2018). dl approaches advanced significantly in 2012 with the introduction of alexnet that was based on lenet-5 architecture, just with a deeper structure(krizhevsky et al., 2012).



improvements on the fast r-cnn design in the same year to move the algorithm closer to real-time detection speeds. this version became the first end-to-end and close to real-time object detector(zou et al., 2019). in the first stage, a region proposal network(rpn) considers a candidate bounding box. in the second stage, feature extraction is completed using region of interest(roi) pooling(roipool) from each candidate which executes classification and bounding box regression(ren et al., 2015).



2) how the model augments data on high-quality images, and 3) optimization of the convolutional and pooling layers of their faster r-cnn model. specifically, feature extraction was completed with a cnn model vgg-16 using 13 convolutional layers, 13 relu layers, and four pooling layers. two loss functions were added to optimize the convolutional and pooling layers, allowing the parameters to adjust automatically during training. they found that automatically tuning parameters resulted in 58 ms/image detection speed with map% of



fast r-cnn, and faster r-cnn in terms of detection speed and map%. when the authors fed their dataset to yolov3 they achieved a 40 ms/ image detection speed and map% of 90.03. so, they were able to soften the gap of performance between the faster r-cnn and yolov3 architectures.



both cameras were mounted over the chili plants at a fixed distance of 130 cm with a light background. the thermal camera was fully controlled with the flir tools; in fact, pre or post-processing could be done on an individual image, using researchir software. using an ir lens with a focal length of 13.1 mm, 112 thermal images(besides 112 rgbs) were captured every other day over three months. on each day, four different images were taken from different directions for a single plant. some of the images were captured in an outdoor setting and in natural light to validate the proposed technique.



where, tp is true positive, fp is false positive, and fn is false negative. true positives are when the model correctly classifies the object detection. false positive occurs when there is incorrect object detection. false negative occurs when ground truth bounding boxes are present in the image and the model fails to detect the object in the image. true negative(tn) is not considered for this application since it would be correctly not labeling parts of the image that do not have truth bounding boxes.



for our implementation of the mask r-cnn architecture, we utilize fpn for feature extraction which is leveraged from a convnet's pyramidal feature hierarchical system(lin et al., 2017). to do this, a regionbased object detector or region-of-interest(roi) pooling extracts features from the matrix. the roi is assigned as: where, bx, by, bh, andbw are bounding box center coordinates at x, y and width and height of the prediction box. tx, y, w, h are network outputs. object scores are calculated as the probability(between 0 and 1) that an object is inside a bounding box from a sigmoid activation function. we report all findings in section 4.3.



this section provides the results of all experimentation completed during training. here we show the viability of certain techniques applied to a chili pepper dataset in an environment with complex backgrounds and good ambient illumination. section 4.1 details the hog algorithm results, section 4.2 provides results for the mask r-cnn architecture, and section 4.3 shows results from real-time detection using the yolov3 architecture. the rgb dataset was considered for experimentation on the hog, mask r-cnn, and yolov3 models.



computer vision is a highly researched area with many new and cutting-edge technology. as a result, terminology can sometimes get confusing. ap was first introduced by voc2007(everingham et al., 2007) and the calculation is applied to every image within the labeled set and measures the average ap of the entire set. we follow the coco definition for map terminology as: where, api is the average precision at image i and n is the total number of images. the map metric is usually used as a final metric to compare performance throughout all object categories(zou et al., 2019), which we use to evaluate experiments with both the mask r-cnn and yolov3 models.



algorithm has identified and located all chili peppers in the image(with different colors), assigned a prediction bounding box, and labeled it with the appropriate label(chili pepper). as covered in section 3.2, precision and recall are determined by evaluating truth bounding boxes and predicted bounding boxes. while training on the rgb dataset, the mask r-cnn performed with a train map of 0.872 and test map of 0.896 with an overall computational time of 40.79 s per test image.



training loss drops below 2.0 roughly at the 250th epoch. after training was complete, we evaluated the model using map performance metrics. both training and testing resulted in 100% precision accuracy(map) with a computational time of 3.64 s per test image.



algorithm has superior capabilities to the mask-rcnn with over ten times the computational speed on the chili dataset. the yolov3 model introduces a spike in model performance for real-time detection(~3 s predictions) and demonstrates the possibility of being utilized during real-time robotic harvesting. however, we reported a lack of confidence in detection when heavy amounts of debris and paper overlapping are present in rgb images. in this study, it was shown that nondestructive thermal imaging can resolve these issues. in particular, yolov3 demonstrated an ability to detect peppers in areas with high debris and pepper overlapping with the thermal imagery; however the mask r-cnn model did not detect well on the thermal imagery. it was shown that mapping temperature differences between the pepper and plant/debris can provide significant features for object detection in real-time and can help improve accuracy predictions with heavy debris, variant ambient lighting, and overlapping of peppers. in addition, successful thermal imaging for real-time robotic harvesting could allow the harvesting period to become more efficient and open up harvesting opportunity in the evening hours or low light situations.



further investigation should be pursued to improve object detection when dense debris and poor ambient light are present. one issue in our experimentation is that only one class was used during training. this issue could lead to overfitting and could be the reason that yolov3 performed so well on the datasets. additional classes and variations in imagery type should be utilized during training and testing to avoid overfitting. we plan to expand the number and type of images in the dataset and determine if the yolov3(or other models) can exceed performance expectations during real-time robotic harvesting in dense debris and poor lighting environments with peppers in natural environment.



