the polarity of first p-wave arrivals plays a significant role in the effective determination of focal mechanisms specially for smaller earthquakes. manual estimation of polarities is not only time-consuming but also prone to human errors. this warrants a need for an automated algorithm for first motion polarity determination. we present a deep learning model - polarcap that uses an autoencoder architecture to identify first-motion polarities of earth-quake waveforms. polarcap is trained in a supervised fashion using more than 130,000 labelled traces from the italian seismic dataset (instance) and is cross-validated on 22,000 traces to choose the most optimal set of hyperparameters. we obtain an accuracy of 0.98 on a completely unseen test dataset of almost 33,000 traces. furthermore, we check the model generalizability by testing it on the datasets provided by previous works and show that our model achieves a higher recall on both positive and negative polarities.



the first motion polarity of earthquake waveforms is an important parameter in determining focal mechanisms, particularly for smaller earthquakes. traditionally the first-motion polarity is assigned manually by expert analysts. however, based on their observation on a dataset from the northridge region hardebeck and shearer (2002), reported that the picked polarities are inconsistent with the true polarities about 10% (for impulsive onset where polarities are more easily determined) to 20% (for emergent onset where polarities are more ambiguous) of the times. this, coupled with the growing volumes of seismological data, warrants the need for a faster, more precise and efficient method for the picking of polarities.



data-driven computer vision techniques, such as convolutional neural networks have been shown to be capable of analysing spatially independent information by mimicking the perception of images by the human brain (voulodimos et al., 2018; lundervold and lundervold, 2019; brachmann et al., 2017). like in most research fields, deep learning has been successfully applied to seismology for tasks such as event detection & location (perol et al., 2018), seismic phase identifi- cation & picking (chen, 2018; zhu and beroza, 2019; li et al., 2021, 2022), magnitude characterization (mousavi and beroza, 2020; chak- raborty et al., 2021a,b, 2022). the applicability of simple convolutional neural networks (cnns) in the picking of first-motion polarities has been demonstrated by ross et al. (2018), hara et al. (2019) and uchide (2020).



in this study we use an autoencoder model for determining the first- motion polarities. unlike (mousavi et al., 2019) who also use autoen- coders for polarity classification in an unsupervised fashion, we adopt a supervised approach and leverage the polarity information provided in the metadata of the instance dataset (michelini et al., 2021). since there are several algorithms that are capable of picking p-arrival times with an accuracy of the order of 0.01s (mousavi et al., 2020; li et al., 2021; zhu and beroza, 2019; liao et al., 2021) we focus solely on classification of polarities and not the picking of p-arrival times.



2004). no such augmentation is applied to the test dataset to retain the original distribution of classes. we do not apply any pre-processing steps, other than normalising each waveform by dividing it with its maximum absolute value. as mentioned earlier, we work with the assumption that the first p-arrival time is already known to us. we use a fixed data window centred around the p-arrival sample. the length of the window was chosen experimentally to be 64 samples after exploring several values between 32 and 1024 samples. note that only powers of 2 were used since the auto-encoder reduces the data dimensionality by a factor of 2 at each step.



huber loss with delta = 0.5, respectively. we use early stopping (pre- chelt, 2012) to prevent overfitting, whereby the training stops auto- matically if the validation loss does not decrease for 15 consecutive epochs, and the best set of learned model weights (one with lowest validation loss) is saved iteratively. we also use reducelronplateau function to reduce the learning rate by a factor of 10 if the validation loss



as outlined above, the incorrect determination of polarity was caused by incorrect picking of p-wave arrival time or emergent nature of p-onsets. in order to tackle the first issue, we used data augmentation to add a time shift to some of the traces in the training data. this augmentation technique was also explored in uchide (2020). since we did not have any information on the quality of p-wave onsets in the metadata, it was not possible to apply augmentation to increase the amount of emergent traces in the training data. the time shift was applied to 1/5th of the traces (which were then added back to the dataset); the amount of time shift was chosen from a normal distribution with mean 0 and standard deviation of 10 samples. a maximum shift of 30 samples was allowed to ensure that the first p-arrival is included in the window.



2.81% for low snr data upon using data augmentation. as one might expected, the improvement was more significant for low snr cases. this could indicate that the augmentation helps in better representing the traces in the scsn dataset (southern california earthquake data center, 2013).



in this study, we explored the potential of a deep learning model - polarcap to determine first-motion polarity of earthquake waveforms when the p-arrival information is available, faster and more accurately as compared to human analysts. we show that when tested on unseen traces, the polarity predicted by the model, matches the ones assigned by human analysts over 98% of the times. we observed that the major reasons behind incorrect assignment of polarity by the model were incorrect p-arrival picks and emergent arrivals; to that end we also found the event depth to indirectly affect the fraction of incorrect predictions by affecting the quality of p-wave arrival. however in spite of these hurdles we find that when the polarities predicted by the model differed from those presented in the metadata, it was usually the model that was correct (almost 41% of the times, while the model was wrong only about 28% of the times), thus demonstrating its ability to overcome human errors.



