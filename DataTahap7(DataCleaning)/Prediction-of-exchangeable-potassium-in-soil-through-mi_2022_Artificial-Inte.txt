in theory, based on vibrational spectroscopy principles, and under controlled conditions with defined mixtures of soil constituents, charac- teristic infrared electromagnetic radiation absorption patterns can be attributed to functional groups and chemical bonds (socrates, 2004). in practice, this is more challenging based on the measurement condi- tions and when analyzing soil constituents like kex that are in lower concentrations and only being observed by correlation with other spectrally active major soil components (sanderman et al., 2020). yet, the interpretation and the ability to assign spectral features to fundamental vibrations of specific soil properties is key (i) to develop more parsimonious models through the selection of specific wavenumbers, known as important, during the preprocessing, feature extraction and modeling phases (viscarra rossel and lark, 2009; mehmood et al., 2012; ng et al., 2019a), (ii) to better understand model output, and provide insight into how these models can be further improved (viscarra rossel and behrens, 2010), (iii) to potentially shed new lights on the current state of knowledge of the soil processes being modeled (lundberg and lee, 2017) and (iv) to foster end-users trust and facilitate adoption of machine learning- based technologies (molnar et al., 2020).



models to predict kex in soil when trained on a large mirs spectral li- brary with a sufficient level of accuracy for the remediation of radioac- tive contamination of agricultural land. to articulate the role of the data regime and model capacity in this analysis, plsr is used as a base- line. our second aim is to investigate, through the analysis of model's performance across soil taxonomy orders, how domain experts can ex- ploit cnn interpretability algorithms to gain new insights into the soil processes being modeled and build confidence in the decision-making process during nuclear remediation.



python version 3.6, numpy ( scikit-learn (https:// scikit-learn.org) and pytorch ( have been used for the data pre-processing, analysis and modeling parts as well as captum ( to address the interpretability needs. a google colab pro computing environment has been used with the following specifica- tion: 1 gpu tesla p100 16gb, 2 intel(r) xeon(r) cpu @ 2.30ghz cores and 26gb ram. this democratized access to the sufficient computational resources is also a key ingredient of reproducibility research.



(i) to assess their robustness and (ii) to mitigate the effect of relatively small sample sizes for certain soil taxonomy orders such as oxisols, vertisols, gelisols and histosols. for each of these different 20 random splits, both models were exposed to the same train, validation and test (unseen) data. the mean performance as well as their standard devia- tion were reported.



to evaluate both the pslr and the cnn models on training, valida- tion and test datasets, the following metrics were used: (i) coefficient of determination (r2) and (ii) lin's concordance correlation coefficient (lccc). lccc measures the linear correlation between the predicted and true values but penalized by a bias term allowing to assess the agreement between the observed and predicted values with respect to the 1:1 line (lawrence and lin, 1989). these two metrics were calcu- lated on the log10-transformed version of the true and predicted values of kex. in addition, the root mean square error (rmse), mean absolute percentage error (mape) were calculated on the original scale of the target variable to facilitate interpretation and provide two complementary perspectives on the performance of the models. indeed, given the skewed empirical distribution of the target variable, rmse and mape tend to overweight errors made respectively for large and small kex values. bias was also calculated on the original scale and reported.



in this study, we implemented the gradientshap (lundberg and lee, 2017; sundararajan et al., 2017; smilkov et al., 2017; kokhlikyan et al., 2020) model interpretability algorithms to identify the spectral features regarded as important by the learning algorithm for the prediction task being performed. the importance of spectral features can be computed model-wide or for an individual or group of instances with marginal ad- ditional computational burden. in our effort to relate this information to domain knowledge, feature importance was calculated for the overall cnn models based on (i) the full dataset, used in this study, and (ii) the soil taxonomy orders separately. the correlation of the gradientshap values of the spectral features for predicting kex content by soil taxonomy orders was also assessed, allowing understanding their similarities. this information on correlation does allow not only increasing interpretability but also helps to understand how the learned spectral features are reused across soil orders.



up to a dataset of 5000 samples, both plsr and cnn models perform poorly with an r2 below 0.65 and a high level of variance across differ- ent random splits. however, a data regime of 10,000 samples appears to be an inflection point. while the plsr model levels off at approximately an r2 of 0.64, the performance of the cnn keeps increasing up to an r2 of about 0.79 as the size of the dataset increases.



moreover, when evaluated by soil taxonomy orders, the average mape ranges from 26.9% for vertisols to 47.3% for vertisols. on mollisols, the most represented order in the kssl dataset, the average mape is 27.4%. the variability of the metrics increases as sample size of the test set decreases as it is the case for gelisols with a standard de- viation of 9.9% for its mape.



it is important to recall that when the snv (standard normal vari- ate) preprocessing step is applied upstream of the modeling pipeline, mir spectra are made translation and scale invariant. hence, machine learning algorithms exploit only deformation/distortion patterns to provide estimates. gradientshap values indicate the effect of local de- formations of the spectra on predicted values.



a detailed analysis of the correlation levels is conducted below. to only consider the general trends at this stage, a high level of correlation is observed between the gradientshap values calculated for spodosols, entisols and the undefined category. the gradientshap values calcu- lated on mollisols, the most represented soil taxonomy orders in the kssl database, are highly correlated positively with vertisols and nega- tively with spodosols and entisols.



interpretation is that the overall validation loss decrease was mainly driven by mollisols and alfisols orders, the two most represented orders in the kssl dataset. more training epochs would have conducted most likely to even better performance on those orders. however, the group including gelisols, spodosols and ultisols validation losses stopped de- creasing after 100 epochs (halfway through the training period). we are overfitting those soil orders. hence, a more conservative approach would have been to stop training at 100 epochs.



whether it is preferable to stratify mirs modeling by soil taxonomy orders rather than including them all together has been a long-standing debate in the mid-infrared soil spectroscopy research community (torres astorga et al., 2018). our study proposes a methodology to in- form this decision in the light of the spectral features learned and re- used by the prediction algorithm. as a first analysis, we have shown that the quality of the prediction of kex is on the one hand indexed on the availability of a large data volume and on the other hand on model classes capable to leverage it. a more detailed analysis of these regimes by soil taxonomy orders, however, revealed that the predictions of kex for some underrepresented classes such as vertisols is possible. hence, we have shown that the pooling of all soil taxonomy orders is beneficial in this circumstance but for instance not, in the case for histosols and gelisols. such an analysis is instructive and would be interesting to conduct also in the context of prediction of other soil analytes.



