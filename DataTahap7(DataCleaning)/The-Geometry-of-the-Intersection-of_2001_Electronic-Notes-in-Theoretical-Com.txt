this question of fusion of two 3d images is still an issue in medical imaging, mainly when small crucial parts of these images have to be matched, as it is the case, for example, with brain areas like caudate nuclei and putamen(see). several similar areas of interest for the pathologist are contained in rather small boxes, sometimes not larger than 10 pixels in each direction and the precision of medical facilities being fixed for technological reasons, there is no way of zooming in to get better views. only a detailed mathematical study of the situation may help the surgeon.



the 2d situation is instructive because the underlying intersection problem is simple and the benefit of lattice periodicity can be easily explained with the help of continued fractions. unhappily such lattice properties do not generalize such as in higher dimensions. this 2d case nevertheless gives precious indications about which higher dimensions notions are worth introducing, like plane sections of voxels spaces studied in parts 5,6, formulas giving plane sections of cubes of part 8 and quadratic cubes of part 13.



accuracy of these simple digital coordinate change formulas is sufficient when the euclidean norm(a, b)/m is not to small(i.e. greater than 10), but is to rough when(a, b)/m is small, which means that both grids have similar sizes. in this case one has to compute areas of intersections of small and large pixels and take account of them into interpolating formulas.



general computational geometry algorithms, which use rather sophisticated data structures to describe convex polyhedra are not well adapted to the present situation for two principal reasons. the first is that they avoid degenerate cases: vertex of the first cube belonging to a face or an edge of the second, colinear edges, edges coplanar to a face, coplanar faces and so on. the second is that implementing them in exact arithmetic or in computer algebra systems is still ahead() and current implementations with floating point systems destroys lattice properties, which forbids their study.



working computer scientists know the long way between theoretical algorithms and their coding. this paper is not only concerned with the geometry of voxels intersection algorithm but also with the issues in its coding. efficiency of this code, mainly the deletion of almost all control tests occurring in main loop, is the first reason of our way of doing; the second one is to stay within a convenient numbers system: quadratic algebraic ones.



when parameters tend toward special values. this implies that these formulas also give particular cases of cubes plane sections. for example vertices of a parallelogram parallel to an edge will converge to it if the section plane tends to this edge. then we shall rely on cube symmetries to get(c) plane sections for any normal vector(a, b, c), using some elementary group theory.



there are several way of extracting plane sections from a 3d image. first one was indicated above and starts cutting all voxels with a given plane leading to the plane tiling already studied. second step of this approach consists in mapping these tiles to pixels overlapping this tiling. a precise treatment of this correspondence supposes determining all intersections of tiles and pixels, which can be done using an algorithm for the intersection of two convex polygons



as mentioned in the introduction our main interest lies in the intersection of two sets of voxels each one tiling r3 space. tiles of each partition are identical cubes. first one can be seen as unit cube of r3 and second one as a cube of arbitrary size and orientation.



both convex polygons being positively oriented, one edge is chosen on each curve and an alternate pursuit is opened. each time the pursuit is stopped, the intersection point of the two current edges is computed and if it is non trivial,(segments may have a void intersection even if their support do not), it is supposed that curves cross at this point. it is easy with the help of a boolean variable to follow which of the two curves lies inside the other one. once all edges have been traversed the algorithm is over.



it occurs that arnold(cf.), for much different motivations, showed that convex hulls of integer points contained in 3d cones,(his theory has even sense for any dimension), are the natural generalization of ordinary continued fractions. such hulls are now called arnold-klein sails. thus intersection schemes of two voxels spaces and arnold-klein sails are in fact the same thing.



implementation of intersection of two digital views of a same object having neighboring resolutions needs to compute intersections of overlapping voxels. a formal approach of this question using as much as possible particular structure of cubes, and specially their symmetries, shows that their plane sections can be described by exact formulas which are still valuable for degenerate cases. this avoids the complicated coding generally met in such situations.



