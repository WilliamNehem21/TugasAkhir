the electric vehicles (evs) market has seen rapid growth recently despite the anxiety about driving range. recent proposals have explored charging evs on the move, using dynamic wireless charging that enables power exchange between the vehicle and the grid while the vehicle is moving. specifically, part of the literature focuses on the intelligent routing of evs in need of charging. inter-vehicle communications (ivc) play an integral role in intelligent routing of evs around a static charging station or dynamic charging on the road network. however, ivc is vulnerable to a variety of cyber attacks such as spoofing. in this paper, a probabilistic cross-layer intrusion detection system (ids), based on machine learning (ml) techniques, is introduced. the proposed ids is capable of detecting spoofing attacks with more than 90% accuracy. the ids uses a new metric, position verification using relative speed (pvrs), which seems to have a significant effect in classification results. pvrs compares the distance between two communicating nodes that is observed by on-board units (obu) and their estimated distance using the relative speed value that is calculated using interchanged signals in the physical (phy) layer.



stations (scs) [2]. the role of a med can be taken over by city buses that follow a predefined route across the city. inner-city busses repeatedly move along a predefined route. an ev can establish a communication with a med and approach it at a specific location along the predefined route to complete the charging process. the proposed method exploits inter-vehicle communication (ivc) in order to eco-route evs. this innovative approach drives the investigation towards integrated solu- tions that allow evs to charge while moving through the city, without the need for a significant change in the existing road infrastructure.



med, optimizing waiting times. specifically, nodes that enter the system broadcast periodically beacon messages, known as cooperative aware- ness message (cam), to inform of their presence. every beacon message contains a node identifier, gps coordinates, gps speed, current time- stamp and mac address of the ev. these messages are transmitted several times per second using dedicated short range communication (dsrc) and wireless access in vehicular environments (wave) tech- nology, based on the ieee 802.11p standard. however, these messages are vulnerable to a wide range of cyber threats, such as eavesdropping, spoofing and modification attacks.



motivation: the main motivation of this paper is to investigate how the presence of a spoofing attacker as an inner node of the system affects the total travel time that must be optimized in ref. [8]. specific examples are described in which the presence of an attacker can violate the right order for the charging of evs using the med or the scs. these examples are not unique, however they are highly probable and can incur a sig- nificant increase in the total travel time. this indicates that more advanced attacks, possibly involving numerous coordinated attackers, can impact and degrade the operation of the system. however, the detailed analysis of coordinated attack models is out of scope of this paper. here, we show that a probabilistic ids is appropriate in order to detect and mitigate the presence of at least one attacker.



the rest of this paper is organised as follows. section 2 provides an overview of related work in the domain of spoofing attack detection. section 3 describes the topology and the types of the implemented at- tacks. section 4 describes the proposed probabilistic ids and the newly introduced pvrs metric. section 5 presents the experimental evaluation setup, the impact of the implemented attack in v2v communication and the proposed system for dynamic wireless charging. it also includes the experimental results of the probabilistic ids. section 6 contains a dis- cussion of recent authentication and key-distribution techniques that are used in vanets in order to strengthen and secure the communication process. finally, section 7 summarises our findings and concludes our work.



explained how these rsu stations can be assumed as non-malicious. a variety of approaches have been proposed in the literature to recognize spoofing. of interest here are methods which compare global navigation satellite system (gnss) information to measurements available from other, non-gnss sensors [11]. in ref. [15] carson and bevly discussed the use of range and bearing information with gps positions to detect spoofing for a platoon of vehicles. they assumed the availability of relative position vectors (rpvs) between pairs of vehicles from the radar sensor. to detect spoofing of a single vehicle they compared these rpvs to the corresponding gps difference vector, declaring spoofing if the difference was too great. their focus was on a pair of vehicles only. all the above mentioned techniques use the ivc for the interchange of ranging information between nodes to detect anomalies that indicate spoofing of the gps positions. however, the wireless v2i communication confronts the wireless interference from the entire location as well the fading characteristics.



methods for gps spoofing detection and mitigation that use either phase delay measurements [16] or the angle of arrival (aoa) estimation [17] from the phy layer to verify the message originator. from an attacker perspective, an illegitimate node may intentionally falsify information to achieve a certain goal that might be rational in some scenarios. a drawback of using metrics from the phy layer is the incorrect gps spoofing detection (e.g. false alarms) that may occur in situations where multiple correct satellite signals are received from similar directions and phase delay differences are below a predefined threshold.



two different charging systems are compared: one that uses a static charging station (scs) only, and one that combines a scs and a mobile energy disseminators (med). we use different initial energy conditions for all the evs of the simulation. our intelligent route search method takes into account the waiting time either for the med-ev appointment or for the waiting time at the queue of an scs, in the presence of a spoofing attacker among the inner nodes of the system. it is shown that the proposed method decreases significantly the waiting time for the charging procedure and the charging time that is needed for an ev, because the ev continues to charge along its route.



waiting time either by the scs or by the med. this comes as a response through the periodical communication with meds or scs using the cam messages. based on this information, an ev can choose either the scs or the med for its charging needs whilst selecting the best route from its starting point to its final destination.



the above scenario is not the only one that may occur. for example, a spoofing attacker may launch a spoofing attack not only for their own benefit. the attacker may aim to disrupt the operation of the system as a form of denial of service (dos) by virtue of the v2v communication problem between ev i and ev b (see section 3.2). in any case, the developed ids would need to distinguish between both legitimate cams sent by ev i, and spoofed cams sent by ev a, both transmitted with the id of ev i.



the ev a approaches the ev b in a distance within the transmission range of 1000m, the attacker intercepts the id and mac address of ev i from the broadcasting cams and starts its spoofing attack. during the spoofing attack, ev a also broadcasts a cam message every 0.1 s, using the id of ev i, in order to inform the ev b about an incorrect gps location and speed value. since the attacker replicates the id and mac address of ev i, during the spoofing attack, there would be wsa frames showing dis- crepancies between the identity and the physical characteristic of the frames.



the routing flow that is selected in the transport layer is based on the incorrect spoofed mac address of the transmitter ev i. this results in frame losses in the phy layer due to path losses and fast fading factors, or due to the strict delay constraints of the backoff procedure in the mac layer. hence, many cams sent by ev i are lost in the mac layer and are never acknowledged by the client, which increases the packet error rate (per) and also decreases the throughput. so it is clear that the spoofing attack affects the communication channel. this attack can be also used as an another kind of a dos attack. the designed ids aims to detect these discrepancies in the communication channel.



the k-nn is a simple machine learning (ml) technique for pattern recognition, based on feature similarity [27]. when we say a technique is non-parametric, it means that it does not make any assumptions on the underlying data distribution. therefore, k-nn could and probably should be one of the first choices for a classification study when there is little or no prior knowledge about the distribution of the data points. k-nn is also



the random forest (rf) is a supervised learning algorithm, based on decision tree models that split a subset of features at training time and output the class that has the majority votes of the classes of the individual trees [28]. this supervised learning algorithm is preferred over others for the following reasons. firstly, it can be used for both classification and regression tasks, providing high accuracy. secondly, if there are more trees, it does not allow overfitting trees in the model. it has the power to handle a large data set with higher dimensionality. lastly, the rf clas- sifier can handle missing values while maintaining the accuracy of a large proportion of data.



sults when implemented independently. however, the combined use of these algorithms may help improve the overall performance of an ids [29]. different methodologies were evaluated to assess whether the classification results could be improved, for instance, by applying data fusion techniques.



ensemble learning has been used to combine the outputs from different classification techniques. ensemble learning is the process in which multiple classifiers are strategically selected and combined in order to solve a particular computational intelligence problem. ensemble learning is primarily used to improve the classification performance of a model. one of the most commonly used ensemble learning algorithms is known as bagging [30]. in this algorithm, bootstrapped replicas of the training data for each classifier (rf, k-nn) are used. during the last step of bagging, the majority voting combination rule is used. since the intended output of the ids is a probabilistic ids, the conditional proba- bilities are estimated for each classifier in the presented ids using the bayesian rule as a data fusion technique.



a lazy algorithm (as opposed to an eager algorithm). what this means is that it does not use the training data points to do any generalisation. in other words, there is no explicit training phase or it is very minimal. in



this algorithm for the pvrs metric which is based on the position verification is presented in algorithm 1. therefore, the entire area is then partitioned into small areas (called subnetworks) that can be investigated in isolation for the detection of a spoofing attacker. a subnetwork can be assumed an ellipse whose foci are the tx and rx vehicles. this ensures that all objects whose sum of distances from tx and to rx (i.e., from tx to object and from object to rx) is less than 1000 m, (this is the maximum communicating distance for 802.11p) are accounted for.



km) in need of charging in the area. this value of mac delay is very close to the cch interval, which is 50 ms. as a result, it becomes difficult for ev i to have access to one of the six service channels (sch) channels. this combination of the mac delay with the traffic density can be assumed as a marginal threshold for the proposed dynamic charging system. this is because if the tmac delay exceeds the 50 ms (cch interval) the estab- lished wireless connection using the ieee 802.11p mac protocol be- tween two evs in fact will be questionable due to the collision probability increase.



focusing specifically on the system that uses only an scs, the dif- ference of the average overall travel time with and without the presence of spoofing attack is about 5min, which increases the average total travel time by 10%. this increase is even more noticeable in the scenario with an scs and a med. in this case, travel time difference with and without the presence of spoofing attack is about 8min, increasing the average total travel time by 13%. the travel time difference is slightly higher in this second scenario because the med, which is a mobile node, contrib- utes with additional propagation delay in the v2v communication. this is also caused by the spoofing attack.



is a probability curve since the proposed system is probabilistic. another evaluation metric used is the area under curve (auc) which represents the degree or measure of separability between classes. thus, the higher auc score, the better our model can distinguish between classes. the last metric that we use for the evaluation of the proposed cross-layer ids is the accuracy. informally, accuracy is the fraction of predictions our model got right in the total of predictions.



