although there are many tools available to create, encrypt and extract data, there is relatively little available in the area of estab- lishing integrity, authentication and provenance. for instance, [7] creates and issues a certificate containing a sha 256 hash value of the submitted media file along with the user details and a times- tamp. that certificate is in turn verified by a digital certificate issued by leading certification authority comodo. the problem here however is that the original file and the certification are sep- arate entities and could easily become separated during distribu- tion or circulation of the file. in general, wrapping the file and its certification inside an outer envelope is no real guarantee that the field and its certification will remain together. inserting the certification into the file is the only apparent reliable method and is the approach used by leading companies such as microsoft and adobe for digital signing of office and pdf documents [8]. a limitation with inserting the certificate inside the file is that it



despite offering better security and faster performance, sha-2 was only adopted slowly over the next three years with sha-1 remaining in extensive use. the main contributory reasons were that sha-2 was not supported on systems using windows xp (sp2) or older, there was no perceived urgency as no collisions had yet been found in sha-1 and sha-256 is about 2.2 times slower than sha-1 though some of that drop can be reduced by a move to sha-512 on 64-bit hardware and operating systems [20].



the original concept of a digital authentication scheme was first proposed by diffie and hellman [25], who revolutionised cryptog- raphy by proposing a method of creating a shared secret over pub- lic or unsecured channel which would enable traditional symmetric cryptography to be used electronically. in their paper, they also discussed the idea of a system of public key cryptography based on public and private keys and also the need for one-way authenti- cation but did not propose solutions for either of these. two years later, such a solution was developed at massachusetts institute of technology (mit) by three researchers [12] which became known by the initial letters of their surnames, rsa (rivest- shamir- adle- man). the rsa public/private key algorithm is based on the diffi- culty of factoring large numbers and produces a private key and a public key where a message encrypted using the public key can be decrypted using the private key but calculating the private key from the public key is computationally infeasible. this is known as asymmetric encryption. the rsa algorithm is too slow for encrypting lengthy messages but it can be used to create a shared secret which can then be used for high-speed symmetrical encryption.



are electronic documents that verify the owner of a public key. these certificates are issued by a certification authority (ca), an organisation which specialises in the business of issuing certifi- cates, usually on a commercial basis and which can be trusted by recipients. the certificate is a binding between an entity and its associated public key and contains information about the issuing ca as well as information about the person or organisation to whom the certificate applies. this information is generally pre- sented in the format of an x.509 certificate. digital certificates issued by third-party certification authorities are the backbone of secure internet connections based on transport layer security (tls), formerly known as secure sockets layer (ssl); a secure con- nection is most recognisable when a website uses hypertext trans- fer protocol secure (https) and a padlock icon appears in the url or at the bottom of the browser. the digital certificate for the site can be viewed by clicking on the padlock. until comparatively recently, secure connections using ssl/tls were primarily used for webpages involving financial transactions but they are coming into wider use in popular sites such as google and social media sites such as facebook and twitter.



editing and inserting metadata in both jpeg and png images. problems have being found with that library [28]. apple os x also has a programmatic way of accessing metadata using spotlight and the tag kmditem although detailed study of that was not carried out.



the metadata segments are followed by segments holding data relevant to the compression algorithm. jpeg is a lossy compression technique which uses quantization and huffman coding. depend- ing upon the way the image was created or edited, other segments may be present for parameters such as restart interval (dri). com- pression information segments are of no direct interest in this pro- ject but the fact that they can be restructured has to be taken into account; for example, inserting an extra metadata field in various applications may split a single dqt or dht segment into multiple segments which collectively hold the exact same information as the original single segment even though the contained data has not changed, the simple act of splitting it will change the hash value for the file. the encoded image data is not held in a segment as there is no restriction on its length. the encoded data is assumed to start immediately after the sos segment and finish immediately before the eoi marker. it should also be noted that as well as the main image, a jpeg usually contains a thumbnail nested inside the metadata section which will be stored as separate jpeg with its own soi, compression information segments, encoded data and eoi; it will not usually contain any metadata.



sixteen application segments are allocated for metadata, referred to as app0... app15 using the markers 0xffe0 to 0xffefc [29]. an application segment can be used for any purpose and multiple instances of a particular segnment can be used within a file; the specific purpose of each segment is indicated by a signature imme- diately following the two bytes stating segment size. metadada readers should skip over a segment if they do not recognise the we developed jpegreader, an application to view jpeg structures in a much simpler way. a different version, pngreader, was also developed for reading and modifying png files. the following screenshots from jpegreader illustrate the different ways in which segments can be used inside a jpeg file.



the structure after adding some metadata through windows explorer. a second app1 segment has been added to hold xmp data. the xmp signature can be seen in the values box below the markers combo box. windows explorer has split the dqt data into two segments and the dht data into four segments. there has been no overall change to the data and despite extensive research, it has not been possible to find an explanation for why windows splits these segments.



1.0 in the second tag. closer analysis showed that all the devices that include the idf have those default values; whilst documentation of this could not be found, it seems reasonable to conclude that devices that do not specifically include the ifd work are in fact using those defaults.



ifd0 tags are not included as there are 231 of them but only a handful are generally used in jpeg. although there are no rules in the exif specification about the order of ifds, all tags inside an ifd must be in numerical order. the first 10 tags shown (f0.. .f9) are generally used in ifd0 as well as the exif and gps tags which can be seen at the bottom of the list of tags in this. there are 4 tags identified as unknown. no documentation could be found for those tags, they are not listed in the tiff or exif specifications



we developed jpegreader and pngreader to assist in the anal- ysis of image files. these were developed in c# using microsoft visual studio. in order to keep the header file uncluttered, the code was written used the pimpl idiom, also known as the cheshire cat or opaque pointer which is a method of avoiding the forward declara- tion of all private variables and methods in a c++ header file [33]. our documented code is available at tinharran.com. our work shows that it is possible to insert a digital certificate into a jpeg file and to edit the exif metadata fields to show references to a certificate. these would be visible in native applications such as windows explorer and os x inspector as well as third party image viewers and editors.



calculated using sha256deep from md5deep v4.3. the result: c7 a0a355a9b5926f7c332807e4ca380e378e20aee652a1f6d066276aa b6324fe was then put through a content signing process which yielded the same sha256 value as step 1. the resulting ps7 file produced and emailed was inserted into an app1 using the photo- prove writer library. in order to confirm persistence, the file was copied across devices and operating systems in a similar process to that used earlier for testing persistence across operating systems



f. buccafurri, l. fotia, g. lax, allowing privacy-preserving analysis of social network likes, in: eleventh annual international conference on privacy, security and trust, pst 2013, eleventh annual international conference on privacy, security and trust, pst 2013, ieee computer society, tarragona (spain) (usa), 2013.



