Cracks are the main diseases of roads and potential threats to road safety. The detection and repair of cracks is the focus of intelligent transportation system research. However, the performance of automatic crack detection is often not good enough due to the uneven illumination, low contrast between the crack and the surrounding pavement and the possible presence of shadows similar in intensity to the crack. In this paper, an improved multi-scale Retinex algorithm is proposed to enhance the crack image. The wavelet transform is integrated into the traditional multi-scale Retinex algorithm to avoid the halo generated by the Retinex algorithm, thereby reducing the image distortion. Meanwhile, the multi-scale Retinex algorithm can make up for the lack of useful information lost by wavelet transform, so the combination of the two can obtain better crack enhancement effect. In addition, the preprocessing of shadow removal is performed before crack enhancement, which effectively eliminates the interference of high-intensity shadows. Through the comparison of objective performance in- dicators, the newly proposed algorithm can better highlight the crack information. The method proposed in this paper can effectively realize the functions of shadow removal and crack enhancement, so that the recognition accuracy of the overall detection system reaches 95.8%, indicating that the algorithm has high research sig- nificance and engineering application value.

maintenance costs and extend pavement life. However, the traditional crack detection mainly relies on manual visual inspection, which is time-consuming and labor-intensive in actual operation, and it is diffi- cult to objectively evaluate the degree of road deterioration [4]. Therefore, it is necessary to develop an automatic, accurate and efficient pavement crack detection method. With the development of computer vision and civil engineering image processing, image-based automatic

A lot of research has been conducted by scholars in various countries on the problem of pavement crack detection, and the main methods are two major categories [5]: methods based on image characteristics and methods based on machine learning [6]. The methods based on image characteristics can be divided into edge detection, histogram analysis, mathematical morphology, filtering, etc. The machine learning based approaches are further divided into supervised learning and unsuper- vised learning [7]. From the perspective of development status, the crack recognition technology based on image features is more widely used in the field of engineering [8,9].

[11] and Canny [12], the foreground of the image, i.e. the crack, is extracted. This method can achieve rapid detection, but it needs to manually set many thresholds. The histogram analysis method is to fit a Gaussian curve according to the grayscale histogram of the crack image, and then determine the segmentation threshold according to the fitted

results are better than the above histogram method, this method relies heavily on the selection of the threshold [16]. The difference between the size of the structural element and the selection of the threshold re- sults in different crack segmentation effects. Especially in the case of different crack thicknesses, the segmentation effect will be worse.

From the current state of research in the field of crack recognition, road crack detection often needs to use a threshold-based segmentation method [17,18], but road surface images are often obtained under bad weather and illumination conditions [19,20], and the road damage image data collected due to uneven illumination is quite difficult to use the threshold-based segmentation method to detect the crack edge [21, 22]. In general, the gray value of the crack itself will be lower than the gray value of the non-cracked pavement image, but the opposite may occur in the pavement image collected under the special circumstances of uneven illumination. If the global threshold method is used in the detection, the crack information in the pavement damage image cannot be detected, resulting in the missing or wrong recognition of the crack information in the pavement damage image, which affects the recog- nition performance. In addition, uneven illumination or insufficient light will lead to another problem, that is, the captured images will have poor contrast, low brightness, blurred local details, sudden changes in brightness, etc., and often accompanied by obvious noise [23]. This makes it difficult for machine vision to extract and analyze information from these images.

The road crack images collected in the natural environment are prone to shadows. The contour of high-intensity shadows is similar to the shape and color of road cracks, which can easily be misjudged as cracks and become one of the main interference factors in crack extraction [29]. The shadow itself is divided into the umbra area and the penumbra area. The umbra area is generally located in the inner area of the shadow. Because all direct light is blocked by the object, the shadow boundary outline will be clearer. The penumbra area is generally located in the edge area of the shadow, the light is partially blocked, the outline of the shadow area is blurred, and the brightness gradually changes from the inside to the outside, showing a smudge effect. In order to eliminate the interference of shadows, this study proposes different shadow removal schemes according to the different characteristics of different shadows. The next two subsections will describe the shadow removal process in detail.

where I(x, y) is the shadowless image andC(x, y) is the shadow factor. Therefore, the problem of solving the shadowless imageI(x, y) is trans- formed into the problem of solving the shadow factorC(x, y). The auto- matic method of solving C(x, y) is described below.

thatt0 can be obtained. Once knowingt0, we can get an initial curve, that is Lt0. Then Lt0 can be evolved towards the direction ofLt1Lt1 andLt2. Since t0 is betweent1 andt2, Lt0 should be betweenLt1 andLt2, and Lt1 andLt2 can be seen to have the same shape. For each line segment, we define the energy function:

contrast mean and the information entropy are much stronger than the original images, which verifies the effectiveness of the Retinex algo- rithm in enhancing the damaged pavement images. However, compared with the algorithm in this study, the performance of the traditional al- gorithm is significantly worse, which not only reduces the amount of information, but also consumes a longer time. The enhancement algo- rithm used in this study effectively improves the contrast and distinction between the non-crack area and the crack line in the damaged pavement image, highlights the crack feature information in the image, and ach- ieves the purpose of facilitating crack line extraction. In a comprehen- sive comparison, the algorithm proposed in this paper still has obvious advantages in the performance of crack image enhancement.

