Single-cell multi-omics methods have enhanced our ability to characterize diverse cell features. However, the dissociation of tissues results in the loss of spatial information. To address this issue, we introduce spatrio, a tool that integrates multi-omics and spatial data to map single cells, explore diverse tissue landscapes, and investigate gene regulation and cell communication at the cellular level. Validation of spatrio using simulations and real data from various tissues has provided spatial insights at the cellular level.

Spatrio takes single-cell multi-omics data and spatial transcriptomics (ST) data as input. Utilizing the optimal transport algorithm and considering gene expression, spatial graph, and modal graph constructed by k-nearest neighbors (k-NN), spatrio computes a probabilistic alignment between cells and spots. This alignment enables spatrio to generate spatial multi-omics data, achieving the deconvolution of spots and reconstruction of multi-omics patterns. Additionally, spatrio's downstream analysis functions enable spatial gene regulation analysis and inference of multi-omics cell-cell communication.

Spatrio constructs a modal graph with a low-dimensional representation of the modality assay and a spatial graph using spatial coordinates. Utilizing fused Gromov-Wasserstein optimal transport, spatrio computes an optimal probabilistic alignment between cells in the single-cell multi-omics data and spots in ST data, minimizing both transcriptional dissimilarity and the difference in graph distance. Spatrio assigns the expected number of cells to each spot based on the alignment results and corrects the cell coordinates based on transcriptional similarity.

Flexible tuning of hyperparameters in spatrio allows the consideration of multiple modalities and location information during alignment, leading to more accurate reconstruction results. This approach is particularly beneficial for addressing the co-existence of spatial heterogeneity and modality differences in cells.

Spatrio also facilitates the exploration of the spatial co-expression distribution of various molecules through spatial feature module analysis. This involves applying the k-NN algorithm to smooth molecular expression and calculating a spatial-weighted expression matrix using a spatial kernel. Feature modules are identified using a consensus clustering algorithm, and the scores of the identified modules can be used for further analysis of spatial regulation and inference of cell-cell interactions based on multi-omics data.

Spatrio demonstrates superior performance compared to other tools, as evidenced by its ability to refine the spatial patterns of irregularly distributed cell populations, preserve the gradient distribution characteristics of various biomolecules among tissue regions, and maintain cell alignment in complex tissue structures.

Furthermore, spatrio is applied to real datasets, accurately identifying cortical layers in mouse cerebral cortex data, mapping major cell types in mouse liver data, and analyzing cell composition differences in human breast cancer data. Spatrio also reveals gene regulatory relationships, high-resolution substructures of cell populations, and modality-specific spatial heterogeneity in these datasets.

Spatrio's approach involves adjusting cell coordinates within each spot, considering gene expression similarity, and utilizing a spatially weighted correlation matrix to detect feature expression modules. It also employs different analytical strategies for cellular communication involving different modalities, such as transcriptome-based and proteome-based analyses.

Ultimately, spatrio's ability to integrate multi-omics and spatial data provides valuable insights into the spatial organization of cells and their communication within complex tissue environments.