Egyptian Informatics Journal 23 (2022) 127–135











A method for generation of substitution box based on random selection
Fırat Artug˘er a,⇑, Fatih Özkaynak b
a Munzur University, Facult of Engineering, Department of Computer Engineering, 62100, Tunceli, Turkey
b Fırat University, Faculty of Technology, Department of Software Engineering, 23119, Elazig, Turkey



a r t i c l e  i n f o 

Article history:
Received 3 January 2021
Revised 5 May 2021
Accepted 18 August 2021
Available online 31 August 2021

Keywords: Block cipher S-box Nonlinearity
Image encryption
a b s t r a c t 

Two basic requirements must be met to encrypt data. These requirements are confusion and diffusion properties. In particular, block cipher algorithms are based on a cryptographic component known as substitution-box to provide the need for confusion. Therefore, attack scenarios generally focus on this cryptographic component. There are alternative design approaches for substitution-box design. It is known that each design approach has several advantages and disadvantages. In this study, an alternative method is proposed to address the problems of the substitution-box design approach based on random selection. The success of the proposed method has been tested in three different scenarios. Analysis results for these three scenarios showed that generated substitution-box provides performance increase for nonlinearity criterion from s-box design criteria. Successful results achieved; It points out that improvement cryptographic components can be used in a variety of practical applications such as block ciphers, masks to prevent side-channel attacks, random number generators, and image encryption algorithms.
© 2022 Published by Elsevier B.V. on behalf of Faculty of Computers and Information, Cairo University.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-
nd/4.0/).





Introduction

The priorities of individuals, societies, and states have been changed with the digital transformation [1]. As a result of this change, information security is an issue that cannot be neglected for everyone [2]. Although information security is an umbrella con- cept, one of the topics associated with this concept (perhaps the first one that comes to mind) is cryptology. There are several alter- natives for encrypting data. A notable among these alternatives is block encryption algorithms. These cryptographic solutions are widely used in ATM devices, biometric passports, and many IoT applications [3]. Two basic requirements must be met for a block cipher algorithm to be considered secure. These requirements are confusion and diffusion. Block cipher algorithms are based on cryp- tographic components known as substitution boxes (s-boxes) to

* Corresponding author.
E-mail addresses: firatartuger@munzur.edu.tr (F. Artug˘er), ozkaynak@firat.edu. tr (F. Özkaynak).
Peer review under responsibility of Faculty of Computers and Information, Cairo University.
provide the need for confusion properties [4]. Therefore, attack sce- narios generally focus on this cryptographic component. Espe- cially; linear and differential attack scenarios on s-box structures have been decisive in the transition from the DES (Data Encryption Standard) to AES (Advanced Encryption Standard [5]. Although the AES s-box design is a very successful example mathematically, diverse cryptanalysis scenarios such as application attacks have revealed various problems. A comparison for s-box design approaches is provided in Table 1 [6].
This study focuses on s-box design method based on random selection. Demonstrating that random selection-based s-box struc- tures can be used as a countermeasure to prevent application attacks played an important role in making this selection. How- ever, it is a serious problem that this design approach has low val- ues for the nonlinearity criterion from the s-box design criteria [7]. Optimization algorithms attract attention as a common approach used recently in the literature to solve this problem [8–11]. Com- putational load in optimization algorithms is another problem that designers have to solve as a disadvantage [12].
The original aspect of this study is that a method has been pro- posed that can be an alternative to approaches based on both mathematical [13–18] and optimization techniques [8–11]. The aim of this study is to overcome the disadvantages of random selection approaches. In the study, s-box structures similar to AES have been generated to increase practical applicability. Any



https://doi.org/10.1016/j.eij.2021.08.002
1110-8665/© 2022 Published by Elsevier B.V. on behalf of Faculty of Computers and Information, Cairo University. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).



Table 1
Comparison for s-box design approaches.
languages work based on bytes, AES s-box structures convert 8- bit length inputs into 8-bit length outputs. To make a fair compar-

Design Approach
Advantages	Disadvantages
ison, therefore, AES-like s-box structures have been generated using a random entropy source in the first step of proposed

Mathematical methods

Optimization Algorithms


Random
Selection
It can best meet design metrics.

The optimization of s-box design criteria can be chosen as the objective function.

It has a simple structure and produces fast results. It does not require complex mathematical transformations.
There are various weaknesses in application attacks.
The computational cost required by the optimization algorithm is high.
It does not provide the most appropriate design metrics that can be achieved.
method. Discrete-time chaotic systems, continuous-time chaotic systems, and classical rand() function can be used as the entropy source. By applying the mode 256 functions to the obtained out- puts, random values are transformed between 0 and 255. Ref.
[21] can be examined for details of this s-box generator program. As an example, generated s-box structure by using this program is shown in Table 2.
As stated before, the AES s-box structure is designed to be resis- tant to differential attacks. Since the highest value is calculated in the XOR distribution table, one of the s-box design criteria associ- ated with the success of differential attacks, this value is desired to be as small as possible. Similarly, it is desired to be as high as pos-

random selection approach can be used to generate AES-like s-box structures. For example, chaos-based random selection designs are very popular approaches in this area. The focus of the study is to improve the nonlinearity value of s-box structures generated by random selection from an entropy source. It has been shown that nonlinearity measurement can be improved by applying the pro- posed post-processing technique.
The rest of the study is organized as follows. In the second sec- tion, the working logic of the proposed method is explained. In the third section, analysis results are given over three different scenar- ios. In the fourth section, a practical application of the obtained outputs is given. In the last section, the results are discussed and possible future studies are given.

Proposed method

The working logic of the proposed architecture is presented in Fig. 1. The method consists of two steps. These steps are the gener- ation of s-box based on random selection and then mixing the positions of the s-box with the proposed approach.
In most general terms, s-box structure is a nonlinear function that maps an m-bit length input to an n-bit length output [19]. This nonlinear structure aims to prevent the success of differential attacks in cryptographic designs. The design technique proposed by Nyberg in the AES s-box is aimed to address differential attacks in the best way [20]. Another advantage of the AES s-box structure is that it has an effective software. Since many programming
sible in the nonlinearity criterion, which is another measurement used to show the complexity of the s-box structure. For the s- box designed by Nyberg [22], the XOR value is 4 and the nonlinear- ity value is 112. However, the deterministic nature of the mathe- matical method has begun to threaten the security of the encryption system as an open point for application attacks such as side-channel analysis [23]. Although random selection-based methods are more resistant to side-channel analysis [24], the most successful results obtained among studies so far have been calcu- lated as 10 for the XOR value and 106.75 for the nonlinearity value. When these values are compared with the AES s-box, the problem becomes more obvious. This comparison is given in Table 3. One method that can be used for performance improvements of ran- dom selection-based designs is optimization algorithms. However, in these designs, the processing load due to optimization algo- rithms is also a disadvantage.
The method suggested in this study has a simpler and faster structure than optimization algorithms. The method aims to increase the value of the nonlinearity criterion without sacrificing simplicity and speed. To achieve this aim, it is proposed to mix row, column, and both s-box structures. It has recently been shown that performance metrics can be improved by changing the posi- tions of s-box cells [25]. The post-processing technique suggested in this study is to be further improved through DES s-box struc- tures. In the method suggested previously, a new s-box structure is generated from each original s-box structure with the post- processing technique. The advantage of this work over than




Fig. 1. General overview of proposed architecture.

A sample s-box structure based on random selection.



Table 3
Performance comparison for AES and random selection s-box.

S-box	Nonlinearity	Bit Independence Criterion




Strict Avalanche Criterion	Maximum I/O XOR



previous is that 96 different s-box structures can be obtained from each original s-box. Because DES s-boxes consist of eight tables in 4*16 dimensions. Values between 0 and 15 in each row are mixed with DES s-box designs [5]. A total of 32 different mixing tables are given in Table 4.
For example, by using the first row of Table 4, the rows of the s- box structure given in Table 2 can be shuffled. To be able to express it more clearly, the operation of the method is shown in Fig. 2. Since the first value in the first row of Table 4 is 14, so row14 of the original table has been replaced as row0 in the derived new table. As a result of all these displacements, the new derived s- box structure in Table 5 has been generated.

Analysis results

There are five basic criteria for evaluating the success of an s-box structure. Among these criteria, the XOR distribution and nonlinearity criteria have been explained in the second section. Other criteria are known as bijective, SAC, and BIC criteria. For more details on these criteria, Ref. [6,19,22] can be examined. The s-box design criteria for derived 32 s-box structures obtained as a result of mixing the rows of the s-box structure in Table 2 according to the values in Table 4 are given in Table 6.
Similarly, the s-box design criteria for the newly derived 32 s-box structure obtained as a result of the replacement of the columns of the original s-box structure in Table 2 using the values in Table 4 are given in Table 7.
The analysis results for the 32 s-box structure obtained as a result of changing the positions of the rows first and then the columns are given in Table 8.
The values given in Tables 6, 7, and 8 are new s-boxes derived from the original s-box structure in Table 2. To evaluate the success of the proposed method more generally, one hundred random s- box structures have been generated, then 96 different s-boxes
were produced from each table for three different approaches and the analysis results were tested. According to the test results, it has been observed that there is an increase of 81.25% of s-boxes in row-based mixing, 91.6% in column mixing, and 75% in row- column mixing according to the test results.

A practical application of the proposed method

Billions of digital content are transferred, processed, and stored every day from one point to another with the widespread use of 5G technology [26]. Ensuring the security of this valuable content has become increasingly important with the increasing demand. To meet this demand, many image encryption algorithms have been proposed in recent years [27–29]. In this section, a practical appli- cation is tried to be given by showing how the outputs can be used in an image encoding algorithm. However, designing an encryption algorithm is not an easy process [30–34]. It has been observed that many proposals can be easily broken without following specific design guidelines and carrying out comprehensive cryptanalysis. An improved version of the image encryption algorithm in Ref.
[35] is proposed in this section. The image encryption algorithm is presented in Ref. [35] uses robust components of modern cryp- tology. In this way, the provable secure design approach has been used. By using the proposed s-box structures in this study, it has been shown that the keyspace of the encryption algorithm can be increased by using more than one s-box structure instead of just a single s-box structure. The flowchart detailing the operation of the improved image encryption algorithm is given in Fig. 3.
A sample test image and its encrypted version are given in Fig. 4.
Histogram analysis for the original and encrypted image is shown in Fig. 5.
Although all these statistical analyzes indicate that the pro- posed image encryption algorithm is working successfully, it is

DES s-box structures.






Fig. 2. Operation step of proposed method.

New s-box structure derived from s-box in Table 2.






Table 6
Performance analysis of s-boxes derived from original s-box using row shuffling.




not sufficient in terms of a cryptology point of view [36,37]. For details on the provable security analysis of the algorithm, Ref.
[35] can be viewed.

Conclusion

One of the main reasons behind the widespread use of electronic commerce is undoubtedly the provable security pro-
mise of cryptographic algorithms. However, advances in the cryptanalysis branch together with technological developments constantly threaten the security of modern encryption algo- rithms. Although modern encryption algorithms are mathemat- ically secure, application attacks have revealed that various weaknesses may exist. One of the cryptographic components affected by the application attacks has been s-box structures. The demonstration that s-box structures generated based on


Table 7
Performance analysis of s-boxes derived from original s-box using column shuffling.




Table 8
Performance analysis of s-boxes derived from original s-box using row/column shuffling.





Fig. 3. Improvement version of image encryption algorithm.






Fig. 4. Outputs of improvement image encryption algorithm.
mathematical techniques are more vulnerable to side-channel attacks compared to random selection-based designs, brings to mind the question of how the design criteria of s-box structures generated based on random selection can be improved. In this study, a method that serves this purpose is proposed.
It has been observed that the proposed method provides signif- icant performance improvements in s-box structures with below- average performance characteristics. It has been shown that derived s-box structures can be obtained from the original s-box structure for three different scenarios. It has been observed that design criteria can be improved by 81.25% in row transformations, 91.6% in column transformations, and 75% in row-column transfor- mations. Considering these results, mixing the columns has been particularly effective. These results indicate that the success of ran- dom selection-based approaches can be further improved by using different techniques and methods in future studies.




Fig. 5. Histogram analysis of images in Fig. 4.



Declaration of Competing Interest

The authors declare that they have no known competing finan- cial interests or personal relationships that could have appeared to influence the work reported in this paper.

Acknowledgment

This study was supported in part by the Firat University Scien- tific Research Project under Grant TEKF.20.21.

References

Keshta I, Odeh A. Security and privacy of electronic health records: concerns and challenges. Egypt Inform J 2021;22(2):177–83.
Elshabka MA, Hassan HA, Sheta WM, Harb HM. Security-aware dynamic VM consolidation. Egypt Inform J 2021;22(2):277–84.
B. Soewito, Y. Marcellinus, IoT security system with modified Zero Knowledge Proof algorithm for authentication, Egyptian Informatics Journal, 2021;22 (3):269–276.
C. Paar, J. Pelzl, Understanding cryptography. Berlin, Heidelberg: Springer Berlin Heidelberg, 2010. 10.1007/978-3-642-04101-3.
L. R. Knudsen, M. Robshaw, The block cipher companion, 2011, Springer.
Cusick T, Stanica P. Cryptographic boolean functions and applica- tions. Amsterdam, The Netherlands: Elsevier; 2009.
Özkaynak F. Construction of robust substitution boxes based on chaotic systems. Neural Comput & Applic 2019;31:3317–26. doi: https://doi.org/ 10.1007/s00521-017-3287-y.
Hematpour N, Ahadpour S. ‘Execution examination of chaotic S- box dependent on improved PSO algorithm. Neural Comput Appl. Aug. 2020. doi: https://doi.org/10.1007/s00521-020-05304-9.
Ahmad M, Khaja IA, Baz A, Alhakami H, Alhakami W. Particle swarm optimization based highly nonlinear substitution-boxes generation for security applications. IEEE Access 2020;8:116132–47. doi: https://doi.org/ 10.1109/ACCESS.2020.3004449.
Tanyildizi E, Ozkaynak F. A new chaotic S-Box generation method using parameter optimization of one dimensional chaotic maps. IEEE Access 2019;7:117829–38. doi: https://doi.org/10.1109/ACCESS.2019.2936447.
Ahmad M, Al-Solami E, Alghamdi AM, Yousaf MA. Bijective S-boxes method using improved chaotic map-based heuristic search and algebraic group structures. IEEE Access 2020;8:110397–411. doi: https://doi.org/10.1109/ ACCESS.2020.3001868.
M.Ș. Açıkkapı, F. Özkaynak, A method to determine the most suitable initial conditions of chaotic map in statistical randomness applications in IEEE Access, 10.1109/ACCESS.2020.3046470.
Gao W, Idrees B, Zafar S, Rashid T. ‘Construction of nonlinear component of block cipher by action of modular group PSL(2, Z) on projective line PL(GF
(28))’. IEEE Access 2020;8:136736–49. doi: https://doi.org/10.1109/ ACCESS.2020.3010615.
Razaq A, Ullah A, Alolaiyan H, Yousaf A. ‘A novel group theoretic and graphical approach for designing cryptographically strong nonlinear components of
block ciphers. Wireless Pers Commun. Oct. 2020. doi: https://doi.org/10.1007/ s11277-020-07841-x.
Ahmad M, Al-Solami E. Evolving dynamic S-boxes using fractional-order hopfield neural network based scheme. Entropy Jun. 2020;22(7):717.
Mahmood Malik MS, Ali MA, Khan MA, Ehatisham-Ul-Haq M, Shah SNM, Rehman M, Ahmad W. Generation of highly non- linear and dynamic AES substitution-boxes (S-boxes) using chaos-based rotational matrices. IEEE Access 2020;8:35682–95. doi: https://doi.org/10.1109/ACCESS.2020.2973679.
Siddiqui N, Khalid H, Murtaza F, Ehatisham-Ul-Haq M, Azam MA. A novel algebraic technique for design of computational substitution-boxes using action of matrices on Galois field. IEEE Access 2020;8:197630–43. doi: https:// doi.org/10.1109/ACCESS.2020.3034832.
N. Siddiqui, F. Yousaf, F. Murtaza, M. Ehatisham-Ul-Haq, M.U. Ashraf, A.M. Alghamdi, A.S. Alfakeeh, ‘A highly nonlinear substitution-box (S-box) design using action of modular group on a projective line over a finite field,’ PLoS ONE, vol. 15, no. 11, Nov. 2020, Art. no. e0241890, 10.1371/journal.pone.0241890.
Wu C, Feng D. Boolean functions and their applications in cryp- tography. Berlin, Germany: Springer; 2016.
Daemen J, Rijmen V. The design of rijndael the advanced encryption standard (AES). Springer; 2020.
F.Özkaynak, An analysis and generation toolboxfor chaotic substitution boxes: A case study based on chaotic labyrinth rene thomas system, Iranian J. Sci. Technol., Trans. Electr. Eng., vol. 44, no. 1, pp. 89–98, Mar. 2020, 10.1007/ s40998-019-00230-6.
K. Nyberg, Differentially uniform mappings for cryptography, inProc. Eurocrypt, in Lecture Notes in Computer Science, vol. 765. Berlin, Germany: Springer, 1994, pp. 55–64.
S.B. Ors, B. Preneel, I. Verbauwhede, Side-channel analysis attacks on hardware implementations of cryptographic algorithms, in Wireless Security and Cryptography-Specifications and Implementations. Boca Raton, FL, USA: CRC Press, 2007.
Acikkapi MS, Ozkaynak F, Ozer AB. ‘Side-channel analysis of chaos-based substitution box structures’. IEEE Access 2019;7:79030–43. doi: https://doi. org/10.1109/ACCESS.2019.2921708.
F. Artug˘ er, F. Özkaynak, A novel method for performance improvement of chaos-based substitution boxes, Symmetry, vol. 12, no. 4, p. 571, Apr. 2020.
Shareef FR. A novel crypto technique based ciphertext shifting. Egypt Inform J 2020;21(2):83–90. doi: https://doi.org/10.1016/j.eij.2019.11.002.
Ge M, Ye R. A novel image encryption scheme based on 3D bit matrix and chaotic map with Markov properties. Egypt Inform J 2019;20(1):45–54. doi: https://doi.org/10.1016/j.eij.2018.10.001.
Abdul N, Abbas M. Image encryption based on independent component analysis and Arnold’s cat map. Egypt Inform J 2016;17(1):139–46. doi: https:// doi.org/10.1016/j.eij.2015.10.001.
Khan JS, Boulila W, Ahmad J, Rubaiee S, Rehman AU, Alroobaea R, Buchanan WJ. DNA and plaintext dependent chaotic visual selective image encryption. IEEE Access 2020;8:159732–44. doi: https://doi.org/10.1109/ ACCESS.2020.3020917.
Muhammad ZMZ, Özkaynak F. Security problems of chaotic image encryption algorithms based on cryptanalysis driven design technique. IEEE Access 2019;7:99945–53. doi: https://doi.org/10.1109/ACCESS.2019.2930606.
C. Li, When an attacker meets a cipher-image in 2018: A year in review, 2019, arXiv:1903.11764. [Online]. Available: https://arxiv. org/abs/1903.11764.
Xie EY, Li C, Yu S, Lü J. On the cryptanalysis of Fridrich’s chaotic image encryption scheme. Signal Process. Mar. 2017;132:150–4.



Zhang LY, Liu Y, Pareschi F, Zhang Y, Wong K-W, Rovatti R, Setti G. On the security of a class of diffusion mechanisms for image encryption. IEEE Trans. Cybern. Apr. 2018;48(4):1163–75.
W. Feng, Y.-G. He, ‘Cryptanalysis and improvement of the hyper- chaotic image encryption scheme based on DNA encoding and scram- bling, IEEE Photon. J., vol. 10, no. 6, Dec. 2018, Art. no. 7909215. 10.1109/JPHOT.2018.2880590.
Muhammad ZMZ, Ozkaynak F. An image encryption algo- rithm based on chaotic selection of robust cryptographic primitives. IEEE Access 2020;8:56581–9. doi: https://doi.org/10.1109/ACCESS. 2020.2982827.
Wu Y, Noonan JP, Agaian S. NPCR and UACI randomness tests for image encryption. Cyber journals: multidisciplinary journals in science and technology. J Selected Areas Telecommunications (JSAT) 2011:31–8.
F. Özkaynak, Role of NPCR and UACI tests in security problems of chaos based image encryption algorithms and possible solution proposals, 2017 International Conference on Computer Science and Engineering (UBMK), Antalya, 2017, pp. 621-624, 10.1109/UBMK.2017.8093481.
