Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 335 (2018) 91–112
www.elsevier.com/locate/entcs

Survival of the Fattest: Evolutionary Trade-offs in Cellular Resource
Storage
Guillaume Terradota,1,2 Andreea Beicab,3 Andrea Weißea,4 Vincent Danosb,5
a School of Informatics University of Edinburgh Edinburgh, United Kingdom
b D´epartement d’Informatique E´cole Normale Sup´erieure Paris, France

Abstract
Cells derive resources from their environments and use them to fuel the biosynthetic processes that determine cell growth. Depending on how responsive the biosynthetic processes are to the availability of intracellular resources, cells can build up different levels of resource storage. Here we use a recent mathematical model of the coarse-grained mechanisms that drive cellular growth to investigate the effects of cellular resource storage on growth. We show that, on the one hand, there is a cost associated with high levels of storage resulting from the loss of stored resources due to dilution. We further show that, on the other hand, high levels of storage can benefit cells in variable environments by increasing biomass production during transitions from one medium to another. Our results thus suggest that cells may face trade-offs in their maintenance of resource storage based on the frequency of environmental change.
Keywords: metabolites, storage, mechanistic cell models, evolutionary strategies, gene regulation, cell physiology

Introduction
Growing cells have to constantly balance the uptake of extracellular resources with the intracellular demands of biosynthetic processes. Depending on how they co- ordinate uptake and consumption cells can adapt the build up, or storage, of in-

1 Thanks to Ilias Garnier and Sebastian Jaramillo-Riveri. The research reported in this paper was partly funded by the ERC Project RULE/320823.
2 Email: G.P.A.Terradot@sms.ed.ac.uk
3 Email: andreea.beica@ens.fr
4 Email: andrea.weisse@ed.ac.uk
5 Email: vincent.danos@ens.fr

https://doi.org/10.1016/j.entcs.2018.03.010
1571-0661/© 2018 The Author(s). Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

tracellular resources. Storage has been proposed as an evolutionary strategy to cope with variable environments, by storing the gains of favourable environmental periods to survive unfavourable ones. The so called ‘storage effect’ was originally proposed to explain behavioural diversity [5]. Under the assumption that no one strategy can perform best in all environmental conditions, it explains coexistence of diverse responses in fluctuating environments and counters the competitive ex- clusion principle, which states that two species exploiting the same set of resources cannot coexist in a closed environment [13]. Here we investigate how cellular con- straints bear on the evolutionary success of various storage strategies in terms of cell growth.
To grow, cells have to perform different tasks that are each carried out by differ- ent proteins. These proteins can be roughly classified into enzymes, which take up extracellular resources and convert them into biosynthetic precursors, biosynthetic proteins, most notably the ribosomes, which are responsible for protein production itself, and other house-keeping proteins (cf. Fig. 1). Bacterial cells are known to adapt their allocation of available resources to produce the different proteins de- pending on their growth media [8,14], which allows them to maximise their growth rate in a given (constant) environment [19,17]. Previous modeling work has shown that during environmental up-shifts, i.e. transitions to a more favourable growth medium, a near-optimal control strategy (in terms of growth rate maximisation) to reallocate cellular resources can be attained by sensing the concentrations of im- mediate precursors to protein synthesis [12]. In our study of cellular storage we therefore focus on resources that are immediate precursors to protein synthesis.
We base our analysis on a recent model [22] that determines growth in terms of coarse-grained cellular mechanisms. The mechanisms considered comprise re- source uptake and conversion into cellular precursors, and how the latter fuel pro- tein biosynthesis and thus growth. Importantly, the model predicts growth rate from the way cells allocate their resources to the production of different types of proteins. We start with a brief review of the model from [22]. We then define a generic scaling transformation of Chemical Reaction Networks (CRNs) that allows one to tune the concentration of one chemical species while preserving this CRN’s behaviour at stationary state. We apply this scaling in the cell model to the protein precursor in order to tune storage capacity. We then go on to show that within our framework (i) storage of our protein precursor is detrimental to exponential growth rate, (ii) that storage capacity can be modulated over several order of mag- nitudes without affecting exponential growth rate, (iii) the cost of storage, in terms of reduced growth, is condition-dependent and higher in rich growth conditions,
(iv) storage results in smoother physiological transitions during environmental up-
shifts and increases biomass during such transitions, and (v) evolutionary benefits of storage increase with the frequency and magnitude of environmental fluctuations.

Review of the cell model:
In the following we revisit the cellular growth model from [22] with a schematic shown in Fig. 1. We provide the parameters we used for simulations in the ap- pendix B. The model recapitulates the allocation of cellular resources to different




Fig. 1. Schematic of the cellular growth model considered (adapted from Ref. [22]). Four types of proteins are considered: et are transporters, em are metabolic enzymes, r are ribosomes and q are house-keeping proteins, the function of which is not accounted for in the model. External sugar s is imported into the cell by the transporters et, internalised sugar si is processed into proteins precursor a by the metabolic enzymes em, see reactions (r1,r2). Messenger RNAs (mRNAs) are produced through transcription, see reactions (r3,r4). Dashed arrows indicate that the transcription rates depend on a’s concentration but do not consume it. mRNAs mx compete for the same pool of ribosomes and bind them to form mRNA-Ribosome complexes cx, see reaction (r5). mRNA-Ribosome complexes incorporate a to produce the protein x, see reaction (r6).
The growth rate is defined as the rate at which cells reproduce their own proteic mass, see reaction (r7).


functions in different growth media. Units of the 14 model variables are expressed in: numbers of molecules per 108 units of proteic mass. One unit of proteic mass corresponds to one amino acid polymerised within a protein. Four classes of genes are represented. Housekeeping proteins q, the function of which is not represented in the model, account for roughly half of the cell proteic mass across different growth conditions [19]. This relatively constant level of expression is achieved in the model through a negative auto-regulation of their gene expression. Ribosomes r are the sole proteins capable of protein production and are thus necessary in order to repli- cate the mass. We show now the different reactions taking place in the cell model and their associated rate functions.

Nutrient Uptake:
Transporters t import extracellular nutrients s into the cell. Metabolic enzymes m transform imported nutrients si into a metabolite a with a stoichiometry ns. The stoichiometry represents the quality of the medium, i.e. the yield of a from s. A biological interpretation of ns is that it is a measure of how many metabolic steps or anabolic effort are/is needed by a cell to turn the nutrients present in the envi- ronment into protein precursors. The higher ns, the less metabolic work is needed. This translates in the model into a higher yield of a from si for the same metabolic enzyme number. The transport and metabolic reactions write respectively as:
νimp(t)
s −−−−→ si,	(r1)
νcat(m)
si −−−−−→ ns · a,	(r2)


with the rates given by

 vt s 
ν	= t ·	,	(f )

imp
Kt + s	1

 vm si 
ν	= m ·	.	(f )

cat
Km + si	2

Transcription:
mRNAs convey genetic information from DNA to the ribosomes. In model there is one type of mRNA mx for each gene x ∈ {r, t, m, q}. Let ωx be the transcrip- tion rate of mx and d the degradation rate, assumed to be identical for all mx. Production and consumption are described by the following reactions:

∅ −ω→x
mx −→d
mx	(r3)
∅	(r4)

ATP is the main energy currency for most cellular processes. Transcription has been estimated to cost ≈ 20 times less ATP than translation [16]. RNA polymerases are the proteins responsible for transcription. In E.coli, their mass fraction is ten times smaller than that of the ribosomes [3]. We assume that in comparison to translation, the cost of transcription is negligible, both in terms of energetic cost and proteins. Therefore in the model transcription is assumed to be free of any cost: (i ) no proteins are needed to produce them, (ii ) their production doesn’t consume metabolites. However, the mRNA transcription rate depends on the amount a of protein precursors as follows:
  wx 
ω (a)=	,	∀x ∈ {t, m, q},	(f )
x	θx	3
+1 
a



ω (a)=		wq q	θq
 +1 
a
· I(q),	with	I(q)=	q


Kq
1
 αq
.	(f3)
+1 

In order to fit experiments measuring the ribosomal mass fraction and the growth-rate in different growth-conditions from [19], the transcriptional threshold of the ribosomes θr must be such that θr  θx,  ∀x ∈ {t, m, r}. Consequently, for high values of the protein precursor a, the composition of the transcriptome shifts to one that accommodates more ribosomal mRNAs. This regulation mechanism ensures the balance between a production and a consumption. Indeed, it promotes the consuming processes (ribosome-dependent) when a is high and the production processes (metabolic/transporter-dependent) when a is low.

Competitive binding:
The different types of mRNAs mx compete for the same pool of free ribosomes r in order to form the mRNA-ribosome complex cx. We assume that the different mRNAs mx have the same binding constant for the ribosomes kb and that cx have the same dissociation constant ku:

k
r + mx →→ cx	(r5)
ku

Translation:
The metabolite a is the precursor for synthesising new proteins. The mRNA- ribosome complexes cx consume a to produce the corresponding protein x and after completion of one translation reaction, the mRNA-ribosome complex cx dissociates into mx and r:
ν
cx + nx · a −→ r + x + mx.	(r6)
Here nx denotes the amount of a required to produce one protein x and the rate of translation νx is:
γ(a)	γmax
ν  = c ·	,	with	γ(a)=	,	(f )
x	x	n	K	6
+1 
a
where γ(a) is the rate of elongation per translating ribosome (a incorporated per unit of time per cx complex), see [22] for a derivation.

Growth:
All intracellular species x get diluted due to growth at rate λ, i.e.


xi −→λ
∅.	(r7)

The growth rate λ is defined as the proteic mass produced per unit of time relative to the typical mass M of an exponentially growing cell, or in other words, the rate at which a cell reproduces its own mass:
λ = Σx νx · nx .	(f )

At stationary state, the equality between the parametrized mass M and the total proteic mass is verified: M = Σx nx · x + nr · Σx cx.
Formal Definition of Storage Capacity
The storage capacity in the model is defined as a scaling factor of the protein precursor amount a at stationary state. We propose here a formal definition of the scaling procedure we perform in order to tune the storage capacity without impacting on the cell model behaviour. We then show how to apply this scaling procedure to reactions following different types of kinetic rate functions: Mass- Action, Michaelis-Menten or Hill. We also apply the scaling to a model of a toggle- switch - a synthetic, bistable gene-regulatory network - published in [11] and show that it behaves as expected from our analysis.
Definition 3.1 A chemical reaction network (CRN) is a tuple A = ⟨S, R, f, κ⟩, where:
S = {S1,..., Sn} is a finite set of species; the state of CRN A can be represented as a multiset of the species’ concentrations, denoted by x = (x1,..., xn) ∈ Rn
R = {r1,..., rr} is a finite set of reactions, each reaction being a pair rj ≡

(yj → yj ) ∈ Zn  × Zn	(yj and yj
are respectively the consumption and

j	≥0	≥0	j
production vectors of reaction rj)
f = {f1,..., fr} is the set of rate functions describing the chemical kinetics of the reactions; each such function fj is parametrized by κj, the set of reaction rate constants associated with reaction rj : ∀rj ∈ R, fj(x; κj) denotes the kinetic law of reaction rj (e.g.: mass action, Michaelis-Menten,etc)
More precisely, reaction rj is written down in the following form:

fj (x;κj )	j	j


Define δij = yj
y1jS1,..., ynjSn −−−−−→ y1j S1,..., ynj Sn.
— yij; ∀Si ∈ S, rj ∈ R.

Then the (deterministic) dynamics of species Si in CRN A in state x is given
by:
 dASi | x = Σr	δijfj(x; κj)
Definition 3.2 Let A = ⟨S, R, f, κ⟩ be a CRN and Si ∈ S a species we want
to scale.	Define dα,i : Rn	n , the state expansion of species Si, as
dα,i(x1,..., xi,..., xn) = (x1,..., αxi,..., xn).	Then A is said to be scalable
along species Si, if the reaction kinetics allows rescaling, that is to say if for any

rescaling factor α in R>0, and for any reaction rj in R, there exists κj
such that

fj(x; κj)= fj(dα,i(x); κj ).
The condition ensures that the initial reaction fluxes can be retrieved through the scaling of the rates of reactions containing the species of interest (Si). Evidently,

if Si is not a reactant species of rj, there is no need for scaling and one can simply take κj = κj.
We note that the scaling is parametrized by reactions, rather than reaction rates. In models where a reaction rate name κ appears in several reactions, what is scaled is κ’s value in a certain reaction rj, rather than a scaling of its value across every reaction it appears in. In terms of model variables, it can be interpreted as every κj being defined locally in reaction rj, rather than globally (i.e., across the whole model).
Definition 3.3 Let A = ⟨S, R, f, κ⟩ be a CRN that is scalable along species Si ∈ S. We define the scaling of A along species Si by a factor of α as follows:
α,Si	j


where each κj
A = ⟨S, R, f, κ⟩ −−→ ⟨S, R, f,κ ⟩ = B,
satisfies the condition of Def. 3.2.

A multi-species scaling of a CRN can be achieved by sequentially applying the transformation described above, along different species.
Theorem 3.4 Let A = ⟨S, R, f, κ⟩ be a CRN scalable along Si ∈ S, and let B be
α,Si
its scaling according to the transformation of Def. 3.3: A −−→ B. Then:



∀x = (x ,...,x ) ∈ Rn

, ∀S
∈S :  dASi | x  =  d5Si | d

(x)	(1)


Proof of Theorem 3.4 is obtained directly via the definition of the network dy- namics in Def.1, and the scalability condition.
α,Si
Corollary 3.5 If A scalable along Si, A −−→ B, and x is a steady state of A, then
dα,i(x) is a steady state of B.
We note that neither Theorem 3.4, nor its corollary should be interpreted as meaning trajectory homothety, but rather steady state equivalence, as can be observed in Fig. 2.

We now show how to apply the scaling transformation for the most commonly used kinetic laws:
if reaction rj has a mass action kinetics: fj(x; κj)= κj ·  xykj , the reaction
the scaling: fj(x; κj)= fj(dα,i(x); κj )
if reaction rj has a Michaelis-Menten kinetics: fj(xi; vmax, KM )= vmax·xi , the

reaction rates scale to vj
= vmax and Kj
= αKM , s.t. the reaction dynam-

ics remains unchanged after the scaling: fj(xi; vmax, KM )= fj(αxi; vj	, Kj )
vmax·xn

if reaction rj has a Hill kinetics: fj(xi; vmax
, n, Kh) =	n	i , the reaction
h

rates scale to nj = n, vj
= vmax and Kj
= αKh, s.t. fj(xi; vmax, n, Kh) = 

Plot the evolution of proteins’ concentrations across time
20
[A] original model
18	[A] scaled model
2−homothety
16	[B] original model
scaled model
14

12

10

8

6

4

2

0
0	2	4	6	8	10
Time (units)

1∗[A]	2∗[B]
Fig. 2. Simulation of a simple CRN (A ————→ ∅; B ————→ ∅) and its scaling along species A, by a factor of
2. As stated by our theorem, the dynamics of species B remains unchanged. The trajectory of the scaled species is not homothetic to the original trajectory (homothety plotted in red, for comparison), but rather the two models (original and scaled) exhibit steady state equivalence.
fj(αxi; vj	, nj, Kj ). A concrete example of the results of scaling such a rate
function is given in Fig. 3.
Example 3.6 Consistent with the notations used in Theorem 3.4, consider a CRN
A =< {a∗, b}, {r1, r2}, {f1, f2}, {k1, k2} >, with reactions:


f1(k1)
r1 : ∅ −−−−→ a
∗ f2(a∗;k2)
(E1)

r2 : a −−−−−→ b
and mass-action kinetics:
f1(k1)= k1
f2(a∗; k2)= k2 · a∗


meaning that:

⎧⎨ dAa∗ | (a∗, b)	= f − f




= k − k


· a∗

α,a∗	∗	j	j
Construct A −−−→B =< {a , b}, {r1, r2}, {f1, f2}, {k1, k2} >, with:

3.5


3


2.5


2


1.5


1


0.5
0	10	20	30	40	50
Time (mins)

Fig. 3. An example of scaling a Hill-kinetic rate function: simulation of the toggle switch (model adapted from [11]) before and after scaling species A by a factor of 3. The genetic toggle switch is a synthetic, bistable gene-regulatory network, composed of two repressors: proteins A and B, and two constitutive promoters. Each promoter is inhibited by the repressor which mRNA is transcribed from the opposing promoter. The
concentrations of proteins A and B are denoted by [A] and [B]. The plotted ratio is the concentration of a protein in the rescaled model divided by the concentration of the same protein in the non rescaled model. As expected, the rescaling preserves the stationary state value of [B] (ratio is equal to 1) while rescaling by 3 the stationary state value of [A]. Note that even though the stationary state values for [A] and [B] are preserved by the rescaling, it is not necessarily the case for transitions. The description of the model and
the parameters used for the simulations are given in the appendix A.



f1(k′ )
r1 : ∅ −−−−→ a
f2(αa∗;k′ )
j : a∗ −−−−−−2→ b


and mass-action kinetics.
Then we can scale the reaction rates using

j
1
kj = k2

, which satisfies Eq. (1)

2	α
of Theorem 3.4.
Example 3.7 Consider the same two CRNs as above, but for which reaction r2
follows a Michaelis-Menten kinetics:

f2(a∗; v, KM )= 
K
v · a∗
+ a∗	(E2)




Once again, scaling the reaction rates using
 Kj
= αKM

, satisfies Eq. (1)

vj = v

of Theorem 3.4.

Metabolite storage slows down exponential growth rate
Storage capacity in the growth model:
We adjust the stationary state concentration of the proteins precursor a following the method presented in the previous section. For convenience we denote with ∗ the reference parameters and concentrations, i.e. their values when α = 1. We list the reaction rates in which a is an input and scale the parameters so that model’s behaviour is preserved:
Consumption of a by translation follows a Michaelis-Menten kinetics, see rate (f6). Following example (E2), we scale the affinity of the ribosome for a when translating proteins by α: Kγ = α · K∗.
Transcriptional rate ωx also follows Michaelis-Menten kinetics, see rate (f3). Therefore we scale the transcriptional thresholds by α: θx = α · θ∗.
We verify that at exponential growth, the scaling {a = α · a∗, Kγ = α · K∗,
θx = α · θ∗} preserves the model’s behaviour:
Or in other words that the consumption of a by translation c · γ(a) is indepen- dent of the storage capacity α:
a = α · a∗	⇒	c ·  γmax  = c · 	γmax	 ,	(2)

 K∗
+1 
a∗
 α · K∗
+1 
a

where c =	x cx is the concentration of ribosome-mRNA complexes and γmax
is the maximal translation rate per ribosome.
And that mRNA production rate for each gene x at exponential growth is invariant to the storage capacity α:
a = α · a∗	⇒	 wx  = 	wx	 .	(3)

 θ∗
+1 
a∗
 α · θ∗
+1 
a

Not all of the model behaviour is preserved though, since perfect preservation would require rescaling the growth rate λ, too. However, our growth rate is an emergent property of the model, resulting from the overall production of proteins, and affects all intracellular species through dilution. In our analysis it therefore would not make sense to modify this rate in the same way as the above parameters that affect the coordination of different processes. The rate λ is shared by many reactions involving all the species of the model. Therefore the effect scaling of λ would propagate to every species’ degradation rate.
We now show that the species scaling expression a = αa∗ can also be considered

as an emergent property of the system at steady state, provided that M   a:
da
= ns · vcat − γ(a) · c − λ · a =0 ⇒ c · γ(a)= ns · vcat − λ · a	(4)
dt
We also know that:


c · γ(a)
λ =
M
⇒ c · γ(a)= λ · M	(5)



From equations (4) and (5), we deduce that:
λ(a)= ns · vcat
M + a


(6)

which implies that increasing the storage capacity α leads to a decrease in the exponential growth rate.
Let us assume M   a and M   αa∗.

Because:
n · v
n · v

λ(a)=  s	cat ≈  s	cat = λ(a∗)	(7)
M + a	M + a∗
and Eq. (4) + Eq. (7) ⇒ a ≈ α · a∗	2
We note that M = 108 is large and 1 < a∗ < 10. As long as M  α · a∗ the exponential growth rate remains unaffected, and so do the other model variables. The fluxes of all reactions thus remain unchanged as long as M  α · a∗, along with the steady state proteic composition and the exponential growth rate.
Note that the rescaled parameters are not strongly constrained by experimen- tal measurements. Indeed, they were initially obtained by fitting the model on experimentally observed cell physiological states in different growth conditions, at stationary state [22]. Therefore, as long as modulating the storage capacity doesn’t affect the model’s abilities to reproduce these measurements, the rescaled parame- ters are equally constrained than they were in the absence of rescaling.

Remark:
In our analysis we assumed so far that a does not contribute to the mass. If we assume otherwise, the total mass of the new cell model, call it MN , writes: MN = M + a, where M =  x nx · x + nr ·  x cx is the mass of the cell model in which a does not contribute to the mass. For such a model the impact of the storage capacity α on the growth rate λN , see Eq. (6), becomes:
  ns · vcat			ns · vcat	
λ	=	=
N	MN + α · a∗	M +2 · α · a∗
Although this shall quantitatively change the impact of tuning the storage ca- pacity, the qualitative conclusions of the analysis that we lead further will likely remain unchanged.

The cost of high storage capacity:
We denote the total amount of mRNA-Ribosome complexes by c =  x cx. We can consider the cost of storage in terms of the fraction of the resource a that, rather than being used for biomass production is diluted through the increase in cell volume

λ · a
α · a∗

η(α)= λ · a + γ · c ≈ M + α · a∗ .	(8)
If one a molecule is to be invested at time t0 into biomass production its contribution to growth is 1/M0, where M0 is the amount of resources a necessary to invest in order to replicate the entire cell. If the same a molecule is to be invested at a later time t1 > t0 and if the growth rate is positive, meaning that the mass of the cell at t1 is M1 > M0, then the contribution of one a molecule to growth of the biomass 1/M1 decreases: 1/M1 < 1/M0. Consequently, the sooner after its production a molecule a is invested into growth of the mass, the more it contributes to growth rate, and the higher the storage capacity the longer is the time between production and consumption of an a.

The cost of storage depends on the richness of the environment:
According to our model [22], the richer the medium, parameterised in the model by the nutrient quality ns, the higher the concentration of metabolites a available for translation. This is also observed experimentally by an increase of the tRNA concentration [9], leading to an increase of the ribosomal translation rate [3,7,24,18,15]. From Eq. (8) thus follows that higher a concentrations are increasing the cost of a high storage capacity, also shown via simulations in Fig. 4. Rich environments therefore impose evolutionary pressure on cells to have a low storage capacity.
We have shown that storage capacity can be modulated over several orders of magnitude without significantly affecting the exponential growth rate of our cell model. Consequently, cells may tune their storage capacity within that range in order to maximize their biomass production in fluctuating environments without impairing their ability to produce biomass in absence of these fluctuations. We show in the next section how variations in the storage capacity affect our cell model biomass production upon environmental fluctuations.

Metabolite storage can allow faster adaptation to en- vironmental fluctuations
Storage capacity affects growth during environmental transitions:
Cells adjust their resource allocation depending on which medium they grow in. In bacteria for example, the ribosomal content increases as the medium gets more favourable to growth [8]. These adjustments are necessary in order to adapt biomass production in different growth conditions [19,22]. But the reallocation of cellular resources to different functions is not instantaneous, as it is constrained


1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1

0
4	5	6

log 7 ()
10

8	9	10


Fig. 4. The model is simulated for increasing storage capacity α for three different environments (ns = 0.08, 0.20 and 0.5). We denote by λ0 the growth rate obtained when the storage capacity is α =1 for any given ns. The relative growth rate λ/λ0 is then the growth rate obtained for a given storage capacity α relative to the growth rate when α = 1. The relative growth rate decreases as the storage capacity α increases. The faster a cell grows, the more storage is detrimental to growth.


by the cellular mechanisms that sense and regulate the different processes, with potential implications for the biomass production during environmental transitions [6,4]. A common assumption is that, on evolutionary time scales, cells seek to optimise their mean biomass production over time, which means that they also seek to optimise the dynamics of the transition between different physiological states such that the biomass production over time is maximised. We analyse the growth rate during environmental transitions by considering environmental up-shifts. We model the up-shifts by an instantaneous change in ns. This parameter is a proxy for how many metabolic steps are necessary in order to convert the nutrients in the environment into protein precursors or anabolic efficacy of the medium. The biological interpretation of shifting the medium abruptly to a higher value of ns is that nutrients that do not require a lot of metabolic processing (like amino acids) before incorporation into biomass are suddenly made available for the cell. Our simulations show that higher storage capacities results in smoother transitions from one physiological state to another (Fig. 5). To understand this behaviour we next look at the sensitivity of transcriptional regulation to levels of the resource a.



Sensitivity of transcriptional regulation decreases with storage:
We define the sensitivity of transcriptional regulation as
σ (a)= dωx ,
x	da


6


5


4


3


2


1


0
0	50	100	150	200	250	300
Time after the shift [minutes]

Fig. 5. λ0 denotes the growth rate of a model with storage capacity α = 1 in a medium quality ns = 0.12. Before t = 0, the model is growing steadily for a medium quality ns = 0.12. At t = 0 the medium quality is shifted from 0.12 to ns = 0.5. Different lines correspond to cell models with different storage capacities. The black line denotes the behaviour of a (theoretical cell) adapting instantaneously its internal composition to the new growth condition. Different dynamics of growth adaptations arise for different storage capacities: increasing the storage capacity α results in smoother transition of the growth rate following an up-shift. For high enough storage capacity, steady growth rate before the shift is severely impaired (red line), as expected from figure 4.


and obtain


σx =
wx · α · θ∗
(α · θ∗ + a)2 wq · α · θ∗
,	x ∈ {t, m, r},

σq = 	q  · I(q).
∗
q

As long as M  α · a∗ we know that a ≈ α · a∗, and so


σx ≈
wx · θ∗
α · (θ∗ + a∗)2 wq · θ∗
,	x ∈ {t, m, r},

σq ≈ 	q	 · I(q).
∗	∗
q

The sensitivity of transcriptional expression thus decreases with increasing storage capacity. An intuitive explanation is that, although the storage capacity impacts the steady state concentration of a, it does not affect its rate of production. Con- sequently, the rate of accumulation or depletion of a relative to its current concen- tration is decreasing, therefore making transcriptional regulation less sensitive to fluctuations in a.

High sensitivity of transcriptional regulation results in overshoot regu- lation during environmental up-shifts:
We now look at the reallocation dynamics of the cell model during an up-shift. We see that high sensitivity of transcriptional regulation, achieved by low values of the storage capacity, results in a two-stage regulation:
Net production of a increases as a result of an increase in ns, Fig. 6C. This is a consequence of the linear increase of the production flux with nutrient quality, ns · νcat, while consumption by ribosomal mRNA complexes is saturated, and so the concentration of a increases, Fig. 6D. Consequently, reallocation of cel- lular resources from metabolic enzymes to ribosomes occurs: see the increase of ribosomal concentration and decrease of metabolic enzymes concentration, Fig. 6A & B.
By the time the concentration of a decreases, ribosomal concentration rela- tive to metabolic enzyme is already high enough, so it creates an imbalance between production of a and consumption. The concentration of a decreases significantly, which results in a reallocation of resources from ribosomes to metabolic enzymes.
An interesting analogy is that for low storage capacity, during an up-shift, the tran- scriptional regulation behaves like a bang-bang control [20]: most of the resources available go to ribosomal production (relative to that of the exponential growth) which leads to an excess in ribosomes requiring to allocate most of the resources available to metabolic enzymes. This behaviour is made possible because:
Reallocation of internal resources to different cellular functions is not instan- taneous. Indeed, allocation arises from competition between different mRNAs for ribosomes. Since mRNAs have non-zero lifetimes, rewiring mRNA produc- tion to one cellular function does not result in a direct update of the mRNA repartitioning to different cellular functions. This motivates the use by liv- ing systems of post-transcriptional regulation mechanisms that are able to act directly at the translation level rather than only tuning transcription.
Protein production is not instantaneous either. The feedback coming from transcriptional regulation of ribosomal or metabolic enzyme expression on a concentration takes time and can thus cause the overshoot in regulation.



Trade-offs between biomass production during transitions and during exponential growth:
Let B(t0,T, α) be the biomass production between two time points t0 and T , for a storage capacity α, and B0 the biomass at time t0, Then:

, T λ(α)·dt
B(t0,T, α)= B0 · e t0	.


2.6
2.4
2.2
2
1.8
1.6
1.4
1.2
1
0.8

0	50	100	150	200	250	300

3 x 106

2.5

2

1.5

1

0.5

0

–0.5

–1  0	50	100	150	200	250	300

Time after the shift [minutes]
Fig. 6. Before t = 0, the model is growing steadily for a medium quality ns = 0.12. At t = 0 the medium quality is shifted from 0.12 to ns = 0.5. Different lines correspond to cell models with different storage capacities..  (A) Ribosome concentration relative to its concentration before the up-shift (B) Enzyme
concentration relative to its concentration before the up-shift (C) Flux of a concentration: da (D) log10
of a concentration relative to its concentration before the up-shift.
We define the relative cumulative growth rate δ as:


δ = ln(B(t0,T, α))
ln(B(t0,T, 1))
T
=  t0	 .	(9)
t0

The relative cumulative growth rate measures how much the mean growth rate with storage capacity α deviates from the growth rate with the reference parameter (α = 1), between two time points t0 and T . Note that the two are related through
B(t0,T, 1)δ = B(t0,T, α).
In Fig. 7 we see the trade-off between smoother transitions during an up-shift and the detrimental impact of increased storage on the exponential growth rate, i.e. the growth rate once the cells have reached their physiological state corresponding to the ns after the shift. As long as M  a, it is favourable to increase the storage capacity in order to maximise biomass production during the up-shifts. When the storage capacity gets too high, the exponential growth rate starts decreasing sharply, hence

annihilating the gains coming from higher biomass production during the up-shift. Cells thus may tune their storage capacity as a result of this trade-off.




1

0.8

0.6

0.4

0.2

0
0	0.2	0.4	0.6	0.8	1
Relative Exponential Growth Rate
Fig. 7. Diamonds correspond to different up-shift experiments from ns = 0.12 to ns = 0.5 for increasing the storage capacity α from 1 to 1010. The relative exponential growth rate is the ratio of the growth rate of the cell model when ns = 0.5 for one given value of the storage capacity α over the growth rate of the cell model when ns = 0.5 and α = 1. The relative cumulative growth rate defined in Equation (9) is computed
for t0 = —20 minutes and T = 100 or T = 1000 minutes. Increasing the storage capacity α results in decrease of the relative exponential growth rate. The benefits from a smoother transition coming from an increased stock of metabolites result in a maximized relative cumulative growth rate at intermediary storage capacities.




The evolutionary pressure to store resources depends on environmental dynamics
Sharper environmental shifts favour high storage:
So far, we have considered only one up-shift intensity. We now consider several shift intensities: ns,1 − ns,0 where ns,0 and ns,1 are respectively the quality of the medium before and after the shift. In Fig. 8, we see that the more intense the up-shifts, the more the maximal storage capacity increases.


Frequent environmental fluctuations favour high storage:
We now consider fluctuating environments and define the frequency of an environmental shift by τ = T—1. For high frequencies, growth during transitions gains importance compared to exponential steady state growth. Consequently, the optimal storage capacity, i.e. the one that maximises cumulative growth, thus increases with the frequency of environmental change, Fig. 9.

1.4

1.2

1

0.8

0.6

0.4

0.2


0
0	2	4
log

() 6	8	10

10
Fig. 8. The cumulative growth rate for one given storage capacity α relative to that of when α = 1 
is maximized for greater storage capacities when the up-shifts are sharper. , T λ(α) · dt/ , T λ(1) · dt is
t0	t0
evaluated for t0 = —20 and T = 300 minutes. The model is shifted from ns = 0.12 to ns = 0.30, ns = 0.50 and ns = 0.80.
Experimentally observed E. coli ATP concentrations fall close to the predicted storage capacity maximizing biomass production:
Living cells such as E. coli use ATP as their main energy currency. ATP is one of the main protein precursor as it is necessary in order not only to assemble molecules into amino acids, which compose proteins, but also for elongating proteins during translation. In slow growing E. coli cells, the average ATP concentration is 1.54 × 10—3 mol.L—1 [23]. Under slow growth conditions, the volume of an E. coli cell is approximatively 1 × 10—15 L [21]. The number of amino acids, whether they are or not constitutive of proteins, in a slow growing E. coli cell is 5.6 × 108 [3]. The mass in the cell model is 108 amino acids. Consequently, there are

1.54 × 10—3 · 1 × 10—15 · NA
5.6
≈ 1.7 × 105
ATP molecules per cell model mass in

a slow growing E. coli cell; where NA = 6.02 × 1023 is the Avogadro constant.
In E. coli, the average ATP cost per amino acid is approximatively 25 ATP.aa—1 [16]. The number of ATP per cell model mass, in amino acid cost equivalent, is

therefore
1.7 × 105
25
≈ 7 × 103. Strikingly, this number falls close to the range of
∗

protein precursor a = α · a  which maximizes biomass production in fluctuating
environments, see fig. 8 and fig. 9, i.e. 104 · a∗ < α· a∗ < 106 · a∗, where a∗ ≈ 1 under slow growing conditions. Note that a∗ is the quantity of the protein precursor when the storage capacity is: α = 1.
Discussion
We used a recent cellular growth model to investigate how the level of resource stor- age can impact cellular growth and thus impose fitness costs or benefits on cells. We

1.4

1.2

1

0.8

0.6

0.4

0.2


0
0	2	4
log

() 6	8	10

10

Fig. 9. The cumulative growth rate for one given storage capacity α relative to that of when α = 1 is maximized for lower storage capacities when the frequency τ of up-shift occurrences decreases. The more frequent the up-shifts, the higher the optimal storage capacity that maximises biomass production.

find first that there is a large window of concentrations for the universal precursor (a conflation of all the various energy and carbon needs of the cell) in which the growth rate is essentially unchanged at steady state. This opens up a significant possibility for selective pressure to drive the cells to a judicious choice of storage level and thus extract the benefits during shifts in nutrient availability and quality. Indeed, we find that constant environments distinctly favour low levels of resource storage (no additional fitness can be obtained by storing), whereas fluctuating environments clearly favour high levels of resource storage (additional fitness can be obtained by storing with little detrimental effect to stationary growth). Furthermore the cost of storage appears to increase the more the environment is favourable to growth. This motivates the use of regulatory systems that tune the storage capacity depending on the growth condition. Indeed, it has been shown in E. coli that proteins in- volved in glycogen synthesis (the main storage molecule in E. coli ) are up regulated in poor growth conditions [10]. Our conclusions are drawn from a specific model of cellular growth. In a recent study that investigated cellular adaptation during environmental transitions [12] the model ignored transcription. This means that the rate of protein production is instantaneously adapted to the proteins precursor concentration. Such model implies shorter timescales for the adaptation of protein production, which can be expected to reduce the negative impact of low storage during transitions and may thus change the conclusions drawn in this paper. It would be interesting to investigate storage effects in this simpler model to see if they are still present to an extent. Be that as it may, this highlights the importance to account for all major timescales that underpin cellular adaptation when studying evolutionary trade-offs in fluctuating environments.
Our analysis suggests that cells face actual trade-offs in the maintenance of re- source storage. Quantitative models such as the one we considered here can be used

to reverse-engineer the ecology of cellular species—much of which we only know in laboratory conditions—using existing data about metabolic resource concentrations [2]. Furthermore, although our analysis was performed on a model for unicellular growth, the mechanisms described may be applicable to any system growing in an environment where resources are fluctuating and scarce. Therefore, similar argu- ments could give a mechanistic ground to the observed trade-offs between growth capacity and low resource tolerance for plants in the Arizona Desert [1].

References
Angert A. L., P. Chesson, T. E. Huxman, D. L. Venable, Functional tradeoffs determine species coexistence via the storage effect., PNAS 106 11641–11645 (2009).
Bennett B. D., S. J. van Dien, E. H. Kimball, M. Gao, R. Osterhout, J. D. Rabinowitz, Absolute metabolite concentrations and implied enzyme active site occupancy in Escherichia coli, Nature Chemical Biology 5 593–599 (2009).
Bremer H. and P. Dennis Modulation of chemical composition and other parameters of the cell by growth rate., EcoSal Plus (2008).
Brunschede H., H. Bremer and T. L. Dove Establishment of exponential growth after a nutritional shift-up in Escherichia coli B/r: Accumulation of deoxyribonucleic acid, ribonucleic acid, and protein., Journal of Bacteriology 129 1020–1033 (1977).
Chesson P., Multispecies Competition in Variable Environments, Theoretical Population Biology 45
(1994), 227–276.
Cooper S., Cell division and DNA replication following a shift to a richer medium., Journal of Molecular Biology 43 1–11 (1969).
Dalbow D. G. and R. Young, Synthesis time of beta-galactosidase in Escherichia coli B/r as a function of growth rate, Biochemical Journal 1 13–20 (1975).
Dennis P., and H. Bremer, Macromolecular Composition During Steady-State Growth of Escherichia coli B/r, Journal of Bacteriology 119 (1974), 270–281.
Dong H., C. G. Kurland, L. Nilsson, Co-variation of tRNA abundance and codon usage in Escherichia coli at different growth rates., Journal of Molecular Biology 260 649–663 (1996).
Edwards A. N., P. Babitzke, M. Cashel, M. I. Camacho, J. A. Fields, D. Georgellis, J. W. Mercante, L.
M. Patterson-Fortin, K. Potrykus, T. Romeo, S. A. Thompson, D. Vinella, C. A. Vakulskas, Circuitry linking the Csr and stringent response global regulatory systems., Molecular Microbiology 80 1561–1580 (1984).
Gardner T., S. Cantor, C. R., Collins J. J.,Construction of a genetic toggle switch in Escherichia coli, Nature 403 339–342 (2000).
Giordano N., J. Geiselmann, J-L. Gouz´e, H. de Jong, F. Mairet,Dynamical Allocation of Cellular Resources as an Optimal Control Problem: Novel Insights into Microbial Growth Strategies, Plos Computational Biology 12 1–16 (2016).
Hardin G. The competitive exclusion principle, Science131 (1960).
Hui S., M. Basan, S. S. Chen, D. W. Erickson, T. Hwa, J. M. Silverman, J. Wang, J. R. Williamson Quantitative proteomic analysis reveals a simple strategy of global resource allocation in bacteria, Molecular Systems Biology 11 (2015).
Forchhammer J. and L. Lindhal, Growth rate of polypeptide chains as a function of the cell growth rate in a mutant of Escherichia coli, Journal of Molecular Biology 55 563–568 (1971).
Lynch M. and G. Marinov, The bioenergetic costs of a gene, PNAS 112 15690–15695 (2015).
Molenaar D., R. van Berlo, D. de Ridder, B. Teusink, Shifts in growth strategies reflect tradeoffs in cellular economics., Molecular Systems Biology 5 (2009).

Pedersen S., Escherichia coli ribosomes translate in vivo with variable rate., The EMBO Journal 12
2895–2898 (1984).
Scott M., C. W. Gunderson, T. Hwa, E. M. Mateescu, Z. Zhang, Interdependence of Cell Growth and Gene Expression: Origins and Consequences, Science 330 (2010), 1099–1102.
Sonneborn L. M. and F. S. Van Vleck, The Bang-Bang Principle for Linear Control Systems., J. SIAM Control 2 151–159 (1965).
Volkmer B. and Heinemann M. Condition-dependent cell volume and concentration of Escherichia coli to facilitate data conversion for systems biology modeling., PLoS One 7 23126 (2011).
Weiße A., V. Danos,D. A. Oyarzu´n, P. Swain, Mechanistic links between cellular trade-offs, gene expression, and growth, PNAS 112 (2015) E1038–E1047.

Yaginuma H., Kawai S., Kakikuza A., Komatsuzaki T., Imamura H., Noji H., Tabata K. V., Tomiyama K., Diversity in ATP concentrations in a single bacterial cell population revealed by quantitative single- cell imaging, Scientific Reports 4 6522 (2014).

Young R. and H. Bremer, Polypeptide-chain-elongation rate in escherichia coli b/r as a function of growth rate, Biocjjemical Journal 160 185–194 (1976).

Appendices
Model of the toggle-switch
We briefly describe here a model of the toggle-switch which we simulated in order to obtain Fig. 3. It is based on a toggle-switch model first published in [11].

Proteins A and B are produced at rates fA and fB:

fA
B −→ A + B	(r1)
fB
A −−→ B + A	(r2)
The rates of proteins A and B production write:


fA = αA
· HB
= αA ·
1


KB  βB
+1 
[B]

fB = αB
· HA
= αB ·
1


KA  βA
+1 
[A]

αA and αB are the maximal production rates of proteins A and B. The produc- tion rate of each protein is modulated by HA and HB. They are Hill function and model the repressions exerted by:
protein A on protein B expression
protein B on protein A expression

Proteins A and B are degraded at rate dA and dB:


d
A −→
d
B −−→
∅	(r3)
∅	(r4)

We set the initial conditions to [A](t = 0) = 0 and [B](t = 0) = 20. The parameters we used for the simulations of the non rescaled model are: dA = 1; dB = 1; KA = 1; KB = 1; αA = 15.6; αB = 3.12; βA = 2.5; βB = 1. In order
to rescale by 3 the stationary state concentration of the protein A, we rescale the parameters dA and KA such that: dA = 1/3 and KA = 3. For further details on this model, refer to [11].
Parameters of the cell model
Default values were used unless otherwise stated. Adapted from [22]. Parameters that have  left of their name have been obtained in [22] by fitting the model to data from [19]. We denote by aa the protein precursors, Amino acids or a in the growth model.

