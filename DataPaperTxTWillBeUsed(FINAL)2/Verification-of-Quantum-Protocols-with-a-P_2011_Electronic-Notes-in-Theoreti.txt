

Electronic Notes in Theoretical Computer Science 270 (1) (2011) 175–182
www.elsevier.com/locate/entcs

Verification of Quantum Protocols with a Probabilistic Model-Checker
Amir M. Tavala 1 ,2	Soroosh Nazem3
Department of Electrical and Computer Engineering Isfahan University of Technology
Isfahan 84156-83111, Iran
Ali A. Babaei-Brojeny4
Department of Physics Isfahan University of Technology
Isfahan 84156-83111, Iran

Abstract
Channel modeling is crucial for studying the behavior of quantum channels in order to build an efficient error correction scheme in addition to security verification of different protocols. While most current analyses of quantum protocols use a traditional mathematical approach, we employ a simpler probabilistic model checking which is more compatible with classical implementations to investigate the dependency of the security on the quantum channel noise. We also compare a couple of eavesdropping strategies from the security point of view.
Keywords: Probabilistic modeling, Quantum protocol verification, Quantum key distribution


Introduction
The field of quantum information theory has brought the potential to accomplish feats considered impossible by purely classical methods. One of these is the ability to transmit an unconditionally secure message between two parties, known as quan- tum cryptography. Quantum cryptography is one of the earliest practical results among the various theories which are tied with quantum mechanics and are not yet fulfilled by present technologies.
On the one hand, quantum mechanics postulates put some constraints on all

1 The authors would like to thank Ms. Farnaz Pirasteh for the help in preparation of the LATEX version.
2 Email: a.tavala@ec.iut.ac.ir
3 Email: sorush.nazem@gmail.com
4 Email: brojeny@cc.iut.ac.ir

1571-0661 © 2011 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2011.01.016

logic that governs classical communication. On the other hand, those postulates enhance security beyond computational security. It should be noted that the quan- tum channel and quantum bits are utilized for transmitting classical bits of the key. The complete communication either involves a classical medium in parallel or the classical data can be sent through the same quantum channel [1].
Quantum key distribution (QKD) establishes a string of random bits shared by two spatially separated parties, say Alice and Bob, in an information-theoretically secure manner [2]. Later, Bob performs a sifting transaction or secret key reconcil- iation (through the public channel) to discard all cases where he reads the wrong basis.
The BB84 and B92 protocols are among the first and best-known ones which are proved to be unconditionally secure even with some assumptions of imperfec- tions in the channel and devices [3, 4]. There have been several recent methods, some of which are based on teleportation and entanglement, such as the six-state scheme, which have relatively enhanced the security bound and tolerate more er- rors [12]. There have been numerous theoretical investigations done by computer scientists on channel modeling in QKD protocols, most of which concentrate on the ideal conditions; in the worst case, they model the channel noise equivalent to the eavesdropper (Eve)’s effect. To have a more realistic description of the channel for a particular protocol, one has to consider different tapping schemes, the detection efficiency of measurement devices [9, 10] and statistical parameters of channel im- perfections such as noise, damping factor (for dissipating channels), decoherence [7], etc.
In this paper, we have measured the security of the BB84 protocol using a
probabilistic modeling approach and built a simple model for channel noise and imperfections which have been verified by PRISM programming. The results are shown to tend to those of the noiseless channel cases and the comparison of differ- ent tapping scenarios is consistent with the other works [13]. The rest of the paper is organized as follows: The model of quantum channels is described in section 2. The PRISM model checker, simulation details and experimental results are given in section 3. The paper is concluded in section 4.

Building the Model
Model checking is a procedure involving three main steps: (i) constructing an ab- stract model of a given system (system specification); (ii) defining the properties desired of the system in a form that can be checked automatically (property speci- fication); and (iii) feeding the model into an appropriate software tool (verification, which will be covered in the next section). A model checker then employs its built-in algorithms to simulate the possibilities and give the result in the form of probabili- ties [8].
Probabilistic simulations are based on different probabilistic models like CTMC, MDP, DTMC, etc. In our experiment, the Discrete Time Markov Chain (DTMC) model is used for security verification of BB84 in a noisy channel. We concentrate

on Intercept-Resend attacks as eavesdropper’s strategy, but a security comparison with Random Substitution attacks is also investigated [8].
In the following subsections, we first briefly introduce the basic concepts of DTMC which are useful for better understanding of the model-checking procedure. Then, we present a simple form of channel noise applied in protocol analysis.

Discrete Time Markov Chains
A Markov chain is a stochastic process whose state space I is discrete (finite or countably infinite) and such that the probability distributions for its future devel- opment depend only on the present state and not on the path (consisting of past states) that was followed to reach this state. If we further assume that the param- eter space T is also discrete, then we have a discrete time Markov chain. We can state the Markov property as
P (Xn = in|X0 = i0, X1 = i1, ..., Xn−1 = in−1)= P (Xn = in|Xn−1 = in−1)	(1)
where the Xi’s are random variables at time step i = {0, 1, 2, ...} and if Xn = j, then the state of the system at time step n is j, X0 being the initial state of the system. So the transition probability of the Markov Chain is given by
pjk(m, n)= P (Xn = k|Xm = j),	0 ≤ m ≤ n	(2)
and if its value depends only on the difference n − m, i.e., the number of steps, then such chains are called homogeneous Markov chains. In such a case:
pjk(n)= P (Xm+n = k|Xm = j)	(3)
denotes the n-step transition probabilities. The one step transition probabilities of a DTMC could be specified in the form of a transition probability matrix. The row sums of this square matrix are equal to unity. It plays an important role in the analysis based on DTMC. The n-step transition probabilities can be computed by one form of the Chapman-Kolmogorov equation:

pij(m + n)= Σ pik(m)pkj(n)	(4)
k
Let P (n) be the n-step transition probability matrix, then we can write the above equation as:
P (n)= P.P (n − 1) = Pn	(5)
Hence, the one step transition probability matrix could be multiplied (n − 1) times by itself to get the n-step transition probability matrix. Also using the theorem of total probability we have:


pj(n)= P (Xn = j)= Σ pi(0)pij(n)	(6)
i
Hence, the step-dependent probability vector of, denoting by p(n) of Xn at time n
could be expressed as
p(n)= [p0(n), p1(n), ..., pj (n), ...]= p(0)P n	(7)

Quantum Channel Noise Modeling
There are various noise forms which can be described as a stochastic process by giving the power density, probability distribution, etc. We here consider a simple model which is expressed with a single parameter, say PN , which represents the probability of flipping the transmitted qubit in its own basis. The protocol security is expected to diminish as the entropy of the received qubit increases which corre- sponds to greater values of PN up to 1 . We can define this parameter for every part of the channel. In our discussion, the channel has two sections. We assume that all imperfections in the transmitting device of Alice, the quantum channel between Alice and Eve and the receiver device of Eve can be modeled by PN1 and the imper- fections in Eve’s transmitter, the channel between Eve and Bob and Bob’s receiver are modeled by PN2.
Although the existence of noise is a desirable fact for the eavesdropper, passive attacks are still unattainable. In other words, Eve cannot hide her modifications
completely in the channel noise and her presence is detectable, but with a relatively lower chance. It should be noted that Eve is assumed to have ultimate computa- tional power and unlimited technology for state preparation.
The detection probability of Eve is our model criterion for security [11] which is denoted by Pdet. This probability is only well-defined when the selected bases by both Alice and Bob are the same, so they are able to check if there is any evidence of tapping. Therefore, we focus on the two cases when the transmitted qubit by Alice and received qubit by Bob are either equal or non-equal, where P (A = B) and P (A /= B) are the probabilities of each of the mentioned cases and the bases are supposed to be identical. Then, we have:
Pdet = Pdet|(A = B).P (A = B)+ Pdet|(A /= B).P (A /= B)	(8)
In a noiseless channel, P (A = B)= 1 — P (A /= B)= 3 ; For nonzero values of PN1
and PN2, this statement is, however, no longer correct. Also, let
P0(N )= [1 — exp(—0.134N )]/N	(9)
where P0(N ) represents the probability of detection of Eve per qubit in a noiseless channel for an intercept-resend attack [13]. It can be shown that the detection probabilities can be derived as follows:



Pdet|(A = B)= 
	P0[PN1(1 — PN2)+ PN2(1 — PN1)]	
P0[PN1(1 — PN2)+ PN2(1 — PN1)] + (1 — P0)[(1 — PN1)(1 — PN2)+ PN1PN2]


(10)



and
Pdet|(A /= B)= 
	P0[(1 — PN1)(1 — PN2)+ PN1PN2]	
P0[(1 — PN1)(1 — PN2)+ PN1PN2]+ (1 — P0)[PN1(1 — PN2)+ PN2(1 — PN1)]


(11)

It may sound reasonable to think of identical stochastic characteristics in the two mentioned parts of the channel for simplification which means PN1 = PN2 = PN . Then, if we define:
H = 2PN (1—PN )	(12)
which is proportional to the variance of a Bernoulli random variable, peaked at
PN = 1 . The above formula can be reduced to:



Pdet
	P0H	
|(A = B)= 
(1 — P 0)(1 — H)+ P0H
(13)




Pdet
	P0(1 — H)	
|(A /= B)= 
P0(1 — H)+ (1 — P0)H
(14)


Applying the model in PRISM
Simulation Details
Because of the random behavior of quantum phenomena, it has been suggested to use an appropriate probabilistic tool for verifying quantum protocols instead of log- ical model-checkers like SPIN [6, 14]. Among them, PRISM (probabilistic symbolic model-checker) has some advantages especially for BB84 analysis as the protocol developers also used it for this purpose [7]. Papanikolaou proposed an analysis of BB84 for two possible attacks where the channel is considered noiseless and all the device imperfections are neglected [14].
Here, each DTMC state corresponds to a unique event which is possible accord- ing to the protocol flowchart and the transition probabilities are determined by our assumptions. For example, it is logical to consider a 50-50 chance for both Bob and Eve to get the correct qubit providing that their measurement basis is not the same as that of the received qubit.
In transmission of a stream of qubits, the security criterion and simulation time

highly depend on the size of the stream or number of transmitted qubits, say N . Larger numbers of qubits provide more security but need more complex systems to be implemented.

Experimental Results
The following 3 figures show the security criterion for an intercept-resend attack in a noisy channel. They are plotted by exporting the result into MATLAB software. In figure 1, the role of channel noise is illustrated which reduces the curvature of the graph when it goes up. Thus, Eve is more likely to be detected. Note that the noiseless condition is shown at the top of other graphs.

Fig. 1. Security criterion vs. PN1 for N = 50 for different values of PN2.
Figure 2 depicts the best and worst cases with respect to the presence of noise in the second part of the channel, i.e., between Eve and Bob.

Fig.2. Security vs. PN1 for three pairs of graphs
when the second part of the channel is either noiseless or random.

In the next figure we suppose identical statistical conditions for both parts of the channel which means PN1 = PN2 = PN . It shows the security dependency on the number of transmitted qubits (N ) as it was expected.

Fig. 3. Security vs. PN for different values of N
Figure 4 is inserted directly from the PRISM environment and shows that it is not a clever idea for Eve to choose random substitution as the detection probability would be considerably higher. That is why it is preferred not to repeat the previous analysis for random substitution attack [5].

Fig. 4. Security criterion vs. noise probabilities for different numbers of qubit stream lengths (10 and 60) for the two attacks. Note that when the channel behavior is completely random, the security has its minimum value and the corresponding values for both attacks become equal. Again, we have
PN1 = PN2 = PN (which is denoted by np in here [5]).

Conclusion and Future Directions
In this presentation, we employ PRISM for analyzing BB84 with different tapping scenarios which are also focused on in [14]. The outcomes for noiseless and noisy channel are compared and it is shown that it confirms and satisfies the expected results and formula [13]. Further investigations can be done by building a more

complicated model of the noise or considering other imperfection factors. Also, the same verification can be done for other protocols or security criteria.

References
Mitra,	A.,	Complete	Quantum	Communication	with	Security,	(1995),	URL:
http://arxiv.org/abs/quant-ph/9812087v7.
Dobsi ek, M., J. Kola, and R. Lorencz, A Theoretic-framework for Quantum Steganography, Proc. of CTU Workshop (2006), 124–125.
Hupkes,  H.  J.,  Unconditional Security of Practical Quantum Key Distribution,  URL:
arXiv:quant-ph/0402170v1 .
Tamaki, K. et al., Unconditional Security of the Bennett 1992 Quantum Key Distribution Protocol over a Lossy and Noisy Channel, Physical Review A (2004).
Tavala, Amir M., Soroosh Nazem, and Ali A. Babaei-Brojeny, Security Verification of BB84 Protocol Using PRISM Model-Checker, Proc. of International Iran Conference on Quantum Information (2007).
Gay, S., R. Nagarajan, and N. Papanikolaou, Probabilistic Model-Checking of Quantum Protocols, URL:
arXiv: quant-ph/0504007v2 (2005).
Barenco, A., T. A. Brun, R. Schack, and T. P. Spiller, Effects of noise on quantum error correction algorithms, URL: arXiv:quant-ph/9612047v1 (1996).
Wu, L., and D. A. Lidar Overcoming quantum noise in optical fibers, Physical Review A (2004).
Gottesman, D., Lo, H. K., Lutkenhaus, N., and Preskill, J. Security of quantum key distribution with imperfect devices, Proc. of International Symposium on Information Theory (2004).
Guerreau, O. L., F. J. Malassenet, S. W. McLaughlin, and J. M. Merolla, Quantum Key Distribution without a Single-Photon Source Using a Strong Reference, IEEE Photonics Technology Letters 178 (2005).
Mayer, D., Unconditional Security in Quantum Cryptography, Journal of ACM483 (2001).
Gottesman, D., and H. K. Lo, Proof of Security of Quantum Key Distribution With Two-Way Classical Communications, IEEE Trans. Information Theory 492 (2003).
Nagarajan, R., N. Papanikolaou, G. Bowen, and S. Gay An Automated Analysis of the Security of Quantum Key Distribution, URL: arXiv:cs.CR/0502048 v1 (2005).
Papanikolaou, N., Techniques for design and validation of quantum protocols, M.Sc. Thesis, URL:
http://www.dcs.warwick.ac.uk/ nikos/.
