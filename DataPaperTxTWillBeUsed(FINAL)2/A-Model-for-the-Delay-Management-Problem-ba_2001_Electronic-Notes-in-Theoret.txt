Electronic Notes in Theoretical Computer Science 50 No. 1 (2001) { Proc. ATMOS 2001 URL:  http://www.elsevier.nl/locate/entcs/volume50.html  10 pages



A Model for the Delay Management Problem based on Mixed-Integer-Programming



Anita Schobel 1

Department of Mathematics Universitat Kaiserslautern and
Institut fur Techno- und Wirtschaftsmathematik Germany


Abstract
Dealing with delayed vehicles is a necessary issue in the dispositive work of a public transportation company. If a vehicle arrives at some station with a delay, it has to be decided if the connecting vehicles should wait for changing passengers or if they should depart in time. A possible objective function is to minimize the sum of all delays over all customers using the transportation network. In this paper the delay management problem is formulated as a mixed integer linear program, and solution approaches based on this formulation are indicated.



1	Introduction

Unfortunately, delays are a main subject of complaints in public transporta- tion, and it does not seem possible to avoid them completely. Customers using a delayed vehicle will probably arrive at their destination later as planned. Even worse, if some passengers want to change from a delayed vehicle into another bus or train, they might miss their connection and maybe have to wait a long time for the next one. In this paper we analyze these e ects and will present a model how to deal with delays.
Suppose that a train arrives at a station k with a delay of some minutes. At station k there is a bus ready to depart. What should this connecting bus do? There are two alternatives:
  The bus either can wait and therefore cause delay for the customers within the bus, but also for the customers who want to get on this bus later on, and possibly for subsequent other buses which will have to wait for its delay.

1 Email: schoebel@mathematik.uni-kl.de
 c 2001 Published by Elsevier Science B. V. Open access under CC BY-NC-ND license.



Fig. 1. A connection (i; j; k) from vehicle i to vehicle j at station k.


 On the other hand, if the bus departs in time, all the customers who planned to change from the delayed train into the bus will miss their con- nection.
The delay management problem is to nd wait-depart decisions, not only for one single bus, but for all vehicles in the public transportation network, such that the inconvenience over all customers is minimized. As inconvenience for a customer, we consider the amount of his delay when he reaches his destination.
Since in the delay management problem new departure times for each vehi- cle at each station have to be determined, it is closely related to the problem of
 nding timetables in public transportation. In this eld, a lot of research has been done, as an example for a combinatorial and a graph-theoretical approach and for various heuristics and metaheuristics, see [9] and references therein. As objective functions, the total waiting time or the traveling time have mainly been considered, sometimes also the costs for operating the timetable. Other models which have also been considered mainly in scheduling and timetabling, but that can be useful when dealing with delays are the max-plus-algebra (e.g., used by [6]) or the heaps-of-pieces-approach, see [13]. The main di erence to the delay management problem, besides the slightly di erent objective func- tions, is that in the delay management problem the connections are not given in advance. In fact, the main decision that must be made is to decide which connections should be maintained and which can be dropped.
Delays and their consequences have been addressed in a few papers before, see e.g., [8,3] for analyzing the occurrence of delays. [11,1,7,12] dealt with de- lays in railway systems. Mainly simulation and expert systems are used when dealing with the reaction to initial delays. In contrast to these approaches, the delay management problem will be modeled as a mixed-integer program in this paper, such that optimization methods can be used for nding good decisions.


2	Mixed-integer programming formulation

In this paper we will deal with the delay management problem de ned as follows.
Given a set of vehicles running within a transportation network, and an initial delay V of one of these vehicles, how should the schedules of the vehicles be adapted, such that the total amount of the delays of all customers within the network is minimized?
We rst introduce some notation. To describe the transportation network, let V be the set of stations and F be the set of vehicles (the eet). For each vehicle, we introduce E i V V as the set of its driving edges within the transportation network. If it is possible to change from vehicle i to vehicle j at a station k, then (i; j; k) will be called a connection and the whole set of connections is given by
U  F  F  V:
We also need parameters pk, pkl, and pk representing the slack times for the
i	i	ij
waiting time of vehicle i at station k, for the driving time of vehicle i on its
way from station k to station l, and for the customers changing from vehicle i to vehicle j at station k, respectively.
Since the objective is to minimize the sum over all delays of all customers in the network, we need to specify the data about the customers. To this end, let A be a set of paths through the public transportation network, and wa be the number of customers using a speci c path a 2 A. To describe the paths
in A we use the parameters ha	de ned as follows.


a
ijk
= <8
1 if station k is reached by vehicle i and left by j in path a

:0  otherwise
To avoid a time-dependent representation of the stations we assume that each vehicle i 2 F and each customer path a 2 A contains any station at most once.
Furthermore, we assume that T is the (common) time period for all vehi- cles, and that in the next time period all vehicles are in time. The initial delay is given as an amount of time, V , of a speci ed vehicle arriving at a speci ed station, and we assume V  T .
As variables we de ne
xk = departure delay of vehicle i at station k yk = arrival delay of vehicle i at station k
z = 8<1  if all connections on path a are maintained
:0  otherwise.


To calculate the sum of delays of all passengers using a speci c path a 2 A we distinguish two cases.
Case 1: All connections on path a have been maintained. Then the delay for passengers using this path simply is the arrival delay of their last vehicle ia at their destination station ka, given by wayka . Note that these passengers might have had a larger delay during their trip, but only the arrival delay at their destination is relevant.
Case 2: At least one connection on path a is not maintained. Then we assume that the passengers using path a have to wait the whole time period T for the next vehicle going towards their destination, and the delay is hence given by waT .
Now the model (DM) for the delay management problem can be given. min Xwa (1  za)T + zayka 
a2A such that

(1)
(2)
y1 = V
yk  xk + pk

8i 2 F;k 2 V 

i	i	i

(3)
xk  yl + pkl
8k; l 2 V;i 2 F : (k; l) 2 E i

i	i	i
xk + pk  yk

(4)
a
ijk
j	ij
M
i +1 8(i; j; k) 2 U ;a 2 A 

(5)	0  yk; xk   T; 
i	i
(6)	za 2 f0; 1g
where ia denotes the last vehicle on path a and ka the last station on path a, and M should be chosen such that

M   max
(i;j;k)2U
k + T: 

Note that constraint (5) ensures that delays greater than the common time period need not be considered, since in this case the customers can take the non-delayed vehicle of the next period.
Constraint (1) contains the source delay, e.g., of vehicle 1 at station 1. Note that this single constraint is the crucial one in the formulation; a relaxation of constraint (1) would lead to the trivial optimal solution without any delays,
i.e., yk = xk = 0 for all i 2 F;k 2 V and za = 1 for all a 2 A. It is of course
i	i
also possible to use a set of source delays, i.e.,
yk = V k for all (i; k) 2 D;
i	i
where D describes the set of initial delays based on the arrival times of the vehicles.
Inequalities (2) make sure that a vehicle arriving with a delay at some station k will also depart with this delay, where a possibly positive slack time can be subtracted, and constraints (3) ensure that a delay is kept correctly





















Fig. 2. The event activity network along the driving edges of the vehicles.


In (4) the xk
and yk
variables are coupled with the data about the cus-

tomers.	To understand the meaning of constraints (4), take a connection (i; j; k) 2 U from a vehicle i to a vehicle j at some station k and a path a 2 A 
containing this speci c connection, i.e. with ha	= 1. Note that

jxk + pk   ykj  jxk  ykj + jpk j  T + max pk
  M:

j	ij	i
j	i	ij
i;j;k	ij

Hence, if the connection is not kept, i.e.,
yk  pk > xk
i	ij	j
we get that  M  xk + pk   yk < 0 and consequently,

j	ij
i
xk + pk

  yk

0	j		ij M
i +1 < 1

such that constraint (4) is satis ed if and only if za = 0. On the other hand, if the connection is maintained,
xk + pk  yk

j	ij
M
i +1  1

such that za is not restricted by constraints (4) and can hence be chosen as za = 1 due to the minimization of the objective function.
Based on event-activity networks (see, e.g., [9]), the formulation can be in- terpreted graph-theoretically as follows. We construct an event-activity net- work G = (V; E), where the set of nodes V = Varr [ Vdep  F  V repre- sents all arrivals (i; k)arr of a vehicle i at some station k and all departures (i; k)dep of some vehicle i at some station k. Then three types of edges can be


distinguished (see Figure 2).
  waiting edges ((i; k)arr; (i; k)dep)
  driving edges ((i; k)dep; (i; l)arr) with (k; l) 2 E i
  changing edges ((i; k)arr; (j; k)dep) with (i; j; k) 2 U 
In the event-activity network, the weights of the edges are the given slack
times, i.e. pk for waiting edges, pkl for driving edges, and pk for changing edges.
i	i	ij
The node weights yk; xk correspond to the decision variables representing the
i	i
delay of the arrival and departure events (i; k)arr and (i; k)dep, respectively.
The goal is to decide which of the changing edges can be dropped and which should be maintained to minimize the overall delay over all customers.
The given formulation of model (DM) can be linearized (and weakened) by substituting the quadratic term yka za by a new variable ua, leading to the
following model (DM').
min Xwa ((1  za)T + ua)
a2A such that

(7)
(8)
y1 = V
yk  xk + pk

8i 2 F;k 2 V 

i	i	i

(9)
xk  yl + pkl
8k; l 2 V;i 2 F : (k; l) 2 E i

i	i	i
xk + pk  yk

(10) za
a
ijk
j	ij
M
i +1 8(i; j; k) 2 U ;a 2 A 

(11)	ua  yka  T (1  za) 8a 2 A 
(12)	0  yk; xk   T; 
i	i
(13)	ua  0;
(14)	za 2 f0; 1g
Lemma 2.1 The linearization is correct. Proof.
(DM) =) (DM'): Let yk; xk; za be a feasible solution of (DM). De ne for
i	i
all a 2 A ua = yka za. Since
yka  yka za + T (1  za) 8a 2 A 
ia	ia
yk; xk; za; ua are feasible for (DM'), and both solutions have the same ob-
i	i
jective value.
(DM) =) (DM): Let yk; xk; za; ua be a feasible solution of (DM'). Then
i	i
yk; xk; za is also feasible for (DM). From (11) we conclude that
i	i
ua  yka if za = 1 ua  0 otherwise.
Consequently, ua   yka za and since we minimize, the objective function
does not increase.



2

3	Upper and lower bounds

To calculate upper bounds, we construct feasible solutions by xing the integer variables za;a 2 A. Let A denote the set of variables za which have been xed to 1, and let

U = f(i; j; k) 2 U : there exists a 2 A such that ha
= 1g

be the set of connections on paths from A . Then constraints (4) reduce to
xk + pk  yk

1	j		ij M
which is equivalent to
i +1 8(i; j; k) 2 U 

xk + pk  yk  0 8(i; j; k) 2 U :
j	ij	i
Hence, the the mixed integer program of model (DM) reduces to the following linear program.
min Xwayka


such that
1
1
  xk + yk
a2A 

=	V
  pk




8i 2 F;k 2 V 

i	i	i

xk  yl
  pkl
8k; l 2 V;i 2 F : (k; l) 2 E i

i	i	i

  xk + yk   pk
8(i; j; k) 2 U 

j	i	ij
0   yk; xk  T
i	i
This formulation can be solved eÆciently by linear programming, or by using the event-activity network described in the previous section, and per- forming the critical path methods for activity networks (e.g., described in [4]), see [5]. To nd values for the za-variables, the following strategies are possible.
All vehicles depart in time: Then the upper bound can be calculated by

X

a2A:ia =1
wayka + X waT
a2A1

where the  rst term is bounded by V Pa2A:ia =1 wa and
A1 = fa 2 A : 9 j 2 F;k 2 V such that (1; j; k) 2 U ; ha

= 1g:

All vehicles wait: this leads to the trivial bound of	a2A waV , which can
be strengthened if the slack times are greater than zero by solving the linear
program above.

Heuristic approach: Construct
A  out of paths which are used by many

customers and do not care for the others.
Metaheuristic approach: Finding a good set A can also be solved by meta- heuristics such as genetic algorithms or simulated annealing.


Note that on the other hand, for any feasible set of values for the xk, yk,
i	i
i 2 F;k 2 V, the optimal values of za, a 2 A can be calculated as follows.

Let Ua = f(i; j; k) 2 U : ha
= 1g be the set of connections on path a 2 A.

Lemma 3.1 Given yk; xk, the optimal solution for (DM) is given by

i

z =
8<0 if min(i;j;k)2Ua i
:1  otherwise:

xj + pk

  yk < 0

Proof. In the case that the x and y-variables are given, (DM) can be reduced to
min Xwa (1  za)T + zayka 


such that
a
ijk
a2A

k ij


8(i; j; k) 2 U ;a 2 A 

za  2 f0; 1g;
xk +pk  yk	k
where gk =  j	ij	i  + 1: Since we want to minimize, and since y a  T for
ij	M	ia
all a 2 A, we conclude that z  = 1 if this is feasible, i.e. if gk   1 for all

(i; j; k) 2 Ua. Using that

gk < 1 () xk + pk  yk < 0

ij	j	ij	i
the result follows.	2
A lower bound for (DM) can be obtained by solving the linear programming relaxation of (DM'), where za 2 f0; 1g is replaced by za  1. To strengthen the formulation, constraint (10) can be replaced by
xk + pk  yk

a
ijk
j	ij
M
i +1 8(i; j; k) 2 U ;a 2 A;

where
a

Ma =	max
(i;j;k)2Ua


k + V:

In this relaxation, the contribution of the missed connections to the objective function is proportional to xk + pk  yk. This means that a connection (i; j; k)
j	ij	i
that has been only just missed because of a few minutes, increases the objective
function not so much as if vehicle j would have departed a long time before the arrival of vehicle i.

4	Application and Outlook

The project of this paper was brought up by two large traÆc associations serv- ing the states Rheinland-Pfalz and the Saarland (both in Germany). They are interested in analyzing the consequences of delays, or, more general, also of (small) changes in the schedule. When analyzing such changes, it is impor- tant not to look only at one single transportation company, but to take into



Fig. 3. Calculating all delayed vehicles (red) in the area of the Lautertalbahn in Rheinland-Pfalz, Germany.

account also connections between di erent public transportation companies. In practice, there are other e ects which need to be considered when dealing with the delay management problem. Two of them are mentioned below.
  On single track lines the oncoming traÆc has to be taken into consideration. This e ect can be modeled by introducing some new connections (i; j; k) representing that vehicle j is not allowed to depart before the oncoming train has been arrived. With arti cial paths a whose variables za are xed to 1 it is possible to ensure that all these new connections are maintained.
  Also the vehicle schedules and the drivers schedules may have an e ect to the model, since a delayed vehicle or a delayed driver cannot start his next piece of duty in time. These e ects can also be modeled by introducing new connections, that may be maintained or dropped, but make sure that a delay is taken over to the next piece of duty.
Together with our project partners we de ned two representative test areas and collected the data about stations, edges and the schedules. Some rst numerical results based on this data show that solving the linear program to
determine the yk and xk can be done within seconds on a PII/500 computer,
i	i
also for the data of a complete day with more than 1000 vehicles. In Figure
3 vehicles which will have a delay (within a given solution of the za, a	2
are indicated in red. Currently, we are collecting real data about the customers' behavior and are implementing and testing the heuristics discussed in Section 3 (see [2]). A branch-and-bound approach, where the za are the branching variables, and which makes use of the bounds developed in the previous section is also under consideration.  Furthermore, [10] gives some


additional assumptions ensuring that the branch-and-bound approach nds an optimal solution within polynomial time.


References

[1] Adenso-D iaz, B., M. O. Gonzalez and P. Gonz alez-Torre, On-line timetable re-scheduling in regional train services, Transportation Research 33B (1999),
pp. 387{398.
[2] Castoldi, L., A. Schobel and T. Sonneborn, Heuristic approaches for the delay management problem, Technical report, Institut fur Techno- und Wirtschaftsmathematik, Kaiserslautern (2001), working paper.
[3] Chen, B. and P. Harker, Two moments estimation of the delay on single-track rail lines with scheduled traÆc, Transportation Science 24 (1990), pp. 261{275.
[4] Elmaghraby, S., \Activity Networks," Wiley Interscience Publication, 1977.
[5] Ginkel, A., \Event-activity networks in delay management," Master's thesis, University of Kaiserslautern (2001 (expected)), currently under research.
[6] Goverde, R., The max-plus algebra approach to railway timetable design, in: Computers in Railways VI: Proceedings of the 6th international conference on computer aided design, manufacture and operations in the railway and other advanced mass transit systems, Lisbon, 1998, 1998, pp. 339{350.
[7] Hendrickson, C. and G. Kocur, Schedule delay and departure time decision in a deterministic model, Transportation Science 15 (1981), pp. 62{77.
[8] Higgins, A. and E. Kozan, Modeling train delays in urban networks, Transportation Science 32 (1998), pp. 346{357.
[9] Nachtigall, K., \Periodic Network Optimization and Fixed Interval Timetables," Deutsches Zentrum fur Luft{ und Raumfahrt, Institut fur Flugfuhrung, Braunschweig, 1998, habilitationsschrift.
[10] Scholl, S., \Anschlusssicherung bei Verspatungen im O PNV," Master's thesis, University of Kaiserslautern (2001).
[11] Suhl, L. and T. Mellouli, Requirements for, and design of, an operations control system for railways, in: Computer-Aided Transit Scheduling (1999).
[12] Suhl, L. and T. Mellouli, Managing and preventing delays in railway traÆc by simulation and optimization, in: Mathematical Methods on Optimization in Transportation Systems (2001), pp. 3{16.
[13] van Egmond, R., An algebraic approach for scheduling train movements, in: Proceedings of the 8th international conference on Computer-Aided Transit Scheduling, Berlin, 2000, 2001.
