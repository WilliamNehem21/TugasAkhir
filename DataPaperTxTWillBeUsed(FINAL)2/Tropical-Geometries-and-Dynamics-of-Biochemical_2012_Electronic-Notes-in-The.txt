Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 284 (2012) 75–91
www.elsevier.com/locate/entcs

Tropical Geometries and Dynamics of Biochemical Networks
Application to Hybrid Cell Cycle Models
Vincent Noel
IRMAR UMR 6625, University of Rennes 1, Rennes, France
Dima Grigoriev
CNRS, Math´ematiques, Universit´e de Lille, 59655, Villeneuve d’Ascq, France
Sergei Vakulenko
Saint Petersburg State University of Technology and Design, St.Petersburg, Russia
Ovidiu Radulescu
DIMNP UMR CNRS 5235, University of Montpellier 2, Montpellier, France

Abstract
We use the Litvinov-Maslov correspondence principle to reduce and hybridize networks of biochemical reactions. We apply this method to a cell cycle oscillator model. The reduced and hybridized model can be used as a hybrid model for the cell cycle. We also propose a practical recipe for detecting quasi-equilibrium QE reactions and quasi-steady state QSS species in biochemical models with rational rate functions and use this recipe for model reduction. Interestingly, the QE/QSS invariant manifold of the smooth model and the reduced dynamics along this manifold can be put into correspondence to the tropical variety of the hybridization and to sliding modes along this variety, respectively.
Keywords: systems biology, model reduction, hybrid models, tropical geometry

Introduction.
Systems biologists develop biochemical dynamical models of various cellular pro- cesses such as signalling, metabolism, gene regulation. These models can reproduce complex spatial and temporal behavior observed in molecular biology experiments. However, currently available dynamical models are relatively small size abstractions,

1571-0661 © 2012 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2012.05.016

containing only tens of variables, and become ineffective when a comprehensive de- scription of high throughput data is needed. This modest size results from the lack of precise information on kinetic parameters of the biochemical reactions on one hand, and of the limitations of parameter identification methods on the other hand. Further limitations can result from the combinatorial explosion of interac- tions among molecules with multiple modifications and interaction sites [4]. In middle out modeling strategies small models can be justified by saying that one looks for an optimal level of complexity that captures the salient features of the phenomenon under study. The ability to choose the relevant details and to omit the less important ones is part of the art of the modeler. Beyond modeler’s art, the success of simple models relies on an important property of large dynamical systems. The dynamics of multiscale, dissipative, large biochemical models, can be reduced to that of simpler models, that were called dominant subsystems [19,8,6]. Simpli- fied, dominant subsystems contain less parameters and are more easy to analyze. The choice of the dominant subsystem depends on the comparison among the time scales of the large model. Among the conditions leading to dominance and allowing to generate reduced models, the most important are quasi-equilibrium (QE) and the quasi-steady state (QSS) approximations [8]. In nonlinear systems, timescales and together with them dominant subsystems can change during the dynamics and undergo more or less sharp transitions. The existence of these transitions suggests that a hybrid, discrete/continous framework is well adapted for the description of the dynamics of large nonlinear systems with multiple time scales [3,15,16]. The notion of dominance can be exploited to obtain simpler models from larger mod- els with multiple separated timescales and to assemble these simpler models into hybrid models. This notion is asymptotic and a natural mathematical framework to capture multiple asymptotic relations is the tropical geometry. Motivated by applications in mathematical physics [10], systems of polynomial equations [24], etc., tropical geometry uses a change of scale to transform nonlinear systems into discontinuous piecewise linear systems. The tropicalization is a robust property of the system, remaining constant for large domains of parameter values; it can reveal qualitative stable features of the system’s dynamics, such as various types of attractors. Thus, the use of tropicalization to model large systems in molecular biology could be a promising solution to the study of systems with imprecise kinetic parameters. In this paper we propose a method for reduction and hybridization of biochemical networks. This method, based on tropical geometry, could be used to automatically produce the simple models that are needed in middle-out approaches of systems biology.

Biochemical networks with rational rate functions.
Systems biology models use chemical kinetics to describe the dynamics of cellular processes. We consider here that the molecules of various species are present in sufficient large numbers and that stochastic fluctuations are negligible as a conse- quence of the law of large numbers and/or of the averaging theorem [3]. We also

consider that space transport phenomena are sufficiently rapid such that the well stirred reactor hypothesis is valid. In these conditions, the dynamics of the bio- chemical system can be described by systems of differential equations. In chemical kinetics, enzymatic reactions are presented as reduced one-step processes character- ized by stoichiometry vectors and rate functions. However, each enzymatic reaction can be decomposed into several steps that define the reaction mechanism. The re- sulting stoichiometry and global rate depend on the mechanism. Several methods were designed for calculating effective rates of arbitrarily complex mechanisms. For single route enzyme reactions King and Altman [9] proposed a graphical method to compute global rates; these are rational functions of the concentrations (an example is the Michaelis-Menten equation). Yablovsky and Lazman [13] studied the same problem for more general mechanisms and found that in this case the reaction rates are solutions of polynomial equations; these can be solved by radicals in a few num- ber of cases and can be calculated by multi-variate hypergeometric series in general [13]. Truncation of these series to finite order leads to rational approximations of the reaction rates.
In chemical kinetics with rational reaction rates the concentration xi of the i-th component follows the ordinary differential equation:
dxi = P (x)/Q (x),	(1)
dt	i	i
where Pi(x)= Σα∈Ai ai,αx , Qi(x)= Σβ∈B bi,βx , are polynomials and we have
α	β


1 ≤ i ≤ n. Here xα = xα1 xα2 ... xαn , xβ = xβ1 xβ2 ... xβn , a
,b	, are nonzero

1	2	n
1	2	n
i,α
i,β

real numbers, and Ai, Bi are finite subsets of Nn called supports of Pi and Qi.
A simple example of model with rational reaction rates is the minimal cell cycle oscillator model proposed by Tyson [26]. This example will be studied throughout the paper. The dynamics of this nonlinear model that contains 5 species and 7 reactions is described by a system of 5 polynomial differential equations:
j	= k9y2 − k8y1 + k6y3,	yj = k8y1 − k9y2 − k3y2y5,
yj = kj y4 + k4y4y2/C2 − k6y3, yj = −kj y4 − k4y4y2/C2 + k3y2y5,
3	4	3	4	4	3
j	= k1 − k3y2y5,	where y1 + y2 + y3 + y4 = C.	(2)
Hybridization and tropical geometry.
Tropical geometry is a new branch of algebraic geometry that studies the asymptotic properties of varieties. While algebraic geometry deals with polynomial functions, tropical geometry deals with piecewise linear functions with integer directing slopes. Tropical geometry has a growing number of applications in enumerative problems in nonlinear equation solving [20], statistics [17], traffic optimization [1].
The logarithmic transformation ui = logxi, 1 ≤ i ≤ n, well known for drawing graphs on logarithmic paper, plays a central role in tropical geometry [27]. By

abus de langage, here we call logarithmic paper the image of Rn
by the logarithmic

transformation, even if n > 2. Monomials M (x)= aαxα with positive coefficients

aα > 0, become linear functions, logM = logaα+ < α, log(x) >, by this transfor- mation. Furthermore, the euclidian distance on the logarithmic paper is a good measure of separation (see next section).
Litvinov and Maslov [11,10] proposed a heuristic (correspondence principle) al- lowing to transform mathematical objects (integrals, polynomials) into their quan-
tified (tropical) versions. According to this heuristic, to a polynomial with positive real coefficients Σα∈A aαxα, where A ⊂ Nn is the support of the polynomial, one associates the max-plus polynomial maxα∈A{log(aα)+ < log(x),α >}.
We adapt this heuristic to associate a piecewise-smooth hybrid model to the
system of rational ODEs (1).
Definition 3.1 We call tropicalization of the smooth ODE system (1) the following piecewise-smooth system:


dxi = s exp[max dt	i

α∈Ai
{log(|ai,α
|)+ < u,α >}− max

β∈Bi
{log(|bi,β
|)+ < u,β >}],
(3)

where u = (logx1,..., logxn), si = sign(ai,αmax )sign(bi,βmax ) and ai,αmax , αmax ∈ Ai (respectively, bi,βmax , βmax ∈ Bi) denotes the coefficient of a monomial of the numerator (respectively, of the denominator) for which the maximum occurring in
(3) is attained.
In a different notation this reads:

dxi = Dom{a dt


i,α

xα}α∈A

/Dom{b


i,β

xβ}


α∈Bi

,	(4)

where Dom{ai,αxα}α∈A = sign(ai,α	)exp[maxα∈A {log(|ai,α|)+ < u,α >}].
Finally, the tropicalization can be written with Heaviside functions:

dxi
Σα∈A
ai,αxα   α′/=α θ(< α − αj, log(x) > +log(|ai,α|) − log(|ai,α′ |))

dt = Σ

β∈Bi
bi,β
xβ 

β′/=β
θ(< β − βj, log(x) > +log(|bi,β
|) − log(|bi,β
,	(5)
′ |))

where θ(x)=1 if x > 0, 0 if not. The following definitions are standard and will be used throughout the paper:
Definition 3.2 The Newton polytope of a polynomial P (x) = Σα∈A aαxα is de- fined as the convex hull (in Rn) of the support of P , New(P )= conv(A).
Definition 3.3 The max-plus polynomial Pτ (x)= max{log|aα|+ < α, log(x) >} is called the tropicalization of P (x). The logarithmic function is defined as log(x): Rn → Rn, log(x)i = log(xi).
Definition 3.4 The set of points x ∈ Rn where Pτ (x) is not smooth is called tropical variety. Alternative names are used such as logarithmic limit sets, Bergman fans, Bieri-Groves sets, or non Archimedean amoebas [18].
In two dimensions, a tropical variety is a tropical curve made of several half- lines (tentacles) and finite intervals [14]. A tropical line corresponds to only three

monomials and is made of three half lines sharing a common point. The tentacles and the intervals of the tropical variety are orthogonal to the edges and point to the interior of the Newton polygon [18] (see Fig.1).

Dominance and separation.
The above heuristic is related to the notion of dominance. Actually we have replaced each polynomial in the rational function by the dominant monomial. Dominance of monomials has an asymptotic meaning inside cones of the logarithmic paper. For instance xα dominates xβ on the half plane < log(x),α−β >> 0 of the logarithmic paper. We have xβ/xα → 0 when the limit is taken along lines in this half plane.
For practical applications, we would also need a finite scale notion of dominance. Let M1(x) = aα xα1 and M2(x) = aα xα2 be two monomials. We define the following binary relations:

Definition 4.1 [Separation] M1 and M2 are separated on a domain D ⊂ Rn
at a

level ρ > 0 if |log(|aα |xα1 ) − log(|aα |xα2 )| > ρ for all x ∈ D.
1	2
On logarithmic paper, two monomials are separated on the domain D, if D is separated by the euclidian distance ρ from the hyperplane < log(x), α1 − α2 >= log|aα2 |− log|aα1 |.
Definition 4.2 [Dominance] The monomial M1 dominates the monomial M2 at the level ρ > 0, M1 >ρ M2, if log(|aα |xα1 ) > log(|aα |xα2 )+ ρ for all x ∈ D ⊂ Rn .
1	2	+
Dominance is a partial order relation on the set of multivariate monomials de- fined on subsets of Rn .
Dominance and global reduction of large models.
There are two simple methods for model reduction of nonlinear models with mul- tiple timescales: the quasi-equilibrium (QE) and the quasi-steady state (QSS) ap- proximations. As discussed in [8], these two approximations are physically and dynamically distinct. Here we present a method allowing to detect QE reactions and QSS species. Like in [19], the first step of the method is to detect the ”slaved” species, i.e. the species that obey quasi-steady state equations. These can be for- mally defined by introducing the notion of imposed trace. Given the traces x(t) of all the species, the imposed trace of the i-th species is a real stable root x∗(t) of the polynomial equation Pi(x1(t),..., xi−1(t), x∗(t), xi+1(t),..., xn(t)) = 0 (sta-

bility means that dPi
i
< 0 at this root). Eventually, there may be several imposed

traced, because a polynomial equation can have several real roots.
Definition 5.1 We say that a species is slaved if the distance between the traces xi(t) and some imposed trace x∗(t) is small on some interval, supt∈I|log(xi(t)) − log(x∗(t))| < δ, for some δ > 0 sufficiently small. A species is globally slaved if I = [T, ∞) for some T ≥ 0.

Slaved species are good candidates for QSS species and this criterion was used to identify QSS species in [19]. More generally, slaved species are involved in rapid processes, but are not always QSS. Actually, two distinct cases lead to slaved species. Quasi-equilibrium. A system with fast, quasi-equilibrium reactions has the fol-
lowing structure [8]:

dx = Σ
R (x)γs + 1
Σ R (x)γf ,	(6)


dt	s
s,slow


ϵ	f
f,fast

where ϵ > 0 is a small parameter γs, γf ∈ Zn are stoichiometric vectors. To separate slow/fast variables, we have to study the spaces of linear conservation law of the initial system (6) and of the following fast subsystem:

dx	1
=
Σ R (x)γf .	(7)


	
dt	ϵ
f
f,fast

In general, the system (6) can have several conservation laws. These are linear functions b1(x),..., bm(x) of the concentrations that are constant in time. The conservation laws of the system (7) provide variables that are constant on the fast timescale. If they are also conserved by the full dynamics, the system has no slow variables (variables are either fast or constant). In this case, the dynamics of the fast variables is simply given by Eq.(7). Suppose now that the system (7) has some more conservation laws bm+1(x),..., bm+l(x), that are not conserved by the full system (6). Then, these provide the slow variables of the system. The fast variables are those xi such that (γf )i /= 0, for some fast reaction f . Let us suppose that the fast system (7) has a stable steady state that is a solution of the QE equations (augmented by the conservation laws of the fast system):

Σ

f,fast
Rf (x)γf = 0,	(8)

bi(x)= Ci,	1 ≤ i ≤ m + l.	(9)
By classical singular perturbation methods [25,28] one can show that the fast vari- ables can be decomposed as xi = x˜i + ηi where x˜i satisfy the QE equations (8) and ηi = &(ϵ), meaning that the fast variables xi are slaved [8].
Let us consider that the reaction rates Rs(x), Rf (x) are polynomial functions
of x.	Let Pi, P˜i be the polynomials Σ	Rs(x)γs + 1 Σ	Rf (x)γf and

Σf,fast
Rf (x)γf , respectively. We call P˜i the pruned version of Pi. When ϵ is

small enough, the monomials of the pruned version P˜i dominate the monomials of
Pi. The practical recipe for identifying QE reactions is given by the Algorithm 1. A more general algorithm, applicable to rational rates, will be given elsewhere.
Quasi-steady state. In the most usual version of QSS approximation [23], the species are split in two groups with concentration vectors xs (“slow” or basic com- ponents) and xf (“fast” or QSS species). Quasi-steady species (also called radicals or fast intermediates) are low-concentration, slaved species. Typically, QSS species

Algorithm 1
Step 1: Detect slaved species by comparing unconstrained and imposed traces.
Step 2: For each Pi corresponding to slaved species, compute the pruned version P˜i by eliminating all monomials that are dominated by other monomials of Pi.
Step 3: Identify, in the structure of P˜i the rates of various reactions. This step could be performed by recipes presented in [22]. If both forward and backward rates are found in the pruned polynomials then the corresponding reaction is QE.
are consumed (rather than produced) by fast reactions. The small parameter ϵ used in singular perturbation theory is now the ratio of small concentrations of fast intermediates to the concentration of other species. After rescaling xs and xf to order one, the set of kinetic equations reads:

dxs dt
= W s
(xs, xf
),	(10)

dxf
f	s	f

= (1/ϵ)W
dt
(x , x
),	(11)

where the functions W s, W f and their derivatives are of order one (0 < ϵ << 1).
Let us suppose that the fast dynamics (11) has a stable steady state. The standard singular perturbation theory[25,28] provides the QSS algebraic condition W f (xs, xf ) = 0 which means that fast species xf are slaved. These equations, together with additional balances for xf (conservation laws) are enough to deduce the fast variables xf as functions of the slow variables xs and to eliminate them [29,12,19]. The slow dynamics is given by Eq.(10).
In models with polynomial reaction rates, W f (xs, xf ) are polynomial functions, that can be pruned by eliminating dominated monomials. Contrary to the QE

situation, in QSS conditions the pruned polynomial
P˜i no longer contains both

forward and backward rates of QE reactions, ie the step 3 of Algorithm 1 does not identify reversible reactions. Alternatively, one can realize that slaved species can have relatively large concentrations, in which case they are not QSS species. However, it is difficult to say which concentration value separates QSS from non QSS species among slaved species, hence the former, dominance criterion is better.

Sliding modes of the tropicalization.
A notable phenomenon resulting from tropicalization is the occurrence of sliding modes. Sliding modes are well known for ordinary differential equations with dis- continuous vector fields [5]. In such systems, the dynamics can follow discontinuity hypersurfaces where the vector field is not defined.
The conditions for the existence of sliding modes are generally intricate. How- ever, when the discontinuity hypersurfaces are smooth and n − 1 dimensional (n is the dimension of the vector field) then sufficient conditions for sliding modes read:
< n+(x), f+(x) >< 0,	< n−(x), f−(x) >< 0,	x ∈ Σ,	(12)

where f+, f− are the vector fields on the two sides of Σ and n+ = −n− are the interior normals.
Let us consider that the smooth system (1) has quasi-steady state species or quasi-equilibrium reactions. In this case, the fast dynamics reads:
dxi	1 ˜	˜
dt = ϵ Pi(x)/Qi(x),	i	fast,	(13)


where
P˜i(x),
Q˜i(x) are pruned versions of Pi, Qi, and ϵ is the small, singular

perturbation parameter.
For sufficiently large times, the fast variables satisfy (to &(ϵ)):
P˜i(x)= 0,	i	fast.	(14)

The pruned polynomial is usually a fewnomial (contains a small number of monomials). In particular, let us consider the case when only two monomials remain after pruning, P˜i(x)= a1xα1 + a2xα2 . Then, the equation (14) defines a hyperplane S = {< log(x), α1 − α2 >= log(|a1|/|a2|)}. This hyperplane belongs to the tropical variety of P˜i, because it is the place where the monomial xα1 switches to xα2 in the max-plus polynomial defined by P˜i. For ϵ small, the QE of QSS conditions guarantee the existence of an invariant manifold Mє, whose distance to S is &(ϵ).

Let n+, n− defined as above and let (f+)i =
1
Q˜i(x)
a1xα1 , (f−)i =
1
Q˜i(x)
a2xα2 ,

fi = 1 [(f
+)i
+ (f
−)i] for i fast, (f
+)j
= (f
−)j
= fj =
P˜j  , for j not fast. Then,
Qj

the stability conditions for the invariant manifold read < n+(x+),f (x+) >< 0,
< n−(x−),f (x−)) >< 0, where x+, x− are close to Mє on the side towards which points n+ and n−, respectively. We note that |(f+)i(x+)| > |(f−)i(x+)|. Thus, < n+,f >= 1 (n+)i[(f+)i + (f−)i]+  j,notfast(n+)j(f+)j and < n+, f+ >=
1 (n+)i(f+)i + Σj,notfast(n+)j(f+)j. Thus, if < n+,f >< 0, then for ϵ small enough
(n+)i(f+)i < 0 and < n+, f+ >< 0 because < n+,f >>< n+, f+ >. Similarly, we show that < n−,f >< 0 implies < n−, f− >< 0. This proves the following
Theorem 6.1 If the smooth dynamics obeys QE or QSS conditions and if the

pruned polynomial P˜
deﬁning the fast dynamics is a 2-nomial, then the QE or

QSS equations deﬁne a hyperplane of the tropical variety of P˜. The stability of the
QE of QSS manifold implies the existence of a sliding mode of the tropicalization along this hyperplane.
The converse result, i.e. deducing the stability of the QE/QSS manifold from the existence of a sliding mode on the tropical variety may be wrong. Indeed, it is possible for a trajectory of the smooth system to be close to a hyperplane of the tropical variety carrying a sliding mode and where the QE/QSS equations are satisfied identically. However, as we will see in the next section, this trajectory can leave the hyperplane sooner than the sliding mode.




Fig. 1. (top left) Detection of slaved species by comparing traces to imposed traces: the species y1, y2, y5 are slaved globally, the species y3, y4 are slaved on intervals Q3,Q4, respectively. (top right) Comparison of monomials of the polynomial systems of quasi-steady state equations. (bottom left) Newton polygons and inner normals of the reduced two dimensional polynomial model. (bottom right) Phase portrait on logarithmic paper of the reduced two dimensional model. We represent the two tropical curves (the tripods graphs, a red and a blue one), the modes (smooth vector fields within domains bordered by tropical curves tentacles), the smooth and tropicalized limit cycles. The tropicalized cycle contains two sliding modes S3,S4
corresponding to the intervals Q3, Q4 on which y3, y4 are quasi-stationary, respectively.

From smooth to hybrid models via reduction.
Starting with the system (2) we first reduce it to a simpler model. The analysis of the model is performed for the values of parameters from [26], namely k1 = 0.015, k3 = 200, k4 = 180, kj = 0.018, k6 = 1, k7 = 0.6, k8 = 1000000, k9 = 1000;
In order to do that we generate one or several traces (trajectories) yi(t). The smooth system has a stable periodic trace which is a limit cycle attractor. We also

compute the imposed traces y∗(t) that are solutions of the equations:
k9y2(t) − k8y∗(t)+ k6y3(t)= 0, k8y1(t) − k9y∗(t) − k3y2(t)y5(t)= 0,
kj y4(t)+ k4y4(t)y∗2(t)/C2 − k6y∗(t)= 0,
4	3	3
−kj y∗(t) − k4y∗(t)y2(t)/C2 + k3y2(t)y5(t)= 0,

4 4	4	3
k1 − k3y2(t)y∗(t)= 0.	(15)

We find that, for three species y1,y2, and y5, the distance between the traces y∗(t) and yi(t) is small for all times which means that these species are slaved on the whole limit cycle (Figure 1 top left). Also, we have a global conservation law y1 + y2 + y3 + y4 = C, that can be obtained by summing the first four differential equations in (2). The three quasi-steady state equations for the three slaved species have to be solved jointly with the global conservation law:
k9y2 − k8y1 + k6y3 = 0, k8y1 − k9y2 − k3y2y5 = 0, k1 − k3y2y5 = 0,
y1 + y2 + y3 + y4 = C.	(16)
Comparison of the monomials (for values of parameters as above) in this system shows that max(k8y1, k9y2) > k6y3, and max(k8y1, k9y2) > k3y2y5 (Fig.1 top right) which leads to the pruned system:
k8y1 − k9y2 = 0, k8y1 − k9y2 = 0, k1 − k3y2y5 = 0,
y1 + y2 + y3 + y4 = C.	(17)
The first two equations are identical and correspond to quasi-equilibrium of the reaction between y1 and y2. The third equation means that y5 is a quasi-steady state species. The pruned system allows the elimination of the variables y1, y2, y5. The slow variable y12 = y1 + y2 demanded by the quasi-equilibrium condition (this is a conservation law of the fast system) can be eliminated by using the global conservation law.
We note that the dominance relations leading to the pruned equations were found numerically in a neighborhood of the periodic trace. This means that QE and QSS approximations are valid at least on the limit cycle. More global testing of these relations will be presented elsewhere. Note that the system (16) can be solved also without pruning. However, (16) has four independent equations allowing to eliminate four of the five dynamic variables leading to a one dimensional dynamical system. It turns out that the correct application of the QE and QSS approximations has to use (17) and not (16).
After elimination, we obtain the following reduced differential-algebraic dynam- ical system:

yj	= kj y4 + k4y4y2/C2 − k6y3,
3	4	3
yj	= −kj y4 − k4y4y2/C2 + k1,
4	4	3
y1	= (C − y3 − y4)k9/(k8 + k9),
y2	= (C − y3 − y4)k8/(k8 + k9),
y5 = k1(k8 + k9)/(k3k8(C − y3 − y4).	(18)
Now we tropicalize this reduced system. The tropicalization could have been done on the initial system in which case the pruned equations (17) would indicate that the reduced dynamics is a sliding mode of the tropicalized system on the two dimensional hypersurface k8y1 = k9y2, k1 = k3y2y5, y1 + y2 + y3 + y4 = C. However, although the result (concerning the dynamics on the QE/QSS manifold) should be the same, it is much handier to tropicalize the reduced system (18). Indeed, the tropicalization of the full 5D system is difficult to visualize and would also produce complex modes that can not be reduced to 2D (these modes describe the fast relaxation to the QE/QSS manifold).
The resulting hybrid model reads:
yj = Dom{kj y4, k4y4y2/C2, −k6y3},
3	4	3
yj  = Dom{−kj y4, −k4y4y2/C2, k1},

4	4	3
(19)

or equivalently using Heaviside functions:

yj = kj y θ(−h

2u )θ(h + u
u )+  k4 y y2θ(h

+ 2u )θ(h + h + u + u )

3	4 4	1
3	2	4
3	C2 4 3	1
3	1	2	4	3

−k6y3θ(−h2 − u4 + u3)θ(−h1 − h2 − u4 − u3),

yj = −kj y θ(−h − 2u )θ(−h
+ u ) −  k4 y y2θ(h
+ 2u )θ(h − h + 2u + u )

4	4 4	3	3
4	4	C2 4 3	3
3	3	4	3	4

k1θ(h4 − u4)θ(−h3 + h4 − 2u3 − u4),	(20)
where h1 = h3 = log(k4/(kj C2)), h2 = log(kj /k6), h4 = log(k1/kj ).
4	4	4
The Newton polygons of the polynomials kj y4 + k4y4y2/C2 − k6y3 and −kj y4 −
4	3	4
k4y4y2/C2 − k6y3 are triangles (Fig.1 bottom left). The two triangles share a com-
mon edge which is a consequence of the fact that the reduced model have two reactions each one acting on the two species. The tentacles of the two tropical curves (in red and blue in Fig.1 bottom right) point in the same directions as the inner normals to the edges of the Newton polygons (the corresponding equations are h1 + 2u3 = 0, h2 + u4 − u3 = 0, h1 + h2 + u4 + u3 = 0 for one and h3 + 2u3 = 0, h4 + u4 = 0, h3 − h4 + 2u3 + u4 = 0 for the other). These tentacles (half lines) decompose the positive quarter plane into 6 sectors corresponding to the 6 modes of the hybrid model.
In Fig.1 bottom right we have also represented the phase portrait of the reduced model on logarithmic paper. The dynamical variables are u3 = log(y3) and u4 =
log(y4). The vector field corresponding to uj = yj /y3 and uj = yj /y4 was computed
3	3	4	4
with the dominant monomials in each plane sector as follows:

uj	= −k4y2, uj = −k6 for the mode 1,
4	3	3
uj = −k4y2, uj = k4y3y4 for the mode 2,
4	3	3

uj  = k1y—1, uj
= k4y3y4 for the mode 3,

4	4	3
uj = k1y—1, uj = kj y4y—1 for the mode 4,
4	4	3	4	3
uj	= k1y—1, uj = −k6 for the mode 5,
4	4	3
uj = −kj , uj = kj y4y—1 for the mode 6.	(21)
4	4	3	4	3
Like the smooth system, the tropicalization has a stable periodic trajectory (limit cycle). This is represented together with the limit cycle trajectory of the smooth system in Fig.1 bottom right. The period of the tropicalized limit cycle is slightly changed with respect to the period of the smooth cycle. However, we can modulate the period of the tropicalized cycle and make it fit the period of the smooth cycle by acting on the moments of the mode change. This stands to displacing the tentacles of the tropical varieties parallel to the initial positions or equivalently, to changing the parameters h1, h2, h3, h4 while keeping h1 = h3 which is a symmetry of the problem.
The tropicalized system has piecewise smooth hybrid dynamics. Typically, it passes from one type of smooth dynamics (mode) described by one set of differential equations to another smooth dynamics (mode) described by another set of differen- tial equations (the possible modes are listed in Eq.(21)). The command to change the mode is intrinsic and happens when the trajectory attains the tropical curve. However, if the sliding mode condition (12) is fulfilled the trajectory continues along some tropical curve tentacle instead of changing plane sector and evolve according to one of the interior modes (21). The tropicalized limit cycle has two sliding modes (S4 and S3 in Fig.1). The first one is along the half-line h3 −h4 +2u3 +u4 = 0 on the logarithmic paper (tentacle S4 on the red tropical curve in Fig.1). In order to check
(12) we note that f + = (k1y—1, −k6), f— = (−k4y2, −k6), n+ = −n— = (−1, −2).
4	3
We have a sliding mode if −k1y—1 + 2k6 < 0, meaning that the exit from the sliding mode occurs when u4 > log(k1/(2k6)). The second sliding mode is along the tentacle h2 + u4 − u3 = 0 (S3 on the blue tropical curve in Fig.1). We have
f + = (k1y—1, −k6), f— = (k1y—1, kj y4y—1), n+ = −n— = (−1, 1). The conditions
4	4	4	3
(12) are fulfilled when k1y—1 − kj y4y—1 < 0 which is satisfied on the entire tenta-
4	4	3
cle. The exit from this second mode occurs at the end of the blue tropical curve
tentacle. Interestingly, the sliding modes of the tropicalization can be put into cor- respondence with places on the smooth limit cycle where the smooth limit cycle acquires new QSS species. This can be seen in Fig.1 top left. The species y3 be- comes quasi-stationary on time intervals Q3 that satisfy (with good approximation) the relation h2 + u4 −u3 = 0 and correspond to the sliding mode on the blue tropical curve. Also, the species y4 becomes quasi-stationary on very short time intervals Q4 that satisfy h3 − h4 + 2u3 + u4 = 0 and correspond to the sliding mode on the red tropical curve. As pointed out in the preceding section, the trajectories of the smooth dynamics can evolve close to the tentacles, but leave them sooner than the sliding modes.
We end this section with a study of the bifurcations of the ODE model and of its

tropicalization. It is easy to check that there is only one degree of freedom describing the relative position of the two tropical curves. This is the distance between the
origins of the tropical curves, that is given by the combination k1kj—1/2k1/2k—1.
4	4	6
Thus, by changing any one of the parameters k1, kj , k4, k6 we can invert the relative
position of the tropical curves and change the partition of the logarithmic paper into domains. This leads to two Hopf bifurcations of the ODE model and also two Hopf bifurcations of the tropicalization. The bifurcation of the tropicalization is discontinuous (the limit cycle oscillation amplitude does not vanish at bifurcation) and can also be delayed with respect to the continuous bifurcation of the ODE model (Fig.2).

Fig. 2. Hopf bifurcations of the smooth and tropicalized system. (left) The relative positions of the tropical curves can be changed by changing the combination k1k′−1/2k1/2k−1. The first Hopf bifurcation corre-
4	4	6
sponds to k1k′−1/2k1/2k−1 = 1, i.e. log(k1)= —4.61, when the tropical curves intersect in a single point.
4	4	6
For the second Hopf bifurcation the relative position of the two tropical curves is no longer exceptional; the position of the bifurcation results from sliding modes stability analysis. (right) Amplitudes of oscillation
are shown for the tropicalization (blue) and for the smooth system (red);


Solving ordinary differential equations in triangular form
In order to illustrate the gain that one can obtain from model reduction, we give a digest of the algorithmic complexity for solving systems of the type (1) and more generally, an arbitrary system of ordinary differential equations:
Gj(x1, x(1),..., x(r), x2, x(1),..., x(r),..., xn, x(1),..., x(r), t)= 0, 1 ≤ j ≤ N, (22)
1	1	2	2	n	n
where Gj are differential polynomials of the order at most r in the derivatives x(s) =
∂sxi/∂ts, s ≤ r. Let the degrees of the differential polynomials Gj do not exceed d.

Finally, for algorithmic complexity purposes we assume that the coefficients of Gj are integers with absolute values less than 2l, the latter means that the bit-size of the coefficients l(Gj) ≤ l.
In [21] an algorithm was designed which works not only for ordinary differential systems like (22), but even for systems of partial differential equations. For ordinary systems (22) the algorithm was improved in [7], although still its complexity is rather big (see below). We describe the ingredients of the output (which has a triangular form) of the latter improved algorithm and provide for it the complexity bounds.
The algorithm executes the consecutive elimination of the indeterminates xn,..., x1. The algorithm yields a partition P = {Pi}1≤i≤M of the space of the possible functions x1. Each Pi is given by a system of an equation fi,1(x1, t)=0 and an inequality gi,1(x1, t) /= 0 for suitable differential polynomials fi,1, gi,1. Then the algorithm yields an equation fi,2(x1, x2, t) = 0 and an inequality gi,2(x1, x2, t) /= 0 for x2 for suitable differential polynomials fi,2, gi,2. We underline that the latter equation and inequality hold on Pi. One can treat the system fi,2 = 0, gi,2 /= 0 as the conditions on x2 with the coefficients being some differential polynomials in x1 (satisfying Pi). Continuing in a similar way, the algorithm produces a tri- angular system of differential polynomials fi,3(x1, x2, x3, t), gi,3(x1, x2, x3, t), ... , fi,n(x1,..., xn, t), gi,n(x1,..., xn, t). Thus, at the end xn satisfies (on Pi) the equa- tion fi,n(x1,..., xn, t) = 0 and the inequality gi,n(x1,..., xn, t) /= 0 treated as a system with the coefficients being differential polynomials in x1,..., xn—1.
In other words, suppose that one has a device being able to solve an ordi- nary differential system f (x) = 0, g(x) /= 0 in a single indeterminate x. Then the algorithm would allow one to solve the system (22) consecutively: first produc- ing x1 satisfying fi,1(x1, t) = 0, gi,1(x1, t) /= 0, after that producing x2 satisfying fi,2(x1, x2, t)= 0, gi,2(x1, x2, t) /=0 and so on.
This completes the description of the output of the algorithm. Now we turn to the issue of its complexity. One can bound the orders of the differential polynomials ord(fi,s), ord(gi,s) ≤ r · 2n := R, 1 ≤ i ≤ M, 1 ≤ s ≤ n, the number of the elements in the partition and the degrees M, deg(f ), deg(g ) ≤ (Nd)2R := Q. Finally, the bit-size of the integer coefficients of fi,s, gi,s and the complexity of the algorithm can be bounded by a certain polynomial in l, Q. Thus, the number n of the indeterminates brings the main contribution into the complexity bound, which is triple exponential in n. Of course, the above bounds have an a priori nature: they take into the account all the conceivable possibilities in the worst case, whereas in practical computations considerable simplifications are usually expected.

Conclusion
Tropical geometry offers a natural framework to study biochemical networks with multiple timescales and rational reaction rate functions. First, and probably most importantly, tropicalization can guide model reduction of ODE systems. We have shown that the existence of quasi-equilibrium reactions and of quasi-stationary species implies the existence of sliding modes along the tropical variety. Conversely,

when the tropicalization has sliding modes along hyperplanes defined by the equality of two monomials, we propose an algorithm to decide whether the system has quasi- equilibrium reactions or quasi-equilibrium species. This distinction allows correct model reduction, and represents an improvement of methods proposed in [19].
The tropicalization represents an abstraction of the ODE model. This abstrac- tion may be not sound for some dynamic properties, but may conserve others. If the trajectories of the ODE model are either very far or very close to the tropical vari- eties, they tend to remain close to the trajectories of the tropicalization for a while. However, the quality of the approximation is not guaranteed at finite distance from the tropical variety. For instance, the exit of tropicalized trajectories from a sliding mode tends to be delayed, and smooth trajectories leave earlier neighborhoods of tropical varieties. The example studied in this paper also illustrates some properties of bifurcations of the tropicalization, that we have tested numerically. The tropi- calization qualitatively preserves the type and stability of attractors, but can also introduce delays of a Hopf bifurcation. Thus, the tropicalization can only roughly indicate the position of the bifurcation of the ODE model. Furthermore, close to the bifurcation, the amplitude of the limit cycle oscillations behaves differently for the ODE model and for the tropicalization. The two detected Hopf bifurcations are continuous (the oscillation amplitude vanishes at bifurcation) for the ODE model and discontinuous (the oscillation amplitude does not vanish at bifurcation) for the tropicalization.
The tropicalization provides in the same time a reduced model and a ”skeleton” for the hybrid dynamics of the reduced model. This skeleton, specified by the tropi- cal varieties, is robust. As a matter of fact, monomials of parameters are generically well separated [6]. This implies that tropicalized and smooth trajectories are not that far one from another. Furthermore, because the tropicalized dynamics is ro- bust, it follows that the system can tolerate large relative changes of the parameters without strong modifications of its dynamics.
The dynamics of the model studied in this paper is relatively simple: it has a limit cycle embedded in a two dimensional invariant manifold. As future work we intend to extend the approach to more complex attractors, such as cycles in dimension larger than two and chaotic attractors. Methods to compute tropical varieties in any dimension are well developed in tropical algebraic geometry [2]. Given the tropical variety, the existence of sliding modes can be easily checked and the pruned polynomials defining the fast dynamics calculated. This should lead directly to identification of quasi-equilibrium reactions and quasi-stationary species, without the need of simulation (Step 1 in the Algorithm 1). Proposing simplified descriptions of the dynamics of large and imprecise systems, tropical geometry techniques could find a wide range of applications from synthetic biology design to understanding emerging properties of complex biochemical networks.

Acknowledgement
VN was supported by University of Rennes 1. SV was supported by the Russian Foundation for Basic Research (Grant Nos. 10-01-00627 s and 10-01-00814 a) and the CDRF NIH (Grant No. RR07801) and by a visiting professorship grant from the University of Montpellier 2.

References
J.P. Aubin. Macroscopic traffic models: Shifting from densities to ”celerities”. Applied Mathematics and Computation, 217:963–971, 2010.
T. Bogart, A.N. Jensen, D. Speyer, B. Sturmfels, and R.R. Thomas. Computing tropical varieties.
Journal of Symbolic Computation, 42(1-2):54–73, 2007.
A. Crudu, A. Debussche, and O. Radulescu. Hybrid stochastic simplifications for multiscale gene networks. BMC Systems Biology, 3(1):89, 2009.
V. Danos, J. Feret, W. Fontana, R. Harmer, and J. Krivine. Rule-based modelling of cellular signalling.
CONCUR 2007–Concurrency Theory, pages 17–41, 2007.
A.F. Filippov and FM Arscott. Differential equations with discontinuous righthand sides, volume 18. Springer, 1988.
AN Gorban and O. Radulescu. Dynamic and static limitation in reaction networks, revisited . In David West Guy B. Marin and Gregory S. Yablonsky, editors, Advances in Chemical Engineering - Mathematics in Chemical Kinetics and Engineering, volume 34 of Advances in Chemical Engineering, pages 103–173. Elsevier, 2008.
D. Grigoriev. Complexity of quantifier elimination in the theory of ordinary differential equations. Lect. Notes Comput. Sci., 378:11–25, 1989.
AN Gorban, O. Radulescu, and AY Zinovyev. Asymptotology of chemical reaction networks. Chemical Engineering Science, 65:2310–2324, 2010.
E.L. King and C. Altman. A schematic method of deriving the rate laws for enzyme-catalyzed reactions.
The Journal of Physical Chemistry, 60(10):1375–1378, 1956.
G.L. Litvinov and V.P. Maslov. Idempotent mathematics: a correspondence principle and its applications to computing. Russian Mathematical Surveys, 51(6):1210–1211, 1996.
G.L. Litvinov, V.P. Maslov, and G.B. Shpiz. Idempotent functional analysis: an algebraic approach.
Mathematical Notes, 69(5):696–729, 2001.
Mark Z. Lazman and Gregory S. Yablonsky. Chapter 2 overall reaction rate equation of single-route complex catalytic reaction in terms of hypergeometric series. In David West Guy B. Marin and Gregory S. Yablonsky, editors, Advances in Chemical Engineering - Mathematics in Chemical Kinetics and Engineering, volume 34 of Advances in Chemical Engineering, pages 47 – 102. Elsevier, 2008.
M.Z. Lazman and G.S. Yablonsky. Overall reaction rate equation of single-route complex catalytic reaction in terms of hypergeometric series. Advances in Chemical Engineering, 34:47–102, 2008.
G. Mikhalkin. Enumerative tropical algebraic geometry in r2. AMERICAN MATHEMATICAL SOCIETY, 18(2):313–377.
V. Noel, S. Vakulenko, and O. Radulescu. Piecewise smooth hybrid systems as models for networks in molecular biology. In Proceedings of JOBIM 2010. Jobim, 2010.
V. Noel, S. Vakulenko, and O. Radulescu. Algorithm for identification of piecewise smooth hybrid systems; application to eukaryotic cell cycle regulation. In Proceedings of WABI 2011, to appear, 2011.
L. Pachter and B. Sturmfels. Tropical geometry of statistical models. Proceedings of the National Academy of Sciences of the United States of America, 101(46):16132, 2004.
M. Passare and A. Tsikh. Amoebas: their spines and their contours. In Idempotent mathematics and mathematical physics: international workshop, February 3-10, 2003, Erwin Schr¨odinger International Institute for Mathematical Physics, Vienna, Austria, volume 377, page 275. Amer Mathematical Society, 2005.

O. Radulescu, A.N. Gorban, A. Zinovyev, and A. Lilienbaum. Robust simplifications of multiscale biochemical networks. BMC systems biology, 2(1):86, 2008.
J.M. Rojas. Why polyhedra matter in non-linear equation solving. In Topics in algebraic geometry and geometric modeling: Workshop on Algebraic Geometry and Geometric Modeling, July 29-August 2, 2002, Vilnius University, Lithuania, volume 334, page 293. Amer Mathematical Society, 2003.
A. Seidenberg. An elimination theory for differential algebra. Univ. of California Press, 3(2):31–66, 1956.
S. Soliman and M. Heiner. A unique transformation from ordinary differential equations to reaction networks. PloS one, 5(12):e14284, 2010.
L.A. Segel and M. Slemrod. The quasi-steady-state assumption: a case study in perturbation. SIAM Review, 31(3):446–477, 1989.
B. Sturmfels. Solving systems of polynomial equations. American mathematical society, 2002.
A. N. Tikhonov, A. B. Vasileva, and A. G. Sveshnikov. Differential equations. Springer, Berlin, 1985.
J.J. Tyson. Modeling the cell division cycle: cdc2 and cyclin interactions. Proceedings of the National Academy of Sciences of the United States of America, 88(16):7328, 1991.
O. Viro. From the sixteenth hilbert problem to tropical geometry. Japanese Journal of Mathematics, 3(2):185–214, 2008.
W. Wasow. Asymptotic Expansions for Ordinary Differential Equations. Wiley, New York, 1965.
GS Yablonskii, VI Bykov, AN Gorban, and VI Elokhin. Kinetic models of catalytic reactions. Comprehensive Chemical Kinetics, volume 32. Elsevier, Amsterdam, 1991.
