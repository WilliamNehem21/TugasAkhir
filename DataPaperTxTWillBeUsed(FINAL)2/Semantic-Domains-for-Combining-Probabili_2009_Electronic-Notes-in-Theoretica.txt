

Electronic Notes in Theoretical Computer Science 222 (2009) 3–99
www.elsevier.com/locate/entcs

Semantic Domains
for Combining Probability and Non-Determinism
Regina Tixa, Klaus Keimela and Gordon Plotkinb
a Fachbereich Mathematik, Technische Universita¨t Darmstadt, Germany
b University of Edinburgh, UK

Abstract
We present domain-theoretic models that support both probabilistic and nondeterministic choice. In [36], Morgan and McIver developed an ad hoc semantics for a simple imperative language with both probabilistic and nondeterministic choice operators over a discrete state space, using domain-theoretic tools. We present a model also using domain theory in the sense of D.S. Scott (see e.g. [15]), but built over quite general continuous domains instead of discrete state spaces.
Our construction combines the well-known domains modelling nondeterminism – the lower, upper and con- vex powerdomains, with the probabilistic powerdomain of Jones and Plotkin [24] modelling probabilistic choice. The results are variants of the upper, lower and convex powerdomains over the probabilistic pow- erdomain (see Chapter 4). In order to prove the desired universal equational properties of these combined powerdomains, we develop sandwich and separation theorems of Hahn-Banach type for Scott-continuous linear, sub- and superlinear functionals on continuous directed complete partially ordered cones, endowed with their Scott topologies, in analogy to the corresponding theorems for topological vector spaces in func- tional analysis (see Chapter 3). In the end, we show that our semantic domains work well for the language used by Morgan and McIver.
Keywords: Semantic Domains, Nondeterminism, Probabilistic Nondeterminism, Directed Complete Partially Ordered Cones, Hahn-Banach Theorems, Denotational Semantics

Contents
Foreword	5
Introduction	7
Order and Topology	11
DCPOs and Scott-Continuous Functions	11
The Specialisation Order	13
1571-0661/© 2009 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2009.01.002


Powerdomains Combining Probabilistic Choice and. . .
.	86

References	95
Index	98



Foreword

This volume is based on Regina Tix’s 1999 doctoral dissertation [55], entitled Con- tinuous D-cones: Convexity and Powerdomain Constructions and submitted to the
Department of Mathematics of Technische Universit¨at Darmstadt. Only a small part of this thesis, namely three sections of Chapter 3, has previously been pub- lished (see [56]). Since then, the main body of the thesis, Chapter 4 on power- domains for modelling non-determinism, has become of increasing interest: indeed the main goal of the thesis was to provide semantic domains for modelling the si- multaneous occurrence of probabilistic and ordinary non-determinism. It therefore seemed appropriate to make the thesis available to a general audience.
There has been a good deal of progress in the relevant domain theory since the thesis was submitted, and so Klaus Keimel has rewritten large parts of the text, while maintaining the global structure of the original dissertation. As well as making a great number of minor changes, he has incorporated some major improvements.
Gordon Plotkin has proved a Strict Separation Theorem for compact sets: all of Section 3.3 is new and essentially due to him. The Strict Separation Theorem 3.8 enables us, in Chapter 4, to eliminate an annoying auxiliary construction used in the original thesis for both the convex upper and the biconvex powercones; one also gets rid of the requirement that the way-below relation is additive, and the whole presentation becomes simplified and shorter.
Next, an annoying hypothesis of a non-equational nature is no longer required for the statement of the universal property of the biconvex powercone. Further, the hypotheses for the lower powercone have been weakened: the universal property for this powercone remains valid without requiring the base domain to be contin- uous. Finally, we have added Section 4.4 explicitly presenting the powerdomains combining probabilistic choice and non-determinism and their universal properties. Combining the extended probabilistic powerdomain with the classical convex pow- erdomain was not possible when Tix’s thesis was submitted: it was not known then whether the extended probabilistic powerdomain over a Lawson-compact contin-

uous domain is Lawson-compact. Extending slightly a recent result from [3], we now know that the extended probabilistic powerdomain is Lawson-compact over any stably locally compact space. For continuous domains the converse also holds. This allows us in particular to include infinite discrete spaces. We have included these new results in section 2.2.
There have also been some terminological changes. For the classical powerdo- mains we now speak of the lower, upper, and convex powerdomains instead of the Hoare, Smyth, and Plotkin ones. Accordingly, for the new powerdomains we speak of the convex lower, convex upper, and biconvex powercones, rather than the convex Hoare, convex Smyth, and convex Plotkin powercones.
D. Varacca [57,58,59] took a related approach to combining probability and non- determinism via indexed valuations. His equational theory is weaker; he weakens one natural equation, but the theory becomes more flexible. M. Mislove [37] has introduced an approach similar to ours for the probabilistic (not the extended prob- abilistic) powerdomain, his goal being a semantics for probabilistic CSP. It is quite likely that our results can be used to deduce analogous properties for the (restricted) probabilistic powerdomain.
Without the 2003 Barbados Bellairs Workshop on Domain Theoretic Methods in Probabilistic Processes and the inspiring discussions there, in particular with
Franck van Breugel, Vincent Danos, Jos´ee Deharnais, Mart´ın Escardo´, Achim Jung, Michael Mislove, Prakash Panangaden, and Ben Worrell, this work would not have been undertaken. Achim Jung’s advice has been most helpful during the preparation of the manuscript.
The diagrams were drawn using Paul Taylor’s diagrams macro package.
Regina Tix Klaus Keimel Gordon Plotkin December 2004



Introduction

The semantics of programming languages has been intensively studied by mathe- maticians and computer scientists. In the late sixties Dana S. Scott invented ap- propriate semantic domains for that purpose [51,49,50]. Continuous domains are directed complete partially ordered sets together with an order of approximation, the so called way-below relation. As they allow one to represent ‘ideal objects’ and their ‘finite approximations’ within one framework, continuous domains provide a suitable universe for denotational semantics. The order can be thought of as an ‘information ordering’. That means the greater an element the more information it carries about the object it approximates. In this approach, computable functions are continuous functions on domains. Moreover, within domains, recursion can be interpreted via least fixed points of continuous functions. Domain theory has since attracted many researchers and evolved in various directions. It owes much to the theory of continuous lattices and domains, most notably [14,15].
An important problem in domain theory is the modelling of non-deterministic features of programming languages and of parallel features treated in a non-determini- stic way. If a non-deterministic program runs several times with the same input, it may produce different outputs. To describe this behaviour, powerdomains were introduced by Plotkin [40,41] and Smyth [52]. A powerdomain over a domain X is a subset of the power set of X. Which subsets of X constitute the powerdomain depends on the kind of non-determinism that is be modelled. There are three classi- cal powerdomain constructions, called the convex, upper, and lower powerdomains, often referred to as Plotkin, Smyth, and Hoare powerdomains.
Probabilistic non-determinism has also been studied and has led to the prob- abilistic powerdomain as a model [47,42,24,23]. Different runs of a probabilistic program with the same input may again result in different outputs. In this situa- tion, it is also known how likely these outputs are. Thus, a probability distribution or continuous valuation on the domain of final states is chosen to describe such a behaviour. Originally attention had been paid to valuations with total mass ≤ 1.

This leads to powerdomains carrying a convex structure. The collection of all con- tinuous valuations (bounded or not) on a continuous domain X, ordered ‘pointwise’, leads to the extended probabilistic powerdomain of X. The extended probabilistic powerdomain carries the structure of a cone, more technically of a continuous d-cone [29], a structure close to that of a an ordered cone in a topological vector space as considered in functional analysis. This development led to an intrinsic interest in d-cones (see also Chapter 2).
For Plotkin’s and Jones’ model of probabilistic computation the continuous d- cone of lower semicontinuous, i.e., Scott-continuous, functions defined on the domain X with values in the non-negative extended reals is also needed. Integration of such lower semicontinuous functions with respect to a continuous valuation plays a crucial role. One obtains a duality between the extended probabilistic powerdomain over a continuous domain X and the continuous d-cone of lower semicontinuous functions on X. One direction of this duality is given by a version of the Riesz’ Representation Theorem. This leads to functional analytic questions about continuous d-cones and their duals for example: whether there exist non-zero linear Scott-continuous functionals, and whether these separate points. We will discuss this issue among other Hahn-Banach type theorems in Chapter 3. It still is an open problem whether there is a cartesian closed category of continuous domains which is closed under the construction of probabilistic powerdomains. This issue is discussed in [25]. Cartesian closure is essential in the denotational semantics of functional languages. There is a new challenge: What happens if non-deterministic choice coexists with probabilistic choice? And how can the classical powerdomain constructions together with the probabilistic powerdomain be used for modelling such situations? The Programming Research Group in Oxford [43] has tackled various aspects of this problem. Out of this group, McIver and Morgan have chosen a subdomain of the Plotkin powerdomain over the space of subprobability distributions on discrete state spaces [36]. The subsets they allow are the convex ones. Our approach to convex powercones was motivated by theirs. We modify and generalize their construction to continuous Lawson-compact d-cones. Therefore, we introduce and investigate a Hoare and Smyth style powerdomain construction for continuous d-cones. Then the convex Plotkin powercone can be defined as a combination of the other two con- structions. It is our goal to apply these constructions to the extended probabilistic
powerdomain in Section 4.4.
More background information will be given in the introductory part of each chapter. The course of the work is as follows:

Chapter 1 introduces briefly the prerequisites from domain theory used in this work and it recalls the interplay between order and topology in domain theory.
Continuous d-cones are the focus of Chapter 2. These are continuous domains which carry the structure of a cone in such a way that addition and scalar multipli- cation are Scott-continuous. The following examples of continuous d-cones will be investigated: the non-negative extended real numbers, the extended probabilistic powerdomain over a continuous domain, the cone of lower semicontinuous functions on a core compact space with values in the non-negative extended real numbers, and products of continuous d-cones. We will see that continuous d-cones are always locally convex, in the sense that each point has a neighbourhood basis of Scott-open convex sets (the notion of convexity is that of convex sets in real vector spaces and has to be distinguished from order-convexity). Sometimes, the hypothesis of an additive way-below relation is useful. We will show that this property is satisfied in all of the above examples with one restriction: The d-cone of lower semicontinuous functions has an additive way-below relation if and only if the underlying space is coherent. We will also give a brief exposition on the relation between continuous valuations and Borel measures.
In Chapter 3, Hahn-Banach type theorems for continuous d-cones will be proved. We begin by proving a Sandwich Theorem. From this we obtain Separation Theo- rems. Since continuous d-cones are locally convex, the Separation Theorems imply that the Scott-continuous linear functionals separate the points on a continuous d-cone. The Strict Separation Theorems will be needed for the convex upper and biconvex powercones. Another application of the Separation Theorem will be indi- cated in the Conclusion: in connection with semantics it can be used to show that a special map between two models is injective. Extension Theorems are another type of Hahn-Banach Theorems. We will prove a typical extension theorem for continuous d-cones with an additive way-below relation.
Chapter 4 introduces Hoare, Smyth and Plotkin style constructions for con- tinuous d-cones with the intention to apply them to the extended probabilistic powerdomain. However, the constructions are feasable and more transparent in the general setting of continuous d-cones. First, we modify the topological characterisa- tion of the lower powerdomain by taking only those non-empty Scott-closed subsets which are also convex. This allows us to lift addition and scalar multiplication in such a way that we obtain a d-cone again, called the convex lower powercone. In addition, binary suprema exist in the convex lower powercone and the convex lower powercone is shown to be universal in this context.

For the upper powerdomain we replace non-empty convex Scott-closed sets by non-empty convex compact saturated sets. Again, this enables us to lift the al- gebraic operations. We also obtain a d-cone, this one with binary infima as ex- tra semilattice operation. However, for this d-cone continuity is equivalent to the existence of linear Scott-continuous functionals which separate compact saturated convex sets from points. The convex upper construction is universal in a suitable setting with respect to binary infima.
The biconvex powercone can be defined over Lawson-compact continuous d-cones as a combination of the convex lower powercone and the convex upper powercone. We prove that the biconvex powercone is also Lawson-compact, and that it is uni- versal in this setting with respect to a binary semilattice operation, called formal union.
This work concludes with giving an idea on how its results can be used for semantics in a situation, where non-deterministic features can be denoted alongside probabilistic ones.



Chapter 1
Order and Topology

In this chapter we briefly review the prerequisites on order and topology necessary for our further results. The focus will be on domain theory; however, a complete introduction to this topic by far exceeds the scope of this work. Thus, we present selected items only and omit all proofs as we go along to fix our notation. We refer to [1,7,14,15,33] for more details.

Dcpos and Scott-Continuous Functions
We shall use the term ordered set in the sense of partially ordered set, that is, it denotes a set X with a reflexive, antisymmetric and transitive binary relation ≤, not necessarily linear. For any subset A of X we get the lower, resp. upper, closure of A by
↓A := {x ∈ X | x ≤ a for some a ∈ A} ,
↑A := {x ∈ X | x ≥ a for some a ∈ A} .
We abbreviate ↓{a} to ↓a and ↑{a} to ↑a. A subset A with A = ↓A is called a lower set; A = ↑A is called an upper set.
A subset D of an ordered set X will be called directed if it is nonempty and if any two elements of D have a common upper bound in D. The dual notion is that of a filtered set. An ordered set X will be called directed complete or a dcpo, for short, if
each directed subset D has a least upper bound  ↑ D in X. If this is true only for
directed subsets that are bounded from above, then we say that X is conditionally directed complete. If every subset A has a least upper bound sup A =  A, then X is a complete lattice. The least upper bound of any (directed) subset is also called its (directed) supremum. The set R+ of non-negative real numbers with the usual total order is conditionally directed complete, whilst R+ = R+ ∩ {+∞} is directed

complete.
A function f : X → Y between ordered sets is order preserving or monotone, if a ≤ b implies f (a) ≤ f (b) for all a, b ∈ X. If X and Y are (conditionally) directed complete, then f : X → Y is called Scott-continuous, if it is order preserving and
if f ( ↑ D)=	↑ f (D) for every (bounded) directed subset D ⊆ X. When we talk
about continuous functions between (conditionally) directed complete partial orders, we always mean Scott-continuous functions. We denote by DCPO the category of dcpos and Scott-continuous functions.
The least upper bound of a directed set D may be considered as a limit of
D. This explains the choice of the notion of continuity. This can be made precise with respect to an appropriate topology: A subset A of a (conditionally) directed complete ordered set X will be called Scott-closed if A is a lower set and if  ↑ D ∈ A
for every (bounded) directed set D ⊆ A. The complement X \ A of a Scott-closed set A will be called Scott-open. Thus, a set U is Scott-open, if U is an upper set and if for every (bounded) directed subset D of X the following holds: If  ↑ D ∈ U , then
d ∈ U for some d ∈ D. It is easily seen that the Scott-open sets form a topology on X, the Scott topology. This topology always fulfills the T0-separation axiom, but is non-Hausdorff unless the (conditionally) directed complete partial order is ordered trivially. Throughout this work, A will denote the closure of a subset A of a (conditionally) directed complete partial order with repect to the Scott topology. Scott continuity as defined above is consistent with the Scott topology: A func- tion f : X → Y between (conditionally) directed complete ordered sets is Scott- continuous if and only if f is continuous with respect to the Scott topologies on X
and Y .
A product X × Y of (conditionally) directed complete ordered sets X and Y is again (conditionally) directed complete. A function f defined on X × Y is Scott- continuous if, and only if, it is componentwise Scott-continuous, that is, if x '→ f (x, y) is Scott-continuous on X for every fixed y ∈ Y and similarly for the second component. It is an unfortunate fact that the Scott topology on X × Y may be strictly finer than the product of the Scott topologies on X and Y , unless one of X and Y is continuous (see sec. 1.4 and [15, p. 197]). Thus, a Scott-continuous function defined on X × Y need not be continuous for the product topology unless one of X and Y is continuous.
For any topological space X we denote the collection of open sets by O(X). Ordered by set inclusion, this gives a complete lattice. Especially, directed suprema exist and O(X) itself can be viewed as a topological space with the Scott topology.

The Specialisation Order
So far, we have seen how to equip a (conditionally) directed complete ordered set with a T0-topology. Let us now change our point of view and consider a T0- topological space X. Such a space always carries an intrinsic order, namely the specialisation order. It is defined by x ≤ y if x is in the closure of {y} or, equiva- lently, if the neighbourhood filter of x is contained in the neighbourhood filter of y. This definition always yields a reflexive, transitive relation, which is antisymmetric exactly for T0-spaces. For this reason, a topological space is always supposed to satisfy the T0-separation axiom in this work. In the case of a T1-space, where every singleton set is closed, the specialisation order is trivial.
Continuous functions between topological spaces preserve the respective special- isation orders. For the product of topological spaces with the product topology, the specialisation order is equal to the product of the respective specialisation orders. A closed set is always a lower set and every open set is an upper set. The closure of a point is exactly its lower closure {a} = ↓a. Let us recall the following result from [48, Corollary 1.6(i)]:
Lemma 1.1 Let f : X → Y be a continuous map between T0-topological spaces and let A be a subset of X. With respect to the specialisation orders, the supremum of f (A) exists in Y if and only if the supremem of f (A) exists in Y . In this case,
  f (A)=  f (A).
For a dcpo with the Scott topology the specialisation order coincides with the originally given order.
The saturation of any subset A in a topological space is defined to be the inter- section of all the neighbourhoods of A. This is exactly the upper closure ↑A with respect to the specialisation order. Thus, an upper set will also be called saturated. In T0-spaces all sets are saturated. It is an immediate consequence of the definition that the saturation of any compact set is again compact.
Compactness is defined by the Heine-Borel covering property: every covering by open sets has a finite subcovering. For a monotone map f : X → Y between two ordered sets, in particular, for a continuous map between topological spaces with their specialisation orders, ↑f (↑A)= ↑f (A) holds for any subset A of X.
We will mainly apply this to compact saturated subsets and Scott-continuous functions.
From general topology we know that the continuity of a function f : X → Z

can be characterized by the property that f (A) ⊆ f (A) or, equivalently, f (A) = 



f (A), for every subset A ⊆ X. We will need the following consequence which can be applied to dcpos and Scott-continuous functions on products, which are only separately continuous with respect to the product topology (see the remarks at the end of section 1.1):
Lemma 1.2 Let X, Y, Z be topological spaces and f : X × Y → Z be separately continuous, that is, x '→ f (x, y) is continuous on X for every y ∈ Y and similarly for the second coordinate. For all subsets A ⊆ X and B ⊆ Y one then has f (A × B)= f (A × B)= f (A × B).

Proof. By separate continuity, we have f (A × {y}) ⊆ f (A × {y}) ⊆ f (A × B) for all y ∈ Y , whence f (A × B) ⊆ f (A × B), and this implies f (A × B)= f (A × B). The second equality follows in an analogous way.	 


Sober Spaces
For a special class of T0-spaces every non-empty closed subset is either the closure of a unique point or the union of two proper closed subsets. We call such spaces sober. An equivalent formulation of sobriety is that every completely prime filter of open sets on X is the open neighbourhood filter of a unique point a ∈ X.
The collection of all nonempty compact saturated subsets of a topological space is denoted by Sc(X) and will be ordered by reverse inclusion. An important prop- erty of sober spaces X is the so called Hofmann-Mislove Theorem (see [20,26], [15, Theorem II-1.20]). The following proposition (see [15, TheoremII-1.21, Corollary II-1.22]) is a consequence of this theorem. It will be used extensively in Section 4.2.
Proposition 1.3 Let X be a sober space. The intersection of a ﬁltered family (Qi) of nonempty compact saturated subsets is compact and nonempty. If such a ﬁltered intersection is contained in an open set U, then Qi ⊆ U for some i.
The first part of this proposition can be rephrased as follows: Sc(X) ordered by reverse inclusion is a dcpo for any sober space X.
It is another property of sober spaces that the specialisation order yields a dcpo, with the original topology being coarser than the Scott topology. However, a dcpo with the Scott topology is not always sober [22]. In the next section we introduce special dcpos, called continuous domains, which are always sober spaces with respect to the Scott topology [31].

Continuous Domains
On a (conditionally) directed complete partial order X we introduce a binary rela- tion  as follows: Let x and y be elements of X. We say that x approximates y or x is way-below y, and we write x  y, if for all (bounded) directed subsets D of
X, the inequality y ≤  ↑ D implies x ≤ d for some d ∈ D. We call   the order
of approximation or way-below relation on X. It is immediate that x  y implies x ≤ y, and w ≤ x y ≤ z implies w z, in particular, the way-below relation is transitive. If x ∨ y exists, then x  z and y  z imply x ∨ y  z. For any x ∈ X and for any subset A ⊆ X, we use the notations

A (conditionally) directed complete partial order X is called continuous if, for all x ∈ X, the set ↓x is directed and x = ↑↓x. A continuous dcpo is also called a continuous domain. A subset B of a continuous domain X is called a basis of X if, for all x ∈ X, the set ↓x ∩ B is directed and has x as its supremum. In a continuous
domain, a basis always exists, for example take B = X. Moreover, in a continuous domain the so called interpolation property holds: Whenever x  y, there is z ∈ X such that x  z  y. If a basis of X is given, z can be chosen from this basis. We denote the category of continuous domains and Scott-continuous functions by CONT.
The Scott topology of a continuous domain can be nicely described via the way- below relation. The sets of the form †x, x ∈ X, form a basis of this topology. Again, we can restrict ourselves to a basis B of X, i.e., the sets †b, b ∈ B, also form a basis of the Scott topology.
The Scott closure of a subset A of an arbitrary dcpo can be obtained in the following way: Let A0 = A and define by transfinite induction An+1 to be the set
of all x such that x ≤  ↑ D for some directed subset D of A ; for limit ordinals
n, we let An =  m<n Am. For cardinality reasons there is an ordinal n such that An = An+1, that is, An = A, the Scott closure of A. For continuous domains, the procedure stops after the first step:
Lemma 1.4 In a continuous domain X the Scott closure of an arbitrary subset A
is
A =   ↑ D | D a directed subset of ↓A}.

For a continuous domain it is known how to obtain the largest Scott-continuous function below a monotone one. The construction once again relies on a monotone function defined on a basis only.
Proposition 1.5 Let B be a basis of a continuous domain X and let Y be a dcpo. For every monotone function f : B → Y there is a largest Scott-continuous function
fˇ: X → Y such that fˇ|B ≤ f. It is given by fˇ(x)=   f (y) | y  x and y ∈ B}.
↑
Let X and Y be dcpos. Then a pair of Scott-continuous functions r : X → Y and s : Y → X is called a continuous retraction-section-pair if r ◦ s is the identity on Y . Note that in this case r is surjective and s is injective. We will call Y a retract of X, and it can be shown that a retract of a continuous domain is again a continuous domain (see [15], p. 81).
We call a space locally compact if every point has a neighbourhood basis of compact sets. Note that continuous domains are always locally compact. Actually, a somewhat stronger condition holds:
Lemma 1.6 In a continuous domain each Scott-compact subset has a neighbour- hood basis of Scott-compact saturated sets.

Lawson-Compact Continuous Domains
According to Nachbin [39], an ordered topological space is a topological space with an order ≤ such that the graph of the order relation is closed in X ×X with the product topology. In [14,15] (partially) ordered topological spaces are called pospaces. One immediately concludes that any pospace is Hausdorff. Another property which can already be found in [39] is the following:
Lemma 1.7 Let X be a pospace. If A is a compact subset, then ↓A, ↑A and ↓A∩↑A
are closed subsets of X.
For any ordered topological space X the collection U(X) of all open upper sets is closed under finite intersections and arbitrary unions, that is, U(X) is a topology on X which is T0 but not Hausdorff unless the order is trivial. Note that the specialisation order with respect to the topology U(X) coincides with the original order on X.
On the other hand, given a T0-topological space with its specialisation order, one may define the co-compact topology which has the compact saturated subsets as a subbasis for the closed sets. The open sets for the co-compact topology are lower sets. The common refinement of a topology with its co-compact topology is called

the patch topology. Another way of creating a topology which is coarser than the co-compact topology is by taking as a subbasis of closed sets the principal filters
↑x, x ∈ X. This weakest T0-topology whose open sets are lower sets is called the
lower topology.
There is an important one-to-one correspondance between compact ordered spaces and certain classes of T0-spaces to be defined.
Definition 1 A topological space X is called coherent , if the intersection of any two compact saturated subsets is compact. It is called stably locally compact , if it is locally compact, sober, and coherent; if, in addition, X is a compact space, then it is called stably compact .
Proposition 1.8 ([15, Proposition VI-6.8, Proposition VI-6.11]) Let X be a stably compact space. With respect to the patch topology and the specialisation order, X becomes a compact pospace; the patch-open upper sets are precisely the open sets for the original topology. Conversely, let X be a compact pospace. With respect to the topology U(X) of open upper sets, X becomes a stably compact space the patch topology of which is the original compact topology on X.
The corresponding result holds for stably locally compact spaces on the one hand, and properly locally compact pospaces on the other hand, where a pospace is called properly locally compact , if it is locally compact and if ↑K is compact for every compact subset K. A locally compact pospace is far from being properly locally compact, in general; the real line with is usual order and topology, for example, is a non-properly locally compact pospace.
We now apply these ideas to dcpos with the Scott topology. For any dcpo the Lawson topology is defined to be the common refinement of the Scott topology and the lower topology. In case the dcpo X is continuous the Scott topology always is locally compact and sober. The Lawson topology and the patch topology coincide (see [33]) and, with respect to the Lawson topology, X is a pospace. We will be interested in continuous domains that are coherent , that is, which have the property that the intersection of any two Scott-compact saturated sets is Scott-compact. By the above, coherence implies stable local compactness for continuous dcpos.
Proposition 1.9 ([15, Theorem III-5.8]) For a continuous domain X the following properties are equivalent:
X is Lawson-compact.
The Scott-compact saturated sets agree with the closed sets for the lower topology

on X, that is, the co-compact topology agrees with the lower topology.
X is compact and coherent, that is, X with the Scott topology is stably compact.
By the above, a Lawson-compact continuous domain becomes a compact pospace when endowed with the Lawson topology. Its Lawson-open upper sets are precisely the Scott-open sets and its Lawson-closed upper sets are precisely the Scott-compact saturated sets. In Section 4.3 we will apply Lemma 1.7 to reduce an order-convex Lawson-compact subset to its lower part, which is Scott-closed, and its upper part, which is compact saturated with respect to the Scott topology. Another important fact from [33] is
Lemma 1.10 Every Scott-continuous retract of a Lawson-compact continuous do- main is Lawson-compact.
Most continuous domains that occur in semantics are coherent. Thus, it will not be a great restriction, if we restrict ourselves to Lawson-compact continuous domains in section 4.3. But there are exceptions. The following is an example of locally compact sober space which is not coherent. It is also an example of a continuous domain that is not Lawson-compact.
Example 1 We take a trivially ordered infinite set Y and attach two new elements a and b as minimal elements, that is we let a < y and b < y for each y ∈ Y , but a and b remain incomparable. This ordered set is a continuous domain, hence, locally compact and sober for the Scott topology, but it is not coherent: The subsets
↑a = {a}∪ Y and ↑b = {b}∪ Y are compact but their intersection Y is not.



Chapter 2
Directed Complete Ordered Cones

The concept of a directed complete ordered cone (d-cone, for short) will be intro- duced in this chapter. As these objects are not yet familiar in domain theory, we do so at a leisurely pace. We take some care in developing their properties, and we also study some classes of examples.
The abstract probabilistic domains APD of Jones and Plotkin [24,23] have in- fluenced the development of the notion of a d-cone. These objects turn out to be the algebras of the monad given by the probabilistic powerdomain functor in the category of continuous domains with respect to a ‘convex structure’. Dealing with subprobabilities allows scalar multiplication by real numbers between 0 and 1 only, addition is replaced by convex combinations. To overcome this inconvenience, Kirch introduced the extended probabilistic powerdomain and showed that this functor is still monadic and has continuous d-cones as algebras [29]. Although studying cones in a domain-theoretic setting is quite new, ordered cones have long played a role in various contexts. For ordered cones, it is natural to require addition, scalar multi- plication and linear functionals to be monotone. D-cones can be seen as a variant of ordered cones: one requires the order to yield a dcpo and, accordingly, one requires addition, scalar multiplication and linear functionals to be Scott-continuous.
Before we give detailed definitions we will name at least some previous occur- rences of ordered cones. In [13] Fuchssteiner and Lusky studied them in a functional analytic setting. In Chapter 3 we will show that some of their results still hold for continuous d-cones. Other results about ordered cones, of which we will take ad- vantage, are due to W. Roth [45]. He deals with ordered cones equipped with a quasiuniform structure proposed by Keimel and Roth in [27]. In the context of har-

monic analysis and abstract potential theory, cones have been studied by Boboc, Bucur and Cornea [5]. Rauch has shown in [44] that a special class of their ordered cones, their standard H-cones, can also be viewed as continuous lattice-ordered d- cones with addition and scalar multiplication being Lawson continuous. Most of these cones — as is the case with d-cones — are not embeddable into real vector spaces as the cancellation law does not hold for addition.

D-Cones and Their Basic Properties
We denote by R+ := {r ∈ R | r ≥ 0} the non-negative real numbers with their usual linear order and endowed with the Scott topology the only proper open sets of which are the intervals ]r, ∞[,r ∈ R+.
Definition 2 A set C is called a cone if it is endowed with two operations, an addition +: C × C → C and a scalar multiplication · : R+ × C → C such that the following hold: there is a neutral element 0 ∈ C for addition making (C, +, 0) into a commutative monoid, that is, for all a, b, c ∈ C one has:
(a + b)+ c = a + (b + c) a + b = b + a
a +0 = a.
Moreover, scalar multiplication acts on this monoid as on a vector space: for a, b ∈ C
and r, s ∈ R+, one has
1 · a = a
0 · a =0 
(r · s) · a = r · (s · a)
r · (a + b)= (r · a)+ (r · b)
(r + s) · a = (r · a)+ (s · a).
A function f : C → D between cones is called linear if, for all a, b ∈ C and r ∈ R+, one has
f (a + b)= f (a)+ f (b)
f (r · a)= r · f (a).
A cone C is an ordered cone if it is also endowed with a partial order ≤ such that addition and scalar multiplication considered as maps C × C → C and R+ × C → C, respectively, are order preserving in both variables. If the order is directed complete and if addition and scalar multiplication are Scott-continuous, then C is called a d-cone. Thus, a d-cone is at the same time a cone and a dcpo. In the case that C is a continuous domain, C is called a continuous d-cone. Note that we are using here the

notions of Scott topology and continuity developed in Section 1.1 for conditionally directed complete partial orders; indeed it was precisely in order to define d-cones that we introduced these notions.
The category of d-cones as objects and Scott-continuous linear maps as mor- phisms is denoted by CONE, and the full subcategory of continuous d-cones is called CCONE.





In the literature ordered cones are used in a slightly more general sense: For scalar multiplication one only requires x '→ r · x : C → C to be monotone for every fixed r ≥ 0, whilst we require also that all the maps r '→ r · x : R+ → C are order preserving. This stronger requirement implies that 0 is the least element, as 0=0 · x ≤ 1 · x = x for any x ∈ C. A d-cone also has a greatest element since the monotonicity of addition implies that the cone as a whole is directed and, hence, has a supremum which the is the greatest element.
D-cones also have a topological flavour, but they are not necessarily topological cones: A topological cone is a cone C endowed with a topology such that both operations, addition (x, y) '→ x + y : C × C → C and scalar multiplication (r, x) '→ r · x : R+ × C → C are jointly continuous. In contrast with classical analysis, we take R+ to have the Scott topology here. As noted in section 1.1, the Scott topology on a product of (conditionally) directed complete partial orders need not be the product of the Scott topologies on the factors, and so a Scott-continuous function defined on a product of (conditionally) directed complete partial orders need not be jointly continuous for the product of their Scott topologies. In particular, addition need not be jointly continuous on a d-cone. This phenomenon cannot occur if one of the two factors is a continuous (conditionally) directed complete partial order. Thus, scalar multiplication is jointly continuous on any d-cone, and addition is jointly continuous for continuous d-cones which, consequently, are topological cones for the Scott topology.
We have discussed the relations between ordered cones, d-cones and topological cones in some detail as we will apply results about topological cones and, especially, ordered cones to continuous d-cones.

A simple example of a continuous d-cone is R+ := R+ ∪ {∞} with its usual linear order, addition and multiplication, extended to ∞ as follows:



x + ∞ = ∞ = ∞ + x,	x ∈ R+

x ·∞ = ∞,	x ∈ R+ \ {0}
0 ·∞ = 0.
With this convention, addition and multiplication are Scott-continuous on R+. For any d-cone, scalar multiplication – which was supposed to be defined for
r ∈ R+ only – can be extended to r = ∞ by defining ∞· x :=  {r · x|r ∈ R }.
↑
The cone axioms will also hold for the extended scalar multiplication.
It is straightforward to see that direct products of (continuous) d-cones are again (continuous) d-cones. Other examples are the extended probabilistic power domain, the space of lower semicontinuous functions and the dual d-cone. We postpone the definition and a more detailed discussion of these examples first examining some general properties of d-cones.

The Way-Below Relation
It is a useful property of d-cones that scalar multiplication preserves the way-below relation. We will see later that this is not true for addition, in general.
Lemma 2.1 Let a, b be elements of a d-cone C with a   b and let r ∈ R+. Then
r · a  r · b holds.
Proof. For r > 0 this follows from the fact that a '→ ra is an order-isomorphism of C. If r =0 then r · a = r · b = 0 is the least element of the d-cone and therefore compact.	 
For some of our results we will need continuous d-cones where also addition preserves the way-below relation. We give a name to this property:
Definition 3 The way-below relation on a d-cone is called additive, if a1   b1 and
a2  b2 imply a1 + a2  b1 + b2.
The additivity of the way-below relation is equivalent to the property that ad- dition is an almost open map in the following sense:
Proposition 2.2 Let C be a continuous d-cone. Then the way-below relation is additive if and only if, for all Scott-open subsets U, V , the set ↑(U + V ) is Scott- open, too.

Proof. Suppose first that  is additive. Let x ∈ ↑(U +V ). Then there are elements u ∈ U, v ∈ V such that u + v ≤ x. As C is continuous, there are elements u' ∈ U , v' ∈ V such that u'   u, v'   v. By the additivity of the way-below relation,
u' + v'  u + v ≤ x. This shows that ↑(U + V ) is Scott-open. For the converse, let
u'   u and v'   v. Then u + v ∈ †u' + †v'. As now the upper set generated by
†u' + †v' is supposed to be Scott-open, there is an x in this set with x  u + v. It follows that u' + v' ≤ x  u + v.	 
It will turn out that most of our examples of continuous d-cones have an additive way-below relation.

Proposition 2.3 The way-below relation on R+ is additive.

Proof. On R+ the way-below relation is characterised by x  y if and only if x < y or x = y = 0. It is straightforward that addition preserves this condition, and thus the way-below relation.	 
The additivity of the way-below relation is preserved under products:
Proposition 2.4 The way-below relation is additive on a product of continuous d-cones with additive way-below relations.
Proof. The way-below relation on a product i∈I Xi of dcpos Xi with a smallest element ⊥i ∈ Xi can be characterised by the way-below relations  i on Xi via
(xi)i∈I  (yi)i∈I if and only if there exist a finite subset E ⊆ I with xi = ⊥i for
i /∈ E and xi  i yi for i ∈ E. The least element in a continuous d-cone is the neutral element 0. Thus, addition preserves the way-below relation in a product if this holds in each component.	 
The way-below relation on the probabilistic powerdomain and on the cone of lower semicontinuous functions will be discussed later. There, we will also see an example of a continuous d-cone where the way-below relation is not additive.
Convex Sets
On d-cones one has two notions of convexity:
Definition 4 A subset M of a cone C is called convex if a, b ∈ M implies r · a + (1 − r) · b ∈ M for all r ∈ [0, 1]. A subset M of a poset C is called order-convex if a, b ∈ M and a ≤ x ≤ b imply x ∈ M . A d-cone C is called locally convex if every point has a neighbourhood basis of Scott-open sets which are convex and order-convex.

Principal filters ↑a and principal ideals ↓a are convex and order-convex for any a ∈ C, since scalar multiplication and addition on a d-cone are monotone. Together with the fact that the union of an increasing sequence of convex, order-convex sets is convex and order-convex, we see that a continuous d-cone is always locally convex. This was pointed out to us by J.D. Lawson:
Proposition 2.5 Every continuous d-cone C is locally convex. Indeed, every point in C has a neighborhood basis of Scott-open convex ﬁlters.
Proof. For a ∈ C let U be a Scott-open neighbourhood of a. Since C is continuous we can find a sequence (an)n∈N in U satisfying a1   a and an+1   an for all n ∈ N. Then V :=  n∈N †an =  n∈N ↑an is a Scott-open neighbourhood of a which
is convex and order-convex and contained in U .	 
In case the way-below relation is additive we can show even more:
Lemma 2.6 For a continuous d-cone with an additive way-below relation, the Scott interior of any convex saturated set M is convex.
Proof. Let x, y ∈ int M and r ∈ [0, 1]. Then, there exist x', y' ∈ M with x'  x and y'   y. Using that the way-below relation is additive, we conclude r ·x+(1−r)·y r · x' + (1 − r) · y' ∈ M , as M is convex; hence, r · x + (1 − r) · y ∈ int M . 
There are other operations which preserve convexity.
Lemma 2.7 Let M be a convex subset of a d-cone C. Then:
The Scott closure M is convex.
The saturation ↑M and the lower closure ↓M are convex.
Proof. For the first claim we use the formation of the Scott closure indicated before Lemma 1.4. In a first step we form the set M1 of all x ∈ C such that there is a
directed family (a ) in M with x ≤  ↑ a . The set M  is convex. Indeed, for
x, y ∈ M  there are directed sets (a ) and (b ) in M such that x ≤  ↑ a and
y ≤  ↑ b . For 0 ≤ r ≤ 1, the family  ra + (1 − r)b  is also directed in M

j
and rx + (1 − r)y ≤ r ·  ↑ a
i
+ (1 − r) ·  ↑ b
j
=  ↑ ra
+ (1 − r)bj , whence

rx + (1 − r)y ∈ M1. We continue this procedure by transfinite induction defining convex sets Mn for ordinals n. (For limit ordinals n we define Mn =  m<n Mm.) For cardinality reasons there is an n such that Mn = Mn+1. Then Mn is the Scott closure of M which consequently is convex.
That the saturation and lower closure of a convex set are convex is an immediate consequence of the fact that addition and scalar multiplication of a d-cone are

monotone.	 
For nonempty subsets P and Q of any cone C and r ∈ R+, we may define
r · P = {ra | a ∈ P } and P + Q = {a + b | a ∈ P, b ∈ Q} .

Clearly, addition of subsets is associative, commutative, and the singleton zero set is a neutral element. Scalar multiplication satisfies all the cone axioms except that (r +s)P /= rP +sP in general. Indeed, let C = R+ and P = {1, 2}, then 2P = {2, 4} but P + P = {2, 3, 4}, whence 2P /= P + P . The situation changes, when we pass to convex subsets:
Lemma 2.8 Let P, Q be subsets of a cone C and r ∈ R+. Then we have:
The convex hull of a scalar multiple is given by conv(r · P )= r · conv P.
The convex hull of the sum is given by conv(P + Q)= conv P + conv Q.
If P, Q are convex, then r · P and P + Q are convex, too.
With the straightforward addition and scalar multiplication as deﬁned above, the collection of all nonempty convex subsets of C is a cone.
If P and Q are convex, then the convex hull of the union is given by
conv(P ∪ Q)= r · p + (1 − r) · q  p ∈ P, q ∈ Q, r ∈ [0, 1]}.
The first and second statements of this lemma are straightforward and they imply the third statement. For the fourth statement the only noteworthy part is the equality
(r + s)P = rP + sP :
Indeed, if r = s = 0, then the equation is trivial. If one of r and s is nonzero, then c ∈ r · P + s · P implies that there are elements a, b ∈ P such that c = ra + sb = (r + s) ·  r  a +  s  b ∈ (r + s) · P . Hence r · P + s · P ⊆ (r + s) · P by the convexity
of P . The converse inclusion is clear. The last item is again straightforward.
If we apply the second part of the previous lemma to two singleton sets {x} and
{y} we see that the convex hull of the two element set {x, y} is indeed the ‘line segment’ connecting x and y. By a simple induction over the cardinality of a finite
set F we conclude conv F =  Σx∈F rxx  x ∈ F, rx ∈ [0, 1], Σx∈F rx = 1}.


n i=1
ri = 1} is compact Hausdorff with respect to the topology induced by the

Scott topology on [0, 1]n. Indeed, the induced topology is equal to the usual compact Hausdorff topology on Δn. We need this observation for n =2 to show

Lemma 2.9 For compact convex subsets P and Q of a topological cone, conv(P ∪Q) is also compact. This applies in particular to continuous d-cones with the Scott topology.
Proof. The set Δ = (r, 1 − r) r ∈ [0, 1] is compact with respect to the Scott topology on [0, 1]2. The map from Δ2 × C × C to C, defined by (r, 1 − r), x, y  '→ r · x + (1 − r) · y is continuous. The convex hull of P ∪ Q is equal to the image of the compact set Δ2 × P × Q. Thus, conv(P ∪ Q) is also compact.	 
We can apply this lemma to two singleton sets and, by induction over the car- dinality, to finite sets F and we obtain that the convex closure conv F and conse- quently also ↑conv F are Scott-compact in a continuous d-cone.

The Extended Probabilistic Powerdomain
In this section we introduce our most prominent examples of d-cones: the extended probabilistic powerdomains over topological spaces.
Definition 5 Let X be a topological space and O(X) the collection of all open subsets. A function μ : O(X) → R+ is called a valuation on X if, for all U, V ∈ O(X), it satisfies:
μ(∅)=0	(μ is strict )
U ⊆ V ⇒ μ(U ) ≤ μ(V )	(μ is monotone)
μ(U )+ μ(V )= μ(U ∪ V )+ μ(U ∩ V )	(μ is modular )
If, in addition, μ is Scott-continuous, that is, if

μ  ↑
U  =  ↑
μ(U ) for all directed families (U )
in O(X),

then μ is called a continuous valuation. The set of all continuous valuations on X is denoted by V(X) and will be called the extended probabilistic powerdomain on X. For a dcpo X, valuations are always defined with respect to the Scott topology.
Valuations may be considered to be a topological variant of a measure or a probability distribution. In connection with order theory it is quite natural to impose Scott continuity as an additional condition on valuations as was done by Lawson in [32]. From a measure theoretical background, one might only impose
the weaker condition of countable continuity, that is, for any increasing sequence

of open sets, μ  ↑	U
↑
n∈N
μ(Un
). The obvious question on the relation

between continuous valuations and classical measures arises: when can a continuous

valuation be extended to a Borel measure? A positive answer has been given for various spaces using quite different techniques. We discuss this question in some detail in Section 2.2.1 below.
Probabilities correspond to normalized valuations, i.e., μ(X) = 1. This is the case for the dcpo of probability distributions on an ω-algebraic domain of states considered by Saheb-Djahromi in [47] in order to model programs with finite proba- bilistic branching. In [42], Plotkin talks about all sub-probability distributions on measurable spaces to describe predicate transformers and state transformation func- tions with probabilities. Sub-probability distribution means that the measures are bounded by 1 instead of being normalized. In this context the value μ(X) gives the probability of termination. The set of all such measures defined on the Borel algebra of an ω-continuous dcpo X with the Scott topology, ordered by μ ± ν if μ(U ) ≤ ν(U ) for all Scott open subsets U of X, has been called the probabilistic powerdomain by Plotkin. The essential stucture regarding this order theoretic model of probabilistic non-determinism is adequately described by the values on open sets. Therefore, it is not suprising to find in [24,23] that Jones and Plotkin replaced measures by con- tinuous valuations in order to define the probabilistic powerdomain as the set of all continuous valuations μ such that μ(X) ≤ 1. They introduce a simple imperative language with a probabilistic construct and use the probabilistic powerdomain of continuous valuations to give its denotational semantics. For this they have to study the internal structure of the probabilistic powerdomain quite well. Most of their results carry over to the extended probabilistic powerdomain (see [29]). Various classes of valuations are also surveyed by Heckmann in [18]. Although the inter- est in the probabilistic powerdomain originated in denotational semantics, more recently Edalat found applications inside mathematics, e.g. the the generalised Riemann integral [9], iterated function systems with probabilities [11], dynamical systems and fractals [10].
We now recall some special valuations. For any element x ∈ X, the point valuation ηx : O(X) → R+ is defined by
η (U ) := ⎧⎪⎨ 1, if x ∈ U
⎪⎩ 0, if x /∈ U.

A point valuation is always continuous.
Given continuous valuations μ and ν on any topological space X and r ∈ R+, it is straightforward to check that μ + ν and r · μ defined ‘pointwise’ by (μ + ν)(U ) :=

μ(U )+ ν(U ) and (r · μ)(U ) := r · μ(U ) for all open sets U of X are again continuous valuations. Especially, we can take finite linear combinations of point valuations,
which will be called simple valuations. They have the form μ = Σn	ri · ηx with
i
ri ∈ R+ and xi ∈ X for i = 1,... , n. Likewise, we define an order on V(X) as the
‘pointwise’ order μ ≤ ν if μ(U ) ≤ ν(U ) for all U ∈ O(X). The supremum  ↑	μ
of a directed family of continuous valuations (μi)i∈I always exists and is given by
(  ↑	μ )(U )=  ↑	μ (U ), U ∈ O(X).
The following Theorem summarizes important properties of the extended prob- abilistic powerdomain. Part (a) of the Theorem is straightforward to check using Scott continuity of addition and scalar multiplication on R+. A proof that every bounded continuous valuation on a continuous domain can be approximated by simple valuations way-below has been given by C. Jones [23]. It has been extended to unbounded valuations by Kirch [29]. For a proof see also [15, Theorem IV-9.16]. The continuity of V(X) for a continuous domain X can be derived from this and we have (b). Assertion (c) of the Theorem is a slight generalisation of Theorem 38 including the remark preceding it in [3]. We include a proof here. As to part (d), Jung and Tix [25] have shown that the probabilistic powerdomain over a Lawson- compact continuous domain is Lawson-compact. It follows from (c) that this result can be generalized to coherent domains. The converse is new. The proof has been communicated to us by J.D. Lawson.
Theorem 2.10 (a) For a topological space X, the extended probabilistic powerdo- main V(X) with pointwise addition, scalar multiplication and order is a d-cone.
If X is a continuous domain, then V(X) is a continuous d-cone; the simple valuations form a basis.
For a stably locally compact space X, the extended probabilistic powerdomain V(X) is stably compact for the weak topology, that is, the weakest topology rendering Scott-continuous the maps μ '→ μ(U ): V(X) → R+ for all open subsets U.
Let X be a continuous domain. Then V(X) is Lawson-compact if and only if
X is coherent.
Proof. It remains to prove the last two statements.

We start with the stably compact space P =	U ∈O(X) R+, where each copy of R+ is equipped with the Scott topology.  The corresponding patch topology
is just the product topology where each copy of R+ is endowed with the usual Hausdorff topology. The set MV(X) of all (not necessarily continuous) valuations



μ : O(X) → R+ is patch closed in P , as one easily verifies. By invoking Proposition
1.9 we have thus shown that MV(X) is stably compact when equipped with the weak topology.
In order to restrict further to continuous valuations, we remember that, for a locally compact space X, the lattice O(X) of open subsets is continuous. We now use a standard technique to associate to an arbitrary valuation μ its Scott-continuous envelope
Φ(μ)(U )= sup{μ(V ) | V  U }
It is clear that Φ(μ)(∅) = 0 holds, and that Φ(μ) is monotone. For the modular law, we exploit stable local compactness which gives us that U ∩ U ' is approximated by sets of the form V ∩ V ' where V   U and V '   U '. We see that Φ(μ) is a
continuous valuation.
Thus Φ is a projection operator on MV(X) with image V(X). In order to see that Φ is continuous with respect to the weak topology on MV(X), observe that Φ(μ)(U ) > r, if and only if μ(V ) > r for some V   U . Hence the preimage under Φ of the subbasic open set {μ ∈ MV(X) | μ(U ) > r} equals  V  U {μ ∈ MV(X) | μ(V ) > r}.
As a (continuous) retract of the stably compact space MV(X), the space V(X) with the weak topology is stably compact (see e.g. [3, Proposition 16]).
Let X be a continuous domain. Let L denote its upper powerdomain, that is, the collection of all Scott-closed subsets of X ordered by inclusion. It is well known that L is a completely distributive lattice. The natural injection x '→ ↓x of X into L preserves the way-below relation and is an embedding both for the respective Scott and Lawson topologies. Identifying the elements x with there images ↓x, we may view X as a subspace of L.
We now suppose that X is not coherent. Then X⊥ = X ∪ {⊥} is not Lawson compact. As L is Lawson compact, there is a net (pi) in X that converges to an element a ∈ L \ X⊥ with respect to the Lawson topology. We claim that the
extended probabilistic powerdomain V(X) is not Lawson-compact.
Suppose by contradiction, that V(X) is Lawson-compact. Then the probabilitic powerdomain V≤1(X) – as a Scott-closed subset – is also Lawson-compact. The net (ηpi ) of point valuations has a Lawson-convergent subnet. By replacing the original net by this subnet, we may suppose that the net (ηpi ) converges to a valuation μ ∈ V≤1(X) with respect to the Lawson topology. We prove the following two statements which are contradictory:
μ(X \ ↓a) = 0: As L is linked bicontinuous, we may choose an element b way-

above a (i.e., way-below for the opposite order). As the set of elements c with b way-above c is Lawson-open, we have pi ≤ b eventually, whence ηpi (X \ ↓b) = 0 eventually. Going to the limit we get μ(X \ ↓b)= 0. As X \ ↓a is the union of the directed family of open sets X \ ↓b for b way-above a, we conclude μ(X \ ↓a) = 0 by the continuity of μ.
μ(X \ ↓a) = 1: We note that X ∩ ↓a is nonempty and Scott-closed in X. As X is sober and a /∈ X, this closed set is not irreducible. Then X ∩ ↓a is the union of two nonempty Scott-closed proper subsets B and C. We choose elements b ∈ B \ C and c ∈ C \ B. As X \ C and X \ B are Scott-open in X, there are elements b1 ∈ X \ C and c1 ∈ X \B with b1  b and c1  c. As in the preceding paragraph, we conclude that b1 ≤ pi and c1 ≤ pi eventually, whence ηb1 ≤ ηpi and ηc1 ≤ ηpi eventually. It follows that ηb1 ≤ μ and ηc1 ≤ μ. This implies 1 = ηb1 (X \ C) ≤ μ(X \ C) ≤ 1 and 1= ηc1 (X \ B) ≤ μ(X \ B) ≤ 1. It follows that

1 ≥ μ(X \ ↓a)= μ (X \ B) ∩ (X \ C) 
= μ(X \ B)+ μ(X \ C) − μ (X \ B) ∪ (X \ C) 
≥ 1+1 − 1= 1.	 

Every continuous map f : X → Y of topological spaces induces a Scott-continuous linear map V(f ): V(X) → V(Y ). To every continuous valuation μ on X we associate
its image V(f )(μ) defined by V(f )(μ)(V ) = μ f −1(V ) for every open set V ⊆ Y . In this way we have defined a functor V from the category of topological spaces to
the category of d-cones. Restricting this functor to the category of dcpos (with the Scott topology), we obtain a functor
V: DCPO → CONE
from the category of dcpos to the category of d-cones. This functor is monadic, but the algebras of this monad are not known. By the previous theorem, we may restrict V to a functor
V: CONT → CCONE
from the category of continuous domains to the category of continous d-cones. The algebras of this monad are the continuous d-cones by the following universal prop- erty (see [23], [29], [54], [15, Theorem IV-9.24]):
Theorem 2.11 Let X be a continuous domain. The map ηX : X → V(X) that to every x ∈ X assigns the point valuation ηx is a topological embedding and, for every

Scott-continuous map f from X intoa d-cone C, there is a unique Scott-continuous linear map fˆ: T(X) → C such that fˆ◦ ηX = f.
A special case of this theorem is the following: For a lower semicontinuous (= Scott-continuous) function f : X → R+, there is a unique Scott-continuous linear map fˆ: T(X) → R+ such that fˆ◦ ηX = f . The map fˆ has a natural interpretation
through integration:
fˆ(μ)= ∫ f dμ for every continuous valuation μ ∈ T(X) .

For an elementary definition and the properties of this integral independant of the universal property see [23,29,54,18].
Because of the interpretation of fˆ(μ) as integral	f dμ in the case of real-valued
functions f , it makes sense to say in general that fˆ(μ) is the integral of the Scott- continuous function f defined on a continuous domain X with values in a d-cone C
with respect to the continuous valuation μ on X.

Valuations and Measures
In this section we present some results on the relation between valuations and classical measures. Indeed, for the spaces we deal with here a continuous valuation can always be extended to a Borel measure. The results collected in this section are not used later; however, a reader who is more familiar with measure theory may find them helpful.

A measure is a function μ : ffi → R+ defined on a σ-algebra ffi with values in the non-negative extended real numbers, which is strict and σ-additive. This is equivalent to being strict, monotone, modular and countably continuous. Thus, whenever a measure is defined on the Borel algebra of a topological space, its re- striction to the open sets yields a countably continuous valuation. A sufficient condition for the Scott continuity of this restriction is the inner regularity of the original measure. This is the case for all ﬁnite measures on Polish spaces, see e.g. [6, Proposition 8.1.10]. An obvious class of examples, where countable continuity and Scott continuity are equivalent for open sets, are Borel measures on second countable topological spaces. However, there are examples of Borel measures that are not Scott-continuous when restricted to the open sets: For example take an uncountable set equipped with the discrete topology. Then the Borel algebra is the whole power set. A function that maps every countable subset to 0 and every uncountable subset to ∞ is clearly a measure, but it is not Scott-continuous.

In the remainder of this section we present some answers to the question: when can a continuous valuation be extended to a Borel measure? We present a brief summary of some unpublished work [28]. Notation and results on the measure theoretical background are taken from [4,16].
For metric spaces an affirmative answer can be given using outer measures and
Carath´eodory’s condition:
Proposition 2.12 On a metric space every countably continuous valuation can be extended to a Borel measure. The extension is unique, if it is required to be outer regular.
However, this method cannot be applied to non-Hausdorff spaces directly. We continue with the non-Hausdorff case and consider extensions to ﬁnitely additive measures first: The fact that a valuation is strict and modular implies that it is finitely additive. Thus, it makes sense to ask for finitely additive extensions. We do not impose any additional continuity condition for the moment. The lattice of open sets O(X) of a topological space X can be extended to a Boolean ring R(X) of sets, which consists of all finite unions
n
R =	Ui \ Vi
i=1
with Ui, Vi ∈ O(X) and Vi ⊆ Ui for all i = 1,... ,n ; moreover, one may suppose that the sets Ui \ Vi are mutually disjoint.
For a ﬁnite valuation μ : O(X) → R+, it is clear how a finitely additive extension
μ¯ : R(X) → R+ has to look like if it exists:
n
μ¯(R)=	μ(Ui) − μ(Vi) .
i=1
The following standard result is sometimes called the Smiley–Horn–Tarski Theorem:
Proposition 2.13 Every ﬁnite valuation μ on a lattice of open sets O(X) has a unique extension to a ﬁnitely additive measure μ¯ on the ring R(X) generated by O(X).
In case the valuation is unbounded, an extension is still possible but not nec- essarily unique. Among all the possible extensions there is always a maximal one ([29], [15, p. 377]).
We return to our question of σ-additive extensions of continuous valuations. The following classical result is useful in this context, see e. g. [4, page 164]:



Proposition 2.14 Let R be a ring of sets. If the function μ : R → R+ is strict, ﬁnitely additive and countably subadditive on R, then μ can be extended toa measure on the σ-algebra generated by R. The extension is unique, if μ is σ-ﬁnite on R(X).
If we apply this to our situation, it remains to show that the finitely additive extension μ¯ : R(X) → R+ from Proposition 2.13 is countably subadditive in order to obtain an extension to a Borel measure. And this is indeed the crucial step that could be performed for various spaces using quite different techniques. Using ideas from [47], the authors from [2] could verify countable subadditivity in the following situation:
Proposition 2.15 Let X be a dcpo with the Scott topology and let (μi)i∈I be a
directed set of simple valuations on X with μ =  ↑	μ . If μ is σ-ﬁnite then μ
i
has a unique extension to a measure on the Borel algebra generated by the Scott topology.
The proof of the proposition also applies to sober spaces X. The reason is that the specialisation order of a sober space always yields a dcpo with the original topology being coarser than the Scott topology.
By Proposition 2.10, the simple valuations are a basis for the extended proba- bilistic powerdomain of a continuous domain. Thus, Proposition 2.15 implies:
Corollary 2.16 Every σ-ﬁnite continuous valuation on a continuous domain with the Scott topology can be extended to a Borel measure in a unique way.
In [2] a negative example is also provided, showing that such an extension does not exist in general. For this the authors consider the following example of a non- sober dcpo [22]: X = N × N ∪ {∞} with (j, k) ± (m, n) if either j = m and k ≤ n or n = ∞ and k ≤ m. It is easy to check that this gives a dcpo and that every nonempty Scott-open set contains all but a finite number of points (m, ∞). They define a function on the Scott topology ν : O(X) → R+ by
ν(U )= ⎧⎨1,	if U /= ∅
⎩0,	if U = ∅.
Then ν is modular since the intersection of any pair of nonempty Scott-open sets is again nonempty. Strictness, monotonicity and Scott continuity are easily verified; therefore, ν is a bounded continuous valuation. But ν cannot be extended to a
Borel measure. In fact, Un = X \  n	↓(j, ∞) is a decreasing sequence of open
sets with  ↓n∈N Un = ∅ but limn ν(Un)= 1.

Another situation where the finitely additive extension of a continuous valuation to the ring R(X) can be shown to be countably subadditive is that of properly locally compact pospaces. Recall from section 1.5 that these are locally compact ordered spaces X in which ↑K is compact for every compact subset K. There we have also seen that the open upper sets form a topology which we denoted by U(X). A continuous valuation μ : U(X) → R+ is called locally ﬁnite if μ(U ) < ∞ for all U ∈ U(X) with U  X with respect to the order of subset inclusion on U(X). Equivalently, U  X iff there is a compact set Q ⊆ X containing U . In this situation one has:

Proposition 2.17 Let X be a properly locally compact ordered space and μ : U(X) → R+ a locally ﬁnite continuous valuation deﬁned on the collection U(X) of all open upper sets. Then μ can be extended to a regular Borel measure on the locally compact pospace X in a unique way.

For the compact case, this result is due to Lawson [32]. It has been extended to the properly locally compact case by Weidner [60] and Keimel [28]. In particular, Proposition 2.17 can be applied to locally compact Hausdorff spaces: Equipped with the trivial order, Hausdorff spaces can be viewed as ordered topological spaces. Then, every subset is an upper set and, trivially, the space is a properly locally compact ordered space. Hence, we have:

Corollary 2.18 On a locally compact Hausdorff space, every locally ﬁnite contin- uous valuation can be extended to a regular Borel measure in a unique way.

In 1.8 and the subsequent remark we have seen that there is a one-to-one corre- spondance between properly locally compact pospaces and stably locally compact spaces: the open upper sets of a properly locally compact pospace X form a locally stably compact topology and, vice-versa, the patch topology on a stably locally compact space yields a properly locally compact pospace.
Using all of the above and the extension result of Proposition 2.17, we have the following:

Proposition 2.19 Every locally ﬁnite continuous valuation on a stably locally com- pact space can be extended in a unique way to a regular Borel measure on the properly locally compact ordered space that one obtains by passing to the patch topology.

Additivity of the Way-Below Relation on the Extended Probabilistic Power- domain
We are interested in the additivity of the way-below relation on the extended prob- abilistic powerdomain T(X) over a continuous domain X. In [23] Jones provides a useful characterisation of the order relation for simple valuations. Her characteri- sation is known as Splitting Lemma:
Lemma 2.20 For two simple valuations ξ, χ on a dcpo X, one has:
n	m
ξ = Σ riηxi ≤ Σ sjηyj = χ
i=1	j=1
if and only if there exist tij ∈ R+ such that tij =0 whenever xi /≤ yj and
m
tij = ri for all i
j=1 n
tij ≤ sj for all j . 
i=1
The original proof in [23] uses a directed version of the graph theoretic Max-flow Min-cut Theorem. A more direct argument can be found in [25]. Jones’ Splitting Lemma yields a similar characterisation for the way-below relation between simple valuations as she pointed out in [23]:
Lemma 2.21 For two simple valuations ξ, χ on a continuous domain
n	m
ξ = Σ riηxi  Σ sjηyj = χ
i=1	j=1
if and only if there exist tij ∈ R+ such that tij =0 whenever xi / yj and
m
tij = ri for all i
j=1 n
tij < sj for all j . 
i=1
Using this characterisation of the way-below relation we can show that addition preserves the way below relation between the simple valuations of a continuous domain X. In a second step, we prove that this is sufficient for the way-below relation on T(X) to be additive. Let us remark, that the simple valuations are closed under addition. Thus, it makes sense to restrict our problem to this subset of T(X).

Lemma 2.22 Addition preserves the way-below relation on the simple valuations of a continuous domain.
Proof. The main reason for this is that the way-below relation on simple valuations can be characterized by the Splitting Lemma as a transport problem. The disjoint union of two of these transport problems corresponds to the sum of the simple valuations. Thus the sums are also way-below each other whenever the summands are pairwise way-below. Formally, we can write the proof like this: Let

n1
ξ1 =	riηxi, ξ2 =
i=1
n

i=n1+1
m1
riηxi , χ1 =	sjηyj , χ2 =
j=1
m

j=m1+1

sjηyj

be simple valuations with ξ1  χ1 and ξ2  χ2. Lemma 2.21 gives rise to tij ∈ R+
with tij = 0 whenever xi / yj and
m1
tij = ri	, i = 1,... , n1
j=1 n1
tij < sj	, j = 1,... , m1
i=1 m


j=m1+1 n

i=n1+1
tij = ri	, i = n1 + 1,... ,n 

tij < sj	, j = m1 + 1,... , m.

For the sums ξ1 + ξ2 = Σn	riηx and χ1 + χ2 = Σm  sjηx we take these tij and
i	j
set tij := 0 in case i = n1 +1,... , n, j = 1,... , m1 or i = 1,... n1, j = m1 +1,... , m. Then
m	m1
Σ tij = Σ tij = ri	, i = 1,... , n1

j=1 m
tij =
j=1
n
j=1
m

j=m1+1 n1+1

tij = ri	, i = n1 + 1,... ,n 

Σ tij = Σ tij < sj	, j = 1,... , m1

i=1
n
tij =
i=1
i=1
n

i=n1+1
tij < sj	, j = m1 + 1,... , m.

Thus, we can apply Lemma 2.21 and conclude ξ1 + ξ2  χ1 + χ2.	 
Our next step is to extend the additivity of the way-below relation on a basis to the whole d-cone.

Lemma 2.23 Let C be a continuous d-cone and B a basis of C which is closed under addition. If the way-below relation is additive on B, then it is also additive on C.
Proof. Let x1   y1, x2   y2 in C. Using the interpolation property we find b1, c1, b2, c2 ∈ B with x1 ≤ b1  c1 ≤ y1 and x2 ≤ b2  c2 ≤ y2. Monotonicity of addition and additivity of the way-below relation on B yield x1 + x2 ≤ b1 + b2 c1 + c2 ≤ y1 + y2 and thus, x1 + x2  y1 + y2 follows.	 
We apply these results to the basis of simple valuations of the extended proba- bilistic powerdomain and conclude:
Proposition 2.24 The extended probabilistic powerdomain over a continuous do- main has an additive way-below relation.

	Lower Semicontinuous Functions and Dual Cones
There is another important class of d-cones closely related to the extended proba- bilistic powerdomain. They consist of all non-negative real-valued lower semicon- tinuous functions on a topological space.

Definition 6 Let X be a topological space and let R+ be equipped with the Scott topology. The set of all continuous functions f : X → R+ is denoted by L(X); they are also called lower semicontinuous functions on X since on R+ the Scott topology is equal to the lower topology.
Special elements in L(X) are the characteristic functions χU : X → R+ of open sets U ⊆ X, defined by
χ (x) := ⎧⎪⎨ 1, if x ∈ U
⎪⎩ 0, if x /∈ U.
Given continuous functions f and g on any topological space X and r ∈ R+, the
functions f + g and r · f defined ‘pointwise’ by (f + g)(x) := f (x)+ g(x) and (r · f )(x) := r · f (x) for all x ∈ X are also continuous. This allows us to take finite
linear combinations of characteristic functions, Σn	ri·χU with Ui ∈ O(X), ri ∈ R+
i
for i = 1,... , n. We call them simple functions. We define an order ‘pointwise’ on
L(X) by f ≤ g if f (x) ≤ g(x) for all x ∈ X. It is straightforward to show that for a
directed subset (fi)i∈I of continuous functions a least upper bound	f  exists
↑
i
in L(X) and turns out to be the pointwise supremum (  ↑	f )(x)=  ↑	f (x),

x ∈ X. To make the set L(X) of functions into a continuous domain we do not need a hypothesis as strong as the underlying space X to be continuous, but only its topology O(X), see [14]. We call such a space, whose lattice of open sets is a continuous domain, core compact.
Proposition 2.25 Let X be a topological space. Then the set of lower semicon- tinuous functions L(X) with pointwise addition, scalar multiplication and order is a d-cone. If X is core compact, then L(X) is a continuous d-cone and the simple functions form a basis.
Lower semicontinuous functions have an integral with respect to every continu- ous valuation. Three different approaches to integration have been developed and can be found in [24,23,29], in [54], and in [18]. Integration plays an important role in Jones and Plotkin’s model for probabilistic non-determinism. There, integrals arise if one looks at the probabilistic powerdomain functor T: CONT → CCONE as being monadic. For continuous domains X there is also a duality between T(X) and L(X).

Definition 7 For a d-cone C the set of continuous linear maps into R+ is called
the dual cone of C, denoted
C∗ := {Λ: C → R  | Λ linear, continuous}⊆ R C.
With respect to pointwise addition, scalar multiplication and the pointwise or- der, the dual cone is indeed a d-cone.
There is a duality between T(X) and L(X). One half of this duality between is given by the Riesz Representation Theorem which holds for any topological space X
and states that T(X) is isomorphic to the dual d-cone L(X)∗. This isomorphism is given by integration μ '→ (f '→ f dμ), see [29,54]. Vice versa, unless X is continu- ous, only a linear injection results by the map f '→ (μ '→  f dμ) given analogously
from L(X) into T(X)∗. The Riesz Representation Theorem also provides us with an example that the dual cone of a continuous d-cone is not always continuous;
take X = [0, 1] with the usual Hausdorff topology. Then the Lebesque measure restricted to the open sets is a continuous valuation which cannot be approximated from below. On the other hand, there exist plenty of continuous d-cones for which the dual cone is also continuous. Thus, an interesting question remains to find a characterisation of those continuous d-cones whose dual cone is continuous.
For the remainder of this section we look at L(X) as a d-cone in its own right and we answer the question when its way-below relation is additive.  Thereby,

we restrict our attention to core compact spaces X, since, for exactly those, L(X) becomes continuous. For characteristic functions of open sets the way-below relation is characterised as follows:
Lemma 2.26 Let X be a core compact space, let U, V ∈ O(X) and tU , tV ∈ R+. Then tU χU   tV χV if and only if tU < tV and U  V (or tU = 0).
However, core compactness is not sufficient to obtain an additive way-below relation on the function space. Recall from section 1.5 that a topological space is called stably locally compact if it is sober and locally compact and if the intersection of any two compact saturated subsets is compact.
In stably locally compact spaces we can apply the characterisation of the way- below relation on function spaces from [12]. We denote by suppf := {x ∈ X | f (x) /= ⊥} the support of a continuous function f : X → L, where L is a bounded complete continuous domain and ⊥ the least element of L. Obviously, suppf is open. Using this notation, [12, Theorem 8] states:
Proposition 2.27 Let X be a stably locally compact space and L a bounded com- plete continuous domain with the Scott topology. For f, g ∈ [X → L], the following statements are equivalent:
f   g
(a) suppf   X, and
there are ﬁnitely many Vi ∈ O(X), Qi ∈ Q(X), ti ∈ L, for i = 1,... n, such that
ti  g(v) for all v ∈ Vi,
f (w) ≤ ti for all w /∈ Qi,
X =  n	Vi \ Qi.
Now we can show:
Proposition 2.28 If X is a stably locally compact space, then L(X) has an additive way-below relation.

Proof. Since R+ is a bounded complete continuous domain, we can use the previous characterisation for the way-below relation on the function space L(X). Let fk gk for k = 1, 2, which is equivalent to
suppfk   X, and
there are finitely many V k ∈ O(X), Qk ∈ Q(X), tk ∈ L, for i = 1,... nk, such

that
i	i	i

tk  gk(v) for all v ∈ V k,
i	i
f (w) ≤ tk for all w /∈ Qk,

X =  nk
i
V k \ Qk.

For the sums f1 + f2 and g1 + g2 we deduce
supp(f1 + f2) = suppf1 ∪ suppf2  X, and

the finitely many Vij := V 1 ∩ V 2 ∈ O(X), Qij := Q1 ∪ Q2
∈ Q(X), tij :=

i	j	i	j
t1 + t2 ∈ R+ for i = 1,... , n1 and j = 1,... , n2, satisfy
i	j
tij = t1 + t2  g1(v)+ g2(v)= (g1 + g2)(v) for all v ∈ V 1 ∩ V 2 = Vij, since
i	j	i	j
the way-below relation is additive on R+,
(f1 + f2)(w) = f1(w)+ f2(w) ≤ t1 + t2 = tij for all w /∈ Q1 ∪ Q2 = Qij,
i	j	i	j
since addition is monotone,

X =		V 1 \ Q1 ∩		V 2 \ Q2 

=		 V 1 \ Q1 ∩ V 2 \ Q2 
i	i	j	j
i=1,...,n1
j=1,...,n2
=		 V 1 ∩ V 2 \ Q1 ∪ Q2 
i	j	i	j
i=1,...,n1
j=1,...,n2

=
i=1,...,n1
j=1,...,n2
Vij \ Qij.

Thus, f1 + f2 and g1 + g2 fulfill the characterising condition of f1 + f2  g1 + g2. 
The assumption that X is stably locally compact is necessary.
Proposition 2.29 If a locally compact space X is not stably locally compact, then the way-below relation on L(X) is not additive.
Proof. Because of the duality between the category of stably locally compact spaces and the category of arithmetic lattices, see e.g. Theorem 7.2.19 in [1], we know that if X is locally compact but not stable, we can find open sets U, V, W with U  V and
U   W , but U / V ∩ W . Thus, there exists a directed set (Oi)i∈I of open sets with

↑
i∈I Oi
= V ∩ W , but U /⊆ Oi
for all i ∈ I. Lemma 2.26 tells us χU
  (1 + ε)χV

and χU   (1 + ε)χW for any 0 < ε < 1. But 2χU /  (1 + ε)χV + (1 + ε)χW ,

since (1 + ε)χV
+ (1 + ε)χW
↑
i∈I
(1 + ε)χ
V ∪W
+ (1 + ε)χOi
, and for all i ∈ I is

2χU /≤ (1 + ε)χV ∪W + (1+ ε)χOi .	 



Chapter 3
Hahn-Banach Type Theorems

In this chapter we consider continuous d-cones in a functional analytic context. For a d-cone C, we already introduced linear Scott-continuous functionals Λ: C → R+.
All these functionals are collected in the dual cone C∗. In the special case that we take the d-cone L(X) of lower semicontinuous functions on a topological space X a version of the Riesz Representation Theorem can be shown [29,54]. It states
that the dual cone L(X)∗ can be viewed as the extended probabilistic powerdomain
T(X), i.e., the two are isomorphic as d-cones. If in addition X is a continuous domain we have full duality, meaning that T(X)∗ is isomorphic to L(X), too. This gives us an understanding the linear functionals for some d-cones and the question
arises: What does the dual cone of an arbitrary continuous d-cone look like? We do not even yet know if in general any linear continuous functional exists besides the constantly zero function. It seems to be appropriate to restrict this investigation to continuous d-cones, since they are locally convex by Lemma 2.5, and we know from classical functional analysis that Hahn-Banach Theorems yield especially nice results for locally convex topological vector spaces.
As a tool we will first prove a version of the Sandwich Theorem for continuous d-cones. From this, we obtain a Separation Theorem which implies that, for a continuous d-cone C, the Scott continuous linear functionals separate the points. This information is complemented by a Strict Separation Theorem. Other Hahn- Banach type theorems are extension theorems. We obtain an Extension Theorem in our context under the additional hypothesis of an additive way-below relation. We have seen in the previous chapter that this hypothesis is fulfilled for a broad class of examples. We close this chapter with a Sum Theorem which is a consequence of our Extension Theorem.

A Sandwich Theorem
We start with a version of the Sandwich Theorem for continuous d-cones. For its proof we will take advantage of existing results for ordered cones. First, we introduce sublinear and superlinear functionals:

Definition 8 Let C be a d-cone. A map p : C → R+ is called sublinear if it is homogeneous and subadditive, that is, if p(r · a)= r · p(a) and p(a + b) ≤ p(a)+ p(b) for all a, b ∈ C and all r ∈ R+.
A map q : C → R+ is called superlinear if it is homogeneous and superadditive, that is, if q(r · a)= r · q(a) and q(a + b) ≥ q(a)+ q(b) for all a, b ∈ C and all r ∈ R+.

We quote a sandwich theorem due to W. Roth (see [45], Theorem 2.6) for ordered cones:

Theorem 3.1 Let C be an ordered cone. Let p : C → R+ be a sublinear and q : C → R+ a superlinear functional such that a ≤ b ⇒ q(a) ≤ p(b). (The latter is satisﬁed if q ≤ p and one of p, q is order preserving.) Then there exists an order-preserving linear functional Λ: C → R+ such that q ≤ Λ ≤ p.
Indeed, among the order preserving sublinear functionals f : C → R+ such that
q ≤ f ≤ p there are minimal ones, and all of these are linear.
Proof. Step 1: Without loss of generality we can assume that both p and q are order-preserving. Simply set p'(a) := inf{p(b) | a ≤ b} and q'(a) := sup{q(b) | b ≤ a}. It is easy to see that p' is sublinear, q' superlinear, both are order preserving and q'(a) ≤ p'(a) for all a ∈ C.
Step 2: In the set of all order preserving sublinear functionals f : C → R+ such that q ≤ f ≤ p we can choose a maximal chain F by the Hausdorff maximality principle. The pointwise defined infimum p(x) = inf{f (x) | f ∈ F} is again order preserving and sublinear, hence minimal in the set of all order preserving sublinear functionals f : C → R+ such that q ≤ f ≤ p. In the same way, one finds an order preserving superlinear functional q which is maximal in the set of all order preserving superlinear functionals g : C → R+ such that q ≤ g ≤ p.
Step 3: Assuming that p is sublinear and order-preserving, the set C' := {a ∈
C | p(a) < +∞} is again a cone and a lower set in C. If μ is an order preserving linear functional below p on C', then it can be extended to a linear order preserving functional on all of C by setting it equal to +∞ outside C'. For the task at hand
we can therefore assume that both p and q take values below +∞.

Step 4: We claim that p = q, which implies that Λ := p = q is linear. For this, choose any fixed a ∈ C and let

q'(x) := sup{q(c) − p(b) | b, c ∈ C, c ≤ x + b}	and
p'(x) := inf{p(d)+ λq'(a) | λ ∈ R+,d ∈ C, x ≤ d + λa} .


Setting c = x, b = 0 in the first definition we see that q ≤ q', likewise by setting d = x, λ = 0 in the second we have p' ≤ p. A simple calculation shows that superlinearity, resp. sublinearity, are preserved. By the minimality and maximality
property of p, resp. q, we deduce p' = p and q' = q. By setting x = a, d = 0,λ =1 in the second definition we see that p'(a) ≤ q'(a) and this implies p(a) = q(a) by the previous inequalities. As this is true for all a ∈ C, we conclude p = q. 


For continuous d-cones this sandwich theorem can be strengthened:

Theorem 3.2 ((Sandwich Theorem)) Let C be a continuous d-cone, let p : C → R+ be sublinear and let q : C → R+ be superlinear and Scott-continuous with q ≤ p. Then there is a Scott-continuous linear map Λ: C → R+ such that q ≤ Λ ≤ p.

Proof. Since every d-cone is an ordered cone, we can apply Roth’s sandwich the- orem 3.1 to our situation. As q is supposed to be Scott-continuous, hence order preserving and as q ≤ p, the hypotheses of Roth’s sandwich theorem are indeed sat- isfied. Thus, there is an order preserving linear functional Λ such that q ≤ Λ ≤ p. Moreover, Λ can be chosen to be minimal in the set X of all sublinear order pre- serving maps s : C → R+ with q ≤ s ≤ p. We now show that Λ is Scott-continuous. For a continuous domain, it is known how to find a largest Scott-continuous
function below a monotone one, see Proposition 1.5. If we apply this to Λ we get
the Scott-continuous function Λˇ defined by Λˇ(a) :=  ↑	Λ(b). As q ≤ Λ and as q
is Scott-continuous, we conclude that q ≤ Λˇ. We also have Λˇ ≤ Λ ≤ p. If we can show that Λˇ is also sublinear, then it is an element of X. From the minimality of Λ in X, we then can conclude that Λˇ = Λ; therefore, Λˇ is linear.
Lemma 2.1 implies that Λˇ is homogeneous. For subadditivity observe that z a + b implies that there are a'  a and b'  b such that z  a' + b'. Now, we can calculate

Λˇ(a)+ Λˇ(b)=  ↑ Λ(a')+  ↑ Λ(b')

a'  a
=	↑
a'  a,b'  b
=	↑
a'  a,b'  b
b'  b
Λ(a')+ Λ(b') Λ(a' + b')

≥	↑
z  a+b
Λ(z)

= Λˇ(a + b).
Thus Λˇ is subadditive and the proof is complete.	 
Before concluding this section let us ask whether the Sandwich Theorem 3.2 remains valid, if one replaces the cone R+ by other target cones. More precisely we ask:
Question 1 Which continuous d-cones P have the Sandwich Property that for any continuous d-cone C, any Scott-continuous superlinear q : C → P and any (Scott- continuous) sublinear p : P → C with q ≤ p, there is a Scott-continuous linear map Λ: C → P such that q ≤ Λ ≤ p?
I
	
As R+ has the Sandwich Property, the same holds for every power R . But one
can easily find continuous d-cones P that do not have the Sandwich Property.

Example 2 In R+ × R+ we consider the subcone P of all pairs (a, b) with a ≤ b with the induced ordering. Then P is a continuous d-cone in its own right. We show that P does not have the Sandwich Property.
Let π1, π2 : R+ × R+ → R+ be the canonical projections π1(a, b) = a and
π2(a, b)= b. Define
q =  inf(π1, π2), π2  and p = π1, sup(π1, π2) .


More explicitly


q(a, b)= min(a, b), b and p(a, b)= a, max(a, b) .


	
Then p and q are Scott-continuous maps from R+ × R+ → P , they are sublinear and superlinear, respectively, they fulfill q ≤ p and, moreover, p|P = q|P = id. But there is no linear map from R+ × R+ to P which is the identity when restricted to
P . This is not only obvious, but can be easily proved: Suppose that there is an additive map Λ: R+ ×R+ → P with Λ|P = id. As (1, 1) and (0, 1) are in P , we have

(1, 1) = Λ(1, 1) = Λ(1, 0) + Λ(0, 1) = Λ(1, 0) + (0, 1). It follows that Λ(1, 0) = (1, 0)
which is not in P .
There is a second question related to the previous one: Is there a parametrized Sandwich Theorem? More precisely:
Question 2 Let X be any continuous domain and C a continuous d-cone. Let

qˆ, pˆ: X×C → R+ be Scott-continuous maps such that qˆ ≤ pˆ and such that qˆ(x, −): C →
R+ and pˆ(x, −): C → R+ are superlinear and sublinear, respectively, for all x ∈ X. Is there a Scott-continuous function Λˆ : X × C → R+ such that qˆ ≤ Λˆ ≤ pˆ and such that Λˆ(x, −): C → R+ is linear for all x?
The relation of this question to the previous one is the following: Let L(X) denote the d-cone of all Scott-continuous functions from X into R+ (see Section 2.3). There is a natural order isomorphism of dcpos
[X × C → R+] ∼= [C → L(X)] .

For functions qˆ, pˆ: X × C → R+ with the properties as in the second question, the corresponding functions q, p : C → L(X) under this isomorphism satisfy the hypotheses of the Sandwich Theorem. Thus, the answer to the second question is affirmative if and only if the cone L(X) has the Sandwich Property. This is the case, if X is a discrete domain, i.e., a set with the discrete order, as then we have L(X) ∼= R X . But if we choose X to be the two element Sierpinski space, then L(X) ∼= P , the d-cone which has been shown not to have the Sandwich property in the example above.

A Separation Theorem
To prove our Separation Theorem we need the following:
Lemma 3.3 If B is a Scott-open subset of a d-cone C then r · B is also Scott-open for all r > 0.
Proof. This is an immediate consequence of the fact that scalar multiplication by a real number r > 0 is an order-isomorphism.	 
Theorem 3.4 (Separation Theorem) Let C be a continuous d-cone with two disjoint nonempty convex subsets A and B. If, in addition, B is Scott-open, then there exists a Scott-continuous linear functional Λ: C → R+ such that Λ(a) ≤ 1 < Λ(b) for all a ∈ A and all b ∈ B.

Proof. Without loss of generality we can assume A to be a lower set, since ↓A is also nonempty convex and disjoint from B.
To apply the Sandwich Theorem we have to define functions p and q satisfying all assumptions of Theorem 3.2:
p(a) := inf  λ  λ ∈ R+, a ∈ λA}

Let us show that p is sublinear. For r =0 we have
p(0 · a)= p(0) = inf λ 0 ∈ λA} = 0, because 0 · A = {0}. For r > 0 we calculate
= r · inf  λ'  a ∈ λ'A} = r · p(a).
This shows that p is homogeneous. Subadditivity holds because
p(a1)+ p(a2)= inf λ1  a1 ∈ λ1A} + inf λ2  a2 ∈ λ2A}
≥ inf λ1 + λ2 a1 + a2 ∈ λ1A + λ2A}
= inf  λ1 + λ2  a1 + a2 ∈ (λ1 + λ2)A}, since A is convex

= p(a1 + a2).
Thus, p is sublinear. The steps to show that q is superlinear are nearly the same. To show homogeneity for r = 0, we use the fact that 0 /∈ B implies that 0 ∈ λB if and only if λ = 0. To show monotonicity of q, let a1 ≤ a2. Since B and hence
λB is an upper set for λ > 0, we conclude that {λ | a1 ∈ λB} ⊆ {λ | a2 ∈ λB}. Thus q(a ) ≤ q(a ) holds. Now, let D be a directed subset of C. Then q(  ↑ D) ≥

↑
d∈D
q(d) because q is monotone. By definition q(  ↑ D) = sup{λ |  ↑ D ∈ λB}.

Lemma 3.3 states that for λ > 0, λB is open. Therefore,	↑ D ∈ λB implies that
an element d ∈ D exists such that d ∈ λB. Then
λ ≤ sup{μ | d ∈ μB}≤  ↑ sup{μ | d ∈ μB} =  ↑ q(d),
d∈D	d∈D
which yields q(  ↑ D) ≤  ↑	q(d), hence q is Scott continuous.
Finally, we need to show that q ≤ p. This holds if a ∈ λA, a ∈ μB imply μ < λ. Assume μ ≥ λ. Then λA ⊆ μA, because A is a convex lower set. Thus a ∈ λA implies a ∈ μA. But then a ∈ μB contradicts A ∩ B = ∅.

Now, we apply the Sandwich Theorem to get a linear Scott-continuous function Λ with q ≤ Λ ≤ p. This yields for all a ∈ A and b ∈ B

Λ(a) ≤ p(a) ≤ 1 < q(b) ≤ Λ(b),

since a ∈ 1A implies p(a) ≤ 1 and B open, b =  ↑	r · b imply that there exist
a non-negative real number r < 1 with r · b ∈ B. Thus b ∈ 1 B and 1 > 1, hence,
r	r
q(b) > 1.	 

The Separation Theorem, which we just proved, implies that the Scott-continuous linear functionals separate the points of a continuous d-cone:
Corollary 3.5 Let C be a continuous d-cone and a /≥ b elements of C. Then a linear Scott-continuous function Λ: C → R+ exists such that Λ(a) < Λ(b).

Proof. By Proposition 2.5 the continuous d-cone C is locally convex. Hence a convex Scott-open neighbourhood B of b exists such that a /∈ B. Using this B and A := {a}, we can apply Theorem 3.4 to get the desired function Λ.	 

From this last corollary it follows by a standard procedure that the map δ : C → C∗∗ from a continuous d-cone C into its bidual C∗∗ is an injective morphism of d- cones where, for a ∈ C, we define δ(a) to be the evaluation map of a, i.e. δ(a): C∗ →
R+, δ(a)(Λ) := Λ(a). It is an open question in this context whether δ is also a
topological embedding.
The dual cone C∗ induces a weak topology on the d-cone C, namely the coarsest topology such that all the Scott-continuous linear functionals Λ: C → R+ are lower
semicontinuous. The weak topology on C is always coarser than the Scott topology. It is not known whether the weak topology is equal to the original Scott topology. Nevertheless, both of them have the same specialisation order:
Proposition 3.6 Let C be a continuous d-cone. For the weak topology on C in- duced by C∗, the principal ideals ↓a, a ∈ C, are closed.
Proof. Take a ∈ C. For every b ∈ C \ ↓a let Λb be a linear Scott-continuous functional with Λb(a) ≤ 1 < Λb(b) as has been shown to exist in Corollary 3.5 and
Theorem 3.4. Then ↓a is equal to b∈C\↓a Λ−1([0, 1]), and therefore is closed with respect to the weak topology.	 

A Strict Separation Theorem
We begin by considering the cone R n with the Scott topology. Define the additive

	
norm ||· ||1 : R+ → R+ by:


and the sup norm by:

n
|| x ||1 :=	xi
i=1

|| x ||∞ := maxi=1,...,nxi

The additive norm is a linear continuous functional; the sup norm is sublinear and continuous, but not linear. We say that x is bounded if || x ||∞ < +∞. We have sx 
x, for any bounded x and any s with 0 ≤ s < 1. (This is not true for unbounded
elements.) Note that  is additive on the cone R n. We set 1 = (1,... , 1) ∈ R n.
+	+
Lemma 3.7 Let K be a convex Scott-compact subset of R n disjoint from ↓1. Then there is a linear continuous functional h and an a > 1 such that h(1) ≤ 1 and h(x) > a for all x in K.
Proof. As x ≤ 1 iff || x ||∞ ≤ 1, we have || x ||∞ > 1, for any x in K. But || K ||∞ is compact as the sup norm is continuous. So we get a b such that +∞ > b > 1 and
|| x ||∞ > b for all x in K. Now, setting s = 1/b, we get 0 < s < 1, and, for all x in
K, sx /≤ 1. Now set
V = {y | y >> sx, for some x in K} .

Clearly V is open; it is convex as K is; and it is disjoint from ↓1 as sx /≤ 1 for any x in K. So, by the separation theorem 3.4, there is a linear continuous functional f such that f (x) > 1 for x in V and f (1) ≤ 1.
The open set V contains all bounded elements of K; however it may not contain all its unbounded elements. The latter can be taken care of using the additive norm, and we combine that linearly with f to obtain h. Choose t and r such that s < t < r < 1, take a = r > 1, and set:
h(x)= rf (x)+ (1 − r) || x ||1
n
Clearly h(1) ≤ 1. We claim that h(x) > a for any x in K. For x unbounded this is immediate as then || x ||1 = +∞. For x bounded we have tx >> sx as t > s and so tx is in V , implying f (x) > 1/t; this yields that h(x) ≥ rf (x) > a.	 
Theorem 3.8 ](Strict Separation Theorem)] Let C be a continuous d-cone. Sup- pose that K is a Scott-compact convex set and that A is a nonempty Scott-closed

convex set disjoint from B. Then there is a Scott-continuous linear functional f

and an a in R+ such that f (x) > a > 1 ≥ f (y) for all x in K and all y in A.
Proof. Consider an element v of K. As v is not in A, by local convexity there is a convex Scott-open set U containing v and disjoint from A. So, by the separation theorem 3.4, there is a Scott-continuous linear functional g such that g(v) > 1 and for all y in A, g(y) ≤ 1. So
Ug := {x | g(x) > 1}
is a Scott-open set containing v and disjoint from A. As K is Scott-compact we can cover it by a finite collection Ug ,... , Ug of such open sets. Now define g : C → R n by:
g(x)= (g1(x),... , gn(x)) .
Then g is linear and Scott-continuous. So we have that g(A) ⊂ ↓1 and that g(K) is Scott-compact, convex, and disjoint from ↓1 (any x in K is in some Ugi , so gi(x) > 1, and we have that g(x) /≤ 1).
Lemma 3.7 now yields a Scott-continuous linear functional h and an a > 1 such that h(1) ≤ 1 and h(x) > a for all x ∈ g(K). Choosing f = hog, we obtain the required functional f and constant a.	 
Corollary 3.9 Let C be a continuous d-cone. Suppose that K is a Scott-compact convex set and that A is a nonempty Scott-closed convex set disjoint from K. Then they can be separated by a convex Scott-open set; that is, there is a convex Scott-open set V including K and disjoint from A.
Proof. Take V := {x ∈ C | f (x) > a}, with f and a given by Theorem 3.8. 
Remark 3.10 The strict separation theorem and its proof still go through with the weaker assumption that K is compact in the weak topology, as in the proof one has a covering by sets open in that topology. In this connection, note too that the conclusion of Corollary 3.9 can be strengthened, as the Scott-open set produced is even open in the weak topology.
Proposition 3.11 Let Q be a nonempty Scott-compact saturated convex subset of a continuous d-cone C. Then Q is the intersection of a ﬁltered family of sets of the form ↑conv F, where F is a ﬁnite subset of C such that Q ⊆ †F.
Proof. Let U be a Scott-open set containing Q. We may find a finite subset F of U such that Q ⊆ †F . If U is convex, too, then the convex hull ↑conv F is also contained in U and Q ⊆ † conv F .

By the Strict Separation Theorem, Q is the intersection of the convex Scott-open sets containing it. Hence, Q is the intersection of sets of the form ↑conv F as in the first paragraph. We have to show that this family is filtered. Thus, let F1 and F2 be finite sets such that Q ⊆ †Fi for i = 1, 2. Then V = †F1 ∩ †F2 is a Scott-open set containing P . We may choose a finite set F in V such that Q ⊆ †F . It satisfies
↑conv F ⊆ ↑conv F1 ∩ ↑conv F2.	 
As ↑conv F is saturated and Scott-compact by 2.9, we conclude:
Corollary 3.12 A Scott-compact saturated convex set in a continuous d-cone is the intersection of a ﬁltered family of Scott-compact convex saturated neighborhoods.
We now have the following strong local convexity properties (the second one of which has been observed by A. Jung):
Corollary 3.13 Every Scott-compact saturated convex set in a continuous d-cone C has a neighborhood basis of Scott-compact saturated convex neighborhoods and a neigborhood basis of Scott-open convex neighborhoods.
Proof. Let Q be a Scott-compact convex saturated set in a continuous d-cone C, and let U be any Scott-open set containing Q. The previous corollary and the Hofmann-Mislove theorem (see 1.3) imply that Q has a Scott-compact convex saturated neigborhood K1 contained in U . For the same reason, K1 has a Scott- compact convex saturated neighborhood K2 contained in U . By induction we obtain an increasing sequence of Scott-compact convex saturated sets Kn contained in U such that Kn is in the interior of Kn+1. It follows that V = n Kn is a Scott-open convex neighborhood of Q contained in U .	 

An Extension Theorem
Definition 9 Let C be a continuous d-cone and D a subcone of C. Then D is called a d-subcone of C, if it has the following properties:
D is closed under directed suprema,
D is a continuous domain with respect to the induced order, and
the way-below relation on D is equal to the restriction of the way-below relation on C.
Note, that this definition implies that the Scott topology on a d-subcone D is equal to the restriction of the Scott topology on C. Thus, D is topologically embedded into C.

Example 3 Each Scott-closed subcone of a continuous d-cone is a d-subcone.

Remark that this class of examples of d-subcones of C consists exactly of the closed faces of C, where a convex subset A of a d-cone C is called a face if, for r ∈]0, 1[ and a, b ∈ C, r · a + (1 − r) · b ∈ A implies a, b ∈ A.
Example 4 The diagonal is a d-subcone of Cn for a continuous d-cone C and
n ∈ N.

In order to show that linear Scott-continuous functionals on a d-subcone can be extended we do not only need that the way-below relation on a continuous d-cone is preserved by scalar multiplication, but also by addition. In the previous chapter we discussed when this property of the additivity of the way-below relation holds. Now, we get to our second Hahn-Banach type theorem for continuous d-cones:
Theorem 3.14 ((Extension Theorem)) Let C be a continuous d-cone with an additive way-below relation, and let D be a d-subcone of C. Moreover, let Λ˜ : D → R+ be linear and Scott-continuous, let p : C → R+ be sublinear and


d ≤ a + c, d, a ∈ D, c ∈ C =⇒
Λ˜(d) ≤ Λ˜(a)+ p(c).


Then there is a Scott-continuous linear extension Λ: C → R+ of Λ˜ with Λ ≤ p.
Proof. Let us first remark that Λ˜ ≤ p on D, since d ≤ 0+ d for all d ∈ D implies Λ˜(d) ≤ Λ˜(0) + p(d)=0 + p(d)= p(d).
We want to apply the Sandwich Theorem 3.2 to a sublinear, monotone function p¯ ≤ p and a superlinear Scott continuous function qˇ with qˇ ≤ p¯ on C and qˇ|D = Λ˜ = p¯|D in order to get the desired extension Λ of Λ˜. We define p¯, qˇ and an auxiliary function q, which will be shown to be superlinear, monotone and q|D = Λ˜, as follows:
p¯(a) := inf Λ˜(d)+ p(c) d ∈ D, c ∈ C, a ≤ d + c}
q(a) := sup Λ˜(d) − p¯(c) d ∈ D, c ∈ C, p¯(c) < ∞,d ≤ a + c}

b  a

First, we prove all the properties that we claimed p¯: C → R+ to have. We have
p¯ ≥ 0, since Λ˜ ≥ 0 and p ≥ 0. Moreover, 0 ≤ 0 + 0 implies p¯(0) ≤ Λ˜(0) + p(0) = 0,
and hence p¯(0) = 0.	For r > 0, using that multiplication with r is an order
isomorphism, we calculate:

p¯(r · a)= inf Λ˜(d)+ p(c) d ∈ C, c ∈ C, r · a ≤ d + c}
= inf  r · Λ˜ 1 · d + r · p 1 · c  d ∈ D, c ∈ C, a ≤ 1 · d + 1 · c,
= r · inf Λ˜(d')+ p(c') d' ∈ D, c' ∈ C, a ≤ d' + c'
= r · p¯(a).
This shows that p¯ is homogeneous. Now, we prove subadditivity:
p¯(a1)+ p¯(a2)= inf Λ˜(d1)+ p(c1) d1 ∈ D, c1 ∈ C, a1 ≤ d1 + c1}
+ inf  Λ˜(d2)+ p(c2)  d2 ∈ D, c2 ∈ C, a2 ≤ d2 + c2}


≥ inf Λ˜(d1 + d2)+ p(c1 + c2) d1, d2 ∈ D, c1, c2 ∈ C, a1 + a2 ≤ d1 + d2 + c1 + c2
≥ inf Λ˜(d)+ p(c) d ∈ D, c ∈ C, a1 + a2 ≤ d + c
= p¯(a1 + a2).
Thus, p¯ is subadditive and hence sublinear. To prove that p¯ is monotone let a1 ≤ a2.
C, a2 ≤ d + c}, and hence p¯(a1) ≤ p¯(a2). For all a ∈ C, a ≤ 0+ a and thus
p¯(a) ≤ Λ˜(0) + p(a)= p(a), which means p¯ ≤ p.
Let a, d ∈ D and c ∈ C such that d ≤ a + c. For all e ∈ D and f ∈ C with
c ≤ e + f we have d ≤ (a + e)+ f . Thus, by hypothesis,
Λ˜(d) ≤ Λ˜(a + e)+ p(f )= Λ˜(a)+ Λ˜(e)+ p(f ).

This implies
Λ˜(d) ≤ inf Λ˜(a)+ Λ˜(e)+ p(f ) c ≤ e + f
= Λ˜(a)+ inf Λ˜(e)+ p(f ) c ≤ e + f
= Λ˜(a)+ p¯(c).
So, p¯ also fulfills that d ≤ a + c always implies Λ˜(d) ≤ Λ˜(a)+ p¯(c). Especially, Λ˜ ≤ p¯. For all d ∈ D, we have d ≤ d +0 and thus p¯(d) ≤ Λ˜(d)+ p(0) = Λ˜(d). The last two inequalities together tell us that p¯|D = Λ˜.

Secondly, we prove all the properties that we claimed q : C → R+ to have. We know 0 ≤ a +0 for all a ∈ C, which implies q(a) ≥ 0. Since d ≤ 0+ c implies Λ˜(d) ≤ p¯(c) which, for p¯(c) < ∞, is equivalent to Λ˜(d) − p¯(c) ≤ 0, we conclude
that q(0) ≤ 0. Therefore q(0) = 0 holds. Homogeneity for r > 0 holds because

multiplication with r is an order-isomorphism. Superadditivity of q follows from a similar calculation like the one for subadditivity of p¯. To prove that q is monotone let a ≤ a . Then Λ˜(d) − p¯(c) d ∈ D, c ∈ C, p¯(c) < ∞,d ≤ a + c ⊆ Λ˜(d) − p¯(c)
d ∈ D, c ∈ C, p¯(c) < ∞,d ≤ a2 + c , and hence q(a1) ≤ q(a2). Let a ∈ C and
d ≤ a + c with d ∈ D, c ∈ C and p¯(c) < ∞. Then Λ˜(d) ≤ p¯(d), since Λ˜ ≤ p¯
≤ p¯(a + c), since p¯ is monotone
≤ p¯(a)+ p¯(c), since p¯ is sublinear.

For p¯(c) < ∞ this is equivalent to Λ˜(d) − p¯(c) ≤
p¯(a), and hence q(a) ≤ p¯(a),

respectively q ≤ p¯ on C. For d ∈ D, d ≤ d + 0 implies q(d) ≥ Λ˜(d) − p¯(0) = Λ˜(d). Moreover, q(d) ≤ p¯(d)= Λ˜(d) for d ∈ D, hence q|D = Λ˜.
By its definition, qˇ is the greatest Scott-continuous function below q. Thus qˇ ≤ p¯ is clear. With Lemma 2.1 it follows immediately that qˇ is homogeneous. To show superadditivity of qˇ we calculate
qˇ(a )+ qˇ(a )=  ↑ q(b )+  ↑ q(b )

1	2	1
b1  a1
2
b2  a2

=  ↑ q(b )+ q(b ) b   a ,b 
  a }, as + is Scott-cont.

≤  ↑ q(b + b ) b   a ,b 
  a }, as q is superadditive

≤  ↑ q(c) c  a
= qˇ(a1 + a2).
+ a2}, as   is additive

By definition, the d-subcone D is closed under directed suprema, it is a continuous d-cone with respect to the induced order, and the way-below relation on D is the
restriction of the way-below relation on C. These properties together with the facts that q|D = Λ˜ and that Λ˜ is Scott-continuous imply
qˇ(a)=  ↑ q(b) b  a and b ∈ C} =  ↑ q(b) b  a and b ∈ D}
=  ↑ Λ˜(b) b  a and b ∈ D} = Λ˜(a),
for a ∈ D. This shows qˇ|D = Λ˜ and completes the proof.	 
In the case that only a linear Scott-continuous functional Λ˜ : D → R+ is given
without a sublinear dominating p : C → R+, we still obtain an extension of Λ˜ to the whole d-cone C. To see this define p : C → R+ by
⎧⎨Λ˜(a),	if a ∈ D

p(a) :=
⎩∞,	if a /∈ D.

Then, Λ˜ and p fulfill the hypothesis of the Extension Theorem 3.14 and we get as an immediate consequence:
Corollary 3.15 Let C be a continuous d-cone with an additive way-below relation. Let D be a d-subcone of C and let Λ˜ : D → R+ be linear and Scott-continuous. Then there is a Scott-continuous linear extension Λ: C → R+ of Λ˜.

In other words this corollary states that R+ is injective in the category of con- tinuous d-cones with additive way-below relations and with respect to d-subcone embeddings.
As another consequence of the Extension Theorem we obtain a Sum Theorem for continuous d-cones:
Theorem 3.16 ((Sum Theorem)) Let C be a continuous d-cone with an additive way-below relation, let Λ: C → R+ be linear and Scott continuous, let p1,... , pn : C → R+ be sublinear, and for d, a, c1,... , cn ∈ C,
n
d ≤ a + ck, k = 1,... ,n =⇒ Λ(d) ≤ Λ(a)+	pk(ck).
k=1

Then Scott continuous linear functions Λk : C → R+ exist with Λk ≤ pk, k = 1,... , n, and Λ= Λ1 + ... + Λn.
Proof. First, remark that Λ ≤ p1 + ... + pn, since c ≤ 0+ c implies
n
Λ(c) ≤ Λ(0) +	pk(c)= p1(c)+ ... + pn(c)
k=1
for all c ∈ C. The main steps of the proof turn out to be quite similar to the proof of [13, Theorem 1.4.1], a Sum Theorem for pre-ordered Abelian semigroups.
For a continuous d-cone C with additive way-below relation, Cn is also a con-
tinuous d-cone with additive way-below relation by Proposition 2.4. The diagonal Δ ⊆ Cn is a d-subcone and Λ˜ : Δ → R+, Λ˜(d,... , d) := Λ(d), is linear and Scott-
continuous. The map p : Cn → R+, p(c1,... , cn) := Σn	pk(ck) is sublinear. By
definition of pointwise addition and order, (d,... , d) ≤ (a,... , a)+ (c1,... , cn) is equivalent to d ≤ a + ck, k = 1,... , n, for a, b, ck ∈ C. Thus,
n
Λ˜(d,... , d)= Λ(d) ≤ Λ(a)+	pk(ck)= Λ˜(a,... , a)+ p(c1,... , cn)
k=1
follows from the hypothesis. This means that we can apply our Extension Theo- rem 3.14 to this situation and obtain a linear Scott-continuous extension Λ¯ : Cn →

R+ of Λ˜ with Λ¯ ≤ p on Cn. We define Λk : C → R+ by Λk(c) := Λ Δk(c) , where Δk(c) := (0,... , 0, c, 0,... , 0) with c at the k-th component and every other com- ponent is equal to zero. As Λ is linear, Scott-continuous and Λ ≤ p, it follows that Λk is linear, Scott-continuous and Λk ≤ pk. Moreover, for d ∈ C,

Λ(d) = Λ˜(d,... , d)= Λ¯ (d,... , d)= Λ¯  Σn
Δk(d)  = Σn

Λ¯ Δk(d) 



n k=1
Λk(d).



Chapter 4
Power Constructions

Consider non-deterministic behaviour of a computer program. Naturally, some kind of power set construction arises in modelling the different possible outcomes of the program for the same input value. A semantics of non-deterministic features within the framework of domain theory was given by Plotkin in [40]. There, he introduced the so-called convex powerdomain (also called Plotkin powerdomain) to capture finite non-deterministic branching. The fact that only finitely many choices are possible is also called bounded non-determinism. Shortly after this, Smyth [52] pro- posed a simpler, half-sided powerdomain, the upper (or Smyth) powerdomain. This one describes a demonic view of bounded non-determinism, while an angelic view is modelled by the lower (or Hoare) powerdomain. Unlike the convex powerdomains, the lower powerdomain cannot be attributed to a single person. It received its name from its connection to Hoare’s work on partial correctness [19]. The upper power- domain can also be used to model total correctness, while the convex powerdomain combines both approaches. Under certain conditions on the underlying space there exist nice topological characterisations for these classical powerdomains as special subsets of the whole power set. We will recall these representations later when we modify them within the context of continuous d-cones.
Winskel describes the classical powerdomains via modal assertions in [61]. The lower powerdomain is built up from assertions about possible behaviour of a process, the upper powerdomain is built up from assertions about the inevitable behaviour of a process, while the convex powerdomain is built up from both kinds of assertions taken together. Heckmann studies these and other powerdomain constructions in a general algebraic framework [17]. The topological concept of powerdomains is stressed by Smyth in [53]. There, he highlights that open sets should be viewed as computable properties.

A different kind of non-determinism is given by probabilistic choice. We already mentioned that a suitable model is given by the probabilistic powerdomain, see [24,23]. What happens if we combine both kinds of non-determinism? A research group in Oxford tackled various aspects of this problem. From this group, Morgan, McIver, and Seidel introduced probabilistic predicate transformers in [38] where non-determinism coexists with probabilistic choice. In [36], Morgan and McIver built a Plotkin style powerdomain over the space of probability distributions on a dicrete state space. We modify their approach in this chapter and develop for all three classical power constructions a version for the extended probabilistic power- domain over continuous state spaces. Actually, it turns out that the more general structure of continuous d-cones suffices for these constructions. We will use the topological characterisations of the classical powerdomains and modify them by us- ing convex subsets. This takes the cone structure into consideration and enables us to lift addition and scalar multiplication to our power constructions. The lifting happens in such a way that the powerdomains also become d-cones. We call them convex powercones.
It is another important property of the classical powerdomains that they are universal with respect to an additional semilattice operation. Developing this point of view, Main related free constructions of powerdomains with semiring modules[35]. Abramsky and Jung studied free continuous domain-algebras in [1]. In this chapter we will also show our convex d-cones to be universal in a suitable setting. Note that even if applied to subsets of a d-cone C, the symbols ↓, ↑, ↓ and † will always refer to the order on C and not to the order on any powerdomain over C.

The Convex Lower Powercone
As the lower powerdomain describes partial correctness, every element approximat- ing the desired behaviour of a program can also be used for an interpretation. An approximation usually means that the program terminates for fewer input values. This does not matter since for partial correctness one is only interested in a correct output whenever the program terminates. This idea may give an intuition for the topological characterisation of the classical lower powerdomain Hc(X) as being the Scott-closed subsets of the underlying domain X ordered by subset inclusion. And – for the topologies we deal with – closed sets are always lower sets. This explains the use of the term ‘lower’.
We will modify this characterisation of the classical lower powerdomain to define the convex lower powercone H(C) over a d-cone C. Then H(C) will be a d-cone in

which binary suprema exist and give an extra semilattice operation. In this context,
H(C) will be shown to be universal.

The Convex Lower Powercone Construction
For a d-cone (C, +, 0, ·) we consider the collection
H(C) := {A ⊆ C | A nonempty, Scott-closed, convex}

of all nonempty Scott-closed convex subsets of C ordered by inclusion ⊆. Addition and scalar multiplication are lifted to H(C) in the following way:

+ : H(C) × H(C) → H(C),	A + B := A + B,
H	H

· : R+ × H(C) → H(C),	r · A := r · A,
H	H

where A + B is the closure of A + B = {a + b | a ∈ A, b ∈ B} in the Scott topology, and r · A = {r · a | a ∈ A}. With these definitions we will prove in this section:
Theorem 4.1 Let (C, +, 0, ·) be a d-cone. Then H(C), + , {0}, · is also a d-cone,
called the convex lower powercone (sometimes also the convex Hoare powercone of C). Binary suprema (hence arbitrary suprema) exist in H(C) and satisfy the following distributivity laws:
A + (B ∨ D)= (A + B) ∨ (A + D)
H	H	H
r · (A ∨ B)= r · A ∨ r · B.
H	H	H
If C is a continuous d-cone, then H(C) is a continuous d-cone, too. If, in addition, the way-below relation is additive on C, the same holds for H(C).
Let us note that, for a continuous d-cone C, the convex lower powercone H(C) is a continuous lattice, hence Lawson-compact.
The proof of this theorem will be broken down in smaller steps. We henceforward suppose C to be a d-cone.
The intersection of a family of nonempty Scott-closed convex sets is again a Scott-closed convex set, and nonempty, as 0 is contained in every nonempty Scott- closed set. Thus we have:
Proposition 4.2 The set H(C) ordered by inclusion is a complete lattice.
For every subset M ⊆ C, there is a smallest Scott-closed convex subset contain- ing M : One first forms the convex hull conv M and then its Scott closure conv M

which is again convex by Proposition 2.7. Thus, binary suprema in H(C) are formed as the Scott closure of the convex hull of the union of two sets,

A ∨ B = conv(A ∪ B) ,
and likewise for the supremum of an arbitrary family (Ai) in H(C),

  Ai = conv  Ai .
i	i
As the union of a directed family of convex sets Ai is again convex, directed suprema in H(C) are given by the topological closure of the directed union

  ↑ A =  ↑ A .
Finally {0} is the least element of H(C).
Now we check the cone properties. Immediately from the definition we see that
{0} is the neutral element for addition in H(C).
Proposition 4.3  H(C), + , {0}, · as deﬁned above is a cone.
Proof. Let us start by showing that the operations + and · are well-defined. For
H	H
convex sets A and B the sum A + B is also convex by 2.8. Its Scott closure is
convex by Lemma 2.7. Multiplication of A by an r ∈ R+ is either {0}, the neutral element of H(C), for r = 0; or else r · A = r · A is again convex and Scott-closed
H
since multiplication by r > 0 is an order isomorphism of the d-cone C.
Most of the cone axioms are straightforward to check using the fact that they are satisfied for the nonempty convex subsets by 2.8. For the associativity of + , for
H
example, we use the Scott continuity of the addition on C and Lemma 1.2: (A +
H
A2)+ A3 = A1 + A2 + A3 = A1 + A2 + A3 = A1 + A2 + A3 = A1 + (A2 + A3). 
H	H	H
Proposition 4.4 Addition + and scalar multiplication · on H(C) are Scott-continuous.
H	H
Proof. Monotonicity of addition on H(C) is clear from its definition. Using the Scott continuity of the addition on C and Lemma 1.2 we have
A + (  ↑ A ) = A +  ↑ A = A +  ↑ A



=  ↑(A + A )=  ↑ A + A
=  ↑

We use that scalar multiplication on C is Scott-continuous and calculate for A ∈

H(C), (  ↑ r ) · A = {(  ↑ r ) · a | a ∈ A} = {  ↑	· a) | a ∈ A} =  ↑ r · A =

(ri · A).  For a directed family (Ai) in H(C) and fixed r ∈ R+, the relation

r ·  ↑ A
↑ r · A ) is straightforward.	 
H

This proposition concludes our proof that H(C) is a d-cone. Binary suprema in
H(C) distribute over the algebraic operations:

Proposition 4.5 For binary suprema in H(C), A∨B = conv(A ∪ B), the following distributivity laws hold for A, B, D ∈ H(C) and r ∈ R+,
A + (B ∨ D)= (A + B) ∨ (A + D)
H	H	H
r · (A ∨ B)= r · A ∨ r · B.
H	H	H
Proof. From the monotonicity of addition we get immediately (A + B) ∨(A + D) ⊆
H	H
A + (B ∨ D). For the other inclusion we use the Scott continuity of addition on C
H
and Lemma 1.2 in order to see that
A + (B ∨ D)= A + conv(B ∪ D)= A + conv(B ∪ D) .
H
Now it suffices to show that A + conv(B ∪ D) ⊆ (A + B) ∨ (A + D). So, let
H	H
x ∈ A + conv(B ∪ D) be arbitrary. Then there are elements a ∈ A, b ∈ B, d ∈ D
and a real number 0 ≤ r ≤ 1 such that
x = a + rb + (1 − r)d = r(a + b)+ (1 − r)(a + d) ,

whence x ∈ conv (A + B) ∪ (A + D)  ⊆ conv (A + B) ∪ (A + D)  = (A + B) ∨
(A + D).
H
We have 0· (A∨B)= {0} = {0}∨{0} = (0· A)∨(0· B). For r > 0, multiplication
H	H	H
by r is an isomorphism and we conclude

r · (A ∨ B)= r · conv(A ∪ B)= r · conv(A ∪ B)
H
= conv(r · A ∪ r · B)= (r · A) ∨ (r · B).
H	H


Together with the Scott continuity of addition and scalar multiplication in the cone H(C), this proposition yields that arbitrary non-empty suprema are preserved by these operations.
Proposition 4.6 If C is a continuous d-cone, then H(C) is a continuous lattice, too. We have B  H A in H(C) if and only if there is a ﬁnite set F such that B ⊆ conv F and F ⊆ ↓A. The sets conv F for nonempty ﬁnite F ⊆ C form a basis of the continuous lattice H(C).

Proof. Let C be a continuous d-cone. To show the continuity of H(C), we imitate the proof of Proposition 6.5 in [48].  First, we show that x   y in C implies

↓x  H ↓y in H(C). Let ↓y ⊆  ↑ Ai for some directed family (Ai)i∈I in H(C).

Since  ↑ Ai = {  S | S directed,S ⊆  A } by Lemma 1.4, there exist a directed
↑	↑
set S ⊆  ↑ A with y ≤  ↑ S. From x   y we conclude that x ≤ s for some
s ∈ S. As there is an i ∈ I with s ∈ Ai, we conclude ↓x ⊆ ↓s ⊆ Ai, hence
↓x  ↓y in H(C). For each Scott-closed convex set A, the continuity of C yields

A =	{↓d | ∃ a ∈ A. d  a} =	{↓d | ∃ a ∈ A. d   a}. We just proved that
↓d  ↓a ⊆ A, whence ↓d  A in H(C). Thus, A is the supremum of convex Scott- closed subsets ↓d way-below it with respect to the Hoare order of subset inclusion. This implies that the lattice H(C) is continuous. It also implies that the finitely generated Scott-closed convex sets conv F, F finite and F  A, are way-below A and that their directed supremum is A. From this we infer the characterisation of the way-below relation claimed in the statement of the proposition.	 
For an alternative proof of continuity for H(C), we can use the fact that for the ordinary lower powerdomain Hc(C) of all nonempty Scott-closed subsets it is well-known that a continuous domain yields a continuous powerdomain (see e.g. Corollary IV-8.7 in [15]). We define a continuous retraction-section pair between the convex lower powercone H(C) and the ordinary lower powerdomain Hc(C). Then H(C) is continuous as the retract of a continuous domain. The retraction is defined in the obvious way r : Hc(C) → H(C), r(A) := conv A. The section is the inclusion map j : H(C) → Hc(C), j(B) := B.
Using the above characterisation of the way-below relation on H(C) we can show that the additivity of the way-below relation is preserved:
Proposition 4.7 If the continuous d-cone C has an additive way-below relation then H(C) does too.
Proof. Let A1  H B1 and A2  H B2 in H(C). By the above characterisation
there exist a finite set Fi such that Ai ⊆ conv Fi and Fi  Bi for i = 1, 2. We claim that F := F1 + F2 is a finite set which is a witness for A1 + A2  H B1 + B2.
H	H
For A1 + A2 = A1 + A2 ⊆ conv F it suffices to show A1 + A2 ⊆ conv F since the latter set is Scott-closed. We have

A1 + A2 ⊆ conv F1 + conv F2
⊆ (conv F1)+ (conv F2), by Lemma 1.2
= conv(F1 + F2), by Lemma 2.8
= conv F. 

For e = e1 +e2 ∈ E there exist b1 ∈ B1 and b2 ∈ B2 with e1  b1 and e2  b2. Since the way-below relation on C is additive we conclude e1 + e2  b1 + b2 ∈ B1 + B2. 

One step of the last proof was to show conv F1 + conv F2 ⊆ conv(F1 + F2). Since the right hand side is closed, we also obtain that conv F1 + conv F2 ⊆ conv(F1 + F2). The left hand side of this inclusion is convex, closed and contains F1 + F2; thus, the converse inclusion also holds. We conclude conv F1 + conv F2 = conv(F1 + F2). We will use this fact later for our convex Plotkin type construction.

Universal Property of the Convex Lower Powercone
Like the classical lower powerdomain, the convex lower powercone can also be de- scribed by a universal property: the d-cone H(C) is the free ∨-d-cone over a d-cone
C. In this section we will prove this statement.
Let us look at our construction in a categorical setting. The d-cones are the objects of the category CONE with the Scott-continuous linear maps as morphisms. In the category CONE∨ we collect as objects those d-cones in which binary suprema (hence arbitrary suprema) exist and distribute over addition and scalar multiplica-
tion as follows:
a + (b ∨ c)= (a + b) ∨ (a + c) r · (a ∨ b)= r · a ∨ r · b
Together with Scott continuity, these two conditions yield that arbitrary suprema distribute over addition and scalar multiplication. The morphisms in the category
CONE∨ are the linear maps preserving arbitrary suprema. In Theorem 4.1 we have seen that the convex lower powercones are objects in the category CONE∨.
Proposition 4.8 The assignment C '→ H(C) can be extended toa functor H: CONE
→ CONE∨ by assigning to any Scott-continuous linear map f : C → D between d- cones the linear map H(f ): H(C) → H(D) preserving arbitrary suprema deﬁned by H(f )(A) := f (A).
Proof. For a Scott-continuous linear function f : C → D between d-cones we have to show that H(f ): H(C) → H(D) is linear and preserves arbitrary suprema. All these are short calculations where one uses the Scott continuity of the function f , of addition and scalar multiplication on C and Lemma 1.2. To finish the proof of the functoriality of H, we calculate for any Scott-closed set A ⊆ C,

H(idC)(A)= idC(A)= A = A = idH(C)(A).

Regarding composition we use continuity of f and g to get
H(g ◦ f )(A)= g f (A) = g f (A) = H(g) ◦ H(f ) (A).
Lemma 4.9 Besides the functor H: CONE → CONE∨ we have the forgetful functor U: CONE∨ → CONE in the other direction and a natural transformation j : IdCONE → U ◦ H where, for each d-cone C, the morphism jC : C → H(C) maps an element
x ∈ C to its lower closure ↓x.
Proof. First we show that for every d-cone C, the map jC is Scott-continuous and linear, hence, a morphism between d-cones. Scott continuity is clear from

↓( ↑ x )=  ↑↓x
=  ↑ ↓x ). To show additivity we calculate
↓(x + y)= ↓(↓x + ↓y)= ↓x + ↓y = ↓x + ↓y.
H

For scalars r ∈ R	we get ↓(r · x)= r · ↓x = r · ↓x.
H
It remains to prove that, for any Scott-continuous linear function f : C → D, the following diagram commutes
jC) H(C)

f	H(f )
v	jD)	v
H(D)

which is equivalent to the statement ↓f (x)= f (↓x) which is straightforward. 
Now, we can prove the following universal property
Theorem 4.10 The functor H: CONE → CONE∨ is left adjoint to the forgetful functor U: CONE∨ → CONE. In other words, for every d-cone C and every Scott- continuous linear map f from C into a d-cone L ∈ CONE∨, there is a unique linear map fˆ: H(C) → L preserving arbitrary suprema such that f = fˆ◦ jC:



fˆ ∈ CONE∨


Proof. To make the diagram commute we must have fˆ(↓x)= f (x). In order to get a map preserving suprema we are forced to set fˆ(A) := sup f (A). This shows the

uniqueness of the function fˆ. It remains to show the map fˆ: H(C) → L defined by
fˆ(A) := sup f (A) is a morphism in CONE∨ which makes the diagram commute.
Since f is monotone fˆ(↓x)=	a∈↓x f (a) ≤ f (x). But since x ∈ ↓x we also have
f (x) ≤ fˆ(↓x), which proves that the diagram commutes.
We now note that for arbitrary A ⊆ C we have:

sup f (A) = sup f (A)= sup f (A)	(1)

= sup f (conv A)= sup conv f (A)	(2)
Indeed x is an upper bound of f (A) iff f (A) ⊆ ↓x and this is equivalent to conv f (A) ⊆ ↓x, as ↓x is Scott-closed and convex. Thus, f (A) and conv f (A) have the same upper bounds, hence the same least upper bound. As f (A) ⊆ f (A) ⊆ f (A) ⊆ f (conv A) ⊆ conv f (A) by the continuity and linearity of f , it follows that all the sups are the same as claimed.
We will use this fact for proving the linearity of fˆ. Let A, B ∈ H(C):
fˆ(A + B) = sup f (A + B)
H	H

= sup f (A + B)
= sup f (A + B)	by equation (1)
= sup f (A)+ f (B)	as f is linear
= sup f (A)+ sup f (B) as addition distributes over sups in L
= fˆ(A)+ fˆ(B).
For any scalar r ∈ R+ we similarly have
fˆ(r · A)= sup f (r · A) = sup r · f (A) = r · sup f (A) = r · fˆ(A).
In order to finish the proof, we take any family (Ai) in H(C) and we have:

fˆ   Ai = sup f conv  Ai 
	
= sup f   Ai	by equation (2)

= sup   f (Ai) 

= sup sup f (Ai) 

= sup fˆ(Ai).
i



As a special case for the universal property we may consider a Scott-continuous linear functional f : C → R+. Then there is a unique linear functional f : H(C) → R+ preserving arbitrary suprema such that f ◦ jC = f , and this functional is defined by
f^(A)= sup f (A) for every Scott-closed convex subset A ⊆ C . 

The Convex Upper Powercone
The upper powerdomain describes total correctness. As non-termination is treated as the worst output, this view is quite opposite to the view of partial correctness for the lower powerdomain. Thus, it is not surprising that the topological characterisa- tion of the upper powerdomain (also called Smyth powerdomain) Sc(X) consists of nonempty compact saturated (= upper) subsets ordered by reverse inclusion. This explains the ‘upper’ nomenclature. Compactness is somewhat harder to motivate. It generalises finiteness, as finitely generated upper sets form a basis for the upper powerdomain of a continuous domain. As for the ordinary upper powerdomain, the universal property of the convex upper powercone does not hold over arbitrary dcpos. One has to restrict to continuous domains.
The Convex Upper Powercone Construction
For a continuous d-cone (C, +, 0, ·) we consider the collection
S(C) := {P ⊆ C | P nonempty, compact, convex, saturated}
of all nonempty Scott-compact convex saturated subsets ordered by reverse inclu- sion ⊇. Addition and scalar multiplication are lifted from C to S(C) in the following way:
+ : S(C) × S(C) → S(C),	P + Q := ↑(P + Q)
S	S

· : R+ × S(C) → S(C),	r · P := ↑(r · P )
S	S
Note that r · P = ↑{0} = C if r =0 and r · P = r · P if r > 0. We will prove that
S	S
S(C) becomes a continuous d-cone in which binary infima exist:
Theorem 4.11 Let (C, +, 0, ·) be a continuous d-cone.  Then  S(C), + , C, ·  is
a continuous d-cone with the order of reverse inclusion called the convex upper powercone (sometimes also convex Smyth powercone). Moreover, binary inﬁma exist in S(C) and satisfy the following distributivity laws:

P + (Q ∧ R)= (P + Q) ∧ (P + R)
S	S	S
r · (P ∧ Q)= (r · P ) ∧ (r · Q)
S	S	S
If the way-below relation is additive on C, the same holds for S(C). If C is Lawson- compact, then S(C) is a continuous lattice, hence Lawson-compact, too.
Most of this section is devoted to the proof of this Theorem. We will suppose henceforeward that C is a continuous d-cone.

A family (Pi)i∈I of nonempty Scott-compact convex saturated subsets of C, which is directed for reverse inclusion, is filtered for inclusion. Hence, i∈I Pi is again nonempty Scott-compact convex and saturated by Proposition 1.3. As it is
the biggest such set contained in all the Pi, it is their infimum with respect to the order of reverse inclusion.

↑ P
i∈I
=	↓ Pi .
i∈I

For P, Q ∈ S(C), the set conv(P ∪ Q) is Scott-compact by Lemma 2.9, and so is
↑conv(P ∪ Q). It is the smallest convex saturated set which contains P and Q, hence, the supremum of P and Q in S(C) with respect to reverse inclusion. If C is Lawson-compact, the intersection of two compact saturated convex sets is again such; hence, S(C) is even a complete lattice. We have shown:
Proposition 4.12 In S(C) directed suprema and binary inﬁma with respect to the order of reverse inclusion exist. They are given by

  ↑ P = 
↓
Pi,

i∈I	i∈I
P ∧ Q = ↑conv(P ∪ Q) .
In particular, S(C) is a dcpo with respect to the order of reverse inclusion. If C is Lawson-compact, then S(C) is a complete lattice.
There is a bottom element in S(C), namely ↑0 = C. This is also the neutral element for addition on S(C).
Proposition 4.13 The above deﬁned S(C), + , C, · is a cone.
Proof. First, we show that the operations + and · are well-defined. The sum of two
S	S
Scott-compact sets is again Scott-compact since addition on C is Scott-continuous.
The sum of any two convex sets is again convex. Taking the upper set ↑(P + Q) preserves compactness and convexity. Surely, this set is also nonempty whenever
P and Q are nonempty. Multiplication by r = 0 yields 0 · P = ↑{0} = C, a
S

non-empty compact saturated subset of C. Since multiplication by r > 0 is an order-isomorphism, we have r · P = r · P and nonempty Scott-compact convex
S
saturated subsets are mapped to sets with the same properties.
The associativity of addition on S(C) is straightforward to check using that addition on C is monotone. Commutativity of addition is immediate. The original cone C is the neutral element for addition in S(C) since it contains the neutral
element 0 of C and because addition is monotone on C. We have 1 · P = P and
S
0·P = C, the neutral element in S(C). The equation (r·s)·P = r·(s·P ) is immediate.
S	S	S  S
Similarly, we obtain r · (P + Q)= (r · P )+ (r · Q) using the monotonicity of addition
S	S	S	S  S
and scalar multiplication on C together with the distributivity law r · (a + b) = 
r · a + r · b on C. To show the other distributivity law (r + s) · P = (r · P )+ (s · P ),
S	S	S	S
one needs in addition that the set P is convex (see 2.8).	 
We continue with
Proposition 4.14 Addition and scalar multiplication are Scott-continuous on S(C).
Proof. For the Scott continuity of addition on S(C), we have to show that (  ↑ P )+

↑
(Pi + Q), that is,
i  S




↑   ↓ Pi + Q =  ↓↑(Pi + Q) .

It is straighforward that the left hand side is contained in the right hand side. For the reverse inclusion, choose any Scott-open set U containing ↑  ↓ Pi + Q. As every saturated subset of a dcpo is the intersection of its Scott-open neighborhoods,
it suffices to prove that the right hand side is contained in U .
As ↓ Pi + Q ⊆ U and as addition is jointly Scott-continuous on the continuous domain C, the Scott-compact sets  ↓ Pi and Q have Scott-open neighborhoods V and W , respectively, such that V + W ⊆ U . As  ↓ Pi ⊆ V , there is an i such that
Pi ⊆ V by Proposition 1.3. Thus, Pi + Q ⊆ V + W ⊆ U , whence  ↓↑ (Pi + Q) ⊆ U .
With respect to scalar multiplication, we have to show that  ↑  (r · P ) =
(  ↑ r ) · (  ↑ P ). If  ↑ r = 0, then r = 0 for all i, and the equation is trivially
true. Thus we may suppose that ri > 0 for all i. The desired equation can be rewritten in the following form

  (r · P )= (  ↑ r ) · ( 
P ).

↓ i	j
i,j
i	↓ j
i	j

That scalar multiplication · on S(C) is monotone follows directly from the monotoni-
S
city of scalar multiplication on C. This implies that the left hand side is contained

in the right hand side. For the reverse inclusion, the argument is similar to the
one for addition. The saturated set (  ↑ r ) · (	P ) is the intersection of the
Scott-open sets U in which it is contained. If we can show that	↓i,j (ri · Pj) ⊆ U
for all those open sets, we are finished. Thus, let U be a Scott-open set with
( ↑ r )·(	P ) ⊆ U . Scalar multiplication on C is jointly Scott-continuous, hence,
the inverse image of U under scalar multiplication {(r, x) ∈ R+ × C | r · x ∈ U }
is Scott-open and contains (↑ ↑ r ) × (	P ). As (↑ ↑ r ) and (	P  are both
Scott-compact, they have Scott-open neighborhoods V and W , respectively, such that V ·W ⊆ U . As sup ri ∈ V there is an i such that ri ∈ V , and as  ↓j Pj ⊆ W , by
Proposition 1.3 there is a j such that Pj ⊆ W . Thus	↓i,j ri·Pj ⊆ ri·Pj ⊆ V ·W ⊆ U
which completes the proof.	 
Lemma 4.15 For binary inﬁma on S(C) the following distributivity laws hold:
P + (Q ∧ R)= (P + Q) ∧ (P + R)
S	S	S
r · (P ∧ Q)= (r · P ) ∧ (r · Q).
S	S	S

Proof.
P + (Q ∧ R) = ↑(P + ↑(conv(Q ∪ R))
S
= ↑(P + conv(Q ∪ R)),	since addition on C is monotone
= ↑{p + λq + (1 − λ)r | p ∈ P, q ∈ Q, r ∈ R, λ ∈ [0, 1]},	by Lemma 2.8
= ↑{λ(p + q)+ (1 − λ)(p + r) | p ∈ P, q ∈ Q, r ∈ R, λ ∈ [0, 1]}
= ↑conv((P + Q) ∪ (P + R)),	by Lemma 2.8
= ↑conv(↑(P + Q) ∪ ↑(P + R)),	since the convex hull operator is monotone
= (P + Q) ∧ (P + R).
S	S
r · (P ∧ Q) = ↑(r · ↑conv(P ∪ Q))
S
= ↑(r · conv(P ∪ Q)),	since scalar multiplication on C is monotone
= ↑conv (r · P ) ∪ (r · Q)
= ↑conv ↑(r · P ) ∪ ↑(r · Q) ,	since the convex hull operator is monotone
= r · P ∧ r · Q.	 
S	S
We will use the following characterisation of the way-below relation on the clas- sical upper powerdomain Sc(C) of all nonempty compact saturated sets (see [1, Proposition 4.2.15] or [15, Proposition I-1.24.2]):
Lemma 4.16 For nonempty compact saturated subsets P and Q of a continuous domain, one has P  S Q with respect to the order of reverse inclusion on the dcpo Sc(C) if and only if P is a neighborhood of Q, that is, if and only if Q is contained in the interior of P.

As the convex upper powercone S(C) is contained in the classical upper pow- erdomain Sc(C), two elements P, Q ∈ S(C) are still way-below each other if the previous condition is fulfilled. We will prove the stronger statement that the way- below relation on S(C)is the restriction of the way-below relation on Sc(C). This implies that the Scott topology on S(C) is the restriction of the Scott topology on Sc(C). For this we will need the Hahn-Banach type separation theorems of chapter 3.
Lemma 4.17 For P, Q ∈ S(C), the following are equivalent:
P  S Q in S(C).
P is a neighborhood of Q.
There is a convex Scott-open set U such that P ⊇ U ⊇ Q.
Q ⊆ †P, that is, for every q ∈ Q there is a p ∈ P such that p  q.
Moreover, the convex upper powercone S(C) is continuous and its ﬁnitely generated members ↑conv F form a basis.
Proof. (1) ⇒ (2) : Suppose P  S Q. By 3.12, Q is the intersection of its compact convex saturated neighborhoods, and this family is directed. It follows that there is a compact convex saturated neighborhood of Q contained in P . Hence, P itself is a neighborhood of P .
⇒ (1) : This implication is an immediate consequence of Lemma 4.16.
(2) ⇔ (3) by Corollary 3.13.
⇒ (4) : We have U =	x∈U †x ⊇ Q. Compactness of Q implies that U
contains a finite subset F such that ↑conv F ⊇ †F ⊇ Q. Since U is open and
P ⊇ U ⊇ F , for each e ∈ F , there exists p ∈ P with p  e.
⇒ (2) : For every f ∈ F choose p ∈ P with p  f and let E be the collection of these finitely many p. Then, † conv E is open and P ⊇ ↑conv E ⊇ † conv F ⊇
↑conv F ⊇ Q.
In order to show continuity, pick Q ∈ S(C). By 3.12, every neighborhood of Q contains a neighborhood of the form ↑conv F for a finite set F . Thus the sets of this kind form a filtered system with Q as intersection. By the above, ↑conv F  S Q. Thus, S(C) is a continuous d-cone and the sets of form ↑conv F for finite F form a basis.	 

Lemma 4.18 If C is a continuous d-cone with an additive way-below relation, then the way-below relation on S(C) is additive, too.

Proof. Let P1  S Q1 and P2  S Q2 in S(C). Then there are Scott-open sets
U1, U2 such that P1 ⊆ U1 ⊆ Q1 and P2 ⊆ U2 ⊆ Q2. Then P1 + P2 = ↑(P1 + P2) ⊆
↑(U1 + U2) ⊆ ↑(Q1 + Q2)= Q1 + Q2. As ↑(U1 + U2) is also Scott-open by Proposition 2.2, we conclude P1 + P2  S Q1 + Q2.	 
S	S

Universal Property of the Convex Upper Powercone
Let CCONE denote the category of continuous d-cones as objects and Scott-continuous linear maps as morphisms. In the subcategory CCONE∧ we collect those continuous d-cones which admit binary infima and which satisfy the following identities:
a + (b ∧ c)= (a + b) ∧ (a + c)
r · (a ∧ b)= (r · a) ∧ (r · b).
Note that the existence of binary infima implies the existence of infima for finite nonempty subsets and the two identities above are equivalent to the following two identities for nonempty finite subsets F and G:
inf F + inf G = inf(F + G) r · (inf F )= inf(r · F ).
Morphisms in CCONE∧ are Scott-continuous linear maps preserving binary infima, hence, infima of finite nonempty sets.
We have seen in Theorem 4.11 that the convex upper powercone is an object of the category CCONE∧.

Proposition 4.19 The assignment C →'
S(C) can be extended to a functor S: CCONE →

CCONE∧ by assigning to a Scott-continuous linear function f : C → D the map
S(f ): S(C) → S(D) with S(f )(P ) := ↑f (P ).
Proof. Let us show that, for a Scott-continuous linear map f : C → D between continuous d-cones, S(f ): S(C) → S(D) is Scott-continuous, linear, and preserves binary infima. For P ∈ S(C), ↑f (P ) is compact, since P is compact and f continu- ous, it is saturated by definition and convex since P is convex and f linear. Clearly, S(f ) is order preserving. It follows that
S(f )  ↓ Pi = ↑f   ↓ Pi ⊆  ↓↑f (Pi)=  ↓S(f )(Pi).
To show the other inclusion we use that the compact convex saturated set S(f)  ↓Pi =
↑f (  ↓ Pi) is the intersection of its compact convex saturated neighborhoods P .
For each of those one has   Pi ⊆ f −1(P ) and the latter set is a neighborhood
of   Pi by the continuity of f . Thus, there is an i such that Pi ⊆ f −1(P ) by

Proposition 1.3. We conclude that f (Pi) ⊆ P , whence ↑f (Pi) ⊆ P and con-
sequently ↓↑f (Pi) ⊆ ↑f ( ↓ Pi) which completes the argument that S(C)(f ) is Scott-continuous. It is straightforward to verify that S(f ) is linear and preserves
binary infima. One uses that f is linear and monotone and that addition and scalar multiplication on D are monotone. Overall, S(f ) is a morphism in CCONE∧. To fin- ish the proof of the functoriality of S, we calculate for any compact convex saturated
set P ⊆ C,
S(idC )(P )= ↑idC(P )= ↑P = P = idS(C)(P ).
Regarding composition we use monotonicity of g and get
S(g ◦ f )(P )= ↑g f (P ) = ↑g ↑f (P ) = S(g) ◦ S(f ) (P ) .



Lemma 4.20 Besides the functor S: CCONE → CCONE∧, we have the forgetful functor U: CCONE∧ → CCONE in the other direction. Then, i : IdCCONE → U ◦ S is a natural transformation where, for each continuous d-cone C, the morphism
iC : C → S(C) maps an element x ∈ C to its upper closure ↑x.
Proof. First we show that, for every continuous d-cone C, the map iC is Scott- continuous and linear, hence, a morphism between d-cones.  As x ≤ y implies
iC(x) = ↑x ⊇ ↑y = iC(y), the map iC is monotone. Now, we show iC(  x ) = 
↑
i (x ), that is ↑(  ↑ x )=  ↑x . Indeed, y ∈  ↑x is equivalent to y ≥ x for
all j, i.e., y ≥  ↑ x or equivalently y ∈ ↑  ↑ x  = i   ↑ x . To show linearity

j
we calculate
j	C	j

iC (x + y)= ↑(x + y)= ↑(↑x + ↑y)= iC(x)+ iC(y)
iC (r · x)= ↑(r · x)= ↑(r · (↑x)) = r · iC(x).
It remains to prove that, for any Scott-continuous linear function f : C → D between continuous d-cones, the following diagram commutes
iC ) S(C)

f	S(f )
v	iD )	v
S(D)
From the monotonicity of f it follows immediately hat iDf (x)= ↑f (x)= ↑f (↑x)= 
US(f )(iC (x) for all elements x ∈ C.	 

A continuous domain L in which binary meets exist, is called a continuous ∧- semilattice. As, in a continuous domain, every element has a neighborhood basis of open filters, the meet operation in a continuous ∧-semilattice is Scott-continuous. But we have more:
Lemma 4.21 (a) In a continuous ∧-semilattice L every nonempty Scott-compact subset Q has a greatest lower bound
inf Q =  ↑ inf F | F ﬁnite and Q ⊆ int ↑F }
and the map Q '→ inf Q : Sc(L) → L is Scott-continuous.
(b) If f : L → M is a Scott-continuous map between continuous ∧-semilattices L and M which preserves binary inﬁma, then f also preserves inﬁma of nonempty compact sets.
Proof. (a) We may restrict ourselves to compact saturated sets, as a set and its saturation have the same lower bounds. At the other hand, in a continuous domain, a nonempty compact saturated set Q is the intersection the finitely generated upper sets ↑F such that ↑F  Q. Moreover, the family of these sets is filtered. That is,
Q =  ↓{↑F | F finite and ↑F  Q} .
As binary infima exist in L, all finite nonempty subsets also have a greatest lower bound, and the set {inf F | F finite and ↑F  Q} is directed. Let
a :=  ↑ inf F | F finite and ↑F  Q} .
It is clear that a is a lower bound of Q. In order to show that a is the greatest lower bound, let b be any lower bound of Q. For every x  b, we have ↑x  Q, whence x = inf ↑x ≤ a. As this holds for every x  b, we conclude b ≤ a.
The continuity of the map Q '→ inf Q follows from the following observation: Let Q be compact saturated and b  inf Q. Then ↑b is a compact saturated set containing Q in its interior, whence ↑b  Q in the domain Sc(L), and b = inf ↑b.
(b) Considering the representation of inf Q proved in (a), the claim follows from the fact that f preserves directed sups and infima of nonempty finite sets. 
We now restrict our attention to continuous d-cones L in which binary infima exist. As the meet operation is Scott-continuous on L, every nonempty Scott- compact convex saturated subset also has an infimum by the previous lemma and, as the Scott topology on S(L) is the restriction of the Scott topology on Sc(L) by 4.17, the map Q '→ inf Q : Sc(L) → L is Scott-continuous. But we have more:

Lemma 4.22 Let L be an object of CCONE∧. For all P, Q ∈ S(L) and r ∈ R+ we have
r · inf P = inf r · P
S
inf P + inf Q = inf(P + Q)
S
inf P ∧ inf Q = inf(P ∧ Q)
Thus, the map
Q '→ inf Q : S(L) → L
is Scott-continuous, linear and preserves binary inﬁma, hence a morphism in the category CCONE∧.
Proof. The first equation is straightforward. For the second, recall that P + Q =
S
↑(P + Q), whence inf(P + Q) = inf(P + Q). As inf P ≤ p and inf Q ≤ q for all
S
p ∈ P, q ∈ Q, we obtain inf P + inf Q ≤ p + q, whence inf P + inf Q ≤ inf(P + Q).
For the converse, consider any b  inf(P + Q). Then ↑b  P + Q. As the finitely
S
generated convex saturated sets form a basis and as addition is Scott-continuous on
S(L), there are finite sets G and H such that ↑conv(G)  P , ↑conv(H)  Q and
↑conv(G)+ ↑conv(H) ⊆ †b. We conclude that b ≤ inf(↑conv(G)+ ↑conv(H)) = inf(G + H)= inf G + inf H ≤ inf P + inf Q. As this holds for every b  inf(P + Q), we conclude inf(P + Q) ≤ inf P + inf Q. For the third equation, recall that P ∧ Q =
↑conv(P ∪ Q). Hence inf(P ∧ Q)= inf conv(P ∪ Q)= inf(P ∪ Q)= inf P ∧ inf Q. 
Now, we can prove the following universal property
Theorem 4.23 The functor S: CCONE → CCONE∧ is left adjoint to the forgetful functor U: CCONE∧ → CCONE. In other words, for every continuous d-cone C and every Scott-continuous linear map f from C intoa d-cone L ∈ CCONE∧, there is a uniqe Scott-continuous linear map fˆ: S(C) → L preserving binary inﬁma such that f = fˆ◦ iC :


fˆ ∈ CCONE∧


Proof. Let C be a continuous d-cone, L a continuous d-cone in which binary in- fima exist, and let f : C → L be a Scott-continuous linear map. Applying the functor S, we obtain a Scott-continuous linear map S(f ): S(C) → S(L) preserving binary infima. It is given by S(f )(P ) = ↑f (P ). We compose this map with the

linear Scott-continuous map Q '→ inf Q : S(L) → L preserving binary infima by the preceding lemma 4.22. We obtain a Scott-continuous linear map fˆ: S(C) → L pre- serving binary infima defined by fˆ(P ) = inf f (P ). The above diagram commutes as fˆ(iC (x)) = inf f (↑x) = f (x). Moreover, fˆ is the only Scott-continuous linear
map preserving binary infima such that the above diagram commutes. Indeed, for Q ∈ S(C), one has Q = infS(C){↑q | q ∈ Q}. Thus, if g : S(C) → L is a Scott- continuous map preserving binary infima such that f = g ◦ iC, then g preserves
infima of compact sets by Lemma 4.21(a), hence g(Q) = g(inf S(C){↑q | q ∈ Q}) = infL{g(↑q) | q ∈ Q} = infL{f (q) | q ∈ Q} = fˆ(Q).	 
As a special case for the universal property we may consider a Scott-continuous linear functional f : C → R+. Then there is a unique Scott-continuous linear func- tional f : S(C) → R+ preserving finite infima such that f ◦ jC = f , and this func- tional is defined by
f^(Q)= inf f (Q) for every Scott-compact convex saturated subset Q ⊆ C . 

The Biconvex Powercone
A topological characterisation of the classical convex powerdomain is known for Lawson-compact continuous domains X. In this case the convex powerdomain (also called Plotkin powerdomain) Pc(X) consists of the nonempty Lawson-compact order-convex subsets with the Egli-Milner order. Union of subsets followed by order- convex closure gives an extra binary semilattice operation. As before, we will modify this characterisation to make it fit within the context of d-cones.
The Biconvex Powercone Construction
In this section, C always stands for a Lawson-compact continuous d-cone.
Definition 10 A nonempty Lawson-compact order-convex subset A of C will be called a lens. We define
P(C) := {P ⊆ C | P a convex lens},
to be the collection of all convex lenses of C ordered by the Egli-Milner order as in the classical case.
Let us recall that, for order-convex subsets A, B ⊆ C, the Egli-Milner order is defined by
A ±EM B if ↓A ⊆ ↓B and ↑A ⊇ ↑B. 

We now define an addition, a scalar multiplication and a formal union operation on P(C):
+ : P(C) × P(C) → P(C), A + B := (↓A + ↓B) ∩ (↑A + ↑B)
P	P	H	S
· : R+ × P(C) → P(C), r · A := (r · ↓A) ∩ (r · ↑A)
P	P	H	S
∪: P(C) × P(C) → P(C), A ∪ B := (↓A ∨H ↓B) ∩ (↑A ∧S ↑B).

Note that A+B, r ·A and A ∪ B are indeed convex lenses, as each is the intersection
P	P
of a convex Scott-closed set and of a Scott-compact saturated convex set. Using
the explicit definitions of addition and scalar multiplication in the lower and upper powercones, we can simplify:
A + B = A + B ∩ ↑(A + B)
P
r · A = r · A
P
We use a seemingly more complicated definition, however, to reduce proofs about the convex Plotkin-type construction to its lower and upper part.
The main theorem of this section is:
Theorem 4.24 Let (C, +,0, ·) be a continuous Lawson-compact d-cone. Then P(C), + ,

{0}, ·
P
P
with the Egli-Milner order is a also a Lawson-compact continuous d-cone called

the biconvex powercone (or convex Plotkin powercone). The ﬁnitely generated convex lenses k(F ) = ↓conv F ∩ ↑conv F form a basis for the continuous d-cone P(C). It carries a semilattice operation ∪: P(C) × P(C) → P(C), called formal union, which is Scott-continuous and obeys the following distributivity laws:
A1 + (A2 ∪ A3)= (A1 + A2) ∪ (A1 + A3),
P	P	P
r · (A1 ∪ A2)= (r · A1) ∪ (r · A2),
P	P	P
for all A1, A2, A3 ∈ P(C) and all r ∈ R+. If the way-below relation is additive on
C, then it is additive on P(C), too.
We will prove this theorem in several steps.

As all Scott-closed subsets of C are Lawson-closed, the convex lower powercone H(C) is a subset of P(C). The Egli-Milner order restricted to Scott-closed sets is just set inclusion which was the order that we used on H(C). Moreover, if A ∈ P(C), B ∈ H(C) and A ±EM B, then A ∈ H(C). Thus H(C) is order embedded into P(C) as a lower set. The embedding preserves arbitrary suprema (and infima); in particular, it is Scott-continuous.

As all Scott-compact saturated subsets of C are Lawson-compact, the convex upper powercone S(C) also is a subset of P(C). The Egli-Milner order restricted to Scott-compact saturated sets is just reverse inclusion which was the order considered on S(C). Moreover, if A ∈ P(C), P ∈ S(C) and P ±EM A, then A ∈ H(C). Thus S(C) is order embedded into P(C) as an upper set. The embedding preserves directed suprema and binary infima (even arbitrary suprema and infima).
The Egli-Milner order can be seen as the intersection of the lower and upper orders. Indeed, for a Lawson-compact convex subset A of C, the sets ↓A and ↑A are also Lawson-compact and convex by Lemma 1.7 and Lemma 2.7. Thus ↓A is convex and Scott-closed and ↑A is convex, Scott-compact and saturated. For A, B ∈ P(C), one has by definition A ±EM B if, and only if, ↓A ⊆ ↓B in the convex lower powercone and ↓A ± ↓B in the convex upper powercone. This tells us that the maps
A '→ ↓A : P(C) → H(C) and A '→ ↑A : P(C) → S(C)
are order preserving retractions and that the map
ε : A '→ (↓A, ↑A): P(C) → H(C) × S(C)
is an order embedding. The following lemma shows that these maps are Scott- continuous:
Lemma 4.25 With the Egli-Milner order, P(C) is a dcpo. The supremum of a directed family (Ai)i in P(C) is given by

  ↑ A =  ↑↓A ∩   ↑A
as for the classical convex powerdomain (see [33]). Moreover,

↓  ↑ A  =  ↑↓A ,	↑   ↑ A  =   ↑A .
Proof. Indeed, (↓Ai, ↑Ai)i is a directed family in H(C) × S(C) and we can form

its supremum componentwise:  ↑ ↓A , ↑A ) =  ↑↓A ,  ↑A . Let us consider
the intersection of its two components

B =  ↑↓Ai ∩  ↓↑Ai =  ↓  ↑↓Ai ∩ ↑Ai 
which is Lawson-compact, convex and order-convex. B is nonempty, as the sets
↑↓Ai ∩ ↑Ai form a filtered family of nonempty Lawson-compact sets, and as such a family has a nonempty intersection. Thus B ∈ P(C).

Let us show that ↓B =  ↑↓Ai. The inclusion ↓B ⊆  ↑↓Ai is straightforward.
For the reverse inclusion, it suffices to show that  ↑↓A ⊆ ↓B, since ↓B is Scott-
closed. Let x ∈ ↓Ai for some i. Then there is a y ∈ Ai such that x ≤ y. For every index j such that Ai ±EM Aj, there is a z ∈ Aj such that y ≤ z, whence

↑x ∩ ↑↓Ai ∩ ↑Aj /= ∅. As the intersection of a filtered family of non-empty Lawson-
compact sets is nonempty, we conclude that ↑x ∩ B = ↑x ∩	↑↓Ai ∩	↑Ai /= ∅,
↓
whence x ∈ ↓B.
In a second step, let us show that ↑B =  ↓↑Ai. Again the inclusion ↑B ⊆
↓↑Ai is straightforward. For the reverse inclusion choose any x ∈  ↓↑Ai. Then

↓x ∩	↑Ai ∩ ↑Ai is nonempty for every index i. As the intersection of a filtered family of nonempty Lawson-compact sets is nonempty, we conclude that ↓x ∩ B =
↓x ∩ ↑↓Ai ∩  ↑Ai /= ∅, whence x ∈ ↑B.
↓
The equalities proved in the two previous paragraphs show that B is the least
upper bound of the directed family of the (Ai) with respect to the Egli-Milner order.  Indeed, if Ai ± B' for all i, then ↓Ai ⊆ ↓B' and ↑Ai ⊇ ↑B', whence
↓B =  ↑↓Ai ⊆ ↓B' and ↑B =  Ai ⊇ ↑B', that is, B ± B'.	 

Note, that throughout this section A still denotes the Scott closure of a set A
and not its Lawson closure.
One might think that A ∪ B is the convex, order-convex hull of A and B. However, this hull is not always Lawson-compact. Basically, the reason is that scalar multiplication is not jointly Lawson-continuous even on continuous d-cones. Hence, the convex hull of the union of two Lawson-compact sets is not necessarily Lawson-compact. The example below illustrates this. It shows the convex hull of two singleton sets in R+ × R+ which happens to be equal to its order-convex hull, but is not Lawson-compact.

R+








R+

For proving that P(C) is a continuous d-cone we want to take advantage of our definition via the lower and upper cone operations. For this, we need the following observations:
Lemma 4.26 For A, B ∈ P(C) and r ∈ R+ the following properties hold:
↓(A + B)= ↓A + ↓B,	↑(A + B)= ↑A + ↑B,
P	H	P	S
↓(r · A)= r · ↓A,	↑(r · A)= r · ↑A,
P	H	P	S
↓(A ∪ B)= ↓A ∨H ↓B,	↑(A ∪ B)= ↑A ∧S ↑B.

Proof. By definition of A + B one has ↓(A + B) ⊆ ↓A + ↓B. Lawson compactness
P	P	H
of A + B implies that ↓(A + B) is Scott-closed. Together with the monotonicity of
P	P
addition on C and A + B ⊆ A + B this implies
P
↓A + ↓B = ↓A + ↓B = ↓(A + B)= A + B ⊆ ↓(A + B).
H	P
The two inequalities together yield ↓(A + B) = ↓A + ↓B. The proofs of the other
P	H
equations are quite similar.	 
These equations can be rephrased by saying that
ε : P(C) → H(C) × S(C)
preserves addition, scalar multiplication and formal union. Thus we can deduce the following proposition immediately from the corresponding results for the lower and upper powercones (see 4.5 and 4.15):
Proposition 4.27 (P(C), + , {0}, ·) is a d-cone. Moreover, formal union is a Scott-
P	P
continuous semilattice operation which satisﬁes the following distributivity laws:
A1 + (A2 ∪ A3)= (A1 + A2) ∪ (A1 + A3),
P	P	P
r · (A1 ∪ A2)= (r · A1) ∪ (r · A2),
P	P	P
for all A1, A2, A3 ∈ P(C) and r ∈ R+.
Although, formal union clearly is a semilattice operation, it is neither the supre- mum nor infimum with respect to the Egli-Milner order on the d-cone.
For a nonempty finite set F we denote by k(F ) := conv F ∩ ↑conv F the convex lens generated by F . Note, that, as a consequence of Lemma 2.9, conv F is convex and Scott-closed, and ↑conv F is convex, Scott-compact and saturated; thus, k(F ) is indeed Lawson-compact.
Now we want to understand the way-below relation on the set which we want to become our basis.

Lemma 4.28 Let A, B ∈ P(C). If ↓A  H ↓B in the lower powercone H(C) and
↑A  S ↑B in the upper powercone S(C), then A  EM B in the biconvex powercone
P(C).
This lemma follows immediately from the fact that ε : P(C) → H(C) × S(C) is a Scott-continuous order embedding and that the way-below relation an a finite product is the product of the way-below relations on the factors.
The next lemma tells us that the finitely generated lenses k(F ) can be approxi- mated from below.
Lemma 4.29 Let F be a ﬁnite subset of C. Consider the sets G obtained by se- lecting exactly one element y  x in C for every x ∈ F. Then k(G)  EM k(F ) and the family of the k(G) is directed in P(C) and k(F ) is the (directed) supremum of this family.
Proof. Once again we use what we know for the convex lower and upper power- cones. Consider the sets G as in the statement of the Lemma. The lemmas 4.6 and
4.17 show that ↓conv G  H ↓conv F in the lower powercone and that ↑conv G  S
↑conv F in the upper powercone. By 4.28 we conclude that k(G)  EM k(F ). By the proof of Proposition 4.2, we get conv F = ↑ conv G, using that addition and scalar multiplication are continuous on C. Proposition 4.17 tells us ↑conv F =  ↓↑conv G.
We conclude
k(F )= conv F ∩ ↑conv F
=  ↑ conv G ∩   ↑conv G
↓
=  ↑ conv G ∩ ↑conv G 
=  ↑ k(G).


Lemma 4.30 The biconvex powercone P(C) is a continuous domain. The ﬁnitely generated convex lenses k(F ) form a basis for the continuous domain P(C) and, for A, B ∈ P(C), one has A  EM B if and only if ↓A  H ↓B and ↑A  S ↑B.
Proof. From 4.29 we know that every finitely generated convex lense k(F ) in P(C) is the supremum of a directed family of finitely generated convex lenses k(G)  EM k(F ). In order to show that the finitely generated convex lenses form a basis ad that P(C) is continuous, it suffices to prove that any convex lens L is the supremum (in the Egli-Milner order) of a directed family of finitely generated convex lenses.
Consider the collection F of all finite subsets F ⊆ C such that A ⊆ †F and

F ⊆ ↓L. For every F ∈ F, we then have F ±EM L and it follows that k(F ) ±EM L
and that k(F ) is a convex neighborhood of L.
Given any convex neighborhood U of L we can find an F ∈ F such that k(F ) ⊆ U : For every a ∈ L we may choose an element ya ∈ U with ya  a. By the compactness of L there is a finite subset F of the ya,a ∈ L, such that L ⊆ †F . As U is convex, k(F ) ⊆ U .
The collection k(F ),F ∈ F, is directed for the Egli-Milner order: If we have k(1) and k(F2) as above, we may look at the convex neighborhood k(F1) ∩ k(F2) of L and find inside a finite set F ∈ F such that k(F ) is an Egli-Milner upper bound for the k(Fi) as in the previous paragraph.
Finally, L is the least upper bound of the directed family of these k(F ) for the Egli-Milner order. Indeed, ↑L is the intersection of its convex neighborhoods, whence ↑L is the directed supremum of the ↑k(F ) in the upper powercone. On the other hand ↓L is the closure of the union of the ↓k(F ), i.e., equal to their directed supremum in the lower powercone.
Now suppose A  EM B. Then there is a basic set k(F ),F finite, such that A EM k(F ) EM B. By Lemma 4.29 there is a finite set G, obtained by by selecting an element y  x in C for every x ∈ F , such that A  EM k(G)  EM k(F )  EM B. As in the proof of Lemma 4.29 we have ↓k(G) = conv G  H conv F = ↓k(F ) and ↑k(G) = ↑conv G  S ↑conv F = ↓k(F ). We conclude that
↓A  H ↓B and ↑A  S ↑B. Together with Lemma 4.28 this finishes the proof of the Lemma.	 
Lemma 4.31 If the way-below relation on C is additive, then the way-below relation on P(C) is additive, too.
Proof. First, we show that the way-below relation is additive on a basis. Let k(G1)  EM k(F1) and k(G2)  EM k(F2), where G1, F1 and G2, F2 are chosen as in Lemma 4.29 Using additivity of the way-below relation on C, one sees that G1 + G2 and F1 + F2 witness
k(G1)+ k(G2)= k(G1 + G2)  EM k(F1 + F2)= k(F1)+ k(F2),
P	P
Now, we apply Lemma 2.23 and conclude that the way-below relation on P(C) is additive.	 
Lemma 4.32 The biconvex powercone P(C) is Lawson-compact.
Proof. In [33], Lawson proves that the classical convex powerdomain Pc(X) of a continuous Lawson-compact domain X is again continuous and Lawson-compact.

Recall that Pc(X) is the set of all lenses of X with the Egli-Milner order. A basis is given by the finitely generated lenses h(F ) := ↑F ∩ ↓F , F a finite subset of X.
We want to define a Scott-continuous retraction r : Pc(C) → P(C). Then we can apply Lemma 1.10 and conclude that P(C) is Lawson-compact.
For F finite, we define r¯ h(F ) := k(F ). Then r¯ is a monotone map on the basis of Pc(C): h(F ) ±EM h(G) means ↓F ⊆ ↓G and ↑F ⊇ ↑G. This implies conv F = conv ↓F ⊆ conv ↓G = conv G and ↑conv F = ↑conv ↑F ⊇ ↑conv ↑G = ↑conv G, which is equivalent to r¯ h(F ) = k(F ) ±EM k(G)= r¯ h(G) . Thus, we can apply Proposition 1.5 and get a Scott-continuous function
r : P (C) → P(C), r(A) :=  ↑ k(F ) F finite, h(F )	A}.

We will show that this function is a retraction. The section that goes with it is the inclusion map j : P(C) → Pc(C), j(B) := B. The only property left to show is r ◦ j = idP(C).
Let G be a finite subset of C. By definition
 r ◦ j  k(G) =  ↑ k(F )  F finite, h(F )	k(G)}.

For h(F )  EM k(G) we have h(F ) ±EM k(G) which is equivalent to ↓F ⊆ conv G
and ↑F ⊇ conv G. It follows conv F = conv ↓F ⊆ conv conv G  = conv G and
↑conv F = ↑conv ↑F ⊇ ↑conv ↑conv G = ↑conv G, or equivalently, k(F ) ±EM
k(G). This implies r ◦ j	k(G)  ±EM k(G).
To show the other inequality we show that whenever we take a finite set E with k(E)  EM k(G) then there exist a finite set F such that h(F )  EM k(G) and k(F )= k(E). From k(E)  EM k(G) it follows that † conv E ⊇ k(G). Since k(G) is compact there exists a finite set E' ⊆ conv E such that †E' ⊇ k(G). Set F :=
E ∪ E'. By definition k(F ) = k(E), and ↓h(F ) ⊆ ↓k(F ) = ↓k(E)  H ↓k(G) and
↑h(F ) ⊇ †h(F ) ⊇ ↑k(G). Hence, h(F )  EM k(G). This implies r ◦ j k(G) ±EM
{k(E) | k(E  EM k(G)} = k(G). Thus, we see that r ◦ j	k(G) = k(G) for all finite subsets G of C.
If a Scott-continuous function is equal to the identity function at all elements of a basis, then it is in fact the identity function. Hence, we have r ◦ j = idP(C) and P(C) is a Scott-continuous retract of Pc(C).	 

The last lemma completes the proof of Theorem 4.24.

Universal Property of the Biconvex Powercone
Our Plotkin type construction can be applied to the Lawson-compact continuous d-cones. We collect all of those in the category CCONEc. The morphisms are still the Scott-continuous linear maps. The second category involved is called CCONE∪. Its objects are the Lawson-compact continuous d-cones L with an additional Scott-
continuous semilattice operation ∪, called formal union, which satisfies the following additional identities:
a + (b ∪ c)= (a + b) ∪ (a + c)
r · (a ∪ b) = (r · a) ∪ (r · b)

for all a, b, c ∈ L and all r ∈ R+. The morphisms in CCONE∪ are those Scott- continuous linear maps which also preserve formal union. Note that the semilattice operation ∪ is not defined in terms of the order relation on the d-cone L. The
element a ∪ b is neither the least upper nor the greatest lower bound of a and b with respect to the order ≤ on L. But, as for any semilattice operation, there is another order relation on L derived from the semilattice operation ∪ that we denote by ⊆ and that is defined by a ⊆ b iff a ∪ b = b. 
For any Lawson-compact continuous d-cone C, the convex powercone P(C) be- longs to the category CCONE∪ by Theorem 4.24. The semilattice operation ∪ forms the smallest convex lens containing two given lenses, and the order relation derived from it is simply subset inclusion which is very different from the Egli-Milner order.


Proposition 4.33 The assignment C →'
P(C) can be extended to a functor P: CCONEc →

CCONE∪ by assigning to a Scott-continuous linear function f : C → D the map
P(f ): P(C) → P(D) with P(f )(A) := f (A) ∩ ↑f (A).
Proof. What remains to prove is all a consequence of Proposition 4.8 and Propo- sition 4.19 using P(f )(A) = H(f )(↓A) ∩ S(f )(↑A) and ↓P(f )(A) = H(f )(↓A),
↑P(f )(A)= S(f )(↑A).	 

Lemma 4.34 In addition to the functor P: CCONEc → CCONE∪ we have the for- getful functor U: CCONE∪ → CCONEc. In this situation i : IdCCONEc → U ◦ P is a natural transformation where for each continuous d-cone C the morphism
iC : C → P(C) maps an element x ∈ C to the singleton set {x}.
Proof. As x ≤ y in C holds if and only if {x} ±EM {y} in P(C), it follows immediately that iC is Scott-continuous. Linearity can be calculated just as easily.

The diagram

iC ) P(C)


f	P(f )
v	iD )	v
P(D)
commutes since f {x} = f (x)} for all x ∈ C.	 
For the proof of the universal property we need two lemmas. It will be convenient to use the notation  F := a1 ∪ ... ∪ an for a finite subset F = {a1,... , an} of L.
Lemma 4.35 For two nonempty ﬁnite subsets F and G of a d-cone L ∈ CCONE∪
we have:
For every a ∈ conv F, one has a ∪  F =  F.
k(G) ±EM k(F )  =⇒   G ≤  F.
F =  ↑   G | G ﬁnite and k(G)	k(F )}.
EM
Proof. (a) It suffices to prove this statement for a convex combination a = rb + sc of two elements b and c, where r and s are nonnegative real numbers such that r + s = 1. Using that scalar multiplication and addition distribute over ∪ we have:
b ∪ c = r(b ∪ c)+ s(b ∪ c)
= (rb ∪ rc)+ (sb ∪ sc)
= rb + (sb ∪ sc) ∪ rc + (sb ∪ sc) 
= (rb + sb) ∪ (rb + sc) ∪ (rc + sb) ∪ (rc + sc)
= b ∪ c ∪ (rb + sc) ∪ (rc + sb)
= b ∪ c ∪ a

(b) The hypothesis k(G) ±EM k(F ) says that firstly F ⊆ ↑conv G and secondly
G ⊆ conv F .
First, let a be any element of F . Then a ≥ b for some b ∈ conv F by the first part of the hypothesis. As ∪ is order preserving, we conclude a ∪  G ≥ b ∪  G =  G by (a). As this holds for all a ∈ F , we conclude
  G ∪   F ≥   G. 

Secondly, let b ∈ G. By the second part of the hypothesis, there is a directed family of elements ci each below some convex combination di of the elements of F such that b ≤  ↑ c . As ∪ is Scott-continuous, we conclude
b ∪   F ≤ (  ↑ c ) ∪   F =  ↑	∪   F ) .
As ci ≤ di ∈ conv F , we conclude ci ∪  F ≤ di ∪  F =  F for all i, using again
that ∪ is order preserving and (a). We conclude that b ∪  F ≤  ↑	∪  F ) ≤
  F . As this holds for every b ∈ G, we have proved
  G ∪   F ≤   G. 

The two inequalities yield the desired result.
(c) For fixed F , the sets k(G) with G finite and k(G)  EM k(F ) form a directed family in P(L) for the Egli-Milner ordering. By (b), the corresponding elements  G form a directed family in L bounded above by  F . We now restrict our attention to the finite sets G obtained by selecting exactly one element bi   ai for each i.
From 4.29 we know that, for these restricted sets G, one has k(G)  EM k(F ). As
a =  ↑ b | b   a }, the Scott-continuity of ∪ implies that  ↑ (  G) =  F .
Thus the desired equality is proved.	 
Lemma 4.36 For every d-cone L ∈ CCONE∪, there is a unique Scott-continuous linear map rL : P(L) → L preserving ∪ such that rL ◦ iL = idL.
Proof. For singletons {a}, we have to define
rL({a})= a
in order to satisfy rL ◦ iL = idL. Now let F = {a1,... , an} be any nonempty finite subset of L. If we want rC to preserve ∪, for k(F )= {a1} ∪ ... ∪ {an}, we have to define
rL k(F ) = a1 ∪ ... ∪ an =   F . 
By Lemma 4.35(b), rL is well-defined and order preserving on the collection of finitely generated lenses k(F ), which form a basis of the biconvex powercone P(L). By Lemma 4.35(c), the map rL is Scott-continuous on this basis. By Proposition 1.5 there is a unique Scott-continuous extension of rL to all of P(L) defined by

r (A)=  ↑ r
 k(F ) | F finite and k(F )  EM

A} .

Addition, scalar multiplication and formal union are Scott-continuous on L and on
P(L). In order to show that rL preseves addition, scalar multiplication and formal

union, it suffices to check these properties on the basis of finitely generated lenses k(F ) ∈ P(L). Thus, it suffices to show that rL is linear and preserves formal unions on the basis. This can be easily seen using the relations
k(F )+ k(G)= k(F + G)
P
r · k(F )= k(r · F )
P
k(F ) ∪ k(G)= k(F ∪ G)
and the distributivity laws holding in L.	 

Now, we are ready to prove the universal property for the biconvex powercone:

Theorem 4.37 The functor P: CCONEc → CCONE∪ is left adjoint to the forget- ful functor U: CCONE∪ → CCONEc. In other words, for every Lawson-compact continuous d-cone C and every Scott-continuous linear map from C into a d-cone
L ∈ CCONE∪, there is a unique Scott-continuous linear map fˆ: P(X) → L preserv- ing formal union such that f = fˆ◦ iC :



fˆ ∈ CCONE∪


Proof. Given a Scott-continuous linear map f : C → L, we first lift it to a Scott- continuous ∪ -preserving linear map P(f ): P(C) → P(L) according to Proposi-
tion 4.33 and we then compose it with the Scott-continuous ∪ -preserving linear retraction rL : P(L) → L from lemma 4.36, that is, we define fˆ: P(C) → L by fˆ = rL ◦ P(f ). Then fˆ is Scott-continuous ∪ -preserving and linear. Moreover
fˆ ◦ iC = rL ◦ P(f ) ◦ iC = rL ◦ iL ◦ f = idL ◦f = f . The uniqueness of fˆ is
straightforward.	 

As a special case for the universal property we may consider the biconvex pow- ercone PR+ over the d-cone R+; it is the set of all closed intervals [a, b] with a, b ∈ R+ and a ≤ b with the Egli-Milner order [a, b] ±EM [a', b'] iff a ≤ a' and
b ≤ b'. The d-cone R+ is embedded into PR+. Thus, for every Scott-continuous
linear map f : C → R+, there is a unique Scott-continuous ∪-preserving linear map f^: P(C) → PR+ such that f^◦ iC = f . For every convex lens A of C, its image f (A) is convex in R+, hence an interval. f^(A) is simply the closure of the interval f (A).

Powerdomains Combining Probabilistic Choice and Non-Determinism

The extended probabilistic power domain T(X) over a topological space X is a d-cone which is continuous whenever X is a continuous domain (with the Scott topology), and which is Lawson-compact, whenever X is stably locally compact, by Theorem 2.10. We thus may apply our three convex powerdomain constructions to the extended probabilistic power domain. We obtain three types of powerdomains modelling ‘uncertain’ or ‘non-determistic’ probability distributions.

Lower. HT(X) is the d-cone of all nonempty Scott-closed convex subsets of T(X) with the order of subset inclusion. By Theorem 2.10, Proposition 2.24 and Theorem 4.1 we have:


Theorem 4.38 Let X be a topological space. Then HT(X) is a d-cone, even a complete lattice, where binary suprema distribute over addition and scalar multipli- cation. If X is a continuous domain, then HT(X) is a continuous d-cone, even a continuous lattice, with an additive way-below relation.


As H and T are functors, we even have a functor HT from the category of topological spaces to the category CONE∨ of d-cones defined at the beginning of subsection 4.1.2. In order to state a universal property for this functor, we have
to restrict ourselves to the category CONT of continuous domains. We now may combine the universal property of the extended powerdomain functor T in Theorem
2.11 and the universal property of the convex lower powerdomain functor H in Theorem 4.10 and we have:


Theorem 4.39 Let X be a continuous domain. There is a natural embedding eX = jV(X) ◦ ηX : X → T(X) → HT(X) assigning to every x ∈ X the lower set ↓ηx generated by the point valuation ηx such that the following holds:
For every d-cone L with binary suprema which distribute over addition and scalar multiplication and every Scott-continuous function f : X → L, there is a unique Scott-continuous linear function fˆ: HT(X) → L preserving binary suprema such

that f = fˆ◦ eX :







Upper. ST(X) is the d-cone of all nonempty compact saturated convex subsets of T(X) with the order reverse to subset inclusion. By Theorem 2.10, Proposition
2.24 and Theorem 4.11 we have:
Theorem 4.40 Let X be a a continuous domain. Then ST(X) is a continuous d-cone with binary inﬁma which distribute over addition and scalar multiplication. The way-below relation is additive on ST(X). If, in addition, X is coherent, then ST(X) is a continuous lattice, whence Lawson-compact.
As S and T are functors, we even have a functor ST from the category CONT of continuous domains to the category CCONE∧ of continuous d-cones defined at the beginning of subsection 4.2.2. We now may combine the universal property of the extended powerdomain functor T in Theorem 2.11 and the universal property
of the convex upper powercone functor S in Theorem 4.23 and we have:
Theorem 4.41 Let X be a continuous domain. There is a natural embedding eX = iV(X) ◦ ηX : X → T(X) → ST(X) assigning to every x ∈ X the upper set ↑ηx generated by the point valuation ηx such that the following holds:
For every continuous d-cone L with binary inﬁma which distribute over addition and scalar multiplication and every Scott-continuous function f : X → L, there is a unique Scott-continuous linear function fˆ: ST(X) → L preserving binary inﬁma
such that f = fˆ◦ eX :







Biconvex. PT(X) is the d-cone of all nonempty convex lenses of T(X) with the Egli-Milner order. By Theorem 2.10, Proposition 2.24 and Theorem 4.24 we have:

Theorem 4.42 Let X be a coherent continuous domain. Then PT(X) is a Lawson- compact continuous d-cone with a Scott-continuous semilattice operation ∪ which distributes over addition and scalar multiplication. The way-below relation is addi- tive on PT(X).
As P and T are functors, we even have a functor PT from the category CONTc of coherent continuous domains to the category CCONE∪ of d-cones defined at the beginning of subsection 4.3.2. We now may combine the universal property of the extended powerdomain functor T in Theorem 2.11 and the universal property of the
biconvex powerdomain functor P in Theorem 4.37 and we have:
Theorem 4.43 Let X be a coherent continuous domain. There is a natural embed- ding eX = iV(X) ◦ ηX : X → T(X) → PT(X) assigning to every x ∈ X the singleton set {ηx} consisting of the point valuation ηx such that the following holds:
For every d-cone L ∈ CCONE∪ and every Scott-continuous function f : X → L, there is a unique Scott-continuous linear function fˆ: PT(X) → L preserving the

semilattice operation ∪
such that f = fˆ◦ eX :




Conclusion: Some Connections with Semantics

The results of the previous chapters can be used to obtain the denotational semantics of a simple imperative language with non-deterministic and probabilistic features. In so doing, we will revisit most of our main results.
Models in which probabilistic choice can be interpreted alongside non-determin- istic choice were pioneered by the Oxford Programming Research Group [43]; chap- ter 4 was motivated by their work. In particular, McIver and Morgan [36] introduced a special case of our biconvex powerdomain: more precisely their space of subprob- ability distributions over a countable discrete state space S embeds into PT(S⊥),
the biconvex powercone over the extended probabilistic powerdomain of S⊥. The
aim of their paper is to model partial and total correctness of programs combining non-deterministic and probabilistic choice within a single framework. A Smyth style semantics of non-determinism together with probabilistic non-determinism can also be found in their work: see [21,38].
Probabilistic choice between executing given programs P and P ' with probabil- ity p in [0, 1], written P p+ P ', means that program P is executed with probability p and program P ' is executed with probability 1—p. Starting from an initial state, the execution of a probabilistic program no longer results in a single state; instead, the
possible outcomes are described by a probability distribution or continuous valua- tion. Such behaviours have been modeled using the probabilistic powerdomain [24].
Non-deterministic choice between executing programs P and P ', written P H P ', means that one of P or P ' will be executed, but we do not know which. In com- bination with probabilistic choice, McIver and Morgan interpret non-deterministic
choice as picking a probability p in [0, 1] arbitrarily and then running program P p+ P '. They illustrate this by saying, ‘. . . a demon could resolve the choice by flipping a coin of arbitrary bias’. Once the coin is chosen, the possible outcome fol-
lows a fixed probability distribution. However, it is not known in advance which one

this will be. Thus, the set of all probability distributions or valuations associated with the programs P p+ P ' (p in [0, 1]) executed at a given state describes the pos- sible outcomes. In this way, we obtain all convex combinations of the denotations
of P and P ' at that state (we are assuming, for the sake of discussion, that P and P ' are themselves deterministic when run from the given state). Thus, they justify modifying the topological characterisations of the classical powerdomains by taking
convex sets only, in agreement with our procedure in Chapter 4, where convexity emerged as a natural condition for making powerdomains into d-cones.
We now follow [36] but generalise their countable discrete state spaces to state spaces X which can be arbitrary coherent continuous domains. Programs will con- tain non-deterministic and probabilistic features as described above. The denotation of a program P will be a Scott-continuous function P ) : X → PT(X), assigning to every state x in X a nonempty, Lawson-compact, convex, order-convex set of valu- ations on X. Let us list all the denotations and discuss their meaning afterwards. For any state x in X, we have
 abort)(x) := {⊥},   where ⊥(U )= 0, for all U ∈ O(X)
 skip)(x) := {ηx}
 assignf )(x) := {ηf (x)},	for a continuous function f : X → X
 P p+ P ')(x) := p · P )(x)+ (1 — p) · P ')(x)
P	P	P
 P H P ')(x) := P )(x) ∪ P ')(x)
 P ; P ') := ˆP ') ◦ P ),	(see below how P ') is lifted)
⎧ P )(x),	if B)(x)= true
 if B then P else P ')(x) :=	 P ')(x),	if B)(x)= false
⎪⎪⎩{⊥}(x),	otherwise

Finally while B do P ) is interpreted as the least fixed point or the functional
F : X → PT(X) → X → PT(X) 


defined by
F (f )(x)= ⎧⎨f^  P )(x) ,	if B)(x)= true
⎩{ηx},	if B)(x)= false

for f : X → PT(X) and x ∈ X.
The first three commands are purely deterministic; hence, their denotation yields a singleton point valuation for each state x in X. Probabilistic choice forms a convex

combination of the sets denoting the arguments. Note too that P p+ P ')(x) will have a singleton value if P )(x) and P ')(x) have.
Now, we look at the denotation of non-deterministic choice. If we start with two programs P and P ' whose denotations at x are singletons, then the denotation of P H P ' at x will be the line segment connecting P )(x) and P ')(x). Obviously, this is a convex set. In general, P H P ')(x) has to contain all convex combinations
of elements in P )(x) and P ')(x). This will be a convex set if P )(x) and P ')(x)
are. Finally, one has to form the Lawson-compact hull of these convex combinations to obtain P H P ')(x); this set is also convex. The procedure we just described is exactly the one used to define formal union at the beginning of section 4.3.1.
In order to define the sequential composition of programs P and P ', we need the combined universal property of the extended probabilistic powerdomain functor and the biconvex powercone functor as stated in Theorem 4.43. Indeed, if the
denotations P ), P ') : X → PT(X) are given, we cannot form their composition
 P ') ◦ P ) right away. But we can replace P ') by its unique formal union preserving linear extension P ') : PT(X) → PT(X) with P ') ◦ eX = P '). We now have the situation indicated by the diagram below, and so the sequential composition P ; P ' can be interpreted by P ; P ') = ˆP ') ◦ P ).









')


The conditional works the way one expects it to work. As usual for while loops, we take the least fixed-point semantics.
Note that one can also give a semantics using either of the other two powercones (by taking the lower or upper closure of the denotations given as sets of valuations as above). Addition and scalar multiplication would be calculated within HT(X) and ST(X), respectively, to define the denotation of probabilistic choice; formal union would be replaced by suprema in the convex lower powercone and by infima in the convex upper powercone to define the denotation of non-deterministic choice; and one would use the universal properties given in Theorem 4.39 and Theorem 4.41 to

define the denotation of sequential composition.
All these models support the view of programs as state transformers, where a deterministic program is interpreted by a continuous function r : X → X. Another frequently used interpretation of programs is that of predicate transformers: accord- ing to Smyth [53], predicates are given by open subsets of the state space X. A state is said to satisfy a certain predicate if it lies within the corresponding open set. If the denotation of a program is a continuous function g : X → X, then the inverse image function maps open sets to open sets, that is, it transforms predicates
to predicates. Hence, we may consider g−1 : O(X) → O(X) instead of g. Note that taking inverse images is contravariant, i.e., it reverses the direction of arrows. So,
in this view of programs, we obtain the greatest possible set of states one can start with, in order to end up in a final state which satisfies a certain predicate. This corresponds to Dijkstra’s weakest preconditions [8]: as g−1 gives the greatest pos-
sible set, it gives the weakest condition a state must fulfill such that the program
transforms it to a state satisfying the desired predicate. Recall that Scott-open sets are in one-to-one correspondence with {0, 1}-valued Scott-continuous functions, i.e., characteristic functions of Scott-open sets. An arbitrary lower semicontinuous (= Scott-continuous) function f : X → R+ will be called an expectation and can be seen as a ‘fuzzy’ predicate or distribution [30]. Expectations generalise predicates and, accordingly, expectation transformers are Scott-continuous functions from the d-cone L(X) of all lower semicontinuous functions f : X → R+ (see 2.3) into itself.
In [36], McIver and Morgan give a second semantics using expectation transform- ers. Let us show, how we can achieve this in our more general situation. Par abus de langage every Scott-continuous function r : X → PT(X) will be called a
(non-deterministic probabilistic) program.
Following Dijkstra’s weakest preconditions, one defines a Scott-continuous func- tion wp : X → PT(X) → L(X) → L(X) . For a program interpreted as a func- tion r : X → PT(X), its weakest pre-expectation with respect to post-expectation f in L(X) and state x in X is given by
wp(r)(f )(x) := inf ∫ f dμ μ ∈ r(x)}.

The integral can be seen as calculating the average value of the expectation of f with respect to the valuation μ ∈ T(X). Minimizing over all these expected values for μ in r(x) corresponds to picking the least probability with which a certain output can be guaranteed. The definition and properties of the integral of lower semicontinuous functions with respect to continuous valuations can be found in [29,54,18].

The programming logic obtained by taking greatest pre-expectations can be defined as above not only for the biconvex powercone and r : X → PT(X), but also for the convex upper powercone and programs r : X → ST(X). This logic describes the total correctness properties of a non-deterministic probabilistic program.
The biconvex powercone and the convex lower powercone also provide a logic which is suited to describe partial correctness. For this we define a Scott-continuous function wlp : X → PT(X) → L(X) → L(X) . For a program r, its greatest liberal pre-expectation with respect to post-expectation f ∈ L(X) and state x in X is given by


wlp(r)(f )(x) := sup ∫ f dμ  μ ∈ r(x)}.



In the same way, a partial correctness logic can be obtained using the convex lower powercone and r : X → HT(X).
It was important for McIver and Morgan in [36] to use the biconvex powercone in order to to treat partial and total correctness within the same framework. For this purpose they generalised the notion of expectation by admitting expectations with positive and negative real values. This approach leads to a treatment of partial
correctness which is equivalent to the one given above, but which looks quite ad hoc within domain theory. We now show how to avoid negative expectations.
We generalise the notion of an expectation in another direction. We use the d-cone P(R+) of all closed intervals [a, b],a ≤ b, a, b ∈ R+ with the Egli-Milner order [a, b] ±EM [a', b'] iff a ≤ a' and b ≤ b'. We note that P(R+) is the bicon-
vex powercone over the d-cone R+. A bi-expectation will be an interval-valued
expectation defined on the state space X; more precisely, it is defined to be a Scott- continuous function f : X → P(R+). In a straightforward way, the bi-expectations on X form a d-cone IL(X), with addition, scalar multiplication and order being defined pointwise. We are going to define a Scott-continuous function wpb : X → PT(X) → L(X) → IL(X) giving for every program r and every post-expectation f a weakest pre-bi-expectation wpb(r)(f ): we first notice that every expectation f : X → R+ can be viewed as a bi-expectation with singleton values. Then, by the universal property 4.43, there is a unique Scott-continuous, linear, ∪-preserving functionf : PT(X) → PR+ such that f = eX ◦f . For every program r we now define wpb(r)(f ) =f^◦ r:


X




X	eX)

f
v
r
v
PT(X)

f
v

R+ 	) P(R+)
iR+
The weakest pre-bi-expectation wpb(r)(f ) carries the information both for the weakest preexpectation wp(r)(f ) and the weakest liberal preexpectation wlp(r)(f ). Indeed, for every x in X, the value wpb(r)(f )(x) is the smallest closed interval in
R+ containing the set
{∫ f dμ | μ ∈ r(x)} .
(This follows by combining the information following 4.37 and 2.11, where we apply the universal properties established in these two theorems to the special case of the reals.) Note that wp(r)(f )(x) and wlp(r)(f ) are the lower and upper boundary points of this interval, respectively, as
wp(r)(f )(x)= inf {∫ f dμ | μ ∈ r(x)} = min wpb(r)(f )(x) ,
wlp(r)(f )(x)= sup {∫ f dμ | μ ∈ r(x)} = max wpb(r)(f )(x) .
Above we have constructed the weakest pre-bi-expectation wpb(r)(f ) for every post-expectation f : X → R+. We may extend this construction to arbitrary post- bi-expectations f : X → P(R+). Indeed, by the universal property 4.43, there is a unique Scott-continuous, linear, ∪-preserving functionf : PT(X) → PR+ such that f = eX ◦ f . For every program r we now define wpb(r)(f ) =f ◦ r and we obtain a Scott-continuous function
wpb :  X → PT(X)  →  IL(X) → IL(X) .

In [36] McIver and Morgan characterize axiomatically those expectation trans- formers that arise from nondeterministic probabilistic programs over a countable discrete state space. We have not yet attacked this question in our more general setting.

References
S. Abramsky and A. Jung. Domain theory. In S. Abramsky, D. M. Gabbay, and T. S. E. Maibaum, editors, Handbook of Logic in Computer Science, volume 3, pages 1–168. Clarendon Press, 1994.
M. Alvarez-Manilla, A. Edalat, and N. Saheb-Djahromi. An extension result for continuous valuations.
Electronic Notes in Theoretical Computer Science, 13, 1998. 10pp.
M. Alvarez-Manilla, A. Jung, and K. Keimel. The probabilistic powerspace for stably compact spaces.
Theoretical Computer Science, 328:221–244, 2004.
P. Billingsley. Probability and Measure. J. Wiley & Sons, 2nd edition edition, 1986. xii+622pp.
N. Boboc, G. Bucur, and A. Cornea. Order and Convexity in Potential Theory: H-Cones, volume 853 of Lecture Notes in Mathematics. Springer Verlag, 1981.
D. L. Cohn. Measure Theory. Birkh¨auser, 1980. x+373pp.
B. A. Davey and H. A. Priestley. Introduction to Lattices and Order. Cambridge University Press, Cambridge, 1990.
E. W. Dijkstra. A Discipline of Programming. Prentice-Hall, Englewood Cliffs, New Jersey, 1976.
A. Edalat. Domain theory and integration. Theoretical Computer Science, 151:163–193, 1995.
A. Edalat. Dynamical systems, measures and fractals via domain theory. Information and Computation, 120(1):32–48, 1995.
A. Edalat. Power domains and iterated function systems. Information and Computation, 124:182–197, 1996.
Th. Erker, M. H. Escard´o, and K. Keimel. The way-below relation of function spaces over semantic domains. Topology and its Applications, 89:61–74, 1998.
B. Fuchssteiner and W. Lusky. Convex Cones, volume 56. North-Holland, 1981.
G. Gierz, K. H. Hofmann, K. Keimel, J. D. Lawson, M. Mislove, and D. S. Scott. A Compendium of Continuous Lattices. Springer Verlag, Berlin, 1980.
G. Gierz, K. H. Hofmann, K. Keimel, J. D. Lawson, M. W. Mislove, and D. S. Scott. Continuous Lattices and Domains, volume 93 of Encyclopedia of Mathematics and its Applications. Cambridge University Press, Cambridge, 2003.
P. R. Halmos. Measure Theory. D. van Norstrand Company, 1950. xii+304pp.
R. Heckmann. Power Domain Constructions. PhD thesis, Universit¨at des Saarlandes, 1990.
R. Heckmann. Spaces of valuations. In S. Andima, R. C. Flagg, G. Itzkowitz, Y. Kong, R. Kopperman, and P. Misra, editors, Papers on General Topology and Applications, volume 806 of Annals of the New York Academy of Sciences, pages 174–200, 1996.
C. A. R. Hoare. Communicating Sequential Processes. Prentice Hall International, 1985.
K. H. Hofmann and M. Mislove. Local compactness and continuous lattices. In B. Banaschewski and R.-E. Hoffmann, editors, Continuous Lattices, Proceedings Bremen 1979, volume 871 of Lecture Notes in Mathematics, pages 209–248. Springer Verlag, 1981.
He Jifeng, A. McIver, and K. Seidel. Probabilistic models for the guarded command language. Science of Computer Programming, 28:171–192, 1997.
P. T. Johnstone. Scott is not always sober. In B. Banaschewski and R.-E. Hoffmann, editors, Continuous Lattices, volume 871 of Lecture Notes in Mathematics, pages 282–283. Springer Verlag, 1981.
C. Jones. Probabilistic non-determinism. PhD thesis, Department of Computer Science, University of Edinburgh, Edinburgh, 1990. 201pp.

C. Jones and G. Plotkin. A probabilistic powerdomain of evaluations. In Proceedings of the Fourth Annual Symposium on Logic in Computer Science, pages 186–195. IEEE Computer Society Press, 1989.
A. Jung and R. Tix. The troublesome probabilistic powerdomain. In A. Edalat, A. Jung, K. Keimel, and M. Kwiatkowska, editors, Proceedings of the Third Workshop on Computation and Approximation, volume 13 of Electronic Notes in Theoretical Computer Science. Elsevier Science Publishers B.V., 1998. Available from http://www.elsevier.nl/lcoate/entcs/volume13.html , 23 pp.).
K. Keimel and J. Paseka. A direct proof of the Hofmann-Mislove theorem. Proceedings of the AMS, 120:301–303, 1994.
K. Keimel and W. Roth. Ordered Cones and Approximation, volume 1517 of Lecture Notes in Mathematics. Springer Verlag, 1992. vi+134pp.
K. Keimel and R. Tix. Valuations and measures. unpublished, 1996.
O. Kirch. Bereiche und Bewertungen. Master’s thesis, Technische Hochschule Darmstadt, June 1993. 77pp., http://www.mathematik.tu-darmstadt.de/-ags/-ag14/∼ papers/kirch/.
D. Kozen. Semantics of probabilistic programs. J. Comp. System Sci., 22:328–350, 1981.
J. D. Lawson. The duality of continuous posets. Houston Journal of Mathematics, 5:357–394, 1979.
J. D. Lawson. Valuations on continuous lattices. In R.-E. Hoffman, editor, Continuous Lattices and Related Topics, volume 27 of Mathematische Arbeitspapiere. Universit¨at Bremen, 1982.
J. D. Lawson. The versatile continuous order. In M. Main, A. Melton, M. Mislove, and D. Schmidt, editors, Mathematical Foundations of Programming Language Semantics, volume 298 of Lecture Notes in Computer Science, pages 134–160. Springer Verlag, 1988.
S. Mac Lane. Categories for the Working Mathematician. Springer Verlag, Berlin, 1971.
M. Main. Free constructions of powerdomains. In A. Melton, editor, Mathematical Foundations of Programming Semantics, volume 239 of Lecture Notes in Computer Science, pages 162–183. Springer Verlag, 1985.
A. McIver and C. Morgan. Partial correctness for probablistic demonic programs. Theoretical Computer Science, 266:513–541, 2001.
M. Mislove. Nondeterminism and probabilistic choice: Obeying the law. In Proc. 11th CONCUR, volume 1877 of Lecture Notes in Computer Science, pages 350–364. Springer Verlag, 2000.
C. Morgan, A. McIver, and K. Seidel. Probabilistic predicate transformers. ACM Transactions on Programming Languages and Systems, 8(1):1–30, January 1999.
L. Nachbin. Topology and Order. Von Nostrand, Princeton, N.J., 1965. Reprinted by Robert E. Kreiger Publishing Co., Huntington, NY, 1967.
G. D. Plotkin. A powerdomain construction. SIAM Journal on Computing, 5:452–487, 1976.
G. D. Plotkin. A powerdomain for countable non-determinism. In M. Nielsen and E. M. Schmidt, editors, Automata, Languages and programming, volume 140 of Lecture Notes in Computer Science, pages 412–428. EATCS, Springer Verlag, 1982.
G. D. Plotkin. Probabilistic powerdomains. In Proceedings CAAP, pages 271–287, 1982.
PSG.	Probabilistic	System	Group.	Collected	reports.
http://www.comlab.ox.ac.uk/-oucl/-groups/-probs/-bibliography.html  .
M. Rauch. Stetige Verb¨ande in der axiomatischen Potentialtheorie. In R.-E. Hoffman, editor, Continuous Lattices and Related Topics, volume 27 of Mathematische Arbeitspapiere. Universit¨at Bremen, 1982.
W. Roth. Hahn-Banach type theorems for locally convex cones. Journal of the Australian Mathematical Society, 68(1):104–125, 2000.
W. Rudin. Functional Analysis. McGraw Hill Series in Higher Mathematics. McGraw Hill, New York, 1973.

N. Saheb-Djahromi. CPO’s of measures for non-determinism. Theoretical Computer Science, 12(1):19– 37, 1980.
A. Schalk. Algebras for Generalized Power Constructions. Doctoral thesis, Technische Hochschule Darmstadt, 1993. 174 pp.
D. S. Scott. Outline of a mathematical theory of computation. In 4th Annual Princeton Conference on Information Sciences and Systems, pages 169–176, 1970.
D. S. Scott. Continuous lattices. In E. Lawvere, editor, Toposes, Algebraic Geometry and Logic, volume 274 of Lecture Notes in Mathematics, pages 97–136. Springer Verlag, 1972.
D. S. Scott. A type theoretical alternative to ISWIM, CUCH, OWHY. Theoretical Computer Science, 121:411–440, 1993. Reprint of a manuscript written in 1969.
M. B. Smyth. Powerdomains. Journal of Computer and Systems Sciences, 16:23–36, 1978.
M. B. Smyth. Powerdomains and predicate transformers: a topological view. In J. Diaz, editor, Automata, Languages and Programming, volume 154 of Lecture Notes in Computer Science, pages 662–675, Berlin, 1983. Springer Verlag.
R. Tix. Stetige Bewertungen auf topologischen R¨aumen. Master’s thesis, Technische Hochschule Darmstadt, June 1995. 51pp., http://www.mathematik.tu-darmstadt.de/-ags/-ag14/-papers/-tix/ .
R. Tix. Continuous D-cones: Convexity and Powerdomain Constructions. PhD thesis, Technische Universit¨at Darmstadt, 1999. Shaker Verlag, Aachen.
R. Tix. Some results on Hahn-Banach type theorems for continuous d-cones. Theoretical Computer Science, 264:205–218, 2001.
D. Varacca. The powerdomain of indexed valuations. Technical Report RS-02-38, BRICS, 2002. 54 pp.
D. Varacca. The powerdomain of indexed valuations. In Proceedings of the 17th IEEE Symposium on Logic in Computer Science (LICS), 2002.
D. Varacca. Probability, Nondeterminism and Concurrency: Two denotational models for probabilistic computation. PhD thesis, University of Aarhus, 2003. 175 pp.
G. Weidner. Bewertungen auf stetigen Bereichen. Master’s thesis, Technische Hochschule Darmstadt, 1995. 45pp.
G. Winskel. A complete proof system for SCCS with modal assertions. In S. N. Maheshwari, editor, Foundations of Software technology and Theoretical Computer Science, volume 206 of Lecture Notes in Computer Science, pages 392–410, Berlin, 1985. Springer Verlag.


Index



R+, 10, 19

R+, 10, 20
↓A, ↑A, 10
†x, ↓x, 14
H(X), 56
Hc(X), 56
L(X), 36
O(X), 25
P(C), 74
Pc(X), 73
S(C), 64
Sc(X), 13, 64
U(X), 15
T(X), 25
CCONE, 69
CCONE∧, 69
CONE∨, 61
CCONEc, 81
CCONE∪, 81
CCONE, 20
CONE, 20, 61
CONT, 14
DCPO, 11
additive way-below relation, 21
basis of a domain, 14
biconvex powercone, 74
co-compact topology, 15 coherent continuous domain, 16 coherent space, 16
compact set, 12
complete lattice, 10
conditionally directed complete, 10
cone, 19
continuous ∧-semilattice, 71
continuous d-cone, 19
continuous domain, 14
continuous valuation, 25
convex lens, 74
convex powerdomain, 73
convex set, 22
core compact, 37
d-cone, 19
d-subcone, 49
dcpo, 10
directed, 10
directed complete, 10
dual cone, 37
Egli-Milner order, 74
expectation, 92
extended probabilistic powerdomain,
25
Extension Theorem, 50
formal union, 74, 81
greatest pre-expectation, 92
Hoare powercone, 57
Hoare powerdomain, 56
Hofmann-Mislove-Theorem, 13

interpolation property, 14
Lawson topology, 16
Lawson-compact, 16
lens, 74
linear function, 19 locally compact space, 15 locally convex cone, 22 lower set, 10
lower powercone, 57
lower powerdomain, 56
lower semicontinuous function, 36
lower topology, 16
monotone function, 11
normalized valuations, 26
order preserving function, 11
order-convex set, 22
ordered cone, 19
ordered set, 10
ordered topological space, 15
partial correctness, 93 partially ordered set, 10 patch topology, 16
Plotkin powercone, 74
Plotkin powerdomain, 73
point valuation, 26
pospace, 15
probabilistic powerdomain, 26
properly locally compact, 16
retraction, 15
Sandwich Property, 43
Sandwich Theorem, 42
saturated set, 12
Scott topology, 11
Scott-closed, 11
Scott-continuous function, 11
Scott-open, 11
Separation Theorem, 44
simple function, 36
simple valuation, 27
Smyth powercone, 65
Smyth powerdomain, 64
sober space, 13
specialisation order, 12
stably compact, 16
stably locally compact, 16 Strict Separation Theorem, 47 sublinear functional, 41
superlinear functional, 41
total correctness, 93
upper powercone, 65
upper powerdomain, 64
upper set, 10
valuation, 25
way-below relation, 14
weak topology, 46
