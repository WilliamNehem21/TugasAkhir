

Electronic Notes in Theoretical Computer Science 270 (2) (2011) 121–139
www.elsevier.com/locate/entcs

Relating Toy Models of Quantum Computation:
Comprehension, Complementarity and Dagger Mix Autonomous Categories
Dusko Pavlovic 1,2
Kestrel Institute and Oxford University

Abstract
Toy models have been used to separate important features of quantum computation from the rich back- ground of the standard Hilbert space model. Category theory, on the other hand, is a general tool to separate components of mathematical structures, and analyze one layer at a time. It seems natural to combine the two approaches, and several authors have already pursued this idea. We explore categorical comprehension construction as a tool for adding features to toy models. We use it to comprehend quantum propositions and probabilities within the basic model of finite-dimensional Hilbert spaces. We also analyze complementary quantum observables over the category of sets and relations. This leads into the realm of test spaces, a well-studied model. We present one of many possible extensions of this model, enabled by the comprehension construction. Conspicuously, all models obtained in this way carry the same categorical structure, extending the familiar dagger compact framework with the complementation operations. We call the obtained structure dagger mix autonomous , because it extends star autonomous categories, popular in computer science, in a similar way like dagger compact structure extends compact categories. Dagger mix autonomous categories seem to arise quite naturally in quantum computation, as soon as complementarity is viewed as a part of the global structure.
Keywords: quantum computation, category, semantics, Hilbert space, relation, span, test space, comprehension principle, complementary observable


Introduction, background, related work
Mathematical models of physical systems are often complicated. Quantum physics in particular is built over very rich mathematical structures. The efforts to extract conceptual components from these structures, and to analyze the particular quan- tum phenomena supported in such fragments, can be traced back all the way to Birkhoff and von Neumann. Nowadays, such efforts sometimes lead to toy models [35,28,40,13,2].

1 Supported by ONR.
2 Email: dusko@kestrel.edu

1571-0661 © 2011 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2011.01.027

But components are only useful if they can be used to build something. Iso- lating some quantum phenomena in partial models is only useful if we know how to combine these partial models together, in order to relate the analyzed phenom- ena; and how to incrementally build larger pictures of quantum theory from smaller fragments. Categorical tools seem well suited for this purpose. Besides providing a categorical view of quantum programming in the standard Hilbert space model [37,38], categorical semantics of quantum computation [1,10,11,14] can be viewed as a toolkit for building, combining and reconstructing toy models of quantum com- putation, and nonstandard models in general. In this spirit, Coecke, Edwards have reconstructed and extended Spekkens’ toy model in a categorical framework [13,12]. Abramsky used the Chu construction as a categorical tool for building big toy mod- els, encompassing not only quantum computation, but possibly other exotic kinds of systems [2,3]. Our exploration here can be viewed as an attempt in the same direction: we propose another categorical construction that might be useful as a piece of the toolkit of categorical semantics of quantum computation.
The starting point of the path towards this quantum categorical toolkit was the remarkably simple observation, due to Abramsky and Coecke [1], that a basic form of quantum entanglement can be modeled using the duality structure of compact categories [23]. Extended with an additional operation, the contravariant functor dagger ‡, corresponding to the operator adjunction, dagger compact categories were thus proposed as a basic type system for an abstract view of quantum computation. The abstract characterizations of mixed quantum states as completely positive op- erators [39], and of quantum and classical observables in terms of special Frobenius algebras [10,16], as well as some related algebraic structures [11,15,31], were soon added to the quantum categorical toolkit, allowing simple characterizations of many quantum operations [14].
In this note, we consider a categorical tool for incremental refinement of toy models, which thus allows by adding new features, such as quantum propositions, probabilities, or complementarity. In the Hilbert space model, quantum proposi- tions are represented as closed subspaces. Quantum logic, initiated by Birkhoff and von Neumann [7], was an attempt to capture the logical content of quantum theory by axiomatizing such propositions, and studying them algebraically. The resulting lattice theory captures some important aspects of quantum theory, but abstracts away some other important aspects. Nevertheless, the link with quantum prob- ability theory through Gleason’s theorem [21] is undoubtedly of great conceptual importance.
So how can we add quantum propositions to a toy model, viewed as a dagger compact category? The categorical construction that can be used generalizes the familiar set theoretic schema of comprehension. It is briefly described in Sec. 2. In the rest of the paper, we apply this categorical comprehension construction to simple examples, and build categories of quantum systems where the quantum operations are required to preserve the comprehended structure: e.g., quantum propositions, observables, etc. The operations that come with these added structures, echoing Birkhoff-von Neumann’s logics, are reflected in the structure of the obtained cat-

egories. In Sec. 3, we finally come around to the original task of adding quantum propositions, and adjoin quantum propositions as explicit structure to finitely di- mensional Hilbert spaces. In Sec. 4, we describe the resulting categorical structure and define dagger mix autonomous categories. In Sec. 5, we discuss the ways to adjoin complementary observables to two basic models, again using the comprehen- sion construction. In Sec. 6 we describe, very briefly, two slightly richer toy models arising from the same construction, just to give an idea of the possibilities that it opens. Sec. 7 lists some open questions that arise from it.

Categorical comprehension construction
The set theoretic comprehension principle asserts that predicates over a set S are in one-to-one correspondence with the subsets of S:
Φ : S 	/2/

{x∈S | Φ(x)} ‹→ S
The topological generalization of this correspondence establishes the equivalence be- tween ´etal´e spaces over a space S and sheaves of sets under S [27]. The categorical generalizations go back to Grothendieck’s construction of the discrete fibration cor- responding to a sheaf [ibidem]; but their logical interpretation, and the connection with the idea of comprehension is due to Lawvere [25,30,22].
In the most general form, originally outlined in [33], the categorical comprehen- sion schema establishes the correspondence of lax functors from a category C to the bicategory Span and arbitrary (small-fibered) functors to C
P : C 	/S/pan

P 	/C/
C
To explain this correspondence, we first describe the bicategory Span and the notion of lax functors to it, and then specify the comprehension construction C P.
Definition 2.1 The bicategory Span consists of
sets A, B, ... as objects (0-sets);
a morphism (1-cell) F : A 	/B/is a span of functions A ¸, F 	/B/;
a transformation (2-cell) χ : F 	/G/: A 	/B/is a function F  χ /G/such that both triangles in the following diagram commute.


... F ¸¸¸¸
(1)

...
,¸¸¸
¸¸¸z 
χ	.. B¸

¸¸¸¸
J ....
G

While the composition of transformations is obvious, the composition of spans is induced by pullbacks:



(F ; H)¸¸
(2)

,,,,
F ¸, s
¸¸¸¸¸z˛

.....
¸¸¸¸¸¸
,,,,,,	¸¸¸¸¸¸

A . . s
¸¸zB˛,  ,, 
¸zC 



Remark. If a span A ¸πA, F  πB /B/is viewed as a set matrix F ∈ SetA×B, with the entries Fab = ⟨πA, πB⟩−1(a, b), then the span composition becomes the usual matrix composition.


Definition 2.2 A (comprehension) speciﬁcation is a lax functor P : C   /S/pan, consisting of the following assignments:
for each object A ∈ |C| a set PA,
   
for each morphism A	B a span PA	{f}	PB, and moreover
f	g
for every composable pair A  B  C a transformation μ



f ; g
,,
μfg 

,,{f } ; {g}¸¸¸
(3)

,,
, 
  {f} ¸¸¸¸¸
¸¸¸¸¸z˛
,,,, {g} ¸¸¸¸

 j 
PA
¸¸¸¸¸	,,,,,,
PB
¸¸¸zz˛z
PC


for every object A ∈ |C| a transformation ηA



,, {idA} ¸¸¸
(4)

,,,,,
¸¸¸¸¸
,,
¸¸¸z˛
,,, PA¸

¸¸¸
idPA
,,,,

such that the following diagrams commute
{f}; {g}; {h} 	μfg ;{h}	/{f/; g}; {h}



{f};μgh


J 
{f};
μ


	/{/ J 




{f}

¸¸¸
{f}; idPB
	f ;ηB	/{f/}; {id }


idPA; {f}

ηA;{f}

J 
¸¸¸¸¸¸
¸¸¸¸¸¸
¸¸¸¸
¸¸¸¸
¸¸¸ J 

z 
{idA}; {f}	μ	/{f/}

Remark. When spans are viewed as matrices of sets, then the above data become the families:

βΣPB
α{f}β × β{g}γ

1
	μαγ
fg	//α{f ; g}γ	(5)

α
A	//α{idA}α	(6)

indexed by α ∈ PA and γ ∈ PC, and where e.g. α{f}β = ⟨πPA, πPB⟩−1(α, β) denotes the entry of the set matrix {f}∈ SetPA×PB.
∫Definition 2.3 The comprehension of a specifi∫cation P : C	/S/pan is the functor
 ∫ P = Σ PA
C	A∈|C|
∫

P ⟨A, α⟩, ⟨B, β⟩ =
R	f∈C(A,B)
α{f}β

An arrow in C P is thus a pair ⟨f, ϕ⟩ : ⟨A, α⟩ 	/⟨B/, β⟩ where f ∈ C(A, B) and
ϕ ∈ α{f}β. The identities and the composition are:
id⟨A,α⟩ = ⟨idA, ηα⟩
⟨f, ϕ⟩; ⟨g, ψ⟩ = (f ; g), μαγ(ϕ, ψ) 
The comprehension functor ∫C P 	/C/is the obvious projection.

Definition 2.4 A functor F : E 	/C/is said to be small if for every object A ∈ |C|
the class of objects F—1A ⊆ |E| is a set.
The correspondence. Any small functor E : E 	/C/induces a comprehension specification PE : C 	/S/pan, defined
PA = E—1A
α{f}β = {ϕ ∈ E (α, β) | Eϕ = f}
with ηα = idα and μfg induced by the composition in E . The obvious equivalence

A
E   C PE preserves the projections to C. The functor E : E
	/C/is faithful if

and only if every span PEA ¸, {f}	/P/E B is a binary relation, i.e. {f} ⊆
PEA × PEB. Putting this all together we get the following.
Theorem 2.5 For every category C there are one-to-one correspondences of
small functors to C and lax functors C 	/S/pan,
small faithful functors to C and lax functors C 	/R/el.
Remark. Note that composing relations as spans does not directly give relations: the assumption that the spans F ,˛ /A/× B and G ,˛ /B/× C in (2) are monic
does not necessarily imply that the span (F ; G)  /A/× C is monic. However, the image factorization (F ; G)   /[F/; G] ,˛ /A/× C yields the relation [F ; G], which
is the usual relational composition of the relations F and G. If relations are viewed
as matrices of 0s and 1s, this factorization replaces with 1 each nonempty set that may occur in the matrix (F ; G).

Comprehending quantum propositions
To begin, let us comprehend quantum propositions within the finite-dimensional part of the standard model. The base category C is thus the category FHilb of finite-dimensional complex Hilbert spaces, and the specification P : FHilb   /R/el simply maps each space H to the set PH of quantum propositions, viz subspaces χ ⊆ H. Each linear map f ∈ FHilb(H, K) induces a binary relation {f}⊆ PH×PK such that
χ{f}κ ⇐⇒ fχ ⊆ κ
holds for χ ∈ PH and κ ∈ PK. In the posetal bicategory Rel of relations, transfor- mations (3) and (4) boil down to the requirements
χ{f}κ ∧ κ{g}ϑ =⇒ χ{f ; g}ϑ
χ = χj =⇒ χ{id}χj
which are obviously satisfied. The total category FHilb P of P : FHilb  /R/el consists of the pairs ⟨χ ⊆ H⟩ as objects, and a morphism ⟨χ ⊆ H⟩   /⟨κ/⊆ K⟩ is simply a linear operator f : H   /K/such that fχ ⊆ κ.
The upshot of this construction is that the dagger compact structure of the base category FHilb and the orthomodular structure of each lattice PH are now

integrated in the structure of the comprehension category FHilb P. We spell out this structure in the next section.

Dagger mix autonomous categories
Definition 4.1 A star autonomous category [6] is
a symmetric monoidal category (A, ⊗, T) with
a contravariant duality (—)∗ : Aop 	/A/, such that
A(A ⊗ X, Y ∗) ~= A (X, (A ⊗ Y )∗), naturally in A, X, Y .
The induced correspondence A(X∗,X∗) ~= A(X ⊗X∗, T∗) ~= A (X, X∗∗) is required to map X∗  id /X/∗ to the unit X  η /X/∗∗ of the duality.
The dual monoidal structure (A, O, ⊥) is defined by XOY = (X∗ ⊗ Y ∗)∗, ⊥ = T∗. It makes Aop into a star autonomous category. It is often convenient to include both monoidal structures in the star autonomous signature.
A star autonomous category is mix autonomous [18,8] when there is a map
⊥ 	/T/. Since there is a natural transformation X ⊗ (Y OZ)  w /(X/⊗ Y )OZ [9], this induces X ⊗ Z	XOZ.
An autonomous category is compact when (X ⊗ Y )∗ ~= X∗ ⊗ Y ∗ holds naturally in X, Y , and T∗ = T.
Definition 4.2 A dagger mix autonomous category is a mix autonomous category also equipped with a lower star functor, i.e.
a covariant strictly monoidal duality (—)∗ : A 	/A/, such that
(X∗)∗ = (X∗)∗ for every object 3 X, and T∗ = T,
(f∗)∗ = (f∗)∗ for every arrow f ,
so that we can write X‡ = X∗∗ and f‡ = f∗∗;
a coherent extranatural transformation X∗	X , such that the diagram


X ⊗ X∗ ¸,X⊗u
X ⊗ X∗
u′⊗X //‡
X∗ 	∼	/(X/∗OX)‡



ε	η‡

J	//	 J 
⊥	T	T‡

commutes, where X u′ /X/‡ is the transpose of u.
In a dagger compact category, u is required to be an isomorphism. For simplicity,
X‡ = X is usually assumed.

3 Equalities between objects are considered ”evil” in categories. We could avoid this by requiring just coherent natural isomorphisms. The next equation between the arrows would then have to be written modulo these isomorphisms.

Conventions. Coherence of the above structures means that their natural iso- morphisms are unique for the given domain and codomain functors. This means that the structures can be strictified: the natural isomorphisms can be reduced to identities by transferring the functors along them. Assuming that this was done, X∗∗ = X, X∗∗ = X will hold on the nose.

Dagger compact structure of FHilb
We first review the structure of the category of finite-dimensional complex Hilbert spaces and linear maps, since the models in the next sections depend on it, and the needed reconstruction differs from [1].
The monoidal structure is given by the usual tensor ⊗, with the unit I = C.
H∗ = FHilb(H, C), i.e. the upper star is the dual space functor.
H∗ is the complex conjugate of H: it has the same underlying set, but for z ∈ C and h ∈ H, z · h in H∗ is z · h in H. Any antilinear map from H to K can be viewed as a linear map H∗  /K/in FHilb.
H‡ = FHilb(H∗, C) = FHilb(H, C)∗. The inner product, viewed as a linear map
⟨—|—⟩ : H∗ ⊗ H 	/C/, induces a canonical maps H 	/H/‡ and H∗ 	/H/∗. By the Riesz representation theorem, they are isomorphisms. For f : H		/K/ and b ∈ K the image f‡b ∈ H corresponds along this isomorphism to ⟨f‡b|—⟩ ∈

FHilb(H, C) , defined as the composite H	K	C	C, i.e. ⟨f‡b|—⟩ =
⟨b|f—⟩.
Dagger mix autonomous structure of ∫FHilb P
On the objects, the star and dagger functors are
⟨χ ⊆ H⟩∗ = χ⊥ ⊆ H∗ 
⟨χ ⊆ H⟩∗ = χ⊥ ⊆ H∗ 
⟨χ ⊆ H⟩‡ = χ ⊆ H‡ 
where χ⊥ = {ψ ∈ H∗ | ψχ = 0} is the annihilator, while χ∗⊥ is its inverse image along the Riesz isomorphism H∗  /H/∗, obtained by transposing the inner product. The arrow parts of the above functors lift from FHilb, because
fχ ⊆ κ =⇒ f∗χ∗ ⊆ κ∗ ∧ f‡κ⊥ ⊆ χ⊥
∗	∗
The tensors are
⟨χ ⊆ H⟩ ⊗ ⟨κ ⊆ K⟩ = ⟨χ ⊗ κ ⊆H ⊗ K⟩
⟨χ ⊆ H⟩ O ⟨κ ⊆ K⟩ = (χ⊥ ⊗ κ⊥)⊥ ⊆H ⊗ K
Note that the unit of ⊗ is T = ⟨C ⊆ C⟩, whereas the unit of O is ⊥ = ⟨0 ⊆ C⟩. The uniformity is realized by the Riesz’ isomorphism.

Comprehending complementarity
Testables
A quantum observable is usually represented as a Hermitian operator over a Hilbert space; the actual outcomes of an experiment are the eigenvectors of the Hermitian, which always form a basis. So a simplified view of an observable is that it is a basis of a Hilbert space. The distinctive feature of a quantum observable arises, however, only when we look at several of them at once: it arises from the uncertainty principle, which says that two observables may be incompatible, or complementary, in the sense that measuring one disturbs the other. The problem of modeling complementarity is that it is not a one-to-one relationship: many observables may be complementary to many other observables. In order to capture complementarity, we model complementary testables, construed as families of observables that can be tested together.
Definition 5.1 Let H be a Hilbert space and H^ a set of rays in it, i.e. its 1-
dimensional subspaces. The colinearity ∠(a, b) of rays a, b ∈ H is then
∠(a, b)= |⟨x|y⟩|
|x||y|
for arbitrary nonzero vectors x ∈ a and y ∈ b. The linearity of the inner product implies that this deﬁnition does not depend on the choice of x and y. Two rays are orthogonal if their colinearity is 0. They are colinear if it is 1.
Definition 5.2 For c ∈ [0, 1] and a set α ⊆ H of rays in a Hilbert space H, the
c-complement is
αc = {x ∈ H | ∀a ∈ α. ∠(x, a)= c}
Definition 5.3 A testable over a ﬁnite-dimensional Hilbert space H is a pair ⟨α, c⟩, where α ⊆ H, and c ∈ [0, 1], such that
both α and αc span H, and
αcc = α
Examples. The pair ⟨H, 0⟩ is a testable if and only if H = 0 is the point, because that is the only case when the 0-complement H0 = ∅ spans H. The pair ⟨H, 1⟩ is a testable if and only if H = C is the 1-dimensional space 4 , because that is the only case when the 1-complement H1 is nonempty, and spans H. Both ⟨0, 0⟩ and
⟨C, 1⟩ are self-complementary. For a nontrivial example, let H be an n-dimensional
Hilbert space and let c = √1 . Then any set β of n orthogonal rays H gives a testable
⟨β, c⟩, because
c	1
b ∈ β ⇐⇒ ∀x ∈ β . ∠(b, x)= √n
^

4 The 1-dimensional space is denoted by C because the standard model is usually deployed over complex Hilbert spaces. For our purposes, though, the ground field is largely irrelevant.

So if a testable β is induced by a basis, then the c-complementary testable βc is the union the sets of rays induced by the bases complementary in the sense of [24].
Remark. It is easy to see that ⟨αc, c⟩ is testable whenever ⟨α, c⟩ is.
Why testables? Since the rays in a testable may not be mutually orthogonal, test- ing may not allow distinguishing the underlying state [29, Sec. 2.2.4]. Intuitively, a testable can be tested, but the outcome may not yield a distinct observation. The purpose of testables is to capture complementarity; and a complement of an observable may be a mixture of multiple observables. The requirement of distin- guishability should be imposed later in the development, through the structure of measurements [10,31].
It is often difficult to provide a clear picture of two ideas in a single structural sweep. Although the complementarity 5 of observables and the distinguishability of states are both usually considered in the context of bases, toy models allow us to conceptualize them separately. While distinguishability requires orthogonal families, complementarity does not: a set Bc of all unit vectors complementary to a given basis B is usually not a basis, because some of its elements are not mutually orthogonal. In most models, Bc contain some bases, that can be extracted. But B is in general not completely determined by any of these complementary bases, since each of them usually admits multiple complementary bases. Yet the basis B turns out to be completely determined the complete set Bc. That is why it seems more appropriate to model complementarity without the orthogonality requirement, usually imposed on observables. Hence this attempt with ”testables”.
Testables in a category. Let the specification T : FHilb   /R/el now map each space H to the set TH of testables over H. Each linear map f ∈ FHilb(H, K) induces a binary relation {f}⊆ TH× TK such that
⟨α, c⟩{f}⟨β, d⟩ ⇐⇒ fα ⊆ β ∧ f‡βd ⊆ αc
The comprehension category  FHilb T has the triples ⟨H, α, c⟩ as the objects, where
⟨α, c⟩ is a testable over H. A morphism ⟨H, α, c⟩  /⟨K/, β, d⟩ is a linear operator
f :	which maps α-tests to the β-tests, while its adjoint f‡ maps the complementary βd-tests to αc-tests. When the rays in α and β are induced by some bases, then this implies that the operator f diagonalizes over these bases. The dagger mix autonomous structure is given by
⟨H, α, c⟩∗ = ⟨H, αc, c⟩
⟨H, α, c⟩∗ = ⟨H‡, αc, c⟩
⟨H, α, c⟩‡ = ⟨H‡, α, c⟩
⟨H, α, c⟩⊗ ⟨K, β, d⟩ = ⟨H ⊗ K,α × β, c · d⟩



5 The terms ”incompatibility”, and ”unbiasedness” are often used in the same context, sometimes synony- mously with complementarity, sometimes in different but related meanings. We take a bird’s eye view of complementarity here, and these distinctions do not come about.

The unit for both ⊗ and O is I = ⟨C, {C}, 1⟩, where C is the tensor unit in FHilb. The mix map ⟨H, α, c⟩⊗ ⟨K, β, d⟩ ,˛υ /⟨H/, α, c⟩ O ⟨K, β, d⟩ is thus realized by the
identity on H⊗ K, since α × β ⊆ (αc × βd)c·d. The uniformity is given by the Riesz
map again.
Entangled vectors live in O but not in ⊗.  Note that all vectors I   /⟨H/, α, c⟩ ⊗ ⟨K, β, d⟩ are separated, i.e. in the form a ⊗ b, for some a ∈ α and b ∈ β. In contrast, the space ⟨H, α, c⟩ O ⟨K, β, d⟩ contains many entangled vectors. In fact, entangled vectors are just those that lie in the complement of the inclusion υ of ⊗ into O. The same phenomenon — that entanglement can be characterized by the difference between two tensors in a dagger mix autonomous category — was present in general probabilistic theories of Barnum, Barrett, Leifer and Wilce [4,5]. Interestingly, this formalism is not based on Hilbert spaces, but on Foulis and Randall’s test spaces. This is what we explore next.

Test spaces and testables over relations
Sets and binary relations form a dagger monoidal category Rel, and thus provide a rudimentary model of quantum computation, albeit with mere two scalars. Never- theless, it turns out that some of the relevant structure in Rel is rich enough to model some quantum phenomena in a surprisingly informative way. This category is the playground of toy models [40,13]. Even Foulis’ and Randall’s test spaces [35,19,36], probably the most extensively studied nonstandard quantum model 6 [41], can be reconstructed and analyzed in this framework, using a comprehension over Rel.
First of all, transferring the algebraic characterization of bases as classical struc- tures from Hilbert spaces [16] to relations [32] yields in Rel a distinction between quantum channels and classical interfaces, which can be used to implement quan- tum algorithms [31] 7 . The idea is that the classicality of an abstract basis vector is characterized by its capability to be copied and deleted. In Rel, such a ”basis” over a set X corresponds to a partition X = a∈α a, where  denotes the disjoint union, and each a comes with a structure of an abelian group. The abstract basis vectors are the components of the partition, i.e. the disjoint subsets a ⊆ X viewed
8	 a //

as the arrows
1	|	X in Rel. See [32] for the details.

Just like the notion of basis, the notion of complementarity can be transferred from FHilb to Rel. An algebraic characterization of complementary bases in FHilb was proposed in [11]. An equivalent version was transferred to Rel in [31], and com- plementary bases were used for a relational presentation of a quantum algorithm. A careful exploration of complementary bases in Rel was provided [17]. Here we try to comprehend complementarity without the restriction to bases, as explained in the preceding section. So we drop the orthogonality requirement, which in Rel

6 nonstandard in the sense: not the Hilbert space model
7 It should be noted that the exponential speedup of boolean functions, provided by quantum computation, arises from implementing them as unitaries, rather than from some inherent power of relations. But the step of implementing a boolean function as a unitary is just as hard when it is to be executed on a ”real” quantum computer, as when it is to be computed as a relation, i.e. executed on a nondeterministic computer.
8 In the same way, the vectors in a Hilbert space H are viewed as arrows, i.e. linear operators I   /H/.

corresponds to the disjointness of subsets.
Definition 5.4 A test space over a set X is a family of subsets α ⊆ ℘X which is
covered, i.e. X = ∪α, and
irredundant, i.e. ∀ab ∈ α. a ⊆ b ⇒ a = b
The elements of α are called tests.
Remark. If the tests are disjoint, i.e. ∀aaj ∈ α. a ∩ aj = ∅, then α is a basis in Rel, in the sense of [32]. Tests spaces can thus generalize bases in Rel in a similar way in which testables generalize observables in FHilb.
Definition 5.5 The complement of a test space α over X is the set of maximal subsets which intersect each test at a single element
α⊥ = u ∈ ℘X | ∀a ∈ α. |u ∩ a| =1 ∧	}
∀uj ⊆ u. (∀a ∈ α. |uj ∩ a| = 1) ⇒ uj = u
Definition 5.6 A family of subsets α ⊆ ℘X is a testable if
both α and α⊥ are test spaces, and
α⊥⊥ = α.
Examples. The simplest testables over X are provided by the crudest cover {X}, and by the finest cover {{x}}x∈X , which happen to be each other’s complements. Furthermore, an arbitrary partition β    X, i.e. a basis in Rel, is also testable.
Its complement β⊥ is clearly a test space. It consists of all p ∈ ℘X which share
exactly one element with each b ∈ β. Thus all p ∈ β⊥ have the same number of elements, |p| = |β|. This means that β⊥ contains a partition only if |β| divides
|X|. The converse is easily seen to hold. The conclusion is thus that a basis β of X in Rel has a complementary basis if and only if all b ∈ β have the same number of elements, and |X| = |b|· |β|. Then every complementary basis γ has |γ| = |b| elements c ∈ γ, and each of them has |c| = |β| elements. Complementary bases thus form a ”rectangular” structure on X. This was mentioned and used in [31, Sec. 5.2], and explored in detail in [17]. But even a basis β of X in Rel that does not admit a complementary basis, viz a complementary observable, always admits a complementary testable. In terms of the induced equivalence relation
β
x ~ y ⇐⇒ ∃b ∈ β. x ∈ b ∧ y ∈ b
the requirement that each p ∈ β⊥ must contain exactly one element from each b ∈ β means that p must never contain two ~-related elements, and is maximal such, or formally:
β⊥	=	 p ∈ ℘X | ∀xy ∈ p. x β y ⇒ x = y ∧
∀pj ≥ p ∃xy ∈ pj. x β y ∧ x /= y}
It is easy to see that β⊥⊥ = β. In fact, the argument goes through even if ~ is not transitive, i.e. if β is not a partition, but the set of maximal cliques for a reflexive symmetric operation. A reader familiar with Girard’s coherence spaces [20] has by

now probably recognized the structure that emerges. Indeed, those testables α that can be presented as sets of cliques of symmetric reflexive relations boil down to coherence spaces 9 . The dagger mix autonomous category of coherence spaces was in fact reconstructed through a comprehension in [33], and it is now fully embedded in the comprehension category of testables over Rel.
Testables over relations. Let the specification T : Rel   /R/el map each set X
to the set T X of testables over X. Each relation r ∈ Rel(X, Y ) induces a relation
α{r}β ⇐⇒ ℘℘r(α) ⊆ β ∧ ℘℘rop(β⊥) ⊆ α⊥
where ℘r(a)= {y ∈ Y | ∃x ∈ a. xry} and ℘℘r(α)= {b ∈ ℘Y | ∃a ∈ α. ℘r(a)= 
b} define ℘℘X  ℘℘r /℘/℘Y .	The comprehension category ∫	T has the pairs
⟨X, α⟩ as objects, where α is a testable over X. A morphism ⟨X, α⟩   /⟨Y/, β⟩ is a relation r which maps every α-test to a β-test, whereas rop maps every β⊥-test to an α⊥-test.
Since Rel is a compact category with a degenerate dagger structure, the com- prehension category Rel T is star autonomous category, with a degenerate dagger:
⟨X, α⟩∗ = ⟨X, α⟩
⟨X, α⟩∗ = ⟨X, α⟩‡ = ⟨X, α⊥⟩
⟨X, α⟩⊗ ⟨Y, β⟩ = ⟨X × Y, α ⊗ β⟩
⟨X, α⟩ O ⟨Y, β⟩ = X × Y, (α⊥ ⊗ β⊥)⊥
where α ⊗ β = {a × b | a ∈ α ∧ b ∈ β}. The unit for both tensors is ⟨1, {1}⟩, the only testable over 1.
Remarks. The resulting category of testables extracts the star autonomous part of the larger category of test spaces and test-preserving relations. This subcategory captures a relational version of complementarity and entanglement, interpreted by analogy with the testables in the preceding section. In contrast with the standard model, we find, e.g., many observables that have complementary testables, but no complementary observables. Is this just an unsound feature of a toy model? Or is the rich, complicated combinatorics of complementary observables in the Hilbert space model just a peculiarity of that model, inessential for quantum computation itself?
It is fair to also mention that test spaces are interpreted in many different ways in the literature. We viewed them as a relational version of rays 10 ; many authors view them as an abstraction of bases. This interpretation can also be related using comprehension; but this must be left for another occasion.



9 There, the story is usually told in terms of irreflexive relations. But this is just a matter of convention.
10 There is no difference between ”rays” and ”vectors” in Rel: both are simply subsets.

Richer comprehensions
Quantum probabilities
The comprehension of quantum propositions in Sec. 3 can be generalized to quantum probabilities. While the specification P : FHilb   /R/el mapped each space H to the lattice PH of its closed subspaces, the specification P : FHilb   /R/el will map each H to the set of quantum probability measures 11
PH = {μ : PH   /[0/, 1] | μ(0) = 0 ∧ μ(H)= H ∧
⟨χ|κ⟩ =0 ⇒ μ(χ ⊕ κ)= μ(χ)+ μ(κ)}
where ⟨χ|κ⟩ = 0 abbreviates ∀x ∈ χ∀y ∈ κ.⟨x|y⟩ = 0. The arrow part assigns to every linear map f ∈ FHilb(H, K) the relation {f} ⊆ PH× PK which relates the probability measures μ over H and ν over K just when it preserves them, i.e.
μ{f}ν ⇐⇒ μ = ν ◦ f


induce measures o∫n H ⊗ K, the dagger mix autonomous structure of
FHilb P is

By Gleason’s theorem [21,34, Sec. 4.2], every quantum probability measure (ex- cept in dimensions 1 and 2) comes from a density operator, i.e. corresponds to a quantum mixed state. Decomposing density operators as convex combinations of rays, FHilb P can be equivalently presented as the category of mixed states and
linear operators that preserve the mixtures. This brings us in the realm of the
questions raised in the final sections of [14]. It is interesting that the annihilators induce a nontrivial duality on mixed quantum states, displayed in the dagger mix autonomous structure of the comprehension category FHilb P.
Multitestables
A test multispace is a test space over a multiset X. The idea is that an outcome
x ∈ X may occur several times.
Definition 6.1 A test multispace A over X is a pair A = ⟨α, ω⟩ where
α ⊆ ℘X is a test space, and
ω : X 	/N/is a function, assigning to each element of X its multiplicity. We call a test multispace A = ⟨α, ω⟩ a multitestable whenever α is a testable.
Notation. We define the complement of a test multispace A = ⟨α, ω⟩ by comple- menting the underlying test space
A⊥ =  α⊥, ω 
Conveniently, a test multispace A can also be presented in the ”´etale form”

11 This is a simplified version of Mackey’s treatment in [26, Sec. 2.2].

|A|  A /℘/X, where
|A|	=	ω(x)	=	{⟨a, x, i⟩ | a ∈ α ∧ x ∈ a ∧ i < ω(x)}
a∈α x∈a
and A denotes the projection ⟨a, x, i⟩  /a,/by abuse of notation. Note the differ- ence between |A| and |A⊥|.
Category of multitestables. Let the specification T : Rel   /S/pan map each set X to the set TX of multitestables over it, and each relation r ∈ Rel(X, Y ) to the span TX ¸, {r}   /T/Y , which we view as a matrix of sets, with the entries

A{r}B	=	 ⟨R, R⊥⟩∈ Rel (|A|, |B|) × Rel |B⊥|, |A⊥| 
A; ℘r = R; B ∧ B⊥; ℘rop = R⊥; A⊥}

|A| 	R	/|B/|
|A⊥| ¸,R⊥
|B⊥|



A	B
J	J 
A⊥	B⊥
J	J 

℘X	℘r	/℘Y/
℘X ¸,op	℘Y



The lax structure (5-6) for X
is given by
| /Y/, Y
| /Z/and A ∈ TX, B ∈ TY , C ∈ TZ

μABC : A{r}B × B{s}C 	//A{r; s}C
⟨R, R⊥⟩ , ⟨S, S⊥⟩ 	/ /R; S , S⊥; R⊥ 
whereas ηA ∈ A{idX}A is  id|A|, id|A⊥| .
The objects of the comprehension category ∫Rel T are the triples ⟨X, α, ω⟩,
⟨Y, β, a⟩, where ⟨α, ω⟩ is a test mu ltispace o ver X, ⟨β, a⟩ over Y , etc. A morphism
The star autonomous structure, still with the degenerate daggers, is on the objects
⟨X, α, ω⟩∗ = ⟨X, α⊥, ω⟩
⟨X, α, ω⟩⊗ ⟨Y, β, a⟩ = ⟨X × Y, α ⊗ β, ω · a⟩
⟨X, α, ω⟩ O ⟨Y, β, a⟩ = X × Y, (α⊥ ⊗ β⊥)⊥,ω · a
The unit for both tensors is ⟨1, {1}, 1⟩.  The duality on the morphisms is
⟨r, R, R⊥⟩∗ = ⟨rop, R⊥, R⟩ and the monoidal structure is left as an exercise. Non- degenerate dagger structure could be obtained by considering signed multisets, i.e. allowing negative multiplicities, with ω : X   /Z/.
Future work
We presented several categories built by comprehension over FHilb and Rel, which played the role of the basic models of quantum computation, suitable for refine- ments and extensions. By refining their dagger compact structure, we arrived in

all cases to dagger mix autonomous categories. Certain star autonomous cate- gories have received a lot of attention in research of resource sensitive logics and type systems. Interesting examples of this structure were previously encountered in modeling quantum computation, e.g. in Selinger’s explorations of higher order [38]. Abramsky’s big toy models [2,3] have star autonomous structure as a prominent feature.
There is a sense in which dagger autonomous categories give a semantically richer structure than dagger compact categories. They capture not only the abstract com- position and duality operations, used for building quantum systems and operations, which correspond to the global operations of the dagger compact structure, but also the complementarity relations, which are modeled in quantum logic, and have been presented in dagger compact categories as local structure. Dagger autonomy arises as soon as complementarity is viewed as a part of the global structure of quantum computation.
However, a richer or finer picture does not always provide a better insight. One of the most salient features of the dagger compact structure is that the calculations with it are supported by a very convenient string diagram language. Is there a convenient extension of that language catering for the dagger autonomous structure? Its utility may depend on such a language.
But at least some of the fundamental concepts of quantum computation do lift from their simple and robust presentations in dagger compact categories into simple and robust presentations in dagger autonomous categories. For instance, the centerpiece of categorical quantum mechanics [1] is the interpretation of entangled pairs in terms of the compact dualities
I  η /H/∗ ⊗ H	H ⊗ H∗  ε /I /
which satisfy the adjunction equations
(ε ⊗ H)(H ⊗ η)= idH	(H∗ ⊗ ε)(η ⊗ H∗)= idH∗ In star autonomous categories, such dualities lifts to the pairs
T  η /H/∗OH	H ⊗ H∗  ε /⊥/
available for every object H. The adjunction equations now become
∗	η⊗H∗	/(H/∗OH) ⊗ H∗

H ¸¸¸¸¸¸¸
H ¸¸¸¸¸¸
¸¸¸¸

H⊗η
J 
¸¸¸¸¸¸¸
¸¸¸¸¸¸id
¸¸¸¸¸
¸¸¸¸¸¸
¸¸¸w¸¸
¸¸z˛

H ⊗ (H∗OH)
¸¸¸¸¸¸
¸¸¸¸¸¸
H∗O(H ⊗ H∗)

¸¸¸¸
w ¸¸¸¸¸
¸¸¸¸
¸¸¸
¸¸¸¸¸¸¸¸
H∗Oε

¸z˛
(H ⊗ H∗
)OH	¸¸¸¸/z˛/
¸¸¸¸zJ˛∗ 

where T⊗ X = X = X ⊗ T, and ⊥OX = X = XO⊥ is assumed for simplicity,

and the distributivities w are as in [9,8]. Generalizing the dagger compact view of teleportation [1,10,14], one could thus interpret T  η /H/∗OH as an entangled pair, and H ⊗ H∗  ε /⊥/as a basic measurement, and get a rudimentary form of teleportation. Remarkably, as pointed out at the end of Sec. 5.1, in many models entanglement arises exactly from the difference between the two tensors: the entan- gled pairs live in H∗OH, the separated pairs in H∗ ⊗ H. This phenomenon seems to deserve further thought and exploration.
Proceeding from the above notion of autonomous duality, extending the methods of [10], one can show that an associative algebra structure H ⊗ H  ∇ /H/in an autonomous category makes H self-dual if it satisfies the autonomous version of the Frobenius condition:
H ⊗ H 	H⊗Δ /H/⊗ (HOH)


Δ⊗H
¸¸¸¸¸¸
¸∇¸¸¸¸¸
¸¸¸¸¸¸¸w
¸¸¸¸¸¸

J 
(HOH)	H
¸¸¸¸¸¸¸
¸¸¸z˛
¸¸¸¸
¸Δ¸¸
z˛
(H ⊗ H)OH

w ¸¸¸¸¸
¸¸¸¸¸
∇OH

z˛	z˛J 
HO(H ⊗ H) HO∇	/H/OH
where Δ = ∇‡. What do classical structures, corresponding to bases and classical observables [16,32] lift to in the dagger autonomous framework, and how do their interact with the notions of complement? What is the meaning of the complemen- tarity of mixed states, touched upon in Sec. 6.1? The comprehension construction provides a handy tool for assembling toy models to explore such questions.
Acknowledgement
Peter Selinger and Chris Heunen provided useful comments and suggestions.

References
S. Abramsky and B. Coecke. A categorical semantics of quantum protocols. In Proceedings of the 19th Annual IEEE Symposium on Logic in Computer Science: LICS 2004, pages 415–425. IEEE Computer Society, 2004.
Samson Abramsky. Big toy models: Representing physical systems as chu spaces. Synthese, 2010. to appear.
Samson Abramsky. Coalgebras, chu spaces, and representations of physical systems. In Jean-Pierre Jouannaud, editor, Proceedings of the 2010 LICS, page 12 pp. IEEE, 2010. to appear.
Howard Barnum, Jonathan Barrett, Matthew Leifer, and Alexander Wilce. Cloning and broadcasting in generic probabilistic theories. quant-ph/0611295, 2006.
Howard Barnum, Jonathan Barrett, Matthew Leifer, and Alexander Wilce. Teleportation in general probabilistic theories. 0805.3553, 2008.
Michael Barr. -Autonomous Categories. Number 752 in Lecture Notes in Mathematics. Springer- Verlag, 1979.
Garrett Birkhoff and John von Neumann. The logic of quantum mechanics. Annals of Mathematics, 37:823–843, 1936.

J.R.B. Cockett and R.A.B. Seely. Proof theory for full intuitionistic linear logic, bilinear logic and MIX categories. Theory and Applications of Categories, 3(5):85–131, 1997.
J.R.B. Cockett and R.A.B. Seely. Weakly distributive categories. J. of Pure and Appl. Algebra, 114:133–173, 1997.
B. Coecke and D. Pavlovic. Quantum measurements without sums. In G. Chen, L. Kauffman, and
S. Lamonaco, editors, Mathematics of Quantum Computing and Technology. Taylor and Francis, 2007. arxiv.org/quant-ph/0608035.
Bob Coecke and Ross Duncan. Interacting quantum observables. In Luca Aceto, Ivan Damg˚ard, Leslie Ann Goldberg, Magnu´s M. Halld´orsson, Anna Ing´olfsd´ottir, and Igor Walukiewicz, editors, ICALP (2), volume 5126 of Lecture Notes in Computer Science, pages 298–310. Springer, 2008.
Bob Coecke, Bill Edwards, and Rob Spekkens. The group theoretic origin of non-locality for qubits. Technical Report RR-09-04, OUCL, 2009.
Bob Coecke and William Edwards. Toy quantum categories. In Bob Coecke and Prakash Panangaden, editors, Proceedings of the 2008 QPL-DCM Workshop, pages 25–35. Springer-Verlag, 2008. arXiv:0808.1037.
Bob Coecke, E´ric Oliver Paquette, and Dusko Pavlovic. Classical and quantum structuralism. In Simon Gay and Ian Mackie, editors, Semantical Techniques in Quantum Computation, pages 29–69. Cambridge University Press, 2009.
Bob Coecke and Aleks Kissinger. The compositional structure of multipartite quantum entanglement. Technical Report arXiv:1002.2540, 2010.
Bob Coecke, Dusko Pavlovic, and Jamie Vicary. A new description of orthogonal bases. Math. Structures in Comp. Sci., 2008. 13 pp., to appear, arxiv.org:0810.0812.
Julia Evans, Ross Duncan, Alex Lang, and Prakash Panangaden. Classifying all mutually unbiased bases in Rel. arXiv/0909.4453, 2009.
Arnaud Fleury and Christian Retor´e. The mix rule. Mathematical Structures in Computer Science, 4(2):273–285, 1994.
D. J. Foulis and C. H. Randall. Operational statistics. I. Basic concepts. J. of Math. Physics, 13(11):1667–1675, 1972.
Jean-Yves Girard. Linear logic. Theor. Comput. Sci., 50:1–102, 1987.
Andrew M. Gleason. Measures on the closed subspaces of a hilbert space. Journal of Mathematics and Mechanics, 6:885–893, 1957.
Bart Jacobs. Categorical Logic and Type Theory. Number 141 in Studies in Logic and the Foundations of Mathematics. North Holland, Amsterdam, 1999.
Gregory M. Kelly and Miguel L. Laplaza. Coherence for compact closed categories. J. of Pure and Applied Algebra, 19:193–213, 1980.
Karl Kraus. Complementary observables and uncertainty relations. Phys. Review D, 35(10):3070–3075, 1987.
F. William Lawvere. Equality in hyperdoctrines and the comprehension schema as an adjoint functor. In Alex Heller, editor, Applications of Categorical Algebra, number 17 in Proceedings of Symposia in Pure Mathematics, pages 1–14. American Mathematical Society, 1970.
George W. Mackey. Mathematical Foundations of Quantum Mechanics. Mathematical Physics Monograph Series. W.A. Benjamin, 1963.
Saunders MacLane and Ieke Moerdijk. Sheaves in Geometry and Logic: A First Introduction to Topos Theory. Springer, 1992.
N. David Mermin. Is the moon there when nobody looks? reality and the quantum theory. Physics Today, pages 38–47, 1985.
Michael A. Nielsen and Isaac L. Chuang. Quantum Computation and Quantum Information. Cambridge University Press, 1 edition, October 2000.
Dusko Pavlovic. Predicates and Fibrations. PhD thesis, Rijksuniversiteit Utrecht, 1990.
Dusko Pavlovic. Geometry of abstraction in quantum computation. Technical Report RR-09-13, OUCL, 2009.


Dusko Pavlovic. Quantum and classical structures in nondeterministic computation. In Peter Bruza, Don Sofge, and Keith van Rijsbergen, editors, Proceedings of Quantum Interaction 2009, volume 5494 of Lecture Notes in Artificial Intelligence, pages 143–158. Springer Verlag, 2009. arxiv.org:0812.2266.
Dusko Pavlovic and Samson Abramsky. Specifying interaction categories. In E. Moggi and G. Rosolini, editors, Category Theory and Computer Science ’97, volume 1290 of Lecture Notes in Computer Science, pages 147–158. Springer Verlag, 1997.
Constantin Piron. Foundations of Quantum Physics. W.A. Bejamin, London, 1976.
C. H. Randall and D. J. Foulis. An approach to empirical logic. The American Mathematical Monthly, 77(4):363–374, 1970.
C. H. Randall and D. J. Foulis. Operational statistics. II. Manuals of operations and their logics. J. of Math. Physics, 14(10):1472–1480, October 1973.
Peter Selinger. Towards a quantum programming language. Mathematical. Structures in Comp. Sci., 14(4):527–586, 2004.
Peter Selinger. Towards a semantics for higher-order quantum computation. In Peter Selinger, editor, Proceedings of the 2nd International Workshop on Quantum Programming Languages, number 33 in TUCS General Publications. Turku Centre for Computer Science, 2004.
Peter Selinger. Dagger compact closed categories and completely positive maps. Electron. Notes Theor. Comput. Sci., 170:139–163, 2007.
Robert W. Spekkens. In defense of the epistemic view of quantum states: a toy theory. Physical Review A, 75:032110, 2007.
Alexander Wilce. Test spaces. In K. Engesser D. Gabbay and D. Lehman, editors, Handbook of Quantum Logic, volume 2, page 120 pp. Elsevier, 2009.
