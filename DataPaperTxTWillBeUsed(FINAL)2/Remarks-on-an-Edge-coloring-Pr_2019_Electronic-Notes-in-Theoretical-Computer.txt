Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 346 (2019) 511–521
www.elsevier.com/locate/entcs
Remarks on an Edge-coloring Problem
Carlos Hoppen1
Instituto de Matema´tica e Estat´ıstica Universidade Federal do Rio Grande do Sul Porto Alegre, Brazil
Hanno Lefmann2
Fakulta¨t fu¨r Informatik, Technische Universit¨at Chemnitz Chemnitz, Germany

Abstract
We consider a multicolored version of a problem that was originally proposed by Erd˝os and Rothschild. For positive integers n and r, we look for n-vertex graphs that admit the maximum number of r-edge-colorings with no copy of a triangle where exactly two colors appear. It turns out that for 2 ≤ r ≤ 12 colors and n sufficiently large, the complete bipartite graph on n vertices with balanced bipartition (the n-vertex
Tura´n graph for the triangle) yields the largest number of such colorings, and this graph is unique with this property.
Keywords: Edge-colorings, Tur´an Problem, Erd˝os-Rothschild Problem

Introduction and main results
This paper is concerned with a multicolored version of a problem that was originally proposed by Erd˝os and Rothschild [9]. The motivation for their problem lies in the well-known Tur´an problem, where, given an integer n and a graph F , we look for the maximum number ex(n, F ) of edges in an n-vertex graph G such that G does not contain F as a subgraph. A graph G that does not contain F as a subgraph is said to be F-free and an F -free n-vertex graph with ex(n, F ) edges is called F-extremal. Tur´an [22] solved this problem for all n whenever F = Kl+1 is a complete graph on (l + 1) vertices. He showed that, for all positive integers n and l ≥ 2, any

1 Email: choppen@ufrgs.com.br
2 Email: Lefmann@Informatik.TU-Chemnitz.de
3 This work was partially supported by Coordena¸c˜ao de Aperfei¸coamento de Pessoal de N´ıvel Superior (CAPES) and DAAD via Probral (CAPES Proc. 88881.143993/2017-01 and DAAD 57391132). The first au- thor acknowledges the support of CNPq 308054/2018-0), Conselho Nacional de Desenvolvimento Cient´ıfico e Tecnol´ogico.

https://doi.org/10.1016/j.entcs.2019.08.045
1571-0661/© 2019 The Author(s). Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

Kl+1-extremal graph is isomorphic to the Tur´an graph Tl(n), the complete l-partite graph on n-vertices whose partition V = {V1,..., Vl} is balanced, that is, such that
|Vi|≤ |Vj| +1 for all i, j ∈ [l]= {1,..., l}. In particular, ex(n, K3)= [n/2♩· [n/2|. There is a vast literature about the Tur´an problem, we refer to [12] (and to the references therein) for more information.
The question of Erd˝os and Rothschild involves r-edge-colorings of n-vertex graphs with the property that every color class is F-free. They wondered whether any n-vertex graph would admit more such colorings than the corresponding F - extremal graph. Note that n-vertex F -extremal graphs admit rex(n,F ) colorings, as their edge set may be colored arbitrarily. Precisely, Erdos and Rothschild conjec- tured that the number of Kl+1-free 2-colorings is maximized by Tl(n). Yuster [23] verified this conjecture for l = 2 and n ≥ 6. Alon, Balogh, Keevash and Sudakov [2] showed that, for r ∈ {2, 3} and n ≥ n0, where n0 is a constant depending on r and l, the Tura´n graph Tl(n) is also optimal for the number of Kl+1-free r-colorings. However, they also provided a construction showing that Tl(n) is not optimal for any r ≥ 4, but did not characterize the graphs that achieve extremality. Pikhurko and Yilma [20] determined the extremal graphs for r = 4 and l ∈ {2, 3}. Together with Staden [19], they also generalized the original Erd˝os-Rothschild problem and showed that it always admits an extremal solution that is a complete multipar- tite graph (however, their proof does not settle whether it is necessarily balanced). Moreover, they defined an optimization problem whose solution produces a complete multipartite graph for which the number of colorings approximates the maximum. Balogh [3] was the first to consider r-colorings that avoid a copy of a graph F colored in a non-monochromatic way. A similar problem was investigated by Hoppen and Lefmann [15] and by Benevides, Hoppen and Sampaio [6], who considered edge- colorings of a graph avoiding a copy of F with a prescribed pattern. Given a number r ≥ 1 of colors and a graph F , an r-pattern P of F is a partition of its edge set into at most r classes, and an edge-coloring of a graph G is said to be (F, P )-free if G does not contain a copy of F in which the partition of the edge set induced by the coloring is isomorphic to P . For instance, if F = K3, there are three possible patterns: the monochromatic pattern PM (where all edges lie in the same class), the rainbow pattern PR (where each class is a singleton) and the 2-colored pattern P2 (where there are two classes, one singleton and one with cardinality two). It is clear that the original Erd˝os-Rothschild problem is precisely the problem of finding
the largest number of (F, PM )-free colorings in an n-vertex graph.
For a formal statement of this multicolored version of the Erd˝os-Rothschild problem, fix a positive integer r and a graph F , and let P be a pattern of F . Let Cr,F,P (G) be the set of all (F, P )-free r-colorings of a graph G. We write
cr,F,P (n)= max { |Cr,F,P (G)| : |V (G)| = n } ,
and we say that an n-vertex graph G is (F, P )-extremal if |Cr,F,P (G)| = cr,F,P (n). In this paper, our main objective is to study (K3, P2)-extremal graphs for the 2-colored pattern P2.
Regarding patterns P of K3, the following is known. As mentioned above, the

Tur´an graph T2(n) is the single (K3, PM )-extremal graph for r = 2 and n ≥ 6 (see [23]) and for r = 3 and n ≥ n0 (see [2] and [14]). Moreover, the graph T4(n) is the single (K3, PM )-extremal graph for r = 4 and n ≥ n0 (see [20]). To the best of our knowledge, the extremal graphs for r ≥ 5 are not known. For the rainbow pattern PR, the complete graph Kn is trivially the single (K3, PR)-extremal graph for r = 2. If r ≥ 5, Odermann and the current authors [16] have proved that the Tur´an graph T2(n) is the single (K3, PR)-extremal graph for n ≥ n0 (and for r ≥ 10 and n ≥ 5). Very recently, Balogh and Li [4] have proved that the complete graph Kn and the Tur´an graph T2(n) are the single (K3, PR)-extremal graphs for r = 3 and r = 4, respectively. Approximate results had also been obtained in [5,6,10,16].
Less is known for the pattern P2. The work of [3] implies that the Turan graph T2(n) is (K3, P2)-extremal for r = 2 and n ≥ n0. Results from [6] prove that, for any r ≥ 3, one of the extremal configurations is always a complete multipartite graph (see [6, Theorem 1.1]) and that the Tur´an graph T2(n) is (K3, P2)-extremal for r =3 and n ≥ n0 (see [6, Theorem 1.3]). On the other hand, let r = 27 and consider a partition of the set of colors into three sets C1, C2, C3, where |C1| = |C2| = |C3| = 9. We shall color the 4-partite graph T4(n) whose vertex set is partitioned V1 ∪· · ·∪V4 as follows (for simplicity, assume that n is divisible by 4). Edges between V1 and V2, and between V3 and V4 are assigned colors in C1; edges between V1 and V3, and between V2 and V4 are assigned colors in C2; edges between V1 and V4, and between V2 and V3 are assigned colors in C3. Clearly, any triangle in T4(n) must be rainbow, so that this produces colorings in C27,K3,P2 (T4(n)). Moreover, the number of colorings produced in this way is equal to
6· n2	n2	ex(n,K )
9 16 = 27 4 = 27	3 .

Since there are many other ways of coloring T4(n) (for instance, changing the choice of the sets C1, C2, C3), we conclude that cr,K ,P (n) > rex(n,K3), so that the Tur´an graph is not (K3, P2)-extremal for r = 27. Actually, a similar analysis shows that T4(n) admits more (K3, P2)-free colorings than T2(n) for all r ≥ 27. We believe that T2(n) is (K3, P2)-extremal for all r ≤ 26, at least for n ≥ n0. In this note, we offer a partial result in this direction by using the regularity lemma combined with a linear programming approach.
Theorem 1.1 Let P2 be the pattern of K3 with exactly two classes and let 2 ≤ r ≤
12. Then there exists n0 such that, for every n ≥ n0 and every n-vertex graph G, we have
|Cr,K ,P (G)|≤ rex(n,K3).
Moreover, equality holds in this equation if and only if G is isomorphic to the bi- partite Tur´an graph T2(n).
As we shall see below, in light of [17, Lemma 3.1], to prove Theorem 1.1, it suffices to prove the following stability result, which states that any n-vertex graph with a ‘large’ number of colorings must be ‘almost bipartite’. For a graph G = (V, E) and a subset W ⊂ V , we write eG(W ) to denote the number of edges of G with

both endpoints in W . We simply write e(W ) if the graph G under consideration is obvious from the context.
Lemma 1.2 Let 2 ≤ r ≤ 12 be ﬁxed. For all δ > 0, there exists n0 with the following property. If G = (V, E) is a graph on n > n0 vertices which has at least rex(n,K3) distinct (K3, P2)-free r-colorings, then there is a partition V = W1 ∪ W2 of its vertex set such that et(W1)+ et(W2) ≤ δn2.
Note that Lemma 1.2 immediately implies that |C	(G)| ≤ rex(n,K3)+o(n2)
for r ∈ {2,..., 12}.
In the remainder of the paper, we shall discuss the main ingredients in our proof of Lemma 1.2. We should mention that, in the last few years, there has been a lot of activity on the Erd˝os-Rothschild problem for several combinatorial structures, such as set systems, the power lattice and sum-free-sets [7,8,13].

Main ingredients
We first observe that, because of previous results by Hoppen, Lefmann and Oder- mann [17], the stability of Lemma 1.2 implies Theorem 1.1. The authors of [17] defined the following notion of stability.
Definition 2.1 Let F be a graph with chromatic number χ(F ) = l +1 ≥ 3 and let P be a pattern of F . The pair (F, P ) satisfies the Color Stability Property for a positive integer r if, for every δ > 0, there exists n0 with the following property. If n > n0 and G is an n-vertex graph such that |Cr,F,P (G)| ≥ rex(n,F ), then there
exists a partition V (G)= V1 ∪ ··· ∪ Vl such that Σl	et(Vi) ≤ δn2.
Then they showed that the Tur´an graph Tl(n) is the only n-vertex graph that
maximizes cr,KÆ+1,P (n) for a class of patterns of complete graphs that satisfy the Color Stability Property, namely patterns for which there is a vertex v such that all edges incident with v lie in different classes. Patterns of this type are called locally rainbow. Note that the 2-colored triangle is locally rainbow.
Lemma 2.2 [17, Lemma 3.1] Let l ≥ 2 and let P be a locally rainbow pattern of Kl+1 such that (Kl+1,P ) satisﬁes the Color Stability Property of Deﬁnition 2.1 for a positive integer r > e(l + 1). Then there is n0 such that every graph of order n > n0 has at most rex(n,KÆ+1) distinct (Kl+1,P )-free r-edge colorings. Moreover, the only graph on n vertices for which the number of such colorings is rex(n,KÆ+1) is the Tur´an graph Tl(n).
They also remarked that, in the case where the forbidden graph is a triangle, the lower bound r > e(l + 1) in the statement of this lemma may be replaced by r ≥ 3. Since Lemma 1.2 establishes that the 2-colored triangle satisfies the Color Stability Property for 3 ≤ r ≤ 12, Theorem 1.1 follows.

Regularity Lemma
Our proof of Lemma 1.2 is based on the Szemer´edi Regularity Lemma [21]. Let G = (V, E) be a graph, and let A and B be two disjoint subsets of V (G). If A and B are non-empty, define the edge-density between A and B by


d(A, B)= 
e(A, B)
,
|A||B|

where e(A, B) is the number of edges with one endpoint in A and the other in
B. For ε > 0 the pair (A, B) is called ε-regular if, for every X ⊆ A and Y ⊆ B
satisfying |X| > ε|A| and |Y | > ε|B|, we have
|d(X, Y ) − d(A, B)| < ε.
An equitable partition of a set V is a partition of V into pairwise disjoint classes V1,..., Vm of almost equal size, i.e., ||Vi|− |Vj|| ≤ 1 for all i, j ∈ [m]. An equitable partition of the vertex set V of G into the classes V1,..., Vm is called ε-regular if
m
2
We now state a (colored) version of the Regularity Lemma, which may be found in [18].
Lemma 2.3 For every ε > 0 and every integer r, there exists an M = M (ε, r) such that the following property holds. If the edges of a graph G of order n > M are r-colored E(G) = E1 ∪ · · · ∪ Er, then there is a partition of the vertex set V (G) = V1 ∪· · ·∪ Vm, with 1/ε ≤ m ≤ M, which is ε-regular simultaneously with respect to the graphs Gi = (V, Ei) for all i ∈ [r].
A partition V1 ∪· · ·∪ Vm of V (G) as in Lemma 2.3 will be called a multicolored ε-regular partition. For η > 0, we may define a multicolored cluster graph H(η) associated with this partition: the vertex set is [m] and e = {i, j} is an edge of H(η) if {Vi, Vj} is a regular pair in G for every color c ∈ [r] and is η-dense for some color c ∈ [r]. Each edge e is assigned the list Le containing all colors for which it is η-dense, so that |Le|≥ 1 for every edge in the multicolored cluster graph H(η).
Given a colored graph F , we say that a multicolored cluster graph H contains F if H contains a copy of F for which the color of each edge of F is contained in the list of the corresponding edge in H. More generally, if F is a graph with color pattern P , we say that H contains (F, P ) if it contains some colored copy of F with pattern isomorphic to P . In connection with this definition, we may obtain the following embedding result. The proof of this result follows from arguments such as in the proof of the Key Lemma [18].
Lemma 2.4 For every η > 0 and all positive integers k and r, there exist ε = ε(r, η, k) > 0 and a positive integer n0(r, η, k) with the following property. Suppose that G is an r-colored graph on n > n0 vertices with a multicolored ε-regular partition
V = V1 ∪· · ·∪ Vm which deﬁnes the multicolored cluster graph H = H(η). Let F be a ﬁxed k-vertex graph with a prescribed color pattern P on t ≤ r classes. If H contains (F, P ), then the graph G also contains (F, P ).

Stability
Another basic tool in our paper are stability results for graphs.
It will be convenient to use the following recent theorem by Fu¨redi [11].
Theorem 2.5 Let G = (V, E) be a Kk+1-free graph on m vertices.	If |E| =

ex(m, Kk+1) − t, then there exists a partition V = V1 ∪ ... ∪ Vk with Σk
We also use the following simple lemma due to Alon and Yuster [1].
e(Vi) ≤ t.

Lemma 2.6 Let G be a bipartite graph on m vertices with partition V (G)= U1 ∪U2 and with at least ex(m, K3) − t edges. If we add at least 3t new edges to G, then in the resulting graph there is a copy of K3 with exactly one new edge, which connects two vertices of K3 in the same class Ui.
Proving Lemma 1.2
In this section, we provide a sketch of the proof of Lemma 1.2. Fix the number r ∈ {2,..., 12} of colors and δ > 0. To avoid case analysis, we concentrate on the case r ≥ 6 4 .
With foresight, we consider auxiliary constants ξ > 0 and η > 0 such that


ξ <  δ ,	rrη+h(rη) <
14
  r	 ξ
M (r)
 δ
and η < 
2r
,	(1)

where M (r) is defined in (11) and h(x) = −x log2 x − (1 − x) log2(1 − x), with
h(0) = h(1) = 0, is the entropy function in [0, 1]. It is well known that
n	≤ 2H(α)n
αn
for any 0 ≤ α ≤ 1/2.
Let ε = ε(r, η, 3) > 0 satisfy the assumption in Lemma 2.4, and assume without loss of generality that ε < η/2. Fix M = M (r, ε) given by Lemma 2.3.
Let Δ be an r-edge coloring of G = (V, E) that contains no 2-colored triangle. By Lemma 2.3, there is a multicolored ε-regular partition V = V1 ∪· · ·∪ Vm of the colored graph, where 1/ε ≤ m ≤ M .
For each color, there are at most ε m irregular pairs with respect to the partition
V = V1 ∪· · · ∪ Vm, hence at most
r · ε ·  m  ·   n 2 ≤ rε · n2 ≤ rη · n2	(2)
edges of G are contained in an irregular pair with respect to some color. Moreover, there are at most

m ·   n 2 = n
≤ εn2 ≤
η · n2
2
(3)



4 The cases 2 ≤ r ≤ 5 may be proved with similar arguments.

edges with both ends in some class Vi, where m ≥ 1/ε. Finally, the number of edges e with ends in different classes Vi and Vj such that the color of e has density less than η between Vi and Vj is at most
r · η ·  m  ·   n 2 ≤ rη · n2.	(4)
Using (2), (3) and (4) gives at most rηn2 edges of these three types, which may be chosen in at most  n2  ways. Note that this set of edges could be colored in at most rrηn2 different ways.
Let H = H(η) be the multicolored cluster graph associated with the partition
V = V1∪· · ·∪Vm. Let Ej(H)= {e ∈ E(H): |Le| = j} and ej(H)= |Ej(H)|, j ∈ [r]. The number of r-edge colorings of G that give rise to the partition V = V1 ∪· · ·∪Vm and to the multicolored cluster graph H is bounded above by

n2 rηn2

· rrηn2
· ⎛ 
jej (H)
⎞(  n )2
⎠
≤ 2h(rη)n2

rrηn2
⎛ 
jej (H)
⎞(  n )2
⎠
.	(5)

j=1
Recall that ξ is a constant defined in (1).
j=1

Claim 3.1 There must be a multicoloured cluster graph H such that
er—3(H)+ ··· + er(H) ≥ ex(m, K3) − ξm2.
Before proving this claim, we show that it implies the desired result. Let Hj be the subgraph of H with edge-set Er—3 ∪ ··· ∪ Er. By Theorem 2.5 there is a partition U1 ∪ U2 = [m] with
eH′ (U1)+ eH′ (U2) ≤ ξm .
Let H^ be a bipartite subgraph of Hj with bipartition U1 ∪ U2 and the maximum
number of edges. Note that by Theorem 2.5 we have
e(H) ≥ ex(m, K3) − 2ξm2.
We claim that e1(H)+ ··· + er—4(H) ≤ 6ξm2. Otherwise, by Lemma 2.6, the graph
obtained by adding the edges of E1 ∪ · · · ∪ Er—4 to H^ would contain a triangle
such that exactly one of the edges f1 is in E1 ∪· · ·∪ Er—4. Let f2 and f3 be the
other two edges of the triangle, which lie in Er—3 ∪ · · · ∪ Er. If there is a color
α ∈ Lf1 ∩ (Lf2 ∪ Lf3 ), say α ∈ Lf1 ∩ Lf2 , we may choose a color β /= α in Lf3 , as
|Lf3 | ≥ r − 3 ≥ 3. Otherwise, let β ∈ Lf1 and note that |Lf2 ∪ Lf3 | ≤ r − 1, while
|Lf2 | + |Lf3 |≥ 2r − 6 ≥ r. So there is a color α ∈ Lf2 ∩ Lf3 , where α /= β. In both cases, this would lead to a 2-colored triangle in G by Lemma 2.4, a contradiction.
As a consequence, the number of edges of H with both ends in the same set Ui is at most 7ξm2. Let Wi = ∪j∈Ui Vj for i ∈ {1, 2}. Then, by our choice of η and ξ, we have
et(W1)+ et(W2) ≤ rηn2 + (n/m)2(eH (U1)+ eH (U2)) < δn2,	(6)

as required.
To conclude the proof of Lemma 1.2, we need to prove Claim 3.1.
Proof. (Proof of Claim 3.1) Suppose for a contradiction that any coloring of G
avoiding a 2-colored triangle leads to a multicolored cluster graph H for which
er—3(H)+ ··· + er(H) < ex(m, K3) − ξm2.	(7)
Given a 2-element set S ⊂ [r] and j ∈ {2,...,r − 4}, let Ej(S, int≥1; H) be the set of all edges ej ∈ Ej(H) that satisfy |Le′ ∩ S| ≥ 1, and let ej(S, int≥1; H) = 
|Ej(S, int≥1; H)|.
Proposition 3.2 Consider a multicolored cluster graph H with no 2-colored trian- gle.
For all 2-element subsets S ⊆ [r] of colors, the subgraph Hj of the multicolored
cluster graph H with edge set  r—4 Ej(S, int≥1; H) ∪  r	El(H) is triangle-
Moreover, there exists a 2-element subset S ⊆ [r] such that

r—4
Σr—4 r − r—j 

 j=2
Ej(S, int≥1; H) ≥
 
2
j=2
r  2	· |Ej(H)|.	(8)
2

Before proving Proposition 3.2, note that it leads to the following inequality:

r—4 r − r—j
 r	· ej(H)+ 

	
el(H) ≤ ex(m, K3).	(9)

Proof. We first argue that  r—4 Ej(S, int≥1; H) ∪  r	El(H) is triangle-free.
For a contradiction suppose that there is a triangle with edges f1, f2, f3. Note that
the lists of these edges have size at least two.
If one of the edges lies in  r	El(H), we may sum the sizes of the lists Lƒ , Lƒ
1	2
and Lƒ3 to obtain at least (r−3)+4 = r +1. In particular, two of the lists must have
a color α in common, and the third list contains β /= α, which produces a 2-colored triangle, a contradiction. Next, assume that f1, f2, f3 ∈  r—4 Ej(S, int≥1; H). If we sum the sizes of Lƒ1 ∩ S, Lƒ2 ∩ S and Lƒ3 ∩ S, we obtain at least three, so that two of the lists must contain the same color α ∈ S, and the third list contains an element β /= α, which proves part (a)
For part (b), we claim that


r—4

|Ej(S, int≥1; H)| =
Σr—4   r 
 r − j 
ej(H).

S∈([r]) j=2
j=2


Indeed, for j = 2,...,r − 4, every edge e ∈ Ej(H) is counted on the left hand side for all sets S ∈ [r] such that |S ∩ e|≥ 1, which amounts to r − r—j times.


Table 1 Approximate values of M (r).

By averaging, as there are r  distinct 2-element subsets in [r], there exists a 2-element subset S ⊆ [r] such that

r—4
Σr—4 r − r—j 

 j=2
Ej(S, int≥1; H) ≥
 
2
j=2
r  2	· ej(H).
2
2

There are at most Mn partitions on m ≤ M classes. Thus, using (5), summing
over all partitions and all corresponding multicolored cluster graphs H, the number of r-edge-colorings of G avoiding a 2-colored triangle is bounded above by
⎛	⎞(  n )2

Mn · Σ 2h(rη)n2 · rrηn2 · ⎝  jej (H)⎠
.	(10)

Note that finding the maximum M (r) of  r	jej (H) in this equation is equivalent
to maximizing
e2 ln 2 + e3 ln 3 + ··· + er ln r,
which is a linear objective function with respect to the variables e2,..., er ≥ 0. Together with linear constraints in (14) and (9), we obtain a linear program as follows. Given H, set ζ(H) = (ex(m, K3) − er—3(H) −· · · − er(H)) /m2, so that ζ(H) ≥ ξ by (7). The inequalities (14) with j = 2 and (9) tell us that to find an upper bound on (10), we may consider the linear program
max x2 ln 2 + x3 ln 3 + ··· + xr—4 ln (r − 4)	(11)
r—4 r − r—j
 r	· xj ≤ 1
x2,..., xr—4 ≥ 0,
where xi plays the role of ei(H)/(ζ(H)m2). As it turns out, for r ∈ {6,..., 12}, if y(r) is the optimum of the linear program, the value of M (r)= ey(r) is given in Table 1.
Clearly, for any multicolored cluster graph H, we have

⎛r—4
jej (H) = ⎝
jej (H)⎞ ⎛
⎠ ⎝
jej (H)⎞
⎠

j=1
j=1
r—4
≤
j=1


jej (H)
j=r—3
⎞ er−3(H)+···+er(H)
⎠ r

as M (r) < r.
≤ M (r)ζ(H)m2 rex(m,K3)—ζ(H)m2 ≤ M (r)ξm2 rex(m,K3)—ξm2 ,	(12)

Since, for each partition, there are at most 2rM2/2 choices for the multicolored cluster graph H, with (12), equation (10) is at most

n	h(rη)n2	rηn2	 rM 2
M (r)


r
 ξn2

rex(m,K3)

n  1  3 h(rη)n2	rηn2
M (r)


r
 ξn2
rex(m,K3)

≤ r(rη+h(rη))n2 ·
 M (r) ξn2

rex(m,K3)
n  1  ex(m,K3)

This implies that G has fewer than rex(n,K3) colorings, a contradiction that proves Claim 3.1.	2

Concluding Remarks
We proved that the Tur´an graph for K3 is the unique n-vertex graph maximizing the number of r-edge-colorings with no copy of a triangle where exactly two colors appear. Of course, one may try to apply the same approach to r ≥ 13, but the optimum value M (r) of the linear program (11) satisfies M (r) > r, so that (12) fails to hold.
A possible way to circumvent this problem might be to include additional linear constraints to the linear program (11), in order to decrease the optimum value M (r).

For instance, for j = 2,..., [r/3♩, let Hj
be the subgraph of the multicolored

cluster graph H (defined in the proof of Lemma 1.2) with edge set Ej ∪···∪ Er—2j,

and fix a bipartite subgraph Bj
of Hj
with the maximum number of edges, so

that |E(Bj )| > |E(Hj )|/2= (ej(H)+ ··· + er—2j(H)) /2 (this is a well-known fact
j	j
about the maximum cut of a graph). Let Hjj be the subgraph of H with edge set

E(Bj ) ∪ Er—2j+1 ∪ · · · ∪ Er. Note that Hjj
is triangle-free, as any such triangle

j	j
would have three edges f1, f2, f3 such that |Lƒi | ≥ j ≥ 2 for all i and such that
maxi |Lƒi |≥ r − 2j +1 ≥ 2. By the pigeonhole principle, two of the lists would have a common color α, and the third list has a color β /= α. For j = 2,..., [r/3♩, this implies that
1
2 · (ej(H)+ ··· + er—2j(H)) + er—2j+1(H)+ ··· + er(H) ≤ ex(m, K3).	(14)
So far we have not been successful in achieving an optimum that is less than r for some r ≥ 13. It is conceivable that such an approach could be extended for all r ≤ 26, as we already know that the bipartite Tur´an graph cannot be optimal for r ≥ 27.

References
N. Alon and R. Yuster, The number of orientations having no fixed tournament, Combinatorica 26
(2006), 1-16.
N. Alon, J. Balogh, P. Keevash, and B. Sudakov, The number of edge colorings with no monochromatic cliques, Journal of the London Mathematical Society 70(2) (2004), 273–288.

J. Balogh, A remark on the number of edge colorings of graphs, European Journal of Combinatorics
27 (2006), 565–573.
J. Balogh and L. Li, The typical structure of Gallai colorings and their extremal graphs, arxiv:1812.07747.
J.O. Bastos, F.S. Benevides, G.O. Mora, and I. Sau, Counting Gallai 3-colorings of complete graphs, arxiv:1805.06805.
F.S. Benevides, C. Hoppen, and R. M. Sampaio, Edge-colorings of graphs avoiding a prescribed coloring pattern, Discrete Mathematics 240(9) (2017), 2143–2160.
D. Clemens, S. Das and T. Tran, Colourings without monochromatic disjoint pairs, European Journal of Combinatorics 70 (2018), 99–124.
S. Das, R. Glebov, B. Sudakov, and T. Tran, Colouring set families without monochromatic k-chains, arXiv:1803.09573.
P. Erd˝os, Some new applications of probability methods to combinatorial analysis and graph theory, Proc. of the Fifth Southeastern Conference on Combinatorics, Graph Theory and Computing (Florida Atlantic Univ., Boca Raton, Fla., 1974). Congressus Numerantium, No. X, Utilitas Math. (1974), 39–51.
V. Falgas-Ravry, K. O’Connell, J. Str¨omberg, and A. Uzzell, Multicolour containers and the entropy of decorated graph limits, arXiv:1607.08152.
Z. Fu¨redi, A proof of the stability of extremal graphs, Simonovits’ stability from Szemer´edi’s regularity,
Journal of Combinatorial Theory, Series B 115 (2015), 66–71.
Z. Fu¨redi, and M. Simonovits, The history of degenerate (bipartite) extremal graph problems, Erd˝os Centennial, Bolyai Society of Mathematics 25, Springer Verlag, 2013, pp 169–213.
H. Han, and A. Jim´enez, Maximum number of sum-free colorings in finite abelian groups, Israel Journal of Mathematics 226(2) (2018), 505–534.
H. Han, and A. Jim´enez, Improved Bound on the Maximum Number of Clique-Free Colorings with Two and Three Colors, SIAM Journal on Discrete Mathematics 32(2) (2018), 1364–1368.
C. Hoppen and H. Lefmann, Edge-colorings avoiding a fixed matching with a prescribed color pattern,
European Journal of Combinatorics 47 (2015), 75–94.
C. Hoppen, H. Lefmann, and K. Odermann, On graphs with a large number of edge-colorings avoiding a rainbow triangle, European Journal of Combinatorics 66 (2017), 168–190.
C. Hoppen, H. Lefmann, and K. Odermann, A rainbow Erd˝os-Rothschild problem, SIAM Journal on Discrete Mathematics 31 (2017), 2647–2674.
J. Koml´os and M. Simonovits, Szemer´edi’s regularity lemma and its applications in graph theory, Combinatorics, Paul Erd˝os is eighty, Vol. 2 (Keszthely, 1993), 295–352, Bolyai Soc. Math. Stud., 2, J´anos Bolyai Math. Soc., Budapest, 1996.
O. Pikhurko, K. Staden, and Z. B. Yilma, The Erd˝os-Rothschild problem on edge-colourings with forbidden monochromatic cliques, Mathematical Proceedings of the Cambridge Philosophical Society 163(2) (2017), 341–356.
O. Pikhurko and Z. B. Yilma, The maximum number of K3-free and K4-free edge 4-colorings, Journal of the London Mathematical Society 85(2) no. 3 (2012), 593–615.
E. Szemer´edi, Regular partitions of graphs, Probl`emes combinatoires et th´eorie des graphes (Colloq. Internat. CNRS, Univ. Orsay, Orsay, 1976), Colloq. Internat. CNRS, vol. 260, CNRS, Paris, 1978, 399–401.
P. Tur´an, On an extremal problem in graph theory (in Hungarian), Matematikai ´es Fizikai Lapok 48
(1941), 436–452.
R. Yuster, The number of edge colorings with no monochromatic triangle, Journal of Graph Theory
21 (1996), 441–452.
