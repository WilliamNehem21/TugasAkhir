Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 346 (2019) 15–27
www.elsevier.com/locate/entcs

A Characterization of Claw-free CIS Graphs and New Results on the Order of CIS Graphs
Liliana Alc´ona, Marisa Gutierreza, Martin Milaniˇcb
a CONICET and CMaLP, Universidad Nacional de La Plata La Plata , Argentina
b University of Primorska, UP IAM and UP FAMNIT Koper, Slovenia

Abstract
A graph is CIS if every maximal clique interesects every maximal stable set. Currently, no good characterization or recognition algorithm for the CIS graphs is known. We characterize graphs in which every maximal matching saturates all vertices of degree at least two and use this result to give a structural, efficiently testable characterization of claw-free CIS graphs. We answer in the negative a question of Dobson, Hujdurovi´c, Milaniˇc, and Verret [Vertex-transitive CIS graphs, European J. Combin. 44 (2015) 87–98 ] asking whether the number of vertices of every CIS graph is bounded from above by the product of its clique and stability numbers. On the positive side, we show that the question of Dobson et al. has an affirmative answer in the case of claw-free graphs.
Keywords: CIS graph, maximal clique, maximal stable set, maximal independent set, randomly internally matchable graph, claw-free graph.

Introduction
Many graph classes can be defined in terms of properties of cliques or stable sets in a graph (see, e.g., [7, 16]). In this paper we continue the investigation of CIS graphs, defined as graphs in which every maximal clique intersects every maximal stable set. Here, ‘maximality’ refers to maximality under inclusion. CIS graphs were studied in a series of papers [1, 2, 7, 8, 11, 12, 14, 25, 27] under different names; the name CIS (Cliques Intersect Stable sets) was suggested by Andrade et al. [2]. Currently, no good characterization or recognition algorithm for the CIS graphs is known. Recognizing CIS graphs was believed to be co-NP-complete [27], conjectured to be co-NP-complete [28], and conjectured to be polynomial [2]. The difficulty of understanding the structure of CIS graphs is perhaps related to the fact that the class of CIS graphs is not closed under vertex deletion. For example, the bull, that is, is the graph with vertex set {v1,..., v5} and edge set {v1v2, v2v3, v3v4, v2v5, v3v5}, is a CIS graph, while deleting vertex v5 from the bull yields the 4-vertex path, which is not CIS.
https://doi.org/10.1016/j.entcs.2019.08.003
1571-0661/© 2019 The Author(s). Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

Some partial results are known regarding the CIS property in particular graph classes. The class of CIS graphs generalizes the class of P4-free graphs, also known as cographs [8, 10]. Polynomially testable characterizations of the CIS property in the classes of planar graphs and of line graphs were given by Sun and Hu [25] and by Boros et al. [7], respectively. Vertex-transitive CIS graphs were characterized by Dobson et al. [12] and by Hujdurovi´c [15]. Furthermore, Dobson et al. proved that vertex-transitive CIS graphs share the well-known property of perfect graphs [20] stating that the number of vertices of the graph is bounded from above by the product of its clique number and stability number. They asked whether the property holds for all CIS graphs.
A notion closely related to CIS graphs is that of a strong clique. A clique in a graph G is said to be strong if it has non-empty intersection with every maximal stable set of G. Thus, a graph is CIS if and only if every maximal clique is strong. A clique is simplicial if it consists of some vertex and all its neighbors. It is not difficult to see that every strong clique is maximal and every simplicial clique is strong. Hujdurovi´c et al. [16] showed that a clique in a C4-free graph is strong if and only if it is simplicial, which leads to a polynomially testable characterization of CIS C4-free graphs. The concept of strong clique gives rise to several other interesting graph properties studied in the literature (see, e.g., [7, 16, 17, 23]).
Our results.  Our results consist of two interrelated parts.  First, we give a structural characterization of claw-free CIS graphs, by proving a composition theorem for this class of graphs (Theorem 4.5). This leads to a polynomial-time recognition algorithm for the CIS property in the class of claw-free graphs (Corollary 4.7). The result is derived using a characterization of graphs in which every maximal matching saturates all vertices of degree at least two (Theorem 3.3), a result related to Sumner’s characterization of randomly matchable graphs [24] that might be of some independent interest.
Second, we answer in the negative the question of Dobson et al. [12] asking whether the number of vertices of a CIS graph G is necessarily bounded from above by the product of its stability number, α(G), and clique number, ω(G). More precisely, using triangle-free graphs of small stability number [18], we construct a sequence of CIS graphs showing that even the relation |V (G)| = O(α(G)ω(G)) fails for general CIS graphs (Theorem 5.1). On the positive side, we show that the question of Dobson et al. has an affirmative answer in the case of claw-free graphs (Theorem 5.4).
Structure of the paper. In Section 2 we collect the necessary notations and preliminary results. In Section 3 we characterize graphs in which every maximal matching saturates all vertices of degree at least two. In Section 4 we prove the structural characterization of claw-free CIS graph. In Section 5 we construct a family of counterexamples to the question of Dobson et al. and study the question in the case of claw-free graphs. We conclude the paper in Section 6 by posing a question left open by our work, namely whether the Erd˝os-Hajnal property holds for the class of CIS graphs. Due to lack of space, proofs of Lemma 4.2 and Corollary 4.7 are omitted.

Preliminaries


We consider finite, undirected, and non-null graphs only. Unless specified otherwise by using the term multigraph, all our graphs will be simple, that is, without loops or multiple edges. A graph G = (V, E) has vertex set V (G) = V and edge set E(G) = E. The order of G is |V |. Given S ⊆ V (G), the subgraph induced by S in G is denoted by G[S] and defined as the graph with vertex set S and edge set {{x, y} | {x, y} ∈ E; x, y ∈ S}. The complement G of a graph G = (V, E) is the graph with vertex-set V (G) = V and the edge-set E(G) = {{x, y} | x, y ∈ V, x /= y, and {x, y} /∈ E}. We say that G is co-connected if its complement is connected. A co-component of G is the subgraph of G induced by the vertex set of a (connected) component of G. The neighborhood of a vertex v ∈ V (G) is the set NG(v) of vertices adjacent to v; its closed neighborhood is the set NG[v], defined as NG[v] = NG(v) ∪ {v}. The cardinality of NG(v) is the degree of v, denoted by dG(v). A universal vertex in a graph G is a vertex of degree |V (G)|− 1. We denote by δ(G) the minimum degree of a vertex in G. For a set S ⊆ V (G), we let NG(S) be the set of all vertices not in S having a neighbor in S.
As usual, we denote the n-vertex complete graph, path graph, and cycle graph by Kn, Pn, and Cn, respectively. The graph K3 will be also referred to as the triangle. By Km,n we denote the complete bipartite graph with parts of the bipartition of sizes m and n. The claw is the complete bipartite graph K1,3. The fact that a graph G is isomorphic to a graph H will be denoted by G ∼= H. We say that G is H-free if no induced subgraph of G is isomorphic to H. Furthermore, given a set F of graphs, we say that a graph G is F-free if G is F -free for all F ∈ F. Given two vertex-disjoint graphs G and H, we denote by G+H their disjoint union, that is, the graph with vertex set V (G) ∪ V (H) and edge set E(G) ∪ E(H). For a non-negative integer k, we denote by kG the graph consisting of k disjoint copies of G.
A clique in a graph is a set of pairwise adjacent vertices; a stable set (or independent set ) is a set of pairwise non-adjacent vertices. We say that a clique (resp., stable set) is maximal if it is inclusion-maximal, that is, if it is not contained in any larger clique (resp., stable set). Given a graph G, its stability number (or independence number ) is denoted by α(G) and defined as the maximum size of a stable set in G; furthermore, its clique number is denoted by ω(G) and defined as the maximum size of a clique in G. A matching in a graph G is a set of pairwise disjoint edges. Given a matching M and a vertex v, we say that M saturates v if M contains an edge having v as an endpoint. We will sometimes abuse this terminology and simply say that “v is in M ” if M saturates v. A matching is perfect if it saturates all vertices of the graph. An internal vertex in a graph G is a vertex of degree at least two. We say that a matching M in a graph G is a perfect internal matching if it saturates all internal vertices of G, that is, if every vertex not in M is of degree at most 1. Perfect internal matchings were studied in a series of papers, see, e.g., [3–6]. For undefined graph terminology and notation, we refer to [26].

Preliminaries on line graphs of multigraphs
Given a multigraph H, its line graph is the simple graph L(H) with vertex set E(H) in which two distinct vertices e and ej are adjacent if and only if e and ej have a common endpoint as edges in H. Clearly, if G is the line graph of a multigraph H, then there exists a multigraph Hj without loops such that G is (isomorphic to) the line graph of Hj. Such a multigraph Hj can be obtained from H by replacing every loop in H joining v with itself with a pendant edge joining v with a new vertex. Hence, we may assume without loss of generality that all line graphs considered are line graphs of loopless multigraphs. Any loopless multigraph H can be equivalently represented with a simple graph and a multiplicity function on the edges. Indeed, for every edge e ∈ E(H), let us denote by w(e) the multiplicity of e in H, that is, the
number of edges of H with the same endpoints as e. Then, H can be equivalently represented with the simple graph H˜ having vertex set V (H) and edge set obtained from E(H) by keeping only one representative edge from each class of multiple edges, together with the restriction of the multiplicity function w to the edges of H˜ .
A weighted graph is a pair (H, w) where H = (V, E) is a graph and w : E   N is a weight function. 1 Interpreting w as the multiplicity function of the edges, we see that every weighted graph (H, w) corresponds to a loopless multigraph. Accordingly, we let L(H, w) denote the line graph of (H, w), this is the line graph of the multigraph obtained from H by replacing each edge e ∈ E(H) with w(e) parallel edges.
Preliminaries on CIS graphs
For k ≥ 2, a k-comb is a graph Fk with 2k vertices v1,..., vk, w1,..., wk such that C = {v1,..., vk} is a clique, vi is adjacent to wi for all i ∈ {1,..., k}, and there are no other edges. In particular, S = {w1,..., wk} is a stable set, which shows that Fk is a split graph with a unique split partition (C, S); moreover, Fk is not a CIS graph since (C, S) is a disjoint pair of a maximal clique and maximal stable set. A k-anticomb is the graph Fk, the complement of a k-comb.
An induced k-comb Fk in a graph G is said to be settled if there exists a vertex v ∈ V (G) \ V (Fk) that is adjacent to every vertex of C and non-adjacent to every vertex of S, where (C, S) is the unique split partition of Fk. Similarly, an induced k-anticomb Fk in a graph G with the split partition (C, S) is said to be settled if there exists a vertex v ∈ V (G) \ V (Fk) that is adjacent to every vertex of C and non-adjacent to every vertex of S. The following lemma describes a necessary (though in general not sufficient) condition for CIS graphs.
Lemma 2.1 (Andrade et al. [2]) If G is CIS, then every k-comb is settled and every k-anticomb is settled.
Two vertices x, y in a graph G are said to be true twins if NG[x] = NG[y]. Consider the equivalence relation ∼ defined on the vertex set of G by the rule x ∼ y

1 We denote by N the set of all (strictly) positive integers.

if and only if x and y are true twins. The true-twin reduction of G is the graph obtained from G by contracting each equivalence class of the equivalence relation
~ (which is a clique) into a single vertex. A graph is said to be true-twin-free if it coincides with its true-twin reduction. For later use, we recall the following useful property of CIS graphs (see, e.g., [2, 8]).
Lemma 2.2 A graph G is CIS if and only if the true-twin reduction of each component of G is CIS.
Next, we recall a characterization of CIS line graphs (of simple graphs) due to Boros et al. [7]. The characterization relies on the following concept related to perfect internal matchings. We say that a maximal matching M in a graph H is absorbing if every vertex not in M sees at most one edge of M , or, more formally, if for every vertex v ∈ V (H) that is not saturated by M , there exists an edge e in M such that every neighbor of v is an endpoint of e. (In particular, this implies that v is of degree at most two in H.) Note that if H has an edge, then every maximal matching that is a perfect internal matching is absorbing.
Theorem 2.3 (Boros et al. [7]) Let H be a graph without isolated vertices and let G = L(H). Then G is CIS if and only if H has no subgraph isomorphic to a bull and every maximal matching in H is absorbing.
Randomly internally matchable graphs
A graph G is randomly matchable if every matching of G can be extended to a perfect matching, or, equivalently, if every maximal matching of G is perfect. Clearly, a graph G is randomly matchable if and only if each component of G is randomly matchable. Therefore, the following theorem due to Sumner completely characterizes the randomly matchable graphs.
Theorem 3.1 (Sumner [24]) A connected graph G is randomly matchable if and only if G ∼= K2n or G ∼= Kn,n for some n ≥ 1.
The concept of perfect internal matchings naturally leads to the following generalization of randomly matchable graphs. We say that a graph G is randomly internally matchable if every matching of G can be extended to a perfect internal matching, or, equivalently, if every maximal matching of G is a perfect internal matching. Using this terminology, we note, for later use, the following consequence of Theorem 2.3.
Corollary 3.2 Let H be a triangle-free graph without isolated vertices and let G =
L(H). Then G is CIS if and only if H is randomly internally matchable.
Proof. Immediately from Theorem 2.3, using the fact that if H is triangle-free, then H has no subgraph isomorphic to a bull and a maximal matching in H is absorbing if and only if it is a perfect internal matching.	2
Clearly, a graph G is randomly internally matchable if and only if each component of G is randomly internally matchable.  In the next theorem, we

characterize the connected randomly internally matchable graphs. A leaf in a graph is a vertex of degree one. A leaf extension of a graph G is any graph obtained from G by adding for each vertex v ∈ V (G) a non-empty set Lv of pairwise non-adjacent new vertices joined to v by an edge.
Theorem 3.3 A connected graph G is randomly internally matchable if and only if G ∼= K2n for some n ≥ 1, G ∼= Kn,n for some n ≥ 1, or G is a leaf extension of some graph.
Proof. If G ∼= K2n or G ∼= Kn,n for some n ≥ 1, then G is randomly matchable and therefore also randomly internally matchable. Suppose now that G is a leaf extension of a graph Gj. Let M be a maximal matching in G and let v ∈ V (G) be an internal vertex of G. Then, v ∈ V (G ) and there exists a vertex v of degree one in G such that vvj ∈ E(G). If v is not M -saturated, then neither is vj and hence M ∪ {vv } is a matching properly containing M , contrary to the maximality of M . Therefore, v is in M and, since v and M were arbitrary, G is randomly internally matchable.
Suppose now that G is a connected randomly internally matchable graph. Clearly, G has at least two vertices and hence δ(G) ≥ 1. Suppose first that δ(G) ≥ 2. Then all vertices of G are internal and hence G is randomly matchable. By Theorem 3.1, G ∼= K2n or G ∼= Kn,n for some n ≥ 2. Suppose now that δ(G) = 1. We may assume that G has at least three vertices, since otherwise G ∼= K2 and we are done. In particular, for every leaf of G, its unique neighbor is an internal vertex. Let L denote the set of all leaves in G, let S = NG(L) denote the set of all neighbors of leaves in G, and let R = V (G) \ (L ∪ S). If R = ∅, then G is a leaf extension of G[S] and we are done. So we may assume that R /= ∅. For every s ∈ S, fix a vertex sj ∈ L adjacent to s and let MS = {ssj | s ∈ S}. Let MR be a maximal matching of the graph G[R]. Then, MR ∪ MS is a maximal matching in G. Since the set of internal vertices of G is precisely S ∪ R and G is randomly internally matchable, MR ∪ MS saturates all vertices in S ∪ R. Consequently, MR saturates all vertices in R. Since MR was an arbitrary maximal matching of G[R], we infer that G[R] is randomly matchable. In particular, every connected component of G[R] has even order. (Theorem 3.1 exactly characterizes the structure of G[R] but we will not need this characterization in the rest of the proof.) Since G is connected, it has an edge of the form rv where r ∈ R and v /∈ R. Since no vertex in R has a neighbor in L, we have v ∈ S. Then, the set M = (MS \ {vv }) ∪ {rv} is a matching in G. Extend M to a maximal matching M in G. Since G is randomly internally matchable, M saturates all vertices in S ∪ R. Let C be the component of G[R] containing r and let MC be the set of edges of M fully contained in C. By construction, every edge in M saturating a vertex in C \ {r} belongs to MC. However, this implies that C is of odd order, a contradiction with the fact that every component of G[R] has even order. This completes the proof.	2

Claw-free CIS graphs
In this section we develop a structural characterization of claw-free CIS graphs. We start with several lemmas giving necessary conditions for a claw-free graph to be a CIS graph. The gem is the graph obtained from the 4-vertex path P4 by adding to it a universal vertex.
Lemma 4.1 Let G be a claw-free CIS graph. Then G is gem-free.
Proof. Suppose for a contradiction that G is a claw-free CIS graph containing an induced copy of a gem, say on vertex set {s, t, u, v, w} where (s, t, u, v) is a path and w is adjacent to all vertices in {s, t, u, v}. Since the subgraph of G induced by
{s, t, u, v} is isomorphic to an induced 2-comb and G is CIS, Lemma 2.1 implies that there exists a vertex x ∈ V (G) \ {s, t, u, v} such that {tx, ux} ⊆ E(G) and
{sx, vx}∩ E(G) = ∅. Clearly x /= w. Furthermore, xw /∈ E(G), since otherwise
{w, s, v, x} would induce a claw in G. This implies that {s, t, u, v, w, x} induces a 3-anticomb in G. (Indeed, the complement of G contains a comb F3 having a clique {s, v, x} and a stable set {t, u, w}.) By Lemma 2.1, G contains a vertex y ∈ V (G) \ {s, t, u, v, w, x} adjacent to every vertex in the clique {t, u, w} and non-adjacent to every vertex in the stable set {s, v, x}. But now, the vertex set
{s, t, x, y} induces a claw in G, a contradiction.	2
We denote by W4 the 4-wheel, that is, the graph obtained from the 4-vertex cycle C4 by adding to it a universal vertex.
Lemma 4.2 Every connected and co-connected {claw, gem}-free graph is W4-free.
Kloks et al. showed in [19] that the class of {claw, gem, W4}-free graphs is exactly the class of dominoes, that is, graphs in which each vertex is contained in at most two maximal cliques. Furthermore, the dominoes are precisely the line graphs of triangle-free multigraphs; see also [22]. This result together with Lemmas 4.1 and 4.2 implies the following.
Corollary 4.3 Every connected and co-connected claw-free CIS graph is the line graph of a connected triangle-free multigraph.
A lemma similar to Lemma 2.2 holds for claw-free graphs. The lemma follows immediately from the definitions.
Lemma 4.4 A graph G is claw-free if and only if the true-twin reduction of each component of G is claw-free.
Lemmas 2.2 and 4.4 imply that when studying CIS claw-free graphs, we may restrict our attention to connected true-twin-free graphs. Thus, the following theorem gives a complete structural characterization of claw-free CIS graphs. Given a graph G, the corona of G (with K1) is the graph G◦K1 obtained from G by adding for each vertex v ∈ V (G) a new vertex v and making v adjacent to v. Note that the corona of G is a particular leaf extension of it.

Theorem 4.5 Let G be a connected true-twin-free claw-free graph. Then G is CIS if and only if one of the following holds:

G ∼= pK2 + qK1 for some p ≥ 0 and q ∈ {0, 1}.
G ∼= L(Kn,n) for some n ≥ 1.
G ∼= L(Gj ◦ K1) for some triangle-free graph Gj.

Proof. Let G be a connected true-twin-free CIS claw-free graph. Suppose first that G is not co-connected and let G1,..., Gk (with k ≥ 2) be the co-components of G. Since k ≥ 2 and G is claw-free, each co-component Gi has stability number at most two. Since by Lemma 4.1 G is gem-free, each co-component Gi is P4-free. Since every P4-free graph with at least two vertices is either disconnected or its complement is disconnected (see, e.g., [10]), each Gi is either K1 or is disconnected. Since α(Gi) ≤ 2, we infer each Gi is either K1 or the disjoint union of two complete graphs. Moreover, since G is true-twin-free, at most one Gi is the single-vertex graph, and each Gi with α(Gi) = 2 is isomorphic to 2K1. Consequently, G ∼= pK2 + qK1 for some p ≥ 0 and q ∈ {0, 1}.
Suppose now that G is co-connected. By Corollary 4.3 there exists a triangle-free multigraph H such that G = L(H). Clearly, we may assume that H has no isolated vertices. Since G is true-twin-free, H is a simple graph. By Corollary 3.2, H is randomly internally matchable. Theorem 3.3 implies that H ∼= Kn,n for some n ≥ 1, or H is a leaf extension of some (triangle-free) graph H . In the former case, G ∼= L(Kn,n) for some n ≥ 1. In the latter case, the fact that G is true-twin-free implies that H is the corona of Hj, that is, G ∼= L(Hj ◦ K1).
For the converse direction, suppose first that G ∼= pK2 + qK1 for some p ≥ 0 and
q ∈ {0, 1}. Since the class of CIS graphs is closed under complementation, it suffices to show that the graph pK2 + qK1 is CIS. This follows easily from the definition and Lemma 2.2. Suppose next that G ∼= L(Kn,n) for some n ≥ 1 or G ∼= L(Gj ◦ K1) for some triangle-free graph Gj. In this case, Theorem 3.3 implies that G ∼= L(H) where H is a randomly internally matchable triangle-free graph without isolated vertices. Hence, by Corollary 3.2, G is CIS.	2
Theorem 4.5 has the following structural and algorithmic consequences.
Corollary 4.6 A graph G is claw-free and CIS if and only if the true-twin reduction of each component of G is of the form pK2 + qK1 for some p ≥ 0 and q ∈ {0, 1}, L(Kn,n) for some n ≥ 1, or L(G ◦ K1) for some triangle-free graph G .
Proof. Immediate from Lemmas 2.2 and 4.4, Theorem 4.5, and the fact that all graphs of the form pK2 + qK1, L(Kn,n), or L(Gj ◦ K1) are claw-free.	2
Corollary 4.7 There is a polynomial-time algorithm for recognizing claw-free CIS graphs.

Bounding the order of CIS graphs by the product of stability and clique numbers
Answering a question of Dobson et. al
We answer the following question of Dobson et al. [12] in the negative.
Question 1 Does every CIS graph G satisfy |V (G)|≤ α(G) · ω(G)?
In fact, as we show in the next theorem, the order of CIS graphs cannot even be bounded from above by any linear function of the product α(G)ω(G).
Theorem 5.1 For every positive integer k there exists a CIS graph Gk such that
|V (Gk)| > k · α(Gk) · ω(Gk).
Proof. Kim proved in [18] that there exists a positive integer n0 such that for a√ll  n ≥ n0, there exists an n-vertex triangle-free graph Hn such that α(Hn) ≤
9 n log n. We may assume that Hn has no isolated vertices, since otherwise we can
add, as long as necessary, for each isolated vertex v, an edge joining v with some other vertex. Note that modifying Hn this way does not create any triangles, it does not change the number of vertices, and it does not increase the stability number.
For a posit√ive integer k, let nk be the smallest positive integer such that nk ≥ n0

and nk ≥ 54k  nk log nk. Let Gk be the graph obtained from Hnk by the following
two-step procedure:
First, construct a graph Hj by gluing a triangle along each edge of Hn .
k
Formally, V (Hj )= V (Hn )∪{ve : e ∈ E(Hn )} and E(Hj )= E(Hn )∪{uve : u
is an endpoint of e in Hnk }.
Second, let p = 6knk and for each vertex v ∈ V (Hn ) in the graph Hj ,
substitute pKp (the disjoint union of p copies of Kp) for v. 2 Call the resulting graph Gk.
Since Hnk is triangle-free and without isolated vertices, its maximal cliques are
its edges. It follows that the maximal cliques of Hj are the triangles consisting of
e
the two endpoints of an edge e of Hnk together with the new vertex v  associated
with that edge. In particular, every maximal clique of Hj is simplicial, and hence

the graph Hj
is CIS.

Clearly, pKp is a CIS graph. Since the class of CIS graphs is closed under substitution [2], we infer that the graph Gk is also CIS. Its clique and stability numbers can be estimated as follows:
ω(Gk)= 2p +1 ≤ 3p.
A clique in Gk of size 2p + 1 can be obtained by choosing any edge e of Hnk , taking two cliques of size p, one from each copy of pKp replacing an endpoint of e in Gk, and vertex ve. It is not difficult to see that there are no larger cliques in Gk.

2 Given two graphs G and H and a vertex x ∈ V (G), the operation of substituting H for x in G results in the graph obtained from the disjoint union of graphs G — x and H by adding all possible edges between NG(v) and V (H).

α(Gk) < 9p√nk log nk + n2.
The stability number of the graph obtained from a graph F by substituting a graph Hv into every vertex v of F equals the maximum total weight of a stable set in the graph F in which each vertex v ∈ V (F ) has weight equal to the stability number of Hv (see, e.g., [21]). Therefore, the stability number of Gk

equals the maximum total weight of a stable set in the graph Hj
in which each

vertex v ∈ V (Hnk ) has weight p and all other vertices have unit weight. Let S be a corresponding maximum-weight stable set of Hj . Writing S = Sp ∪ S1 where Sp = S∩V (Hnk ) and S1 = S\V (Hnk ), we see that the total weight of Sp is at most
p · α(Hn ), while the total weight of S1 is at most |V√(Hj ) \ V (Hn )| = |E(Hn )|.
It follows that α(Gk) ≤ p · α(Hn )+ |E(Hn )| < 9p  nk log nk + n2 , as claimed.
Consequently, we have k · α(Gk) · ω(Gk) < k · (9p · √nk log nk + n2) · 3p = p ·
√		2	2	k
27k  nk log nk · p + 3knk	≤ p · (pnk/2√+ pnk/2) = p nk < |V (Gk)|, where the
second inequality follows from nk ≥ 54k  nk log nk and p = 6knk, and the last one
from |V (Gk)| = p2nk + |E(Hn )|. This completes the proof.	2

A positive answer for claw-free graphs
In order to show that Question 1 has a positive answer for claw-free CIS graphs, we first show a property of weighted randomly internally matchable graphs, which follows easily from the characterization of randomly internally matchable graphs given by Theorem 3.3. For this we need some definitions.
Given a weighted graph (H, w) and a set X  E(H), we denote by w(X) the total weight of edges in X, that is, w(X)= Σe∈X w(e). Given a vertex v ∈ V , we denote by E(v) the set of all edges having v as endpoint, and define its weighted
degree as dw(v) = Σe∈E(v) w(e). We denote by Δw(H) the maximum weighted
degree of a vertex in H. The maximum size of a matching in a graph H is its matching number, denoted by ν(H). A maximum matching in H is a matching of a size ν(H).
Lemma 5.2 Let (H, w) be a weighted graph such that H is a connected randomly internally matchable graph. Then w(E(H)) ≤ Δw(H) · ν(H) .
Proof. By Theorem 3.3, H satisfies one of the following conditions: (i) H ∼= K2n for some n ≥ 1, (ii) H ∼= Kn,n for some n ≥ 1, or (iii) H is a leaf extension of some n-vertex graph H . It is not difficult to see that in either case, the matching number of H equals n. Hence, we want to show the inequality w(E(H)) ≤ n · Δw(H). If H ∼= K2n, then 2w(E(H)) =  x∈V (H) w(E(x)) ≤ 2n · Δw(H). If H ∼= Kn,n, witha bipartition {X, Y }, then w(E(H)) = x∈X w(E(x)) ≤ n · Δw(H). Finally, if H is a leaf extension of some n-vertex graph H , then w(E(H)) ≤ x∈V (H′) w(E(x)) ≤ n · Δw(H). Thus, in either case, the desired inequality holds.	2
From Lemma 5.2 we derive one more intermediate lemma.
Lemma 5.3 Let H be a connected triangle-free multigraph and let G = L(H). If
G is CIS, then |V (G)|≤ α(G) · ω(G).

Proof. Let (H, w) be a weighted graph such that H is a connected triangle-free graph, and assume that G = L(H, w) is CIS (cf. Section 2.1). Let Gj = L(H) be the usual line graph of H. It is not difficult to see that G can be obtained from Gj by substituting, for each vertex v  V (Gj), a clique of size w(ev) where ev is the edge of H corresponding to v. Since G is CIS if and only if Gj is CIS (see, e.g., [8]), we infer that Gj is CIS. By Corollary 3.2, H is randomly internally matchable. Since H is connected, Lemma 5.2 implies that w(E(H)) ≤ Δw(H) · ν(H).
Clearly, the stability number of G is given as α(G)= α(L(H, w)) = α(L(H)) = ν(H). Moreover, the clique number of G is the maximum weight of a clique in L(H) with respect to the weight function assigning to each vertex v ∈ L(H) weight w(ev), where ev is the edge of H corresponding to v. Since H is triangle-free, every clique in L(H) corresponds to a set of edges in H witha fixed common endpoint. It follows that the clique number of G equals the maximum weighted degree Δw(H). Since also |V (G)| = w(E(H)), the inequality w(E(H)) ≤ Δw(H) · ν(H) implies that
|V (G)|≤ α(G) · ω(G), as claimed.	2
Theorem 5.4 If G is a CIS claw-free graph, then |V (G)|≤ α(G) · ω(G).
Proof. Suppose for a contradiction that the theorem fails and let G be a counterexample with the smallest possible number of vertices. That is, G is a claw-free CIS graph such that |V (G)| > α(G) · ω(G), but every smaller claw-free CIS graph Gj satisfies |V (Gj)|≤ α(Gj) · ω(Gj).
First we show that G is connected. Suppose not, and let G be the disjoint union of two graphs G1 and G2. Then each of G1 and G2 is a smaller claw-free CIS graph, therefore |V (Gi)|≤ α(Gi) · ω(Gi) holds for i ∈ {1, 2} by the minimality of G. We have ω(G) = max{ω(G1), ω(G2)}. Without loss of generality we may assume that ω(G)= ω(G1) ≥ ω(G2). We thus have |V (G)| = |V (G1)| + |V (G2)| ≤ α(G1) · ω(G1)+ α(G2) · ω(G2) ≤ (α(G1)+ α(G2)) · ω(G1)= α(G) · ω(G). Hence, G
is not a counterexample. This contradiction shows that G is connected.
Next, we show that G is co-connected. If not, then G is the disjoint union of two smaller graphs H1 and H2. Since G is CIS, we have that both H1 and H2 are CIS. Therefore H1 and H2 are CIS claw-free graphs of smaller order than G, which implies |V (Hi)| ≤ α(Hi) · ω(Hi) for i ∈ {1, 2}. Similar arguments as above show that |V (G)| = |V (H1)| + |V (H2)| ≤ α(G) · ω(G) = α(G) · ω(G), a contradiction. Thus, G is co-connected.
Now, since G is a connected and co-connected claw-free CIS graph, Corollary 4.3 implies that G is the line graph of a connected triangle-free multigraph. By Lemma 5.3, we have |V (G)|≤ α(G)·ω(G), implying that G is not a counterexample. This contradiction completes the proof.	2

An open question
Question 1 has been answered in the negative. The following relaxation of it is still open.

Question 2 Is there an integer k such that every CIS graph G satisﬁes |V (G)| ≤ 
(α(G) · ω(G))k?
A graph class G is said to satisfy the Erd˝os-Hajnal property if there exists some ε > 0 such that max{α(G), ω(G)} ≥ |V (G)|ε holds for all graphs G ∈ G. The well-known Erd˝os-Hajnal Conjecture [13] asks whether for every graph F , the class of F -free graphs has the Erd˝os-Hajnal property. The conjecture is still open (see [9] for a survey). It is not difficult to see that, using this terminology, Question 2 can be equivalently phrased as follows.
Question 3 Does the class of CIS graphs have the Erd˝os-Hajnal property?
Note, however, that it is possible that Question 3 bears only superficial resemblance with the Erd˝os-Hajnal Conjecture. This is because every graph is an induced subgraph of a CIS graph (see, e.g., [2]); furthermore, for a graph F , the class of F -free graphs is a subclass of the class of CIS graphs if and only if F is an induced subgraph of P4. It is thus in principle possible that the Erd˝os-Hajnal Conjecture is true, while Question 3 has a negative answer, or vice versa.
Acknowledgement
The authors are grateful to Nevena Pivaˇc for helpful discussions and comments on an early version of this work. The work of the third author is supported in part by the Slovenian Research Agency (I0-0035, research program P1-0285 and research projects N1-0032, J1-7051, J1-9110). Part of the work for this paper was done in the framework of a bilateral project between Argentina and Slovenia, partially financed by the Slovenian Research Agency (BI-AR/15–17–009).

References
Andrade, D. V., E. Boros and V. Gurvich, Not complementary connected and not CIS d-graphs form weakly monotone families, Discrete Math. 310 (2010), pp. 1089–1096.
Andrade, D. V., E. Boros and V. Gurvich, On graphs whose maximal cliques and stable sets intersect, in:
B. Goldengorin, editor, Optimization Problems in Graph Theory: In Honor of Gregory Z. Gutin’s 60th Birthday, Springer International Publishing, Cham, 2018 pp. 3–63, see also RRR 17-2006, RUTCOR Research Reports, Rutgers University.
Bartha, M. and E. Gomba´s, A structure theorem for maximum internal matchings in graphs, Information Processing Letters 40 (1991), pp. 289–294.
Bartha, M. and M. Kr´esz, Tutte type theorems for graphs having a perfect internal matching, Information Processing Letters 91 (2004), pp. 277–284.
Bartha, M. and M. Kr´esz, Deciding the deterministic property for soliton graphs, Ars Mathematica Contemporanea 2 (2009), pp. 121–136.
Boros, E., N. Chiarelli and M. Milaniˇc, Equistarable bipartite graphs, Discrete Math. 339 (2016),
pp. 1960–1969.
Boros, E., V. Gurvich and M. Milaniˇc, On equistable, split, CIS, and related classes of graphs, Discrete Appl. Math. 216 (2017), pp. 47–66.
Boros, E., V. Gurvich and M. Milaniˇc, On CIS circulants, Discrete Math. 318 (2014), pp. 78–95.
Chudnovsky, M., The Erd¨os-Hajnal conjecture—a survey, J. Graph Theory 75 (2014), pp. 178–190.

Corneil, D. G., H. Lerchs and L. S. Burlingham, Complement reducible graphs, Discrete Appl. Math. 3
(1981), pp. 163–174.
Deng, X., G. Li and W. Zang, Proof of Chv´atal’s conjecture on maximal stable sets and maximal cliques in graphs, J. Combin. Theory Ser. B 91 (2004), pp. 301–325.
Dobson, E., A. Hujdurovi´c, M. Milaniˇc and G. Verret, Vertex-transitive CIS graphs, European J. Combin. 44 (2015), pp. 87–98.
Erdos, P. and A. Hajnal, Ramsey-type theorems, Discrete Appl. Math. 25 (1989), pp. 37–52, combinatorics and complexity (Chicago, IL, 1987).
Gurvich, V., Decomposing complete edge-chromatic graphs and hypergraphs. Revisited, Discrete Appl. Math. 157 (2009), pp. 3069–3085.
Hujdurovi´c, A., Strong cliques in vertex-transitive graphs (2018), arXiv:1808.09534 [math.CO].
Hujdurovi´c, A., M. Milaniˇc and B. Ries, Detecting strong cliques (2018), arXiv:1808.08817 [math.CO].
Hujdurovi´c, A., M. Milaniˇc and B. Ries, Graphs vertex-partitionable into strong cliques, Discrete Math.
341 (2018), pp. 1392–1405.
Kim, J. H., The Ramsey number R(3, t) has order of magnitude t2/ log t, Random Structures Algorithms
7 (1995), pp. 173–207.
Kloks, T., D. Kratsch and H. Mu¨ller, Dominoes, in: Graph-theoretic concepts in computer science (Herrsching, 1994), Lecture Notes in Comput. Sci. 903, Springer, Berlin, 1995 pp. 106–120.
Lovasz, L., A characterization of perfect graphs, J. Combinatorial Theory Ser. B 13 (1972), pp. 95–98.
Lozin, V. V. and M. Milaniˇc, A polynomial algorithm to find an independent set of maximum weight in a fork-free graph, J. Discrete Algorithms 6 (2008), pp. 595–604.
Metelsky, Y. and R. Tyshkevich, Line graphs of Helly hypergraphs, SIAM J. Discrete Math. 16 (2003),
pp. 438–448.
Milaniˇc, M. and N. Trotignon, Equistarable graphs and counterexamples to three conjectures on equistable graphs, J. Graph Theory 84 (2017), pp. 536–551.
Sumner, D. P., Randomly matchable graphs, J. Graph Theory 3 (1979), pp. 183–186.
Sun, J. and Z.-q. Hu, Proof of Ding’s conjecture on maximal stable sets and maximal cliques in planar graphs, Acta Math. Appl. Sin. Engl. Ser. 26 (2010), pp. 473–480.
West, D. B., “Introduction to Graph Theory,” Prentice Hall, Inc., Upper Saddle River, NJ, 1996.
Zang, W., Generalizations of Grillet’s theorem on maximal stable sets and maximal cliques in graphs, Discrete Math. 143 (1995), pp. 259–268.
Zverovich, I. and I. Zverovich, Bipartite bihypergraphs: a survey and new results, Discrete Math. 306
(2006), pp. 801–811.
