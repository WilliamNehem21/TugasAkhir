The need for anonymous communication on networks is becoming increasingly pressing, and with the widespread commercial use of onion routing, such safety seems within reach. Tor, a descendant of the Onion Router project, is an established network with around two thousand nodes and several hundred thousand users. It operates using heavily encrypted data layers and sends this information through a series of relay nodes, each decrypting a layer without revealing the ultimate destination. Recent growth in Tor usage has led to various salient attacks.

To enhance Tor's performance and anonymity, researchers have developed a method called novel traffic dividing and scheduling (NTDS), which splits traffic based on metrics like throughput and congestion and allocates it across different circuits. This approach can thwart some sniper attacks but falls short against more sophisticated protocol-level attacks that exploit system vulnerabilities or bugs to compromise user connections.

Protocol-level attacks often involve malicious nodes manipulating data packets to deplete resources or confirm communication between users (like Alice and Bob) by controlling entry and exit nodes in the Tor network. Such attacks alter data traffic to cause recognizable errors at the exit node, confirming the compromised path.

This paper introduces a new defensive mechanism named MIDDrrQ designed to counter protocol-level attacks in Tor. It involves using indistinguishability obfuscation to generate indistinct fake traffic at intermediate relays and applies the deficit round robin (DRR) queuing method to effectively manage outgoing connections, thereby enhancing security while minimizing additional delays.

Indistinguishability obfuscation ensures that an adversary cannot distinguish between the obfuscated versions of two similar programs, P1 and P2, based on their execution, even though the two may differ slightly. In queuing, the DRR algorithm assigns credits to manage data packet transfer and balance flow fairness, reducing the complexity and delay associated with standard queuing models.

The paper compares the efficiency of this new mechanism with NTDS and other existing measures using a network simulator. The simulation deployed 100 nodes, including designated malicious ones, to assess various metrics such as packet delivery rate, bandwidth, and the probability of choosing a compromised route. These evaluations demonstrate the superior performance of the proposed MIDDrrQ mechanism in defending against protocol-level attacks in the Tor network and ensuring better anonymity and reduced latency.