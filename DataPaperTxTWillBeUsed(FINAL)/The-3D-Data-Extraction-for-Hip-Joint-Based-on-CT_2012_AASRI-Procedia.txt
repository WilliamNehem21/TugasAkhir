Available online at www.sciencedirect.com



AASRI Procedia 1 (2012) 293 – 298
AASRI
Procedia
www.elsevier.com/locate/procedia





2012 AASRI Conference on Computational Intelligence and Bioinformatics
The 3D Data Extraction for Hip Joint Based on CT
Luo Sandinga,*, Zou Zhenga, Chen Yuanbinga, Liu Qianlana
College of Information Science and Engineering, Central South University, Changsha 410083, China



Abstract

The 3D data can be extracted by measuring healthy hip joint, which is the basis of making proper artificial hip conform to right physiological characteristics. In this paper, firstly, we use adaptive windows directed by neighbouring CT slices for reducing ranges of searching. Secondly, a method based on 2D contour characteristic points matching in multilayer is proposed to effectively correct contours. Thirdly, according to complexity in the primary contours, location and fitting quasi-circular contours femur head with circle are used to adjust contours of femur head. Finally, a projecting method based on distance transform has been used for locating key points of hip joint such as intersection of head and neck, which meets anatomy features, can obtain effective and efficient 3D data. In fact, experiment in this paper shows that the method in paper can accurately extract 3D data on proximal femur in CT Series Images.

© 2012 Published by Elsevier B.V. Open access under CC BY-NC-ND license.
Selection and/or peer review under responsibility of American Applied Science Research Institute

Keywords: Hip Joint; CT images Process; 3D data extraction


Introduction

Hip joint consists of femur head, neck and backbone. Femur head is the round end between femur and pelvic bone, surrounding by muscles. It looks like circularity in appearance. Femur neck is smaller which connects femur head and femur backbone. Femur below femur neck appears tubular. In order to make artificial hip fit the biological and physical characteristics, and matching the structure of acetabular bone better,



* Luo Sanding. Tel.: +86-13187066098.
E-mail address: sdluo88@gmail.com.







2212-6716 © 2012 Published by Elsevier Ltd. Open access under CC BY-NC-ND license.
doi:10.1016/j.aasri.2012.06.045


it is necessary to fully understand the pattern of hip joint. Extracting some information from hip surface is the foundation and basis of making artificial hip fit patients.
Extracting hip contour is the premise of 3D data extracting. The segmentation of bones is difficult because of the irregular physiology bones structure, fuzziness of the contour line caused by conjunction of femur head and acetabular bone, low contrast and noise etc. No-seed region segmentation is employed in [1], this method is very useful since there are some holes in the region which can be ignored, but it depends on initial value too much. Non parameter Level Set method for image segmentation which proposed in [2] has great adaptability for images with low contrast, however it is complicated to calculate. In [3] the solution is introduced that extracting the dental contours from frame to frame with region growing method combined with radial line method. The new solution can get good segmentation if quasi circular bone parameters are fixed and interactive input is specific, but it seems not adaptive enough to resolve quasi circular femur segmentation with flexible radius, so its level of automation is not high.
In view of the shortcomings of the former study, the paper proposes a method which extracts data based on associated interframe tracing based on interlayer pilot 2D contour characteristic combined with bidirectional contour information fusion, then it can quickly extract accurate 3D data on the femur surface.

Primary Contours Extraction

Some processes of original images based on gray level and border are useful to reduce the noises and errors that produced by shape mutations of bones.

Primary contour determination

The border tracking method [4] is improved to get primary contours, through searching clockwise the border of bone continuously till coming back to beginning position, then recording the subsequence of border points, combined to internal or external situation against border can determine border. However, this method gets more than one external border in a slice. Considering area occupied by required bone is bigger than other bones in ROI, we can pick the right border with calculating the biggest area as the primary contour. Meanwhile, by normalizing the contour point information, the 2-dimensional position data can be reduced to 1-dimensional one.

Determining Series Contours With Interframe Tracing Method

Interframe tracing method processes slices from bottom to up, it make all use of similarity between slices, employing the previous frame to conduct current frame how to update its contours to get an accurate result.

Determining adaptive window

Adaptive window can be used for reducing analysis range of current frame image, because the contour in current contour must be close to contour in previous frame. In order to get the adaptive window, the detail is this as followed.
Construct a border rectangle Rb according to all contour points boundary extreme values in previous frame.
Expand n pixels in the border rectangle Rb along each direction respectively (n is the maximum possible difference value in neighboring frames), and it forms contour which surrounds the border rectangle Rb in current frame. Data analysis in current frame will be focus on this area.


For improving the accuracy of post analysis, integral image interpolation operation will be used in the border rectangle Rb for three times.
Determining edge points with characteristic matching

The shell of bone is compact while core of bone is loose, and part bone edges are low contrast in some slices, then it results in trench curves among bone edges in Fig 1(c). To remove trench curve, matching contour points in two neighboring frame and finding all the matching points in current frame, examine length of neighboring matching points to decide whether neighbouring matching edge points should be adjusted.
Aligning initial contour points in neighboring frames, suppose current contour is Pi , previous contour is Pi 1 .

Pick evenly N points in Pi 1
, point K j
is a even point in
Pi 1
(0  j  N ) , suppose  there are M event

points in Pi  search minimum distance D with Two Searching Method

D  min{dis(Kt  K j )}(0  j  N,0  t  M)	(1)


Among that, dis(Kt  K j ) is the distance between contour point Kt and K j , if there exists a point Kt
which

i	i 1	i	i 1	i
can get the most minimum distance with K j , Kt is a matching point of K j .
i 1	i	i 1






(a)	(b)	(c)	(d) Fig. 1. (a) original image of frame i; (b) contour of frame i-1; (c) contour of frame i; (d) adjusted contour of frame i

Get all the matching points K j in P , if the length of neighboring matching points is longer than its length
i	i
of even part divide by N, edge points between neighboring matching points should be removed and updated by a line, adjusted contour can be seen in Fig 1(d).


dis(K j1  K j )  d  (d	 length(P) N)
(2)

i	i	ave  ave	i

Among that, dave is the even length of Pi ,  is coefficient determine length range, generally  >1.

Adjusting femur head contours

(a)	(b)

Fig. 2. (a) cutaway view for bone; (b) series contour projection on XZ plane


The first step for adjusting is finding the frame range of femur head. In Fig 2(a), which is a cutaway view for bone, and there exists characters that the line link from top greater trochanter to bottom femur head is horizontal. The position is marked in Fig 2 as Kb , and contour areas change greatly form frame Kb to Kb 1 , we can get Kb through find the biggest difference of contours between neighboring frames. In Fig 2(b) Ke is where femur head disappears, and it is an image projecting on XZ plane. In the top of head, horizontal
distance is smallest, then it is easy to get Ke , and Km is where the center of head lies, due to the contour in
Km appears close to circle, in frame Km contour has a biggest circle area. The second step is fitting the contour
from frame Kb to Ke update the center of contour in every frame, which is helpful for removing interferent.

Locating Key Points

As long as position of head-neck intersection is ensured, other 3D data can be ensured, so head-neck intersection is very important. In order to meet the anatomy features for intersection, a projecting method based on distance transform has been used for locating key points.

Determining section

We cut the whole bone from top to bottom vertically, which make the section basically lie at the axile line. Due to section is vertical to XY plane, section depend on cut line on the top of bone. In order to find right cut line which evenly cut whole bone, we project all contours in all frames to XY plane as Fig 3(a).
		
(a)	(b)	(c) Fig. 3. (a) projecting contour; (b) cut line in external contour; (c) vertical section
In Fig 3, the projecting contours can form a series of interlaced contour lines, and border tracking method is
employed to find the enclosed external contour line P of projecting contours in Fig 3(b). Point PL and PR on

P divide P into two parts ,and S1 and S2
are separately their area,when S1  S2 , the line linked by PL
and

PR is the right cut line,then L can cut every contour in every frame and form two intersections, eventually ,
all intersections can get a vertical section F as Fig 3(c).

Locating head-neck intersection

Considering head-neck intersection lies in corner of femur a a method based on distance transform in four neighborhoods is used to process the section F , and steps are like this.
Fill the section F with horizontal lines.
Set initial gray in area out of border F to 0, while initial gray in section F is 255.
Current point gray is Vij , compare gray between left neighborhood and up neighborhood to get minimum gray to update current point gray.


Vij  min(Vi 1, j ,Vi 1, j 1) 1
(3)


Compare gray between right neighborhood and down neighborhood to get minimum gray to update current point gray.


Vij  min(Vi, j 1,Vi 1, j 1) 1
(4)



Finally, there exists a point Pmax
which has a maximum in bone corner, seeing Fig 4(a).









(a)	(b)

Fig. 4. (a) intersection with distance transform; (b) head-neck angles

After getting head-neck intersection, femur head center is easier obtained. In fact, head centre can get from frame Km , then we can see from Fig 4(b), Ph is head centre, and Pn is head-neck intersection, combined with centre of bottom backbone forms a head-neck angle, which is widely used to diagnose whether the patient’s hip is deformed.

Experiment And Results

In this experiment, there are some hip joint CT series scanning images from male subjects (512  512 pixel, interlayer distance is 1mm, pixel distance is 0.78125mm). Choose 5 groups of images randomly for detecting of left side and right side in hip. Compared with manual segmentation results, the results of automatic head- neck angle detection (demonstrate in table 1) are evaluated by objective different degree O . It is defined as in (5).


O  AM  AD
M 100%
(5)


Table 1. Estimating objective different degree with head-neck angle

From Table 1 above, we can see that most of subjects’ objective different degrees are less than 1.0, and results are stable, which indicates that the automatic segmentation results are coincide with manual ones. The


main reason for results more than 1.0 in fifth groups is backbone length, which can be calculated from CT slices, if length below lesser trochanter is less than 5cm, backbone has a deflection between extracted backbone and vertical plane, which result in the inaccurate center of the bottom backbone.

Conclusion

In this paper, an automatic and effective method for hip segmentation and data extraction is proposed. We employ bottom-to-top strategy to process serial images. Meanwhile, this paper also introduces an associated interframe tracing method, and makes full use of contour in known slices to analyze contour of subsequent slices with interframe correlation, and avoid the interference of other contours, improve speed of obtaining. In order to locating head-neck intersection with projecting method based on distance transform, which meets anatomy features, can obtain effective and efficient 3D data. Compared with manual segmentation, the method can segment proximal surface of hip join femur accurately, and prepare a good basis for later study on characteristics of proximal femur.


References
Liao Shenghui, Xu Duanging, Dong Jinxiang. Image Segmentation and Contour Correspondence and Branching Problem in Human Mandible ReconstructionJOURNAL OF COMPUTER-AIDED DESIGN COMPUTER GRAPHICS 2004, 16(9): 1225-1230.
Sokratis Makrogiannis, Rahul Bhotika,James V.Miller. Nonparametric Intensity Priors for Level Set Segmentation of Low Contrast Structures[C].MICCAI 2009,PART 1,LNCS 5761:230-238.
Zhang Fei,Fan Yubo, Pu Fang, Liu Zhan,“A Semi-automatic Method for Tooth Segmentation in Dental CT Images,“ J Biomed Eng, vol. 24, Feb. 2007, pp: 15-18.
Chang Chun, Jen Chen, Chi Jen Lu. A Linear Time Component Labeling Algorithm using Contour Tracing Technique[J].Computer Vision and Image Understanding,2004,93(2):206-220.
Zhang Huizhang. “Research on Image Understanding Based on Visual Perception,” Northwestern Polytechnical University, Nov.2003.
