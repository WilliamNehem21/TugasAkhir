Available online at www.sciencedirect.com
ScienceDirect

AASRI Procedia 4 (2013) 96 – 103


2013 AASRI Conference on Intelligent Systems and Control 2013

A Lyapunov-based Adaptive Control Law for an Electromagnetic Actuator
Paolo Mercorelli
Leuphana University of Lueneburg Institute of Product and Process Innovation Volgershall 1, D-21339 Lueneburg, Germany
Tel.: +49-(0)4131-677-5571, Fax: +49-(0)4131-677-5300
mercorelli@uni.leuphana.de



Abstract
Electromagnetic devices in industrial systems are utilised for problems of positioning and tracking control. A direct adaptive non-linear control framework for a non-linear electromagnetic actuator is presented in this paper. Starting from a Lyapunov approach a continuous control law is calculated for the actuator. After that, an approximated sampled final control law is proposed. The resulting control strategy is an adaptive one in which the main parameter depends on the variable inductance of the actuator itself. This aspect seems to be important to prevent saturation during the control phase.

© 2013 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license.
Selection and/or peer review under responsibility of American Applied Science Research Institute
Keywords:
Actuators; adaptive control; Lyapunov approach

Introduction and motivation
With the recent rapid progress in permanent-magnet technology, very compact and high-performance electromagnetic linear actuators are already available in a wide range of applications. They open new possibilities for high-force motion control in mechatronic applications. Recent contributions are given in this direction in [1] and in [2] where different electromagnetic actuators are presented together with most of their important control problems. In particular, control and optimal trajectory generation are analyzed. In [3] and in [4] an electromagnetic actuator and its sensorless control using Kalman Filter are presented. In industrial systems, mechanical and/or hydraulic-mechanical components have been often replaced by electromagnetic ones, see [5] and [6]. One of the most utilized kinds of actuator is the linear electromagnetic one. There are, beside linear electromagnetic actuators, other types of electromagnetic actuators with different advantages, corporations, such as BMW [7], GM [8], DaimlerChrysler AG [9], Renault [10] and Siemens [5, 11] have based their prototype developments on the electromagnetic actuator design. A typical set-up for this kind of electromagnetic valve actuator, see the left side of Fig. 1, is equipped with two electromagnets and two springs and a moving armature. The upper coil is responsible for the closing phase and the lower coil is


2212-6716 © 2013 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license. Selection and/or peer review under responsibility of American Applied Science Research Institute doi:10.1016/j.aasri.2013.10.016


	



Fig. 1. Left: Valve actuator cross-sections. Right: Half valve actuator cross-sections



responsible for the opening phase of the valve. Since the inductance depends on the air gab between the armature and the pole, the magnetic force is very sensitive to the variation of the air gap. The force increases in a non-linear relation with respect to the air gap. Because of that, the input voltage should change very fast to compensate these force variations. In this paper a direct adaptive non-linear control framework for a non-linear electromagnetic actuator is proposed in which, starting from a Lyapunov approach, a continuous control law is derived for the actuator. After that, an approximated sampled final control law is proposed. The resulting control strategy is an adaptive one in which the main parameter depends on the variable inductance of the actuator itself. This aspect seems to be important to prevent saturation during the control phase. The proposed control law seems to be suitable to avoid rapid changes in the input voltage which can generate saturation. In fact, the proposed control law compensates this variability effect of the inductance due to the movement of the armature using basically a cancelation. The paper is organised in the following way. Section 2 is devoted to the model description of the considered actuator. Section 3 proposes an analysis to derive the control law. Conclusions and future work close the paper.

Model description
In Fig. 2 the scheme of the magnetic circuit is drawn. State vector x(t) = [i(t), s(t), v(t)] and input uin(t) are taken under consideration for the representation of the system. Current i(t), armature position s(t), velocity v(t) and input voltage by uin(t) are the state variables. The dynamics of the electrical part of the actuator is the following:


Considering that:
uin(t) − Rcui(t) − uq(t)= 0.	(1)

ΦCoil(t)= L(t)i(t),	(2)

with ΦCoil(t) the magnetic flux is indicated. The induced voltage is:


uq(t)= 
∂L(t)


∂t

i(t)+ L(t)
∂i(t)


∂t

.	(3)

Inserting equation (3) into (1) the following expression is obtained:

∂i(t) =  1  u

(t) − R
i(t) − ∂L(t) i(t) ,	(4)

∂t	L(t)	in	cu	∂t


where i(t) is the current, u(t) is the supply voltage, Rcu is the resistance and L indicates the inductance. Inductance L depends on current i(t) and on distance s(t). The mechanical dynamics are represented by:


∂s(t)


∂t
=  v(t)	(5)

∂v(t)

=	 1  − k
s(t)+ F
(t) − k v(t)+ d(t) .	(6)

From [12] and considering the hypothesis of a uniformly distributed flux, the following expression for the magnetic force is obtained:

i 2 (t )N 2
Fin(t)= R2(s(t))A
.	(7)
μ0

M is the mass of the armature, kf is the constant which characterizes the spring, AF e1 the magnetic pole cross-sectional area, N is the number of the windings of the coils, kv is the friction coefficient, d(t) repre- sents the force acting against the cylinder because of the burning phase of the engine. μ0 is the magnetic air permeability and R is the magnetic reluctance from the air gap point of view. The parameters kf and kv are considered constant here. In the right part of Fig. 2 a polynomial approximation of the inductance as a function of the valve position is shown.


ΘCoil

0.7


0.6



RmF e1
2
ΦCoil ΦAir
RmAir
2
RmF e1
2





RmAir
2
0.5

0.4

0.3

0.2

0.1




RmFe2
0
0	2	4	6	8	10	12
Valve position (mm)




Fig. 2. Left: Magnetic equivalent circuit of the actuator. Right: Polynomial approximation of the inductance as a function of the valve position.

It holds:
ΘCoil = i(t)N,	(8)


ΦCoil
 ΘCoil 
=	.	(9)
Rm

Moreover it is possible to write that:
sum




Rmsum = RmHe1 + Rmp ,	(10)

where RmFe1 represents the ferromagnetic pole reluctance and

R	=  Rmσ (RmFe2 + RmAir )

(11)

mp	Rm
+ Rm

Fe2
+ Rm

Air


is the parallel reluctance. In (11), Rmσ is the reluctance related to the leakage flux and RmFe2 is the armature magnetic reluctance.
Moreover,


RmFe1

	AFe1	
μ(HFe1 )AFe1


Fe2

	AFe2	
μ(H Fe2 )AFe2

where μ = BFe1 , lF e1 is the ferromagnetic pole length, μ = BFe2 , lF e2 is the armature length and AF e2 is

HFe1
its cross-section.
In addition,




RAir




 2s(t) 	R
0 Fe1	σ
HFe2



RmFe2 RAir

k0 s(t)

where ko is a constant. Through mathematical calculations, the following expression is obtained:


Φ =Φ 

  (RmFe2 + RmAir )	

(12)


and
σ	coil Rm


+ Rm

Fe2
+ Rm

Air

Φ	=Φ 
	Rmσ	 .	(13)

Air
coil Rm
+ Rm

Fe2
+ Rm

air

The reluctance from the air gap point of view can be calculated as follows:
R = (Rmσ + RmFe2 + RmAir )Rmsum .	(14)
Rmσ

The uniform magnetic density fluxes are calculated in the following way:
BFe1 = ΦCoil ,  BFe2 = ΦAir ,  BAir = ΦAir .	(15)

AFe1
AFe2
AFe1

Note that the reluctance RmAir and Rmσ are strongly dependent on the armature position.

An adaptive Lyapunov Based Controller
It is known that inductance L(t) depends on position s(t), and thus starting from equations (4)–(6) the following differential equations are obtained:

∂i(t)
∂t
=	  1	 u
L(s(t))	in

(t) − Rcu
+ ∂L(t) i(t)	(16)
∂t

∂L(t)


∂L(t) ∂s(t)
=
(17)

∂t
∂s(t)
∂s(t)  ∂t

=  v(t)	(18)
∂t

∂v(t)
∂t
=	 1	− k
M	f
s(t)+ Fin
(t) − kvv(t)+ d(t) .	(19)

The system represented by equations (16)–(19) can be represented as follows:

⎡


x˙ (t)= ⎢⎢

∂i(t)
∂t
∂L(t)
∂t
∂s(t)
∂t
∂v(t)

∂t
⎤


⎥⎥ = f (x(t)) + g(x(t))uin(t)+ Dd(t)	(20)



with fields

⎡ −   1	 Rcui(t)+ ∂L(t) i(t)  ⎤

⎡   1	 ⎤	⎡	⎤


f (x(t)) =
⎢⎢⎣
L(s(t))
∂t
∂L(t)
∂s(t)
v(t)
⎥⎥⎦

, g(x)= ⎢⎣
L(s(t))
0
0
0
⎥⎦ ,  D = ⎢⎣ 0
⎥⎦ .	(21)

 1 − kf
s(t)+ Fin
(t) − kvv(t)	M

If the following controller is defined:


K(t)= G xd(t) − x(t) ,	(22)

where G =	Pi	0 Ps	Pv , in which Pi, Ps and Pv are constant to be set. xd(t) represents the vector of the desired state variables of the actuator. Equation (22) becomes as follows:
⎡ id(t) − i(t) ⎤

K(t)= Pi
0 Ps
P  ⎢ Ld(t) − L(t) ⎥
(23)

sd(t) − s(t)
vd(t) − v(t)
with Pi, Ps and Pv are the parameters of the controller. If the following Lyapunov function is defined:
K2(t)


then it follows that:
V (K)= 
,	(24)
2

V˙ (K)= K(t)K˙ (t).	(25)
To find the stability condition of solution K(t)= 0, the following Lyapunov function is considered:
V˙ (K)= −η(t)K2(t),	(26)
with η > 0. Comparing (25) with (26), the following relation is obtained:
K(t)K˙ (t)= −ηK2(t),	(27)

and to conclude it follows that:

K(t) K˙ (t)+ ηK(t) = 0.	(28)

The constructive solution is obtained using the following condition:
K˙ (t)+ ηK(t)= 0.	(29)

From (22) it follows:

K˙ (t)= G x˙ d(t) − x˙ (t) = Gx˙ d(t) − Gx˙ (t).	(30)

The basic idea is to calculate a ueq(t), an equivalent input, and after that a uin(t), such that x˙ (t) = x˙ d(t). For that, from (20), if d(t)= 0, then:
x˙ (t)= x˙ d(t)= f (xd(t)) + g(xd(t))uin(t),	(31)
and from (30) it follows:
K˙ (t)= Gx˙ d(t) − Gf (xd(t)) − Gg(xd(t))uin(t)= Gg(xd(t)) ueq(t) − uin(t) ,	(32) where ueq(t) is the equivalent input and it follows that:
ueq(t)= Gg(xd(t)) −1G x˙ d(t) − f (xd(t)) .	(33)


After inserting (32) into (29) the following relation is obtained:
Gg(xd(t)) ueq(t) − uin(t) + ηK(t)= 0,	(34)

and in particular



uin

(t) = ueq

(t) + Gg(x (t)) −1ηK(t).	(35)

Normally, calculating ueq(t) could be difficult. Using Euler approximation, equation (32) can be rewritten in a discrete form as:

K((k + 1)Ts) − K(kTs) = Gg(x (t)) u

(kT ) − u

(kT ) .	(36)

Ts	d
eq	s
in	s

Considering Euler approximation for equation (35), the following equation is obtained:

u  (kT )= u
(kT )+ Gg(x (t)) −1ηK(kT ).	(37)

Equation (36) can be also rewritten as:


u  (kT )= u
(kT )+ Gg(x (t)) −1 K((k + 1)Ts) − K(kTs) .	(38)

eq	s
in	s	d	Ts

Equation (38) is equivalent to:
u ((k − 1)T )= u  ((k − 1)T )+ Gg(x (t)) −1 K(kTs) − K((k − 1)Ts) .	(39)
eq	s	in	s	d	Ts
Because of ueq(t) is a continuous function, then:
ueq(kTs) ≈ ueq((k − 1)Ts).	(40)
Considering equation (40), then equation (39) becomes:
u (kT )= u  ((k − 1)T )+ Gg(x (t)) −1 K(kTs) − K((k − 1)Ts) .	(41)
eq	s	in	s	d	Ts
Inserting (41) into (37):
u  (kT )= u  ((k − 1)T )+ Gg(x (t)) −1 ηK(kT )+ K(kTs) − K((k − 1)Ts) ,	(42)

in	s	in	s	d

and finally:
s	Ts

u  (kT )= u
((k − 1)T )+ Gg(x (t))T −1 ηT K(kT )+ K(kT ) − K((k − 1)T ) .	(43)

Remark 1. It is to notice that Gg(x (t))T −1 = L(s(t)) . Factor Gg(x (t))T −1 represents the main
weight of the control. The resulting control law is an adaptive one in which the main parameter depends on the variable inductance of the actuator itself. This aspect seems to be important to prevent saturation during the control phase. Because of the presence of the inductance value in the numerator of this factor, from equation (16), the control law cancels the effect of this nonlinearity.	 

Simulations
Simulated results are visible in Figs. 3 and 4. This trajectory corresponds to 6000 rounds per minute. The power involved for each exhaust valve does not exceed the mean value of 60 W in the case of 6000 rpm. A sampling time equal to 20 × 10−6sec. is used.



15

10

5

0

−5

−10

−15
0.01	0.02	0.03	0.04	0.05	0.06	0.07
Time (sec.)


12
10
8
6
4
2
0
−2


0.018	0.02	0.022	0.024	0.026
Time (sec.)


Fig. 3. Left: Position (6000 rpm). Right: Detail of the position (6000 rpm)



15
8
10	6

5	4


0

−5

−10

−15









0.01	0.02	0.03	0.04	0.05	0.06	0.07
Time (sec.)
2

0

−2

−4









0.018	0.02	0.022	0.024	0.026
Time (sec.)


Fig. 4. Left: Velocity (6000 rpm). Right: Detail of the velocity (6000 rpm).



Conclusions and future work
A direct adaptive non-linear control framework for a non-linear electromagnetic actuator is presented in this paper and starting from a Lyapunov approach a continuous control law is calculated for the actuator. After that, an approximated sampled final control law is proposed. The resulting control law is an adaptive one in which the main parameter depends on the variable inductance of the actuator itself. This aspect seems to be important to prevent saturation during the control phase.

Future work
The results which have been presented are based on the assumption that the inductance, as a function of the position of the armature, is known. To apply this algorithm in practical applications a robust analysis is requested.

References
P. Mercorelli, An anti-saturating adaptive pre-action and a slide surface to achieve soft landing control for electromagnetic actuators, IEEE/ASME Transactions on Mechatronics 17 (1) (2012) 76–85.


A. Fabbrini, A. Garulli, P. Mercorelli, A trajectory generation algorithm for optimal consumption in electromagnetic actuators, IEEE Transactions on Control System Technology 20 (4) (2012) 1025–1032.
P. Mercorelli, A two stage augmented extended kalman observer for sensorless valve control in camless internal combustion engines, IEEE Transactions on Industrial Electronics 59 (11) (2012) 4236–4247.
P. Mercorelli, A hysteresis hybrid extended kalman filter as an observer for sensorless valve control in camless internal combus- tion engines, IEEE Transactions on Industry Applications 48 (6) (2012) 1940–1949.
S. Butzmann, J. Melbert, A. Koch, Sensorless control of electromagnetic actuators for variable valve train, in: Proc. SAE Tech- nical Paper 2000-01-1225 (http://www.sae.org/automag/), Detroit, 2000.
K. Peterson, A. Stefanopoulou, Rendering the elecreomechanical valve actuator globally asymptotically stable, in: Proc. 42nd IEEE Conference on Decision and Control, Maui, Maui, 2003.
R. Flierl, M. Klu¨ting, The third generation of valvetrains - new fully variable valvetrains for throttle-free load control, in: SAE, 2000-01-1227 (http://www.sae.org/automag/), 2000.
M. A. Theobold, B. Lequesne, R. Henry, Control of engine load via electromagnetic valve actuators, in: SAE, 940816 (http://www.sae.org/automag/), 1994.
M. Gramann, M. Nagel, T. Rockl, R. Wilczek, Electromagnetic actuator, in: US Pat. 6,037,851, 2000.
S. Birch, Renault research, in: Automotive Engineering International Online (http://www.sae.org/automag/), 2000.
M. Schechter, M. Levin, Camless engine, in: SAE, 960581 (http://www.sae.org/automag/), 1996.
F. Moon, Magneto-solid Mechanics, John Wiley and Sons, New York, 1984.
