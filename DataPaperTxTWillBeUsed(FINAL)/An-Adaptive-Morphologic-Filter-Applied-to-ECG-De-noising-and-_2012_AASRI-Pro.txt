Available online at www.sciencedirect.com



AASRI Procedia 1 (2012) 474 – 479
AASRI
Procedia
www.elsevier.com/locate/procedia





2012 AASRI Conference on Computational Intelligence and Bioinformatics
An Adaptive Morphologic Filter Applied to ECG De-noising and Extraction of R Peak at Real-time
Wang An-donga*, Liu Lanb ,Wei Qina,b
a School of Information engineering Wuhan University of Technology, Wuhan 430070,China
bSchool of Information engineering Wuhan University of Technology, Wuhan 430070,China




Abstract

Electrocardiogram (ECG) is an electrical signal detected by the particular device and method. It is very important to analyze and measure ECG for diagnosis of various heart diseases. However, it is often disturbed by different types of noise. In this paper, an adaptive morphological filter is presented to remove the power line interference from ECG signals, by which the drawbacks of previous morphological method are overcome. Moreover, the extraction of R peak in ECG is also feasible by this filter for further study on ECG. Due to the high speed of our method, the ECG de-nosing and R Peak extracting could be both realized at real time, which is an effective method to monitoring patients undergoing surgeries.

2012 Published by Elsevier B.V. Selection and/or peer review under responsibility of American Applied Science Research Institute Open access under CC BY-NC-ND license.

Keywords: Electrocardiogram; Mathematical Morphology; LMS algorithm; Noise suppression


Introduction

The electrocardiogram (ECG) is a recording of the heart’s electrical potentials which has been always applied to the diagnosis of kinds of heart diseases. The noises disturbing ECG involve generally the power- line interference, baseline drift, electrode polarization noise and the amplifier noise[1]. The most useful


* Corresponding author.Tel:15871685606
E-mail address: 942569665@qq.com
Key Lab.of Broadband wireless communications and Sensor networks, Wuhan University of Technology, Wuhan, Hubei 430070,China







2212-6716 © 2012 Published by Elsevier Ltd. Open access under CC BY-NC-ND license.
doi:10.1016/j.aasri.2012.06.074


clinical information in ECG is to find the intervals and amplitudes, for example, the R-R interval detection is a major factor in determining the heart rate, and several related arrhythmias such as Tachycardia, Bradycardia[2]. Many approaches have been applied to the enhancement of filtering ECG, such as FIR filter[3],EMD method[4],Morphology[5]. The primary drawbacks of FIR filter is that it can only filter the interference of fixed frequency, while the spectra of the ECG signal and the interference overlaps. However, EMD method, which is able to effectively remove noise from ECG signal, but requires considerable computational time which is not suitable for real-time processing. In recent years, mathematical morphology has become one of the effective approaches for the processing and analysis of the ECG signals. Although this approach is promising in terms of robustness and computational efficiency, it introduces distortions to the QRS waves [6], which causes the difficulty in extraction of ECG features. In this paper, we modify the morphologic filter to combine it with the adaptive filter algorithm and extracting R pear in ECG. The previous morphologic filter, the adaptive filter, and our method are illustrated in next section. And in the third section, experimental results of clinical ECG recording collected during kinds of surgeries are given. Finally, the discussion and conclusion are in the last part.

Methods

Mathematical morphology

Mathematical morphology(MM) is a branch of mathematics which is based on set theory, topology and random functions. Structuring elements are the basic concept of mathematical morphology, which has a certain form (such as point, line, circle, etc). Erosion and dilation are two basic morphological operators. Open and close can be defined through the transform of them. The morphology operations are defined as follows:
The discrete signal f is defined on f(n),n=0,1…N-1, the discrete structure-element g is defined on g(m),m=0,1…M-1,and N>M, Erosion is a “shrinking” operator while the dilation operation is an “expansion” operation.

Erosion operation:
f g(n) 
min	{ f (n  m)  g(m)}
(1)

m0,1...M 1
n0,1...N M

Dilation operation:
f  g(n) 
max  { f (n  m)  g(m)}
(2)

m0,1...M 1
nM 1,M ...N 1

After eroded and dilation operation, the signal is cut down by M length. In order to obtain the whole results, we need to expand the original signal from the beginning and end respectively M length. The open operation and close operation built on eroded operation and dilated operation are defined as follow:

Open operation : Close operation:
f ∘ g  ( f g)  g
f •g  ( f  g)g
(3)
(4)

In most applications, opening is used to suppress peaks, while closing is used to suppress pits. Opening is a shrinking operator while closing is a expansion operator. So the two filters combine in order to suppress one- way migration[7]. The morphology method used in our paper is mainly based on the following equation.[8].Figure1 illustrates the structure of morphology used in morphology filter.

OC_CO(f , g)=( f ∘ g•g  f •g ∘ g) / 2
(5)



Input





Fig.1. morphology filter structure used in ECG processing

Adaptive Filter for Noise Removal

The adaptive filter extracts the signal, or eliminates the noise, by iteratively minimizing the MSE between the primary and the reference inputs [9].By adjusting its coefficients continuously, the filter output unlimitedly close to the reference, so that it can achieve the purpose of eliminating interference. This is why the adaptive filter is superior than the fixed parameter filters.Figture2 shows a typical self-adaptive filter structure used for suppress power-line interference [10].
d=s+n0


ε







Fig.2. self-adaptive filter structure used in ECG processing

signal d is composed of the desired signal s and noise signal n  , which is additive and not correlated with
s. n1 is the reference signal ,which is uncorrelated with desired signal, but correlated with noise n. Since the

signal s and noise the signal best.
n0 is uncorrelated, when
E[(n0
 y)2 ] reach the min value, The adaptive filter extracts

An Novel Adaptive Morphologic Filter and Extraction of R Peak

In this paper, we combined mathematical morphology and adaptive filter to suppress the 60Hz power-line interference and baseline wander in ECG signals. Theoretically, if morphological filtering has width of the structuring element larger than the width of noise aimed to suppress, morphology can separate the useful signal from noise. But in fact the high amplitude QRS wave and the peaks and pits of its adjacent regions will also be removed during simulation process, resulting in the distortion of corrected ECG signal. Our method is designed to solve this problem perfectly. The overall system diagram is showed in Figure3.

R peak
2




e	De-noised
	Signal


Fig. 3. Block diagram for removing noise and extracting R peaks

Firstly, OC-CO operation in morphology filter introduced in part II is used to suppress the power-line


interference in noisy ECG signal f0 . g1 is a triangular structure element which width is 0.02Fs. Signal f1 is obtained from the noisy ECG signal after OC_CO operation, and the noise has been removed from it ,as well as the peaks and pits in high amplitude QRS wave. Signal p contains the important peaks and pits cut down in the operation of morphology, however, there is a lot of noise too.
Secondly, signal p is processed through adaptive filter to remove the noise. Figure 2 shows the structure of this self-adaptive filter structures.

Applying the structure element g2
to filter baseline wander.

Reconstruct the signals with e to get the de-noised ECG f3 .
Lastly, apply the structure element g3 to extract QRS wave. g3 is a linear structure element which width is 0.09Fs.
Experimental Results

To prove whether our algorithm is appropriate for the ECG signal, we use the real ECG signal getting from the process of operations of Taiwan hospital. The sample rate is 300Hz, and the noise signal was obtained by adding 60Hz noise into the pure signal. We use the the signal-to-noise ratio (SNR) and root-meansquare error (RMSE) to measure the performance of our methods.

SNR  10 log10 (
x(i)2
2





RMSE 
i 1 [x(i)  y(i)]





In the above two equations , x(i) is the original ECG signal, y(i) is the signal after filtered. Our experiment is composed of two parts. We chose the record 1 from a 78 years man in experiment1, because it captures normal sinus rhythms and is reasonably free of noise, and record 2 from a 56 years man in experiment 2 is corrupted with synthetic PLI with frequency and baseline wander. Figure 4 show the results of experiment 1.





2	1

1	0.5

0	0

-1	-0.5


-2
0  1  2  3  4  5  6  7  8  9  10
Time / s (a)

-1
0  1  2  3  4  5  6  7  8  9  10
Time / s (b)

2

1

0

-1

-2
0  1  2  3  4  5  6  7  8  9  10
Time / s (c)
2

1

0

-1

-2
0  1  2  3  4  5  6  7  8  9  10
1

0.5

0

-0.5

-1
0  1  2  3  4  5  6  7  8  9  10
Time / s (d)
2

1

0

-1

-2
0  1  2  3  4  5  6  7  8  9  10

Fig4 .The experimental results by several filtering mTeimte h/ s ods. (a) The pure ECG signal.Ti(meb/ s)baseline wander (c) ECG signal corrupted with
(e)	(f)
power line interference and baseline wander. (d)baseline wander extracted from morphology operator (e) The result of adaptive morphologic filter (f)The result of previous morphologic filter.

Table1 The result of SNR and RMSE in the experiment1


From Figure 4 and Table1, our method has the better performance with the improved SNR and RMSE between the pure signal and the filtered ECG was reduced. The morphology method alone can suppress the noise and cut down the peak of R wave at the same time. Although our method will take a little more time to process, it can keep the important features in noisy ECG signal unchanged, which has an important effect on real-time ECG processing.
2

1
0

-1
-2

-3




1


0.5


0


-0.5


2

1

0

-1

-2
0	5	10	15	20	25	30
Time / s (a)


0	5	10	15	20	25	30
Time / s (b)


0	5	10	15	20	25	30
Time / s (c)


Fig5 .The result of experimental 2(a) The corrupted ECG signal. (b)baseline wander extracted from morphology operator (c) The result of adaptive morphologic filter
QRS wave
2

1

0

-1

0	1	2	3	4	5	6	7	8	9	10
Time / s (a)
R peak
2

1

0

-1

0	1	2	3	4	5	6	7	8	9	10
Time / s (b)
R peak detected from another patient
2

1

0

-1

0	1	2	3	4	5	6	7	8	9	10
Time / s
(c)
Fig6.QRS wave extracted from morphology and R peak (a) QRS wave obtained from morphology method (b) Detected R peaks (c) R peak detected from another patient

Figure5 proves that the adaptive morphologic filter is very effective in processing real-time ECG signals.Figure6 shows that the R peak calculated from QRS wave which was extracted from morphology filter2, morphology method keeps the ECG signal unchanged and it is very effective in real-time processing in R-R interval.

Discussion and Conclusion


In this paper, a new ECG de-noising method which combines morphology with adaptive filter with LMS algorithm is proposed. This new method overcomes the disadvantage that the morphology will cut down the R peaks in ECG signals. It not only suppress the power line interference effectively, but also minimally the losses of the useful information in ECG signal. In addition, our method applies LMS algorithm to reduce the noise in R peaks obtains from morphology. At last, we applied morphology method to extract the QRS wave from the de-noised signal, which can benefit for processing R-R interval in real-time effectively. However, how to select a appropriate structuring elements to adapt to individual differences is the most difficult part in future work.


Acknowledgements

This paper was supported by the Natural Science Foundation of Hubei Province under Grant 51175389


References
Lihuang She, Zhongqiang Xu, De-noisng Of ECG Based On EMD Improved thresholding And Mathematical Morphology Operation. International Conference on Biomedical Engineering and Informatics ,BMEI 2010.
S.Z.Mahmoodabadi,  A.Ahmadian,  ECG  FEATURE  EXTRACTION  USING  DAUBECHIES
WAVELETS, Proceedings of the Fifth IASTED International Conference, VISUALIZATION,IMAGING,AND  INMAGING,AND  IMAGE  PROCESSING,  September  7-9,2005
Benidorm, Spain.
Chavan,Mahesh.S,Design and implementation of digital FIR equiripple notch filter on ECG signal for removal of power line interference, WSEAS Transactions on Signal Processing, v 4, n 4, p 221-230, April 2008.
Chang, Kang-Ming, Ensemble empirical mode decomposition for high frequency ECG noise reduction,
Biomedizinische Technik, v 55, n 4, p 193-201, August 1, 2010
CHEE-HUNG HENRY CHU,EDWARD J.DELP.Impulsive Noise Suppression and Background Normalization of Electrocardiogram Signals Using Morphological Operators[J].IEEE Trans.on BME,1989,36(2):262—273.
P. Sun, Q. H. Wu, A. M. Weindling, An Improved Morphological Approach to Background Normalization of ECG Signals, IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 50, NO. 1, JANUARY 2003.
Lihuang She, Zhongqiang Xu, De-noisng Of ECG Based On EMD Improvedthresholding And Mathematical Morphology Operation, 2010 3rd International Conference on Biomedical Engineering and Informatics (BMEI 2010)
Zhongguo Liu,ECG Signal Denoising Based on Morphological Flitering, 5th International Conference on Bioinformatics and Biomedical Engineering, iCBBE 2011.
Mohammad Zia Ur Rahman, Adaptive Noise Removal in the ECG using the Block LMS Algorithm, 2009 2nd International Conference on Adaptive Science & Technology
Yuan Weiting, An Improved Self-Adaptive Filter Based on LMS Algorithm for Filtering 50Hz Interference in ECG Signals. The Eighth International Conference on Electronic Measurement and Instruments, ICEMI2007.
