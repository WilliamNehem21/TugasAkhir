Artificial Intelligence in Agriculture 4 (2020) 31–38











Real-time hyperspectral imaging for the in-field estimation of strawberry ripeness with deep learning
Zongmei Gao a, Yuanyuan Shao b,c,⁎, Guantao Xuan b,d,⁎⁎, Yongxian Wang b, Yi Liu b, Xiang Han b
a Center for Precision and Automated Agricultural Systems, Department of Biological Systems Engineering, Washington State University, Prosser, WA 99350, USA
b College of Mechanical and Electrical Engineering, Shandong Agricultural University, Tai'an 271018, China
c Nanjing Institute of Agricultural Mechanization, Ministry of Agriculture and Rural Affairs, Nanjing 210014, China
d College of Agriculture, Food and Natural Resources, University of Missouri, Columbia, MO 65211, USA



a r t i c l e	i n f o 

Article history:
Received 10 December 2019
Received in revised form 26 April 2020
Accepted 27 April 2020
Available online 30 April 2020

Keywords:
Strawberry ripeness Hyperspectral imagery In field
CNN
a b s t r a c t 

Strawberry is one of the popular fruits with numerous nutrients. The ripeness of this fruits was estimated using the hyperspectral imaging (HSI) system in field and laboratory conditions in this study. Strawberry at early ripe and ripe stages were collected HSI data, covered wavelength ranges from 370 to 1015 nm. Spectral feature wave- lengths were selected using the sequential feature selection (SFS) algorithm. Two wavelengths selected for field (530 and 604 nm) and laboratory (528 and 715 nm) samples, respectively. Then, reliability of such spectral fea- tures was validated based on support vector machine (SVM) classifier. Performance of SVM classification models had good results with receiver operating characteristic values for samples under both field and laboratory condi- tions higher than 0.95. Meanwhile, the spatial feature images were extracted from the spectral feature wave- length and the first three principal components for laboratory samples. Pretrained AlexNet convolutional neural network (CNN) was used to classify the early ripe and ripe strawberry samples, which obtained the accu- racy of 98.6% for test dataset. The above results indicated real-time HSI system was promising for estimating strawberry ripeness under field and laboratory conditions, which could be a potential application technique for evaluating the harvesting time management for farmers and producers.
© 2020 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).






Introduction

Strawberry fruit is favored by consumers for its characteristic fea- tures such as aroma, juicy texture, and sweetness and has been a critical fruit in terms of economic value. The fresh fruits or prepared foods such as preserves, juice and pies has been consumed in large quantities (Gunness et al., 2009). In 2017, there were 9.2 million tons of straw- berries produced over world, led by China with 21% of the total (FAOSTAT, 2017). While strawberry is a non-climacteric fruit, harvest- ing at the optimum stage of ripening often determines good quality of the fruit. Conventionally, strawberry ripeness has been evaluated with certain objective criteria including color, texture, and chemical constit- uents, etc., by fruit expert or researchers (Rico et al., 2007; Zhang et al., 2016). These methods even though with satisfactory accuracy are often destructive, time-consuming and labor intensive. Therefore,

* Correspondence to: Y. Shao, College of Mechanical and Electrical Engineering, Shandong Agricultural University, Tai'an 271018, China.
⁎⁎ Correspondence to: G. Xuan, College of Agriculture, Food and Natural Resources, University of Missouri, Columbia, MO 65211, USA.
E-mail addresses: syy007@sdau.edu.cn (Y. Shao), xuangt@sina.com (G. Xuan).
it is needed to develop a rapid and nondestructive method for straw- berry fruit ripeness evaluation.
Spectral imaging techniques have been successfully applied to mea- surement of quality attributes in fresh fruits and vegetables (Nicolaï et al., 2007). Hyperspectral imaging (HSI) technique, as a commonly ad- vanced nondestructive technique, integrates conventional imaging and spectroscopy technique, collecting spectral and spatial information in parallel. Further, it is chemical-free, and measuring rapidly with limited sample preparation (Wu and Sun, 2013; Gao et al., 2019; Shao et al., 2019). With these advantages, HSI has been applied to estimate fruit ripeness, including banana, astringent persimmon, strawberry, bananito fruit, etc. (Rajkumar et al., 2012; Wei et al., 2014; Zhang et al., 2016; Pu et al., 2019). Zhang et al. (2016) employed HSI, along with the support vector machine (SVM) for strawberry ripeness evalu- ation under the laboratory condition. With 380 to 1030 nm and 874 to 1734 nm, set as the spectral range on HSI, respectively, optimal wave- lengths and the corresponding image features were extracted from each range for the ripeness analysis of strawberries (unripe, mid-ripe and ripe). The classifier (SVM) results in the end revealed that the dataset of spectra ranging from 441.1 to 1013.97 nm outperform those from 941.46 to 1578.13 nm in terms of accuracy, efficiency. This study


https://doi.org/10.1016/j.aiia.2020.04.003
2589-7217/© 2020 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the CC BY-NC-ND license (http:// creativecommons.org/licenses/by-nc-nd/4.0/).



significantly facilitated application of HSI on strawberry ripeness evaluation.
To date, deep learning method has been used in a wide range of areas as applications of end-to-end learning (LeCun et al., 2015). Deep neural networks can offer a connection between the inputs i.e. an image of an object to an output such as the ripeness of fruits (Ferentinos, 2018). The layers in a neural network are mathematical functions that make learning decisions from the extracted features (Schmidhuber, 2015; Mohanty et al., 2016; Zhang et al., 2018a; Zhang et al., 2018b). Krizhevsky et al. (2012) proposed that AlexNet convolutional neural network (CNN) architecture has a milestone con- tribution in image recognition and classification. Sa et al. (2016) devel- oped a ‘DeepFruits’ to detect seven different fruits using deep convolutional neural networks, which was helpful for fruit yield estima- tion and automated harvesting. Rahnemoonfar and Sheppard (2017) designed a DCNN for tomato target recognition that accurately identi- fied tomato targets which were shaded, occluded by leaves, and over- lapped. Yu et al. (2019a) and Yu et al. (2019b) built one Mask Region Convolutional Neural Network (Mask-RCNN) for detecting ripe and un- ripe strawberries based on RGB images. The fruit detection results of 100 testing images demonstrated its robustness, with the average de- tection precision, recall and MIoU rates at 95.78%, 95.41% and 89.85%, respectively. Tian et al. (2019) proposed an improved YOLO-V3 algo- rithm to identify apples in different growth stages. The algorithm can realize real-time detection of occlusion and overlapping apples and achieved good recognition results. In addition, there were a large num- ber of reports on fruit quality, crop quality, and crop pest detection based on deep learning (Le and Lin, 2019; Kamilaris and Prenafeta- Boldú, 2018; Yu et al., 2018; Yu et al., 2019a; Yu et al., 2019b; Geetharamani and Pandian, 2019).
Though the application of hyperspectral imaging to identify the ripe-
ness of strawberry fruits in laboratory has been performed (Zhang et al., 2016), while it is still challenging to identify the ripeness of the straw- berry fruits in field, not even at early ripe stage. Therefore, this study was aimed to estimate the ripeness of the strawberry fruits under infield and laboratory conditions using hyperspectral imaging combined with deep learning. Specifically, in this study, we carried out the strawberry fruit's ripeness estimation at two different ripening stages (early ripe and ripe) using HSI under both field and laboratory conditions. The
objectives of this study were to: 1) develop the hyperspectral imaging technique to evaluate strawberry ripeness in field; 2) select spectral fea- ture wavelength from respective field and laboratory datasets; and
3) validating the precision of the selected key wavelengths based on both spectral and spatial information.

Related work

Deep learning has emerged as one advanced technology to image analysis in precision agriculture throughout from growing to harvest- ing. Convolutional neural network (CNN) is one of the most used deep network architectures, has been employed for image classification, seg- mentation, object detection etc. Zheng et al. (2019) developed CropDeep using YOLOv3 network for image classification and detection consisted by crop digital images from 31 different classes. Bargoti and Underwood (2017) applied CNN to segment images obtained by one digital camera in apple orchard for counting fruits number and estimat- ing yield. Zhang et al. (2018a) employed the regions-convolutional neu- ral network (R-CNN) to deploy the object detection for detecting the branch of apple trees based on the images taken using the depth-RGB sensor. The typical image classification, segmentation and object detec- tion application in precision agriculture are summarized in Fig. 1.
Fruit detetcion and ripeness estimation based on deep leanring has been one recent interest for the resarchers aiming to practical applica- tion in orchard or field detection. Some studies were dedicated to apply deep learning to fruit detetcion industrially. Hossain et al. (2018) employed two deep learning frameworks, one was light model with six convolutional neural network layers and another one was fine-tuned VGG model. The authors operated few experiments to classi- fied different fruits based on such frameworks. The VGG model achieved great performance for classifying the fruits with accuracy higher than 90%. In addition, various studies have applied deep learning for classifiying the fruit ripeness for further harvesting and shelf storage. Halstead et al. (2018) presented a robotic vision system for estimating the sweet pepper ripeness based on one parallel FasterRCNN (FRCNN) framework. The accuracy for estimation of ripeness reached to 82.1%. Whiel the proposed method was not operated well for samll juvenile sweet pepper since the size of such frits were samll, leading to many misclassified number of fruits. While, most of the stuidies employed




Fig. 1. The typical applications of convolution neural network for image classification, segmentation and object detection in precision agriculture, (a) crop classification (image from Zheng et al., 2019), (b) apple images segmentation (image from Bargoti and Underwood, 2017), and (c) apple branch detection (image from Zhang et al., 2018a).


Table 1
Summary of studies using deep learning for various fruit applications.

Note: NIR: Near-infrared; SAE: stacked auto-encoders; FNN: fully connected neural network; SSC: soluble solid content; Faster R-CNN: faster region-CNN; RGB-D: RGB-depth.


the digital sensor for estimating ripeness of fruits as of today. The digital sensing methods works well for fruits with significant color variations at different ripen stages, while it is still chanellenging for fruits with less color diffeences.
Recently, with the development of optical sensing technology, hyperspectral imaging has been applied as one powerful tool to noncon- tact detect the fruits quality including the ripeness for many fruits, such as persimmon (Munera et al., 2017), olive (González-Cabrera et al., 2018), nectarine (Munera et al., 2017b), strawberry (Zhang et al., 2016), bananito (Musa acuminata, AA) (Pu et al., 2019), etc. While it is still challenging to employ the hyperspectral imaging in field, with lim- itations in light source, winds, and crops overlapping etc. Furthermore, combined with hyperspectral imaging and deep learning is worth of ex- ploration for detailed information extraction and information under- standing with large amounts of dataset. As summarized in Table 1, most research applied CNN for the fruit quality detection based on dig- ital sensors for classification. A wide spectrum of applications is worthy of exploitation combined with deep learning with the high-channels sensors.

Materials and methods

Infield sampling

The experimental site was a commercial strawberry farm located in Tai'an, Shandong Province, China (36.2003° N, 117.0876° E). “Zhangji” cultivar strawberry was planted. The strawberry farm planting area was 1080 m2 with planting row distance at 0.3 m. The length of each
row was 9 m and 4 strawberries were planted within 1 m. Strawberry rows were selected randomly for the spectral imaging analysis. Early ripe and ripe strawberries without disorders were respectively chosen to take the hyperspectral images on March 22, 2019. The strawberry plants were randomly selected from the rows. In all, 26 early ripe and 19 ripe strawberry plants were randomly selected for the hyperspectral image acquisition. The real-time collected HSI in-field images were shown in Fig. 2, with the hyperspectral images being automatically col- lected. Meanwhile, another 60 early ripe and 60 ripe strawberries were randomly detached from the corresponding ripening strawberry plants, respectively, for the reliability validation of infield images.

Hyperspectral imaging acquisition

A portable snapshot hyperspectral imaging system (Fig. 3) was employed in this study (GaiaField-V10E, Dualix Instruments Co., Ltd., Chengdu, China). The system was consisted by a spectrometer (GaiaField-V10E), lens (HSIA-OL23), light source (HSIA-LS-T-200 W), white panel (HSIA-CT-150 × 150), tripod (HSIA-TP-S), and the com- puter installed with the data collection software of SpecView. The spec- tral ranged from 370 to 1015 nm, with the spectral resolution at 2.8 nm. The image of each wavelength is with 1394 × 1040 pixels. During the HSI image collection in the field, the parameter optimization was re- quired. The sensor exposure time was set to 3 ms, and distance between the lens and the ground was 0.87 m. Before collecting the strawberry images, a white reference image was taken based on imaging a white panel, and a dark reference image was obtained by covering the lens with the cap.




Fig. 2. Infield hyperspectral images of strawberry at (a) early ripe, and (b) ripe stage.




Fig. 3. Hyperspectral imaging system used in this study; (a) the diagram of the HSI system; (b) data collection of strawberry fruits in the field.


To eliminate the impacts of uneven illumination and dark current noise, the raw hyperspectral images were calibrated using the white and dark reference images by calibration Eq. (1):

Rc = R0−D	(1)
W  D

where, Rc indicates the calibrated hyperspectral image, R0 indicates the raw hyperspectral image, W is the white reference image and D is the dark reference. Each strawberry was selected as one region of interest
Classification models

SVM is a supervised machine learning method based on the statisti- cal learning theory (Guo et al., 2010). Briefly, SVM makes an effort to find a hyperplane in the multidimensions to separate the different clas- ses, i.e. early ripe and ripe previously mentioned in this study. The hy- perplane is the optimal surface with the maximal distance between the hyperplane and classes from each side, namely the margin, as stated in Eq. (2), depending on the number of classes (Nclasses), a different number of hyperplanes (Nhplanes) is generated.

(ROI) for extracting the spectral information of the strawberry. For in- field samples, 60 individual early ripe and 60 individual ripe strawberry were extracted from the corresponding ripeness plants as ROIs. The av-
Nhplanes = Nclasses × (Nclasses −1)
(2)

eraged spectral data was calculated from the pixels in each ROI.

Feature wavelength selection

The analysis of the hundreds of wavebands from hyperspectral im- ages would be computationally laborious. Therefore, the strategy to se- lect and focus on the analysis the feature wavelengths has often been prevalent in the field. Herein, a few numbers of wavelengths with the most informative significance and the minimum co-linearity and redun- dancy from full spectra were screened to reduce the data dimensionality and complexity (Gao et al., 2019). In this study, the robust feature selec- tion algorithm, sequential feature selection (SFS) were utilized for fea- tures selection, which greatly improved the computational efficiency and reduced error of the model by removing irrelevant features or noise. This SFS algorithm, distinct from other feature selection algorithms,
is consisted by two components: (1) The objective function, called the criterion, with mean squared error (for regression models) and misclas- sification rate (for classification models), seeking to minimize overall feasible feature subsets. (2) A sequential search algorithm, determining the candidate subset during the criterion evaluation. Sequential searches are in one-way working modes, exclusively growing or shrink- ing the candidate set (Zhang et al., 2013). In particular, the SFS algo- rithm carries out a “bottom-up” search strategy, starting from an empty feature subset and adding one feature at a time, eventually achieves a feature subset with the desired cardinality. The SFS algorithm with the forward direction was employed for selecting the feature wavelengths in this study. All of the data sample were used for selecting feature wavelengths by SFS algorithm for field and laboratory condi- tions, respectively. This procedure was performed in the MATLAB® (2019a, The MathWorks Inc., Natick, MA).
In general, the classifier will perform better when the margin with the larger value. For training an SVM model is a process of finding the optimize hyperplane based on the training dataset. In the optimization, SVM adopts a structural minimum principle for avoiding the over- fitting problems. SVM classifier, in numerous research, has been dem- onstrated with superior performance on HSI classification (Fauvel et al., 2007). The samples were split into training and test dataset with a ratio of 70:30 for respective field and laboratory conditions. As a result, there were 43 early ripe and 41 ripe strawberries in training dataset for field condition. While there were 17 early ripe and 19 ripe strawberries in test dataset collected in field. Similarly, there were 39 early ripe and 45 ripe strawberries in training dataset for laboratory condition. While there were 21 early ripe and 15 ripe strawberries in test dataset col- lected under laboratory.
The receiver operating characteristic (ROC) curve visualizing the classifier's performance was used in this study for operating point selec- tions, or threshold decisions. The size of area under the ROC curve (AUC) proportionally indicates of classifier's performance level, and therefore is useful for comparing the performances of a number of different clas- sification schemes. The point closest to the top left corner of the ROC curve was chosen as an optimal threshold value (where the true posi- tive rate equals 1 and the false positive rate equals 0). This procedure was performed in the MATLAB® (2019a, The MathWorks Inc., Natick, MA).

CNN archerite

AlexNet competed in the ImageNet Large Scale Visual Recognition Challenge (ILSVRC), in 2012. The convolution layers could be optionally followed by a normalization layer and a pooling. While ReLu non-linear




Fig. 4. Pretrained CNN architecture for classifying the early ripe and ripe strawberry images.


activation units normally have associated with all the layers. Briefly, AlexNet contains five convolution layers, three fully connected layers, and with one last layer of softmax. For the convolution layers, the first two convolution layers (Conv1 and Conv2) are followed by a normaliza- tion and a pooling layer, respectively. While the fifth convolution layer (Conv5) is followed by only one pooling layer. The final fully connected layer (fc8) has two outputs, i.e. the number of classes (early ripe and ripe), in the pretrained AlexNet in this study. Then, the softmax layer normalizes the input which obtained from layer (fc8), producing a dis- tribution of values across the two classes. Such values could be used for evaluating the performance of the network, with each input image representing one of the corresponding classes (Szegedy et al., 2016; Mohanty et al., 2016).
Fig. 4 illustrates the trained CNN after fine-tuning and training for the early ripe and ripe strawberry classification. The input data were im- ages in 227 × 227 × 3. In the first convolution layer (Conv1 layer), the network used 96 convolution kernels in size of 11 × 11 of each to extract the image features using GPU. The rectified linear units (ReLu) activa- tion function was used to compress the results if convolution into range of (0, +∞). The pool layer could reduce the spatial information and parameters to integrate features and avoid overfitting of the net. The dropout layer from the original layer AlexNet was not taken into consideration since the image dataset was relatively small.

Results and discussion

Spectral analysis

The average spectra of the early ripe and ripe strawberry fruits im- aged in field and laboratory were shown in Fig. 5, and significant
differences in reflectance ranged from 500 to 950 nm between the early ripe and ripe strawberry samples collected in field (Fig. 4(a)). Whereas the value gap in reflectance are mainly distributed from 400 to 700 nm in laboratory (Fig. 4(b)). Interestingly, between 750 and 950 nm, the average spectra of early ripe and ripe strawberry samples in laboratory only are almost overlapped, indicating the rather close re- flectance values under the laboratory condition. There were some parts in common between the infield and lab average spectra. For example, reflectance value divergence at the he wavelength of 535 nm indicated distinct anthocyanin contents between the early ripe and ripe straw- berry samples, while that at wavelength of 675 nm was mainly caused by the chlorophyll content difference.

Spectral feature selection

Massive amounts of wavebands in hyperspectral images exponentialize the time spent in computational analysis. The strategy of spectral feature wavelengths selection, via greatly reducing the di- mensionality while maintaining most important information from orig- inal data, could significantly simplify the analyzing process. In this study, two wavelengths were selected for strawberries from infield (530 and 604 nm) and laboratory (528 and 715 nm), based on the crite- rion value i.e. 0.2 and 0.025 for infield, 0.067 and 0 for laboratory, re- spectively, using SFS algorithm, shown in Table 2. Fig. 6 shows the empirical distribution function (EDF) of the cumulative distribution of criterion values of selected wavelength based on SFS algorithm for early ripe and ripe samples collected under infield and laboratory condi- tions. This cumulative distribution function is a step function that jumps up by 1/n at each of the n data points. In this study, n equaled to 2. The cumulative distribution function (CDF) value at any specified value of




Fig. 5. Mean spectrum for early ripe and ripe strawberries collected in (a) field; (b) laboratory.



Table 2
Spectral feature wavelengths selected using SFS and the SVM models based on the se- lected feature wavelengths.



the measured variable is the fraction of observations of the measured variable that are less than or equal to the specified value. For example, the CDF value of criterion value of 530 nm for infield strawberry was 1.0, while CDF value of criterion value of 604 nm was 0.5. Such CDF values indicated that the 530 nm had stronger discrimination power than 604 nm. Similarly, for laboratory strawberry samples, the 528 nm had stronger discrimination power than 715 nm.
To evaluate the reliability of selected feature wavelengths, the SVM classifier was applied to build models for demonstrating the resulting classifications, with training dataset as the input for both laboratory and infield datasets. Test dataset was used for validating the perfor- mance of the training models for laboratory and infield, respectively. Table 2 and Fig. 7 showed the ROC value of each training and test dataset for respective laboratory and infield based on the selected spectral fea- ture wavelengths. Since the ROC curve for training and test datasets achieved great results with ROC values reaching to 1 under laboratory condition, so the curves were overlapped shown in Fig. 7(b). These re- sults revealed the possibilities of applying the hyperspectral imager to
estimate the ripeness of strawberries in field. Meanwhile, the selected spectral feature wavelengths could provide support for building one customized multispectral module for estimating the strawberries ripeness.

Spatial feature extraction and classification

The spatial features between the early ripe and ripe strawberries fa- vored in terms of significant difference, thereby, was employed along with selected feature wavelengths above for classifications. Meanwhile, the selected feature wavelength of 530 nm from infield samples is adja- cent to the wavelength of 528 nm which was selected from the labora- tory samples. Thus, the grayscale images of the 530 nm were extracted from the laboratory samples, to validate the transferability of the feature wavelength of 530 nm from infield to laboratory condition. Further, the hyperspectral images containing 256 wavebands could be compressed into few principal components (PCs) images based on principal compo- nent analysis (PCA). Each PC is a linear sum of the original HSI image at individual waveband multiplies by the corresponding weighing coeffi- cients. In this study, the first three PCs images were extracted from lab- oratory samples to reveal the main features of strawberry samples (Fig. 8).
Overall, 60 images extracted from feature wavelength (530 nm) and 180 images were extracted from the first three PCs using PCA for early rip strawberry. Similarly, 60 images extracted from feature wavelength (530 nm) and 180 images were extracted from the first three PCs using PCA for ripe strawberries. Together, 240 images were obtained for





Fig. 6. Empirical distribution function (EDF) of the cumulative distribution of criterion values of selected wavelength based on SFS algorithm for early ripe and ripe samples collected under
(a) infield; (b) laboratory conditions.



Fig. 7. ROC curves for SVM classification between the early ripe and ripe strawberry samples collected using hyperspectral imaging system under (a) field; and (b) laboratory condition.




Fig. 8. Spatial feature images at feature wavelength of 530 nm and first three PCs images for early ripe and ripe strawberries collected in laboratory for (a) early ripe and (b) ripe strawberry samples.


respective early ripe and ripe strawberry samples, summing of 480 im- ages. These grayscale images were resized as 227 × 227 pixels for each image and used as input for the CNN classification architecture. At a ratio of 70:30, all input images were split for training dataset (336) and validating dataset (144), respectively.
The reliability evaluation was performed with the result shown in Fig. 8(a), both the accuracy and loss eventually included. In the respect of training accuracy, indicated by blue curve, there was a sharp/growth at epoch 2, with value of 100%. In contrast, there was a steep decline at epoch 2 with its loss value has fallen to around 0.0 as shown by the or- ange curve. For testing the performance of the trained model, validating dataset images were as input for predicting the strawberry samples classes (early ripe or ripe). Fig. 9(b) showed the confusion matrix results performance from the trained model based on the test images, of which the overall accuracy was 98.6%.
In summary, results from this study firstly validated the divergency in average spectral wavelengths. Based on that, feature wavelengths were selected from images to overcome the redundant imaging data problem, and employed in spatial feature analysis, of which the accu- racy was demonstrated 98.6% based on validate dataset. It indicated that the ripeness of strawberry between the early ripe and ripe stage in the field is distinguishable using the hyperspectral imagery according to conventional standard. While there are still some limitations that need to be addressed in this study. First, the strawberry fruits hidden under the leaves cannot be identified by the hyperspectral imagery.
Second, the accuracy of the spectral and spatial features may need fur- ther improvement to make this technique more practical for typical in- field application. Meanwhile, analyzing the infield hyperspectral images still has difficulties, we believe that a larger dataset for sample prepara- tion and effective sample preprocessing before analysis will help esti- mate the ripeness, which also will be part of our future work.

Conclusion

In this study, a portable hyperspectral imagery was used to estimate the ripeness of strawberry in field and laboratory, with images collected from samples at early ripe and ripe stages. Spectral feature wavelengths were selected using forward SFS algorithm. Two wavelengths were se- lected for respective in field (530 and 604 nm) and laboratory (528 and 715 nm) conditions. The SVM classification models were established based on the selected feature wavelengths, which obtained good results with ROC values higher than 0.95 in test dataset for both field and laboratory conditions. Since 530 nm and 528 nm was adjacent wavelengths, the wavelength of 530 nm from infield condition was con- sidered as important wavelength to extract spatial feature images for laboratory samples. Meanwhile, the first three PCs images were ex- tracted from laboratory samples based on PCA method. Further, pretrained AlexNet CNN was applied to detect deep spatial features based on the spatial images for classifying the early ripe and ripe sam- ples in laboratory, with the prediction accuracy of 98.6% based on test




Fig. 9. The training progress and test performance of the trained model. (a) Accuracy and loss values in the training process and (b) confusion matrix of test dataset images.



dataset. The results of this study indicated the potential of using porta- ble HSI system to estimate the strawberry ripeness real-timely, which could provide support for precision strawberry harvesting infield. While analyzing the infield hyperspectral images is still challenging, we believe that a larger dataset for sample preparation and effective sample preprocessing before analysis will help estimate the ripeness. In future study, more samples images will be collected with wider var- iations of external and internal quality of strawberry fruits at different ripeness stage.

CRediT authorship contribution statement

Zongmei Gao:Formal analysis, Writing - original draft.Yuanyuan Shao:Conceptualization, Methodology, Writing - review & editing. Guantao Xuan:Investigation, Supervision.Yongxian Wang:Data curation, Validation.Yi Liu:Data curation.Xiang Han:Data curation.

Acknowledgements

This research was supported by National Natural Science Foundation of China (Nos. 31701325, 31671632). This work was also funded by China Scholarship Council (No. 201709135004), Post-doctor Fund of Jiangsu Province. Zongmei Gao would like to acknowledge China Schol- arship Council for supporting her study at Washington State University. The team acknowledges help of Tai'an Xinlv farm in completion of this study experiments.

References
Bargoti, S., Underwood, J.P., 2017. Image segmentation for fruit detection and yield esti- mation in apple orchards. J. Field Robot. 34 (6), 1039–1060.
FAOSTAT, 2017. http://www.fao.org/faostat/en/#data/QC/visualize.
Fauvel, M., Chanussot, J., Benediktsson, J.A., Sveinsson, J.R., 2007. Spectral and spatial clas- sification of hyperspectral data using SVMs and morphological profiles. 2007 IEEE In- ternational Geoscience and Remote Sensing Symposium. IEEE, pp. 4834–4837 July, 2007.
Ferentinos, K.P., 2018. Deep learning models for plant disease detection and diagnosis.
Comput. Electron. Agric. 145, 311–318.
Gao, Z., Zhao, Y., Khot, L.R., Hoheisel, G.-A., Zhang, Q., 2019. Optical sensing for early spring freeze related blueberry bud damage detection: hyperspectral imaging for salient spectral wavelengths identification. Comput. Electron. Agric. 167, 105025.
Ge, Y., Xiong, Y., From, P.J., 2019. Instance segmentation and localization of strawberries in farm conditions for automatic fruit harvesting. IFAC-PapersOnLine 52 (30), 294–299.
Geetharamani, G., Pandian, A., 2019. Identification of plant leaf diseases using a nine-layer deep convolutional neural network. Comput. Electr. Eng. 76, 323–338.
González-Cabrera, M., Domínguez-Vidal, A., Ayora-Cañada, M.J., 2018. Hyperspectral FTIR imaging of olive fruit for understanding ripening processes. Postharvest Biol. Technol. 145, 74–82.
Gunness, P., Kravchuk, O., Nottingham, S.M., D’Arcy, B.R., Gidley, M.J., 2009. Sensory anal-
ysis of individual strawberry fruit and comparison with instrumental analysis. Post- harvest Biol. Technol. 52 (2), 164–172.
Guo, L., Boukir, S., Chehata, N., 2010. Support vectors selection for supervised learning using an ensemble approach. 2010 20th International Conference on Pattern Recog- nition. IEEE, pp. 37–40.
Halstead, M., McCool, C., Denman, S., Perez, T., Fookes, C., 2018. Fruit quantity and ripe- ness estimation using a robotic vision system. IEEE Robot. Autom. Lett. 3 (4), 2995–3002.
Hossain, M.S., Al-Hammadi, M., Muhammad, G., 2018. Automatic fruit classification using deep learning for industrial applications. IEEE T. Ind. Inform. 15 (2), 1027–1034.
Hu, C., Liu, X., Pan, Z., Li, P., 2019. Automatic detection of single ripe tomato on plant com- bining faster R-CNN and intuitionistic fuzzy set. IEEE Access 7, 154683–154696.
Ibrahim, Z., Sabri, N., Isa, D., 2018. Palm oil fresh fruit bunch ripeness grading recognition using convolutional neural network. J. Telecomm. Electron. Comput. Eng. 10 (3–2), 109–113.
Kamilaris, A., Prenafeta-Boldú, F.X., 2018. Deep learning in agriculture: a survey. Comput.
Electron. Agric. 147, 70–90.
Krizhevsky, A., Sutskever, I., Hinton, G.E., 2012. Imagenet classification with deep convolutional neural networks. Advances in Neural Information Processing Systems,
pp. 1097–1105.
Le, T.T., Lin, C.Y., 2019. Deep learning for noninvasive classification of clustered horticul- tural crops–a case for banana fruit tiers. Postharvest Biol. Technol. 156, 110922.
LeCun, Y., Bengio, Y., Hinton, G., 2015. Deep learning. Nature 521 (7553), 436–444.
Liu, X., Zhao, D., Jia, W., Ji, W., Ruan, C., Sun, Y., 2019. Cucumber fruits detection in green- houses based on instance segmentation. IEEE Access 7, 139635–139642.
Mohanty, S.P., Hughes, D.P., Salathé, M., 2016. Using deep learning for image-based plant disease detection. Front. Plant Sci. 7, 1419.
Mohtar, I.A., Ramli, N.S.S., Ahmad, Z., 2019, September. Automatic classification of Mango- steen ripening stages using deep learning. 2019 1st International Conference on Arti- ficial Intelligence and Data Sciences (AiDAS). IEEE, pp. 44–47.
Munera, S., Besada, C., Aleixos, N., Talens, P., Salvador, A., Sun, D.W., ... Blasco, J., 2017. Non-destructive assessment of the internal quality of intact persimmon using colour and VIS/NIR hyperspectral imaging. LWT 77, 241–248.
Munera, S., Amigo, J.M., Blasco, J., Cubero, S., Talens, P., Aleixos, N., 2017b. Ripeness mon- itoring of two cultivars of nectarine using VIS-NIR hyperspectral reflectance imaging.
J. Food Eng. 214, 29–39.
Nicolaï, B.M., Beullens, K., Bobelyn, E., Peirs, A., Saeys, W., Theron, K.I., Lammertyn, J., 2007. Nondestructive measurement of fruit and vegetable quality by means of NIR spec- troscopy: a review. Postharvest Biol. Technol. 46 (2), 99–118.
Pu, Y.-Y., Sun, D.-W., Buccheri, M., Grassi, M., Cattaneo, T.M.P., Gowen, A., 2019. Ripeness classification of Bananito fruit (Musa acuminata, AA): a comparison study of visible spectroscopy and hyperspectral imaging. Food Anal. Methods 1–12.
Rahnemoonfar, M., Sheppard, C., 2017. Deep count: fruit counting based on deep simu- lated learning. Sensors 17 (4), 905.
Rajkumar, P., Wang, N., EImasry, G., Raghavan, G.S.V., Gariepy, Y., 2012. Studies on banana fruit quality and maturity stages using hyperspectral imaging. J. Food Eng. 108 (1), 194–200.
Rico, D., Martín-Diana, A.B., Barat, J.M., Barry-Ryan, C., 2007. Extending and measuring the quality of fresh-cut fruit and vegetables: a review. Trends Food Sci. Technol. 18 (7), 373–386.
Sa, I., Ge, Z., Dayoub, F., Upcroft, B., Perez, T., McCool, C., ... McCool, C., 2016. DeepFruits: A Fruit Detection System Using Deep Neural Networks. Sensors 16 (8), 1222.
Schmidhuber, J., 2015. Deep learning in neural networks: an overview. Neural Netw. 61, 85–117.
Shao, Y., Xuan, G., Hu, Z., Gao, Z., Liu, L., 2019. Determination of the bruise degree for cherry using Vis-NIR reflection spectroscopy coupled with multivariate analysis. PLoS One 14 (9).
Steinbrener, J., Posch, K., Leitner, R., 2019. Hyperspectral fruit and vegetable classification using convolutional neural networks. Comput. Electron. Agric. 162, 364–372.
Szegedy, C., Vanhoucke, V., Ioffe, S., Shlens, J., Wojna, Z., 2016. Rethinking the inception architecture for computer vision. Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition, pp. 2818–2826.
Tian, Y., Yang, G., Wang, Z., Wang, H., Li, E., Liang, Z., 2019. Apple detection during differ- ent growth stages in orchards using the improved YOLO-V3 model. Comput. Electron. Agric. 157, 417–426.
Toon, O.P., Zakaria, M.A., Nasir, A.F.A., Majeed, A.P.A., Tan, C.Y., Ng, L.C.Y., 2019. Autono- mous tomato harvesting robotic system in greenhouses: deep learning classification. Mekatronika 1 (1), 80–86.
Wang, Z., Walsh, K., Koirala, A., 2019. Mango fruit load estimation using a video based MangoYOLO—Kalman filter—Hungarian algorithm method. Sensors 19 (12), 2742.
Wei, X., Liu, F., Qiu, Z., Shao, Y., He, Y., 2014. Ripeness classification of astringent persim- mon using hyperspectral imaging technique. Food Bioprocess Technol. 7 (5), 1371–1380.
Wu, D., Sun, D.-W., 2013. Advanced applications of hyperspectral imaging technology for food quality and safety analysis and assessment: a review — part I: fundamentals. Innov. Food Sci. Emerg. Technol. 19, 1–14.
Yu, X., Lu, H., Wu, D., 2018. Development of deep learning method for predicting firmness and soluble solid content of postharvest Korla fragrant pear using Vis/NIR hyperspectral reflectance imaging. Postharvest Biol. Technol. 141, 39–49.
Yu, X., Wang, J., Wen, S., Yang, J., Zhang, F., 2019a. A deep learning based feature extrac- tion method on hyperspectral images for nondestructive prediction of TVB-N content in Pacific white shrimp (Litopenaeus vannamei). Biosyst. Eng. 178, 244–255.
Yu, Y., Zhang, K., Yang, L., Zhang, D., 2019b. Fruit detection for strawberry harvesting robot in non-structural environment based on Mask-RCNN. Comput. Electron. Agric. 163, 104846.
Zeng, X., Miao, Y., Ubaid, S., Gao, X., Zhuang, S., 2020. Detection and classification of bruises of pears based on thermal images. Postharvest Biol. Technol. 161, 111090.
Zhang, C., Guo, C., Liu, F., Kong, W., He, Y., Lou, B., 2016. Hyperspectral imaging analysis for ripeness evaluation of strawberry with support vector machine. J. Food Eng. 179, 11–18.
Zhang, J., He, L., Karkee, M., Zhang, Q., Zhang, X., Gao, Z., 2018a. Branch detection for apple trees trained in fruiting wall architecture using depth features and regions- convolutional neural network (R-CNN). Comput. Electron. Agric. 155, 386–393.
Zhang, L., Jia, J., Gui, G., Hao, X., Gao, W., Wang, M., 2018b. Deep learning based improved classification system for designing tomato harvesting robot. IEEE Access 6, 67940–67950.
Zhang, Y., Wang, S., Ji, G., 2013. A rule-based model for bankruptcy prediction based on an improved genetic ant colony algorithm. Math. Probl. Eng. 2013, 1–10.
Zheng, Y.Y., Kong, J.L., Jin, X.B., Wang, X.Y., Su, T.L., Zuo, M., 2019. CropDeep: the crop vi- sion dataset for deep-learning-based classification and detection in precision agricul- ture. Sensors 19 (5), 1058.
