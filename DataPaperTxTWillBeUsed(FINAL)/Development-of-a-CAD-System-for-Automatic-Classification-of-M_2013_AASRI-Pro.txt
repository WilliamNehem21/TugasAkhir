Available online at www.sciencedirect.com
ScienceDirect

AASRI Procedia 4 (2013) 90 – 95


2013 AASRI Conference on Intelligent Systems and Control
Development of a CAD system for automatic classification of microcalcifications based on FPGA
Tiago A. Dócussea*, Alexandre C. R. da Silvaa, Aledir S. Pereirab, Norian Marranghellob
a São Paulo State University, Av. Brasil, 56, Centro, Ilha Solteira/SP, 15385-000, Brazil
b São Paulo State University, R. Cristóvão Colombo, 2265, Jardim Nazareth, 15054-000, Brazil




Abstract

This paper presents a Computer Aided Diagnosis (CAD) system that automatically classifies microcalcifications detected on digital mammograms into one of the five types proposed by Michèle Le Gal, a classification scheme that allows radiologists to determine whether a breast tumor is malignant or not without the need for surgeries. The developed system uses a combination of wavelets and Artificial Neural Networks (ANN) and is executed on an Altera DE2-115 Development Kit, a kit containing a Field-Programmable Gate Array (FPGA) that allows the system to be smaller, cheaper and more energy efficient. Results have shown that the system was able to correctly classify 96.67% of test samples, which can be used as a second opinion by radiologists in breast cancer early diagnosis.

© 2013 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license.
Selection and/or peer review under responsibility of American Applied Science Research Institute

Keywords: Image classification; Cancer detection; Mammography; Embedded software;








* Corresponding author. Tel.: +55-17-33210070.
E-mail address: tiagodocusse@gmail.com.










2212-6716 © 2013 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license. Selection and/or peer review under responsibility of American Applied Science Research Institute doi:10.1016/j.aasri.2013.10.015


Introduction

Computer-Aided Diagnosis systems have been built to aid medical doctors in diagnosing diseases and increase patients’ quality of life. Breast cancer is a disease that is the death cause of many women around the world [1], and the development of CAD systems can help doctors in early detecting it, this being the best way to reduce the number of people that die because of this disease [2]. CAD systems for breast cancer early detection can be developed to detect and classify microcalcifications, small calcium accumulations that can be present in breast tissue and be the first sign of a tumor not perceivable in palpable examinations [3].

Le Gal classification scheme

In order to aid radiologists in deciding whether a tumor is malignant or not, Michèle Le Gal developed a classification scheme [4] widely used in Europe [5] that differentiate microcalcifications into five types, and depending on the number and type of these elements it is possible for a radiologist to decide whether a tumor is malignant or not without the need for surgeries, avoiding their complications and reducing the need for recurrent treatment [2]. This classification scheme is based on the morphology of microcalcifications, and samples of microcalcifications from each of the five types are displayed in Fig. 1 [6].
The main difference between these types is that microcalcifications from type I are rounded but with their interior unfilled; microcalcifications from type II and type IV are also rounded but with their interior filled, the difference between them being the smoothness of their borders (the ones from type II are smooth while ones from type IV have rugged borders); microcalcifications from type III are very small and the ones from type V have worm format. Table 1 shows the percentage of malignant tumor associated with each type, according to the classification of Le Gal [6].

(a)	(b)	(c)	(d)	(e)

Fig. 1 Types of microcalcification according to the Le Gal classification scheme (a) type I; (b) type II; (c) type III; (d) type IV; (e) type V. Table 1. Percentage of malignant tumor associated with each type of microcalcification.




Fig. 2. Components of the designed hardware.

Related work

Several papers have been published in the area of breast cancer detection, and several tools have been used to provide CAD systems a way to aid doctors in early detection of this disease, like the wavelet transform [7], ANN [8-9], the pyramid steerable transform [10] and support vector machines [11-13]. The main drawback of those CAD systems is that none of them classify microcalcifications into the five types proposed by Michèle Le Gal. Pereira proposed a method [6] that uses the Hough transform to classify them according to this classification scheme, but its classification of microcalcifications from types II and IV is not ideal.

Method explained

The developed CAD system described on this paper is an embedded system whose software was developed in the C++ programming language and hardware designed with the Altera SOPC Builder. The hardware was compiled using the Altera Quartus 12.1 software and an Altera DE2-115 development board was programmed with it. Fig. 2 shows the components of the designed hardware.
The CPU component of the hardware is an Altera Nios II software processor that uses as its reset vector and exception vector the SDRAM on the board, containing 128MB of memory. There is a parallel port that communicates the board with four push buttons for user interaction. There is also a Secure Disk (SD) card reader on the board, and a Liquid Crystal Display (LCD) for displaying messages to the user. In order to user the system, the user inserts a SD card containing images to be processed on the SD card reader and chooses the one he wants to be processed using the push buttons on the board. Once the user chooses an image, it is processed by the software part of our CAD system, whose diagram is displayed on Fig. 3. The LCD shows the progress of the processing, and warns the user when it is done.


Fig. 3. Software logical schema.

The software part of our CAD system is composed by six steps, the three first ones being modifications of a previous system developed by ourselves [14] but with adjustments made to the region-growing algorithm used to detect microcalcifications on the input image, so instead of using a recursive solution, our algorithm controls its own stack of pixels to be analyzed. This modification resulted on a 73% reduction on memory


usage and a 40% reduction on time needed to process an image in comparison to the former algorithm, which is always desirable since the development on equipment with less memory than regular computers. On “Feature extraction” step, the system extracts four features from each microcalcification in order to differentiate microcalcifications from the five types: area (type III microcalcifications are very small), average gray value (type I microcalcifications have average gray value lower than the others), smoothness index calculated according to [14] (to differentiate microcalcifications from types II and IV), and the ratio between length and width of the microcalcification (type V microcalcifications are the only ones that do not have rounded shape). To compute the length of a microcalcification we created an algorithm that detects the longest Euclidian distance between two pixels (length), and then compute the width as the longest distance between two pixels on the perpendicular direction to the computed length. On “Classifier” step, the system uses the four extracted features on previous step as the input of a multiplayer ANN that has four neurons on its input layer (one for each feature), twelve neurons at the hidden layer and five neurons on the output layer (one for each type of microcalcification). The ANN was trained with the backpropagation learning algorithm using eighty (80) simulated samples of microcalcifications as the learning set (sixteen of each type). Microcalcifications with area inferior than 5 are considered false positives [15]. Results are written on the root of a SD card connected to the board as an eXtensible Markup Language (XML) file containing identification, values of extracted features and the final classification of each microcalcification. An image with microcalcifications automatically labeled is written on the root of the SD card as well, in order to make it easier for the user to identify each microcalcification on the XML file. Fig. 4 shows an example of an image with microcalcifications automatically labeled and Fig. 5 shows the CAD system running on the Altera DE2- 115 board.

Fig. 4. Output figure with microcalcifications automatically labeled.


Fig. 5. Altera DE2-115 board with the proposed system in execution.

Results

We used fourteen images from a personal database to test our system, each one containing a simulated sample of a microcalcification of each type based on real images, and simulations of high frequency objects and blood veins, in order to analyze the detection of false positives, resulting in seventy images of microcalcifications, each one different to the ones on the learning set. Also, we used SciLab to add Gaussian


noise to these images, resulting in 210 images to test our system. We saved all test images on a SD card, connected it to the board, processed each image and collected the data. Table 2 shows the percentage of microcalcifications successfully and unsuccessfully classified as one of the five types of Le Gal classification scheme.
Table 2. Percentage of microcalcifications successfully and unsuccessfully classified


Results showed that the system was able to successfully classify microcalcifications from all types. During our tests no false positives were detected by the system. Also, in every test image all microcalcifications were detected, despite the addition of noise on these images. Each image took on average approximately 2.7 s to be processed and no drawbacks were found in executing the system on the Altera DE2-115 board, thus providing an option to create a CAD system that is cheaper, smaller [16] and more energy efficient [16-17] than if it was developed to be executed on regular computers.

Conclusion

The system presented on this paper was able to successfully classify microcalcifications from the five types proposed by Michèle Le Gal, and the use of the Altera DE2-115 and the Altera Nios II processor made it possible to be developed. We are now trying to acquire more images of mammograms to further analyze our system.


Acknowledgements

This work was carried out with the financial support of CNPq (National Council for Scientific and Technological Development) Process N. 309023/2012-2.


References
INTERNATIONAL AGENCY FOR RESEARCH ON CANCER, “Globocan 2008: Country fast stat” 2010.
WORLD HEALTH ORGANIZATION, World Cancer Report 2008, WORLD HEALTH ORGANIZATION, Lyon, 2008.
C. S. Huang and C. Y. et al Wu, “Microcalcifications of non-palpable breast lesions detected by ultrasonography: correlation with mammography and histopathology” Ultrasound Obstet Gynecol, 1999, 13(6): 431–436.
M. LE GAL, D. PELLIER, and G. CHAVANNE, “Valeur diagnostique des microcalcifications groupées découvertes par mammographies” Bull Cancer, 1984, 71: 57–64.


F. ZANCA and D. P. et al Chakraborty, “An improved method for simulating microcalcifications in digital mammograms” Medical Physics, 2008, 35(9): 4012–4018.
A. S. PEREIRA, Processamento de imagens médicas utilizando transformada de Hough, Ph.D. thesis, Sao Paulo University, 1995.
C. B. R FERREIRA and D. L. BORGES, “Analysis of mammogram classification using a wavelet transform decomposition” Pattern Recognition Letters, 2003, 24: 973–982.
A. P. DHAWAN and Y. S. et al CHITRE, “Classification of mammographic microcalcification and structural features using an artificial neural network” in Annual International Conference of the IEEE Engineering in Medicine and Biology Society, 1991, 13: 1105–1106.
R. R. HERNÁNDEZ-CISNEROS and H. T. TERASHIMA-MARÍN, “Evolutionary neural networks applied to the classification of microcalcification clusters in digital mammograms” in IEEE Congress on Evolutionary Computation, Vancouver, 2006, pp. 2459–2466.
A. B. HUDDIN, B. W. H. NG, and D. ABBOTT, “Investigation of multiorientation and multiresolution features for microcalcifications classification in mammograms” in Seventh International Conference on Intelligent Sensors, Sensor Networks and Information Processing, 2011, pp. 52–57.
A. TIRTAJAYA and D. SANTIKA, “Classification of microcalcification using dual-tree complex wavelet transform and support vector machine” in Second International Conference on Advances in Computing, Control and Telecommunication Technologies, 2010, pp.164–166.
J. DHEEBA and T. SELVI, “Classification of malignant and benign microcalcification using svm classifier,” in International Conference on Emerging Trends in Electrical and Computer Technology, 2011, pp. 686–690.
S. LAHMIRI and M. BOUKADOUM, “Dwt and rt-based approach for feature extraction and classification of mammograms with svm” in 2011 IEEE Biomedical Circuits and Systems Conference, 2011, 24: 412–415.
T. A. DOCUSSE and A. S. et al PEREIRA, “Microcalcification border characterization using wavelets on digital mammograms” IEEE Engineering in Medicine and Biology Magazine, 2009, 28(5): 41–43.
A. M. SCARANELO, “Leite de cálcio” Revista da Associacão Médica Brasileira, 2004, 50(2): 122–122.
J. U. CHO and S. H. et al Jin, “Fpga-based real-time visual tracking system using adaptive color histograms” in IEEE International Conference on Robotics and Biomimetics, 2007, pp. 172–177.
C. TTOFIS and T. THEOCHARIDES, “Towards accurate hardware stereo correspondence: A real-time fpga implementation of a segmentation-based adaptive support weight algorithm” in Design, Automation & Test in Europe Conference & Exhibition, mar 2012, pp. 703–708.
