Available online at www.sciencedirect.com
ScienceDirect

AASRI Procedia 4 (2013) 202 – 205


2013 AASRI Conference on Intelligent Systems and Control
Modeling NRPs with Soft and Reified Constraints
Ricardo Sotoa,b*, Broderick Crawforda,c, Rodrigo Bertranda, Eric Monfroyd
aPontificia Universidad Católica de Valparaíso, Av. Brasil 2950, Valparaíso, Chile bUniversidad Autónoma de Chile, Av. Pedro de Valdivia 641, Santiago, Chile cUniversidad Finis Terrae, Av. Pedro de Valdivia 1509, Santiago, Chile
dCNRS, LINA, University of Nantes, 2 Rue de la Houssinière, Nantes, France




Abstract

A nurse rostering problem (NRP) deals with the shifts arrangements of nursing staff in the daily operation of a given health care center. This problem is known to be complex mainly due to its combinatorial nature that commonly requires exponential time to be solved. The literature presents a large list of works devoted to solve NRPs, however most of them are focused on the performance of results of well-known NRP instances, and just a few address real cases. In this paper we present a study of real nurse rostering, which particularly involves a very uncommon shift pattern due to proper country legal regulations. We introduce a new model including soft constraints that can be efficiently solved by employing reified constraints.

© 2013 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license.
Selection and/or peer review under responsibility of American Applied Science Research Institute

Keywords: Optimization; Constraint Programming; Nurse Rostering


Introduction

Nurse rostering consists in producing a schedule of shift assignments for a given period of time satisfying a set of constraints. The problem is known to be challenging mainly because the number of variables and the



* Corresponding author. Tel.+56 32 2273659; fax: .+56 32 2273859
E-mail address: ricardo.soto@ucv.cl










2212-6716 © 2013 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license. Selection and/or peer review under responsibility of American Applied Science Research Institute doi:10.1016/j.aasri.2013.10.031

Ricardo Soto et al. / AASRI Procedia 4 (2013) 202 – 205	203

complexity of constraints. Hospital management policies, government regulations, minimum area allocation, different required nurse skills, as well as the fairness among nurses define the constraints of the problem. Different commercial and generic solutions have been proposed to tackle this problem. However they usually fail to satisfy the given requirements due to the wide variety of constraints from one scenario to another. Health centers therefore try to design tailored solutions in order to satisfy their specific policies and operation mechanisms.
Nurse rostering has been largely studied from the seventies. Classic and exact methods from the mathematical programming area were early used to tackle such a problem [4]. From the nineties, metaheuristics have taken an important place in the rostering research. Different solutions have been proposed, some examples use tabu search [2], simulated annealing [13], genetic algorithms [8], variable neighborhood search [7], electromagnetic metaheuristics [9]. In the context of complete search, constraint programming has been also strongly involved in nurse rostering, some examples can be seen in [1, 6, 11, 10, 14]. However, most work is focused on the efficient solving of well-known instances; and the work devoted to real cases of nurse rostering is quite limited.
This paper presents the study of a real case of nurse rostering in mid-size Chilean health care centers. We take as sample three clinics and four hospitals that collect the main features of those health centers (similar size, organization and amount of nurses). The problem is represented as a CSP (Constraint Satisfaction Problem) involving soft and hard constraints, and solved with CP (Constraint Programming) algorithms via the JaCoP solver. We believe that this work will be useful to increase the experience in real cases of nurse rostering as well as to future NRP researchers.

CP

CP is a relatively modern software technology devoted to the efficient solving of problems subjected to constraints. The main features of this paradigm are inherited from different and relevant domains of computer science such as operational research, programming languages, and artificial intelligence. In CP, a problem is formally stated as a CSP, which is composed of a finite sequence of variables		; the associated set of domains, that is,		, and a set of constraints		. A solution to a CSP is an assignment	such that    	; and the set C is satisfied [3].

The NRP model

Mid-size health care centers in Chile employs a particular type of shift assignment called the ``fourth shift'' system. This system is quite uncommon do not fitting with the common 8 hours-shift system used in most hospital and research papers. The ``fourth shift'' system considers two shifts of 12 hours per day: D and N. D corresponds to a day shift (from 08:00 until 20:00); and N corresponds to a night shift (from 20:00 until 8:00 of the next day).

Constraints for nurses

The “fourth shift” considers 12 hours shifts sequentially ordered as shown below:

We consider a 28 days-planning to cover the 28 possible combinations of 4 (the number of shifts within a cycle) x 7 (the number of week days). Then, taking into account the set of nurses	, the set of

204	Ricardo Soto et al. / AASRI Procedia 4 (2013) 202 – 205


days , and the set of variables   , where 0=day off, 1=D, and 2=N, the constraints are modeled as follows:

	A D shift precedes a N shift which in turn precedes a day off,	:

		A N shift precedes two day off, which in turn precedes a D shift,  	:
Now, in order to guarantee the required nurse allocation and off nurses per day, the occurrences global constraint is included.		guarantees that Val occurs Num times in the list named Vars. Let  denote the set of variables			. Then, the required constraints are:	,		, and		.

Soft Constraints

Soft constraints allows one to model preferences. For instance, in the studied health-care centers, there exist nurses holding a senior position able to suggest some preferences on the schedule. As common CP solvers do not provide primitives to directly handle soft constraints, we model the soft constraints by using reified constraints. A reified constraint reified(ck,Bk) assigns 1 (true) to the variable Bk if the constraint ck is satisfied; and it assigns 0 (false) otherwise. Then, the idea is to maximize the summation of Bk variables as follows, assuming   , where p is the number of preferences: maximize 
Then, the constraint satisfaction problem is naturally transformed into an optimization problem. As an
example, let us consider three preferences: c1: Nurse 5 prefers not to be off on day 1; c2: nurses 2 and 4 prefer to start with a day shift. c3: nurse 11 prefers to be off the third weekend of the cycle. Those constraints can be modeled as follows: c1: V5,1  0; c2: V2,1 = 1  V4,1 = 1; c3: V11,20 = 0  V11,21 = 0. Finally, we impose three reified constraints and the corresponding objective function in order to obtain a solution:
reified (c1,B1)  reified (c2,B2)  reified (c3,B3) maximize 
The implementation in JaCoP is depicted in the following. Firstly, the result of reified constraints is stored
in an array called B. Then, the summation  is stored in the summation variable at line 4, which is then imposed in the store of constraints. At line 6, a variable cost with a domain [-INF, 0] is initialized. Then, at line 7, the value of summation is multiplied by -1and assigned to the cost variable. This is done since JaCoP only minimizes, thus, it is mandatory to invert the value of the summation variable. Finally, the labeling method triggers a branch and bound algorithm using as cost function the cost variable.
store.impose(new Reified(c1, B[1])) ;
store.impose(new Reified(c2, B[2])) ;
…
Sum summation = new Sum(B, summation) ;
Store.impose(summation) ;
cost = new IntVar(store, "Cost", -INF, 0) ;
store.impose(new XmulCeqZ(summation, -1, cost)) ;
boolean result = search.labeling(store, select, nrp.cost) ;

Ricardo Soto et al. / AASRI Procedia 4 (2013) 202 – 205	205

Conclusions

This paper addressed a NRP study for a set of chilean mid-size health care centers. We have presented a model that handles a very uncommon shift pattern and the nurse preferences via soft constraints. Soft constraints have been modeled by using reified constraints in conjunction with an objetive function in order to maximize the number of preferences satisfied. In this way, the model becomes an optimization problem that has been solved in the JaCoP solver. Rosters are automatically generated in about 20 minutes considering 40 nurses. The approach presented here can naturally be extended by considering bigger health care centers and more complex soft constraints. Using metaheuristics and autonomous search [5, 12] will be an interesting research direction to pursue as well.


References
Bourdais S, Galinier P, Pesant G (2003). Hibiscus: A constraint programming application to staff scheduling in health care. In Proceedings of CP, volume 2833 of LNCS, pages 153–167. Springer.
Burke E, Causmaecker PD, Berghe GV (1999). A Hybrid Tabu Search Algorithm for the Nurse Rostering Problem. In Proceedings of SEAL, volume 1585 of LNCS, pages 187–194. Springer.
Bessière C. (2006). Handbook of Constraint Programming, ch. Constraint Propagation, pages 29–84. Elsevier.
B. Cheang, H. Li, A. Lim, B. Rodrigues (2003): Nurse rostering problems - a bibliographic survey. European Journal of Operational Research 151(3): 447-460
Crawford B, Soto R, Monfroy E, Palma W, Castro C, Paredes F (2013). Parameter tuning of a choice- function based hyperheuristic using Particle Swarm Optimization. Expert Syst. Appl. 40(5): 1690-1695.
Li H, Lim A, Rodrigues B (2003). A hybrid AI approach for nurse rostering problem. In Proceedings of SAC, pages 730–735. ACM Press.
Lü Z, Hao JK (2012). Adaptive neighborhood search for nurse rostering. European Journal of Operational Research, 218(3):865–876.
Maenhout B, Vanhoucke M (2011). An evolutionary approach for the nurse rerostering problem. Computers & OR, 38(10):1400–1411.
Maenhout B, Vanhoucke M (2007). An electromagnetic meta-heuristic for the nurse scheduling problem. J. Heuristics, 13(4):359–385.
Métivier JP, Boizumault P, Loudni, S (2009). Solving Nurse Rostering Problems Using Soft Global Constraints. In Proceedings of CP, volume 5732 of LNCS, pages 73–87. Springer.
Pizarro R, Rivera G, Soto R, Crawford B, Castro C, Monfroy E (2011). Constraint-based nurse rostering for the Valparaíso clinic center in chile. In Proceedings of HCI International 2011, volume 174 of CCIS, pages 448–452. Springer.
Soto R, Crawford B, Monfroy E, Bustos V (2012). Using Autonomous Search for Generating Good Enumeration Strategy Blends in Constraint Programming. In Proceedings of ICCSA, , volume 7335 of LNCS, pages 607-617, Springer.
Thomson G (1996). A Simulated Annealing Heuristic for Shift-Scheduling Using Non-Continuously Available Employees. Computers and Operations Research, 23:275–288.
Qu R, He F (2008). A hybrid constraint programming approach for nurse rostering problems. In Proceedings of SGAI, pages 211–224.
