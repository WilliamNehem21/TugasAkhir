Available online at www.sciencedirect.com
ScienceDirect

AASRI Procedia 6 (2014) 34 – 40


2013 2nd AASRI Conference on Computational Intelligence and Bioinformatics
A Novel Improved Truncated Unscented Kalman Filtering Algorithm
Chao Hou, Liang-qun Li*
ATR Key Laboratory, Shenzhen University, Shenzhen, GuangDong 518060, P.R.China




Abstract

For the conventional truncated unscented Kalman filtering (TUKF) algorithm requires the measurement to be a bijective function, a novel improved truncated unscented Kalman filtering is proposed. In the proposed algorithm, we linearize the bijective measurements function based on the statistical linear regression (SLR) in order to obtain the only inverse function of the measurement function. It is a modified algorithm which extends the range of practical application of the filtering problems. Finally, the experiments show that the performance of the proposed algorithm is better than the unscented Kalman filter (UKF) and the quadrature Kalman filter (QKF). This approach can efficiently deal with this problem that measurement functions are not bijective.
© 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).
Peer-review under responsibility of Scientific Committee of American Applied Science Research Institute
Keyword: Truncated Unscented Kalman Filtering; Statistical Linear Regression; Linearization of the Measurements Function


Introduction

Estimation refers to estimate the parameters or some state variables from the observed data with random error. Filtering is estimating the current signal value of the state of the process by the observed value from real time indirect measurement. The optimal approximation to the nonlinear filtering problem demands a complete



* Corresponding author. Tel.: +0-755-2673-2055; fax: +0-755-2673-2049.
E-mail address: lqli@szu.edu.cn.










2212-6716 © 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).
Peer-review under responsibility of Scientific Committee of American Applied Science Research Institute doi:10.1016/j.aasri.2014.05.006


representation of the obtained posterior distribution. For most problems the posterior probability density function (PDF) of the state is difficult to handle so approximations are required which involves two steps: prediction and update [1] .
UKF approximates the nonlinear distribution through deterministic sampling to capture the Gaussian variables with covariance and mean. The accuracy and stability is superior to EKF. UKF is increasingly concerned and has been widely used. The truncated Kalman filter (TKF) proposes a modified prior PDF in the Kalman filtering process, which improves the performance of Kalman filtering effectively. TUKF approximates the TKF when the measurements are informative. The main limitation of TUKF is that it requires the measurement function of the state be bijective. This paper modifies the limitations of TUKF algorithm using SLR for linearization of measurement functions. The simulations show that the computation of the presented algorithm is equivalent to other Gaussian approximation, but the filtering performance is better than other filtering method.
The outline of this paper is arranged as follows. In Section 2, the nonlinear model of Kalman filtering is presented. In Section 3, a novel improved truncated unscented Kalman filtering is present, including the principle and concrete steps of the algorithm. The experiment and analysis are provided in Section 4.

Kalman Filter for Nonlinear Environment

Consider a discrete nonlinear system, we assume the measurement equation as follows:




where
zk  h(xk )  wk
xk  Rnx denotes the system state,


z  Rnz


denotes the measurement of the system,
(1)
h() denotes a

known nonlinear function, the measurement noise wk is presumed to be Gaussian with covariance R (k ) and

zero mean. We suppose p () the prior distribution of x , the MMSE xˆk |k
are[2]:
and covariance Pk |k of x k given z



xˆk|k  E[xk zk ]
(2)



Pk|k
 E[(xk
 xˆ

k|k
)(xk
 xˆ

k|k
)T z ]

(3)

Calculating xˆ k |k
and Pk|k
directly is very difficult due to the integration. Kalman filtering provides the

[3]
linear MMSE estimator of xk given z , xˆ


xˆu,0,k|k
 xˆ

p,0,k|k 1
 Pxz,k|k 1
1
zz,k|k 1
(zk
 zˆ0 )

(4)

Where

zˆ0  E[zk ]   E[zk xk ] p0 (x)dxk



(5)






zz,k|k1
	k


0  k	0	k  0	k

(6)





xz,k|k 1
k  k	

k	p,0	k	0	k	0	k

(7)

where xˆp ,0,k|k 1 denotes the mean of the prior probability of xk .Then the updated covariance can be estimated as follows


Pu ,0,k|k
 Pp,0,k|k 1
 Pxz,k|k 1
1
zz ,k|k 1
T
xz,k|k 1

(8)

where Pp,0,k|k 1 is the covariance of the prior probability.

Modified Truncated Unscented Kalman Filter

Truncated unscented Kalman filter

Consider a discrete nonlinear system, we assume the measurement equation as follows:


zk  h(ak )  wk
(9)

where h() is the nonlinear function of ak . Supposing h() is bijective and the PDF of the additive noise is
bounded, then the joint prior PDF p () is defined based on p (x ; z ) and p (x ) as follows[5]:

2
p2 (xk ; zk )  α0 p1 (xk ; zk )  (1  α0 ) p0 (xk )
1  k  k	0  k
(10)

where α0 [0,1] . Suppose
xˆ p,1
and
Pp,1 denote the mean and covariance matrix of
p1 ()
respectively, the

updated covariance and mean is
xˆu ,2  αxˆu ,1  (1  α )xˆu ,0

(11)

Pu,2
 α[Pu,1
(xˆu,1
 xˆu,2
)(xˆu,1
 xˆu,2
)T ]  (1α)[P
(xˆu,0
 xˆu,2
)(xˆu,0
 xˆu,2
)T ]
(12)

where
α  	α 0	 , α [0,1] maintains the degree of freedom of α . The detailed derivation of the
[α 0  (1  α 0 )ε1 ]

TUKF algorithm can be found in [6].
Approximation of h1 (zk )

To approximately compute h1 (z ) , our purpose is to get a linear estimation of zk , zˆ  H x  d , where
Hk is a matrix and dk is a vector. They are depend on the minimum of the mean-squared error [7] using SLR

{H , d }  arg min E(a T a )
m	m
(13)

H  PT P1 [w (x  x )(z  z )T ]T [w (x
 x )(x
 x )T ]1

k	xz xx
kl
l1
k	kl	k
l kl
l1
k	kl	k
(14)


	
dk  zk  Hk xk
(15)


Modified truncated unscented Kalman filtering algorithm

Assume at time k 1 that the mean xˆk 1|k 1 and variance Pk 1|k 1 of the state is known, and the process noise wk and the measurement noise vk are independent, whose means are zero and covariances are Qk and R . Our objective

is approximately calculate the first two moments xˆk|k and Pk|k of the posterior PDF px | z
based on the current

measurement zk .
k  1:k



Unscented transformation and time update

According to the reference [6], we can first obtain N  2na  1 sigma points λ1 , λ2 ..., λN


and the associated

0  0	0

weights w , w ,..., w
using UT[8], where n
 n  n  n
, The one-step predicted sigma points are acquired

1  2	N	a	x	v	w
using the nonlinear state function f () :

i
0 ,k |k 1
 f (λi ),
i  1,2,… , N
(16)

Therefore, the first two moments of the predicted PDF p x | z	 can be approximated as

xˆ	  w χ i
0  k  1:k 1

p,0,k|k 1
i
i1
N
0,k|k 1
(17)

P	 Q   w (χ i
 xˆ
)(χ i
xˆ )T

p,0,k|k 1
k	i
i1
0,k|k 1
p,0
0,k|k 1
p,0
(18)



Measurement update

Update measurement based on the prior p0 x 

To  approximately  compute  the  predicted  measurement










zˆ0,k|k 1




,  the  one-step  predicted  sigma

points χ i	N are propagated through the measurement model h() as follows:
0,k|k 1 i1
zi	 h(χ i	), i  1,2,…, N

0,k|k 1
0,k|k 1
(19)

the predicted measurement can be estimated as
N

zˆ0,k|k 1
i  j
0,k|k 1
i1
(20)

according to (19) and (20), the innovation covariance is estimated as
m
P	 R   w (zi	 zˆ	)(zi	 zˆ	)T

zz,k|k 1
k	i
i1
0,k|k 1
0,k|k 1
0,k|k 1
0,k|k 1
(21)

the cross covariance is calculated as
m

P	  w ( χ i
xˆ
)( z i
zˆ	)T

xz ,k |k 1
i
i 1
0 ,k |k 1
p , 0 ,k |k 1
0 ,k |k 1
0 ,k |k 1
(22)

the error covariance is computed as
m

P	 w (χi	 xˆ	)(χi
xˆ	)T

xx,k|k1	i  0,k|k1	p,0,k|k1	0,k|k1
i1
p,0,k|k1
(23)


Consequently, according to (21-23), the first two moments of the posterior PDF p0 xk | z1:k  based on the prior p0 x can be approximately computed as follows:

xˆu ,0,k|k
 xˆ

p,0,k|k 1
 Pxz,k|k 1
1
zz ,k|k 1
(zk
 zˆ
0,k|k 1 )
(24)

Pu , 0 ,k |k
 Pp , 0 ,k |k 1
 Pxz ,k |k 1
1
zz ,k |k 1
T
xz ,k |k 1
(25)


Measurement update based on the modified prior
According to (14) and (15) in section 3.2, the linear regression coefficients Hk and dk can be computed by using the (22-23) as

H k	xz ,k |k 1
 1
xx ,k |k 1
(26)

d k  zˆ0 ,k |k 1  H k xˆ p , 0 ,k |k 1
Then, the measurement equation (1) can be written as a linear function:
zk  h(xk )  wk  Hk xk  dk  wk
(27)

(28)

The first two moments xˆp,1,k|k 1 and Pp,1,k|k 1 of
μa ,1 
p1 x can be approximately computed as

xˆ p ,1,k|k 1  

μ

b ,1 

(29)

a ,1 in (29) can be approximately calculated as
μ   a p (a ; z )da  h 1 (z )  H  z  d 

a,1   k  1  k  k	k

k	k	k	k
(30)

a ,1
Pp ,1,k|k 1  
(
ab ,1  
)T  	

	ab ,1
b ,1  
(31)

where μb,1 , a,1  b,1 and 	can be computed according to [6].
Since the sigma points λi , w  do not reflect the uncertainty due to the modified prior p1 x , we draw
0  i

N sigma points
1
1,k|k 1
2
1,k|k 1
N
1,k|k 1 with the associated weights w , w ,.	w
using the UT based on the

1	2	N
mean xˆ	and variance Pp,1,k|k 1 . The predicted measurement and covariance is similar to the (19-23), then
the first two moments of the posterior PDF p1 xk | z1:k based on the prior p1 xcan be approximately computed as follows:

xˆu ,1,k|k
 xˆ

p ,1,k|k 1
 Pxz1,k|k 1
1
zz1,k|k 1
( zk
 zˆ1,k|k 1 )
(32)

Pu ,1,k |k
 Pp ,1,k |k
 Pxz1,k|k 1
1
zz1,k|k 1
T
xz1,k|k 1
(33)

Finally, the update mean and covariance are
xˆk|k  αxˆu ,1,k|k  (1  α )xˆu ,0,k|k

(34)


Pk|k

 α [Pu,1,k|k
 (xˆ


u,1,k|k
xˆ


k|k
)(xˆ


u,1,k|k
xˆ


k|k
)T ]  (1  α ) P
 (xˆ


u,0,k|k
 xˆ


k|k
)(xˆ


u,0,k|k
 xˆ


k|k
)T 
(35)

Where α  	γtr(a,0 )	 can be found in [6].
γtr(a,0 )  (1  γ )tr(a,0 )


Simulation Results

In this section, we present the result using a nonlinear model. The DSS equations for this model can be written as
f (x)  0.5  x  25  x /(1  x^2)  8  cos(1.2  t)  wk


h ( x )  
0 .2 * x 2  v
,k  30

 0 .5 * x 3  2  v
, k  30

where wk ~ N (0,1), vk ~ N (0,5) . Data were produced using α  1, β  0,κ  2 .We compare the performance of the improved TUKF with UKF and QKF using Monte Carlo simulation with 100 runs. The estimation of the state using improved TUKF, UKF, QKF and the real state are present in Fig.1.

25

20

15

10

5

0

-5

-10

-15

-20


-25


0	10	20	30	40	50	60



Fig. 1. The Mean and Covariance




18

16

14

12

10

8

6

4

2

0
0	10	20	30	40	50	60


Fig.2. The Performance of Filters

The MSE of UKF, QKF and improved TUKF are shown in Fig.2. We should realize that the mean and covariance of improved TUKF is lower than UKF and QKF. The performance of improved TUKF is higher than other filters.
Finally, in order to take into account the influence of parameters in the algorithm, we change the value of the covariance of measurement noise Q and process noise R , the performance of algorithm is shown in table 1.
Table 1. The mean and covariance of filters for different process noise parameters





According to the simulation results above, it is clear that the function of the algorithm is preferable if the measurement noise is larger. However, if the process noise is smaller, the results is not good enough, even the performance of improved TUKF is not as good as UKF and QKF.

Conclusions

The proposed algorithm linearizes the measurement function using SLR based on TUKF for the nonlinear filtering. It can deal with the situation when the measurement is not bijective. On this condition the algorithm extends the range of application of the filter. Simulations show that in general, the improved TUKF performs better than UKF and QKF.


Acknowledgements

This work was supported by the National Natural Science Foundation of China (61301074, 61271107), Research Fund for the Doctoral Program of Higher Education of China (20104408120001), Natural Science Foundation of the Guangdong Province of China (S2012010009417), Key Project of National Science & technology of pillar program (2011BAH24B12).


References
[1] M. Arulampalam, S. Maskell, N.Gordon, and T. Clapp, “A tutorial on particle Filter for online nonlinear/non-Gaussian Bayesian tracking,” IEEE Trans. Signal Process., vol. 50, no. 2, pp.174-188,Feb.2002. [2]Y. Bar-Shalom, T. Kirubarajan , and X. R. Li, Estimation with Applications to Tracking and Navigation . Hoboken, NJ: Wiley, 2001.
S. M. Kay, Fundamentals of Statistical Signal Processing: Estimation Theory. Englewood Cliffs, NJ: Prentice-Hall, 1993.
K. Burdett, “Truncated means and variances,” Econ. Lett., vol. 52, pp.263–267, 1996.
A. F. García-Fernández, M. R. Morelande, and J. Grajal, “Nonlinear filtering update phase via the single point truncated unscented Kalman filter,” in Proc. 14th Int. Conf. Inform. Fusion, 2011, pp. 17–24.
Ángel F.García-Fernández, Mark R.Morelande, Jesús Grajal,“Truncated Unscented Kalman Filtering,” IEEE Trans. Signal Process., vol. 60, no. 7,July 2012.
Ienkaran Arasaratnam, Simon Haykin, “Discrete-Time Nonlinear Filtering Algorithms Using Gauss– Hermite Quadrature,” PROC.IEEE,vol.95,no.5,May 2007.
S. J. Julier and J. K. Uhlmann, “Unscented filtering and nonlinear estimation, ”Proc. IEEE, vol. 92, no. 3,
pp. 401–422, Mar. 2004.
