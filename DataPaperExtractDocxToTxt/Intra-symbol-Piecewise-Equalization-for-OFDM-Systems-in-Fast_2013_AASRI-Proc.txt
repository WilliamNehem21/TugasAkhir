Available online at www.sciencedirect.com
ScienceDirect

AASRI Procedia 5 (2013) 32 – 39


2013 AASRI Conference on Parallel and Distributed Computing Systems
Intra-symbol Piecewise Equalization for OFDM Systems in Fast Fading Channels
Zhigang Chena, Lei Wanga*, Pinyi Rena
a Xi'an Jiaotong University, No.28, Xian Ning West Road, Xi’an, China



Abstract

Based on intra-symbol piecewise linear channel model, a novel piecewise equalizer is proposed for OFDM systems in high mobility environment. In this proposed scheme the complex ICI caused by fast fading channels has been resolved as new OFDM subsystems' simple ISI and lower ICI, respectively caused by the average channel and the time-varying channel over a piece-period. By further employing the characteristics of the channel matrix, a successive `ISI' and `ICI' mitigation based equalization with low complexity has been realized. Simulation results show that the proposed scheme has lower computation complexity than the comparative one, while perserving good performance.

© 2013 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license.
Selection and/or peer review under responsibility of American Applied Science Research Institute

Keywords: Equalization; OFDM;Time-varying channels; Piecewise linear channel model


Introduction

By expanding the symbol duration and adding the cyclic prefix, OFDM systems can easily overcome the multi-path dispersion by simple 1-tap equalization [1]. On the other hand, OFDM systems become more susceptible to time-variations as symbol length increases. Hence, the equalization over fast fading channels becomes a challenging and important issue for OFDM systems [2].



* Corresponding author. Tel.: +86-29-82668772-549; fax: +86-29-82667951
E-mail address: lei.wang@mail.xjtu.edu.cn









2212-6716 © 2013 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license. Selection and/or peer review under responsibility of American Applied Science Research Institute doi:10.1016/j.aasri.2013.10.055


The existing equalization schemes over fast fading channels can be roughly divided into 2 classes, namely, pure-equalization and turbo-equalization. The pure-equalization schemes usually assume the channel information completely known by the receiver, and focus on low complexity data symbol estimation by fully using the channel characteristics [1],[3]-[4]. While the turbo-equalization schemes estimate the channel and/or data symbol and equalize the channel alternatively and iteratively, and generally perform better than the former at the cost of higher complexity [5]-[6]. Despite the rigorous requirement of complete time varying channel information, pure-equalization schemes with low complexity still preserve their importance. First, because the tradeoff between the equalization performance and complexity is still a challenging problem, even with complete channel information [3]. Second, because turbo-equalization schemes usually employ pure-equalization as data symbol estimation component.
Inspired by the piecewise linear channel model in [2], a low complexity intra-symbol piecewise pure- equalization scheme over the fast fading channels is proposed in this paper. Based on the intra-symbol piecewise linear channel model, the complex ICI caused by the fast fading channel is resolved as the new OFDM subsystems’ simple ISI and lower ICI, respectively caused by the average channel and time-varying channel over a piece-period. By fully exploiting the piecewise linearity of time varying channels, a successive ISI and ICI mitigation based equalization is realized with low complexity.
This paper is organized as follows. Section 2 introduces the intra-symbol piecewise OFDM system model and section 3 describes the proposed equalization scheme. Further complexity analysis and some simulation examples to demonstrate the performance of the proposed scheme are provided in section 4 and 5 respectively. And conclusions are drawn in section 5.
Notation: ( )T and ( )H represent transpose and complex conjugate transpose (Hermitian), respectively. (A)UT and (A)LT denotes the upper triangular part (excluding the diagonals) and the lower triangular part (including the diagonals) of matrix A . diag(a) is a diagonal matrix with the vector a on the diagonal and

blkdiag( ) denotes block diagonal concatenation of the input arguments. Finally, IN and FN
identity matrix and FFT matrix respectively.

System Model and Assumption
denote the N  N


Consider an OFDM system with N subcarriers in a fast time-varying multipath channel. Let the fast

fading channel be expressed as time varying tapped delay line model
h(n,l),n
 0,1,  , N
1;l
 0,1,  , L 1 .

Assuming the channel’s maximum delay length L less than cyclic prefix length and perfect synchronization,

the time domain signal with CP removed at the receiver r
form [6] as
 [r(0), r(1),  , r(N
1)]T
can be written in matrix


r  HFH X  W	(1)


where X
 [ X (0), X (1),..., X ( N
1)]T
and W
 [W (0),W (1),  ,W (N
1)]T
are ‘frequency domain’ data vector and

additive white Gaussian noise (AWGN) vector respectively, and N  N time domain channel matrix H is the

circular form of N  L channel impulse response (CIR) matrix  with ( p, q)
circular shift operation on the CIR matrix as

H  CSHIFT(, N )
h( p
1, q
1) . And define the


(2)

(k,((k  m))N
1)	0
 k  m  L  1

H(k, m)	 ( N 1)
k  m else
( N  L)


where (())N represents a cyclic shift in the base of N .
To match the fast varying channel, the channel is further approximated as intra-symbol piecewise linear
model [7]. In this model the symbol period is divided into M  2 p pieces and p is a natural number, and the
CIR varies linearly in each piece-period. Let the average CIR vector hm in the m -th piece-period be denoted

as the middle instant CIR vector hm
 h(mN / M  N / (2M ),:)
as in [2], and the difference between the average

CIR vector in the (m
1) -th and m -th piece-period be denoted as
hm  hm
hm 1 . By using the CIR in the m -

th piece-period, define the (N / M )  ( N / M )
CIR matrix Hm
, Hm and Hm
as the circular form of (N / M )  L

the	CIR	matrix	m	with
m ( p, q)
h(mN / M  p
1, q 1)
,	average	CIR	matrix	m	with

m ( p, q)
h(mN / M  N / (2M ), q
1) , and linear variation CIR matrix	m with
m ( p, q)
hm (q
1) respectively,

which can be expressed as


Hm  CSHIFT(
m , N / M )
(3)




Hm  CSHIFT(
m , N / M )
(4)




	
Hm  Hm  Hm
 diag( 2M *(0 : ( N / M
2N
1))
N )CSHIFT( , N / M )
(5)


where the second equation in (5) is derived from the property of the piecewise linear channel model.

It can be derived that the channel matrices H and
2L  N / M .


Hm , Hm , Hm
satisfy the following matrix form if


H 



ISI
H

(6)

Due to the sparsity of the matrix (H )UT and the small channel difference between the neighbouring piece-
	
periods, the fourth term in the right hand is negligible. And let the first three terms be denoted by H , H and
H respectively.

Let the received signals in the m -th piece-period be denoted by rm
 [r(mM
 0), r(mM
1),  , r(mM
1  N / M )]T ,

then divide the ‘frequency domain’ data symbol X into M groups with the m -th data symbol group denoted

as Xm  [ X (m), X (m  1 M ), X (m
2 M ),
X (m  ( N
M
M )]T , the received signal r can be expressed by using the

M symbol groups {X }M 1 as


r  [(r )T (r )T

 (rM 1

)T ]T
 H
ISI
Y  H Y  H Y  W	(7)



where


p,q  e
j 2( p 1)( q 1)
M
, Em  diag(1,e

j 2m
N ,  ,e

j 2 ( N / M 1)m
N	) .

According to equation (7), the OFDM system can be equivalent as M subsystems, and the m -th subsystem is a new OFDM system with N / M subcarriers, data symbol Xm and subcarrier spacing f  M f , and experiences frequency offset of mf . Thus the IFFT modulated signal of the original OFDM system in each piece-period can be viewed as the weighted-sum of M OFDM subsystems’ symbols. Such intra-symbol
piecewise OFDM system model for M  2 has been shown in Fig. 1.


The first term and the second term in the right hand of equation (7) individually represents the M ‘symbols’ through the average channel and the linear time-varying channel in different piece-periods. The third term in the right hand of equation (7) represents the inter-symbol interference (ISI) of the OFDM subsystems owing to missing of cyclic-prefix between neighbouring symbols, which has also been shown in Fig. 1.
Based on such intra-symbol piecewise OFDM system model, the original OFDM system’s complex ICI caused by the fast fading channel has been resolved as the subsystems’ simple ISI and lower ICI, respectively caused by the time average channel and time-varying channel in multiple piece-periods. In the following section, a novel successive intra-symbol piecewise ‘ISI’ and ‘ICI’ mitigation method will be proposed to equalize the fast fading channel.


CP	OFDM Symbol


CP Generation


CP 1 rst New Symbol



H
0 N / 2  0


2nd New Symbol



H
0 N / 2  0


Channel Delay Spread effects

+	+	+
Sub-OFDM-System 1

CP 1 rst New Symbol
H
0 N / 2  0
2nd New Symbol
H
1 N / 2 1

Sub-OFDM-System 2


Fig. 1. Intra-symbol piecewise OFDM system model for M  2

Intra-symbol Piecewise Equalization Method

Since we focus on the equalization of time-varying channel, AWGN will not be considered in the
following description. For brevity, the intra-symbol piecewise equalization method for piece number M  2
will be described in detail first in this section, then such proposed method is generalized for piece number
M  2 p .
The equalization for each data group Xm is similar and composed of three steps: symbol modification,
‘ISI’ mitigation and ‘ICI’ mitigation. And the equalization for the m -th data group is introduced as following.

symbol modification

First the received samples are modified as

r  FH BF G r  HG FH X  HG ·Y	(8)

where the frequency offset rotation matrix Gm and modifying matrix B are N  N diagonal matrix with the

n -th diagonal element Gm (n,n)
e j 2 nm / N
and B(n,n)  [F HFH ](n,n) / [F HFH ](((n  m)) ,((n  m)) ) .

From (7) and (8), it can be derived that




FN /2r0
[ D0 E m X0 D0 E m 1X1
][ D0 E m X0 D0 E m 1X1
][ jm D0 E m X0 D0 E m 1X1  ]
(9)

FN /2r1
e jm ( D0 E m X0 D0 E m 1X1 )

Sig
e jm (D0 E m X0 D0 E m 1X1 )	e


Sig
( D0 E m X0 D0 E m 1X1 )
ISI
Sig



where Dm


 F  HmFH
, Em
 F  E FH
, D  F  H FH
, D  F


(Hm )UT FH
. For simplification, define the three

N /2 
N /2 
N /2 
m N /2 
m	N /2 
m  N /2 
N /2 
N /2 


		
terms in (9) as Sig , Sig and Sig respectively.
‘ISI’ mitigation

From (9), the m -th ‘ISI’ free data group estimate Xm satisfies the following formula

 			

D0 E m X0 D0 E m 1 X1


e jm (D0 E m X0 D0 E m 1 X1 )
Sig  Sig	(10)


By subsitituting (10) into (9), we have



 	
D0 E m X0 D0 E m 1 X1
e jm (D0 E m X0 D0 E m 1 X1 )


FN /2r0
FN /2r1
ISI
Sig	(11)



From (11), the ‘ISI’ free data symbol estimate Xm can be further approximated as

	

Xm
{(Dm )
FN / M rm }
(12)





with estimate error Errm


 [(D0 ) 1D0


(D1 ) 1D1 ][(1


e jm )E m X
 (1  e jm )E m 1X ] . Thanks to the sparsity of matrix

Dm and (D0 ) 1D0  (D1 ) 1D1 , the estimate error Errm of the m -th ‘ISI’ free data group is trivial and negligible.

ICI mitigation




Based on the obtained ‘ISI’ free data symbol estimate, the ‘ICI’ free data symbol estimate Xm
further derived from (10).
can be



Xm	1 [(D0  D ) 1D0  (D1  D ) 1D1 ]Xm	1 [(D0  D ) 1D0  (D1  D ) 1D1 ]Xmod ( m 1,2)

(13)

2	0	1	2	0	1


Considering that time variation matrix Dm
is much ‘smaller’ than Dm
with a sufficient large piece number M ,

the approximation (Dm
 D ) 1


 (Dm ) 1
(Dm ) 1 D (Dm ) 1 can be obtained from matrix theory.

By substituting the approximation above into (13), the ‘ICI’ free data symbol estimate Xm
obtained.
is finally


	

Xm  Xm
{(Dm )
1 D} Xm
(14)




Until all the M  2 data groups have been estimated through the steps above, the equalized data symbol



can be finally obtained by permutating the data groups estimate {Xm }M 1 .
The abovementioned intra-symbol piecewise equalization method for M

2 can be directly generalized for

M  2 p , and the equalization steps: symbol modification, ‘ISI’ mitigation and ‘ICI’ mitigation for the m -th
data group are described as (8), (12) and (14) respectively.


Complexity Analysis

The equalization complexity is evaluated in terms of complex additions (CA), complex multiplications (CM), and complex divisions (CD). According to (8), (12) and (14), the steps of the proposed method mainly includes FFT, IFFT and matrix-vector multiplications. Owing to the property of the cyclic toeplitz matrix,

Dm  F	HmFH	is a diagonal matrix with diagonal element vector F
(Hm (1,:))T , and the matrix D  can be

N / M	N / M
expressed in matrix form from (5)
N / M	m





Dm  FN / M
diag( 2M *(0 : ( N / M
2N
1))
N	H
N / M


where	Dm  is also a diagonal matrix with diagonal element vector F	( hm )T . Hence the matrix-vector
N / M 
multiplication involved in (8), (12) and (14) can be simplified as diagonal matrix-vector multiplication and FFT/IFFT, which are both low complexity operations.
As the N -point IFFT/FFT operation require N / 2log2 N CM and Nlog2N CA, the three equalization steps on

the m -th data symbol group Xm
have computation complexity of
2Nlog2N  CA
N (log2N
CM N CD,

N [log2 (N / M )  1] CA
respectively.
0.5* Nlog2 (N / M )
CM N CD and
N [2log2 (N / M )  1] CA
N[log2 (N / M )  2]
CM N CD


Table 1. Complexity comparison

As a total, the proposed scheme requires {13Mlog2N / 2 9Mlog2M / 2  9M }N	complex operations for piece number M , while the classical simple equalization scheme in [1] with banded factor Q requires a total of

(8Q3 / 3
20Q2
 52Q / 3
4)N complex operation. Banded factor Q
 2,4 and piece number M
 2,4
is assumed in

the following simulations that the two equalization schemes not only have comparative complexity, but also achieve better trade-off between performance and complexity in fast fading channels. For ease of comparison, the computation complexity of the two schemes for typical system parameters has been listed in Table 1.

Among the listed typical parameter configuration cases the proposed method for M
complexity.

Simulation Results
2 can achieve the lowest


In this section the uncoded BER performance is applied to evaluate the performance of different equalizers.

An OFDM system with N
 256, L
8,32 , and QPSK modulation is supposed. Rayleigh fading channels with

exponential power delay profile and maximum normalized Doppler frequency fd  0.15,0.30 is assumed in the
simulations. For fair comparison, the proposed equalizer and the banded equalizer [1] both have only the CSI at mid-time instant in each piece-period, and the complete CSI for the banded scheme is obtained by linear interpolation in each piece-period.
From Fig. 2, the proposed scheme achieved slightly worse performance than the banded scheme for
fd  0.15 case, while achieved better performance for fd  0.30 case, since the ICI energy outside Q banded
neighbouring subcarriers can not be negligible in fast fading channels, while the proposed scheme can


efficiently mitigate the much lower ‘ICI’ caused by time-varying channel in each piece-period. But the proposed scheme is more susceptible to the multipath length increase than the banded one, since the ‘ISI’ mitigation of the proposed scheme is dependent on the multipath length. The proposed scheme performs

better for M
4 than for M
2 only in L
 8, fd
 0.30
case, since the ’ISI’ dominates the equalization

performance for lower Doppler spread cases or big delay spread cases.

Conclusions

We have proposed an intra-symbol piecewise equalizer for OFDM systems over fast time-varying multipath channels. By using the intra-symbol piecewise OFDM system model and the characteristics of channel matrix, the equalization against fast fading channels can be realized through the successive `ISI' and
`ICI' mitigation with complexity of {13Mlog2N / 2 9Mlog2M / 2  9M }N . We have shown the proposed scheme has lower computation complexity than the comparative one, while perserving good performance especially in fast fading channels with small delay spread.

100










10−1










10−2




10−3

0	5	10	15	20	25	30
SNR



Fig. 2. BER comparison between the proposed scheme and banded scheme for fd
 0.15,0.30


Acknowledgements
This work was supported by the National Natural Science Foundation of China by Grant 60902045 and Major National Wireless Broadband Mobile Communications Project of China under Grant 2010ZX03003- 004-01.


Corresponding Author
Corresponding author: Lei Wang, lei.wang@mail.xjtu.edu.cn, and Mobile Telephone 13991944880


References
L. Rugini, P. Banelli and G. Leus. Simple equalization of time-varying channels for OFDM. IEEE Comm. Letters, vol. 9, no. 7, pp. 619-921, Jul. 2005.
Y. Mostofi and D. Cox. ICI mitigation for pilot-aided OFDM mobile systems. IEEE Trans. Wireless


Commun., vol. 4, no. 2, pp. 765-774, Mar. 2005.
P. Schniter. Low-complexity equalization of OFDM in doubly selective channels. IEEE Trans. Signal Processing, vol. 52, pp. 1002-1011, Apr. 2004.
S. Feng, H. Minn, L. Yan and L. Jinhui. PIC-based iterative SDR detector for OFDM Systems in doubly- selective fading channels. IEEE Trans. Wireless Comm., vol. 9, no. 1, Jan. 2010.
E. Panayrc, H. Senol and H. V. Poor. Joint channel estimation, equalization, and data detection for OFDM systems in the presence of very high mobility. IEEE Trans. Signal Processing, vol. 58, no. 8, pp. 4225-4238, Aug. 2010.
T. Hrycak, S. Das, G. Matz and H. G. Feichtinger. Low complexity equalization for doubly selective channels modeled by a basis expansion. IEEE Trans. Signal Processing, vol.58, no.11, pp. 5706-5719, Nov. 2010.
