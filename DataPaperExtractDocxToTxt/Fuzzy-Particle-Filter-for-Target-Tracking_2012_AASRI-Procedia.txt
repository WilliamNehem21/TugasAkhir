Available online at www.sciencedirect.com



AASRI Procedia 3 (2012) 191 – 196



2012 AASRI Conference on Modeling, Identification and Control
Fuzzy Particle Filter for Target Tracking
Qing LIN 1,2,a, Xiao-Ding XU 1,b, Shi-Tong WANG3, c,
1(School of Computer Science and Telecommunications Engineering, Jiangsu University, Jiangsu , Zhenjiang, 212013, China)
2(School of Computer Science and Technology, Nanjing University of Science and Technology, Nanjing, 210094, China)
3(School of Information Technology  Southern Yangtze University  Jiangsu ,Wuxi ,214122, China)

Abstract

For the lack of the traditional particle filter and particle filter based on the colour histogram in the background illumination and the deformation and transformation of target, fuzzy particle filter combined with the classical Monte Carlo algorithm employs fuzzy technique to extract the target features. Colour image sequence converts from RGB to L*a*b Colour space of the International Illumination Commission. Fuzzy particle filter and re-sampling weight superimposed is more effective in reducing the number of particles and enhances traditional particle filter capacity to the recognition positioning and real-time tracking. Experimental results displayed that the method in the target shape, attitude or background illumination in intraday variation tracked target in real time. The algorithm enhances the traditional particle filter robustness and real-time in the light of dramatic changes, background constant variation and the target deformation self-adaptive. And the partially obscured target is not lost.
© 2012 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license. Selection and/or peer review under responsibility of American Applied Science Research Institute Key Words: Monte Carlo ; Fuzzy techniques ; particle filter ; illumination ; target tracking


Introduction

The tracking target in the video sequence effectively has been a challenging issue in the computer vision[1- 2]. In recent years, particle filter as an efficient target state estimation method, which belongs to the non- parametric estimation with not exhaustive search and has the advantage of high tracking accuracy, has been successfully applied in the field of target tracking and some across-domain[3-4]. It is high computational cost that each particle state is estimated at any frame image in the tracking process[2]. In the case of partial occlusion, illumination variation, changing posture and shape of targets, the real-time and robustness of the traditional particle filter becomes the problems, i.e HPF( Histogram-based particle filter). Vinu[5] put forward to combine with the technology of the fuzzy feature measurement and the stability theory to improve

* Corresponding author   TEL   +86-18796081259
E-mail address: 978564205@qq.com.cn ; ,jcs533@qq.com







2212-6716 © 2012 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license. Selection and/or peer review under responsibility of American Applied Science Research Institute doi:10.1016/j.aasri.2012.11.032


the timeliness and robustness of tracking on the basis of Ning [6]. The fuzzy particle measurement methods as well as superimposed weight sampling algorithm is employed in the paper to reduce the number of particles and improve the real-time quality. Y. Satoh applied the color characteristics to implement tracking[7].

Particle Filter Tracking Theory

In the video tracking, the color position, speed, rate value range, direction of the target , etc., the choice of
parameters depends on the purpose of use. When the posterior probability density function p(xt | Zt ) is used	to
estimate, Zt is the set of effective observation point, and when xt represents a valid estimate of the time points, the original PDF (Probability Density Function) p(x0 | y0)as a priori point, recursive get in two stages, form the basis detect and update of Bayesian theory [8], which Zt {z1, z2 ,  zt }. Assuming PDF p(xt1 | Zt1) p(xt1 | z1 :zt1) valid in the
instant t-1 , the system model x t = f t ( x x  1 , v t  1 ) get the a priori probability of PDF in time t in the exploratory
phase., ft is a nonlinear function containing vt 1 , and in the instantaneous t, using the Bayesian theory to

update [7]
p(xt | z1 :zt ) p(zt | xt )P(xt | z1 :zt1)/ p(zt | z1 :zt1)
p(zt |z1 :zt-1 )= p(zt |xt )p(xt |zt :zt-1)dxt

(1)
(2)

The constant is based on the similar function of measurement model zt  ht (xt ,nt ), the function h t non-linear associated with n t , where n t is a measure noise sequence. In the particle filter, the probability distribution is approximate to weighted distribution collection, for example s {(x(n) ,w(n) ) | n 1,2,...N }, N is the number of particles,

N s wi =1
t	t	s	s

by the value i =1 t  of these weighted statistics [9].
Sampling theory is employed to get close to the posterior probability weight value p(xk|Z1: Zk ). If px (x) is the probability density, it is difficult to obtain from  ( x) , because  ( x) is estimated obtained, so weighted approximate density obtained by the following formula
N s

p ( x ) 

 1
i  ( x 
i )
(3)

Where wi ((xi)/ q(xi)) is the i-th particle nonlinear weighted values,
x  q ( x ) , i  1, 2 ,	, N s
q (. )
obtain a

sample. Particle filter connected via two create transported to target detection in the target tracking, fuzzy, and the target is detected, such as its color histogram, an area, centric, and shape calculated by the ambiguity function F (I )={f1,f2  f j} where fj is defined as

N
j	i =1 i,j
1 N
pi =   ui ,j
i =1
(4)

Where ui,j is the degree of membership of the i-th pixel and the j the pixel. p is the i-th pixel probability of being selected, and N is the total number of pixel. In order to reduce the non-uniformity of the RGB color space, the color of each pixel is converted from RGB color space to the CIE (Commission International de L'Eclairage French abbreviation) L*a * b color space. When c is much smaller than n, c kinds of color local rough set theory and fuzzy histogram calculated from fuzzy C-means (FCM) histogram. c rough color fuzzy clustering core unified color space, defined as follows:
c  n

J  (M, F : X )   um || x  f ||2 (F=(f , f	f )) 1p mp 
(5)

m	i, j  i	j
j1 i1
1  2	N

Where M is a member function matrix, F  { f , f . ..... f } T is unknown clustering prototype vector u  from
1  2	n	i , j 
the collection X {x1,x2	xn} belonging to i model the value of the member function of the j-th cluster, The index m
controls ambiguity or member function range shared by C clustering. This cluster and the membership function value obtained by the following formula:
 n (ui ,j )m x j
f 

 n (ui ,j ) m
u =1/c

( || x -f ||2 /||x -f ||)	( for 1  i  n,1<j,l<c)
(6)
(7)


Calculate fuzzy particle filter histogram can be expressed asFc1McnHn1, Hn1the color histogram well changed


from the binary RGB to CLE L*a * b, Mcn members of the matrix, ui, j is a rough set of the i-th color binary and j-th binary .

Computer of the Fuzzy Particle Measurement

Based on fuzzy tracking, fuzzy similarity measure has been widely used in target tracking, the similar fuzzy measurement methods have been the target tracking [10], Based on calculate of fuzzy distinction, fuzzy distinction between all two frames fuzzy histogram described as follows

c
S(imag ,imag )   {2((1u
)  u
) (ui,1ui,2)	(ui,1 ui,2 )
(8)

1	2  
i1
i,1
i,2
i,2
i,1



1	1	2	c
c min(u ,u )
(9)


i1 (min(ui,1,ui,2 )   min(1-ui,1ui,2 )   min(ui,1  ui,2 ))
ui,1,ui,2 corresponds to a membership function value of the i-th layer image of the histogram, difference of two frames more (imag1, imag2) [11] is smaller, the similar property is obvious, the difference for a pair of identical pictures is 0.

Fuzzy Particle Filter Tracking

The compute Based on the stability theory

Tversky et al consider that particles is a set of feature points rather than the simple metric[10] , We consider Generalized Tversky Index (GTI) measure for image region extraction has been proposed as the formula (9) .GTI provides directional similarity assessment that is based on human perception. Values a, β determine the relative importance of the distinctive features of the adjacent two images.

Description in our important algorithm

Defined in the set of RGB space is an n-dimensional colour space and color in CIE L*a*b color space c is much smaller than the variable n.
the transformation between RGB colour space and the CIE L*a * b colour , according to the formula(5) calculated fuzzy membership matrix Mc .

The initialization of the distribution function  ( X , m,  )
Covariance variable .
Each Pixel I (x, y,t) with uniform wights wi , t return (3)
where m is the mean	variable ,Σis the

Iterative computation the wights and intensity each pixel ( I (x, y,t),t 11 x  Nx ,1 y  My ) .

If the value of pixel I(x, y,t)
steering (4) and (5)
lies in the particular M (M=2.5) of B, update its weights, mean, covariance,

If found <T, I (x, y, t) is a background pixel B[11] ,
Rearranges the weight of each particle value wi,t  in descending order

The Implementation in the Fuzzy particle filter

Sampling Ns particles from the set .i .e, in accordance with the unified weights randomly generated

particles as the initial collection later effective sample papers accumulated PDF S
 {(s ( n ) , w ( n ) ) | n  1, 2...N }

t 1
t 1  t 1	s

Determination P( xt | Z1:t ) by  above-mentioned (2) and (3) recursively xt
formula
is the  State variables in the

predict by Sampling from P ( x
t | xt 1
 s ( n ) n 1:N )


Measure and weight a new pixel ( I (x,y,t) ) value of the weight in the image .
Calculate a new histogram of target in the image .
Tracking the target , definition window both calibration its	possible location and possible movement position .
Calculate by formula (9)
Cross-track In the minimum
h) Specification and resampling [11] , time t in the exploratory phase , calculate the importance weights
t  wt 1 p(zt | xt )

Standardized weight
i
w t  w i 

s w j

Cumpter
N s ~
i
eff	t
i 1

If N m  N eff  N s
Retain the high weight of tablets according to the weight distribution abandon the low weight of the particles, And setting weight value of new particles as 1/Ns ,
Else return and initialize

Experimental Results and Analysis

In 1st Experiment , the size of images which from http://www.dabi.temple.edu is 256*192 px and the number is 120 frames in the Experiment . Red rectangle manually select the area in the diagram, the tracking area of based on the color histogram particles and fuzzy particle filter with a=0.500 ,β=0.750 are yellow and white rectangle area, respectively . The part of the track result in 1st Experimental  as follows:
	
1st	43rd	116th	1 st	43rd	116th
Fig 1: From left to right 1st ,43rd, 116th in HPF ‘S tracking result	Fig 2: From left to right 1st ,43rd, 116th in FPF ‘s tracking result

The small part of the both track results in 2nd Experiment	results as follows:

70th	120th	70th	120th
Fig 3:From left to right 70th ,120th in HPF	Fig 4:From left to right 70th ,120th in FPF:

The statistical of errors in two sets experiment ,	the HPF’s error statistical results was indicated by red dotted line	but the FPF’s error statistical results was showed through blue line in Fig 5 and Fig 6 .
Fig 5 :HPF’s and FPF’s result in Experimental 	Fig 6 :FPF’s result in Experimental 


Table 1:Two sets of experimental results as follow , Because the based on the color histogram (HPF) is unable to track the target after 70 th in Experiment 2 ,no result is showed in the table .


There is a target of various attitude change in the sequence. 116th showed that the algorithm based on the color histogram m of particle filter (HPF) has obvious deviation , the partially obscured target is not lost in the new algorithm . The part of tracking the effect in the first experiment is displayed in Fig 1 ,2 the deviation Statistics in the tracking target is as shown in Fig 5 . As is shown in Fig 5, in the 20th, 80th, 100th frames respectively, due to the target deformation, similar with the background, similar goals shows interference, target error change increased , so the color histogram-based particle effects get worse.
In 2nd Experiment , the image size: 505*285 px ,about 120 frames , the sequence form: http://www.di.ens.fr/willow /SPAMS/ [12] ,the fuzzy particle filter is with  =0.755, =0.556 .As shown in Fig 3 target becomes smaller, the method of the paper can also track with adaptive., FPF conclusion was verified according to the compare with the traditional based on the color histogram of particle filter algorithm .Shown in Fig 6, the thesis method the error statistic of x-coordinate , but the particle filter based on color histogram in fast illumination 70th frame lost target, FPF also has big error, but also can track the target, since the background light changes quickly, the tracking error was impacted. So Fig 6 and Table I only was displayed the FPF deviation statistics. The based on the HPF in 70th frames is unable to track the target , no statistics after 70th frames.. The table displayed above that the track effects of FPF experiment very ideal. Both of experimental results are statistical as Table 1

Conclusion

Therefore, a fuzzy particle filter, which is combined with fuzzy measurement technology and new re- sampling method, and its robustness and real-time performance has been improved in the experiment.
Particle filter algorithm can estimate the a posteriori distribution of the target state ,so it can be maintained with a variety of assumptions of the target state through a large number of particles, and therefore has strong handling capacity with a rapid light changes, the longer time occlusion .Thesis method, however, there are many insufficient or not involved in some research areas, which combined with the special traffic weather (for example, rain, fog, etc.), multi-target tracking will be our next research item.


Acknowledgments

This work was financially supported by National Natural Science Foundation (61170126) and Jiangsu Provincial Natural Science Foundation (BE20111156).


References

ALPER Y,OMART J,MUBARAK S.,Object tracking :A survey [J],ACM Computing Surveys ,2006, 38(4)
HAN M,SETHIY A,HUA W,et al. A detection-based multiple-object tracking method [C]International Conference of Image Processing. USA :IEEE Computer Society ,2004, 5:3065-3068
S.-Y. Chien , Y.-W. Huang, B.-Y. Hsieh, S.-Y. Ma, and L.-G. Chen, “Fast video segmentation algorithm with shadow cancellation, global motion compensation, and adaptive threshold techniques [J] IEEE Trans. Multi-media, vol. 6, no. 5, pp. 732–748, Oct. 2004.
[4]H. K. Sorenson, “Least squares estimation: From gauss to Kalman [J] IEEE Spectrum , vol. 7, no. 7, pp. 63–68, Jul. 1970.
H.Wu, F. Sun, and H. Liu, “Fuzzy particle filtering for uncertain systems,”[J]IEEE Trans. Fuzzy Syst.,vol.16, no.5, pp. 1114–1129,Oct.2008
J. Ning, L. Zhang, D. Zhang, and C. Wu, Robust object tracking using joint color-texture histogram [J] ,Int.
J. Pattern Recog. Artif. Intell.,vol..23,no. 7, pp. 1245–1263,2009.
Y. Satoh, T. Okatani, and K. Deguchi, A color-based tracking by Kalman particle filter[C], in Proc. 17th Int. Conf. Pattern Recog, vol. 3, Aug. 2004, pp. 502–505.
[8]X. Mei and H. Ling, Robust Visual Tracking Using 11 Minimization [C], Proc. IEEE Int’l Conf. Computer Vision, 2010 Oct pp.520-528
[9]T. Chaira and A. K. Ray, Fuzzy measures for color image retrieval [J],Fuzzy Sets Syst., vol. 150, pp. 545– 560, 2005. [10]T. Chaira and A. K. Ray, Fuzzy measures for color image retrieval [J], Fuzzy Sets Syst., vol. 150, pp. 545–560, 2005.
J. Fan and W. Xie, “Distance measure and induced fuzzy entropy [J] , Fuzzy Sets Syst. , vol. 104,pp.305–314, 1999.
J. Mairal, F. Bach, J. Ponce and G. Sapiro. Online Dictionary Learning for Sparse Coding [C]. v 382, 2009, Proceedings of the 26th Annual International Conference on Machine Learning, ICML'09'
