Artificial Intelligence in Geosciences 1 (2020) 31–35

		




Automatic fault instance segmentation based on mask propagation neural network
Ruoshui Zhou *, Yufei Cai **, Jingjing Zong, Xingmiao Yao, Fucai Yu, Guangmin Hu
University of Electronic Science and Technology of China, China



A R T I C L E I N F O

Keywords:
Deep learning Fault interpretation
A B S T R A C T

Fault interpretation plays a critical role in understanding the crustal development and exploring the subsurface reservoirs such as gas and oil. Recently, significant advances have been made towards fault semantic segmen- tation using deep learning. However, few studies employ deep learning in fault instance segmentation. We introduce mask propagation neural network for fault instance segmentation. Our study focuses on the description of the differences and relationships between each fault profile and the consistency of fault instance segmentations with adjacent profiles. Our method refers to the reference-guided mask propagation network, which is firstly used in video object segmentation: taking the seismic profiles as video frames while the seismic data volume as a video sequence along the inline direction we can achieve fault instance segmentation based on the mask propagation method. As a multi-level convolutional neural network, the mask propagation network receives a small number of user-defined tags as the guidance and outputs the fault instance segmentation on 3D seismic data, which can facilitate the fault reconstruction workflow. Compared with the traditional deep learning method, the introduced mask propagation neural network can complete the fault instance segmentation work under the premise of ensuring the accuracy of fault detection.





Introduction

Fault interpretation is a periodic work, which involves long-term iteration and repeated verification. Since deep learning has been proven superior at discovering complex structures in high-dimensional data (Krizhevsky et al., 2012), it has attracted widespread attention from various fields in recent years, and it has achieved good results in image classification, target detection, semantic segmentation, etc. For instance, fault detection could be regarded as a semantic segmentation problem where we classify each point in seismic data as ‘fault’ or ‘non-fault’. Therefore, many studies have applied the deep learning method to tackle such problem (Guitton, 2018; Guo et al., 2018): Huang et al. (2017) uses a variety of seismic attributes as the input of con- volutional neural network (CNN) and builds a big data platform, which promotes the application of deep learning methods in geophysics; Xiong et al. (2018) uses seismic data slices in different directions as the input of the neural network which make full use of the continuity of the fault in three-dimensional space; Wu et al. (2019) uses a large number of labeled synthetic data as the training set and introduce U-net network model which greatly improves the effectiveness of fault detection. The
Unet-based fault detection is directly applied to the entire seismic volume data and does not need to process each seismic voxel point separately. This way, it makes full use of the spatial characteristics of faults and greatly reduces the calculation cost.
Existing studies regard fault detection as a semantic segmentation which lacks the description of the relationship between faults and the establishment of the spatial topological structure of fault model. In order to further reduce the labor cost and improve the effectiveness of fault detection, we introduce instance segmentation to solve problem. Compared with semantic segmentation, instance segmentation not only needs to distinguish fault and non-fault, but also needs to classify and mark different faults specifically (fault 1, fault 2 and etc). We adopt the idea of video instance segmentation to deal with fault instance segmen- tation because each frame of video data has continuity in time, while seismic data has continuity in space. Video object segmentation methods can be divided into two types: propagation-based methods and detection- based methods. Propagation-based methods mainly leverage the tem- poral coherence of object motion. These methods rely on the spatio- temporal connections between pixels. The detection-based methods, on the other hand, learn the appearance of target object from a given



* Corresponding author.
** Corresponding author.
E-mail address: 13558649050@163.com (R. Zhou).

https://doi.org/10.1016/j.aiig.2020.12.001
Received 7 August 2020; Received in revised form 5 November 2020; Accepted 5 December 2020
Available online 3 February 2021
2666-5441/© 2020 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).




Fig. 1. Label making of fault instance segmentation task.


annotated frame, and perform a pixel-level detection of the target object at each frame. The core idea of our method is to combine such two modes of fault segmentation based on both the reference profile and the fault tracking from the previous profile. In our work, we make a set of 3D fault instance segmentation labels, based on the synthetic seismic data following Wu (2019), as training data. We train the mask propagation neural network (Oh et al., 2018) in a step-by-step process iteratively. We complete the fault instance segmentation in a user-defined range and show the final result of fault reconstruction. A multi-input, multi-level encoding and decoding convolutional neural network is used to learn the distribution and combination rules of fault between the adjacent profile and the reference profile to predict the target profile, so as to realize the
fault combination modeling of the whole seismic data. The reference profile is a pre-determined reference profile with fault marks, while the adjacent profile is the previous profile with new fault marks transferred down profile by profile. Compared with traditional deep learning methods, such as CNN, we can not only identify faults and non-faults, but also describe the relationships between faults. Such that we provide valuable information for a more effective fault interpretation.

Method

The core of our idea is to build an analogy between seismic volume and video stream. We take the profiles of seismic volumes along the




Fig. 2. The structure of the mask propagation neural network model.




Fig. 3. The step-by-step training process for falt instance segmentation in this study.


inline direction as video frames and achieve the fault instance segmen- tation by the mask propagation method. The network achieving mask propagation has two mainstreams: one is to exploit the appearance of the target faults in a given reference profile called reference stream, and the other is to propagate the key profiles to roughly specify and locate the target faults of interest called the target stream. Then the mask propa- gation neural network learns the rules of distribution and the shape-shifts among reference profile, previous profile and target profile, and to further complete fault instance segmentation in each profile of the seismic volume data. Eventually, using the relationship between the faults obtained by fault instance segmentation, fault reconstruction can be completed more easily and quickly.

Training data

We need 3D seismic volume data with fault instance segmentation labels to train deep learning model. A set of 3D fault instance segmen- tation labels are made from 3D 0–1 fault labels using a semi-automatic picking method, as shown in Fig. 1. We manually pick the fault slices in a large area and then classify the remaining unlabeled fault points via k-NearstNeighbor (KNN) method (Cover, 1967). In our method, the selected neighbor is the fault point that has been correctly classified, and
the classification of the point to be classified is determined according to the category of the adjacent 10, fault points (k = 10). According to the spatial distribution of fault points, the linear distance between two sampling points in space is selected as the measurement distance. The
measuring distance is defined as follows:
After the labeling work, we have 3D fault instance segmentation la- bels, then we select 256 sets as the training dataset and 12 sets as the test dataset. Each set consists of a total of 32 pieces of continuous seismic profiles in total.

Network structure

In this paper, we use a mask propagation neural network with an encoder-decoder structure, as shown in Fig. 2. The network has two input streams, including the reference stream and the target stream. Each input consists of one seismic profile and one corresponding fault instance segmentation mask.
The model output one result to show the fault instance segmentation of target profile. The reference stream consists of the first seismic profile
and its fault instance segmentation mask. The target stream consists of the current seismic profile and the fault instance segmentation of the previous profile. Both share a multi-level encoder designed as ResNet50 (He et al., 2016), and is contacted together through a global convolution block, which is used to match the features of fault instance segmentation between the reference stream and the target stream. To overcome the
limitation of convolution operation, two convolution layers of 1 × k + k
× 1 and k × 1 + 1 × k (e.g. k = 7) are set in a global convolution block. The two convolution layers are added to be the input of a residual convolution block.
The decoder layer is composed of numbers of decoding blocks and is matched with the encoder layer. The decoding block operates with skip connections of the encoding block and up-sampling. Finally, the fault instance segmentation mask of the target profile is obtained as output through a convolution layer and a softmax layer.
Our method relies on two kinds of knowledge, as suggested by the structure of the mask propagation convolutional neural network: one is the human knowledge that is the fault instance segmentation labels picked manually, the other is the machine knowledge that is the propa- gation rules learned from mask propagation neural network. The two kinds of knowledge restrain and support each other to achieve the semi- supervised fault instance segmentation in 3D seismic data.

Training step

In our work, the mask propagation neural network is trained in a step- by-step process iteratively, as shown in Fig. 3. If the first seismic profile is considered as the reference profile, training starts with the second pro- file, which is chosen as the target profile. The training step needs N-1 times in total (N is the number of profiles).
For example, if we select the pth profile as the reference profile and the tth profile as the target profile, the whole training step indicates as follows: in the current training step, the reference stream always keeps the pth profile and the pth fault instance segmentation mask. The target stream is comprised of the tth seismic profile and the (t-1)th fault instance segmentation mask. The mask propagation neural network receives the two input streams and outputs the fault instance segmentation mask of the tth seismic profile. Then we propagate it through the network as the previous fault instance segmentation mask in the target stream. In this way, 32 pieces of adjacent profiles are iteratively processed as one data set. We have trained 256 data sets for 100 epochs.




Fig. 4. Preprocessing of data set to be predicted in the inference step.


Fig. 5. Reconstruction results of fault surface. (a): Reconstruction result of set A. (b): Reconstruction result of set B. (c): Reconstruction result of set C.


Inference step

The inference step needs a range of profiles in a data set that is user- defined rather definite. We divide a 3D seismic volume into several data sets, as shown in Fig. 4.
Each set would go through the mask propagation neural network as a test sample and it will be recombined together to achieve fault instance segmentation in 3D seismic data. For the prediction of multiple fault instance segmentations, a simple way is to run each fault independently and to label the pixel with the largest output probability of fault instance segmentation. We take softmax aggregation as the loss function that combines multi-instance probabilities softly. It assumes that probabilities of positive samples and negative samples sum to 1. We calculate fault instance segmentation mask using the equation below and pass it as the input of the next profile.
pi;m ,(1 — pi;m )
= σ(log it(p )) =
PM  p	1	p )
The inference step is similar to the traditional fault interpretation in workflow. It starts with labeled fault instances of the interested profile and creates subsequent fault instances in a user-defined range like Fig. 4. If there are some fault misclassifications in profile M. We can relabel profile M and regard it as the first reference profile. Then the inference step starts over with profile M. The instance segmentation results can classify fault points into different instances from a range of profiles. Then we easily and quickly reconstruct fault surfaces based on fault instance segmentations, as shown in Fig. 5.

Result

We evaluate our method on two chosen sets (set A and B) from a synthetic seismic volume, whose size is 128*128*32. Each fault instance segmentation mask has been labeled in the first profile. We show the fault instance segmentation result of the 1st, 9th, 17th, 25th profiles in Fig. 6. Set A contains four non-intersecting fault instances, which have the similar fault dip and strike. We can see blue fault instance fade away as
inline direction goes on. Some fault instances of set B are intersected. The

j=0 bi;j
( — bi;j
magenta fault instance and the blue fault instance belong to one instance segmentation of faults, but two different branches in the shape of “Y”.

where σ and logit represent the softmax and logit functions, respectively,
Pi;m is the network output probability of the instance m at the pixel location i.(m = 0 indicates the background), and M is the number of instances.
Our method can sculpture the details of the fault edge between fore- ground (fault) and background (non-fault) in fault detection, also detect various fault instance segmentations in one profile while keeping the shape of fault instance segmentations both in the crossed and isolated




Fig. 6. Segmentation results of set A, set B and set C. (a): Seismic images. (b): Fault semantic segmentation results based on CNN. (c) Results of fault instance segmentation.


areas.

Conclusion

Most fault interpretation methods based on deep learning focus on fault detection. We study fault instance segmentation on 3D seismic data based on deep learning on the first try. Our method takes the 3D seismic data as a sequence of profiles, which is similar to the form of video frames. The mask propagation neural network is designed to learn the propagation of fault instance segmentations in profiles along the inline direction. We demonstrate the results of fault instance segmentation in seismic profiles and show fault reconstruction based on work mentioned above: the fault instance segmentation and the reconstruction of fault surfaces are carried out on several groups of validation data sets. The validation samples include independent fault examples and cross fault examples. The experimental results show that the front and back scenes of fault and non-fault are separated clearly. Further, the separation of multiple examples of fault is complete and clear, which verifies the effectiveness of our method. Fault instance segmentation further im- proves the efficiency of fault intelligent interpretation, so it has high practical value and research significance. Compared with fault detection based on other deep learning method such as CNN, our method can not only identify faults, but also characterize the relationship between faults. In future research, we hope to add continuity constraint to the fault and to solve the problem of discontinuity of fault line when the fault is far away from the reference profile.

Declaration of competing interest

We declare that we do not have any commercial or associative
interest that represents a conflict of interest in connection with the work submitted.

Acknowledgment

This work is supported by Natural Science Foundation of China (U1562218 and 41974147) and the authors would like to thank X. M. Wu for his public seismic synthetic data set.

References

Cover, T., et al., 1967. Nearest neighbor pattern classification. IEEE transactions on information theory.
Guitton, A., 2018. 3D convolutional neural networks for fault interpretation. 80th EAGE Conference and Exhibition 2018.
Guo, B., Lu, L., Liu, Y., 2018. Automatic Seismic Fault Detection with Convolutional Neural network[C]. International Geophysical Conference, Beijing, China.
He, K.M., Zhang, X., Ren, S., et al., 2016. Deep Residual Learning for Image Recognition [C]. IEEE Conference on Computer Vision & Pattern Recognition. IEEE Computer Society.
Huang, L., Dong, X., Clee, T.E., 2017. A scalable deep learning platform for identifying geologic features from seismic attributes[J]. Lead. Edge 36 (3), 249–256.
Krizhevsky, A., Sutskever, I., Hinton, G.E., 2012. Imagenet Classification with Deep Convolutional Neural networks[C]//Advances in Neural Information Processing Systems, pp. 1097–1105.
Oh, S.W., Lee, J.Y., Sunkavalli, K., et al., 2018. Fast Video Object Segmentation by Reference-Guided Mask Propagation[C]. IEEE CVF Conference on Computer Vision & Pattern Recognition. IEEE.
Wu, X.M., Liang, L.M., Shi, Y.Z., et al., 2019. FaultSeg3D: using synthetic datasets to train an end-to-end convolutional neural network for 3D seismic fault segmentation[J]. Geophysics.
Xiong, W., Ji, X., Ma, Y., Wang, Y.X., et al., 2018. Seismic fault detection with convolutional neural network[J]. Geophysics 83 (5), 97–103.
