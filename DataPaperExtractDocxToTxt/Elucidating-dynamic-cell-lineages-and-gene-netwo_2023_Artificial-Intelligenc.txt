Artificial Intelligence in the Life Sciences 3 (2023) 100068

		


Research Article
Elucidating dynamic cell lineages and gene networks in time-course single cell differentiation
Mengrui Zhangc,1, Yongkai Chena,1, Dingyi Yub, Wenxuan Zhong a, Jingyi Zhangb,âˆ—, Ping Maa,âˆ—
a Department of Statistics, University of Georgia, Athens, GA 30602, United Stated
b Department of Industrial Engineering, Center for Statistical Science, Tsinghua University, Beijing, China
c Surrozen, Inc., South San Francisco, CA, USA


a r t i c l e	i n f o	a b s t r a c t

	

Keywords:
scRNA-seq Optimal Transport Smoothing Spline
Dynamic Gene Networks
Single cell RNA sequencing (scRNA-seq) technologies provide researchers with an unprecedented opportunity to exploit cell heterogeneity. For example, the sequenced cells belong to various cell lineages, which may have different cell fates in stem and progenitor cells. Those cells may differentiate into various mature cell types in a cell differentiation process. To trace the behavior of cell differentiation, researchers reconstruct cell lineages and predict cell fates by ordering cells chronologically into a trajectory with a pseudo-time. However, in scRNA- seq experiments, there are no cell-to-cell correspondences along with the time to reconstruct the cell lineages, which creates a significant challenge for cell lineage tracing and cell fate prediction. Therefore, methods that can accurately reconstruct the dynamic cell lineages and predict cell fates are highly desirable.
In this article, we develop an innovative machine-learning framework called Cell Smoothing Transformation (CellST) to elucidate the dynamic cell fate paths and construct gene networks in cell differentiation processes. Unlike the existing methods that construct one single bulk cell trajectory, CellST builds cell trajectories and tracks behaviors for each individual cell. Additionally, CellST can predict cell fates even for less frequent cell types. Based on the individual cell fate trajectories, CellST can further construct dynamic gene networks to model gene-gene relationships along the cell differentiation process and discover critical genes that potentially regulate cells into various mature cell types.





Introduction

A comprehensive understanding of complex biological processes such as tissue development and regeneration requires the investigation of cell differentiation across a wide range of samples and experimental time points [1]. The cell differentiation process includes the differen- tiation of stem cells into different mature cell types [2,3]. Such a pro- cess is dynamic and continuous, including rapid changes in gene expres- sions and cell types over time. To profile such cell differentiation behav- iors, single cell RNA-seq sequencing (scRNA-seq) technology has been developed rapidly [4â€“7]. In particular, scRNA-seq enables researchers to observe the gene expressions of all cells simultaneously (Fig. 1a) in both static or time-course experiments (Fig. 1b). The static scRNA-seq experiment takes a snapshot of all cells and their gene expressions at one time [8,9], whereas the time-course scRNA-seq experiments take snapshots at multiple time points. Using scRNA-seq, researchers can ob- serve the behavior of individual cells in cell differentiation processes
over time. Cell lineage tracing has been widely used to predict dynamic cell fates by indicating the ancestor and posterity cells in cell differenti- ation processes. For example, during a stem cell differentiation process, the multipotent stem cells can develop into multiple cell lineage end- points (Fig. 1c). Despite the effectiveness, quantifying the dynamic cel- lular changes of cell development is still challenging due to the following technical limitations [10]. In time-course scRNA-seq experiments, cells are sacrificed and sequenced at each time point. Thus there is no cell- to-cell correspondence information for cells between two time points, which creates a significant challenge in constructing cell lineages and elucidating the dynamic cell behaviors in the differentiation process. Moreover, it is very challenging to align different cells sequenced in two adjacent time points since expressions of cells are high-dimensional and noisy, and the number of cells in each time point is large. Such a large sample and high-dimensional and noisy data problem render many classical methods, such as Euclidean distance or Pearson correlation, invalid [11,12].


âˆ— Corresponding authors.
E-mail addresses: mengrui@surrozen.com (M. Zhang), yongkaichen@uga.edu (Y. Chen), yudy21@mails.tsinghua.edu.cn (D. Yu), wenxuan@uga.edu (W. Zhong), jingyizhang@tsinghua.edu.cn (J. Zhang), pingma@uga.edu (P. Ma).
1 Mengrui Zhang and Yongkai Chen contributed equally.

https://doi.org/10.1016/j.ailsci.2023.100068
Received 21 December 2022; Received in revised form 17 March 2023; Accepted 22 March 2023
Available online 25 March 2023
2667-3185/Â© 2023 The Authors. Published by Elsevier B.V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/)




Fig. 1. Single cell analysis and cell smoothing transformation (CellST) overview: a: The advantage of scRNA-seq analysis over bulk RNA-seq analysis. b: Data structures for static scRNA-seq experiments and time-course scRNA-seq experiments. Cells in time-course experiments have been marked with experimental time points. c: The multipotent stem cells can develop into multiple cell lineage endpoints. d: Cell lineages are constructed by connecting individual cells over time. Cell fate trajectories are constructed by smoothing the connected cell lineages. e: Dynamic gene networks are constructed based on the calculated dynamic relationship between genes.


One natural approach to surmount the challenges is to order cells into a continuous cell trajectory. Many methods have been proposed to achieve this goal in static scRNA-seq experiments. In these methods, re- searchers construct a pseudotime to order cells chronologically [13â€“19]. Despite their effectiveness, such methods may fail in the following cir- cumstances [20]. First of all, most existing trajectory inference methods construct a bulk cell trajectory, i.e., the mean trajectory of the popula- tion cells across time rather than that of individual cells.
However, some individual cellsâ€™ behaviors may oscillate up and down around their mean expressions or severely deviate from them. Cell differentiation behaviors are dominated by cells with major cell types, and patterns with less frequent might be hidden in the dataset. Sec- ond, individual cell developing trajectories may follow different com- plex topologies, including loops or alternative paths during the devel- opment. For example, analysis approaches in [21], and [22] used dimen- sion reduction methods to identify a low-dimensional space of the gene expression space before constructing cell trajectories [23,24]. Those methods may introduce a significant bias and are hard to validate, as cells are ordered based only on the selected reduced dimensions. Fi- nally, the cells may not be synchronized at the same developing time points. Cells within the same time point can be expressed at different developing stages. In this situation, the bulk cell trajectory that takes the average pattern of cells at different stages might result in unreliable scientific discovery.
In this article, we propose a novel analysis framework named Cell Smoothing Transformation (CellST) to overcome the aforementioned limitations. The CellST framework elucidates dynamic cell fates and con- structs gene networks in the cell differentiation process. In the CellST framework, we propose a cell lineage tracing method, which aligns two individual cells between any adjacent two time points via the optimal transport technique. The optimal transport technique is a mathemati- cal tool initially developed to identify the transport map between two probability measures with the minimum transport cost [25]. Recently, this technique has gained increasing importance in various applications such as subsampling [61], suï¬ƒcient dimension reduction [59], feature screening [57], and graph comparison [55]. Consequently, it has be- come a powerful tool for modeling cell dynamics [27â€“29]. See Zhang et al. [29,60] for recent reviews. Those aligned cells can potentially rep- resent individual cell lineages, tracing cell differentiation behaviors by constructing cell-to-cell trajectories (Fig. 1d). We then use a smoothing spline model to predict cell fate trajectories and reduce both cell-cell variations. The smoothing spline method models the gene expression patterns in the aligned cell lineages from the previous step and builds the estimated individual cell fate trajectories. Lastly, we narrow down our focus to utilize the gene expression patterns from those cell fate trajectories to construct dynamic gene networks (Fig. 1e). The dynamic gene networks are constructed by estimating the dynamic relationship of pairwise gene expression patterns using the functional concurrent mod-




Fig. 2. Example of cell-to-cell linking: a: Cell differentiation over time (x-axis) reflects an increasing trend in average cell expressions (y-axis). b: The individual cell correspondences at different time points reflect a decreasing trend in average cell expression (y-axis).


els [30] and smoothing spline models [31]. The dynamic gene networks
vector ğ±ğ‘¡; each dimension of ğ±ğ‘¡ represents a gene expression1. We write

{ ğ‘–}ğ‘›ğ‘¡	ğ‘–

can be used to find critical genes by profiling genes with significantly
ğ—ğ‘¡ =
ğ‘¡
ğ‘– ğ‘–=1
, where ğ‘›ğ‘¡ indicates the number of cells at time ğ‘¡ in single

different patterns from other genes.
Our major contribution is developing the first analysis framework (CellST) to construct cell lineages and predict dynamic cell fates at the individual cell level, which can help researchers better observe cell be- haviors in the differentiation process. In contrast, the existing methods only estimate the bulk trajectory in scRNA-seq experiments. Those anal- ysis methods may overlook the hidden patterns in the cell differentiation process to create a spurious cell differentiation trajectory. We illustrate this problem by using a simulated time-course cell dataset indicating the disadvantage of bulk cell trajectories (Fig. 2). The cell-to-cell tra- jectories are able to overcome the disadvantage and identify the real gene expression patterns in cell development. Under some cell develop- ment and differentiation circumstances, cellsâ€™ average expressions show an increasing pattern if we only construct one average cell trajectory to order cells (Fig. 2a). However, when individual cells are aligned at different time points, the individual cell lineagesâ€™ average expressions reflect unique decreasing patterns, which are in contrast to the bulk tra- jectory (Fig. 2b). This means some cells start at a lower expression level, and the expression keeps going down over time. Those cell development patterns can be easily misled by the average cell trajectory and thus re- flect spurious cell differentiation behaviors. Furthermore, we propose the dynamic gene networks based on the individual cell fate trajecto- ries to estimate the dynamic gene-gene relationship and critical genes in the differentiation process. The empirical performance of the pro- posed framework is evaluated by several simulated and real experiment studies.
the domain spaces by aligning the distribution of ğ—ğ‘¡ to ğ—ğ‘¡+1. cell RNA-seq dataset. Our goal is to learn the transformation between
As a powerful tool to learn the transformation from one probabil- ity measure to another, optimal transport has been applied to solve the
obtain the domain adaptive coupling between ğ—ğ‘¡ and ğ—ğ‘¡+1. In other domain adaptation problem [32]. We thus apply optimal transport to
words, we transform the cell alignment problem into an optimal trans- port problem. In particular, we formulate the problem as a Monge opti- mal transport by minimizing the cost for transporting a gene expression
distribution ğœ‡ğ‘¡ and ğœ‡ğ‘¡+1 using a map ğ“ğ‘¡:
min  ğ‘(ğ‘¥, ğ“ (ğ‘¥))dğœ‡ (ğ‘¥),	(1)
ğ“ğ‘¡  ğ‘¡
where ğ“ğ‘¡#ğœ‡ğ‘¡ = ğœ‡ğ‘¡+1, # represents the push-forward operator, such that for any measurable ğ‘¥, ğ“ğ‘¡#ğœ‡ğ‘¡(ğ‘¥) = ğœ‡ğ‘¡(ğ“âˆ’1(ğ‘¥)), ğœ‡ğ‘¡ and ğœ‡ğ‘¡+1 are probability distribution of ğ—ğ‘¡ and ğ—ğ‘¡+1 in â„ğ‘‘ , where ğ‘‘ is the dimension. We define the optimal transport map ğ“ğ‘¡ âˆ¶ â„ğ‘‘ â†’ â„ğ‘‘ , where â„ğ‘‘ can be interpreted as the domain space for ğ±ğ‘¡ or ğ±ğ‘¡+1. In this optimal transport problem, one constraint for the transportation map ğ“ğ‘¡ from a measure ğœ‡ğ‘¡ to a measure
ğœ‡ğ‘¡+1 is the so-called measurement-preserving, i.e., ğ“ğ‘¡#ğœ‡ğ‘¡ = ğœ‡ğ‘¡+1. Among
all the measurement-preserving maps, the optimal ğ“ğ‘¡ is the one that
minimizes the transportation cost.
Since we can only observe gene expressions for sample cells at each time point, we focus on the case where the probability distributions are
discrete. The distributions ğœ‡ğ‘¡ and ğœ‡ğ‘¡+1 for gene features at time points ğ‘¡
and ğ‘¡ + 1 are defined as:

Method

In this section, we introduce the Cell Smooth Transformation
âˆ‘ğ‘›ğ‘¡
ğœ‡ğ‘¡ =
ğ‘¡ ğ‘–=1
ğ‘›âˆ‘ğ‘¡+1
ğ›¿ğ‘¡	and	ğœ‡ğ‘¡+1 =
ğ‘¡+1 ğ‘—=1
ğ›¿ğ‘¡+1ğ‘— ,	(2)

(CellST) method, which constructs the cell fate trajectories and dynamic gene networks for time-course scRNA-seq data.
where ğ›¿ğ‘¡ğ‘–  and ğ›¿ğ‘¡+1ğ‘—  are the Dirac measures at location ğ±ğ‘¡ğ‘–  and
ğ±ğ‘¡+1ğ‘— respectively. Denote the positions of the supporting points ğ—ğ‘¡ =

Cell lineage & Individual cell fate trajectories
(ğ±ğ‘¡1 , ğ±ğ‘¡2 , â€¦ , ğ±ğ‘¡
ğ‘›ğ‘¡
)ğ‘‡ . In discrete cases, the transport ğ“ğ‘¡ from ğœ‡ğ‘¡ to ğœ‡ğ‘¡+1 can


To construct the cell fate trajectories, we first align the cells at dif- ferent time points to construct the cellsâ€™ lineages information between time points. We then smooth the gene expression pattern for each gene over time and extract the â€mean curveâ€ of all individual gene expres-
be denoted as ğ“ğ‘¡(ğ—ğ‘¡) = Î£ğ—ğ‘¡, where Î£ is an ğ‘›ğ‘¡+1 Ã— ğ‘›ğ‘¡ matrix. For simplic-
ity, we first consider the equal-size mapping, i.e., ğ‘›ğ‘¡ = ğ‘›ğ‘¡+1 = ğ‘›. Notice that in this case, the transport between ğ—ğ‘¡ and ğ—ğ‘¡+1 is a one-to-one as- signment with permutation, Î£ then can be regarded as a permutation matrix with the (ğ‘–, ğ‘—)th element:

sion patterns in single cell fate trajectories to obtain the general gene expression pattern.
Î£ğ‘–,ğ‘— =
{
1	if ğ“ğ‘¡(ğ±
ğ‘¡ğ‘—
) = ğ±
ğ‘¡+1ğ‘– ,
(3)


Cell-to-cell lineages by optimal transport
Regarding cells at different time points as cells with genes of different domain spaces, we transform the problem of aligning cells at different
the normalized gene expression for cell ğ‘– at time ğ‘¡ by a ğ‘‘-dimensional time points into a problem of domain adaptation. Specifically, we denote
0	otherwise,
1 For ğ±ğ‘¡ , we (1) use all available genes, (2) select highly expressed genes, or (3)
apply dimension reduction methods such as the principal component analysis (PCA). In the first two cases, each gene expression represents an individual gene; while in the last case, each gene feature represents a combination of all genes.



Furthermore, the transportation cost ğ¶(ğ“ğ‘¡) defined in (1) can be calcu-
the minimization of

lated as:
1 âˆ‘ğ‘› (	( )
)2	1

âˆ‘ğ‘› âˆ‘ğ‘›  (	)
ğ‘›	ğ‘”ğ‘– âˆ’ ğœ‚ ğ‘¡ğ‘–
â€“ ğ³ğ‘‡ ğ›
+  ğ›ğ‘‡ Î£ğ› + ğœ†ğ½ (ğœ‚),	(7)
ğ‘›

ğ¶(ğ“ğ‘¡) =
ğ‘ ğ±ğ‘¡ğ‘— , ğ±ğ‘¡+1ğ‘–  Î£ğ‘–,ğ‘— ,	(4)
ğ‘–=1
âˆ«  â€²â€²	2

ğ‘–=1 ğ‘—=1
where the first term measures the goodness-of-fit, ğ½ (ğœ‚) =
(ğœ‚ (ğ‘¡)) ğ‘‘ğ‘¡

where ğ‘(ğ±
ğ‘¡ğ‘—
, ğ±
ğ‘¡+1ğ‘—
) can be interpreted as the energy required to transform
quantifies the smoothness of ğœ‚, and ğœ† is the smoothing parameter con-
trolling the trade-off between the goodness-of-fit and the smoothness

an individual cell from the stage as ğ±ğ‘¡ to the stage as ğ±ğ‘¡+1 . The optimal

ğ‘—	ğ‘–
of ğœ‚ [33,34]. Consider the minimization of the least squares estimation

transport map ğ“ğ‘¡ then can be calculated through:
{
(equation 7) in a space with basis  ğœ‰1 , â€¦ , ğœ‰ğ‘
}
, function ğœ‚ can be ex-

min
âˆ‘ğ‘› âˆ‘ğ‘›
ğ‘(ğ±ğ‘¡ğ‘— , ğ±ğ‘¡+1ğ‘– )Î£ğ‘–,ğ‘— .	(5)
pressed as
âˆ‘ğ‘‘

Î£ ğ‘–=1 ğ‘—=1
ğœ‚(ğ‘¡) =
ğ‘ğ‘— ğœ‰ğ‘— (ğ‘¡) = ğƒğ‘‡ (ğ‘¡)ğœ.	(8)

where ğ‘(ğ±
ğ‘¡ğ‘—
, ğ±
ğ‘¡+1ğ‘–
) = â€–ğ±ğ‘¡
â€“ ğ±
â€–ğ›¼ and â€– â‹… â€– is the Euclidean norm in â„ğ‘‘ .
ğ‘—=1

â€–	â€–
We set ğ›¼ = 2 in this paper. The minimum of the optimization problem
(5) is called the ğ¿ğ›¼-Wasserstein distance (to the power ğ›¼) and is denoted
Plugging equation 8 into equation 7, thus ğœ‚ can be estimated by mini-
mizing:

(
by ğ‘Šğ›¼ ğœ‡ğ‘¡ , ğœ‡ğ‘¡+1
)ğ›¼
. The ğ‘Šğ›¼ defines a distance on the set of distributions
(ğ  âˆ’ ğ‘…ğœ âˆ’ ğ‘ğ›)ğ‘‡ (ğ  âˆ’ ğ‘…ğœ âˆ’ ğ‘ğ›) + ğ›ğ‘‡ Î£ğ› + ğ‘›ğœ†ğœğ‘‡ ğ‘„ğœ.	(9)

(cells) that have moments of order ğ›¼. In general, the cell lineage con-
struction by optimal transport can be summarized as three steps: Esti-
mating empirical gene feature distributions ğœ‡ğ‘¡ and ğœ‡ğ‘¡+1 as in (2). Finding
With the standard formulation of penalized least squares regres- sion, the minimization of equation 7 is performed in a so-called
reproducing kernel Hilbert space	âŠ† {ğœ‚ âˆ¶ ğ½ (ğœ‚) < âˆ} in which ğ½ (ğœ‚)

an optimal transport map ğ“ğ‘¡ from ğœ‡ğ‘¡ to ğœ‡ğ‘¡+1 through (5). Applying ğ“ğ‘¡ to
is a square seminorm, and the solution resides in the space îˆº âŠ•

ğ‘¡	ğ‘¡+1
span ğ‘…  ğ‘¡ , â‹… , ğ‘– = 1, â€¦ , ğ‘› , where îˆº = {ğœ‚ âˆ¶ ğ½ (ğœ‚) = 0} is the null space

When dealing with large-scale studies involving numerous se-
of ğ½ (ğœ‚) and ğ‘… (â‹…, â‹…) is the so-called reproducing kernel in îˆ´ âŠ– îˆº . The

ğ½  ğ‘–	ğ½
ğ½	ğ½

quenced cells or measured genes, several more eï¬ƒcient algorithms can
solution has an expression:

be used to calculate the optimal transport map, including the Sinkhorn
algorithm (Cutur., 2013), sliced-Wasserstein methods [26,54], Hilbert curve-based method [56], fast Sinkhorn method [58].
ğœ‚(ğ‘¡) =
âˆ‘ğ‘š
ğ‘–=1
ğ‘‘ğœˆ ğœ™ğœˆ (ğ‘¡) +
âˆ‘ğ‘›
ğ‘–=1
(	)
ğ‘Ìƒğ‘– ğ‘…ğ½ ğ‘¡ğ‘– , ğ‘¡
(10)

Itâ€™s important to note that the optimal transport map discussed above could be unsuitable in some cases when the one-to-one cell differentia-
{  }ğ‘š
ğœˆ ğœˆ=1
is a basis of îˆº . It follows that ğ‘… = (ğ‘† , ğ‘„Ìƒ), where ğ‘† is
(ğ½ )	Ìƒ

ğ‘›Ã— ğ‘š with the (ğ‘–, ğœˆ)th entry ğœ™ğœˆ ğ‘¡ğ‘–  and ğ‘„ is ğ‘› Ã— ğ‘› with the (ğ‘–, ğ‘—) th entry
tion assumption does not hold. However, our optimal transport frame-	ğ‘… (	)

work can be modified to account for more general cell-to-cell relation- ships. Specifically, we consider the following two general scenarios. First, the number of cells may vary at different time points, and as a result, some cells may need to be reused when constructing cell-to-cell lineages. This can lead to multiple lineages passing through a single cell at specific time points. Second, cells may exhibit different proliferation rates at the same time points, i.e., the numbers of new cells produced by two cells at the same time point could be significantly different. This could result in the varying proportions of cell groups across time. To ad- dress these general assumptions, we present a comprehensive discussion of our generalized methods and experimental results in the supplemen- tary materials.
ğ½ ğ‘¡ğ‘– , ğ‘¡ğ‘— . In the smoothing spline model, the estimation of ğœ‚ is highly
related to the choosing of the smoothing parameter ğœ†. We choose the smoothing parameter ğœ† and estimate random effect ğ› by Generalized Cross-Validation (GCV) [31,34]. Since there are ğ‘‘ gene expression pat- terns over ğ‘¡ time points for the cell fate trajectories, the smoothing spline
model estimates one expression pattern for individual cells and smooths the expression patterns.
2.1.3. Dynamic gene networks
We consider the connection of two genes to be dynamic and the rela-
relationship of the ğ‘™th gene and ğ‘ th gene, where 1 ğ‘™, ğ‘  ğ‘, ğ‘™ ğ‘ . Denote tionship may smoothly change. Suppose we want to study the dynamic
ğ‘‹âŸ¨ğ‘™âŸ©(ğ‘¡) and ğ‘‹âŸ¨ğ‘ âŸ©(ğ‘¡) as the ğ‘™th gene and ğ‘ th geneâ€™s expression values of cell

ğ‘–	ğ‘–

Individual cell fate trajectories by smoothing spline model
the individual cell lineages at time points ğ‘¡ and ğ‘¡ + 1. We then align After we align the cells from different time points, we can obtain
fate trajectories ğ‘–, and ğ‘– = 1, â‹¯ , ğ‘›. By taking ğ‘™th gene as the response and
ğ‘ th gene as the covariate, we consider the functional concurrent linear
model,
ğ‘‹âŸ¨ğ‘™âŸ©(ğ‘¡) = ğ›½âŸ¨ğ‘™,ğ‘ âŸ©(ğ‘¡)ğ‘‹âŸ¨ğ‘ âŸ©(ğ‘¡) + ğœ€âŸ¨ğ‘™,ğ‘ âŸ©,	(11)

ğ‘–
cells for all time points based on the cell couplings to construct each
ğ‘–	ğ‘–,ğ‘¡

cells coarse cell fate trajectories across the timeline. Those cell fate tra- jectories are smoothed to reduce the estimation variance in CellST by utilizing the smoothing spline models. The smoothing spline model is a versatile family of smoothing methods that are suitable for both univari-
where ğ›½âŸ¨ğ‘™,ğ‘ âŸ©(ğ‘¡) models the dynamic linear relationship between two genes, ğœ€âŸ¨ğ‘™,ğ‘ âŸ©s are i.i.d. random errors with mean zero and constant vari-
ance. We estimate ğ›½âŸ¨ğ‘™,ğ‘ âŸ©(ğ‘¡) by minimizing the following penalized least
squares function,

ate and multivariate problems [33]. To construct the proposed smoothed
 1 âˆ‘ğ‘›
âˆ‘ğ¾ (	( )
(  )	(
))2

gene expression along the cell fate trajectories. Let ğ‘¡ represent the time cell trajectories, we use equation 6 to model the behavior patterns of the
ğ‘›ğ¾
ğ‘–=1 ğ‘˜=1
ğ‘‹âŸ¨ğ‘™âŸ© ğ‘¡
ğ‘–ğ‘˜
â€“ ğ›½âŸ¨ğ‘™,ğ‘ âŸ© ğ‘¡
ğ‘–ğ‘˜
ğ‘‹âŸ¨ğ‘ âŸ© ğ‘¡
ğ‘–ğ‘˜
+ ğœ†ğ½ (ğ›½âŸ¨ğ‘™,ğ‘ âŸ©).	(12)

points in the time-course dataset, and ğ‘”ğ‘– represent the gene expression
for each gene within an aligned cell fate trajectory. For co-expressed
With the representer theorem [34], the optimizer of 12 can be written as

genes, we model the gene expression patterns using a smoothing spline
ğ‘›
ğ›½Ì‚âŸ¨ğ‘™,ğ‘ âŸ© (ğ‘¡) =
âˆ‘ğ‘š
ğ‘‘ğ‘£ ğœ“ğ‘£ (ğ‘¡) +
âˆ‘ğ‘›
âˆ‘ğ¾
(	)
ğ‘ğ‘–ğ‘˜ ğ‘…1 ğ‘¡ğ‘–ğ‘˜ , ğ‘¡
(13)

mix-effect model with {ğ‘”ğ‘– , ğ‘¡ğ‘– }ğ‘–=1 as the observations [31]:
ğœ†
ğ‘£=1
ğ‘–=1 ğ‘˜=1

ğ‘”ğ‘– =
( )
ğœ‚ ğ‘¡ğ‘–
+ ğ³ğ‘‡ ğ› + ğœ€ğ‘–	(6)
where {ğœ“ğ‘£ }ğ‘š
is the basis function of the ğ‘š-dimensional null space îˆ´0,

( )	and ğ‘… (â‹…, â‹…) is the reproducing kernel of îˆ´ . Moreover, ğ‘‘
and ğ‘
are the

ğ‘– = 1, â€¦ , ğ‘›, where the regression function ğœ‚ ğ‘¡
ğ½
is assumed to be a smooth
1	ğ‘£
ğ‘–ğ‘˜

ğ‘–	( )
function on the genes domain space in a cell. ğœ‚ ğ‘¡ğ‘–
are the fixed effects
coeï¬ƒcients to be estimated. By Plugging equation 13 to equation 12,
we can yield the estimations of ğ’„ = (ğ‘ , â‹¯ , ğ‘  , â‹¯ , ğ‘ , â‹¯ , ğ‘  )ğ‘‡ and ğ’… =

and ğ³ğ‘‡ ğ› are the random effects with ğ› âˆ¼ ğ‘ (ğŸ, ğµ) and ğœ€ âˆ¼ ğ‘ ( , ğœ2)
1	1ğ¾
ğ‘‡
ğ‘›1
ğ‘›ğ¾

ğ‘–	ğ‘–
0	. The
(ğ‘‘1 , â‹¯ , ğ‘‘1ğ¾ , â‹¯ , ğ‘‘ğ‘›1 , â‹¯ , ğ‘‘ğ‘›ğ‘˜ ) , which follow

random effects are used to account for the co-expressed genes in one
( âˆ’1	âˆ’1 ( ğ‘‡  âˆ’1 )âˆ’1 ğ‘‡
)
âˆ’1	âŸ¨ğ‘ âŸ©
âŸ¨ğ‘™âŸ©

individual cell trajectory. The model terms ğœ‚(ğ‘¡) or ğœ‚(ğ‘¡) + ğ³ğ‘‡ ğ› will be esti-
mated using the penalized (unweighted) least squares method through
ğ’„ = ğŒ  âˆ’ ğŒ  ğ’ ğ’ ğŒ  ğ’
ğ’… = (ğ’ğ‘‡ ğŒâˆ’1 ğ’)âˆ’1 ğ’ğ‘‡ ğŒâˆ’1 ğ‘¿âŸ¨ğ‘™âŸ©
ğ’ ğŒ
ğ—  ğ‘¿
(14)



where	ğ—âŸ¨ğ‘ âŸ© = ğ‘‘ğ‘–ğ‘ğ‘”((ğ‘¿âŸ¨ğ‘ âŸ©ğ‘‡ , â‹¯ , ğ‘¿âŸ¨ğ‘ âŸ©ğ‘‡ ))	with	the	vector	ğ‘¿âŸ¨ğ‘ âŸ©ğ‘‡ =
experiments, we conducted cell lineage tracing in a single-cell mouse

1	ğ‘›	ğ‘–

(ğ‘‹âŸ¨ğ‘ âŸ©(ğ‘¡ğ‘–1 ), â‹¯ , ğ‘‹âŸ¨ğ‘ âŸ©(ğ‘¡ğ‘–ğ¾ ))ğ‘‡ ,  ğ‘¿âŸ¨ğ‘™âŸ© = (ğ‘¿âŸ¨ğ‘™âŸ©ğ‘‡ , â‹¯ , ğ‘¿âŸ¨ğ‘™âŸ©ğ‘‡ ))ğ‘‡  with  the  vector
hematopoietic system experiment [38]. Moreover, we evaluated the en-

ğ‘–	ğ‘–
1	ğ‘›
tire proposed framework on a scRNA-seq experiment for zebrafish cell

ğ‘¿âŸ¨ğ‘™âŸ© = (ğ‘‹âŸ¨ğ‘™âŸ©(ğ‘¡ğ‘–1 ), â‹¯ , ğ‘‹âŸ¨ğ‘™âŸ©(ğ‘¡ğ‘–ğ¾ ))ğ‘‡ , ğ’ = (ğ’ğ‘‡ , â‹¯ , ğ’ğ‘‡ )ğ‘‡ with the (ğ‘˜, ğ‘£)th entry

ğ‘–	ğ‘–	ğ‘–
1	ğ‘›
embryogenesis [39].

of the ğ¾ Ã— ğ‘š matrix ğ’ğ‘– equals to ğœ“ğ‘£ (ğ‘¡ğ‘–ğ‘˜ )ğ‘‹âŸ¨ğ‘ âŸ©(ğ‘¡ğ‘–ğ‘˜ ), ğŒ = ğ—âŸ¨ğ‘ âŸ© ğğ—âŸ¨ğ‘ âŸ© + ğ‘›ğœ†ğˆ

and ğ is the ğ‘›ğ¾ Ã— ğ‘›ğ¾ block matrix with the (ğ‘–, ğ‘—)th block is the ğ¾ Ã— ğ¾ matrix with the (ğ‘˜, ğ‘¢)th entry equals to ğ‘…1 (ğ‘¡ğ‘–ğ‘˜ , ğ‘¡ğ‘—ğ‘¢). Thus, the estimation of ğ›½âŸ¨ğ‘™,ğ‘ âŸ©(ğ‘¡) can be written as
ğ›½Ì‚âŸ¨ğ‘™,ğ‘ âŸ© (ğ‘¡) = ğ ğ‘‡ ğ’… + ğƒğ‘‡ ğ’„	(15)

Simulation

Reconstruct cell-to-cell correspondence along time points
To investigate the accuracy of cell aligning, we simulated scRNA-seq

where	ğ = (ğœ“1 (ğ‘¡), â‹¯ , ğœ“ğ‘š (ğ‘¡))ğ‘‡	and	ğƒ = (ğ‘…1 (ğ‘¡11
, ğ‘¡), â‹¯ , ğ‘…1 (ğ‘¡1ğ¾
, ğ‘¡),
experiments with only two different time points. The simulated datasets,
which contain the same number of cells and cell types, were generated

â‹¯ , ğ‘…1 (ğ‘¡ğ‘›1 , ğ‘¡), â‹¯ , ğ‘…1 (ğ‘¡ğ‘›ğ¾ , ğ‘¡))ğ‘‡ . Note that ğ›½âŸ¨ğ‘™,ğ‘ âŸ©(ğ‘¡) models the dynamic
linear relationship between ğ‘™th gene and ğ‘ th gene, and ğ›½âŸ¨ğ‘™,ğ‘ âŸ©(ğ‘¡0 ) = 0 means the correlation between gene ğ‘™ and gene ğ‘  to be 0 at the time point ğ‘¡0 . We then derive the 100(1 âˆ’ ğ›¼)% confidence band of ğ›½âŸ¨ğ‘™,ğ‘ âŸ©(ğ‘¡). We adopt the Bayes model in [33] and get the posterior variance of ğ›½âŸ¨ğ‘™,ğ‘ âŸ©(ğ‘¡)
satisfies
independently for each time point. These simulation datasets contain five same cell types in both time points. In the simulation setting, the number of cells ranges from 200 to 600, and the number of genes in one cell ranges from 100 to 500. The cell alignment and cell-to-cell corre- spondences were constructed using the CellST based only on the gene expression information of cells at each time point and no information

[
Var ğ›½âŸ¨ğ‘™,ğ‘ âŸ©
(ğ‘¡) âˆ£ ğ—, ğ—
]
âŸ¨ğ‘™âŸ©
= ğœ2
ğ‘›ğ¾ğœ†
(
ğ‘…1(ğ‘¡, ğ‘¡)+ğ
ğ‘‡ (ğ’ğ‘‡ ğŒ
âˆ’1ğ’)âˆ’1
ğ âˆ’ 2ğ ğ‘‡
ğ’…ğœ‰ âˆ’ğƒğ‘‡
)
ğ’„ğœ‰
on the benchmark labels of cell types. Specifically, we estimated an em- pirical transportation cost for the individual cell alignment between two


where
(
âˆ’1
âˆ’1 (	âˆ’1 )âˆ’1	âˆ’1 )
(16)
time points using the gene expressions in cells. We aligned cells by se- lecting pairs with the smallest transportation cost. Since cell dynamics is a continuous development process and cells within the same cell type

ğ’„ğœ‰ = ğŒ
â€“ ğŒ  ğ’ ğ’ğ‘‡ ğŒ  ğ’
ğ’ğ‘‡ ğŒ
ğ—âŸ¨ğ‘ âŸ©ğƒ
tend to have similar gene expression profiles, the cell aligning accuracy

( ğ‘‡  âˆ’1 )âˆ’1 ğ‘‡
âˆ’1  âŸ¨ğ‘ âŸ©
(17)
can be validated by counting the number of aligned cell pairs with the

ğ’…ğœ‰ = ğ’ ğŒ  ğ’	ğ’ ğŒ  ğ—  ğƒ
Using equation (16), we can estimate the posterior variance of ğ›½âŸ¨ğ‘™,ğ‘ âŸ©(ğ‘¡0 )
and write as ğ›¾âŸ¨ğ‘™,ğ‘ âŸ©(ğ‘¡0 ). We then construct the 100(1 âˆ’ ğ›¼%) Bayesâˆšian con-
same cell type (Fig. 3b).
We noticed that the accuracy of the cell aligning method has an in- creasing trend as we added more genes in cells for the simulated data.

fidence interval (BCI) of ğ›½âŸ¨ğ‘™,ğ‘ âŸ©(ğ‘¡): ğµğ¶ğ¼âŸ¨ğ‘™,ğ‘ âŸ©(ğ‘¡) âˆ¶= ğ›½Ì‚âŸ¨ğ‘™,ğ‘ âŸ© (ğ‘¡) Â± ğ‘§ğ›¼âˆ•2
ğ›¾âŸ¨ğ‘™,ğ‘ âŸ©(ğ‘¡),
This observation is due to the fact that the CellST gets more information

where ğ‘§ğ›¼âˆ•2 is the 1 âˆ’ ğ›¼âˆ•2 quantile for standard normal distribution.
We use Bayesian confidence intervals to construct the dynamic graph, where a node represents a gene, and an edge between two nodes
zero            coeï¬ƒcient            ğ›½âŸ¨ğ‘™,ğ‘ âŸ©(ğ‘¡). exists if the two corresponding genes follow the model (11) with non-

2.2. Test diï¬€erentially expressed genes
We integrate a functional ANOVA test method [35] in our frame- work to estimate deferentially expressed genes based on the con- structed cell fate trajectories. For each gene in those cell fate tra- jectories, we consider independent vectors of the random function
to learn the patterns of genes when more genes are simulated in each cell. Similarly, increasing cell numbers will also increase the aligning accuracy since cells can be treated as information replicates to enhance the accuracy. We also compared the accuracy of coupled cells with the Euclidean distance and Pearsonâ€™s correlation. Those two methods are the most commonly used distances or similarity measures for gene ex- pression analysis. [40â€“42]. The accuracy comparison results (Fig. 3b) show the CellST method achieves the best cell aligning accuracy in the simulation settings. In summary, the cell aligning method achieves high accuracy and captures the significant gene expressions when aligning cells and constructing individual cell correspondences at two different time points. Accurate cell alignment is crucial for the down-streaming

ğ—ğ‘˜ğ‘–
(ğ‘¡) = (
ğ‘˜ğ‘–1
(ğ‘¡), â€¦ , ğ‘‹
ğ‘˜ğ‘–ğ‘‘
(ğ‘¡))âŠ¤, where ğ‘˜ indicates the number of trajec-
individual cell fate prediction when aligned cells are transformed into a

tory groups, ğ‘– indicates cells and ğ‘‘ indicates the number of genes in one
individual cell trajectory, defined over the interval ğ¼ . In the multivariate
analysis of variance problem for functional data (FMANOVA), we test
the following hypothesis
ğ»0 âˆ¶ ğ1 (ğ‘¡) = â‹¯ = ğğ‘˜ (ğ‘¡), ğ‘¡ âˆˆ ğ¼, 
(18)
ğ´	1	ğ‘˜
Wilks lambda test statistics for testing significantly different genes
tions of test statistics are approximated by ğ¹(ğ‘™âˆ’1)ğœ…,(ğ‘›âˆ’ğ‘™)ğœ… -distribution, ğœ… are approximated using the fdANOVA method [35]. The null distribu-
are estimated by the naive and biased-reduced methods [36]. The ğ‘-
trajectory over time.

CellST estimate cell fates in two simulated pathways
To investigate the effectiveness in predicting the individual cell fates, we simulated a time-course scRNA-seq data with 13 experimental time stamps, and 160 cells were simulated at each time stamp. This simu- lation dataset has two pathways with distinct development expression patterns, and each pathway contains 100 genes. The first pathway was created using the contact inhibition genes that keep cells growing into only a layer one cell thick (mono-layer) [43,44]. The growth of cellsâ€™ av- erage expression in this simulated pathway diminishes and approaches

(	)

value is given by ğ‘ƒ ğ¹(ğ‘™âˆ’1)ğœ…,(ğ‘›âˆ’ğ‘™)ğœ… > ğ¹ğ‘› , where ğ¹ğ‘› denotes the test statis-
tic. P-values for all genes tested are corrected by Benjamini & Yekutieli
method [37].

Results

We evaluated the performance of the CellST framework on cell lin- eage tracing and cell fate prediction in both simulated and real scRNA- seq experiments. The simulation analysis was conducted in two sce- narios: Firstly, we simulated scRNA-seq datasets with cells at two time points to only investigate the accuracy of constructed cell-to-cell corre- spondence between time points. Secondly, we simulated a time-course scRNA-seq dataset with multiple time points to examine individual cell differentiation patterns in the cell fate trajectories. For real scRNA-seq
an equilibrium expression over time. We simulated the second pathway according to the cellular division process, which is more active in cells under mitosis and less active in cells in interphase [45]. Eighty cells con- tain only the contact inhibition pathway at each time point, and eighty cells contain only the cellular division pathway.
To observe and predict the dynamic cell fates, we utilized cellsâ€™ experimental time information and built individual cell fate trajecto- ries using CellST. The cell lineages between adjacent time points were constructed using cell lineage tracing in CellST (Fig. 4a). Those con- nected cells were then smoothed using the smoothing spline technique in CellST to estimate the cell fate trajectories. Fig. 4b illustrates the es- timated individual cell fate trajectories (red curves). Based on the two distinct pathways, the two types of cells are automatically well sepa- rated by CellST. The expressions of cell fate trajectories were compared




Fig. 3. A simulation example of cell aligning process at two time points. a: Cell-to-cell alignment with five (right) cell types in both time points. b: Accuracy comparison of the cell aligning process (red) with other gene similarity measurements (Pearson correlation (blue) and Euclidean distance (green)).


Fig. 4. a: Cell couplings through all time points constructed by the CellST method. The cells are classified by the pathway they contain. b: The cell fate trajectories (red curves) built by CellST and Benchmark average expression cell trajectory(black curve). c: Development expression patterns for a simulated gene (m_67). The red and black curves estimated by the CellST method indicate the gene expression in two different pathways. The dotted two curves are constructed by the tradeseq method.


with the benchmark pathway expression patterns (black curves). The expression of cell fate trajectories illustrates consistent patterns with the benchmark expression of the two simulated pathways over time. In addition to the consistency, we observed that cells have unique behav- iors over time from the cell fate trajectories. Some cells grow slower and have lower expression values, while others grow faster and have higher expression values than the simulated average development pat- terns. The cell fate trajectories predict the unique cell development be- haviors by smoothing the constructed cell lineages to reduce cell-cell variance.
Next, we performed a comparative analysis of CellST with the ex- isting trajectories analysis method â€œtradeseqâ€ [46]. The â€œtradeseqâ€ is a trajectory-based method to estimate the dynamic expressions of dif- ferentially expressed genes. By comparing the gene expression patterns constructed by CellST and tradeseq (Fig. 4c), we notice that the tradeseq method constructed two similar expression patterns for a simulated gene expression (dotted curves), while the CellST method built two distinct expression patterns (black and red curves). Those constructed dynamic gene expression curves by CellST are also consistent with the simulated benchmark expressions by showing distinct expression patterns. When constructing the cell fate trajectories, the CellST method can automati- cally classify cells that contain different pathway expressions and con- struct cell correspondences within the same pathway.

Real scRNA-Seq Experiments

CellST construct accurate cell lineages
We applied the proposed method on a single cell mouse hematopoi- etic system experiment to evaluate the effectiveness of constructing cell lineages [47]. The dataset includes three experimental time points and the cells defined a continuous state map spanning from multipotent
progenitors (MPPs) to nine mature cell types, including erythrocytes (Er), megakaryocytes (Mk), basophils (Ba), mast cells (Ma), eosinophils (Eos), neutrophils (Neu), monocytes (Mo), plasmacytoid dendritic cells (pDCs), Ccr7+ migratory DCs (migDCs), and lymphoid precursors (Ly) (Fig. 5a). We constructed the cell developing lineages for neutrophils (Neu) cell type and compared the results with the benchmark cell pseudo-time from the original experiment (Fig. 5a). CellST connected cells through the three experimental time points to represent the de- veloping processâ€™s penitential cell lineages. Specifically, we estimated an empirical transportation cost for the individual cell correspondence between two time points using the gene expressions in cells and then aligned cells by selecting pairs with the smallest transportation cost.
Since cell development is a gradual process and cells within the adja- cent time points tend to have similar gene expression profiles, we mea- sured the differences from cell pseudo-time in all constructed cell lin- eages. We compared the distribution of cell pseudo-time with Pearsonâ€™s correlation method, which has been widely used to measure similar- ity between two cells [40â€“42]. Comparing with Pearsonâ€™s correlation method, we observed that CellST constructs cell lineages with higher cell similarities, in which the changes in pseudo-time of connected cells are gathering near zero (Fig. 5b and c). The results indicate that CellST can observe the gradually step-wise developing behaviors of cells at each time point. CellST constructed cell lineages based on the cell-cell correspondence connection to represent the cell-developing behaviors throughout the time points.

Discover critical genes in zebrafish cell embryogenesis

To further investigate individual cell differentiation behaviors and gene-gene relationships, we performed CellST on a zebrafish embryoge- nesis scRNA-seq dataset. This dataset contains 38,731 cells and 11,588




Fig. 5. Constructing individual cell lineages with mouse hematopoietic system. a: scRNA-seq dataset for hematopoietic stem cell differentiation. We specifically focus on the cell differentiation of neutrophils (Neu) mature cell types. b: The distribution pseudo time difference between aligned individual cells between two time points. The distribution has been compared with the Pearson Correlation method, which measures the similarities between cells. c: Boxplot comparison for the pseudo time difference between CellST and Pearson correlation method.


genes of early zebrafish development using Drop-seq [39]. Samples in the dataset are from the high blastula stage (3.3 hours post-fertilization) when most cells are pluripotent, to the six-somite stage (12 hours post- fertilization), when many cells have differentiated into different cell types. We observed that cells were clustered together at the beginning high blastula stage and differentiated into different cell types in later development stages. Since we are constructing cell trajectories for mul- tiple cell types simultaneously, the proliferation rates potentially vary across cells. To address this, we utilize our generalized CellST method to construct cell fate trajectories (Fig. 6a), which capture the unique individual cell development behaviors under more general scenarios. This method also enables us to estimate the proliferation rate for each individual cell. The histograms of the normalized proliferation rates at different time points are presented in Fig. 6b. Note that the mean of the normalized proliferation rates at each time point equals 1, while the variance indicates the heterogeneity level of the proliferation rates among cells at the corresponding time point. We notice that this hetero- geneity is significantly high in the early stages of the cell differentiation process and decreases gradually over time.
Unlike the bulk cell trajectory, the CellST cell fate trajectories
achieved full cell development coverage for all cells. The full coverage indicates that the cell fate trajectories can reveal less frequent cell de- velopment patterns overlooked by the bulk cell trajectory. The CellST
constructed cell fate trajectories throughout the stages and illustrated the unique individual cell development behaviors. The cell fate trajec- tories return each cellâ€™s potential cell fate paths into different cell types throughout the 12 developmental stages.
Furthermore, as cells developed into multiple cell types at the 12.0- 6-somite stage (last developmental stage), we built trajectory groups to those cell fate paths by CellST according to the cell types in the last developmental stage. We constructed the dynamic gene networks (Fig. 6c) for each group of cell fate trajectories. In those dynamic net- works, we observed some genes that behave significantly differently from other genes (Fig. 6c) as cells developed into different cell types. For instance, MYF5, MYOD1, and KRT18 genes appeared to behave dif- ferently in two of the trajectory groups in later developmental stages. The MYF5 is a protein with a key role in regulating muscle differen- tiation or myogenesis, specifically the development of skeletal muscle [48,49], and MyoD1 is a key regulator that orchestrates skeletal mus- cle differentiation through the regulation of gene expression [50,51]. Moreover, KRT18 regulates the epithelial cell differentiation process [52,53].
We then visualized and validated the expressions of those critical genes (Fig. 6d and Fig. 6e). The expressions of MYF5 and MYOD1 genes are significantly higher in trajectory group 5 versus in other trajectory groups, which is consistent with the discovery in the CellST dynamic




Fig. 6. a: We constructed the individual cell fate trajectories by connecting cells through the 12 developing stages. b: Histograms of the distribution of the cell proliferation rates at different time points. c: Illustration of identifying multiple cell trajectory groups based on the cell types at the 12.0-6-somite stage (last developmental stage). d: Example of critical genes identified using CellST dynamic gene network. e: Dynamic gene networks constructed by CellST for the cell trajectory groups.


Table 1
Top five gene functional annotation groups.



networks. KRT18 is highly expressed in trajectory group 15, which is also consistent with the CellST dynamic network results. Additionally, we performed functional deferentially expressed gene tests based on the CellST cell fate trajectories. We discovered a total of 268 differentially expressed genes in this zebrafish cell development process dataset. We performed gene ontology annotations to those genes (Table 1), and the function of those genes is highly related to regulating the cell develop- ment/differentiation process.
Those results proved that the cell fate trajectories and dynamic gene networks in the CellST method can be used to discover critical genes in a cell differentiation process. We also demonstrated the CellST cell fate trajectories have full coverage on different cell lineages even in some rare cell types since the trajectories track individual cell behav- iors. Lastly, those individual cell fate trajectories reflect unique gene expression patterns when cells develop into different mature cell types.

Discussion

Understanding the dynamic of cell differentiation throughout a pe- riod is crucial for future research in scRNA-Seq analysis. We devel- oped a novel machine learning analysis framework, CellST, to build cell fate trajectories and dynamic gene networks for time-course scRNA-seq datasets. The cell fate trajectories enabled researchers to observe the individual cell development behaviors and better use the benefit of the single cell sequencing technology. Compared to the existing bulk single- cell trajectory, we brought the cell development analysis into a more
precise and unprecedented resolution. The dynamic gene networks esti- mated the dynamic relationship of genes and discovered potential criti- cal genes during cell differentiation processes.
There are three major advantages of the CellST analysis frame- work. Firstly, the cell lineages were constructed with high accuracy and provides unique individual cell differentiation behaviors between time points. Secondly, since the trajectory tracks individual cells, the cell fate trajectories will have full coverage on different cell lineages even in some rare cell types (Fig. 6a). Thirdly, the dynamic gene networks analysis in the CellST framework can accurately estimate gene-gene re- lationships and discover critical genes in the cell differentiation process. Through the simulation and real dataset analysis, We constructed cell fate trajectories in single cell RNA-seq experiment and various dynamic cell differentiation behaviors were observed.

Code availability

The CellST R package and example for constructing the cell fate tra- jectories and dynamic gene networks analysis can be found on GitHub (https://github.com/zhanzmr/CellST).

Author information

Corresponding authors: Correspondence to Jingyi Zhang and Ping Ma.
Co-first author: Mengrui Zhang, Yongkai Chen

Declaration of Competing Interest

The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.
Data availability

All data used in this paper are publicly available datasets. The mouse hematopoietic system experiment dataset can be found on



GitHub (https://github.com/AllonKleinLab/paper-data). The zebrafish embryogenesis dataset from the original paper [24] can be found in the NCBI database with accession number GSE106587.

Acknowledgements

This work was supported by National Science Foundation grants DMS-1903226,  DMS-1925066,  DMS-2124493  and  NIH  grants
R01GM1222080. The authors acknowledge the contribution of Dr. Jingyi Zhang for the grant â€œNational Key R&D Program of China (No. 2021YFA1001300)â€.

Supplementary material

Supplementary material associated with this article can be found, in the online version, at doi:10.1016/j.ailsci.2023.100068.

References

Spiller DG, Wood CD, Rand DA, White MR. Measurement of single-cell dynamics. Nature 2010;465(7299):736â€“45.
Guo J, Grow EJ, Yi C, Mlcochova H, Maher GJ, Lindskog C, Murphy PJ, Wike CL, Carrell DT, Goriely A, et al. Chromatin and single-cell rna-seq profiling reveal dy- namic signaling and metabolic transitions during human spermatogonial stem cell development. Cell Stem Cell 2017;21(4):533â€“46.
Burrows N, Bashford-Rogers RJ, Bhute VJ, PeÃ±alver A, Ferdinand JR, Stewart BJ,
hypoxia-inducible factor-1ğ›¼ activity is essential for normal b cell development. Na- Smith JE, Deobagkar-Lele M, Giudice G, Connor TM, et al. Dynamic regulation of
ture Immunol 2020;21(11):1408â€“20.
Nawy T. Single-cell sequencing. Nature Methods 2013;11(1):18.
Shapiro E, Biezuner T, Linnarsson S. Single-cell sequencing-based technologies will revolutionize whole-organism science. Nature Rev Genet 2013;14(9):618â€“30.
GrÃ¼n D, Oudenaarden A. Design and analysis of single-cell sequencing experiments. Cell 2015;163(4):799â€“810.
Tanay A, Regev A. Scaling single-cell genomics from phenomenology to mechanism. Nature 2017;541(7637):331â€“8.
Lawson DA, Bhakta NR, Kessenbrock K, Prummel KD, Yu Y, Takai K, Zhou A, Eyob H, Balakrishnan S, Wang C-Y, et al. Single-cell analysis reveals a stem-cell program in human metastatic breast cancer cells. Nature 2015;526(7571):131â€“5.
Hrvatin S, Hochbaum DR, Nagy MA, Cicconet M, Robertson K, Cheadle L, Zilio- nis R, Ratner A, Borges-Monroy R, Klein AM, et al. Single-cell analysis of experi- ence-dependent transcriptomic states in the mouse visual cortex. Nature Neurosci 2018;21(1):120â€“9.
Stegle O, Teichmann SA, Marioni JC. Computational and analytical challenges in single-cell transcriptomics. Nature Rev Genet 2015;16(3):133â€“45.
Alonge M, Wang X, Benoit M, Soyk S, Pereira L, Zhang L, Suresh H, Ramakrishnan S, Maumus F, Ciren D, et al. Major impacts of widespread structural variation on gene expression and crop improvement in tomato. Cell 2020;182(1):145â€“61.
Ren G, Jin W, Cui K, Rodrigez J, Hu G, Zhang Z, Larson DR, Zhao K. Ctcf-mediated enhancer-promoter interaction is a critical regulator of cell-to-cell variation of gene expression. Mol Cell 2017;67(6):1049â€“58.
Qiu X, Hill A, Packer J, Lin D, Ma Y-A, Trapnell C. Single-cell mrna quantification and differential analysis with census. Nature Method 2017;14(3):309.
Cannoodt R, Saelens W, Saeys Y. Computational methods for trajectory inference from single-cell transcriptomics. Eur J Immunol 2016;46(11):2496â€“506.
Trapnell C. Defining cell types and states with single-cell genomics. Genome Res 2015;25(10):1491â€“8.
Ji Z, Ji H. Tscan: pseudo-time reconstruction and evaluation in single-cell rna-seq analysis. Nucl Acid Res 2016;44(13). e117â€“e117
Chen H, Albergante L, Hsu JY, Lareau CA, Bosco GL, Guan J, Zhou S, Gorban AN, Bauer DE, Aryee MJ, et al. Single-cell trajectories reconstruction, exploration and mapping of omics data with stream. Nature Commun 2019;10(1):1â€“14.
Trapnell C, Cacchiarelli D, Grimsby J, Pokharel P, Li S, Morse M, Lennon NJ, Li- vak KJ, Mikkelsen TS, Rinn JL. The dynamics and regulators of cell fate deci- sions are revealed by pseudotemporal ordering of single cells. Nature Biotechnol 2014;32(4):381.
Liu Z, Lou H, Xie K, Wang H, Chen N, Aparicio OM, Zhang MQ, Jiang R, Chen T. Re- constructing cell cycle pseudo time-series via single-cell transcriptome data. Nature Commun 2017;8(1):1â€“9.
Tritschler S, BÃ¼ttner M, Fischer DS, Lange M, Bergen V, Lickert H, Theis FJ. Concepts and limitations for learning developmental trajectories from single cell genomics. Development 2019;146(12).
Moon KR, Stanley III JS, Burkhardt D, van Dijk D, Wolf G, Krishnaswamy S. Manifold learning-based methods for analyzing single-cell rna-sequencing data. Curr Opin Syst Biol 2018;7:36â€“46.
Dai K, Damodaran K, Venkatachalapathy S, Soylemezoglu AC, Shivashankar G, Uh- ler C. Predicting cell lineages using autoencoders and optimal transport. PLoS Com- put Biol 2020;16(4):e1007828.
Saelens W, Cannoodt R, Todorov H, Saeys Y. A comparison of single-cell trajectory inference methods. Nature Biotechnol 2019;37(5):547â€“54.
Wagner DE, Weinreb C, Collins ZM, Briggs JA, Megason SG, Klein AM. Single-cell mapping of gene expression landscapes and lineage in the zebrafish embryo. Science 2018;360(6392):981â€“7.
Villani C. Topics in optimal transportation. American Mathematical Soc; 2003.
Meng C, Ke Y, Zhang J, Zhang M, Zhong W, Ma P. Large-scale optimal transport map estimation using projection pursuit. In: Advances in Neural Information Processing Systems; 2019. p. 8116â€“27.
Schiebinger G, Shu J, Tabaka M, Cleary B, Subramanian V, Solomon A, Gould J, Liu S, Lin S, Berube P, et al. Optimal-transport analysis of single-cell gene expression identifies developmental trajectories in reprogramming. Cell 2019;176(4):928â€“43.
Tong A, Huang J, Wolf G, van Dijk D, Krishnaswamy S. Trajectorynet: a dy- namic optimal transport network for modeling cellular dynamics. arXiv Preprint arXiv:200204461 2020.
Zhang J, Zhong W, Ma P. A review on modern computational optimal transport methods with applications in biomedical research. arXiv preprint arXiv:200802995 2020.
Wang J-L, Chiou J-M, MÃ¼ller H-G. Functional data analysis. Annual Rev Stat Appl 2016;3:257â€“95.
Gu C, Ma P. Optimal smoothing in nonparametric mixed-effect models. Annal Stat 2005;33(3):1357â€“79.
Courty N, Flamary R, Tuia D. Domain adaptation with regularized optimal transport. In: Joint European conference on machine learning and knowledge discovery in databases. Springer; 2014. p. 274â€“89.
Gu C. Smoothing spline ANOVA models, vol 297. Springer Science & Business Media; 2013.
Wahba G. Spline models for observational data. CBMS-NSF Regional Conference Series in Applied Mathematics, vol. 59. Philadelphia: SIAM; 1990.
GÃ³recki T, Smaga Å. fdanova: an r software package for analysis of variance for univariate and multivariate functional data. Comput Stat 2019;34(2):571â€“97.
Zhang J. Analysis of variance for functional data. Monograph Stat Appl Probab 2014;127:127.
Benjamini Y, Yekutieli D. The control of the false discovery rate in multiple testing under dependency. Annal Stat 2001:1165â€“88.
Weinreb C, Wolock S, Tusi BK, Socolovsky M, Klein AM. Fundamental lim- its on dynamic inference from single-cell snapshots. Proc Natl Acad Sci 2018;115(10):E2467â€“76.
Macosko EZ, Basu A, Satija R, Nemesh J, Shekhar K, Goldman M, Tirosh I, Bialas AR, Kamitaki N, Martersteck EM, et al. Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets. Cell 2015;161(5):1202â€“14.
Angermueller C, Clark SJ, Lee HJ, Macaulay IC, Teng MJ, Hu TX, Krueger F, Small- wood SA, Ponting CP, Voet T, et al. Parallel single-cell sequencing links transcrip- tional and epigenetic heterogeneity. Nature Method 2016;13(3):229â€“32.
Klimovskaia A, Lopez-Paz D, Bottou L, Nickel M. PoincarÃ© maps for analyzing com- plex hierarchies in single-cell data. Nature Commun 2020;11(1):1â€“9.
Skinnider MA, Squair JW, Foster LJ. Evaluating measures of association for singleâ€“ cell transcriptomics. Nature Method 2019;16(5):381â€“6.
Pavel M, Renna M, Park SJ, Menzies FM, Ricketts T, FÃ¼llgrabe J, Ashkenazi A, Frake RA, Lombarte AC, Bento CF, et al. Contact inhibition controls cell survival and proliferation via yap/taz-autophagy axis. Nature Commun 2018;9(1):1â€“18.
Mendonsa AM, Na T-Y, Gumbiner BM. E-cadherin in contact inhibition and cancer. Oncogene 2018;37(35):4769â€“80.
Tomasetti C, Durrett R, Kimmel M, Lambert A, Parmigiani G, Zauber A, Vogelstein B. Role of stem-cell divisions in cancer risk. Nature 2017;548(7666):E13â€“14.
Van den Berge K, De Bezieux HR, Street K, Saelens W, Cannoodt R, Saeys Y, Du- doit S, Clement L. Trajectory-based differential expression analysis for single-cell sequencing data. Nature Commun 2020;11(1):1â€“13.
Weinreb C, Rodriguez-Fraticelli A, Camargo FD, Klein AM. Lineage tracing on transcriptional landscapes links state to fate during differentiation. Science 2020;367(6479):eaaw3381.
Esteves de Lima J, Relaix F. Master regulators of skeletal muscle lineage development and pluripotent stem cells differentiation. Cell Regenerat 2021;10:1â€“13.
Agarwal M, Bharadwaj A, Mathew SJ. Tle4 regulates muscle stem cell quiescence and skeletal muscle differentiation. J Cell Sci 2022;135(4):jcs256008.
Blum R, Vethantham V, Bowman C, Rudnicki M, Dynlacht BD. Genome-wide identification of enhancers in skeletal muscle: the role of myod1. Genes Dev. 2012;26(24):2763â€“79.
Agaram NP, LaQuaglia MP, Alaggio R, Zhang L, Fujisawa Y, Ladanyi M, Wexler LH, Antonescu CR. Myod1-mutant spindle cell and sclerosing rhabdomyosarcoma: an aggressive subtype irrespective of age. a reappraisal for molecular classification and risk stratification. Modern Pathol 2019;32(1):27â€“36.
Jiang P, Gil de Rubio R, Hrycaj SM, Gurczynski SJ, Riemondy KA, Moore BB, Omary MB, Ridge KM, Zemans RL. Ineffectual type 2â€“toâ€“type 1 alveolar epithe- lial cell differentiation in idiopathic pulmonary fibrosis: persistence of the krt8hi transitional state. Am J Respirat Crit Care Med 2020;201(11):1443â€“7.
Liu Y, Li J, Yao B, Wang Y, Wang R, Yang S, Li Z, Zhang Y, Huang S, Fu X. The stiffness of hydrogel-based bioink impacts mesenchymal stem cells differen- tiation toward sweat glands in 3d-bioprinted matrix. Mater Sci Eng: C 2021;118: 111387.
Bonneel Nicolas, Rabin Julien, PeyrÃ© Gabriel, Pfister Hanspeter. Sliced and radon wasserstein barycenters of measures. Journal of Mathematical Imaging and Vision 2015;51:22â€“45.
Li Mengyu, Yu Jun, Xu Hongteng, Meng Cheng. Eï¬ƒcient approximation of gro- mov-wasserstein distance using importance sparsification. Journal of Computational and Graphical Statistics 2023a:1â€“25 just-accepted.
Tao Li, Cheng Meng, Jun Yu, and Hongteng Xu. Hilbert curve projection distance for distribution comparison. arXiv preprint arXiv:2205.15059, 2022.



Li Tao, Yu Jun, Meng Cheng. Scalable model-free feature screening via sliced-wasser- stein dependency. Journal of Computational and Graphical Statistics 2023b:1â€“24 just-accepted.
Liao Qichen, Chen Jing, Wang Zihao, Bai Bo, Shi Jin, Wu Hao. arXiv preprint; 2022.
Meng Cheng, Yu Jun, Zhang Jingyi, Ma Ping, Zhong Wenxuan. Suï¬ƒcient dimension reduction for classification using principal optimal transport direction. Advances in Neural Information Processing Systems 2020;33:4015â€“28.
Zhang Jingyi, Ma Ping, Zhong Wenxuan, Meng Cheng. Projection-based techniques for highdimensional optimal transport problems. Wiley Interdisciplinary Reviews: Computational Statistics 2022:e1587 page.
Zhang Jingyi, Meng Cheng, Yu Jun, Zhang Mengrui, Zhong Wenxuan, Ma Ping. An optimal transport approach for selecting a representative subsample with applica- tion in eï¬ƒcient kernel density estimation. Journal of Computational and Graphical Statistics 2023;32(1):329â€“39.
