Available online at www.sciencedirect.com



AASRI Procedia 3 (2012) 319 – 327




2012 AASRI Conference on Modeling, Identification and Control
Research on Cylinder Data Matrix Barcode Recognition
Wei-ping He a,*, Qing-song Lina, Wei Wanga, Xi-zheng Caoa, and Gai-fang Guoa
a Contemporary Key Lab of Design & Integrated Manufacturing Tec, 710072, China




Abstract

For the special requirements of recognition the Data Matrix barcode which marked on the cutter cylinder, considering of traditional recognition methods can t solve the problems such as highlight reflection, cylinder distortion, the information incomplete collection, etc., causing low recognition rate. This paper presents a cutter cylinder Data Matrix barcode recognition method based on the sequence images mosaic and fusion. This method through rotating the cutter which is put in the auxiliary device to collect a group of cutter cylinder Data Matrix barcode sequence images, and then corrects the barcode longitudinal displacement to achieve calculating matching degree and image registration based on phase correlation method. At last, in order to ensure the structure of the barcode right, the sequence images are fused into three parts on the basis of the matching degree, and then achieve module division and distortion correction of each part. Finally according to the barcode module relation, three parts are fused into a barcode image which has a correct structure, and recognize the barcode image. The experimental results show that this method can solve the problem of recognition the cutter cylinder Data Matrix barcode, the decoding accuracy achieve 95%, and mosaic the time is less than 200ms.

© 2012 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license.
Selection and/or peer review under responsibility of American Applied Science Research Institute

Keywords: Cutter cylinder, Rotating collection, Image mosaic, Data Matrix barcode


Introduction

Cutter is the foremost productive source in the whole manufacturing process. Practices show that DPM (Direct Part Marking) and Data Matrix barcode (hereinafter referred to as DM code) can solve the puzzle of


* Corresponding author. Tel.: +86-139-918-50652
E-mail address: weiping@nwpu.edu.cn.







2212-6716 © 2012 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license. Selection and/or peer review under responsibility of American Applied Science Research Institute doi:10.1016/j.aasri.2012.11.051


real-time collection and tracking of the cutter information [1][2]. However, the actual collected DM code marked on cutter cylinder have some outstanding problems, such as the highlight reflection caused by the smooth surface, cylinder distortion caused by cylinder, incomplete information collection caused by the blocked cylinder or the inappropriate collection angle, which make it difficult for recognition DM code marked on cutter cylinder, as shown in Fig.1, and when the cutter diameter is more small, the problems are more serious.
In order to solve all these problems above at once, this paper presents a method that mosaic DM code sequence images to obtain high-quality barcode image, and then recognize it. The key technologies of image mosaic are image registration and image fusion. At present, there are mainly two registration algorithms: the phase correlation method [3][4] and the feature matching method [5][6]. However, comparing with traditional image mosaic, the DM code image mosaic has two significantly different points: (1) the mosaic results has to ensure the right structure of DM code, otherwise the current methods will be easy to cause structure error; (2) the mosaic time has to ensure the real-time requirements of the barcode recognition. These differences make the current image registration algorithms unreliability. Even if there is only one registration error in sequence images, it can cause the overall error of DM code structure. In the meantime the current  correct the cylindrical distortion, and fail to meet the real-time requirements of barcode recognition. Therefore, this paper presents a new algorithm based on sequence images mosaic and fusion to recognition the DM code.


Fig.1. Cutter cylinder DM code

Cutter cylinder DM code sequence images

Cutter cylinder DM code sequence images collection principle

Cutter cylinder DM code image collection system is mainly composed of positioning device, CCD camera, LED array light source, and sealing device, as shown in Fig.2. In the image collection process, cutter is put in the positioning device, and keeps the cutter cylinder DM code in the gap of the positioning device; then rotating the cutter and the CCD camera collect the cutter cylinder images at the same time. After the cutter cylinder DM code is rotated past the crevice completely, the sequence images will completely contain the cutter cylinder DM code information. Cutter cylinder DM code images collect from a small gap with a little cylindrical distortion and no highlight reflection.




Fig. 2. Cutter cylinder DM code imaging collection system diagram

Transform model analysis

Generally the relationship of two images which getting from a scene with the same perspective but different location can be described by the affine transformation of higher geometry theory, which is a linear transform [7]. Reference image A1 and the current image A0 meet the affine transformation, then the corresponding points (x1, y1) and (x0, y0) in each image meet the affine transform:


	sin	x0	x
	cos	y0	y

(1)


Where, x, y are the translation between two images;  is the rotation angle between two images.
In this paper, cutter cylinder DM code sequence images are acquired from a gap. For simplify the computation, the cutter cylinder in a little gap can be approximated to a planar. Then the affine transformation can be simplified:


x1	x0	x
y1	y0	y

(2)


In this paper, image registration based on the above affine transformation.

Image registration

This paper locates the longitudinal position of DM code in each image firstly, then corrects the image longitudinal displacement y, and realizes image registration based on phase correlation finally.


DM code longitudinal displacement correction

The traditional methods locate DM code edge based on geometric shape feature. These methods are vulnerable to be polluted by scratches, noise with high error rate. Therefore, this paper presents a data fitting positioning method based on the image gray projection. Firstly, calculation the image horizontal gray level projection:


avg j 	pixi, j
(3)




Where, w is image width, h is image height, and pixi,j is pixel gray value of the i columns and the j rows, 0  j  h-1.
The projection data {avgj} is showed in Fig. 3. According to graph data feature, we know that the raised position in the Fig is namely the DM code longitudinal position.


Fig. 3. Projection data

This paper uses the least squares fitting method fit the projection data to locate the barcode longitudinal position. In order to avoid cyclic embedded, projection data is divided into two parts. Fitting function as follows:
a1 0  x  x1 

y1
b1 x1
x  h / 2
(4)



y	a2
b2
0  x  x2
x2  x  h

(5)


Where, a1, b2, a2, b2 are the fitting constants, x1 and x2 are fitting parameters. Through analysis the fitting variance, we can get the minimum variance:






2
min	1
h / 2

j  0
avg j

x1	h / 2

x1  1

(6)





2
min
x2
2
x2  h / 2

h  x2  1
(7)


In the range of x1 and x2, we can get the minimum values of formula (6)(7). At this time, the value of x1 and
x2 are the DM code longitudinal position, set Yd and Yu.
After calculating all the DM code positions in sequence images by above method, we use Yu to subtract Yd for getting the DM code size in each image; then calculate the mean values of DM code size of sequence images without the maximum and minimum values, set DM size Ys. Finally, cutting sequence images according to the longitudinal DM code position and the DM size Ys, getting a new sequence images height h= Ys.

Image registration based on phase correlation

Phase correlation method was proposed by Kuglin at 1975 [8], which can be able to precisely realize the two-dimensional translational images alignment. It transforms two images into the frequency domain based on two-dimensional Fourier transform. The basic principle of Phase correlation method as follows:
f1(x, y) and f2(x, y) are supposed to be two-dimensional translation images, meet f2(x, y)= f1(x-x, y-y), the Fourier transform result:


F2 u, v
e j 2
uxvy 
1
u, v
(8)


The phase correlation matrix result:

F * u, v F u, v

Q u, v
  1	2	
e j 2
uxvy
(9)

F * u, v F u, v
1	2

Where, F1* is the complex conjugate of F1.Inverse Fourier transform result as matching function:


x x, y
y	F 1 e j 2
uxvy
(10)


Matching function belongs to [0, 1]. The function will get the maximum at the relative displacement
(x,y).
As a result of longitudinal displacement has been corrected in 3.1, this  s image registration only exists in direction x. In the range of x, we can get the maximum of the matching function as the optimal matching degree , and this location as the registration location G.


According to phase correlation method above, the registration location {Gn} and the optimal matching degree {n} of the sequence images can be determined.

Image fusion

DM code has very strong error correction, as long as the structure of DM code is right, the barcode can be correctly decoded even if some barcode information is error. However, the traditional fusion methods are easily cause barcode structure error, resulting in all the information wrong. In order to ensure the DM code structure right, this paper according to the {n} divides the sequence images into three parts and preliminary fuses into three parts firstly, then corrects distortion. Finally, the three parts are fused into a correct size DM code image, and ensure the right structure.

Image preliminary fusion

Firstly, the paper searches the {n}, takes two smallest value positions as the subsection position of sequence images, divides the sequence images into three parts, and then fuses in each part based on the {Gn}. To reduce the amount of calculation and realize the smooth transition, the paper uses the weighted average method [9] directly.
Through the steps above, the sequence images fuse into three parts. In the first and last part, there contain blank area and module area, and the blank area should be cut. Using the above data fitting method, the algorithm calculates the barcode boundary in the first and last part, and then cut the blank area. After cutting, three parts only contain DM code, set Part0, Part1, and Part2.

DM code module division and distortion correction

Generally, the module division of DM code which marked on the cutter cylindrical belongs to one of
{2n*2n|4n12} styles. The references [10] proposed a mean based on DM code boundary gradient projection. By going through all the module division modes, this algorithm uses normal peak characteristic value describe each module division mode results. Based on the DM code boundary properties, the normal peak characteristics value of the correct division mode is greater than the incorrect division mode, which has robustness when DM code boundary is polluted.
According to the method, this paper divides the barcode longitudinal module, puts Part0, Part1, Part2 longitudinal alignment, and lateral side by side, then merges into one image, and calculates longitudinal gradient projection, then gets the best DM code module division mode by using the above references method, set P*P.
Causing by cylindrical curve and rotational motion blurred, the DM code image distortion has breadthwise distortion. The paper takes the max width image form Part0 , Part1 , Part2, then calculates horizontal gradient projection, searches the gradient projection, statistics complete horizontal module number q and its size Mq. The theory barcode module size is Ms=h/P, the actual barcode module size is M=Mq/q, and the DM code distortion ratio is =Ms/M.
According to distortion ratio , using bilinear interpolation corrects the image width of Part0, Part1, and
Part2. After corrected, the image width is w0, w1, w2.


DM code image generation

Through the calculation above, the DM code sequence images contains the DM code module number is P*P, the size is h*h, and the module size is Ms*Ms. Then the algorithm set a memory buffer h*h, and divide meshes P*P.
Firstly, the image Part0 is put on the left side of the memory area, and the image Part2 is put on the right side. The algorithm scans Part1 by vertical scanning line, and marks the position where scanning line has maximum gradient, then puts Part1 between Part0 and Part2, and moves overlap w column elements with Part0 to the right until overlap one columns element. In the moving process, when the vertical scanning line marked in Part1 overlaps with the memory area mesh dividing line, the algorithm calculates the MSE of overlap region, sets the MMSE position as registration position finally, and cuts overlap area reserves at most 10 column elements, uses above weighted average method to fuse them. At last, using mature decoding algorithm recognizes the DM code in the buffer zone.

Experimental results analysis

In order to confirm the effectiveness of the algorithm above, this paper tests on the cutter cylinder DM code imaging system, using MV-1300UM as the CCD camera, the focal length f=25mm, the image resolution 180*512. Sequence images mosaic on the computer with CPU 2.0GHz, memory 1GB with VC6.0.
We select 80 groups of DM code sequence images, collect ranges include, cutter diameter:  5~ 30, cutter material: high-speed steel and hard alloy, DM size: 4mm~12mm. Using the algorithm to mosaic these images, the accuracy decoding rate of the mosaic results can achieve 95%, and the mosaic time is less than 200ms. Comparisons the experimental results between this novel algorithm and the traditional algorithm are presented in table 1.
Table1. Comparisons between this novel algorithm and the traditional algorithm results

Fig 4 is a group cutter cylinder DM code sequence images, and the image mosaic result by the classical phase correlation, feature matching and this algorithm.










Cutter cylinder DM code sequence images


		
Phase correlation (boundary error)	Feature matching (structural error)	This algorithm

Fig. 4. Image mosaic results

As the experimental results shown above, comparing with traditional algorithms, the novel cutter cylinder DM code sequence images mosaic algorithm has great advantages not only in time but also accuracy. Is also convenient to the subsequent decoding, improving the decoding speed. But, the DM code and the cutter axis generally have an angle, when the angle is greater than 15°, this mosaic algorithm maybe fail.

Conclusions

In the light of the special requirement of cutter cylinder DM code sequence images, this paper designs a cutter cylindrical DM code sequence images collection system, and focuses on analysis the mosaic method for DM code sequence images. For meet the real-time and reliability requirements of the DM code recognition, this paper proposes a new DM code sequence images mosaic method, discusses the mosaic model, image registration, image fusion, etc. The experimental results show that the algorithm can effectively mosaic cutter cylinder DM code sequence images, keep the DM code structure correct, and raise the barcode mosaic correct rate and decode accuracy.

Acknowledgements

National Natural Science Foundation of China (51275419).

References

Keegan W B. Application of Data Matrix Identification Symbols to Aerospace Parts using Direct Part Making Methods/Techniques, NASA- HDBK- 6003. R Atalanta: Materias, Processes and Manufacturing Department of NASA, 2001.
Su-an Wang, Wei-ping He, Wei Zhang, etc. Direct tool marking & identification method, J Computer Integrated Manufacturing Systems, 2007; 13(6): 1169~74.
B. Srinivasa Reddy, B. N. Chatterji. An FFT based technique for translation, rotation. and scale-invariant image registration. J IEEE Transactions on Image Processing. 1996; 3(8): 1266~70.
Hong-jie Xie et al. Automatic Image registration based on FFT algorithm and IDL/ENVI. C International Conference on Remote Sensing and GIS/GPS. ICORG; 2000.
Xian-xiang Wu, Bao-long Guo, Juan Wang. Cylindrical Panoramic Image Automatic Mosaic Algorithm Based on Phase Correlation. J Acta Optica Sinica. 2009;(07):82~87.
Yong-bin Zheng, Xin-sheng Huang and Song-jiang Feng. An Image Matching Algorithm Based on


Combination of SIFT and the Rotation Invariant LBP. J Journal of Computer -Aided Design & Computer Graphics, 2010(02):104~10.
Hui-feng Wang, Shang-qian Liu, Da-bao Wang, etc. Panoramic Image Mosaic Method For Rotary Scanning Serial Image. J Acta Optica Sinica, 2009; 29(05): 81~85.
[8]C. Kuglin, D. Hines. The phase correlation image alignment method. Conference on Cybernetics and Society. New York, IEEE. 1975;163~65
Juan Wang, Jun Shi, Xianxiang Wu. Survey of image mosaics techniques. J Application Research of Computers, 2008(07):26~29+33.
Wei Wang, Wei-ping He, Lei Lei, et al. 2-D Bar Code Data Extraction on Metal Parts. J Journal of Computer- Aided Design & Computer Graphics, 2012; Vol.24 No.5:612~19.

Contact of Corresponding Author: Wei-ping He, weiping@nwpu.edu.cn, +86-13991850652
