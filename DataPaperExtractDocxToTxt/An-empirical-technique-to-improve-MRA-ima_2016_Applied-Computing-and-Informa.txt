


ORIGINAL ARTICLE
An empirical technique to improve MRA imaging

Sonia Rauf a, Kalim Qureshi b,*, Jawad Kazmi a, Muhammad Sarfraz b

a Department of Computer Science, COMSATS University, Abbottabad, Pakistan
b Department of Information Science, College of Computer Sciences and Engineering, Kuwait University, P.O. Box 5969, Safat 13060, Kuwait

Received 31 August 2014; revised 8 June 2015; accepted 8 June 2015
Available online 16 June 2015

Abstract In the Region Growing Algorithm (RGA) results of segmentation are totally dependent on the selection of seed point, as an inappropriate seed point may lead to poor segmentation. How- ever, the majority of MRA (Magnetic Resonance Angiography) datasets do not contain required region (vessels) in starting slices. An Enhanced Region Growing Algorithm (ERGA) is proposed for blood vessel segmentation. The ERGA automatically calculates the threshold value on the basis of maximum intensity values of all the slices and selects an appropriate starting slice of the image which has a appropriate seed point. We applied our proposed technique on different patients of MRA datasets of different resolutions and have got improved segmented images with reduction of noise as compared to tradition RGA.
ª 2015 The Authors. Production and hosting by Elsevier B.V. on behalf of King Saud University. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).



Introduction

In the field of medical imaging blood vessels segmentation is an important task for diagnosis of different diseases. Seg- mented blood vessels provide meaningful information about the structure and position of the vessels which plays a critical role in many medical applications such as diagnosis, surgery planning and radiation treatment planning.
Medical image segmentation is considered as a difficult task due to variable shapes of objects and different qualities of

* Corresponding author.
E-mail addresses: soniarauf@ciit.net.pk (S. Rauf), kalimuddinqure- shi@gmail.com (K. Qureshi), jawajkazmi@ciit.net.pk (J. Kazmi).
Peer review under responsibility of King Saud University.
images causing noise. Although a bundle of segmentation tech- niques have been developed [1–5] still there is no single segmentation technique that is applicable for all imaging appli- cations. The most common region segmentation method is based on threshold value, which is most often used as an initial step in the majority of image processing applications.
A lot of research has been done in this area but region growing technique has got more attention due to its simplicity, noise suppression, automation and whole tree detection of ves- sels. In region growing algorithm results of segmentation are totally dependent on the selection of seed point. An inappro- priate seed point leads toward poor segmentation. The major- ity of MRA datasets do not contain required region (vessels) in start of slices. We have been studying and published papers in MRI enhancement [6,7].
The paper is organized as follows: In Section 2, we give a brief literature survey, the details of proposed ERGA is pre- sented in Section 3, while Section 4 demonstrates the measured results and conclusion is given in Section 5.


http://dx.doi.org/10.1016/j.aci.2015.06.002
2210-8327 ª 2015 The Authors. Production and hosting by Elsevier B.V. on behalf of King Saud University. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).



Related work

In MRA, the blood vessels show a wide range of intensity val- ues due to the amount of blood flow. This is similar to the region growing technique where the rate of growth is also based upon the range of intensity values. Therefore, the con- ventional region growing technique fails to extract whole ves- sels tree. In order to solve the intensity range problem for the segmentation of blood vessels, a range of strategies based upon region growing have been proposed by various authors. Pau- lina et al. [1] implemented the idea of both global thresholding and local thresholding. Global thresholding is applied to the selection of seed points and local thresholding serves as a cri- terion to put a stop to region growing. Average intensity values of images are calculated and applied to the formula of quadra- tic polynomial, which gives a global threshold value. Seed points are obtained after applying global thresholding. Abdel-Dayem and El-Sakka [8] recommended the fuzzy region growing technique for the segmentation of carotid artery ultra- sound images. Ultrasound images usually have problems of noise and low contrast. To overcome these problems, two pre- processing steps are performed. Histogram equalization is applied in order to increase the dynamic range of the image gray levels. For noise removal, a median filter was applied on the histogram equalized image. Dokladal et al. [9] proposed a branch-based region growing technique for the segmentation of blood vessels of MRA. According to this technique, seg- mentation is performed individually branch by branch. Ini- tially a single seed point is selected manually and then it begins the search for a branch.
Another region growing based technique for the extraction of liver blood vessels from X-ray images is applied by Passat et al. [10]. Their proposed algorithm maintains hierarchical priority lists based upon ‘‘first in first out’’ where the priority to each list was assigned according to the value of luminosity. For the insertion of new points, lists are accessed randomly. Kim et al. [11] proposed an atlas based automatic approach for region-growing segmentation of brain vessels. They have implemented the concept of two threshold values: a higher and lower value respectively to cover all the vessels in tree. Multiple seed points are chosen with the help of a higher threshold value.
Kim and Park [12] have proposed a local adaptive thresh- olding based technique for the segmentation of carotid artery using MRA slices. This technique automatically computes the threshold value by considering a midpoint of maximum and minimum gray levels of only first slice. In addition, the application of the threshold value filters the first slice. Taking into account the anatomical structure of the left and right car- otid arteries, the filtered slice is divided into two subregions. Seed points of each subregion are calculated and their eight connecting neighbors are labeled in order to get the region of interest.
Almi’ani and Barkana [13] proposed a modified region growing algorithm to extract cerebral vessels of MRA images. The image segmentation, pre-processing step, gamma correc- tion and spatial operations were the components of proposed techniques. The proposed technique shows performance improvement in terms of noise attenuation, vessel enhance- ment and segmentation.
Priyadharshini and Anitha [14] applied region growing algorithm to diagnose glaucoma in eye. The pre-processing imaging technique and morphological operations such as dila- tion and erosion were incorporated and median filter was applied in the proposed technique. The technique shows per- formance improvement in terms of image quality and image edges compared to the thresholding techniques.
Wen et al. proposed [15] cerebrovascular segmentation algorithm to obtain accurate vessel. The finite mixture model, Gaussian distribution function and Rayleigh distribution func- tion were used. The proposed have two limitations that are, (i) proposed algorithm iteration runs sequentially to achieve a stable state and (ii) proposed algorithm does not consider the neighborhood relationships between the voxels.
In this paper, we proposed few enhancements in region growing algorithm. Our main contribution is to determine appropriate threshold value of slice, seed point and starting slice number. We also developed a two pass algorithm for grayscale 8-connected neighbors. We applied all these compo- nents in RGA and evaluate the performance in terms of image enhancement. The region growing algorithm that applies in our proposed system is driven from [16].

Enhanced Region Growing Algorithm (ERGA)

In the traditional region growing algorithm, results of segmen- tation are totally dependent on the selection of seed point. An appropriate seed point results in quality segmentation. How- ever, in the majority of MRA datasets, the start of the slices does not contain any required information. As a result of this, we have not applied region growing algorithm directly on the first slice. In order to begin from the required region, we have developed an automatic threshold value. To calculate the threshold, the maximum intensity value of each slice is obtained and stored in an array denoted as max_list. From this max_list, we then find the maximum and minimum intensity values, i.e. m1 and m2 respectively. Finally the difference between m1 and m2 is gained.
T = m1 — m2	(1)
The maximum intensity of each slice is compared with threshold T given in Eq. (1). Slices are checked in a sequence in ascending order. Any slice with an intensity value greater or equal to the threshold value is selected as a first slice F1. Region growing algorithm is then applied to F1 and onward slices only. In this way, the starting slice F1 is different for each dataset and is selected automatically according to max- imum intensity values. The steps for ERGA are given as follows:

Steps for slice selection algorithm

Initialize n with total number of slices in a dataset
Read all MRA slices of sequence images
Find maximum intensity value of each slice and store in an array, i.e. max_list, in ascending order.
Find maximum intensity value from max_list, i.e. m1
Find minimum intensity value from max_list, i.e. m2
Find threshold T by taking the difference of m1 and m2 values
Start loop from j = 1 to n

If max_list (j) P T
The jth slice will be selected as a starting slice for region growing
Assign value of j to F1 (first slice)
Break
Pass selected slices to region growing algorithm, i.e. F1 to n.
Apply RGA for segmentation of vessels [16].


Grayscale 8-connected neighbors for region growing algorithm

Region growing algorithm is based on the idea of neighbor’s connectivity. We have used 8-connected neighbors’ criterion for region growing. The algorithm used for labeling of 8- connected neighbors is called ‘‘two pass algorithm’’, which makes two passes over the image. One pass records the equiv- alences and assigns temporary labels. During second pass, each temporary label is replaced by the label of its equivalence class. In order to apply two pass algorithms on grayscale images threshold value is required. We have selected two threshold values, i.e. higher and lower. Higher threshold is assigned with the value of homogeneity criterion, i.e. the average of current segmented slice region and next un-segmented slice region. For lower threshold value we subtracted a constant value 10 from higher threshold value. The pseudo code of pass 1 and pass 2 is listed below.

Experiment setup and measurement results

Details of datasets used in the experiment are given in Table 1, the investigated images are ToF with T1 relaxation and 16 bit. From Table 1, the obtained value of starting slice for the enhancement and maximum intensity value of starting slice will be used for enhancement. The vessels segmentation of head MRA for dataset 1, using a region growing algorithm without any enhancement, is shown in Fig. 1. The maximum intensity value of the first slice is 356, which is very low com- pared to the maximum intensity value of the entire dataset,
i.e. 988. The first slice does not give the required information (vessels) as shown in Fig. 1a. The threshold is selected by taking an average of the difference between maximum and minimum intensity values, i.e. T = 178. After applying T on the first slice grayscale image, a binary image is con- structed. This is presented in Fig. 1b. The segmented noisy result of the first slice image following region growing is described in Fig. 1c, which does not contain any required vessel. The region growing technique is totally dependent on the selection of seed point. An inappropriate seed point results in poor segmentation, shown in Fig. 1d. In the first slice, there is no appropriate seed point. So the region is grown according to the noise (unwanted region) leading to poor segmentation.
Fig. 2a shows the grayscale (slice 27) image that is maxi- mum and minimum intensity values are 644 and 0 respectively. The threshold value for the starting slice is 322. Fig. 2b is the threshold binary image of the starting slice. The segmentation result of the starting slice is described by Fig. 2c. As soon as an appropriate starting point is selected, head vessels are extracted correctly (see Fig. 2d).
As in the first slice (Figs. 1a and 2a), there is no appropri- ate seed point, so the region grows according to the noise (unwanted region) which results in poor segmentation. This is one of the main reasons that, in order to find the correct seed point, we have proposed this very algorithm based on thresh- olding. The maximum intensity value of each of the 118 slices is obtained and stored in an array, i.e. max_list. Once again, to obtain the maximum value from max_list, i.e. 988, and mini- mum value from max_list, i.e. 356, the difference between the maximum and minimum values is calculated, which is 632. The result is selected as the threshold. The maximum intensity value of each slice is compared with the threshold. Slice 27 is the first slice with a maximum intensity value greater than 632, so it is selected as a starting slice for the proposed region growing algorithm.
Like datasets 1 and 2 the results obtained by using datasets 3 and 4 are not listed as listed in Figs. 1 and 2. This is due to






 
(a)	(b)

(c)	(d)

Figure 1 Segmentation of head vessels for dataset 1 using region growing before enhancement. (a) First slice image of head dataset. (b) Threshold image of first slice. (c) Result of first slice after region growing. (d) Final result of segmentation after region growing of all (118) slices.



(a)	(b)

(c)	(d)

Figure 2 Segmentation of head vessels of dataset 1 using region growing after enhancement, (a) selected starting slice (27) image of head dataset. (b) Thresholded image of starting slice. (c) Result of starting slice after region growing. (d) Final result of segmentation after region growing of 92 slices (27–118).


similarity of and to save the space. For datasets 3 and 4 the enhancement start by slice 36 and 8 respectively as listed in Table 1. By viewing Fig. 3 for each dataset it is observed that
the image obtained after applying ERGA has better results in terms of contract, better visibility of vessels including the thin vessels and unwanted noise is eliminated.


 
Data set 1: Before Enhancement (RGA)	Data set 1: After Enhancement (ERGA)

Data set 2: Before Enhancement (RGA)	Data set 2: After Enhancement (ERGA)

Data set 3: Before Enhancement (RGA)	Data set 3: After Enhancement (ERGA)

Data set 4: Before Enhancement (RGA)	Data set 4: After Enhancement (ERGA)

Figure 3	Comparison of obtained images by applying RGA and with ERGA.


Conclusion

The segmentation of blood vessels is an active research area which plays a significant role in many medical applications including diagnosis, surgery planning and radiation treatment. The quality of segmentation in the case of the region growing algorithm completely relies on the selection of seed point. In cases where the selected seed point does not belong to the
region of interest (vessels), the whole region will be grown incorrectly. MRA, which is used specifically for images of blood vessels, does not contain the required region in start of slices. Applying a region growing algorithm directly from the first slice will result in an inappropriate seed point, thereby leading to poor segmentation. In order to overcome this prob- lem, an ERGA has been proposed. The vessel images gener- ated by ERGA are improved quality as compared to generic RGA.



References

M. Paulinas, D. Miniiniotas, O.M. Meilunas, A. Usinskas, An algorithm for segmentation of blood vessels in images, Electron. Electr. Eng. 83 (2008) 25–28.
S. Eiho, H. Sekiguchi, N. Sugimoto, T. Hanakawa, S. Urayama, Branch-based region growing method for blood vessel segmentation, 2005.
P. Dokladal, C. Lohou, L. Perroton, G. Bertrand, Liver blood vessels extraction by a 3-D topological approach (1999) 95–105.
N. Passat, C. Ronse, J. Baruthio, J. Armspach, C. Maillot, C. Jahn, Region-growing segmentation of brain vessels: an atlas- based automatic approach, J. Magn. Reson. Imaging 21 (2005) 715–725.
S. Ehio, H. Sekiguchi, N. Sugimoto, T. Hanakawa, S. Urayama, Branch-based region growing method for blood vessel segmentation, J. Syst. Comp. Japan 36 (2005).
Mubbashar Saddique, Jawad Haider Kazmi, Kalim Qureshi, A hybrid approach of using symmetry technique for brain tumor segmentation, J. Comput. Math. Meth. Med. 2014 (2014) 1–13
(Article ID 712783).
J.H. Kazmi, K. Qureshi, H. Rasheed, An implementation of SAN filter and edge sharpening method for MRA images, Malay. J. Comp. Sci. 20 (2007) 99–114.
A.R. Abdel-Dayem, M.R. El-Sakka, Carotid artery ultrasound image segmentation using fuzzy region growing, in: Proceedings of the Second International Conference on Image Analysis and Recognition, 2005, pp. 869–878.
P. Dokladal, C. Lohou, L. Perroton, G. Bertrand, Liver blood vessels extraction by a 3-D topological approach, in: Medical
Image Computing and Computer-Assisted Intervention MICCAI’99, Lecture Notes in Computer Science, vol. 1679, 1999, pp. 98–105.
N. Passat, C. Ronse, J. Baruthio, J.P. Armspach, C. Maillot, C. Jahn, Region-growing segmentation of brain vessels: an atlas- based automatic approach, J. Magn. Reson. Imaging 21 (2005) 715–725.
D.Y. Kim, S.M. Chung, J.W. Park, Automatic navigation path generation based on two-phase adaptive region-growing algorithm for virtual angioscopy, Med. Eng. Phys. 28 (4) (2006) 339–347.
D.Y. Kim, J.W. Park, Multiple-phase segmentation approach for blood vessel extraction on cervical MRA image sequence, Magn. Reson. Imaging 27 (2) (2009) 256–263.
Muder M. Almi’, Buker D. Barkama, Vascular segmentation in magnetic resonance angiography: a modified region growing approach, in: IEEE Signal Processing in Medicine and Biology Symposium, SPMB 2012, 2012.
Lydia Glory, M. Priyadharshini, J. Anitha, A region growing method of optic disc segmentation in retinal images, in: International Conference on Electronics and Communication Systems, ICECS 2014, 2014.
Lei Wen, Xingce Wang, Zhongke Wu, Mingquan Zhou, Jesse S. Jin, A novel statistical cerebrovascular segmentation algorithm with particle swarm optimization, J. Neurocomput. 148 (2015) 569–577.
Huiyan Jiang, Baochun He, Di Fang, Zhiyuan, A region growing vessel segmentation algorithm based on spectrum information, Comput. Math. Meth. Med. (2013) 413–426 (Article ID 743809).
