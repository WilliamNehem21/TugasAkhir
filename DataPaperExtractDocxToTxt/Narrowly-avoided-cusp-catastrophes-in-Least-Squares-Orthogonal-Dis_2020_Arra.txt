Array 8 (2020) 100046

		




Narrowly avoided cusp catastrophes in Least Squares Orthogonal Distance Fitting
Alvin Penner
Fonthill, ON, Canada



A R T I C L E I N F O


MSC:
65D17
58K35
Keywords:
Least squares orthogonal distance fitting Beta2-spline
Cusp catastrophe Critical points Topology Streamlines Parametric function
Transcritical bifurcation
A B S T R A C T

Computer animation often requires that complex objects need to be modeled by fitting them with simpler shapes such as splines. It is necessary that these simpler shapes respond continuously as the object changes shape. This response can become complex if the topology of the error function is changing. The topological events which can occur when a spline is fit to a changing object are classified and analyzed, with a view towards defining conditions which make them possible. The Least Squares Orthogonal Distance Fitting (ODF) method is used to fit a continuous parametric function whose shape is changing. The fit is performed using a closed-shape Beta2-spline. Three types of topological events can occur: self-annihilation of two solutions, simultaneous merge of three so- lutions into one, and crossover of two solutions in which a local minimum and saddle point interchange roles. The events can be detected and classified by inspecting the determinants of two second-order response matrices. The last two types of event occur only within sub-manifolds defined by additional constraints not normally present in the ODF solution. The nature of these constraints is defined. The constrained events are interpreted in the context of catastrophe theory, which describes dynamical systems that can exist in multiple states with the possibility of discontinuous transitions between them. Within this theory they appear as narrowly avoided cusp catastrophes.





Introduction

When developing a computer animation of an object whose shape is changing, it may be necessary to first approximate the shape using a set of splines which are more easily rendered than the original object. As the object’s shape changes, two types of unexpected events may occur. First, in order to produce a fit whose error is minimized, it may be necessary to undergo discontinuous changes in the fitting parameters. Second, the topology of the solution set may change due to solutions merging, crossing each other, or being created. We investigate these events using the Least Squares Orthogonal Distance Fitting method (ODF). It is typi- cally used to fit a spline to a set of discrete shape data [1]. Here we will use it to generate solutions that undergo changes in topology when we fit a spline to a continuous two dimensional curve whose shape is changing. Three types of topological events will occur. The most common event is the annihilation of two solutions where one is a local minimum and the other is a saddle point [[2], p.63]. This can be described as a fold ca- tastrophe [3]. Less common is an event in which two equivalent solutions (for example, saddle points) terminate when they meet a local minimum, leaving only a single saddle point. In this case the two equivalent solu- tions will have a symmetry that is twofold less than the solution they are
meeting. Finally, the most unusual event is one in which a saddle point meets a local minimum, both with the same symmetry, and they inter- change roles. This will be described below as a narrowly avoided cusp catastrophe [3,4].
The fold catastrophe event does not require any additional constraints to be met when it occurs: it happens simply as a result of the shape change. The last two types, however, cannot occur unless additional constraints are present. We will present two different views of these additional constraints. The first view is algebraic and takes the form of a requirement that an “augmented” second-order response matrix must be singular. The second view is geometric and takes the form of a plot of a solution path relative to a catastrophe boundary. The algebraic method is desirable because it is a precisely defined local test. However, the ca- tastrophe theory interpretation has a qualitative advantage in displaying the relationship between multiple events: in the third type of event described above, where a local minimum and saddle point interchange roles during a narrowly avoided cusp catastrophe, we find that the interchange is always followed closely by a standard fold catastrophe in which a local minimum and saddle point coalesce and disappear. The algebraic method is not capable of linking these two events, but the ca- tastrophe theory plot, Fig. 1, makes it qualitatively clear that these two


E-mail address: penner@vaxxine.com. https://doi.org/10.1016/j.array.2020.100046
Received 9 June 2020; Received in revised form 26 September 2020; Accepted 21 October 2020
Available online 3 November 2020
2590-0056/© 2020 The Author(s). Published by Elsevier Inc. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-
nc-nd/4.0/).


Ch.2], which is a modified version of [1], to deal with the fitting of continuous curves rather than discrete data. Define f(a,u)= (fx, fy) as the two-dimensional spline we are adjusting to perform the fit, while g(t) = (gx, gy ) is a known parametric function to be fit. f has adjustable pa-
rameters a, and a parametric variable u ∈ [0, N] where N is the number of segments, while g will be chosen to be a superellipse [13] with para- metric variable t ∈ [t1,t2]. g has an adjustable parameter ε, which we will use to change the shape of the curve in order to see how the fitted spline responds. At each value of t we define the residual error as ||f(a, u) — g(t)||. In the ODF method we must adjust u(t) to minimize this distance, which leads to the constraint:
(f(a, u)— g(t)) · f (a, u)= 0.	(1)

where f' (a, u) = ∂f/∂u. This simply states that the residual error vector will be perpendicular to the curve f(a, u). The error functional is
1 Z t2





Fig. 1. Example of a cusp catastrophe, with a solution trajectory that contains both a fold catastrophe and a crossover event between stable and unsta- ble solutions.
We will optimize F with respect to changes in a while ensuring that Eq. (1) is satisfied at all times. The optimization uses the Newton method [[14], p.348] which relies on the fact that F can be locally approximated by a quadratic form:

events are related, and that it is highly unlikely that a solution crossover
F = F + Lta + 1 t

(3)

could occur without the associated fold catastrophe. Fig. 1 displays a system which has two independent degrees of freedom, A and B. The solution, x, is a value that extremizes a potential energy function in dynamical systems, or in our case extremizes an error function. It may consist of either one or three values. If three solutions exist, one of them (dotted line) will be unstable, while the other two (solid lines) are stable, with the possibility of discontinuous jumps between them. The boundary between these regions is shown as a curved line when projected onto the A-B plane. The blue trajectory is a solution path that contains both a fold catastrophe and a crossover event between stable and unstable solutions,
which has also been projected onto the A-B plane to show how it touches
0	a Ma
2
where at = (a1, …, an), Lt = (L1, …, Ln), Li = dF/dai, and M =
{d2F/daidaj n . The aim of the optimization is to find the critical points where L = 0, while the rate of convergence to the optimum solution will be governed by the second-order response matrix M. The character of the solution, whether it is a minimum or saddle point, will be determined by the eigenvalues of M. These eigenvalues are a measure of the curvature of F when moving in the direction of the corresponding eigenvector. The gradient L can be expressed [[12], Ch.2] as

the boundary.
Events of this type are well-known in topology, where they are clas- sified as being either “birth/death” events [5] or “interchange” events in

Li =
t2
(f(a, u)— g(t)) · ∂f
t1
, ∂ai dt	(4)

which the critical points survive. The interchange event is significantly more complex, and has been variously described as a switch [6], swap [[7], Fig. 6], or F 1 [[8], Fig. 3.1]. What is missing from these topological

while the second order response is obtained [[12], Ch.2] as Mij = t2
Gij(a, u)dt, where
G = ∂f , ∂a · ∂f , ∂a + (f(a, u) — g(t)) · ∂2f , ∂a ∂a — E(u)∂u , ∂a ∂u , ∂a .

interchange. These events are also well-known in bifurcation theory [9, 10], where an “interchange” event would be termed a transcritical bifur- cation. In this case, some examples of the constraints that need to be satisfied are given at the end of Sec. 5. The goal of the present study is to define analogous constraints in the context of ODF. We will encounter two distinct types of constraints (Secs. 6 and 7) which are sufficient to allow this to happen, in a problem which is otherwise quite simple.
The remainder of this paper is organized as follows. In Sec. 2 we derive the generic ODF method, suitable for fitting a continuous function. The family of curves we are fitting is described in Sec. 3, and the spline curve in the ODF method is specialized to be a closed-shape Beta2-spline [11]. Details of the optimization procedure are in Sec. 4, along with re- sults. Sec. 5 defines the types of topological events that occur. Sec. 6 analyzes a symmetry-breaking event, while Sec. 7 analyzes a crossover event. These sections contain explicit definitions of the constraints that are satisfied in each case. Sec. 8 casts the above events into the language of catastrophe theory.

Applying ODF to a parametric function

For the ODF method we follow closely the development of [[12],
This contains the Hessian [[14], p.340] term ∂2f/∂ai∂aj, and a term in
∂u/∂ai(∂u /∂aj), which represents the contribution caused by the fact that
Eq. (1) is satisfied at all times. To evaluate this term we use the rela- tionship [[12], Ch.2]:
E(u)∂u / ∂ai = — f (a, u)· ∂f(a, u) / ∂ai — (f(a, u) — g(t)) · ∂f (a, u) / ∂ai (6) where
E(u)= f' (a, u)· f' (a, u)+ (f(a, u)— g(t)) · f''(a, u).	(7)
The optimization proceeds [[12], Eq.2.9] by successively solving the equation
M(a — a0)= — L	(8)

to calculate the latest increment in the vector a, given the previous es- timate a0. The system of equations, Eq. (1) and Eq. (8), are solved using the “variable-separation” method [1] with a tolerance of 10—9 in both the inner and outer loops. Further computational details are available in
[[12], Ch.2].


Definition of spline f(a, u) and parametric curve g(t)

The function g(t) is taken from the family of curves in Fig. 2. These are superellipses [13]:
g(t) = (a(cost)ε, a(sint)ε)	(9)
where we will set a = 180 to facilitate comparison with [15] for the case of a circle (ε = 1). The curves have a fourfold rotation symmetry and a reflection symmetry about an axis at 45◦. This symmetry is denoted C4v in [[16], p.60]. We will attempt to fit the curves over the range 0 < ε < 2, which allows the curvature at some endpoints to range from zero to infinity.
When specifying f(a, u) we need to use at least an 8-point uniform
closed cubic B-spline, in order to emulate the symmetry of g(t). We also wish to produce a fit that is accurate to 6th order with respect to arc angle of each segment [17]. This requires that the curvature at each knot must
be independently variable, which is not possible in a B-spline. We therefore generalize to a Beta2-spline, which relaxes the continuity re- quirements at a knot from C 2 to G 2 (geometric continuity) [[11],
p.294]. We will decompose the Beta2-spline into eight cubic B´ezier
segments, and constrain the B´ezier control arms to be consistent with
  
β2i < ∞. These are consistent with the limits highlighted in the work of de Tisi and Rossini [18]. In practice, the lowest value observed here is β2 = —3.995 for a solution with radial symmetry, which did not lead to
an abnormal termination, while the upper limit was approached on five occasions, all of which led to abnormal terminations of the solution.

Optimization of a Beta2-Spline

The optimization requires the first-order response, Eq. (4), where ∂
f(a, u)/∂ai is given by the special cases:
dfw . dwi = ∂fw . ∂wi + X ∂fw , ∂dwj ∂dwj . ∂wi for w ∈ {x, y}	(12)

dfw . dβ2i = X ∂fw , ∂dwj ∂dwj . ∂β2i for w ∈ {x, y}


where the summation includes only two B´ezier control arms, dj, per segment. The terms ∂fw/∂wi and ∂fw/∂dwj are straightforward functions only of u. From Eq. (10) we obtain:
∂dwj . ∂wi = C—1	— C—1for w ∈ {x, y}	(13)

any point, and that the slopes at each knot are not constrained. Therefore, define the parameter vector a using the eight B´ezier endpoints and the corresponding β2 values: a = {x0 — x7, y0 — y7, β20 — β27}.

—1
j,(i—1) mod 8

'
dwi . 2for w ∈ {x, y}

If we define a B´ezier segment i, Fig. 2, with the four control points
{R0i — R3i}, then the control arm at the start point of this segment is given by di = R1i — R0i. The control arms are symmetric at each node since β1 = 1 [[11], Eq.14.2]. Therefore the control arm at the endpoint of
this segment, namely R2i — R3i, is equal to — di+1, so it is redundant. From [[11], Eq.14.3] we find that the components (dxi, dyi) of these
control arms can be evaluated independently using the equation:
Δw = Cdw for w ∈ {x, y}	(10)
where Δwi = w(i+2) mod 8 — wi for i ∈ [0, 7]. The matrix C is given by:
The response ∂f (a, u)/∂ai in Eq. (6) is obtained directly from this by
differentiation. The Hessian terms ∂2f/∂ai∂aj in Eq. (5) are zero unless they involve ∂/∂β2:
d2fw . dwidβ2j = X(∂fw / ∂dwk)∂2dwk . ∂wi∂β2j for w ∈ {x, y}	(14)

d2fw . dβ2idβ2j = X(∂fw / ∂dwk)∂2dwk . ∂β2i ∂β2j for w ∈ {x, y}


where the summation includes only two B´ezier control arms. Application

8> 1  for j = i and i ∈ [0, 7]
of the operator ∂2/∂wi∂β2j

		 

or ∂2/∂β2i



∂β2j
to Eq. (10) leads to:

0  otherwise.
The relationship between di and β2i is generally an inverse one: higher

∂2dwk .


—1
k,(i—1) mod 8


∂dwi

. ∂β2j
. 2for w ∈ {x, y}

β2i (sometimes referred to as tension [[11], p.307]) leads to shorter B´ezier arm length di. For the special case where all β2i are the same, we find that C is singular at β2i = — 4. Therefore we anticipate that (roughly) — 4 <


—1
k,(j—1) mod 8
. ∂β2i . 2.



Fig. 2. A family of superellipse curves at different ε. The points are B´ezier endpoints for two solution branches at ε = 0.6. Also shown is a typical B´ezier segment with endpoints (R0, R3) and control points (R1, R2).
This completes the calculation of the optimization equations.
The results of the optimization are best displayed in radial co- ordinates. The radius of the B´ezier endpoints is not very informative since it is always very close to the corresponding radius of g(t). The angle of the endpoints, however, gives useful information on symmetry. The function g(t) has eightfold symmetry, C4v, but the solution f(a, u) may have lower symmetry than this. If so, then the solution set will always contain
multiple branches which are complements of each other with the same root-mean-square (rms) error, such that the set of all complementary branches has C4v symmetry. Fig. 3 shows the variable θ0 for the B´ezier
endpoint (x0, y0) over the range 0.6 < ε < 1.4. The B´ezier endpoints are
indexed starting in the fourth quadrant, so typically — 90 < θ0 < 0. The figure shows two branches that have C4v symmetry: a “radial” branch with variable θ0 (θ1 = —90 — θ0 and r0 = r1), and an “angular” branch with r0 < r1 and θ0 = —45 (θ1 = 0). Typical B´ezier endpoints for these
two branches are shown in Fig. 2 for ε = 0.6. These are the only two
branches that have the full eightfold symmetry. In addition there are two branches with fourfold rotational symmetry, C4. These come in pairs which are reflections of each other about an axis at 45◦. They are termed “bridge” solutions because they can connect the angular and radial






Fig. 3. B´ezier end point angle θ0 as a function of ε. Three solution branches are shown.

branches of higher symmetry. The left bridge solution, which exists only for ε < 1, is approaching an angular solution at ε = 1. The right bridge solution, which begins as a bifurcation from the radial branch at ε = 1.308, will touch an angular solution at ε = 1 in Fig. 4, and then approach a different angular branch at ε = 1 after reversing direction at ε = 0.978. These are never optimal solutions but serve an essential to- pological function which will be defined below.
Fig. 3 does not contain much information on the eightfold symmetric branches, other than an affirmation of the symmetry. The details of the shape are given by the β2i values. Since we have nothing to compare the
β2i with, we choose to re-express them as B´ezier control arm lengths, di =
|di|, using Eq. (10). For the special case of a circle, ε = 1, these arm lengths can be compared directly to [[15], Fig. 6]. There are very slight differences due to the fact that the current Beta2-spline is not clamped at
the endpoints, but otherwise the two sets of solutions are qualitatively the same for the case of a circle. In Refs. [15] the “angular” solutions for the circle were subdivided into two classes: an “S-shaped” branch which includes both a symmetric (d0 = d1) solution which is a local minimum and two asymmetric branches which are also local minima, but less optimal, and an “oval-shaped” branch which contains two saddle points. This terminology is used in the current fit as well. Fig. 4 shows the arm
lengths for the range of interest. For the S-shaped and Oval branches, d0 and d1 are distinct, for the Radial branch they are equal, and for the Bridge solutions they interchange places as we switch between the two complementary branches of the solution.
A primary goal of the current study is to analytically distinguish be- tween the S-shaped and Oval branches, since they are qualitatively different, and since they intersect at ε = 0.96323. The S-shaped branch is
qualitatively obtainable by fitting curvature at the B´ezier endpoints, while the Oval branch is qualitatively the result of extremizing the < y' > moment of the B´ezier curve [15]. A secondary goal is to understand the constraints that make the bifurcation of the Radial branch at ε = 1.308 possible.
Fig. 5 shows the rms error. For ε > 1 there are five distinct unexpected
terminations of either the S-shaped or Oval branches caused by β2 → ∞, with either d0 or d1 approaching zero. There is also one instance of a narrowly avoided singularity caused by β2 → —4 in the Radial solution at ε = 1.69. However, the choice of optimum solution is unambiguous for
ε > 1. For ε < 1 the optimum solution path has a discontinuous jump
from the S-shape branch to the Oval branch at ε = 0.953 followed by a continuous crossover of these two branches at ε = 0.96323, which will be investigated below. The Oval branch also has a fold catastrophe at ε ≈ 0.91, which terminates in a manner that is consistent with [[2],
p.67], namely ΔF∝q(ﬃﬃεﬃﬃﬃ—ﬃﬃﬃﬃﬃεﬃﬃ0ﬃﬃﬃ)ﬃ3ﬃﬃ, where ε0 is the point where the merge


Two types of topological events

For each solution branch, the eigenvalues of M determine whether the solution is a minimum or saddle point. More generally, the Morse index [[2], p.55], which counts the number of negative eigenvalues [[19], Sec.3], will determine the multiplicity of the saddle points, if they exist. Since the object we are fitting is a closed shape, we anticipate that the number of local minima at each ε should equal the number of saddle points. Fig. 6 shows the lowest eigenvalues, eig0, for the four types of branches. The plot often has cusps because it is quite common for different eigenvalues of the same solution to cross each other without interacting. We are interested only in the instances where an eigenvalue crosses zero or terminates at zero, which signals a topological event. The rule for these events (if higher order saddle points are involved) is that Euler’s characteristic number [19] must be preserved [[20], Fig. 3–22, p.149]. In simplest terms this states that one local minimum must cancel one saddle point, which is the case for a fold catastrophe, or that a single saddle point must cancel a “2-saddle point” (Morse index = 2) [19]. In Fig. 6, we see that at ε = 1.4 the S-shape solution is a local minimum and

	
Fig. 4. B´ezier control arm lengths d0 and d1 as a function of ε. The Angular
solution branch is subdivided into S-shape and Oval branches.	Fig. 5. Logarithm of rms error as a function of ε.


E(u)∂u / ∂ε = — f' (a, u)· ∂(f(a, u)— g(t)) / ∂ε — (f(a, u)— g(t)) · ∂f' (a, u) / ∂ε.
(18)
To interpret Eq. (16) we switch to a representation in which M is diagonalized. Define a unitary transform U, such that Ut MU = D (diag- onal). Equation (16) can be rewritten as DUt (da /dε)+ Ut Y = 0. Now we
see that, if a given eigenvalue, D00, is zero, and if the corresponding response, Ut (da /dε), is to be well-behaved, then it is necessary that Ut Y = 0, where U0 is the eigenvector associated with D00.






Fig. 6. Lowest eigenvalues of M (eig0) and M+ (aug0) as a function of ε. aug0 is shown only for the Bridge solution, for simplicity.

the Radial solution is a saddle point, so the set of solutions is topologi- cally balanced. However, at ε = 1.308 the Radial solution becomes a local minimum, so we now require two saddle points to balance this
We wish to test this assertion on the Radial branch at ε = 1.308. On both sides of this event the solution vector a shows the pattern:
a∝(A, B, B, A, —A, —B, —B, —A,
—B, —A, A, B, B, A, —A, —B, C, C, C, C, C, C, C, C)6 ∈	(19)


where, in this case, A = x0 and B = x1. The vector Y shows the same pattern, with different values for A and B. The eigenvector U0 shows the pattern:

change. These are provided by the two fourfold symmetric bridge solu- tions for ε < 1.308, which serve an essential topological function even
U0∝(E, F, —F, —E, —E, —F, F, E,
F, E, E, F, —F, —E, —E, —F, —G, G, —G, G, —G, G, —G, G)6 ∈
(20)

though they are not optimal fits. This event will be called a “3–1 termi- nation” event, Sec. 6, in which a pair of solutions of lower symmetry terminates and changes the character of a higher symmetry branch. This is an example of a pitchfork bifurcation [[3], Fig. 7], which is normally associated with symmetry-breaking [[9], p.55]. It is made possible by the symmetry properties of the solutions that contribute to it [[3], Sec.10]. The left hand side of Fig. 6 shows a different type of topological event.
At ε = 0.6 the solution set is topologically balanced, with S-shape and
Radial minima, and a pair of saddle points in the Bridge solution. At ε = 0.96323 we encounter a “2-2 crossover” in which a saddle point in the S- shape branch crosses a local minimum in the Oval branch and in-
The dot product of these two vectors, Ut Y, is zero by symmetry, as expected. Therefore it is reasonable to expect that da/dε will be well-
behaved on this branch even though the eigenvalue is going through zero. Note that this orthogonality does not exist on the lower symmetry Bridge solutions which are terminating at this point, leading to infinite
slope in dθ0/dε in Fig. 3.
An alternate way of viewing the same issue is to define an
“augmented” M+ matrix:
M+ = Mij for {i, j} ∈ [1, n]
M+  = M+  = Y = d2F.da dε for i ∈ [1, n]

eightfold symmetric and neither disappears. This is an example of a
transcritical bifurcation [9,10]. Bifurcations of this type always require an additional constraint to be met. In [[9], Sec.3.2] it is the requirement that

+
n+1,n+1
= d2F.dε2

one fixed point must remain constant while another fixed point crosses over it, where the term “fixed point” refers to an equilibrium solution of a
differential equation. In [[10], Fig.1.3a] it is the constraint α = β, which
where d2 F/dε2 = R t2 J (a, u)dt, and
J (a,u)=∂(f —g),∂ε·∂(f —g),∂ε+(f —g)·∂2(f —g),∂ε2 —E(u)∂u,∂ε(∂u/∂ε).

leads to a special type of imperfect bifurcation (In [[3], Fig.18], this same constraint is re-expressed as b = — a3.). The need for an additional constraint to explain ODF solution crossovers was also discussed in [[12], Sec.5.2]. In the context of ODF, the constraint is that two second-order response matrices are simultaneously singular, which leads to a smooth crossover of solutions rather than an avoided crossing or an abnormal termination.

Response to a change in shape: “3–1 termination”

The rest of this paper discusses methods of detecting such events analytically and categorizing them graphically. The question is: why are these solutions well-behaved when they meet? The matrix M has singu- larities at each event; therefore, according to Eq. (8), we should see a
singularity in da/dε, but Fig. 4 shows no such effect. To explain this we
need to develop an analytical expression for da/dε, evaluated under the
constraints that Li = 0 and Eq. (1) are both satisfied at all times. Following the derivation of [[12], Eq.5.5], we find:
M(da / dε)+ Y = 0	(16)
where Yi = d2 F/daidε = R t2 I i(a, u)dt, and
I i(a, u)=∂(f — g) ∂ε · ∂f ∂ai +(f — g)· ∂2f ∂ε∂ai — E(u)∂u ∂ε(∂u / ∂ai).
(17)
This requires the calculation of ∂u/∂ε, which is given by
(22)
The augmented matrix M+ is essentially the second-order response matrix obtained if we admit the variable ε as a new independent variable, comparable to {ai}, the only difference being that F is not stationary with respect to changes in ε. It plays a role analogous to the “tangent space”
TG [[10], Eq.2.2] and [[3], p.208].
Comparison of the eigenvalues of M and M+ can be informative. If D00 is an eigenvalue of M, and if Ut Y = 0, then it will also be an eigenvalue of M+ as well, where the augmented eigenvector is just U0 with an additional zero at the end. Fig. 6 shows the eigenvalue of M+ that is closest to zero, denoted aug0. For the eightfold symmetric Radial branch there is always an augmented eigenvalue that agrees with eig0 at all ε. This is the reason why this branch is able to have zeros in eig0 while still being well-behaved. For the Bridge solution this is not normally the case, although the figure shows that eig0 and aug0 both approach zero at ε
= 1.308.
The augmented matrix has been previously defined in a similar
context [[2], p.66]. In that discussion it was stated that M and M+ cannot simultaneously be singular because there are not sufficient degrees of freedom to allow this to happen [[2], p.60, Assumption A]. Normally, of course, this is true: we have only one degree of freedom, ε, so we cannot
simultaneously satisfy two constraints. Therefore the only way for this to be possible is if there are additional constraints in operation such that both matrices can be made to be singular on a sub-manifold of the so- lution space. (A similar statement is made in Ref [[10], Eq.2.10]. with reference to a bifurcation point [[10], Fig.2.1a]). In the present example,


“3–1 termination”, the additional constraint is symmetry, which allows
symmetric solutions to intersect with asymmetric solutions without pathological behavior. In the next section an alternative constraint is

Xi=1


μi Li  =


t2
(f(a, u)— g(t)) ·
t1

Pi=1

μi ∂f
,∂aidt

t2	f' a u
(24)

described which also allows two solution branches to cross each other and interchange roles without singular behavior. This allows [[2], p.60, Assumption A] to be violated due to the presence of a newly defined sub-manifold.

Response to a change in shape: “2-2 crossover”

This event consists of an intersection between the S-shaped and Oval branches in Fig. 4 at ε = 0.96323. At a first glance, it appears that three branches (two minima plus a saddle point) have simultaneously coa- lesced to produce a single minimum. Upon closer inspection we find (Fig. 7a) that there are two distinct events, both of which involve only two branches. (Note the similarity of Fig. 7a to [[10], Fig.1.3a] and to
3
 ( , )
=  (f(a, u)— g(t)) ·	dt
t1	h(u)
= 0

where we have used Eq. (1). This equation represents a new constraint on the {Li}: this releases one of the original constraints we would normally impose on L, which gives us a new degree of freedom we may be able to
use to set the determinant of M+ to zero. In effect, it defines a sub- manifold within which a crossing of solutions becomes theoretically possible. We now need to derive appropriate conditions for this to occur. The function h(u) can be calculated as follows. Taking a derivative of
Eq. (23) we find:
n

[[3], Fig.18] for the intermediate cases where b = — a ). At ε = 0.9631 a
n	.	X	.
f'' a u	h u P μ ∂f'  ∂a	h' u	μ ∂f ∂a


0.96323 the two branches cross each other at finite slope in Fig. 7a with
P	' ,	h (u) '

an interchange of character from minimum to saddle point and vice-versa
= h(u)

i=1
μi ∂f
∂ai + h(u) f (a, u).

(This was previously termed a Type 2 crossover in [[12], Chap.5]. It has also been called an “interchange event” in Ref. [[7], Fig. 6], “height
switch” in Ref. [6], and F 1 in Ref. [[8], Fig. 3.1].). In this case both M
Substitute this into Eq. (7) to obtain:
n

β	E(u) = f (a, u
f' a, u) + h(u)(f(a, u) — g(t)) · X μ ∂f' . ∂a
(26)

and M+ are singular. As before, the simultaneous singularity of these two matrices is a necessary condition for da/dε to be well-behaved. There are
)· (
i	i
i=1

two questions that need to be addressed: where do we find the necessary
degrees of freedom to make M and M+ simultaneously singular, and are these two events related (could a “2-2 crossover” occur without a cor-
responding fold catastrophe)? The first question can be answered alge-
where we have used Eq. (1) to eliminate the term h' (u)(f(a, u) — g(t)) ·
f' (a, u)/h(u), which is zero. Now operate on Eq. (6) to obtain:

braically, while the answer to the second question is most easily demonstrated using catastrophe theory (Sec. 8).
E(u)
Xi=1
μi ∂u.
∂a  = —f' (a, u)· 
Xi=1
μi ∂f
.∂ai — (f(a, u)— g(t))·
Xi=1
μi ∂f

∂ai

'	'	.
X	' .

As noted in Sec. 4, the S-shape branch is a “typical” solution in that it
is qualitatively comparable to fitting curvature at the endpoints. The oval-shaped solution is abnormal since it is related to an extremum of the
= —f (a, u)· f (a, u) h(u)— (f(a, u)— g(t))·
μi ∂f  ∂ai.
i=1
(27)

< y' > moment. Upon closer inspection, we find that the oval-shaped solution yields an unexpected relationship, which is not true on the S-
Comparing this to Eq. (26) we find:

shape branch: the variables (f(a, u) —g(t)) · ∂f/∂ai are linearly dependent
on each other 6t. Combining this with Eq. (1) we obtain the more general expression
h(u)
Xi=1
μi ∂u .
∂ai = — 1	(28)


f' (a, u)= h(u)

Xi=1

μi ∂f
. ∂ai	(23)
where h(u) can be viewed as a scalar normalization function in Eq. (23). If we eliminate h(u) from these equations we can obtain a further inter- esting constraint. Substitute Eq. (28) into Eq. (23) to obtain:

in which h(u) is to be determined and μi are functions of ε but not u. The	'
X	,	, Xn

calculation of μi will be described below (Sec. 7.1). For now we note an interesting consequence of Eq. (23). From Eq. (4) and Eq. (23) we have:
f (a, u) = — 


i=1
μi ∂f
∂ai


i=1
μi ∂u / ∂ai	(29)




Fig. 7. Solution properties versus ε during a crossover event between the Oval and S-shaped branches. Also shown is the associated fold catastrophe event.


f' (a, u)

n

Xi=1
μi ∂u .

∂ai +

Xi=1

μi ∂f
. ∂ai = 0	(30)

results in, the remaining terms are equated below:	
factor	left hand side	right hand side

u(1 — u)4	— μ1 d1sinθ1cosθ1	— μ1 d1sinθ1cosθ1

X μ [∂f / ∂a + f' (a, u)∂u / ∂a ]= 0	(31)



which represents a new constraint on the total response of f(a, u) with respect to a, which is valid only on the oval-shaped branch. We note in passing that analogous constraints have also been found to be satisfied on oval-shaped branches of the ODF solutions obtained when fitting a


The first and last rows are satisfied trivially, which leaves only two constraints on {μi }. These can be expressed as:

clamped cubic and/or quartic B´ezier to a 45◦ segment of g(t), where g(t)
 —2Δ — 2d sin(θ
— θ )	d sin(θ — θ )
  μ 

4v
case they are also associated with a “2-2 crossover”.
d2sin(θ2 — θ1)	2Δ2 — 2d1sin(θ2 — θ1)	μ2



Implications for M

In order to define this class explicitly, we need to calculate μ




. Begin
where Δi = (X3 — X0)cosθi + (Y3 — Y0)sinθi. We find, as expected, that this matrix is singular at all times on the oval-shaped branch in Fig. 7, so
the {μi } can be calculated to within a normalization constant. Since this constraint does not involve μ3 or μ4, we also find that it is equally

with Eq. (23) and express it as a parallel relationship:
{ i }
applicable to the case of a clamped cubic B´ezier segment [[12], Chap.5].
Given {μi }, we wish to work out the consequences for M. Beginning with Eq. (5), and noting that the Hessian terms are zero within this

'	¨ X
∂ .∂
particular symmetric representation, we have

X4	,
(32)
,	X	,
,	X	,

f '	X4

μ ∂f /∂a
(38)


where the sum extends over all the independent variables ai. Here we will
= h(u ∂f
∂ai · f (a, u) + h(u) E(u)∂u
∂ai

make use of the eightfold symmetry of the Oval solution to simplify the representation. Define the B´ezier control arms for one segment as in Ref. [[15], Fig. 1]:
where we have used Eq. (23) and Eq. (28). Now use Eq. (6) to eliminate
E(u) and integrate Gij to obtain:

R = (X , Y )= (X — d sinθ , Y + d cosθ )
R2 = (X2, Y2)= (X3 + d2sinθ2, Y3 — d2cosθ2)

where R0 and R3 are the endpoints. The angles θ1 and θ2, of R0 and R3, are fixed by symmetry, so the independent variables are a = (d1, d2, R0, R3). Express f(a, u) in terms of Bernstein polynomials [[11], p.224], and re-express Eq. (32) as
t2  1	'


j=1	t1

These equations provide a new mechanism by which M may become singular, one which is unique to the oval-shaped branch: by setting 4 1μj Mij = 0 6i. We have confirmed computationally that these zeros
in Eq. (39) occur 6i during a “2-2 crossover”, leading to a singular M.


Y0B’ + (Y0 + d1cosθ1)B’ + Y3B’ + (Y3 — d2cosθ2)B’	+

	03	13	33	23
Implications for M

X0B’
+ (X0 — d1sinθ1)B’
+ X3B’
+ (X3 + d2sinθ2)B’

=  μ1 B13cosθ1 + μ3(B03 + B13)sinθ1 — μ2 B23cosθ2 + μ4(B23 + B33)sinθ2 
—μ1 B13sinθ1 + μ3 (B03 + B13)cosθ1 + μ2 B23sinθ2 + μ4 (B23 + B33)cosθ2
(34)
By itself, a singular M is not a surprising event; what is of interest is whether the M+ matrix will simultaneously become singular. From Eq. (17), and noting that the Hessian term is zero, we find:

Use the relationship B'i,n = n(Bi—1,n—1 —Bi,n—1) and rearrange:



 d1cosθ1B02 + d2cosθ2B22 + ΔYB12  =  μ3 sinθ1B03 + μ4sinθ2B33 + (μ1cosθ1 + μ3sinθ1)B13 +(— μ2 cosθ2 + μ4 sinθ2)B23 

(35)

—d1sinθ1B02 — d2sinθ2B22 + ΔXB12	μ3 cosθ1B03 + μ4 cosθ2B33 +( — μ1 sinθ1 + μ3 cosθ1)B13 + (μ2 sinθ2 + μ4 cosθ2)B23



where
X	,	X	,
, X	,


3	0	1	1	2	2
ΔY	Y	Y	d	d

(36)

i=1

i=1

i=1


Now multiply through by both denominators and organize the terms
=  1 ∂(f — g),∂ε · f' (a, u)+  1  E(u)∂u,∂ε

according to their use of the functions ui (1 — u)j where i + j = 5. We find that the term in (1 — u)5, obtained by multiplying B02B03, is satisfied only
h(u)
h(u)

(40)

if μ3 = 0. Similarly, the term in u5 requires μ4 = 0. Substituting these two
where we have used Eq. (23) and Eq. (28). Now use Eq. (18) to eliminate
E(u) and integrate I i(a, u) to obtain:


Xi=1



μid2F
, daidε = — 
t2	1 
h(u) (f(a, u)— g(t)) · ∂f
∂εdt.	(41)

We wish to determine whether the right hand side of Eq. (41) will go to zero simultaneously with the right hand sides of Eq. (39) 6i. This would mean that a singular M, as defined by Eq. (39), would also lead to a singular M+. For the present, unclamped, spline this is trivially true, since
∂f' /∂ε = 0 by definition. For a clamped spline [15], a proof is required. In
this case a sufficient condition for this to occur is:

f' (a, u)ν ∂f' .

∂ε +

Xi=1

νi∂f
' .∂a 6u	(42)


where {νi} are constant with respect to u, and we have used the fact that Eq. (1) is satisfied 6u. The sum extends over {d1, d2}. We now need to relate {νi} to {μi }, to confirm that they exist. Compare this equation to Eq. (32) to obtain:


ν0∂f

∂ε +

Xi=1

νi∂f
' .∂a

 Xi=1

μi ∂f
.∂ai.	(43)



Fig. 8. Catastrophe theory representation of both a “3–1 termination” (dashed)

Express f(a, u) in terms of Bernstein polynomials and Eq. (33):
and “2-2 crossover” (dotted) event. The curved boundary separates the region of three solutions from the single solution range.

ν  B'
+ B' sinθ — B'
+ B'  sinθ 


ν  B'
+ B' cosθ — B'  + B'  cosθ  = —μ B13 sinθ1 + μ B23 sinθ2

We note, finally, that the same sub-manifold also exists in the ODF fit

—ν1B13’sinθ1 + ν2B23’sinθ2

(44)
we have four degrees of freedom instead of two, but otherwise the specification of {μi } and {νi} proceeds in the same way as above.

where we have used the definition of the hypoTrochoid g(t) in Ref. [15] to calculate the response (∂f' /∂ε) of the endpoints to a change in ε, which is called c in Ref. [15]. Now use the relationship B'i,n = n(Bi—1,n—1 —
Bi,n—1):

—ν0B12(sinθ1 + sinθ2)

Modeling an avoided catastrophe

We wish to re-express these events in the language of catastrophe theory, which is visually more informative. In order to model events involving three critical points we define s, a one-dimensional streamline

  +ν1(B02 — B12)cosθ1 — ν2(B12 — B22)cosθ2 
—ν0B12(cosθ1 + cosθ2)
—ν1(B02 — B12)sinθ1 + ν2(B12 — B22)sinθ2
 (1 — u)μ1 cosθ1 — uμ2cosθ2 
—(1 — u)μ1 sinθ1 + uμ2 sinθ2

(45)
[21,5] joining the critical points, and assume that F(s) is approximated by a quartic function along this path:
F = s4,4 + As2,2 + Bs.	(47)


where we have canceled a common factor of u(1 —u) on the right hand side. Multiply through by both denominators and organize the terms
according to their use of the functions ui (1 — u)j where i + j = 3:
In this equation all the parameters which affect only the scaling and positioning have been removed, leaving only two parameters which control the shape. This can be used to describe a cusp catastrophe [3,4].

		The function F has three critical points when
factor	left hand side	right hand side


3	— μ ν sinθ cosθ

— μ ν sinθ cosθ
B2 , 4 + A3,27 < 0.	(48)

u(1 — u)2	2μ1 ν0sinθ1(sinθ1 + sinθ2)
+2μ1 ν1sinθ1cosθ1
+μ2 ν1cosθ1sinθ2
+2μ1ν2sinθ1cosθ2
u2 (1 — u)	—2μ2ν0sinθ2(sinθ1 + sinθ2)
—2μ2 ν1cosθ1sinθ2
—μ1 ν2sinθ1cosθ2
—2μ2 ν2sinθ2cosθ2
—2μ1 ν0cosθ1(cosθ1 + cosθ2)
+2μ1 ν1sinθ1cosθ1
+μ2 ν1sinθ1cosθ2
+2μ1ν2cosθ1sinθ2
2μ2 ν0cosθ2(cosθ1 + cosθ2)
—2μ2 ν1sinθ1cosθ2
—μ1 ν2cosθ1sinθ2
—2μ2 ν2sinθ2cosθ2
Otherwise it has only one critical point. The boundary curve, Eq. (48), is shown in Fig. 8 and Fig. 1.
We wish to show that both the 3–1 termination and the 2-2 crossover events are represented by a tangential touching of the boundary curve in this figure, while a “normal” merge of two critical points is represented by a non-tangential crossing of this boundary. Consider a one-

u3	μ2ν2sinθ2cosθ2	μ2ν2sinθ2cosθ2



The first and last rows are satisfied trivially, which leaves only two constraints on {νi}. These can be expressed in matrix form:
dimensional problem in which we search for critical points of F(s) along the streamline s. Then the condition that M be singular at a critical point is expressed, Eq. (47), as:
d2F , ds2 = 3s2 + A = 0.	(49)


(2μ —4μ )[1+cos(θ —θ )] —3μ sin(θ —θ )	0
(4μ1 —2μ2 )[1+cos(θ2 —θ1)]	0	—3μ1 sin(θ2 —θ1)
ν0
ν1  =0.
ν2
(46)
The condition that da/dε be well-behaved, or the condition that M+
be simultaneously singular, is satisfied if
d2F , dsdε = sdA,dε + dB,dε = 0.	(50)

These constraints can always be satisfied to within a normalization constant: for example, we find ν1/ν0 is a linear function of μ1/ μ2 . Therefore we conclude that M+ may become singular simultaneously with M, and that this is possible only on the sub-manifold represented by
Combining them we obtain the constraint
dA . dB = —1.s = p—ﬃﬃﬃﬃ3ﬃﬃﬃ/ﬃﬃAﬃﬃﬃ



(51)



which is just the expression for the slope of the catastrophe boundary. As an application of this concept, consider the 3–1 termination event.
In this case, two degenerate saddle points merge with a higher symmetry local minimum to produce a single saddle point, while da/ dε is well-
behaved. Since the two saddle points have the same rms error, we find that B = 0 in Eq. (47). Therefore the tangential touching of the boundary occurs at the origin. The additional constraint that is required in order to produce a tangential touching is provided by symmetry. The tangential touching event also coincides with a normal fold catastrophe at the origin
to produce a single saddle point at A > 0. The path that the system fol-
lows is plotted as a vertical line in Fig. 8, which passes through the origin. The 2-2 crossover event of Sec. 7 is more challenging. We wish to fit F(s) to a sequence of ODF data obtained along the path joining three critical points in Fig. 7a, to see how the fit evolves as ε changes. For each ε we need at least five data points to do so. Three of these points are already known from the ODF optimization at the critical points, but two remain to be calculated. The problem is that these two points are no longer critical points; instead, they are points defined along an unknown streamline that joins a set of critical points [21]. The streamline is defined to be tangent to the gradient of F at all times. The uniqueness of the streamline was shown in Ref. [5]. However, calculating it exactly turns out to be difficult: in the vicinity of a critical point the typical behavior [[22], p.183] is that the streamline is a function of the type
p1/λ1 ∝p1/λ2 , where p is a point in the transformed coordinate system
Conclusion

When fitting a spline to a closed shape it is normal to see multiple solutions, which will appear as local minima and saddle points in the error function. If the shape of the object is changed by varying a single external paramater, then it may happen that these different types of so- lutions meet, leading to a topological change in which solutions either disappear or interchange their character. The outcome of these topo- logical events can be determined by inspecting two different matrices which represent the second-order response of the curve-fitting error to changes in the curve-fitting parameters and the shape of the object. Events in which two solutions annihilate are quite common and do not require any special constraints to be met, other than the change in shape. Events in which two solutions survive and interchange character are rare, and require both of these response matrices to be simultaneously sin- gular. In the context of ODF curve-fitting, a new algebraic constraint is defined, which allows this type of solution crossover to occur. It is also possible for solution bifurcations to occur as a result of symmetry- breaking, which is a relatively common occurrence. These three types of events: annihilation, crossover, and symmetry-breaking, can be analyzed algebraically using matrix determinants, but that does not lead to any understanding of the relationship between them. A more visual representation is obtained using catastrophe theory, which allows us to
represent them as being either a simple crossing of a boundary (annihi-

1	2	lation), a simultaneous crossing of two boundaries which have merged

defined by the eigenvectors of M, λi are the eigenvalues, and the origin of p is at the critical point. As we approach a critical point these streamlines will exhibit very high curvature, particularly if the ratio λ2/ λ1 is large, which will be the case if two critical points approach each other. How-
ever, we do not need the entire streamline, just a set of intermediate points between two critical points. We evaluate these approximately using the method of steepest descent [[23], p.121]: calculate a pre- liminary estimate of a by linearly interpolating between a saddle point and a local minimum. Then perform some iterations of the steepest
descent method. Each iteration will increment a by the amount Δa = —
αL, where α = Lt L/Lt ML. Typically the point a will oscillate back and
forth across the narrow trough that leads to the minimum [[23], Fig8.2]. We terminate the iteration when the gain α stabilizes, since any point along this streamline will do. Perform this for both pairs of mini- ma/saddle points at each ε to obtain a total of five data points. Then fit a general quartic model of F(s) and convert this to the standard form in Eq.
(47). The resulting data are shown in Fig. 8. The figure shows the results of this method applied to the current Beta2-spline, where the steepest descent iteration was terminated after 20 iterations. The path length s
was evaluated using the distance in the (d1, d2) plane. We see that there is
a tangential touching event at ε = 0.96323, followed very closely by a fold catastrophe. Unfortunately, the particular numerical method we are using does not allow us to actually cross the boundary at the fold catas- trophe, but it is clear that this crossing is imminent. A similar avoided
catastrophe was obtained by applying this method to a clamped single-segment cubic B´ezier fit (see Fig. 5.1 in Ref [[12]]) at c ≈ 3.59, with the steepest descent iteration terminated after one iteration.
Fig. 8 confirms the supposition that a 2-2 crossing consists of a tangential touching of the catastrophe boundary. We also note that the sign of B has changed between the 2-2 crossing and the corresponding fold catastrophe. Therefore not the same pair of critical points is involved in these two events. The figure also clarifies the relationship between these events. Given the highly curved character of the catastrophe boundary, and given the fact that the relationship between A and B is nearly linear as ε varies, it is almost inconceivable that a 2-2 crossover event could occur without a corresponding fold catastrophe. This is an insight that we would not have obtained if we restricted ourselves to the use of only the determinants of M and M+.
(symmetry-breaking), or a tangential touching of a boundary in which a catastrophe is avoided (crossovers). In the case of a crossover, the ca- tastrophe theory representation makes it clear that a crossover is not only rare, but will almost certainly be closely associated with an annihilation event, so much so that it may be difficult to distinguish the two events.

Credit author statement

Alvin Penner: Conceptualization, implementation, writing.


Declaration of competing interest

I declare that I have no known competing financial interests or per- sonal relationships that could have appeared to influence the work re- ported in this paper.

Acknowledgements

The author is grateful to the reviewers and editors for their valuable comments, which were used to improve the quality of this paper.
The calculations were performed using the Java code at the re- pository: https://github.com/alvinpenner/Spiro2SVG/.

References

Ahn SJ. Least squares orthogonal distance fitting of curves and surfaces in space, LNCS 3151. Berlin: Springer; 2004. https://doi.org/10.1007/b104017.
Aubin J-P, Ekeland I. Applied nonlinear analysis. Mineola, N.Y.: Dover Books on Mathematics, Dover Publications; 2006.
Stewart I. Catastrophe theory in physics. Rep Prog Phys 1982;45(2):185–221. https://doi.org/10.1088/0034-4885/45/2/002.
Zeeman EC. Catastrophe theory, Scientific American 1976;234(4):65–83. https:// doi.org/10.1038/scientificamerican0476-65.
Antony C. Gradient flow line near birth-death critical points. J Topol Anal 2018;10: 1–45. https://doi.org/10.1142/s1793525319500493.
Gay DT. Functions on surfaces and constructions of manifolds in dimensions three, four and five. 2017. p. 1–20. https://arxiv.org/abs/1701.01711.
Edelsbrunner H, Harer J, Mascarenhas A, Pascucci V, Snoeyink J. Time-varying reeb graphs for continuous space-time data. Comput Geom 2008;41(3):149–66. https:// doi.org/10.1016/j.comgeo.2007.11.001.
Kirby R. A calculus for framed links in s3. Invent Math 1978;45(1):35–56. https:// doi.org/10.1007/bf01406222.
Strogatz SH. Nonlinear dynamics and chaos. CRC Press; 2018. https://doi.org/ 10.1201/9780429492563.



Golubitsky M, Schaeffer D. A theory for imperfect bifurcation via singularity theory. Commun Pure Appl Math 1979;32(1):21–98. https://doi.org/10.1002/ cpa.3160320103.
Bartels RH, Beatty JC, Barsky BA. An introduction to splines for use in computer graphics & geometric modeling. Los Altos: Morgan Kaufmann; 1987.
Penner A. Fitting splines to a parametric function. Cham, Switzerland: Springer Briefs in Computer Science, Springer; 2019. https://doi.org/10.1007/978-3-030- 12551-6.
Ahn SJ, Rauh W, Cho HS, Warnecke H-J. Orthogonal distance fitting of implicit curves and surfaces. IEEE Trans Pattern Anal Mach Intell 2002;24(5):620–38. https://doi.org/10.1109/34.1000237.
Bjorck A. Numerical methods for least squares problems. Philadelphia: SIAM; 1996. https://doi.org/10.1137/1.9781611971484.
Penner A. Fitting a cubic bezier to a parametric function. Coll Math J 2019;50: 185–96. https://doi.org/10.1080/07468342.2019.1583038.
McWeeny R. Symmetry: an introduction to group theory and its applications. Mineola, N.Y.: Dover; 2002.
de Boor C, Hollig K, Sabin M. High accuracy geometric hermite interpolation. Comput Aided Geomet Des 1987;4(4):269–78. https://doi.org/10.1016/0167- 8396(87)90002-1.
de Tisi F, Rossini M. Behavior of the beta-splines with values of the parameters beta2 negative. Comput Aided Geomet Des 1992;9(6):419–23. https://doi.org/ 10.1016/0167-8396(92)90040-V.
Mascarenhas A, Snoeyink J. Isocontour based visualization of time-varying scalar
fields. In: Mathematics and visualization. Springer Berlin Heidelberg; 2009.
p. 41–68. https://doi.org/10.1007/b106657_3.
Guillemin V, Pollack A. Differential topology. Englewood Cliffs: Prentice-Hall; 1974. https://doi.org/10.1090/chel/370.
Gordon P. Paths connecting elementary critical points of dynamical systems. SIAM J Appl Math 1974;26(1):35–102. https://doi.org/10.1137/0126005.
Lefschetz S. Differential equations: geometric theory. New York, N.Y.: Dover; 1977.
Chong EKP, Zak SH. An introduction to optimization. Wiley; 2008. https://doi.org/ 10.1002/9781118033340.
