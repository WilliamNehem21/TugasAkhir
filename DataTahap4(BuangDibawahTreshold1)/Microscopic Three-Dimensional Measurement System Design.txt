Micro stereo vision system is widely used in the field of microscopic research due to its high-precision 3D measurement and positioning by visual feedback. High-precision measurement data can provide advanced observation and analysis for scientific research and industrial applications. The study reconstructed three-dimensional information of objects accurately in microscopic viewing by combining phase shift technology with optical microscopy technique. This paper focused on the technology of phase shift, a system prototype has been developed, and we have done application tests in many fields to test the accuracy of this system, the feasibility and stability of the system has been verified.

Currently, Stereo Light Microscope(SLM) is one of the most widely used devices, it obtains stereoscopic images from two perspectives by two sub-optical paths. Due to matching accuracy and other factors, the 3D reconstruction precision of SLM is lower, which can not meet the real needs, SLM can be only used to observe the stereoscopic reality of measured objects. There are significant differences between accurate measurements and qualitative analysis, the current device is only as an auxiliary for observation, unable to meet the requirement of quantitative analysis.

With the basic principle of phase shifting, we can capture the object images when we project a specific mode lamp, such as grating, etc., to the surface measurement object. The measurement of height object can be obtained with image correlation. Structure light imaging principle in Fig 1. To be confirm the height of the reference plane is 0. Through the projection light through the grating surface of the object, we can calculate relative height point D in space position (x, y) to the reference plane:

We know that phase value of the key structure light imaging from Eq.(1). The phase information of the raster image can solve three main methods: time-domain Fourier transform, convolution filtering and phase shifting. The most reliable and effective method is phase shifting, which has high capacity(or low capacity) of anti- static noise and low computational complexity. Therefore, we calculate the phase information with the method of phase shifting.

In Eq. (5), It is shown that the phase value interval distribution in [ / 2,  / 2] . First, we need to extend the phase values to [ ,  ] with the phase values of sine and cosine, so we can gain phase value by a continuous distribution. Then, the continuous phase mapping can be searched of phase unwrapping method. Follows are the main steps:

Step 1. Establish the threshold value R to be approached and less than 2 , e.g. R  1.9 ; Step 2. Begin from i  0 , perform the following steps until access all of the phase value; Step 3. Computation phase difference of the points which is adjacent:

Projected a set of sinusoidal intensity grating stripes produced by the computer on the object by a projector, ingested images with CCD camera, reconstruct the surface contour of the object by phase-shift technology. As shown in Fig 3, the system is mainly constituted by a computer, microscopic stripe projector and CCD monocular microscope. The projection portion of the microscopic stripe projector and CCD optical imaging section both are with variable magnification lens, which can be applied to measuring the size of different observation.

Combined four-step phase shift and encoding method with 3D sensing technology, just like projecting a set of sinusoidal intensity grating stripes produced by the computer on the object by a projector, the system projected 4 sinusoidal stripe patterns and 9 coded stripe patterns. Projected stripe will be deformed due to the depth variation of the measured surface, CCD collect the bitmap of the measured object, so as to achieve 3D reconstruction of the object. Fig 4. is the acquisition process of measurement for shot hole.

This paper lead phase shift technology into the application of microscopic measurement. Combined stripe projection, CCD acquisition with mutative viewing range, it can reconstructed 3D information of objects accurately, in the viewing range of 1mm-20mm, the measurement error can be controlled within 1µm. Finally, prove the system is practical and accurate by application testing. This paper is a tentative applied study for obtaining 3D information in the microscopic viewing, although the system has gained good results, but also need to keep studying and improving.

