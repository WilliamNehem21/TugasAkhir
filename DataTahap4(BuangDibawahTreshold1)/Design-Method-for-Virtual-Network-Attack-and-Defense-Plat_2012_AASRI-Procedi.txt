A design method for network attack and defense simulation platform is discussed in this paper. Firstly the component and function of the platform are analyzed. Then Visio second development method is used to construct the virtual network topology. The parsing of virtual network topology is also researched and the relative flow sheet is described. Lastly an example is carried out to test performance of the platform. Simulation results show the effectiveness of the proposed method.

defensive drilling and testing. Virtual network attack and defense simulation platform is to construct an attack and defense system with theoretical knowledge, reasonable structure, and suitable for the study of security management for the above requirements. Network attack and defense simulation combat environment is constructed to help security managers to raise the overall level of safety management, and enhance network and information security[1-2]. Design of network attack and defense simulation platform is of great significance to study the security of the network devices.

A design method of virtual network attack and defense simulation platform is constructed in this paper. The composition and function of the platform is analyzed. The establishing and parsing of virtual network topology is researched based on the Visio secondary development method, and the simulation is also presented.

Virtual networks and devices are used to simulate the real ones in the network attack and defense simulation platform. Its main functions contain generation of network topology, configuration of network security device, implementation of network attacks, attack detection, attack records and statistics. The virtual network device and topology are displayed in a graphical interface, and the functions of various devices are simulated through some special properties and methods, which is propitious to carry through network attack and defense simulation. The composition of network attack and defense simulation platform is shown in Figure 1(a).

Network defense simulation server is mainly composed of network data capture, network topology parsing, virtual network device and virtual network database. During simulation, the virtual network topology is established according to the actual situation, and the virtual network device should be configured according to the actual parameters of each device. The data transmission in the virtual network is determined by the network topology and device configuration. Each virtual device contains processes of data receiving, data processing and logging. Data arriving at each device should be tested with the particular rules of the device. The legitimate data will be transmitted properly while the illegitimate one will be discarded.

The creation of a virtual network topology is necessary for the construction of virtual network environment. There are various methods for the creation of a virtual network topology. The secondary development of drawing software technology is one of the most effective methods. It can simplify the development of the graphics editing module, and the capabilities of devices can also be carried out in the programming software. So Visio secondary development technology is used in the creation of virtual network topology.

Microsoft Office Visio 2003 ActiveX Control (Visio drawing control) can provide the full function for Visio application as an embedded component through the Visio object model. Visio drawing control can be driven by events or codes in the host application. In addition, the Visio drawing control provide chart production environment in the context of the application user interface for users[3].

Office XP and Microsoft Office container (such as Microsoft Office Word 2010, Microsoft Internet Explorer 5.0 and other Microsoft ActiveX container). The control will display the shape of the drawing screen after added to the host application. The Visio drawing control allows developers to extend custom applications and solutions. Visio components can be driven by the user drawing operation or host application events and data through providing programming capabilities, as well as control access to the full Visio object model. The architecture of Visio drawing control in application[3] is shown in Figure 1(b).

The device model in the toolbox can be dragged to add a network device in the network attack and defense platform. When a network device is added to the virtual network, a dialog box will be popped up asking to enter the basic information of the device. The network device will be displayed in the network topology drawing interface if the information is proper. The user can operate the related devices through the right mouse button. For the router, the user can add some routing paths to the existing routing table; for the firewall, the user can edit the firewall rules, and then add it to the firewall rule table.

The virtual network device is called drawing cell, and the toolbox where the drawing cell is placed is called the mold in Visio. Each drawing is a Shape, and each Shape has a corresponding Shape sheet. There are two important tables in the Shape sheet: one is the User Defined Cells, the other is the Custom Properties. Properties of simulation devices can be set through the two tables.

In the Establishment of the mold, the drawing cell symbol is mapped out in the drawing area firstly. Then, the Shape Sheet spreadsheet is used to set properties for the drawing cell. Finally, the completed drawing cell will be dragged to a new mold, which can be saved with a new name.

The control on the drawing cell with program contains two aspects: one is obtaining information of the drawing cell; the other is writing information to the drawing cell and controlling the state. The function shape.getCells() is used to obtain information of the drawing cell, and the specific values selected from Shape sheet should be determined in accordance with the relevant parameters. For example, if there is a row called

The corresponding menu should be popped up when the mouse right-click the virtual device components in order to input and modify the data of the device. So the right-click events of the Visio drawing control should be defined in the design of drawing cells. The codes of mouse handling event[5] are shown in Figure 2(a).

When the drawing cell corresponding to each device is dragged to the drawing control from the mold and connection between devices is constructed, the mapping of network topology is completed. After the completion of network topology, rules of the network security devices should be set to lay the groundwork for the attack and defense simulation. The rule setting mainly includes the router routing table and firewall filtering rules. A virtual network topology is established after the configuration of the virtual network security device.

When the drawing cell corresponding to each device is dragged to the drawing control from the mold and connection between devices is constructed, the mapping of network topology is completed. After the completion of network topology, rules of the network security devices should be set to lay the groundwork for the attack and defense simulation. The rule setting mainly includes the router routing table and firewall filtering rules. A virtual network topology is established after the configuration of the virtual network security device.

After the establishment of virtual network topology, all network devices show only a simple graphical interface. The virtual network topology should be parsed to realize the simulation. The devices in the graphical interface and its connection relationship should be obtained. In the platform, the virtual network topology can be parsed by identifying the type of device and recording connection information of the cable. The process of the virtual network topology parsing is shown in Figure 3(a).

Visio is a mature vector graphics system, and it is very convenient to obtain the topological relations between the drawing cells. Network cable connecting different devices is used to determine the connection between devices. The connection relationship of each device is written to the relevant attributes by Visio during drawing graphics. The From Connects set of Connects properties of devices is used to obtain the devices connected to current device, which is advantageous for the parsing of network topology[6]. The function ParseNet() is used to parse the virtual network topology, the codes of which are shown in Figure2(b).

The previous sections have conducted a comprehensive study for the architecture of network attack and defense simulation platform. An attack and defensive simulation example is established to test the platform in this section. The virtual network constructed in the platform is shown in Figure 3(b).

It can be seen from the figure that whether the data of Router3 is transmitted depends on its routing table. Data in line with the routing table will be transmitted to the next device, while the improper data is rejected and logged. In the same way, data of Firewall1 compliant with the rules is transmitted, while the improper data is discarded.

The composition and function of virtual network attack and defense simulation platform are analyzed in this paper. The creation of virtual network topology is achieved through the Visio secondary development technology and the parsing method of virtual network topology is also researched. Finally, the platform is tested by network attack and defense instances. Simulation results show that the main function of the virtual network attack and defense simulation platform is realized, and the design objectives are achieved.

