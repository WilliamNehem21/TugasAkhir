Abstract Epilepsy is a chronic neurological condition that affects approximate- ly 70 million people worldwide. Characterised by sudden bursts of excess elec- tricity in the brain, manifesting as seizures, epilepsy is still not well understood when compared with other neurological disorders. Seizures often happen unex- pectedly and attempting to predict them has been a research topic for the last 30 years. Electroencephalograms have been integral to these studies, as the recordings that they produce can capture the brain’s electrical signals. The diag- nosis of epilepsy is usually made by a neurologist, but can be difficult to make in the early stages. Supporting para-clinical evidence obtained from magnetic reso- nance imaging and electroencephalography may enable clinicians to make a diagnosis of epilepsy and instigate treatment earlier. However, electroencephalo- gram capture and interpretation is time consuming and can be expensive due to the need for trained specialists to perform the interpretation. Automated

detection of correlates of seizure activity generalised across different regions of the brain and across multiple subjects may be a solution. This paper explores this idea further and presents a supervised machine learning approach that classifies seizure and non-seizure records using an open dataset containing 342 records (171 seizures and 171 non-seizures). Our approach posits a new method for generalis- ing seizure detection across different subjects without prior knowledge about the focal point of seizures. Our results show an improvement on existing studies with 88% for sensitivity, 88% for specificity and 93% for the area under the curve, with a 12% global error, using the k-NN classifier.

Epilepsy is a chronic condition of the brain, and causes repeated seizures, com- monly referred to as fits. Epilepsy is said to affect 70 million people worldwide [19]. The risk of developing epilepsy is greatest at the extremes of life with inci- dences more common in the elderly than the young [18] and is the cause of prema- ture mortality for those suffering with the condition [19].

Seizures can be focal (partial) and exist in one part of the brain only, or they can be general and affect both halves of the brain. During a focal seizure, the person may be conscious and unaware that a seizure is taking place, or they may have uncontrollable movements or unusual feelings and sensations. A diagnosis of epilepsy is made with the help of an electroencephalogram (EEG). EEG recordings are commonly visualised as charts of electrical energy produced by the brain and plotted against time [16].

A whole-brain seizure detection approach supports para-clinical evidence obtained from magnetic resonance imaging and EEG to make a diagnosis of epilepsy and instigate treatment earlier. It helps to mitigate the difficulties associ- ated with the capture and interpretation of electroencephalogram by neurologists. In this paper, a robust data processing methodology is adopted and several clas- sifiers are trained and evaluated, using 342 EEG segments extracted from the EEG records of 24 patients suffering with epilepsy.

The structure, of the remainder, of this paper is as follows. Section 2 describes the underlying principles of EEG and the type of features extracted from EEG sig- nals. Section 3 discusses machine learning and its use in seizure and non-seizure classification, while Section 4 describes the evaluation. The results are discussed in Section 5 before the paper is concluded in Section 6.

Gotman is one of the pioneers of seizure detection whose research in the area dates back to 1979. In Gotman et al. [22], he proposed a system for automatic recogni- tion of inter-ictal epileptic activity in prolonged EEG recordings using a spike and sharp wave recognition method. Extensions to this work are presented in Koffler and Gotman [29], Gotman [21], Gotman [23], Qu and Gotman [51], while recent works have focussed on the use of functional magnetic resonance imaging (fMRI) and the correlation between cerebral hemodynamic changes and epileptic seizure events visible in EEG [36]. More recently, he has looked at automatic seizure detection in sEEG using high frequency activities in the wavelet domain [10].

In other studies, the most common classifier used to distinguish between seizure and non-seizure events has been the support vector machine (SVM). Using the CHB-MIT database and a patient-specific prediction methodology, the study in Shoeb [55] used a SVM classifier on EEG recordings from 24 subjects. The results show that a classification accuracy of 96% for sensitivity was produced, with a false-positive rate of 0.08 per hour. In a similar study five records from the CHB-MIT dataset (containing 65 seizures) were evaluated using a linear dis- criminant analysis classifier [28]. The overall accuracy reported was 91.8%, 83.6% for sensitivity, and 100% for specificity. For similar SVM studies using other datasets the reader is referred to [55,28,44,62].

Electroencephalography is the term given to the recording of electrical activity resulting from ionic current flows generated by neurons in the brain and is mainly used to evaluate seizures and epilepsy. In order to retrieve EEG signals, electrodes are placed on the scalp where odd numbered electrodes are placed on the left side of the scalp and even numbered electrodes on the right. Electrode locations and names are specified by the International 10–20 system [55].

The collection of raw EEG signals is always temporal. However, for analysis and feature extraction purposes, translation, into other domains, is possible and often required. These include frequency representations, via Fourier Transform [42,37,24,12] and wavelet transform [12,32,40,17,14,39]. The advantage of frequen- cy-related parameters is that they are less susceptible to signal quality variations, due to electrode placement or the physical characteristics of subjects [38].

In order to obtain frequency parameters, several studies have used Power Spec- tral Density (PSD). Within PSD, Peak Frequency is one of the features considered in many studies. It describes the frequency of the highest peak in the PSD. During a seizure, EEG signals tend to contain a major cyclic component, which shows itself as a dominant peak in the frequency domain. In one example, Aarabi et al. used Peak Frequency, along with sample entropy and other amplitude features, to detect epileptic seizures and achieved a sensitivity of 98.7% and a false detection rate of 0.27 per hour [3].

Meanwhile, Ning and Lyu [45] found that Median Frequency displayed sig- nificant differences between seizure and non-seizure patients. By segmenting the EEG signal into five separate frequency bands for delta (d: 0.5 6 f 6 4 Hz), theta (h: 4 6 f 6 8 Hz), alpha (a: 8 6 f 6 12 Hz): beta (b: 12 6 f 6 25 Hz), and gamma (c: 25 6 f), it was possible to predict 79 of 83 seizures, with a sensitivity value of 95.2%.

Root mean square (RMS) has also been considered a useful feature for distin- guishing between seizure and non-seizure events. RMS measures the magnitude of the varying quantity and is a good signal strength estimator in EEG frequency bands [5]. In a study on neonatal seizure detection [50], 21 features for seizure clas- sification were compared, which saw RMS achieves an overall accuracy of 77.71%. The study showed that RMS outperformed all the other features used.

Entropy has been used as a measure of the complexity, or uncertainty, of an EEG signal, where the more chaotic the signal is, the higher the entropy. There are two kinds of entropy estimators: spectral entropies, which use the amplitude of the power spectrum; and signal entropies, which use the time series directly [27]. Many authors agree that during a seizure, the brain activity is more pre- dictable than during a normal, non-seizure, phase and this is reflected by a sudden drop in the entropy value [46,47,61,66].

has been used in seizure detection [46]. The study found that delta and theta fre- quency bands saw a much larger distribution of energy during a seizure compared to normal EEG, whereas the alpha, beta and gamma frequency bands saw a lower energy distribution during a seizure. Using the energy distribution, per frequency band, as a feature achieved an overall accuracy of 94%.

Correlation dimension has been investigated as a correlation measure in several studies, which is a nonlinear univariate, widely used to measure fractal dimension. Fractal dimension measures the complexity of the EEG signal, in other words, the regularity and divergence of the signal [33,7]. In [1] correlation dimension and five other features for seizure prediction of focal neocortical epilepsy produced reason- ably good results with 90.2% for sensitivity and 97% for specificity. However, when looking specifically at the correlation dimension they found the results dropped in 44.9% of seizures and increased in the pre-ictal phase in 44.9% of sei- zures. They also found that there were stronger dimension changes in the remote channels compared with those near the seizure onset.

In [8] correlation dimension and the largest Lyapunov exponent were studied to determine their ability to detect seizures. The study showed that neither measure on its own was useful for the task, but did work better, when they were used together. They also noted that correlation dimension was only useful when applied to the frequency sub-bands (delta, theta, alpha, beta, and gamma), and not on the entire 0–60 Hz frequency spectrum that was used in the study. The authors con- cluded that changes in dynamics are not spread out across the entire spectrum, but are limited to certain frequency bands.

Skewness is a third-order statistical moment, and kurtosis is the fourth. Along with the first and second order moments, mean and variance, respectively, the four statistical moments provide information on the amplitude distribution of a time series. Specifically, skewness and kurtosis give an indication of the shape of the dis- tribution [4]. Khan et al. use skewness and kurtosis, along with normalised coeffi- cient of variation, for seizure detection in paediatric patients. They managed to detect all 55 seizures from a subset of 10 patients, achieving 100% sensitivity, with a false detection rate of 1.1 per hour.

The aim of most studies, in EEG detection, has been to detect patient-specific focal seizures, rather than predicting general seizures across a much bigger population. As Shoeb [55] explains, a seizure EEG pattern is specific to a particular patient. The main reason for this is that focal seizures can occur in any part of the brain, and therefore, can only be detected in the EEG on specific channels. A classifier trained on a patient who experiences focal seizures in the occipital lobes, for exam- ple, would no doubt be trained on features from channels, including electrodes O1, and O2 (electrodes to monitor electrical activity in the occipital lobe), as these

The approach utilises machine learning algorithms embedded in-line with exist- ing clinical systems to enhance clinical practices in epilepsy diagnostics. The pro- posed algorithms support para-clinical evidence obtained from magnetic resonance imaging and electroencephalography to alleviate the capture and inter- pretation of electroencephalogram and help reduce costs, by minimising the need for trained specialists to perform the interpretation. The approach provides auto- mated detection of correlates of seizure activity generalised across different regions of the brain and across multiple subjects.

The CHB-MIT dataset is a publicly available database from physionet.org that contains 686 scalp EEG recordings from 23 patients treated at the Children’s Hospital in Boston. The subjects had anti-seizure medication withdrawn, and EEG recordings were taken for up to several days after.

The EEG recordings are divided among 24 cases (one patient has two sets of EEG recordings 1.5 years apart). The patients range between 1.5 and 22 years of age, and there are 5 males and 17 females. Case 24 was added after the original dataset was collected and has no patient data.

Most of the recordings are one hour long, although those belonging to case 10 are two hours and those belonging to cases 4, 6, 7, 9, and 23 are four hours long. Records that contain at least one seizure are classed as seizure records and those that contain no seizures as non-seizure records. Of the 686 records, 198 contain seizures.

Although the description supplied with the dataset states that recordings were captured using the international 10–20 system of EEG electrode positions and nomenclature, it was found that 17 of the files that contained seizures had different channel montages to the rest of the seizure files. Therefore, these 17 records have been excluded from this study, leaving 181 seizure files. A further 10 records were removed from the dataset due to a large number of missing data.

blocks) contain 23 s or more of ictal data, with the average block containing 45 s if we consider the median. However, the data contain outliers, i.e. the Max value is 752. To get a more representative summary the first 60 s of ictal data is used from each seizure record that lasts longer than 60 s. Table 2 provides a summary of the data.

The average block now contains 45 s if we consider the median, 40.52% if we consider the mean. More importantly, the majority of the data blocks (64%) of the 171 ictal blocks contain 30 s or more of icta data. In a real-world scenario, it is unlikely that, whatever window size we select, data blocks will contain only ictal data. The more realistic case is that it will contain both ictal and non-ictal data. By having 60-s blocks with different ictal and non-ictal data splits, this allows us to determine the performance of the classifiers under conditions more aligned with a real-world situation. However, future work will explore optimal window sizes. To balance the dataset, 171 data blocks randomly extracted from non-seizure files were also added to the dataset.

A bandpass filter was applied to each of the 342 EEG segments (171 seizures, 171 non-seizures) to extract the EEG data in each of the frequency blocks. Second order butterworth filters were used as they offer good transition band character- istics at low coefficient orders; thus, they can be implemented efficiently. This results in five columns of additional data; the complete bandwidth (0.5–30 Hz), delta (d: 0.5 6 f 6 4 Hz), theta (h: 4 6 f 6 8 Hz), alpha (a: 8 6 f 6 12 Hz): and beta

The feature vectors in this paper are generated from the 171 seizure files and 171 non-seizure blocks, obtained from 23 patients, using Peak Frequency, Median Fre- quency, variance, root mean squares, sample entropy, skewness and kurtosis. These features were extracted from each of the 115 columns in an EEG block (N = 7 fea- tures * 115 columns = 805). The literature reports that Median Frequency, sample entropy and root mean square have the most potential to discriminate between sei- zure and non-seizure records. To validate these findings, the discriminant capa- bilities of each feature are determined using several measures: statistical significance (p and q-values), principal component analysis (PCA) – Principle Com- ponent one (PC1) and Principle Component two (PC2), linear discriminant analysis independent search (LDAi), linear discriminant analysis forward search (LDAf), lin- ear discriminant analysis backward search (LDAb) and gram-schmidt (GS) analysis. Using these measures, the top 20 uncorrelated features were extracted from all regions of the EEG scalp readings (region-by-region feature extraction is consid- ered later in the paper). For example, in the case of p-values we select the top 20 uncorrelated features (from the 805 features that we have) that have the highest p- values and use these features with all our classifiers. The tttest2 function in Matlab can be used to extract p-values and they can be ranked using the sort function.

These features are then used to determine which classifier performs the best. The same approach is used for the q-values. The mafdr function in Matlab can be used to determine the q-values and again, they can be ranked using the sort function. In the case of Principle Component one (PC1), the top 20 uncorrelated features that comprise the most variance in PC1 were selected and evaluated against all classi- fiers. The same approach was used for PC2. In the case of linear discriminant ana- lysis feature selection, the featseli, featself, and featselb provided by the Matlab pattern recognition toolbox PRTools is used to provide an ordered ranking of fea- tures. In a similar way, the Gram-Schmidt ranks and orders each feature by importance.

Fig. 2 shows (using PCA) that several RMS and Median Frequency features, from different channels and frequency bands, appear along the principal compo- nent. This is consistent with the findings in Ning and Lyu [45], Abdul-latif et al. [5], Paivinen et al. [47]. The vertical axis shows that CH12_48_Var, CH9_48_Var, and CH3_0530_MFreq features align closest with the second principal component. Again, these results are consistent with the findings in Ning and Lyu [45], Abdul-latif et al. [5], Paivinen et al. [47].

This study also extracts the top five uncorrelated features from each of the five regions covered by the EEG scalp electrodes as shown in Table 4. This ensures that each region is represented without the bias from all other regions, and allows clas- sifiers to detect focal seizures in different parts of the brain. The features extracted, using the generalised and region-by-region approach, are used to evaluate the capabilities of several classifiers considered in this study and are the top five fea- tures per region selected based on their rank determined by the linear discriminant backward search technique, creating five feature sets containing five features each. The top 20 uncorrelated features and the 25 region-by-region features are com- pared in the evaluation.

In order to determine the overall accuracy of each of the classifiers several valida- tion techniques have been considered. These include Holdout Cross-Validation, Sensitivities, Specificities, Receiver Operating Curve (ROC) and area under the curve (AUC). The Holdout Cross-Validation technique uses 80 per cent of ran- domly selected observations (N = 19.2) to train the algorithms and 20 per cent of randomly selected test cases to test the algorithms (N = 3.8).

The first evaluation uses all the seizure and non-seizure blocks from all subjects in the CHB-MIT dataset (171 seizures and 171 non-seizures). The simulations use 80% for training and 20% for testing. Table 5, shows the mean averages obtained over 100 simulations for the sensitivity, specificity, and AUC.

As shown in Table 5, the sensitivities (seizure), in this initial test, are low for all classifiers. This is interesting given that the dataset is balanced between seizure and non-seizure blocks. One possible reason for this is that the ictal length across the 171 records was 60 s. However, in the CHB-MIT records ictal periods ranged between 2 and 752 (cut down to 60 s) seconds. It is possible that some ictal blocks resemble non-seizure records resulting in misclassification (particularly blocks that contain 2 s of ictal data). However, given that 64% of the ictal blocks contain more than 30 s of icta data, this is appropriate for training. Furthermore, it is a decision that is supported by the relatively high sensitivity, specificity and AUC

The receiver operator characteristic (ROC) curve shows the cut-off values for the false negative and false-positive rates. Fig. 3 indicates that several of the classifiers performed reasonably well. The AUC values in Table 4 support these findings with good accuracy values for the LOGLC and KNNC classifiers.

The simulations use 80% for training and 20% for testing. As shown in Table 7, the sensitivities (seizure), for most of the algorithms have improved, including the specificities values. The AUC results also show improvements for several of the classifiers, with 93% achieved by the KNNC classifier. From the previous results, we find a 4% increase in sensitivities, a 3% increase in specificities and a 2% increase in the performance of the KNNC classifier, with other classifiers improv- ing by similar values.

Again, the ROC curve shows the cut-off values for the false-negative and false- positive rates. Fig. 4 indicates that the performance of several classifiers improved. The AUC values in Table 7 support these findings with the KNNC classifier show- ing a 2% increase in performance.

The study has focused on discriminating between seizure and non-seizure EEG records across a group of 23 subjects, rather than a single individual. The classi- fiers are trained using all 24 cases, and therefore, classification is generalised across the whole population contained in the CHB-MIT database. To achieve this, fea- tures from all the channels that capture the EEG in all parts of the brain were used. In the initial classification results, the top 20 uncorrelated features from the whole of the head (not region-by-region) were extracted from 805 possible fea- tures. This was determined using the linear discriminant analysis backward search technique to rank features. This approach achieved reasonably good results, using the KNNC classifier, with 84% for sensitivity, 85% for specificity, 91% for the AUC, with a global error of 15%.

Using the top five uncorrelated features from EEG channels specific to the five main regions of the head improved the sensitivities and specificities, while produc- ing high AUC values. The best classification algorithm was again the KNNC clas- sifier, which achieved 88% for sensitivity, 88% for specificity, and an AUC value of 93% with a 12% global error. This was followed closely by the SVC classifier, which achieved 85% for sensitivity, 86% for specificity, and an AUC value of 90% with a 14% global error.

This work has potential future clinical applications in the investigation of patients with suspected seizure disorders and may be useful in the assessment of patients with non-epileptic attack disorder (NEAD). Introducing automated sei- zure detection technologies could help increase capacity within healthcare systems such as the UKs National Health Service (NHS), which currently suffers from a chronic shortage of trained clinical neurophysiologists to interpret EEGs. Tele- EEG reporting has previously been suggested as a solution and more recently online systems [20,41], which are interesting approaches, but carry increased costs and concerns over data security. Nonetheless, these, including automated seizure detection may be viable solutions, following further work aimed at improving accuracy further.

There are a large number of features reported in the literature, which have not been considered in this paper. In particular our future work will consider the set of features described in Logesparan et al. [34], Logesparan et al. [35]. Furthermore, our future work will investigate the use of more advanced machine learning algo- rithms, despite the good performance of the classifiers considered in this paper. In particular, we will investigate the use of convolutional neural networks [53] and SVM with different kernels [54].

Window sizes will also be considered to determine whether further improve- ments on accuracies can be made. Future development will also utilise regression analysis and a larger number of observations. This may help to define the charac- teristics of the pre-ictal phase. In addition, more advanced classification algo- rithms, and techniques, will be considered, including advanced artificial neural network architectures (higher order and spiking neural networks). The investiga- tion and comparison, of features, such as fractal dimension and cepstrum analysis, autocorrelation zero crossing and correlation dimension, have also not been per- formed. These techniques should be investigated in a head-to-head comparison, with linear methods.

The paper has investigated the use of classic yet powerful machine learning algorithms and evaluated their ability to detect correlates of seizure activity. While the results are convincing the paper does not address how the system can be gen- eralised for normal use. Furthermore, it does not address real-time concerns where performance will degraded significantly. The approach evaluates the algorithms using offline data; however, this is not a good indicator of the system’s ability as the signals that are used to train and test the algorithms are processed and cleaned and appropriate features extracted. This is a major concern and our future work will look to implement the methodology pipeline using real-time signals, using advances in the Internet of Things and Big Data community that currently utilise data processing technologies, such as Apache Spark.

