This paper proposes two complementary road edge detection methods for unstructured roads. The methods can be used for visual navigation and intelligent control of mobile robots. One method is color-based, which is applicable to the circumstance that the road and off-road areas have obvious color difference; the other is based on threshold segmentation and can be applied even the road boundary is not clear. On the other hand, shadow has enormous impact on threshold segmentation method, but color-based method is not sensitive to it. These make the two methods complementary. Furthermore, on the basis of edge detection, inverse perspective projection transformation is carried out to calculate running state of the robots. Through experiments on mobile robot platform, verifications that the two proposed methods complement each other in different road environments well are made. The experiments also show that the methods achieve high accuracy in initial positioning and meet requirement of real-time.

There are three main categories in unstructured road recognition, feature-based methods, model-based methods and machine learning based methods. Commonly used features in feature -based include color, texture and edge[1][2]. This category is vulnerable to water stain, shadow and lighting condition. Model-based methods[3][4] establish the mathematical model for road boundary, and calculate related parameters in the model to get the boundary. However, it is difficult for methods in this category to establish proper general model for all the forms of road. Machine learning based methods[5] train the detection system to automatically collect and accumulate road features in the video image, so that detections become more and more stable and reliable. However, the actual process to collect a large number of training samples requires tremendous time.

To meet the challenge, lack of generality, in unstructured road detection, this paper proposes two complementary road edge detection methods for unstructured roads. One method is color-based, which is applicable to the circumstance that the road and off-road areas have obvious color difference and is not sensitive to shadow. The other is based on threshold segmentation and is suitable to be applied in the road where boundary is not clear, but shadow has enormous impact on it. By combining these two methods, generality in unstructured road detection can be achieved. The proposed methods only detect one side of the road edge, reducing the requirement of field view, installation angle of camera. Once the edge of the road is detected, positioning of the robot relative to the edges of the road is calculated, inverse perspective projection transformation. It provides good support for navigation and control of robots.

The rest of the paper is organized as following. Section 2 introduces the proposed two methods for road edge detection. Section 3 elaborates initial positioning based on road edge detection. Section 4 gives out experiments. And finally Section 5 concludes the work and points our future works.

Color-based method uses both color feature and edge feature, as individual feature based detection suffers affect from shadow. Colors on both sides of the road edge are usually very different, and the image gradient of road edge is generally very large. We look for colors of road area and non-road area around points with greater gradient, further to determine whether the points are road edge candidates.

The method is illustrated in the environment where the non-road area is green belt, and the right edge of the read is detection target, as a case. First canny edge extraction is done on the grayscale of the original image, and we denote it C. Then the original image is transformed into HSV space and recorded as M.

Binary image of M can be got using following formula for each point in M. White points in the binary image denote green points, and black points denote non-white points. f(x) is the pixel gray value. H and S are the H and S components of original pixel. 50-100 and 0-40 are H and S range interval for green pixel.

Assume that the total number of candidate edge points is t; the number of points in C is p. If t and p satisfy the following formulas, it means that there may be no shadow on the road and the edge of the road is not clear. Then the current method should be stopped by switching to threshold segmentation based method. Otherwise, the method continues to fit the road edge line using road edge candidate points.

We convert the image into grayscale image and traversal through each pixel. According to maximum criteria of Between-class variance, optimal threshold t can be got. Transform the image into binary image using the optimal threshold, and then canny edge extraction is done. Scan from left to right (if it is right edge detection) to get the first white pixels, and the road edge can be got by conducting Hough transform upon these pixels.

Assume the position of the robot is B in Fig 1, the center solid line (ABC) is the direction the robot is travelling, and dashed line (DE) is the extension of edge. The driving angle deviation  is the angel between the center solid line and the dashed line. The length of BD is lateral displacement. And it does not matter whether they are positive or negative.

 can be calculated as follow. Coordinates for each pixel in the edge line can be got in former detection algorithm. Multiplied by the inverse perspective projection transformation matrix H, coordinates for each pixel in the straight line DE can be got. Using the coordinates for the two pixels, the slope of the line can be calculated. Then we can get. If the x coordinate of the two pixels are the same,  is 0˚.

Lateral displacement (BD) can be calculated as follow. Calculate the coordinates of A, and assume the y coordinate of A is h. Assume actual distance between robot center and the image bottom (BC) is d (mm), transform to pixel distance   , where  (mm) is actual length of a pixel. Lateral displacement (BD) is	, where height is image height in pixels, which is also C’ y coordinate.

Experiments are carried out in Mobilerobots’ Pioneer 3-AT robot platform. The robot possesses 2.3GHz dual core processors, 1 G memory and Windows XP sp2 operating system. The development environment is Visual Studio C++ 2005, involving OPENCV open source library for image processing.

This paper proposes two complementary road edge detection methods for unstructured road. One method is color-based, which is applicable to the circumstance that the road and off-road areas have obvious color difference and is not sensitive to shadow. The other is based on threshold segmentation and is suitable to be applied in the road where boundary is not clear, but shadow has enormous impact on it. By combining these two methods, generality in unstructured road detection can be achieved. When the road edge is got, positioning of the robot relative to the edges of the road is calculated, inverse perspective projection transformation. Experiments show that the two methods achieve high accuracy in initial positioning and lays foundation for navigation and control.

