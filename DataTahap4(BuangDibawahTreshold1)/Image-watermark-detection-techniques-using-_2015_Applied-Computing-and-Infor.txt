Abstract The quadtree, a hierarchical data structure for the representation of spatial information based on the principle of recursive decomposition, is widely used in digital image processing and computer graphics. This paper demonstrates the detection of invisible watermarked images generated by popular watermark- ing techniques, including CDMA, DCT, DWT, and Least Significant Bit (LSB) using quadtree. Results corresponding to typical (512 · 512) pixel images show differences among these methods when they are used. Each time we use the same image, the original images and invisible watermarked image to test the four methods in conjunction with quadtree decomposition. In addition to the subjec- tive method represented by quadtree, many objective evaluations such as Pear- son correlation, mean square error (MSE), Structural SIMilarity Index (SSIM) and false positive and false negative were used to give the comparison criteria between original and watermarked images. In results, the quadtree decomposi- tion considered a promise subjective method to recognize among these water- mark techniques.

Digital image watermarking has attracted the attention of many researchers over the past decade. The motivation behind this work is the achievement of informa- tion security, information concealment, authentication, and fingerprinting. Several approaches to digital image watermarking have been proposed, one of which is the discrete wavelet transform (DWT). The DWT has become highly popular in the field of watermarking due to its ability to decompose available images into sub- bands in which watermarks can be embedded selectively. There are many pub- lished studies on this approach and its combination with other approaches, such as quadtrees, DCT, and CDMA approaches. A semi-blind algorithm proposed

The most accurate tests of accuracy and quality are subjective tests involving the human observers. Those tests have been developed by psychophysics, scientific disciplines, which aim to identify the relationship between the physical world and people’s subjective experience of this world. An accepted measure for evaluation of the level of distortion is a Just Noticeable Difference (JND), and it represents a level of distortion that can be perceived in 50% of experimental trials. One JND thus represents a minimum distortion that is generally perceptible [15]. Survey of watermarking techniques and applications was given in Muharemagic and Furht [15]. Marini et al. [11] proposed to use a Double Stimulus Impairment Scale (DSIS) protocol. In this protocol, the original and the watermarked images are

Quadtree decomposition is used in this paper as an analytical technique to sub- divide an image into blocks that are more homogeneous than the image itself. This technique reveals information about the structure of the image. We use this data structure to examine differences among watermarking methods such as DWT, DCT, LSB, and CDMA in relation to watermark insertion.

This paper is organized as follows: Section 2 provides an overview of related theories. Section 3 presents the subjective and objective performance evaluation. Section 4 depicts the proposed system. In Section 5, we present experimental results and a discussion of the proposed system. Finally, Section 6 concludes the paper.

CDMA is an application of a direct sequence spread spectrum. Its purpose is to combine multiple signals that, despite overlapping in both time and frequency, remain separable. This separability is achieved by projecting individual messages onto near-orthogonal PN sequences prior to carrier modulation. The number of simultaneous users in the system dictates the choice of a particular sequence. Max- imal length, Kasami, and Gold sequences have been widely used for many reasons.

If I denotes the image block of length L (i.e., image transformation coefficients of length L), a binary-valued code pattern of length M is used to spread each watermark bit. Therefore, a set P of N code patterns, each of length M, is gener- ated to form watermark sequence W through the following operation.

Here, a is the modulation index, and its proper choice will optimize the maximum amount of allowed distortion and minimum necessary watermark energy for reli- able detection. a may or may not be a function of image coefficients. Accordingly, SS watermarking schemes can be categorized as signal adaptive or non-adaptive [5].

The fundamental idea of the discrete wavelet transform (DWT) in image process- ing is to decompose the image into sub-images of different spatial domains and independent frequency districts. Next, the coefficient of the sub-image is trans- formed. After the original image has been DWT-transformed, it is decomposed into four frequency districts: one low-frequency district (LL) and three high- frequency districts (LH, HL, and HH). If information from the low-frequency district is DWT-transformed, information about the sub-level frequency district can be obtained. A two-dimensional image after three iterations of DWT decom- position is shown in Fig. 1, where L represents the low-pass filter and H represents the high-pass filter [18,21].

Step 2: The watermark is embedded in n higher-magnitude coefficients in the transform matrix, excluding the DC component. This step ensures that the watermark is embedded in the most significant perceptual components of the image. A watermark embedded in the less significant components may be destroyed by compression or other attacks. When the watermark X(n) is embed- ded into DCT components C(u, v) to obtain new watermarked DCT coefficients C*(u, v), we specify a scaling parameter a that determines the extent to which X(n) alters C(u, v), as shown in the following equation:

LSB coding is one of the earliest used methods in watermarking and steganogra- phy. It can be applied to any form of watermarking. In this method, the LSB of the carrier signal is substituted with the watermark. The bits are embedded in a sequence that acts as the key. To retrieve the signal, this sequence must be known. The watermark encoder first selects a subset of pixel values in which the water- mark must be embedded. Then, the watermark information is embedded on the LSBs of the pixels from this subset. While LSB coding is a very simple technique, the robustness of the watermark tends to be insufficient. When using LSB coding, it is usually impossible to retrieve the watermark without noise [13].

A natural gray-level image usually can be divided into differently sized regions with variable amounts of details and information. Such segmentation of the image is useful for the efficient coding of image data. QT decomposition is a powerful technique that divides the image into 2-D homogeneous regions, thereby produc- ing the segmentation.

A quadtree representing a picture is a tree in which successively deeper levels represent successively finer subdivisions of picture areas. Each node represents the quadrant of its parent. The tree is filled through the process of recursively sub- dividing an image matrix into four quadrants until a quadrant is one solid color. A quadtree is a tree with nodes that are either leaves or have four children. The chil- dren are ordered: 1, 2, 3, and 4.

The region quadtree: The region quadtree represents a partition of space into two dimensions that decomposes a region into four equal quadrants, sub- quadrants, and so on. Each leaf node contains data corresponding to a speci- fic subregion. Each node in the tree has either exactly four children or no children (a leaf node).

The region quadtree is not strictly a ‘tree’ (more precisely, ‘trees’) because the positions of subdivisions are independent of the data. A region quadtree with a depth of n may be used to represent an image of 2n · 2n pixels, with each pixel val- ued 0 or 1. The root node represents the entire image region. If the pixels in any region are not entirely 0 s or 1 s, that region is subdivided.

In this application, each leaf node represents a block of pixels that are all 0 s or all 1 s. A region quadtree may also be used as a variable resolution representation of a data field. In this paper, the region quadtree is assumed.

Point quadtree: The point quadtree is an adaptation of a binary tree used to represent two-dimensional point data. It shares the features of all quadtrees but is a true tree because the center of a subdivision is always on a point. The shape of the tree depends on the order in which the data are processed. The point quadtree is typically very efficient at comparing two-dimensional ordered data points, usually operating in O(log n) time.

(1) Edge quadtree: Edge quadtrees are specifically used to store lines rather than points. Curves are approximated by subdividing cells until a very fine resolu- tion is reached. This procedure can result in extremely unbalanced trees, which may defeat the purpose of indexing. Fig. 2 demonstrates the decompo- sition of an image [20,10].

SSIM index is a method for measuring the similarity between two images. Struc- tural information is the idea that the pixels have strong inter-dependencies espe- cially when they are spatially close. These dependencies carry important information about the structure of the objects in the visual scene. The SSIM metric is calculated on various windows of an image. The measure between two windows x and y of common size N · N is [22]:

of x and y respectively, and rxy is the covariance of x and y. c1 = (k1L)2 and c2 = (k2L)2 are two variables to stabilize the division with weak denominator, L is the dynamic range of the pixel-values (typically this is 2#bits per pixel 1), and k1 = 0.01 and k2 = 0.03. The resultant SSIM index is a decimal value between

This matrix provides a quantitative performance representation for each classifier in terms of class recognition or detection. Values along the main diagonal give the total number of correct classifications for each class. Values other than those on the main diagonal represent classification errors.

The proposed system was implemented on a Dell Laptop (Windows 7, Processor Core 2 Duo and 2.00 GB RAM) using MATLAB. In this section, we describe a detection system using a quadtree. Fig. 3 is a conceptual diagram of the proposed system.

ing with nearly equal to the values resulting from each method, suggesting a way to differentiate from other. Table 2 gives the resultant of the correlation between the original images and the watermarked images. The results seen for the same images show that the output correlation is equal to 1, which means that the two images are identical. As mentioned earlier in SSIM index, there is variation in the results of each method of image watermarking. Table 3 shows MSE results, which indicate no error between the same images. A lower value for MSE means less error as noted in the LSB method.

Depending on the results of these assessments, another comparison between the original images and watermarked images achieved in Table 4 through the confu- sion matrix and the Supplementary Fig. S5 using the false positive and false nega- tive. The confusion matrix is given in Table 4; numbers shown in bold font are correct classifications.

All tested images used watermarked images. Note that the results reported in Supplementary Fig. S5 show that the false negative decreases as false positive increases. Fortunately, this action reduces the chance of false negative conditions which occurs when a watermark detector fails to detect a watermark.

In this work, we have presented quadtree decomposition as a subjective metric and objective metrics based on SSIM, MSE, Pearson correlation and false positive and false negative. We tested its performance in the context of four distinct watermark techniques: CDMA, DWT, DCT, and LSB. Quadtree is usually used in segmen- tation process; in this paper, we benefit of quadtree decomposition to recognize the method of image watermark. The results reveal differences between the water- marked image and the original image across the four techniques; this was con- firmed by the results of the quantitative evaluation. This research demonstrates the effectiveness of the quadtree as a detector of watermarked images and shows the differences in the performance of various techniques.

