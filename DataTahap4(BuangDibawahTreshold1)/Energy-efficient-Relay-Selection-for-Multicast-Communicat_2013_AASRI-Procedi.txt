where PR is the receiving power of each user. At the second stage, Nx users in G are selected as relays, the corresponding relay set is Re, and then these relays forward data to the users in B. In order to make all users decode data correctly in the two stages, relays multicast data at a rate that user with worst CSI could decode correctly. Therefore multicasting rate of relays at the second stage is

In this section, we set R=100m, =3, B=10 kHz, ST=1000 bits, PBS=1w, PRE=0.1w and PR=0.05w, and define the energy efficiency as the number of bits transmitted when one joule energy is consumed. For clarity of presentation, we simplify traditional cooperation, optimal relay selection algorithm, and greedy algorithm,

