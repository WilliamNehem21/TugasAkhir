Abstract Accurate long-term prediction of time series data (TSD) is a very use- ful research challenge in diversified fields. As financial TSD are highly volatile, multi-step prediction of financial TSD is a major research problem in TSD min- ing. The two challenges encountered are, maintaining high prediction accuracy and preserving the data trend across the forecast horizon. The linear traditional models such as autoregressive integrated moving average (ARIMA) and gener- alized autoregressive conditional heteroscedastic (GARCH) preserve data trend to some extent, at the cost of prediction accuracy. Non-linear models like ANN maintain prediction accuracy by sacrificing data trend. In this paper, a linear hybrid model, which maintains prediction accuracy while preserving data trend, is proposed. A quantitative reasoning analysis justifying the accuracy of proposed model is also presented. A moving-average (MA) filter based pre- processing, partitioning and interpolation (PI) technique are incorporated by the proposed model. Some existing models and the proposed model are applied on selected NSE India stock market data. Performance results show that for

Financial TSD mining provides useful information for the investors, banks and insurance companies to channel their funds properly for better returns. This deci- sion making is the primary motivation for prediction of financial TSD. Accurate multi-step ahead prediction of financial TSD becomes more difficult, as the finan- cial TSD is highly volatile. If prediction is one-step ahead preserving data trend is irrelevant. However, as the forecast horizon increases, preserving data trend becomes significant. In either case, prediction accuracy should remain high. Hence, the two basic requirements for multi-step ahead prediction model are maintaining high prediction accuracy and preserving the data trend across the pre- diction horizon.

Traditional models like ARIMA, GARCH or ANN cannot meet both the requirements simultaneously. However, a hybrid model may provide scope for preserving data trend across the forecast horizon while maintaining good predic- tion accuracy, which motivates the research work of this paper. Most of the tra- ditional models such as ARIMA, GARCH and ANN are applied for one-step ahead forecasting in many works of the literature, where prediction accuracy is of major concern. However, in the present paper, we target multi-step ahead pre- diction, which requires preserving data trend in addition to high prediction accu- racy. Such a model should account for the nature of TSD at every stage in the model.

Rest of the paper is organized as follows. Section 2 presents a literature survey of different prediction models existing in the literature. The proposed PI based hybrid ARIMA–GARCH model is detailed in Section 3. A quantitative analysis of the proposed model is discussed in 4. The proposed and the traditional models are applied on selected NSE India data and the performance is compared in Sec- tion 6. The paper ends with conclusion in 7.

systems. In [4] ARIMA is used to perform one-day-ahead forecasts of tomorrow’s federal funds rate. ARIMA with a wavelet based decomposition is used in one- step ahead forecasting of average global temperature in [5]. ARIMA model is suit- able for short term forecasting, if this model is applied for long term prediction the prediction accuracy may not very accurate which can observed from [6], where employment information of Chinese computer industry is forecasted.

Engle in 1982 introduced ARCH model [7] which is known for forecasting high- ly volatile TSD. An improved version of ARCH model called generalized ARCH also known as GARCH model [8] was introduced by Bollerslev, Engle, and Nel- son in 1994. Several extensions of GARCH model are found in the literature. Some of the extensions are extensively surveyed in [9]. In [10] a simple (linear) GARCH(1,1) model is applied on Swiss market index and the results show that the model provides a good parametrization for the daily returns. GARCH model is further explored and studied in [11] and showed that the presence of outliers has an impact on the forecast results. In [12] GARCH models are used to forecast hourly prices in the deregulated electricity markets of Spain and California and the results outperform ARIMA model when volatility and price spikes are present. Some times GARCH models are inappropriate to model as they assume Gaussian distribution. In such cases student-T distribution can be assumed. This fact is fur- ther investigated in [13].

Many Hybrid models are derived in the literature for time series forecasting. The hybrid models combine strengths of few individual models to render better prediction accuracy. A composite ARIMA–GARCH model for forecasting rain- fall data is presented in [14]. ARIMA is used with GARCH model for forecasting daily load and maximum electricity demand estimation as seen in [15], which pro- vides a better long term forecasting. In [16], traffic modeling and prediction using ARIMA and GARCH models are proposed. A MA filter based hybrid ARIMA– ANN model is proposed in [17]. Other techniques like spectral analysis to forecast real time traffic flow [18], Grey–Markov model to forecast Chaina electric-power demand [19] also exist in the literature.

Financial data are highly volatile in nature. If this volatility nature is character- ized and accounted at every stage in a prediction model, both the data trend and accuracy requirements can be met simultaneously. General characteristics of high- ly volatile TSD are changing variance as a function of time, volatility clustering (VC) and fat tail distribution (FTD) [20]. These are mathematically characterized using conditional standard deviation, autocorrelation plot of absolute or squared returns, Quartile–Quartile plot respectively [20]. Using these characteristics a MA

Given TSD is decomposed into two components, one of which is smooth, called the trend component and the other named as noise component. This decomposi- tion is shown in Fig. 1. The MA filter is given in (1), where m indicates length of the filter, smt is the smoothened trend component and ert is the noise component. It is adjusted such that one of the decomposed components is highly volatile with predominant VC and FTD, but the other is low volatile with relatively very less VC and no FTD.

[21] or variability of prices or returns of a given TSD [22]. The popular measure of volatility is the conditional standard deviation, rt, given in (2), which is the vari- ance of TSD available till the time lag t. In (2), rt represents the returns data. If rt changes slowly with time, the TSD is identified as low volatile, else it is highly volatile.

According to [23], some TSD can be characterized by VC, which means large changes are more likely to be followed by large changes and small changes more likely follow small changes, in the given TSD. VC implies, though the time samples appear uncorrelated across time, they are actually dependent across time. VC can be quantified using the autocorrelation plot of absolute returns data [23], or using autocorrelation plot of squared returns [20]. If these plots slowly decay as a func- tion of time lag, then the data are said to exhibit VC. If the decay is relatively slow, the effect of VC is high, else it is low. The autocorrelation sequence can be calcu- lated using (3), where, s represents the time lag.

If the distribution of given TSD deviates from that of Gaussian (Normal), then the data are fat tail distributed. This means the data exhibit peaked nature at the cen- ter and the tails are fatter than that of Gaussian distribution. To quantify FTD, Jarque–Bera normality test can be used. According to this test, if the kurtosis of TSD is 3, it is Gaussian distributed and if kurtosis is not equal to 3, it exhibits FTD. Note that if the data are highly outlier prone, kurtosis is greater than 3 and if it is less prone to outliers, the kurtosis is less than 3 [24]. Kurtosis is com- puted using (4). Another way of identifying FTD is the Q–Q plot on returns data [20]. If this Q–Q plot deviates substantially from the standard normal Q–Q plot, the data have FTD.

sample data points. On this data, a linear interpolation is done to obtain Tr data points. This process is repeated on each of the partitions and P different TSD are obtained, each consisting of Tr sample data points. Thus interpolated TSD parti-

values as training data a GARCH model is fit, validated and En — Er forecasts are obtained. The mean absolute percentage error (MAPE) with En — Er pre- 4. Consider one partition P 1 with first Er data values, where Er < En. Using Er

The proposed PI based hybrid ARIMA–GARCH model has improved prediction accuracy than individual models. The success of this technique lies in the success of the decomposition and PI techniques. On a simulated highly volatile TSD, these two techniques are applied and analyzed. Later, the improved prediction accuracy of the proposed method is justified and its other advantages and limitations are discussed.

deviation plots, the autocorrelation of absolute returns plots and the Q–Q plots. It can be observed that the series S1 is highly volatile with predominant VC and FTD, and the other is series S2, is low volatile with less VC and no FTD. Thus it is indeed possible to obtain the required two series by selecting a proper value of m. Note that the value of m is not unique. For example in this case, we observed that for values of m ranging in 25 6 m 6 35, the required two series can be prop- erly obtained (Results are not presented).

Let a TSD, referred as raw data here, have 500 data points. If 10 partitions are done, each partition will have 50 points. In this case, the first partition has the data points 1; 11; 21; .. . ; 491, second partition has data points 2; 12; 22; .. . ; 492, and

From Fig. 2, on the low volatile decomposition with less VC and no FTD, ARIMA model is applied. This is apt because ARIMA model assumes a Gaussian distribution (i.e. no FTD), no VC and constant variance [1]. Similarly on the high- ly volatile decomposition, which has VC, and FTD, GARCH model is being applied. This is apt because, GARCH model relaxes the constraint of constant variance [26], and is suitable for data with VC [23]. The proposed hybrid model is hence applying apt individual models based on the nature of decompositions. Note that in general decomposition improves prediction accuracy [24], and in this case, due to the application of right model to each of the decomposition accuracy further improves.

Instead of directly applying GARCH model on S1, if PI technique is applied, P different data series result. On each of the series, GARCH is suitable because, the volatility, VC and FTD still prevail as discussed in Section 4.2, irrespective of the number of partitions P. Now out of the P different GARCH models, the best model can be chosen. Let this best model be obtained due to the Bth partition. This means that some of the data points, which do not really play any role in prediction (for example, outliers) are not present in this Bth partition and so this partition gave the best prediction accuracy.

The advantages of the proposed model are that, it is well suited for long term pre- diction. Also, being a linear model, the data dynamics i.e. data trend is preserved and the prediction accuracy is high, better than the popular ANN. The ANN on the other hand uses the training data and learns from the data before prediction. It blindly tries to maximize the overall prediction accuracy. In this process, the data dynamics are sacrificed. This reasoning supports the fact that the proposed prediction model is better than the ANN model. The proposed model is clearly better than ARIMA, GARCH and Wavelet ARIMA models also, because the nature of the given time series data is clearly accounted at every stage in the model.

The limitation of the proposed model is that, the number of partitions P is decided based on trial and error. If the estimation of P for a given data set is possible, it will improve the model, though complexity increases. Also, in this paper, the covariates are not considered. The proposed model is shown to work

well for univariate data. If the covariates are considered, the prediction accuracy still further improves because taking the effect of covariates, implies the dependen- cies of the data are completely being accounted. The drawback will be the model complexity and tuning of the increased number of model parameters [22]. So this study is not included in this paper.

In this section, on selected financial TSD originating from NSE India data, the proposed model, ARIMA, GARCH, wavelet-ARIMA and ANN are applied. The performance measures used for comparison, are the error measures, MAPE, Maximum Absolute Percentage Error (MaxAPE), MAE and Root Mean Square Error (RMSE) which are given in (7)–(10) respectively. In these equations, pi and pf are the start and end time instants of the prediction interval. yi;actual is the actual

number of trades data of Tata Steel. A 20-step ahead prediction is performed in both the cases. This implies using the data values available till yesterday, the data values from today till another 20 days are predicted. In both these TSD cases, the proposed method outperformed other models in terms of prediction accuracy and also in preserving data trend.

The number of trades of Tata Steel from January 2011 to December 2011 is con- sidered as TSD2 for the study. On this highly volatile TSD, the ARIMA, GARCH, wavelet ARIMA, ANN and the proposed model are applied. The results of MAPE, Max APE, MAE, and RMSE for these models are given in Table 2. The proposed model outperformed others as in the previous case. The corresponding actual and the predicted values in the prediction horizon are shown in Fig. 5. The figure shows that ANN failed to follow the data trend, whereas the proposed method preserved the data trend more accurately. In this case the pro- posed model used 11 partitions, where 6 of them had almost same VC, FTD and Q–Q nature as the S1 series while the other 5 showed very different nature. The

best partition is one of these 5 partitions. As the results for this TSD2 given in Table 2 and Fig. 5 showed that the proposed model has improved performance, it is enough evidence for the quantitative justification given in Section 4.

In this paper, for highly volatile financial TSD, a hybrid ARIMA–GARCH model is proposed, which is suitable for multi-step ahead forecasting. The technique involves a MA filter based decomposition as a pre-processing step on given TSD. The proposed model is applied on selected NSE India data sets to get mul- ti-step ahead prediction. The obtained results are evaluated using error perfor- mance measures MAPE, MaxAPE, RMSE, whose values confirm the improved prediction accuracy compared to traditional models ARIMA, GARCH and ANN. The proposed model also preserved the data trend over the prediction hori- zon better than the others. The prediction performance can be studied by the inclusion of covariates, which forms the future scope of this paper.

