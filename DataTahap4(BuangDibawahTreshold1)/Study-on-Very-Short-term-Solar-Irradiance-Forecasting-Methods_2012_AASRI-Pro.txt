Due to the fluctuating and intermittent nature of solar irradiance, the power output of PV power station fluctuates. It brings great difficulties for power output forecasting of PV power station. Traditional PV power output forecasting technologies using physical/statistical model combined with NWP failed to provide accurate results. Based on the research of on-line analysis on ground-based cloud image captured by Total Sky Imager (TSI), through the technical phases of cloud recognition, cloud blocking prediction, distortion correction, projection transformation and integration with cloud forcing analysis, the roadmap of PV very short term solar irradiance forecasting based on ground-based cloud image analysis was presented in this paper. Theoretical analysis proves that the method tends to provide reasonable accurate forecasting results and can be widely used.

The fluctuating and intermittent nature of PV power output may cause the instability of power system integrated with large scale of PV power. PV Output power forecasting is used to optimize the dispatching job of the grid and guarantee power quality. PV power forecasting with high accuracy can help to reduce the spare capacity and cut down the operating costs, so as to take full advantage of solar resource and achieve both of social and economic benefit. The intermittency and randomness of surface solar irradiation directly cause the fluctuating of PV output power and bring great difficulties for PV output power forecasting. Traditional

The domestic and foreign relevant research (Istvan et al., 1998; Harshvard et al.,1990) indicates that: the sun being blocked by cloud is mainly responsible for the intermittency of solar irradiance. Observing and collecting cloud image, then predicting clouding blocking, and then analyzing the cloud forcing effects are one of the effective way to forecasting the solar irradiation.

In the following part of this paper, the work flow of the solar irradiance forecasting and the method of cloud image data collection are presented first. Then the key technology and implementation of cloud blocking prediction are presented. And then, integrated with cloud forcing model (Ramanathan and Cess, 1989), the cloud blocking prediction results are used to forecasting irradiance. Finally, the conclusion. Contents of this paper are focused on how to perform cloud blocking prediction using on-line cloud image data.

In order to implement the function mentioned above, the work flow of the method is shown in fig.1. Firstly, the cloud image collection module collects the on-line cloud images captured by cloud observation equipment and these images are matriculated and sent to cloud recognition module. The latter recognizes and annotates each cloud in the image and send the result to cloud blocking prediction module. Then, the cloud blocking prediction module makes cloud blocking prediction, distortion correction and projection transformation jobs according to the TSI factory documents. Finally, the cloud forcing calculation module calculates the solar irradiance forecasting results in real time exploiting the historical observed weather condition and irradiation data.

For keeping the balance between cost, maintainability, high-integrity and accuracy of measurement, Total Sky Imager (TSI) (Long et al., 2001) is chosen as the cloud observation equipment in this paper. Being developed by Yankee Environmental System Corporation (YES), TSI as observation equipment is designed to capture cloud image of the total sky in real time. A CCD camera is installed on top of the equipment to capture the sky image in a spherical mirror below. The new generation of TSI880 is capable of capturing 24 bit JPEG images with resolution of 352*288, the minimum time sampling interval is 10s. TSI supports to provide continuous sky image in day time with a visual angle of 160ecovered 95% area of the sky. When solar elevation angle is greater 10e, TSI is able to invert the distribution of cloud in the sky.

The job of cloud recognition is to recognize and annotate each cloud in the sky image through 3 phases: 1) image loading and graying; 2) image filtering, preprocessing phase for raw image with noise. This processing can help to improve the quality of the image and make it easy to be recognized. 3) Threshold segmentation, using blue-red ratio to distinguish the clouds from clear blue sky, so as to classifying the objects in the image into 3 type: opaque cloud, thin cloud and clear blue sky (Long et al., 2006). In those phrases, cloud images are stored and processed as matrix, which are easy to be handled by computer.

In order to perform these processes by computer software, OpenCV Tool Suite are chosen to implement the algorithms involved in these phrases. OpenCV (Bradski et al., 2008) is a widely used open source computer vision research tool suite. It includes hundreds of the implementations of general computer vision algorithms. These general computer vision algorithms can help to implement image collection, image graying, image filtering and threshold segmentation.

Through recognition and annotation, cloud image are represented as two dimensional matrix, where blue sky pixel as annotated as 0, cloud pixel as none-0 value (red-blue ratio). Through iteratively predicting the motion trend of each cloud and solar movement in the image, we are able to predict the block of the sun by cloud at a future time. Since solar movement is only relevant to time line and can be tracked by calculation, the key factor of the prediction of cloud blocking focuses on how to predict the motion trend of each cloud.

For the convenience of analyzing the motion trend of the cloud in the image, we can consider a series of timely continuous images as frames in motion picture. Based on the algorithm of displacement estimator for motion picture (Zhang et al., 2004) which is adopted in digital video compression field, we can estimate the shifting of the objective cloud. The basic idea is to divide each frame in motion pictures into image sub-blocks, for each sub-block in current frame, the most similar sub-block in the previous frame is distinguished from all the candidate sub-block in a given area, which we called block match. The shifting between the current sub-block and its matched sub-block is the displacement vector of the sub-block. Based on this vector, we can predict the location and the coverage of the cloud at a future time. Through calculating the location of the sun at the same time, we can predict the occurrence of cloud blocking. The pseudo code of algorithm of cloud blocking is shown in Fig.2.

Assumed that the cloud image captured by TSI could be considered as a plan graph without distortion, we could directly calculate the decreasing of solar irradiance based on the prediction result of cloud blocking. However, according to the imaging principle of TSI (Long et al., 2001), cloud images in the spherical mirror tend to occur edge distortion. That is to say, the area (pixel count) of the cloud in the edge of the image looks smaller than it is, so the prediction result need for distortion correction.

Long et. al., 2006 believe that even if through distortion correction, there still exists difference between the area of cloud in the image and that of the real cloud in the sky. In this sense, to ensure the consistence between the cloud image and observation results by eye, the image should go through a projection transformation procedure to in advance correct the area of the objective cloud during the prediction calculation.

As to cloud forcing analysis, from the theory in He Wulin et al., 2003 we can figured out that the solar total radiation can be calculated by direct radiation, scattered radiation and reflected radiation. However, in practice, the calculation accuracy is often affected by aerosols, water vapor and other immeasurable factors. Through analyzing measured data, we obtained a simplified equation for calculating solar total radiation:

In this paper, cloud data processing method and collecting equipments are described first, then the methodology of cloud blocking prediction based on cloud image analysis are presented. And then, the cloud blocking results are integrated with cloud forcing analysis and a work flow and effective method for very short-term solar irradiance forecasting based on ground-based cloud image is put forward. The theoretical presentation and data analysis proved that this method tend to provide irradiation prediction results with high accuracy under complex weather conditions. Furthermore, since the data sources and collecting equipments involved in the method are easy to be obtained and used, this method has extensive applicability.

