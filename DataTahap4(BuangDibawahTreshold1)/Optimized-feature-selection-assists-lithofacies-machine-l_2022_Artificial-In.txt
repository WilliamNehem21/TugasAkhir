The classification of lithofacies in wellbores is a fundamental component of reservoir characterization (Dubois et al., 2007). Extensive use is made of recorded well-log dataset to conduct that classification in both clastic (Rider, 1990) and carbonate (Stowe and Hock, 1988) res- ervoirs. This is very effective, particularly where the lithofacies are easily distinguished in core and well-log terms, laterally extensive across the reservoir, reasonably homogeneous and a sufficient diversity of well-log features is recorded in multiple wellbores. If some of these re- quirements are missing it is typically necessary to complement the available core/well-log data with additional geological information (Reverdy et al., 1983).

substantial influence on its effectiveness and accuracy. There are many approaches that can be adopted to conduct feature selection in lith- ofacies analysis. At the simplest level a trial-and-error approach can be used, if there are relatively few features to select from. However, as the number of available features increases the possible combinations for those features runs into many thousands, making trial-and-error both inefficient and unreliable. Indeed, feature selection is an NP-hard combinatorial challenge (Cortes and Vapnik, 1995); as the number of possible feature combinations grows exponentially as the number of available features increases. A more effective approach is to apply op- timizers to conduct more comprehensive feature selection (Abiodun et al., 2021).

reduce the number of features can improve the efficiency of some ML models (Ma, 2011). Distinct types of ML algorithm are now used for well-log-based lithofacies prediction. This commenced three decades ago with neural networks (Rogers et al., 1992; Agrawal et al., 2022) and has diversified to include support vector classification (Sarkar and Majundar, 2020), K-nearest neighbor (Merembayev et al., 2021), opti- mized data matching (Wood, 2019) and various tree-ensemble methods

There are no specific geological factors used to define or control any of the log attributes selected. However, the fluctuating values of each attribute do tend to respond differently to different formation lithol- ogies, textures, and degrees of lamination. The attributes selected are generic and could be applied to any log curve that shows fluctuations in its absolute values versus depth that relate to the physical rock prop- erties. Hence, attributes calculated for gamma-ray, bulk density, and acoustic well logs are more likely to give consistent responses for for- mations across several wells than resistivity and neutron logs. The reason for this is that the resistivity and neutron logs are strongly affected by the fluid type present in the porous formations present. So, for lithofacies analysis, attributes applied to gamma-ray, bulk density, and acoustic logs commonly recorded in many wells are the most obvious logs for which attributes can provide useful complementary information to the raw log values.

With as many as sixteen potentially influential well-log variables to choose from it is appropriate to conduct feature selection to establish whether some of the least influential of those variables can be dis- regarded, thereby helping to make the ML models more efficient and effective. There are multiple possible variable combinations that could be considered. Two combination that are used as benchmarks are Case 0 using only the four recorded well logs (GR0, PB0, TH0, K0) and Case 1 using all sixteen available variables.

These ML models are: adaptive boosting (ADA), a tree-ensemble method introduced by Freund & Schapire (1997); decision tree (DT) introduced by Quinlan (1986); K-nearest neighbor (KNN) introduced by (Fix and Hodges, 1951); logistic regression (LR) introduced by Cox (1958); random forest (RF) introduced by Ho, (1998); support vector regression (SVC) introduced by Cortes & Vapnik (1995); and extreme gradient boosting (XGB) introduced by Chen and Guestrin (2016). These models have been widely applied to lithofacies classification studies and their mathematical formulations are well described in the literature. Several recent studies have evaluated and fully described these algo- rithms. Al-Mudhafar et al. (2022) applied ADA and XGB to classify a heterogeneous carbonate reservoir using well log data. Sarkar and Majundar (2020) compared the performance of DT, RF and SVC in lithofacies classification based on wireline data. Merembayev et al. (2021) compared the performance of DT, KNN, RF and XGB in pre- dicting lithofacies in oil and gas fields located in Norway and Kazakhstan. Masapanta (2021) compared the performances of multiple ML models, including LR, KNN, SVC, DT and RF, to classify lithofacies in North Sea field reservoirs.

Once the hyperparameters are established, it is necessary to establish the appropriate splits of data records to use for the training and vali- dation dataset. A multi-k-fold cross validation technique is conducted to identify the appropriate splits to use. Four different k values are evalu- ated: 3-fold, 4-fold, 5-fold and 10-fold. Each fold is computed for mul- tiple runs with the combined data records from Wells V and X (the training and validation subset) to provide mean and standard deviations for mean absolute error (MAE) and root mean squared error (RMSE) of the facies#. A comparison of the mean and standard deviation MAE and RMSE values of the four different k-folds considered indicates the appropriate splits to use. Typically, the split with the lowest mean plus standard deviation is the best split to use. Also, k-folds that generate high mean and/or standard deviation values typically identify the least efficient splits to apply. The K-fold-cross-validation function available in Python for use with the ML packages of SciKit Learn (2022d) is customized to execute the multi-k-fold technique.

These eight high-performing feature selections include between 7 and 10 of the available 16 features available. They achieve prediction accuracies of approximately between 0.92 and 0.94. The three best- performing feature selections are evaluated in more detail: Rank 1(SC) as Case 2 with nine features; Rank 2 (DE) as Case 3 with seven features; and Rank 3 (PS) as Case 4 with nine features. These cases are compared in terms of their lithofacies prediction performance with Case 0 (involving just the four recorded well logs) and Case 1 (involving all sixteen available features).

KNN model achieves higher accuracy than the SVC model. Slight dif- ferences between the error and accuracy performances among the models are to be expected. These are explained in terms of the extent of the misclassification of data records that are incorrectly predicted by a model. The cases where prediction misclassifications involve numeri-

smaller impact on MAE, RMSE and R2 than for misclassification that involve more numerically separated facies (e.g. Sh = 0 misclassified as Sh = 3). On the other hand, the accuracy measure only considers whether the prediction for each data record is correct or incorrect.

not involved in the training/validation of the models. (e.g., XGB Case 0 with<0.58 accuracy, and ~0.6 accuracy in predicting the testing subset lithofacies associated with oil pay) Calculating well-log attributes for some of the recorded logs and using optimizers to select features

from the recorded well logs and the calculated attributes generates models that substantially improve the lithofacies classification perfor- mance (e.g., XGB Case 3 with ~0.65 accuracy and ~0.75 accuracy in predicting lithofacies associated with oil pay). However, scope remains to further improve lithofacies prediction accuracy achieved by the attributed-enhanced models developed in this study. Three possible ways to do this are:

Expand the suite of well logs recorded across the reservoir sections in both cored and non-cored wellbores. This is not easily achieved retrospectively in wells already drilled and completed in a producing reservoir. Additional well logs that record physical properties of the reservoir sections, such as compressional-wave and shear wave-sonic logs, would add an additional dimensions and diversity to the existing four-log suite. One of the problems with the existing four log suite is that the GR0, Th0 and K0 log distributions are highly correlated resulting in a lack of diversity and contrast within the

Evaluate alternative well-log attributes calculated from the existing suite of well logs to determine whether they could further improve upon the lithofacies classification achieved by the derivative and volatility attributes calculated using the recorded GR0 and PB0 curves. Combined with the feature-selection optimization method applied in this study, such an approach offers the quickest and lowest cost approach to apply. Future studies are planned to evaluate other mathematical attributes of the sparse recorded well-log suite avail- able for the studied field, to determine if, together with recorded well logs and derivative and volatility attributes, they can further improve the lithofacies predictions.

Meandering, braided fluviatile depositional environments generate clastic reservoir formations that tend to lack laterally continuity of their sandstone and siltstone pay zones. This makes it difficult for lithofacies classification machine-learning (ML) models, supervised with available core and well-log data in a few wells, to reliably predict lithofacies in non-cored wellbores distributed across the entire field area. That prob- lem is heightened when only a small suite of well logs is recorded, and those recorded well logs are highly correlated with each other. The dataset evaluated consists of three cored wells drilled into such a reservoir system with only a spectral gamma ray log recorded in the field development wells. The available recorded log suite is restricted to the total gamma ray (GR), density (PB), Thorium (TH) and Potassium (K) spectral signals. To supplement the recorded well-log data six derivative and volatility attributes were calculated for each cored depth interval covered by the GR and PB curves. This generated a dataset of 1236 data records with sixteen log-derived features and four lithofacies classes verified by core analysis.

A novel feature-selection technique coupling multiple evolutionary optimization algorithms with a K-nearest neighbor (KNN) model, applied to the complete dataset, was able to identify several high- performing feature combinations. The best feature combinations uti- lized just seven to ten of the available features for lithofacies classifi- cation. Five feature-combination cases were evaluated in detail with seven ML algorithms. Case 0 involved just the four recorded well logs, Case 1 included all sixteen available features, Cases 2 and 4 both included nine different features, and Case 3 included just seven features. Two of the three wells (V and X) were used for ML model training and

model solutions. For Case 0, the feature importance ranking of the recorded logs was revealed as GR0>TH0>PB0>K0. For the best- performing model with attributes, XGB Case 3, the feature ranking was GR0>TH0>GR6>K0>GR5>PB2>PB6, highlighting the impor- tance both volatility and derivative attributes to that solution. The

Zhang, Y., Li, Y., Guo, W., Li, Y., Dang, H., 2020. Differential evolution and the influencing factors of low-maturity terrestrial shale with different types of kerogen: a case study of a Jurassic shale from the northern margin of Qaidam Basin,China. Int.

