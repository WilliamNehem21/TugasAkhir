Nowadays, the number of corona patients is increasing significantly. The relationship between the Internet of Medical Things (IoMT) and the Internet is struggling to keep up with this number of patients. The transmission of Patient Health Records (PHR) to the care of a patient through Internet plays an important role in the remote monitoring and fast detection of new contaminated patient with coronavirus. Moreover, it has generated sig- nificant security and privacy concerns for the global health care system due to tampering of control messages. This paper focuses on the application of blockchain and smart contract mechanisms to solve the shortcomings of the current health application and propose a new security schema based on context-aware CP-ABE. The proposed schema includes context-aware policies to achieve a robust authentication of identity and confidentiality of

people has achieved 2.5 million in September 2019. As the number of infected humans with the virus is continuously increasing, the rela- tionship between Internet of Medical Things (IoMT) and Internet is necessary to keep up with new infected patients. The transmission of Patient Health Records (PHR) to the care of a patient through Internet plays an important role in the remote monitoring and detection of new contaminated patient with coronavirus. It generated significant security and privacy concerns for the global health care system due to tampering of control messages.

their healthcare data should be also made available for use, which is becoming more and more necessary until it leads to untenable situations that may converge towards a complete blockage of the healthcare pro- cess. The Cloud plays a key role in the storage of unlimited medical information of patients and convenient transmission of sensitive data across different stockholders. Whereas, the data is gathered by the medical things (IoMT) and transmitted to Cloud for analyzing by various healthcare experts such as physicians, radiologists, and specialists. While the medical data are stored on the cloud, the latter can be exchanged across different cloud resources decision-making. However, an e-health system-based Cloud may raise several security challenges such as confidentially, privacy of patient data. Also, there are many problems facing Cloud-based systems like overhead communicate se- curity problems in reason of network access misuse using hackers access nodes. Meantime, blockchain can be represented as a portion of the implementation layer of a distributed e-health system. By using block- chain, the integrity of the data in distributed e-health systems can be accomplished and maintained [1].

the last few years and it makes a real revolution in the financial sector. In addition, it started to include different fields like healthcare, supply chain, and many fields. Blockchain technology enables to provide cryptographically validated transactions and data, which are not under the control of any third-party organization [2]. In general, blockchain technology has a key advantage of decentralization, persistency, ano- nymity, and audibility. With these features, it can save costs greatly and develop efficiency [3]. In this work, we will apply blockchain technol- ogy and cryptography techniques to ensure security and privacy of healthcare data without needing a third party to control it. The appli- cation of blockchain enables the hospitals or clinics to access a specific

The paper is organized as follows. Detailed related work is repre- sented in Section 2. Section 3 gives an overview of the ontology model. The proposed schema in Section 4. Implementation details and experi- mental results are given in Section 5. The conclusion and some per- spectives are illustrated in Section 6.

For that reason, a new authentication technique based-secure communication in the mobile Cloud has been proposed by Jegadeesan et al. [6] to protect the control access of mobile users to the Cloud ser- vices. The technique is based on mutual verification between users and Cloud providers where both sides need to provide their legitimacy to each other. Due to the limited storage capacity of mobile devices, mobile users are not able to store the huge details of Cloud services anony- mously. Therefore, the technique exchanges only session keys once the successful authentication of mobile users to Cloud services occurs which decreases the computational cost. The technique uses a third party known as Trusted Third Party (TTP) to send private keys and public keys for both users and service providers to ensure registration and the authentication phases. The legitimacy of both components is checked via the hashing and cryptographic methods. This approach does not incorporate environmental attributes.

review of the security problems that affect the implementation of Blockchain in sustainable smart cities. Incorporating the Blockchain and artificial intelligence in the smart society concept opens new security suggestions such as the protection of privacy. Moreover, encryption methods are not sufficient to ensure the protection of security and pri- vacy of the nodes, like hash functions necessitate an improvement by using intelligent search techniques and algorithms. However, it remains a limitation for role explosion problem to provide fine-grained access control.

Neural Networks to ensure secure access control in digital healthcare system. For instance, Ali et al. [21] ensures a secure search and keywords-based access to the database using neural network with ho- momorphic encryption and blockchain technology. The work provides more security and less computational cost, which was characterized by a homomorphic encryption method and neural network. Another approach has applied deep learning and blockchain to process IoT data in health field [22] giving a prediction rate of 99%. Furthermore, Ben Daoud [23] has applied a secure and intelligent method for IoT-Fog Environments that persist network attacks.

Attribute-Based Encryption (ABE) is a recent approach that uses Public-Key (PK) cryptography [3; 15]. It can be flexible for systems with large-scale applications that use one-to-many encryption messages based on attributes such as roles and context. ABE is becoming func- tional encryption and Identity-Based Encryption (IBE) in cryptography. The access control must respect a set of policies that are defined over a set of attribute values (Ciphertext-Policy ABE: CP-ABE). The ABE secu- rity model is based on the following phases:

and the ability to exploit and react to environmental changes. To improve the efficiency of the control process, attribute-based access control is being used, with the goal of applying and integrating contextual data to detect authorized users of cloud resources. More specifically, To address the role explosion problem and provide exact results, the proposed scheme leverages features of the contexts at the session for role activation, where users may be assigned to one or more roles and only one role may be active.

With the increased use of public communication networks, security and privacy have become major concern in healthcare. Cryptography is the practice and study of secure communications techniques. Encrypting health information is the essential strategy in cryptography when it comes to patient history details. In recent years, a large number of encryption algorithms have been proposed, but the majority of these algorithms have high computational overhead and are no longer suffi- cient to recent attacks. Thus, we need to propose robust low-cost encryption-decryption schemes for IoMT. The next section will focus on our proposal in context-aware attributes based access control, IoMT and blockchain technology in health system.

Blockchain technology was applied in the proposed architecture. We have developed key information that is stored in the blockchain in the proposed smart contract. The smart contract includes fields of ID (the account identity), transaction detail, certificate, and timestamp. This information is highly encrypted and can only be accessed with the authorization of the data owner, thereby ensuring data security and personal privacy using the following two main transactions:

Second Scenario. When a patient wants to delegate his right access to another physics specialty from another hospital, a notification is sent to the proxy/Fog component and the access policy is dynamically updated. Of course, his access policy will be updated to include envi- ronmental attributes (e.g., orthopedic department, resource-department

Using context-aware CP-ABE, the new encrypted PHR can be decrypted only by the physics of the orthopedic department that he can find useful in his working domain. All this while he can always check the state of his health (e.g., if it is orthopedic problem, then deploy vitamin D service).

AVISPA is a formal security verification technique for the automatic authentication of cryptographic protocols and applications [18]. AVI- SPA simulator will be used to analyze security for the patient and proxy/fog registration and phases of the proposed schema. Through AVISPA, the symmetrical schema demonstrates that it is secure. The security model is specified and proved [20] as follows:

classifiers on a real dataset based on two different metrics: stability and total execution time. All experiments have been performed on a PC with Intel Core i5 2.67 GHz, with 4 GB of RAM, 250 GB hard disk and window 7 (64 bits) using Eclipse java platform and BSWABE [17] java library.

hyperthyroidism, blood pressure) and permits the context-aware access control process to be simulated. The number of access control policies and health attributes is varied in each execution. Thus, we can simulate the scalability and execution time experiments for a different number of attributes.

In this paper, we presented the IoMT-Fog-Cloud architecture of health systems to secure e-health applications by exchanging data confidentially and protecting patient privacy. We presented also a new extension of CP-ABE algorithm known as Context-aware Ciphertext- Policy ABE (Cx-CP-ABE) which integrates the Blockchain and context- awareness to enhance security at the level of data access control man- agement. Besides, our proposal ensures integrity and keeps track of data sharing. After several conducted experiments, we demonstrated the Cx-

