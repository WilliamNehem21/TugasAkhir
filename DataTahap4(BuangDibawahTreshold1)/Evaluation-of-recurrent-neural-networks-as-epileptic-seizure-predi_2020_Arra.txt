several cases within the database. Then clusterization of cases in groups is proposed in order to improve the training and evaluation of the ANN, alongside a channel reduction aimed to decrease the computational load of the algorithm. After the data sets are structured, feature extraction techniques are proposed, using temporal and spectral analysis like Standard Deviation and Short Time Fourier Transform (STFT). The pre-processing of data includes the proposal of two techniques to improve the ANN accuracy, being those of the data superposition tech- nique and the anticipation of target data, both for the training phase of the algorithm. Finally, the LSTM network is developed, using two structures due to the techniques proposed, and its performance is analyzed by the training accuracy, and the sensitivity (true-positive rate) and specificity (true-negative rate) of the predictions.

Given the objective of developing an RNN for pre-ictal segments categorization, the network structure and feature extraction aim to capture the most significant mathematical patterns that can yield high classification accuracy. The proposal for this method is presented in Fig. 1.

The method starts by selecting and grouping patients based on the number of epileptic events presented in the recordings, then only EEG channels common to all recordings are maintained and the data entries containing epileptic events are added in a target column vector. The data pre-processing step starts with channel reduction to less than a quarter of the channels selected, followed by the extraction of 5 temporal and spectral features, just as data normalization and target encoding. The last proposed technique consists of the proposal of two data manipulation techniques - input signals superposition and anticipation of target values, both for training data. Finally, considering the two techniques proposed, two RNN structures are created to test the accuracy, sensitivity, and specificity in identifying pre-ictal regions.

instead of the acquisition of such signals, an open database was chosen for this work. The database selected was obtained from Ref. [9,10], which consists of scalp EEG data of 22 children with intractable epileptic seizures, gathered by a group of Massachusetts Institute of Technology and Children’s Hospital Boston professionals. Each record was obtained using the 10–20 International System for electrodes, using 256 samples per second with a 16 bits ADC, being the values recorded in microvolts. These records were labeled using information about the time of occur- rence of epileptic events, in such a way that each entry had a new column indicating if a seizure was occurring at the time of data capturing or not. The recordings displayed a different series of channels, so the more frequent channels present in the recordings were selected, resulting in FP1-F7, F7-T7, T7-P7, P7-O1, FP1-F3, F3-C3, C3-P3, P3-O1, FZ-CZ, CZ-

Among previous works [12], obtained less than 10% of the variation in sensitivity and specificity when using only the C3-C4 channel, in comparison with the results when using all 11 available EEG channels. [13], which used the same database as the present work, applied the Decision Trees algorithm to identify EEG channels with a greater contribution in correct seizure classification, identifying the channels FZ-CZ, F3-C3, and P3-O1 as the most relevant channels for classification, although pointing out that it was a patient-specific result. Also using the Physionet Database [14], evaluated the performance of using from 2 to 6 out of 22 channels. Initially, a 60% accuracy was obtained when using 22 channels; with 5–6 channels, the accuracy increased to 70%; finally, with 3–4 channels, the accuracy was the same as with 22 channels.

As seen in Fig. 3, there are abrupt temporal and spectral variations in imminence and the occurrence of epileptic events (highlighted by white rectangles superimposed to the graph). Similar variations occur in other sections without epileptic events, such as right after 500 and 3000 s, indicating at first that there is no coherent pattern variations in epileptic events, but it should be considered that not only the frequency pattern characterizes the regions of interest, but rather a set of characteristics considered simultaneously in ANN training.

pre-ictal and ictal regions, a more detailed view of the spectral compo- nents in such regions is shown in Fig. 4, using the same case as Fig. 3, regarding the analysis of the F7-T7 channel along with the untreated EEG signal of the four channels selected for analysis.

Analyzing the EEG signals shape, it’s possible to notice that there are many sparse peaks over time, with these peaks correlating with specific cognitive activities as well as with epileptic events, as analyzed by Ref. [15]. Given the characteristic of constant variation in amplitude and presence of peaks, in the present work is taken into consideration tem- poral characteristics such as Root Mean Square (RMS), standard devia- tion, and the number of peaks observed above a certain threshold.

The threshold used for peak counting was 80% of the maximum signal amplitude for each EEG channel used, considering the entire patient re- cord being analyzed. This threshold was obtained in preliminary tests by varying the threshold from 50 to 90%, looking for a value that could better represent visually distinctive peaks, but minimizing the detection of local maxima. All observations in a time frame of 1 s were summed, then this sum was replicated for all samples in the second in question, being 256 samples due to the sample rate of 256 Hz.

After the data normalization, the targets are encoded in such a way that the ANN can easily process the data. This is done by categorizing values that are originally zeros and ones into an array, by using the one- hot encoding process. The outcome of the encoding process is that each set of data entry have a target represented by a two columns array, specifying if an epileptic is occurring or not in that sample.

After the manipulations described, the data is resized in batches, as seen in Fig. 5. A set of N inputs is divided in B batches, having each batch T observations or inputs, being B the rate between the total number on inputs N of the data set and the number of observations T, which can also be seen as time steps. Finally, the target A is divided in Ta time steps in the same fashion as N inputs to T time steps.

In this work it was chosen to use 1-s batches, that is, 256 observations per batch, since the EEG acquisition rate is 256 Hz, totaling 3600 batches per EEG file. Lower batches of 0.5 and 0.25 s, as well as bigger batches as 2–5 s, were tested; the outcome showed that batch size presents a trade- off between computational load and generalization error, in such a way that higher batches significantly increased the computational load with some improvement in accuracy. The value of 1 s showed a reasonable memory consumption while achieving good results in comparison with larger batches.

One approach to try to anticipate predictions of epileptic events is to overlay the data by replicating it with the segmentation technique named sliding windows. The technique registers a window of data W, then move it forward by S steps/inputs and adds this new data window to the first one, and so on. It is noted in the Fig. 6 the superposed signal (lower half) from three windows applied in the original signal (upper half), in which the windows height, just as the vertical displacement of the signals, are altered for better visualization.

It is empirically defined in the present work the use of 1 s windows (256 entries) and 0.5 s steps (128 inputs), i.e. 50 % overlap, expanding the training set to double of its original extension. Thus it is intended that the ANN be exposed more than once to various data. A consequence of

In conjunction with data overlapping, it is applied an approach where the target values are anticipated, based on [25], which applies to a partial data set the target verified at the end of the set. The anticipation is made by shifting the target values to earlier positions in time in such a way to move the positive targets (which indicate the incidence of an epileptic event) to the pre-ictal sections. The target offset can be seen in Fig. 7, where Fig. 7a shows the original signal and Fig. 7b shows the result of the offset.

The developed network processes such input data using several LSTM cell layers. In the present work, the configuration developed has three LSTM network layers and one output layer. The first two LSTM layers have 30 cells, returning one output at each input, configuring an archi- tecture of multiple inputs to multiple outputs. In addition, these first two layers pass to each subsequent batch the internal states computed in the last batch. The third layer has 4 cells, being this is a random value chosen by the error minimization criterion. This layer returns an output only after analyzing all observations in a batch, having a structure of multiple inputs to one output, and maintains the procedure of passing internal states to subsequent batches.

Finally, there is a layer with 2 neurons and the Softmax activation function, which actually calculates the probability that the processed sequence belongs to each of the present classes. The diagram of the developed LSTM network can be seen in Fig. 8a, where the data stream of a batch is represented. Because ANN performs the classification of which class should belong to the analyzed sequence, the loss function used is Categorical Cross Entropy.

Fig. 6. Input data overlay (upper signal) achieved by applying sliding windows of size W and step S, obtaining an overlapped signal (lower signal). Different dashes indicate different windows. The procedure is used in training sets to anticipate predictions of epileptic events.

The diagram shown in Fig. 8a corresponds to the general architecture used when there is no data overlap. However, when using an overlay, the input format of the first LSTM layer is changed to receive any number of batches so that the data length is longer in training and of normal size in tests. For this, the second layer of 30 neurons that received sequences of defined size was removed, because the matrix sequence has a variable size, as seen in Fig. 8b. In addition, the internal states computed in the last batch are no longer passed to each subsequent batch due to the same change in network architecture to accept any number of batches.

Once the ANN is trained, it is necessary to evaluate the results generated by it against new data. ANN’s performance evaluation metric is based on detecting signals such as pulses or detection windows be- tween 5 and 60 s before an epileptic event occurs, being these values are arbitrated as a near period to the epileptic event but with certain ante- cedence, so that it is possible to take the necessary actions by epileptic patients or related individuals. Other detection time values are also evaluated in a summarized manner (as per analysis presented in the Results chapter).

Fig. 8. Diagram of the ANN LSTM developed for categorical classification of EEG temporal signals between inter-ictal and pre-ictal. Datastream representation for a single batch. The number in each layer indicates the number of cells or neurons: (a) general architecture diagram and (b) architecture diagram for data superposition.

Once the network performance is evaluated, the results of epileptic events detection are evaluated. The results obtained with the developed ANN LSTM did not present in any of the tests the detection of anticipated epileptic events with consistent patterns between files, or without the presence of several other similar detections preceding the supposed early detection, even when using several different anticipation periods. It was considered for this analysis the detection metric established within 5–60 s prior to an epileptic event, that is, the period considered pre-ictal.

Although early detection of epileptic events did not achieve signifi- cant results through the tests, the predictions obtained demonstrated that the LSTM structure acted as a classifier, analyzing data sequences and predicting for a set of tests the precise periods of occurrence of epileptic events. Examples of unanticipated prediction can be seen in Fig. 9.

In Fig. 9a, from group 1 of patients, the correct prediction is observed in practically every window of occurrence of the epileptic event to the right of the figure. Earlier in the same figure one can also observe erro- neous predictions. Fig. 9b shows that the same result is observed in other training and testing groups, which is an example of group 3. In both figures, the ANN’s accuracy in classifying epileptic events is evident, even if there are small sections within the event window where the rating fluctuates.

Fig. 9. Examples of unanticipated predictions, both files analyzed present epileptic events at the end. Although predictions weren’t classified in advance, they correctly indicate the occurrence of epileptic events. Presence of false-positives: (a) at the beginning of the file belonging to group 1 and (b) at the end of the file belonging to group 3, immediately after the epileptic event.

Using the ANN shown in Fig. 8, using the basic structure, the confu- sion matrices shown in Fig. 10 were obtained, relating the sensitivities and specificities in the classification of epileptic events for each of the four training groups, that is, determination of ictal periods.

The results show that the classification of ictal periods did not present a good rate of true-positives, resulting in an average sensitivity of 14.3% for the 1494 ictal segments for all four groups, and a maximum sensitivity of 45.5% for group 3. There are partial detections of the periods for half of the groups, except for groups 2 and 4 that did not present any correct answers. However, it should be considered that there were detections within peak event windows in the form of spikes or smaller windows. An example of the detections can be seen in Fig. 11, which shows an example of detection for group 1.

Analyzing the results shown in Table 4, it can be seen that the sensitivity of ANN increased with the use of data superposition technique when compared to the basic structure, resulting in an average sensitivity of 19.9% for the total of 1494 ictal segments for all four groups, and a maximum of 61.3% for group 3. This shows that this technique attenu- ates the occurrence of false-negatives. However, the false-positive rate increases too, as seen in Fig. 12, which shows the results for groups 1 and 3.

In Fig. 12a there is an epileptic event between 3000 and 3500 s, overlapped by several detection peaks, in which it can be seen that ANN correctly identifies this segment, resulting in a higher sensitivity compared to the basic training structure. Fig. 12b shows a similar result for group 1, with a high concentration of detection peaks during the epileptic event.

In addition to the test performed with the previously described methodology, a brief test was also performed to compare with a different overlapping window and step value from those originally proposed. Instead of 1-s overlap windows with half-second steps, the parameters used for data overlap were halved then doubled, that is, a 0.5-s window with 0.25-s steps and 2-s windows with 1-s steps. Using training group 1 only, the results shown in Table 5 were obtained.

Although training targets were anticipated by 5 s before an epileptic event, with a value of 1 being set for targets, sensitivity improved by 1.60% for group 1 and worsened by 5.30% for group 3, that is, there was no consistent improvement in results. Other than that, ANN’s hit rate and specificity worsened for virtually all training groups. This result dem- onstrates that for the ANN structure and configurations proposed in the present work the anticipation of targets tends to show a slight worsening of results, or at best a small increase in sensitivity.

arbitrarily chosen in the present methodology was not optimal and that this value does not appear to have a local maximum either. Using a similar target anticipation technique [25], was able to anticipate facial movement predictions, obtained by monitoring with a camera. However, although the present ANN architecture differs from the architecture proposed by Ref. [25], the principle of data anticipation training is the same.

As with target anticipation techniques without overlapping data, there was no consistent increase in sensitivity. Despite the improvement of sensitivity of 16.9% for group 1, there was a worsening of 16.3% for group 3, characterizing a strong dependence on performance with the patient analyzed.

Although data overlap resulted in higher sensitivity for groups 1 and 3, remembering that for the other groups the sensitivity was null, the results followed the pattern observed in the anticipation of targets. Compared to the basic structure, sensitivities are better for group 1 and worse for group 3. This shows that for the ANN structure and techniques proposed in this paper, the use of target anticipation is not good. Consistent results for prediction sensitivity also show the same behaviors when used in conjunction with other techniques.

This work reached a maximum percentage of 8.33% and 61.3% of anticipated seizures onset detection and epileptic events classification, respectively. It is important to consider for this comparison that the present development used an extensive database and a combination of data from several patients, to generalize all scenarios present in the database as much as possible. Ideally, this combination of factors would make the ANN apprehend the generalization of pre-ictal segments; however, results show a model difficulty in learning the variety of EEG patterns for so many patients.

When comparing the results with works such as [19], which showed sensitivity around 98% in the classification of ictal regions, inter-ictal and pre-ictal with SVM classifier, it can be noticed that the result ob- tained with the present ANN LSTM is less satisfactory as it reaches a maximum of 61.3% sensitivity (using the data superposition). However, it must be considered that, as cited by Refs. [19], the database of such previous work was relatively small, being about 30 times smaller in time of recordings in comparison to the database used in this work, with 3.28 h of data versus 101 h of the files used in the present work. When analyzing a shorter data set, there is less probability of facing specific seizure scenarios with particular patterns that differ from others. Even with the present considerations, it is interesting to notice the use of

Fig. 12. Example of data overlapping results for groups 1 and 3. There is an epileptic event occurring at the end of each file, where there are many detection peaks. Sensitivity has good results over specificity, a result evinced by many false-positives. Epileptic events are marked by arrows for better identification.

The work of [20] adopted the same database as in this development, aiming to classify epileptic events by using the Extreme Learning tech- nique. The temporal and spectral characteristics have similarities, although the final results differ widely, with the work cited reaching 95% of correct classifications. The authors used only one EEG channel from the 3 patients selected, contrasting with the present research, which used 4 EEG channels from 10 different patients, resulting in 5 times more data. Therefore, it is again considered that the referred work may have been

In [26], the authors used the same database as this work to implement seizure prediction using LSTM with patient-specific analysis; the work achieved over 99% sensitivity and specificity, and 0.11 false positives per hour when evaluating pre-ictal segments of 15 min before seizures. Some significant differences between the present work and [26] remain in the signal segmentation, class imbalance approach and time window used to asses the performance of anticipated predictions.

The authors in Ref. [26] divided the data into segments of 5 s each, instead of 1 s, resulting in less segmentation and possibly leading to better feature extraction at the cost of higher computational load. The class imbalance was solved by extracting random inter-ictal results with the same size of pre-ictal segments, creating balanced segments. The main difference remains in the pre-ictal window size used for metrics. The current work evaluated early predictions from 5 to 60 to 5–240 s, while [27] windows ranged from 15 to 120 min, a window eight times larger. This larger window drastically changes the results; therefore, a strict direct performance comparison is not possible. The authors compared their work with other studies that used windows of at least 5 min, being all windows at least two times wider than the ones used in this work.

It was possible to verify a strong dependence on the proposed tech- nique with the patient and their EEG patterns, suggesting that it may be not possible to obtain EEG patterns generalization for several patients in a single ANN model. This strong dependency was especially visible in sensitivity results. Considering this, it is suggested that such models be first trained and tested with only one patient, then generalized with the combination of other patients. It was possible to verify a strong depen- dence on the proposed technique with the patient and their EEG patterns, suggesting that it may be not possible to obtain EEG patterns general- ization for several patients in a single ANN model. This strong de- pendency was especially visible in sensitivity results. Considering this, it is suggested that such models be first trained and tested with only one patient, then generalized with the combination of other patients.

The directions of future research would be to experiment with the combination of other features, using Multivariate Discriminant Analysis to find resulting features that have a greater correlation with pre-ictal periods. The combination of different features can result in dimension- ality reduction and eventual elimination of redundant features for training. Experimentation with larger databases and Deep Learning structures, using only raw EEG data, could result in a model with a low number of EEG channels, in case significant features are successfully extracted by the deep learning model. It is also suggested to test similar EEG databases, compare results, and further analyze the ANN generalization.

