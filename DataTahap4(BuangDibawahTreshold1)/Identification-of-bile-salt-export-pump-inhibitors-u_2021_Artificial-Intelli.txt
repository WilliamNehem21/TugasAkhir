gin, defined as IC50/Cmax in plasma, and used in risk assessment in later discovery phases [4]. The pre-clinical safety (PCS) department at Novar- tis monitors the BSEP safety margin. Low BSEP safety margin relates to higher risk of serious DILI, and conversely. At early stages when expo-

tant practical limitation is that compounds falling into the intermediate activity range were excluded, which simplifies the modeling task [13]. In a recent study, McLoughlin et al. reported an extensive benchmark of predictive models for BSEP inhibition using 1149 compounds [14]. Authors evaluated over 15,500 models using different algorithms, hy- perparameters, descriptors, and data splitting approaches, e.g., random and scaffold-based. Superiority of deep learning methods was not ob- served, and the preferred approach was RF with Molecular Operating Environment (MOE) descriptors, similar to Montanari et al. [13,14].

The in-house BSEP assay measures [3H]taurocholate uptake by in- verted vesicles prepared from HEK293 cells over-expressing human re- combinant BSEP (hrBSEP) [18]. BSEP inhibition is quantified with the half-maximal inhibitory concentration (IC50). In vitro BSEP data was as- sembled and pre-processed. Measurements without associated structure or report date were discarded, and salts were removed. The data set con-

Compounds were represented using RDKit 2D descriptors and/or Morgan fingerprints (MFP) [19]. Descriptor vectors had a length of 200 (RDKit version 2019.03.3) [20] and included molecular weight, calcu- lated LogP, topological polar surface area, number of hydrogen donors and acceptors, count of specific substructures, among others. MFP is a hashed fingerprint that encodes circular atom environments up to a given diameter. Herein, the count version of MFP was utilized, where the number of occurrences of a given atom environment or substructure is encoded. MFP had a length of 2048 with radius 2.

Training and test sets were generated according to the measurement date. For classification models, training (60%), calibration (15%), and validation (25%) sets were considered. Models were initially built with the training set and evaluated on the calibration set. Prediction reliabil- ity was assessed using output probabilities from binary ML classifiers. High and low probabilities were used to classify compounds into in- hibitors and non-inhibitors, respectively. For probabilities associated to lower confidence (closer to the decision boundary), predictions were set to inconclusive. After model optimization and selection, the final model was retrained using 75% of the data, and performance was estimated on the external validation set, which consisted of the most recent BSEP experiments. For regression models, more time-split scenarios were con- sidered with different proportions of training and test data: (i) 75/25%,

ML methods were applied for classification and regression models. Linear regression methods included Partial least squares (PLS) [21] and Lasso regression [22]. PLS reduces feature dimensionality focusing on covariance, prior to a linear regression model. PLS is applicable to mul- ticollinear features. Lasso regression utilizes shrinkage or L1 regulariza- tion and generates sparser models by adding a penalty to rely on less pa- rameters. Non-linear support vector regression (SVR) [23] with a radial basis function was also applied. SVR is an extension of support vector machines (SVM). SVR maps data into a higher dimensional space and

Classification methods comparison. Binary classification performance for models based on 2D descriptors and/or MFP, and tree-ensembles (ExtraTrees, RF, XGB) or k-NN. Reported are the AUC, MCC, and BA for all calibration set compounds and for reliable/conclusive predictions only. The percentage of inconclusive predictions is also shown.

learning rate (0.01, 0.1, 0.2), maximum depth (6, 12), subsample (0.1, 0.3) hyperparameters were optimized. The optimized XGB model with 2D descriptors and MFP used 500 decision trees, a learning rate of 0.01, maximum depth of 12, and a subsample of 0.3.

[30] definition. The number of scaffolds and compounds per scaffold were calculated and statistics showed that there is a high percentage of singletons in the data set and only few large clusters, in particular 14 (4) clusters with at least 10 (20) compounds. From the external validation set compounds, 88% contained BMSs that were not contained in com- pounds from the training and calibration sets. As an alternative way of

training data or from the same chemical series (scaffolds). Moreover, permutation tests [32] were carried out to assess the significance of ob- tained results. XGB binary classification models were built with shuf- fled labels and the performance was assessed in independent trials. The model trained on data with random labels had a mean AUC of 0.55 and BA of 50%, and did not achieve the performance of the model based on

precision in the prediction of BSEP inhibitors. When the model flags a compound as a BSEP inhibitor, there is a high probability that this is correct. Moreover, the model is generally applicable since it has been prospectively evaluated on a relatively large and representative set of compounds, which includes different chemical series.

assessment analysis nor a medium class. Despite being trained on pub- lic or external data sources, promising results were obtained for AD- MET Predictor and eTRANSAFE models. Nevertheless, the in-house XGB model reached higher performance than these models, regardless of the applied thresholds for the definition of inhibitors and non-inhibitors. When only conclusive predictions were considered, performance differ- ences substantially increased. Higher PPV, NPV, MCC, and BA values were obtained for all comparisons. PPV and NPV values for the in-house model reflect the high utility of the model in practical applications since predictions are very likely to be true, particularly 89% and 84% for in- hibitors and non-inhibitors, respectively.

The trade-off between training and test set splitting is a classical is- sue in ML. More training data generally implies a better model and, de- pending on the data composition, might lead to higher accuracy or less variance [36]. Similarly, more test or validation compounds improve performance estimation, which is critical to assess the generalization ability of a ML model. Herein, SVR models were evaluated at different points in time with the data not used for model training.

scale. Since a single hold-out set might lead to over/under-optimistic es- timation of predictive performance, a representative prospective test set and the consideration of both long and short-term validation (i.e. multi- ple splits) were essential to assess SVR generalization ability in scenarios that resemble future model usage.

Despite deviations from measured values, Spearman rank correla- tion values ranged between 0.74 and 0.78. Current literature strate- gies for reducing BSEP inhibition focus on modifications of molecular weight and lipophilicity. However, the Spearman rank correlation be- tween these properties and BSEP inhibition ranged from 0.56 to 0.61, being slightly lower for LogP. These results suggest that ML models pro- vide a better ranking and more effective guidance for compound modi- fications than considering these two properties individually.

Herein, ML classification and regression models were generated for the prediction of BSEP inhibition, an important DILI risk factor. ML mod- els can make predictions for any compound, even prior to synthesis, solely from chemical structure. This provides a valuable opportunity. However, robust model building and evaluation are key for supporting correct decisions in pharmaceutical industry. A predictive safety model- ing work has been reported from a practical drug discovery perspective, focusing on the importance of defined classification categories and ML set-up, which greatly influence the quality of ML-based decisions.

Taken together, ML-based predictions can be used as an additional factor providing decision support when progressing compounds during early stages of drug discovery and in vitro experiment prioritization. In vitro experiments can be limited to those compounds for which models do not give reliable predictions and the most promising compounds for which a numerical value is preferred. Even at discovery phases when safety or liver toxicity are still not being considered, BSEP classification predictions are made available, which helps to de-risk compounds or series at early stages.

