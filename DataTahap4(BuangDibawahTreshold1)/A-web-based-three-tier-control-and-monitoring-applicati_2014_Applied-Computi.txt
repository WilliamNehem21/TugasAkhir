Abstract The architecture of a control system can be designed vertically with the distinction between functional levels. We adopt this layered approach for the design and implementation of a network-based control and monitoring appli- cation. In this paper we present the design and implementation of a network- based management application for controlling and monitoring the input and output data of remote equipment aiming at performance macro-observation, alarm detection, handling operation failures, installation security, access control, collection and recording of statistical data and provisioning of reports. The main services provided to the user and operating over the public internet and/or mobile network include control, monitoring, notification, reporting and data export. Our proposed system consists of a front-end for field (site-level) control and monitoring as well as a service back-end which undertakes to collect, store

and manage data from all remote installations. Hierarchical data acquisition methodology and performance macro-observation are according to the IEC 61724 standard. We have successfully used our control and monitoring applica- tion for integrated facility management of photovoltaic plant installations; nev- ertheless it can be easily migrated to other renewable energy generation installations and remote automation applications in general.

The rest of the paper is organized as follows. The automation system architec- ture is presented in Section 2. The main control and automation services provided are described in Section 3. A description of the solar park installation, the moni- tored signals and implemented alarms follow in Section 4. Section 5 illustrates the implemented services via the application screenshots, while Section 6 presents the technology used to build the proposed application and the database schema.

The middle level is the Data Center which communicates through a public and/ or private network with the bottom level. It is also known as automation level. Its role is to monitor and control all installations in a centralized manner. The main part of the Data Center is the service back end, which undertakes to collect, store and manage data from all remote installations. More specifically, the service back end has the following responsibilities:

The back-end is scalable to accommodate any number of measurement points merely through the addition of new servers and storage subsystems. The service back-end can also provide external interfaces to other software entities, depending on the customer needs. The service back-end has been designed to provide inter- operation with a variety of third-party controllers and PLCs. For this reason, an independent module, denoted as the Communications Adapter Module (CAM) in the ensuing, has been implemented, which undertakes the task of acquiring data from the remote installation and feeding them to the service back-end as well as conveying data from the service back-end to the remote site. Multiple CAMs are supported. The service back-end also incorporates an Appli- cation Logic Module (the ALM), which calculates the derived parameters. This module can be extended at will with new calculation functions. Other service back-end modules include the Notification Server Module (NSM), which under- takes the notification of the PV management solution users via SMS or e-mail as well as the Reporting Server Module (RSM), which handles the generation and delivery of reports. All necessary data are stored in a database.

The top level is the management level. At this level, information from the entire system is accessible. The PV management solution includes a front-end, capable of operation with a standard Web browser (Internet explorer, Mozilla Firefox or Google Chrome). A unified interface is presented to the operator and end-users

for manual intervention in the system. It provides vertical access to the values of the automation level, including the modification of parameters such as timetables. Alarms are generated for exceptional situations such as technical errors or critical conditions. The long-term storage of historical data with the ability to give com- mands for reports and statistics is also part of this level.

Primary parameters: Primary parameters are calculated as the time-series aver- age of real-time data after a certain set of validations have been applied. The span of this average (the recording period) has to be an integer sub-multiple or multiple of an hour. The PV management solution supports any recording interval, though it has to be the same for the whole of a single installation. Daily, monthly and yearly averaged values are also supported for each primary parameter separately. Data acquisition and the calculation of primary parame- ters are considered to be carried out by field-deployed controllers in order to reduce the data that are conveyed to the service back-end and minimize band- width requirements.

Derived parameters: Derived parameters are calculated using a specific mathe- matic formula which operates on a specific set of values or vectors of values of primary (and/or other derived) parameters. The PV management solution provides the infrastructure that is necessary to carry out all derived parameter calculations in the service back-end so as to further minimize the necessary bandwidth and storage at the remote site. In the case that derived parameters are calculated in the field, they can be considered as primary parameters within the service back-end. Daily, monthly and yearly values are supported for each derived parameter separately.

Each parameter sample and event are collected, stored and visualized with their acquisition time-stamp and engineering unit. Primary and derived parameters as well as raw real-time data are collected from the field based on a time schedule, aligned with the recording period. Status-change events are collected upon their occurrence and real-time monitored data upon user request.

The PV management solution records and presents to the user the current status of entities that are either internal or external to the solution. The status is consid- ered to be a powerful tool in terms of the user getting an immediate grasp on whether any entity of the installation being monitored or even the PV management solution itself operate properly or not. Status information actually encodes the severity of the condition of each entity independently, which is a number on a scale from 0 (everything normal) to 100 (complete disaster). The status update mecha- nism shall become apparent in the ensuing.

Apart from status information, the PV management solution also supports an arbitrary number of state-sets per entity. Each state set encodes a set of states, which are mutually exclusive, i.e. the entity can be found in only one of them. Each state of each state set also has a preset severity level associated with it. Changes among states are triggered by state-change events, which are either directly gener- ated by sensors and equipment connected to the PV management solution (pri- mary events), or by the PV management solution itself (derived events). The PV management solution provides all means necessary for the user to acknowledge (validate) that he/she has been notified on any specific state-change event and

has taken appropriate actions. This acknowledgement is a simple form of book- keeping of user actions for further investigation. Each state-change event is stored and presented to the user per state set with a list of data, including the entity gen- erating the event, the state the event led to in a descriptive form, the event date/ time in the timezone of the installation, the date/time of the reception of the event in the timezone of the installation, and the event acknowledgment status and acknowledgment text.

Since all entities are organized in a hierarchical structure, the current status of a certain entity cannot depend solely on the state (or states) it is into, but the sta- tuses of all underlying entities within the hierarchy are used as well. This is a basic concept within the PV management solution, since it enables the efficient notifica- tion of the user if something calls for his/her attention. Moreover, this hierarchical status propagation, as it will be denoted in the ensuing, can help the user realize the effect that an entity being in a certain state of a certain state set has on the operation of the installation as a whole.

The status of each entity of the installation hierarchy is always equal to the maximum severity of the states of all underlying entities at any given point in time. The statuses of all involved entities are presented to the user in an easily under- standable form (e.g. color encoding, based on a set of severity thresholds) so that his/her attention is drawn not only to a specific event but also to the effect it has on the operation of the whole installation. The approach is further clarified through Fig. 4, presenting an exemplary hierarchy with the related statuses and state-sets for each node. The related severities are also depicted, so that the hier- archical status propagation is apparent.

The main duty of the PV management solution is to provide, in a timely and con- cise manner, information to its user on the operation of a group of remote sites. As far as the monitoring service is concerned, the flow of data through the solution architecture is presented in Fig. 5. The CAM retrieves information necessary for the addressing of data items within the site-level control/monitoring system from the service back-end. It then connects to the field-deployed equipment based on a schedule, collects the necessary data and submits them to the service back-end,

which caches them in case some other module requests them and writes them to the database. The ALM retrieves the necessary primary data to calculate the derived values, also based on a schedule and submits the results to the service back-end, which again caches and stores them in the database. The remaining software modules (the Graphical User Interface, the Reporting Server Module and the Notification Server Module) connect to the back-end, either in a scheduled manner or upon user request and collect data in order to depict them or use them in reports or notifications.

The PV management solution allows the user to issue commands toward the equipment within the installation or the solution itself. This functionality is imple- mented through the notion of settings, whose values are considered constant from the time they are set until they are reset. Each setting event is stored and visualized with its timestamp and engineering unit. A user-inserted comment is also stored. The user is notified whether his/her action has been successful or not as well as whether it has been applied yet. As far as the control service is concerned, the flow of data through the solution architecture is presented in Fig. 6. A control

command is issued via the GUI toward the service back-end. This software mod- ule stores the command to the database and forwards it to the CAM, which retrieves information necessary for the addressing of the controls within the site-level control/monitoring system from the service back-end. It then connects to the field-deployed equipment and propagates the command. At all times, the user is notified via the GUI on the progress of the command he/she has issued.

The Notification service informs the user on the occurrence of critical events. Notification is via emails (internet gateway) or SMS (SMS gateway). The gener- ation of such notifications is not triggered by individual state-change events but rather by the status changes of each node of the hierarchy which is affected by them. More specifically, if the severity of the status goes above a certain user con- figurable threshold and remains there for a preset period of time, a notification is generated to alert the user. Additionally, if the status falls below the same thresh- old, another notification is generated in order to notify the user on the expiration of the criticality. The user is capable of subscribing to the status changes of and configuring the severity thresholds for each hierarchy node separately. It is understandable that if he/she, depending on the subscription he/she has config- ured, may receive multiple notifications upon occurrence of the same event or set of events affecting the statuses of a certain set of nodes in the hierarchy. Moreover, the user is capable of subscribing separately to the positive edge (sta- tus going above threshold) or the negative edge (status going below threshold) for each hierarchy node separately. Finally, the PV management solution logs all notifications sent.

A very important function is the automatic generation of reports. This service uses the Web and delivers reports to e-mails or mobile phones of users who have subscribed to the service. These reports include information on the operation, maintenance and financial situation of the entire system or specific facilities. The timing and scope are determined by the administrator and the choices of the user.

The Data export service allows the user to store locally data that are stored in the application. The source of data is primary or derived parameters from any mon- itored entity. The extracted data are in xml file format or graphic representations. The time frequency of data extraction and export is determined by the user.

The operation of solar parks/PV plants is based on the photovoltaic effect. The photovoltaic effect is the basic physical process in which a photovoltaic cell con- verts sunlight into electricity. A solar park consists of solar panels. Each panel is a set of solar cells and numerous other protective and functional coatings installed onto an aluminum frame as a means of support. They are connected in series until we get the desired effect on current output and in parallel until they reach the desired voltage. As a result, solar panel connection is very important during installation.

Every control and monitoring application controls a number of signals using the appropriate sensing elements. Each transducer gives some type of digital (binary or discrete) or analog (continuous) signal, or more complex signals in the form of a protocol, e.g. serial. The type of signal depends on the observed physical size and the transducer used. Controllers inside an automation system can control and monitor digital, analog and serial data from sensors, actuators and devices (Nof, 2009). Our implementation for controlling and monitoring the power of a solar park uses the following signals:

Temperature signal: It is an analog signal used for checking the proper function- ing of the system in extreme environmental conditions. Sensors measure the temperature of the installation, both internal (module temperature) and external (air temperature). The ideal temperature for solar power plants is 25 °C (77 °F). When temperature increases, the current increases slightly, while the voltage is reduced too quickly. This results in a lower overall energy output. A general rule is that the performance of a cell drops by 0.5% per 1 °C above the 25 °C.

The system has been tested with real data. These were collected during a period of one year from a real PV installation which collected and monitored the above signals. Fig. 7 depicts the annual power produced in our monitored park in relation with air temperature and humidity in the park area. The maximum per- formance is in May, while the minimum appears in mid-December. The perfor- mance increases during the summer months due to the favorable climate. Apparently, performance change is proportional to temperature change. Mini- mum performance has been recorded during the day of the year with minimum air temperature. This synchronization between the two plots does not happen for maximum performance. That means that temperature is not the only factor

Fig. 8 depicts the power and temperature values across a winter and a summer day. Recordings on 12 August 2010 – a hot summer day with an outside tempera- ture of an average 30 °C – show a peak of 900 KW. Recordings on 12 December 2010 – a cold winter day with an outside temperature of a mere 5 °C – show that it is easily and permanently possible to achieve the goal of 70 °C and a thermal energy of almost 1.5 MWh in the storage units: a very good result for almost the shortest and coldest day of the year. In both cases, it is observed that the energy produced (apparent power) by the park is entirely consumed (active power).

Alarms are binary signals which depend on one or more signals and activated by the changes of their values and situation. In the case of binary digital signals the alarm is activated by the state change of the signal. In case of analog signals, activation of the alarm takes place when the signal value exceeds or goes under a threshold. Our solar park control and monitoring application implements the following alarms:

Temperature alarm (air and module alarm): The manufacturer or user sets min- imum and maximum values for air and module temperature in order to control the environment of a solar plant system in extreme weather conditions, such as frosts or large heat waves. Temperature alarms are created when values exceed these thresholds. The ideal temperature for solar power plants is 25 °C (77 °F).

Power loss alarm: This alarm is activated by a combination of factors. Some of them are long periods of shadow, battery performance and temperature. As mentioned before (see temperature signal), the increase in temperature results in a lower overall energy output.

Battery alarm: The amount of kW per hour that a solar panel can produce with battery life depends on temperature and on sun exposure. The manufacturer or user sets minimum/maximum thresholds and when the temperature value is out of this range for a long period then a battery alarm is created. The performance of a battery is reduced below a threshold and battery stops charging over a tem- perature limit.

Every installation has cameras in specified areas according to pairs of coordinates (south, north, west and east). The user can monitor with live video every plant by specifying the direction s/he wishes, and even handling PTZ (pan, tilt, zoom) func- tionality if available (see Fig. 9).

This service is very important because it allows the user to monitor very quickly the total performance of the park. The user can monitor the current performance as well as define specific periods of time to view a graph of the recorded values. This service allows for macro-observation of the performance of the PV system in field conditions. The user can compare the performance values between days, months, years or certain time intervals and draw useful conclusions (see Fig. 10). Performance analysis and evaluation are based on the procedures and performance indicators defined in the IEC 61724 standard (International Electrotechnical Commission, 1998; Emery et al., 2013), extended properly to support state-sets and state-change events. Performance monitoring is significantly affected by the quality and calibration interval of the measurement hardware and

Following the IEC 61724 directives, the PV Management System acquires real time measurement data from the PV equipment (DC–DC converter or inverter, sensors like pyranometer, temperature and humidity sensors etc.) on fixed periods of time. The completeness of real-time data is determined and used for further pro- cessing. Derived parameters are calculated using mathematic formulas that oper- ate on specific sets of values or vectors of values of primary (and/or other derived) parameters covering a set of specific time spans (always in multiples of the record- ing period), called ‘‘reporting periods’’. IEC61724 presents a number of derived parameters, related to efficiency, yields, losses and performance ratio which can be used to monitor the performance of a PV system. The ones selected for the PV management system are mean array efficiency, array capture losses, and per- formance ratio.

Mean array efficiency represents the mean energy conversion efficiency of the PV array, which is useful for comparison with the array efficiency at its nominal output power. The difference in efficiency values represents diode, wiring, and mis- match losses as well as energy wasted during plant operation. The array capture losses represent the losses due to array operation and indicate the amount of time during which the array would be required to operate at its rated power to provide such losses. The maintenance performance ratio is calculated per PV array, PV array group and the PV plant as a whole only for values of total irradiance which are above the standard specified threshold. This threshold is the same for all per- formance ratio calculations.

Through the data export page the user can select one monitored signal or a group of signals, the time period of interest for which a plot shall be produced (‘‘from/ to’’ selection) and the unit (X axis) of representation (days, months, years). The results are being represented by graphical plots. The user further has the opportu- nity to store these values locally in an xml file or send them via email (see Fig. 11).

notifications are generated based on these values. Two specific alarms – battery and performance – are generated automatically by functions inside the service back-end. For these two alarms the user can only define their threshold in percent- age mode, e.g. a notification is being generated when battery reaches 15% of max- imum performance. In addition, this service displays a graphical representation for the selected alarm in the specified period allowing the user to easily spot values exceeding the predefined threshold which is depicted with a blue area (see Fig. 12).

The user defines in his/her profile page which type of communication channel will be used per type of notification and alarm. Three channels are provided by the system: (i) SMS to receive notifications in a mobile phone. (ii) Email, where the user receives notifications in the email address filled in the registration form.

(iii) Inbox, which is implemented through a web page of the PV management sys- tem called ‘Notifications’. This page is accessible through the system environment of a logged user. It is easy to use and very practical because all the information is gathered together (see Fig. 13).

The proposed PV management system has been implemented in Visual Studio 2010 with Framework .NET 4. The programming language used is the object- oriented C# language v4.0. The application consists of three projects. The first project is a web site where all .aspx pages are implemented. The aspx pages

The second one is a Class Library project named DBTier. This project provides the Database Access Layer of the PV management solution and establishes the connection to the system database. It contains files for each database table and communicates with the Application Logic, Reporting Module and Notification Module by carrying out insertions and updates or returning feedback via query results for every function they operate.

The last project is a WCF Service Library project, which implements the Web Service of the PV management application. WCF is an API in the .NET Frame- work for building connected, service-oriented applications. Our PV management application has implemented a Mail Sender Web Service, which sends notification emails when an alarm is created. For this purpose we used the System.Net.Mail library of the .NET framework. This library contains classes in order to send email to a designated SMTP server for delivery. Notification mails include reports as attachments.

The Visual Studio Integrated Development Environment includes the creation of WCF Service Library for Web Services implementation. The WCF Service Library is a compiled component that can be expanded as a Web Service or Win- dows Service or even as part of a custom application hosting. When the debugger starts, the WCF Service Host (WcfSvcHost.exe) implements the hosting of the Web Services projects. Then it opens the WCF Test Client (WcfTestClient.exe) and displays a list of service endpoints that have been defined in a configuration

The Graphical representations of our application were implemented using Charting Controls which are embedded in Framework 4.0. With these tools we can specify the type of graph, the format of the source of data and the filter of data. The database on the service back-end was implemented in Microsoft SQL

Panel data: stores signals’ values. These values derive from the CAM, which acquires data from the remote installation and calculates values’ average of a time span of 30 s. The values stored are: battery, humidity, wind speed, air and module temperature, as well as active, reactive and apparent power.

We have developed a flexible modular network-based application which supports all key services for automatic remote control and management of photovoltaic parks. Our implemented PV management application fully achieved the system objectives meeting successfully the initial user requirements. We have presented in detail a three-tier layered architecture and the according design and implemen- tation of a modular service back-end system including database, notification, reporting and arithmetic logic system components. The presented integrated sys- tem allows the easy and convenient monitoring of a real operational environment and helps the executives to administer their solar parks. The service back-end can provide online customized monitoring of signal groups and system status, energy

production and environmental benefits in real-time. We have tested our system with real data collected and monitored during a period of one year from a 2MWp PV plant installation. The monitored panel data included several signals: active, reactive and apparent power, air and module temperature, battery, humid- ity and wind speed.

