Electrocardiogram (ECG) is an electrical signal detected by the particular device and method. It is very important to analyze and measure ECG for diagnosis of various heart diseases. However, it is often disturbed by different types of noise. In this paper, an adaptive morphological filter is presented to remove the power line interference from ECG signals, by which the drawbacks of previous morphological method are overcome. Moreover, the extraction of R peak in ECG is also feasible by this filter for further study on ECG. Due to the high speed of our method, the ECG de-nosing and R Peak extracting could be both realized at real time, which is an effective method to monitoring patients undergoing surgeries.

clinical information in ECG is to find the intervals and amplitudes, for example, the R-R interval detection is a major factor in determining the heart rate, and several related arrhythmias such as Tachycardia, Bradycardia[2]. Many approaches have been applied to the enhancement of filtering ECG, such as FIR filter[3],EMD method[4],Morphology[5]. The primary drawbacks of FIR filter is that it can only filter the interference of fixed frequency, while the spectra of the ECG signal and the interference overlaps. However, EMD method, which is able to effectively remove noise from ECG signal, but requires considerable computational time which is not suitable for real-time processing. In recent years, mathematical morphology has become one of the effective approaches for the processing and analysis of the ECG signals. Although this approach is promising in terms of robustness and computational efficiency, it introduces distortions to the QRS waves [6], which causes the difficulty in extraction of ECG features. In this paper, we modify the morphologic filter to combine it with the adaptive filter algorithm and extracting R pear in ECG. The previous morphologic filter, the adaptive filter, and our method are illustrated in next section. And in the third section, experimental results of clinical ECG recording collected during kinds of surgeries are given. Finally, the discussion and conclusion are in the last part.

Mathematical morphology(MM) is a branch of mathematics which is based on set theory, topology and random functions. Structuring elements are the basic concept of mathematical morphology, which has a certain form (such as point, line, circle, etc). Erosion and dilation are two basic morphological operators. Open and close can be defined through the transform of them. The morphology operations are defined as follows:

In most applications, opening is used to suppress peaks, while closing is used to suppress pits. Opening is a shrinking operator while closing is a expansion operator. So the two filters combine in order to suppress one- way migration[7]. The morphology method used in our paper is mainly based on the following equation.[8].Figure1 illustrates the structure of morphology used in morphology filter.

The adaptive filter extracts the signal, or eliminates the noise, by iteratively minimizing the MSE between the primary and the reference inputs [9].By adjusting its coefficients continuously, the filter output unlimitedly close to the reference, so that it can achieve the purpose of eliminating interference. This is why the adaptive filter is superior than the fixed parameter filters.Figture2 shows a typical self-adaptive filter structure used for suppress power-line interference [10].

In this paper, we combined mathematical morphology and adaptive filter to suppress the 60Hz power-line interference and baseline wander in ECG signals. Theoretically, if morphological filtering has width of the structuring element larger than the width of noise aimed to suppress, morphology can separate the useful signal from noise. But in fact the high amplitude QRS wave and the peaks and pits of its adjacent regions will also be removed during simulation process, resulting in the distortion of corrected ECG signal. Our method is designed to solve this problem perfectly. The overall system diagram is showed in Figure3.

interference in noisy ECG signal f0 . g1 is a triangular structure element which width is 0.02Fs. Signal f1 is obtained from the noisy ECG signal after OC_CO operation, and the noise has been removed from it ,as well as the peaks and pits in high amplitude QRS wave. Signal p contains the important peaks and pits cut down in the operation of morphology, however, there is a lot of noise too.

To prove whether our algorithm is appropriate for the ECG signal, we use the real ECG signal getting from the process of operations of Taiwan hospital. The sample rate is 300Hz, and the noise signal was obtained by adding 60Hz noise into the pure signal. We use the the signal-to-noise ratio (SNR) and root-meansquare error (RMSE) to measure the performance of our methods.

In the above two equations , x(i) is the original ECG signal, y(i) is the signal after filtered. Our experiment is composed of two parts. We chose the record 1 from a 78 years man in experiment1, because it captures normal sinus rhythms and is reasonably free of noise, and record 2 from a 56 years man in experiment 2 is corrupted with synthetic PLI with frequency and baseline wander. Figure 4 show the results of experiment 1.

From Figure 4 and Table1, our method has the better performance with the improved SNR and RMSE between the pure signal and the filtered ECG was reduced. The morphology method alone can suppress the noise and cut down the peak of R wave at the same time. Although our method will take a little more time to process, it can keep the important features in noisy ECG signal unchanged, which has an important effect on real-time ECG processing.

In this paper, a new ECG de-noising method which combines morphology with adaptive filter with LMS algorithm is proposed. This new method overcomes the disadvantage that the morphology will cut down the R peaks in ECG signals. It not only suppress the power line interference effectively, but also minimally the losses of the useful information in ECG signal. In addition, our method applies LMS algorithm to reduce the noise in R peaks obtains from morphology. At last, we applied morphology method to extract the QRS wave from the de-noised signal, which can benefit for processing R-R interval in real-time effectively. However, how to select a appropriate structuring elements to adapt to individual differences is the most difficult part in future work.

