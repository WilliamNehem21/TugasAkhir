assignment of crops to fields and simultaneously accounting for vehicle routing and other constraints for optimized harvest planning has not been discussed in the literature before. Such strategic assignment must be conducted once per year and at the beginning of the (yearly) work-cycle, thereby decisively affecting the complete agricultural production-cycle, as the first step within a two-layered framework. The second layer involves coordinations of PUs and SUs, exploiting all of the aforementioned references, and is to be conducted at the end of the work-cycle during harvest.

The contribution of this paper is a novel method that can (a) assist farm managers in the planning of crop assignments to available fields and (b) simultaneously determines crop-tours, i.e., optimized se- quences in which to service fields of the same crop during harvest. Eight different integer programs (IPs) are formulated corresponding to different problem setups.

The remaining of the paper is organized as follows. Problem and no- tation are formulated in Section 2. Algorithms are derived in Section 3. Extensions are discussed in Section 4. Numerical examples are given in Section 5 before concluding with Section 6.

Problem 1. Suppose a setting in which multiple fields, a path network connecting these fields, multiple depots, and potentially multiple har- vesters located initially at each depot are given. Then, at the beginning of every work-cycle (beginning with planting and ending with harvest- ing), a crop has to be assigned to all available fields. This entails the fol- lowing questions:

16.3 km. The path network connecting the fields is curvy and often along rural gravel roads only permitting slow traveling speeds. The overall field coverage area is more than 1700 ha. Traveling distances between pairs of fields is between meters up to dozens of km.

Assumption 2. A fixed number of harvesters is assigned for the harvest of every crop. Then, during the coverage of all fields associated with a crop, harvesters travel as a group. Thus, it is assumed that there is no dispatch of individual harvesters to individual fields.

Assumptions 1, 2 and cost coefficients (1) are defined for practical con- siderations discussed below. Thus, in the most general sense of Problem 1 they are limiting. However, on the other hand, they permit to ap- proach Problem 1 based on planning routes for each crop (in the follow- ing referred to as crop-tours) similar to the mTSP-framework (Bektas, 2006). Thus, a route for each crop and the fields correspond to a travel- ing salesman route and cities to be visited, respectively. Note, however, despite this basic analogy, the mTSP-framework is insufficient to ad- dress Problem 1. In particular, crop assignment, multiple depots and ad- ditional constraints are not addressed. Therefore, eight customized IPs are derived in Section 3.2. First, however, it is further elaborated on Assumption 2.

Proof. The proof is by construction. For the asymmetric case with dif- ferent fields ripening at different times, a unique optimal working se- quence is already implied. For the symmetric case, a cost-minimizing route exists and includes exactly two edges incident to the depot vertex. This is due to nonnegativity of traveling costs and the fact that cost co- efficients (1a) and (1b) are invariant to the number of harvesters trav- eling along inter-field paths (uniform scaling by Nharv,k). Any other initial distribution of harvesters to fields not connected to the depot ver- tex along the two aforementioned edges is thus suboptimal and har- vester group travel is thus an optimal policy.

Several comments are made. First, accumulated inter-field path length minimization(invariant to the number of harvesters traveling along the path) is of interest for minimization of total non-harvesting time. By nonnegativity of edge path lengths there exists a shortest path crop-tour. Since harvesters can always work in parallel on fields since they are not constrained by each other, this shortest path should be followed by all harvesters.

Eight different IPs are formulated for the eight different problem setups considered to be most relevant for harvest planning. First, these problem are stated only literally. Relevant constraints are summarized compactly, whereby it is distinguished between constraints used in final numerical simulations and additional constraints. Then, for brevity only the two most general IPs are stated mathematically. Nevertheless, in the final numerical experiments of Section 5 all eight IPs are evaluated.

IP-3 Among D > 1 potential depots, the best depot w.r.t. a cost crite- rion is selected. Then, all available harvesters are assigned to this best depot. Note that this problem could also be addressed by separately solving IP-1 for each of the D depots and then selecting the best solution. However, here it is solved by a single IP-formulation. Any subset of K crops can be used for planting.

The two most relevant IP formulations, IP-3 and IP-4, are stated. These are most relevant since they can be simplified to all six remaining IPs. For IP-1, D = 1 is enforced in IP-3. For IP-2 cost coefficients from IP-1 must be adapted. For IP-5 until IP-8, the inclusion of all K crops is enforced. Accordingly, their counterparts IP-1 until IP-4 simplify.

Remark 1. It is stressed that for h~ < L, because of the clustering Step 2, there can be examples constructed in which a hierarchical method that (a) first solves an assignment problem without accounting for any spatial field-proximity, before (b) then computing crop-tours can be more cost-efficient than a corresponding CApR-solution. However, this cannot occur for h~ = L. This is since the hierarchical solution is a feasible solution of the method coupling crop assignment and vehicle routing. Therefore, in practice, to optimize the monetary result the number of clusters must always be increased as much as computational power and available IP-solver permit, ideally, until h~ = L.

For numerical simulations one data set is composed of 10 different random instances. In Section 5.3 the mean evaluation results are re- ported for these instances. Problem data is generated synthetically based on realistic parameter settings from farming in Northern Germany. The data generation for each instance is as follows. The num- ber of available depots, crops and fields is set as D = 3, K = 3 and L = 50, respectively. Field and depot locations are generated randomly accord- ing to a Gaussian distribution centered at the origin with standard devi-

The focus of this paper was on problem modeling for a broad variety of settings typical in agriculture. For future work the main task is devel- opment of an efficient solution method. This is motivated by the fact that the output of CApR-n remains heuristic and in general suboptimal for all h~ < L due to the clustering step. Thus, IP-solution methods must be de- veloped that enable to solve in reasonable time for h~ = L and for large L,

Reformulations of the SECs, for example, in form of MTZ-SECs (Miller et al., 1960), which introduce additional continuous variables for SECs and thereby render the problem of mixed integer nature may also be ex- plored. Alternatively and secondly, optimization by simulation algo- rithms, e.g., Tabu search heuristics similar to Gendreau et al. (1994), may be tested to solve the proposed IP-problems.

