In the first group of components, the most important is the User- Agent. It can be described as an intelligent software component that operates on behalf of the end-user. The main functions it provides are: global and local discovery (R1), to manage the privacy for the end-users (R3), to interact with the local infrastructure to estimate position of the end-user (R2), to interact with the end-user (R4). Other functional components that could be installed on the device are the Navigator and a Translator, the first of course to manage navigation, determination of the shortest routes etc, the second is increasingly adopted to facilitate vocal interaction, as done with commercial vocal assistants (Amazon Alexa, Apple Siri, Google Home) (R4).

The second group of components concern the infrastructure. In particular, the Indoor Location System and the Map Server (R2, R3). The first consists of hardware and software artifacts deployed in the environment that are functional to the estimation of the user’s position and the data protection, as detailed in Section 3.4. The second one

provides the indoor maps and features of the indoor environment useful for navigating. Other components we foresee are the Discovery Server which provides the description of the resources available by the infra- structure (R1, R2) and the System Agent which is the counter-part with which the User Agent can communicate. In particular, the System Agent can be seen as a regular chat user to which send requests for assistance or information (R4), it can be implemented by an Instant Messaging bot. Components deployed in the infrastructure are interfaced by respective services orchestrated by the User-Agent. A person trough the User-Agent interface can interact with the System-Agent of the indoor infrastructure.

We now detail the internal structure of a generic ILS. We consider it provides three main sub-components, as detailed in Fig. 2: the ILS En- gine, the GDPR-Based Access Control System (G-ACS) and the Communication and Interaction Orchestrator. Such components implement the main features of an ILS. Moreover, we expect that they rely two distinct database for collecting the information.

Data provided by an ILS can be simultaneously accessed by multiple actors. More specifically, the end-user, the system administrator or a generic supervisor might require access to specific data. In order to manage the different grants for the actor, we consider that the ILS and the GDRP Access Control System (G-ACS) components have to cooperate (see Fig. 2). In particular, the latter is in charge of evaluating each single data access request and to allow or deny the access according to several fac- tors. They are: the consents collected, the data validity period, the spe- cific users/service rights and the access control policies established inside the overall Localization Infrastructure.

Finally the Communication and Interaction Orchestrator is the component in charge of man-aging the communication to and from the ILS. This component is exploiting publish-subscribe design pattern through extensible events. It is in charge to instantiate communication channels and manage flows of notifications and events data. Those events can be structured adopting several asynchronous messaging technologies like Java Messaging Service (JMS), Advanced Message Queueing Proto- col (AMQP), Message Queueing Telemetry Transport (MQTT) in order to decoupling not only the locations of the publishers and subscribers, but also decouple them temporally.

The interaction among the components described in reported in Fig. 3. The indoor infrastructure periodically advertises its presence broadcasting an URI. The URI points to the meta-information of the ILS. When the end-user enables the indoor positioning on its device, the User Agent starts listening for such announces (Listen for URI activity). The Discovery phase ends when the User-agent accesses the URI in order to obtain the description of all the resources that are part of the infra- structure. The structure of the information obtained during the discovery phase represents a key-point. We report a schematic example of such information in Fig. 4. The information reported can be represented following different formats, such as JSON or XML text-based format.

The Access stage can now start. During this stage, the end-user grants or denies some consents required by the ILS to work properly (Consent evaluation). This process can also in-volve a more fine-grained assess- ment of the consents (specialized consent acceptance activity), depend- ing on the kind of services to be used. If consents are accepted, the subscription data as well as the collected consents are used by the G-ACS System for example:

As a general observation, information about the physical distance among people can be exploited in three different stages: before, during and after the end-user visits a location. More specifically, knowing how people dispose indoor during the such stages, can increase the user- experience and improve the effectiveness of countermeasures to the diffusion of diseases (see Section 2). We report in Fig. 5 an example of how the information concerning the social distance can be used during while visiting a generic indoor environment. More specifically:

information about the social distance can also be used after the visit. More specifically, knowledge about how many people visited a spe- cific location, can be used to plan an efficient cleaning schedule, to better dispose products and, more generally, to allow the service provider to re-think the way services is accessed. Data collected after the visits can be used for statistical purpose as well, in order to measure if the actions taken prevent the existence of crowds.

Visiting a museum is a challenging scenario in which to guarantee a proper social distance among the visitors. A museum is generally orga- nized with a visiting path designed to guide visitors through the art- works. Users can decide to follow the path and to move across the rooms in a specific order. Small museums do not recommend any specific path

to follow, while others have multiple paths. Users following a path do not have any time restriction during their visits, they are free to move across the rooms and to rest. Moreover, the number of visits in a museum changes dramatically according to several factors, such as the day of the week, the hour, the scheduled holidays as well as the whether conditions. The combination of such factors determines the existence of burst of visits, as discussed in Ref. [55] that are challenging to predict.

We consider that the adoption of an indoor localization system in a museum can support the adoption of effective countermeasures for limiting crowded areas. More specifically, the knowledge of the position of the visitors can be used for 1) observing the way visitors access the museum and 2) to manage in real-time the flow of visits. Concerning the first goal, we argue that it is highly important to measure quantitatively the way visitors access a museum. More specifically, it is possible to measure the total amount of visits, the visits during a specific time in- terval, the visiting time for each room and artwork, the existence of preferential paths during a visit and other metrics useful to describe the social attitude of the users. Such information, can be in turn used to meet the second goal, namely to plan the visits according to the requirements previously reported.

Users can be localized by adopting proximity-based technologies such as Bluetooth Low Energy (BLE) or the UltraWide frequencies. Such technologies are becoming more and more popular. In particular, BLE is already available in most of the commercial smart devices, while the UltraWide technology is expect to diffuse in the near future. It is worth to notice that the iPhone 11 already provides the U1 chip-set. Bluetooth and UltraWide band allow to detect proximity not only between users but also between users and points of interests such as artworks or furniture. Moreover, such technologies can be easily integrated with personal de- vices such as smartphones or an audio guides without the need of a complex network infrastructure. Some remarkable works already addressed the problem of localizing people in a museum, we refer to Refs. [56–58] for further details.

in which users freely roam. An airport terminal provides several services for the end-users. Some of them are mandatory to all the passengers, others are optional and provided only for the entertainment purpose. The number of users accessing to such services changes dramatically ac- cording to the seasons and according to external factors, such as weather conditions, strikes and delays of the flights.

Also for this use-case, we consider beneficial the adoption of a modular indoor localization system tracking the distance among users. In particular, the indoor localization system can be used for detecting the existence of crowds in a specific location e.g. check-in desks and to prevent other passengers to stack in queue. Furthermore, such localiza- tion system can be also exploited for security tasks, such as identification and tracking of target subjects. The majority of the terminals are already equipped with Wi-Fi networks available also for traveller. Some works already address the problem of localizing users in an airport. Authors of

[59] proposes a multi-modal solutions based on Wi-Fi and BLE tags. Through the availability of a precise map of the environment and an accurate survey of the environment. The end-user can benefit of services based on positioning information on their own commercial smartphone. In [60] authors propose an interesting approach, based on BLE technol- ogy in an airport scenario, using a combination of Received Signal Strength Indication (RSSI) and Time-of-flight.

A shopping mall is generally organized with product-specific aisles. Customers are free to decide the order of the products to pick. Malls also have some locations for specific fresh products, such as bakery or fresh- fish. In these locations, the self-service is generally not allowed, and customers interact with an operator. Some small/mid-size malls guide customers through a suggested walking path, while in large-scale malls, customers can freely move within the areas.

A shopping mall equipped with an indoor localization system can provide several services for customers. We foresee the possibility of optimizing the path to follow in order to completing the shopping list. Moreover, the supermarket can provide a queue management service that notifies the customers when to approach to a specific desk. Finally, a supermarket can provide services for personalized advertising to the end- users. In fact, indoor positioning systems shall make available a set of personal data which can be exploit to promote sales products or to pro- mote temporary offers.

In the last decade, supermarkets have been equipped with internet access, throughout Wi-Fi Access Points deployed in the environment. These APs can be exploited also to provide an indoor localization ser- vices. The more promising technique in this environment is the finger- printing technique, where the RSSI previously collected together with the position of the user is leveraged to infer the current user position [61]. In fact, the accuracy of this technique ranges in the order of few meters and, exploiting also inertial sensors of the smartphone, ILSs are generally able to localize users accurately. A distributed ILS can provide meaningful information before, during and after shopping. For example, before shopping, users can use the aggregated information about the number of current buyers to plan the purchases or not. During shopping, the user is reassured about the use of the ILS which can provide a “safe route” as described before. After shopping, information related to all the routes followed by customers can be used to thoroughly sanitize the most fre- quented spaces.

Although our goal is not to define a reference implementation of the architecture described in Section 3, we consider that some of the com- ponents in Fig. 2 can be implemented with existing software artifacts available in the current literature. We report in this section some meaningful examples both for the Indoor Infrastructure and for the Smart Device.

Concerning the Indoor Infrastructure, the Map Server is responsible for managing the indoor map. In particular, it provides the base maps or a tile set covering a specific area. The Map Server couples with the client side, in charge or downloading (possibly, with parallel connections) and rendering the map on a e.g. 5-inch screen. Both modules are available in literature and can be re-used as third-party black boxes. As for example, the open source map-view solutions, open layers and leaflet are available. According to the specific needs, it is also possible to adopt different Map Server such as mapbox, Google Maps and AcrGis.3

Concerning the ILS engine the literature also offers some interesting and open source solutions that can be deployed as off-the-shelf products, among them we refer to Anyplace as a complete framework for indoor localization comprising API, Viewer, Navigator and Logger components.4 We finally mention some existing discovery protocols that can be embedded with the Indoor Infrastructure to discover the server in a seamless way. In particular, the SLP, UPnP, ZeroConf and WS-Discovery are old-but-robust valuables candidates for discovering networked re- sources [62]. Moreover, if the goal is to implement a local discovery then the Bluetooth beaconing and the Wi-Fi probing also represent two interesting protocols that can be used to broadcast small chunk of information.

Finally, in relation to the Smart Device we found several client in- terfaces that can be customized. Among them, we consider that Telegram app5 is a valuable alternative since it offers the possibility of customizing the popular chat-based application by reusing most of features available. Such choice allows to include specific features enabling the localization, the discovery and the map rendering in a chat box. We finally remark that guidelines for choosing the proper technical solution are out of the scope for this paper but, it is worth to remark that these design decisions strongly depend on the considered use cases.

We now discuss some issues related to the concrete possibility of adopting an indoor localization system for the purpose of measuring the distance among users. This section covers different aspects of its adop- tion. In particular, in subsection 5.1 we discuss the impact on the privacy and trust reputation of the ILS. Subsection 5.2 focuses on the discovery phase of ILS. Subsection 5.3 presents two alternatives for the social distancing, namely a manual and automatic approach and, lastly, sub- section 5.4 concludes with a description of some challenges of the deployment phase of an ILS in real-world settings.

Privacy by design encompasses seven principles that should be fol- lowed [64]: proactive privacy protection instead of remedial action after privacy violations have happened; privacy as the default setting; privacy embedded into the design; full functionality with full privacy protection; privacy protection through the entire life-cycle of the data; visibility and transparency; and respect for user privacy. Solutions for incorporating these principles in the design of an ILS are necessary. In parallel, data minimization approaches should be considered as a best practice for privacy by design adoption.

Furthermore, we argue that information sharing, active defence and automation methods should be integrated with an ILS. Thus, we consider mandatory to develop efficient methods to create, disseminate, and consume threat intelligence in a standardized and admissible way. It is also necessary to adopt defence mechanisms able to increasing the cyber adversary’s cost by decreasing their overall efficiency of the active cyber operation. In parallel, in order to make the solutions effective, automa- tion should be considered and solutions integrated into business work- flow, governance, and structure control.

We also consider an orthogonal aspect of the privacy, namely the trust reputation of the ILS. Since the architecture described in Fig. 1 involves a variety of components, it is required to implement different protections policies and to ensure that there are no privacy leaks at any of the stages we modelled in Fig. 3. Additionally, the architecture should be deploy- able across different systems and environments maintaining the required level of trust. Another aspect linked with the management of the trust of the system, is how to guarantee trust for third-party components that an ILS can integrate. As for example: multiples Map servers and different implementations of ILSs can coexist with the design presented in Section

3. To this purpose, we foresee some possible solutions: to provide interoperability recommendations and specifications; to define specific governance; to provide on-line verification and validation tools in order to identify the security risks. In parallel, data should be encrypted both at rest and in transit.

Mobility in multiple indoor environments increases privacy issues. Continuing on the example of the outdoor navigation services offered by Google, we know that the people who activate the history of their posi- tions are tracked by Google, which, through the user account, allows you to view your movements and possibly eliminate them entirely. In the case of indoor navigation, this information will be collected by multiple subjects who must make it accessible to the owners of the data both for consultation and for modification. The task of the User Agent in this case becomes essential, because it must be capable of maintaining a history of the indoor sites visited. In particular, it must keep track of the policies and consents signed by the user, as well as links to the various interfaces to access the consultation and modification services of personal data. Nevertheless, much of this information must be conveyed during the Discovery process (Figure JSON file) Privacy management in general is more complex than the use case presented here, de-pending on whether the localization techniques used are Self-positioning or Remote posi- tioning based. Systems that intrinsically guarantee privacy should be favoured, in which the position is estimated by the user agent (self- positioning) and is not known by other subjects, such systems are also more scalable. However, with respect to social distancing, you must in any case give up your rights and reveal your position even if used only anonymously, therefore defining an access control based on GDPR is always an indispensable step.

Another crucial aspect is the safety distance among people (usually fixed in the range of 1–2 m) which is normally perceivable on sight. People in favour of using automatic tools to support social distancing are already well prepared to keep the right distance from others. We observe two conflicting requirements: firstly, service providers e.g. a shopping centre, aim to increase the number of customers while, secondly, cus- tomers are interested to access a service scarcely populated. Therefore, a service obeying to the current prescriptions will grant the access to the maximum number of admitted customers. Such situation is generally perceived by the final users as potentially unhealthy, even if customers stay 1–2 m away from others. Such consideration is predominantly of psychological nature. However, we argue that also the adoption of apps for preserving the social distance do not resolve the dichotomy between number of customers and distance among them. In fact, the false posi- tive/negative alerts of such app, combined with the privacy issues pre- viously mentioned, discourage their use in the daily basis.

for their successful adoption on the large scale. More specifically, range- based applications (i.e. based on Wi-Fi/Bluetooth signal strength) often fail in crowded scenarios or in those environments characterized by barriers and obstacles. Differently, the adoption of indoor localization system based on the data-fusion techniques are more reliable in such circumstances. Data-fusion allows to gather and to combine heteroge- neous sensing and context information. Although more complexity with

The current trend is to adopt solutions for preserving the social dis- tance that are based on apps for smartphones. We consider that such approach might fail on the large-scale and on the long-term. We consider necessary to understand those practicable alternatives and how to gradually move from the use of apps to the use of infrastructures, such as an Indoor Localization System.

If we consider that people are well predisposed for social distancing through the use of sight, a first discriminating factor is the type of environment. In open spaces, such as a supermarket, people will have greater ease of self-determination if a situation is risky or not. Differently, in indoor and constrained environments people need to be supported with automatic tools.

The transition from manual to automatic systems for social distancing requires bridging technologies able to reduce the deployment costs. As a remarkable example, we mention those systems designed to count the number of people in each room. Once a certain density has been reached, the system warns incoming people, in order to limit the access to such places. In any case, even if a precise localization system is not used, common interfaces must be studied through which to communicate to all end-users. Other aspect to consider is that the turnout of people could be estimated from the reservations that are made to visit a certain envi- ronment. This practice is currently used by the most visited museums, where you can buy tickets online and avoid long queues to buy tickets. In other environments such as airports, by integrating the various infor- mation systems of the airline companies, the number of people at a certain time can be determined on the basis of the scheduling of flights departing and arriving. Obviously, this is an alternative to preparing new infrastructures for localization, but it is an estimate that can be affected by various random factors, lost reservations, flight delays, random congestion. But even in this case, an interface to people who access the environment/system is necessary to allow it to check the crowding status and possibly receive notifications.

The previous step leads to the installation of the hardware required by an ILS. This step, usually, requires to find places where to deploy anchor nodes enabling the localization of the users, such as Wi-Fi Access Points, Bluetooth tags or UltraWide band boards. The hardware to be deployed often requires a power supply source in the nearby, the absence of sur- rounding obstacles and a safety distance from the end-users. The com- bination of such requirements makes the deployment a challenging task in places not designed for such purpose.

We finally focus on the assessment of the performance of the inte- grated architecture as a crucial part of applicability of the solution we propose in this work. Our goal is to frame a reference architecture based on localization techniques for the purpose of measuring quantitatively the distance among people roaming in an indoor environment. In this picture, both the user experience and the hardware/software compo- nents can be measured to understand the effectiveness and its real applicability in real-world scenarios. To this purpose, we consider a set of measurable KPIs addressed to the 4 main players: the End-Users, the Smart Device, the Indoor Infrastructure and the Service Providers. We detail the motivation behind the such choices, how to measure the KPIs, the unit of measurement and any critical issue arising from the KPI. Table 3 summarizes the KPIs we propose.

Conceptualization, Methodology, Investigation, Supervision, Visualiza- tion, Writing – review & editing. Antonino Crivello: Conceptualization, Methodology, Investigation, Supervision, Visualization, Writing – review & editing. Said Daoudagh: Conceptualization, Methodology, Investiga- tion, Supervision, Visualization, Writing – review & editing. Francesco Furfari: Conceptualization, Methodology, Investigation, Supervision, Visualization, Writing – review & editing. Michele Girolami: Conceptu- alization, Methodology, Investigation, Supervision, Visualization, Writing – review & editing. Eda Marchetti: Conceptualization, Method- ology, Investigation, Supervision, Visualization, Writing – review & editing.

Ramadan Q, Salnitriy M, Strüber D, Jürjens J, Giorgini P. From secure business process modeling to design- level security verification. In: Proceedings of the ACM/ IEEE 20th international conference on model driven engineering languages and systems (MODELS). IEEE; 2017. p. 123–33.

Ranise S, Siswantoro H. Automated legal compliance checking by security policy analysis. In: Computer safety, reliability, and security - SAFECOMP 2017 workshops, ASSURE, DECSoS, SASSUR, TELERISE, and TIPS, Trento, Italy, september 12, 2017, proceedings, vol. 10489. Springer; 2017. p. 361–72. of Lecture Notes in Computer Science.

Pelant J, Tlamsa Z, Benes V, Polak L, Kaller O, Bolecek L, Kufa J, Sebesta J, Kratochvil T. Ble device indoor localization based on rss fingerprinting mapped by propagation modes. In: 2017 27th international conference radioelektronika (RADIOELEKTRONIKA). IEEE; 2017. p. 1–5.

Greaves B, Coetzee M, Leung WS. A comparison of indoor positioning systems for access control using vir- tual perimeters. In: Fourth international congress on information and communication technology - ICICT 2019, London, UK, february 25- 26, 2019, vol. 1; 2019. p. 293–302.

