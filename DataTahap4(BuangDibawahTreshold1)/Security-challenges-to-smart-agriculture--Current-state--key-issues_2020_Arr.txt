Smart agriculture integrates a set of technologies, devices, protocols, and computational paradigms to improve agricultural processes. Big data, artificial intelligence, cloud, and edge computing provide capabilities and so- lutions to keep, store, and analyze the massive data generated by components. However, smart agriculture is still emerging and has a low level of security features. Future solutions will demand data availability and accuracy as key points to help farmers, and security is crucial to building robust and efficient systems. Since smart agriculture comprises a wide variety and quantity of resources, security addresses issues such as compatibility, constrained resources, and massive data. Conventional protection schemes used in the traditional Internet or Internet of Things may not be useful for agricultural systems, creating extra demands and opportunities. This paper aims at reviewing the state-of-the art of smart agriculture security, particularly in open-field agriculture, discussing its architecture, describing security issues, presenting the major challenges and future directions.

Since smart agriculture integrates elements from the traditional Internet, IoT, cellular, and wireless networks, it may incorporate all se- curity problems these technologies present. It also deals with new special security issues such as data and device integrity, data accuracy, and availability. In smart farming, the devices (sensors and actuators) and communication systems are exposed to climatic fluctuations (sun, rain, snow), natural events (lightning, hail), engines (used in agriculture), power line transmissions (common in some rural regions), wandering animals, people and agricultural machinery. These elements make smart farming vulnerable to problems that have not been addressed in other contexts so far.

For instance, smart agriculture has devices installed in open areas and exposed to external agents such as animals, humans, or agricultural machinery. These agents can unintentionally remove the sensor from the original location or damage them. Most times, the devices cannot use protection boxes to prevent these external agents from approaching as in other scenarios, such as in smart cities. The lack of protection leaves devices vulnerable to security incidents and reveals a distinctive feature concerning applications in agricultural systems.

century B.C [8]. This type of terrorism can have several objectives, such as causing financial damage, fear, and social instability [9,10]. Through crises in agriculture and the food industry, terrorists can stimulate social unrest and loss of trust in government, which can serve a variety of in- terests in the globalized world. For example, terrorists and governments in trade disputes may want to cause economic damage to a nation, eco- nomic opportunists may attempt to manipulate markets, and unbalanced or disgruntled people may commit attacks with idiosyncratic or narcis- sistic motivations [8]. New technologies, such as smart agriculture, can contribute to the evolution of agroterrorism, creating cyberagroterrorism. It might use computer systems in agricultural environments to damage crops, livestock, and generate financial losses. Cyberagroterrorists can act both locally, on farms, and online, operating the attacks through cyber resources.

This article presents special security issues in Agriculture 4.0. The aim is to highlight the main solutions in this area and discuss security threats. Section 2 reviews smart agriculture and the architecture used by most systems. Section 3 outlines the major security threats from a layered perspective. Section 4 summarizes the current state of intelligent agri- culture applications. The last section presents the key challenges in this area and points to future directions.

The edge layer may contain a variety of resources such as security features, data filters, decision-making capability, diversified processing, in-out interface, and the gateway. Including one or more resources at the edge depends on the features of the appliance. Some appliances support only the retransmission of data, while others have the computational capability to perform more tasks. More robust gateways can process data, make decisions, send commands to actuators and data to the cloud. The Internet Service Provider (ISP) connects the gateway to the cloud. The cloud processes and stores data to provide end-users with information and services. Data processing is a challenge, considering a large mass of data produced by the perception devices reaching the Big Data world, and the financial cost of processing in the cloud.

systems. Such integration aims at meeting different demands of agri- cultural automation, farm management, and precision farming [12,30]. Solutions must evolve to management systems rather than just moni- toring, which can result in new challenges and possibilities. Another issue is the security of data. From the detection up to the storage and decision-making in the cloud, it is mandatory to provide data privacy, reliability, and accuracy. Security issues in smart farming are a great challenge and will be detailed in section 3.

Security incidents may be accidental or intentional. Animals, farm working, and machinery can easily access farming environments and cause incidents. Additionally, smart systems comprise heterogeneous devices and software from distinct manufacturers installed between growth areas and the cloud. These specific features might make several security breaches and could result in incidents that compromise the smart system. Nevertheless, this topic has not been studied in most systems in use so far.

The system design should consider compatibility with distinct de- vices, protocols, subsystems, and multi-access methods. Smart Agricul- ture uses machine-to-machine (M2M) communication and devices manufactured by different vendors. However, most security mechanisms were developed for the communication model used by TCP/IP networks. These mechanisms usually ignore the existence of multiple heteroge- neous devices communicating simultaneously. Security features created for TCP/IP networks can divide the relationship between smart farming devices, reducing their efficiency. Multi-access methods and heteroge- neity hinder security, interoperability, and network coordination, increasing security vulnerabilities [31].

Agriculture 4.0 is exposed to a vast spectrum of cyberattacks. Security concern needs to be part of the system, maximizing their potential. Among these issues, there is also access control, management, informa- tion storage, data integrity, and reliability. Most of the security problems are quite common in other systems, but some are present only in those

Autonomous system hijacking - It consists in hijacking autonomous systems such as tractors, drones/UAV, and sowing robots. Several farming activities use autonomous systems, such as drones and robots. Drones could spray pesticides and fertilizers, and robots may perform weeding and disease detection. If a malicious agent hijacks an autono- mous system, the hijacker can remotely control and guide without authorization. This type of attack could have several impacts, from the unavailability of the system to perform a task to its complete damage or crop damage.

The perception layer mainly deals with physical devices, such as sensors and actuators. They can be installed in small farm areas, such as those found in Europe, or scattered along with large farms, current in the USA, Australia, and Brazil. Physical devices may malfunction because of accidental or intentional human action, viruses, malware, or cybercri- minals. There are many kinds of sensors and technologies used by smart

Optical deformation - It is the deformation of images from cameras installed in robots or autonomous devices. Some autonomous systems have cameras to capture images. The cameras usually have an essential function in the system, and the captured images should have a minimum quality. Cameras are usually vital to the system. Pictures must meet a minimum quality standard in order to ensure the whole process to run smoothly. Below standard pictures may mislead the harvesting system into picking spoiled or unripe fruit or even damaging the fruit trees.

Node capture - It consists of the physical capture of a node or device. This operation could be performed by entirely replacing the device or modifying components of hardware or software [32,33]. Node capture may not generate a significant impact if performed on a single node and might not trigger other attacks. However, after capturing a device, the opponent may modify the hardware or software, gain access to the sys- tem, or inject false data. A node capture breaches the integrity of the system and can potentially interfere with decision-making. It might also damage the cultivation and cause financial loss. For example, a hostile actuator in an irrigation system could never start irrigation or flood the crop. A dissatisfied employee or commercial competitor who has physical or logical access to the system could perform this attack for several reasons.

Fake node - An adversary adds fake or malicious nodes to the system to disrupt their operation [31]. A node capture could trigger this attack and lead to node replication. This kind of attack usually aims at both to manipulate data or to shutdown services and devices. In a system with insufficient or fraudulent identity control, malicious sensors could send wrong data interfering with decision-making, or inject multiple packets into the network causing a denial of service, or sleep deprivation. Like- wise, actuators may act maliciously, hostile gateways may send false commands to legitimate actuators, or act as black holes to cause harm.

Since Agriculture 4.0 systems are open-field, they are susceptible to environmental conditions, climate fluctuations, and human action. Weak security measures could affect the reliability and trust of the system, exposing them to accidental use of corrupted data, remote control, and physical damage. Sensors do not have computational resources that allow the adoption of traditional security methods, such as cryptography, which makes security even more challenging. Therefore, adding inno- vative security solutions to this layer is as challenging, as necessary.

The network layer transmits data from the perception layer to the most robust computational unit, usually the cloud. The transmission of a large amount of data over a wide transmission area makes this layer susceptible to attacks, which generally threaten confidentiality and integrity [36]. Although the existing communication network has rela- tively complete security protection measures, there are still some com- mon threats that can compromise network resources [31,37]. Major security issues in the network layer are as follow:

Data Transit Attacks - Some attacks intend to intercept data exchanged between network components to find sensitive information [7]. Different connection technologies connecting distinct points on the network and wireless networking carrying clear (unencrypted) data make these systems susceptible to data breaches [7,40]. An opponent could conduct traffic interception through malicious access points or by man-in-the-middle attacks [40]. Traffic interception exposes sensitive information such as unique identifiers, access credentials, or crypto- graphic keys. Other transit attacks can corrupt network traffic, enabling malicious control, or even compromising the entire system.

Routing Attacks - They intend to alter network routes to achieve control of traffic. IoT networks may have malicious nodes that try to redirect routing paths during the data transmission process. Attacks such as sinkhole and wormhole could subvert the communication network and get unauthorized access. The sinkhole is routing attacks where a rival announces a shorter routing path and draws nodes to route traffic through it. Malicious routes allow disrupting the traffic flow [7,41]. In a wormhole, an opponent creates a tunnel between two nodes for fast packet transferring to create a shortcut on the network and control traffic [7,42]. During these attacks, the recipient may receive the information late, receive partial or changed information, or not receive one data [41, 42].

Network layer resources on smart farming and IoT systems have some common security vulnerabilities. However, smart farming can consist of multiple systems and integrate technologies and subsystems from different vendors. Therefore, integrating systems and technologies re- quires caution to avoid incompatibilities. Likewise, the security features of these systems and technologies cannot be fully trusted, as they may contain vulnerabilities embedded in the system or generated by the integration process.

The edge contains critical elements monitoring and controlling sub- systems, communicating with all layers, and accessing strategic re- sources. The processing of massive amounts of data generated by perception layer can be local, instead of centralized in the cloud. This would save energy, bandwidth and cloud-processing costs. Due to the distributed architecture of edge computing, this layer might provide services with faster response and higher quality, in contrast with cloud

Forged controls for actuators - It is the injection of false measures/ data to manipulate the system. The perception devices are usually resource constrained and do not support complex security features. Typically, the gateway receives the data in plain text. The gateway may receive data from the perception or cloud by Supervisory Control and Data Acquisition (SCADA) systems or other control systems. An opponent who knows the data patterns sent by the sensors to the gateway or cloud can use a computational device to inject the same data pattern into the system. If the control system receiving the data at the gateway does not have sufficient security mechanisms, the data will be accepted and may propagate through the system. False data will cause incorrect decision making. For example, to manipulate a smart irrigation system, an opponent could inject incorrect soil moisture measurements.

Forged measure injection - It consists of the injection of false measurements/readings to manipulate the system. Perception devices generally are resource-constrained and do not support complex security features. In general, data exchange with the gateway is done in plain text, creating several vulnerabilities. An opponent who knows the patterns of data sent by sensors to the gateway or the cloud can use a computational device to inject the same data pattern into the system. Sending false data could result in wrong decision-making. For instance, to manipulate an intelligent irrigation system, an opponent may inject incorrect soil moisture measurements.

Booting - IoT evolution has driven the development of low-cost and resource-constrained devices. These devices are becoming smaller and cheaper. However, innovations do not advance into the field of security [43]. Smart agriculture uses resource-constrained artifacts in the perception and edge layers. Usually, these artifacts have few security features and rarely include boot protection. Lack of security processes on booting, leaving devices vulnerable to attacks [44]. For instance, SD-cards and USB sticks may contain malicious scripts that could run at startup [43]. Malicious boot processes could trigger a series of attacks to the edge with weak protection. Those processes could open back doors or allow elevation of privileges. Insufficient computing resources and direct connection to perception and the cloud make it imperative to protect the start-up process.

communication to collect information or even replace it. Compromised devices or malicious nodes can trigger several internal or external attacks in systems with weak or missing security [46,47]. Many solutions use communication protocols that use the publish-subscribe model with a broker, which effectively acts as a proxy. These protocols allow decou- pling the publishing and subscribing clients from each other, authorizing messages to be sent to an unknown destination. An attacker who achieves the broker control and becomes a man-in-the-middle may obtain full control of communication without being noticed by the clients [7].

Edge resources provide computing services for clients or applications and can connect to distinct features from all layers. Both locally and externally processed data pass-through this layer. Protecting devices from remote access and using appropriate cryptographic resources are key security challenges. Therefore, it is imperative to achieve security features to avoid compromising data and edge resources.

The application layer aims at providing services to end-users, storing data, and making decisions within the system. Security issues in this layer focus on preventing data theft and ensuring privacy and are specific to different applications. Some applications comprise a sub-layer, which supports services, and helps intelligent resource allocation [7,33]. Each application has distinct characteristics, and it is impossible to predict all vulnerabilities which could affect them. Therefore, the security issues listed below are some threats that might affect cloud-based applications and services.

Phishing - It is a virtual pest that aims to fraudulently obtain confi- dential user data, such as ID and password. Phishing usually achieves end-user from fraudulent emails or websites [49,50]. An opponent who accesses the system with administrative credentials may send fraudulent commands to actuators and change system settings. In critical cases, the attacker could interfere with decision-making processes or other internal processes. It is impossible to avoid this type of attack, but secure access control systems can mitigate it. However, the most efficient protection would be to have the users themselves keep vigilant while surfing the net [33].

Malicious scripts - The connectivity of agricultural solutions to the Internet allows them to interact with other online services and users. This interaction makes them targets for malicious scripts such as Java applets, Active-X scripts, and cross-site scripting (XSS) [33,36]. Malicious scripts can mislead customers, inject malicious information, access sensitive information, and break security mechanisms. Cybercriminals often make this attack by personal, financial, and political ends. From malicious scripts, they can damage or disrupt the service operation, displaying unwanted advertisements, and extorting money [51].

The application layer includes cloud-based applications and services, so it has all cloud security issues. The cloud exposes applications and resources to Internet-based attacks becoming urgent to take preventive security measures. Usually, security focuses on privacy and access control to protect the many sensitive data stored and processed in the cloud. However, it is essential to consider more than just privacy and access control, adopting security measures to ensure the availability and integrity of the complete system.

In the past few years, there has been a growing effort to develop smart systems to improve agricultural activity. Farmers usually conduct these activities in open-field or greenhouses. This work focuses on open-field agriculture, as it is an immature area with security features limited to access control and web encryption. Therefore, it analyzes smart agri- culture projects and explores information on the security features implemented by them.

[18] propose a smart irrigation system to control irrigation devices. These devices are remotely controlled by a server and managed from a web application. There are no details about security resources, creating the chance for opportunistic adversaries to gain improper access to the system, inject forged measures, forge controls for actuators, or conduct any previously reported attacks to deviate the system from its regular operation.

[22] have designed an intelligent solution for the detection of leaf diseases. The system identifies leaf diseases based on data of sensors and images from cameras. The end-user interacts with the system by a mobile or web application. This paper does not discuss the implementation de- tails or security. If this system is part of a disease control process and receives corrupted or malicious data, the images suffer optical defor- mation, or an opponent compromises system, then security incidents can hinder disease detection and cause misuse of agricultural resources. In critical cases, this may cause loss of the entire production.

[28] introduces NETPIE, a system that provides information about agricultural products. Using a set of perception devices, NETPIE controls and monitors the growing environment. The production information is summarized and saved in a QR code and available to the customer. Just like the other presented systems, NETPIE does not discuss security re- sources. Any of the attacks that disrupts data accuracy may break the reliability of the information summarized in the QR code.

[12] present a cloud-based Wireless Sensor and Actuator Network (WSAN) communication system to monitor and control farm devices. The system monitors environmental conditions, predicts the irrigation re- quirements, and acts automatically on the environment. The paper de- scribes the system architecture, including appliances and protocols, allowing the WSAN to remain vulnerable to the attacks shown in Section 3.

Likewise [23], propose a smart farming system for data exchange between the server, the gateway, and the nodes. The paper describes the construction of the system but does not mention any user interaction or remote control and does not demonstrate any security concerns. Because it is a system for data exchange, the most critical attacks are those that affect the network layer, such as DoS, signal disruption, data transit, and routing.

smart irrigation system controlled remotely by the user. Farmers manage the irrigation process from a mobile application. This strategy uses HTTPS to encrypt the communication between the server and smart- phone. The use of cryptography protects data in transit, preventing an

diseases. The paper presents the developed platform and does not discuss prediction. The system includes a user and device manager, which per- mits to manage authorized users and devices to interact with the system. Access control prevents unauthorized devices or users from gaining ac- cess to the system and acting maliciously. Nevertheless, this resource is insufficient to protect a platform designed to predict disease and remotely monitor, as it does not prevent events that could interfere with the accuracy of the data or that could take the system to an unreliable state.

Currently, smart agriculture is an easy target for malicious agents. Attacks may have several motivations, such as commercial, ideological, or even terrorist reasons. For instance, terrorist groups can inflict eco- nomic harm to a nation, economic opportunists may try to manipulate markets, and an individual employee may proceed with an attack for a variety of reasons [8]. Thus, it is urgent to add security as an essential resource for smart farming, contributing to the development and popu- larization of reliable and efficient systems.

Devices from traditional Internet have many security features built into them, like firewalls, authentication, and access control schemes, and so on. However, these security shields are missing on Agriculture 4.0 or limited in use. Sometimes this is due to smart farming is still emerging,

it impossible to use most security mechanisms, which makes this task even more challenging. Others have more computational resources and include a small operating system, limited processor, and little memory. The software developed for these devices should be lightweight and easy to manage to be operated by farmers. Once the gateway accesses many

Communication between devices could use one or more technologies, such as LoRa, LoRaWan, Sigfox, Zigbee, and LTE. Some standards allow connecting devices over wide areas, simplifying management and reducing installation and maintenance costs. However, only these fea- tures are not enough to guarantee data transmission security. Technol- ogies that support some level of encryption can maximize data transmission security, reducing the risk of traffic interception.

