When evaluating the performances of the CNN models using the 10C-database, the ResNets outperformed AlexNet and VGG nets, mean- while, the accuracy improved when the nets were deeper. The leading CNN models that have been successful in the challenging ImageNet da- tabase all exploit “very deep” models, with a depth from sixteen to hun- dreds of layers (He et al. 2016), indicating that network depth is of crucial importance. However, deep CNNs could suffer the degradation problem: with the network depth increasing, accuracy gets saturated and then degrades rapidly (Simonyan and Zisserman 2014). He et al. (2016) successfully addressed this problem by using deep residual learning. In this study, ResNet152_v2 with 152 layers did not suffer from the degradation problem and it achieved the highest validation ac- curacy of 97.80%; thus, it is an ideal CNN for invertebrate classification.

Fig. 2. Typical errors when testing the M5C model. The blue windows marked with “Clear” are correctly classified as background. The red windows with class name are correctly classified as the corresponding pests. The misclassified windows are highlighted with yellow colour. The numbers in the square brackets are the values of confidence of classification.

Creating a high-quality database for training purpose is one of the most expensive and time-consuming tasks and it is a bottleneck of ma- chine learning applications in the agricultural field (Barbedo 2020). Ma- chine learning tools have evolved to a point in which the data fed to them has a much more prominent role in their success than their intrin- sic characteristics, which explains the relatively similar performances yielded by different models when the data used to train and test them is the same (Kamilaris and Prenafeta-Boldú 2018; Liakos et al. 2018). The classification accuracy in Table 3 to Table 6 clearly show this trend. Conversely, image sets with different data distributions and var- iability can lead to significantly disparate performances even when the same machine learning model is employed, a fact that was reflected in the M10C and M5C database.

The M5C model achieved a positive testing result with an overall ac- curacy of 97.89%, true positive rate of 75.90% and true negative rate of 98.78%. This achievement was obtained by cutting down the intra-class variance of background, reducing the number of classes and enlarging the size of the database. The class of background in the 5C-database was mainly composed of green leaves without flowers and dry plant residuals so to simplify the classification. In real

We found that the wide-angle cameras of smartphones working at 20 cm to 50 cm can capture high-quality images for pest detection. This imaging approach can be automated by using a ground-based plat- form with a robotic arm equipped with a low-cost camera. The process- ing speed was tested on a computer with a 4.2G Hz CPU and the average time for processing a window was 0.21 s. By using parallel processing, this processing rate can support real-time pest detection in the field.

In precision agriculture, detection of invertebrate pests at an earlier stage on crops in the natural farming environments is a nec- essary prerequisite of IPM, however, this task is challenging and corresponding methods have not been well developed. We devel- oped a computer vision method which can achieve proximal detec- tion of invertebrate pests on crops. We found that ResNets outperformed AlexNet and VGG for pest classification and data ar- gument and transfer learning can significantly improve classifica- tion accuracy and speed up convergence. We proposed a novel method to generate a virtual database which not only enabled train- ing a model with high accuracy but also significantly saved the cost and time for collecting training data. Using three-dimensional modelling and gaming technologies to generate large-size training data would boost the applications of machine learning. In the fu- ture, using a large virtual database including millions of images and tens of classes to train a model with high accuracy for pest de- tection will be further investigated. Using multispectral or hyperspectral images to detect well-camouflaged pests would be another research direction. Developing a ground-based robotic sys- tem to conduct proximal detection of pests on crops in real-time for pest management will be considered.

Fig. A1 Example images of 10C-database. The ﬁrst column shows the class names of background (BK), aphid (AP), portuguese millipede (PM), earwig (EA), vineyard snail and white garden snail (SN), slug (SL), honeybee (HB), locust (LO), orange striped oakworm (OO), redlegged earthmites (RE).

