Artificial Intelligence in Geosciences 2 (2021) 20–25

		




Microleveling aerogeophysical data using deep convolutional network and MoG-RPCA
Xinze Li a, Bangyu Wu a,*, Guofeng Liu b, Xu Zhu a, Linfei Wang c
a School of Mathematics and Statistics, Xi'an Jiaotong University, Xi'an, Shaanxi, 710049, PR China
b School of Geophysics and Information Technology, China University of Geosciences, Beijing, 100083, PR China
c China Aero Geophysical Survey and Remote Sensing Center of Nature Resources, Beijing, 100083, PR China



A R T I C L E I N F O

Keywords: Areogeophysical data Microleveling
Deep convolutional network MoG-RPCA
A B S T R A C T

Residual magnetic error remains after standard levelling process. The weak non-geological effect, manifesting itself as streaky noise along flight lines, creates a challenge for airborne geophysical data processing and inter- pretation. Microleveling is the process to eliminate this residual noise and is now a standard areogeophysical data processing step. In this paper, we propose a two-step procedure for single aerogeophysical data microleveling: a deep convolutional network is first adopted as approximator to map the original data into a low-level part with nature geological structures and a corrugated residual which still contains high-level detail geological structures; second, the mixture of Gaussian robust principal component analysis (MoG-RPCA) is then used to separate the weak energy fine structures from the residual. The final microleveling result is the addition of low-level structures from deep convolutional network and fine structures from MoG-RPCA. The deep convolutional network does not need dataset for training and the handcrafted network serves as prior (deep image prior) to capture the low-level nature geological structures in the areogeophysical data. Experiments on synthetic data and field data demon- strate that the combination of deep convolutional network and MoG-RPCA is an effective framework for single areogeophysical data microleveling.





Introduction

As an efficient geophysical prospecting technique, aerogeophysical exploration plays an important role for the survey of resources (Gao et al., 2016). The measurement between large flight line spaces (several Kilo- meters) can cause levelling errors for typical aerogeophysical data (Luo et al., 2012). The non-geological effects still remain after standard levelling, displayed in airborne geophysical images in the form of weak streaky noise along flight lines. It affects the subsequent data processing and interpretation. Microleveling or decorrugation is the process to suppress the residual noise. It has become one of the standard steps for processing of aerogeophysical data, which provides high-quality dataset for subsequent work.
There have been a lot of research on the specific operation methods of microleveling. Classical microleveling methods are based on the space/ Fourier domain filters or the combinations (Syberg, 1972; Minty, 1991; Ferraccioli et al., 1998; Siemon, 2009; Paterson, Grant & Watson, 1998). All the directional filtering microleveling techniques filter out part of the high frequency geological structures along the flight lines (Gorune et al.,
2018). To extract the space localized anomaly details, Fedi et al. (2003) proposed the discrete wavelet transform based magnetic fields decorru- gation methods. Microleveling can also be achieved by statistical methods (Gorune et al., 2018; Davydenko et al., 2014; Zhang et al., 2018). Gao et al. (2021) designed a leveling method based on curvelet transform. Leveling error in data can be effectively removed due to the multi-scale and multi-directional features of curvelet transform.
Areogeophysical data microleveling shares common features from problem definition to operation with stripe noise removal in image processing. For a comprehensive and systematic review of the image destriping methods, please refer to Chang et al. (2020). In recent years, machine learning has been widely used in the field of geophysics (Wang et al., 2020, 2021; Magrini et al., 2020; Cuddy, 2021). Since deep CNN models have successfully solved many geophysical problems (Zhou et al., 2021; Yu et al., 2021; Wu et al., 2021; Huang et al., 2021; Li et al., 2021), the image destriping method using deep CNN models is naturally pro- posed. However, these methods need a large number of training samples, which are not feasible for the microleveling of field aerogeophysical data. Ulyanov et al., 2020 showed that the structure of generator CNN can



* Corresponding author.
E-mail address: bangyuwu@xjtu.edu.cn (B. Wu).

https://doi.org/10.1016/j.aiig.2021.08.003
Received 10 June 2021; Received in revised form 27 August 2021; Accepted 27 August 2021
Available online 8 September 2021
2666-5441/© 2021 The Authors. Publishing Services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the CC BY license
(http://creativecommons.org/licenses/by/4.0/).



capture a great deal of low-level image statistics priors. Using the network as a handcrafted prior, they demonstrated excellent applications in image denoising, super-resolution and inpainting. Without training dataset, Liu et al. (2021) used U-net structure as seismic data prior, and applied to seismic data missing trace reconstruction. Qiu et al. (2021) proposed an unsupervised denoising method for seismic random noise attenuation by using the high and low impedance of ConvNet to noise and seismic data.
In this paper, we propose a two-step procedure for single aero- geophysical image microleveling. After levelling, the residual corruga- tion in the image is weak comparing to the amplitude of the geological structures and contributed to the high frequency components in the two- dimensional image. In our proposed algorithm, the first step is to use the generator network with Deep Image Prior (DIP) (Ulyanov et al., 2020) to extract the strong amplitude of the low-level nature geological structures in the areogeophysical data. The horizontal stripe weak corrugation is then separated from the data mixed with fine scale geological structures. For the second step, MoG-RPCA (Zhao et al., 2014) is adopted to separate the fine scale structures from the residual of the deep convolutional network. And then the separated structure details are added back to the low-level geological structures in first step.
The paper is organized as follows: Section II introduces deep con- volutional network and MoG-RPCA in detail; Section III presents the model structure and parameter selection process used in this paper. In Section IV, we conduct experiments and discuss the results. And in Sec- tion V, we draw our conclusions.

Proposed method

Deep convolutional network

The aim of microleveling is to recover the nature geological structures x* from the corrugated aerogeophysical data x0, which can be expressed as
x* = minE(x; x0)+ R(x);	(1)
x

where x is the input data of the neural network, x* is the microleveling result, E(x; x0) is the loss function, and R(x) is the regularization function which uses to capture the generic regularity of natural geological struc- tures.
In our task, the deep convolutional network model replaces R(x) with an implicit prior captured by a convolutional neural network (Ulyanov et al., 2020), as follows
θ* = argminE(fθ(z); x0); x* = fθ* (z);	(2)
θ

where θ* is the optimal parameter solution obtained through training based on the randomly initialized network parameters, fθ is the mapping (the deep convolutional network with the parameter θ), and z is a random initialized input.
When iterating，the initial value is random weights θ0, and the pa- rameters are updated by minimizing the data item equation (2). Each
iteration is a network training process. The specific iterative process is illustrated in Fig. 1.
Ulyanov et al. (2020) found that CNN presented low impedance to nature image by comparing the reconstruction task loss curves of original image and shuffled image (rearrange the image pixel amplitude randomly). This means the CNN network approximates the “clean” image first when it contains random noise. In this way, it can be used to attenuate the random noise from an image. To show the effectiveness of the method, we conduct similar test on the aerogeophysical data. We use deep convolutional network to reconstruct the original aerogeophysical data and the corresponding shuffled data, and the loss curves are shown in Fig. 2. From Fig. 2, it can be seen that the impedance to the real



Fig. 1. The flow chart of microleveling with deep convolutional network.


Fig. 2. The reconstruction task loss curves of original data (blue line) and shuffled data (red line).

aerogeophysical data is lower than shuffled data, which means deep convolutional network can capture aerogeophysical data statistics prior and can be used for microleveling.
Different from random noise, for aerogeophysical data, the stripe noise is low-frequency along flight lines. However, the corrugated lines are high-frequency for the two-dimensional image. And after standard levelling, the amplitude of the stripe noise is weak comparing to the main geological structures in the aerogeophysical data. Fig. 3 shows the iter- ation process of synthetic data. We observe that because of the Mean Square Error (MSE) loss function, the network will extract nature geological structures with larger amplitude value and separate the stripe noise. For the weak energy fine structures with amplitudes same level as the stripe noise will also be removed. Therefore, the residual separated by deep convolutional network contains weak energy fine structures. For a high-quality microleveling result, the fine structures need to be preserved.

MoG-RPCA

We use MoG-RPCA to separate the fine scale structures from the re- sidual of the deep convolutional network. The robust principal compo- nent analysis (RPCA) is a powerful method, which decomposed the given data matrix into low rank matrix and sparse matrix (Vidal et al., 2016; Huang et al., 2017). The formula of RPCA can be expressed as
Y = L + S;	(3)

where L is a low rank matrix and S is a sparse matrix. RPCA has suc- cessfully solved many machine learning and computer vision problems. Wu et al. (2019) proposed a workflow to attenuate seismic traffic noise using the lp-norm RPCA. Zhao et al. (2014) developed a generative RPCA model under the Bayesian framework by modeling data noise as a mixture of Gaussians (MoG). This method (MoG-RPCA) has shown good effects on random noise removal and background subtraction.


ation of Gaussian distribution. The conjugate priors over the parameters of Gaussian components, μk , τk, and the mixing proportions, π, are rep- resented as
μk , τk ~ N μk μ0 , (β0 τk)—1 Gam(τk|c0, d0 ,	(5)

π ~ Dir(π|α0),	(6)
where Gam(τ|c0, d0) is the Gamma distribution with parameters c0 and d0, and Dir(π|α0) denotes the Dirichlet distribution parameterized by α0 = (α01, ⋯, α0k).
The automatic relevance determination (Babacan et al., 2012) is used
in the low rank component modeling part due to its fast speed and good scalability. The matrix L ∈ Rm×n with rank l ≤ min(m, n) is product of U ∈ Rm×R and V ∈ Rn×R

R
T	T
.r
r=1

where R > l and u.r (v.r ) is the rth column of U(V). Apply the following priors to U and V
u.r ~ N u.r 0, γ—1Im , v.r ~ N v.r|0, γ—1In ,	(8)














Fig. 3. Synthetic data iteration process. (a): The synthetic data. (b): 200 itera- tions. (c): The residual of (b). (d): 1000 iterations. (e): The residual of (d). (f): 5000 iterations. (g): The residual of (f).


MoG-RPCA is generally used when the non-sparse effective infor- mation is low rank, and the sparse random noise is high rank. The Gaussian mixture is used to estimate the noise. However, for aero- geophysical data, the low-rank part is low-frequency stripe noise, the high rank part is the detail geological structures we need. The original nature geological structures of aerogeophysical data does not satisfy the sparse condition. And most of the information will be extracted as the principal component together with the stripe noise, so there is no way to achieve good microleveling effect by directly using the MoG-RPCA to the original data.
However, we find that most of the fine structures retained in the re- sidual after deep convolutional network processing is sparse, which can be extracted by MoG-RPCA. We can use this method to extract the fine structures from the residual and add it to the nature geological structures obtained by using deep convolutional network. Therefore, the micro- leveling of aerogeophysical data can be realized by the two-step pro- cedure we proposed.
To be specific, MoG is a universal approximator with any continuous distribution (Bishop, 2006). The fine scale structures from the residual are complicated, sparse and can be represented by MoG.
Assuming that S is the summation of sij and each sij follows the MoG distribution (Zhao et al., 2014)
K
where Im is the m × m identity matrix. The conjugate prior on each precision variable is
γr ~ Gam(γr |a0, b0)	(9)
Bring equations (4) and (7) into (3) to obtain a complete Bayesian robust principal component analysis model based on MoG, which is short for MoG-RPCA.

Methodology

Network architecture

The generalized network is a full convolution encoder-decoder ar- chitecture. This type of network structure ensures that the size of the output data is same as that of the input data. In order to avoid the loss of valid data details in the pooling operation, skip-connections are also added to the network. To avoid degradation of network's generalization ability, the BatchNorm structure is added to each convolution level, deconvolution level and skip-connections level. We use LeakyReLU as the nonlinear mapping and choose bilinear upsampling in the upsampling operation. We implement the downsampling technique by using average pooling. For the depth of network, considering the microleveling effect and computational cost, the depth of network is set to 5 layers. Although the valid geological structures are different with locations, the stripe noise is same. After testing, we select the network with largest impedance to the low-frequency stripe noise in the data. The specific network structure is shown in Fig. 4.


Parameter settings of MoG-RPCA

Except for the Gaussian number K, all the parameters in the model are set in a non-informative way, to make their influence on the posterior distribution as small as possible. In the experiment, we set μ0 = 0 and
α01, ⋯, α0K , β0 , a0, b0, c0, d0 all set to 10—6 (Zhao et al., 2014). For Gaussian number K, we first run the model with a large K and then verify

ij	X k  ij k
k —1 
whether there are two similar Gaussian components, that is, verify that

s ~	π N s
μ , τ
,	(4)

—1	—1	—1	—1 

k=1
 μi —μj /(|μi| + μj ) and τi  —τj	/( τi	+ τj	) are both smaller than

where K is the number of Gaussian distributions; πk is the weights with
PK
the preset threshold. If yes, we set K to K — 1 and repeat the above operation until we find the appropriate K. The K value used in our

πk ≥ 0 and

k=1
πk = 1; μk , τk—1 represents the mean and standard devi-
experiment is 3.




Fig. 4. The architecture of the deep convolution network. Each blue box denotes multiple feature maps. The number above the boxes represents the number of channels of the feature map. The arrows denote different operations.


Fig. 5. The microleveling process of two-step procedure. (a): The noiseless aerogeophysical data. (b): The added stripe noise. (c): The synthetic data we used. (d): The low-level geological structures obtained by deep convolutional network. (e): The corrugated residual obtained by deep convolutional network. (f): The weak energy fine structures in corrugated residual obtained by MoG-RPCA. (g): The final removed stripe noise after microleveling. (h): Microleveling result obtained by pro- posed method.


Experiments

Synthetic data

The synthetic data experiment is conducted on noiseless aero- geophysical data (Fig. 5a) with stripe noise added (Fig. 5b). The data dimension is 256×256. Before inputting the data into the network, normalize it so that its value is between [0,1]. The initial input data of the network is uniform noise generated between 0 and 0.1 with the same dimensions as the experimental data. The learning rate is set to 0.01.
Fig. 5 shows the microleveling process of our two-step procedure method. First, we use deep convolutional network to process the syn- thetic data (Fig. 5c), extract most of the low-level geological structures (Fig. 5d) and get the corrugated residual (Fig. 5e). By comparing the corrugated residual with the original data, it can be seen that the residual also contains lots of weak energy fine structures. Next step we use MoG- RPCA to further extract the fine structures in the corrugated residual. As can be seen from Fig. 5f and g that almost all the fine structures are
extracted. Finally, the weak energy fine structures extracted by MoG- RPCA (Fig. 5f) is added to the low-level geological structures obtained by deep convolutional network (Fig. 5d) to obtain the micro-leveling result (Fig. 5h).
We use structural similarity (SSIM), MSE and Peak Signal to Noise Ratio (PSNR) to quantitatively evaluate the synthetic aerogeophysical data micro-leveling effect. The metrics are shown in Table 1. Through Table 1, we can find that the presence of stripe noise does have a certain impact on aerogeophysical data and the two-step microleveling proced- ure we proposed is effective.

Field data

The field data used in our experiments is the real aerogeophysical data attached to Geosoft's Oasis montaj software with dimension of 289 × 289, which is shown in Fig. 6. The parameters setting is the same as the synthetic data experiment.
We also use MoG-RPCA and discrete wavelet transform method (Fedi



Table 1
Quantitative evaluation of microleveling result on synthetic data.



Fig. 6. The field aerogeophysical data.

et al., 2003) to directly process the original data. The microleveling result and the low-frequency stripe noise are shown in Fig. 7 and Fig. 8 respectively. We can see that only using MoG-RPCA (Figs. 7c and 8c), the horizontal stripe noise and the nature geological structures are regarded as the principal component together and cannot be separated. The discrete wavelet transform method (Figs. 7d and 8d) effectively removes the stripe noise, but it also removes a lot of geological structures. Our method extracts the effective information further on results of deep convolution network (Figs. 7a and 8a), so the removed energy (Fig. 8b) does not contain any valid information, and the microleveling result (Fig. 7b) is the best.
We also extract same column of data from the four sets of micro- leveling results and plot them in Fig. 9. The results in Fig. 9 further prove that compared with the single deep convolutional network (Fig. 9a), MoG-RPCA (Fig. 9c) and discrete wavelet transform method (Fig. 9d), the two-step microleveling procedure we proposed (Fig. 9b) effectively removes the strip noise and retain more natural geological structures.

Discussions and conclusions

In this paper, we propose a two-step procedure for single aero- geophysical data microleveling, using deep convolutional network and

Fig. 7. Microleveling result. (a): Deep convolutional network. (b): Proposed two-step method. (c): MoG-RPCA. (d): Discrete wavelet transform (Fedi and Florio, 2003).



Fig. 8. Removed stripe noise after microleveling. (a): Deep convolutional network. (b): Proposed two-step method. (c): MoG-RPCA. (d): Discrete wavelet transform (Fedi and Florio, 2003).
MoG-RPCA. The deep convolutional network does not need dataset for training and can capture the low-level nature geological structures in the areo-geophysical data. The specific network structure is determined for microleveling effect, computational cost, and number of parameters. MoG-RPCA is used to further extract the weak energy fine structures in the corrugated residual and obtain the microleveling result. We use synthetic and field areogeophysical data to conduct the experiments and show the effectiveness of the proposed method. The two-step micro- leveling procedure can be used to generate labels for the supervised machine learning microleveling methods.

Funding

This work was supported by National Key R&D Program of China (2017YFC0602204-01).

Declaration of competing interest

We declare that we do not have any commercial or associative in- terest that represents a conflict of interest in connection with the work submitted.


Fig. 9. Comparison of randomly selected data plots. (a): Deep convolutional network. (b): Proposed two-step method. (c): MoG-RPCA. (d): Discrete wavelet transform (Fedi and Florio, 2003).



References

Bishop, C., 2006. Pattern Recognition and Machine Learning. Springer, New York.
Babacan, S., Luessi, M., Molina, R., Katsaggelos, A., 2011. Sparse bayesian methods for low-rank matrix estimation. IEEE Trans. Signal Process. 60 (8).
Chang, Y., Chen, M., Yan, L., Zhao, X., Li, Y., Zhong, S., 2020. Toward universal stripe removal via wavelet-based deep convolutional neural network. IEEE Trans. Geosci. Rem. Sens. 58 (4), 2880–2897.
Cuddy, S., 2021. The benefits and dangers of using artificial intelligence in petrophysics.
Artificial Intelligence in Geosciences 2, 1–10.
Davydenko, A., Grayver, A., 2014. Principal component analysis for filtering and leveling of geophysical data. J. Appl. Geophys. 109, 266–280.
Ferraccioli, F., Gambetta, M., Bozzo, E., 1998. Microleveling procedures applied to regional aeromagnetic data: an example from the Transantarctic Mountains.
Geophys. Prospect. 46 (2), 177–196.
Fedi, M., Florio, G., 2003. Decorrugation and removal of directional trends of magnetic
fields by the wavelet transform: application to archaeological areas. Geophys. Prospect. 51 (4), 261–272.
Gao, W., Shu, Q., Qu, J., et al., 2016. New progress of aerogeophysical techniques abroad.
Geophys. Geochem. Explor. 40 (6), 1116–1124.
Groune, D., Allek, K., Bouguern, A., 2018. Statistical approach for microleveling of aerogeophysical data. J. Appl. Geophys. 159, 418–428.
Gao, L., Yin, C., Wang, N., et al., 2021. Leveling of airborne electromagnetic data based on curvelet transform. Chin. J. Geophys. 64 (5), 1785–1796.
Huang, W., Wang, R., Chen, X., Chen, Y., 2017. Double least-squares projections method for signal estimation. IEEE Trans. Geosci. Rem. Sens. 55 (7), 4111–4129.
Huang, W., Gao, F., Liao, J., Chuai, X., 2021. A deep learning network for estimation of seismic local slopes. Petrol. Sci. 18, 92–105.
Luo, Y., Wang, L., He, H., 2012. Microleveling processing of airborne geophysical data.
Geophys. Geochem. Explor. 36 (5), 851–855.
Liu, Q., Fu, L., Zhang, M., 2021. Deep-seismic-prior-based reconstruction of seismic data using convolutional neural networks. Geophysics 86 (2), 131–142.
Li, K., Chen, S., Hu, G., 2021. Seismic labeled data expansion using variational autoencoders. Artificial Intelligence in Geosciences 1, 24–30.
Minty, B., 1991. Simple micro-levelling for aeromagnetic data. Explor. Geophys. 22 (4), 591–592.
Magrini, F., Jozinovi, D., Cammarano, F., et al., 2020. Local earthquakes detection: a benchmark dataset of 3-component seismograms built on a global scale. Artificial Intelligence in Geosciences 1, 1–10.
Paterson, G., Watson, G., 1998. Microleveling Procedure for Oasis Montaj™.
Qiu, C., Wu, B., Liu, N., Zhu, X., Ren, H., 2021. Deep learning prior model for unsupervised seismic data random noise attenuation. Geosci. Rem. Sens. Lett. IEEE. In press.
Syberg, F., 1972. A Fourier method for the regional-residual problem of potential fields.
Geophys. Prospect. 20, 47–75.
Siemon, B., 2009. Leveling of helicopter-borne frequency-domain electromagnetic data.
Appl. Geophys. 67, 206–218.
Ulyanov, D., Vedaldi, A., Lempitsky, V., 2020. Deep image prior. Int. J. Comput. Vis. 128 (8).
Vidal, R., Ma, Y., Sastry, S., 2016. Generalized principal component analysis. Int. J. Comput. Vis. 27 (12).
Wang, Y., Wang, L., Li, K., et al., 2020. Unsupervised seismic facies analysis using sparse representation spectral clustering. Appl. Geophys. 17 (4), 533–543.
Wang, Y., Liu, Y., She, B., et al., 2021. Data-driven pre-stack AVO inversion method based on fast orthogonal dictionary. J. Petrol. Sci. Eng. 201 (11), 108362.
Wu, B., Meng, D., Zhao, H., 2021. Semi-supervised learning for seismic impedance inversion using generative adversarial networks. Rem. Sens. 13 (5).
Wu, B., Yu, J., Ren, H., Lou, Y., Liu, N., 2019. Seismic traffic noise attenuation using l- norm robust PCA. Geosci. Rem. Sens. Lett. IEEE 17 (11), 1998–2001.
Zhao, Q., Meng, D., Xu, Z., Zuo, W., Zhang, L., 2014. Robust principal component analysis with complex noise. In: Proceedings of the 31th International Conference on Machine Learning (ICML-14), pp. 55–63.
Yu, J., Wu, B., 2021. Attention and hybrid loss guided deep learning for consecutively missing seismic data reconstruction. IEEE Trans. Geosci. Rem. Sens. https://doi.org/ 10.1109/TGRS.2021.3068279. In press.
Zhang, Q., Peng, C., Lu, Y., et al., 2018. Airborne electromagnetic data levelling using principal component analysis based on flight line difference. J. Appl. Geophys. 151, 290–297.
Zhou, R., Cai, Y., Zong, J., et al., 2021. Automatic fault instance segmentation based on mask propagation neural network. Artificial Intelligence in Geosciences 1, 31–35.
