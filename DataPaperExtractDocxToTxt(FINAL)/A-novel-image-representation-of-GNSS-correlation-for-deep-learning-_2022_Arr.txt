Array 14 (2022) 100167










A novel image representation of GNSS correlation for deep learning multipath detection
Antoine Blais a, Nicolas Couellan a,b,âˆ—, Evgenii Munin a
a ENAC, UniversitÃ© de Toulouse, 7 Avenue Ã‰douard Belin, BP 54005, 31055 Toulouse Cedex 4, France
b Institut de MathÃ©matiques de Toulouse, UniversitÃ© de Toulouse, UPS IMT, F-31062 Toulouse Cedex 9, France


A R T I C L E  I N F O	A B S T R A C T

	

Keywords:
Deep learning GNSS
Multipath
Convolutional neural networks Correlation
This paper proposes a novel framework for multipath prediction in Global Navigation Satellite System (GNSS) signals. The method extends from dataset generation to deep learning inference through Convolutional Neural Network (CNN). The process starts at the output of the correlation stage of the GNSS receiver. Correlations of the received signal with a local replica over a (Doppler shift, propagation delay)-grid are mapped into gray scale 2D images. They depict the received information possibly contaminated by multipath propagation. The images feed a CNN for automatic feature construction and multipath pattern detection. The issue of unavailability of a large amount of supervised data required for CNN training has been overcome by the development of a synthetic data generator. It implements a well-established and documented theoretical model. A comparison of synthetic data with real samples is proposed. The complete framework is tested for various signal characteristics
and algorithm parameters. The prediction accuracy does not fall below 93% for ğ¶âˆ•ğ‘ 0 ratio as low as 36 dBHz,
corresponding to poor receiving conditions. In addition, the model turns out to be robust to the reduction of image resolution. Its performance is also measured and compared with an alternative Support Vector Machines (SVM) technique. The results show the undeniable superiority of the proposed CNN algorithm over the SVM benchmark.





Introduction

The dissemination of GNSS receivers in smartphones and cars has made it natural to each of us to have access to our localization at any time. However, the quality of the position calculated by a GNSS equipment may be reduced when the received signal is degraded. This degradation can find its origin in a defect of the signal generation system, carried by the satellite, it is the evil waveform case. The receiving conditions can also be a source of disturbance, this is typically the case when interferences or multipaths are in addition to the useful signal.
More specifically, inside the GNSS chip, the calculation process of the Position Time Velocity (PVT) solution relies on the accurate syn- chronization of the receiver on the signal transmitted by each satellite in view. This is achieved by correlating the received signal with a local replica signal which parameters are under control. The correlation is done against the three unknown parameters of the incoming signal which are required to achieve synchronization: the propagation delay
ğœ, the Doppler shift ğ›¿ğ‘“ (due to the relative motion between the satellite
and the receiver) and the carrier phase ğœƒ. The aim of the receiver is to
find the set of estimators which maximizes the correlation, resulting in
the tightest synchronization of the local replica signal. Any alteration to the signal of interest will skew the estimators and biased the position delivered to the user.
A large amount of research and analysis has been conducted so far to detect, classify, identify and finally mitigate these impairments. As the GNSS receiver has to track the direct signal by mean of a Delay-Locked Loop (DLL) to estimate the propagation delay, multiple methods have been proposed which use the already existing correlator outputs required by this DLL. The narrow correlator technique [1], the earlyâ€“late-slope technique [2], the strobe correlator [3], the double- delta correlator [4] and the multipath intensive delay lock loop [5] are among the most representative methods of this class. They all take advantage of the geometric shape of the auto-correlation function of the PRN code, as defined later on in (2) and (3) and illustrated in Fig. 3, to detect and mitigate the multipath distortion. Their relative simplicity is their principal benefit at the expense of their effectiveness. On the other hand, more sophisticated techniques, yet demanding in hardware re- sources, have been developed. In the statistical approach, the Multipath Estimating Delay Lock Loop (MEDLL) is a reference implementation of the maximum likelihood principle [6]. It matches the correlator outputs


âˆ— Corresponding author at: ENAC, UniversitÃ© de Toulouse, 7 Avenue Ã‰douard Belin, BP 54005, 31055 Toulouse Cedex 4, France.
E-mail address: nicolas.couellan@recherche.enac.fr (N. Couellan).

https://doi.org/10.1016/j.array.2022.100167
Received 18 July 2021; Received in revised form 11 February 2022; Accepted 1 April 2022
Available online 12 April 2022
2590-0056/Â© 2022 The Author(s). Published by Elsevier Inc. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by- nc-nd/4.0/).



with candidates of multipath auto-correlation functions parameterized by magnitudes, delays, and phases. The shortest estimated delay is then retained as the one of the direct path. The frequency domain has also been explored, through the Fourier transform [7] or the wavelet decomposition [8]. Indeed, due to their specific spectral characteristics in comparison to the direct path, the multipath can be identified and excised. However, these methods may damage the signal of interest, especially when the multipath frequencies are close to the spectrum of the direct path.
To overcome the limitations of these classical signal processing methods, Machine Learning (ML) techniques have also been considered. Starting from the early 2000s, some research work has been dedicated to the use of ML techniques to facilitate the error mitigation in GNSS signals. For instance, an hybrid neural network architecture based on multilayer perceptron to mitigate multipath error for Low Earth Orbit (LEO) satellites has been proposed [9]. Later, with the advances of ker- nel methods, the authors of [10] were able to develop a support vector regressor to mitigate multipath on ground fixed Global Positioning Sys- tem (GPS) stations and using signal geometrical features. Other similar studies were conducted with various choices of features construction. For example, in [11,12], non-line of sight (NLOS) multipath detection is carried out using features directly extracted from the correlator output. The recent and significant advances in Artificial Intelligence (AI), and notably in ML, have opened up new perspectives. In [13], using a CNN, a carrier-phase multipath detection model is developed. The authors propose to extract feature map from multi-variable time se- ries at the output of the signal processing stage using 1-dimensional convolutional layers. Deep learning spoofing attack detection in GNSS systems was addressed in the research literature [14] as well. Hand- crafted features based on earlyâ€“late phase, delay and signal level from the correlation output of the tracking loop were used to train a deep fully-connected neural model. A review of the recent applications of ML in GNSS is also proposed in [15], focusing on use cases relevant to the
GNSS community.
The method proposed in this article aims at making use of an efficient CNN architecture for multipath detection. The intent is to exploit the full power of CNN by letting the convolutional mechanism construct its own feature space from the whole correlator information. Indeed, features are not extracted from the signal but the signal is rather transformed into 2D images in the timeâ€“frequency domain. No correlator output signal information is lost during the process and the CNN is able to build its own representation of corrupted/non corrupted correlated signals.
Raw and complete information from the GNSS correlator out- puts are synthesized in 2D-images. The correlation delay and Doppler shift ranges are selected in order to capture complete multipath information. This is a novel approach in comparison to standard multipath mitigation techniques that are using only one dimensional delay correlation information.
A CNN model is used to automatically extract relevant features for multipath detection from the images of correlator outputs. This contributes to the very recent and emergent use of modern ML techniques in the GNSS signal processing field.
The proposed framework covers the generation of image data, the choice of the CNN architecture, its training as well as its validation. Experiments are fully reproducible. To the best of our knowledge such complete workbench is unique in the research community.
The achieved average detection accuracy for realistic multipath parameters ranges in standard receiving conditions is above 93%. This performance has been shown to be robust to the reduction of correlator output image resolution.
The organization of this article follows the framework depicted in Fig. 2. In Section 2, the GNSS signal model used in this work is presented, then the correlation process is introduced and a model of its output is detailed, for both the direct path and the multipath signal. Section 3 exposes the dataset elaboration using a specific software generator. Next, in Section 4, the CNN model proposed in this paper to detect the multipath contamination is explained in detail. In Sec- tion 5, the experiments conducted to assess the proposed technique are exposed and the results discussed. Finally, Section 6 draws conclusions and perspectives from this work.

Problem statement

GNSS signal model

The fundamental principle behind the calculation of the user po- sition by a GNSS receiver is trilateration. It implies the measurement of the geometric distances between the antenna of the receiver and
satellites of known positions. Indeed, a distance ğ‘‘ in particular is
propagation from the satellite to the receiver antenna, ğœ = ğ‘‘âˆ•ğ‘ with ğ‘ estimated through the propagation delay affecting the signal during its
the speed of light. This is made possible by a specific signal structure, recalled in Eq. (1) which models the signal at the antenna port [16]:

The search ranges for the values of the propagation delay and the Doppler shift spans a 2D grid which forms in turn 2D-images at the output of the correlation process, the correlator output in short.
âˆš
ğ‘Ÿ(ğ‘¡) =  2ğ¶ğ·(ğ‘¡ âˆ’ ğœ)ğ‘(ğ‘¡ âˆ’ ğœ) cos(2ğœ‹(ğ‘“ğ‘
where
+ ğ›¿ğ‘“ )ğ‘¡ + ğœƒ) + ğ‘(ğ‘¡)	(1)

Regarding the phase value, the phase estimation error is captured over
[0, 2ğœ‹] by mean of two orthogonal projections. These projections are
carried out by the correlation with the In-phase (I) signal replica on one side and the in-Quadrature (Q) signal on the other. A diagram representing this process is given in Fig. 1. As depicted, the correlation operation is implemented through a product followed by an integrate and dump stage and generates 2D image representations of the I and Q channels. These images coded into 3D tensors will feed a downstream CNN, as it will be seen below.
This study proposes a complete framework to train and assess a CNN model on correlator output 2D-images in order to detect whether the GNSS signal is subject to multipath or not. A graphical representation of this framework is given in Fig. 2. Our technique exploits the full power of deep learning architectures by sampling the complete correlated signal information in the timeâ€“frequency domain and the I and Q chan- nels. Features are not handcrafted but rather constructed automatically by the convolution mechanism that elaborates its own representation of the relevant feature space to detect multipath corrupted signals.
The main contributions of this study can be listed as follows:
ğ¶ is the power of the received signal,
ğ·(ğ‘¡) is the navigation message, binary encoded (Â±1),
ğ‘(ğ‘¡) is the PRN code sequence, specific to each satellite,
ğ‘“ğ‘ is the carrier frequency,
ğ‘(ğ‘¡) is an Additive White Gaussian Noise (AWGN) which accounts
for the thermal noise of the receiver, referred to the antenna port.
The results presented in this paper where established using the PRN code sequences of the GPS L1 C/A legacy signal. However, the authors are confident that they could be generalized to other navigation signals, with the same structure, as no specific assumption has been made on
ğ‘(ğ‘¡).
assessed by its ğ¶âˆ•ğ‘ 0 figure, in other words the ratio of the signal In this model, the receiving condition of a signal in particular is power to the Power Spectral Density (PSD) level ğ‘ 0 of the (white) noise ğ‘(ğ‘¡). Clearly, the accuracy of the estimation of the related distance
ğ‘‘ will depend upon this ğ¶âˆ•ğ‘ 0 ratio. Without any other perturbation
receiver, from a set of distances ğ‘‘ at its disposal, is then completely than the noise, the quality of the final position calculated by the




/ig. 1. Synoptic view of the correlation process. The received signal is correlated with two local replica signals in quadrature whose parameters span a grid. The two correlator outputs form then 2D-images which fed a downstream CNN. The tilde notation indicates the local parameter by opposition to the received signal unknown parameter.


/ig. 2. Proposed framework to train and assess a CNN model on correlator output 2D-images (with references to article sections).


determined by the corresponding set of ğ¶âˆ•ğ‘ 0 ratios, along with the
relative satellitesâ€“receiver geometry though.
A model of the I and Q correlator outputs [16] is as follows:
ğ¼ = ğ´ğ¾(ğ›¥ğœ) cos(ğœ‹ğ›¥ğ‘“ ğ‘‡ğ‘– + ğ›¥ğœƒ) sinc(ğœ‹ğ›¥ğ‘“ ğ‘‡ğ‘–) + ğ‘›ğ¼	(2)
ğ‘„ = âˆ’ğ´ğ¾(ğ›¥ğœ) sin(ğœ‹ğ›¥ğ‘“ ğ‘‡ğ‘– + ğ›¥ğœƒ) sinc(ğœ‹ğ›¥ğ‘“ ğ‘‡ğ‘–) + ğ‘›ğ‘„	(3)
with
ğ‘‡ğ‘– the integration time,
ğ´ a coefficient depending on ğ¶, ğ· and ğ‘‡ğ‘–,
ğ›¥ğœ the propagation delay estimation error,
ğ›¥ğ‘“ the Doppler shift estimation error,
ğ›¥ğœƒ the phase estimation error,
ğ¾(ğ›¥ğœ) the auto-correlation function of the PRN code in ğ›¥ğœ,
ğ‘›ğ¼ and ğ‘›ğ‘„ the noise components.
It is worth noting the sinc function behavior of the correlator outputs as a function of the Doppler shift estimation error.
Fig. 3 gives a graphical representation of the noise-free ğ¼ and ğ‘„
correlator outputs as functions of ğ›¥ğœ and ğ›¥ğ‘“ , for ğ›¥ğœƒ = 0. The shape of
the auto-correlation function of the PRN code can be observed in the
ğ›¥ğ‘“ = 0 plane, for delays in units of Î¼s. The previously mentioned sinc function is visible in the ğ›¥ğœ = 0 plane, for Doppler shifts in units of Hz.

Multipath contamination

As some perturbations can distort the desired signal, the received signal cannot always be modeled simply using Eq. (1). Among these perturbations, multipath is considered to be an important source of degradation [17]. This is especially the case in urban environment, inducing reduced positioning accuracy. Multipath is due to the reflec- tion of the direct signal path on a surface in view of the receiver. As a consequence, a specific multipath can be modeled in the same way as the direct signal in (1):
âˆš
ğ‘š(ğ‘¡) =  2ğ¶MPğ·(ğ‘¡ âˆ’ ğœMP)ğ‘(ğ‘¡ âˆ’ ğœMP) cos(2ğœ‹(ğ‘“ğ‘ + ğ›¿ğ‘“MP)ğ‘¡ + ğœƒMP)	(4)
where ğ¶MP, ğœMP, ğ›¿ğ‘“MP and ğœƒMP have the same definition as in Sec-
tion 2.1, but for the multipath.


/ig. 3. An illustration of the noise-free I and Q correlator output model, ğ›¥ğœƒ set to 0, PRN number to 1.




lar, it is to be noted that ğ¶MP â‰¤ ğ¶ and ğœMP > ğœ. What is more, depending Due to the larger propagation distance of the multipath in particu-
system, there is no reason for ğ›¿ğ‘“MP being equal to ğ›¿ğ‘“ nor ğœƒMP having on the time-varying relative geometry of the satelliteâ€“receiverâ€“reflector the same value as ğœƒ.
In general, a receiver is impacted by multiple multipaths, especially in urban environments where reflectors are numerous. Sometimes, the direct path may even be absent due to an obstruction, for example when high buildings are surrounding the receiver [18]. However, in this study the assumption is made that the direct path is always present and a single multipath will be considered.

Synthetic dataset generation

Availability of GNSS multipath data

In order to test our prediction models, an artificial signal generator was developed. The data are generated in the form of two matrices,







/ig. 4. Empirical auto-correlation and cross-correlation functions of the noise at the correlator output for the I and Q channels, PRN number set to 10.




axes of these matrices are in Doppler shift estimation error ğ›¥ğ‘“ and code one for each of the I and Q channels, according to Eqs. (2) and (3). The delay estimation error ğ›¥ğœ. The output data corresponding to this main
time ğ‘‡ğ‘– in ms and the carrier-to-noise ratio ğ¶âˆ•ğ‘ 0 in dBHz. signal can be parameterized as a function of the coherent integration

Noise sample production

At the correlator output the noise is not only spatially correlated inside each I and Q image, but also cross-correlated between them. The exact derivation of the auto-correlation and cross-correlation func- tions of the noise are still to establish. To overcome this impossibility
analytical model, a workaround has been developed. A signal ğ‘Ÿ(ğ‘¡)(1) to generate the noise contribution at the correlator output from an made of a simple noise term ğ‘(ğ‘¡) is correlated according to the process
described in Fig. 1, as would be a true received signal. This correlation process is implemented in a software GNSS receiver developed by the SIGnal processing and NAVigation (SIGNAV) research team of the
are then collected and stored in a dataset, to be added on demand as ğ‘›ğ¼ ENAC laboratory. The noise samples available at the correlator output and ğ‘›ğ‘„ in Eqs. (2) and (3). Fig. 4 gives an example of empirical auto-
correlation and cross-correlation functions of noise samples for PRN number 10.
for ğ‘‡ğ‘– = 20 ms and ğ¶âˆ•ğ‘ 0 = 45 dBHz is given in Fig. 5, with the corre- An illustration of the noisy output of the synthetic data generator
bit ğ· = âˆ’1 this time, in comparison to Fig. 3 where ğ· = +1). sponding flattened images in Fig. 6 (note the value of the navigation

Assessment of the synthetic data

In order to validate the synthetic data generator its outputs have been compared to the data from an IFEN SX3 GNSS receiver. Two different data collection sessions have been conducted.
The receiver has been fed with a signal produced by a Spirent GSS6560 generator. The scenario implemented in the generator simulates the take-off and initial climb of a commercial aircraft from runway 14L of the Toulouseâ€“Blagnac Airport. The flight happens on Tuesday the 28th of May 2019 from 12:55 UTC. The multipaths are disabled in this scenario.
A high end GNSS antenna has been connected to the receiver. The antenna was set up in a clear view site to avoid multipath contamination. Moreover, only signals from high elevation satel- lites were considered afterwards so that the collected samples could be considered as multipath free. The recording was carried out on Friday the 14th of February 2000 from 08:05 UTC.
/ig. 5. An illustration of the I and Q correlator outputs of the synthetic data generator, PRN number set to 1.


/ig. 6. The I and Q correlator outputs of the synthetic data generator as images, PRN number set to 1.


/ig. 7. Comparison between an output of the synthetic data generator and a real sample from a SX3 receiver, I channel, PRN number set to 1.



In both cases the SX3 receiver sampling frequency was set to 20
MHz. The samples were stored for post-processing by the software
GNSS receiver already mentioned in Section 3.2. The resulting refer- ence images are available on [19] for the two sessions.
Figs. 7 and 8 provide an example of visual comparison of images. It is worth noting that these real data were used only to validate the generator. Indeed, for training purposes it would be unrealistic to produce a sufficient amount of labeled physical signals.

Model for GNSS multipath data generation

The considered model integrates I and Q signals, I and Q multipath and correlated receiver noise. If a multipath signal is received in addition to the main signal, as the signal processing chain is linear, the correlator output can then be considered as the sum of the correlator output of the main signal and the one due to the multipath. In this work, a single multipath contamination is considered. Its contribution






/ig. 8. Comparison between an output of the synthetic data generator and a real sample from a SX3 receiver, Q channel, PRN number set to 1.



(ğ¼MP, ğ‘„MP) to the correlator output is considered as an additional term to the main signal (ğ¼ , ğ‘„), detailed in (2) and (3):
ğ¼ â€² = ğ¼ + ğ¼MP(ğ›¼MP, ğ›¥ğœMP, ğ›¥ğ‘“MP, ğ›¥ğœƒMP)	(5)
ğ‘„â€² = ğ‘„ + ğ‘„MP(ğ›¼MP, ğ›¥ğœMP, ğ›¥ğ‘“MP, ğ›¥ğœƒMP)	(6)
where
ğ›¼MP = ğ¶MPâˆ•ğ¶ < 1 is the multipath attenuation coefficient in comparison to the main path,
ğ›¥ğœMP = ğœMP âˆ’ ğœ > 0 is the code delay in excess to the main signal
delay,
ğ›¥ğ‘“MP = ğ›¿ğ‘“MP âˆ’ ğ›¿ğ‘“ is the difference between the Doppler shift of
the main signal and the multipath,
ğ›¥ğœƒMP = ğœƒMP âˆ’ ğœƒ is the difference between the phase of the main
signal and the multipath.

The I/Q image dataset generation

The data generator has been implemented with the Python lan- guage [19] to produce datasets of I and Q images according to the signal and noise models detailed in Sections 3.2 and 3.4. This soft- ware is referred as the generator in this paper. The generator is fully configurable with respect to the following parameters:
ğ›¼MP, ğ›¥ğœMP, ğ›¥ğ‘“MP and ğ›¥ğœƒMP which entirely define the multipath.
The definition intervals of these parameters are detailed in Ap-
pendix A. Their probability distributions are clarified in Section 5 dedicated to the experiments conducted with the help of the generator,
ğ¶âˆ•ğ‘ 0 ratio which sets the strength of the direct path signal with
respect to the receiver noise,
ğ‘ the number of pixels along each of the delay and Doppler shift
are set in Appendix B. The size of the images is then ğ‘ Ã— ğ‘ axes. The definition domains of the delay and Doppler shift axes pixels. It is important to mention that 2ğ‘ 2 is then the number
of correlators required to implement the technique proposed in this paper. Hence, it is a direct measure of its complexity as the correlation operation is from far the most power and time consuming process in a GNSS receiver,
ğ‘‡ğ‘– the coherent integration time. In this study ğ‘‡ğ‘– = 20 ms, a value corresponding to the duration of one navigation bit ğ· as defined
accuracy for ğœ, ğ›¿ğ‘“ and ğœƒ estimation, without bit transition during in Eq. (1). It ensures the longest correlation time, so the best
the correlation which would otherwise lower the final result.
The experiments led in this work were all done with datasets of 600 pairs of I and Q images, equally split in 300 with multipath and 300 without. However, the generator can provide datasets of arbitrary size and distribution on demand.
Convolutional neural network model

Image classification using CNN

Convolutional neural networks [20] are nowadays considered as among the most powerful tools to learn information from images. This is explained by their computational efficiency and their impressive performance on image information processing. Their learning capabil- ity comes from their ability to automatically construct and combine abstract features from an image. The first layers of the network are composed of convolutional layers. Such layers apply several filters over the various regions of the input image and create feature maps that are various versions of the filtered input image. Several convolutional layers are usually stacked in order to progressively extract meaningful information from the feature maps as the depth of the network is increased. The last layers of the CNN perform the task of classification usually through several layers of neurons with dense connectivity. The weights of each convolution layer filters (also called kernels) and those of the dense layers are learned through supervised learning based on gradient back-propagation. The underlying structure of convolutional layers has the advantage of having sparse connectivity and high weight sharing among neurons, which leads to much greater computational efficiency over fully connected neural networks when image sizes are large or the image resolutions are high.
The above principles are at the heart of CNN architectures. Several additional components are usually integrated in the network. Some Pooling layers are used in order to reduce the dimension of feature maps. A Flatten layer is added in front of the stack of dense layers so as to transform feature map information in vector-like input. To increase the generalization power of the network, a dropout mechanism can also be used to artificially and randomly remove a small portion of the neuron connection within the network. The number and the organization of these various components generate several possible CNN architectures [21].

Choice of a CNN architecture

Among CNN architectures that have proven to be effective in prac- tice [22], the VGG-like architecture has been shown to be one of the best choice for image feature extraction [23]. Despite its number of parameters to be trained compared to other popular and more complex architectures such as Inception V3 [24], ResNet [25] and other variants, it has been widely adopted in practice by the ML community. The architecture is composed of several blocks of convolutional layers that are each separated by a pooling layer that decreases the feature map dimension between blocks. As the depth increases, the dimension of layer input decreases but the number of filters increases. When data are organized on a multi-scale basis, mixing macro and micro patterns, the number of convolutional blocks should be chosen sufficiently large. For the GNSS multipath application, such multi-scale representation is not expected in the signal. This is the reason why the chosen architecture only includes one convolutional block composed of two convolutional layers. It is therefore a very simple instance of a VGG-like network.
VGG architectures are usually implemented for RGB images (mean- ing three input channels: the â€˜Râ€™, â€˜Gâ€™ and â€˜Bâ€™ channels). For the specific case of I/Q images, each input image is actually composed of two channels (I channel + Q channel) that are sharing the GNSS correlation
signal information. Input images are therefore tensors of size ğ‘ Ã— ğ‘
and depth 2. Fig. 9 provides the precise network architecture and layer
dimension used in this study.

Feature maps and heatmaps as a combined mean to visualize the feature space

Although artificial neural networks are usually thought of as black- box models that construct complex decision surfaces that are difficult to




/ig. 9. The CNN architecture used in this study: the input has 2 channels corresponding to ğ¼ and ğ‘„ channels, the first and second convolutional layers have 16 and 32 filters respectively with ReLu activations and the pooling layer is a 2 Ã— 2 max pooling operation layer (this figure has been generated by the NN-SVG tool [26]).

/ig. 10. Examples of feature maps extracted from the last convolutional layer for the generated synthetic data using 3 Ã— 3 filters.


interpret for a specific application, their CNN instances provide some ways to get knowledge on the features that are designed during the training process. The convolutional layers extract meaningful informa- tion in the image for the learning task at hand. Therefore, visualizing the constructed filters after each convolutional layers gives information on the structure of the image that was extracted by the layer, the so- called feature maps. Visualizing the stack of the various feature maps at the output of the various layers will provide insightful knowledge for the user, see Fig. 10 for an example of such stack of filters constructed by the proposed CNN. The figure shows filtered GNSS correlation images from the last convolutional layers. It provides understanding on the regions of the signal image that are extracted for multipath detection. Clearly the various peaks of the signal are considered for the detection task.
In addition, there is also the possibility to build a class-discriminative localization map that will highlight the regions of the input image that are most important for the trained CNN to assign a specific class to the image. Several methods have been proposed along this line [27,28]. The GradCAM method [28], that will be used later in this study, is often used for such purpose as it is applicable to most standard CNN architectures. The main idea is to compute the gradients of the score
resizing will be necessary as the activation map ğ¹ ğ‘ usually does not
have the same dimension as the input. In the experiments, an example
of such GradCam activation map is provided, see Fig. 12. In Section 5.7, such heatmaps are constructed for the multipath detection task in the I/Q images. These visualization tools provide further understanding on the patterns of the correlation signals that are important for multipath discrimination. This information may be used later to further refine the signal frame that carries relevant information.

Experiments

Experimental setup

This section describes the experiments which were conducted to evaluate the performance of the proposed model on the dataset de- scribed in Section 3.5. For each test case the mean, median and stan- dard deviation values of accuracy and F1 score averaged over 20 runs are provided. The range and probability distribution of the multipath parameters as defined in Eqs. (5) and (6) are set, unless otherwise specified, as follows:

ğ‘¦ğ‘ of a specific class ğ‘ with respect to the feature maps ğ´ğ‘˜ âˆˆ Rğ‘¢Ã—ğ‘£ of a
convolutional layer. A class importance weight ğ›¼ğ‘ is then constructed
ğ›¼MP the multipath attenuation coefficient is uniformly distributed

ğ‘˜
by averaging these gradients over the height and width of the feature
map as follows:
ğ›¼ğ‘ =  1  âˆ‘ âˆ‘  ğœ•ğ‘¦ğ‘ .
in [0.1, 0.9],
ğ›¥ğœMP the additional propagation delay of the multipath is also uniformly distributed, in [0, 3ğ‘‡ğ‘ âˆ•2] as explained in Appendix A,
ğ›¥ğ‘“MP the difference in Doppler shift between the direct signal

ğ‘˜	ğ‘¢ Ã— ğ‘£ ğ‘–  ğ‘—
ğ‘˜
ğ‘–ğ‘—
and the multipath is distributed in [âˆ’125, +125] Hz according

These weights are then used to build a weighted combination of acti- vation maps during a forward propagation of a specific input image:
deviation        set        to        125âˆ•3, to a truncated zero-mean normal distribution with a standard

ğ‘
ğºğ‘Ÿğ‘ğ‘‘ğ¶ğ´ğ‘€
= ğ‘…ğ‘’ğ¿ğ‘ˆ
(	)
âˆ‘ ğ›¼ğ‘ ğ´ğ‘˜  .
ğ‘˜
ğ›¥ğœƒMP the difference between the phase of the main signal and the
multipath is uniformly distributed in [0, 2ğœ‹].
The value of the navigation bit ğ·, as defined in Eq. (1), is chosen

Using the ğ‘…ğ‘’ğ¿ğ‘ˆ function will account only for positive influence of class ğ‘. To visualize the corresponding influence in the input space,
randomly with equal probability between âˆ’1 and +1 for each pair of I
and Q images.



Table 1
Mean (ğœ‡) and standard deviation (ğœ) of prediction accuracy and F1-score with respect
to Doppler shift.
Table 4
Mean (ğœ‡) and standard deviation (ğœ) of prediction accuracy and F1-score
with respect to image resolution.




Table 2
Mean (ğœ‡) and standard deviation (ğœ) of prediction accuracy and F1-score with respect
to propagation delay.



Table 3
Mean (ğœ‡) and standard deviation (ğœ) of prediction accuracy and F1-score with respect
to carrier to noise ratio.




ğ¹ 1






Influence of multipath characteristics

In this section, the influence of the multipath characteristics on the
in this way: ğ¶âˆ•ğ‘ 0 = 47 dBHz and the image resolution is 80 Ã— 80. This detection performance is assessed. The experimental conditions are set
corresponds to good observation conditions for the direct path, so that
5 equally spaced values for both the difference in Doppler shift ğ›¥ğ‘“MP the CNN response can be clearly observed. The tests were conducted on
from 0 to 50 Hz and the additional propagation delay of the multipath
ğ›¥ğœMP from 0 to ğ‘‡ğ‘ . The results are represented in Tables 1 and 2. They
show that there is no significant influence of the Doppler shift on the
approaches 0.2ğ‘‡ğ‘ (meaning that the multipath gets close to the main detector performance. On the other hand, when the propagation delay
signal), a slight degradation of the accuracy and F1-score by 6% can be observed.

Influence of the signal to noise ratio C/N0

In this section the influence of ğ¶âˆ•ğ‘ 0 ratio on the detection perfor- mance is assessed. The experimental conditions are the following: ğ‘‡ğ‘– = 20 ms and the image resolution is 80 Ã— 80. The multipath parameters
were conducted on equally spaced values of ğ¶âˆ•ğ‘ 0 ratio from 24 to 46 distributions are identical to those defined in Section 5.2. The tests dBHz. The results are presented on Table 3. From this results the current
values down to 36âˆ’38 dBHz. Then, as expected, the model performance model shows high robustness towards the noisy incoming images for decreases greatly with the value of the ğ¶âˆ•ğ‘ 0 (when I and Q images are
noisier). On Fig. 11, it can be also observed that the standard deviation

Influence of the I/Q image resolution

In order to evaluate the performance of the multipath detector, the proposed algorithm was applied on images of various resolutions
ğ‘ âˆˆ {20, 40, 60, 80} with the intent to estimate the best compromise
performance vs image resolution. The multipath parameters distribu-
tions are the same as before. The results in Table 4 show that the model performance decreases with the image resolution. However, for resolu- tions above 40 pixels per axes, the model classification performance stays above 95%.

Discussion on CNN performance results

The experiments exposed in this section put in light that the perfor- mance of the proposed method is more than adequate in the three axis of importance in our study:
The multipath parameters have been varied over their respective realistic range to assess the validation accuracy. It is not less than 94% in any case,
The ğ¶âˆ•ğ‘ 0 ratio, that reports the receiving condition of the GNSS
signal of interest, was changed from 46 (good) to 24 (poor) dBHz. A failover is observed in the performance around 36 (fairly poor) dBHz, which establishes a quite acceptable operational limit to
our network,
The image resolution, parameterized by ğ‘ the number of points
per axes, has been gradually decreased to measure the robustness
accuracy  of  93%  is  still  achieved  for  ğ‘  =  20. of the algorithm to hardware limitations. Indeed, a validation
With respect to the chosen architecture, the experiments confirm that the detection task at hand does not require large depth as not much multi-scale learning seems to be needed. Indeed, our choice of a quite shallow architecture has proven to be appropriate for efficient multi- path detection.

Comparison with an SVM based detection technique

In this experiment, the performance of the proposed method is compared to the SVM multipath detection technique proposed in [29]. The SVM model constructs a maximum margin separating hyperplane between the two classes of data points (multipath/no multipath). SVM are often used as an alternative method to neural network as they are able to handle non linearly separable data [30,31]. Since the method proposed in [12,29] also collects signal information from the output of the correlator block, from a data collection point of view, it is similar to the technique proposed in this study. However, unlike CNN, they require prior data feature engineering. For comparison purposes, the feature extraction pipeline used in [29] was also implemented on 13 correlator outputs and identical SVM hyperparameters were used. More specifically, the features proposed in [29] were extracted as follows:
Number of local maxima of the correlation outputs per period

of the metrics decreases when the image becomes less noisy. This means that the detection model achieves greater robustness in performance
ğ¹2
= ğ‘ğ‘™ğ‘œğ‘ğ‘ğ‘™âˆ’ğ‘šğ‘ğ‘¥ğ‘–ğ‘šğ‘
ğ›¥ğ‘¡

when the noise decreases. A value of around ğ¶âˆ•ğ‘ 0 = 36 dBHz seems
to be also a threshold after which the performance is much higher.
where ğ›¥ğ‘¡ is the correlation interval taken equal to coherent inte-
gration period.



/ig. 11. Average validation accuracy (left) and average F1 score (right) with respect to carrier to noise ratio ğ¶âˆ•ğ‘ 0 (vertical bars represent standard deviation values).


/ig. 12. Example of heatmaps (bottom) with respect to input image sample (top). (For interpretation of the references to color in this figure legend, the reader is referred to the web version of this article.)


Distribution of the delay of the maximum correlation output
Table 5
Comparison of Mean (ğœ‡) and standard deviation (ğœ)

âˆ‘ğ‘€
ğ¹3 =
ğ‘–=1
(ğ‘¡ğ‘–âˆ’ğ‘šğ‘ğ‘¥ âˆ’ ğ‘¡Ì„)2
of prediction accuracy and F1-score for SVM and CNN models.

Model	SVM	CNN

where ğ‘¡ğ‘–âˆ’ğ‘šğ‘ğ‘¥ is the code delay of the maximum correlation output,
ğ‘¡Ì„ is the mean of the code delay, and ğ‘€ is the number of correlator
output samples.

elevation angle feature (referred as ğ¹1 in their article). This feature However, in [29], the authors have also used a signal strength versus
was not taken into account here as no physical context was introduced in the experiments (receiverâ€™s speed, satellite constellation) since the
generated dataset is synthetic. In the experiment, the ğ¶âˆ•ğ‘ 0 is taken
high (47 dBHz) for both algorithms to assess performance in favorable
noise conditions.
Table 5 reports the results on the mean, median and standard deviation values of accuracy and F1 score1 averaged over 20 runs of both models (SVM and CNN). The results show that the proposed CNN algorithm considerably outperforms the SVM benchmark.

1 The F1 score is not to be confused with the ğ¹1 feature from [29].
ğœ‡ğ´ğ‘ğ‘	0.73	0.98
ğœ‡ğ¹ 1	0.74	0.95




Analysis of CNN automatic feature construction: towards CNN multi- path detection interpretability

The experiments have highlighted the multipath detection power of the CNN when compared to SVM. The automatic feature extraction that takes place in the convolutional layers is able to catch the geometrical dependencies in the data. To further demonstrate this property, activa- tion maps as described in Section 4.3 have been computed using the GradCam technique (see Fig. 12). Clearly, the activation maps show hot detection regions around both signal and multipath peaks (red and yellow areas on the figure) while cold regions that do not carry detection relevant information are marked in dark blue. Distortion around the main signal is highlighted in the activation map in various multipath situations (near or far from main signal peak). When there is no multipath, no distortion appears in the heatmap and a much



more symmetrical pattern can be observed. These observations in a sense validates the detection mechanism and provides a sound and clear interpretation of the CNN decision rule.

Conclusions

In this study, a complete GNSS multipath detection framework based on deep learning has been presented. The proposed method starts with the construction of training image data from synthetic receiver correlation outputs. A precise image generation process based on specific parameter definition intervals is described. This process optimizes the relevance of built-in information within dataset samples. A CNN architecture is then presented and tested with the constructed dataset. For various multipath parameter choices, experiments have demonstrated the detection performance of the proposed deep learn- ing model. Further investigation using heatmaps provides additional understanding of the detection model decision rule and validates its relevance. The results provided in this study are very encouraging and should motivate further research combining ML techniques and GNSS signal processing modeling. More specifically future research will focus on multiple multipath that characterizes urban environment. Investi- gations will also be conducted with deep regression architectures for multipath parameters estimation. The time dynamic of the multipath should also be studied in order to improve current static learning models.

CRediT authorship contribution statement

Antoine Blais: Conceptualization, Methodology, Software, Valida- tion, Formal analysis, Writing. Nicolas Couellan: Conceptualization, Methodology, Validation, Formal analysis, Writing. Evgenii Munin: Conceptualization, Methodology, Software, Validation.

Declaration of competing interest

No author associated with this paper has disclosed any potential or pertinent conflicts which may be perceived to have impending conflict with this work.

Acknowledgments

This project has been partly funded by the SESAR Joint Undertaking under the European Unionâ€™s Horizon 2020 research and innovation programme under grant agreement No 783287. The opinions expressed herein reflect the authorsâ€™ view only. Under no circumstances shall the SESAR Joint Undertaking be responsible for any use that may be made of the information contained herein. The authors are grateful to the Direction Technique de lâ€™Innovation (DTI) of the French Civil Aviation Authority (DGAC) for providing a simulation environment to validate our synthetic generator.

Appendix A. Definition intervals of the multipath parameters

In this section the ranges of variation of the multipath parameters
ğ›¥ğœMP and ğ›¥ğ‘“MP are addressed.
Fig. A.13 represents the correlation between the local signal and the
sum of the direct path and the multipath signals as a function of the delay offset between the local and received signals. The triangle pattern
corresponds to ğ¾(ğ›¥ğœ) (2),(3), the specific auto-correlation function of
the PRN code, with ğ‘‡ğ‘ the bit period of the code. This corresponds to the
limit case when the multipath signal arrives with the same Doppler shift
two circles at âˆ’ğ‘‡ğ‘ âˆ•2 and +ğ‘‡ğ‘ âˆ•2 represent the two extreme correlation and with the same amplitude and phase as the direct path signal. The
points used in a classical GNSS receiver to track the signal of interest. The case without disturbance of these measurement points is realized
when ğ›¥ğœMP > ğ‘‡ğ‘ + ğ‘‡ğ‘ âˆ•2, so ğ›¥ğœMP is taken in [0, 3ğ‘‡ğ‘ âˆ•2].



/ig. A.13. Limit case of the difference in propagation delay between the direct path and the multipath.


/ig. A.14. Limit case of the difference in Doppler shift between the direct path and the multipath.



Fig. A.14 represents the correlation between the local signal and the sum of the direct path and the multipath signals as a function of the fre- quency offset between the local and received signals. This corresponds to the hypothetical limit case when the multipath signal arrives with the same code delay and with the same amplitude and phase as the direct path signal. The disturbance induced in the correlation function of the direct path by the multipath sinc function is considered to be
negligible for |ğ›¥ğ‘“MP| > 2.5âˆ•ğ‘‡ğ‘– as it peaks under 10% of the value at
ğ›¥ğ‘“ = 0. However, depending on the value of ğ‘‡ğ‘–, |ğ›¥ğ‘“MP| is further bounded by the physical value of 800 Hz. This is the maximum Doppler
shift which could be encountered for example by a commercial aircraft in the approach or landing phase at a speed of 140 knots. Finally,
|ğ›¥ğ‘“MP| < min(800, 2.5âˆ•ğ‘‡ğ‘–)
Appendix B. Definition domains of the delay and doppler shift axes

In this part the observation intervals of the propagation delay ğœÌƒ and Doppler shift ğ›¿ğ‘“Ìƒ are defined
into the interval [âˆ’ğ‘‡ğ‘ , 5ğ‘‡ğ‘ âˆ•2] because outside of it the correlation does As it can be seen in Fig. A.13, the propagation delay is included
not contain information neither about direct path nor multipath signals. However, it has been observed in real receivers that a strong multipath
could move forward the value of ğœÌƒ as far as Â±ğ‘‡ğ‘ âˆ•2 in comparison to the
real value of ğœ. So a safety margin has been included in the range of ğœÌƒ which finally spans [âˆ’3ğ‘‡ğ‘ âˆ•2, 3ğ‘‡ğ‘ ].
the upper bound can be taken |ğ›¿ğ‘“Ìƒ| < 5.5âˆ•ğ‘‡ğ‘– because for higher For the Doppler shift observation interval, Fig. A.14 shows that
frequencies the value of the multipath sinc function becomes negligible
depending on the value of ğ‘‡ğ‘–, |ğ›¿ğ‘“Ìƒ| is further bounded by the physical in comparison to its maximum. Nevertheless, as in the previous section, value of 800 Hz: |ğ›¿ğ‘“Ìƒ| < min(5.5âˆ•ğ‘‡ğ‘–, 800 + 2.5âˆ•ğ‘‡ğ‘–).

References

Van Dierendonck AJ, Fenton P, Ford T. Theory and performance of narrow correlator spacing in a GPS receiver. Navigation 1992;39(3):265â€“83.
Townsend B, Fenton P. A practical approach to the reduction of pseudorange multipath errors in a Ll GPS receiver. In: Proceedings of the 7th international technical meeting of the satellite division of the institute of navigation. 1994, p. 143â€“8.
Garin L, Rousseau J-M. Enhanced strobe correlator multipath rejection for code & carrier. In: Proceedings of the 10th international technical meeting of the satellite division of the institute of navigation. 1997, p. 559â€“68.
McGraw GA, Braasch MS. GNSS multipath mitigation using gated and high resolution correlator concepts. In: Proceedings of the 1999 national technical meeting of the institute of navigation. 1999, p. 333â€“42.



Jardak N, Vervisch-Picois A, Samama N. Multipath insensitive delay lock loop in GNSS receivers. IEEE Trans Aerosp Electron Syst 2011;47(4):2590â€“609. http:
//dx.doi.org/10.1109/TAES.2011.6034653.
Townsend B, Van Nee R, Fenton P, Van Dierendonck K. Performance evaluation of the multipath estimating delay lock loop. In: Proceedings of the 1995 national technical meeting of the institute of navigation. 1995, p. 277â€“83.
Zhang Y, Bartone C. Multipath mitigation in the frequency domain. In: PLANS 2004. Position location and navigation symposium (IEEE Cat. No.04CH37556). 2004, p. 486â€“95. http://dx.doi.org/10.1109/PLANS.2004.1309033.
Zhang Y, Bartone C. Real-time multipath mitigation with WaveSmoothTM technique using wavelets. In: Proceedings of the 17th international technical meeting of the satellite division of the institute of navigation. 2004, p. 1181â€“94.
Vigneau W, Nouvel O, Manzano-Jurado M, Sanz C, Carrascosa AH, Roviras D, Juan JM, et al. Neural networks algorithms prototyping to mitigate GNSS multi- path for LEO positioning applications. In: Proceedings of the 19th international technical meeting of the satellite division of the institute of navigation. 2006, p. 1752â€“62.
Phan H, Tan S-L, Mcloughlin I, Vu L. A unified framework for GPS code and carrier-phase multipath mitigation using support vector regression. Adv Artif Neural Syst 2013. http://dx.doi.org/10.1155/2013/240564.
Hsu L. GNSS multipath detection using a machine learning approach. In: Proceed- ings of the 2017 IEEE 20th International conference on intelligent transportation systems. 2017, p. 1â€“6. http://dx.doi.org/10.1109/ITSC.2017.8317700.
Suzuki T, Amano Y. NLOS multipath classification of GNSS signal correlation output using machine learning. Sensors 2021;21(7).
Quan Y, Lau L, Roberts G, Meng X, Zhang C. Convolutional neural network based multipath detection method for static and kinematic GPS high precision positioning. Remote Sens 2018;10(12). http://dx.doi.org/10.3390/rs10122052.
Schmidt E, Gatsis N, Akopian D. A GPS spoofing detection and classification correlator-based technique using the LASSO. IEEE Trans Aerosp Electron Syst 2020;56(6):4224â€“37. http://dx.doi.org/10.1109/TAES.2020.2990149.
Siemuri A, Kuusniemi H, Elmusrati MS, VÃ¤lisuo P, Shamsuzzoha A. Machine learning utilization in GNSSâ€”Use cases, challenges and future applications. In: 2021 International conference on localization and GNSS. 2021, p. 1â€“6. http:
//dx.doi.org/10.1109/ICL-GNSS51451.2021.9452295.
Won J-H, Pany T. Signal processing. In: Springer handbook of global navigation satellite systems. Springer, Cham; 2017, p. 401â€“42. http://dx.doi.org/10.1007/ 978-3-319-42928-1_15.
Kaplan ED, Hegarty CJ. Understanding GPS : principles and applications. 2nd ed.. Artech House; 2006.
Ziedan NI. Improved multipath and NLOS signals identification in urban environments. Navigation 2018;65(3):449â€“62.
Blais A, Munin E, Couellan N. A synthetic GNSS correlator output generator. 2021, URL: https://github.com/AntoineBlaisENAC/Synthetic_GNSS_Correlator_ Output_Generator.git.
Goodfellow I, Bengio Y, Courville A. Deep learning. MIT Press; 2016, http:
//www.deeplearningbook.org.
Shin H, Roth HR, Gao M, Lu L, Xu Z, Nogues I, et al. Deep convolutional neural networks for computer-aided detection: CNN architectures, dataset characteristics and transfer learning. IEEE Trans Med Imaging 2016;35(5):1285â€“98. http://dx. doi.org/10.1109/TMI.2016.2528162.
Voulodimos A, Doulamis N, Doulamis A, Protopapadakis E. Deep learning for computer vision: A brief review. Comput Intell Neurosci 2018;2018:1â€“13. http:
//dx.doi.org/10.1155/2018/7068349.
Simonyan K, Zisserman A. Very deep convolutional networks for large-scale image recognition. In: Bengio Y, LeCun Y, editors. 3rd International conference on learning representations, ICLR 2015, San Diego, CA, USA, May 7-9, 2015, Conference Track Proceedings. 2015, URL: http://arxiv.org/abs/1409.1556.
Szegedy C, Vanhoucke V, Ioffe S, Shlens J, Wojna Z. Rethinking the inception architecture for computer vision. In: 2016 IEEE conference on computer vision and pattern recognition. 2016, p. 2818â€“26. http://dx.doi.org/10.1109/CVPR. 2016.308.
He K, Zhang X, Ren S, Sun J. Deep residual learning for image recognition. In: 2016 IEEE conference on computer vision and pattern recognition. 2016, p. 770â€“8. http://dx.doi.org/10.1109/CVPR.2016.90.
LeNail A. NN-SVG: Publication-ready neural network architecture schematics. J Open Source Softw 2019;4(33):747. http://dx.doi.org/10.21105/joss.00747.
Zhou B, Khosla A, Lapedriza A, Oliva A, Torralba A. Learning deep features for discriminative localization. In: 2016 IEEE conference on computer vision and pattern recognition. 2016, p. 2921â€“9. http://dx.doi.org/10.1109/CVPR.2016.
319.
Selvaraju RR, Cogswell M, Das A, Vedantam R, Parikh D, Batra D. Grad-CAM: Visual explanations from deep networks via gradient-based localization. Int J Comput Vis 2019;128(2):336â€“59.
Suzuki T, Nakano Y, Amano Y. NLOS multipath detection by using machine learning in urban environments. In: 30th International technical meeting of the satellite division of the institute of navigation, vol. 6. Institute of Navigation; 2017, p. 3958â€“67.
Vapnik VN. Statistical learning theory. Wiley-Interscience; 1998.
Scholkopf B, Smola AJ. Learning with kernels: support vector machines, regularization, optimization, and beyond. Cambridge, MA, USA: MIT Press; 2001.
