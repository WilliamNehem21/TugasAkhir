Artificial Intelligence in Agriculture 7 (2023) 35–43











Improving the non-destructive maturity classification model for durian fruit using near-infrared spectroscopy
Sirirak Ditcharoen a, Panmanas Sirisomboon b, Khwantri Saengprachatanarug a, Arthit Phuphaphud a, Ronnarit Rittiron c, Anupun Terdwongworakul d, Chayuttapong Malai a, Chirawan Saenphon a,
Lalita Panduangnate a, Jetsada Posom a,⁎
a Department of Agricultural Engineering, Faculty of Engineering, Khon Kaen University, Khon Kaen 40002, Thailand
b Department of Agricultural Engineering, School of Engineering, King Mongkut's Institute of Technology Ladkrabang, Bangkok 10520, Thailand
c Department of Food Engineering, Faculty of Engineering at Kamphaengsaen, Kasetsart University, Nakhon Pathom 73140, Thailand
d Department of Agricultural Engineering, Faculty of Engineering at Kamphaeng Saen, Kasetsart University, Kamphaeng Saen, Nakhon Pathom 73140, Thailand



a r t i c l e	i n f o


Article history:
Received 10 October 2022
Received in revised form 13 February 2023 Accepted 19 February 2023
Available online 22 February 2023


Keywords: Classification Durian fruit Maturity stage
Near-infrared spectroscopy Non-destructive method
a b s t r a c t

The maturity state of durian fruit is a key indicator of quality before trading. This research aims to improve the near-infrared (NIR) model for classifying the maturity stage of durian fruit using a completely non-destructive measurement. Both NIR spectrometers were investigated: the short wavelength NIR (SWNIR) ranging from 450 to 1000 nm and long wavelength NIR (LWNIR) ranging from 860 to 1750 nm. The samples collected for ex- perimentation consisted of four stages: immaturity, prematurity, maturity, and ripe. Each fruit was scanned at the rind position on the main fertile lobe (header, middle, and tail) and stem. The classification models were devel- oped using three supervised machine learning algorithms: linear discriminant analysis (LDA), support vector ma- chine (SVM), and K-Nearest neighbours (KNN). The analysis results revealed that the use of durian rind spectra only obtained between 83.15% and 88.04% accuracy for the LWNIR spectrometer, while the SWNIR spectrometer provided 64.73 to 93.77% accuracy. The performance of model increases when developing with combination be- tween rind and stem spectra. The LDA model developed using a combination of rind and stem spectra provided the greatest efficiency, exhibiting 97.28% and 100% accuracy for LWNIR and SWNIR spectrometers, respectively. The LDA model is therefore recommended for obtaining spectra from smoothing moving average (MA) + baseline of rind position and when used in combination with the MA + standard normal variance (SNV) of stem spectra. The NIR spectroscopy indicated high potential for non-destructive estimation of the durian maturity stage. This process could be used for quality control in the durian export industry to solve the problem of unripe durian being mixed with ripe fruit.
© 2023 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).






Introduction

Durian is known as the king of fruit and considered to be an impor- tant agricultural product. Thailand is the largest producer and exporter of durian in the world (Ministry of Commerce, 2020). In particular, the Mon Thong variety is famous because it has a sweet, delicious taste. Ac- cording to Thailand's export statistics for fresh durian in 2021, Thailand is the world's number one exporter of durian, with an export volume of around 900,000 tons, valued at about 3 billion dollars. In 2021, the value of Thailand's fresh durian exportation increased by approximately 66.39% compared to 2020 (Export statistics of fresh durian, 2022).

* Corresponding author.
E-mail address: jetspo@kku.ac.th (J. Posom).
Presently, market demand for durian fruit is showing a continuously in- creasing trend, leading to high-value exports.
The quality of durian exports is controlled under the sorting criteria of the Agricultural Commodity Standards of the National Bureau of Ag- ricultural Commodity and Food Standards, Ministry of Agriculture and Cooperatives to retain high quality and meet the specified product stan- dards (Product Standard of Durian Agriculture, 2013). The quality of du- rian fruit for export is based on the analysis of its physical properties and external characteristics such as shape, amount of pulp, cleanliness with- out contamination, external defects, etc. (Somsri, 2013). For example, to be considered a mature fruit, durian must be harvested when its rind and stem colour change from bright green to brown or dark green. How- ever, there is a high possibility that mistakes may be made if the fruit grows on the outside branches of the tree (under sunlight). Fruit ex- posed to extreme sunlight tends to be browner, rougher, and have


https://doi.org/10.1016/j.aiia.2023.02.002
2589-7217/© 2023 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is an open access article under the CC BY license (http:// creativecommons.org/licenses/by/4.0/).



dark brown stems, while the end of the thorn is drier and browner than canopied fruit of the same age (Regional information warehouse, 2023). Therefore, the traditional visual sorting method is subject to potential mistakes.
Most of the durian fruit exported is fresh. To deliver fresh fruit, it is necessary for the fruit to be transported under the appropriate condi- tions, such as by considering the transportation distance. If the transpor- tation distance is short, mature durians could be chosen which can ripen within 1–3 days, while a longer transportation distance requires durians to be at a less mature stage to allow enough time for the fruit to be ripe and ready to eat when it reaches the consumer. Usually, durians are transported under refrigeration to retain the appropriate temperature (Paoumnuaywit, 2019).
According to a recent report, from 2014 to 2015, the value of durian exports reduced from 69.3 to 6.5% because the quality of the fruit failed to meet the required standards (Jintakanon, 2020). If this situation were to continue, it could affect the international export business sector, causing the loss of its existing customer base. If the durians delivered do not meet the required standard, they will be beaten and sold at a lower price causing high-value losses.
To control quality and reduce the problem of young durian being mixed with mature fruit, random selection is employed to determine its chemical values, such as total soluble solid content (TSS) and dry matter (DM), allowing the inside quality of the durian to be thoroughly and accurately assessed. This method also has limitations in terms of cost because such analysis is time-consuming and requires highly- skilled operators. Therefore, it is not popularly used and cannot guaran- tee 100% quality.
Currently, near infrared (NIR) is used as an alternative method and has the potential to predict the quality of durian fruit. Talabnark and Terdwongworakul (2017) used FT-NIR spectroscopy (12,500–3,500 cm−1) to assess the DM content of durian pulp. The PLSR model developed from pulp spectra and whole fruit spectra with sliced rind spectra were compared for performance. The pulp spectra model provided an rp and RMSEP of 0.78% and 3.02%, respec- tively, while the model developed from whole fruit with sliced rind spectra gave an rp and RMSEP of 0.69% and 3.57%, respectively. Somton et al. (2015) applied near-infrared spectroscopy (1100–2500 nm) to classify three maturity classes (immature du- rian, early-mature durian, and mature durian) based on sliced rind and sliced stem absorbance. They concluded that a combination model using both sliced rind and stem spectra data provided the highest classification accuracy (94.4%). The researchers in the fore- going studies employed minimally destructive evaluation by remov- ing the stems and slicing the peel and rind to provide a flat area before scanning. However, since fruit for export should not be scratched or damaged, this application is impractical. To address this research gap, an effective non-destructive test should be devel- oped in the future.
Near-infrared spectroscopy was used to predict the sweetness of du- rian pulp both online (scanning with the sample moving) and offline (scanning with the sample remaining static) (Leepaitoon, 2018). The online model consisted of an R2 of 0.70 and RMSEP of 4.0%. Meanwhile, the offline model had an R2 of 0.81 and RMSEP of 3.27%. The near- infrared (NIR) hyperspectral image technique was used to scan the du- rian pulp, predict DM, and classify the ripeness of the durian pulp (Sharma et al., 2022). For DM prediction, the model developed with a
According to the literature review, the near-infrared spectroscopy (NIRs) techniques demonstrated a high potential to determine the ma- turity stage and ripeness of durian fruit and pulp. The previous research resulted in destructive and minimally destructive fruit. Therefore, this present research attempted to perform evaluation under conditions which were as non-destructive as possible. Therefore, the aim of this study was to apply NIR spectroscopy techniques to classify the maturity of whole durian fruit. The scanning was performed under full non- destructive conditions and two main objectives: 1) to develop a classifi- cation model for measuring the maturity stage of whole durian fruit using SWNIR and LWNIR spectroscopy, and 2) to search for an optimal scanning method for use as a full non-destructive measurement of maturity class.


Materials and methods

Sample collection

Durian fruit (Mon Thong variety) was obtained from the Duangkhae durian orchard, Nam Nao District, Phetchabun Province (Latitude 16.7866, longitude 101.6478). A total of 160 fruit samples were col- lected from five different age periods, based on the days after blooming (DAB), including 80 to 90 (40 fruits), 90 to 100 (40 fruits), 100 to 110 (40 fruits), 110 to 120 (20 fruits), and 120 to 130 (20 fruits). The durian fruit collected was classified into three maturity stages based on DAB: unripe (80 to 100 DAB = 80 fruits), prematurity (101 to 120 DAB =
60 fruits), and mature (121 to 130 DAB = 20 fruits). The samples were taken to the Department of Agricultural Engineering Laboratory, Faculty of Engineering, KhonKaen University. The 30 durian fruits from prematurity stage (60 fruits) were separated randomly and were left to ripen for seven days. They were assigned as the ripe stage (Pimten., 2021; Posomboon, 2020). Durian is a climacteric fruit. The rip- ening is regulated by ethylene which fruit can ripe by itself after har- vesting (Tongdee et al., 1990).
Therefore, the durian fruits of this experiment included four matu- rity stage (unripe: 80 fruits; prematurity: 30 fruits; mature: 20 fruits and ripe stage: 30 fruits). Table 1 shows the durian fruit categorised ac- cording to maturity and number of samples.


NIR scanning

The fruits sample were placed in room temperature at 25 ± 2 °C for one hour before the samples were taken for scanning to eliminate the temperature difference factor. The NIR scanning system consisted of a measurement chamber and two NIR spectrometers. The measurement chamber comprised a black box measuring 60 L × 60 W × 60H cm. Four halogen lamps of 25 W were installed at the top of each corner of the box at an angle 45° from the y-axis (see Fig. 1a). The samples were scanned using two spectrometers: long wavelength (LWNIR) spectrometer (AvaSpec-ULS2048-USB2-VA-50, AVANTES, Netherlands, wavelength range between 860 and 1750 nm), and short wavelength

Table 1
Classification of ripening based on DAB and maturity percentage following to Thongklin (2018).



genetic algorithm (GA) for variable selection provided the highest per- formance with an R2 of 0.878 and RMSEP of 1.22%. For ripeness classifi- cation, the LDA algorithm demonstrated 100% accuracy. Durian (Durio
Stages	Maturity (%)
Day after blooming
Number of samples
Total	Calibration (fruit) set (fruit)


Validation set (fruit)


ducted at room temperature.
DAB: days after blooming.

























Halogen lamp

Fibre optic


Black box








(b)

Fig. 1. Experimental setting, a) front view durian scanning, b) overview scanning and component of tools.


(SWNIR) spectrometer (AvaSpec-NIR256-1.7-EVO, AVANTES, Netherlands, wavelength range between 140 and 1100 nm).
Spectra acquisition consisted of three steps: 1) the light source was turned on and left for 10 min to ensure stable light intensity; 2) the dark and white references were collected; and 3) the samples were scanned using two spectrometers with the same integrating time of 200 ms. Each durian fruit sample was scanned under light windows. The reflectance was calculated as R =  Is — Id , with Is, Id, and Iw being the reflectance intensity of the sample, dark, and white reference, re- spectively. The absorbance (A) was then calculated as A = log(1/R).
The samples were scanned at the stem (Somton et al., 2015) of one side in triplicate to obtain average spectra. The rind (at header, middle, and tail position) of the fertile lobe (which is a completing lobe through- out the length of the fruit and larger than other lobes) was then scanned in triplicate at each position and averaged (Buasub, 2007) (see Fig. 1b and Fig. 2). Therefore, four spectra were obtained for each fruit: header, middle, tail, and stem. The schematic of the developed classification model is shown in Fig. 2.


Dry matter content measurement

After scanning, the peel was removed from the fruit, and the pulp taken at the head, middle, and tail determined for DM using the dry oven method. The samples at each position weighed approximately 10 g according to the digital balance system (ATX224, Shimadzu, Japan) and placed in a hot air oven at 60 °C for 72 h (UF75, Memmert,
Germany) (Saechua et al., 2021). The dried samples were then weighed and the DM calculated following Eq. (1).

W2DM (%) =	× 100	(1)
W1

Where W2 is the final weight of the dried sample (g), W1 is the initial weight (g). Each position was evaluated in triplicate and averaged.

Model development

Fig. 2 displays the schematic for developing the model of maturity classification. To search for the best model, the total data were analyzed using supervised machine learning classification, linear discriminant analysis (LDA), support vector machine (SVM), and k-nearest neigh- bours (KNN). Spectral pre-treatment methods were used for both non-pre-processed (raw spectra) and pre-processed spectra from the 1st derivative (D1) (gap = 5 points, segment = 5 points), 2nd deriva- tive (D2) (gap = 5 points, segment = 5 points), smoothing moving av- erage (MA) + standard normal variance (Smooth + SNV), and MA + baseline offset. For the gap-segment derivative, the gap size indi- cated the spacing between points over which the derivative is com- puted, while the segment size indicated the range over which the points are averaged. Adding a gap and segment to a derivative can help to smooth and eliminate any noise created from the derivative itself.




Fig. 2. Schematic for model development of maturity durian classification.



The training model was created using cross-validation (CV). K-Fold CV is where a given dataset is split into a K number of sections/folds with each fold used as a testing set at some point. Taking the scenario of 5-Fold CV (K = 5). In the first iteration, the first fold is used to test the model and the remainder to train the model. In the second iteration, the second fold is used as the testing set, while the remainder serves as the training set. This process is repeated until each of the five folds have
been used as the testing set (Krishni, 2018). Thus, in this research, k-fold CV of k = 5 used where the training set and test dataset are 75% and 25%, respectively. Therefore, the total sample was 160, calibration set was 117 fruits and validation set were 43 fruits.
In the first step, the models were developed using rind spectra (at positions: a (head), b (middle), and c (tail)), with each position assigned as an individual spectrum sample to choose the optimal



spectra pre-processing technique. Therefore, calibration set had 351 samples (117 × 3 spectra) and validation set had 129 samples (43 × 3 spectra). The rind spectra were examined with either raw or pre-
TP
Precision (%) = TP + FP × 100	(3)

processed spectra. The appropriate spectra pre-processing technique and its corresponding classification algorithm were then obtained.
In the second step, when the optimal spectra pre-processing method
Recall (%) =	TP
TP + FN
× 100	(4)

for rind (from first step) had been obtained, the pre-processed rind spectra were merged with raw stem spectra or stem spectra pre- treated with several techniques (D1, D2, MA + SNV, and MA + baseline offset). A rind spectral sample was merged with a stem sample to form a single sample. These combined spectra were used to generate the clas- sification model again.
The performance of LDA, SVM, and KNN models was evaluated for overall accuracy (Eq. (2)), precision (Eq. (3)), recall (Eq. (4)), and spec- ificity (Eq. (5)). The variables in each equation are true positives (TP), true negatives (TN), false positives (FP), and false negatives (FN) true positives (TP), true negatives (TN), false positives (FP), and false negatives (FN).
TN
Specificity (%) = TN + FP × 100	(5)

This work classifies into four classes i.e. unripe, prematurity, matu- rity, and ripe. For example, if considering for the class of ripe stage; TP, TN, FP, and FN can be described as: TP is the number of samples that are correctly classified for ripe; TN is the number of samples unripe, pre- maturity, and maturity; FN is the number of samples to unripe that are misclassified as ripe, prematurity, and maturity and; FP is the number of samples of unripe, prematurity, and maturity that are misclassified as ripe. Furthermore, the area under the receiver operating characteristic
curve (AUC-ROC) estimated the potential of the classifier to distinguish

Overall accuracy (%) =	TP + TN
TP + TN + FP + FN
× 100	(2)
between classes. The AUC-ROC ranges from 0 to 1, where a score close to 1 indicates that the classifier can successfully divide the positive class




Fig. 3. Spectra of LWNIR spectrometer for durian: (a) raw spectra of durian rind, (b) SNV spectra of durian rind, (c) average spectra of each maturity stage of durian rind, (d) raw spectra of



from the negative. While remained three class was analyzed as same as above mention.
Both SWNIR and LWNIR spectra classification models were gener- ated using the same methodology, and their performance subsequently compared. Finally, using different machine learning classification and pre-processing, the NIR wavelength spectrometer and spectra position model (only rind or combined spectra) provided the highest accuracy and was found to be the best model.

Results and discussion

Spectral characteristics of durian

The raw spectra of durian rind and stem collected using LWNIR (860–1750 nm) and SWNIR (450–1000 nm) are shown in Figs. 3 and 4, respectively. Figs. 3a, b, and c; 4a, b, and c show the raw, SNV, and av- erage raw spectra of the rind, respectively. Figs. 3d, e, a, and f; 4d, e, and f show the raw, SNV, and average raw spectra of the stem, respectively.
Figs. 3a, b, d, and e; and 4a, b, d, and e show the raw spectra and SNV spectra of the rind and stem, respectively. Baseline offset usually oc- curred when scanning the durian fruit samples. The linear baseline
shift affecting the absorption value was tilted up systematically with in- creasing wavelengths (Haruthaithanasan, 2011). The average raw spec- trum of the rind and stem at different maturity stages, i.e., unripe, premature, mature, and ripe, are presented in Figs. 3c and f and 4c and f for LWNIR and SWNIR, respectively. The average raw spectra of both rind and stem were clearly divided into two groups. Group 1: unripe and premature stage and Group 2: mature and ripe stage, showing sim- ilar results. While the average raw spectra between the two groups was obviously different. For example, Fig. 3c and f show that the absorption of the two groups was clearly different at a wavelength of 1250 nm vi- brational band of sugar (Pu et al., 2016). For SWNIR, the average raw rind spectra, at a wavelength of 680 nm vibrational band of anthocya- nins and chlorophyll (Benelli et al., 2021), approximately, clearly had different absorption values at various stages. Whereas Fig. 4f shows that the SWNIR of raw stem spectra clearly had a different absorption curve. As previously mentioned, the different absorption values ap- peared clearly at various maturity stages resulting in the classification model giving good accuracy. The report by Sharma et al. (2022) shows the average spectra SNV pre-treated. At wavelengths of 900 and 1200 nm the spectra can be clearly split according to the different ripe- ness stages of durian. Likewise, Saputro and Handayan (2017)




Fig. 4. Spectra of SWNIR spectrometer for durian: (a) raw spectra of durian rind, (b) SNV spectra of durian rind, (c) average spectra of each maturity stage of durian rind, (d) raw spectra of






Fig. 5. Dry matter of durian pulp according to different maturity stage.


demonstrated that the reflectance profile of a banana was separated in the various maturity stages at wavelengths of around 480, 680, and 960 nm.

Dry matter content

Fig. 5 demonstrates the average DM of durian pulp at different matu- rity stages. The results show that the DM of durian pulp increased with a rise in DAB. However, durian at the ripe stage exhibited a lower DM than at the maturity stage because it was left to ripen naturally from the prematurity. These results are consistent with the findings of Chuenatsadongkot et al. (2018) in that the correlation of the DM per- centage to the DAB shows a clear trend, with the DM percentage tending to increase steadily during the period, rising from 100 to 135 DAB. However, at the ripe stage, the mean percentage DM declined less than at the maturity stage because when the durian is very ripe,
the pulp smears, causing the humidity to be higher than usual. This corresponds to Timkhum and Terdwongworakul (2013), where the percentage DM values are lower because of the high moisture caused by the heavy rainfall. This demonstrates that humidity affects the percentage DM.

Classification models

Table 2 shows the accuracy of validation set of each classification model developed using the full wavelength from LWNIR. The report on the first step indicates that the maturity classification models were developed using durian rind spectra coupled with different algorithms (i.e., LDA, SVM, and KNN) and either raw spectra or pre-treated spectra (i.e., D1, D2, MA + SNV and MA + baseline offset) to find the optimal pre-treatment and its corresponding algorithm. The model efficiency was determined based on precision, recall, specificity, and accuracy. The results show that the optimal pre-treatment of the D2 was suitable for LDA and SVM algorithms, and the MA + SNV was appropriate for KNN, provided precision, recall, specificity, and overall accuracy for val- idation set of 71.45%, 71.62%, 91.61%, and 87.50%; 73.91%, 62.45%,
90.21%, and 88.04%; and 73.91%, 62.45%, 90.21%, and 88.04%, respec-
tively. Finally, the optimal spectra pre-treatment of the D2 was appro- priate for LDA and SVM, while MA + SNV was optimal for KNN.
According to the report on the second step, either the raw or pre- treated stem spectra were matched with the rind spectra (pre-treated using the D2 for LDA and SVM, and MA + SNV for kNN, obtained from the first step). From the hypothesis, it is clear that the combination of rind spectra and stem spectra could improve the classification accuracy. Table 2 indicates that the combined spectra (rind and stem) can in- crease the model performance of all algorithms. The LDA model devel- oped with the rind (D2) + stem (MA + SNV) provided the best classification efficiency, precision, recall, specificity, and overall accu- racy of 96.40%, 91.88%, 97.55%, and 97.28%, respectively. The confusion matrix of validation set was displayed in Table 3.



Table 2
The accuracy of the different classification models for validation set developed using the full wavelength of LWNIR spectrometer.




Table 3
Confusion matrix of the LDA model developed with the rind (2nd derivative) + stem (MA + SNV) for LWNIR spectrometer.
Table                                 5 Confusion matrixof the LDA model developed with the rind (MA + Baseline offset) + stem (MA + SNV) for SWNIR spectrometer.




Table 4 shows the accuracy of validation set of each classification model developed using the full wavelength from SWNIR. The analysis methodology was the same as for LWNIR. The maturity classification models were developed using durian rind spectra. Each algorithm coupled with either raw or pre-processed spectra was used for model development to find the optimal pre-treatment and its corresponding algorithm. The model efficiency was also determined based on preci- sion, recall, specificity, and overall accuracy. The results show that the optimal pre-treatment of the MA + baseline offset was suitable for LDA, the D1 for SVM, and the D2 for KNN, provided precision, recall, specificity, and overall accuracy of 84.70%, 83.48%, 85.30%, 84.39%;
95.99%, 91.99%, 95.56%, 93.77%; and 87.90%, 85.62%, 87.50%, 87.01%,
respectively.
As seen in Table 4, it can be observed that the combined spectra (rind and stem) can increase the model performance for all algorithms. The LDA model developed with the rind (MA + baseline off- set) + stem (MA + SNV) provided the best classification efficiency, obtaining precision, recall, specificity, and overall accuracy of 100%. Table 5 demonstrate the confusion matrix of validation set for SWNIR spectrometer which model ability was higher slightly than that of LWNIR spectrometer.
The NIR-HSI (NIR hyperspectral image) system (900–1600 nm) was
used to create the ripeness classification model (unripe, ripe, and
overripe) following DAB. The model was developed with pulp durian spectra. The results display that the LDA model could be used to classify the durian maturity level, providing high accuracy of 100% (Sharma et al., 2022). Talabnark and Terdwongworakul (2017) reported that FT-NIR spectroscopy (800–2500 nm) can be used to classify the fruit maturity levels (at 101, 108, 115, and 122 days) using sliced rind spectra with a high accuracy level of 87.48%, and the model developed by PLS- DA. Whereas the model established from pulp durian spectra provided higher accuracy than the sliced rind spectra (92.5%). Somton et al. (2015) found that the classification model from NIR (1000–2500 nm) developed using a combination of sliced rind and sliced stem spectra can achieve higher accuracy than models created from only sliced rind spectra (94.4% accuracy). Timkhum and Terdwongworakul (2012) ap- plied visible NIR spectroscopy (350–750 nm) to classify five maturity stages (ranging from 106 to 134 DAB) using sliced rind durian spectra. The model achieved the best classification accuracy (83.30%), while the model developed with sliced stem spectra provided higher accuracy than the sliced rind spectra (94.7%) (Saputro and Handayani, 2017). These results were supported by Praneenararat, who found that the du- rian stem contains liquid sugar compounds that coincide with sweet- ness. The chemical analysis revealed that when the durians began to ripen, the sucrose increased significantly while the glucose and fructose decreased (Praneenararat, 2021). Therefore, the higher accuracy



Table 4
The accuracy of the different classification models for validation set developed using the full wavelength of SWNIR spectrometer.




provided by the durian stem spectra model accords with the results of the present study (see Tables 2 and 4), while the spectra of the stem combined with rind gave high accuracy. Some previous studies have re- sulted in destructive measurement, and others minimally destructive. The aim of the present research was to provide a completely non- destructive measurement. The NIR spectroscopy, combined with machine learning has the potential to be used as a non-destructive measurement.
The application of NIR spectroscopy could reduce operating time, and different positions of rind combined with stem spectra producing a similar performance. Any rind position combined with stem spectra can be used for prediction. The findings reveal that different rind spectra can give similar results. Accurate prediction was achieved by the LDA classification model developed from MA + baseline rind spectra (differ- ent positions, i.e., head, middle, and tail) and MA + SNV stem spectra for SWNIR spectrometer.

Conclusion

This research demonstrates that the NIR spectroscopy technique has the potential to become a full non-destructive measurement. The model was generated using several machine learning techniques for classifica- tion of the maturity (four stages, i.e., immature, premature, mature, and ripe) based on durian DAB. The strength of this research is that the sam- ples are not destroyed during the classification process. The LWNIR and SWNIR coupled with LDA, SVM, and KNN algorithm gave slightly differ- ent performance results. The developed LWNIR model using rind spectra provided overall accuracy of 87.50%, 88.04%, and 88.04%, respec- tively, while the developed SWNIR model using rind spectra gave over- all accuracy of 84.39%, 93.77%, and 87.01%, respectively. The models improved when combined spectra (rind spectra + stem spectra) were used. The LDA model was the best classifier, providing 100% classifica- tion accuracy for SWNIR when the rind spectra were pre-treated with the MA + baseline offset and the stem spectra pre-treated using MA + SNV. The rind spectra at any position combined with the stem spectra is recommended for practical use. The NIR spectrometer could be applied to classify durian maturity. Any spectrometer instruments could be used as it offers the same high efficiency, but SWNIR is recom- mended because it is less expensive than LWNIR.

CRediT authorship contribution statement

Sirirak Ditcharoen: Conceptualization, Methodology, Software, Formal analysis, Investigation, Resources, Data curation, Writing – original draft, Writing – review & editing, Visualization. Panmanas Sirisomboon: Validation, Funding acquisition. Khwantri Saengprachatanarug: Validation, Conceptualization. Arthit Phuphaphud: Validation, Writing – review & editing. Ronnarit Rittiron: Validation. Anupun Terdwongworakul: Validation. Chayuttapong Malai: Validation, Data curation. Chirawan Saenphon: Validation, Data curation, Methodol- ogy. Lalita Panduangnate: Validation, Data curation. Jetsada Posom: Con- ceptualization, Formal analysis, Data curation, Writing – review & editing, Supervision, Project administration, Funding acquisition.

Declaration of Competing Interest

None.

Acknowledgements

This work also supported by Research and Graduate Studies, Khon Kaen University, Thailand; Research Fund for Supporting Lecturer to Admit High Potential Student to Study and Research on His Expert Program Year 2021 from Graduate School, Khon Kaen University, Thailand; the Agricultural Research Development Agency (Public Orga- nisation) [grant number CRP6405031580]. The authors would like to
acknowledge the Department of Agricultural Engineering, Faculty of En- gineering, Khon Kaen University, for providing the equipment and loca- tion for the experiments and King Mongkut's Institute of Technology Ladkrabang for its financial support.

References
Benelli, A., Cevoli, C., Fabbri, A., Ragni, L., 2021. Ripeness evaluation of kiwifruit by hyperspectral imaging. Biosyst. Eng. https://doi.org/10.1016/j.biosystemseng.2021. 08.009.
Buasub, W., 2007. Agricultural extension academic manual (Durian). Bureau Agricult. Commodit. Promot. Manag, accessed 1 August 2022. http://www.agriman.doae.go. th/home/t.n/t.n1/3fruit_Requirement/01_Durian.pdf.
Chuenatsadongkot, T., Treeamnuk, T., Treeamnuk, K., 2018. Comparison of the ability to evaluation of ‘Monthong’ durian maturity using color value from spectrometer and image processing. Int. J. Mech. Prod. Eng. Issue 6. http://iraj.in.
Export statistics of fresh durian, 2022. Office of Agricultural Economics. http://impexp. oae.go.th/service/export.php?S_YEAR=2563&E_YEAR=2565&PRODUCT_GROUP= 5252&PRODUCT_ID=4977&wf_search=&WF_SEARCH=Y.
Haruthaithanasan, V., 2011. NIR-Infraede Technology and Applications in Industries. https://ebook.lib.ku.ac.th/ebook27/ebook/2015RG0071/.
Jintakanon, K., 2020. Solving the problem of maturity durian. Technol. Chaoban, accessed 1 August 2022,  https://www.technologychaoban.com/agricultural-technology/article_
183405.
Krishni, 2018, December 17. K-Fold Cross Validation. DataDrivenInvestor. https:// medium.datadriveninvestor.com/k-fold-cross-validation-6b8518070833.
Leepaitoon, K., 2018. On-line and off-line nir spectroscopy for measuring total soluble solids of durian (Durio zibethinus CV monthong). King Mongkut’s Institute of Technology Ladkrabang. http://ebook.lib.kmitl.ac.th/assets/library/reader/reading/index.php.
Ministry of Commerce, 2020. Durian is the king of Thai fruits. Trade Policy and Strategy Office. http://www.tpso.moc.go.th/sites/default/files/thueriiyn_240863.pdf.
Mohd Ali, M., Hashim, N., Shahamshah, M.I., 2021. Durian (Durio zibethinus) ripeness de- tection using thermal imaging with multivariate analysis. Postharvest Biol. Technol.
176. https://doi.org/10.1016/j.postharvbio.2021.111517.
Paoumnuaywit, P., 2019. How to export durian to be fresh until the destination. Logist. Maneger, accessed 1 August 2022. https://logistics-manager.com/th/how-to-deliver- durian/.
Pimten., 2021, February 15. How to rapid ripen durian. Shopper’s Cafe; Elsevier B.V. https://www.shopat24.com/blog/trending/how-to-make-durian-ripen-quickly-tips-  that-durian-necks-should-not-miss.
Posomboon, M., 2020, February 15. How to cutting durian for 5 days have not come off the bouquet. Kasetgo; Elsevier B.V. https://kasetgo.com/t/topic/8839.
Praneenararat, T., 2021. Durian ripeness indicator from the sugar in its stem.
Chulalongkorn University. https://www.chula.ac.th/en/highlight/50923/.
Product Standard of Durian Agriculture, 2013. National Bureau of Agricultural Commodity and Food Standards. http://e-book.acfs.go.th/Book_view/256.
Pu, H., Liu, D., Wang, L., Sun, D.W., 2016. Soluble solids content and pH prediction and ma- turity discrimination of lychee fruits using visible and near infrared hyperspectral imag- ing. Food Anal. Methods 9 (1), 235–244. https://doi.org/10.1007/s12161-015-0186-7.
Regional information warehouse, 2023. Botanical characteristics. Agricultural Research Development Agency Retrieved 2 August 2022, from https://www.arda.or.th/ kasetinfo/south/durian/controller/index.php.
Saputro, A., Handayani, W. (2017). Wavelength Selection in Hyperspectral Imaging for Prediction Banana Fruit Quality. 2017 International Conference on Electrical Engi- neering and Informatics (ICELTICs 2017) October 18-20, 2017 - Banda Aceh, Indonesia. https://doi.org/10.1109/ICELTICS.2017.8253259.
Saechua, W., Sharma, S., Nakawajana, N., Leepaitoon, K., Chunsri, R., Posom, J., Roeksukrungrueang, C., Siritechavong, T., Phanomsophon, T., Sirisomboon, P., Lapcharoensuk, R., Pornchaloempong, P., 2021. Integrating Vis-SWNIR spectrometer in a conveyor system for in-line measurement of dry matter content and soluble solids content of durian pulp. Postharvest Biol. Technol. 181. https://doi.org/10. 1016/j.postharvbio.2021.111640.
Sharma, S., Sumesh, K.C., Sirisomboon, P., 2022. Rapid ripening stage classification and dry matter prediction of durian pulp using a pushbroom near infrared hyperspectral im- aging system. Measurement 189. https://doi.org/10.1016/j.measurement.2021. 110464.
Somsri, S., 2013. Durian. National Bureau of Agricultural Commodity and Food Standards. https://www.acfs.go.th/standard/download/DURIAN_new.pdf.
Somton, W., Pathaveerat, S., Terdwongworakul, A., 2015. Application of near infrared spectroscopy for indirect evaluation of ‘Monthong’ durian maturity. Int. J. Food Prop. 18 (6), 1155–1168. https://doi.org/10.1080/10942912.2014.891609.
Talabnark, A., Terdwongworakul, A., 2017. Minimally destructive evaluation of durian maturity using near infrared spectroscopy. Thai Soc. Agricult. Eng. J. 23 (2). http:// www.tsae.asia/new/wp-content/uploads/2018/08/v23_2.pdf.
Timkhum, P., Terdwongworakul, A., 2012. Non-destructive classification of durian matu- rity of ‘Monthong’ cultivar by means of visible spectroscopy of the spine. J. Food Eng. 112 (4), 263–267. https://doi.org/10.1016/j.jfoodeng.2012.05.018.
Timkhum, P., Terdwongworakul, A., 2013. Non-destructive classification of durian matu- rity of ‘Monthong’ cultivar by visible spectroscopy of the husk. Thai Society of Agricul- tural. Eng. J. 19, 1–6. www.tsae.asia.
Tongdee, S.C., Suwanagul, A., Neamprem, S., 1990. Durian Fruit Ripening and Effect of Va- riety, Maturity Stage at Harvest, and Atmospheric Gases. International Society for Horticultural Science.
