Journal Pre-proof

Secure and efficient prediction of electric vehicle charging demand using
ğ›¼2-LSTM and AES-128 cryptography

Manish Bharat, Ritesh Dash, K. Jyotheeswara Reddy, A.S.R. Murty, Dhanamjayulu C., S.M. Muyeen


PII:	S2666-5468(23)00079-4
DOI:	https://doi.org/10.1016/j.egyai.2023.100307 Reference:	EGYAI 100307
To appear in:	Energy and AI

Received date : 26 May 2023
Revised date :	8 October 2023
Accepted date : 9 October 2023


electric vehicle charging demand using ğ›¼2-LSTM and AES-128 cryptography. Energy and AI Please cite this article as: M. Bharat, R. Dash, K.J. Reddy et al., Secure and efficient prediction of
(2023), doi: https://doi.org/10.1016/j.egyai.2023.100307.

This is a PDF file of an article that has undergone enhancements after acceptance, such as the addition of a cover page and metadata, and formatting for readability, but it is not yet the definitive version of record. This version will undergo additional copyediting, typesetting and review before it is published in its final form, but we are providing this version to give early visibility of the article. Please note that, during the production process, errors may be discovered which could affect the content, and all legal disclaimers that apply to the journal pertain.
Â© 2023 Published by Elsevier Ltd. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).






Manuscript	Click here to view linked References 





Secure and Efficient Prediction of Electric Vehicle Charging Demand using Î±2-LSTM and AES-128 Cryptography
Manish Bharata,b, Ritesh Dashb, K Jyotheeswara Reddyb, A S R Murtya,
Dhanamjayulu Cc, S M Muyeend
aDepartment of Electrical and Electronics Engineering, Visvesvaraya Technological University, Belgaum, India
bSchool of Electrical and Electronics Engineering, REVA University, Bangalore, India cSchool of Electrical Engineering, Vellore Institute of Technology, Vellore, India dDepartment of Electrical Engineering, Qatar University, Doha,2713, Qatar

Abstract
In recent years, there has been a significant surge in demand for electric ve- hicles (EVs), necessitating accurate prediction of EV charging requirements. This prediction plays a crucial role in evaluating its impact on the power grid, encompassing power management and peak demand management. In this paper, a novel deep neural network based on Î±2 -LSTM is proposed to predict the demand for charging from electric vehicles at a 15-minute time resolution. Additionally, we employ AES-128 for station quantization and secure communication with users. Our proposed algorithm achieves a 9.2% reduction in both the Root Mean Square Error (RMSE) and the mean abso- lute error compared to LSTM, along with a 13.01% increase in demand accu- racy. We present a 12-month prediction of EV charging demand at charging stations, accompanied by an effective comparative analysis of Mean Abso- lute Percentage Error (MAPE) and Mean Percentage Error (MPE) over the last five years using our proposed model. The prediction analysis has been conducted using Python programming.
Keywords: Charging Demand Forecasting, Deep Neural Network, Electric Vehicles, LSTM, Peak Demand Management





Preprint submitted to Elsevier	October 4, 2023











Introduction
The advancement in battery management technology has increased the demand for the sustainable development of Electric Vehicles (EVs) [1, 2]. Government policies for clean energy have further contributed to the rise in demand for EVs. Research shows that more than 3 million electric vehicles were sold globally in 2020, with more than 3.8 million sold in 2021, indicating a significant demand for electrical power in the near future. With the increase in the demand for electric vehicles, the demand for charging stations also increases. The International Energy Agency estimates that only 8% of public EV charging stations are available for the total number of EVs sold. The government has already taken steps to install and increase the number of charging stations in both AC and DC forms by the end of 2022.
However, most EV owners face the problem of charging time. According to estimates, the charging time for EVs is approximately 5 hours for a 7.2 kW charging point. A full charge can only take the driver to a distance of 300-400 km, which can be inconvenient for long trips. This requires proper planning at the charging station, which depends on the demand at that station. Day- ahead forecasting of charging station demand can easily mitigate this issue. Mariz B. Anias et al. [3] investigated demand forecasting using big data analysis. They used traffic and weather data as input parameters for a real- world charging demand forecasting model. Case studies were considered for the forecasting model to predict demand for both slow and fast charging stations. The features taken into account for the analysis were the start charging time and the state of charge of the battery (SoC). The proposed
model could be more suitable for weekdays and weekends.
Ghanbanzadeh et al. [4] proposed a hybrid particle swarm optimization and an ant colony optimization approach to evaluate the demand for charg- ing stations. They conducted a sensitivity analysis on the reliability level of vehicle-to-grid (V2G) systems and addressed the unit commitment problem related to the charging demand patterns of EVs. An important observa- tion from their research is that operating costs increase when compared to reliability limits.
Khayati and Kang [5] applied a household activity pattern approach to optimize the prediction of EV charging demand. They tested their algorithm using two patterns based on the California-state-wide travel survey, develop- ing a sequential activity allocation method and inserting heuristics to solve the problem. Lam and Yin [6], on the other hand, used an activity-time

2












utility theory model to address the inequality problem. They tested their algorithm using expanded heuristics in terms of a space-time network.
Mujidpoun et al. [7] investigated four different algorithms to predict the charging demand of EVs:EVs: Modified Pattern Sequence Forecasting (MPSF), Support Vector Regression (SVR), Random Forest (RF), and Time Weighted Dot Product-Based Nearest Neighbor (TWDP-NN). To study the impact of the EV distribution grid, they used a stochastic model to determine a realistic driving profile for each agent. In contrast, Daina et al. [8] applied a random utility model to integrate an activity-based demand model. They used two data sets to determine charging choices, including the amount of energy, charging time, and charging cost of the EV. Additionally, the model captures the behavioral nuances of charging.
Neaimeh et al. [9] investigated a probabilistic approach to determine the actual EV charging profile and the demand for meters on a distribution network. They studied the spatial and temporal diversity of EV charging demand, which enabled demand-side management and reduced planning un- certainties in stochastic models. In contrast, Nouninejad et al.[10] proposed an activity-based equilibrium scheduling algorithm to find a unique solution for a convergence optimization problem. They claimed that their algorithm could increase the welfare of the social model by 20% compared to V2G. Sandstrom and Binding [11] presented a semi-Markov chain based on a â€trip prediction modelâ€. This model results in a one-to-one charging architecture that ultimately avoids congestion from the distribution grid.
Tan et al. [12] applied distributed optimization to reduce electricity bills and flatten demand response. Xydas et al. [13] proposed a fuzzy model and a data mining model to predict the demand for electric vehicle charging in various geographical regions. Yagetekin and Uzunoglu [14] developed a smart charging management algorithm strategy to avoid overloading trans- formers, which in turn reduces charging costs and demand for electric vehicles charging.
Luo et al. [15] used the Monte Carlo technique in their research paper to forecast EV charging demand in the long term. They tested their algorithm on different types of electric vehicles, such as electric buses and taxis, for the years 2015, 2020, and 2030. By simulating the load demand at charging stations, they identified the need for a proper demand profile for peak and off-peak vehicles. In a similar vein, Xing et al. [16] relied on ride-hailing trip data to predict EV charging demand at charging stations. They took into account both driving and charging characteristics to create their model.
3












Li and Zhang et al. [17] used a probabilistic power flow model to simulate the energy pattern of electric vehicles over a certain period of time. They also applied queuing theory to estimate the overall demand for EV charging facilities. Similarly, Bae and Kwasinski [18] used fluid dynamics to evaluate charging demand patterns at highway charging stations, also utilizing queu- ing theory. They studied simulation results to help vehicle owners optimize their planning for charging infrastructure. The model captures both spatial and temporal dynamics of charging demand.
Louie [19] and Buzoa et al. [20] investigated the performance of a seasonal autoregressive integrated moving average model in predicting the demand for EV charging stations in San Diego, California, and the Netherlands, respec- tively. They demonstrated that the geographical location and characteristics of EV charging stations are crucial factors to accurately predict demand.
Compared to the statistical way of forecasting EV charging demand for a charging station, demand forecasting enabled by Machine Learning (ML) is more accurate. ML algorithms can be used for both short-term and long-term forecasting. Therefore, many researchers have investigated the application of ML, specifically Support Vector Machine (SVM), Decision Tree, and K- Nearest Neighbour (KNN), in predicting charging demand. However, one drawback associated with this technique is that it lacks the ability to simulate the temporal correlation between data, which ultimately leads to inaccurate predictions.
Zhu et al. [21] applied deep learning techniques to evaluate short-term predictions of time series data. They used recurrent neural networks (RNN), long-short-term memory (LSTM) and gated recurrent units (GRUs) to fore- cast demand from one hour to 24 hours ahead. The authors found that GRU and LSTM are effective for fixed time steps, but not for multistep predictions. Sutskever et al. [22] developed a Seq2seq model that takes the output of the first model as input to the second model to predict the result. Meanwhile, Wang et al. [23] designed a SeqST-GN multi-step algorithm to predict the performance of EV charging demand at a charging station.
Xi Chen et al. [24] introduced a two-fold approach to enhance electric ve- hicle (EV) usage and promote renewable energy (RE) utilization. First, they developed a prioritization ranking algorithm for EV drivers based on their driving and charging patterns. Second, they proposed a secure, anonymous, and decentralized blockchain-based EV incentive system involving utilities, EV drivers, charging service providers, and RE providers. This system guides EV users to charge during periods of higher RE generation.
4












In [25], Xi Chen et al. discussed the modeling of the EV charging net- work as a cyber-physical system integrating transportation networks and smart grids. They introduced an EV charging station recommendation al- gorithm and emphasized the importance of deploying a charging scheduling algorithm. This approach transforms EV charging from burdening power grids to serving as a load-balancing tool, facilitating energy transfer within unbalanced distribution grids.
Tianyang et al. [26] presented a stochastic model depicting interactions between charging stations /Battery Swapping Stations (BSS) and taxi/bus fleets. The model incorporates realistic user behavior through various stochas- tic processes and accounts for the dynamic effects of road congestion.
The previous discussion showed that predicting EV charging demand can be achieved either through statistical modeling or by using ML algorithms. However, regardless of the method, data remains the crucial parameter. Ad- ditionally, the discussion identified connection time and battery State of Charge (SoC) as two important parameters that play a vital role in fore- casting demand for EV charging stations. However, none of the papers dis- cussed the integrity and authenticity of data before forecasting or predicting demand for EV charging stations. A recurrent neural network such as Long Short Term Memory (LSTM) can be used to create a sequence model on past data before processing the prediction. The sequence of the model helps to create labeled data for an unbalanced time series model. The labeled data uses two activation functions in the LSTM module to forecast the data. The backpropagation model used in the training of data leads to fading during subsequent iteration. The provision must be given for time series data to preserve the memory after each iteration. This can be achieved by providing some encrypted sequence to the data, which can be validated at the time of handshaking. This paper attempts to incorporate cryptanalysis in evaluating the prediction of EV charging demand at a specific charging station.
Based on the literature survey on the present state of art model, the following key contribution has been proposed in the present research article.
The paper addresses the need for accurate prediction of EV charging requirements due to the increasing demand for electric vehicles. This prediction is crucial for assessing the impact on the power grid, includ- ing power management and peak demand management.
A novel deep neural network based on Î±2-LSTM is proposed for pre- dicting EV charging demand at a 15-minute time resolution.
5












AES-128 encryption is employed for quantizing the station and provid- ing secure communication to the user. This ensures that the communi- cation between the EV charging station and the user remains protected and confidential.
The proposed algorithm outperforms LSTM, achieving a 9.2% reduc- tion in RMSE and mean absolute error, and a 13.01% increase in de- mand accuracy.
The paper aims to demonstrate that a large window size of data can be used without compromising efficiency and error minimization while uti- lizing cryptography for accurate and secure prediction of EV charging demand.

Problem Formulation
The demand for EV charging at a charging station depends largely on the traffic flow on the road. This demand, in turn, is influenced by the roadâ€™s active structure. To analyze charging demand, it is necessary to solve the traffic flow problem. A macroscopic traffic model that considers the energy state of EVs has been developed to evaluate the demand for charging at a station.

Figure 1: Single lane traffic flow diagram

To evaluate the multiphase aspects of traffic flow, the total energy of the system must be considered. This is because the systemâ€™s dynamic equation can be represented by a number of algebraic variables that contribute to its overall dynamics. Let the total energy of the system be

1	2
Ek = 2 Ïv

(1)

6












In eq.(1), Ek represents the kinetic energy present in the system, Ï is the density and V represents the speed of the system. The total energy density can now be expressed as

1	2
Ek = Ek + Ïµ(Ï) = 2 Ïv
c2	2
+ 2Ï (Ï âˆ’ Ïc)
(2)

In eq.(2), Ïc represents the critical density of the system. Again from eq.(2), three different cases can be obtained
Free Flow (Ï â‰¤ Ïc)
Congested Flow (Ïc â‰¤ Ïmax)
Saturated Flow (Ï = Ïmax)
Assuming that the system is congested, Fig.1 shows the Single lane traffic flow diagram. Let PË™i(t) be the position of ith car and Vi(t) be the velocity of ith car. The acceleration or deceleration of a car depends on two parameters:
the velocity of the car in front of it and the distance between them. As a result, the state equation becomes:


PË™i(t) = Vi
VË™i = a(Vi, Viâˆ’1, Piâˆ’1 âˆ’ Pi)
Again, from eq.(2) the velocity can be written as
(3)



Putting eq.(4) in eq.(3)
c2	2
Vi = ET âˆ’ 2Ï (Ï âˆ’ Ïc)
(4)

  E  âˆ’ C2 (Ï âˆ’ Ï )2	âˆ—	2 
i
Eq.(5) represents the derived velocity of the car in terms of its internal energy and the space between the car ahead of it as a function of the den- sity parameter. Let the function â€Fâ€ represent the statistical distribution function as a composite parameter of the position and velocity of the car.
F = f (t, p, v)	(6)
7












so the total energy density becomes
âˆ
Ï(t, p) =
0


(t, p, v)dv	(7)

and that of average velocity becomes
  1 	âˆ
V (t, p) =


(t, p, v)dv	(8)

s(t, p) 0
The 1st differential solution for eq.(8) becomes

df	df
 + v
dt	dp
df
+ a(t, p)
dv

= Q[f, Ï]	(9)

The state equation for eq.(9) can be written as
Ï + (ÏV )p = 0
Vt + V Vp = a(Ï, v, Ïp)


(10)

or
(Ï + (ÏV )p = 0


(11)

Vt + V Vp = 1(VÏ
â€” V ) âˆ’ PË™Ï Ï

Eq.(11) can be further reduced to,
(Ï + (ÏV )p = 0


(12)

Ë™
Vt + V Vp + PÏ Ï
or
= 1(V (Ï) âˆ’ V )

 Ït + " V	Ï # Ïp = 0	(13) on applying convective derivative to eq.(13), it reduces to

 Ït  + V	Ï	  Ïp = 0	(14)


8












Figure 2: Function of number of cars at Charging station

Eq.(14) shows that a huge demand for charging may occur if all drivers start at the same time. Therefore, an optimal solution is required. Let UÂ¯ (t) represents the departure time for minimizing the cost i.e.
u(t, p) = Ï(t, p).V [Ï(t, p)]	(15)
against


Ï + [ÏV (Ï)]p = 0
Ï(t, 0) + V (Ï(t, 0)) = UÂ¯ (t)
(16)

Therefore, the optimal departure rate UÂ¯ (t) with reference to Fig.2 be- comes as a function of number of cars i.e.,
âˆ« UÂ¯ (t) = k	(17)
Convex symmetric plane analysis for eq.17 is shown in Fig.3. It can be observed that instead of optimizing the entire convex surface, optimization can be done for a small section as shown inside the surface.
Free Flow Condition
Here, it is assumed that the combustion of internal energy is negligible. The entire energy of the system depends on the available kinetic energy. Therefore eq.(11) becomes


Ït + (ÏV )p = 0
Vt + V Vp+ = 1[]V (Ï) âˆ’ V ]
(18)

9












or



Figure 3: Convex symmetric plane Analysis

Ï + (ÏV )p = 0
Vt + V dvp = 1[]V (Ï) âˆ’ V ]


(19)

dt	Î¶
or


dtÏ + dp(ÏV ) = 0
V = Vmax âˆ’  Ï (Vmax âˆ’ Vc)
Again, from eq.(20), the minimization function becomes
(20)

u(t, p) = Ï(t, p).Vmax[Ï(t, p)]	(21)
against


Ït + [Ïv(Ï)]p = 0
Ï(t, 0) + Vmax[  Ï (t, 0)]P = UÂ¯ (t)
(22)

Fig. 4 presents the 3-dimensional surface view for the free flow condition under three different values of charging density demand: Ï = 0.30, 0.75 and 0.98.
10












(a)
(b)

(c)
Figure 4: 3-dimension surface view of charging density demand under free flow condition for (a) Ï = 0.30 (b) Ï = 0.75 and (c) Ï = 0.98
11












Congested Flow Condition
Let the critical density become Ïc. Therefore eq.(11)can be written as

(Ït + (ÏcV )p = 0

(23)



t	c P	Î¶	c


Ïc	p

The state eq.(23) can be written as

 Ït  +	VcVp	Ïc  Ïc  =  0	(24)
The 3-dimensional surface view for the free flow condition under Con- gested Flow conditions for different values of charging density demand start- ing from 10% to 90% is presented in Fig. 5, Fig. 6 and Fig. 7 respectively.

Solution Methodology
The free flow condition and congested flow condition show that the min- imization problem is a function of time, P, and density Ï. Again it is also seen that the congestion increases in an exponential manner in the epigraph
(M) as a function of P : Rn â†’ [âˆ’âˆ, âˆ). If this is the case then a situation will arise where M will co-inside with MÂ¯ 1 with a minimum common value around P (0). Mathematically for free flow condition eq.(21) can be written as
u(t, p) = P (0)	(25)
Therefore the reciprocally duality function becomes


s(Î») =	inf
(Vc,Vp)âˆˆepi(Î±2)
or
[Ï + Ï
â€²Ïc ]
(26)



s(Î») =	inf
(Vc,Vp)|vâ‰¤epi(Î±2)
or
[Ï + Ï
â€²Ïc ]
(27)



s(Î») = inf
V â‰¤Rm
â€²
[Ï(v) + Ï
]	(28)

12














(a)
(b)

(c)
Figure 5: 3-dimension surface view of charging density demand under Congested Flow Condition for (a) Ï = 0.10 (b) Ï = 0.20 and (c) Ï = 0.30



13















(a)
(b)

(c)
Figure 6: 3-dimension surface view of charging density demand under Congested Flow Condition for (a) Ï = 0.40, (b) Ï = 0.50 and (c) Ï = 0.60




14















(a)
(b)

(c)
Figure 7: 3-dimension surface view of charging density demand under Congested Flow Condition for (a) Ï = 0.70, (b) Ï = 0.80 and (c) Ï = 0.90




15












Hence, S(Î») = âˆ’Sâˆ—(âˆ’Î»),so
sâˆ—(Î») = sup [Ïâ€²Ïcâˆ’Ï(v)](29)
Î»â‰¤Rm
Eq.(29) behaves the conjugate of eq.(28). Again modifying eq.(29)
Sâˆ— = sup[0. âˆ’ (âˆ’Î») âˆ’ Sâˆ—(âˆ’Î»)] = Sâˆ—Î±2 (0)	(30)
Î»Rm
Eq.(30) shows that there exists a convex plane where it is a double con- jugate of s or there exists an Î±2 plane. Therefore,
P (v) = inf Vc(Ï)	(31)
ÏR
where,
Vc(Ï) = sup[S(Ï, Ïc) âˆ’ Ïc]	(32)
Î»Rm
on modifying eq.(31) to a non constant function f : âˆ’F where existing on inverse function fâˆ’1. Both f and fâˆ’1 are monotone on s-plane, Fig.8 i.e.
1
 1  +  1  = F (u(VcÏx + VpÏy), V (VcÏx + VpÏy))	(33)

VcÏx
or
1
VcÏx



= fâˆ’1 F (u(VcÏx + VpÏy), V (VcÏx + VpÏy))



(34)


 1  +  1 	2

VcÏx
or
VcÏx


1
 1  +  1 


â‰¤ VcÏx + VpÏy
2

VcÏx
VcÏx
(35)


or in general
â‰¤ fâˆ’1 F (u(VcÏx + VpÏy), V (VcÏx + VpÏy)
2

Î£1	â‰¤ fâˆ’1 Î£ v f (Ï ) 
 Î£ V Ï fâˆ’1(Ï )	(36) 16












In eq. (34), both Vc and Vp are increasing variables based on traffic

strategies. Ïx
and Ïy
is a subset of V and Vc
and Vp
â‰¥ 0 such that V (Î±2) +

V (Î±2) = 1, then eq. (36)) can be reduced into


h(vcÏx + vpÏy) = F (u(vcÏx + vpÏy), v(vcÏx + vpÏy))
= Vch(Ïx) + Vph(Ïy)
(37)

Again replacing Ïx â†’ Ï and Ïy â†’ Ïc, eq.(37) becomes
h(vcÏ + vpÏc) = Vch(Ï) + Vph(Ïc)	(38) and that of minimization function becomes

Figure 8: Quadratic plane cross-section analysis for convergence evaluation


minimizie
V sF (s(Ï, Ïc)) + Vp

(T, Î±2) âˆˆ Rn	V sVp +  c	
(39)


s.t s(s, Ïc) < sâˆ’1(s, sc)




inf
c



n Î£ vi


Vp(fâˆ’1(ÏÎ±))

Î£ ViÏifâˆ’1(Ïi)




Eq. (39) represents the desired minimization form.


17












Bench marking Model
In this research work, the proposed method has been compared and an- alyzed with three benchmarking models, such as
Neural Network Auto-Regressive (NNAR) Model
Extreme Learning Machine (ELM)
Long Short-Term Memory (LSTM) Network
Neural network Auto regressive Model
NNAR model is a type of Artificial Neural Network (ANN) model, where lagged values of time series data will be fed into the system for its analysis. It uses some complex algorithms to find the relation between input to output variables. The model tries to build a vectored output as a linear combination of the previous results. Again for a free flow condition, the density of the vehicle near the charging station is a function of car and the time. When they raised the token for charging the vehicle i.e. the output u(t, p) can be modelled as
m
u(t, p)n =	Pt + [Ïv(Ïc]p	(41)
i=1
or
m
u(t, p)n =	Ptâˆ’1D[i] + Ïµn	(42)
i=1
Where u(t, p)n = [u(t, p)1, u(t, p)2,  u(t, p)n], it is the nth sample in S(v)
plane as shown in Fig.8. Here D[i] is a column vector of â€²Ïâ€² by â€²Ïâ€² matrix. Ïµn represents the Gaussian noise function.The mean value of the Gaussian function is subtracted from the generated time stamp.
The model as shown in eq.(42) can be remodeled in terms of multivariate linear regression, such that
u(t, p)n = d(1 : n)nWn + Ïµn	(43) where, d(1 : n)n = d(1 : n)nâˆ’1, d(1 : n)nâˆ’2, ...d(1 : n)nâˆ’m are the multi-
variate model. Eq.(43) can be modified as

18












u = DW + E	(44)
in eq.(44), U represents (N âˆ’ M ) by Ï matrix. D represents (n : 1) by (n : 1)n matrix. This shows that the output layer is a fully connected matrix. The entire NNAR for EV charging demand prediction is shown in Fig.9. In the hidden layer for identifying any non-zero activities, sub-network dynamics can be applied.


Figure 9: NNAR Model for EV charging demand prediction

Extreme Learn Algorithm
ELM is basically used for a single hidden layer. Feed-forward network generally poses only one single hidden layer not in terms of neuron.Fig.10 shows the architecture of ELM with one hidden layer. Here the output of architecture is
m
f (u(t, p) =	Î²n, hn(t, p) = h(p)Î²	(45)
i=1
In the eq.(45) Î² = [Î²1, Î²2	Î²n]n, which represents the n-dimensional vec-
tor as a function of position density of vehicle and h(p) = [h1(t, p), h2(t, p)	hn(t, p)],

19












represents the non-linear feature mapping in s(v) plane as shown in Fig.9.
Again in real-time application, the value of h(p) becomes
h(p) = G(wË™i, wÂ¨i, p)	(46)
Here in eq.(46) wË™i, wÂ¨i represents piece wise continuous function. Both wË™i and wÂ¨i were generated randomly. Here hyperbolic tangent function has been used as a probability distribution function. Therefore the minimization function as shown in eq.(21) under the problem formulation section can be modified as

Figure 10: Extreme Learn Algorithm architecture for Demand Prediction


min
Î²nâˆˆRnXn
or
min
m
||h(p)Î² âˆ’ Ï||2	(47)
i=1
Î£ ||HÎ² âˆ’ Ï||2	(48)

20












In eq.(21), H represents the hidden layer matrix in n-dimension as shown in Fig.10. Similarly, Fig.11 shows the Extreme Learning Algorithm Flow Chart with Back Casting.
ï£®h1(t, p)ï£¹



H = ï£¯
ï£¯ï£°
.
.
.
.	ï£»
(49)




Algorithm 1 Pseudo code for ELM based Charging Demand Forecasting
Require: Charging station Demand Data
Ensure: Prediction Model Mp for EV Charging Station Data Preparation and Redundancy Evaluation
Xin Enter the demand history of Charging station DH as a function of time t.
â€²â†’Xn
in
DH : Nearest Charging Stationi â†’ 1 to DH Xn : Demand History
in Extended Charging Station
Train the Model
MP = fELM (xâ€ )
1	T	â€²	2
Long Short Term Memory Network
Long short-term memory network is a part of RNN. It is basically de- veloped to deal with volatile gradient problems and occurs mainly due to back-propagated error [24]. RNN uses a weighted sum of the input signal to calculate non-linear function whereas LSTM uses a memory called Ct such
that the activation unit.

at = Ï„ttanhct
(50)

j	j	j
21



















































Figure 11: Extreme Learning Algorithm Flow Chart with Back Casting



22












In eq.(50), the information about the cell was stored in Cj state and in hidden layer (Yt). sigmoid type activation functions were used for analysis. In this research paper, the tangent function was used for analysis. The time series data will be modeled as a lagging data set by Q such that (tâˆ’ Q) time series data will be given as an input to the predictor algorithm and that of lagged time data (t) will be considered as a target set.
Therefore, the memory cell can be modeled as


Ct = ftCtâˆ’1 + it Ct
(51)

j	j  j	j  j
This LSTM as shown in Fig.12, will provide an output based on actual input value retrieved from their memory. Basically, the entire operation consists of three gates such as the input gate, that control the flow of the ac- tivation function. The sigmoid layer present here controls the output variable between 0 and 1. The output gate allocates the amount of memory required for the next gate operation. The last gate i.e. forget gate generally removes the information from the cell after its operation. Algorithm 2 represents the Pseudo code for LSTM-based Charging Demand Forecasting.

Figure 12: LSTM Network architecture


Result Analysis
The time series pattern for the captured data set has been collected from a charging station from 2017 to 2021 based on the EV vehicle demand. After the collection of data, a redundancy check has been performed to evaluate

23












Algorithm 2 Pseudo code for LSTM-based Charging Demand Forecasting
Require: Input: Ltâˆ’1|n âˆˆ 0, 1, 2, ...n
Ensure: Output: Lpt|t âˆˆ 0, 1, 2...t âˆ’ 1
1: C â†’ 0
2: t â†’ 0
3: Normalizeu = limn âˆˆ (0, 1, 2...n)Ltâˆ’1|n n âˆˆ (0, 1, 2	n)
4: C1 + Ltâˆ’1 â‰¥ Normalizeu
5: rt â†’ c + Ltâˆ’1.RT
u	p
6: C â†’ 0
7: t â†’ t + 1
8: Lt â†’ htâˆ’1(1 âˆ’ RT )
p	p


any blank data for repetition. Whenever data is not available back casting method has been applied to fill the cell. In a similar way forward casting was also applied to validate the back-casting operation. In order to train the model the entire data sheet was split into two parts a training set and a testing set. As per the standard norms of the machine learning algorithm, the data set was divided into an 80:20 ratio. Spyder-platform in Python has been used for analysis. Similarly, the tense flow-enabled Spyder platform has been chosen for deep neural network analysis.
Table 1: NNAR performance with variation in Neuron level for training and testing set


In order to validate the proposed model, prediction using the three bench- marking models has been evaluated first and then a comparison among the models has been carried out. Keeping in view the maximum allowable win-

24














Table 2: ELM performance for No Prediction (NOP) to Prediction (P)


dow size and not compromising with the noise, the NNAR model has been tested for different hidden neurons starting from 100 to 800. The perfor- mance of the NNAR model is shown in Table 1. Hence it is observed that for hidden layers of 600, 700, and 800 the text time is the same of 22.32 seconds. Similarly, the accuracy train becomes 84.70 average. Similarly, the train- ing time is also saturated for higher-order neural hidden networks. Table 2, shows the NNAR analysis for nonprediction to prediction.
Therefore, to predict the output more accurately cluster formation has been carried out with two major data such as charging demand and multi- step charging demand. Altogether nine slices have been prepared and three round of iteration has been applied to the data set. Table 3 shows the RMS value against nine different slices. Three rounds of iteration have been applied to evaluate the performance iteration, 2 and 3 slices show an overfitting of data. Similar results of overfitting have been observed for slice 7. This also increases the noise in predicting the output. Slice 8 and slice 9 have been considered for predicting the charging demand of EVs on charging stations. Fig.13 shows the monthly prediction of EV demand for actual and predicted based on the NNAR model. 3 months have been considered such as January 2022, February 2022, and March 2022. The algorithm works fine for slices 8 and 9 with lower window size and less amount of noise. Maximum demand for EV charging can be noticed on weekends such as Friday and Saturday.
learn algorithm analysis has been carried out with the same training and testing set. Here random weights were evaluated based on the neuron level. Seven-layer architecture has been designed in accordance with Fig.10 and pseudocode algorithm one has shown under extreme learning algorithm. Table 4 and 5 shows the performance measure based on the random variables.
25















(a)
(b)

(c)
Figure 13: Monthly prediction of EV demand for actual and predicted based on NNAR
(a) Jan 2022 (b) Feb 2022 and (c) Mar 2022




26














Table 3: Comparative analysis of Root Mean Square Error (RMSE) of NNAR for 3 Iter- ation

Table 4: ELM performance with variation in Neuron level for training and testing set


Table 6 shows the EV charging Probability prediction analysis for Î±2 LSTM. As shown in Table 2, it can be found that NOP-3 is 114 .10 which rep- resents that 86% of changes are there where the system can predict actually and that of actual 97.68% accuracy is showing under prediction level-3. Sim- ilarly, no such difference from NOP-1 to P-1 has been noticed in Table 2. Overfitting of data with 75% has been noticed of 105.67 and that of maxi- mum value of 122.13 has been noticed. The root mean square error for t+1,
t+2, and t+3 becomes 144.535, 123.87, and 121.1491 respectively.
Fig.14 , shows the monthly prediction of EV charging demand for 30 days for the first 3 months in a year based on ELA model. Similarly, Fig.15

27















(a)
(b)

(c)
Figure 14: Monthly prediction of EV demand for actual and predicted based on ELA (a) Jan,2022 (b) Feb,2022 and (c) Mar,2022




28












represents the LSTM Box plot for 12 month of prediction.

Figure 15: LSTM Box plot for 12 month of prediction

Fig.16 and Fig.17 show the ELM time lag plot for 7 times and LSTM time lag plot for 3 times based components. Here 7 rounds of back casting have been evaluated to find the relation in charging demand with previous day data. In most of the research, it is just x(n-1). Therefore it will not consider the changes in base level. Here a change has been made by adding the number of vehicles sold under that regional transport office to the previous day of demand. So instead of just x(n-1) it becomes x(n-1)+Pk, where Pk is the probability of a vehicle sold on (n âˆ’ 1)th day. Therefore, the time graph seems to be static and no many changes have been noticed after 100 weight.
A comparative analysis for 5 years from 2017 to 2021 has been presented in Table 7. It shows a comparative analysis for NNAR, ELM and LSTM based on MAPE. Here it can be concluded that LSTM shows better per- formance against all other algorithms. Three characteristics have been con- sidered for analysis such as charging time with a minimum 1Hr. 20M to 2Hr. 50M, SOC level of 37 percent, and traffic congestion an average of performance is shown under average.
29



































Figure 16: ELM time lag plot for 7 time based components




Figure 17: LSTM time lag plot for 3 time-based components



30


































Figure 18: LSTM auto-correlation for actual vs predicted



Table 5: Comparative analysis of Root Mean Square Error (RMSE) of ELM for 3 Iteration



31























Table 6: charging Probability prediction analysis for Î±2 âˆ’ LSTM


Î±2 = 0.77




Î±2 = 0.84




Î±2 = 0.88












32















  



Figure 19: 12 Months prediction of EV charging demand on charging station for the year 2022 based on Î±2 âˆ’ LSTM (a) Jan (b) Feb (C) Mar (d) Apr (e) May (f) June (g) July
(h) Aug (i) Sept. (j) Oct. (k) Nov. (l) Dec.






33














Table 7: Comparative analysis of MAPE for Five year forecast


















Concession




MPE, for 5-year forecasting, is shown under Table 8. Therefore, from Table 7 and Table 8, it can be found that there is a requirement of another parameter, so that tuning can be proper and accurate prediction can be achieved Î±2 LSTM has been applied to the data set for evaluating the per- formance of the algorithm. Four argument and sigma values were evaluated for the proposed algorithm. Fig.18, shows the LSTM auto-correlation for actual with respect to predicted on EV charging station. Fig.19, shows the prediction performance of EV charging demand for 2022 spanning over 12 months.
Fig.20, represents the curve fitting analysis for the neural network auto- regressive model. Fig.20 (a) represents the actual charging demand and the predicted charging demand is presented in Fig. 20 (d). The actual

34














































35












































Figure 20: Curve fitting analysis for Extreme Learning Machine









36












































Figure 21: Curve fitting analysis for LSTM









37












































Figure 22: Curve fitting analysis for Î±2 LSTM









38














Table 8: Comparative analysis of MPE for five year forecasting


charging demand is randomly distributed over the exponential (rectangular hyperbola) population growth model. During the initial hour the actual charging demand has shown some negative charging demand, this is due to over overcharging demand of users for whom the SoC level is above 90%. All those data have been taken into consideration for curve fitting analysis. The randomness and R-value which determine the goodness of fitting values that quantify, how well the model explains the variance in the data have been considered as an evaluation criterion for the statistical analysis of curve fitting. The residual determines the noise level present in the model. After successful iteration, the residuals are shown in Fig. 20 (c). Similarly, curve fitting analysis for extreme learning machine and LSTM is presented in Fig. 21 and Fig. 22 respectively. In continuation to above fig.23 represents the curve fitting analysis of the proposed Î±2-LSTM technique.
-9, represents a comparative analysis of curve-fitting technique statistics among the benchmarking model and the proposed Î±2 -LSTM model. As observed NNARM model possesses 0.061 of R2 value with a randomness of 16.22% and that of the proposed model possesses a randomness of 8.23%. Similarly, ELM and LSTM possess a R2 value of 0.028 and 0.041 respectively.

39














Table 9: Curve fitting analysis of benchmarking Model and proposed Î±2 -LSTM model


Conclusion
This paper presents a novel encrypted deep learning model to predict the EV charging demand at a charging station. A detailed comparison of the classical ML model, deep ML model, and encrypted deep model has been presented. The developed algorithm and model have also been evaluated with real-time data sets from Bengaluru. Two types of forecasting analysis have been carried out such as multi-step and one-month horizon analysis. Based on the result analysis it has been observed that LSTM appears to be robust as compared to others and hence AES-128 with Î±2 hyperplane has been applied with LSTM to predict the charging demand with scheduled locking priority for EV users.
The Î±2 LSTM, also shows that the RMSE has been reduced to 7.12% against 13.37% in the previous literature. Again data noise is another tech- nical constraint that affects the performance of deep ML algorithms. In this research paper the introduction of AES-128 to the LSTM and Î±2 has reduced these issues in describing the prediction.
This research work is dedicated to security constraints in data prediction systems and not related to memory constraint issues. If a data frame of large size is made available then xGboost, prophet method can be analyzed further.

Acknowledgment
The publication of this article was funded Qatar National Library.




40












References
Liao, G. H. W., Luo, X. (2022). Collaborative reverse logistics network for electric vehicle batteries management from sustainable perspective. Journal of Environmental Management, 324, 116352.
Liu, W., Placke, T., Chau, K. T. (2022). Overview of batteries and battery management for electric vehicles. Energy Reports, 8, 4058-4084.
Mariz B. Arias, Sungwoo Bae, Electric vehicle charging demand forecast- ing model based on big data technologies, Applied Energy, Volume 183, 2016, Pages 327-339.
Ghanbarzadeh, Taraneh, Sassan Goleijani, and Mohsen Parsa Moghad- dam. â€Reliability constrained unit commitment with electric vehicle to grid using hybrid particle swarm optimization and ant colony optimiza- tion.â€ 2011 IEEE Power and Energy Society General Meeting. IEEE, 2011.
Khayati, Yashar, and Jee Eun Kang. Modeling intra-household interac- tions for the use of battery electric vehicles. No. 15-4052. 2015.
William H.K. Lam, Yafeng Yin, An activity-based time-dependent traf- fic assignment model, Transportation Research Part B: Methodological,
Volume 35, Issue 6, 2001, Pages 549-574
Mostafa Majidpour, Charlie Qiu, Peter Chu, Hemanshu R. Pota, Rajit Gadh, Forecasting the EV charging load based on customer profile or station measurement?,Applied Energy, Volume 163, 2016, Pages 134-141
Nicol`o Daina, Aruna Sivakumar, John W. Polak, Electric vehicle charging choices: Modelling and implications for smart charging services, Trans- portation Research Part C: Emerging Technologies, Volume 81, 2017,
Pages 36-56
Myriam Neaimeh, Robin Wardle, Andrew M. Jenkins, Jialiang Yi, Graeme Hill, Padraig F. Lyons, Yvonne HuÂ¨bner, Phil T. Blythe, Phil
C. Taylor, A probabilistic approach to combining smart meter and elec- tric vehicle charging data to investigate distribution network impacts, Applied Energy,Volume 157,2015,Pages 688-698

41












	Mehdi Nourinejad, Joseph Y.J. Chow, Matthew J. Roorda, Equilib- rium scheduling of vehicle-to-grid technology using activity based mod- elling, Transportation Research Part C: Emerging Technologies, Volume 65, 2016, Pages 79-96
	Sundstrom, Olle, and Carl Binding. â€Flexible charging optimization for electric vehicles considering distribution grid constraints.â€ IEEE Trans- actions on Smart grid 3.1 (2011): 26-37.
	Z. Tan, P. Yang, A. Nehorai, An optimal and distributed demand re- sponse strategy with electric vehicles in the smart grid, IEEE Trans. Smart Grid 5 (2) (2014) 861â€“869.
	E. Xydas, C. Marmaras, L.M. Cipcigan, N. Jenkins, S. Carroll, M. Barker, A data driven approach for characterising the charging demand of electric vehicles: a UK case study, Appl. Energy 162 (2016) 763â€“771
	B. Yagcitekin, M. Uzunoglu, A double-layer smart charging strategy of electric vehicles taking routing and charge scheduling into account, Appl. Energy 167 (2016) 407â€“419.
	Z. Luo, Y. Song, Z. Hu, Z. Xu, X. Yang and K. Zhan, â€Fore- casting charging load of plug-in electric vehicles in China,â€ 2011 IEEE Power and Energy Society General Meeting, 2011, pp. 1-8, doi: 10.1109/PES.2011.6039317.
	Q. Xing et al., â€Charging Demand Forecasting Model for Electric Ve- hicles Based on Online Ride-Hailing Trip Data,â€ in IEEE Access, vol. 7,
pp. 137390-137409, 2019, doi: 10.1109/ACCESS.2019.2940597.
	G. Li and X. Zhang, â€Modeling of Plug-in Hybrid Electric Vehicle Charging Demand in Probabilistic Power Flow Calculations,â€ in IEEE Transactions on Smart Grid, vol. 3, no. 1, pp. 492-499, March 2012, doi: 10.1109/TSG.2011.2172643.
	Bae, S.,  Kwasinski, A. (2012). Spatial and temporal model for electric vehicle rapid charging demand. 2012 IEEE Vehicle Power and Propulsion Conference,  VPPC 2012,  3(1),  345â€“348.
https://doi.org/10.1109/VPPC.2012. 6422675


42












	Louie, H. M. (2017). Time-series modeling of aggregated electric vehicle charging station load. Electric Power Components and Systems, 45(14), 1498â€“1511. https://doi. org/10.1080/15325008.2017.1336583
	Buzna, L., De Falco, P., Khormali, S., Proto, D., & Straka, M. (2019). Electric vehicle load forecasting: A comparison between time series and machine learning approaches. SyNERGY MED 2019 â€“ 1st Inter- national Conference on Energy Transition in the Mediterranean Area, 1â€“5. https://doi.org/10.1109/SyNERGY-MED.2019.8764110 Calinski,
T., Harabasz, J. (1974). A dendrite method f
	Zhu, J., Yang, Z., Guo, Y., Zhang, J., Yang, H. (2019). Short- term load forecasting for electric vehicle charging stations based on deep learning approaches. Applied Sciences (Sciences), 9(9), 1723. https://doi.org/10.3390/ app9091723
	Sutskever, I., Vinyals, O., Le, Q. V. (2014). Sequence to sequence learn- ing with neural networks. Advances in Neural Information Processing Systems, 4, 3104â€“3112.
	Wang, N., Pan, H., Zheng, W. (2017). Assessment of the incentives on electric vehicle promotion in China. Transporta- tion Research Part A: Policy and Practice, 101(2017), 177â€“189. https://doi.org/10.1016/j.tra.2017.04. 037
	Chen, X., Zhang, T., Ye, W., Wang, Z., Iu, H. H. C. (2020). Blockchain- based electric vehicle incentive system for renewable energy consumption. IEEE Transactions on Circuits and Systems II: Express Briefs, 68(1), 396- 400.
	Chen, X., Wang, H., Wu, F., Wu, Y., GonzÂ´alez, M. C., Zhang, J. (2021). Multimicrogrid load balancing through EV charging networks. IEEE Internet of Things Journal, 9(7), 5019-5026.
Zhang, T., Chen, X., Wu, B., Dedeoglu, M., Zhang, J.,  Trajkovic,
L. (2021). Stochastic modeling and analysis of public electric vehicle fleet charging station operations. IEEE Transactions on Intelligent Trans- portation Systems, 23(7), 9252-9265.


43

Highlights (for review)



Highlights
A novel deep neural network based on Î±2-LSTM for predicting EV charging demand at a 15-minute time resolution is proposed..
The AES-128 for quantizing the station and ensuring secure communication with the user is presented
Proposed algorithm achieves a 9.2% reduction in both the Root Mean Square Error (RMSE) and the mean absolute error compared to LSTM, and a 13.01% increase in demand accuracy
The primary objective of this paper is to demonstrate that a large window size of data can be used without compromising efficiency and error minimization, while also utilizing cryptography for accurate and secure prediction of EV charging demand.






Graphical Abstract (for review)	Click here to access/download;Graphical Abstract (for review);Graphical Abstract (for review).docx



Graphical Abstract (for review)

A novel deep neural network based on Î±2-LSTM for predicting EV charging demand at a 15- minute time resolution is proposed. The AES-128 for quantizing the station and ensuring secure communication with the user is presented. Proposed algorithm achieves a 9.2% reduction in both the Root Mean Square Error (RMSE) and the mean absolute error compared to LSTM, and a 13.01% increase in demand accuracy. The primary objective of this paper is to demonstrate that a large window size of data can be used without compromising efficiency and error minimization, while also utilizing cryptography for accurate and secure prediction of EV charging demand.


Figure: Function of number of cars at charging station











Declaration of interests

â˜’ The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.

â˜’The authors declare the following financial interests/personal relationships which may be considered as potential competing interests:






Highlights
A novel deep neural network based on Î±2-LSTM for predicting EV charging demand at a 15-minute time resolution is proposed..
The AES-128 for quantizing the station and ensuring secure communication with the user is presented
Proposed algorithm achieves a 9.2% reduction in both the Root Mean Square Error (RMSE) and the mean absolute error compared to LSTM, and a 13.01% increase in demand accuracy
The primary objective of this paper is to demonstrate that a large window size of data can be used without compromising efficiency and error minimization, while also utilizing cryptography for accurate and secure prediction of EV charging demand.
