	Electronic Notes in Theoretical Computer Science 92 (2004) 52–64	
www.elsevier.com/locate/entcs




The Station Location Problem on Two Intersecting Lines
Maria Flavia Mammanaa,1 Steffen Meckea,2 Dorothea Wagnerb,3
a Department of Computer and Information Science, University of Konstanz, Germany
b Department of Computer Science, University of Karlsruhe, Germany

Abstract
The station location problem consists of placing new stations along the railway tracks of an existing network in order to increase the number of users. In this paper we consider the problem for a railway network consisting of two intersecting lines forming an angle α. An approach for solving the problem in polynomial time for sufficiently large angles α is presented.
Keywords: station location, covering by discs, facility location


Introduction
The station location problem consists of placing some new stations along the tracks of an existing railway network in order to increase the number of users. The motivation for studying this problem is mainly to increase the attrac- tiveness of train travel for local traffic in an existing railway network. But new stations are costly for the company and new stops will result in a longer travelling time for those people that are already using the network. Therefore our goal is to minimize the number of new stations. Actually, this research was motivated by a collaboration with with the Deutsche Bahn about exactly this

1 flavia@dmi.unict.it
2 mecke@ira.uka.de
3 dwagner@ira.uka.de
4 The authors acknowledge financial support from the EU for the RTN AMORE under grant HPRN-CT-1999-00104.


1571-0661 © 2004 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2003.12.022

question. However, in this paper we look at a somewhat simplified scenario, where we ignore for example actual costs of building stations or travel time.
The problem of locating stops in a transportation network has been studied in several papers, analyzing bus transportation networks as well as railway networks. The problem of locating stops in a bus network is considered in [5,3,4], all dealing with the problem of opening new stops out of a set of given candidates.
The station location problem was first introduced and modelled in [1], where it is shown to be NP-complete. Sch¨obel et al. [6] describe a reduc- tion from the station location problem to a discrete set covering problem. In particular the covering matrix is analyzed, and an efficient solution method is presented for the special case when the railway network consists of one straight line only. Kranakis et al. [2] study the ”MAX gain” problem of finding the placement of a fixed number of k stations such that the number of covered settlements is maximized. In [7] the problem of covering population areas is presented. While in the previous papers settlements are represented as points, in [7] demand regions are considered, and an efficient algorithm for finding an optimal solution in the case when the railway network consists of one straight line is given.
While the station location problem for one line segment is solvable in polynomial time, in general the problem becomes NP-hard for two or more line segments [1]. However, a heuristic approach to solve the station location problem in practice consists of a decomposition of the railway network into independent line segments. Then, for a good solution of the problem the common area between line segments needs to be considered in more details. The problem considered in this paper may be viewed as a first step towards this approach.
The paper is organized as follows. In Section 2 the station location prob- lem is modelled as a minimization problem and the variant of the problem studied in this paper is defined. In Section 3, we define the problem of cov- ering a common region of two lines by discs and characterize the solutions to this problem depending on the angle between the two lines. In Section 4 we approach the station location problem on two intersecting lines and apply results of the covering by discs problem to obtain optimal solutions for the station location problem for sufficiently large values of the angle α formed by the two lines.

Problem definition





A railway network and a set P of settlements are given. A settlement Pi ∈P is covered by the railway network if there is a station at distance less than or equal to a fixed radius R from Pi. We assume that none of the settlements in	 is currently covered by an existing station, that each settlement in can be covered by a new station, and that stations can be placed anywhere along the tracks. The goal is to select as few new stations as possible to cover all the settlements. Precisely, given a set S of points in the plane, define cover (S)= {x ∈ R2 : d(x, S) ≤ R} as the points at distance less than or equal to	from	, the distance	being the Euclidian distance. Then the station location problem can be modelled as the following minimization problem:
Station Location: Given a geometric graph G = (V, E), i.e. a set V of vertices in the plane and a set E of edges represented as straight line segments, a set P of points in the plane and a fixed radius R. Find a minimum number of vertices S on the edges such that P ⊆ cover (S).
The NP-hardness of the station location problem has been shown [1] by a transformation from the geometric covering problem. The geometric covering by discs is defined as follows: Given a set P of points in the plane, find the minimum number of discs D that cover P, where a point Pi in the plane is covered by a disc D = (c, R) with center in c and radius R, if d(Pi, c) ≤ R.
In this paper we focus on the station location problem when the railway network consists of two straight lines with a common end point O forming an angle α, and the set  of settlements is placed in the common area of the two lines. More precisely, for a given radius R and two lines l1, l2 we call the area in the plane that can be covered on one hand by discs of radius R having centers on l1, and on the other hand by discs of radius R having centers on l1 the common area of l1 and l2. See Figure 1. Then define:
Station Location on Two intersecting Lines (SLTL): Given a geo- metric graph G = (V, E) that consists of two adjacent edges represented as straight line segments, a set P of points in the common area of the two lines, and a fixed radius R. Find a minimum number of vertices S on the edges with O ∈S such that P ⊆ cover (S).




Fig. 1. The grey area is the common area of the lines l1 and l2 .
Covering by Discs
In this section a variant of the geometric covering by discs problem is stud- ied. Given two line segments, l1 and l2, with a common end point O, we are interested in covering the entire common area of the lines l1 and l2 by discs centered on either line. Precisely:
Covering by Discs on Two Lines (CDTL): Given two straight line segments with a common end point O forming an angle α < 180◦. Find the minimum number of discs centered on either line that cover the common area of the two lines.
Obviously, an optimum solution of the CDTL problem is at least a feasible solution of the SLTL problem.
Covering by Discs on Two Lines
In this paragraph we consider CDTL for the cases α ≥ 60◦ and 41.4◦ ≤ α < 60 . Let us introduce some notation that we use in the paper. Figure 2 illustrates the notation. We assume R = 1.
l1 and l2 are the two lines of the CDTL problem;
O is the common end point of the lines l1 and l2;
α is the angle formed by the lines l1 and l2;
−x−O→y is the orthogonal coordinate system in the plane having origin in O, positive x-axis in the bisector of the angle α;
t1 and t2 are the two lines at distance 1 from l1 and l2 respectively, which intersect each other in the positive x-axis;

C is the disc centered in O with radius 1;
O1 is the intersection point of the lines t1 and t2;
C1 and C1' are the two unique discs centered respectively on l1 and l2 passing trough O1;
O− = (−1, 0) and O+ = (1, 0);
A is the intersection point of the line t2 and the disc C;
B is the intersection point of the line t1 and the disc C.

Fig. 2. The notation.

Lemma 3.1 Any optimal solution for the CDTL contains at least three discs.
Proof. The disc C centered in O is the only disc that covers the point O−. The discs C1 and C1' are the only two discs that cover the point O1 and those points infinitely close to it on the lines t1 and t2.	 
Therefore, without loss of generality, we can assume that the discs C, C1

and C1'
are contained in any optimal solution to the CDTL problem. The

next step is to investigate the number of discs that are needed to cover the
remaining part of the common area. (See Figure 2.) More precisely, we consider the following problem: Given two straight line segments l1 and l2 with a common end point O, the discs C, C1 and C1' . Find the minimum set of discs including C, C1 and C1' that cover the common area.
Lemma 3.2 The minimum number of discs that cover the common area is three when 60◦ ≤ α.

Proof. We prove that the discs C, C1 and C1'
cover the common area if the

angle α formed by the lines l1 and l2 is greater than or equal to 60◦. According

to the orthogonal coordinate system −x−O→y, if m = tan( α), m > 0 then:

l1: y = −mx	√	
l2: y = mx
√	

t1: y = −mx +	1+ m	t2: y =  mx −
2
1+ m2

O: (0, 0)	O :  √1+m2 , 0 

1	m
2	2		1	 2

  1	 2

The three discs cover the entire common area if the disc C1 passes through

or contains the point A =  √ m	,
1
1+m2
 . C1 passes through the point A,

if
 	m	
	1	 2

√1+ m2 − m√1+ m2	=1 
1	1
which leads to m =	√3 . Since m > 0, the only acceptable solution is m = √3 ,
which corresponds to α = 60◦.	 

Note that when the angle α equals 60◦ the discs C1 and C1'
pass through



the point O+ and the points of the segment O+O1 are all contained in the two discs. See Figure 3.

Fig. 3. The case α = 60◦.

Lemma 3.3 The minimum number of discs that cover the common area is five when 41.4◦ ≤ α < 60◦.

Proof. Let O
=   1−m2
, 0  be the intersection point of C , C'
and the

x-axis, other than O1. When the angle α is smaller than 60◦, the points A and B are not covered by the discs C1 and C1' , as well as those infinitely close to them on the lines AO1, and BO1 and the ones on the segment O2O+. See Figure 4.
C2 and C2' are the discs through O2 with centers on l1 and l2. The five discs
C, C1, C1' , C2 and C2' , cover the common area if the disc C2 passes through or



Fig. 4. The uncovered area for α < 60◦ and three discs.

contains the point A =  √ m

1
1+m2
 . C2 passes through the point A, if

	m	1 − 3m2
 2		−1
1 − 3m2	 2

√1+ m2 − m(1 + m2)√1+ m2	+  √1+ m2 + (1 + m2)√1+ m2	=1 
1	1	1
which leads to m = ±√3 , ±√7 . The only acceptable solution is m = √7 ,
which corresponds to α = 41.4◦. Moreover, the four discs C, C1, C1' and C2
do not cover the common area because the disc C2 does not contain the points
of the common area on the segment BT , where T is the intersection point of the line t1 and the disc C2. See Figure 5	 

Fig. 5. The case α = 41.4◦.


The CDTL Algorithm
The approach used in the previous section leads to the covering by discs al- gorithm shown in this section. For the cases 60◦  α and 41.4◦  α < 60◦ we use Lemma 3.2 and 3.3 respectively. For α < 41.4◦, the algorithm successively places discs on the two lines according to the proof of Lemma 3.3. However,

this yields a solution that is not necessarily optimal. Altogether, the algo- rithm gives an optimal solution for the CDTL problem when the angle α is greater than or equal to 41.4◦ and only a feasible solution otherwise. It could be improved to an optimal solution for α < 41.4◦. But this would require an elaborate case distinction.

Algorithm 1 CDTL
Input
two lines l1 and l2 having a common point O forming an angle α less than 180◦;
c, disc centered in O;
bis, the bisector of l1 and l2.
Output collection D of discs that cover the common area. The algorithm uses the following notation.
cX is out of the two discs through the point X with center on line l1, the one that is not already in D;
cX is out of the two discs through the point X with center on line l2 the one that is not already in D;
l1⊥,X1 is the perpendicular line to l1 passing trough the point X1;
Z = d	t2 is, out of the two intersection points of the disc d with the line
t2, the one that is closer to A;
Z = d bis is, out of the two intersection points of the disc d with the line
bis, the one that is closer to O.
1: X := t1 ∩ t2
2: compute c1 and c2
3: D := {c, c1 , c2 }
4: while A is not covered do
5:	X1 := c1 ∩ t2
6:	X := c1 ∩ bis
7:	X2 := l1⊥,X1 ∩ bis
8:	if d(O, X2) ≤ d(O, X) then
9:	compute c1 and c2
10:	D := D ∪ {c1 , c2 }
X	X
11:	else
12:	compute c1	and c2

13:	D := D ∪ {c1
X1 }

14:	c1 := c1
15:	c2 := c2


The loop in lines 4–15 builds the collection of discs and the algorithm stops when the point A is contained in a disc. The points X and X2, constructed in lines 6 and 7, are those we refer to in order to find the next discs. The algorithm runs in time linear in the number of discs.
Lemma 3.4 If α is smaller than or equal to 60◦ then any disc centered on line l1 covering the point A also covers the point O+.
Proof. Let CA and CO+ be the circles with radius 1, centered in A and O
respectively, refer to Figure 6.

Fig. 6. The discs CA and CO+
The discs centered in points on l1 contained in the intersection of the two discs are the only ones covering both A and O+. Let PA = {CA ∩ l1}\ O,
PO+ = {CO+ ∩ l1} \ O, ψ := ∠O+OPO+ and ϕ := ∠AOPA. It is sufficient to
show that OP A ⊂ OPO+ . Since the triangles OO PO+ and OAPA are isosceles,
then OPA ⊂ OPO+ if and only if ψ ≤ ϕ. It is ψ = α and ϕ = 90◦ − α, then
ψ ≤ ϕ if and only if α ≤ 60◦.	 
Lemma 3.5 If d(O, X2) ≤ d(O, X) then the disc C1 contains the point I1,
and if d(O, I2) > d(O, I) then the disc C1  contains the point X.
Proof. This can be easily proved applying the pythagorean theorem.	 
Theorem 3.6 The collection D of discs produced by Algorithm 1 covers the entire common area of the two given lines.
Proof. Let P be a point in the common area. If P is at distance less than or equal to 1 from O, then it is covered by the disc c. So let P be a point in
the triangle O1O+A and Dl = {Di} be the collection of discs with center on
l1 produced by the algorithm. We will show that P is covered by at least one disc in Dl . Consider the intervals Ibis = Di ∩ bis and It2 = Di ∩ t2 and let
lbis and lt2 be the points in Ibis and It2 respectively farthest from O1. Note
i	i	i	i

that O+O1 ⊂   Ibis, AO1 ⊂   It2 and that the left points lbis and lt2 of the
intervals appear along O1O+ and O1A respectively in increasing order of their
indices.
For i > 1 let Poli be the polygon with vertices lbis, lbis , lt2 , lt2 and Pol1

bis	t
i	i−1
i−1  i

the triangle l1 O1l 2 . See Figure 7. Note that, by Lemma 3.4 and Lemma 3.5,
the union of the polygons Poli (1 ≤ i ≤ |Dl |) contains the triangle OO+A, so the point P is contained in at least one polygon Poli. Therefore P is contained in the disc Di because it is convex and covers all vertices of Poli.	 




Fig. 7. The polygon P oli


The Station Location Problem
As explained before, given an existing railway network and a set P of n set- tlements the problem is to cover the settlements placing as few new stations as possible. We represent:
The railway network as a graph in the plane where the nodes are the stations and the edges are straight line segments representing the tracks between stations;
the set P as n points in the plane.
We consider the SLTL problem, where the network consists of two line segments, l1 and l2 forming an angle α and a set  of points all lying in the common area of the two lines is given.
Theorem 4.1 Three stations cover all the settlements in P if α ≥ 60◦.
Proof. According to Lemma 3.2, two discs, plus one centered on the com- mon point, are enough to cover the common area between two lines having a common point, when the angle α formed by the two lines is greater than or equal to 60◦.	 

Theorem 4.2 Five stations cover all the settlements in P if 41.4◦ ≤ α < 60◦.
Proof. According to Lemma 3.3, four discs, plus one centered on the com- mon point, are enough to cover the common area between two lines having a common point, when the angle α formed by the two lines is greater than or equal to 41.4◦ and smaller than 60◦.	 
We now want to generate a minimum set of points on the lines l1 and l2 that cover a given set of settlements P. Let Pi ∈ P. We call Ci the circle with center in Pi and radius R. Since each settlement in  can be covered by a new station along the tracks, Ji := Ci  l1  l2 is not empty. Let Ji be the interval induced by point Pi on the line l1 and Ji the interval induced by point Pi on l2. Then the settlement Pi is covered if and only if there is a station placed in Ji = Ji ∪ Ji.
Let I1 = {Il } and I2 = {Il } be the sets of subintervals induced by all
points in P on the lines l1 and l2 respectively. More precisely, if Ji = [ai, bi]
and Jj = [aj, bj] are intervals induced on l1 by Pi and Pj, such that Ji ∩ Jj /= ∅
1	1	1
with ai ≤ aj, then they detect the subintervals:
[ai, aj], [aj, bi], [bi, bj]	if bi ≤ bj or
[ai, aj], [aj, bj], [bj, bi]	if bi ≥ bj.
This can be extended to any number of intervals. Note that the resulting number of sub-intervals on each line is at most 2n − 1.
Theorem 4.3 An O(n) time algorithm optimally solves the SLTL problem if
α ≥ 60◦.
Proof. Let P = {Pi:1 ≤ i ≤ n}. For all Pi ∈ P compute the intervals Ji
and Ji. Let Ii := Ii−1 ∩ Ji and Ii := Ii−1 ∩ Ji. Note that Ii and Ii are the
intervals on l1 and l2 that cover all the points up to Pi. If In = In = ∅ we need
two stations else we need only one in addition to O. Computing the intervals
Ii and Ji takes constant time for every i.	 
j	j
Theorem 4.4 An O(n3) time algorithm optimally solves the SLTL problem if 41.4◦ ≤ α < 60◦.
Proof. For a given set , Algorithm 2 successively checks if  can be covered by a set of two, three or four stations on the two lines. In case not all points in can be covered by four stations, the result is a covering of the entire common area of the two lines with five stations. Obviously, the running time is in O(n3).
 



Algorithm 2 SLTL
Input two lines l1 and l2 having a common point O, set of points in the common area of l1 and l2;
Output collection of one, two or three intervals on l1 and l2, such that O together with one arbitray point from each interval of this collection cover  ; if no such collection exists five points covering the entire common area.
1: I0 := l1, I0 := l2
1	2
2: for Pi ∈У do
3:	Ii := Ii−1 ∩ Ji
4:	Ii := Ii−1 ∩ Ji
5: if In /= ∅ or In /= ∅ then
6:	output O and In resp. In
1	2
7: else
8:	for every subinterval I	1	2 do
9:	I0 := l1, I0 := l2
1	2
10:	for Pi ∈У do
11:	if Pi covered by I then
12:	Ii := Ii−1
1	1
13:	Ii := Ii−1
2	2
14:	else
15:	Ii := Ii−1 ∩ Ji
16:	Ii := Ii−1 ∩ Ji
17:	if In /= ∅ or In /= ∅ then
18:	output O, I and In resp. In
1	2
19:	if In = ∅ = In for all I ∈ f1∪∈ f2 then
20:	for every pair of subintervals I, I'	1	2 do
21:	I0 := l1, I0 := l2
1	2
22:	for Pi	do
23:	if Pi is covered by I or by I' then
24:	Ii := Ii−1
1	1
25:	Ii := Ii−1
2	2
26:	else
27:	Ii := Ii−1 ∩ Ji
28:	Ii := Ii−1 ∩ Ji
29:	if In /= ∅ or In /= ∅ then
30:	output O, I, I' and In resp. In
1	2
31:	if In = ∅ = In for all pairs of subintervals I, I' then
32:	output five points on l1 and l2 covering of the entire common area
Remark If we do not assume that there is necessarily a station in the common point O of the two lines, then an 0(n2) algorithm solves the problem when the

angle α  60◦ and an (n4) algorithm solves the problem for 41.4◦  α < 60◦
using the same approach used in Theorem 4.3 and Theorem 4.4.

Conclusion
We considered the problem of covering the common area between two inter- secting straight line segments. In general this problem is NP-hard. A char- acterization of solutions to this problem depending on the angle between the line segments is given. This leads to an algorithm with running time linear in the number of discs to find a small, though in general not minimum, number of discs covering the common area. The result is then applied to the station location problem for a railway network that consists of two intersecting tracks forming a sufficiently large angle.
From our collaboration with the Deutsche Bahn, we know that railway networks are to some extent decomposable in large regions where only one track is relevant for placing new stations. For future work it would be inter- esting to apply a decomposition technique to the railway network, where our result can be used as a subroutine for regions where tracks meet.

Acknowledgement
The authors thank Anita Scho¨bel for fruitful discussions, and Sabine Cornelsen and Leon Peeters for helpful comments on the presentation of the paper.

References
Hamacher, H., A. Liebers, A. Sch¨obel, D. Wagner and F. Wagner, Locating new stops in a railway network, Electronic Notes in Theoretical Computer Science 50 (2001).
Kranakis, E., P. Penna, K.Schlude, D. Taylor and P. Widmayer, Improving customer proximity to railway stations, Technical report, ETH Zurich (2002).
Murray, A., Coverage models for improving public transit system accessibility and expanding access, Technical report, Department of Geography, Ohio State University (2001).
Murray, A., Strategic analysis of public transport coverage, Socio Economic Planning Sciences
35 (2001), pp. 175–188.
Murray, A., R. Davis, R. Stimson and L. Ferreira, Public transportation access, Transportation Research 3 (1998), pp. 319–328.
Sch¨obel, A., H. Hamacher, A. Liebers and D. Wagner, The continuos stop location problem in public transportation, Technical report, Universit¨at Kaiserslautern (2002), report in Wirtschafts- mathematik Nr 81/2001.
Sch¨obel, A. and M. Schr¨oder, Covering population areas by railway stops, Proceedings of OR 2002, Klagenfurt to appear (2002).
