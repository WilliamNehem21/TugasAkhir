
ORIGINAL ARTICLE

A new combined technique for automatic contrast enhancement of digital images
Ismail A. Humied *, Fatma E.Z. Abou-Chadi, Magdy Z. Rashad

Faculty of Computers and Information Sciences, Mansoura University, Mansoura, Egypt

Received 31 October 2011; revised 1 January 2012; accepted 4 January 2012
Available online 7 February 2012

Abstract Some low contrast images have certain characteristics makes it difficult to use traditional methods to improve it. An example of these characteristics, that the amplitudes of images histogram components are very high at one location on the gray scale and very small in the rest of the gray scale. In the present paper, a new method is described. It can deal with such cases. The proposed method is a combination of Histogram Equalization (HE) and Fast Gray-Level Grouping (FGLG). The basic procedure of this method is segments the original histogram of a low contrast image into two sub-histograms according to the location of the highest amplitude of the histogram compo- nents, and achieving contrast enhancement by equalizing the left segment of the histogram compo- nents using (HE) technique and using (FGLG) technique to equalize the right segment of this histogram components. The results have shown that the proposed method does not only produce better results than each individual contrast enhancement technique, but it is also fully automated. Moreover, it is applicable to a broad variety of images that satisfy the properties mentioned above and suffer from low contrast.
© 2012 Faculty of Computers and Information, Cairo University. Production and hosting by Elsevier B.V. All rights reserved.




* Corresponding author.
E-mail addresses: Ismaiel555@yahoo.com (I.A. Humied), f-abochadi @ieee.org (F.E.Z. Abou-Chadi), Magdi_z2011@yahoo.com (M.Z. Rashad).

1110-8665 © 2012 Faculty of Computers and Information, Cairo University. Production and hosting by Elsevier B.V. All rights reserved.

Peer review under responsibility of Faculty of Computers and Information, Cairo University.
doi:10.1016/j.eij.2012.01.001
Introduction

Because some features are hardly detectable by eye in an image, we often transform images before display. Numerous contrast enhancement techniques exist in literature, such as gray-level transformation based techniques (e.g., logarithm transformation, power-law transformation, piecewise-linear transformation, etc.) and histogram processing techniques (e.g., Histogram Equalization (HE), histogram specification, etc.) [1–6]. Histogram Equalization (HE) is one the most well-known methods for contrast enhancement. Such an ap- proach is generally useful for images with poor intensity distri- bution. Its basic idea lies on mapping the intensity levels based on the probability distribution of the input intensity levels. It

28	I.A. Humied et al.


flattens and stretches the dynamics range of the image’s histo- gram and resulting in overall contrast improvement [7]. How- ever, it tends to change the brightness of an image and hence, often fail to produce satisfactory results for a broad variety of low-contrast images. Such as, the original image have the amplitudes of its histogram components are very high in the first component of the nonzero histogram components NZHC,
e.g., at the zero location on the gray scale and very small in the rest of the gray scale, which could cause a washed-out effect on the appearance of the output image [8].
Recently, a histogram-based optimized contrast enhance- ment technique called Gray-Level Grouping (GLG) was devel- oped by Chen et al. [8]. The basic procedure of this technique is to first group the histogram components of a low-contrast im-





























































Figure 1	Flow chart of the proposed method algorithm with combination of HE and FGLG.

A new combined technique for automatic contrast	29

rk	(a)	(b)	(c)	(d)
Figure 2	Histograms of a virtual image in four basic intensity characteristics. (a) Dark image. (b) Light image. (c) Low contrast image.
(d) High contrast image.



age into a proper number of groups according to a certain cri- terion, then redistribute these groups of histogram components uniformly over the gray scale so that each group occupies a gray scale segment of the same size as the other groups, and finally ungroup the previously grouped gray-levels.
To reduce time in GLG technique as well as the number of iterations, a default value can be used for the total number of gray-level bins (as the right of Fig. 1), 20. In this method there is no need of constructing the transformation function and cal- culating the average distance between pixels on the gray scale for each set of gray-level bins. This method is called Fast Gray- Level Grouping (FGLG) since it is executed faster than basic GLG, as in [8]. It enhances the contrast of images that have the position of the highest amplitude histogram component, Phist, in the first component of the nonzero histogram compo- nents NZHC. These techniques cannot enhance low contrast images that have Phist lie in any location of the left region of NZHC [9].
Fig. 2 shows the histograms of a virtual image in four basic intensity characteristics (dark, light, low contrast and high con- trast) which the Phist, solid line, lies in the left region of NZHC. The horizontal axis of each histogram plot corresponds to intensity values, rk. The vertical axis corresponding to values of the probability of occurrence of intensity levels, P(rk).
In this paper, a new method is described to enhance low contrast images that have the amplitudes of its histogram com- ponents are very high at one location on the gray scale and very small in the rest of the gray scale.
This paper is organized as follows. Our proposed method is reported in the next section. In Section 3, the experimental re- sults of our proposed method and other existing methods are presented and compared fairly. Section 4 contains our con- cluding remarks.

The proposed method

In this section, an automatic contrast enhancement technique
stages. Fig. 1 illustrates a schematic diagram of the proposed method.
The histogram of an image with intensity levels in the range [0, L — 1] is a discrete function h(rk)= nk, where rk is the kth intensity level and nk is the number of pixels in the image with intensity rk. It is common practice to normalize a histogram by
dividing each of its components by the total number of pixels in the image, denoted by product MN, where, as usual, M and N are the row and column dimensions of the image. Thus, a normalized histogram is given by P(rk)= nk/MN, for k = 0,
1, 2, .. . , L — 1. Loosely speaking, P(rk) is an estimate of the
probability of occurrence of intensity level rk in an image. Sup- pose that an input image I with intensity levels in the range [0, L — 1] and its histogram was calculated, the basic procedure of the proposed method is as follows:

Histogram separation

Find the position of the highest amplitude histogram compo- nent, Phist, on the gray scale. If Phist lies inside the left segment of the NZHC but not in the first component of the NZHC, the
histogram can be separated into two sub-histograms, the first starting from 0 to (Phist — 1) intensity and the second starting from Phist to maximum intensity level (L — 1).
On the other hand, if Phist lies inside the right segment of the NZHC or in the first component of the NZHC then we have to enhance low contrast image using FGLG.

Piecewise transformed function

Having performed the histogram separation based on the po- sition of the highest amplitude histogram component, Phist. We can directly apply the HE to first sub-histogram from 0
to (Phist — 1) and apply FGLG to second sub-histogram from
Phist to L — 1. The transformation function using HE can be expressed as followed [1,7]:

is proposed that performs effectively with images that have the position of the highest amplitude histogram components lies in the left of NZHC region. It is a combination of Histo-
THE(rk)= (L — 1)
k

j=0
pr (rj)= 
(L — 1) k
MN	j=0
nj	(1)

gram Equalization (HE) and Fast Gray-Level Grouping (FGLG). The proposed method is carried out via various
for k = 0, 1, 2, ... , Phist — 1. The transformation function
using	FGLG	is	TFGLG(rk),	for	k = Phist,	Phist + 1,

30	I.A. Humied et al.

Intensity levels for original image

Figure 4  Transformation functions for the HE, GLG, FGLG and proposed method. Transformations where obtained from the histograms of the images in Fig. 3.








T(rk)= THE(rk)+ TFGLG(rk)	(2)
for k = 0, 1, 2, .. . , L — 1. Finally, the piecewise transformed function is applied to the original image to reconstruct the optimal enhanced image.

Experimental results











Figure 3 Images of sample text and their corresponding histo- grams. (a) Original low-contrast image, with Phist = 27 intensity level. (b) Result of HE. (c) Result of GLG, with the optimal bin numbers of 8 found through the iterations process. (d) Result of FGLG. (e) Result of proposed method. (The highest amplitude in the histograms is the largest peak whose actual amplitude is 28089 Pixels. It is truncated so that the rest of the histograms can be displayed on a proper scale.)
Phist + 2, ... , L — 1, as shown in Fig. 1. Therefore the piece- wise transformed function T(rk) can be expressed as followed:
To demonstrate the effectiveness of the proposed algorithm, it was implemented and applied to a 46 of low contrast gray scale and colored images, such as text, faces and X-ray medical images.
As visual quality is extremely desirable for the contrast enhancement of the image, some specific properties are indica- tive of an effective contrast enhancement method. These are the probability of erroneous associations due to unsuitable illumination changes created by over-enhancement.
Fig. 3a shows the low contrast image of a sample text and histogram corresponding it, which show the position of the highest amplitude histogram component, Phist = 27.
Fig. 3b is the equalized image using HE and histogram cor- responding it. Histogram Equalization, on the other hand, substantially changes the original image. Many of the previ- ously hidden letters are exposed. Unfortunately, at the same time, the enhancement over-saturates several areas of this im- age. Notice how the equalized image became washed out and not acceptable for many applications as mentioned earlier.

A new combined technique for automatic contrast	31





















































Position of the highest amplitude histogram component, Phist , along gray scale


Figure 5 The values of: (a) PSNR. (b) MSE. (c) AMBE, for enhanced a set of low contrast images using HE, GLG, FGLG and proposed method. (The highest amplitude histogram compo- nent in these images has different position.)


The cause for the washed-out appearance is that the middle of the gray scale on the histogram of the equalized image is sim- ply empty.
Fig. 3c and d is the resulting images of GLG and FGLG respectively, which are better than the HE result and the histo-


Figure 6 Images of airplane U2, and their corresponding histograms. (a) Original low-contrast image, with Phist = 18 intensity level. (b) Result of HE. (c) Result of GLG, with the optimal bin numbers of 11. (d) Result of FGLG. (e) Result of proposed method.


grams for it results, are spread better than histogram for HE. Therefore the images result using GLG and FGLG are better

32	I.A. Humied et al.




















































Figure 7	Images of house, and their corresponding histograms.
(a) Original low-contrast image, with Phist = 57 intensity level. (b) Result of HE. (c) Result of GLG, with the optimal bin numbers of
1. (d) Result of FGLG. (e) Result of proposed method.



than image result using HE, but the letters in these images still are not clear and appear slightly washed-out. Fig. 3e shows the
Figure 8	Images of woman, and their corresponding histograms.
(a) Original low-contrast image, with Phist = 11 intensity level. (b) Result of HE. (c) Result of GLG, with the optimal bin numbers of
1. (d) Result of FGLG. (e) Result of proposed method.


results of the proposed method and it is more effective than that obtained from techniques mentioned. The histogram cor- responding it is more spread over the full range of gray scale, so there is no washed-out appearance in the output image and more natural looking effect.

A new combined technique for automatic contrast	33




Figure 9 Images of stenosis of the abdominal Aorta in an infant, and their corresponding histograms. (a) Original low-contrast image, with Phist = 14 intensity level. (b) Result of HE. (c) Result of GLG, with the optimal bin numbers of 3. (d) Result of FGLG.
(e) Result of proposed method.


The mapping curves are illustrated in Fig. 4. It can be seen, that the proposed method, solid line, has a smoother curve compared to other methods. The equalized image mapped using the proposed method is a smooth mapping curve and


Figure 10 Images of Chest X-ray and their corresponding histograms. (a) Original low-contrast image, with Phist = 240 intensity level. (b) Result of HE. (c) Result of GLG, with the optimal bin numbers of 4. (d) Result of FGLG. (e) Result of proposed method.

can produce a more natural looking enhancement of original image as shown in Fig. 3e.

34	I.A. Humied et al.










possible to compare their performance. The PSNR is defined as follows:
2552
PSNR = 10log10 MSE	(3)
where MSE is mean-square error, defined as


MSE =
 1  M
MN x=1

N

y=1


[I(x; y)— I(x; y)]2

(4)



where I and I are the original and enhanced image, respec- tively, of size M · N. Note that higher PSNR value and lower MSE represents greater image quality.
The performance of brightness preservation is rated by an objective measurement AMBE. It is defined as the absolute dif- ferential gray-level mean between the original image and en- hanced image.





In addition to qualitative evaluation, quantitative accuracy is also utilized to evaluate the proposed method and compare its performance with other methods. Using the Peak Signal-to- Noise Ratio (PSNR), Mean Square Error (MSE) and Abso- lute Mean Brightness Error (AMBE), are the most common measures of picture quality in image processing [10,11], it is
Im and Im denote the gray-level mean of the original and en-
hanced image, respectively. Note that lower AMBE value indi- cates that the brightness is better preserved and greater image quality.
Table 1, lists the PSNR, MSE, AMBE values of the HE, GLG, FGLG and proposed method. We can conclude from the results tabulated in this table that the proposed method achieves the highest PSNR and the lowest MSE and AMBE values. It should be noted these results agree with the visual inspection by the human eye.

A new combined technique for automatic contrast	35





























































Figure 11 Medical examination images and their corresponding histograms. (a) Original low-contrast image, with Phist = 241 intensity level. (b) Result of HE. (c) Result of GLG, with the optimal bin numbers of 2. (d) Result of FGLG. (e) Result of proposed method.




























































Figure 12	Images of fruits and their corresponding histograms.
(a) Original low-contrast image, with Phist = 15 intensity level. (b) Result of HE. (c) Result of GLG, with the optimal bin numbers of
30. (d) Result of FGLG. (e) Result of proposed method.




Fig. 5 shows the values of PSNR, MSE and AMBE for a 46 of low contrast images enhanced using HE, GLG, FGLG and
proposed method versus the position of the highest amplitude histogram component, Phist, on these images along gray scale. The highest amplitude histogram component in these images

36	I.A. Humied et al.
has different position. In the left segment of gray scale shows that the proposed method has a highest PSNR values and lowest MSE, AMBE values. Moreover, it can be seen that the PSNR values decrease when we move away from the left of gray scale and there is an increase in the MSE and AMBE values.
Figs. 6–9 show examples of low contrast gray scale images to demonstrate the effectiveness of the proposed method when Phist lies in the left segment of the histogram component. These figures illustrate the results obtained from applying HE, GLG, FGLG and proposed algorithm. It can be seen from these fig- ures that visual quality of original image has been greatly en- hanced in the resultant images.
Fig. 10, on the other hand, shows the Chest X-ray images, where the resultant image has not been enhanced by applying the proposed method. However, these images have been en- hanced using GLG and FGLG method because Phist lies in the right segment of the histogram components.
The quantitative analyses of the images in Figs. 6–10 are calculated and listed in Tables 2–6. It is noted that the images in Figs. 6–9 have significantly larger PSNR values and smaller MSE and AMBE values comparison with the other techniques. These results indicate that the proposed method performed better than other techniques. The interpretation of these results is that low-contrast images have noisy backgrounds represent- ing a fairly large percentage of the image area.
The high amplitudes of the histogram components correspond- ing to the noisy image background often prevent the use of conven- tional Histogram Equalization techniques and the new basic GLG technique, because they would significantly amplify the back- ground noise, rather than enhance the image foreground [9].
On the other hand, the images which have Phist lies in right seg- ment of the histogram component can be processed using the GLG or FGLG method as shown in the flowchart in Fig. 1. These char- acteristics often prevent the use of proposed method because of nature algorithm of the FGLG, the transformation function, TFGLG, shows the Phist mapping into zero location in gray scale. So the sudden change in result image in visual is occurrence in this case. As a result in Fig. 10e, the image is not desirable in visual.
The following Tables 7–9 show the quantitative analysis of HE, GLG, FGLG and the proposed method when applied to colored images as shown in Figs. 11–13. It can be seen from these figures that visual quality of original image has been greatly enhanced in the resultant image.

Conclusion











Figure 13 Images of girl and their corresponding histograms. (a) Original low-contrast image, with Phist = 6 intensity level. (b) Result of HE. (c) Result of GLG, with the optimal bin numbers of
53. (d) Result of FGLG. (e) Result of proposed method.
In this paper, a new method for automatic contrast enhancement images is described, which is a combination of the Histogram Equalization (HE) technique and the Fast Gray-Level Grouping (FGLG) technique. Experimental results show that the proposed method produces is effective and robust enhancement and better enhancement for various images than using each technique sepa- rately. The results show that the proposed method achieves the best quality through qualitative visual inspection and the image quan- titative analysis of Peak Signal-to-Noise Ratio (PSNR), Mean square error (MSE) and Absolute Mean Brightness Error (AMBE) for the used images. The proposed method can be con- ducted in a fully-automated manner to contrast enhancement.

A new combined technique for automatic contrast	37


References

Gonzalez Rafael C, Woods Richard E. Digital image processing. 3rd ed. Prentice Hall; 2008 [August].
Thyagarajan KS. Digital image processing with application to digital cinema. Focal Press; 2006.
Relf CG. Image Acquisition and Processing with LabVIEW: North Mopac Expressway Austin. USA: National Instruments, ni.com; 2004.
Dorf RC. Circuits, signals, and speech and image processing. 3rd ed. United States of America: Taylor & Francis Group; 2006.
Lakshmanan R, Nair MS, Wilscy M, Tatavarti R. Automatic contrast enhancement for low contrast images: A comparison of recent histogram based techniques. In ICCSIT ’08: Proceedings of the 2008 international conference on computer science and information technology. IEEE Computer Society: Washington, DC, USA; 2008. p. 269–76.
Chen Z, Abidi BR, Page DL, Abidi MA. A generalized and automatic image contrast enhancement using gray level grouping.

In: ICASSP’06: Proceedings of the 2006 IEEE international conference on acoustics, speech and signal processing (ICASSP’06); 2006. p. 2.
William K. Pratt, digital image processing: PIKS scientific inside. Wiley-Interscience; 2007.
Chen ZhiYu, Abidi Besma R, Page David L, Abidi Mongi A. Gray-level grouping (GLG): an automatic method for optimized image contrast enhancement – Part I: The basic method. IEEE Trans Image Process 2006;15(8):2290–302.
Chen ZhiYu, Abidi Besma R, Page David L, Abidi Mongi A. Gray-level grouping (GLG): an automatic method for optimized image contrast enhancement – Part II: The variations. IEEE Trans Image Process 2006;15(8):2303–14.
Kim M, Chung MG. Recursively separated and weighted histogram equalization for brightness preservation and con- trast enhancement. IEEE Trans Consum Electron 2008;54(3): 1389–97.
ElDib M, Onsi H. Human age estimation framework using different facial part. Egypt Inform J 2011;12(1):53–9.
