Available online at www.sciencedirect.com



Electronic Notes in Theoretical Computer Science 281 (2011) 101–111
www.elsevier.com/locate/entcs

Lagrangean Relaxation Parallel Method for Optimizing of a Hydroelectric Generation System
Fanny Gonz´alez a,1, Lu´ıs Farin˜a a,2, Eustaquio Mart´ınez a,3,
Esteban Vargas a,4 and Anastacio Arce b,5
a Facultad Polit´ecnica - Universidad Nacional del Este Ciudad del Este - Paraguay
b Itaipu´ Binacional Hernandarias - Paraguay

Abstract
This paper presents the Lagrangean Relaxation parallel method applied to the optimal commitment of generating units in a Hydroelectric System. The model is implemented on a cluster built upon low cost readily available personal computers. It also introduces the algorithms applied in the above mentioned platform. The results obtained in terms of “Speed Up” for a sample problem of rather important dimensions, indicate the validity of the proposal.
Keywords: Lagrangean relaxation parallel, Optimal commintment of generating units, Personal Computer network, Cluster.


Introduction
The Lagrangean Relaxation (LR) [14,15,7,12,9] is a technique which uses concepts of the Dual Theory to deal, in a special way, with the set of constraints of a problem. The constraints considered complex are transferred to the objective function which is assessed through especial penalty parameters called Lagrange Multipliers. Thus the primal problem is transformed into a relaxed problem, where the structure of the resulting constraints generates sub-problems which can be solved with greater

1 Email:fgonzalez@fpune.edu.py
2 Email:lfarina@fpune.edu.py
3 Email:amartinez@fpune.edu.py
4 Email:evargas@fpune.edu.py
5 Email:arce@itaipu.gov.py

1571-0661 © 2011 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2011.11.028

ease than the primal one. In [14,15,7] an exact algorithm is proposed for the TSP (Traveling Salesman Problem) using which promising results were obtained. Later on, the technique was successfully used for solving other combinatorial optimization problems [8,17,2].
The LR technique is also used with multiple variable functions which can be maximized or minimized given certain constraints. Also can be used for hydrother- mal coordination, optimizing operations, etc. [11,2].
The problem of optimizing the commitment of Generating Units in a Hydro- electric System [1,2], is of great interest especially in the context of economics. It is concerned with the proper programming of the Generating Units, in such a way as to minimize costs linked to generation losses as well as start up and shut down costs of said units [1,2]. This problem can be solved using a heuristic procedure based on Lagrangean Relaxation and Dynamic Programming, as proposed in [1]. The solution process by Lagrangean Relaxation, is done in two levels defined by de dual and primal problems which requires significant time processing, according to the size of the problem. This aspect of solution method based on Lagrangean Relaxation justifies the technique application study of parallel processing, subject of this work [11,3].
This article deals the subject topic presented in the following way: in Section 2 a brief review of the lagrangean relaxation method is introduced, in Section 3, the optimal commitment of generating Units in a Hydroelectric System is discussed, in Section 4 the lagrangean relaxation Parallel Method is proposed, and in Section 5 the experimental results are presented, so as to introduce the concluding remarks reached in the process of the research, in Section 6.

Lagrangean Relaxation
Lagrangean Relaxation, as mentioned in [14,15] was used in the implementation of an exact algorithm for TSP, later on it was successfully employed for solving other problems. As stated in [7,12,9], LR was established as a powerful tool. In [13,23,28], detailed information can be found on the LR technique as well as a rich variety of additional references.
Summarizing, LR is a technique which uses concepts from the Duality Theory [18,27] to deal in especial way with a set of constraints of a given problem. The constraints considered complex are transferred to the objective function which is assessed through especial penalty parameters called Lagrangean Multipliers. Thus a primal problem is transformed into a relaxed problem, where the structure of resulting constraints, in general, generates sub-problems which can be solved with greater ease than the primal problem.
Consider the optimization problem P , in this case called Primal problem, which is described in [28] as:
min f (X)
Subject to:

hk(X)= ek,  k = 1, 2, ..., m
gj(X) ≤ bj, j = 1, 2, ..., p
x ∈ X
Where functions f (X), gj(X)y hk(X) can be arbitrarily non linear or non convex
[5]. The feasible region of the problem is bound by the constraints (2), (3) and the others which include integrality and non negative constraints, here represented by the set X. It is assumed that the problem would be easily solved in the absence of constraints (2).
Lagrangean Relaxation relaxes constraints hk(X)= ek, moving them to the ob- jective function with its corresponding multipliers uk, k = 1, 2, ..., m, which results in function [5,18,28]:

​
L(X, u)= f (X)+ Σ uk(ek − hk(X))
k=1
Where u = (u1, u2, ..., um)T and u1, u2, ..., um are designated as Lagrange Mul-

tipliers (Dual Variables).
It can be observed that if a relaxed constraint j is type “ ≥ ” , then the Lagrange Multiplier is uk ≥ 0. To equality constraints unrestricted Lagrange Multipliers are linked [28].
The Dual function is defined as:
Θ(u)= minXL(X, u)
Subject to:
gj(X) ≤ bj, j = 1, 2, ..., p
The expression (6) is called lagrangean sub-problem. The Dual function is ob-
tained minimizing the lagrangean function subject to constraints (3) and (4). Then Dual function of the problem is formulated as [28]:

​

​
where
max Θ(u) Subject to:
uk ∈ Rm

m

​
Θ(u)= min{f (X)+ Σ uk(ek − hk(X))}
k=1

The Optimal Commitment of Generating Units of a Hydroelectric System
The optimal commitment of generating units of a hydroelectric system [1] can adopt as performance criterion a model which assesses the losses in the generation system and also the cost connected to start ups and shut downs of the generating units. The formulation of the unit commitment problem is characterized as a mixed integer

problem and therefore non convex [1]. Additionally to the previously mentioned features non linearity and the huge size of the problem makes it more difficult to achieve an optimal solution [1].
To solve this problem a heuristic methodology is proposed in [1], which de- composes the problem into two sub-problems: The commitment of the generating units (CU), which determines the configuration of generating hydroelectric units in operation in each one of the power plants during each time interval [2]; and the one which corresponds to Commitment of Generation (CG) which determines the optimal generation commitment for a configuration of generating units in a given operation. Both sub-problems can be solved in an iterative way untila global solution for the system is obtained. Fig. 1 presents this line of reasoning.



Fig. 1. Diagram of Heuristic Methodology for solving the optimal commitment problem [1]

The Commitment Generation Problem
The sub-problem CG of hydroelectric generating units can be formulated as a spe- cific case of the hydroelectric generation problem, for which the number of gener- ating units in operation is already established through sub-problem CU. Thus, the mathematical formulation for the previously mentioned sub-problem is:
T	N

​
min
Σ Σ {cp.fi(n∗t, pt)}

i	i
t=1 i=1
Subject to:
N
Σ pt = dt ∀t


​
i=1 T
t i

​
t=1
pmin(n∗t) ≤ pt ≤ pmax(n∗t)

i	i	i	i	i
where: T is the number of time interval;
N is the number of hydroelectric power plants;

fi(pt, n∗t) is the function of losses in the power plant i [MW], which depends on
i	i
the number of generating units n and the power generated p during time interval t;
mi is the power target of the hydroelectric power plant i [MWaverage];
dt is the load of the system during a time interval t [MW];
∗t is the number of generating units in operation in power plant i during time
interval t ;
cp cost of losses connected to the generation system;
pt power generated in power plant during time t ;
pmin(.), pmax(.) minimum and maximum power, respectively, linked to n generating
i	i
units committed in power plant i , during time t;
This problem involves continuous variables and can be solved through a La- grangean Relaxation method [19,4,20,5]. Observing equations (11) to (14) it can be pointed out that the objective function is formed by the summation of losses functions linked to the generation of each power plant and for each time interval t. These functions are convex, represented by degree two polynomials.
The relationship between the equations (1) to (10), and those presented in sec- tion 2, can be established trough expressions (11) to (14), considering that
X = pt = [p(i, t)]N×T ; i = 1, 2, ..., N ; t = 1, 2, ..., T
and the objective function
T	N

​
with equality constraints
f (X)= Σ Σ {cp.fi(n∗t, pt)}
t=1 i=1

,⎨ ΣN
pt;	1 ≤ k ≤ N

T
t=1
pt;	N +1 ≤ k ≤ N + T


(18)

ek =
,⎨ dt;	1 ≤ k ≤ N
, T.mi;	N +1 ≤ k ≤ N + T

and unequality constraints
gj(X)= pt − pmin(n∗t); j = {i × t}
i	i	i
bj = pmax(n∗t) − pmin(n∗t); j = {i × t}
i	i	i	i
with the lagrangean multipliers (Dual Variables )


​

uk =
T
t=1
N
i=1
λt;	1 ≤ k ≤ T
μi;	T +1 ≤ k ≤ N + T

The following lagrangean function can be obtained
L(X, u)= L(p, μ, λ)
m	m
f (X)+ Σ ukek − Σ ukhk(X)
k=1	k=1

which can be written as

ΣT	ΣN
 cp.fi(n∗t, pt)} + ΣT
λtdt − ΣT
ΣN  λtpt+

​
t=1	i=1
i	i	t=1
t=1
i=1	i

N
i=1
Which results in
μtmi.T − ΣT
N
i=1


m
μipt

​

and
f (X)+ Σ uk(ek − hk(X))
k=1

T	N	T	N	N	T
Σ Σ cp.fi(n∗t, pt)} + Σ λt(dt − Σ pt)+ Σ μt(mi.T − Σ pt)

t=1 i=1
i	i
t=1
i
t=1
i=1
i
t=1

then the Dual Function is defined as
minXL(X, u)	=	min t L(p, μ, λ)
i

​
s.t.	s.t.
gj(X) ≤ bj,j = 1, 2, ..., p	pmin(n∗t) ≤ pt ≤ pmax(n∗t);  ∀i, t

i	i	i	i	i
Finally the solution to the problem (11) to (14) can be obtained solving the following Dual problem:



​
max Θ(u)	=	max h(μ, λ)
s.t.	s.t.
u ∈ Rm	λ ∈ RT ,μ ∈ RN

The solution of the problem, as it was mentioned before, can be achieved through a hierarchical calculation structure with two levels, according to [1]. In the upper lever (coordinator or master program) the values of the lagrangean multipliers are determined and in the lower level the primal sub-problems are solved, one for each power plant and for each time interval, according to lagrangean multipliers set by the coordinator.
Blocks p(i, t) in Fig. 2, represent the solution to primal sub-problems connected to power plant i during the time interval t. On this level N × T sub-problems are solved and on the upper level in the coordinator the values of μ and λ are determined to solve the Dual problem.

Sequential Solution of the Problem
The solution of the optimization problem can be obtained through the heuristic method mentioned before in the previous section, alternating dynamic programming for Sub-Problem CU and Lagrangean Relaxation for sub-problem CG, until the best solution is obtained using the algorithm described in Fig. 3.






Fig. 2. General Diagram of the solution of sub-problem CG [1].

Start
Solve sub-problem CU (Using Dynamic Programming)
While there is an alteration in the last configuration of the generating units do Calculate sub-problem CG (Using Lagrangean Relaxation)
Calculate Lagrange multipliers (λ, μ)
For t=1 to T do Solve equation (27)
Calculate errors (Demand constraints and target power errors) Optimization Test (Power generation and demand response errors) If no solution is found, Calculate sub-problem CG again
End sub-problem CG.

Fig. 3. Algorithm of Sequential Solution.
Parallel Lagrangean Relaxation
Parallel Approach
As it can be observed in Fig. 2, for a specific situation, to find the optimal commit- ment of the generating units in a hydroelectric system is preferable to implement a parallel method, since there are calculations that can be carried out concurrently. A hydroelectric system to optimize consists of a great number of power plants and for the problem at issue, different horizons can be established: a short term, a medium term and long term one, which implies a great amount of calculations. The short term programming involves a daily discretization, the medium term one involves a week and the long term a year; nevertheless if a daily program is required dis- cretization should be per hour, which allows for a supervision of the system in real

time [1].
The planning and discretization horizons obviously define the size of the problem to be dealt with, since the larger the planning and discretization horizons the larger the amount of data and the larger the dimension of the problem. In [11] a parallel environment is used to deal with the problem in question and it was considered as a motivation to approach the parallelization of the Heuristic method discussed in this paper. However unlike what was presented in the aforementioned proposal here the parallelization implemented is the Lagrangean Relaxation in terms of sub-problem CG to solve which a Master-Slave model is implemented on a cluster of work station linked by a network.

Algorithms
The algorithms used in this work for the master processor and for the slave pro- cessors are presented in the following diagrams, they have been written based upon main communication guidelines of the library MPITB responsible for relaying mes- sages [21], implemented through Octave programming language [22].

MASTER Process:
Start the slave processes (MPI Init())
Solve sub-problem CU (Using Dynamic Programming)
While there is an alteration in the last configuration of the generating units
do
Calculate sub-problem CG Calculate Lagrange Multipliers (λ ,μ) For k =1 to (K − 1) do
Send (switch open) to all slave processes (MPI Send( ))
Send (λ,μ) to all slave processes (MPI Send( ))
For k =1 to (K - 1) do
Receive pt from all the slaves (MPI Recv( ))
Calculate errors (Demand and Power Target constraint errors) Optimization Test (Generation Commitment and demand response errors)
If no solution were found, return to Calculate sub-problem CG
End sub-problem CG
Calculate sub-problema CU (New conﬁgurations for Generating Units are obtained)
For k =1 to (K − 1)
Send (switch close) to all active slave processes (MPI Send( ))
End (MPI Finalize)

Fig. 4. Algorithm of Master process.

In the algorithm presented in Fig. 4, the Master processor sends data (μ, λ) to the (K − 1) processors, K corresponds to the total number of available processors. The Master processor sends commands to start and finish generation calculation;

while it waitf for the pt of the slave processors.

SLAVE Process:
Initializes necessary values for calculation
Processes task division according to the number of processors available
(Initial and Final Time)
Receives switch from master (MPI Recv( ))
While switch remains open do
Receive (λ, μ) from master (MPI Recv( ))
For initial time to final time do Calculate equation (27)
Send ptto master process (MPI Send( ))
Receive switch from master (MPI Recv( ))
End

Fig. 5. Algorithm of the Slave process.
As it can be observed in Figures 4 and 5, master and slave processes solve the sub-problem of Generation Commitment in a certain time interval, allocating a fraction of time to each slave, subject to the programming horizon established.
Experimental Results
Computational Enviroment
The algorithms in Fig. 4 and 5 were encoded using Octave programming language [22], and the instructions from the MPITB library (MPI ToolBox) [21], on a Peli- canHPC architecture [24], that is to say a cluster of workstations, composed by per- sonal computers. The before mentioned cluster consists of 10 identical computers with 2.2 GHz Opteron AMD processors and 1GByte RAM memory, interconnected through a 100 Mbps Ethernet network and totally isolated from other networks. One of the machines was selected as the Master processor and the others as Slaves.
Results
The performance of the parallelization was verified carrying out a series of exe- cution tests, using as a sample problem the generation commitment on a daily programming horizon of 78 power plants in the Brazilian hydroelectric system. The discretization used was the hourly. As a measure of performance in the parallel context the SpeedUp (Sp), was used, this is defined as:

​
Sp = ts
tp

where ts corresponds to time (in seconds) which requires the program to be executed in a sequence and tp to the time required for executing the program on p processors.
In Fig. 6(a), can be observe that using the parallelization method proposed for solving the Generation Commitment problem, specifically from the moment when











(a)	(b)


Fig. 6. (a)Speedup (b)Execution time

3 processors are in use, an earning in term of time is experienced, if compared to the solution of the same problem with just one processor. This trend is permanent and it more significant when 5 or more processors are in use. In Fig. 6(b), what was mentioned before can be confirmed by checking the decreasing tendency for execution time when several processors are in use.
Comparatively, when solving the optimization problem sequentially, much more time is used if compared to the parallelization method presented in this proposal, since it is possible to obtain earnings of up to 4 times in terms of time considering the sample problem and the experimental platform used.

Conclusions
The optimization problem of the optimal commitment of generating units of a Hy- droelectric System, can be solved using a heuristic methodology which combines Lagrangean Relaxation and Dynamic Programming, and this can also be imple- mented in a parallel environment as it was presented in this work aiming at reduc- ing execution time, in agreement with the principle of real time control. In fact the growing tendency presented by SpeedUp, as well as the decreasing tendency of execution time for the solving of the problem encourages the design of other parallel algorithms, may be more efficient than the ones presented in this paper.

References
Arce, A., “Despacho O´ timo de Unidades Geradoras em Sistemas Hidroel´etricos via Heur´ıstica Baseada em Relaxac˜ao Lagrangeana e Programa¸c˜ao Dinˆamica”, Ph.D. Dissertation, Universidade Estadual de Campinas, Brazil, January 2006.
Arce A., T. Ohishi and S. Soares, Optimal dispatch of Generating Units of the Itaipu Hydroelectric Plant, IEEE Trans, on Power Systems, vol. 17(2002), No 1.


Almeida, F. and F. Rodrguez, “Introducci´on a la programaci´on paralela”, Ed. Paraninfo Cengage Learning, 2008.
Bazaraa, S. and C. Shety, “Nonlinear Programming”, Atlanta: John Wiley and Sons, 1979.
Bertzakas, D., “Nonlinear Programming”, Massachusetts: Athena Scientific, 1999.
De Caos a Cluster, URL: http://www.linux-magazine.es/issue/52/028-032Pelican\HPCLM52.pdf

Everett III, H., Generalized Lagrange Multiplier Method for Solving Problems of Optimum Allocation of Resources, Oper. Res. 11(1963), 399-417.
Fisher, M., The Lagrangian Relaxation Method for Solving Integer Programmming Problems, Management Science (pre-1986), 27(1981), No 1, 1-18.
Fisher, M., The Lagrangian Relaxation Method for Solving Integer Programming Problems, Management Science 27(1981),No. 1, 1-18.
Fisher, M., The Lagrangian Relaxation Method for Solving Integer Programming Problems, Management Science, 50(2004), No. 12,1861-1871.
Fung, C., S. Chow, and K. Wong, “A low Cost Parallel Computing Platform for Power Engineering Applications”, in Proc. of the 5th. International Conference on Advances in Power System Control and Management, APSCOM 20, Hong Kong, October, 2000.
Geoffrion, A., Lagrangean relaxation for integer programming, Mathematical Programming Study,
2(1974), 82-114.
Guignard, M., “Lagrangean Relaxation”, TOP, 11(2003), No.2, 151-228.
Held, M., R. Karp, The traveling salesman problem and minimum spanning trees, Operations Research,
18(970),1138-1162.
Held M., R. M. Karp, The Traveling salesman problem and minimum spanning trees: Part II, Mathematical Programming, 1(1971), No.1, 6-25.
Hilera, J., “Programaci´on paralela”, Ed. Universidad de Alcal´a, 1998.
Jim´enez, N., “Coordinacio´n hidrot´ermica en el corto plazo mediante t´ecnicas de relajaci´on lagrangiana”, Ph.D Disertation, Departamento de Tecnolog´ıa Electr´onica, Universidad de M´alaga, Spain, 1998.
Kuhn, H., and A. Tucker, “Nonlinear Programming”, in Proc. of the 2nd Berkeley Symposium on Mathematical Statistic and Probability, J. Neyman (Ed.), University of California Press. Berkeley, CA, 1951.
Luemberger D., “Introduction to Linear and Non-linear Programming”, Second Edition, Addison- Wesley, Reading, Mass., 1984.
Lasdon, L., “Optimization Theory of Large Systems”, New York: Macmillan Company, NY, 1970.
Morris, L., MATLAB Laboratory for MPI toolbox (MPITB), URL: http://www.tech.plym.ac.uk/ spmc/links/matlab/matlab_mpi.html
Octave, URL: http://www.www.gnu.org/software/octave/

Ohishi, T., E. Santos, A. Arce M. Kadowaki, M. Cicogna and S. Soares, “Comparison of two Heuristic Approaches to Hydro Unit commitment”, IEEE Power Tech, St. Petersburg, Russia, June 2006.
PelicanHPC GNU Linux, URL: http://idea.uab.es/mcreel/ParallelKnoppix/

Ruggiero M., V. L´opez, “C´alculo Num´erico, Aspectos Te´oricos y Computacionales”, MacGraw-Hill, 1988.
Shapiro, J., “Mathematical Programming: Structures and algorithms”, John Wiley and Sons, 1979.
Stoer, J., Duality in Nonlinear Programming and the Minimax Theorem, Numerische Mathematik,
5(1963),371-379.
Singiresu R., “Engineering Optimization, Theory and Practice”, Fourth Edition, John Wiley and Sons, 2009.
