

Electronic Notes in Theoretical Computer Science 223 (2008) 187–200
www.elsevier.com/locate/entcs

The Length of Subset Reachability in Nondeterministic Automata
Pavel Martyugin1
Department of Mathematics and Mechanics Ural State University
620083 Ekaterinburg, Russia

Abstract
We study subset reachability in nondeterministic finite automata and look for bounds of the length of the shortest reaching words for automata with a fixed number of states. We obtain such bounds for nondeterministic automata over 2-letter, 3-letter and arbitrary alphabets.
Keywords: Reachability, Synchronization, Nondeterministic Automata


Introduction
A nondeterministic finite automaton (NFA) is a triple A = (Q, Σ, δ) such that Q is a finite set of states, Σ is a finite alphabet, and δ is a transition function. The function δ maps the set Q × Σ to the set 2Q where 2Q is a set of all subsets of
the set Q. If q ∈ Q, a ∈ Σ, and δ(q, a)= P ⊆ Q, we write P = q.a. Let Σ∗ be the Σ-generated free monoid whose identity element (the empty word) is denoted by λ. The function δ can be naturally extended to the set 2Q × Σ∗. Let S ⊆ Q, a ∈ Σ, then we put S.a =   q.a. We also put S.λ = S. Let S  Q, w  Σ , w = ua and
q∈S
the set S.u is defined, then we put δ(S, w)= S.w = S.u.a.
Let A = (Q, Σ, δ) be an NFA, S, T ⊆ Q, w ∈ Σ∗, and S.w = T . In this case we say that the set T is reachable from the set S in the automaton  and w is a reaching word.
If an NFA has only one letter, then it is just a directed graph. In this case reachability describes an ‘infection’ model in the graph. Let Γ = (Q, E), where E ⊆ Q × Q, be a directed graph. Suppose that at some initial moment τ = 0 

1 martugin@mail.ru


1571-0661 © 2008 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2008.12.039

of discrete time τ some vertices q ∈ Q get marked (‘infected’). Now assume that marks propagate according to the following rule: a vertex v ∈ Q gets a mark at the moment τ = i + 1 if and only if there exists an arrow (u, v) ∈ E such that the vertex u was infected at the moment τ = i. The following picture shows the evolution of ‘infection’ in a simple example. Initially only one vertex was marked but soon, more precisely, in three steps the whole graph has become infected. The process of the graph infection can be interpreted as a reachability of the set Q from one-element subset S ⊆ Q.
			
4	4	4	4
τ =0	τ =1	τ =2	τ =3 
Fig. 1. Evolution of markings in a graph
One can think of the described model as of a version of Conway’s Game of Life with rather simplified rules and a finite but arbitrarily complex gameboard. Our model also admits quite a natural interpretation in terms of the spread of e-mail viruses on networks, which is certainly a problem of both practical and theoretical interest. Indeed, imagine the directed graph whose vertices are, say, Microsoft Outlook Express users and whose arrows are pairs (B, C) of users such that the e-mail address of C is stored in the address book of B and also loops (B, B) for all users who do not use an appropriate anti-virus software. Many e-mail viruses propagate by using the following mechanism: when such a virus arrives at the computer of a user B, it immediately starts sending itself to all addresses that if finds in the infected computer. In this active phase, the virus can be detected and deleted by the corresponding anti-virus software provided the user B had installed some; if B had not taken care of protecting her or his computer, the latter stays infected forever and keeps infecting its ‘neighbors’ in the described graph. It is easy to see that the rule of our model formalizes exactly this propagation mechanism.
The natural question is the following one: how fast can such an ‘epidemic’ spread over a graph with a given number of vertices. The following theorem can be proved.
Theorem 1.1 Let Γ= (Q, E) be a directed graph with a marked vertex and |Q| = n. If marks can propagate over the whole set Q, then the propagation completes in at most (n − 1)2 +1 steps. This bound is tight in the sense that for each n > 1 there exists a directed graph Γ= (Q, E) with |Q| = n such that marks can propagate from a certain vertex to Q and the propagation takes exactly (n − 1)2 +1 steps.
This theorem was discovered many times in different formulations. A proof can be found for instance in [7] or [2]. There the authors considered the following problems. Let M be a matrix of size n × n with nonnegative real elements. The

matrix M is called primitive if there exists an integer p > 0 such that all elements of Mp are positive. The question is: how large can be minimal p > 0 for primitive matrix M of size n×n such that all elements of matrix Mp are positive. The example of a primitive matrix is the adjacency matrix of a directed graph G = (Q, E) such that the set Q is reachable from any one-element subset q ⊆ Q. The following theorem is equivalent to Theorem 1.1.
Theorem 1.2 If M is a primitive matrix of size n × n, then for p ≤ (n − 1)2 +1 all elements of M are positive. This bound is tight in the sense that for each n > 1 there exists a matrix M of size n × n such that p = (n − 1)2 +1 is a smallest number with property that M contains only positive elements.
The reachability in NFA containing more than one letter is thus a natural gener- alization of the reachability in directed graphs. We can also consider the infection of NFA. Let A = (Q, Σ, δ) be a NFA and q ∈ Q. The question is how long can be the shortest word w such that q.w = Q. In this paper we consider not only reachability of the set Q from one-element subsets but also reachability of some subset T ⊆ Q from some subset S ⊆ Q.
Even though the above interpretation may look quite attractive, it would be fair to say that our original motivation has come from a different source, namely, from the theory of synchronizing automata. Recall that a deterministic finite automaton (DFA) A = ⟨Q, Σ, δ⟩ is said to be synchronizing (or directable) if there exists a word w ∈ Σ whose action resets A, that is, brings all states to a particular one: δ(q, w) = δ(q', w) for all q, q' ∈ Q. It is rather natural to ask how long
such a reset (or directing ) word may be. Cˇerny´ conjectured in [1] that for any
synchronizing automaton A there exists a reset word of length (|Q|− 1)2. Although being confirmed in some special cases, this simply looking conjecture still constitutes an open problem. Surveys of results concerning synchronizing words can be found in [5] or [6].
One can conveniently think of any DFA A = ⟨Q, Σ, δ⟩ as a board for a solitaire- like game. Each letter a ∈ Σ defines a move via the following rule: if tokens had covered certain subset S of the state set Q before the move corresponding to a then, after the move, tokens cover states from the set {δ(q, a) | q ∈ S}. The initial position is such that every state in Q is covered by a token. Then synchronizing automata can be characterized as automata for which a sequence of moves collects all tokens on a single state, and the shortest reset word is nothing but the shortest sequence of moves with this property. This game viewpoint has proved to be useful, especially when constructing examples of ‘slowly’ synchronizing automata.
Now consider the reversal of A, that is, the non-deterministic automaton (NFA) Arev = ⟨Q, Σ, δ−1⟩ where δ−1(q, a)= {q' | δ(q', a)= q}. Clearly, the above solitaire game on A corresponds to an ‘anti-solitaire’ game on A  in which the move cor- responding to a given letter a makes tokens propagate along the arrows labelled a
(tokens may multiply if necessary). The reversals of synchronizing automata can be then characterized as automata for which a sequence of moves distributes tokens over the whole state set from a single state, and the shortest reset word for A co-

incides with the reversal of the shortest move sequence with the latter property for Arev. Thus, studying the above anti-solitaire game on non-deterministic automata may be considered as an approach to the Cˇerny´ conjecture and generalizations of the conjecture to the non-deterministic case (see [4] and [3, Chapter 8] for a discus- sion of such generalizations). At the same time the ‘anti-solitaire’ game is a model
of reachability of the set Q from some one-element set.
The reachability in NFA can be described using a token model too. Let A = (Q, Σ, δ) be an NFA, S, T ⊆ Q, and w ∈ Σ∗. Let at the start time there is a token on any state from the set S. We apply the letters of the word w step by step. The
action of any letter a ∈ Σ splits the token from the state q into |δ(q, a)| parts. After that, it moves these parts to the states of the set δ(q, a). If two tokens arrive to one state, then one of them removes. If a subset of states with tokens is equal to T after the action of the word w, then the set T is reachable from the set S.
We are ready to formulate the main problem discussed in the paper (an analogue of the Cˇerny´’s problem). Let a finite set Q and its subsets S, T  Q be fixed. Consider all NFAs A = (Q, Σ, δ) such that the set T is reachable from the set S in A . Denote by dA (S, T ) the length of the shortest word reaching the set T from the set S in the NFA A . If there is no word u such that S.u = T , then we put
dA (S, T )= −∞. We study the maximal size of the value dA (S, T ) for fixed sets Q, fixed subsets S, T ⊆ Q, and an arbitrary NFA A = (Q, Σ, δ). Define two values:
ω(Q, S, T )= max{dA (S, T )|A = (Q, Σ, δ) is a NFA},

ωk(Q, S, T )= max{dA (S, T )|A = (Q, Σ, δ) is a NFA, |Σ| = k}.
We call these values the length of reachability and the length of k-reachability of the set T from the set S in the set Q. In this paper we obtain bounds for the values ω(Q, S, T ) and ωk(Q, S, T ) for k ≥ 2. Let |Q| = n. First we prove that
ω(Q, S, T ) = 2n − 2 for T ∈/ {∅, Q, S}, and ω(Q, S, ∅) = 2 − 1 (Theorem 2.1).
Then we show that ω(Q, S, Q) ≥ 3[(n−1)/3♩ for 1 ≤ |S| < n − 2 (Theorem 2.2). We also prove that the minimum value of ω (Q, S, T ) for fixed Q and arbitrary S, T ⊆ Q,S ∈/ {T, ∅} as a function of |Q| = n grows faster than any polynomial in n (Theorem 3.1). Moreover, we prove that the value ω (Q, S, T ) for ‘not very
large’ subsets T is greater than some function of |Q| = n which grows faster than any polynomial in n (Theorem 3.2).
For the sequel, we need some notation. For a word w ∈ {a, b}∗, we denote by
|w| the length of w and by w[i], where 1 ≤ i ≤ |w|, the i	letter in w from the left.
If 1 ≤ i ≤ j ≤ |w|, we denote by w[i, j] the word w[i] ··· w[j].

Automata over an arbitrary alphabet
Here we find the value ω(Q, S, T ). The idea of the proof of the following theorem was used in [4] to prove a lower bound of the length of the shortest D1-synchronizing words. We use it in a more general setting.

Theorem 2.1 Let Q be a ﬁnite set, |Q| = n. Let S be a non-empty subset of Q
and T a subset of Q such that T /= Q, ∅, S. Then
ω(Q, S, T )= 2n − 2;
ω(Q, S, ∅)= 2n − 1.
Proof. Let A = (Q, Σ, δ) be a NFA. Recall that we denote by dA (S, T ) the length of the shortest word w such that δ(S, w) = T . Let us first prove that dA (S, T ) ≤ 2n − 2. Suppose by a contradiction that dA (S, T ) = m > 2n − 2. Let w ∈ Σ be a word such that S.w = T and |w| = m > 2n − 2. Consider the sets S.w[1, i], i ∈ {0,... , m}. Each of them is not empty. The set Q contains only 2n − 1 distinct nonempty subsets. Therefore there exist numbers i1, i2 ∈ {0,... , m}, i1 < i2 such that S.w[1, i1] = S.w[1, i2]. In this case S.w[1, i1][i2 + 1, m] = T and dA (S, T ) ≤ m − (i2 − i1) < m. This is a contradiction. Thus dA (S, T ) ≤ 2n − 2. The inequality dA (S, ∅) ≤ 2n − 1 can be proved by the same way.
Now we construct an NFA Anfa = (Q, Σ, δ) such that dAnf a (S, T )= 2 − 2. Let
n
P0,... , P2n−2 be the distinct nonempty subsets of the set Q listed such that P0 = S, P1 = Q, P2n−2 = T , and |P1| ≥ |P2| ≥ ... ≥ |P2n−3| = 1. In the case of S = Q, we put P0 = Q and |P0| ≥ |P1| ≥ ... ≥ |P2n−3| = 1. Now we take the alphabet Σ= {a1,... , a2n−2} and, for each i ∈ {1,... , 2n − 2}, define
δ(q, a )= ⎧⎨ Pi if q ∈ Pi−1,
⎩ Q if q ∈/ Pi−1.
Let w = a1 ... a2n−2. We have S.a1 ... ai = Pi for i ∈ {1,... , 2n − 2}. Therefore S.a1 ... a2n−2 = T . We are going to prove that w is the shortest word such that δ(S, w)= T . Let u ∈ Σ∗ be one of the shortest words such that S.u = T . Arguing by a contradiction, suppose |u| < |w|. Note that the word u can not be equal to w[1, j] for some j < |w| because S.w[1, j] = Pj /= T . Let k = min{j|w[j] /= u[j]}. Consider the set S.u[1, k]. We have

Pi if i	1,... , 2n	2 , u[k]= ai, S.u[1,k	1]	Pi−1,
S.u[1, k]= 
⎩ Q otherwise.
The set S.u[1,k − 1] = Pk−1 can be a subset of Pi−1 only if k − 1 ≥ i − 1 (otherwise
|Pk−1| ≥ |Pi−1|). In this case S.u[1,k − 1].u[k] = S.u[1,k − 1].ai = Pi. Therefore
S.u = S.u[1,i − 1].u[k, |u|], and the word u is not the shortest reaching word.
If S.u[1, k] = Q, then S.u = S.u[1].u[k + 1, |u|] (if S = Q = P0, then S.u =
S.u[k + 1, |u|]). Again, in this case the word u is not the shortest reaching word.
n	n
Hence dAnf a (S, T ) ≤ 2 − 2 and ω(Q, S, T )= 2 − 2.
It is enough to construct the automaton Anfa and put T = ∅ for proving ω(Q, S, ∅) = 2n − 1. In this case the sequence of sets Pi contains all 2n subsets of the set Q. Hence the shortest word reaching the empty set from the set S has length 2n − 1. The theorem is proved.	 

Note that the case of T = Q was not considered in Theorem 1. This case is more complicated, but we still can prove that the value ω(Q, S, Q) is exponential in
|Q| for any subset S ⊂ Q.
Theorem 2.2 Let Q be a ﬁnite set, |Q| = n. If S is a subset of Q such that
1 ≤ |S| < n − 2, then ω(Q, S, Q) ≥ 3[(n−1)/3♩.
Proof. Let n be equal to 3k + 1 for some integer k (one or two states can be added to obtain a similar construction for n /= 3k + 1). We put k = (n − 1)/3. We are going to construct a NFA  nfa = (Q, Σ, δ). By definition, put
Q = {q(m, i)|m ∈ {0, 1, 2},i ∈ {1,... , k}} ∪ {start},	Σ= {a1,... , ak, b, c}.
Let i ∈ {1,... , k}, then by definition, put
δ(start, b)= {q(0, j) | j ∈ {1,... , k}};	for q /= start, δ(q, b)= ∅;
δ(start, c)= ∅;	for δ(q(0, i), c)= δ(q(1, i), c)= ∅;
δ(q(2, i), c)= {q(0, i), q(1, i), q(2, i), start}.
Let i, p ∈ {1,... , k} and m ∈ {0, 1, 2}, then
⎧⎪ {q(m, i)},	p > i
δ(q(m, i), ap)= ⎪⎨ ∅,	p = i, m =2 .

⎪⎩ {q(0, i)},	p < i, m =2 
δ(start, a1)= ... = δ(start, ak)= start,
We have 1 ≤ |S| < n − 2. Hence we can assume that S ⊆ Q\{q(0, 1), q(1, 1), q(2, 1)} and start S. The automaton nfa for k = 3 is shown in Fig. 2. The action of the letters a1,... , ak in the automaton Bnfa can be thought of as the ternary counter of k-digit integers.
We construct a word w such that S.w = Q. First we define words v1,... , vk. Let v1 = a2. Assume the word vi is already defined, then by definition, put vi+1 = viai+1viai+1vi. We prove that the word w = bvkc is the shortest word such that
S.w = Q.
Let i ∈ {1,... , k}. Notice that S.b = {q(0, 1),... , q(0, k)}. Inducting on i
one can obtained S.bvi = {q(2, 1),... , q(2, i)}∪ {q(0,i + 1),... , q(0, k)}. Therefore Q.bvkc = {q(2, 1),... , q(2, k)}.c = Q. By the construction, |v1| = 2, |vi+1| = 3 · |vi| + 2. Hence |vk| = 3k − 1, |w| = 3k +1 = 3n/3 + 1.
We are going to prove that no word of length less then |w| reaches the set Q from the set S. Denote by Qi the set {q(0, i), q(1, i), q(2, i)} for i ∈ {1,... , k}. Let us define the weight μ(P ) for any subset P ⊆ Q. Suppose Pi ⊆ Qi for some

a1, a2, a3



a1, a2

a2, a3,c	a1, a2

a1, a2
c	c	c
Fig. 2. The automaton Bnfa for k =3 
i ∈ {1,... , k}. By definition, put
⎧ 2 · 3i−1 if q(2, i) ∈ Pi,
3i−1	if q(2, i) / Pi, q(1, i)	Pi,
μ(Pi)= 
0	if q(2, i) ∈/ Pi, q(1, i) ∈/ Pi, q(0, i) ∈ Pi,
⎪⎩ −∞	if q(2, i) ∈/ Pi, q(1, i) ∈/ Pi, q(0, i) ∈/ Pi.
⎧⎨ 1 if P0 = {start},
Let Q  = {start} and P  ⊆ Q . By definition, put μ(P ) = 

0	0	0
⎩ 0 if P0 = ∅.

An arbitrary subset P ⊆ Q is the union of the sets Pi = P ∩ Qi, i ∈ {0,... , k}. We put μ(P )= μ(P0)+ ... + μ(Pk).
Suppose α ∈ Σ∗ and P ⊆ Q. We prove that if μ(P )= −∞, then μ(P.α) ≤ 0; if
μ(P ) ≥ 0, then μ(P.α) ≤ μ(P )+ 1.
First suppose μ(P ) = −∞. In this case there is i ∈ {1,... , k} such that Pi =
P ∩ Qi = ∅.
If α ∈ {a1,... , ak, c}, then P.α ∩ Qi = ∅ and μ(P.α)= −∞.
Assume α = b.
If start ∈ P , then P.b = {q(0, 1),... , q(0, k)} and μ(P.b)= 0,
If start ∈/ P , then P.b = ∅ and μ(P.b)= −∞.

Suppose μ(P ) ≥ 0.
Assume α = b.
If start ∈ P , then P.b = {q(0, 1),... , q(0, k)} and μ(P.b)= 0,
If start ∈/ P , then P.b = ∅ and μ(P.b)= −∞.
Assume α = c.

· If {q(2, 1),... , q(2, k)} ⊆ P , then
if start ∈/ P , then μ(P )= 3k − 1 and P.α = Q, therefore, μ(P.α)= 3k; if start ∈ P , then μ(P )= 3k and P.α = Q, therefore, μ(P.α)= 3k.
· If {q(2, 1),... , q(2, k)} ¢ P , then there exists i ∈ {1,... , k} such that q(2, i) ∈/ P , in this case P.α ∩ Qi = ∅ and μ(P.α)= −∞.
Assume α = ai for some i ∈ {1,... , k}. In this case for j ∈ {i + 1,... , k}, P.α ∩ Qj = P ∩ Qj.
· Let {q(2, 1),... , q(2, i−1)} ⊆ P , then for j ∈ {1,... , i−1}, P.α∩Qj = {q(0, j)}.
· If q(2, i) ∈/ P , q(1, i) ∈/ P and q(0, i) ∈ P , then {q(1, i)} ⊆ P.α ∩ Qi and
μ(P.α)= (μ(P ) − 2 − 2 · 3 − ... − 2 · 3i−2)+ 3i−1 = μ(P )+ 1.
If q(2, i) ∈/ P and q(1, i) ∈ P , then {q(2, i)} ⊆ P.α ∩ Qi and μ(P.α)= (μ(P ) −
2 − 2 · 3 − ... − 2 · 3i−2) − 3i−1 +2 · 3i−1 = μ(P )+ 1.
If q(2, i) ∈ P , then
if q(1, i) ∈/ P and q(0, i) ∈/ P , then P.α ∩ Qi = ∅ and μ(P.α)= −∞;
if q(1, i) ∈/ P and q(0, i) ∈ P , then P.α ∩ Qi = q(i, 1) and μ(P.α) = (μ(P ) −
2 − 2 · 3 − ... − 2 · 3i−2)+ 3i−1 − 2 · 3i−1 = μ(P ) − 2 · 3i−1 + 1;
if q(1, i) ∈ P , then P.α∩Qi = q(2, i) and μ(P.α)= μ(P )−2−2·3−.. .−2·3i−2 =
μ(P ) − 3i−1 + 1.
Let there is j ∈ {1,... ,i − 1} such that q(2, j) ∈/ P , then P.α ∩ Qi = ∅ and
μ(P.α)= −∞.
Thus if μ(P ) = −∞, then μ(P.α) ≤ 0; if μ(P ) ≥ 0, then μ(P.α) ≤ μ(P )+ 1. Therefore for P = S obtain P  Q1 = ∅. Whence μ(S)=  . At the same time, μ(Q) = 1+2+2 3+ ... +2 3k−1 = 3k. Therefore the set Q can not be reached from the set S under the action of a word of length less then 3k +1 = 3(n−1)/3 + 1. Hence ω(Q, S, Q) ≥ 3[(n−1)/3♩.	 
The NFA Bnfa can be used to prove the bounds ω(Q, S, Q) ≥ 2 · 3[(n−1)/3♩−1 and ω(Q, S, Q) ≥ 3[(n−1)/3♩−1 for subsets S ⊆ Q of cardinality n − 2 and n − 1 correspondingly. Therefore for any S ⊆ Q the value ω(Q, S, Q) is exponential in
|Q|.

Automata over a fixed alphabet
We showed in the previous section that for any subsets S, T ⊆ Q the value ω(Q, S, T ) is exponential in |Q|. What about the values ωk(Q, S, T ) for different k? Are they exponential or polynomial in |Q|?
Let us consider the minimal value of ωk(Q, S, T ) for fixed Q and arbitrary S, T ⊆
Q. Let k ≥ 2 be an integer. Define


k
min
(n) = min{ωk(Q, S, T )|S, T ⊆ Q, S ∈/ {T, ∅}, |Q| = n}.



We prove that for k ≥ 3 the value ωk
n.
(n) grows faster than any polynomial in

Theorem 3.1 If k ≥ 3, then the value ωk
(n) grows faster than any polynomial

in n.
Proof. It is evident that ωk
min

(n) ≥ ω3

(n) for k > 3. Thus we consider the

value ω3 (n).We prove that for any subsets S, T of Q such that S /= T, ∅, one has
√
ω3(Q, S, T ) ≥ 2 3 |Q|.
Case 1. T /= Q, |S| > 1. We construct a NFA Anfa3 = (Q, {a, b, c}, δ). Let pj be the j-th prime number (i.e. p1 = 2, p2 = 3, and so on). Assume for simplicity that |Q| = p1 + ... + pr for some r. By definition, put
Q = {q(i, m)|i ∈ {1,... , r},m ∈ {0,... , pi − 1}}.
Now we define the action of the letters a, b, c. Denote by R the set {q(j, 0)|j ∈
{1,... , r}}. Let i ∈ {1,... , r}, m ∈ {0,... , pi}, then
δ(q(i, m), a)= R,

δ(q(i, m), b)= {q(i, (m + 1) mod pi)}, δ(q(i, m), c)= ⎧⎨ T if m = pi − 1,
⎩ Q otheswise.
The NFA Anfa3 is shown in Fig. 3, where solid, dashed, and dotted lines stand for the action of respectively b, a, and c. It is easy to prove that, for any subset S  Q, one has S.abp1·...·pr −1c = T .


q(1, 0)
Q

q(2, 0)
Q
Q  q(3, 0)
q(3, 1)


R


q(3, 2)


q(1, 1)
R	R
q(2, 2)
Q q(2, 1)
q(3, 4)
Q
q(3, 3)
. . .


Q	Q
T	T	T
Fig. 3. Automaton Anfa3

Let w ∈ Σ∗ be the shortest word reaching the set T from the set S in Anfa3. Suppose S /⊂ T .  We have |S| > 1 and T /= Q.  Therefore we can assume
{q(1, 0), q(1, 1)} ⊆ S and q(1, 0) ∈/ T . The word w contains the letter a because for any word v ∈ {b, c}∗ one has {q(1, 0), q(1, 1)} ⊆ {q(1, 0), q(1, 1)}.v. Suppose S ⊂ T ; then we can assume {q(1, 0), q(1, 1)} ⊆ S, T . In this case for any word v ∈ {b, c}∗,
|S.v| ∈ {|Q|, |S|}. This implies that |S.v| /= |T |. Hence the word w contains the letter a.
It is easy to show that for any v ∈ Σ∗,u ∈ Σ∗ one has S.vau = S.au. Therefore w[1] = a and w[i] /= a for any i > 1. We may assume that the automaton Anfa3 and the set T can be defined such that T /= R.bt for any integer t > 0. Hence w = abtc

for some t. Notice that S.abtc ∈ {T, Q}. If S.abtc = Q, then the letter a should be applied again. Therefore w = S.ab c.
We have S.a = R = {q(i, 0)|i ∈ {1,... , r}}. Note that for any i ∈ {1,... , r}, we have q(i, 0).ax = q(i, pi − 1) if and only if x ≡ pi − 1(mod pi). We obtain a system of r linear congruences. The minimal positive solution of this system is x = p1p2 ... pr  1. Therefore t = p1p2 ... pr  1. This means that the word w = bap1·...·pr −1c is a shortest word reaching the set T from the set S in the automaton Anfa3.
Notice that i < pi for any i ≥ 1. From the famous Tschebycheff theorem it follows that α · i ln(i) < pi < β · i ln(i), where α and β are some constants. Hence for 1 < i ≤ r, pi < i2 ≤ r2. Therefore
r	r	r	r
|w| =   pi +1 >   i = r! > 2r, n = Σ pi ≤ Σ r2 = r3.

i=1
Hence ω3(Q, S, T ) ≥ 2 √3 |Q|.
i=1
i=1
i=1

r
If
i=1
pi < |Q| <
r+1
i=1
pi, then a similar construction proves the statement of the

theorem. We just should add the states q1,... , qσ to the automaton Anfa3 and put
qi.a = {q(j, 0)|j ∈ {1,... , r}}, qi.b = {qi}, qi.c = T for i ∈ {1,... , σ}.
Case 2. T /= Q, |S| = 1. The inequality ω3(Q, S, T ) ≥ 2	|Q| can be proved
similarly using the NFA A '	= (Q, {a, b, c}, δ) such that Q = {q(i, m) | i ∈
{1,... , r},m ∈ {0,... , pi − 1}} ∪ {start}, S = {start}, and for i ∈ {1,... , r},
m ∈ {0,... , pi}
δ(q(i, m), a)= Q, δ(start, a)= {q(j, 0)|j ∈ {1,... , r}},
δ(q(i, m), b)= {q(i, (m + 1) mod pi)}, δ(start, b)= Q,
δ(q(i, m), c)= ⎨ T if m = pi − 1, δ(start, c)= Q.
Q otherwise,
The proof of Case 2 is omitted due to the space constraints.
Case 3. T = Q. Let us construct a NFA Bnfa3 = (Q, {a, b, c}, δ). Let pj be the j-th prime number. We put also p0 = 1. For simplicity assume that |Q| = p0 + ... + pr +2 for some r. Let
Q = {q(i, m) | i ∈ {0,... , r},m ∈ {0,... , pi − 1}} ∪ {start}∪ {err}.
In this case, ∅ /= S /= Q. Whence we can assume q(0, 0) ∈/ S and start ∈ S. For i ∈ {0,... , r} denote by Ki the set {q(i, m) | m ∈ {0,... , pi−1}}. Let i ∈ {0,... , r}, m ∈ {0,... , pi − 1}. By the definition, we put
δ(q(i, m), a)= {err},	δ(start, a)= {q(j, 0)|j ∈ {1,... , r}} ∪ {err},
δ(q(i, m), b)= {q(i, (m + 1) mod pi)}∪ {err},	δ(start, b)= {err},

δ(q(i, m), c)= ,⎨ Ki ∪ {start}∪ {err} if m = pi − 1,
, {err},	otherwise,

δ(start, c)= {err},

δ(err, a)= δ(err, b)= δ(err, c)= {err}.
It can be proved that for any subset S, S.abp1 ·...·pr −1c = Q. The NFA Bnfa3 is represented in Fig. 4, where solid, dashed, and dotted lines stand for the action of respectively b, a, and c.
Let w ∈ Σ∗ be the shortest word such that S.w = Q. Suppose that at the beginning every state from the set S holds a token. There is no token on the state q(0, 0). After applying the word w one of the tokens should be on the state q(0, 0). It can appear there under the action of the letter a only. For any subset P ⊆ Q we
have either P.a = {q(j, 0)|j ∈ {1,... , r}} ∪ {err} (if start ∈ P ), or P.a = {err} (if
start ∈/ P ). Therefore for any word v ∈ Σ∗ we have either S.va = S.a = {q(j, 0)|j ∈
{1,... , r}} ∪ {err}, or S.va = {err}. The word w can not be equal to vau for some
v /= λ and u ∈ Σ∗. Indeed, if S.va = S.a, then S.vau = S.au and the word w is not a shortest; if S.va = {err}, then S.w /= Q. Therefore w[1] = a and w[l] /= a for l > 1.
There is only one token in any set Ki at the moment when the letter w[1] = a has been applied. The letter b does not change the number of tokens in the set Ki. Suppose w[l]= c. If q(i, pi − 1) ∈/ S.w[1,l − 1], then S.w[1, l] ∩ Ki = ∅. In this case the word w[l+ 1, |w|] should contain the letter a, and the word w is not the shortest. If {q(i, pi − 1)|i ∈ {1,... , r}} ⊆ S.w[1,l − 1], then S.w[1, l]= Q. Therefore l = |w|. The set Q can not be obtained from the set S under the action of a word which consists of the letters a and b only. Therefore w = abtc for some t. The minimal possible positive t is equal to p1 · ... · pr − 1. By the same argument as in the proof of Case 1, we obtain that ω3(Q, S, T ) ≥ 2 3 |Q| for sufficiently large |Q|.
start	err



q(0, 0)	q(1, 0)

q(2, 0)


q(3, 0)
q(3, 1)


q(3, 2)




q(1, 1)

q(2, 2)


q(2, 1)

q(3, 4)


q(3, 3)
. . .






If 2 +

r i=1


pi < |Q| <2+ 
Fig. 4. Automaton Bnfa3

r+1
pi, then the same automaton can be constructed.
i=1

We only should add some states q1,... , qσ and put qi.a = qi.b = qi.c = err for

i ∈ {1,... , σ}.
Since in Cases 1-3 we have obtained that ω3(Q, S, T ) ≥ 2 √3 |Q| for S, T ⊆ Q
S /= T, ∅, the value ω3 (n) grows faster than any polynomial in n. The theorem
is proved.	 

Is the value ω2
(n) a polynomial in n? This question is still open. We answer

here to a weaker form of this question.
Let pi be the i-th prime number (i.e. p1 = 2, p2 = 3, and so on). Let Q be a

finite set, |Q| = n and
r i=1
r+1
pi	n < 
i=1
pi for some r. Let

Ψ= {P ⊆ Q | |P | ≤ Σ pi − r − 2},
i=1
i.e. Ψ consists of ‘not very large’ subsets of Q. By the definition, put


2
min
(n) = min{ω2(Q, S, T )|S ⊆ Q, T ∈ Ψ,S ∈/ {T, ∅}, |Q| = n}.

Theorem 3.2 The value ω¯2
min
(n) grows faster than any polynomial in n.

Proof. We are going to prove that for sufficiently large |Q| and T ∈ Ψ, S ⊆ Q S /= T, ∅ one has ω¯2(Q, S, T ) ≥ 2 3 |Q|.
Case 1. |S| > 1. We define a NFA Anfa2 = (Q, {a, b}, δ). Let pj be the j-th prime number. Assume for simplicity that |Q| = p1 + ... + pr for some r. We put
Q = {q(i, m) | i ∈ {1,... , r},m ∈ {0,... , pi − 1}}.
Denote by R the set {q(i, 0)|i ∈ {1,... , r}}. Denote by F the set {q(i, pi − 1)|i ∈
{1,... , r}}. Notice that |R| = |F | = k. Let i ∈ {1,... , r}, m ∈ {0,... , pi}. By definition put
δ(q(i, m), a)= ,⎨ T if m = pi − 1,
, R if otherwise,
δ(q(i, m), b)= {q(i, (m + 1) mod pi)}.
Since T ∈ Ψ, we have |T | < |Q|− |F |− 1. We may assume that T ∩ F /= ∅ and
R⊆T because we can take the set Q\(F ∪ {q(1, 0)}) containing in the set T .
The NFA AnfaA is represented in Fig. 5, where solid and dotted lines stand for the action of respectively b and a.
Let |S| > 1. We prove that we may assume that |S ∩ K2| ≥ 2. Indeed, if
|S ∩ T |≥ 2, then |S| ≥ 2, and we may assume that q(2, 1), q(2, 2) ∈ S. If S ∩ T = ∅, we may assume that q(2, 1) ∈/ T because |T | < |Q|− |F |− 1. We have q(2, 0) ∈ F , whence q(2, 0) ∈/ T . Thus we may assume that q(2, 0), q(2, 1) ∈ S. If |S ∩ T | = 1, then we may assume q(2, 1) ∈ S ∩ T . We have |S| > 1, whence we may assume that q(2, 0) ∈ S. This implies that |S ∩ K2|≥ 2.

For any subset S  Q one has S.a2bp1·...·pr −1a = T . Indeed, S.a  T R  Q F . Hence S.a2 = R. Further, R.bp1·...·pr−1 = F . Therefore F.a = T .
Let w ∈ Σ∗ be such that |w| = dAnf a2 (S, T ). Suppose that at the beginning every state from the set S holds a token. We have |S ∩ K2| ≥ 2, therefore there are at least two tokens on the set K2. It can be proved that the automaton nfa2 can be constructed such that S.bl /= T for any integer l. Hence the word w contains a
letter a. Let j1 be the position of the first occurrence of letter a in the word w. Let
S.w[1, j1 − 1] = P1. Notice that P1.a ∈ {T, R, T ∪ R}.
Let P1.a = R ∪ T and T /= ∅. For any subset P ⊆ Q, |P.b| = P . Hence for any t ≥ 0 it follows that (R ∪ T ).bt /= T . Therefore there is a second occurrence of the letter a in the word w. Let j2 be the number of this occurrence. If S.w[1, j2]= R∪T , then S.w = S.w[1, j1]w[j2 + 1, |w|] = T . This means that S.w[1, j2] /= R ∪ T . We have P1.a = R ∪ T and T /= ∅. Therefore there exists i ∈ {1,... , r} such that
|Ki ∩ P1.a| = 2. Hence for any t we have |P1.ab ∩ Ki| ≥ 2. Therefore S.w[1, j2] /= T . Thus S.w[1, j2]= R.
Let m = min{j|S.w[1, j] = R}. We have just proved that m = j1 or m = j2. For any i ∈ {1,... , r}, |S.w[1, m] ∩ Ki| = 1. Either the set T is empty, or |T | = 1, or for some i ∈ {1,... , r}, |T ∩ Ki| ≥ 2. Hence for any integer t > 0 it follows that T /= R.bt. The set F cannot be reached from the set R under the action of any word of length less than bp1 ·...·pr −1. At the same time for t < p1 · ... · pr − 1 we have R.bta = T ∪ R. Therefore |w| ≥ m + p1 · ... · pr. Hence if S ⊆ T or T = ∅, then
|w| ≥ 1+ p1 · ... · pr, else |w| ≥ 2+ p1 · ... · pr. In any case, for sufficiently large |Q|,
we have ω2(Q, S, T ) ≥ 2 3 |Q|.

For
r

i=1
pi < |Q| <
r+1
i=1
pi, the construction is similar. To obtain it we should add

states q1,... , qσ to the automaton Anfa2 and define qi.a = R, qi.b = {qi} for i ∈
Σr
{1,... , σ}. We should also assume that q1,... , qσ ∈/ T , because |T |≤ (	pi)−r −2.
The proof for this case is similar.
Case 2. |S| = 1. The inequality ω3(Q, S, T ) ≥ 2 3 |Q| can be proved similarly
using the NFA A '	= (Q, {a, b}, δ) such that Q = {q(i, m) | i ∈ {1,... , r},m ∈
{0,... , pi − 1}} ∪ {start}, S = {start}, R = {q(i, 0) | i ∈ {1,... , r}}, and for



q(1, 0)


q(1, 1)



q(2, 2)
q(2, 0)

R
q(3,

q(2, 1
, 2)
. . .


T	T	T
Fig. 5. Automaton Anfa2

i ∈ {1,... , r}, m ∈ {0,... , pi},
δ(q(i, m), a)= ,⎨ T if m = pi − 1,
, Q if otherwise,



δ(start, a)= R,

δ(q(i, m), b)= {q(i, (m + 1) mod pi)},	δ(start, b)= Q.
The proof of Case 2 is omitted.	 
Thus we proved that the values ω(Q, S, T ) and ωk(Q, S, T ) for k ≥ 2 are not poly- nomials in |Q| in most cases. It is an open question whether the values ω2(Q, S, T ) for large sets T are polynomials or not.

Acknowledgement
The author is grateful to his supervisor Dr. D. S. Ananichev and to Prof.
M. V. Volkov for their valuable help.

References
Cˇerny´, J. Pozn´amka k homog´ennym eksperimentom s konecny´mi automatami, Mat.-Fyz. Cˇas. Slovensk. Akad. Vied. 14 (1964) 208–216 [in Slovak].
Holladay, I.; Varga, R. On powers of non negative matrices, Proc. Amer. Math. Soc. 9 (1958) 631–634.
Ito, M. Algebraic Theory of Automata and Languages, World Scientific, Singapore, 2004.
Ito, M.; Shikishima-Tsuji, K. Some results on directable automata, in J. Karhum¨aki, H. Mauer, Gh. Pa˘un, and G. Rozenberg (eds.), Theory Is Forever. Essays Dedicated to Arto Salomaa on the Occasion of His 70th Birthday. [Lect. Notes Comp. Sci. 3113] Springer, Berlin, 2004, 125–133.
Mateescu, A.; Salomaa, A. Many-valued truth functions, Cˇerny´’s conjecture and road coloring, EATCS Bull. 68 (1999) 134–150.
Sandberg, S. Homing and synchronizing sequences, in M. Broy et al (eds.), Model-Based Testing of Reactive Systems [Lect. Notes Comp. Sci., 3472], Springer, Berlin, 2005, 5–33.
Wielandt, H. On eigenvalues of sums of normal matrices, Pacif. J. Math. 5(4) (1955) 633–638.
