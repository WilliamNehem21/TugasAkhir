
ORIGINAL ARTICLE
Data fitting by G1 rational cubic Be´zier curves using harmony search

Najihah Mohamed a,*, Ahmad Abd Majid b, Abd Rahni Mt Piah b

a Faculty of Industrial Sciences & Technology, Universiti Malaysia Pahang, Lebuhraya Tun Razak, 26300 Kuantan,
Pahang, Malaysia
b School of Mathematical Sciences, Universiti Sains Malaysia, 11800 USM, Pulau Pinang, Malaysia

Received 3 December 2014; revised 23 March 2015; accepted 14 May 2015
Available online 6 June 2015

Abstract A metaheuristic algorithm, called Harmony Search (HS) is implemented for data fitting by rational cubic Be´zier curves. HS is a derivative-free real parameter optimization algorithm, and draws an inspiration from the musical improvisation process of searching for a perfect state of har- mony. HS is suitable for multivariate non-linear optimization problem. It is mainly achieved by data fitting using rational cubic Be´zier curves with G1 continuity for every joint of segments of the whole data sets. This approach has significant contributions in making the technique auto- mated. HS is used to optimize positions of middle points and values of the shape parameters. Test outline images and comparative experimental analysis are presented to show effectiveness and robustness of the proposed method. Statistical testing between HS and two other different metaheuristic algorithms is used in the analysis on several outline images. All of the algorithms improvised a near optimal solution but the result that is obtained by the HS is better than the results of the other two algorithms.
© 2015 Production and hosting by Elsevier B.V. on behalf of Faculty of Computers and Information, Cairo University. This is an open access article under the CC BY-NC-ND license (http://creativecommons.
org/licenses/by-nc-nd/4.0/).



Introduction

Data fitting is a well-studied area in computer graphics and mathematics which is also a fundamental problem in many fields, such as computer graphics, image processing, shape

* Corresponding author.
Peer review under responsibility of Faculty of Computers and Information, Cairo University.
modelling and data mining. Depending on applications, differ- ent types of curves such as parametric curves, implicit curves and subdivision curves are used for fitting. Data fitting is nor- mally divided into two types, approximation and interpola- tion. Under an approximation-fitting scheme, a curve must pass reasonably close to the data points but is not required to pass through them [12].
Rational Be´zier curves are widely used in CAD/CAGD fields, because they have concise and geometrically meaningful presentation and can be deformed easily by moving the control points or modifying weights. Some studies on data fitting using rational Be´zier functions, to determine the best conic approxi- mation of a given curve which is based on Hausdorff distance


http://dx.doi.org/10.1016/j.eij.2015.05.001
1110-8665 © 2015 Production and hosting by Elsevier B.V. on behalf of Faculty of Computers and Information, Cairo University. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

176	N. Mohamed et al.


curves through the concept of C(u;v) – continuity [1] and as iter- function [7], approximate rational Be´zier curves by Be´zier ation method for approximation of rational Be´zier curves by
adjusting control points gradually using the scheme of weighted progressive iteration approximations through a global Lp – error [9]. Recently, a few researchers such as Huang et al. [6] whose derived offset by using cubic Be´zier for approximating degree n Be´zier with comparing three methods, Hausdorff dis- tance, shifting control and approximation based on L2 norm in order to find the better approximation. While Yang et al. [21] focused on curves on surfaces which present a parabola approximation method based on the cubic rational Be´zier sur- faces. This study also used Hausdorff distance between the approximate curve and the exact curve; the approximation is controlled under the user-specified tolerance. Shen et al. [17] proposed a certified approximation as an optimization method to select proper weights in the cubic rational Be´zier curve to approximate the given curve. The error of the approximation is controlled by the size of its tetrahedron, which converges to zero by subdividing the curve segments. Stamati and Fudos [20] presented a fast curve approximation method that approximates raw data with cubic rational Be´zier curves. The
This paper begins with an overview of rational cubic Be´zier, least-squares error and parameterization used based on cen- tripetal method together with some basic concepts on data fit- ting. A gentle overview on the HS is also given. The G1 continuity concept between two segments of our proposed data set is presented. Finally, method and its implementation, with some experimental results are presented. This method also had been compared with other two metaheuristic algo- rithms, which are genetic algorithm and particle swarm opti- mization on four different outline images. Statistical analysis also had been carried out in this paper to identify the reliability and effectiveness of this method.

Data fitting with rational cubic Be´zier

A rational cubic Be´zier function is defined as:

Let {(si; Qi ); i = 1; 2; ·· · ; n} be a given set of data point where s1 < s2 < ··· < sn. The piecewise rational cubic Be´zier function  is  defined  over  each  interval  I = [si; si+1]; i = 1; 2; ··· ; n — 1.
P(s)Ξ P(si)

approach combines least squares approximation with continu-
ity constraints to ensure G1 continuity between neighbouring
(1 — u)3C
=	0
+ 3u(1 — u)2w C
+ 3u2(1 — u)w2C2
+ u3C3

curves. This study imposed continuity constraints into the least squares optimization process to ensure that the computed con- trol points respect the estimated tangents at the end points.
Meanwhile, a few researchers had used metaheuristic method recently to curve fit outline images or a set of data points such as Sarfraz [18] that used simulated annealing to curve fit extracting outlines of images with a generalized cubic spline, the simulated annealing is used to optimize the shape parameter and another paper [19] also used simulated anneal- ing as the mechanism to globally optimizes the shape parame- ters in the description of the conic splines but in the case of
poor approximation, the insertions of intermediate points are
(1 — u)3 + 3u(1 — u)2w1 + 3u2(1 — u)w2 + u3
(1)
where u = s—si and hi = si+1 — si;	u ∈ [0; 1].

w1 and w2 are shape parameters and Ci; i = 0; 1; 2; 3 are control points with C0 and C1 are fixed.

Least-squares error and reparameterization

By using centripetal method, the length of the data polygon can be written as
n

made as long as the desired approximation is achieved. Yahya [16] proposed particle swarm optimization to optimize
L =	|pi — p
i=1
i—1
|1/2	(2)

the control points and weight which were then used in conic
equations. While, Ga´lvez and Iglesias [3] applied PSO to com-
Hence the parameters are
(	1  Xk	!	)

0
as free variables for B-splines functions.
In this paper, a metaheuristic approach namely, HS is


k	i
i=1
i—1	n

implemented as an approximation tool using rational cubic Be´zier curve from given data points. Our algorithm is based on the idea of minimizing least-squares error by Yahya [14] in order to improve positions of two middle control points,
C1; C2 and values of weights, w1andw2 as in Yahya et al. [15].
We use the adjustments adjust its shape and parametric struc- ture so as to construct curves that pass as closely as possible between the data sets smoothly. We also adjust and control points and values of weights until the error of the least squares is minimized. Therefore, the best approximation with mini- mum least-squares error can be obtained by this technique. The aim of this study was to prove that HS can be used as a method to fit a set of data points via rational cubic Be´zier and also as a best method based on its time consuming and guarantee to nearly reach the global optimal solution and locally optimal solution as it has a stoping criteria with the best solution it has found so far. In order to prove that statement, a statistical analysis had been done.
function   between   P(ui)   and   Q(si)   is For a specified set of control points, the least-squares error
n
E =  |P(ui)— Q(si)|2	(4)
i=1
We are looking the values of w1; w2; C1 and C2 for which E
is minimum.
Harmony search

Currently many phenomenon-mimicking meta-heuristic algo- rithms, such as genetic algorithm (GA), simulated annealing (SA), tabu search, ant colony optimization, and particle swarm optimization (PSO), have been used in various science and engineering problems. The advantages of these algorithms over calculus-based optimization algorithms include: not requiring complex gradient derivative and initial vector, ability to per- form global search as well as local search, and efficiently

Data fitting by G1 rational cubic Be´zier curves	177

handling discrete variables [5]. Harmony Search (HS) is a metaheuristic algorithm which was originally inspired by the improvisation process of Jazz musicians. The analogy between improvisation and optimization can be described as each musi- cian corresponds to each decision variable; musical instru- ment’s pitch range corresponds to decision variable’s value range; musical harmony at certain time corresponds to solu- tion vector at certain iteration; and audience’s aesthetics corre- sponds to objective function [8]. Just like musical harmony is improved time after time, solution vector is improved iteration by iteration. HS imposes fewer mathematical requirements and does not require initial value settings of decisions variables. As

(HMCR); pitch adjusting rate (PAR); and number of improvi- sation (NI), or stopping criterion. The harmony memory (HM) is a memory location where all the solution vectors (sets of decision variables) are stored. At this step, HM is similar to the genetic pool in the GA where all of the data had been stored [10].

Initialize the harmony memory

HM matrix is filled with as many randomly generated solution vectors as the HMS

the algorithm uses stochastic random searches, derivative information is also unnecessary. The steps in the procedure
1	1
1	2
6	1	2
···	u1	1
···	u2	N

of harmony search are shown in Fig. 1. The basic steps are
as follows [10]:


HM =	.
6


.	.	.
.	.	.

 

.	(6)
7





Min f(u) subject to ui ∈ U;	i = 1; 2; ... ; N	(5) Suppose the optimization problem is specified as follows: where f(u) is an objective function, decision variables ui, N is
the number of decision variable, U is the set of the possible
range of values for each decision variable, Lui 6 U 6 Uui where Lui and Uui are lower and upper bounds for each deci- sion variable, respectively. Parameters for HS are harmony memory size (HMS); harmony memory considering rate









Figure 2	Geometric view of G1 continuity.





































Figure 1	Procedure of harmony search algorithm.




178	N. Mohamed et al.













Figure 3	G1 continuity illustration between (a) 3 segments and (b) 2 segments.


(c)	(d)
Figure 4	(a) Outline of the image, (b) outline with break points,
(c) line connecting Ci’s in every segment, (d) outline image with correspondent rational Be´zier curve.


Improvise a new harmony

A new harmony vector, u' = (u' ; u' ; ··· ; u' ) is generated based on three rules: memory consideration, pitch adjustment and
random selection. Generating a new harmony is called ‘impro- visation’. In the memory consideration, the value of the first
(c)	(d)
Figure 5 (a) Bitmapped image, (b) outline of the image, (c) outline with break points, (d) outline image with correspondent rational Be´zier curve.

decision variable, u' for the new vector is chosen from any
1

of the values in the specified HM range (u'1; u'2; ··· ; u'HMS),
G
continuity between two segments

1	1	1
similar process to the other decision variables (u' ; u' ; ··· ; u' ).
2  3	N

The detailed process of this steps is illustrated in Fig. 1.

Update harmony memory
If the new harmony vector, u' = (u' ; u' ; ··· ; u' ) is better than
Suppose	two	regular	curves	B(s); s ∈ [s0; s1],	and C(t); t ∈ [t0; t1], meet at a point P = B(s1)= C(t0). Then the Marsh [11] gave a definition of geometric continuity by:
two curves said to meet with Gk – continuity whenever there
is  a  Reparameterization  b : [u0; u1]→ [s0; s1]  such  that

1  2	N

the worst harmony in the HM, judged in terms of the objective function value, the new harmony is included in the HM and the existing worst harmony is excluded from the HM.
s1 = b(u1) and
diB
dui (b(u))|u=u1

diC
dti (t)|t=t0	(7)

Check

If the stopping criterion is satisfied, computation is terminated. Otherwise, steps 3 and 4 are repeated.
for all i = 0; ··· ; k. This type of continuity is called geometric
continuity.
In a geometric view, for a regular curve P(u), G1 at u if it is
G0 continuous and it possesses continuous unit tangent vector,

Data fitting by G1 rational cubic Be´zier curves	179










Figure 6	(a) Outline of the image, (b) outline with break points, (c) outline image with correspondent rational Be´zier curve.


P'(u—) and P'(u+) point to the same direction with different values of magnitude as in Fig. 2.
Be´zier points C2; C3 and C' must be collinear but the ratio
of C2C3  and C' C'  are not fixed, where b is utilized to
0  1
break the chain.

Method and implementation
















Figure 7 (a) Bitmapped image, (b) outline of the image, (c) outline with break points, (d) outline image with correspondent rational Be´zier curve.
bP'(u—)= P'(u+)	(8)
where b =  P'(u+) > 0
In order to implement HS, Eq. (4) is used as the objective function. HS parameters in this work are HM = 5, HMCR = 0.9, PAR = 0.3 and bw = 0.03. All these values of parameters are the usual choice in HS community and also supported based on empirical results by [13]. According to results by Omran and Mahdavi [13], in general, using a small HM seems to be a good and logical choice with the added advantage of reducing space requirements. Actually, since HM resembles the short-term memory of a musician which is known to be small, it is logical to use a small HM as in the paper used the smallest value of HM is 5. As for HMCR, a large value for HMCR (e.g. 0.95) generally improves the performance of the HS. The experiments show that using a relatively small constant value for PAR seems to improve the performance of the HS.
As the beginning, all the data extracted from the outline boundary of the images had been broke into a few curve seg- ments. The completion of the procedures to fit all the data con- sists of 3 sections: original segments, segment between two segments and end segment.



Original segments

In this section, only the odd segments (1,3,.. .) will be considered and all the data in the segment will be approxi- mated without any constraints. The size of w1 and w2 is in
[0; 2]. The search space for C1 and C2 are estimated as
follows:
Let a segment consists a set of points (d1; d2; ·· · ; dend)∈ R2
while C* and C* are extremum points in the segments. The size
1	2
of each C* and C* is determined by:
1	2
size of C* = |dmax — dmin|;	i = 1; 2	(9)




Figure 8 Data fitting for outline for alphabet ‘S’ with 2593 data points. The highlight segment consists of 113 data points, HS error = 0.0008, GA error = 0.0025 and PSO error = 0.0803.
Segment between two segments

For this section, the even segments (2,4,.. .) will be considered and all the data in the segment will be approximated with cer- tain constraints, which are as follows:
Suppose a set of data has three segments, seg1; seg2 and seg3
as in Fig. 3(a), each segment of rational cubic Be´zier curve



(c) Letter ‘e’ (2783 data points)	(d) Letter ‘s’ (2593 data points)

Figure 9	Minimum least-squares error for each segment of test outline images.














Suppose a set of data has two last segments, segend—1 ; segend
as in Fig. 3(b). All these two segments should have smooth
joints with G1 continuity. Therefore, data fitting in seg must fulfil certain constraints involving segend—1 .
The size of w1 and w2 is in [0; 2.5]. While search space for C1
able, Ci = (xi; yi) depends on the other one at the last joint, i.e.,  [(C2; segend—1); (C3; segend—1 = C0; segend); (C1; segend)] and C2 are similar to the previous section but one of the vari-
must be collinear.
Demonstration and experimental results

Proposed data fitting method has been implemented practi- cally in Figs. 4–7(a). Each data segments are evaluated at uni-
collection of 201 data points on the interval of [0; 1]. formly distributed values of u in its domain to generate a
Figs. 4(d), 5(d), 6(c) and 7(d) are the best fitting curves,
where OG is the original graph and, RB is the corresponding rational Be´zier curve. Fig. 4(c) shows lines which connects




Table 6  T-test of two samples assuming unequal variances.
t-test: two-sample assuming unequal variances  t-test: two-sample assuming unequal
variances

t-test: two-sample assuming unequal variances




t-test: two-sample assuming unequal variances  t-test: two-sample assuming unequal
variances
t-test: two-sample assuming unequal variances




t-test: two-sample assuming unequal variances  t-test: two-sample assuming unequal
variances
t-test: two-sample assuming unequal variances




t-test: two-sample assuming unequal variances  t-test: two-sample assuming unequal
variances
t-test: two-sample assuming unequal variances


(continued on next page)



Table 6  (continued)
t-test: two-sample assuming unequal variances  t-test: two-sample assuming unequal
variances


t-test: two-sample assuming unequal variances





all the Ci‘s in every segment which applies G1 continuity between two segments.
Table 1 summarizes the G1 continuity analysis for above test outline images. Values of b for each test function are cal- culated based on Eq. (8).

Comparison with other methods and analysis

Our G1 HS approach performs well for the above test outline images. To support this claim, a comparison with recent alter- native curve fitting based on soft computing techniques has been carried out. There were a few of soft computing method used in this data fitting problem, such as curve fitting by B- splines using GA by Ga´lvez et al. [4], Sarfraz [19] used cubic spline by SA and Yahya [15–16] proposed an approach of curve fitting by PSO. Here a comparison between HS, GA and PSO that used on the similar data points. The procedure of PSO was taken from [2]. Fig. 8 highlights on a segment of letter ‘s’ and shows that HS approach better the data points within the same time range as others. Fig. 9 summarizes the least-squares errors of each segment for test outline images and in the graphs; the output for HS in segments 4 and 10 for the first image, segment 3 in third image and also segment 15 in fourth image are larger than others as there are cusps before the segments. However, HS approach each outlines bet- ter by looking at the total of least-squares error in the data sets.

Statistical analysis

All evolutionary algorithms, including HS, GA and PSO are stochastic population based search methods. Accordingly, there is no guarantee that the optimal solution will be reached consistently. Therefore, in order to deny that there is a guaran- tee that HS can be used to have better approximation to the global optimal solution, a comparison on optimization prob- lem using such algorithm where a statistical analysis had been carried out. 30 sample data of total least-squares error of four outlines for methods HS, GA and PSO were being used with the time taken for all the data which were fixed.
From Table 2, it is clearly shows the prominent method for all images based on descriptive data is HS. All the sample data had been assessed their normality by the Shapiro-Wilks statis- tics in order to verify their significance different between their variance. The results of normality were shown in Table 3.
According to Table 4, there is sufficient evidence that the HS has the smallest variation compared to GA and PSO at
1–10% significance level (p-value: 0.0722, 2.7164 · 10—16;
1.4988 · 10—14, 8.7131 · 10—8; 0.0006, 6.2017 · 10—12; 0.0006,
0.0000). While Table 5 shows that the mean of HS is the small-
(p-value: 8.0837 · 10—7, 4.5621 · 10—14; 9.1411 · 10—14, est value compared to GA and PSO at 1–10% significance level
3.6084 · 10—31;  0.0934,  5.7907 · 10—18;  1.3302 · 10—18,
4.9253 · 10—19). While, Table 6 also supported the same con- clusion of HS compared to other two methods. These leads
to say that, in this study, HS was found to give the best fit for data fitting using rational cubic Bezier for each segment of all tested outlines images. These results give strong indica- tion that the HS method is more stable and accurate compared to GA and PSO.

Conclusions

A derivative-free real parameter optimization technique, based on HS, is implemented for data fitting. This technique opti- mizes the control points and shape parameters of rational cubic Be´zier curves in order to approximate the data sets. The technique data fitting by G1 continuity for every joint of segments for the whole data set, the rational Be´zier ultimately produces optimal results in approximating the data. It pro- vides an optimal fit with an efficient computation cost. A com- parison between HS, GA and PSO were done on four different outline images and a few of statistical testing also had been carried out over a 30 sample data set each. Based on the statis- tical analysis carried out on the sample data, there are suffi- cient evidences to say that HS gave a smaller values of error compared to other two methods.

References

Cai HJ, Wang GJ. Constrained approximation of rational Be´zier curves based on a matrix expression of its end points continuity condition. Comput Aided Des 2010;42(6):495–504.
Das S, Abraham A, Konar A. Particle swarm optimization and differential evolution algorithms: technical analysis, applications and hybridization perspectives. Stud Comput Intel (SCI) 2008;116:1–38.
Ga´lvez A, Iglesias A. Efficient particle swarm optimization approach for data fitting with free knot –splines. Comput Aided Des 2011;43(12):1683–92.



Ga´lvez A, Iglesias A, Puig-Pey J. Iterative two-step genetic- algorithm-based method for efficient polynomial B-spline surface reconstruction. Inf Sci 2012;182:56–76.
Geem ZW, Sim K-B. Parameter-setting-free harmony search algorithm. Appl Math Comput 2010;217:3881–9.
Huang W-X, Jin C-J, Wang G-J. Approximate Be´zier curves by cubic LN curves. Appl Math Comput 2011;218:3083–92.
Hur S, Kim T. Finding the best conic approximation to the convolution curve of two compatible conics based on Hausdorff distance. Comput Aided Des 2009;41(7):513–24.
Lee KS, Geem ZW. A new meta-heuristic algorithm for contin- uous engineering optimization: harmony search theory and practice. Comput Methods Appl Mech Eng 2005;194:3902–33.
Lu L. Sample-based polynomial approximation of rational Be´zier curves. J Comput Appl Math 2011;235(6):1557–63.
Mahdavi M, Fesanghary M, Damangir E. An improved harmony search algorithm for solving optimization problems. Appl Math Comput 2007;188(2):1567–79.
Marsh D. Applied geometry for computer graphics and CAD. 2nd ed. London: Springer-Verlag; 2005.
Mortenson ME. Geometric modeling. Canada: John Wiley & Sons; 1997.
Omran MGH, Mahdavi M. Global-best harmony search. Appl Math Comput 2008;198:643–56.
Yahya F, Ali JM, Majid AA, Ibrahim A. An automatic generation of G1 curve fitting of arabic characters. In: International conference on computer graphics imaging and visualisation CGIV06; 2006. p. 1–6.
Yahya ZR, M Piah AR, Majid AA. G1 continuity conics for curve fitting using particle swarm optimization. In: 2011 15th international conference on information visualisation; 2011. p. 497–501.
Yahya ZR, Piah ARM, Majid AA. Curve fitting conic by evolutionary computing. J Math Stat 2012;8(1):107–10.
Shen L-Y, Yuan C-M, Gao X-S. Certified approximate of parametric space curves with cubic B-spline curves. Comput Aided Des 2012;29:643–63.
Sarfraz M. Vectorizing outlines of generics shapes by cubic spline using simulated annealing. Int J Comp Math 2010;87(8):1736–51.
Sarfraz M. Intelligent approaches for vectorizing image outlines. J Software Eng Appl 2012;5:78–83.
Stamati V, Fudos I. On reconstructing 3D feature boundaries. Comput-Aid Des Appl 2008;5(1–4):316–24.
Yang Y-J, Zeng W, Yang C-L, Meng X-X, Yong J-H, Deng B. G1 continuous approximate curves on NURBS surfaces. Comput Aided Des 2012;44:824–34.
