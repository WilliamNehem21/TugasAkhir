Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 354 (2020) 75–89
www.elsevier.com/locate/entcs

Building a Maximal Independent Set for the Vertex-coloring Problem on Planar Graphs
Cristina Lopez-Ram´ırez a,1,2,
Jorge Eduardo Guti´errez G´omez a,1,3 and Guillermo De Ita Luna a,1,4
a Benem´erita Universidad Aut´onoma de Puebla
14 Sur Esq. Sn. Claudio, C.U. - Edif. CCO1, Puebla, Pue., M´exico

Abstract
We analyze the vertex-coloring problem restricted to planar graphs and propose to consider classic wheels and polyhedral wheels as basic patterns for the planar graphs. We analyze the colorability of the composition among wheels and introduce a novel algorithm based on three rules for the vertex-coloring problem. These rules are: 1) Selecting vertices in the frontier. 2) Processing subsumed wheels. 3) Processing centers of the
remaining wheels. Our method forms a maximal independent set S1 ⊂ V (G) consisting of wheel’s centers, and a maximum number of vertices in the frontier of the planar graph. Thus, we show that if the resulting graph G′ = (G − S1) is 3-colorable, then this implies the existence of a valid 4-coloring for G.
Keywords: Planar Graphs, Vertex Coloring, Wheel Graphs, Polyhedral Wheel Graphs, Maximal Independent Set.


Introduction
By a proper coloring (or just a coloring) of a graph G, we refer to an assignment of colors (elements of a set) to the vertices of G, one color to each vertex, such that adjacent vertices are colored differently. The smallest number of colors in any coloring of G is called the chromatic number of G and is denoted by χ(G).When it is possible to color G from a set of k colors, then G is said to be k-colorable, while this coloring is called a k-coloring. If χ(G)= k, then G is said to be k-chromatic, and every k-coloring is a minimum coloring of G.

1 Thank you to SNI-CONACYT for the economic support for this work.
2 Email:cristyna2001@hotmail.com
3 Email:user name ed@hotmail.com
4 Email:deita@cs.buap.mx

https://doi.org/10.1016/j.entcs.2020.10.007
1571-0661/© 2020 The Author(s). Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

The computation of the chromatic number χ(G) is polynomial computable if G is k-colorable with k ≤ 2; otherwise, the problem becomes NP-complete [6]. As a consequence, there are many unanswered questions related to the coloring of a graph.
Graph vertex coloring problem is an active field of research with many interesting subproblems and applications in areas like frequency allocation, planning, computer vision, scheduling, image processing, etc [4,9]. In this context, planar graphs play an important role in the graph theory area and complexity theory, since it involves the frontier between efficient and intractable computational procedures. In fact, planar graphs have several interesting properties, since they are 4-colorable, scattered, and their inner structure is described elegantly and succinctly [3].
In the case of the vertex-coloring problem, the 2-colorability is solvable in poly- nomial time. The 3-colorability has also been solved in polynomial time for some graph topologies such as AT-free graphs and perfect graphs. In addition, the de- termination of χ(G) for some classes of graphs, such as comparability graphs [12], chordal graphs, and interval graphs, have been efficiently solved. In all those cases, special structures (patterns) have been found to characterize the classes of graphs that are colorable in polynomial time complexity.
In this article, we introduce what we believe are the basic graph patterns that form any planar graph and that we have called polyhedral wheels. We consider com- positions among polyhedral wheels and analyze its chromatic number. We propose a novel method to recognize the colorability for classic and polyhedral wheels.

Preliminaries
Let G = (V, E) be an undirected simple graph (i.e. finite, loop-less and without multiple edges) with vertex set V (or V (G)) and set of edges E(orE(G)). We assume the reader is familiar with standard terminology and notation concerning graph theory and planar graphs in particular, see e.g. [10] for standard concepts in graph theory. We present here only some notations that we will use.
If there is an edge {v, w} ∈ E joining two different vertices, then we say that v and w are adjacent. The Neighborhood of x ∈ V is N (x)= {y ∈ V : {x, y} ∈ E}, and its closed neighborhood, denoted by N [x], is N (x) ∪ {x}. The cardinality of a set A is denoted by |A|. The degree of a vertex x ∈ V is |N (x)|, and it will be denoted by δ(x). A graph in which every pair of distinct vertices is adjacent is called a complete graph. The complete graph on n vertices is denoted as Kn.
We say that GJ = (V J, EJ) is a subgraph of G = (V, E) if V J ⊂ V and EJ ⊂ E. If V J = V , then GJ is called a spanning subgraph of G. If GJ contains all the edges of G that join two vertices in V J, then GJ is said to be induced by V J. In this way, G − V J is the induced subgraph from V − V J. Similarly, if EJ ⊂ E, then G − EJ = (V, E − EJ). If V J = {v} and e = {u, v}, then this notation is simplified as G − v and G − e, respectively.
Given a graph G = (V, E), S ⊆ V is an independent set in G if for any two vertices v1, v2 in S, {v1, v2} ∈/ E. Let I(G) be the set of all independent sets of G.

An independent set S ∈ I(G) is maximal, abbreviated as MIS, if it is not a subset of any larger independent set. In addition, it is maximum if it has the largest size among all independent sets in I(G).


Planar Graphs
A drawingΓ ofa graph G maps each vertex v to a distinct point Γ(v) of the plane and each edge {u, v} to a simple open Jordan curve Γ(u, v), with endpoints Γ(u) and Γ(v). A drawing is planar if it can be embedded (or it has an embedding) in the space in a way that no two edges intersect except at a common endvertex. A graph G is planar if G admits an embedding in the plane. A planar drawing partitions the plane into connected regions called faces. The unbounded face is usually called outerface or external face.
In general, a planar graph has many embeddings in the plane. Two embeddings of a planar graph are equivalent, when the boundary of a face in one embedding always corresponds to the boundary of another face. A planar embedding is an equivalent class of planar drawings and is described by the clockwise circular order of the edges incident to each vertex. A maximal planar graph is one to which no edge can be added without losing planarity. Thus, in any embedding of a maximal planar graph G with n ≥ 3, the boundary of every face of G is a triangle.
One of the most outstanding results is Kuratowski’s theorem [7]. The theorem gives a criterion in order to recognize a graph as a planar graph. Kuratowski shows that if a graph contains no subgraph that is a subdivision of K5 or K3,3, where K5 is the complete graph of order 5 and K3,3 is the complete bipartite graph with 3 vertices in each of the sets of the partition, then the graph is planar. Similarly, the theorem of Wagner [13] states that a graph G is planar if and only if it does not have K5 or K3,3 as minor. However, both characterizations are different, since a graph may admit K5 as minor without having a subgraph that is a subdivision of K5.
The famous Four-Color Theorem (4CT) says that every planar graph is vertex 4-colorable. Robertson et al. [11] describes an O(n2) 4-coloring algorithm. This seems to be very hard to improve, since it would probably require a new proof of the 4CT. On the other hand, to decide if a planar graph requires only three colors is a NP-hard problem [6]. However, the Grotzsch’s theorem [5] guarantees that every triangle-free planar graph is 3-colorable. Thus, the hard part in the coloring of planar graphs is to decide if an unrestricted planar graph is 3 or 4-colorable.
Not all graphs are planar. However, planar graphs arise quite naturally in real- world applications, such as road or railway maps, electric printed circuits, chemical molecules, etc. Planar graphs play an important role in these problems, partly due to the fact that some practical problems can be efficiently solved for planar graphs even if they are intractable for general graphs [10]. In recent years, planar graphs have attracted computer scientists’ interest, and a lot of interesting algorithms and complexity results have been obtained from planar graphs.

The internal-face graph of a planar graph
In this section, we introduce concepts that we have developed to be used in our algorithmic proposal. A planar graph G has a set of closed non-intersected regions F (G)= {f1,..., fk} called faces. Each face fi ∈ F (G) is represented by the set of edges that bound its inside area. All edge {u, v} in G, that is not the border of any face from G, is called an acyclic edge.
Two faces fi, fj ∈ F (G) are adjacent if they have at least one common edge, this is, (E(fi) ∩E(fj)) /= ∅. Otherwise, they are independent faces. Notice that two independent faces can have common vertices, but they do not have common edges. A set of faces is independent if each pair of them is independent.
An acyclic edge is adjacent to a face if they have just one common vertex. Two acyclic edges are adjacent if they share a common endpoint. We build an internal- face graph Gf = (X, E(Gf )) from G, in the following way:
Each face fi has attached a vertex x ∈ X.
Each acyclic edge from G has attached a vertex of Gf , labeled with the same label of its vertices.
There is an edge {u, v}∈ E(Gf ) joining two adjacent vertices of Gf , when its corresponding faces (or acyclic edges) are adjacent in G.
Gf is the internal-face graph of a planar graph G. We must emphasize that Gf is not the dual graph of G, since in the construction of Gf the external face of G is not considered. Notice that Gf is also a planar graph with vertices representing faces or edges from G (as we can see in Figure 1b). The internal-face graph Gf of G provides a mapping of the relation among the faces of G, which is useful for the search of the 3-coloring pattern graphs.
For any planar graph G = (V, E), we denote as Ext(G) the set of vertices of G that are incident to the outerface. Meanwhile, the internal vertices of G, denoted by Int(G), are vertices that are not incident to the outerface. This is, Int(G)= V (G) − Ext(G).

Graph G with identified faces	(b) The internal-face graph of the graph in Fig. (1a)
Fig. 1. A planar graph and its internal-face graph

Classical and Polyhedral wheels
A basic pattern in planar graphs is a classic wheel rx ⊂ rG, where rG denotes the set of all wheels in G. A single wheel rx is formed by a vertex Crx . Crx is called the center vertex of the wheel. Crx is adjacent to all the vertices forming a cycle surrounding it. Each face (called an axle of the wheel) is a triangle. There are two classes of vertices in a wheel: the center vertex and the vertices forming the cycle. Note that a wheel of a planar graph G is represented as a cycle in its internal-face Gf . An even wheel (odd wheel) has an even (odd) number of faces. All wheels that have a number of even triangles are 3-colorable. Meanwhile, any planar graph containing K4 or odd wheels will request four colors in order to properly color those graphs. However, these topologies are not the only 4-colorable cases.
For example, in Figure 1a, a simple wheel is formed by the edges b−c−e−f −d, and whose center vertex is j. All the axles of this wheel are triangular. Meanwhile, in Figure 1b the internal face graph Gf from the graph in Figure 1a is shown.
We extend the class of wheels by considering any polygon as an axle face of the wheel. Such type of wheel is called a polyhedral wheel. This means that there are some vertices in the cycle of rx surrounding the center vertex Crx , and which are not adjacent to the center. The center vertex is a common incident vertex to all the axle face of the polyhedral wheel.A polyhedral wheel of a planar graph G is represented as a cycle in its internal-face graph Gf .
We differentiate the cycle’s vertices in a polyhedral wheel as axle vertices if they are adjacent to the center vertex. Otherwise, they are considered as extra-axles. In the case of the edges in a polyhedral wheel, we have the edges of the cycle and the edges incident to the center, called spoke edges.
Coloring planar graphs
It is easy (in linear-time on the size of the graph) to recognize if an input graph is 2-colorable, since it involves the recognition of only even cycles in the graph. Similarly, it is known by Grotszch’s theorem [5] that any planar graph triangle- free is 3-colorable. However, the recognition of the 3-coloring of a planar graph is a classic NP-Complete problem [6]. It becomes difficult to recognize between the three or four coloring of a planar graph when it contains triangles, because there is not (at least until now), a sufficient condition to recognize the 3-colorability of a planar graph.
Let Three = {1, 2, 3} be the set that contains three different colors. We denote the function Color(v) that assigns a unique color from Three to the vertex v. Let v be a vertex of G that has a color c ∈ {1, 2, 3, 4} and let Tabu(v) ⊂ {1, 2, 3, 4} be the prohibited colors associated to v. In fact, Tabu(v) contains the colors associated to the vertices in N (v). We say that x is a free vertex when Tabu(x) = ∅. A set A is marked when ∀x ∈ A; Tabu(x) = {1}, and in this case, we say that each vertex x ∈ A is not free.
In this section, we start introducing simple algorithms and results obtained from us in order to analyze between the 3 or 4-colorability of the basic graphic patterns

formed by the wheels of the graph. We start considering an algorithm for coloring simple wheels.
We introduce a typical coloring for a wheel, where its center vertex is assigned the first color. The colors 2, 3 are assigned alternately through to the cycle’s vertices. This coloring begins in any triangular face of the wheel, and follows a counter clockwise direction from the cycle’s vertices. Only when the last vertex of the cycle is visited, it is determined if a fourth color is needed.
Lemma 4.1 The union of even simple wheels, where its center vertices are inde- pendent, is 3-colorable.
Proof. When all center vertices of the wheels form an independent set on the graph then the first color can be assigned to those vertices. Common edges between wheels are only given by the cycle’s edges of the wheels. If the center vertices are removed of the graph, since they were already colored, the remaining subgraph is bipartite because it has only the cycle’s edges. As only even cycles remain in the subgraph, then the subgraph is 2-colorable. We obtain a 3-coloring for this kind of planar graphs by using different colors between the center vertices and the cycle’s vertices.	2
We will consider an acyclic graph as a tree. In the case of trees, we call node to each vertex of the tree. It is known that an acyclic graph is 2-colorable. However, considering that any vertex of an acyclic graph has restricted any color from any of the 3 colors of Three, the acyclic graph is 3-colorable.
Lemma 4.2 An acyclic component is 3-colorable if all of its vertices have at the most one color from the 3 possible colors as a restriction.
Proof. The acyclic component is considered as a tree rooted in vr ⊂ V (rx). A pre-order coloring is made from vr, where Color(vr) = MIN{Three − Tabu(vr)}. If we advance in pre-order for each new level to be colored, all node y in the new level will have at the most two restricted colors from its parent node and a color that could exist in Tabu(y). Thus, a color has always been available of the three possible from Three. When all node of the tree had been visited in pre-order, our proposal has already colored all node.	2
When Gf is a tree, we say that G (its corresponding planar graph) is a polygonal tree [8]. This means that, although G has cycles, all those cycles can be arranged as a tree whose nodes are polygons instead of single vertices of G. The following theorem shows that to determine an order for visiting all faces from the planar graph is enough to obtain an efficient procedure for the 3-coloring of a polygonal tree.
Theorem 4.3 If the internal-face graph of a planar graph G has a tree topology, then G is 3-colorable.
Proof. Let Gf be the internal-face graph of a planar graph G. Since any face of
G is a simple cycle, then it is 3-colorable. All acyclic edge of G is also 3-colorable,

because all acyclic graphs are 2-colorable. A 3-coloring procedure for G can be done by traversing the nodes of Gf in pre-order. The face of the father node of Gf is colored first and after, the faces of its children nodes. In each current level, the two adjacent faces (father and children in G) are considered. Both regions have two common extremal vertices x, y in its common boundaries.
Those common vertices are colored first, and then, the remaining vertices in both faces have two prohibited colors at most. Notice that there is not a pair of adjacent vertices u and v in any of the two faces, such that {u, v}⊆ (N (x) ∩ N (y)). This happens because {x, y, u, v} form K4 and this subgraph cannot be part of any polygonal tree. Thus, for all the remaining vertices in both faces, it is available at least one color of the three possible in Three. The 3-coloring process ends when all the nodes of the tree Gf have been visited in pre-order.	2
If a planar graph G has not a polygonal tree topology, this means that there are cycles in Gf and, therefore, wheels in G. For this kind of planar graphs, it is possible to recognize 3-colorable graphic patterns.
Lemma 4.4 All the polyhedral wheels are 3-colorable.
Proof. If rx is a polyhedral wheel, then there is an axle face that is not triangular. Therefore, there is at least one vertex ve in V (rx) that is not adjacent to the center vertex vx of the whee; otherwise, all axle face would be triangular. The graph R−ve = (rx − ve) is a polygonal tree; therefore, it is 3-colorable by Lemma 4.2 and Theorem 4.3. Any typical 3-coloring for R−ve can be extended to a 3-coloring for rx if ve has the same color as vx, because in a typical coloring the color of the center vertex is not used in the cycle’s vertices. Therefore, the center’s color has not been used for the vertices in N (ve).	2
Several works have focused on recognizing 3-coloring patterns based on the length of the cycles. For example, Borodin et. al [1,2] have shown the 3-colorability of planar graphs without triangles at distance less than 4 and without 5-cycles. Similarly, for graphs without cycles of length from 4 to 7. On the other hand, we perform a different analysis for recognizing between the 3 or 4-colorable topologies in planar graphs. Mainly, we focus on the recognition of the topologies formed by the union of polyhedral wheels in order to design a coloring algorithm.
The union of 3-colorable polyhedral wheels is not necessarily 3-colorable. For example, in Figure 2a, if we consider each common face as one of the faces of the polyhedral wheel that contain it, then we are considering each polyhedral wheel as independent to the others, and in this case, each wheel is 3-colorable by Lemma
4.4. However, the final graph (union of the wheels) must request four colors, as we illustrate using the variables x, y, z to indicate the 3 different colors to be used. Notice that the vertex with label ’ ?’ can not be colored with the colors represented by x, y, z, and therefore, the graph request a fourth color.















Union of polyhedral wheels that is not 3-colorable


Building a Disc with {e1, e2, e3}

Fig. 2. A planar graph G, and a disc of 3 vertices that encloses to G

Coloring algorithm
Let G be an embedding of an input planar graph and let Gf be its corresponding internal-face graph. Let rx be a polyhedral wheel with vertex center Crx . Let Exc(rx) = Cycle(rx) ∩ Ext(G) be the set of the cycle’s vertices of rx incident to the outerface of G, and let Inc(rx)= N (Crx ) ∩ Int(G) be the neighbors of Crx that are not incident to the outerface of G.
Since the polyhedral wheels are the basic patterns to be recognized and processed by our coloring algorithm, special structures are used to represent and codify the properties of the wheels of a graph G. For example, for any wheel rx ∈ G; Crx , Cycle(rx), Exc(rx),Inc(rx) are computed and updated each time so that the input graph G is updated. Thus, special computational structures must be used to update, in an efficient way, the associated structures of each wheel in G.

Definition 5.1 Given two polyhedral wheels rx and ry with vertices center Crx and Cry , respectively, if Cycle(ry) ⊆ V (rx) holds, then we say that ry is subsumed by rx.
When a wheel ry is subsumed by a wheel rx, and as rx /= ry, then there is a vertex u ∈ Cycle(rx) such that u ∈/ V (ry). If a color is assigned to Crx , such as Color(Crx ) = 1, then the wheel rx is reduced to a single face fx, which will become a face of the wheel ry. Let us denote as rx,y the new wheel formed by the fusion of rx on the face fx, which is now, also part of the wheel ry. The face fx is not triangular in rx,y, since at least the vertex u ∈ V (fx) is not adjacent with Cry . Therefore, the polyhedral wheel rx,y is 3-colorable by Lemma 4.4.
Note that on a fused wheel rx,y, the pair of vertices {Cry , u} can have the same color, for example Color(Cry ) = Color(u) = 2, and the resulting subgraph (rx,y−{Cry , u}) is now an acyclic component with one restricted color, and therefore, 3-colorable by Lemma 4.2.
We will say that a vertex x is definitely removed from the current graph G, when x has been assigned a color by making G = (G − {x}). The final removal of

x adjusts the parameters of the graph δ(y)= δ(y) − 1, ∀y ∈ N (x), Ext(G), Int(G), as well as the parameters associated to the wheels of the graph.
The stop conditions of our algorithm will be checked after of each step. The stop conditions are the following.
If the resulting graph GJ is a polygonal tree, then a 3-coloring is built on GJ
based on theorem 4.3.
If the resulting graph GJ does not contain triangular faces, then GJ is 3-colorable based on Gr¨otszch’s theorem.
If GJ is acyclic, then a 3-coloring is built for GJ (based on the lemma 4.2). Now, we present our general coloring algorithm.
Algorithm 1.
Step 1: Selecting external vertices for assigning color 1.
Given a graph G, identify a free vertex e ∈ Ext(G) that can be part of a maximal number of faces in Gf . Then, assign Color(e)=1 and ∀y ∈ N (e); Tabu(y)= {1}. Afterward, the vertex e is removed from G, updating G and Ext(G). The selection and elimination of external vertices is an iterative process until there is not more free vertices in Ext(G).
We check if the resulting graph matches at least one of the stopping conditions. Otherwise, we continue to the next step.
Step 2: Processing subsumed wheels and polyhedral wheels.
Processing all subsumed wheels:
Given a pair of wheels rx, ry, if (Cycle(ry) ⊂ V (rx)), then Color(Crx )= 1. In this step, we process all subsumed wheel on the current graph.
A center’s list Sc = {Cr1 ,..., Crk } is formed with the center vertices of all wheel in G. Sc is sorted considering first the centers of classic wheels and afterward, the centers of polyhedral wheels. Inside of each partition, first are considered the odd wheels, and afterward, the centers of even wheels. Among each partition, the sorting follows the rule: min{|N (Crx ) ∩Sc|}, and for similar values, the rule max{|Exc(rx)|} is applied. Afterward, an iterative process is applied by first selecting a free vertex Cri ∈ Sc in order to assign Color(Cri )= 1, Sc = Sc − {Cri }, and then, marking N (Cri ).
End of algorithm
In the case ofa wheel ry subsumed by another rx, the step (2a) guarantees that the center of rx is being assigned the color 1 instead of the center of ry. In addition, Step 2 guarantees that in the resulting graph, there are not any classic wheels and the vertices with color 1 form a maximal independent set S1 ⊂ V (G).
Example 5.2 In the following example, we show the relevance of the order of the steps of our proposal. For this, let us consider the graph shown in Figure 3a. The first step of the algorithm processes the external vertices. In this case, g is selected

to be assigned color 1, c(g) = 1, because g is incident to the greatest number of faces that are on the set of external vertices. The resulting graph GJ = G − {g} is shown in Figure 3b. Notice that each vertex u ∈ Ext(G) has Tabu(u)= {1}.
The cycles are recognized for GJ: Cycle(x)= {a, b, d, c}, Cycle(d)= {x, b, c}. There are two classic wheels in GJ, whose centers are x and d. Those wheels hold: rd ⊂ rx, and rd /⊂ rx. When we apply the subsumed wheel rule - step (2a), we are forced to process the wheel with center x as shown in Figure 3c. However, if the step (2b) were applied assigning color 1 to the center d, instead of the step (2a), then the resulting graph is shown in Figure 3d.
Notice that in the resulting graph from Figure 3d, the vertices: a, x, b and c form the well-known graph K4, that is known to be 4-colorable. As the color 1 was to be used after the first step, this color cannot be used for coloring K4, then the graph in figure 3d becomes 5-colorable. However, considering the real order of the steps in our algorithm, the resulting graph in Figure 3c is 3-colorable, and therefore, the input graph is 4-colorable.



The input graph G
Graph G without vertex g



	
Graph G without {g, x}	(d) Graph G without {g, x, d}
Fig. 3. Building a 4-coloring for the input graph in (3a)


The step 1 of our algorithm is supported by the following lemma.

Lemma 5.3 Every planar graph G has a 4-coloring such that the ﬁrst color is not assigned to the vertices of Ext(G).
Proof. Let G be a planar graph. G can be enclosed by a disc D formed by 3 vertices {e1, e2, e3} joined by the edges: {{e1, e2}, {e1, e3}, {e2, e3}}. D is drawn in the following way. First, the vertex e1 is drawn in the outerface of G, and the edges: {e, e1}, ∀e ∈ Ext(G) are drawn. Thus, only one edge {u, v} incident to the outerface of G will remain as incident to the outerface of (G ∪ {e1}). Afterward, we draw e2 and e3 in the outerface of (G ∪ {e1}) and in front of {u, v}, so we can add the new edges {e2, u} and {e3, v} that do not cross with any other edge in (G∪{e1}) nor the original edges of G. Finally, we add the edges {{e1, e2}, {e1, e3}, {e2, e3}} in order to form the disc D.
Notice that in this way, a new planar graph GJ has been built, where Ext(GJ)= 
{e1, e2, e3}. Thus, a 4-coloring for GJ exists due to the 4CT theorem. Whenever we choose a color without loosing its generality, e.g., the color 1 is assigned to e1 (Color(e1) = 1), then the vertices {e2, e3} ∪ Ext(G) remain non-free and its Tabu sets contain the color 1. When we remove e1 from GJ, then a new planar graph G1 = GJ − {e1} is built, where color 1 cannot be assigned to the vertices in Ext(G1). Therefore, any 4-coloring in G1 will be a 4-coloring for G, where the first color is not used by the vertices of Ext(G).
2
An example of a disc formed by three edges that encloses the whole graph is shown in Figure 3a. The disc is formed by the edges {{g, e}, {g, f}, {e, f}}. Notice that Ext(G)= {g, e, f} encloses another layer of external vertices in (G − Ext(G)), denoted by Ext(G1)= {a, b, c}. When Color(g) = 1, then all the remaining vertices in Ext(G) and Ext(G1) are marked. Thus, no vertex in Ext(G1) will have color 1, as the previous lemma claims. When a vertex e ∈ Ext(G) is colored, then it is completely removed from G. Therefore, the vertices in NG(e) are non-free. Notice that when e is removed, then the vertices in NG(e) are now part of Ext(G − {e}).
Another example of a disc D formed by three edges that encloses a whole graph is shown in Figure 2b, the disc formed by {e1, e2, e3} enclose the graph of the Figure 2a.
Notice that the step 1 of our proposal is justified by Lemma 5.3, since we can always build a 4-coloring of any planar graph G where color 1 is not used for Ext(G). For that reason, we can initiate assigning the color 1 to the maximum number of external vertices of G, and then remove them in order to form new planar graphs GJ until ∀e ∈ Ext(GJ); Tabu(e)= {1}.
In the resulting planar graph GJ, its internal vertices are free and its external vertices are marked. As a logical consequence from Lemma 5.3, a 4-coloring is guar- anteed on GJ where color 1 is excluded from Ext(GJ). This 4-coloring is extended to a 4-coloring of G with color 1 assigned to the vertices initially removed from the original set in Ext(G), since these vertices would not have any adjacent vertex with color 1, since color 1 was excluded for Ext(GJ).
The step 1 is the only step in our method that is justified by the 4CT theorem.

On the other hand, the inclusion of step 1 in our proposal is justified because it speeds up the construction of a 4-coloring.
The step 2 removes any subsumed wheel and classic wheel from G, remaining in G only polyhedral wheels whose center vertices are free. This makes free the centers’ vertices in G, since they are enclosed by the vertices of their cycles, and therefore, any e in Ext(G) with color 1 is not adjacent to the remaining center wheels of GJ. In that sense, step 2 leaves the remaining graph free from K4.
Theorem 5.4 There are not any remaining classic wheels in the resulting graph
Gr after the application of step 2.
Proof. By contradiction. Let Gr be the remaining graph after applying step 2, and let us suppose that there is a wheel rx ∈ Gr with Crx as center, where every face is triangular. If Tabu(Crx )= ∅ then step 2 assigns Color(Crx )=1 and rx is reduced to one face fx. On the other hand, Tabu(Crx ) = {1} can only occur if a wheel ry is processed with center Cry , such that Crx ∈ N (Cry ), and where Cycle(Cry ) is embedded in one of the triangular faces of rx. This means that rx is being contained in fa ∈ F (rx); otherwise, Cycle(ry) would cross through the spoke edges of rx. If Cycle(ry) is embedded in E(fa), then we would have the following conditions:
N [Cry ] ⊆ N [Crx ]. In this case, Crx should have been assigned the color 1 prior to Cry by criterion (2a) of our algorithm. Therefore, Crx ∈/ N (Cry ).
|Exc(ry)| = |Exc(rx)| = 2. Since |Ext(Gr)|≥ 3 and Ext(Gr) only has vertices of degree 3 or greater, then there should be another wheel rz with center Crz , which holds |Exc(rz)| > |Exc(rx)| and |Exc(rz)| > |Exc(ry)| and where (Cycle(rz) ∩Cycle(ry) ∩Cycle(rx)) /= ∅. When Color(Crz ) = 1, then the wheel rz is reduced to a new face fz with a length strictly greater than 3. This new face is part of the wheels rx and ry; therefore, rx should have at least one non-triangular face.
2
Theorem 5.4 includes the forbidden existence of K4 and any other classic wheel in the resulting graph GJ. If GJ is a polygonal tree, then a 3-coloring is built. Otherwise, different algorithms can be proposed to build a 3-coloring for GJ.
Example 5.5 Figure 1a shows the planar graph G that has to be processed in this example. The first step of the algorithm is to consider the external vertices: Ext(G) = {a, b, g} to be assigned the color 1. A vertex x ∈ Ext(G) is selected following the rules of the step 1, and using the internal-face graph of G (Figure 1b). In this case, the vertex g is selected for being colored: Color(g) = 1 since g has a maximum degree in Ext(G). Next, the vertices N (g) are marked with color 1. Then g is removed from the graph G, G = (G − {g}). Since there is not another free external vertex, we continue to step 2.
As the first part of step two, the wheels that subsume other wheels are processed (step 2a). The list of wheels rh = {a, b, i, c}, ri = {h, b, c}, rj = {b, d, f, e, c} is generated. We can see that the wheel rh subsumes the wheel ri, so that the vertex h is selected for being colored. Color(h)=1 and N (h) is marked with 1. As there

are no more subsumed wheels, we proceed to step (2b).
A list of all free triangular wheel centers is created. In this case, the list consists of the vertex j; therefore, this vertex is colored. Color(j) = 1. In addition, j is removed from the graph G = (G − {j}) and its neighborhood is marked with 1.
At this point, all the vertices in the graph have in their Tabu set the color 1, (Tabu(V (G)) = 1). The resulting graph is shown in Figure 4, and its corresponding internal-face graph is shown in Figure 5. We can see that it is a polygonal tree, so according to the stop condition (i), a 3-coloring on G is built based on theorem 4.3.

Fig. 4. G after removing vertices with color 1
Fig. 5. The internal-face graph Gf of the graph in the figure. 4
After GJ was 3-colored, we return all removed vertices that were colored with color 1 on steps 1 and 2. The resulting graph G is a 4-colorable graph (the 4-coloring is shown in Figure 6).


Fig. 6. A 4-coloring of G

Algorithm’s time-complexity
Let G = (V, E) be an input planar graph, with n = |V | and m = |E|. In the first part of the algorithm, we select some of the external vertices and remove them. This process iterates until there are not more external free vertices in the current graph. In the worst case, the graph would be outerplanar (all vertices are in the external face) and we could select any of them, giving a complexity of O(n).

In the step (2a) of our algorithm, subsumed wheels are searched and processed by using special data structures that storage the components of the wheels. We have to build every cycle of the wheels, using a Breadth First Search procedure that has an O(m) time-complexity. Afterwards, we compare a cycle of each wheel versus each other cycle of the remaining wheels, performing at most n2 comparisons in the worst case.
In this step, every cycle is formed as a string of vertices that should be compared with all other cycle in G. The final time complexity is of order O(n2).
In step(2b), we have to sort all wheel of the current graph based on three criteria; first, the parity of the wheels, and second, based on the rules min{|N (Crx ) ∩ Sc|} and max{|Exc(rx)|}. Thus, we sort the list using a typical sorting algorithm that has a complexity of O(n · log(n)).
In conclusion, as the three main steps are sequential, we can calculate the general complexity of the algorithm by taking the greatest complexity among all steps as: O(max{O(step1), O(step2), O(step3)})= O(n2)
Conclusion
We determined classic and polyhedral wheels as the basic patterns in the formation of planar graphs. Afterwards, we analyzed these wheels and their compositions for the construction of a maximal independent set (a MIS) from the input planar graph
G. The MIS M of G is built by an algorithm, which is based on three rules. The first rule is to consider the maximum number of non adjacent external vertices to assign the color 1. Later on, centers of wheels that subsume other wheels are selected. Finally, we color the center of the remaining wheels by sorting them, considering the order of classic, polyhedral, even, odd and minimum internal connected of each center vertex in the current graph. Lastly, we show that if the graph GJ = (G − M ) is 3-colorable, then G is 4-colorable.
The process presented here can be used to develop a robust algorithm for coloring planar graphs. In our future works, we are considering extend our proposal for developing a general coloring algorithm for planar graphs.

References
O.V. Borodin, and A. Raspaud. A sufficient condition for planar graphs to be 3-colorable, Journal of Combinatorial Theory, Series B, 88 (1977), pp. 17 - 27, 2003.
O.V. Borodin, A. N. Glebov and A. Raspaud and M.R. Salavatipour. Planar graphs without cycles of length form 4 to 7 are 3-colorable, Jour. of Combinatorial Theory, Series B, 93, pp. 303-–311, 2005.
P. Cortese and M. Patrignani. Planarity Testing and Embedding. Press LLC, 2004.
Z. Dvora´k, D. Kr´al and R. Thomas. Three-coloring triangle-free graphs on surfaces. Proc. 20th ACM- SIAM Symp. on Discrete Algorithms, pp. 120-–129, 2009.
H. Gr¨otzsch. Ein Dreifarbensatz fu¨r dreikreisfreie Netze auf der Kugel. Wiss. Z. Martin-Luther-Univ. Halle-Wittenberg Math.-Natur. Reihe 8, pp. 109–120, 1959.
D. Johnson. The NP-Completeness Column: An Ongoing Guide. Jour. Of Algorithms 6, pp.434–451, 1985.


K. Kuratowski. Sur le probleme des courbes gauches en topologie. Fund. Math., volume 15, pp.271-–283, 1930.
C. L´opez, G. De Ita and A. Neri. Modelling 3-Coloring of polygonal trees via Incremental Satisfiability.
Pattern Recognition of LNCS, volume 10880, pp. 93–104, 2018.
G. B. Mertzios and P.G. Spirakis.Algorithms and almost tight results for 3-colorability of small diameter graphs. Technical report. arxiv.org/pdf/1202.4665v2.pdf, 2012.
T. Nishizeki and N. Chiba. Planar graphs: Theory and algoritms. Elsevier, volume 32, pp. 83–87, 1988.
N. Robertson, D.P. Sanders, P.D. Seymour, and R. Thomas. The four color theorem.Journal Combinatorial Theory Ser. B, volume 70, pp. 2—44, 1997.
J. Stacho. 3-colouring AT-free graphs in polynomial time. In: Cheong, O., Chwa, K.-Y., Park, K. (eds.). Algorithms and Computation, ISAAC 2010. LNCS, volume 6507, pp. 144—155. Springer, Heidelberg, URL: https://doi.org/10.1007/978-3-642-17514-5 13, 2010.
K. Wagner. U¨ ber eine Eigenschaft der ebenen Komplexe. Mathematische Annalen,volume 114, pp. 570—590, 1937.
