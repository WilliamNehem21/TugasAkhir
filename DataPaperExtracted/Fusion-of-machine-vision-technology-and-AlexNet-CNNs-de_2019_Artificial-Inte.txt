Fusion of machine vision technology and AlexNet-CNNs deep learningnetwork for the detection of postharvest apple pesticide residues
Bo Jianga,b,c, Jinrong Heb,c,d, Shuqin Yanga,b,c, Hongfei Fue,T o n gL ia,b,c, Huaibo Songa,b,c,⁎, Dongjian Hea,b,c
aCollege of Mechanical and Electronic Engineering, Northwest A&F University, Yangling, Shaanxi 712100, China
bKey Laboratory of Agricultural Internet of Things, Ministry of Agriculture and Rural Affairs, Yangling, Shaanxi 712100, China
cKey Laboratory of Agricultural Information Perception and Intelligent Services, Yangling, Shaanxi 712100, China
dCollege of Information Engineering, Northwest A&F University, Yangling, Shaanxi 712100, China
eCollege of Food Science and Engineering, Northwest A&F University, Yangling, Shaanxi 712100, China
abstract article info
Article history:Received 16 November 2018Received in revised form 27 January 2019Accepted 4 February 2019Available online 14 March 2019Pesticide residue is an important factor that affects food safety. In order to achieve effective detection of pesticideresidues in apples, a machine-vision-based segmentation algorithm and hyperspectral techniques were used tosegment the foreground and background regions of the apple image. By calculating the roundness value andextracting the region with the highest roundness value in the connected region, a region of interest (ROI)mask was created for the apple. Four pesticides (chlorpyrifos, carbendazim and two mixed pesticides) and an in-active control were used at the same concentration of 100 ppm (except for the control group), and thehyperspectral region of the corresponding sample image was extracted by obtaining the different types of pesti-cide residues in the ROI masks. To increase the diversity of the samples and to expand the dataset, Gaussian whitenoise with a varying signal-to-noise ratio was added to each of the hyperspectral images of the apple. The num-ber of samples was increased from four types of 12 samples to four types of 72 samples, giving 4608hyperspectral data images in each category. The structure and parameters of a convolutional neural network(CNN) were determined using theoretical analysis and experimental veri ﬁcation. All the extracted hyperspectral images of apples were normalized to 227 × 227 × 3 pixels as the input of the CNN network for pesticide residuedetection. There were 18,432 sample data of four types for 72 samples. Of these, 12,288 images were selectedusing a bootstrap sampling method as the training set, and 6144 as the test set, with no overlap. The test resultsshow that when the number of training epochs was 10, the accuracy of the test set detection was 99.09%, and thedetection accuracy of the single-band average image was 95.35%. A comparison with traditional k-nearest neigh-bor (KNN) and support vector machine classi ﬁcation algorithms showed that the detection accuracy for KNN was 43.75% and the average time was 0.7645 s. These results demonstrate that our method is a small-sample, non-contact, fast, effective and low-cost technique that can provide effective pesticide residue detection in posthar-vest apples.© 2019 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/4.0/ ).
Keywords:Pesticide residue detectionAppleHyperspectralCNN networkKNNSVM
1. IntroductionAccording to Food and Agriculture Organization statistics from 2013,the production of apples ranks second in the world ( Czernyszewicz, 2016). Although pesticides can increase the yield of apples, they also in-crease the risk to the safety of food (Jiyun et al., 2014). Pesticide residues in apples are one of the most important factors affecting their safety(Liang and Xie, 2017;Jia et al., 2017). A great deal of attention has been paid to the problem of pesticide residues in apples, and effectivepesticide residue detection methods are important in restrictingproduction by fruit farmers and improving the level of information forpesticide detection.In prior research into fruit and vegetable pesticide residue detection,researchers have carried out numerous studies and have proposed a va-riety of effective detection methods. In view of the different compo-nents and types of pesticide residue in apples, Zhou ( Wei, 2017) proposed a method for the detection of pesticide residues in applejuice involving cloud point extraction, gas chromatography and massspectrometry that can achieve the separation of 45 organophosphoruspesticides. This method can accurately detect information about pesti-cide residue in apples and categorize it. However, this method suffersfrom lossy detection, and the operation is so complex that it is not suit-able for the large-scale detection of pesticide residues in apples. Lei(Peng et al., 2014) proposed the use of multi-spectralﬂuorescenceArtiﬁcial Intelligence in Agriculture 1 (2019) 1 –8
⁎Corresponding author at: College of Mechanical and Electronic Engineering,Northwest A&F University, Yangling, Shaanxi 712100, China.E-mail address:songhuaibo@nwsuaf.edu.cn(H. Song).
https://doi.org/10.1016/j.aiia.2019.02.0012589-7217/© 2019 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the C CB Y - N C - N Dl i c e n s e (http://creativecommons.org/licenses/by-nc-nd/4.0/ ).
Contents lists available atScienceDirect
Artiﬁcial Intelligence in Agriculture
journal homepage:http://www.keaipublishing.com/en/journals/artificial-intelligence-in-agriculture/image technology to detect pesticide residues, and found that under ex-citation by ultraviolet light at 190–300 nm, fruit containing organophos-phorus pesticides produced signiﬁcantﬂuorescence near 440 nm, which can be used to accurately detect the presence or absence of pes-ticide residues in apples. However, this method requires the experimen-tal parameters to be conﬁgured in advance, and the experimentalresults are not stable.Zhu et al. (2017)put forward a method for detect- ing pesticide residues in apples by laser. Based on established ﬂuores- cence data for various types of pesticide residues, an empiricalformula was established for an analysis of whether apples contain pes-ticide residues, using spectral data analysis. However, this method has alow true positive rate, high time costs and a slow detection speed. Liu(Yande et al., 2017) proposed the detection of Imipenem pesticide res-idues in navel oranges using surface-enhanced Raman spectroscopy.The correlation coefﬁcient and predicted mean square root for thismethod were 0.919 and 3.990 mg/L respectively. This method has ahigh detection accuracy, but the operational cost is also high. Li(Zengfang et al., 2016) proposed a method for detecting pesticide resi-dues on the surface of a Gannan navel orange, based on hyperspectralimaging technology, and for realizing the nondestructive detection ofagricultural residues by extracting characteristic bands for principalcomponent analysis.Zhang and Li (2018)proposed a full-convergence neural network for hyperspectral transmission imaging, which wasused to segment blueberry bruises and ﬂower buds.Wang et al. (2018)applied high-spectral transmittance data with a deep learningarchitecture to accurately and quickly detect mechanical damage insideblueberries.Jiang et al. (2016)used NIR hyperspectral imaging technol-ogy to detect pesticide residues in mulberry leaves. Hyperspectral char-acteristic bands in mulberry leaves were extracted, analyzed andprocessed via continuous projection and stepwise regression. The de-tection accuracy was high, but the complexity of the algorithm wasalso signiﬁcant.We therefore put forward a small-sample, non-contact, low-cost,fast, efﬁcient and non-destructive method for detecting apple pesticideresidues under hyperspectral conditions. By taking the advantage of thenumerous sample bands in hyperspectral technology, a method is pro-posed for the detection of hyperspectral pesticide residues in applesbased on machine vision technology and CNNs. Based on a collectionof high-spectrum apple pesticide residues, a hyperspectral image of anapple was analyzed to extract a mask image corresponding to the typeof pesticide residue. The structure and parameters for a CNN networkwere designed based on the AlexNet framework using the characteris-tics of hyperspectral apple images. The extracted hyperspectral imageswere used to train and test the network performance, and ﬁnally to re- alize the rapid and effective non-destructive detection of pesticide resi-dues in apples.2. Materials and methods2.1. MaterialsPostharvest samples of Fushi apples were collected from the YanglingApple Agricultural Demonstration Station in June 2016. A hyperspectralinstrument (HyperSIS-VNIR-PFH ofZhuoli Hanguang ZOLIX model) wasused, as shown inFig. 1. Three samples of hyperspectral data for pesti-cide residue were collected for each of four pesticides, which weresprayed on the apples: chlorpyrifos, mycelium, two mixed pesticides(mixtures of chlorpyrifos and carbendazim) and an inactive control.The spectral wavelength range was 865.11 –1711.71 nm, and the spectral resolution was 3.32 nm. There were 12 samples in total, and each indi-vidual sample contained 256 bands of hyperspectral data.The data samples for the four pesticide residues were labeled as A(chlorpyrifos), AB (two mixed pesticides), B (carbendazim), and K (in-active control). Each pesticide residue contained three different samplesof data, each of which contained 256 bands of spectral data, giving 768spectral data images in total for each pesticide residue. In order to in-crease the diversity of the samples, Gaussian white noise with signal-to-noise ratios of 1, 2, 3, 4 and 5 dB was added to the hyperspectral
image of the apple for each pesticide residue. This increased the numberof samples from 12 in four categories to 72 in four categories, giving4608 spectral data images in each category. Using a bootstrap samplingmethod, the sample set was randomly divided into a training set andtest set. The training set sample contained 66.7% of the data, with 48training samples, that is, 12 samples for each type of pesticide residuesample. The test set sample was 33.3% of the data, with 24 samples, giv-ing a total of 48 training samples, that is, six samples for each kind ofpesticide residue sample. There was no overlap between the trainingand the testing sample sets.The processor for the subsequent training and test processing plat-form was a 3.4 GHz Inter Core i5-7200 M with 16 GB memory and500 GB hard disk, and the development platform for the algorithmwas MATLAB 2016b. When the hyperspectral image was obtained, the
Fig. 1.Hyperspectral imaging system.2 B. Jiang et al. / Artiﬁcial Intelligence in Agriculture 1 (2019) 1 –8area of the apple wasﬁxed in the center of the image, meaning that theinvalid image area could be eliminated by extracting the ROI informa-tion for the position of the apple.2.2. Hyperspectral preprocessing of the apple image using machine visiontechnologyFig. 2shows theﬂow chart for the algorithm.2.2.1. Positioning of the ROI for the appleThe Otsu segmentation algorithm uses an optimal threshold that isselected automatically to divide the original image into foregroundand background (Kwong et al., 2018).Fig. 3a shows a hyperspectral image of an apple with a certain band, and Fig. 3b shows a hyperspectral gray histogram. It can be seen fromFig. 3that the hyperspectral image of the apple is a multi-peak image in which the sub-peaks of eachpeak are different, that is, they are relatively independent. This multi-peak image is therefore considered to be a linear superposition of mul-tiple single peaks. The Otsu segmentation algorithm can be used to pro-cess the hyperspectral images to obtain rough pixel regions for theapples, and the binary image obtained in this way is subjected to a mor-phological operation to eliminate non-ROI interference and segmenttheﬁnal ROI region for the apple. The obtained Otsu segmentationimage shown inFig. 4ai sp i x e l -ﬁlled to give binary padding, as showninFig. 4b, and the pixel area value of each white pixel block is calculatedseparately. The other pixel areas that are smaller than a factor of 0.05 ofthe maximum region areﬁltered to obtain the image inFig. 4c. The roundness (0≤R
N≤1) of each connected area is then calculatedaccording to Eq.(1), and the connected area with the largest roundnessvalue is the apple ROI area, as shown in Fig. 4d.RN¼4πSC
2ð1ÞwhereSis the area of the pixel block in the connected domain, Cis the perimeter of the pixel block in the connected domain, the units arepixels, andR
Nrepresents the roundness of the pixel block in the con-nected domain.2.2.2. Extraction of ROI for the appleThe obtained ROI position image is used as a mask M(x,y)f o r extracting other bands, and the ROI of the remaining band is calculatedaccording to Eq.(2).f
ROIx;yðÞ ¼Mx;yðÞFx;yðÞ ð 2ÞwhereF
ROI(x,y) is the ROI image of the extracted from the band, and F(x, y) is the hyperspectral image of the remaining bands. As shown in Fig. 5, the ROI mask for the apple and the remaining band image undergo amathematical operation to obtain the ROI for the apple of the remainingband, and this lays the foundation for the CNN to carry out featureextraction.2.2.3. Construction of the CNN networkA CNN is a type of deep network used in the deep learning model.Compared with a traditional neural network model, a CNN has fewer
Fig. 2.Proposed algorithmﬂowchart.
Fig. 3.Apple hyperspectral image and its Histogram. (a) Apple hyperspectral images (b) Histogram of apple hyperspectral images (the x-axis represents the frequency at which the pixel value appears, and the y-axis represents the number of pixel values).3 B. Jiang et al. / Artiﬁcial Intelligence in Agriculture 1 (2019) 1 –8parameters and stronger expressive power, and can automatically ex-tract effective feature structures from complex spectral data ( Lawrence et al., 1997). AlexNet is a CNN network with a relatively shallow net-work structure, and is capable of extracting rich features from images(Yuan and Zhang, 2016).The hyperspectral data for each apple pesticide residue is used as a category or model. The detection of pesticide residues in applesrequires matching and predicting unknown pesticide residue cate-gories. The number of grades of apple pesticide residues in thesample is used as the number of mat ching categories or recognition patterns. A total of 18,432 spectral data images are included in thefour types of samples. A CNN is req uired with a fast training time, a relatively shallow network structure, and ef ﬁcient extraction of feature information from spectral data, and the AlexNet network ar-chitecture meets these conditions. Based on the above analysis ofthe hyperspectral data characteristics of apple pesticide residues,an AlexNet CNN framework that was suitable for the detection of apple pesticide residues was constructed.
Fig. 4.Obtain binary images of apple's ROI area. (a) Otsu segmentation result. (b) Image ﬁlling. (c) Filtering smaller pixel blocks. (d) Extracting pixel blocks with the largest roundness.
Fig. 5.Obtain the rest of band apple ROI images with mask.4 B. Jiang et al. / Artiﬁcial Intelligence in Agriculture 1 (2019) 1 –82.3. Image classiﬁcation method in traditional machine learningThe classiﬁcation of hyperspectral data for the apple pesticide resi-dues involved in this study is a typical image classi ﬁcation problem; based on hyperspectral data maps for different apple pesticide residuetypes, particular characteristics reﬂected by the same target object aredivided into one type. In this study, in order to ensure that as many de-tails as possible are input into the hyperspectral data map, the imagesize for the agricultural residue hyperspectral data was normalized to2 2 7×2 2 7×3p i x e l s .Since no problems such as deformation of the position of theapple in the hyperspectral image are encountered, a framework ofﬁve convolutional layers and three fully connected layers was usedin this work. In addition, a three-layer max-pooling layer was alsoadopted to improve the network's utilization rate of the feature in-formation for the hyperspectral data images for the different typesof apple pesticide residues. When pooling, the output matrix of theprevious layer is maximized based on the superparameters of thepooled layer, and the pooled layer has no weight or offset value. I In-formation matching was realized using the Softmax function. In thisstudy, there are four different apple pesticide residues, and Softmaxtherefore contains four perceptrons.The biologically similar ReLu activation function was used as the ac-tivation function. Compared to a sigmoid function, it has three major ad-vantages: (i) unilateral inhibition; (ii) a relatively wide thresholdexcitation boundary; and (iii) sparse activation ( Glorot et al., 2012). Fi- nally, the network structure of the CNN shown in Fig. 6was selected for this research.The blue arrow inFig. 6represents the convolution process, and thelight blue color represents the output after convolution; the yellowarrow represents the maximum pooling process, and the lighter yellowindicates the output after maximum pooling; the purple arrow repre-sents the process of fully connecting the extracted feature values. Thelight green color shows each feature extracted using the above network,and the red represents the Softmax classi ﬁer, which contains four perceptrons. The speciﬁc parameters used are shown inTable 1. In order to further compare the advantages and disadvantages of theCNN for the AlexNet architecture with traditional image classi ﬁcationmethods, we carry out a comparison of this approach with two commonimage classiﬁcation methods, SVM (Hearst et al., 2002)a n dK N N(Cost and Salzberg, 1993). In this paper, the brightness feature was extractedfrom the hyperspectral data and used as the basis of image classi ﬁcation, before SVM and KNN classiﬁcation were used to classify the apple pes-ticide residues in the data.The SVM image classiﬁcation method gives a hyperplane in the fea-ture space for hyperspectral data samples of different apple pesticideresidues. The brightness feature of the hyperspectral data images areclassiﬁed by this hyperplane, i.e. this is a classiﬁcation of hyperspectral images. The KNN image classiﬁcation method can give the similarity be-tween the brightness features in the high spectrum of the apple pesti-cide residues based on the distance metric, i.e. a brightness featurewith high similarity indicates that the hyperspectral data image forthe pesticide residue type is highly likely to be a certain species. Thekey parameters for the two algorithms used in comparative experimentare shown inTable 2.3. Results and discussion3.1. Classiﬁcation results and analysis
The CNN was trained using a training set of 12,288 hyperspectral datamap samples, and the minimum loss function and network parameters
Fig. 6.CNNs network structure presented in this research.
Table 1Parameters of each layer in the convolutional neural network.Layer name Size Number Stride PaddingConv1 11 × 11 96 4 0Maxpooling1 3 × 3 1 2 0Conv2 5 × 5 256 4 0Maxpooling2 3 × 3 1 2 0Conv3 3 × 3 384 4 0Conv4 3 × 3 384 4 0Conv5 5 × 5 256 4 0Maxpooling3 3 × 3 1 2 05 B. Jiang et al. / Artiﬁcial Intelligence in Agriculture 1 (2019) 1 –8were obtained using mini-batch gradient descent (MBGD) ( Li et al., 2017). The initial parameters used in the CNN in this study are as follows:time decay: 0.0005; momentum parameter: 0.9; batch size: 32; oneepoch: 384 iterations; number of epochs: 10. After the tenth training iter-ation, the network was veriﬁed using a sample set of 6144 hyperspectraldata images. The results are shown in Table 3. As can be seen from the table, the CNN constructed here can detect the hyperspectral images ofsingle apple pesticide residues and the hyperspectral test atlas of applepesticide residues with accuracies of 90.55% and 99.11%, respectively.The average time required is also low enough to meet the requirementsof real-time detection.Of 6144 hyperspectral data images of apple pesticide residues in thetesting set, 0.91% were detected incorrectly (56 images). Fig. 7shows sample number 42 in category B (wavelength 1545.71 nm) and samplenumber 60 in category K (wavelength 1545.71 nm) for which detectionerrors occurred. The image details are lost after changing the size of theimage and max-pooling, making it difﬁcult for the constructed network to distinguish between similar images. Thus, when two hyperspectralimages are in the same band and have similar appearances, the networkwill generate detection errors.In order to further improve the accuracy of detection for hyperspectralimages of apples with similar appearance in the same band, the numberof speciﬁc features in the convolution kernel can be increased, i.e. the in-dividual feature information of the apples in the hyperspectral images isincreased to ensure that there are larger differences between similar ap-p l e si nt h es a m eb a n d .3.2. Analysis of the characteristic diagramFig. 8shows the corresponding feature image results for hyperspectralimages of apples obtained by the convolution layer and the max-poolinglayer in the CNN. Since the images are normalized before input, thenumerical distribution interval of each feature image matrix ob-tained is [0, 1] (Vahadane et al., 2016;Garain et al., 2018;Zanjani et al., 2018).By comparing the input image inFig. 8with the image obtained from the b-convolution layer, we can see that the 96 convolution kernels inthe b-convolution layer extract image features such as the outline ofthe input image, bright and dark pixel areas, etc. Since the obtainedimage features have a smoothing effect, the input image can be consid-ered as having beenﬁltered 96 times through a convolution kernel, andeach convolution operation can improve the anti-interference capabilityof the network. The c max-pooling layer is used to enlarge the imagefeatures obtained by the b convolution layer, the f omission layer in-cludes three convolution layers and two max-pooling layers, and the gfully connected layer connects all the extracted image features. This op-eration can reduce the solution parameters and extract the main fea-ture information from the image, which can give a better detectioneffect.3.3. Comparison with image classiﬁcation methods in traditional machinelearningThe training and testing sets of the CNN were used as the trainingand testing sets for the SVM and KNN classi ﬁcation algorithms in the traditional image classiﬁcation process, and the performance of thesethree algorithms was compared. Values for the accuracy and timecosts of the hyperspectral image detection of pesticide residues in ap-ples are shown inTable 4.In the KNN and SVM classiﬁcation algorithms, classiﬁcation is based on information in the brightness feature of hyperspectral images. Due tothe use of hyperspectral data images, the brightness information of im-ages in the same band is very similar. The Euclidean distance ( Mesquita et al., 2017), which is used to calculate the brightness feature informationof each image, is also very close, so the correct rate for hyperspectral applepesticide residue detection is as lowas 43.75%, and the time consumptionis 0.7645 s. Using its non-linear mapping characteristics, SVM dividesthe brightness feature space for the hyperspectral images into opti-
mal hyperplanes and maximizes the classi ﬁcation boundary, and the classiﬁcation detection accuracy of SVM is therefore higherthan that of KNN. In summary, a CNN using the AlexNet frameworkhas robust anti-interference ability, and the detection process has alow time cost; at the same time, it also has high robustness to theimage brightness characteristics.4. Conclusion(1) In this study, a CNN based on AlexNet was constructed. Detectionresults for 6144 images of four kinds of hyperspectral apple pes-ticide residue showed that the average recognition rate forTable 2Values of key parameters for the SVM and KNN methods.SVM KNNParameters Values Parameters ValuesNum. class 4 Num. class 4Cost function Square function Cost function Square functionClass design One-to-many Distance metric Euclidean distance
Table 3Detection rate and efﬁciency of CNN.Net name Detection rate/% Elapsed time/sSingle image Test set Single image Test setCNN 95.35 99.09 0.0846 8.0691
Fig. 7.Hyperspectral images of crisscross detection. (a) B concentration sample No. 42 ( λ= 1545.71 nm). (b) K concentration sample No. 60 ( λ= 1545.71 nm).6 B. Jiang et al. / Artiﬁcial Intelligence in Agriculture 1 (2019) 1 –8single-band images was 95.35%, and the true positive detectionrate for the test set was 99.09%. There was no overlap betweenthe test samples and the training samples, and this shows thatthe network has strong generalizability.(2) The Otsu segmentation algorithm was used to detect binary im-ages containing the ROI for the apple in hyperspectral images.The roundness analysis of the binary image can obtain an effectivemask for the ROI of the apple and eliminate the invalid region.(3) Compared with the SVM and KNN methods, the CNN has theadvantages of low time cost and high robustness. However,when two hyperspectral images are in the same band andhave a similar appearance, the network is prone to detectionerrors. In future research, the number of speci ﬁcf e a t u r ep a - rameters of the convolution kernel could be increased as thebasis of network classiﬁcation, in order to improve the featureextraction ability of the network for similar hyperspectral im-ages of apples in the same band, and to further improve the ac-curacy of pesticide residue detection.AcknowledgmentsThis work was supported by the National Natural Science Founda-tion of China (Grant No. 31501228) and the Yangling DemonstrationZone Science and Technology Plan Project (Grant No. 2016NY-31).Compliance with ethical standardsThis article does not involve any studies with human or animalsubjects.Conﬂict of interestBo Jiang declares that he has no conﬂict of interest. Jinrong He de- clares that he has no conﬂict of interest. Hongfei Fu declares that hehas no conﬂict of interest. Tong Li declares that he has no con ﬂict of in- terest. Huaibo Song declares that he has no con ﬂict of interest. Dongjian He declares that he has no conﬂict of interest. Yun Zhao declares thatshe has no conﬂict of interest.Informed consentNot applicable.References
Cost, S., Salzberg, 1993.A weighted nearest neighbor algorithm for learning with sym-bolic features. Mach. Learn. 10 (1), 57 –78. Czernyszewicz, E., 2016.Long-term trends in production and consumption of apples inPoland, Europe and worldwide. Acta Sci. Pol. 15 (3), 95 –104. Garain, J., Kumar, R.K., Kumar, D., Kisku, D.R., 2018. Image speciﬁc cross cohort normaliza- tion for face pair matching. Proc. Comput. Sci. 132, 1060 –1067. Glorot, X., Bordes, A., Bengio, Y., 2012. Deep sparse rectiﬁer neural networks. International Conference on Artiﬁcial Intelligence and Statistics, pp. 315 –323. Hearst, M.A., Dumais, S.T., Osuna, E., Platt, J., 2002. Support vector machines. IEEE Intell. Syst. 13 (4), 18–28.Jia, Song, Lihua, Song, Yue, Chen, Jianhui, Zhang, Wu, Hao, 2017. The inﬂuence of cleaning methods on pesticide residue removal effect of fruits and vegetables. Food Res Dev 38(20), 160–164.Jiang, S., Sun, J., Xin, Z., Mao, H., Wu, X., 2016. Visualizing distribution of pesticide residues in mulberry leaves using NIR hyperspectral imaging. J. Food Process Eng. 40 (4).Jiyun, Nie, Zhixia, Li, Chuande, Liu, Jinbao, Fang, Wang, Cheng, Guo, Yongze, Shaorong, Lei,Haifei, Li, Xu, Guofeng, 2014. Risk assessment of pesticide residues in apples. Sci. Agric. Sin. 47 (18), 3655–3667.Kwong, S.T.W., Gao, H., Pun, C.M., 2018. An improved artiﬁcial bee colony algorithm with its application to metallographic image segmentation. IEEE Trans. Ind. Inf. 99, 1.Lawrence, S., Giles, C.L., Tsoi, A.C., 1997. Face recognition: a convolutional neural-network approach. IEEE Trans. Neural Netw. 8 (1), 98 –113. Li, J., Li, X., Zhao, L., 2017.Hyperspectral unmixing via projected mini-batch gradient de-scent. IEEE International Geoscience and Remote Sensing Symposium, pp. 1133 –1136. Liang, Ke, Xie, Junping, 2017.Current status and breakthrough of rapid detection technol-ogy for pesticide residues in fruits and vegetables. China Food Saf. Mag. 31, 32 –33. Mesquita, D.P.P., Gomes, J.P.P., Junior, A.H.S., 2017. Euclidean distance estimation in in- complete datasets. Neurocomputing 248, 11 –18. Peng, Lei, Lv, Shaobo, Li, Ye, 2014. Multispectralﬂuorescence imaging technology for pes- ticide residues detection. Chin. J. Lumin. 35 (6), 748 –753.
Fig. 8.Results in each layer (part) of CNNs. (a) Input layer. (b) Convolutions layer (part connection). (c) Max-pooling layer (d) Convolutions layer (part c onnection). (e) Max-pooling layer. (f) Omit layer. (g) Full connection layer.
Table 4Comparison of image classiﬁcation methods and CNN.Algorithm Recognition rate/% Time/sKNN 43.75 0.7645SVM 74.34 11.2301CNNs 99.09 0.08467 B. Jiang et al. / Artiﬁcial Intelligence in Agriculture 1 (2019) 1 –8Vahadane, A., Peng, T., Sethi, A., 2016. Structure-preserving color normalization and sparse stain separation for histological images. IEEE Trans. Med. Imaging 35 (8), 1962 –1971. Wang, Z., Hu, M., Zhai, G., 2018. Application of deep learning architectures for accurateand rapid detection of internal mechanical damage of blueberry using hyperspectraltransmittance data. Sensors 18 (4), 1126.Wei, Zhou, 2017.Determination of organophosphorous pesticides in cider by GC-MScoupled with cloud point extraction. Sci. Technol. Food Ind. 23, 225 –231. Yande, Liu, Xie, Qinghua, Wang, Haiyang, Ma, Kuirong, 2017. Quantitative study on phosmet residues in navel oranges based on surface enhanced Raman spectra.Laser Technol. 41 (4), 545–548. Yuan, Z.W., Zhang, J., 2016.Feature extraction and image retrieval based on AlexNet.Eighth International Conference on Digital Image (100330E).Zanjani, F.G., Zinger, S., Bejnordi, B.E., Laak, 2018. Stain normalization of histopathology images using generative adversarial networks. IEEE International Symposium on Bio-medical Imaging, pp. 573–577. Zengfang, Li, Bingquan, Chu, Hailiang, Zhang, He, Yong, Xuemei, Liu, 2016. Study on non- destructive detecting gannan navel pesticide residue with hyperspectral imagingtechnology. Spectrosc. Spectr. Anal. 36 (12), 4034 –4038. Zhang, M., Li, C., 2018.Fully convolutional networks for blueberry bruising and calyx seg-mentation using hyperspectral transmittance imaging. 2018 ASABE Annual Interna-tional Meeting. American Society of Agricultural and Biological Engineers, p. 1.Zhu, Wenxiu, Wei, Zhuang, Jianzhong, Liu, Yunqi, Tang, 2017. Laser detection of apple pesticide residues. Sci. Technol. Inf. 15 (15), 116 –117.8 B. Jiang et al. / Artiﬁcial Intelligence in Agriculture 1 (2019) 1 –8