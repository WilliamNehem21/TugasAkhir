 AASRI Procedia   5  ( 2013 )  32 – 39 
2212-6716 © 2013 The Authors. Published by Elsevier B.V.
Selection and/or peer review under responsibility of American Applied Science Research Institute
doi: 10.1016/j.aasri.2013.10.055 ScienceDirect
 2013 AASRI Conference on Parallel and Distributed Computing Systems 
Intra-symbol Piecewise Equalization for OFDM Systems in Fast 
Fading Channels 
Zhigang Chena, Lei Wanga*, Pinyi Rena 
aXi'an Jiaotong Universit yy, No.28, Xian Ning West Road, Xi’an, China  
 
Abstract 
Based on intra-symbol piecewise linear channel model, a novel piecewise equalizer is proposed for OFDM systems in 
high mobility environment. In this proposed scheme the complex ICI caused by fast fading channels has been resolved as 
new OFDM subsystems' simple ISI and lower ICI, respectively caused by the average channel and the time-varying 
channel over a piece-period. By further employing the charac teristics of the channel matri x, a successive `ISI' and `ICI' 
mitigation based equalization with low complexity has been realized. Simulation results show that the proposed scheme 
has  lower computation complexity than the comparative one, while perserving good performance. 
 
© 2013 Published by Elsevier B.V.  
Selection and/or peer review under responsibility of American Applied S cience Research Institute 
 
Keywords: Equalization; OFDM;Time-varying channels; Piecewise linear channel model   
1. Introduction  
By expanding the symbol duration and adding the cyclic prefix, OF DM systems can easily overcome the 
multi-path dispersion by simple 1-t ap equalization [1]. On the other hand, OFDM systems become more 
susceptible to time-variations as symbol length increas es. Hence, the equalization over fast fading channels 
becomes a challenging and important issue for OFDM systems [2].  
 
 
* Corresponding author. Tel.: +86-29-82668772-549 ; fax: +86-29-82667951  
E-mail address:  lei.wang@mail.xjtu.edu.cn 
Available online at www.sciencedirect.com
© 2013 The Authors. Published by Elsevier B.V.
Selection and/or peer review under responsibility of American Applied Science Research InstituteOpen access under CC BY -NC-ND  license.
Open access under CC BY -NC-ND  license.33  Zhigang Chen et al.  /  AASRI Procedia   5  ( 2013 )  32 – 39 
 The existing equalization schemes over fast fading channels can be roughly divided into 2 classes, namely, pure-equalization and turbo-equalization. The pure-equalization schemes usually assume the channel information completely known by the receiver, and focus on low complexity data symbol estimation by fully using the channel characteristics [1],[3]-[4]. While the turbo-equalization schemes estimate the channel and/or data symbol and equalize the channel alternativ ely and iteratively, and generally perform better than the former at the cost of higher complexity [5]-[6]. Desp ite the rigorous requirement of complete time varying channel information, pure-equalization schemes with low complexity still preserve their importance. First, because the tradeoff between the equalization performance and complexity is still a challenging problem, even with complete channel information [3]. Seco nd, because turbo-equalization schemes usually employ pure-equalization as data symbol estimation component.  Inspired by the piecewise linear channel model in [2], a low complexity intra-symbol piecewise pure-equalization scheme over the fast fading channels is proposed in this paper. Based on the intra-symbol piecewise linear channel model, the complex ICI caused by the fast fading channel is resolved as the new OFDM subsystems’ simple ISI and lower ICI, respectiv ely caused by the average channel and time-varying channel over a piece-period. By fully exploiting the piecewise linearity of time varying channels, a successive ISI and ICI mitigation based equalization is realized with low complexity.  This paper is organized as follows. Section 2 introduces the intra-symbol piecewise OFDM system model and section 3 describes the proposed equalization scheme. Further complexity analysis and some simulation examples to demonstrate the performance of the pr oposed scheme are provided in section 4 and 5 respectively. And conclusions are drawn in section 5. Notation: 
()T and ()H represent transpose and complex conjugate transpose (Hermitian), respectively. 
()UTAand ()LTAdenotes the upper triangular part (excluding the diagonals) and the lower triangular part (including the diagonals) of matrix 
A. ()diaga is a diagonal matrix with the vector a on the diagonal and 
()blkdiag denotes block diagonal concatenation of the input arguments. Finally, NIand NF denote the NN  identity matrix and FFT matrix respectively. 2. System Model and Assumption Consider an OFDM system with 
N subcarriers in a fast time-varying multipath channel. Let the fast fading channel be expressed as time varying tapped delay line model 
(, ) , 0 , 1 , , 1 ; 0 , 1 , , 1hnl n N l L . Assuming the channel’s maximum delay length 
L less than cyclic prefix length and perfect synchronization, the time domain signal with CP removed at the receiver 
[( 0 ) ,( 1 ) , ,( 1 ) ]Trr r Nr  can be written in matrix form [6] as    
HNrH F XW  (1) where 
[ (0), (1),..., ( 1)]TXX X N X  and [( 0 ) ,( 1 ) ,,( 1 ) ]TWW W N W  are ‘frequency domain’ data vector and additive white Gaussian noise (AWGN) vector respectively, and 
NN  time domain channel matrix H is the circular form of 
NL  channel impulse response (CIR) matrix  with (,) ( 1 , 1 )pq h p q . And define the circular shift operation on the CIR matrix as   
(,)N HC S H I F T  (2) 
 ( ,(( )) 1) 0 1(, ) ( 10)( ) N kk m k mLkm o r N k m N Lelse
H  34   Zhigang Chen et al.  /  AASRI Procedia   5  ( 2013 )  32 – 39 
 where (( ))Nrepresents a cyclic shift in the base of N.  To match the fast varying channel, the channel is further approximated as intra-symbol piecewise linear model [7]. In this model the symbol period is divided into 
2pM  pieces and p is a natural number, and the CIR varies linearly in each piece-period. Let the average CIR vector 
mh in the m-th piece-period be denoted as the middle instant CIR vector 
(/ / ( 2 ) , : ) m mN M N M hh  as in [2], and the difference between the average CIR vector in the 
(1 )m -th and m-th piece-period be denoted as 1mm m hhh . By using the CIR in the m- th piece-period, define the 
(/ ) (/ )NM NM  CIR matrix mH , mH and mH as the circular form of (/ )NM L  the CIR matrix 
m with (,) ( / 1 , 1 )mpq hm N M p q  , average CIR matrix m with 
(,) ( / / ( 2 ) , 1 )mpq hm N M N M q  , and linear variation CIR matrix m with (,) ( 1 ) mm pq q h  respectively, which can be expressed as  
(, /)mm NM HC S H I F T                                                                                                                  (3) 
(, / ) m m NM HC S H I F T                                                                                                                (4) 
2* ( 0 : (/ 1 ) )() ( , / )2
mmm mMN M Ndiag N MNHH H C S H I F T                                           (5) where the second equation in (5) is derived from the property of the piecewise linear channel model.  It can be derived that the channel matrices 
H and mH, mH,mH satisfy the following matrix form if 
2/LNM .  
00 001101 1 01 1 112211() () () ()() () ,, , ,, , () () %() ()() () (
()()UT UT UT UTUT UTUT UT M M UT LTMM UT UTMM
blkdiag blkdiagH0 0H H0 0 HHH0 0 HH H HH H 0 HH0 00 HH 0 H H00 HH 00
H
11)( )UT UTMMISIHHH
(6) Due to the sparsity of the matrix 
()UTmH  and the small channel difference between the neighbouring piece-periods, the fourth term in the right hand is neglig ible. And let the first three terms be denoted by 
H , H and 
ISI
H respectively.  Let the received signals in the 
m-th piece-period be denoted by [( 0 ) ,( 1 ) , ,( 1 / ) ]T m rm M rm M rm M N M r , then divide the ‘frequency domain’ data symbol 
X into M groups with the m-th data symbol group denoted as 
[ ( ), ( 1 ), ( 2 ), ( ( 1) )]T mN Xm Xm M Xm M Xm M MX , the received signal r can be expressed by using the 
M symbol groups 10 {}MmmX  as  
1,1 / 1, / 0/ 02, 1 / 2, / 1 / 1
1/ 1 ,1 / , /
01 1[( ) ( ) ( ) ]H NM M NM NMH NM M NM NMHMN M M MN M M M N M ISI TT T TMII EF X II E F XEFX IIYrr r r H H YH YH YW (7) where  
2( 1)( 1),jp qMpq
e , 2( / 1 )2
(1, , , )mN M mjjNN m
diag e e E .  According to equation (7), the OFDM system can be equivalent as 
M subsystems, and the m-th subsystem is a new OFDM system with 
/NM subcarriers, data symbol mX and subcarrier spacing fMf , and experiences frequency offset of 
mf. Thus the IFFT modulated signal of the original OFDM system in each piece-period can be viewed as the weighted-sum of 
M OFDM subsystems’ symbols. Such intra-symbol piecewise OFDM system model for 
2M has been shown in Fig. 1. 35  Zhigang Chen et al.  /  AASRI Procedia   5  ( 2013 )  32 – 39 
 The first term and the second term in the right hand of equation (7) individually represents the M ‘symbols’ through the average channel and the linear time-varying channel in different piece-periods. The third term in the right hand of equation (7) represents the inter-symbol interference (ISI) of the OFDM subsystems owing to missing of cyclic-prefix between ne ighbouring symbols, which has also been shown in Fig. 1. Based on such intra-symbol piecewise OFDM system model, the original OFDM system’s complex ICI caused by the fast fading channel has been resolved as the subsystems’ simple ISI and lower ICI, respectively caused by the time average channel and time-varying channel in multiple piece-periods. In the following section, a novel successive intra-symbol piecewise ‘ISI’ and ‘ICI’ mitigation method will be proposed to equalize the fast fading channel.            
Fig. 1. Intra-symbol piecewise OFDM system model for 2 M  
3. Intra-symbol Piecewise Equalization Method 
Since we focus on the equalization of time-varying channel, AWGN will not be considered in the following description. For brevity, the intra-symbol piecewise equalization method for piece number 
2M will be described in detail first in this section, then such proposed method is generalized for piece number 
2pM .  The equalization for each data group 
mX is similar and composed of three steps: symbol modification, ‘ISI’ mitigation and ‘ICI’ mitigation. And the equalization for the 
m-th data group is introduced as following.  3.1. symbol modification First the received samples are modified as  
·HHNN m m N mr F BF G r HG F X HG Y                                                                                                 (8) where the frequency offset rotation matrix 
mG and modifying matrix B are NN  diagonal matrix with the 
n-th diagonal element 2/(,)jnm N m nn eG  and ( , ) [ ]( , ) / [ ]((( )) ,(( )) )HHNN NN N N nn nn n m n mBF H F F H F . From (7) and (8), it can be derived that  
00 1 1 00 1 /2 0 0 1 0 0 0 1 0100 1 00 1 01 1 /2 1 0 1 00 0 1
() () () [] [] []mm mm mm N jm jm jm mm mm mm NISIe e eFr D EXD E X D EXD E X DE X DE XDE X DE X Fr D EXD E X DE X DE XSig Sig Sig                                           (9) where 
/2 /2H
mmNNDF H F  , /2 /2HmNm N EF E F  , /2 /2H mNm N DF H F  , /2 /2()UT HmNN DFH F . For simplification, define the three  CP Generation OFDM  Symbol CP
0/ 2 0 1 rst New Symbol HNEF X0/ 2 0 2nd New Symbol HNEF X
1/ 2 1 2nd New Symbol HNEF X0/ 2 0 1 rst New Symbol HNEF XChannel Delay S
pread effects
+ + + 
Sub-OFDM-System 2 Sub-OFDM-System 1 CP CP 36   Zhigang Chen et al.  /  AASRI Procedia   5  ( 2013 )  32 – 39 
 terms in (9) as Sig , Sig and ISI
Sig respectively.  3.2. ‘ISI’ mitigation From (9), the 
m-th ‘ISI’ free data group estimate mX satisfies the following formula  
00 0 1 100 0 1 1
()[]mmjmmm
eDE X DE XDE X DE X Sig Sig                                                                                                             (10) By subsitituting (10) into (9), we have  
00 0 1 1 /2 000 0 1 1 /2 1
()[]mm N jmmm NISIeDE X DE X FrFr DE X DE X Sig                                                                                                       (11) From (11), the ‘ISI’ free data symbol estimate 
mX can be further approximated as  
11/0 1{( ) }Mmm NM mm
MXD F r                                                                                                                   (12) with estimate error 
1100 1 1 1 01 [( ) ( ) ][(1 ) (1 ) ]jm jm mm mee Err D D D D E X E X . Thanks to the sparsity of matrix 
mD and 1100 1 1() ()DD DD , the estimate error mErr of the m-th ‘ISI’ free data group is trivial and negligible.  3.3.  ICI mitigation Based on the obtained ‘ISI’ free data symbol es timate, the ‘ICI’ free data symbol estimate 
mX can be further derived from (10).  
11 1100 1 1 00 1 1 ( 1 , 2 )01 0111[( ) ( ) ] [( ) ( ) ]22
mm m o d mXD D D D D D X D D D D D D X                  (13) Considering that time variation matrix 
mD is much ‘smaller’ than mD with a sufficient large piece number M, the approximation 
111 1( ) () () () mm m mmmDD D D D D  can be obtained from matrix theory.  By substituting the approximation above into (13), the ‘ICI’ free data symbol estimate 
mX is finally obtained.  
110 1{( ) }Mmm m mm
MXX DD X                                                                                                        (14) Until all the 
2 M  data groups have been estimated through the steps above, the equalized data symbol can be finally obtained by permutating the data groups estimate 
10 {}MmmX .  The abovementioned intra-symbol piecewise equalization method for 
2 M  can be directly generalized for 
2pM  , and the equalization steps: symbol modification, ‘ISI’ mitigation and ‘ICI’ mitigation for the m-th data group are described as (8), (12) and (14) respectively. 37  Zhigang Chen et al.  /  AASRI Procedia   5  ( 2013 )  32 – 39 
 4. Complexity Analysis 
The equalization complexity is evaluated in terms of complex additions (CA), complex multiplications (CM), and complex divisions (CD). According to (8), (12)  and (14), the steps of the proposed method mainly includes FFT, IFFT and matrix-vector multiplications. Owing to the property of the cyclic toeplitz matrix, 
//H mmNMN M DF H F  is a diagonal matrix with diagonal element vector /(( 1 , : ) )TmNM FH , and the matrix mD can be expressed in matrix form from (5)  
// / /2* ( 0 : (/ 1 ) )() ( , / )2
mHH mN M N M N M m N MMN M Ndiag N MN
DDF F F C S H I F T F  where 
mD is also a diagonal matrix with diagonal element vector /()TmNM Fh . Hence the matrix-vector multiplication involved in (8), (12) and (14) can be simplified as diagonal matrix-vector multiplication and FFT/IFFT, which are both low complexity operations.  As the 
N-point IFFT/FFT operation require 2 /2Nl o g N  CM and 2 Nlog N  CA, the three equalization steps on the 
m-th data symbol group mX have computation complexity of 2 2Nlog N  CA2(2 )Nl o gN  CM N CD, 
2[( / ) 1 ]Nl o g N M  CA2 0.5* ( / ) Nlog N M  CM N CD and 2 [2 ( / ) 1]Nl o gNM  CA2[( / ) 2 ]Nl o g N M  CM N CD respectively.  
Table 1. Complexity comparison  Proposed Equalization Banded Equalization 
M=2 M=4 Q=2 Q=4 
N=1024 100N 230N 140N 564N 
N=256 80N 184N 140N 564N 
N=64 60N 138N 140N 564N 
As a total, the proposed scheme requires22 {1 3 / 2 9 / 2 9 }Mlog N Mlog M M N   complex operations for piece number 
M, while the classical simple equalization scheme in [1] with banded factor Q requires a total of 
32(8 20 43/ 3 )/5 2QQ Q N  complex operation. Banded factor 2,4Q and piece number 2,4M is assumed in the following simulations that the two equalization sche mes not only have comparative complexity, but also achieve better trade-off between performance and complexity  in fast fading channels. For ease of comparison, the computation complexity of the two schemes for typi cal system parameters has been listed in Table 1. Among the listed typical parameter configuration cases the proposed method for 
2M can achieve the lowest complexity. 
5. Simulation Results 
In this section the uncoded BER performance is applied  to evaluate the performance of different equalizers. An OFDM system with 
256, 8,32NL , and QPSK modulation is supposed. Rayleigh fading channels with exponential power delay profile and maximum normalized Doppler frequency 
0.15,0.30df  is assumed in the simulations. For fair comparison, the proposed equalizer  and the banded equalizer [1] both have only the CSI at mid-time instant in each piece-period, and the complete CSI for the banded scheme is obtained by linear interpolation in each piece-period.  From Fig. 2, the proposed scheme achieved sligh tly worse performance than the banded scheme for 
0.15df  case, while achieved better performance for 0.30df  case, since the ICI energy outside Q banded neighbouring subcarriers can not be negligible in fa st fading channels, while the proposed scheme can 38   Zhigang Chen et al.  /  AASRI Procedia   5  ( 2013 )  32 – 39 
 efficiently mitigate the much lower ‘ICI’ caused by time-varying channel in each piece-period. But the proposed scheme is more susceptible to the multipath length increase than the banded one, since the ‘ISI’ mitigation of the proposed scheme is dependent on  the multipath length. The proposed scheme performs better for 
4M than for 2M only in 8, 0.30d Lf  case, since the ’ISI’ dominates the equalization performance for lower Doppler spread cases or big delay spread cases.  
6. Conclusions 
We have proposed an intra-symbol piecewise equalizer for OFDM systems over fast time-varying multipath channels. By using the intra-symbol piecewise OFDM system model and the characteristics of channel matrix, the equalization against fast fading channels can be realized through the successive `ISI' and `ICI' mitigation with complexity of 
22 {1 3 / 2 9 / 2 9 }Mlog N Mlog M M N . We have shown the proposed scheme has lower computation complexity than the comparative one, while perserving good performance especially in fast fading channels with small delay spread.  
0 5 10 15 20 25 3010−310−210−1100
SNRBER
  
L=8L=32fd=0.15fd=0.30
Subpieced scheme M=4
Subpieced scheme M=2
Banded scheme Q=4
Banded scheme Q=2
 
Fig. 2. BER comparison between the proposed  scheme and banded scheme for 0.15,0.30df  
Acknowledgements 
This work was supported by the National Natural Science Foundation of China by Grant 60902045 and Major National Wireless Broadband Mobile Communicat ions Project of China under Grant 2010ZX03003- 004-01. 
Corresponding Author 
Corresponding author: Lei Wang, lei.wang@mail.x jtu.edu.cn, and Mobile Telephone 13991944880 
References 
[1] L. Rugini, P. Banelli and G. Leus. Simple equalization of time-varying channels for OFDM.  IEEE Comm. Letters, vol. 9, no. 7, pp. 619-921, Jul. 2005.  [2] Y. Mostofi and D. Cox. ICI mitigation for pilot-aided OFDM mobile systems.  IEEE Trans. Wireless 39  Zhigang Chen et al.  /  AASRI Procedia   5  ( 2013 )  32 – 39 
 Commun., vol. 4, no. 2, pp. 765-774, Mar. 2005.  [3] P. Schniter. Low-complexity equalization of OFDM in doubly selective channels.  IEEE Trans. Signal Processing, vol. 52, pp. 1002-1011, Apr. 2004.  [4] S. Feng, H. Minn, L. Yan and L. Jinhui. PIC-ba sed iterative SDR detector for OFDM Systems in doubly- selective fading channels.  IEEE Trans. Wireless Comm., vol. 9, no. 1, Jan. 2010.  [5] E. Panayrc, H. Senol and H. V. Poor. Joint channel estimation, equalization, and data detection for OFDM systems in the presence of very high mobility.  IEEE Trans. Signal Processing, vol. 58, no. 8, pp. 4225-4238, Aug. 2010.  [6] T. Hrycak, S. Das, G. Matz and H. G. Feichtinger. Low complexity equalization for doubly selective channels modeled by a basis expansion.  IEEE Trans. Signal Processing, vol.58, no.11, pp. 5706-5719, Nov. 2010.   