Nondestructive determining the soluble solids content of citrus usingnear infrared transmittance technology combined with the variableselection algorithm
Xi Tiana,b,J i a n g b oL ib, Shilai Yic, Guoqiang Jind,X i a o y i n gQ i ue, Yongjie Lid,⁎
aCollege of Information and Electrical Engineering, China Agricultural University, Beijing 100083, China
bBeijing Research Center of Intelligent Equipment for Agriculture, Beijing 100097, China
cCitrus Research Institute, Southwest University, Chongqing 400712, China
dCo-innovation Center of Citrus Industrial Technology in Linhai, Linhai 31700, China
eStation of Popularizing Speciality Technology in Linhai, Linhai 31700, China
abstract article info
Article history:Received 22 April 2020Received in revised form 6 May 2020Accepted 6 May 2020Available online 11 May 2020
Keywords:Full transmittance spectrumSpectral preprocessingThick-skin fruitsSoluble solids contentVariable selection algorithmNondestructive determination the internal quality of thick-skin fruits has always been a challenge. In order to in-vestigate the prediction ability of full transmittance mode on the soluble solid content (SSC) in thick-skin fruits,the full transmittance spectra of citrus were collected using a visible/near infrared (Vis/NIR) portable spectro-graph (550–1100 nm). Three obvious absorption peaks were found at 710, 810 and 915 nm in the original spectracurve. Four spectral preprocessing methods including Smoothing, multiplicative scatter correction (MSC), stan-dard normal variate (SNV) andﬁrst derivative were employed to improve the quality of the original spectra. Sub-sequently, the effective wavelengths of SSC were selected from the original and pretreated spectra with thealgorithms of successive projections algorithm (SPA), competitive adaptive reweighted sampling (CARS) and ge-netic algorithm (GA). Finally, the prediction models of SSC were established based on the full wavelengths andeffective wavelengths. Results showed that SPA performed the best performance on eliminating the useless infor-mation variable and optimizing the number of effective variables. The optimal prediction model was establishedbased on 10 characteristic variables selected from the spectra pretreated by SNV with the algorithm of SPA, withthe correlation coefﬁcient, root mean square error, and residual predictive deviation for prediction set being0.9165, 0.5684°Brix and 2.5120, respectively. Overall, the full transmittance mode was feasible to predict the in-ternal quality of thick-skin fruits, like citrus. Additionally, the combination of spectral preprocessing with a var-iable selection algorithm was effective for developing the reliable prediction model. The conclusions of this studyalso provide an alternative method for fast and real-time detection of the internal quality of thick-skin fruits usingVis/NIR spectroscopy.© 2020 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/4.0/ ).
1. IntroductionFruits quality characteristics, including external quality (such ascolor, size, and shape) and internal quality (such as soluble solids, titrat-able acid, andﬁrmness), are the basic factors affecting the consumers'desire of purchasing (Nghia et al., 2014). Nowadays, consumers' pursuit of fruits quality is not only limited to external quality, but also extendsto internal quantity. Citrus is planted widely in the world for its high nu-trition and uniqueﬂavor. Soluble solids content (SSC) is one the mostcrucial internal attribute determining consumers' purchasing desirealso plays an important role in guiding orchard management. However,the traditional testing technology of SSC is destructive, time-consumingand high energy-consumption, which is not suitable for the demand offast and large amounts of fruits grading industry ( Ireri et al., 2019). Nondestructive testing technology has the advantages of real-time,low energy consumption and minimal sample preparation. In recentyears, it has been extensively studied and accepted as an effectivemethod for the detection of fruits maturity, shelf life, quality sorting,and even internal disease. In general, nondestructive testing technolo-gies include electronic nose (Brezmes et al., 2001;Saevels et al., 2003; Sanaeifar et al., 2014), visible/near infrared (Vis/NIR) spectroscopy(Sinelli et al., 2008;Tian et al., 2018;Li et al., 2020), ultrasonic sensing technique (Kim et al., 2009;Aboudaoud et al., 2012), machine vision sensing technique (Blasco et al., 2007;Elmasry et al., 2009; Lopezgarcia et al., 2010) and the fusion of multiple non-destructivesensing methods (Hong and Wang, 2014;Mendoza et al., 2012). TheArtiﬁcial Intelligence in Agriculture 4 (2020) 48 –57
⁎Corresponding author at: Co-innovation Center of Citrus Industrial Technology inLinhai, 219
#dongfang avenue, Linhai 31700, China.E-mail address:lyonjie@sina.com(Y. Li).
https://doi.org/10.1016/j.aiia.2020.05.0012589-7217/© 2020 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the C C BY-NC-ND license (http:// creativecommons.org/licenses/by-nc-nd/4.0/ ).
Contents lists available atScienceDirect
Artiﬁcial Intelligence in Agriculture
journal homepage:http://www.keaipublishing.com/en/journals/artificial-intelligence-in-agriculture/Vis/NIR spectroscopy technology provides a promising approach for thequality detection of agricultural products due to its low implementationcost, high detection accuracy, and fast detection speed.The Vis/NIR spectrum belongs to the high-energy vibrational spec-trum performed in the range of 400 –2500 nm. When Vis/NIR electro- magnetic radiation reaches the fruits, the difference of physicalfeatures (such as the skin thickness andﬁrmness) and internal chemical compositions (such as SSC and titratable acid) of fruits will perform var-ious absorption or reﬂection spectrum at a different wavelength(Pasquini, 2018). Generally, three different spectra acquisition modesincluding diffuse reﬂectance, interactive (or semi-transmittance), andfull transmittance modes are commonly used according to the differ-ence of optical property of tested fruits. The diffuse re ﬂectance spectrum is mainly associated with the superﬁcial layer within about 4 mm (Lammertyn et al., 2000), rather than the internal tissue of fruits. Addi-tionally, the specular reﬂection caused by the spherical shape of fruitscould easily interference with the reﬂectance spectra, resulting in a poor prediction model (Fu et al., 2007). Citrus belongs to thick-skin fruits, the spectra information collected from a super ﬁcial layer using diffuse reﬂectance mode mainly relates with citrus peel, which is indi-rectly related to theﬂesh tissue. The spectrograph and the lamp locateopposite both sides of the tested fruit for directly acquiring the internalcomponent information in full transmittance mode ( Cayuela, 2008). Therefore, the full transmittance mode may assist in getting a better re-sult for the prediction of SSC in thick-peel fruits ( Wang et al., 2014). Furthermore, citrus is a complicated natural product composed of agreat variation of external and internal structures, the SSC and skinthickness are signiﬁcant from proximal to distal of fruits, as well as thepeel color in sunlit and shaded also. Diffuse re ﬂectance spectrum is mainly collected from local position or super ﬁcial layer region, the non- uniform distribution of chemical components would weak the predic-tion accuracy of intact fruit. Hence the full transmittance mode canovercome the inhomogeneous condition to some extent through ac-quiring more internal tissue information. Dull and Birth (1989)argued that the peel in the light path would not change the fundamental de-pendencies between the spectrum data and chemical components.Therefore, full-transmittance mode maybe is a promising technologyfor the determination of SSC with high accuracy and robust in citrus.The Vis/NIR spectrum usually has hundreds or thousands of wave-lengths, the developed prediction model would be too complicated ifall spectra wavelengths are used directly. Moreover, some irrelevant in-formation with the target component exists in original variables, whichcould weaken the prediction ability of the developed model ( Wu et al., 2010;Xu et al., 2012). Thus, variable selection algorithms, such asMonte Carlo based uninformative variable elimination (MC-UVE), ge-netic algorithm (GA), competitive adaptive reweighted sampling(CARS), successive projection algorithm (SPA) and random frog (RF),are usually applied to extract effective variables from full wavelengths.Those‘uninformative’variables that cannot enhance the overall perfor-mance of the prediction model are eliminated, while those ‘informative’ variables that correlate to interested parameters are remained through
variable selection algorithm performing ( Pasquini, 2018).Fan et al. (2015)developed a better prediction model of SSC and ﬁrmness of pear based on the 46 and 41 variables selected from full variablesusing CARS method, respectively.Zhang et al. (2018)found the predic- tion model of sugar in pear built by effective wavelengths was fasterthan the full wavelength. In a word, the selected variables contributeto building a simpler and faster regression model by revealing the rela-tionship between the original spectra and the target property.The variable selection methods have been widely applied to predictthe internal quality of thin-skin fruits such as pears ( Fan et al., 2015; Zhang et al., 2018) and apples (Tian et al., 2019;Zhang et al., 2019), but there have been few reports on thick-skin fruits such as citrus. Thethicker skin and complex structure of citrus interfere with the light ra-diation to acquire the information of internal tissue, and increase thedifﬁculty of effective variables selection and prediction modeldevelopment, resulting in the internal quality prediction of intact citrusdeveloped slowly (Krivoshiev et al., 2000;Fraser et al., 2003). Therefore, the speciﬁc objectives of this study were to: (1) investigate the feasibil-ity of full transmittance mode on the prediction of SSC in thick-skinfruits; (2) compare the performance of different spectral preprocessingmethods; (3) analyze the distribution of effective variables selected bydifferent variable selection algorithms; (4) compare the accuracy of pre-diction models built by the combination of different spectral prepro-cessing methods and variable selection algorithms.2. Material and methods2.1. Sample preparationA total of 224‘Gannan’navel orange fruit without any apparent de-fects were purchased from a local fruit supermarket in Beijing, China.Then all the samples were stored in the laboratory within 24 h at21 °C and relative humidity of 65% to reduce the effect of temperatureon the prediction results (Li et al., 2020). Kennard-Stone is the most widely used algorithm for sample assignation due to its excellent per-formance of ensuring the representativeness of calibration and predic-tion sets (Barbin et al., 2013;Fan et al., 2016). Therefore, a subset of 168 samples was selected as calibration set for developing the calibra-tion model, and the remaining 56 were used as prediction set to verifythe performance of developed model according to a proportion of 3:1with the algorithm of Kennard-Stone, respectively.2.2. Spectra collectionThe transmittance spectra of citrus were collected using a commer-cial Vis/NIR portable spectrophotometer covering 550-1100 nm with aninterval of 0.45 nm (AvaSpec-ULS2048XL-EVO, Inc., Apeldoorn,Netherlands). The optimal integration time was set at 10 ms forobtaining appropriate spectral intensity. The sample was placed manu-ally on the platform between the spectrometer and the light source withthe orientation of the stem-calyx axis vertical ( Fig. 1), three separate spectra were measured around the equator (120°) for each fruit. There-fore, a total of 672 transmittance spectra were collected from equatorpositions for 224 fruit.2.3. Quality attributesAfter spectra collecting, SSC of each fruit was measured immediatelyusing the traditional destructive method. The juice was squeezed fromthe overall fruit and then dropped 1 ml onto the fruit sugar refractome-ter (PAL-1, ATAGO, Japan) after stirring.
HalogenlampPlatformSpectrographSampleShield
Fig. 1.The schematic of full transmittance spectra measurement system.49 X. Tian et al. / Artiﬁcial Intelligence in Agriculture 4 (2020) 48 –572.4. Spectral data preprocessingSome irrelevant information including noise, baseline translationand stray light caused by instrument or external environment affectsthe identiﬁcation of valuable spectra information in the process ofmodeling (Liu et al., 2010;Zhang et al., 2019). Spectra preprocessing methods are helpful to develop a reliable and robust model by eliminat-ing the disturbances of irrelevant information ( Magwaza et al., 2012). Therefore, four kinds of spectra preprocessing methods, includingSmoothing (9 points), multiplicative scatter correction (MSC), standardnormal variate (SNV), and theﬁrst derivative was used to process theoriginal spectra data. The Smoothing could eliminate random noise orhigh-frequency random error to improve the signal-to-noise ratio.MSC was designed to separate scattering spectral signals from chemicalinformation in the original spectra using mathematical methods. SNVwas usually used to eliminate the effect of solid particle size and opticalpath change in the original spectra (Barnes et al., 1989),ﬁrst derivative was effective for reducing baseline shifts and superposed peaks ( Tian et al., 2018). The spectra preprocessing procedure was performed inthe Unscramblerv 9.7 (CAMO PROCESS AS, Oslo, Norway).2.5. Effective variable selectionEffective variable extraction can decrease spectral dimension andsimplify the process of modeling, additionally, the relationship betweenthe selected variable and the interested parameters also can be clearlyexplained. In this study, three variable selection algorithms includingSPA, CARS, and GA were employed to select the effective wavelengthof SSC of citrus from full wavelengths.SPA starts from one wavelength and calculates its projection ontothe unselected wavelength in each cycle. The wavelength correspond-ing to the maximum projection value is considered to be the initialvalue of the next cycle until the number of wavelengths set. The newvariable selected by SPA is the maximum projected value of the previ-ously selected variable. The SPA is employed to obtain these variableswith small collinearity and the minimum redundant information, thenumber of variables used in modeling is greatly reduced, and the accu-racy and speed of the prediction model are improved ( Liu et al., 2014). In the process of variable optimization, different MLR calibration modelsare established based on different variable subsets. The variable subsetwith the lowest value of root mean-square error of cross validation(RMSECV) will be considered as the optimal variables. More details onthe steps involved in SPA application can be found in previous studies(Araújo et al., 2001;Galvão et al., 2008).CARS is a novel algorithm proposed by Li et al. (2009), in order to re- tain the wavelength variables with a large absolute value of regressioncoefﬁcient in the PLS model, CARS employs the adaptive weighted sam-pling technique to evaluate the importance of each variable, N variablesubsets are obtained through repeated screening, ﬁnally, the variables closely related to the measured components are extracted after crossvalidation for each variable subset. According to the importance levelof each wavelength, the Monte Carlo (MC) sampling is used to ran-domly selectNsample subsets with the principle of iterative and com-petitive for developingNPLS calibration modes, and the variablesubsets with the lowest RMSECV are deﬁned as the key variables. As a new variable selection method, the CARS performs better when dealingsimultaneously with uninformative and collinear variables ( Zhang et al., 2018). Details of the CARS methodology could be referred to the previ-ous literature (Li et al., 2009;Wu and Sun, 2013). GA is an adaptive global optimization search algorithm developed bynatural selection and evolution, which realizes the recombination anditerative optimization of individual structures in a population throughcrossover, selection, and variation. When the iteration is completed,the frequency selected by the wavelength variable is modeled one byone from high to low. The detailed process of the GA procedure is avail-able in the study of
Leardi and Gonzalez (1998). GA has beensuccessfully used for multivariate correction analysis, such as GA-PLS(Andersen and Bro, 2010), GA-least squares support vector machine(LS-SVM) and GA-artiﬁcial neural network (ANN) (Zhang et al., 2018) indicating that GA is useful for effective variable screening and adaptto different modeling techniques.2.6. Multivariate model developingThe linear PLS model is the most widely applied and robust algo-rithm for its insensitive to collinear variables and tolerant to large num-bers of variables. PLS could explain the correlation between the originalspectrum and the target properties using the no more than 20 latentvariables (LVs) extracted from the original wavelength, so it is com-monly employed to analyze the internal content of fruit. In this research,the PLS models were developed based on the full wavelengths spectraand the effective variables selected by SPA, CARS, and GA, then the per-formance of all developed models was compared for evaluating the fea-sibility of full transmittance model on the prediction of SSC in thick-skinfruits. The root mean square error of calibration set (RMSEC) and pre-diction set (RMSEP), the correlation coefﬁcient of calibration set (Rcal) and prediction set (R
pre), were selected as the evaluation parametersfor these PLS models. A good prediction model should have a higherR
caland R pre, and a lower RMSEC and RMSEP. The higher the R preand the smaller the RMSEP, the stronger the prediction ability of themodel is. The residual predictive deviation (RPD) also was introducedto further evaluate the performance of the prediction results. RPD isthe standard deviation of the predicted sample reference data dividedby the predicted standard error (SEP), which provides the standardiza-tion for SEP. Generally, the RPD value is divided into three levels to de-ﬁne the performance of prediction models, 1.5 to 2 indicates that themodel can distinguish high or low values of the target variable, 2 to2.5means that rough quantitative prediction can be made, and an excel-lent prediction accuracy would occur on 2.5 to 3 or above ( Li et al., 2014a).3. Results and discussion3.1. SSC of sampleTable 1shows the overview of SSC for 224 samples, it could be seenthat the SSC ranges were 7.00 to 14.6°Brix and 7.80 to 13.00°Brix withstandard deviations (S.D.) of 1.50 and 1.45°Brix for calibration and theprediction sets, respectively. It is worth noting that the range of calibra-tion set was wider than prediction set, which is helpful to build a robustmodel for SSC prediction of citrus fruit.3.2. Spectral features and preprocessingOnly the spectral range of 600 –1000 nm (928 bands) was used tobuild prediction model in this study due to the lower signal to noiseratio below 600 nm and up 1000 nm. The mean value of three spectrameasured from the same one fruit is used as the transmittance spec-trum of each fruit. The transmittance spectra of all 224 fruits areshown inFig. 2. Three signiﬁcant absorption peaks around 710, 810,and 915 nm are found from original transmittance spectra, respectively.710 nm is well known as the red spectral region associated with
Table 1Statistic results of SSC (°Brix) in different data sets.Data sets No. of samples Min. Max. Mean S.D.Calibration set 168 7.00 14.60 10.57 1.50Prediction set 56 7.80 13.00 10.42 1.45Total 224 7.00 14.60 10.53 1.4750 X. Tian et al. / Artiﬁcial Intelligence in Agriculture 4 (2020) 48 –57maturity, which can be used to determine the chlorophyll content offruit (Zude-Sasse et al., 2002). Water is the major component of citrus,810 nm is mostly triggered by the third overtone stretch of O \\Hi n water (Martinsen and Schaare, 1998). 915 nm is mostly related to thethird overtones of C\\H in sugar (Guthrie et al., 2005). The absorbance spectrum stayed relativelyﬂat in the range of 680–910 nm for diffuse reﬂectance mode of citrus (Gómez et al., 2006;Wang et al., 2014), how- ever, three absorption peaks were found around 710, 810 and 915 nm intransmittance spectrum of citrus, which were less reported. Therefore,these characteristic peaks may contribute to predict the internal qualityof citrus fruit.Four kinds of preprocessing methods including Smoothing, MSC,SNV, andﬁrst derivative were applied in this research. It could befound fromFig. 2, the spectra curves treated by MSC and SNV weremoreﬂat than the original and other preprocessed spectra. MSC andSNV were effective to highlight the peak and valley of the spectra pro ﬁle and balance the distribution of variables by correcting the difference ofoptical path. However, the Smoothing method had no signi ﬁcant effect on noise reduction, and theﬁrst derivative method seems to greatly am-plify the noise. In conclusion, MSC and SNV performed better on noisereduction and simultaneously emphasized the spectral feature, bothmethods might be optimal for improving the transmittance spectralquality of citrus.3.3. Prediction models build by full wavelengthTable 2shows the performance of prediction models based on fullwavelengths data of original and processed spectra. It could be seen(a) (b) 
(c) (d) 
(e) 600 700 800 900 10000123456x 104
Wavelength (nm)ytisnetnI
600 700 800 900 10000123456x 104
Wavelength (nm)ytisnetnI
600 700 800 900 1000-101234x 104
Wavelength (nm)ytisnetnI
600 700 800 900 1000-2-1012
Wavelength (nm)ytisnetnI
600 700 800 900 1000-200-1000100200300
Wavelength (nm)ytisnetnI
Fig. 2.The original spectra (a) and preprocessed spectra of Smoothing (b), MSC (c), SNV (d) and ﬁrst derivative (e).51 X. Tian et al. / Artiﬁcial Intelligence in Agriculture 4 (2020) 48 –57that the Smoothing had no signiﬁcant difference with original spectrabecause their latent variables (LVs), R
pre, RMSEP and RPD values were close, indicating that Smoothing unable to remove undesirable signalinterference in original spectra. Theﬁrst derivative is not applicable to preprocess the original transmittance spectra of citrus, because the per-formance turned worse than the original spectra, the result was similartoLiu et al. (2010)andLiu et al. (2015). The best performance of the prediction model was derived from the pretreated spectra of SNV withR
preof 0.9215, RMSEP of 0.5546°Brix, and RPD of 2.5746, respectively.The closer RMSEC and RMSEP value, the more stable the model is. Theabsolute difference between RMSEC and RMSEP were 0.0008 and0.0042°Brix for the prediction models built by pretreated spectra ofSNV and MSC, respectively, which were smaller than that of originaland other pretreated spectra, suggesting that the method of SNV orMSC could signiﬁcantly improve the robustness of the predictionmodel. Overall, SNV performed the best performance on eliminating un-desirable interference of original spectra and obtained the best modelfor predicting SSC of citrus fruit.3.4. Prediction models build by effective variablesTo simplify the prediction model and improve the prediction speed,three variable selection algorithms including SPA, CARS, and GA wereapplied to select the effective wavelength of SSC from full wavelengths.Taking spectra pretreated by smooth to describe detail the procedure ofvariable selection of SPA, CARS, and GA.3.4.1. Effective variable selection of SPAFig. 3a shows the curves of the RMSECV changing with the numberof selected variables in the SPA. The RMSECV value reduced rapidlyﬁrstly and then gradually decreased with the growth of selected vari-ables. When the RMSECV obtained the optimal value, 16 variableswere selected to predict the SSC of citrus (marked in an open redsquare).Fig. 3b shows the distribution map of the 16 selected variables(marked in an open red square), included 622.62, 648.53, 664.53,676.94, 706.92, 732.34, 746.74, 758.92, 787.07, 813.76, 831.76, 847.13,878.16, 906.47, 964.72 and 981.37 nm. It could be found that the 16 se-lected variables almost evenly distributed in the range of 600 –1000 nm. It was worth noting that half of the variables belonged to the Vis region(400–780 nm), indicating that the color variances was helpful to evalu-ate the SSC in citrus accurately, the result agreed with previous studiesfor apple (Tian et al., 2019) and pear (Li et al., 2014a). Comparing the distribution of effective variables selected by different preprocessingmethods inFig. 6(vertical solid red lines), 17, 22, 10 and 25 effectivevariables were selected as effective variables from full wavelengths(928 bands) for original, MSC, SNV andﬁrst derivative spectra, respec- tively. The number of effective variables varying with the difference ofpreprocessing methods, proving that the spectral preprocessing has asigniﬁcant inﬂuence on the results of variable selection.3.4.2. Effective variable selection of CARSBefore the CARS operating, the number of Monte Carlo samplingruns was set to 50 and the 10-fold cross validation was used to choosethe optimal variable for SSC prediction ( Fan et al., 2015). It could be seen fromFig. 4a, the number of sampled variables decreases sharplyat an exponential rate with the number increasing of sampling runsﬁrstly. Subsequently, the selection speed of sampled variables graduallyslows down when the number of sampling runs reaches 15 (marked inan open red square), which reﬂects the process from rough selection toﬁne selection in the CARS algorithm.Fig. 4b shows the transformation trends of RMSECV value with the sampling runs, further describingthe elimination procedure of useless variables. The RMSECV value ﬁrstly reduces signiﬁcantly due to the elimination of useless variables andthen increases with the loss of some characteristic wavelengths of SSC.The RMSECV reaches the minimum or optimal value when the samplingruns are 15.Fig. 4c shows the regression coefﬁcient path of PLS model- ing for each variable, each line records the change of regression coef ﬁ- cient at different sampling runs. These variables with a larger absolutecoefﬁcient would be selected from each sampling runs to form a subsetthat is also considered as the subset of effective wavelengths (marked
by the vertical blue star line). Finally, 161 characteristic variables wereextracted from the full wavelengths and would be set as the inputs toTable 2Results of the prediction models based on the full wavelengths spectra pretreated by dif-ferent methods.PretreatmentmethodsLVs Calibration set Prediction setR
cal RMSEC(°Brix)R pre RMSEP(°Brix)RPDNone 12 0.9105 0.7609 0.9034 0.6163 2.3169Smoothing 12 0.9088 0.7613 0.9033 0.6168 2.3148MSC 13 0.9439 0.5924 0.9089 0.5966 2.3935SNV 14 0.9523 0.5554 0.9215 0.5546 2.5746Firstderivative9 0.9062 0.7871 0.8518 0.7419 1.9248
Fig. 3.RMSEP plot (a) and the distribution map of selected variables (b) in SPA algorithm.52 X. Tian et al. / Artiﬁcial Intelligence in Agriculture 4 (2020) 48 –57develop the model of citrus SSC, which accounted for 17.3% of the 928bands.The same procedure also was applied to the original and otherpretreated spectra. 97, 125, 97 and 110 bands were selected as effectivewavelengths for the original, Smoothing, MSC, SNV and ﬁrst derivativespectra, and the distribution of these selected bands are marked bythe vertical solid blue lines below the curves in Fig. 6. The number of the selected variable by CARS was signiﬁcantly larger than that of SPA, which mainly caused by the difference of principle within different var-iable selection algorithms.3.4.3. Effective variable selection of GAThe parameter of GA was set as follows before calculation: the initialpopulation size was 50, 5 variables as the chromosome, the crossoverprobability was 0.5, and the variation probability was 0.01, the back-ward progressive iteration times was 100 ( Zhang et al., 2018). During the implementation process of the GA, due to the randomness of the se-lection of the initial population, the selection of genetic operators, thecrossover and mutation process, those variables selected at high fre-quency would have a certain consistency. Fig. 5shows the selected fre- quency for each variable after 100 runs, the variables selected more thantwo times would be considered as the effective wavelength to build theprediction models, therefore 170 variables were selected by GA for thespectra pretreated by Smoothing, which accounted for 18.3% of thefull wavelengths. 181, 194, 198, and 141 bands were selected as effec-tive wavelengths for the original, MSC, SNV and ﬁrst derivative spectra, and their distribution maps (marked by the black dots on the spectrumcurve) can be seen inFig. 6. It was worth mentioning that the selectedbands by GA almost uniformly distributed throughout the range of600–1000 nm.Comparing the results of different variable selection methods, thenumber of variables selected by SPA was signi ﬁcantly lower than CARS and GA. The distribution of selected variables varied with the dif-ference of variable selection algorithms. The difference in size and distri-bution of selected variables is mainly caused by the difference in theselecting mechanism of algorithms and the collinearity of pretreatedspectra (Li et al., 2014b). SPA is designed to obtain variables withsmall collinearity preferentially, caused the number and correlation ofselected variables to be less and lower, respectively. CARS was ﬁrstly used to eliminate the uninformative variables existed in full spectra(Fan et al., 2015), however, GA is an algorithm performing the searchingprinciple of random and global, it still carries out the global search foravoiding local minimization in the later iteration period, leading tosome redundancy variables were often included in the optimal subset(Durand et al., 2007).3.4.4. Prediction models built by effective wavelengthIn order to evaluate the performance of the effective variables se-lected by SPA, CARS, and GA, the selected variables were used to develop
.....................................................................................................
................. (15,161) ............... 
Fig. 4.Changing trend of the number of sampled wavelengths (a), 10-fold RMSECV values(b) and regression coefﬁcients of each wavelength (c) with the increasing of samplingruns. The line (marked by red dot) denotes the optimal point where 10-fold RMSECVvalues are the lowest (161 bands were selected when the number of sampling runsreaches 15).
Fig. 5.Frequency of variable selection after 100 runs by GA algorithm.53 X. Tian et al. / Artiﬁcial Intelligence in Agriculture 4 (2020) 48 –57the prediction models andTable 3shows the performance of all devel-oped models. Comparing with the CARS or GA, the variables selectedby SPA performed the best performance for almost all models exceptthe spectra pretreated byﬁrst derivative. The SNV-SPA performs bestbased on only 10 characteristic variables with R
preof 0.9165, RMSEP of 0.5684°Brix, and RPD of 2.5120, respectively. It is also worth notingthat models developed by SNV-GA also gave an acceptable accuracyconsidering the R
pre, RMSEP and RPD were 0.9164, 0.5776°Brix and2.4271, but 198 characteristic variables were selected as inputs. It indi-cated that GA could well extract the useful informative from the spectrapretreated by SNV, to build a better prediction model. The variables se-lected by CARS yielded worst prediction results, and the differencebetween RMSEC and RMSEP also was greater than that of SPA and GA,indicating that some redundant and uninformative variables were stillretained in the effective spectra selected by CARS.In the models built by full wavelengths, the best performance wasderived from the pretreated spectra of SNV with Rpreof 0.9215, RMSEP of 0.5546°Brix and RPD of 2.5746, respectively. Although themodel built by the SNV-SPA (R
pre= 0.9165, RMSEP = 0.5684°Brix,RPD = 2.5120) was slightly inferior to the full wavelengths model, thenumber of characteristic variables of the SNV-SPA model decrease by98.9%. Therefore, the elimination of redundant information can reducethe complexity and increase the performing speed while maintainingthe determination accuracy. The scatter plots of measured versus(a) (b) 
(c) (d) 
(e) 600 700 800 900 100001234x 104
Wavelength (nm)ytisnetnI
600 700 800 900 100001234x 104
Wavelength (nm)ytisnetnI
600 700 800 900 100001234x 104
Wavelength (nm)ytisnetnI
600 700 800 900 1000-2-10123
Wavelength (nm)ytisnetnI
600 700 800 900 1000-200-1000100200
Wavelength (nm)ytisnetnI
Fig. 6.The distribution of effective variables selected by SPA, CARS and GA algorithms based on original (a), smoothing (b), MSC (c), SNV (d) and ﬁrst derivative (e) spectra. SPA;
CARS;–□–GA.54 X. Tian et al. / Artiﬁcial Intelligence in Agriculture 4 (2020) 48 –57predicted SSC are shown inFig. 7, the point are evenly and closelyaligned along the line and the difference between RMSEC and RMSEPalso is very smaller.Wang and Xie (2014)developed SSC prediction model of ‘Tangelo’ citrus and achieved the performance of R
pre= 0.893, RMSEP = 0.436°Brix based on the GA–SPA–MLR model, which was slightly infe-rior to this study. On the other hand, the previous results achieved bydiffuse reﬂectance mode were R
pre= 0.946, RMSEP = 0.308°Brix andRPD = 2.94 for grapefruit (Ncama et al., 2017), wereR=0 . 7 4 2 ,S E C V= 0.74°Brix, and RPD = 1.49 for ‘Clemevilla’mandarin (Cavaco et al., 2018), were R
pre= 0.87, RMSEP = 0.47°Brix, and RPD = 2.34 for‘Gannan’navel orange (Liu et al., 2010), were R
pre= 0.858, RMSEP = 0.7113°Brix, RPD = 1.95 for‘Nanfeng’mandarin (Zhang et al., 2011). The performance of full transmittance mode achieved by this studywas slightly superior or similar to those modes established by diffuse re-ﬂectance mode, proving the transmittance mode was feasible to deter-minate SSC of citrus.The best prediction model of SNV-SPA-PLS were built based on 10effective variables including 685.34, 705.61, 733.21, 750.66, 787.07,811.61, 892.55, 955.13, 968.47 and 983.03 nm. The 685.34, 705.61 nmare associated with the red spectrum region, the color difference is con-sidered to be indirect and important indicators of fruit ripeness ( Gómez et al., 2006). The 733.21 and 750.66 nm belong to the third overtone ofO\\H and the fourth overtone of C\\H stretching (Wang et al., 2014). The 787.07 and 811.61 nm are covered by the range of 760 –850 nm, which are mostly associated with O\\H functional groups of water (Martinsen and Schaare, 1998), both 787 nm (Cavaco et al., 2018;Wang and Xie, 2014)a n d8 1 1n m(Li et al., 2014a) also were reported as important variables to predict fruit quality and yielded good perfor-mance. It is worth noting that 810 nm is one of the absorption peak ofthe original transmittance spectrum, its adjacent band (811.61 nm)was selected as an effective band by SPA, simultaneously. Therefore,the effective variables selected by SPA are closely related to water andcarbohydrate in navel orange fruit, which helped to explain the relation-ship between the developed model and SSC parameter.SPA was considered as the best variable selection algorithm in thisstudy, which may be contradictory to previous reports. The differencein spectral acquisition mode and the fruits variety may contribute tothis result. Although variable selection algorithm can eliminate mostof the noise, interference and useless information of the spectra, spectralpreprocessing is still the powerful tool to eliminate spectral differencescaused by optical path changes between samples, to correct scatteringdifferences caused by various sizes of particle, and to improve SNR (Sig-nal Noise Ratio). Therefore the combination of spectral preprocessingwith a variable selection algorithm will be the indispensable link inthe analysis of Vis/NIR spectroscopy.4. ConclusionThe full transmittance spectra of citrus were collected using a Vis/NIR portable spectrograph (550 –1100 nm) to investigate the feasibilityof full transmittance mode on the prediction of SSC in thick-skin fruits.Four kinds of spectral preprocessing methods including Smoothing,MSC, SNV, andﬁrst derivative were employed to improve the qualityTable 3Results of the prediction models based on effective bands selected by different algorithms.Variable selection algorithms Pretreatment methods LVs No. of selected bands Calibration set Prediction setR
cal RMSEC (°Brix) R pre RMSEP (°Brix) RPDSPA None 14 17 0.8963 0.7845 0.9162 0.5770 2.4747 Smoothing 13 16 0.8971 0.7683 0.9148 0.5802 2.4612MSC 14 22 0.9355 0.6048 0.8988 0.6211 2.2990SNV 10 10 0.9133 0.6468 0.9165 0.5684 2.5120First derivative 8 25 0.8774 0.7835 0.8494 0.7529 1.8964 CARS None 15 97 0.9749 0.4989 0.8279 0.8220 1.7371 Smoothing 15 161 0.9524 0.6254 0.8108 0.8559 1.6682MSC 14 125 0.9797 0.4540 0.8635 0.7599 1.8790SNV 14 97 0.9817 0.3888 0.8526 0.7894 1.8088First derivative 15 110 0.9924 0.3409 0.7895 0.9608 1.4861 GA None 14 181 0.9186 0.7657 0.8947 0.6433 2.2196 Smoothing 12 170 0.8981 0.7869 0.8536 0.7401 1.9292MSC 13 194 0.9438 0.5955 0.9053 0.6112 2.3364SNV 14 198 0.9508 0.5733 0.9164 0.5776 2.4721First derivative 11 141 0.9239 0.8023 0.8643 0.7168 1.9920The boldfaced line represents the optimal model for SSC prediction of citrus.
7 8 9 10 11 12 13 147891011121314
Measured SSC (°Brix))xirB°( CSS detciderP
Calibration data
Prediction dataRcal=0.9523RMSEC=0.5554R
pre=0.9215RMSEP=0.5546RPD=2.5746
7 8 9 10 11 12 13 147891011121314
Measured SSC (°Brix))xirB°( CSS detciderP
Calibration data
Prediction dataRcal=0.9133  RMSEC=0.6468R
pre=0.9165  RMSEP=0.5684RPD=2.5120
Fig. 7.The scatter plots of measured and predicted SSC based on the full wavelength preprocessed by SNV (a) and the effective variables selected by SPA (b).55 X. Tian et al. / Artiﬁcial Intelligence in Agriculture 4 (2020) 48 –57of original spectra. Subsequently, the effective wavelengths of SSC wereselected from the original and pretreated spectra with the algorithms ofSPA, CARS, and GA. Finally, the prediction model of SSC was constructedbased on full wavelengths and effective wavelengths. The resultsshowed that the SPA performed best on eliminating the useless infor-mation variable and optimizing the number of effective variables. Theoptimal prediction model was established based on the 10 characteristicvariables selected from the spectra pretreated by SNV with the algo-rithm of SPA, with R
preof 0.9165, RMSEP of 0.5684°Brix, and RPD of2.5120 respectively. Overall, the full transmittance mode was feasibleto predict the internal quality of thick-skin fruits, like citrus. Addition-ally, the combination of spectral preprocessing with a variable selectionalgorithm was effective for developing a reliable prediction model. Theconclusions of this study also provide an alternative method for fast andreal-time detection of the internal quality of thick-skin fruits using Vis/NIR spectroscopy.FundingThis study was supported by National Key Research and Develop-ment Program (2016YFD0200104), Beijing Talents Foundation(2018000021223ZK06) and National Natural Science Foundation ofChina (Grant No. 31671927).CRediT authorship contribution statementXi Tian:Writing - original draft, Formal analysis, Investigation.Jiangbo Li:Methodology.Shilai Yi:Funding acquisition, Project adminis-tration.Guoqiang Jin:Data curation, Formal analysis.Xiaoying Qiu:In- vestigation.Yongjie Li:Writing - review & editing.Declaration of competing interestThe authors declare no conﬂict of interest.References
Aboudaoud, I., Faiz, B., Aassif, E., Izbaim, D., Abassi, D.E., Malainine, M., 2012. The maturity characterization of orange fruit by using high frequency ultrasonic echo pulsemethod. Iop Conference. 42, 012038.Andersen, C.M., Bro, R., 2010. Variable selection in regression-a tutorial. J. Chemom. 24,728–737.Araújo, M.C.U., Saldanha, T.C.B., Galvã, R.K.H., Yoneyama, T., Chame, H.C., Visani, V., 2001.The successive projections algorithm for variable selection in spectroscopic multi-component analysis. Chemom. Intell. Lab. Syst. 57 (2), 65 –73. Barbin, D.F., ElMasry, G., Sun, D.W., Allen, P., Morsy, N., 2013. Non-destructive assessment of microbial contamination in porcine meat using NIR hyperspectral imaging. Innova-tive Food Sci. Emerging Technol. 17 (17), 180 –191. Barnes, R., Dhanoa, M., Lister, S.J., 1989. Standard normal variate transformation and detrending of near-infrared diffuse re ﬂectance spectra. Appl. Spectrosc. 43 (5), 772 –777. Blasco, J., Aleixos, N., Gomez, J., Molto, E., 2007. Citrus sorting by identiﬁcation of the most common defects using multispectral computer vision. J. Food Eng. 83 (3), 384 –393. Brezmes, J., Llobet, E., Vilanova, X., Orts, J., Saiz, G., Correig, X., 2001. Correlation betweenelectronic nose signals and fruit quality indicators on shelf-life measurements withpinklady apples. Sens. Actuators, B. 80(1), 41 –50. Cavaco, A.M., Pires, R., Antunes, D.M., Panagopoulos, T., Brazio, A., Afonso, A., Silva, L.,Lucas, M.R., Cadeiras, B., Cruz, S.P., Guerra, R., 2018. Validation of short wave near in- frared calibration models for the quality and ripening of ‘Newhall’orange on tree across years and orchards. Postharvest Biol. Technol. 141, 86 –97. Cayuela, J.A., 2008.Vis/NIR soluble solids prediction in intact oranges (Citrus sinensis L.)cv. Valencia Late by reﬂectance. Postharvest Biol. Technol. 47 (1), 75 –80. Dull, G.G., Birth, G.S., 1989.Nondestructive evaluation of fruit quality: use of near infraredspectrophotometry to measure soluble solids in intact honeydew melons.HortScience 24, 754.Durand, A., Devos, O., Ruckebusch, C., Huvenne, J.P., 2007. Genetic algorithm optimisation combined with partial least squares regression and mutual information variable se-lection procedures in near-infrared quantitative analysis of cotton –viscose textiles. Anal. Chim. Acta 595, 72 –79. Elmasry, G., Wang, N., Vigneault, Clément, 2009. Detecting chilling injury in red delicious apple using hyperspectral imaging and neural networks. Postharvest Biol. Technol. 52(1), 1–8.Fan, S., Huang, W., Guo, Z., Zhang, B., Zhao, C., 2015. Prediction of soluble solids content andﬁrmness of pears using hyperspectral re ﬂectance imaging. Food Anal Method. 8( 8 ) ,1 9 3 6–1946.Fan, S., Guo, Z., Zhang, B., Huang, W., Zhao, C., 2016. Using Vis/NIR diffuse transmittance spectroscopy and multivariate analysis to predicate soluble solids content of apple.Food Anal Method. 9 (5), 1333 –1343. Fraser, D.G., Jordan, R.B., Künnemeyer, R., Mcglone, V.A., 2003. Light distribution inside mandarin fruit during internal quality assessment by NIR spectroscopy. PostharvestB i o l .T e c h n o l .2 7( 2 ) ,1 8 5 –196. Fu, X., Ying, Y., Lu, H., Xu, H., 2007. Comparison of diffuse reﬂectance and transmission mode of visible-near infrared spectroscopy for detecting brown heart of pear.J. Food Eng. 83, 317–323.Galvão, R.K.H., Araújo, M.C.U., Fragoso, W.D., Silva, E.C., José, G.E., Soares, S.F.C., Paiva, H.M.,2008.A variable elimination method to improve the parsimony of MLR models usingthe successive projections algorithm. Chemom. Intell. Lab. Syst. 92 (1), 83 –91. Gómez, A.H., He, Y., Pereira, A.G., 2006. Non-destructive measurement of acidity, soluble solids andﬁrmness of Satsuma mandarin using vis –NIR spectroscopy techniques. J. Food Eng. 77, 313–319.Guthrie, J.A., Walsh, K.B., Reid, D.J., Liebenberg, C.J., 2005. Assessment of internal quality attributes of mandarin fruit. 1. NIR calibration model development. Aust. J. Agric.Res. 56 (4), 405–416.Hong, X., Wang, J., 2014.Detection of adulteration in cherry tomato juices based on elec-tronic nose and tongue: comparison of different data fusion approaches. J. Food Eng.126, 89–97.Ireri, D., Belal, E., Okinda, C., Makange, N., Ji, C., 2019. A computer vision system for defect discrimination and grading in tomatoes using machine learning and image process-ing. Artiﬁcial Intelligence in Agriculture 2 (C).Kim, K. B., Lee, S., Kim, M. S., Cho, B.K., 2009. Determination of apple ﬁrmness by nonde- structive ultrasonic measurement. Postharvest Biol. Technol. 52(1), 44 –48. Krivoshiev, G.P., Chalucova, R.P., Moukarev, M.I., 2000. A possibility for elimination of the interference from the peel in nondestructive determination of the internal quality offruit and vegetables by VIS/NIR spectroscopy. LWT-Food Sci Technol. 33 (5),344–353.Lammertyn, J., Peirs, A., Baerdemaeker, J.D., Bart, N., 2000. Light penetration properties of NIR radiation in fruit with respect to non-destructive quality assessment. PostharvestB i o l .T e c h n o l .1 8( 2 ) ,1 2 1 –132. Leardi, R., Gonzalez, A.L., 1998. Genetic algorithms applied to feature selection in PLS re-gression: how and when to use them. Chemom. Intell. Lab. Syst. 41 (2), 195 –207. Li, H., Liang, Y., Xu, Q., Cao, D., 2009. Key wavelengths screening using competitive adap- tive reweighted sampling method for multivariate calibration. Anal. Chim. Acta 648(1), 77–84.Li, J., Zhao, C., Huang, W., Zhang, C., Peng, Y., 2014a. A combination algorithm for variable selection to determine soluble solid content and ﬁrmness of pears. Anal. Methods 6 (7), 2170–2180.Li, J., Huang, W., Chen, L., Fan, S., Zhang, B., Guo, Z., 2014b. Variable selection in visible and near-infrared spectral analysis for noninvasive determination of soluble solids con-tent of‘ya’pear. Food Anal Method. 7 (9), 1891 –1902. Li, Y., Jin, G., Jiang, X., Yi, S., Tian, X., 2020. Non-destructive determination of soluble solids content using a multi-region combination model in hybrid citrus. Infrared Phys.Technol. 104, 103138.Liu, Y., Sun, X., Zhou, J., Zhang, H., Yang, C., 2010. Linear and nonlinear multivariate regres- sions for determination sugar content of intact gannan navel orange by vis –nir diffuse reﬂectance spectroscopy. Math. Comput. Model. 51 (11 −12), 1438–1443.
Liu, D., Sun, D.W., Zeng, X.A., 2014. Recent advances in wavelength selection techniques for hyperspectral image processing in the food industry. Food Bioprocess Technol. 7(2), 307–323.Liu, C., Yang, S.X., Deng, Lie, 2015. Determination of internal qualities of Newhall navel or-anges based on NIR spectroscopy using machine learning. J. Food Eng. 161, 16 –23. Lopezgarcia, F., Andreugarcia, G., Blasco, J., Aleixos, N., Valiente, J., 2010. Automatic detec-tion of skin defects in citrus fruits using a multivariate image analysis approach.Comput Electron Agr. 71(2), 189 –197. Magwaza, L.S., Opara, U.L., Nieuwoudt, H.H., Cronje, P.J., Saeys, W., Nicolai, B., 2012. NIR spectroscopy applications for internal and external quality analysis of citrus fruit —a review. Food Bioprocess Technol. 5 (2), 425 –444. Martinsen, P., Schaare, P., 1998. Measuring soluble solids distribution in kiwifruit usingnear-infrared imaging spectroscopy. Postharvest biol. Technol. 14 (3), 271 –281. Mendoza, F., Lu, R., Cen, H., 2012. Comparison and fusion of four nondestructive sensorsfor predicting apple fruitﬁrmness and soluble solids content. Postharvest Biol.Technol. 73, 89–98.Ncama, K., Opara, U.L., Tesfay, S.Z., Fawole, O.A., Magwaza, L.S., 2017. Application of Vis/ NIR spectroscopy for predicting sweetness and ﬂavour parameters of‘Valencia’or- ange (Citrus sinensis) and ‘star ruby’grapefruit (Citrus x paradisi Macfad). J. Food Eng. 193, 86–94.Nghia, N.D.T., Erkinbaev, C., Tsuta, M., De Baerdemaeker, J., Nicolai, B., Saeys, W., 2014.Spatially resolved diffuse reﬂectance in the visible and near-infrared wavelength range for non-destructive quality assessment of ‘Braeburn’apples. Postharvest Biol. Technol. 91, 39–48.Pasquini, C., 2018.Near infrared spectroscopy: a mature analytical technique with newperspectives—a review. Analytica Chimica Acta 1026, 8 –36. Saevels, S., Lammertyn, J., Berna, A.Z., Veraverbeke, E., Natale, C. D., Nicolai, B., 2003. Elec-tronic nose as a non-destructive tool to evaluate the optimal harvest date of apples.Postharvest Biol. Technol. 30(1), 3 –14. Sanaeifar, A., Mohtasebi, S.S., Ghasemi-Varnamkhasti, M., Ahmadi, H., Lozano, J., 2014. De- velopment and application of a new low cost electronic nose for the ripeness moni-toring of banana using computational techniques (PCA, LDA, SIMCA and SVM).Czech J. Food Sci. 32 (6), 538 –548. Sinelli, N., Spinardi, A., Egidio, V.D., Mignani, I., Casiraghi, E., 2008. Evaluation of quality and nutraceutical content of blueberries (Vaccinium corymbosum L.) by near andmid-infrared spectroscopy. Postharvest Biol. Technol. 50 (1), 31 –36.56 X. Tian et al. / Artiﬁcial Intelligence in Agriculture 4 (2020) 48 –57Tian, X., Wang, Q., Li, J., Peng, F., Huang, W., 2018. Non-destructive prediction of solublesolids content of pear based on fruit surface feature classi ﬁcation and multivariate re- gression analysis. Infrared Phys. Technol. 92, 336 –344. Tian, X., Fan, S., Xia, Y., Huang, W., Zhao, C., 2019. Comparison and optimization of models for SSC on-line determination of intact apple using ef ﬁcient spectrum optimization and variable selection algorithm. Infrared Phys. Technol. 102, 102979.Wang, A., Xie, L., 2014.Technology using near infrared spectroscopic and multivariateanalysis to determine the soluble solids content of citrus fruit. J. Food Eng. 143, 17 –24. Wang, A., Hu, D., Xie, L., 2014.Comparison of detection modes in terms of the necessity ofvisible region (VIS) and inﬂuence of the peel on soluble solids content (SSC) determi-nation of navel orange using VIS –SWNIR spectroscopy. J. Food Eng. 126, 126 –132. Wu, D., Sun, D.W., 2013.Potential of time series-hyperspectral imaging (TS-HSI) for non-invasive determination of microbial spoilage of salmon ﬂesh. Talanta 111, 39–46. Wu, D., He, Y., Nie, P., Cao, F., Bao, Y., 2010. Hybrid variable selection in visible and near- infrared spectral analysis for non-invasive quality determination of grape juice. Anal.Chim. Acta 659 (1), 229–237.Xu, H., Qi, B., Sun, T., Fu, X., Ying, Y., 2012. Variable selection in visible and near infrared spectra: application to on-line determination of sugar content in pears. J. Food Eng.109, 142–147.Zhang, L., Xue, L., Liu, M. H., Li, J., 2011. Nondestructive detection of soluble solids contentof nanfeng mandarin orange using VIS-NIR spectroscopy. Adv. Mater. Res. 361 –363, 1634-1637.Zhang, D., Xu, L., Liang, D., Xu, C., Jin, X., Weng, S., 2018. Fast prediction of sugar content in Dangshan pear (Pyrus spp.) using hyperspectral imagery data. Food Anal Method. 11(8), 2336–2345.Zhang, D., Xu, Y., Huang, W., Tian, X., Xia, Y., Xu, L., Fan, S., 2019. Nondestructive measure- ment of soluble solids content in apple using near infrared hyperspectral imagingcoupled with wavelength selection algorithm. Infrared Phys. Technol. 98, 297 –304. Zude-Sasse, M., Truppel, I., Herold, B., 2002. An approach to non-destructive apple fruit chlorophyll determination. Postharvest Biol. Technol. 25 (2), 123 –133.57 X. Tian et al. / Artiﬁcial Intelligence in Agriculture 4 (2020) 48 –57