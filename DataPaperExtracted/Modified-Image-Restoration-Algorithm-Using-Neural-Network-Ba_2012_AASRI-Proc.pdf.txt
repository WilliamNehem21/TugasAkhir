 AASRI Procedia   1  ( 2012 )  196 â€“ 206 
2212-6716 Â© 2012 Published by Elsevier Ltd. doi: 10.1016/j.aasri.2012.06.031 
 
 2012 AASRI Conference on Computational Intelligence and Bioinformatics  
Modified Image Restoration Algorithm Using Neural Network Based on Harmonic Model 
Yang Bing *a, Zhang Zhigangb, Dai Shufena, Xiao Zhongnanb 
aDongling School of Economics & Management, University of Science & Technology Beijing, Beijing, 100083, China 
bSchool of Mathematics & Physics, University of Science & Technology Beijing, Beijing, 100083, China  
Abstract 
In this paper, we considered the neural network image restoration algorithm based on harmonic model and improved the efficiency of the algorithm. After analyzing the complexity of the algorithm, I found that the storage of the connection weight 
j iw, wastes a lot of spaces. And when I made a deeper analysis of thej iw,, I found that there are many duplicated elements, and the distribution of the elements is regular. So I started from this point to improve the algorithm, and simplified the calculation of the connection weights matrix, a nd avoided a large amount of data storage. As a result, the space complexity reduced to 
) (n O from ) (2n O, meanwhile, the time complexity is improved. This is a great improvement. At last, I made some data simulation experiment, and the result give a further description of the algorithm.

 Â© 2012 Published by Elsevier B.V. Selection and/or peer review under responsibility of  American Applied Science Research Institute   
Keywords: image restoration; neural network; harmonic model 
 * Corresponding author. Tel.: 13810614116; E-mail address: yangjingyuan1984@sina.com. 
AASRI
Procedia
www.elsevier.com/locate/procediaAvailable online at www.sciencedirect.com
Open access under CC BY-NC-ND license.
Open access under CC BY-NC-ND license.197  Yang Bing et al.  /  AASRI Procedia   1  ( 2012 )  196 â€“ 206 
 2 / ) ( ) ( 2 /2222xDYxDXx H yEHarmonic Â˜  Â˜ Â˜  Â˜   O2 /2 /22x Dx H y EÂ˜ Â˜  Â˜   O1. Introduction In the image processing, image restoration has been on e of the most important basic research subjects. Many application fields need clear and high quality im ages, so image restoration (such as denoising, deblurring etc.) is of great significance. The traditio nal image restoration method is mainly about image filtering processing. With most of the image informatio n existing in the edge portion, therefore, image filtering is needed to not only remove the blur and noise from the image but also to keep the detail of the image. Because of image details and noise in frequency bands aliasing, making the image smoothing and the edge details remain becomes a pair of contradiction and the traditional filtering methods are difficult to deal with this kind of problem. The development of neural network technology in recent years to solve this contradiction of the image restoration provides a new me thod (Zhou Y T and Chellappa R, 1988; Paik JK and Katsaggelos AK, 1992; Yubing Han and Lenan Wu, 2004; Perry S.W and Guan L, 2000; Erler K and Jernigan E,1994; Wu W and Kundu A,1992). Neural network for image restoration model was first put forward by Zhou et al. (Zhou Y T and Chellappa R, 1988). They linked image restoration with Hopfield  neural network through the energy function, and converted image restoration into optimization problem of the neural network calculation. However, using the Zhou method there are shortcomings that the network mode l is huge and network state is updated slow and so on. In order to overcome these disadvantages, Paik et al. (Paik JK and Katsaggelos AK, 1992) put forward an improved Hopfield neural network model for gray-scale image restoration. Later, the Paik method was improved by many scholars from the network model and the convergence rate and so forth (Yubing Han and Lenan Wu, 2004; Perry S.W and Guan L, 2000; Erler K and Jernigan E, 1994; Wu W and Kundu A, 1992). Literature (Yadong Wu, 2006) on the basis of Paik algorithm, using the regularization term based on the harmonic model, proposed a neural network algorithm based on the harmonic model. But the author in the analysis of the algorithm found that the storage of the connection weights needs a size of matrix
L Lu, among them
N M Lu  , MandNfor the image width to height. For an image of the size 12h, the connection weights matrix will be the 16384 d. It's not conducive to the computer processing. Then based on this algorithm an improved algorithm is proposed, to  simplify the calculation of the connection weights.  2. The Restoration Model According to the problem of the image restoration model, the image restoration problem can be transformed to minimize the following error function:                                                                                                                                                                    (1) Among them, 
Â˜ represents the norm of2L, xis the estimated value of the real image, yis the degraded image. 
xAndy for column vectors, namely ) (ix x Ëˆ ) (iy y ËŠIn the above equation, the first term represents that finding a
xmakes x HÂ˜ approximate y in the case of minimum variance; the second term is the constraints of
x, also called the regularization item; for regularization parameter O, it controls the proportion between removing fuzz and smoothing noise. Matrix
Hrepresents the distortion of the imaging system, which is the size of
L LuToeplitz matrix generated by the point spread function. Dis the high-pass filter, which is a matrix generated by the regularizat ion operator. In the traditional rehabilitation model, regularization operator is the Laplace operator. If the point spread function
h for the ru1 matrix, d also should be written as the 
ru1matrix. Dis in the same form with H. The harmonic model will be introduced into the image restoration frame based on neural network as follows,       (2) 198   Yang Bing et al.  /  AASRI Procedia   1  ( 2012 )  196 â€“ 206 
  Among them,
DX  andDY  are the L Lu Toeplitz matrixes respectively generated by vertical and horizontal gradient. The connection weight is for,                                                       (3)                                                                 3. The Recovery Algorithm Based on the above model, the algorithm generated by referencing the structure of the Paik algorithm can be found in the literature [8], time complexity of the algorithm is
) (3n O, and space complexity is ) (2n O. Then we will improve it as follows. First of all, several definitions and theorems prepared for the improved algorithm are introduced. For a matrix 
n nj ia Au ,,it is the Toeplitz matrix; i.e., for all the n j id d, 2,1 , 1,  j i j ia a . And A is also the symmetric matrix. Then A is called the symmetric Toeplitz matrix. For arbitrary matrix
n nuwith the following form,  
Â¸Â¸Â¸Â¸Â¸Â¸Â¸Â¸Â¹Â·Â¨Â¨Â¨Â¨Â¨Â¨Â¨Â¨Â©Â§ 

0 1 2 11 0 12 11 21 0 112 1 0
a a aaa a aa aa aa a aaa a aA
nn
" "% #% % % ## % % %# %" "                                                                                               (4) That is a symmetric Toeplitz matrix.  Theorem 1: if a matrix
n nj ih Hu ,is the Toeplitz matrix, then the matrix n nj iw Wu ,is the symmetric Toeplitz matrix, among them
Â¦
  npj p i pj i
h h w
1, ,,. Proof: first prove the symmetry of the matrix
W. Because ofi jnpi p j pnpj p i pj iw h h h h w,1, ,1, ,,   Â¦ Â¦
  , namely the arbitrary element satisfies 
i j j iw w, , for the matrix W, so the matrix of Wis the symmetric matrix; For all the
n j id d, 2, according to the definition of H, the equation 1 , 1 ,  j i j ih h is established. So 
j inpj p i pnpj p i pj iw h h h hw,1, , 11 , 1 ,1 , 1   Â¦ Â¦
                                                                                 (5) Â¦Â¦ Â¦
     LpLpLpj p i p j p i p j p i pj i
DY DYDX DXh h w
11 1 , , , , , ,,OO199  Yang Bing et al.  /  AASRI Procedia   1  ( 2012 )  196 â€“ 206 
 That is Wfor the symmetric matrix; Thus, 
Wis a symmetric Toeplitz matrix. QED. Corollary 1: the linear combination of symmetric To eplitz matrixes is still a symmetric Toeplitz matrix. Proof: this proposition is equivalent to proving the following conclusion. If 
nA A A, , ,2 1"  are all symmetric matrices with the order
n nu, nO O O, , ,2 1" are all the arbitrary constants, then 
n nAA A AO O O    "2 2 1 1                                                                                                        (6) Still for the symmetric Toeplitz matrix. Obviously
Ais a symmetric matrix; assume that arbitrary element of Ais ) , (j i A, the arbitrary element of 
nO O O, , ,2 1" is ) , ( ,),, (),, (21 j i A j i A j i An" respectively, then 
) , () , ( ) , ( ) , (2 21 1 j i A j i A j i A j i An nOO O   "                                                                    (7) 
nA A A, , ,2 1" are Toeplitz matrixes, so for all the n j id d, 2,  
) 1 , 1 ( ) , (11   j i A j i AËˆ ) 1 , 1 ( ) , (22   j i A j i AËˆÄ‚Ä‚Ëˆ ) 1 , 1 ( ) , (   j i A j i Ann  (8)  So  
) 1 , 1 () 1 , 1 () 1 , 1 ( ) 1 , 1 () , () , ( ) , ( ) , (2 21 12 21 1
                j i Aj i Aj i A j i Aj i A j i A j i A j i An nn nOOOOO O""                                        (9)  
That is ) 1 , 1 ( ) , (   j i A j i A, soAis the Toeplitz matrix. To sum up, 
Ais the symmetric Toeplitz matrix, namely the linear combination of symmetric Toeplitz matrixes is still a symmetric Toeplitz matrix. QED. Corollary 2: if a matrix 
Wis a symmetric Toeplitz matrix, then for the arbitrary element of the matrix W  
1 , 1,  i jj iw w  , n j id d, 1.                                                                                                        (10) Proof: first consider for the arbitrary element
i jt, according to the definition of the Toeplitz matrix,
1 , 1,  j i j iw w , we can draw the conclusion: 
1 , 1 ) 1 (),1 (1 , 1 ,         i ji j i ij i j iwww w"                                                                             (11) And for
i jt, according to the property of the symmetric matrix we can get the conclusion: 
1 , 1 , ,   j i i j j iw w w                                                                                                                        (12) 200   Yang Bing et al.  /  AASRI Procedia   1  ( 2012 )  196 â€“ 206 
 From two equations above, for the arbitrary element n j id d, 1,1 , 1,  i jj iw w .QED. Before going further, we first present two properties of the Toeplitz matrix related. 
His the order of n nuToeplitz matrix generated by >@rh h h h, , ,2 1" ,among them, 
1 ,! tr r n.Hhas the following form, 
n nrrrrhh hh hhhhh hh h hH
uÂ¸Â¸Â¸Â¸Â¸Â¸Â¸Â¸Â¹Â·Â¨Â¨Â¨Â¨Â¨Â¨Â¨Â¨Â©Â§ 
1 22 122 12 1
00000" "% ## % % %% % % ## %" "                                                                        (13) 
Makej ih,for the arbitrary element; from its structure we can see that the following two properties are obvious: Property 1:  for all the 
n j id d, 1 
Â¯Â®Â­ t    j ih hj ih hi j j ij i j i1 , 1 ,1 , 1,                                                                                                     (14) Property 2: the elements of the first line and the firs t column of the element have the following relationship 
2 , 1 1 ,  i nih h , among them n id d2                                                                                         (15) Or 
1 , 2, 1  j n jh h , among them n jd d2. We will use the two properties to prove the following theorem for many times. Theorem 2: if 
His the order of n nuToeplitz matrix generated by >@rh h h h, , ,2 1" , among them,
1 ,! tr r n then the matrix n nj iw Wu , at most only has the number of rdifferent nonzero elements, of which
Â¦
  npj p i pj i
h h w
1, ,,; And, if
1 2 tr n, Whas rdifferent nonzero elements, and as the increase of n, the value of the
relements will not change, which are as follows:                                                                                           (16)  
Â°Â°Â°Â¯Â°Â°Â°Â®Â­             
rrr rr rr
h h wh h h h h h wh h h h h h wh h h w
1 , 124 2 3 1 3 , 113 2 2 1 2 , 122221 1 , 1#"""201  Yang Bing et al.  /  AASRI Procedia   1  ( 2012 )  196 â€“ 206 
    Proof: This proposition is divided into two parts to prove: (1) From the above discussion we know the structure of
H, makingj ih,for the arbitrary elements. From theorem 1, it is known that 
Wis a n nusymmetric Toeplitz matrix; for n j id d, 1, the corollary 2 tells us that 
Wsatisfies1 , 1,  i jj iw w . Therefore we just need to prove that in the first line of Wthere are at most only
rdifferent nonzero elements. According to the generation rules of 
Wand property 1 and 2 we can derive the following equations: 
1 , 1 , 1 1 , 1 1 , 2 1 , 2 1 , 1 1 , 1 2 , 11 , 1 , 1 1 , 1 1 , 2 1 , 2 1 , 1 1 , 1 1 ,1 , 1 1 , 2 , 1 1 , 1 3 , 1 1 , 2 1 , 2 1 , 1, 1 , , 1 1 , 1 , 2 1 , 2 , 1 1 , 11, 1 ,, 1
n nn nn nn n nnnnn n n n n n n n n nnpn p pn
h h h h h h h hh h h h h h h hh h h h h h h hh h h h h h h hh h w
                      Â¦
""""                                                                 (17) And 
1 , 1 , 1 1 , 1 1 , 2 1 , 2 1 , 1 1 , 1 2 , 12 , 1 , 2 , 1 1 , 1 2 , 2 1 , 2 2 , 1 1 , 112 , 1 ,2 , 1
n nn nn nn nnpp ph h h h h h h hh h h h h h h hh h w
            Â¦
""                                                      (18) 
Namelynw w, 1 2 , 1 ;Vice versa,1 , 1 3 , 1 nw w , Ä‚, 2 , 1 , 1  r n rw w .Another obviously results: 
22221 1 , 1rh h h w    "                                                                                                            (19) So far, we know that 
W has possessed relements. From the above analysis, we can conclude
1 , 1 , 1 r rw w , if 1 2  r n. Namely the first line of Wjust has 
relements, so if 1 2 dr n, the conclusion is set up. Then we continue to prove that, if the first line of 
Whas other elements, the other elements are zero. That 202   Yang Bing et al.  /  AASRI Procedia   1  ( 2012 )  196 â€“ 206 
 is when r n2t and if 11  d d r n j r, then 0, 1 jw . Given in the range, 
j n nj r n r n j r n r n jjnpj p pj h hh h h h h h h hh h w, 1 ,, 2 1 , 2, 1 1 , 1 , 2 1 , 2 , 1 1 , 11, 1 ,, 1             Â¦
""                        (20) From the structure of
H, when r n2t, and if 12  d dr n i, then 01 , iw ; In addition, when
1 tr j, 0, 1 jh  so the equation above is changed into the following form: 
j n nj r n r n jh hh h w, 1 ,, 2 1 , 2, 1     "                                                                                             (21) For
j r n r n nt   !   t1 2, so according to property 1 we can derive the following equations: 
Â°Â¯Â°Â®Â­  
    1 , 1,1 , 3, 2j n j nj r n j r nh hh h#                                                                                                                     (22) That by
11  d d r n j ris known, 
1 2 2 32     d    dr n r n j r n So ,
01 , 3   j r n h ; Similarly, 11    d   dr n r n j n r, namely 01 , 1  j nh , from this we can get
0, 1 jw . To sum up, the first part of theorem 2 is established. Namely the matrix 
Wat most only has the number of
rdifferent nonzero elements. (2) Apparently ,
22221 1 , 1rh h h w    "; By the definition of W, considering 1 2 tr n, 
2 , 1 , 2 , 1 1 , 1 2 , 3 1 , 32 , 2 1 , 2 2 , 2 1 , 2 2 , 1 1 , 1 2 , 1n nn nr n r nr n r nh h h hh hh h h h h h w             ""                                                                   (23) According to property 1 and 2 the equation above can be transformed into the following. 
3 , 1 2 , 1 4 , 1 3 , 1 , 1 1 , 1 1 , 1 , 1 1 , 1 , 1 2 , 1 1 , 1 2 , 1h h h h h h h h h h h h wr rr rn        ""                             (24) When
1 tr jË— 0, 1 jh ; So the values are substituted into it, we can draw 203  Yang Bing et al.  /  AASRI Procedia   1  ( 2012 )  196 â€“ 206 
 r rh h h h h h w13 2 2 1 2 , 1    "                                                                                                     (25) We can see that the values of
2 , 1wdonâ€™t matter with n; similarly the following equation can be drawn, 
Â°Â¯Â°Â®Â­     rrr r
h h wh h h h h h w
1 , 124 2 3 1 3 , 1#"                                                                                           (26) These values have nothing to do with
n, that is, when 1 2 tr n, along with the increase of n, these values will not change. Proposition is proved.  Consolidated conclusions of (1) and (2), theorem 2 is proved. QED. Let's talk about the actual significance of the theorems  above in the algorithms. In the image restoration algorithms based on harmonic model, the network connection weight values are defined as follows 
Â¦Â¦ Â¦
     LpLpLpj p i p j p i p j p i pj iDY DYDX DXh h w
11 1 , , , , , ,,OO                                                            (27) Among them,
HËˆDX  andDY  are all the Toeplitz matrixes . From theorem 1 and its inferences to know, the generated matrix
L Lj iw Wu , is a symmetric Toeplitz matrix; assume that the point spread function
h for the ru1 matrix which generates H. In actual applications, the image size r L!!, we think
1 2 tr L. So from the corollaries of theorem 1 reasoning and theorem 2 we can know some key features of the matrix
W: (1) The number and the values of nonzero elements are defined, which can be expressed by using the elements of 
h.And along with the changes of L, the values will not be changed; (2) The elements of the matrix
Ware regular. All elements and some element of the first line are in same value, and this equivalence relation follows certain rule. Based on the two points above, we think that in the course of the algorithm, there is no need to generate the Toeplitz matrix
H, and only need to calculate its certain numerical values according to the rule. If we do so, for the original algorithm space complexity and time complexity will have a very big improvement. The following describes the algorithm of calculating
W. (1) The matrixes generating
H,DX  andDY are given, written by the form of ru1.They are as follows: 
>@>@>@
Â°Â¯Â°Â®Â­   
rrrdy dy dy dydx dx dx dxh h h h, , ,, , ,, , ,
2 12 12 1"""                                                                                                               (28) In order to facilitate the calculation, the matrixes above are expanded for
) 1 2 ( 1 ur , and the elements of the part expanded are filled with zero, so it can be written as the following form: 204   Yang Bing et al.  /  AASRI Procedia   1  ( 2012 )  196 â€“ 206 
 >@>@>@
Â°Â¯Â°Â®Â­   
 u u u) 1 2 ( 1 2 1) 1 2 ( 1 2 1) 1 2 ( 1 2 10 , , 0 , , , ,0 , , 0 , , , ,0 , , 0 , , , ,
rrrrrr dy dy dy dydx dx dx dxh h h h" "" "" "                                                                                      (29) (2) Calculate 
r different values of W, and then store them in a ru1matrix T; For i = 1: r 
>@Â¦
   Â˜    Â˜    rti tdytdyi tdxtdxi t h t h i T
1) 1 ( ) ( ) 1 ( ) ( ) 1 ( ) ( ) ( OO                                                 (30) End  (3)Assign for each element
j iw, ofW, and the algorithms are described below: Make
1   i j q; If 
11  d d r L q r 
0, j iw  Else if 
1  !r L q 
) 2 (, q L T wj i     Else 
) (, q T wj i  End 4. The Experimental Results and Discussion The algorithms in the last section are from matrix  internal data features, looking for the relationship between dates. The improvement is that it avoids the re dundant data storage, thus avoiding the generation of large scale matrix. The calculating process of 
Wonly needs2rtimes; in the original algorithm, external circulation times are
2L. In practical application L r2, so time complexity ) (n T(make L n ) of the improved algorithm is 
) ( ) ( ) (22 2n O n r O n T|                                                                                                                (31) In the space complexity, the improved algorithm only has the linear complexity
) (n O; relative to the original algorithm of
) (2n O.This is a great improvement, and also the main work done of the algorithm. In order to test the improved algorithm restoration effect, degraded images all use 
9 1umotion blur. And we join the Gaussian white noise with the variance of 25, using the MSE and PSNR as measures. In the algorithm, the 205  Yang Bing et al.  /  AASRI Procedia   1  ( 2012 )  196 â€“ 206 
 gradient operator takes the Sobel  operator: vertical gradient operator for
Â»Â»Â»Â¼ÂºÂ«Â«Â«Â¬Âª1 0 12 0 21 0 141, horizontal gradient operator for
Â»Â»Â»Â¼ÂºÂ«Â«Â«Â¬Âª  1 2 10 0 01 2 141. Hof algorithms take experience value 05. 0 H . To different images, the value of
Ois different, which is computed in the program. The following is processing effect of the standard image, in this example
0204 . 01  SNR O . 
 
Figure.1. (a) original image; (b) Fuzzy image ; (c) Restored image. 
Seen from the pictures, the algorithm in noise removal performance is very good, but in keeping the edge of performance is relatively insufficient, which confirmed the previous theoretical knowledge: Harmonic canonical in the gradient and the edge of the two or thogonal directions are diffused, and has the same diffusion coefficient. Therefore, the harmonic model in no ise smoothing also fuzzes edges of the image. Fuzzy image
7 . 2256 MSE, 5960 . 14 PSNR ;Restored image 1614.2 MSE Ëˆ 16.0513 PSNR ËŠ 5.  The End This paper first studied the complexity of the origin al algorithm, and then had a detailed analysis of the calculation process of connection weight matrix, finding the internal structural features. By the form of Theorem 1and 2 it was summarized and the theorems wa s applied to the original algorithm. Then we put forward a new improved algorithm saving time and space and finally did the data simulation experiment, which not only deepened the understanding to the algorithm, but also illustrated the advantages of the improvement algorithm. References [1] Zhou Y T, Chellappa R. Image restoration using a network. IEEE Trans. on Acoust, Speech, Signal Process 1988; 36(7):1141-1151. [2] Paik JK, Katsaggelos AK. Image restoration using a modified Hopfield network. IEEE Transactions on Image Processing 1992; 1(1):49-63. [3] Yubing Han, Lenan Wu. Image restoration using a m odified Hopfield neural network of continuous state change. SIGNAL PROCESSING 2004; 20(5):431-435. [4] Perry S.W, Guan L. Weight assignment for adap tive image restoration by neural networks. IEEE Trans 
(b) 
 (c) 
 (a) 206   Yang Bing et al.  /  AASRI Procedia   1  ( 2012 )  196 â€“ 206 
 Neural Networks 2000; 11(1):156-170. [5] Erler K, Jernigan E. Adaptive image restoration usi ng recursive image filters. IEEE Transactions on Signal Processing 1994; 42(7):1877-1881. [6] Wu W, Kundu A. Image estimation using fast modi fied reduced update Kalman filter. IEEE Transactions on Signal processing 1992; 40(4):915-926. [7] Yadong Wu. Research on Image Restoration Algorith ms: Degree thesis. University of Electronic Science and technology of computer application technology 2006.  