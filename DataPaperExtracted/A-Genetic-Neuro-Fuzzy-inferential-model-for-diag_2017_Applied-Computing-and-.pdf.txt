ORIGINAL ARTICLE
A Genetic-Neuro-Fuzzy inferential model fordiagnosis of tuberculosis
Mumini Olatunji Omisorea,*, Oluwarotimi Williams Samuelb,1,Edafe John Atajeromavwo
c,2
aCentre for Information Technology & Systems, University of Lagos, Yaba-Akoka, Lagos, Nigeria
bBiomedical Engineering & Health Techonolgy, Shenzhen Institute of Advanced Techonolgy, CAS, Shenzhen, Guangdong, China
cDepartment of Computer Science, Delta State Polytechnic, Ogwashi-uku, NigeriaReceived 4 March 2015; revised 2 June 2015; accepted 9 June 2015Available online 24 June 2015
KEYWORDSMedical diagnosis;Mycobacterium tuberculosis;Artiﬁcial intelligence;Inference system;Decision supportAbstractTuberculosis is a social, re-emerging infectious disease with medical implicationsthroughout the globe. Despite efforts, the coverage of tuberculosis disease (with HIV prevalence)in Nigeria rose from 2.2% in 1991 to 22% in 2013 and the orthodox diagnosis methods availablefor Tuberculosis diagnosis were been faced with a number of challenges which can, if measure nottaken, increase the spread rate; hence, there is a need for aid in diagnosis of the disease. This studyproposes a technique for intelligent diagnosis of TB using Genetic-Neuro-Fuzzy Inferential methodto provide a decision support platform that can assist medical practitioners in administering accu-rate, timely, and cost effective diagnosis of Tuberculosis. Performance evaluation observed, using acase study of 10 patients from St. Francis Catholic Hospital Okpara-In-Land (Delta State, Nigeria),shows sensitivity and accuracy results of 60% and 70% respectively which are within the acceptablerange of predeﬁned by domain experts.
/C2112015 The Authors. Production and hosting by Elsevier B.V. on behalf of King Saud University. This isan open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/4.0/ ).
1. IntroductionTuberculosis (TB) is a social, re-emerging infectious diseasethat has medical implications throughout the globe [1]. The largest single cause of adult illness and death from the commu-nicable disease is caused by Mycobacterium Tuberculosis [2]. Nigeria has made great strides in increasing access to DirectlyObserved Therapy Short-course (DOTS) for TB yet, coverage,which was 45% in 1999, had reached 75% by 2005 while treat-ment success for 2005 cohort was 75%[3]. Although TB inci-dence in Nigeria is below the normal level for Sub-SaharanAfrica, but it remains high at a rate of 311 cases per 100 grand*Corresponding author. Tel.: +234 7031967847.E-mail addresses:ootsorewilly@gmail.com(M.O. Omisore),timi- tex92@gmail.com(O.W. Samuel),edafejohn2006@yahoo.com(E.J. Atajeromavwo).
1Tel.: +86 15814491870.
2Tel.: +234 8064784094.Peer review under responsibility of King Saud University.
Production and hosting by ElsevierApplied Computing and Informatics (2017) 13,2 7–37
Saudi Computer Society, King Saud University
Applied Computing and Informatics
(http://computer.org.sa)www.ksu.edu.sawww.sciencedirect.com
http://dx.doi.org/10.1016/j.aci.2015.06.0012210-8327/C2112015 The Authors. Production and hosting by Elsevier B.V. on behalf of King Saud University.This is an open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/4.0/ ).population members in 2006. The trends for both Nigeria andSub-Saharan Africa, as depicted inFig. 1, show a slight down-ward turn of TB incidence since 2003. Still with 250 grand newcases each year, a mortality rate of 81 deaths per 100,000 spellsthe disease as high burden on Nigeria[4].The World Health Organization (WHO) estimated in 2006,that each year, more than 8 million new cases of TB occur andapproximately 3 million persons die from the disease [4,5]and estimated that between 19% and 43% of the world’s popula-tion will be infected with Mycobacterium Tuberculosis. Withinthe past decade it has become clear that the spread of HIVinfection and the immigration of persons from areas of highincidence have resulted in increased numbers of TB cases. Ithas always occurred disproportionately among disadvantagedpopulations such as the homeless, malnourished, and over-crowded[6]. Today, several methods for the diagnosis of TBhave been proposed. Tuberculin Test, Radiological Examina-tion, and Sputum Smear Microscopy are common conven-tional approaches however in the last 10 years, severalmolecular methods have been developed for direct detection,identiﬁcation and susceptibility testing of mycobacteria [7]. Orthodox methods of diagnosing TB are primarily throughphysical examination and laboratory tests. The formerinvolves asking patients certain questions for prognosis pur-poses while tests are carried out to afﬁrm physical examina-tion. Diagnosis can be stopped if medical practitioner istotally convinced after physical examination however, this isnot advised. This orthodox method is currently faced with anumber of challenges such as lack of medical facilities in mostmedical centers and as a result, inhibiting the management ofTB in developing countries.The strength of IT in providing an effective and efﬁcientsolution to real life problems has been explored to aid scientiﬁcdiscoveries and advancement of different ﬁelds of medicine [8]. Hence, to reduce the morbidity and mortality rates in humanas a result of TB, there is need to incorporate IT into its diag-nostic approach. This study, therefore, proposes a decisionsupport model for intelligent diagnosis of TB using Genetic-Neuro-Fuzzy Inferential technique. The model is aimed at pro-viding a decision support platform that can aid medical prac-titioners in administering accurate, timely, and cost effectivediagnosis of TB in developing countries.2. Literature reviewThis section presents a review of literature on the concept ofExpert System (ES). Description of major tools for buildingsuch adaptive systems including is briefed while review ofhybrid and decision support systems is also presented.2.1. Artiﬁcial intelligenceResearch on Artiﬁcial Intelligence (AI) in the last two decadeshas greatly improved performance of both manufacturing andservice systems[9]. AI, ﬁrst coined by John McCarthy in theﬁfties is concerned with the ‘hows’ and the ‘whys’ of humanintelligence; however, it has become an important area ofresearch in virtually all ﬁelds including engineering, scienceand education, and as well as its applications in accounting,marketing, stock market and law, among others [10,11]. AI is the intelligence deployed by machines to handle com-plex imprecise tasks that require intelligence if done byhumans. The central problems of AI include reasoning, pro-gramming, artiﬁcial life, belief revision, knowledge representa-tion, machine learning, natural language understanding, andtheory of computation[12,13,38]. It achieved greater feats inpractical application despite, some setbacks, its success is beingrevived with the commercial success of ES [39]. Fuzzy Logic, Neural Networks, and Genetic Algorithms, are such tech-niques used in modeling intelligence.2.2. Expert systemsExpert Systems (ESs) is a branch of AI that employs the use ofhuman knowledge to solve problems that require human’sexpertise and it helps to solve complex problems by reasoningabout knowledge rather than following developers’ proceduresas in the case of conventional programming [14]. ES continues to evolve for speciﬁc applications in medical diagnosis due toinﬂux of new and massive information that requires expertsto be specialized.The basic steps in ES development have been reported in[15]. Many AI systems have been developed for the purposeof enhancing healthcare delivery, providing better healthcarefacilities, and reducing the cost associated with quality health-care services. Early studies in intelligent systems have beenshown to outperform manual practices of medical diagnosis.Examples of such systems are as follows: INTERNIST, arule-based expert system for the diagnosis of complex prob-lems in general internal medicine; MYCIN, a rule-based expertsystem to diagnose and recommend treatment for certainblood infections; CASNET, an expert system for the diagnosisand treatment of glaucoma, EXPERT, an extension general-ization of the CASNET formalism which was used in creatingconsultation systems in rheumatology and endocrinology [16]. 2.3. Soft computing toolsThe intervention of soft computing tools (techniques) in med-ical analysis has greatly reduced the cost of human supportand medical diagnosis, with increase in accuracy of diagnosisresults. Fuzzy Logic, Neural Networks, and Genetic Algo-rithm are common tools adopted in developing ESs [17]. 2.3.1. Fuzzy logicFuzzy Logic (FL) is one of AI techniques that deals with
uncertainty in knowledge and simulates human reasoning inan incomplete or fuzzy data. FL is deﬁned as a nonlinear map-
Figure 1Incidence of TB in Nigeria and other Sub-SaharanAfrican countries[39].28 M.O. Omisore et al.ping of an input data set to a scalar output data set, basically itis aimed at providing approximate reasoning. This techniquehas attracted growing attention and interest in modern IT, pat-tern recognition, and decision making among others [18].F L theory provides a mathematical strength to capture uncertain-ties associated with human cognitive processes, such as think-ing and reasoning. It is a suitable and applicable basis fordeveloping knowledge-based systems in varying sectors of lifesuch as health. It has been applied to interpret sets of medicalﬁndings; syndrome differentiation in eastern medicine anddiagnosis of diseases in western medicine; and for real-timemonitoring of patient data[19].In fuzzy set theory, linguistic terms are used to illustrate thecorrelation of Membership Function (MF) which describes themembership of an element within the base of a fuzzy set. Eachelement has a unit value that characterizes the grade of mem-bership of a set and such element can simultaneously belong toanother set, possibly, at varying degrees. Ref. [20]emphasize that a number of different types of MFs have been proposedfor fuzzy control systems though[21]concluded triangularand trapezoidal MFs as the mostly used. Triangular MF is aparticular case of MF that is speciﬁed by three parameters(a,b,c) and shows the degree of membership of each classof a linguistic term as possibility distribution [22].Fig. 2arep- resents a typical Triangular MF of input and output variableswhileFig. 2buses four parameters to describe the membershipof an element in a fuzzy set using Trapezoidal MF.The trapezoidal MF of a fuzzy setFwith each element hav-ing tolerance interval [a,b], left widthaand right widthbis determined using Eq.(1). If notationF=(a,b,a,b) is used, then½F/C138c¼½a/C0ð1/C0cÞa;bþð1/C0cÞb/C138,Vce½0;1/C138hence the sup- port of A is (a/C0a,
b+b).FðxÞ¼1/C0ða/C0xÞ=aifa/C0a6x6a1i fa6x6b1/C0ðx/C0bÞ=bifa6x6bþb0 otherwise8>>><>>>: ð1ÞIn fuzzy set, an element can belong to both its set and itscompliment set or to neither of them. This principle preservesthe structure of the logic and avoids the contradiction of ele-ment. However, fuzzy logic is highly abstract and employsheuristic requiring human experts to discover rules about datarelationship[19]. FL has been widely adopted in developingESs for health management. For instance,[18]proposed model ES for typhoid fever, while[23]for malaria diagnosis, andlastly,[24]developed a diagnostic ES for cardiovascular dis-eases. In[19], the use of Fuzzy Cluster Means was applied todiagnose HIV/AIDS shortly after[25]proposed the use offuzzy sets for diagnosing low back pain in computer users.2.3.2. Neural networkNeural Network (NN) is a group of interconnected artiﬁcialneurons that mimic the properties of biological neurons. It fol-lows analog and parallel computing system made up of simpleprocessing elements that communicate through a rich set ofinterconnections with varying contributory weights. ArtiﬁcialNeural Network (ANN), is synthetic nervous systems looselyinspired to simulate functions of human brain [26]. ANN attempts to abstract the complexity of biological nervous sys-tem so as to focus on what may hypothetically matter mostfrom an information processing point of view.Medicine has always beneﬁted from forefront of technologyas it has boosted medicine to extraordinary levels of achieve-ment. ANN has been successfully used in various areas of med-icine such as biomedical analysis, imaging systems, and drugdevelopment but extensively used in diagnosis to detect ail-ments such as cancer and heart problems in human [27]. The termnetworkin ANN arises because of the functionf( x) deﬁned as a composition of other functiong
i(x) which are fur- ther used as composition of more functions.Fig. 3shows a simple NN which comprises of three layers.The ﬁgure comprises of input units connected to hidden unitswhich in turn is connected to a layer of ‘‘output ”units. The activity of the input unit represented the raw information thatis fed into the network; the activity of the hidden units is deter-mined by the activity of the input units and the weightsbetween the hidden and output units. The hidden units are freeto construct their own representation of the input; the weightsbetween the input and hidden units determine when each hid-den unit is active and so by modifying the weights, a hiddenunit can choose what it represents.ANN employs learning paradigm that includes supervised,unsupervised and reinforced learning. One good thing is it doesnot require details on how to recognize disease but it has a self-learning and self-tuning feature which helps it to attain that[28]. Finally, it cannot handle linguistic information and vagueinformation.2.3.3. Genetic algorithmGenetic Algorithm (GA) is simply a search algorithm based onthe observation of sexual reproduction and principle of sur- vival of the ﬁttest, which enables biological species to adaptto their environment and compete effectively for resources.GAs are search algorithms which use principles inspired bynatural genetics to evolve solutions to problems. The basic ideais to maintain population of chromosomes that represents can-didate solutions to a problem, and the candidate will evolve
Figure 2aTriangular MF of input and output variables.
1.00
a-αabb  +  β
Figure 2bTrapezoidal MF of input and output variables.A Genetic-Neuro-Fuzzy inferential model 29over a period of time through competition and controlledvariation.GAs have got a great measure of success in search and opti-mization problems. While the algorithm is relatively straightforward, it is an effective stochastic search method, provenas a robust problem solving technique that produces betterthan random results[29]. GAs are robust and powerful in dif-ﬁcult situations where the space is usually large, discontinuous,complex and poorly understood[30], it has been applied in awide range of problem areas, though it just guarantee ﬁndingan acceptable solution in a quick and not a global optimumsolution to a problem.2.3.4. Review of hybrid and decision support systemsA Decision Support System is an interactive computer-basedinformation system that utilizes database models to solve ill-structured problems and come up with a valuable decision.In the late 1980s, DSS was conﬁrmed to have assisted in man-agerial positions using suitable available technologies toimprove effectiveness of academic and professional activities[38]but over the years, it has migrated to an interactive systemthat assists users in taking quick appropriate decisions in anygiven context[31]. In a related study, Ref.[32]developed a fuzzy expert system as a platform for diagnostic support forhypertension management. The system is composed of fourmajor components for fuzzy processes while Root Sum Squareand Center of Gravity were employed as fuzzy inference anddefuzziﬁcation methods respectively. A case study of 30patients with tuberculosis was used to validate the ES. [33] combined NN, FL and Case Based Reasoning to model DSSfor diagnosis of depression disorders. The NNs were con-structed to imitate intelligent human biological processes oflearning while FL provides a means for dealing with impreci-sion, vagueness and uncertainties in the medical data andCBR entails the use of past situations to solve new occur-rences. Finally, this study proposes a Genetic-Neuro-Fuzzyinferential technique for diagnosis of tuberculosis.3. Proposed decision support systemThis section presents design of the system’s architecture andprocedures performed by each component of the architectureduring diagnosis. Components of the architecture, as presentedinFig. 5, are Knowledge Base, Genetic-Neuro-Fuzzy InferenceEngine, and Decision Support Engine.3.1. Knowledge baseKnowledge base stores both static and dynamic interpretedinformation about the decision variables involved in the diag-nosis of TB. The component, comprising of the Database,Fuzzy Logic, Neural Network, and Genetic Algorithm, servesas a repository for operational data that are to be processed.3.1.1. DatabaseStructured database presents quantitative data about facts andthe established rules in the ﬁeld of medicine focusing on diag-nosis of TB. The facts comprise of signs and symptoms of TB,while rules are patterns to draw deductions based on availableinformation[18]. Unstructured database is heuristic in natureand hence gathered by experience, good practices, guesses,and judgments[34]. The database comprises of Patient-Bio-Data, Disease-Physical-Signs, Disease-Symptoms, Medical-History, Physical Examination, results of diagnostic tests andPatient Diagnosis.3.1.2. Fuzzy logicThe diagnosis process harnesses the strength of fuzzy logiccomponent in the following operational sequence:3.1.2.1. Fuzziﬁcation of input variables.Given a fuzzy setA, deﬁned as Eq.(2), represents TB diagnosis variables with ele-ment denoted byx
i, the fuzziﬁcation process involves trans-forming raw input value of each variable to a fuzzy term
X1
X2
XnW1
W2
W3
WnY1
Y2Input Hidden Output
Figure 3A simple neural network (Adapted from: Imianvan and Obi, 2012).
Population GenerationFitness EvaluationParent SelectionCrossover Mutation
Figure 4Basic operations of GA.30 M.O. Omisore et al.obtained from set [very mild,mild,moderate,severe,very sev- ere] deﬁned over the variables. That is, such values are derivedfrom functions deﬁned to determine the degree of membershipof each variable in the fuzzy set.A¼f ðx
i;lAðxiÞÞjx i2V;lAðxiÞ2½0;1/C138g ð2Þ Fuzziﬁcation is done using function deﬁned in Eq. (3)l
AðxiÞ¼1i fxi<a
xi/C0ab/C0aifa6x i<b
c/C0xi
c/C0bifb6x i<c0i fc<x
i8>>><>>>: ð3Þwherel
AðxiÞis the MF ofx iin A using triangular MF whilelA
is the degree of membership ofx iinA.a,bandcare the parameters of the MF governing its triangular shape and eachattribute is described with linguistic terms.3.1.2.2. Establishment of fuzzy rule base.The rule base for TBdiagnosis is characterized by a set of IF–THEN rules in whichthe antecedents (IF parts) and consequents (THEN parts)involve linguistic variables. The rules can be formulated withassistance of experts in the management of TB, or on consul-tation to existing standard literature. A rule can only ﬁre ifany of its precedence parameters such asvery mild,mild,mod- erate,severe, andvery severeevaluates toTRUE, otherwise it does not ﬁre.3.1.2.3. Fuzzy inference engine.This component controls thedecision making logic by applying suitable composition proce-dure from rule base to values of variable inputs received. Theinference engine applies composition procedure on the inputsto produce desired output, and Root Sum Square ( RSS), is applied to scale the functions at their respective magnitudeand computes a composite area. RSS is a method used to com-bine the effects of ﬁred rules in order to draw relevant infer-ence. It is computed with Eq.(4).RSS¼X
nk¼1ðR2kÞð 4ÞRkis a ﬁred rule wherek81;...;nis the Id of ﬁred rule3.1.2.4. Defuzziﬁcation of output values.Defuzziﬁcation of out-put values involves translating result from the inference engineinto crisp values which are, mostly, required by medicalexperts for proper analysis and interpretation, this aids efﬁ-cient diagnosis. This research employs Centroid of Area(CoA) technique for its defuzziﬁcation. This interface receivesthe output of inference engine as its input and ﬁnalizes compu-tation by applying Eq.(5).CoA¼
Pni¼1lYðx iÞxiPni¼1lYðx iÞð5Þ wherelYðx
iÞis degree ofiin a membership function andx iis the center value in function.The computational simplicity and intuitive plausibility ofthis approach gives rise to its adoption. For a complete medi-cal evaluation of TB disease, the variables considered afterconsultations with medical experts and other standard literalsources are categorized as presented inTable 1. 3.1.3. Neural networkNeural Network has the capability of capturing domainknowledge from available indicators and can readily handleboth continuous and discrete data. NN is used to train and testthe designed fuzzy system to optimize the performance of theoverall system. The NN component ofFig. 6is made up of variables fromPhysical Examination(PE), Medical History (MH), Laboratory Investigation(LI), and Chest Radiology(CR) of patients. Each diagnosis variable has a weight W
i
which shows its contribution in the diagnosis process.The raw information obtained from patients is fed into NNvia input layer and participation of each category of variablesis determined at a hidden layer of the network using:CAT
i¼XniAi/C3W Ai ð6ÞCAT
iisith category of variable, n is count of variables inCAT
i, andA iis theith diagnosis variable with weightW Ai.
Universe of Discourse
Unstructured knowledge Structured knowledgeUser Input Diagnosis Results
Knowledge Base
Decision Support System 
Cognitive Filter Emotional Filter
Genetic-Neuro-Fuzzy Inference EngineDatabase
Fuzzy Logic
Neural Network
Genetic AlgorithmResult Valida/g415onUSER INTERFACE
Figure 5Architecture of the proposed Genetic-Neuro-Fuzzy expert system.A Genetic-Neuro-Fuzzy inferential model 31Result of the output layer represents an overall output of diag-nosis by the NN component of the architecture shown inFig. 5. The output result is given by:Output
NN¼XniCAT i/C3W CAT i ð7ÞwhereW
CAT iis the connection weight ofCAT i
3.1.4. Genetic algorithmActually, NN provides a structure for combining the diagnos-tic parameters which could serve as a platform for the infer-ence engine, but a speciﬁc issue with NN is lack of deﬁniteway of determining the connection weights for hidden layerswhen dealing with a particular problem. A number of medicaldiagnosis had been assisted by neuro-fuzzy systems thoughsuch systems had been built based on trial and errors, thisincreases computation cost. In this study, genetic optimizationis performed to choose optimal values from a group of diag-nostic parameters which serve as input.Fig. 6shows there are 24 diagnostic parameters in the NN but the task is todecide which parameters are taken as input in order to mini-mize complexity.An individual chromosome consists of 24 genes and eachgene represents the connection weight of a diagnosis variablein a length of 1 bit. One feasible solution is to generate an ini-tial population holding a set of possible solutions from ran-dom chromosomes. A chromosome is represented as a vectorC=(C
A,...,C X) of binary decision variablesC i=0,2,3 ; encoded in binary representation as string consisting {0,1}genes. A geneC
i= 1 if theith variable is included in a solutionset of a diagnostic process otherwise 0. Fitness function is usedto optimize each chromosome by evaluating the genes thatconstitute the chromosome using their ﬁtness value.Table 1Categorization of diagnosis variables for tuberculosis.
Category Diagnosis variables Code Category Diagnosis variables CodePhysical Examination (PE) Swollen lymph nodes A
1 Medical History (MH) Meningitis B 9
Blood pressure A 2 Hoarseness B 10
Rale breathe A 3 Laboratory Investigation (LI) Sputum test C 1
Abnormal breast sounds A 4 Cerebrospinal ﬂuid test C 2
Medical History (MH) Loss of appetite B 1 Pus test C 3
Confusion B 2 Tuberculin skin test C 4
Cough B 3 Blood test C 5
Fever B 4 Biopsy test C 6
Chest pain B 5 Chest Radiography (CR) Plefus D 1
Weight loss B 6 Pulede D 2
Night sweat B 7 Cardrat D 3
Fatigue B 8 Zanﬂo D 4
OutputA4A3
C1
C6B1
D1
D4Physical Examination
Laboratory Investigation
Chest RadiologyWA2WA3
WA4
WB1
WB2A2
B2
WB10
C2WC1
WC2
WC6
D2
D3WD1
WD2
WD3
WD4WPE
WMH
WLI
WCR
Input Layer Hidden Layer Output LayerB10A1
WA1
Medical History
Figure 6Block diagram of NN for the diagnosis of TB diseases.32 M.O. Omisore et al.As evolutionary algorithm continues through its cycle, ﬁt-ness value of each chromosome keeps improving till it reachesan optimum value when it can no longer improve. Fig. 7shows chromosomes of some candidates and their ﬁtness values. Anumber of constraints have been considered in carrying outappropriate management of disease in medical diagnosis,therefore ﬁtness evaluation of chromosome must be done withproper constraint validation. Constraints can be termed asobjectives that must be achieved in which some render mostof the solutions from the search space hence, its applicationin GA is problem speciﬁc. Ordering constraint proposed in[35]is adopted in this study. The ﬁtness evaluation of an indi-vidualF(i) is done as:F
i¼1þXni¼0Wi/C3CiðpÞ !/C01
ð8Þwherenis the number of diagnosis variables,W
iis the weight associated withith variable andC
iðpÞis the number of viola-tions forith constraint at solutionp.This ﬁtness function has a range of [0,1] and an optimalsolution occurs when we have 0 violations thusP
ni¼0Wi/C3CiðpÞwhich results inF i¼1. Chromosomes withhigher ﬁtness value are selected as parents for mating in orderto produce outstanding candidates and maximize the ﬁtnessfunction. The probability of choosing an individual for geneticoperation is proportional to its ﬁtness, that is, if the ﬁtnessvalue of an individual isF
i, then the probability,P i, of choos- ing the individual is:P
i¼FiPn/C01i¼0Fið9ÞThis process is repeated until an optimal connection weight isachieved.3.2. Genetic-Neuro-Fuzzy Inference System (GENFIS)Genetic-Neuro-Fuzzy Inference System (GENFIS) is an infer-ential technique proposed to integrate GA, NN and FL com-ponents ofFig. 4to provide a self-learning and adaptivesystem for handling uncertain and imprecise data for diagnosisof tuberculosis. The inference system employs feed forwardpropagation learning technique made up of seven layers ofneurons as shown inFig. 8. Both hidden and output layersconsist of active nodes where computations take place, whilethe nodes at input layer are passive.The inference engine consists of reasoning algorithm drivenby the production rules based on Mamdani’s Inference Mech-anism. Of the seven layers, the ﬁrst one consists of active nodeswhich denote inputs to the system. The inputs are numeric val-ues representing how severe a patient feels the diagnosis vari-ables. The output of this layer is the linguistic labelscorresponding to each input value. The second layer is madeup of adaptive nodes that receive the output of preceding layeras input, and produce their corresponding membership gradedetermined as:L2ðxiÞ¼lAiðXiÞð10Þ The fuzzy value of each variable is computed using triangu-lar MF, given as:l
AiðxiÞ¼xi/C0ba/C0b ð11Þ whereaandbare the variables of the triangular MF thatbounds its shape such thatb6x
i6a.Third layer act as multipliers and their operations are ﬁxedand labeled asM. These nodes compute the ﬁring strengths ofassociated rules as:L
3ðXiÞ¼lAiðXiÞ/C3lBiðXiÞ/C3lCiðXiÞð12Þ In the fourth layer, nodes ﬁxed but they do normalize theﬁring strength of each rule. The normalized strength of a kth rule is determined as:L
4ðXiÞ¼WkP3j¼1Wjð13ÞThe product of normalized ﬁring strength of a rule and itscorresponding output value is observed in the ﬁfth layer todetermine the variable’s contribution to the diagnosis pro-cesses. This is done with Eq.(14).L
5ðXiÞ¼L 4ðXiÞ/C3L 3ðXiÞð14Þ The sixth layer consists of a single ﬁxed node labeled Y which represents the GENFIS’s ﬁnal output. It obtains thecumulative sum of all incoming signals as shown in Eq. (15). Y¼X
ni¼1L5ðxiÞð 15ÞFinally, we employed Eq.(16)to classify the crispy numericvalue in Eq.(15)as the system’s output, which represents thepatient’s diagnosis result.Output¼Very MildY60:2Mild 0:26Y<0:4Moderate 0:46Y<0:6Severe 0:66Y<0:8Very Severe 0:86Y61:08>>>>>><>>>>>>: ð16Þ1 0 0 0 1 0 1 0 0 0 1 0 1 1 1 0 0 0 1 0 1 0 1 0 C 1
1 1 1 0 0 0 1 0 0 0 1 0 0 0 1 1 1 0 1 0 1 1 0 0 C 2
0 0 0 1 1 0 1 0 1 0 1 1 1 0 0 0 1 1 0 1 1 C 3
1 0 1 0 0 0 1 1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 C KA B C D E F G H I J K L M N O P Q R S T U V W X Fitness
F1
F2
F3
Fk
Figure 7Chromosomes of the selected individual candidates and corresponding ﬁtness value.A Genetic-Neuro-Fuzzy inferential model 333.3. Decision support engineThe decision made by GENFIS is optimized by Decision Sup-port Engine (DSE) which takes the output of GENFIS asinput and tunes to ﬁt any diagnostic case at hand [37]. The sup- porting components of DSE are cognitive ﬁlter which objec-tively inﬂuences the result of GENFIS on conformance basiswith knowledge extracted from medical personnel, holdingassumptions and beliefs with heuristics in medical ﬁeld andemotional ﬁlter that refers to subjective feelings of a medicalpersonnel based on physical and psychological elicited frompatient. Emotional ﬁlter provides information that helps med-ical personnel to decide whether a diagnostic result from GEN-FIS is as a result of the patient’s situation or environmentalinhibiting factors.4. Model simulation and evaluationSimulation of the proposed model was done with a case studyof 10 patients from Saint Francis Catholic Hospital Okpara-In-Land, Delta State, Nigeria. The procedure was observedin Matrix Laboratory (MATLAB) Version 7.9 environment,the result and evaluation of the simulations are reported in thissection.4.1. SimulationIn order to evaluate the performance of the proposed model,medical records of 100 patients’ representing their state ofhealth with respect to TB were formulated and stored as rulesin the database. Each rule is made up of 24 input variables andan output variable. To determine the output value of each rule,the records were retrieved and assessed by domain experts inhuman respiratory diseases. Assessment was based on intensityof the input variables and the expertise of the (human) expert.Intensity of each variable represents its contribution to TBinfection, rating was thereafter done based on linguistic termsshown inTable 2.Result obtained from fuzziﬁcation of variables serves asinput to the neural network. Each node in the network is athree-layered feed forward architecture which interacts witheach other as shown inFig. 8. Back-propagation algorithmwith sigmoid function is used to train the NN for hiddenand output layer neurons’ transformation. The NN trainedby the subsystem consists of 24 nodes at the input layer, eachrepresenting unique TB variables considered in this study. Todetermine an optimal number of variables needed for a diag-nosis, GA component of the proposed GENFIS takes all vari-ables as input and optimizes them into just N variables whosevalues have role to play in the diagnosis. Hence, the genotypeis represented by a sequence of symptoms as described earlier.During simulation, binary-matrix vectors with length n were created. Each element of the vector corresponds to speci-ﬁc diagnostic parameters in NN. The binary bit of a diagnosticparameter is determined using:b
i¼1 Selected0 Ignored/C26 ð17Þ.. . .. . .. . .. . 
FGenetic AlgorithmN Very Mild
Mild
Moderate
Severe
Very SevereM
N Very Mild
Mild
Moderate
Severe
Very SevereM
Figure 8Combinatorial model for Genetic-Neuro-Fuzzy Inference System.
Table 2Intensity of diagnosis variables.
LinguistictermVerymildMild Moderate Severe Verysevere Intensity 1 2 3 4 534 M.O. Omisore et al.Hence, if the value of a parameter is equal to 1 then thevariable will be selected otherwise not. In this simulation, theGA used selected values given inTable 3to ﬁnd optimal solu-tion and once a complete set of optimal value for the parame-ters is reached, the GA processes stops. High mutationprobability used in the parameter settings is a brain behindbringing new individuals at each stage hence, to avoid a sce-nario whereby best combination will only be from initial indi-viduals who passed ﬁrst selections.4.2. Result and evaluationMedical records of 10 patients from the Hospital of our casestudy were taken as testing data for the system. Resultobtained from simulation indicates that GA component ofthe proposed model can extract a maximum of 13 out of 24parameters as the best combination. As shown in Table 4, selected parameters show that the model is sensitive to radio-graphic variables. The variables were selected for all cases withdiagnosis result above 50%. Diagnosis of records R04, R09,and R10 by the model shows that patients possessing suchattributes have tuberculosis infection.Result of this simulation procedure was validated byhuman experts and their response using metrics proposed insome previous studies. Human responses presented in Table 5 shows an expert either accepts the model’s result by assigning‘‘p”or rejects it with ‘‘x”.I n[36], sensitivity is a quality ofNeuro-Genetic model used to check the effects of selectedparameters on a trained NN with evaluation function.Given a True Positive value (TP) that represents the num-ber of patients with tuberculosis as agreed by both model andhuman expert, a True Negative value (TN) indicating the num-ber of patients where agreement could not be reached by bothmodel and human expert, and TNR as the total number ofrecords; the sensitivity and accuracy of GENFIS are:Sensitivity¼TPTNR/C3100%ð18ÞAccuracy¼
TPþTNTNR/C3100%ð19Þ FromTable 5, the sensitivity and accuracy of the proposedGENFIS are 60% and 70%.5. ConclusionThe use of soft computing techniques in medical diagnosis can-not be overemphasized as they have greatly imparted the pro-cesses in medical diagnosis and aided an increase in diagnosisaccuracy. This novel study demonstrated how an aggregationof such technique can assist in the diagnosis of TB. In theapproach, cognitive and emotional ﬁlters were adapted to takecare of contextual factors that often affect medical expert duringdiagnosis of diseases in the traditional and conventional ways.This study shows that a combination of the soft computingmethods can offer a more effective system of medical diagnosiswith improved system accuracy. For instance, [32]validated a fuzzy-based expert system for tuberculosis diagnosis with 61%accuracy. Also, in[24], a neuro-fuzzy decision support modelfor therapy of heart failure was conducted and a sensitivityanalysis conducted shows that diagnosis done by the modelhas a high concordance of 60.72% with physician’s diagnosisat an accuracy of 57.14%. Unlike the proposed model, existingsystems does not have a thorough scope in terms of data set ordiagnosis depth and on a general sense, the model exhibits arelatively higher performance when compared with existingsystems hence, depicting a more reliable results.Table 3Parameters used in ﬁnding optimal solution.
S/No Parameters Value1 Number of generations 202 Number of individuals 403 Crossover probability 0.554 Mutation probability 0.35
Table 4Results from selected parameters in the proposed model.
Id A 1A2A3A4B1B2B3B4B5B6B7B8B9B10C1C2C3C4C5C6D1D2D3D4Result R 0 1 01000010001000 1001000 0 1 0 0.350 R 0 2 10000000000000 1100000 0 0 0 0.296 R 0 3 01001010100001 0010001 0 0 0 0.381 R 0 4 10010110001010 1001011 1 1 1 0.814 R 0 5 00000001000000 0000000 0 0 0 0.174 R 0 6 00001000010000 0100001 0 0 0 0.313 R 0 7 01000100000010 0000000 0 0 0 0.280 R 0 8 10100001000101 0010000 0 0 0 0.412 R 0 9 00010010001000 1001001 1 1 1 0.660 R 1 0 10010010001000 1001001 1 1 1 0.717
Table 5Validation of GENFIS simulation results.
Record Id R01 R02 R03 R04 R05 R06 R07 R08 R09 R10Result 35.0% 29.6% 38.0% 81.4% 17.4% 31.3% 28.0% 41.2% 66.0% 71.7%GENFISpppp xpxxpp Human xppppp xpppA Genetic-Neuro-Fuzzy inferential model 35So well so good, this study demonstrates how triangularmembership functions of fuzzy logic system can be employedto deﬁne linguistic labels and neural networks were introducedfor self-tuning and adaptation in case of new situations. Also,for effective selection of optimal input parameters, GeneticAlgorithm has been incorporated. Yet, the effectiveness ofthe model has only been validated using casual TB recordsbecause the rule base of the knowledge base was formulated.To further validate the results of this model, sufﬁcient real-life records of TB patients can be obtained from medical clinicsin order to generate rules and training data sets.AcknowledgmentsWe thank the management of St. Francis Catholic HospitalOkpara-In-Land, Delta State, Nigeria, for their utmost coop-eration in the area of data collection. We also appreciate theefforts Dr. Ahmed of Obafemi Awolowo University TeachingHospital Complex, Wesley Guild Unit, Ilesa, Osun State,Nigeria, for his assistance on rule-base formulation and pro-posed model performance evaluation.Appendix A. Supplementary materialSupplementary data associated with this article can be found,in the online version, athttp://dx.doi.org/10.1016/j.aci.2015.06.001.References
[1]C.A. Robert, J.E. Buikstra, The Bio-Archaeology ofTuberculosis: A Global Perspective on a Re-Emerging Disease,University Press of Florida, Gainesville, Fl, 2009
. [2]
David M. Morens, Gregory K. Folkers, Anthony S. Fauci, Thechallenge of emerging and re-emerging infectious diseases,Nature 430 (2004) 242–249
.[3] World Health Organization, WHO Country CooperationStrategy: Federal Republic, 2002.[4] World Health Organization, Global Tuberculosis Control,WHO Report 2008, Geneva, 2008.[5]
P. Sudre, G.T. Dam, A. Kochi, Tuberculosis: a global overviewof the situation today, Bull. World Health Organ. 70 (1992) 149–159
.[6]
American Thoracic Society, Diagnostic standards andclassiﬁcation of tuberculosis in adults and children, Am. J.Respir. Crit. Care. Med. 161 (2000) 1376–1395
. [7]
Syed Tasleem, Gulraiz Ali, Farzana Mahdi SikandarHasan,Molecular diagnosis of tuberculosis: a new primer design, Iran.J. Clin. Infect. Dis. 4 (2) (2009) 105–108
. [8]
Young S. Kim, Donald E. Shelton, Gregg Barak, Studying jurorexpectations for scientiﬁc evidence: a new model for looking atthe CSI myth, J. Am. Judges Assoc. 47 (1–2) (2011) 8–18
. [9]
S.A. Oke, A literature review on artiﬁcial intelligence, Int. J. Inf.Manage. Sci. 19 (4) (2008) 535–570
. [10]
V.P. Masnikosa, The fundamental problem of an artiﬁcialintelligence realisation, Cybernetes 27 (1) (1998)
. [11] W.E. Halal, Artiﬁcial intelligence is almost here, On theHorizon, The Strategic Planning Resource for EducationProfessionals, vol. 11(2), 2003.[12]
Y. Peng, X. Zhang, Integrative data mining in systems biology:from text to network mining, Artif. Intell. Med. 41 (2) (2007) 83–86
.[13]
X. Zhou, B. Liu, Z. Wu, Y. Feng, Integrative mining oftraditional chinese medicine literature and medline forfunctional gene networks, Artif. Intell. Med. 41 (2) (2007) 87–104
.[14]
J. Sutojo, E. Mulyanto, V. Suhartono, KecerdasanBuatan,Penerbit ANDI Publisher, Yogyakarta, 2011
. [15]
A. Ajith, Nature and scope of AI techniques, in: H.S. Peter, T.Richard (Eds.), Handbook of Measuring System Design, JohnWiley & Sons, Ltd., USA, 2005
.[16] V. Cecilia, K. Fabio, Intelligent and expert systems in medicine –a review, in: XVIII CongresoArgentino de Bioingenierı ´a SABI 2011 – VII Jornadas de Ingenierı´aClı´nica Mar del PlataSara, 28–30 of September 2011, 2011, pp. 326–331.[17] N. Mehdi, Y. Mehdi, Designing a fuzzy expert system fordiagnosing the hepatitis B intensity rate and comparing it withadaptive neural network fuzzy expert system, in: Proceedings ofthe World Congress on Engineering and Computer Science(WCECS), vol. 11, San Francisco, USA, 2009.[18]
O.W. Samuel, M.O. Omisore, B.A. Ojokoh, A web baseddecision support system driven by fuzzy logic for the diagnosisof typhoid fever, Exp. Syst. Appl. 40 (2013) (2013) 4164–4171
. [19]
A. Imianvan, F. Anosike, C. Obi, An expert system for theintelligent diagnosis of HIV using fuzzy cluster means algorithm,Glob. J. Comp. Sci. Technol. 11 (12) (2011) 73–80
. [20]
B.K. Bose, Modern Power Electronics and AC Drives, Prentice-Hall, Upper Saddle River, NJ, 2002, pp 44
. [21] J. Zhao, B.K. Bose, Evaluations of membership functions forfuzzy logic controlled induction motor drive, in: Proceedings ofthe IEEE, 2002.[22]
B.A. Ojokoh, M.O. Omisore, O.W. Samuel, T.O. Ogunniyi, Afuzzy logic based personalized recommender system, Int. J.Comp. Sci., Inf. Technol. Sec. 2 (5) (2012) 1008–1015
. [23]
T.O. Oladele, J.S. Sadiku, R.O. Oladele, Coactive neuro-fuzzyexpert system – a framework for diagnosis of malaria, Afric. J.Comput. ICT 7 (2) (2014) 174–188
. [24]
O.U. Obot, F.M. Uzoka, O.C. Akinyokun, J.J. Andy, A neuro-fuzzy decision support model for therapy of heart failure, Int. J.Med. Eng. Inform. 6 (4) (2014) 319–334
. [25]
A. Kadhim, A. Alam, H. Kaur, Design and implementation offuzzy expert system for back pain diagnosis, Int. J. Innov.Technol. Creat. Eng. 1 (9) (2011) 16–22
. [26]
A. Barwad, P. Dey, S. Susheilia, Artiﬁcial neural network indiagnosis of metastatic carcinoma in effusion cytology,Cytomet. B Clyn Cytom. 82 (2012) 107–111
. [27]
P. Dey, A. Lamba, S. Kumari, N. Marwaha, Application of anartiﬁcial neural network in the prognosis of chronic myeloidleukemia, Anal. Quant. Cytol. Histol. 33 (6) (2012) 335–339
. [28]
K. Vahid, A.M. Gholam, Artiﬁcial Intelligence in Medicines,Information Technology Department, School of Engineering,Terbiat Moderas University Tehran, Iran, 2009
. [29] A.J. Ramirez, B.D. Knoester, B.H.C. Cheng, P.K. McKinley,Applying genetic algorithms to decision making in autonomiccomputing systems, in: Proceedings of the 6th InternationalConference on Autonomic Computing and Communications(ICAC’09), Barcelona, Spain, June 15–19, 2009, 2009.[30]
E. Lo´pez-Gonza´lez, M.A. Rodrı´guez-Ferna´ndez, C. Mendan˜a- Cuervo, The logistic decision making in management accountingwith genetic algorithms and fuzzy sets, Mathw. Soft Comput. 7(2000) 229–241
.[31]
K. Rajeswari, M. Shindalkar, N. Thorawade, P. Bhandari, DSSusing apriori algorithm, genetic algorithm and fuzzy logic, Int. J.Eng. Res. Appl. 3 (4) (2013) 132–136
. [32]
X.Y. Djam, Y.H. Kimbi, A medical diagnostic support systemfor the management of hypertension, J. Sci. Multidisc. Res. 3(2011) 16–30
.[33]
V. Ekong, E. Onibere, A. Imianvan, Fuzzy cluster means systemfor the diagnosis of liver diseases, Int. J. Comp. Sci. Technol. 2(3) (2011)
.[34]
J. Ermine, Expert System: Theory and Practice, Prentice Hall ofIndia, New Delhi, 1995
.36 M.O. Omisore et al.[35] H.L. Fang, Genetic Algorithms in Timetabling Scheduling,Doctoral Thesis, University of Edinburgh, UK, 1994.[36]K. Priya, T. Manju, R. Chitra, Predictive model of strokedisease using hybrid neuro-genetic approach, Int. J. Eng. Comp.Sci. 2 (3) (2013) 781–788
.[37]
L. Bechoo, R. Chandrahauns, An empirical analysis onperformance evaluation of decision support system (DSS) inbusiness process reengineering, Int. J. Adv. Res. Comp. Sci.Softw. Eng. 3 (7) (2003) 1093–1097
.[38]H.G. Sol, Expert systems and artiﬁcial intelligence in decisionsupport systems, in: Proceedings of the Second Mini-EuroConference, 17–20 November 1985, Springer, Lunteren, TheNetherlands, 1987, pp. 1–2
.[39]
A. Agunwamba, D. Bloom, A. Friedman, M. Ozolins, L.Rosenberg, D. Steven, M. Weston, Nigeria: The NextGeneration: Literature Review, Havard School of PublicHealth, British Council of Nigeria, 2009, pp. 57
.A Genetic-Neuro-Fuzzy inferential model 37