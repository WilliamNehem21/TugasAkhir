Narrowly avoided cusp catastrophes in Least Squares OrthogonalDistance Fitting
Alvin Penner
Fonthill, ON, Canada
ARTICLE INFO
MSC:65D1758K35Keywords:Least squares orthogonal distance ﬁtting Beta2-splineCusp catastropheCritical pointsTopologyStreamlinesParametric functionTranscritical bifurcationABSTRACT
Computer animation often requires that complex objects need to be modeled by ﬁtting them with simpler shapes such as splines. It is necessary that these simpler shapes respond continuously as the object changes shape. Thisresponse can become complex if the topology of the error function is changing. The topological events which canoccur when a spline isﬁt to a changing object are classiﬁed and analyzed, with a view towards de ﬁning conditions which make them possible. The Least Squares Orthogonal Distance Fitting (ODF) method is used to ﬁta continuous parametric function whose shape is changing. The ﬁt is performed using a closed-shape Beta2-spline. Three types of topological events can occur: self-annihilation of two solutions, simultaneous merge of three so-lutions into one, and crossover of two solutions in which a local minimum and saddle point interchange roles. Theevents can be detected and classiﬁed by inspecting the determinants of two second-order response matrices. The last two types of event occur only within sub-manifolds de ﬁned by additional constraints not normally present in the ODF solution. The nature of these constraints is de ﬁned. The constrained events are interpreted in the context of catastrophe theory, which describes dynamical systems that can exist in multiple states with the possibility ofdiscontinuous transitions between them. Within this theory they appear as narrowly avoided cusp catastrophes.
1. IntroductionWhen developing a computer animation of an object whose shape ischanging, it may be necessary toﬁrst approximate the shape using a set ofsplines which are more easily rendered than the original object. As theobject’s shape changes, two types of unexpected events may occur. First,in order to produce aﬁt whose error is minimized, it may be necessary toundergo discontinuous changes in theﬁtting parameters. Second, the topology of the solution set may change due to solutions merging,crossing each other, or being created. We investigate these events usingthe Least Squares Orthogonal Distance Fitting method (ODF). It is typi-cally used toﬁt a spline to a set of discrete shape data [ 1]. Here we will use it to generate solutions that undergo changes in topology when we ﬁt a spline to a continuous two dimensional curve whose shape is changing.Three types of topological events will occur. The most common event isthe annihilation of two solutions where one is a local minimum and theother is a saddle point [[2], p.63]. This can be described as a fold ca- tastrophe[3]. Less common is an event in which two equivalent solutions(for example, saddle points) terminate when they meet a local minimum,leaving only a single saddle point. In this case the two equivalent solu-tions will have a symmetry that is twofold less than the solution they aremeeting. Finally, the most unusual event is one in which a saddle pointmeets a local minimum, both with the same symmetry, and they inter-change roles. This will be described below as a narrowly avoided cusp catastrophe[3,4].Thefold catastropheevent does not require any additional constraintsto be met when it occurs: it happens simply as a result of the shapechange. The last two types, however, cannot occur unless additionalconstraints are present. We will present two different views of theseadditional constraints. Theﬁrst view is algebraic and takes the form of arequirement that an“augmented”second-order response matrix must besingular. The second view is geometric and takes the form of a plot of asolution path relative to a catastrophe boundary. The algebraic method isdesirable because it is a precisely deﬁned local test. However, the ca- tastrophe theory interpretation has a qualitative advantage in displayingthe relationship between multiple events: in the third type of eventdescribed above, where a local minimum and saddle point interchangeroles during a narrowly avoided cusp catastrophe, we ﬁnd that the interchange is always followed closely by a standard fold catastrophe inwhich a local minimum and saddle point coalesce and disappear. Thealgebraic method is not capable of linking these two events, but the ca-tastrophe theory plot,Fig. 1, makes it qualitatively clear that these two
E-mail address:penner@vaxxine.com.
Contents lists available atScienceDirect
Array
journal homepage:www.elsevier.com/journals/array/2590-0056/open-access-journal
https://doi.org/10.1016/j.array.2020.100046Received 9 June 2020; Received in revised form 26 September 2020; Accepted 21 October 2020Available online 3 November 20202590-0056/©2020 The Author(s). Published by Elsevier Inc. This is an open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-
nc-nd/4.0/ ).Array 8 (2020) 100046events are related, and that it is highly unlikely that a solution crossovercould occur without the associated fold catastrophe. Fig. 1displays a system which has two independent degrees of freedom, A and B. Thesolution, x, is a value that extremizes a potential energy function indynamical systems, or in our case extremizes an error function. It mayconsist of either one or three values. If three solutions exist, one of them(dotted line) will be unstable, while the other two (solid lines) are stable,with the possibility of discontinuous jumps between them. The boundarybetween these regions is shown as a curved line when projected onto theA-B plane. The blue trajectory is a solution path that contains both a foldcatastrophe and a crossover event between stable and unstable solutions,which has also been projected onto the A-B plane to show how it touchesthe boundary.Events of this type are well-known in topology, where they are clas-siﬁed as being either“birth/death”events [5]o r“interchange”events in which the critical points survive. The interchange event is signi ﬁcantly more complex, and has been variously described as a switch [ 6], swap [[7],Fig. 6], orF
1β[[8], Fig. 3.1]. What is missing from these topologicaltreatments is a speciﬁcation of the constraints that need to be satis ﬁed if the two critical points are to,ﬁrst of all, touch, and secondly, survive andinterchange. These events are also well-known in bifurcation theory [ 9, 10], where an“interchange”event would be termed atranscritical bifur- cation. In this case, some examples of the constraints that need to besatisﬁed are given at the end of Sec.5. The goal of the present study is to deﬁne analogous constraints in the context of ODF. We will encountertwo distinct types of constraints (Secs. 6 and 7) which are suf ﬁcient to allow this to happen, in a problem which is otherwise quite simple.The remainder of this paper is organized as follows. In Sec. 2we derive the generic ODF method, suitable for ﬁtting a continuous function. The family of curves we areﬁtting is described in Sec.3, and the spline curve in the ODF method is specialized to be a closed-shape Beta2-spline[11]. Details of the optimization procedure are in Sec. 4, along with re- sults. Sec.5deﬁnes the types of topological events that occur. Sec. 6 analyzes a symmetry-breaking event, while Sec. 7analyzes a crossover event. These sections contain explicit deﬁnitions of the constraints that are satisﬁed in each case. Sec.8casts the above events into the languageof catastrophe theory.2. Applying ODF to a parametric functionFor the ODF method we follow closely the development of [[ 12],Ch.2], which is a modiﬁed version of [1], to deal with theﬁtting of continuous curves rather than discrete data. De ﬁnefða;uÞ¼ðfx;fyÞas the two-dimensional spline we are adjusting to perform the ﬁt, whilegðtÞ¼ ðg
x;gyÞis a known parametric function to beﬁt.fhas adjustable pa- rametersa, and a parametric variableu2½0;N/C138whereNis the number of segments, whilegwill be chosen to be a superellipse [ 13] with para- metric variablet2½t
1;t2/C138.ghas an adjustable parameter ε, which we will use to change the shape of the curve in order to see how the ﬁtted spline responds. At each value oftwe deﬁne the residual error asjjfða;uÞ/C0 gðtÞjj. In the ODF method we must adjust uðtÞto minimize this distance, which leads to the constraint:ðfða;uÞ/C0gðtÞÞ /C1f
0ða;uÞ¼0: (1)wheref
0ða;uÞ¼ ∂f=∂u. This simply states that the residual error vectorwill be perpendicular to the curvefða;uÞ. The error functional isFða;uÞ¼
12Zt2
t1ðfða;uÞ/C0gðtÞÞ /C1ðfða;uÞ/C0gðtÞÞdt:(2)We will optimizeFwith respect to changes inawhile ensuring that Eq.(1)is satisﬁed at all times. The optimization uses the Newton method[[14], p.348] which relies on the fact that Fcan be locally approximated by a quadratic form:F¼F
0þLtaþ12atMa (3)wherea
t¼ða 1;…;a nÞ,Lt¼ðL 1;…;L nÞ,L i¼dF=da i, andM¼ fd
2F=da idajgni;j¼1. The aim of the optimization is toﬁnd the critical points whereL¼0, while the rate of convergence to the optimum solution willbe governed by the second-order response matrix M. The character of the solution, whether it is a minimum or saddle point, will be determined bythe eigenvalues ofM. These eigenvalues are a measure of the curvature ofFwhen moving in the direction of the corresponding eigenvector. ThegradientLcan be expressed [[12], Ch.2] asL
i¼Zt2
t1ðfða;uÞ/C0gðtÞÞ /C1 ∂f/C30∂aidt (4)while the second order response is obtained [[ 12], Ch.2] asM
ij¼Rt2
t1
Gijða;uÞdt, whereG
ij¼∂f/C14∂ai/C1∂f/C14∂ajþðfða;uÞ/C0gðtÞÞ /C1 ∂2f/C14∂ai∂aj/C0EðuÞ∂u/C14∂ai/C0∂u/C14∂aj/C1:(5) This contains the Hessian [[14], p.340] term
∂2f=∂ai∂aj, and a term in
∂u=∂aið∂u=∂ajÞ, which represents the contribution caused by the fact thatEq.(1)is satisﬁed at all times. To evaluate this term we use the rela-tionship [[12], Ch.2]:EðuÞ
∂u=∂ai¼/C0f0ða;uÞ/C1∂fða;uÞ= ∂ai/C0ðfða;uÞ/C0gðtÞÞ /C1 ∂f0ða;uÞ= ∂ai(6)whereEðuÞ¼f
0ða;uÞ/C1f0ða;uÞþðfða;uÞ/C0gðtÞÞ /C1f00ða;uÞ:(7) The optimization proceeds [[12], Eq.2.9] by successively solving theequationMða/C0a
0Þ¼ /C0L (8)to calculate the latest increment in the vector a, given the previous es- timatea
0. The system of equations, Eq.(1)and Eq.(8), are solved using the“variable-separation”method [1] with a tolerance of 10
/C09in both the inner and outer loops. Further computational details are available in[[12], Ch.2].Fig. 1.Example of a cusp catastrophe, with a solution trajectory that containsboth a fold catastrophe and a crossover event between stable and unsta-ble solutions.A. Penner Array 8 (2020) 100046
23. Deﬁnition of spline f(a, u) and parametric curve g(t)The functiongðtÞis taken from the family of curves inFig. 2. These are superellipses [13]:gðtÞ¼ðaðcostÞ
ε;aðsintÞεÞ (9)where we will seta¼180 to facilitate comparison with [15] for the case of a circle (
ε¼1). The curves have a fourfold rotation symmetry and areﬂection symmetry about an axis at 45
/C14. This symmetry is denotedC 4vin [[16], p.60]. We will attempt toﬁt the curves over the range 0<
ε<2, which allows the curvature at some endpoints to range from zero toinﬁnity.When specifyingfða;uÞwe need to use at least an 8-point uniformclosed cubic B-spline, in order to emulate the symmetry of gðtÞ. We also wish to produce aﬁt that is accurate to 6th order with respect to arc angleof each segment [17]. This requires that the curvature at each knot mustbe independently variable, which is not possible in a B-spline. Wetherefore generalize to a Beta2-spline, which relaxes the continuity re-quirements at a knot fromC
2toG2(geometric continuity) [[11], p.294]. We will decompose the Beta2-spline into eight cubic B /C19ezier segments, and constrain the B/C19ezier control arms to be consistent with[[11], Eq.14.3] withβ
1¼1. Note that this spline is not clamped togðtÞat any point, and that the slopes at each knot are not constrained. Therefore,deﬁne the parameter vectorausing the eight B/C19ezier endpoints and the correspondingβ
2values:a¼fx 0/C0x 7;y0/C0y 7;β20/C0β27g. If we deﬁne a B/C19ezier segmenti,Fig. 2, with the four control points fR
0i/C0R 3ig, then the control arm at the start point of this segment isgiven byd
i¼R 1i/C0R 0i. The control arms are symmetric at each nodesinceβ
1¼1[ [11], Eq.14.2]. Therefore the control arm at the endpoint ofthis segment, namelyR
2i/C0R 3i, is equal to/C0d iþ1, so it is redundant. From [[11], Eq.14.3] weﬁnd that the components (d
xi,dyi) of these control arms can be evaluated independently using the equation:Δw¼Cd
wforw2fx;yg (10)whereΔw
i¼w ðiþ2Þmod 8 /C0w ifori2½0;7/C138. The matrixCis given by:C
ij¼8>><>>:1 forj¼iandi2½0;7/C1384þβ2i=2 forj¼ðiþ1Þmod 81 forj¼ðiþ2Þmod 80 otherwise: (11)The relationship betweend
iandβ2iis generally an inverse one: higher β
2i(sometimes referred to astension[[11], p.307]) leads to shorter B/C19ezier arm lengthd
i. For the special case where allβ2iare the same, weﬁnd that Cis singular atβ
2i¼/C04. Therefore we anticipate that (roughly) /C04<β2i<∞. These are consistent with the limits highlighted in the work ofde Tisi and Rossini [18]. In practice, the lowest value observed here isβ
2¼/C03:995 for a solution with radial symmetry, which did not lead toan abnormal termination, while the upper limit was approached on ﬁve occasions, all of which led to abnormal terminations of the solution.4. Optimization of a Beta2-SplineThe optimization requires theﬁrst-order response, Eq.(4), where
∂
fða;uÞ= ∂aiis given by the special cases:df
w.dw
i¼∂fw.
∂wiþX
j/C0∂fw/C14∂dwj/C1∂dwj.
∂wiforw2fx;yg(12)df
w.dβ
2i¼X
j/C0∂fw/C14∂dwj/C1∂dwj.
∂β2iforw2fx;ygwhere the summation includes only two B /C19ezier control arms,d
j, per segment. The terms
∂fw=∂wiand∂fw=∂dwjare straightforward functions only ofu. From Eq.(10)we obtain:
∂dwj.
∂wi¼C/C01j;ði/C02Þmod 8 /C0C/C01j;iforw2fx;yg(13)
∂dwj.
∂β2i¼/C0C/C01j;ði/C01Þmod 8 dwi.2forw2fx;ygThe response
∂f0ða;uÞ=∂aiin Eq.(6)is obtained directly from this by differentiation. The Hessian terms
∂2f=∂ai∂ajin Eq.(5)are zero unless they involve
∂=∂β2:d
2fw.dw
idβ2j¼X
kð∂fw=∂dwkÞ∂2dwk.
∂wi∂β2jforw2fx;yg(14)d
2fw.dβ
2idβ2j¼X
kð∂fw=∂dwkÞ∂2dwk.
∂β2i∂β2jforw2fx;ygwhere the summation includes only two B /C19ezier control arms. Application of the operator
∂2=∂wi∂β2jor∂2=∂β2i∂β2jto Eq.(10)leads to:
∂2dwk.
∂wi∂β2j¼/C0C/C01k;ðj/C01Þmod 8 ∂dwj.
∂wi.2forw2fx;yg(15)
∂2dwk.
∂β2i∂β2j¼/C0C/C01k;ði/C01Þmod 8 ∂dwi.
∂β2j.2forw2fx;yg/C0C
/C01k;ðj/C01Þmod 8 ∂dwj.
∂β2i.2:This completes the calculation of the optimization equations.The results of the optimization are best displayed in radial co-ordinates. The radius of the B/C19ezier endpoints is not very informative sinceit is always very close to the corresponding radius of gðtÞ. The angle of the endpoints, however, gives useful information on symmetry. The functiongðtÞhas eightfold symmetry,C
4v, but the solutionfða;uÞmay have lower symmetry than this. If so, then the solution set will always containmultiple branches which are complements of each other with the sameroot-mean-square (rms) error, such that the set of all complementarybranches hasC
4vsymmetry.Fig. 3shows the variableθ 0for the B/C19ezier endpointðx
0;y0Þover the range 0:6< ε<1:4. The B/C19ezier endpoints are indexed starting in the fourth quadrant, so typically /C090<θ
0<0. The ﬁgure shows two branches that have C
4vsymmetry: a“radial”branch with variableθ
0(θ1¼/C090/C0θ 0andr 0¼r1), and an“angular”branch withr
0<r1andθ 0¼/C045 (θ 1¼0). Typical B/C19ezier endpoints for these two branches are shown inFig. 2for
ε¼0:6. These are the only two branches that have the full eightfold symmetry. In addition there are twobranches with fourfold rotational symmetry, C
4. These come in pairs which are reﬂections of each other about an axis at 45
/C14. They are termed “bridge”solutions because they can connect the angular and radial
Fig. 2.A family of superellipse curves at different ε. The points are B/C19ezier endpoints for two solution branches at
ε¼0:6. Also shown is a typical B/C19ezier segment with endpoints (R
0;R3) and control points (R 1;R2).A. Penner Array 8 (2020) 100046
3branches of higher symmetry. The left bridge solution, which exists onlyfor
ε<1, is approaching an angular solution at ε¼1. The right bridge solution, which begins as a bifurcation from the radial branch at
ε¼ 1:308, will touch an angular solution at
ε¼1i nFig. 4, and then approach a different angular branch at
ε¼1 after reversing direction at
ε¼0:978. These are never optimal solutions but serve an essential to-pological function which will be deﬁned below.Fig. 3does not contain much information on the eightfold symmetricbranches, other than an afﬁrmation of the symmetry. The details of theshape are given by theβ
2ivalues. Since we have nothing to compare theβ
2iwith, we choose to re-express them as B /C19ezier control arm lengths,d i¼ jd
ij, using Eq.(10). For the special case of a circle, ε¼1, these arm lengths can be compared directly to [[ 15],Fig. 6]. There are very slight differences due to the fact that the current Beta2-spline is not clamped atthe endpoints, but otherwise the two sets of solutions are qualitativelythe same for the case of a circle. In Refs. [ 15] the“angular”solutions for the circle were subdivided into two classes: an “S-shaped”branch which includes both a symmetric (d
0¼d 1) solution which is a local minimumand two asymmetric branches which are also local minima, but lessoptimal, and an“oval-shaped”branch which contains two saddle points.This terminology is used in the currentﬁt as well.Fig. 4shows the armlengths for the range of interest. For the S-shaped and Oval branches, d0
andd 1are distinct, for the Radial branch they are equal, and for theBridge solutions they interchange places as we switch between the twocomplementary branches of the solution.A primary goal of the current study is to analytically distinguish be-tween the S-shaped and Oval branches, since they are qualitativelydifferent, and since they intersect at
ε¼0:96323. The S-shaped branch is qualitatively obtainable byﬁtting curvature at the B/C19ezier endpoints, while the Oval branch is qualitatively the result of extremizing the <y
0> moment of the B/C19ezier curve [15]. A secondary goal is to understand theconstraints that make the bifurcation of the Radial branch at
ε¼1:308 possible.Fig. 5shows the rms error. For
ε>1 there areﬁve distinct unexpected terminations of either the S-shaped or Oval branches caused by β
2→∞, with eitherd
0ord 1approaching zero. There is also one instance of anarrowly avoided singularity caused by β
2→/C04 in the Radial solution at
ε¼1:69. However, the choice of optimum solution is unambiguous for
ε>1. For ε<1 the optimum solution path has a discontinuous jumpfrom the S-shape branch to the Oval branch at
ε¼0:953 followed by a continuous crossover of these two branches at
ε¼0:96323, which will be investigated below. The Oval branch also has a fold catastropheat
ε/C250:91, which terminates in a manner that is consistent with [[ 2], p.67], namelyΔF∝ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃð
ε/C0ε0Þ3q, where
ε0is the point where the merge occurs.5. Two types of topological eventsFor each solution branch, the eigenvalues of Mdetermine whether the solution is a minimum or saddle point. More generally, the Morse index[[2], p.55], which counts the number of negative eigenvalues [[ 19], Sec.3], will determine the multiplicity of the saddle points, if they exist.Since the object we areﬁtting is a closed shape, we anticipate that thenumber of local minima at each
εshould equal the number of saddlepoints.Fig. 6shows the lowest eigenvalues,eig
0, for the four types of branches. The plot often has cusps because it is quite common fordifferent eigenvalues of the same solution to cross each other withoutinteracting. We are interested only in the instances where an eigenvaluecrosses zero or terminates at zero, which signals a topological event. Therule for these events (if higher order saddle points are involved) is thatEuler’s characteristicnumber [19] must be preserved [[20], Fig. 3–22, p.149]. In simplest terms this states that one local minimum must cancelone saddle point, which is the case for a fold catastrophe, or that a singlesaddle point must cancel a“2-saddle point”(Morse index¼2) [19]. In Fig. 6, we see that at
ε¼1.4 the S-shape solution is a local minimum and
Fig. 3.B/C19ezier end point angleθ 0as a function of ε. Three solution branches are shown.
Fig. 4.B/C19ezier control arm lengthsd 0andd 1as a function of ε. The Angular solution branch is subdivided into S-shape and Oval branches.
Fig. 5.Logarithm of rms error as a function of ε.A. Penner Array 8 (2020) 100046
4the Radial solution is a saddle point, so the set of solutions is topologi-cally balanced. However, at
ε¼1:308 the Radial solution becomes alocal minimum, so we now require two saddle points to balance thischange. These are provided by the two fourfold symmetric bridge solu-tions for
ε<1:308, which serve an essential topological function eventhough they are not optimalﬁts. This event will be called a“3–1 termi- nation”event, Sec.6, in which a pair of solutions of lower symmetryterminates and changes the character of a higher symmetry branch. Thisis an example of apitchfork bifurcation[[3],Fig. 7], which is normally associated withsymmetry-breaking[[9], p.55]. It is made possible by the symmetry properties of the solutions that contribute to it [[ 3], Sec.10]. The left hand side ofFig. 6shows a different type of topological event.At
ε¼0:6 the solution set is topologically balanced, with S-shape andRadial minima, and a pair of saddle points in the Bridge solution. At
ε¼ 0:96323 we encounter a“2-2 crossover”in which a saddle point in the S- shape branch crosses a local minimum in the Oval branch and in-terchanges character with it, Sec. 7. In this case both branches are eightfold symmetric and neither disappears. This is an example of atranscritical bifurcation[9,10]. Bifurcations of this type always require anadditional constraint to be met. In [[9], Sec.3.2] it is the requirement that oneﬁxed point must remain constant while another ﬁxed point crosses over it, where the term“ﬁxed point”refers to an equilibrium solution of adifferential equation. In [[10], Fig.1.3a] it is the constraint
α¼β, which leads to a special type ofimperfect bifurcation(In [[3], Fig.18], this same constraint is re-expressed asb¼/C0a
3.). The need for an additional constraint to explain ODF solution crossovers was also discussed in [[ 12], Sec.5.2]. In the context of ODF, the constraint is that two second-orderresponse matrices are simultaneously singular, which leads to a smoothcrossover of solutions rather than an avoided crossing or an abnormaltermination.6. Response to a change in shape: “3–1 termination”The rest of this paper discusses methods of detecting such eventsanalytically and categorizing them graphically. The question is: why arethese solutions well-behaved when they meet? The matrix Mhas singu- larities at each event; therefore, according to Eq. (8), we should see a singularity inda=d
ε, butFig. 4shows no such effect. To explain this weneed to develop an analytical expression for da=d
ε, evaluated under the constraints thatL
i¼0 and Eq.(1)are both satisﬁed at all times. Following the derivation of [[12], Eq.5.5], weﬁnd: Mðda=d
εÞþY¼0 (16)whereY
i¼d2F=da idε¼Rt2
t1Iiða;uÞdt, andI
iða;uÞ¼ ∂ðf/C0gÞ/C14 ∂ε/C1∂f/C14∂aiþðf/C0gÞ/C1 ∂2f/C14∂ε∂ai/C0EðuÞ∂u/C14∂εð∂u=∂aiÞ:(17) This requires the calculation of
∂u=∂ε, which is given byEðuÞ∂u=∂ε¼/C0f0ða;uÞ/C1∂ðfða;uÞ/C0gðtÞÞ= ∂ε/C0ðfða;uÞ/C0gðtÞÞ /C1 ∂f0ða;uÞ= ∂ε:(18) To interpret Eq.(16)we switch to a representation in which Mis diagonalized. Deﬁne a unitary transformU, such thatU
tMU¼D(diag- onal). Equation(16)can be rewritten asDU
tðda=d εÞþUtY¼0. Now we see that, if a given eigenvalue,D
00, is zero, and if the corresponding response,U
t0ðda=d εÞ, is to be well-behaved, then it is necessary thatU
t0Y¼0, whereU 0is the eigenvector associated withD 00. We wish to test this assertion on the Radial branch at
ε¼1.308. On both sides of this event the solution vector ashows the pattern: a∝ðA;B;B;A;/C0A;/C0B;/C0B;/C0A;/C0B;/C0A;A;B;B;A;/C0A;/C0B;C;C;C;C;C;C;C;CÞ8 2(19)where, in this case,A¼x
0andB¼x 1. The vectorYshows the same pattern, with different values forAandB. The eigenvectorU
0shows the pattern:U
0∝ðE;F;/C0F;/C0E;/C0E;/C0F;F;E;F;E;E;F;/C0F;/C0E;/C0E;/C0F;/C0G;G;/C0G;G;/C0G;G;/C0G;GÞ8 2(20)The dot product of these two vectors,U
t0Y, is zero by symmetry, as expected. Therefore it is reasonable to expect that da=d
εwill be well- behaved on this branch even though the eigenvalue is going throughzero. Note that this orthogonality does not exist on the lower symmetryBridge solutions which are terminating at this point, leading to in ﬁnite slope indθ
0=dεinFig. 3.An alternate way of viewing the same issue is to de ﬁne an “augmented”M
þmatrix:M
þij¼M ijforfi;jg2½1;n/C138M
þi;nþ1¼Mþnþ1;i¼Y i¼d2F.da idεfori2½1;n/C138 M
þnþ1;nþ1 ¼d2F.dε2(21)whered
2F=dε2¼Rt2
t1Jða;uÞdt, andJða;uÞ¼
∂ðf/C0gÞ/C14 ∂ε/C1∂ðf/C0gÞ/C14 ∂εþðf/C0gÞ/C1 ∂2ðf/C0gÞ/C14 ∂ε2/C0EðuÞ∂u/C14∂εð∂u=∂εÞ:(22) The augmented matrixM
þis essentially the second-order responsematrix obtained if we admit the variable
εas a new independent variable, comparable tofa
ig, the only difference being thatFis not stationary with respect to changes in
ε. It plays a role analogous to the“tangent space” TG[[10], Eq.2.2] and [[3], p.208].Comparison of the eigenvalues ofMandM
þcan be informative. If D
00is an eigenvalue ofM, and ifUt0Y¼0, then it will also be an eigenvalue ofM
þas well, where the augmented eigenvector is just U 0
with an additional zero at the end.Fig. 6shows the eigenvalue ofMþthat is closest to zero, denotedaug
0. For the eightfold symmetric Radialbranch there is always an augmented eigenvalue that agrees with eig
0at all
ε. This is the reason why this branch is able to have zeros in eig 0while still being well-behaved. For the Bridge solution this is not normally thecase, although theﬁgure shows thateig
0andaug 0both approach zero at ε
¼1.308.The augmented matrix has been previously de ﬁned in a similar context [[2], p.66]. In that discussion it was stated that MandM
þcannot simultaneously be singular because there are not suf ﬁcient degrees of freedom to allow this to happen [[2], p.60, Assumption A]. Normally, ofcourse, this is true: we have only one degree of freedom,
ε, so we cannot simultaneously satisfy two constraints. Therefore the only way for this tobe possible is if there are additional constraints in operation such thatboth matrices can be made to be singular on a sub-manifold of the so-lution space. (A similar statement is made in Ref [[ 10], Eq.2.10]. with reference to a bifurcation point [[10], Fig.2.1a]). In the present example,
Fig. 6.Lowest eigenvalues ofM(eig 0) andMþ(aug 0) as a function of ε.aug 0is shown only for the Bridge solution, for simplicity.A. Penner Array 8 (2020) 100046
5“3–1 termination”, the additional constraint is symmetry, which allowssymmetric solutions to intersect with asymmetric solutions withoutpathological behavior. In the next section an alternative constraint isdescribed which also allows two solution branches to cross each otherand interchange roles without singular behavior. This allows [[ 2], p.60, Assumption A] to be violated due to the presence of a newly de ﬁned sub-manifold.7. Response to a change in shape: “2-2 crossover”This event consists of an intersection between the S-shaped and Ovalbranches inFig. 4at
ε¼0.96323. At aﬁrst glance, it appears that three branches (two minima plus a saddle point) have simultaneously coa-lesced to produce a single minimum. Upon closer inspection we ﬁnd (Fig. 7a) that there are two distinct events, both of which involve onlytwo branches. (Note the similarity of Fig. 7at o[ [10], Fig.1.3a] and to [[3], Fig.18] for the intermediate cases where b¼/C0a
3). Atε¼0.9631 a local minimum and a saddle point coalesce and disappear in a fold ca-tastrophe. At this pointeig
0¼0 and the slope inFig. 7ai si nﬁnite. At ε¼ 0.96323 the two branches cross each other at ﬁnite slope inFig. 7a with an interchange of character from minimum to saddle point and vice-versa(This was previously termed a Type 2 crossover in [[ 12], Chap.5]. It has also been called an“interchange event”in Ref. [[7],Fig. 6],“height switch”in Ref. [6], andF
1βin Ref. [[8], Fig. 3.1].). In this case bothM andM
þare singular. As before, the simultaneous singularity of these twomatrices is a necessary condition for da=d
εto be well-behaved. There are two questions that need to be addressed: where do we ﬁnd the necessary degrees of freedom to makeMandM
þsimultaneously singular, and are these two events related (could a“2-2 crossover”occur without a cor- responding fold catastrophe)? Theﬁrst question can be answered alge- braically, while the answer to the second question is most easilydemonstrated using catastrophe theory (Sec. 8). As noted in Sec.4, the S-shape branch is a“typical”solution in that it is qualitatively comparable toﬁtting curvature at the endpoints. Theoval-shaped solution is abnormal since it is related to an extremum of the<y
0>moment. Upon closer inspection, weﬁnd that the oval-shaped solution yields an unexpected relationship, which is not true on the S-shape branch: the variablesðfða;uÞ/C0gðtÞÞ /C1
∂f=∂aiare linearly dependent on each other8t. Combining this with Eq.(1)we obtain the more general expressionf
0ða;uÞ¼hðuÞXni¼1μi∂f.∂ai (23)in whichhðuÞis to be determined and
μiare functions of εbut notu. The calculation of
μiwill be described below (Sec.7.1). For now we note an interesting consequence of Eq.(23). From Eq.(4)and Eq.(23)we have:Xni¼1μiLi¼Rt2
t1ðfða;uÞ/C0gðtÞÞ /C1Pni¼1μi∂f/C30∂aidt¼R
t2
t1ðfða;uÞ/C0gðtÞÞ /C1f0ða;uÞhðuÞdt¼0(24)where we have used Eq.(1). This equation represents a new constraint onthefL
ig: this releases one of the original constraints we would normallyimpose onL, which gives us a new degree of freedom we may be able touse to set the determinant ofM
þto zero. In effect, it deﬁnes a sub- manifold within which a crossing of solutions becomes theoreticallypossible. We now need to derive appropriate conditions for this to occur.The functionhðuÞcan be calculated as follows. Taking a derivative ofEq.(23)weﬁnd:f
00ða;uÞ¼hðuÞPni¼1μi∂f0.
∂aiþh0ðuÞXni¼1μi∂f.∂ai
¼hðuÞPni¼1μi∂f0/C30
∂aiþh0ðuÞhðuÞf 0ða;uÞ:(25)Substitute this into Eq.(7)to obtain:EðuÞ¼f
0ða;uÞ/C1f0ða;uÞþhðuÞðfða;uÞ/C0gðtÞÞ /C1Xni¼1μi∂f0.
∂ai (26)where we have used Eq.(1)to eliminate the termh
0ðuÞðfða;uÞ/C0gðtÞÞ /C1 f
0ða;uÞ=hðuÞ, which is zero. Now operate on Eq. (6)to obtain:EðuÞX
ni¼1μi∂u.∂ai¼/C0f0ða;uÞ/C1Xni¼1μi∂f.∂ai/C0ðfða;uÞ/C0gðtÞÞ/C1Xni¼1μi∂f0.
∂ai
¼/C0f0ða;uÞ/C1f0ða;uÞ.hðuÞ/C0ðfða;uÞ/C0gðtÞÞ/C1Xni¼1μi∂f0.
∂ai:(27) Comparing this to Eq.(26)weﬁnd:hðuÞX
ni¼1μi∂u.∂ai¼/C01 (28)wherehðuÞcan be viewed as a scalar normalization function in Eq. (23).I f we eliminatehðuÞfrom these equations we can obtain a further inter-esting constraint. Substitute Eq.(28)into Eq.(23)to obtain:f
0ða;uÞ¼/C0Xni¼1μi∂f,∂ai,Xni¼1μi∂u=∂ai (29)
Fig. 7.Solution properties versus εduring a crossover event between the Oval and S-shaped branches. Also shown is the associated fold catastrophe event.A. Penner Array 8 (2020) 100046
6f0ða;uÞXni¼1μi∂u.∂aiþXni¼1μi∂f.∂ai¼0(30)X
ni¼1μi½∂f=∂aiþf0ða;uÞ∂u=∂ai/C138¼0(31)which represents a new constraint on the total response of fða;uÞwith respect toa, which is valid only on the oval-shaped branch. We note inpassing that analogous constraints have also been found to be satis ﬁed on oval-shaped branches of the ODF solutions obtained when ﬁtting a clamped cubic and/or quartic B/C19ezier to a 45
/C14segment ofgðtÞ, wheregðtÞ is a hypoTrochoid shape withC
4vsymmetry [[12], Chaps.4, 8]. In this case they are also associated with a“2-2 crossover”.7.1. Implications forMIn order to deﬁne this class explicitly, we need to calculate f
μig. Begin with Eq.(23)and express it as a parallel relationship:f
0ða;uÞ/C13/C13/C13X4i¼1μi∂f.∂ai
f0
y
f0
x¼X4i¼1μi∂fy/C14∂aiX4i¼1μi∂fx=∂ai; (32)where the sum extends over all the independent variables a
i. Here we will make use of the eightfold symmetry of the Oval solution to simplify therepresentation. Deﬁne the B/C19ezier control arms for one segment as inRef. [[15],Fig. 1]:R
1¼ðX 1;Y1Þ¼ðX 0/C0d 1sinθ 1;Y0þd 1cosθ 1Þ R
2¼ðX 2;Y2Þ¼ðX 3þd 2sinθ 2;Y3/C0d 2cosθ 2Þ(33)whereR
0andR 3are the endpoints. The anglesθ 1andθ 2,o fR 0andR 3, areﬁxed by symmetry, so the independent variables are a¼ðd
1;d2;R0; R
3Þ. Expressfða;uÞin terms of Bernstein polynomials [[11], p.224], and re-express Eq.(32)as
Y0B’03þðY 0þd 1cosθ 1ÞB’13þY 3B’33þðY 3/C0d 2cosθ 2ÞB’23
X0B’03þðX 0/C0d 1sinθ 1ÞB’13þX 3B’33þðX 3þd 2sinθ 2ÞB’23
¼μ1B13cosθ 1þμ3ðB03þB 13Þsinθ 1/C0μ2B23cosθ 2þμ4ðB23þB 33Þsinθ 2
/C0μ1B13sinθ 1þμ3ðB03þB 13Þcosθ 1þμ2B23sinθ 2þμ4ðB23þB 33Þcosθ 2:(34) Use the relationshipB
0i;n¼nðB i/C01;n/C01 /C0B i;n/C01Þand rearrange:
whereΔX¼X
3/C0X 0þd 1sinθ 1þd 2sinθ 2
ΔY¼Y 3/C0Y 0/C0d 1cosθ 1/C0d 2cosθ 2:(36)Now multiply through by both denominators and organize the termsaccording to their use of the functions u
ið1/C0uÞjwhereiþj¼5. Weﬁnd that the term inð1/C0uÞ
5, obtained by multiplyingB 02B03, is satisﬁed only if
μ3¼0. Similarly, the term inu5requires μ4¼0. Substituting these tworesults in, the remaining terms are equated below:factor left hand side right hand sideuð1/C0uÞ
4 /C0μ1d1sinθ 1cosθ 1 /C0μ1d1sinθ 1cosθ 1
u2ð1/C0uÞ3 μ2d1sinθ 2cosθ 1/C02μ1ΔYsinθ 1 μ2d1cosθ 2sinθ 1þ2μ1ΔXcosθ 1
u3ð1/C0uÞ2 /C0μ1d2sinθ 1cosθ 2þ2μ2ΔYsinθ 2 /C0μ1d2cosθ 1sinθ 2/C02μ2ΔXcosθ 2
u4ð1/C0uÞ μ2d2sinθ 2cosθ 2 μ2d2sinθ 2cosθ 2
Theﬁrst and last rows are satisﬁed trivially, which leaves only two constraints onf
μig. These can be expressed as:/C18/C02Δ
1/C02d 2sinðθ 2/C0θ 1Þd 1sinðθ 2/C0θ 1Þ d
2sinðθ 2/C0θ 1Þ2Δ 2/C02d 1sinðθ 2/C0θ 1Þ/C19/C18μ1
μ2/C19¼0(37)whereΔ
i¼ðX 3/C0X 0Þcosθ iþðY 3/C0Y 0Þsinθ i.W eﬁnd, as expected, that this matrix is singular at all times on the oval-shaped branch in Fig. 7,s o thef
μigcan be calculated to within a normalization constant. Since thisconstraint does not involve
μ3orμ4, we alsoﬁnd that it is equally applicable to the case of a clamped cubic B /C19ezier segment [[12], Chap.5]. Givenf
μig, we wish to work out the consequences for M. Beginning with Eq.(5), and noting that the Hessian terms are zero within thisparticular symmetric representation, we haveX
4j¼1μjGij¼∂f,∂ai/C1X4j¼1μj∂f,∂aj/C0EðuÞ∂u,∂aiX4j¼1μj∂u,∂aj
¼1hðuÞ∂f/C30∂ai/C1f0ða;uÞþ1hðuÞEðuÞ∂u/C30∂ai(38)where we have used Eq.(23)and Eq.(28). Now use Eq.(6)to eliminate EðuÞand integrateG
ijto obtain:X
4j¼1μjMij¼/C0Zt2
t11hðuÞðfða;uÞ/C0gðtÞÞ /C1∂f0/C30
∂aidt8i(39)These equations provide a new mechanism by which Mmay become singular, one which is unique to the oval-shaped branch: by settingP
4j¼1μjMij¼08i. We have conﬁrmed computationally that these zerosin Eq.(39)occur8iduring a“2-2 crossover”, leading to a singularM.7.2. Implications forM
þ
By itself, a singularMis not a surprising event; what is of interest iswhether theM
þmatrix will simultaneously become singular. From Eq.(17), and noting that the Hessian term is zero, we ﬁnd:
X
4i¼1μiIiða;uÞ¼ ∂ðf/C0gÞ, ∂ε/C1X4i¼1μi∂f,∂ai/C0EðuÞ∂u,∂εX4i¼1μi∂u,∂ai
¼1hðuÞ∂ðf/C0gÞ/C30 ∂ε/C1f0ða;uÞþ1hðuÞEðuÞ∂u/C30∂ε
(40) where we have used Eq.(23)and Eq.(28). Now use Eq.(18)to eliminate EðuÞand integrateI
iða;uÞto obtain:d1cosθ 1B02þd 2cosθ 2B22þΔYB 12
/C0d1sinθ 1B02/C0d 2sinθ 2B22þΔXB 12¼μ3sinθ 1B03þμ4sinθ 2B33þðμ1cosθ 1þμ3sinθ 1ÞB13þð/C0 μ2cosθ 2þμ4sinθ 2ÞB23
μ3cosθ 1B03þμ4cosθ 2B33þð/C0 μ1sinθ 1þμ3cosθ 1ÞB13þðμ2sinθ 2þμ4cosθ 2ÞB23(35)A. Penner Array 8 (2020) 100046
7X4i¼1μid2F/C30da idε¼/C0Zt2
t11hðuÞðfða;uÞ/C0gðtÞÞ /C1∂f0/C30
∂εdt:(41)We wish to determine whether the right hand side of Eq. (41)will go to zero simultaneously with the right hand sides of Eq. (39)8i. This would mean that a singularM,a sd eﬁned by Eq.(39), would also lead to a singularM
þ. For the present, unclamped, spline this is trivially true, since
∂f0=∂ε¼0b yd eﬁnition. For a clamped spline [15], a proof is required. In this case a sufﬁcient condition for this to occur is:f
0ða;uÞk ν0∂f0.
∂εþX2i¼1νi∂f0.
∂ai8u(42)wheref
νigare constant with respect tou, and we have used the fact that Eq.(1)is satisﬁed8u. The sum extends overfd
1;d2g. We now need to relatef
νigtof μig, to conﬁrm that they exist. Compare this equation toEq.(32)to obtain:
ν0∂f0.
∂εþX2i¼1νi∂f0.
∂aikX2i¼1μi∂f.∂ai:(43)Expressfða;uÞin terms of Bernstein polynomials and Eq. (33):
ν0/C2/C0B 0
03þB0
13/C1sinθ
1/C0/C0B0
23þB0
33/C1sinθ
2/C3þ
ν1B13’cosθ 1/C0ν2B23’cosθ 2
ν0/C2/C0B 0
03þB0
13/C1cosθ
1/C0/C0B0
23þB0
33/C1cosθ
2/C3/C0
ν1B13’sinθ 1þν2B23’sinθ 2¼μ1B13cosθ 1/C0μ2B23cosθ 2
/C0μ1B13sinθ 1þμ2B23sinθ 2
(44) where we have used the deﬁnition of the hypoTrochoidgðtÞin Ref. [15] to calculate the responseð
∂f0=∂εÞof the endpoints to a change in ε, which is calledcin Ref. [15]. Now use the relationshipB
0i;n¼nðB i/C01;n/C01 /C0 B
i;n/C01Þ:
/C0ν0B12ðsinθ 1þsinθ 2Þþ
ν1ðB02/C0B 12Þcosθ 1/C0ν2ðB12/C0B 22Þcosθ 2
/C0ν0B12ðcosθ 1þcosθ 2Þ/C0
ν1ðB02/C0B 12Þsinθ 1þν2ðB12/C0B 22Þsinθ 2¼ð1/C0uÞ μ1cosθ 1/C0uμ2cosθ 2
/C0ð1/C0uÞ μ1sinθ 1þuμ2sinθ 2
(45) where we have canceled a common factor of uð1/C0uÞon the right hand side. Multiply through by both denominators and organize the termsaccording to their use of the functions u
ið1/C0uÞjwhereiþj¼3:
factor left hand side right hand sideð1/C0uÞ
3 /C0μ1ν1sinθ 1cosθ 1 /C0μ1ν1sinθ 1cosθ 1
uð1/C0uÞ2 2μ1ν0sinθ 1ðsinθ 1þsinθ 2Þþ2
μ1ν1sinθ 1cosθ 1
þμ2ν1cosθ 1sinθ 2
þ2μ1ν2sinθ 1cosθ 2/C02μ1ν0cosθ 1ðcosθ 1þcosθ 2Þþ2
μ1ν1sinθ 1cosθ 1
þμ2ν1sinθ 1cosθ 2
þ2μ1ν2cosθ 1sinθ 2
u2ð1/C0uÞ/C02 μ2ν0sinθ 2ðsinθ 1þsinθ 2Þ/C02
μ2ν1cosθ 1sinθ 2
/C0μ1ν2sinθ 1cosθ 2
/C02μ2ν2sinθ 2cosθ 22μ2ν0cosθ 2ðcosθ 1þcosθ 2Þ/C02
μ2ν1sinθ 1cosθ 2
/C0μ1ν2cosθ 1sinθ 2
/C02μ2ν2sinθ 2cosθ 2
u3 μ2ν2sinθ 2cosθ 2 μ2ν2sinθ 2cosθ 2
Theﬁrst and last rows are satisﬁed trivially, which leaves only two constraints onf
νig. These can be expressed in matrix form:/C18ð2
μ1/C04μ2Þ½1þcosðθ 2/C0θ 1Þ/C138 /C03 μ2sinðθ 2/C0θ 1Þ0 ð4
μ1/C02μ2Þ½1þcosðθ 2/C0θ 1Þ/C1380/C03 μ1sinðθ 2/C0θ 1Þ/C190@ν0
ν1
ν21A¼0:(46) These constraints can always be satisﬁed to within a normalization constant: for example, weﬁnd
ν1=ν0is a linear function of μ1=μ2. Therefore we conclude thatM
þmay become singular simultaneouslywithM, and that this is possible only on the sub-manifold represented bythe oval-shaped solution inFig. 7.We note,ﬁnally, that the same sub-manifold also exists in the ODF ﬁt of a quartic B/C19ezier to a hypoTrochoid curve [[12], Chap.8]. In this case we have four degrees of freedom instead of two, but otherwise thespeciﬁcation offμigandf νigproceeds in the same way as above.8. Modeling an avoided catastropheWe wish to re-express these events in the language of catastrophetheory, which is visually more informative. In order to model eventsinvolving three critical points we deﬁnes, a one-dimensional streamline [21,5] joining the critical points, and assume that FðsÞis approximated by a quartic function along this path:F¼s
4/C144þAs2/C142þBs: (47) In this equation all the parameters which affect only the scaling andpositioning have been removed, leaving only two parameters whichcontrol the shape. This can be used to describe a cusp catastrophe[3,4]. The functionFhas three critical points whenB
2/C144þA3/C1427<0: (48) Otherwise it has only one critical point. The boundary curve, Eq. (48), is shown inFig. 8andFig. 1.We wish to show that both the 3–1 termination and the 2-2 crossover events are represented by a tangential touching of the boundary curve inthisﬁgure, while a“normal”merge of two critical points is representedby a non-tangential crossing of this boundary. Consider a one-dimensional problem in which we search for critical points of FðsÞ along the streamlines. Then the condition thatMbe singular at a critical point is expressed, Eq.(47), as:d
2F/C14ds2¼3s2þA¼0: (49) The condition thatda=d
εbe well-behaved, or the condition thatMþ
be simultaneously singular, is satisﬁed if d
2F/C14dsd ε¼sdA/C14d εþdB/C14d ε¼0:(50) Combining them we obtain the constraintdA.dB¼/C01.s¼/C6ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ/C03=Ap (51)
Fig. 8.Catastrophe theory representation of both a “3–1 termination”(dashed) and“2-2 crossover”(dotted) event. The curved boundary separates the region ofthree solutions from the single solution range.A. Penner Array 8 (2020) 100046
8which is just the expression for the slope of the catastrophe boundary.As an application of this concept, consider the 3 –1 termination event. In this case, two degenerate saddle points merge with a higher symmetrylocal minimum to produce a single saddle point, while da=d
εis well- behaved. Since the two saddle points have the same rms error, we ﬁnd thatB¼0 in Eq.(47). Therefore the tangential touching of the boundaryoccurs at the origin. The additional constraint that is required in order toproduce a tangential touching is provided by symmetry. The tangentialtouching event also coincides with a normal fold catastrophe at the originto produce a single saddle point at A>0. The path that the system fol- lows is plotted as a vertical line inFig. 8, which passes through the origin.The 2-2 crossover event of Sec.7is more challenging. We wish toﬁt FðsÞto a sequence of ODF data obtained along the path joining threecritical points inFig. 7a, to see how theﬁt evolves as
εchanges. For each ε
we need at leastﬁve data points to do so. Three of these points arealready known from the ODF optimization at the critical points, but tworemain to be calculated. The problem is that these two points are nolonger critical points; instead, they are points de ﬁned along an unknown streamline that joins a set of critical points [ 21]. The streamline is deﬁned to be tangent to the gradient of Fat all times. The uniqueness of the streamline was shown in Ref. [ 5]. However, calculating it exactly turns out to be difﬁcult: in the vicinity of a critical point the typicalbehavior [[22], p.183] is that the streamline is a function of the typep
1=λ1
1∝p1=λ2
2, wherepis a point in the transformed coordinate systemdeﬁned by the eigenvectors ofM,λ
iare the eigenvalues, and the origin ofpis at the critical point. As we approach a critical point these streamlineswill exhibit very high curvature, particularly if the ratio λ
2=λ1is large, which will be the case if two critical points approach each other. How-ever, we do not need the entire streamline, just a set of intermediatepoints between two critical points. We evaluate these approximatelyusing the method of steepest descent [[ 23], p.121]: calculate a pre- liminary estimate ofaby linearly interpolating between a saddle pointand a local minimum. Then perform some iterations of the steepestdescent method. Each iteration will increment aby the amountΔa¼/C0
αL, where α¼LtL=LtML. Typically the pointawill oscillate back and forth across the narrow trough that leads to the minimum [[ 23], Fig8.2]. We terminate the iteration when the gain
αstabilizes, since any point along this streamline will do. Perform this for both pairs of mini-ma/saddle points at each
εto obtain a total ofﬁve data points. Thenﬁta general quartic model ofFðsÞand convert this to the standard form in Eq.(47). The resulting data are shown inFig. 8. Theﬁgure shows the results of this method applied to the current Beta2-spline, where the steepestdescent iteration was terminated after 20 iterations. The path length s was evaluated using the distance in the ðd
1;d2Þplane. We see that there is a tangential touching event at
ε¼0:96323, followed very closely by a fold catastrophe. Unfortunately, the particular numerical method we areusing does not allow us to actually cross the boundary at the fold catas-trophe, but it is clear that this crossing is imminent. A similar avoidedcatastrophe was obtained by applying this method to a clampedsingle-segment cubic B/C19ezierﬁt (see Fig. 5.1 in Ref [[12]]) atc/C253:59, with the steepest descent iteration terminated after one iteration.Fig. 8conﬁrms the supposition that a 2-2 crossing consists of atangential touching of the catastrophe boundary. We also note that thesign ofBhas changed between the 2-2 crossing and the correspondingfold catastrophe. Therefore not the same pair of critical points is involvedin these two events. Theﬁgure also clariﬁes the relationship between these events. Given the highly curved character of the catastropheboundary, and given the fact that the relationship between AandBis nearly linear as
εvaries, it is almost inconceivable that a 2-2 crossoverevent could occur without a corresponding fold catastrophe. This is aninsight that we would not have obtained if we restricted ourselves to theuse of only the determinants ofMandM
þ.9. ConclusionWhenﬁtting a spline to a closed shape it is normal to see multiplesolutions, which will appear as local minima and saddle points in theerror function. If the shape of the object is changed by varying a singleexternal paramater, then it may happen that these different types of so-lutions meet, leading to a topological change in which solutions eitherdisappear or interchange their character. The outcome of these topo-logical events can be determined by inspecting two different matriceswhich represent the second-order response of the curve- ﬁtting error to changes in the curve-ﬁtting parameters and the shape of the object.Events in which two solutions annihilate are quite common and do notrequire any special constraints to be met, other than the change in shape.Events in which two solutions survive and interchange character are rare,and require both of these response matrices to be simultaneously sin-gular. In the context of ODF curve-ﬁtting, a new algebraic constraint is deﬁned, which allows this type of solution crossover to occur. It is alsopossible for solution bifurcations to occur as a result of symmetry-breaking, which is a relatively common occurrence. These three typesof events: annihilation, crossover, and symmetry-breaking, can beanalyzed algebraically using matrix determinants, but that does not leadto any understanding of the relationship between them. A more visualrepresentation is obtained using catastrophe theory, which allows us torepresent them as being either a simple crossing of a boundary (annihi-lation), a simultaneous crossing of two boundaries which have merged(symmetry-breaking), or a tangential touching of a boundary in which acatastrophe is avoided (crossovers). In the case of a crossover, the ca-tastrophe theory representation makes it clear that a crossover is not onlyrare, but will almost certainly be closely associated with an annihilationevent, so much so that it may be difﬁcult to distinguish the two events.Credit author statementAlvin Penner: Conceptualization, implementation, writing.Declaration of competing interestI declare that I have no known competing ﬁnancial interests or per- sonal relationships that could have appeared to in ﬂuence the work re- ported in this paper.AcknowledgementsThe author is grateful to the reviewers and editors for their valuablecomments, which were used to improve the quality of this paper.The calculations were performed using the Java code at the re-pository:https://github.com/alvinpenner/Spiro2SVG/ .References[1] Ahn SJ. Least squares orthogonal distance ﬁtting of curves and surfaces in space, LNCS 3151. Berlin: Springer; 2004. https://doi.org/10.1007/b104017 . [2]Aubin J-P, Ekeland I. Applied nonlinear analysis. Mineola, N.Y.: Dover Books onMathematics, Dover Publications; 2006 . [3] Stewart I. Catastrophe theory in physics. Rep Prog Phys 1982;45(2):185 –221. https://doi.org/10.1088/0034-4885/45/2/002 . [4] Zeeman EC. Catastrophe theory, Scienti ﬁc American 1976;234(4):65–83.https:// doi.org/10.1038/scientiﬁcamerican0476-65. [5] Antony C. Gradientﬂow line near birth-death critical points. J Topol Anal 2018;10:1–45.https://doi.org/10.1142/s1793525319500493 . [6] Gay DT. Functions on surfaces and constructions of manifolds in dimensions three,four andﬁve. 2017. p. 1–20.https://arxiv.org/abs/1701.01711 . [7] Edelsbrunner H, Harer J, Mascarenhas A, Pascucci V, Snoeyink J. Time-varying reebgraphs for continuous space-time data. Comput Geom 2008;41(3):149 –66.https:// doi.org/10.1016/j.comgeo.2007.11.001 . [8] Kirby R. A calculus for framed links in s3. Invent Math 1978;45(1):35 –56.https:// doi.org/10.1007/bf01406222 . [9] Strogatz SH. Nonlinear dynamics and chaos. CRC Press; 2018. https://doi.org/ 10.1201/9780429492563.A. Penner Array 8 (2020) 100046
9[10] Golubitsky M, Schaeffer D. A theory for imperfect bifurcation via singularity theory.Commun Pure Appl Math 1979;32(1):21 –98.https://doi.org/10.1002/ cpa.3160320103.[11]Bartels RH, Beatty JC, Barsky BA. An introduction to splines for use in computergraphics&geometric modeling. Los Altos: Morgan Kaufmann; 1987 . [12] Penner A. Fitting splines to a parametric function. Cham, Switzerland: SpringerBriefs in Computer Science, Springer; 2019. https://doi.org/10.1007/978-3-030- 12551-6.[13] Ahn SJ, Rauh W, Cho HS, Warnecke H-J. Orthogonal distance ﬁtting of implicit curves and surfaces. IEEE Trans Pattern Anal Mach Intell 2002;24(5):620 –38. https://doi.org/10.1109/34.1000237 . [14] Bjorck A. Numerical methods for least squares problems. Philadelphia: SIAM; 1996.https://doi.org/10.1137/1.9781611971484 . [15] Penner A. Fitting a cubic bezier to a parametric function. Coll Math J 2019;50:185–96.https://doi.org/10.1080/07468342.2019.1583038 . [16]McWeeny R. Symmetry: an introduction to group theory and its applications.Mineola, N.Y.: Dover; 2002.[17] de Boor C, Hollig K, Sabin M. High accuracy geometric hermite interpolation.Comput Aided Geomet Des 1987;4(4):269 –78.https://doi.org/10.1016/0167- 8396(87)90002-1.[18] de Tisi F, Rossini M. Behavior of the beta-splines with values of the parametersbeta2 negative. Comput Aided Geomet Des 1992;9(6):419 –23.https://doi.org/ 10.1016/0167-8396(92)90040-V . [19] Mascarenhas A, Snoeyink J. Isocontour based visualization of time-varying scalarﬁelds. In: Mathematics and visualization. Springer Berlin Heidelberg; 2009.p. 41–68.https://doi.org/10.1007/b106657_3 . [20] Guillemin V, Pollack A. Differential topology. Englewood Cliffs: Prentice-Hall;1974.https://doi.org/10.1090/chel/370 . [21] Gordon P. Paths connecting elementary critical points of dynamical systems. SIAM JAppl Math 1974;26(1):35–102.https://doi.org/10.1137/0126005 . [22]Lefschetz S. Differential equations: geometric theory. New York, N.Y.: Dover; 1977 . [23] Chong EKP, Zak SH. An introduction to optimization. Wiley; 2008. https://doi.org/ 10.1002/9781118033340.A. Penner Array 8 (2020) 100046
10