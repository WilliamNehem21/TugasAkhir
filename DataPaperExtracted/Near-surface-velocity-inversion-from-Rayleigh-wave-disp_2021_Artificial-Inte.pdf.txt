Near-surface velocity inversion from Rayleigh wave dispersion curves basedon a differential evolution simulated annealing algorithm
Yaojun Wanga, Hua Wanga,*, Xijun Wua, Keyu Chena, Sheng Liub, Xiaodong Dengb
aCenter for Information Geoscience, University of Electronic Science and Technology of China, Chengdu, 5162125, China
bSouth Branch of Sinopec Geophysical Corporation, Chengdu, 610041, China
ARTICLE INFO
Keywords:Simulated annealingDifferential evolutionBlock coordinate descentSurface wave dispersion curveNonlinear inversionABSTRACT
The utilization of urban underground space in a smart city requires an accurate understanding of the undergroundstructure. As an effective technique, Rayleigh wave exploration can accurately obtain information on the sub-surface. In particular, Rayleigh wave dispersion curves can be used to determine the near-surface shear-wavevelocity structure. This is a typical multiparameter, high-dimensional nonlinear inverse problem because thevelocities and thickness of each layer must be inverted simultaneously. Nonlinear methods such as simulatedannealing (SA) are commonly used to solve this inverse problem. However, SA controls the iterative processthough temperature rather than the error, and the search direction is random; hence, SA always falls into a localoptimum when the temperature setting is inaccurate. Speci ﬁcally, for the inversion of Rayleigh wave dispersion curves, the inversion accuracy will decrease with an increasing number of layers due to the greater number ofinversion parameters and large dimension. To solve the above problems, we convert the multiparameter, high-dimensional inverse problem into multiple low-dimensional optimizations to improve the algorithm accuracyby incorporating the principle of block coordinate descent (BCD) into SA. Then, we convert the temperaturecontrol conditions in the original SA method into error control conditions. At the same time, we introduce thedifferential evolution (DE) method to ensure that the iterative error steadily decreases by correcting the iterativeerror direction in each iteration. Finally, the inversion stability is improved, and the proposed inversion method,the block coordinate descent differential evolution simulated annealing (BCDESA) algorithm, is implemented. Theperformance of BCDESA is validated by using both synthetic data and ﬁeld data from western China. The results show that the BCDESA algorithm has stronger global optimization capabilities than SA, and the inversion resultshave higher stability and accuracy. In addition, synthetic data analysis also shows that BCDESA can avoid theproblems of the conventional SA method, which assumes the S-wave velocity structure in advance. The robustnessand adaptability of the algorithm are improved, and more accurate shear-wave velocity and thickness informationcan be extracted from Rayleigh wave dispersion curves.
1. IntroductionWith the acceleration of urbanization and with rapid increases inpopulation and economic activity, the utilization of urban undergroundspace (UUS) has become a dramatic strategy in smart cities, which arecharacterized by massive constructions such as subways, pipeline net-works, groundwater projects, and underground malls. UUS utilizationrequires accurate and efﬁcient measurements of the subsurface. There-fore, efﬁcient measurement methods for determining the extents of near-surface underground structures have become a popular issue in the ﬁelds of geophysics and geotechnical engineering.Existing near-surface survey methods include the high-density elec-trical method, ground-penetrating radar, re ﬂection seismology, and multichannel analysis of surface waves (MASW) ( Xia et al., 1999;Park et al., 1999). Among them, the high-density electrical method andground-penetrating radar obtain the resistivity distribution of the sub-surface, whereas reﬂection seismology and multichannel transient sur-face wave methods use the propagation of elastic waves to obtainvelocity information and describe the underground structure. The formerhas a high detection accuracy, but the depth of investigation is limited bythe frequency of electromagnetic waves; in contrast, the latter has a highresolution and large investigation depth. In particular, the MASW
* Corresponding author.E-mail addresses:yaojun.wang@uestc.edu.cn(Y. Wang),huawang@uestc.edu.cn(H. Wang),wuserry@163.com(X. Wu),chloe.chen@std.uestc.edu.cn(K. Chen), shengliu@sinopec.com.cn(S. Liu),dengxd05@hotmail.com(X. Deng).
Contents lists available atScienceDirect
Artiﬁcial Intelligence in Geosciences
journal homepage:www.keaipublishing.com/en/journals/artiﬁcial-intelligence-in-geosciences
https://doi.org/10.1016/j.aiig.2021.10.001Received 15 June 2021; Received in revised form 30 September 2021; Accepted 24 October 2021Available online 27 October 20212666-5441/©2021 The Authors. Publishing Services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the CC BY-NC-ND
license (http://creativecommons.org/licenses/by-nc-nd/4.0/ ).Artiﬁcial Intelligence in Geosciences 2 (2021) 35–46method, a nondestructive method with a rapid detection speed ( Qi et al., 2002) that extracts the dispersion curves of surface waves and then in-verts the near-surface velocity information ( Xia et al., 1999;Park et al., 1999),is widely used in the detection of UUS ( Pugin et al., 2013;Xia et al., 2015).Surface waves include Rayleigh waves, Love waves, and Stoneleywaves; Rayleigh waves, which are formed by P- and SV-waves propa-gating along the free interface, are the most common. Rayleigh wavesbecome dispersive when the formation depth and velocity vary. Thus, thedispersion curves of Rayleigh waves can be used to invert for the velocity(especially the S-wave velocity, Vs) and thickness of underground media.Although this method is extensively used to image near-surface anddeeper earth structures (Zhang et al., 2014;Foti et al., 2011), there are still some challenges, such as the extraction of dispersion curves fromsurface waves (Zhang et al., 2014) and the acquisition of stable andreliable dispersion curves from an inversion algorithm ( Foti et al., 2011; Park et al., 1999). This study will focus on the development of adispersion curve inversion method.Numerous inversion methods, both linear and nonlinear, have beenused to extract the velocity structure from Rayleigh wave dispersioncurves. Linear inversion methods are popular in ﬁeld applications because of their fast convergence speed. The dispersion equations arelinearized, and the inversion results are obtained after the model pa-rameters are modiﬁed by a Jacobian matrix. The damped least squares(DLS) and least squares (LM) methods are common linear methods.However, the depth of investigation inﬁeld applications typically in- volves multiple layers (usually more than 3) with the Rayleigh wavemethod, and the nonlinear problem of inverting multiple parameters (thethickness and velocity in each layer) strongly relies on the initial model,leading to a result with low accuracy and a local optimum solution ( Dal Moro et al., 2007). In contrast, nonlinear inversion methods are inde-pendent of the initial model and obtain results through a global search;consequently, local extrema are avoided ( Lu et al., 2016). The simulated annealing (SA) algorithm (Kirkpatrick et al., 1983) and its derivatives are common nonlinear techniques that are often used for the inversion ofRayleigh wave dispersion curves (e.g., Beaty et al., 2002;Ryden and Park, 2006;Pei et al., 2007;Lu et al., 2016), but these algorithms still have various problems that affect the stability and uniqueness of theinversion:(1) Dispersion curve inversion requires the simultaneous inversion ofmultiple sets of layer thicknesses (h) and Vs. The inversiontherefore exhibits multiparameter and high-dimensional features,but the conventional SA algorithm adapts poorly to multiparam-eter, high-dimensional optimization problems ( Pei et al., 2008). (2) The iteration direction in the SA algorithm is random, and theconvergence is controlled through temperature; thus, the resultmay fall into a local optimum due to the limitation on the numberof iterations and an inaccurate temperature control.Accordingly, we propose an improved SA dispersion curve inversionalgorithm to address these limitations in two ways:1) We introduce the block coordinate descending (BCD) method ( Zhao et al., 2015;Xu and Yin, 2015) to improve the capability of the SAalgorithm to synchronously optimize multiple parameters. Then, themultiple parameters, namely, h and Vs for each layer in a multilay-
ered model, can be inverted by the improved SA algorithm.2) We introduce the differential evolution (DE) algorithm ( Storn and Price, 1997) to control the optimization direction and use the error asthe control condition. Thus, the inversion avoids falling into localoptima.Finally, the block coordinate descent differential evolution simulatedannealing (BCDESA) algorithm is formed. The new algorithm is veri ﬁed by synthetic geological models andﬁeld data.2. MethodAs described in the introduction, using the SA algorithm to invert thevelocities from Rayleigh wave dispersion curves results in a highlynonlinear ill-posed problem. There are two challenges: multiparameterinversion and avoiding locally optimal results. When solving multipa-rameter problems, the SA algorithm has poor performance ( Pei et al., 2008). However, inﬁeld applications, we always need to obtain morethan 3 parameters to account for all necessary formation layers, andhence, SA is not suitable. The fact that the results obtained by the SAalgorithm are locally optimal is a recognized weakness of this techniquebecause the overall iterative process is controlled by temperature and thesearch direction is random.2.1. Principle of the velocity inversion from Rayleigh wave dispersioncurvesIn the inversion of Rayleigh wave dispersion curves, the objectivefunction of the inversion procedure is constructed by the mean squareerror between the forward model and the observed Rayleigh wavedispersion curve, as shown in equation (1):E¼ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ1NXNi¼1ðVrobsi/C0VrcaliÞ2vuut (1)where N is the number of sampling points on the dispersion curve andVr
obsiandVrcaliare the observed and calculated phase velocities, respec-tively, at thei
thsampling point of the frequency. Here, we can use thegeneralized reﬂection-transmission coefﬁcient method (Chen, 1993;Pei et al., 2008) or some other algorithm to calculate the synthetic dispersioncurves by using variousVs, P-wave velocities (Vp), densities (
ρ), andh. Moreover, the observed curves can be extracted from the f-kspectrum of theﬁeld Rayleigh wave data.According toXia et al. (1999), the inﬂuences ofVpand
ρon the Rayleigh wave dispersion curve can be ignored. Therefore, we ﬁxVpand
ρduring the inversion and invert only Vsandhto reduce the uncertainty of the inversion. Global optimization algorithms such as SA are usuallyemployed to solve nonlinear objective functions such as equation (1).W e introduce the basic principles of the SA in the following section.2.2. Simulated annealing (SA)Using the SA algorithm to invert velocity pro ﬁles from Rayleigh wave dispersion curves, the modelVsand h are perturbed by equation(2):Vs
jiþ1¼VsjiþajðV2/C0V 1Þandhjiþ1¼hjiþbjðH 2/C0H 1Þ(2)whereVs
ijandVs ijþ1are theVsvalues at theithand (iþ1)thiterationsof the j
thlayer, respectively;h ijandh iþ1jare the thicknesses of theithand (iþ1)th
iterationsof thejthlayer, respectively; (V 1,V2) represents theVsrange of thej
thlayer; (H 1,H2) represents thehrange of thejthlayer. Only the parameters in their value ranges are effective in the inversion. Theperturbation coefﬁcientsaandbare subjected to a probability distribu-tion, such as a uniform distribution ( Beaty et al., 2002) or a Gaussian distribution (Pei et al., 2007). In this paper, we use the coefﬁcients derived from the very fast simulated annealing (VFSA) algorithm (seeequation(3)). The advantage of this approach is that the perturbationrange of the model becomes narrow when the temperature is decreasing(Ingber, 1989):a;b¼sgn/C18u/C0
12/C19Thð1þ1=TÞ j2u/C01j/C01i(3)where sgn is a step function,uis subject to a uniform distribution, and T is the current temperature.Y. Wang et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 35 –46
36At the beginning of the inversion, the synthetic dispersion curve isobtained from an initial model (Vp,Vs,
ρ,h), and the objective functionE 0
is calculated using equation(1). Then, at aﬁxed temperatureT,w e perturb the initial model using equation (2). An updated objective functionE
1is calculated, and the variation in the objective function(ΔE¼E
1–E0) is obtained. IfΔE is negative, the new model is accepted;otherwise, the model continues to update. This process is repeated untilthe iteration meets certain conditions. Next, the value of Tdecreases, and the above process is repeated at the current Tuntil a steady state is reached. At this time, the updated model is the output result.In this paper, the temperature-dropping rule is expressed asT
kþ1¼T kαﬃﬃ
kp(4)wherekis the temperature-dropping number and
αis the temperature drop coefﬁcient in the range of [0.8, 0.99] (Pei et al., 2008). This formula is derived from the VFSA method (Ingber, 1989). After the values ofVsand h are updated,Vpcan be updated according to Poisson's ratio
σandVs(Xia et al., 1999):Vp¼Vsﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
2ð1/C0 σÞ1/C02
σr (5)
ρis usually a constant, but we can change it depending on the li-thology roughly identiﬁed from the invertedVsproﬁle.2.3. Block coordinate descent simulated annealing (BCDSA)Although the inverted parameters are reduced after consideringρand Vp, in existing Rayleigh wave inversion methods, the parameter dimen-sion is still 2n (n is the number of layers). If n is large, the SA algorithmhas difﬁculty obtaining the ideal outcome (Pei et al., 2008). To avoid the problem of multiple parameters, an alternative iteration approach isproposed. In this scheme, weﬁrst disturbVswith aﬁxedhuntilVsis accepted. Then,his iterated with the updatedVs(ﬁxed) untilhis accepted. If n is large (e.g., n>3), the iteration errors in each layer willaccumulate, and eventually, the inversion will deteriorate.Here, we use the BCD method (Zhao et al., 2015;Xu and Yin, 2015)t o divide the high-dimensional parameter problem into multipleone-dimensional local iterative optimization problems. In each iteration,weﬁrst update the parameters corresponding to the selected coordinateor coordinate block; in the same iteration, other coordinates or coordi-nate blocks areﬁxed, and the overall objective function value andgradient are calculated for optimization. After the selected coordinatesare optimized, the next coordinate or coordinate block is iterated. In theBCD method, a global multiparameter optimization problem can bedivided into several single-parameter local optimization problems, andthe optimal solution can be acquired by stepwise approximation ( Wang et al., 2018;Zhao et al., 2015). Here, we introduce the BCD principle intothe SA algorithm and propose the BCDSA algorithm.The details of the BCDSA algorithm are as follows:
Y. Wang et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 35 –46
372.4. Block coordinate descent differential evolution simulated annealing(BCDESA) algorithmAlthough the BCDSA algorithm is suitable for the multiparameter,high-dimensional inversion of Rayleigh wave dispersion curves, thismethod does not directly control the decrease in error because it uses thetemperature as the termination condition. Moreover, invalid distur-bances under high temperatures may lead to insuf ﬁcient disturbances, ultimately destabilizing the inversion results. Hence, we employ the di-versity of population information in the DE algorithm ( Storn and Price, 1997) to improve the stability of the BCDSA algorithm.Here, the basic operations of the DE algorithm, namely, populationinitialization, mutation and recombination, are introduced.2.4.1.1. Population initializationAn individual m
iis assumed to be in anN-dimensional matrix (i.e., a model withNlayers) in populationM, whereVsandhin m
iare Vs
i¼(Vsi1,V si2,…,V siN), (6a) h
i¼(hi1,hi2,…,hiN). (6b) Theﬁrst generation of the population is randomly generated as fol-lows:Vs
ij¼randðV 1;V2Þ;hij¼randðH 1;H 2Þ i¼1;2; :::;M;j¼1;2; :::;N (7)where rand(A, B) is a function to generate a random number rangingfrom A to B.Vpis updated according to equation(5), and
ρis constant. Theﬁnal initialized population size isM, and the individual dimension is N.2.4.1.2. MutationA new individualm
acan be mutated with two randomly selectedindividualsm
bandm c:m
0
iðgþ1Þ¼m aðgÞþFðm bðgÞ/C0m cðgÞÞa6¼b6¼c;i¼1;2; :::;M(8)wherem
0
iðgþ1Þis the individual of theithvariation in the (gþ1)thgen- eration;m
aðgÞ,m bðgÞ, andm cðgÞare three different individuals in the gth- generation population; andF2½0;2/C138is the scaling factor, for which 0.5 isused in this paper, where a large Fresults in a high diversity of the generated population and a smallFleads to fast convergence (Rahna- mayan et al., 2008).Vsandhare treated according to equation(8), and Vpis updated by equation(4), while the density remains unchanged.2.4.1.3. RecombinationTakingVsas an example, after the (gþ1)
thpopulation mutation, theith
individualVs i(gþ1) may recombine with theithindividualVs iðgÞof thegth
population:Vs
j0
iðgþ1Þ¼(Vsjiðgþ1Þr i<CRVs
jiðgÞothersi¼1;2; :::;M;j¼1;2; :::;N(9)wherejrepresents thej
thdimension ofVsjiðgþ1ÞandVsj0
iðgþ1Þis the result of recombination.r
iobeys a uniform distribution in(0,1).CR2 ½0;1/C138is a recombination factor, which is usually much smaller than 1,such as 0.3 (Storn, 1996).2.4.1.4. SelectionWe use a greedy algorithm to select individuals in the next genera-tion:m
iðgþ1Þ¼(m0
iðgþ1Þ;E/C0m0
iðgþ1Þ/C1<Eðm iðgÞÞm
iðgÞ;other;(10)The basic process of the DE algorithm is as follows:1) Determine the control parameters of the DE algorithm, and determinethe error function. The De algorithm control parameters include thepopulation size NP, scaling factorF, and recombination factor CR. 2) Initialize the population according to equation (7). 3) If the population reaches the termination conditions, the best indi-vidual is the optimal solution; otherwise, the evolution needs tocontinue.4) Obtain intermediate populations through mutation and recombina-tion according to equations(8) and (9), respectively. 5) Select individuals from the original population and the intermediatepopulation according to equation(10)to obtain a new generation of the population.6) Advance the evolution generation number, i.e., g¼gþ1, and go to step 3.Generally, the SA algorithm is used for every individual in all pop-ulations, and the initial temperature is properly reduced to avoid invaliddisturbances caused by high temperatures. The useful information of theparent can be inherited by the next generation, which can accelerate theconvergence of the algorithm. Furthermore, the algorithm can directlycontrol the decline in the error by replacing the traditional temperaturetermination condition with an error termination condition, which im-proves the stability of the algorithm and further increases the accuracy.The idea of using the error as the termination condition and utilizingpopulation selection ensures the stability of the DE algorithm. Moreover,the richer the population information is, the more stable the algorithm.The detailed workﬂow of the proposed algorithm is shown in Fig. 1.3. Performance analysesWe use two models to test the performance of BCDESA in the inver-sion of velocity proﬁles from Rayleigh wave dispersion curves. Themodels contain two and four layers with increasing velocity, as shown inTables 1 and 2, respectively.3.1. Performance of introducing BCD into SAAlthough a higher-order mode was recently used ( Wang et al., 2019), the mode most extensively applied during Rayleigh waveexploration is the fundamental-order Rayleigh wave because of its highenergy and the ease with which it is observed ( Yu et al., 2018). In this study, the dispersion curve of the fundamental-order Rayleigh wave isused to invert the near-surfaceVsandhof each layer. Here, we use the improved fast generalized reﬂection-transmission coefﬁcient method (Chen, 1993;Pei et al., 2008) to calculate the dispersion curves fordifferent models.During the inversion, theVsandhin each layer usually range from 0.5to 1.5 times the true value (Lu et al., 2016) to improve the accuracy. In practical applications, we can limit the search ranges of these two pa-rameters based only on the Rayleigh wave dispersion curve because thephase velocity of the fundamental-order Rayleigh wave at thelow-frequency limit is close to 0.92 times the Vs of the homogeneoushalf-space, and the corresponding high-frequency limit is close to 0.92times the Vs of theﬁrst layer (Knopoff, 1964). Moreover, the investigation depth of the Rayleigh wave is half of themaximum wavelength. We set the model range of Vsfrom the 0.5 times the minimum Rayleigh wave phase velocity to 1.5 times the maximumphase velocity. The layer thickness is greater than 0, and the sum of thelayer thicknesses is smaller than the maximum wavelength.We perform 10 inversions for the two models by both SA and BCDSA.The input parameters are the same for each inversion ( T0,Tend,
α), as listed inTable 3, and theNumis the iteration number required to meetthe termination condition. The SA algorithm uses the alternating itera-tive optimization method forVsandh(Pei et al., 2007). In the BCDSAY. Wang et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 35 –46
38algorithm, the number of coordinate blocks is set to 1; i.e., only oneparameter is iterated at a time.Fig. 2shows the error distributions of ten tests. The errors of the re-sults obtained by the SA method may suddenly change (the errors of thetwo results inFig. 2a are abnormally large), whereas the errors of theBCDSA method are stable. The average error and variance in the 10 in-versions for Models A and B, respectively (see Table 4) illustrate that the introduction of the BCD method into the SA algorithm can signi ﬁcantly improve the accuracy of the latter, especially when the number of modellayers increases.The smallestVserrors are obtained for Models A and B among the 10inversion tests, and the forward modeling dispersion curves are shown inFigs. 3 and 4. The maximum relative error ofVsin Model A is 1.85% and 0.62% for the SA and BCDSA inversion, respectively, and the relativeerror ofhis 9.31% and 1.22%, respectively. With increasing depth(Model B), the BCDSA inversion results are signi ﬁcantly better than SA results.Table 5lists the inversion results and errors for Model B. TheBCDSA inversion results for each layer are better than the SA results. Inparticular, BCDSA greatly improves the inversion accuracy withincreasing depth.Fig. 5shows the decreasing trend of errors during theinversion by using SA and BCDSA. The overall error of the BCDSA al-gorithm exhibits a decreasing trend with decreasing temperature, whichindicates that BCDSA has the capability to jump out of local optima, butthe SA method cannot (iteration>680 inFig. 5a and iteration>2600 in Fig. 5b).3.2. Performance of the introduction of DE into the BCDSA (BCDESA)Because BCDSA uses the temperature as a termination condition, theinversion commonly terminates even if the error does not achieve therequirement when the temperature reaches 0 ( Table 4). In addition, SA and BCDSA are particularly susceptible to accepting a worse solution dueto the limitation of the Metropolis criterion when the number of itera-tions is relatively small (i.e., at higher temperatures, see Fig. 5). Conse- quently, it is easy to obtain invalid results in unsatisfactory inversions. Ingeneral, BCDSA cannot control the error direction. One solution is to usethe DE algorithm to control the termination error by replacing the tem-perature termination condition with an error termination condition. Theworkﬂow of the BCDESA method is shown in Fig. 1. We use Model B as an example to test the performance of BCDESA.The parameters for the BCDESA inversion are as follows: population sizeM¼10, scaling factorF¼0.5, crossover factorCR¼0.3, initial tem- peratureT0¼25, termination temperatureTend¼0.1, temperature drop coefﬁcientα¼0.8, and current temperature maximum iteration numberNum¼2. We set the initial temperature as 25 in BCDESA because theBCDSA algorithm still has a strong ability to jump out of local solutionswhen the temperature is between 28 and 18
/C14C (Iteration>650 inFig. 5a and Iteration>3300 inFig. 5b). In addition, the relatively low initialtemperature also reduces the computational time.To illustrate the controllability of the BCDESA error, we test two caseswhere the termination errorEis 4.5 and 2.0. The other parameters areconstant in the inversions.Fig. 6shows a comparison between the out-comes of the two inversion tests, andTable 6lists the inversion results for each layer. Compared with the BCDSA inversion accuracy ( Table 5), the BCDESA inversion accuracy is higher. However, a lower inversion errorrequires more iterations, resulting in an increased number of calculations(Fig. 7).4. Synthetic data examplesIn this section, we test the performance of the BCDESA inversionmethod with 3 typical layered models ( Pei et al., 2007): Models C
Fig. 1.The workﬂow of the BCDESA algorithm.
Table 1Model A: Parameters of the two-layer model with increasing velocity.
LayerVs(m/s)Vp(m/s) ρ(kg/m3)h(m)1 202 349.9 1900 52 301 521.3 1900 ∞
Table 2Model B: Parameters of the four-layer model with increasing velocity.
LayerVs(m/s)Vp(m/s) ρ(kg/m3)h(m)1 201 348.1 1900 22 301 521.3 1900 43 403 698.0 1900 64 505 874.7 1900 ∞
Table 3Parameters of the SA and BCDSA algorithms. T0: initial temperature;Tend: termination temperature;
α: temperature drop coefﬁcient;Num: iteration number at the current temperature.
Parameters Model A Model BSA BCDSA SA BCDSAT02000 2000 2000 2000Tend0.1 0.1 0.1 0.1
α 0.9 0.9 0.9 0.9Num40 20 200 50Y. Wang et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 35 –46
39(Table 7), D (Table 8), and E (Table 9). TheVsof each layer in Model C is increasing, while Model D contains a high Vsinterlayer, and Model E has a lowVsinterlayer.The computation time is also affected by the population size M, which is usually a multiple of 10 (Storn, 1996). We useModel Bas an example to test the inﬂuence of the population sizeMon the BCDESA algorithm.M is set as 10, 20, and 30, and the termination error is set as 4.5. The otherparameters are the same as those in Fig. 6.Table 10lists the average algebra of generations for the convergence (CAA) and average number ofindividuals generated(ANI) of the algorithm. A value of 10 is the bestchoice forMbecause this value is the minimum number of generations,which requires the fewest computations.4.1. Noiseless caseHere, we use the BCDESA and SA methods to invert the 3 typicalmodels without any noise. The parameters for the BCDESA inversion arethe same as those inFig. 6, except the termination error is 4.5. The pa-rameters for the SA inversion are the same as in Model B in Table 3. Figs. 8–10show comparisons between the models and inversion results.Figs. 8–10(a)show comparisons between the true model dispersion curve(red solid curve) and the forward modeling inversion curves (blue curvefor BCDESA and black dotted curve for SA). Similarly, Figs. 8–10(b)show comparisons between theVsproﬁle of the true model (red curve) and theinverted proﬁles (blue curve for BCDESA and gray curve for SA). Thedispersion curves obtained by BCDESA are closer to the true dispersioncurve, but SA cannot obtain a good result, especially for Model D(Fig. 9b), whereVsandhconsiderably deviate from the model values.The maximum errors of the inverted Vsfor Models C, D, and E from
Fig. 2.Error distribution for 10 inversions using different methods. (a) Model A; (b) Model B. The error is calculated by equation (1). The blue points are the BCDSA errors, and the black crosses are the SA errors. The BCDSA error is lower than the SA error. In Model B, SA has two large error anomalies.
Table 4Stability analysis of the inversion errors from ten tests by using SA and BCDSA fortwo models (the error is calculated by equation (1)).
Model A Model BSA BCDSA SA BCDSAMean error 5.69 2.73 17.06 6.98Variance 8.18 2.54 143.36 7.74
Fig. 3.Inversion results of SA and BCDSA for Model A. (a) shows the dispersion curve. The red line is the true dispersion curve of Model A, and the blue and blacklines are obtained from the inversion results of BCDSA and SA, respectively. (b) shows the Vs pro ﬁle. The red line is the true value of Model A, and the blue and black lines are the inversion results of BCDSA and SA, respectively.
Fig. 4.SA and BCDSA inversion results for Model B. The representations of the lines are the same as in Fig. 3.Y. Wang et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 35 –46
40BCDESA are 2.55%, 3.64% and 5.14%, respectively, while the errorsfrom SA are 3.15%, 24.38% and 13.64%, respectively. The maximumerrors ofhare 6.45%, 5.60% and 12.40% in the BCDESA inversion, whilethe correspondingherrors are 8.80%, 22.47% and 33.67% in the SAinversion, respectively.4.2. Noisy caseInﬁeld applications, recorded seismic data inevitably contain noise,which may reduce the accuracy and stability of the inversion algorithm.Table 5Statistics of the inversion results for Model B (RE stands for relative error).
Parameters True values SA BCDSAInverted RE (%) MSE Inverted RE (%) MSEV1(m/s) 201 137.5 31.57 7.5 187.9 6.50 3.0V2(m/s) 301 246.4 18.14 296.7 1.41V3(m/s) 403 439.0 8.93 427.3 6.02V4(m/s) 505 496.2 1.74 501.7 0.65H12 0.13 93.35 1.76 11.93H24 4.98 24.47 4.19 4.66H36 11.36 89.25 7.39 23.09
Fig. 5.Variations in the errors with increasing iterations. (a) is Model A, and (b) is Model B. The error is calculated by equation (1). Although SA converges faster than BCDSA when the iteration number is small, BCDSA still has the potential to jump out of local solutions as the iteration number increases, enabling BCDS A to obtain a better solution.
Fig. 6.BCDESA inversion of Model B under different termination errors. (a) shows the dispersion curves; (b) shows the Vsproﬁles. The black, blue, and red curves are the inversion results with the termination error set to 4.5, 2.0, and the true value, respectively.
Table 6Statistics of the inversion results for Model B for different TEs. TE and RErepresent the termination error and relative error, respectively.
Parameters TruevalueTermination error¼4.5 Termination error ¼2.0Inverted RE(%)MSE Inverted RE(%)MSEV1(m/s) 201 182.4 9.27 4.1 198.5 1.27 1.8V2(m/s) 301 326.1 8.33 285.5 5.14V3(m/s) 403 400.1 0.73 414.6 2.87V4(m/s) 505 505.5 0.09 506.1 0.21H12 1.84 8.15 1.79 10.51H24 4.82 20.42 3.88 2.94H36 5.37 10.47 6.88 14.67
Fig. 7.Variation in the error with the number of iterations. The generationssigniﬁcantly increase if the termination error is small.Y. Wang et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 35 –46
41We add Gaussian noise of 20 dB to the dispersion curve to test the per-formance of the BCDESA and SA algorithm under noisy conditions. Weset the termination error of the BCDESA to 12 because the mean squareerror (E) of the noisy data and the clean data is between 10 and 11. Theother parameters are not changed.Figs. 11–13show comparisons between the model and the inversionresults for Models C, D, and E, respectively. In Figs. 11–13(a), the red curves are the dispersion curves of the models with added noise. The blueand black dotted curves are the dispersion curves from the inversionresults. Similarly,Figs. 11–13(b)show comparisons of theVsproﬁles between the true model (red curve) and the inverted models (blue curvefor BCDESA and gray curve for SA). The maximum errors of the invertedVsfrom BCDESA for Models C and D, E are 5.43%, 6.01% and 5.14%,respectively, while the errors from SA are 9.14%, 9.81% and 9.79%,respectively. The maximum errors of the inverted hare 3.10%, 7.12% and 12.39% in BCDESA, while the corresponding errors are 55.10%,9.27% and 24.39% in the SA inversion, respectively. The comparableresults between the noise-free and noisy data illustrate the good perfor-mance of the BCDESA algorithm.5. Field data exampleTo further test the applicability of BCDESA, we employ the BCDESAmethod to invert the near-surface structure by using ﬁeld data acquired in southwestern China.Fig. 14shows the acquisition system: the GTDS-10H seismometers are arranged with a minimum source-receiver spacingof 1 m and a receiver interval of 2 m; the time interval is 1 ms, and therecord length is 2 s.Fig. 15a shows the array waveform recordings. Theenergy is concentrated mainly between the 70
thand 170thtraces. A dispersion analysis (Fig. 16b) is conducted by applying anF–Ktransform to the waveforms in channels 121–168. Within the frequency range of10–30 Hz, we can see more than one mode in Fig. 16b. Here, we manually pick only the dispersion curve of the fundamental mode (seethe dotted curve inFig. 15b) to invert the near-surface velocity proﬁle. Core samples were collected approximately 40 m from the researcharea, and the lithological column is shown in Fig. 16a.Table 11lists theh andVsof each layer.Fig. 16b shows the inverted results from BCDESATable 7Parameters for Model C: an increasing Vs layer model.
LayernumberS-wave velocity(m/s)P-wave velocity(m/s)Density (kg/m
3)Thickness(m)1 380 658.2 2000 102 540 935.3 2000 253 700 1056.6 2000 ∞
Table 8Parameters for Model D: a high-Vs interlayer model.
LayernumberS-wave velocity(m/s)P-wave velocity(m/s)Density (kg/m
3)Thickness(m)1 900 1558.8 2000 282 1340 2338.3 2000 243 1200 2078.5 2000 ∞
Table 9Parameters for Model E: a low-Vs interlayer model.
LayernumberS-wave velocity(m/s)P-wave velocity(m/s)Density (kg/m
3)Thickness(m)1 510 883.3 2000 102 400 692.8 2000 163 700 1212.4 2000 ∞
Table 10Convergence comparison of BCDESA with various values of the population sizeM.CAA is the convergent average generation. ANI is the average individualnumber, which represents the number of calculations.
M1 0 2 0 3 0CAA 2.16 1.92 1.91ANI 21. 38.4 57.4
Fig. 8.Inversion results and synthetic dispersion curves of Model C from BCDESA and SA. (a) is a comparison between the true model dispersion curve (red solidcurve) and the best matching dispersion curves from the inversion (blue curve for BCDESA and black dotted curve for SA). (b) is a comparison between the Vsproﬁle of the true model (red curve) and the inverted pro ﬁles (blue curve for BCDESA and gray curve for SA).
Fig. 9.Inversion results and the synthetic dispersion curves of Model D from BCDESA and SA. The description of the ﬁgure is the same as inFig. 8.Y. Wang et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 35 –46
42Fig. 10.Inversion results and the synthetic dispersion curves of Model E from BCDESA and SA. The description of the ﬁgure is the same as inFig. 8.
Fig. 11.Inversion results for Model C from the noise-added (20 dB) dispersion curve of Model C. The description of the ﬁgure is the same as inFig. 8.
Fig. 12.Invert results of Model D from the noise-added (20 dB) dispersion curve of Model C. The description of the ﬁgure is the same as inFig. 8.
Fig. 13.Invert results of Model E from the noise-added (20 dB) dispersion curve of Model C. The description of the ﬁgure is the same as inFig. 8.
Fig. 14.Schematic diagram of the acquisition system. A portable vibroseis source is used.Y. Wang et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 35 –46
43(gray curve) and SA (blue curve). In this inversion, the number of layersis set as 6 in the SA inversion, and the search range of the total thicknessis from 10 m to 30 m. The search range of Vsis from 0.5 times the minimum phase velocity to twice the maximum phase velocity. The otherparameters are the same as the parameter settings in Model B ( Table 3). The parameters in BCDESA, such as the number of layers and the searchranges of the total thickness andVs, are the same as those in the SA inversion. Although the search range of Vsis the same, the initial model Vsis not known in advance in the BCDESA inversion.Fig. 17shows the dispersion curves from the inverted models (bluecurve for BCDESA and black curve for SA) and the dispersion curveextracted from the measured waveform (red curve). The dispersion curvefrom the model inverted by the BCDESA method has relatively smallerrors at low frequencies. Quantitative analysis reveals that the errors oftheVsproﬁles from the BCDESA and SA methods are 6.67 and 7.85,respectively, which further illustrates the effectiveness of the BCDESAmethod. To verify the accuracy of BCDESA, we use the X
2test, which is deﬁned as:X
2¼Xki¼1ðoi/C0e iÞ2
ei(11)
Fig. 15.(a) Array waveform recordings. (b) is the F–Kspectrum of the waveforms from channels 121 –168 in (a). The dotted curve is the manually picked dispersion curve of the fundamental Rayleigh mode.
Fig. 16. (a)Lithological proﬁle from core samples;(b)Vsproﬁle obtained by the inversion.
Table 11Lithology and Vs information from the core samples.
Starting depth(m)Final depth(m)Lithology S-wave velocityrange (m/s)0 2.5 Plain ﬁll 200~300 2.5 8.5 Clay 180~3008.5 15 Pebble soil 300~60015 19.4 Pebble soil 300~60019.4 25 Mudstone (strong weathering)600~130025 45.5 Sandstone (moderate weathering)600~1300
Fig. 17.Forward modeling dispersion curves from the inversions. The bluecurve is the result from BCDESA, and the black curve is the result from SA. Thered curve represents the dispersion curve extracted from the observedseismic waveform.Y. Wang et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 35 –46
44whereo iis the observed dispersion curve,e iis the dispersion curve for- ward modeling ofVsobtained by inversion, andkrepresents k number inversion are carried out. The results of X
2obtained by the above equation is expressed as a sort of normalized distance between observedand the synthesized data. As can be seen from Fig. 18, BCDESA has a smaller deviation than SA from the statistics. Table 12lists the results from the BCDESA and SA inversions in detail. The inversion results fromthe BCDESA method closely follow the borehole lithology, indicating thatthe BCDESA method is more accurate than the SA method alone.6. ConclusionThe inversion ofVsproﬁles from Rayleigh wave dispersion curvesconstitutes a typical nonlinear inverse problem, which is characterizedby multiple inversion parameters and high dimensionality. It is not easyto solve such a problem by using a traditional nonlinear inversion tech-nique, such as the SA algorithm, because an increase in the number oflayers (a random iterative direction) leads to large errors in high-dimensional nonlinear problems. Based on the SA algorithm, we pro-pose the BCDESA algorithm, where the high-dimensional nonlinear SAparameter inverse problem is solved by the BCD algorithm. By using thepopulation evolution and optimal control attributes of the DE technique,the SA algorithm is transformed to control the whole iterative processwith error, thereby avoiding the instability of the inversion algorithm.This method can also be used to solve other nonlinear inverse problemsin the future.In this study, we systematically verify the feasibility of the proposedmethod through experimental analysis. First, the BCD method is used toimprove the SA algorithm, which divides the high-dimensional param-eter inverse problem of Rayleigh waves into several single-parameterlow-dimensional inverse problems and makes full use of the strong SAsolution to the single-parameter low-dimensional problem to improvethe SA inversion accuracy. From two model experiments with differentsets of layer thicknesses, compared to that of the SA algorithm, the ac-curacy of the BCDSA algorithm after introducing the principle of BCD iseffectively improved, especially when the number of layers is increased,and the improvement effect is more obvious. Furthermore, comparativeexperiments reveal that for both BCDSA and SA, local optimization willoccur during the iteration process, and controlling the iteration by atemperature control alone may cause unstable results. In view of theabove problems, this paper further introduces the DE algorithm andchanges the termination condition of the BCDSA algorithm from a tem-perature condition to an error condition. This modi ﬁcation realizes the control of the whole iterative process by using the abovementioned errorand ultimately improves the stability of the algorithm. Finally, we usethree typical theoretical models to show that the BCDESA algorithm has abetter inversion accuracy than the SA algorithm, especially in theinversion of low-speed interlayers, and can identify high-speed in-terlayers. Moreover, the inversion of actual data in western China showthat the inversion results of the BCDESA algorithm are consistent withdrilling data, while the SA algorithm has a large deviation.In the experiment, we alsoﬁnd that the proposed method can set theVs and depth ranges automatically according to the Rayleigh wave ve-locity and wavelength, which can achieve accurate and reliable inversionresults while avoiding the problem of the traditional method, whichneeds to set the ranges of the inversion parameters arti ﬁcially. This provides convenience for practical applications and enables the indus-trialization of the proposed method.Declaration of competing interestThe authors declare that they have no known competing ﬁnancial interests or personal relationships that could have appeared to in ﬂuence the work reported in this paper.AcknowledgementsThis study is supported by National Natural Science Foundation ofChina (NOs. 41974150, 42174158, 42174151, 41804126), a supportingprogram for outstanding talent of the University of Electronic Science andTechnology of China (No. 2019-QR-01), and Project of Basic Scienti ﬁc Research Operating Expenses of Central Universities (ZYGX2019J071;ZYGX 2020J013). We thank three anonymous reviewers whose commentssubstantially improved the presentation of our work.References
Beaty, K.S., Schmitt, D.R., Sacchi, M., 2002. Simulated annealing inversion of multimodeRayleigh wave dispersion curves for geological structure. Geophys. J. Int. 151,622–631.Chen, X., 1993. A systematic and ef ﬁcient method of computing normal modes for multilayered half-space. Geophys. J. Int. 115, 391 –409. Dal Moro, G., Pipan, M., Gabrielli, P., 2007. Rayleigh wave dispersion curve inversion viagenetic algorithms and marginal posterior probability density estimation. J. Appl.Geophys. 61, 39–55.Foti, S., Parolai, S., Albarello, D., Picozzi, M., 2011. Application of surface-wave methodsfor seismic site characterization. Surv. Geophys. 32, 777 –825. Ingber, L., 1989. Very fast simulated Re-annealing. Math. Comput. Model. 12, 967 –973. Kirkpatrick, S., Gelatt, C.D., Vecchi, M.P., 1983. Optimization by simulated annealing.Science 220, 671–680.Knopoff, L., 1964. A matrix method for elastic wave problems. B SEISMOL SOC AM 54,431–438.Lu, Y., Peng, S., Du, W., Zhang, X., Ma, Z., Lin, P., 2016. Rayleigh wave inversion usingheat-bath simulated annealing algorithm. J. Appl. Geophys. 134, 267 –280. Park, C.B., Miller, R.D., Xia, J., 1999. Multichannel analysis of surface waves. Geophysics64, 800–808.Pei, D., Louie, J.N., Pullammanappallil, S.K., 2007. Application of simulated annealinginversion on high-frequency fundamental-mode Rayleigh wave dispersion curves.Geophysics 72, R77–R85.Pei, D., Louie, J.N., Pullammanappallil, S.K., 2008. Improvements on computation ofphase velocities of Rayleigh waves based on the generalized R/T coef ﬁcient method. B SEISMOL SOC AM 98, 280–287. Pugin, A.J.M., Pullan, S.E., Hunter, J.A., 2013. Shear-wave high-resolution seismicreﬂection in Ottawa and Quebec city, Canada. Lead. Edge 32, 250 –255.
Fig. 18.Results ofX2test. The blue points are the results from BCDESA, and thered points are the results from SA.
Table 12Inversion results of the BCDESA and SA algorithms.
BCDESA SALayer thickness (m) Vs(m/s) Layer thickness (m) Vs(m/s)2.56 199.0 2.82 199.35.21 249.2 2.49 262.26.06 572.5 2.15 264.86.83 529.4 2.27 303.66.80 581.0 6.39 718.4∞635.9∞517.2Y. Wang et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 35 –46
45Qi, S., Sun, J., He, H., 2002. Review of Rayleigh wave exploration. Prog. Geophys. 17 (4),630–635.Rahnamayan, S., Tizhoosh, H.R., Salama, M.M., 2008. Opposition-based differentialevolution. IEEE T EVOLUT COMPUT 12, 64 –79. Ryden, N., Park, C.B., 2006. Fast simulated annealing inversion of surface waves onpavement using phase-velocity spectra. Geophysics 71, R49 –R58 s. Storn, R., 1996. On the usage of differential evolution for function optimization. In:Proceedings of North American Fuzzy Information Processing, pp. 519 –523IEEE. Storn, R., Price, K., 1997. Differential evolution –A simple and efﬁcient heuristic for global optimization over continuous spaces. J. Global Optim. 11, 341 –359. Wang, J., Wu, G., Chen, X., 2019. Frequency-bessel transform method for effectiveimaging of higher-mode Rayleigh dispersion curves from ambient seismic noise data.J. Geophys. Res.: Solid Earth 124 (4), 3708 –3723. Wang, Y., Lin, W., Cheng, S., She, B., Hu, G., Liu, W., 2018. Sharp and laterallyconstrained multitrace impedance inversion based on blocky coordinate descent.Acta Geophys. 66, 623–631.Xia, J., Miller, R.D., Park, C.B., 1999. Estimation of near-urface shear-wave velocity byinversion of Rayleigh waves. Geophysics 64, 691 –700. Xu, Y., Yin, W., 2015. A block coordinate descent method for regularized multiconvexoptimization with applications to nonnegative tensor factorization and completion.SIAM J IMAGING SCI 6, 1758–1789. Xia, J., Gao, L., Pan, Y., Shen, C., Yin, X., 2015. New ﬁndings in high-frequency surface wave method. Chin. J. Geophys. 58 (8), 2591 –2605. Yu, D., Song, X., Jiang, D., Zhang, X., Zhao, S., Zhao, P., Cai, W., Yuan, S., 2018.Improvement of artiﬁcial bee colony and its application in Rayleigh wave inversion.Chin. J. Geophys. 61 (4), 1482–1495. Zhang, H., Maceira, M., Roux, P., Thurber, C., 2014. Joint inversion of body-wave arrivaltimes and surface-wave dispersion for three-dimensional seismic structure aroundSAFOD. Pure Appl. Geophys. 171, 3013–3022. Zhao, Q., Meng, D., Xu, Z., Gao, C., 2015. A block coordinate descent approach for sparseprincipal component analysis. Neurocomputing 153, 180 –190.Y. Wang et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 35 –46
46