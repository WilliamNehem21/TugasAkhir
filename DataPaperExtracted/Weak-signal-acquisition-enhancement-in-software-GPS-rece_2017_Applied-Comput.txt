Weak signal acquisition enhancement in softwareGPS receivers – Pre-ﬁltering combined post-correlation detection approach
G. Arul Elangoa,*, G.F. Sudhaa, Bastin Francisb
aDepartment of Electronics and Communication Engineering, Pondicherry Engineering College, Pondicherry, India
bTata Consultancy Services Limited, Bangalore, IndiaReceived 27 April 2014; revised 30 September 2014; accepted 28 October 2014Available online 6 November 2014
KEYWORDSGPS;Singular Spectral Analysis;Weak GPS signal acquisition AbstractThe Civilian Global Positioning System (GPS) receivers often encounter problems ofinterference and noise which degrade the receiver performance. The conventional methods of par-allel code phase search acquisition with coherent, non-coherent and differential coherent detectionfor weak signal acquisition fail to enhance the signal for all conditions especially, when the Carrierto Noise ratio (C/N
0) falls below 15 dB-Hz. Hence, the GPS receiver has to employ sophisticatedtechniques to excise the noise and to improve the Signal-to-Noise Ratio (SNR) of the signal for fur-ther processing. In this paper, a pre-ﬁltering technique of reduced rank Singular Spectral Analysis(SSA) is proposed for noise excision and is processed through coherent, non-coherent and differen-tial detection postcorrelation methods to retrieve the signal embedded in noise. Monte Carlo sim-ulations carried out to examine the acquisition sensitivity at various power levels with the differentpostcorrelation approaches indicate that the SSA combined with differential detection approachprovides a signiﬁcant performance improvement with lesser mean acquisition time. It has 96%probability of detection at a worst signal power level of /C0159 dBm (i.e.C/N
015 dB-Hz), compared to other conventional methods.
/C2112014 The Authors. Production and hosting by Elsevier B.V. on behalf of King Saud University. This isan open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/3.0/ ).
1. IntroductionGlobal Positioning System satellites use spread spectrum typeof ‘L’ band carrier signal ‘L1’ with carrier frequency1575.42 MHz and ‘L2’ with carrier frequency 1227.6 MHzwhich are modulated on 50-bps data stream. This is spreadwith a pseudorandom code called Coarse and Acquisition(C/A) code consisting of a 1023 chip sequence having a periodof 1 ms and a chip rate of 1.023 MHz[1]. In comparison withtraditional hardware GPS receivers, presently, software based
*Corresponding author.E-mail addresses:arulelango2012@gmail.com(G. Arul Elango), gfsudha@pec.edu(G.F. Sudha),bastinfrancis@gmail.com(B. Fran- cis).Peer review under responsibility of King Saud University.
Production and hosting by ElsevierApplied Computing and Informatics (2017) 13,6 6–78
Saudi Computer Society, King Saud University
Applied Computing and Informatics
(http://computer.org.sa)www.ksu.edu.sawww.sciencedirect.com
http://dx.doi.org/10.1016/j.aci.2014.10.0022210-8327/C2112014 The Authors. Production and hosting by Elsevier B.V. on behalf of King Saud University.This is an open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/3.0/ ).GPS receivers are gaining popularity not only for their re-conﬁgurability[2]but also provide an excellent research toolfor investigating and improving the receiver performance ina wide range of conditions. Also software based GPS receiversallow ﬂexibility in dealing with noise excision. The exploitationof spectrum transforms and mathematical tools are more fea-sible in software and faster performance is achieved [3]. The signal acquired by a GPS receiver is deteriorated by interfer-ence and receiver noise giving false information about the vis-ibility of satellite and is unable to provide a precise position ofthe user. This paper proposes an approach for signal acquisi-tion enhancement based on software approach for a L1 GPSreceiver. The typicalC/N
0value of an ideal GPS receiverranges from 37 to 45 dB-Hz. Under noisy conditions, theGPS signal needs to be acquired with the power level rangingfrom/C0160 dBW to/C0200 dBW[4]. In tracking stage of idealGPS receiver, signal strength up to 25 dB-Hz is allowed butacquisition is limited to about 35 dB-Hz[5], so acquisition sen-sitivity is more compared to tracking.A variety of algorithms have been proposed for estimatingand acquisition of the weak signal. The wavelet de-noisingmethod coupled with differential coherent integration (DFC)proposed by Lei et al.[6]achieved a worst case improvementof 2 dB gain within 10 ms integration period at /C0176 dBW (i.e. 28 dB-Hz) compared to traditional DFC algorithm. Anadapted acquisition algorithm depicted by Tian et al., basedon DFC with coherent integration time of 1 ms with 60DFC accumulation is able to detect the weak signal up to30 dB-Hz. By increasing the integration time to 5 ms and10 ms, the extremely feeble signal of 22 and 20 dB-Hz isdetected with 90% detection[7]. The indoor and outdoor envi-ronment acquisition capability of DFC algorithm is mentionedby Ba et al.[4]with signal strength of/C0177 dBW (indoor) and/C0155 dBW (outdoor) acquired with 179 and 1 ms integrationtimes. Yang and Tian[8]compared various weak signal acqui-sition algorithms and reported coherent correlation with DFChas larger output SNR 3–5 dB gain compared to other worksbut there seems a high complexity in implementation. The iner-tial navigation system (INS) aided acquisition algorithm cansuccessfully capture the signal withC/N
0as low as /C0150 dBm[9]while a Block Acquisition Method forC/N
0as low as 21 dB-Hz[10]. A new peak ﬁnding algorithm[11]was able to locate the peak location accurately and provides fasterperformance in a software based acquisition for a C/N
0of 19 dB-Hz. Similarly, a block average model based on the accu-mulation of synchronized and phase corrected signal blocks ofFast Fourier Transform (FFT) was found suitable for Gaus-sian noise, narrow band interference and weak signals [12]. Likewise, a Signal Existence Veriﬁcation Process was proposedto detect and subsequently verify low power-received GPS sig-nals even if the estimated code delay information had an offsetof half chip from the correct one based on the time–frequencyrepresentation[13]. More recently, full bit acquisition algo-rithm for software GPS receiver in a weak signal environmentwas found capable of improving theC/N
0by 2 dB-Hz whenthe noncoherent integration time equals 40 ms [14]. The earlier reported weakest signal that can be detected in 4 s of datausing full bits method is with aC/N
0of 19 dB-Hz[10]. Signal acquisition in the range of 15 dB-Hz can be accomplished byincreasing the integration time up to 20 s. But when the C/ N
0falls below 15 dB-Hz, performing acquisition with coherentdetection beyond 10 ms does not work due to data transitionproblem in the navigation data decoding. Performing non-coherent integration also goes in vain, since extending the inte-gration time to 20 s to fulﬁll the required Processing Gain ( Gp) to more than 20 dB, delays the time to ﬁrst position ﬁx duringcold start conditions.The present study investigates noise using Singular SpectralAnalysis (SSA), as a pre-ﬁltering approach which provides bet-ter weak signal detection without changing the traditionalacquisition methods but with reduced mean acquisition time.The SSA is used as it is a powerful technique for noise reduc-tion irrespective of the environment whether it is stationary ormobile, linear or non-linear, Gaussian or non-Gaussian and itdoes not require prior assumptions about the data [15]. When the GPS signal is corrupted by an additive whiteGaussian noise (AWGN), the worst case signal power level liesin the range of/C0160 dBm. In order to boost up the processinggain at lower SNR, different postcorrelation detection tech-niques are used. The traditional postcorrelation detectionmethods use coherent, non-coherent and differential detectionapproaches. To address the conventional postcorrelationdetection techniques failing to recover a noisy GPS signal aslow as/C0159 dBm (C/No of 15 dB-Hz), the present studyemploys postcorrelation techniques, combined with SSA forweak signal acquisition enhancement (Fig. 1). In the presenceof noise, the GPS trajectory matrix becomes full rank. Whenthe rank is reduced to the minimum extent using reduced rankSVD process it decomposes the data matrix into signal sub-space and noise subspace. Keeping only the signal subspace,the data matrix is said to be noise free. The residue matrix(noise) is found by subtracting the reduced rank matrix fromthe full rank trajectory matrix. However this rank reductiondestroys the structure (Toeplitz/Hankel) of the matrix, thusdemanding a step to re-establish the special structure of thematrix. The rank reduction process is repeated k times, fol-lowed by structure restoration till the minimum Frobeniusnorm is achieved. The reduced rank SVD is known as SingularSpectral Analysis (SSA) if the number of iteration is limited to1, i.e.,k=1[16].The traditional postcorrelation detection techniques fail torecover a noisy GPS signal of signal strength as low as/C0159 dBm (C/No of 15 dB-Hz), therefore present investigationcombines postcorrelation techniques with SSA for weak signalacquisition enhancement. The effectiveness of the SSA com-bined with differential coherent method is compared to otherconventional methods in terms of processing gain and meanacquisition time for various power levels.2. Simulation results and analysesThe received GPS ‘L1’ signal from the Radio Frequency (RF)front end is converted to Intermediate Frequency (IF) of4.1304 MHz and sampled at a frequency of 16.367 MHz. For1 ms of data, the number of samples can be found as 1/1000of the sampling frequency i.e., 16.367/C210
6/1000 = 16367 samples with a single bit resolution. To ensure good probabil-ity of successful acquisition, we have conﬁned the Nvalue as 16,367 samples. The digitized data obtained after analog todigital conversion are given as the input to the acquisition pro-cess to determine the code phase and Doppler frequency of vis-ible satellites. The simulation parameters are mentioned inTable 1.Weak signal acquisition enhancement in software GPS receivers 672.1. Choice of window size (M) and rank (r)The choice of setting window size (M) is based on theW-correlation valueq
w¼ðxðrÞ;xðnÞÞw
kxðrÞkkxðnÞk;whereðxðrÞ;xðnÞÞw¼P
ni¼1wixðrÞixðnÞi.I fxðrÞ;xðnÞare approximately separable andq
w/C250. Though there is no universal rule existing for the selec-tion of the window length (M), it is generally accepted thatM6N/2. Forðkx
ðrÞFkÞ /C29 kxðnÞFkÞ;a better separation isachieved with largerM. However, too large values ofMlead to an undesirable decomposition which in turn yields mixingof residual components. Sometimes small transitions in M reduce the mixing and lead a better separation, hence SSAanalysis was repeated several times using different values ofM[17].At extreme noise level (/C0159 dBm) the de-noising is basedon iterative SSA, initially the SVD is carried out with certainwindow size (M1) which splits the trajectory matrix into signalsubspace (Xr) and noise subspace (Xn). The SVD is performedwith another window size (M2) on noise subspace where it isdecomposed into (X
1r) and (X 1n). This is continued up to sev-eral window sizes and ﬁnally all the signal subspace compo-nents (X
r)+(X 1r)+...(X nr) are added. This yields goodseparation of signals from noise. By repetitive trials, the valueofMwas chosen to be 13 for weak signal of/C0150 dBm and 250 for extremely weak signal of/C0159 dBm.Normalized singular values for varying ranks are plotted asshown inFig. 2a for a GPS signal of power level/C0150 dBm. AAuto- Correlation (X AUTO)
Co-Variance (X COV) 
Modified Covariance (X
Mod.COV ) 
Economy SVDX
(r)= U RS RVRT
Toeplitz (T)
Hankel (H)
Toeplitz over Hankel (TH)Rank Restoration of signal subspace (S)
One dimensional GPS Signal (y) extraction  Compute Trajectory matrix(X)Select Window size (M)
Set Rank = r
YesNo KiterationAuto-Correlation(XAUAATOTT)
Co-Variance(XCOV)
ModififfedCovariance
(XMod.COV)
EconomySVD
X(r)=URUUSRVRRT
Toeplitiiz(T)T
Hankel(H)
Toeplitiizover
Hankel(THTT)RankRestorationof
siggnalsubsppace(S)
OnedimensionalGPSSignal(y)
extractionComputeTrajaectory
matrix(X)SelectWiWWndowsize(M)
SetRank=r
YesNoK
i
t
e
r
a
t
i
o
nSSA based Pre-ﬁltering
Noisy Input GPS Data y N= [y 0, y1, y2…….y N-1]
Diﬀeren/g415al detec/g415onSingle msec detec/g415on     
Coherent detec/g415on
Non-coherent detec/g415on
Diﬀeren/g415aldetec/g415onSinglemsecdetec/g415on
Coherentdetec/g415on
Non-coherentdetec/g415onPost-correla/g415on
Decision statistic (S)
Figure 1Flow chart for proposed pre-ﬁltering combined postcorrelation detection in GPS receivers.
Table 1Simulation parameters for GPS signal.
Parameters ValuesInput sample data length 16,367IF frequency 4.1304 MHzSampling frequencyf
s 16.367 MHz Doppler frequency search ±10 kHz68 G. Arul Elango et al.noise signal typically decreases with sequence of singular val-ues. In our case a signiﬁcant drop in a singular value occursaround the rank value of 2 which could be interpreted as astart of noise ﬂoor.Similarly the extreme weak GPS signal of power level/C0159 dBm is tested and their normalized singular values forvarying rank values are plotted inFig. 2b. A rapid drop inthe singular value occurs at the rank value of 2. So we havechosen rank (r) as 1 for both cases of GPS signal. To under-stand the effect of rank in restoration of weak GPS signals,the noisy GPS signal of power level/C0150 dBm is applied tothe pre-ﬁltering based SSA approach. As per the deﬁnitionof SSA the number of iteration (k) is limited to 1. The recon-structed GPS signal with rank values of 1, 2 and 3 for three dif-ferent trajectory matrices, autocorrelation, covariance andmodiﬁed covariance are plotted inFig. 3.The autocorrelation method with rank 1 Hankel structurebased restoration provides a better version of the reconstructedsignal when compared other methods as shown in Fig. 3b. Hence, this is selected for further processing of GPS signal.The spectrum for an actual input GPS data at /C0130 dBm (Fig. 4a) and noisy GPS data with/C0150 dBm power level(Fig. 4c) for a sampling frequency of 16.367 MHz with an IFof 4.13 MHz is shown inFig. 4b and d respectively. The resultsafter application of SSA on noisy GPS data are shown inFig. 4e and f. From this we infer that the shape of the spectrumafter SSA is preserved and the center frequency is approxi-mately located around 4.13 MHz. If the power level goesbelow/C0159 dBm, i.e., for an extremely weak signal, the pre-ﬁltering alone does not alleviate the detection of visible satel-lites. Hence further enhancement by postcorrelation analysisis required in the GPS receiver to fulﬁll the processing gain.The simulation results for selection of the trajectory matrixdepending on the three performance metrics namely MeanSquare Errorð^eÞ, maximum correlation peak and ProcessingGain (G
p) are given inTable 7. Considering that the correla-tion peak is a measure of perfect alignment of the incomingGPS signal with the C/A code, higher correlation peak signiﬁesmaximum alignment between incoming signal and the local C/A code replica indicating better acquisition. Processing gain isthe measure of total gain obtained after the signal acquisitionand indicates how well the trajectory matrix is able to acquire aweak signal. Along with the processing gain G
pand correlation peak, the other performance metric chosen is Mean SquareError. The mean squared error^ebetween the actual and theestimated signal is given as^e¼
1MPN/C01n¼0jeðnÞj2.For the three cases of trajectory matrices, autocorrelation,covariance and modiﬁed covariance, the Mean Square Erroris given by the following expression^eaut¼1MXN/C01þMn¼0jeðnÞj2
^ecov¼1MXN/C01n¼MjeðnÞj2
^emod:cov ¼1MXN/C01n¼MjeþðnÞj2/C0je /C0ðnÞj2ð1Þwheree
þðnÞande /C0ðnÞare the errors in the computation ofupper Hankel and lower Toeplitz matrices respectively.The results demonstrate that the autocorrelation type oftrajectory matrix combined with differential detection inGPS acquisition, achieves the maximum postcorrelation pro-cessing gain of 20 dB at signal level of/C0150 dBm (Table 7) which is more compared to covariance (17.3 dB) and modiﬁedcovariance (18.2 dB) methods. Similarly, autocorrelation typeof trajectory matrix has produced the highest correlation peak.Though Covariance method is widely used in the SSAapproach[18], the autocorrelation method has a full versionof trajectory matrix that avoids the reacquisition of GPS databy making 5 satellites to be visible. Also, the Minimum MeanSquare Error of 0.2346 is achieved by this method compared toothers approaches. The perfect alignment of pseudorandomnoise (PRN) code with the incoming signal has been achievedfor SVN 31 with highG
p. From the simulation results, it isclear that this method is capable of correcting the code phaseof satellites. The combination of autocorrelation with differen-tial detection is the best choice among the others to enhancethe signal in the worst case SNR level.2.2. Performance comparison of SSA with other pre-ﬁltersTo demonstrate the efﬁcacy of SSA pre-ﬁltering, it is com-pared with other pre-ﬁlters such as Butterworth, Chebyshevand Wavelet techniques[6]. The ﬁlters are being tested withan extremely weak GPS signal having SNR of /C029 dB, a cen- ter frequency of 4.13 MHz and sampling frequency of16.367 MHz. A Butterworth ﬁlter of order 14 and Chebyshevﬁlter of order 5 are designed with a pass band width of2.2 MHz. For a wavelet based ﬁltering, Haar wavelet with 8level decomposition is used to de-noise the signal. A compar-ison of SNRs and achieved gain using the different ﬁltersshows that the Butterworth ﬁlter has obtained a gain of5.8452 dB little more than Chebyshev ﬁlter and wavelet de-noising is able to get only an additional gain of 0.3438 dB.In contrast, the SSA pre-ﬁlter outperforms other methods withan impressive amount of 23 dB gain (seeTable 2).
(a) (b)1 2 3 4 5 6 7 8 9 10 11 1200.20.40.60.81
ranknormalized singular values
50 100 150 200 250 30000.20.40.60.81
ranknormalized singular values
Figure 2Selection of singular values (a) GPS signal of /C0150 dBm and (b) extremely weak signal of/C0159 dBm.Weak signal acquisition enhancement in software GPS receivers 692.3. Parallel code phase search acquisition scheme for singlemsec dataA weak GPS signal with SNR of/C0150 dBm (C/N
0of 24 dB- Hz) is tested with the circular correlation based traditionalFFT frequency domain technique. The Parallel Code PhasePeak search algorithm for determining the threshold is beingused to determine the dominant peak[11]with the assumptionthat if the difference between maximum value and second max-imum value is large enough, the probability of false alarm willbe decreased.The threshold condition for peak search is given in Eq. (2) [11]max½SðnÞ/C138 /C0mean½SðnÞ/C138>VT
1ð0:3Þmax½SðnÞ/C138 /C02
ndmax½SðnÞ/C138>VT 2ð0:15Þ/C27ð2ÞAs per the conditions mentioned in Eq.(2), the difference between maximum and mean peak values and difference(a) 
(b) (c) 
(d) (e) 
(f) (g) 
(h) (i) 0 500 1000 1500-505
samplesamplitudeGPS SIGNAL (-130dBm)
0 500 1000 1500-20-1001020rank=1,number of iterations(k) =1
samplesamplitude
0 500 1000 1500-100-50050100rank=2
samplesamplitudeauto correlation method
0 500 1000 1500-150-100-50050100150rank=3
samplesamplitudeautocorrelation method
0 500 1000 1500-40-200204060rank=1
samplesamplitudecov method
0 500 1000 1500-40-2002040rank=2
samplesamplitudecov method
0 500 1000 1500-60-40-200204060rank=3
samplesamplitudecov method
0 500 1000 1500-50050rank=1
samplesamplitudemod cov method
0 500 1000 1500-100-50050100rank=2
samplesamplitudemod cov method
(j) 0 500 1000 1500-150-100-50050100150rank=3
samplesamplitudemod cov method
Figure 3Reconstructed GPS signal for rank values 1, 2 and 3 (a) actual GPS signal. (b–d) – autocorrelation method (e–g) – covariancemethod (h–j) – modiﬁed covariance method.70 G. Arul Elango et al.between 1st maximum and 2nd maximum peak valuesshould be greater than 0.3 and 0.15. In order to get a minimumprobability of false alarm 10
/C02, the thresholdsVT 1andVT 2
values are chosen as 0.99 and 0.25 respectively. In case, thecorrelation output crosses the above predetermined thresholdwith only one period time of C/A code, the GPS receiver can-not produce an SNR gain to make a reliable detection. It isobserved that the weak signal detection with single msec datadoes not satisfy the condition. As it fails to give a maximumvalue of the decision statistic (S) and hence no satellites arevisible. The simulation results of testing one msec data forSatellite Vehicle Number (SVN) 31 indicate that both withSSA and without SSA fail to excise the noise(Fig. 5a and b). For reasonable acquisition of signals around35 dB-Hz with nominal amount of false alarm [5], single msec data is sufﬁcient, still in order to meet the speciﬁed thresholdvalues for weak signal (<35 dB-Hz), longer duration dataare needed.2.4. SSA combined coherent detection based post-correlationapproachThe coherent detection method is tested for/C0150 dBm power level at 4 ms integration time. The method is unable to satisfythe maximum value of the decision statistic ( S) and poor cor- relation performance of SVN 31 (Fig. 6a) and the data aretested with the SSA method. Among the locally generated32-PRN codes correlated with the incoming signal, onlySVN-31 crosses the peak condition (Fig. 6b) requiring mini-mum of 4 satellites to ﬁnd out the user position. Increasingthe acquisition data length beyond 10 ms leads to data transi-tion. Longer duration coherent detection increases number offrequency bins to be searched which restricts extending theintegration time during weak signal conditions. As coherentintegration even when combined with SSA is not able to detectweak signals less thanC/N
024 dB-Hz, therefore non-coherentintegration is next to study.(a) (b)
(c) (d)0 100 200 300 400 500 600 700 800-505
samplesamplitudeGPS SIGNAL (-130 dBm)
0 2 4 6 8 10 12 14 16
x 1060102030
Frequency (Hz)Magnitude (dB)SPECTRUM OF GPS SIGNAL
0 100 200 300 400 500 600 700 800-100-50050100
samplesamplitudeNOISY GPS SIGNAL (-150dBm)
0 2 4 6 8 10 12 14 16
x 10651015202530
Frequency (Hz)Magnitude (dB)SPECTRUM OF NOISY GPS SIGNAL
(e) (f) 0 100 200 300 400 500 600 700 800-20-1001020
samplesamplitudeNOISE EXCISED GPS SIGNAL THROUGH SSA
0 2 4 6 8 10 12 14 16x 10
6-20-100102030
Frequency (Hz)Magnitude (dB)SPECTRUM OF NOISE EXCISED SIGNAL THROUGH SS A
Figure 4Simulation results of SSA on noisy GPS signal. (a) GPS signal at /C0130 dBm, (b) spectrum of the GPS signal, (c) noisy GPS signal of/C0150 dBm, (d) spectrum of noisy GPS signal. (e) Noise excised GPS signal and (f) spectrum of noise stripped GPS signal.
Table 2Type of ﬁlters used for noise excision (SNR of weak signal before ﬁltering = /C029 dB).
Pre-ﬁlter type used SNR(dB)= 10/C3logPN/C01n¼0xðnÞ2
PN/C01n¼0ðxðnÞ/C0~xðnÞÞ2/C18/C19After ﬁltering Gain (dB)Butterworth ﬁlter /C023.1548 5.8452 Chebyshev ﬁlter /C023.3740 5.6260 Wavelet de-noising /C022.6816 6.1894 Singular spectral analysis /C06.3529 22.7335Weak signal acquisition enhancement in software GPS receivers 712.5. SSA combined noncoherent detection based post-correlationapproachThe/C0150 dBm GPS data are tested for 40 ms duration nonco-herent integration time.Fig. 7.a shows the non-coherent detec-tion result of SVN 31 without SSA where the maximum valueof the decision statistic (S) is not arrived, the required thresh-old conditions, and the signal is declared absent. While testingnoncoherent integration with SSA, only SVN-31 is found withdominant peak (Fig. 7b). Studies have demonstrated that theSignal Sensitivity increases roughly with square root of inte-gration time[19]and a 10 ms longer integration time gives only5 dB increase in sensitivity. Hence it is concluded that 100 msnon-coherent integration correlation i.e. one tenth of seconddata are required to acquire a signal having C/N
0up to 24 dB-Hz[5].2.6. SSA combined differential coherent detection basedpostcorrelation approachThe 16 ms duration noisy data are tested for differential coher-ent detection approach at/C0150 dBm power level. The SVN-31correlation performance is tested and it surpasses the thresholdvalue. But at lower power level (below/C0159 dBm) the decisionstatistic (S) does not cross the predetermined threshold valuesfor SVN-31.This is because the noise independent property hascapability of removing the squaring loss up to certain SNRvalues only. On examiningFig. 8a and b it is inferred that dif-ferential coherent scheme is able to detect only one visibleSVN-31 for SNR level of/C0150 dBm. When the signal levelis weaker (/C0159 dBm), even an increase in integration timeto 100 ms does not make any satellite to be visible.In the proposed work, the SSA approach is combined withdifferential detection and ﬁve SVNs are visible and the decisionthreshold conditions have been satisﬁed without any con-straints. Perfect correlation has been achieved and many falsesecondary peaks owing to noise are eliminated. The ﬁve SVNs(2, 17, 26, 27, and 31) meet the threshold condition for the sig-nal range ofC/N024 dB-Hz and 15 dB-Hz (Table 3).Fig. 9a–e shows the ﬁve SVN’s 3-D correlation and their correspondingcode phase i.e., perfect alignment with the C/A code samples isplotted inFig. 9f–j.Table 4summarizes the comparison of theresults of 15 dB-Hz weak GPS signal tested with differentdetection methods. The proposed method i.e. SSA combinedwith differential detection performs better in obtaining visiblesatellites for 16 ms weak GPS data and acquiring 5 SVNs toinitiate the tracking process. Even though the differentialdetection scheme has dominant peak but the threshold condi-tion 1 is not satisﬁed for all the SVNs. The code phase andDoppler frequency comparison between different detectiontechniques are listed inTable 5. The data show that the differ-
Figure 5Correlation output of SVN-31 tested with 1 ms integration time for input power level of /C0150 dBm (C/N 0of 24 dB-Hz). (a) Single msec data and (b) single msec processed using SSA.
Figure 6Correlation output of SVN-31 tested with coherent detection (4msec) for input power level of /C0150 dBm (C/N 0of 24 dB-Hz). (a) Coherent integration time and (b) SSA combined with coherent integration time.72 G. Arul Elango et al.ential coherent detection technique with pre-ﬁltering approachcorrects the deviation in code phase of 22.1 chips and Dopplerfrequency of 164 Hz of the SVN-31 caused by noise at/C0150 dBm when compared to differential detection.3. Acquisition sensitivity analysis3.1. Processing Gain (G
p) estimation in software GPS receiverThe nominal signal strength of a typical C/A code receiver is/C0130 dBm[20]. The noise ﬂoor for 1 kHz is at/C0144 dBm; thusthe corresponding SNR is 14 dB (/C0130 + 144). The inputpower level of incoming GPS signal varies from /C0130 dBm to/C0159 dBm and the locally generated PRN-31 is correlatedwith incoming signal for the probability of false alarm ( pfaÞ of 10
/C02. The probability of detection and theG pare computed for different integration periods. The Monte Carlo simulationis carried out for 10,000 trials to ensure the effectiveness of theperformance comparison between the three detection methods.A weak GPS signal of/C0140 dBm (34 dB-Hz) i.e. SNR of(/C0140 + 144) = 4 dB was set as power level. In order toachieve nominal SNR of 14 dB, a gain of 10 dB is required,
Figure 7Correlation output of SVN-31 tested with non-coherent detection (40 ms) for input power level of /C0150 dBm (C/N 0of 24 dB Hz). (a) Non-coherent integration time and (b) SSA combined with Non-coherent integration time.
(a) (b) 
Devia/g415on in code phase and doppler frequency
Figure 8Acquisition correlation output of SVN-31 tested with differential detection for input power level of /C0150 dBm (C/N 0of 24 dB Hz) and/C0159 dBm (C/N
0of 15 dB Hz). (a) 16 ms integration time at /C0150 dBm power level and (b) 100 ms integration time at /C0159 dBm power level.
Table 3Comparison of different detection techniques at two power levels.
PowerlevelPeak search condition = Max peak-mean peak >0.99 and Max peak-secondary peak >0.25Detection type1 ms data Coherent post-correlation Noncoherent post- correlationDiﬀerential post-correlationWithoutpre-ﬁlterPre-ﬁltercombinedWithoutpre-ﬁlterPre-ﬁltercombinedWithoutpre-ﬁlterPre-ﬁltercombinedWithoutpre-ﬁlterPre-ﬁlter combined/C0150 dBm No visibleSVNNo visibleSVNNo visibleSVN1 SVN (31) No visibleSVN1 SVN (31) 1 SVN (31) 5 SVN (2, 17, 26, 27and 31) /C0159 dBm No visibleSVNNo visibleSVNNo visibleSVNNo visibleSVNNo visibleSVNNo visibleSVNNo visibleSVN5 SVN (2, 17, 26, 27and 31)Weak signal acquisition enhancement in software GPS receivers 73hence signal must be averaged over a sufﬁciently long non-coherent integration time (20 ms) to build up the SNR to areliable level (10 dB) (Fig. 10a). In a similar fashion, the poweris varied at different levels and the corresponding probabilityof detection and theG
pare examined. The detection metricsfor the three detection methods have been presented in Table 6 for different values of signal quality. SNR after correlation isalso determined with longer integration times. The SNR com-putation in the software receiver is deﬁned as the ratio betweenthe accumulated and averaged in phase arm ( ^Iarm) power to the(a) SVN 2 (b) SVN 17 (c) SVN 26 
(d) SVN 27 (e) SVN 31
(f) (g) (h)
(j) (i)
0 2000 4000 6000 8000 10000 12000 14000 16000012345x 1014
SamplesMagnitudeSVN-17
0 2000 4000 6000 8000 10000 12000 14000 160000246810x 1014 SVN-26
SamplesMagnitude
0 2000 4000 6000 8000 10000 12000 14000 160000246810x 1014
SamplesMagnitudesSVN-27
0 2000 4000 6000 8000 10000 12000 14000 1600000.511.522.5x 1015
SamplesMagnitudeSVN-310 2000 4000 6000 8000 10000 12000 14000 160000246810x 1014
SamplesMagnitudeSVN-2
Figure 9Correlation outputs of visible SVN tested with GPS data of input power level of /C0159 dBm (C/N 015 dB-Hz) using SSA combined differential coherent approach. (a–e) – 3D search correlation results for SVN 2, 17, 26, 27 and 31 (f–j) – code phase for SVN 2,17, 26, 27 and 31.
Table 4Determination of visible SVN based on peak search condition tested for different detection techniques processed throughSSA at/C0159 dBm power level.
SVN Pre-ﬁlter combined coherent Pre-ﬁlter combined non- coherentDiﬀerential[6–8]Pre-ﬁlter combined diﬀerentialdetection Maxpeak(e
+07)2nd maxpeak(e+07)Avgpeak(e+07)SMaxpeak(e+07)2nd maxpeak(e+07)Avgpeak(e+07)SMaxpeak(e+19)2nd maxpeak(e+18)AvgPeak(e+18)SMaxpeak(e+15)2nd maxpeak(e+14)Avgpeak(e+12)S2 3.364 0.795 0.183/C24.205 0.993 0.229/C20.195 0.265 0.114/C20.9945 0.555 5.007p 17 2.166 0.715 0.161/C22.708 0.894 0.201/C20.167 1.003 0.126/C20.4122 0.449 3.808p 26 3.127 1.545 0.193/C23.909 1.931 0.242/C20.208 0.389 0.133/C20.8596 2.098 5.680p 27 3.167 1.559 0.228/C23.959 1.948 0.285/C22.180 0.087 1.057/C20.8814 2.135 7.442p 31 4.983 1.206 0.202/C26.229 1.508 0.253/C20.702 3.139 0.302/C22.182 1.279 6.414pS– Whether detection threshold condition satisﬁed – p– Yes and/C2– No.74 G. Arul Elango et al.accumulated and averaged noise power ( ^Q arm) given by Eq.(3) [21]SNR¼10log
10^I2arm
2^Q2arm !dB^I
2arm¼ðfssÞ2c2and^Q 2arm¼fssr2yð3Þwheres– integration time,C– carrier power,r
2y– noise variance.Theoretically noncoherent integration time of 20 ms isenough to obtain the gain of 10 dB at/C0140 dBm, however,50 ms is required to get the highest probability of detectionduring the simulation. More than a second of data is requiredto get the 100% of detection at the power level of /C0150 dBm. As the required gain goes beyond 20 dB in the incredibly lowerSNR, an increment of 1000 ms integration time results onlyin1.5 dB improvement in gain. So a group of data i.e. 20 s isrequired to attain the gain of 25 dB which is practically impos-sible. Processing non-coherent integration of 20 s data on aPersonal Computer (PC) of 1.46 GHz processor with 1 GBmemory runs 14 h time which delays the time to ﬁx the ﬁrstposition of the satellite in the acquisition stage. Such expensivecomputations will be feasible only for off-line applications [5]. The differential detection scheme shows appreciable perfor-mance compared to non-coherent detection with lower acqui-Table 5Acquisition output for different detection techniques processed through SSA pre-ﬁltering.
PowerlevelSVN Pre-ﬁlter combined coherent Pre-ﬁlter combined non-coherentDiﬀerential detection Pre-ﬁlter combineddiﬀerential detection Code phase(chips)Dopplerfrequency (Hz)Code phase(chips)Dopplerfrequency (Hz)Code phase(chips)Dopplerfrequency (Hz)Code phase(chips)Dopplerfrequency /C0150 dBm 2/C2/C2 /C2/C2 /C2/C2 56.5/C04800 17/C2/C2 /C2/C2 /C2/C2 347.8 4500 26/C2/C2 /C2/C2 /C2/C2 750.4 2700 27/C2/C2 /C2/C2 /C2/C2 365.9 5400 31 322.9 2400 322.9 2400 345 2564 322.9 2400/C0159 dBm 2/C2/C2 /C2/C2 /C2/C2 56.5/C04800 17/C2/C2 /C2/C2 /C2/C2 347.8 4500 26/C2/C2 /C2/C2 /C2/C2 750.4 2700 27/C2/C2 /C2/C2 /C2/C2 365.9 5400 31/C2/C2 /C2/C2 /C2/C2 322.9 2400
Figure 10Acquisition sensitivity improvement at different power levels for PRN-31. (a) G pimprovement of 10 dB through 50 ms non- coherent integration at 34 dB-Hz power level and (b) G
pimprovement of 20 dB through 16 ms pre-ﬁltering combined differential coherent integration at 24 dB-Hz power level.Weak signal acquisition enhancement in software GPS receivers 75Table 6Required integration time, Processing Gain ( G p) and mean acquisition time (T acq) at different power levels of GPS signal.
Detection type Input C/N 0(dB-Hz)Integration time(ms)Probability of detection(%)G p
(dB)Mean acquisition time(s) Noncoherent detection 44 ( /C0130 dBm) 1 100 – 23.3934 (/C0140 dBm) 2 1.8 2.20 46.7810 3.62 6.71 233.9220 10.53 8.46 467.8550 97.30 10.67 1.16e
+03
24 (/C0150 dBm) 50 26.66 10.67 1.16e+03
100 34.54 12.29 2.33e+03
500 92.76 15.94 1.16e+04
1000 98.45 17.48 2.33e+04
1500 100 18.37 3.50e+04
19 (/C0155 dBm) 2000 93.23 19.01 4.67e+04
10,000 100 22.54 2.33e+05
15 (/C0159 dBm) 20,000 91.22 24.05 4.67e+05
Diﬀerential detection[7]44 4 100 – 25.0734 8 100 9.30 40.0924 16 100 19.72 78.5619 32 98.56 23.42 124.7615 64 68.24 24.32 153.23SSA combined with diﬀerentialdetection44 2 100 – 70.9334 2 100 10.03 70.9324 4 100 19.22 112.9019 8 99.44 24.50 131.2815 16 96.11 29 269.88
(a) (b)5 10 15 20 25 30 35 40 4500.10.20.30.40.50.60.70.80.91
C/N (dB-Hz)PDMonte Carlo Simulation Results
pre-filtering combined differential coherent-16 msec
differential coherent-32 accumulations (Tcoh=10msec)
noncoherent-2sec
10010110210310410515202530354045
Integration Time [m.sec]C/N0 [dB-Hz]noncoherent
differential coherent(Tcoh=10msec)
pre-filtering combined differential coherent
(c)15 20 25 30 35 40 45101102103104105106
C/N0 [dB-Hz]mean acquisition time [sec]noncoherent
differential coherent(Tcoh=10msec)
pre-filtering combined differential coherent
Figure 11Performance comparison of various detection techniques. (a) C/N 0versus probability of detection, (b) integration time versus C/N
0and (c)C/N 0versus mean acquisition time.76 G. Arul Elango et al.sition time, however, for dealing with15 dB-Hz weak signal,even after extending the integration time to 100 ms is not suf-ﬁcient enough to meet the decision statistic and the detectionprobability is around 0.68 only. On the other hand, the SSAcombined differential detection does well in the lower SNRlevel.Fig. 10b shows theG
pimprovement of 20 dB under thepower level 24 dB-Hz while performing 16 ms differential inte-gration time combined with SSA. The pre-ﬁltering combineddifferential coherent approach provides a signiﬁcant G
pof 29 dB within the integration time of 16 ms having 96% ofprobability of detection under the signal level of /C0159 dBm. An additional gain of 3 dB with a detection probability of0.96 is being provided by the pre-ﬁltering combined differentialcoherent method (Fig. 11) compared with the differentialdetection approach in the signal range lower than C/N
0
20 dB-Hz. Integration Time versusC/N 0is plotted whereC/ N
0goes below the nominal level (Fig. 11b), the required non-coherent integration time is in the order of 10
4ms whereas performing pre-ﬁltering combined differential coherent detec-tion the required integration is about 20 ms.3.2. Mean acquisition time computationMean acquisition time (T
acq) for coarse acquisition (C/A) codeis computed for a parallel code phase search acquisition system[22].T
acq¼ð2/C0P dÞð1þkP faÞ2P
dðqsdÞ;q¼2046/C341ð1=T
cohÞð4Þ wheres
dis total GPS integration period,kP fais false alarm penalty time (by keepingk= 10),qis the total number of cellsto be searched in the bin andT
coh= 1 ms for coherent, nonco-herent and 10 ms for DFC. Using the Eq.(4),T
acqis computed for different integration times.Fig. 11c shows that processing20 s non-coherent data takes the computing time of 4.6785e+05 s whereas utilizing 16 ms pre-ﬁltering combined differen-tial integration method, the required gain is attained within269.88 s of mean acquisition time.3.3. Computation complexityThe initial step of formation of trajectory matrix requires com-plexity of O (N
2) operations. The multiplication of left singularmatrix with sizeN/C2(N/C0r), diagonal matrix of size (r/C2r) and the right singular matrix with sizeM/C2Min the economy SVD rank reduction step requires O (N
3) operations. The ﬁnalstep of diagonal averaging in rank restoration requires O ( N
2)computations. In total, a worst case complexity of O ( N2)+O (N
3)+O(N2)=O(N3) operations are required for SSA algo-rithm computation. While running the SSA algorithm on1.46 GHz processor with 1 GB memory in MATLAB simula-tor, the average computation time of SVD stage is only around9.5773 s, rank reduction stage is 7.883210 s and reconstructionstage is 6.767183 s. Hence total computation time of SSA isonly 24.227 s. The 16 ms DFC based parallel code phasesearch acquisition algorithm takes 241.2868 s. Therefore thetotal mean acquisition time for the SSA based differentialscheme for 15 dB-HzC/N
ois 269.88 s as shown inTable 6. Hence the inclusion of the SSA stage has signiﬁcantlyincreased the overall computation time. Therefore with theproposed approach, the extremely weak signal has beenacquired with less acquisition time without much increase incomputational time.4. Conclusion and future workThe SSA based de-noising approach relies on ﬁnding the econ-omy SVD of the autocorrelation trajectory matrix of noisyinput samples and maintaining the structure of the matrix byapplying suitable rank reconstruction (Toeplitz/Hankel) meth-ods. On testing with noisy GPS signal, this method combinedwith DFC efﬁciently handles lower power signal level of/C0159 dBm with shorter integration time and achieves 3 dBgain improvement within 269.88 s of mean acquisition time.The detection of the number of visible satellites is increasedand also the re-acquisition of GPS data is avoided. From thesimulation results, the differential coherent detection techniquewhen combined with pre-ﬁltering corrects the deviation in codephase and Doppler frequency of the visible SVN compared toother conventional methods. The SSA based de-noising cou-pled with DFC has an ability to recover the weak signals onlyup to/C0159 dBm which is the limitation of current approach.Therefore for an indoor environment, Independent Compo-nent analysis can be used in the SSA signal decomposition stepfor ﬁnding proper rotations of eigen triples in weak signalseparability.References
[1]Michel S. Braasch, A.J. Van Dierendonck, GPS receiverarchitecture and measurements, Proc. IEEE 87 (1999) 48–64
. [2]
Giacomo Bacci, Filippo Giannetti, Marco Luise, Softwaredeﬁned radio technologies GNSS receivers: a tutorial approachto a simple design and implementation, Int. J. Navigat. Observ.(2010)
.[3]
Kai Borre, Dennis M. Akos, Nicolaj Bertelsen, Peter Rinder,Soren Holdt Jensen, A Software Deﬁned GPS and GalileoReceiver, Birkha¨user Bostonin, 2007 (ISBN-10 978-0-8176-4390-
4).[4] Xiaohui Ba, Ying Yang, Jinhai Li, Jie Chen, Differentiallycoherent acquisition algorithm for indoor GPS, IETInternational Conference on Wireless, Mobile and MultimediaNetworks, 2006, 6–9 November 2006, pp. 1–4.[5] Luke Winternitz, Michael Moreau, Gregory J. Boegner, Jr.,Steve Sirotzky, Navigator GPS receiver for fast acquisition andweak signal space applications, in: Proceedings of the 17thInternational Technical Meeting of the Satellite Division of TheInstitute of Navigation (ION GNSS 2004), Long Beach, CA,September 2004, pp. 1013–1026.Table 7Selection of trajectory matrix tested for SVN-31 at/C0150 dBm.
Parameters Type of trajectory matrixAutocorrelation Autocovariance Modiﬁedcovariance Mean squareerrorð
^eÞ0.2346 0.7789 0.6356Maximumcorrelationpeak2.182e
152.8549e134.5627e13
Gp(dB) 20 17.3 18.2Weak signal acquisition enhancement in software GPS receivers 77[6] Nana Lei, Hao Zhu, Jianyong Cui, Wavelet-based method forweak satellite signal acquisition. International Conference onTransportation, Mechanical, and Electrical Engineering(TMEE), 16–18 December 2011, pp. 2487–2490.[7] Shijun Tian, Yiming Pi, Research of weak GPS signalacquisition algorithm, Communications, Circuits and Systems,2008. ICCCAS 2008, 25–27 May 2008, pp. 793–796.[8] Liu Yang, Jin Tian, Analysis and compare of weak GPS signalacquisition algorithms, IET International CommunicationConference on Wireless Mobile and Computing (CCWMC2009), 7–9 December 2009, pp. 492–495.[9] Jingwei Ma, Lingjuan Miao, Xi Zhang, Zhifeng Gao, Weaksignal acquisition algorithm of GPS software receiver aided byINS, Sixth International Symposium on ComputationalIntelligence and Design (ISCID), 2013, 28–29 October 2013,vol. 1, pp. 321–325.[10] M.L. Psiaki, Block acquisition of weak GPS signals in asoftware receiver, in: Proceedings of Institute of NavigationGPS Conference 2001, Salt Lake City, UT, USA, 2001, pp.2838–2850.[11]Wei-Lung Mao, An-Bang Chen, New code delay compensationalgorithm for weak GPS signal acquisition, Int. J. Electron.Commun. (2008) 665–677 (Elsevier Publications)
. [12] Mohamed Sahmoudi, Moeness G. Amin, Rene Jr. Landry,Acquisition of weak GNSS signals using new block averagingpre-processing, Position, Location and Navigation Symposium,IEEE/ION2008, pp. 1362–1372.[13]
Shau-Shiun Jan, Chih-cheng Sun, Signal Existence Veriﬁcation(SEV) for GPS low received power signal detection using thetime-frequency approach, J. Sens. (2010) 4717–4738
.[14] Yingyan Song, Xue Li, Yikang Yang, Lei Liu, Enhanced full bitacquisition algorithm for software GPS receiver in weak signalenvironment, IEEE International Conference on ComputationalProblem-Solving, 2011 (ICCP2011), pp. 440–443.[15]Hossein Hassani, Singular spectral analysis: methodology andcomparison, J. Data Sci. (2007) 239–257
. [16] Sophocles J. Orfanidis, SVD, PCA, KLT, CCA, and All That-Acourse on Optimum Signal Processing, Rutgers University,2002–2007.[17] Golyandina, Nina, Zhigljavsky, Anatoly, Singular SpectrumAnalysis for Time Series, Springer Publications, ISBN 978-3-642-34913-3, 2013.[18] A Beginner’s guide to SSA, David Claessen and Andreas Groth,CERES-ERTI, Ecole Normale Superieure, Paris.[19] Bo Zheng, Ge´rard Lachapelle, GPS software receiverenhancements for indoor use, in: Proceedings of the 18thInternational Technical Meeting of the Satellite Division ofThe Institute of Navigation (ION GNSS 2005), Long Beach,CA, September 2005, pp. 1138–1142.[20]
James Bao-Yen Tsui, Fundamental of Global PositioningSystem Receivers – A software Approach, second ed., A WileyInterscience Publication, New York, 2000, pp. 133–160
. [21] Angelo Joseph, Measuring GNSS Signal strength, Inside GNSSMagazine, November/December 2010, pp. 20–25.[22] Lingjuan Wu, Weijun Lu, Dunshan Yu, Research of weak signalacquisition algorithms for high sensitivity GPS receivers, AsiaPaciﬁc Conference on Postgraduate Research inMicroelectronics & Electronics (Prime Asia), 19–21 January2009, pp. 173–176.78 G. Arul Elango et al.