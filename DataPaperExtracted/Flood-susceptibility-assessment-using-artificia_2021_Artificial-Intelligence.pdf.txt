Flood susceptibility assessment using artiﬁcial neural networks in Indonesia
Stela Priscilliaa,*, Calogero Schillacib, Aldo Lipania
aDepartment of Civil, Environmental and Geomatic Engineering, University College London (UCL), United Kingdom
bEuropean Commission, Joint Research Centre, Italy
ARTICLE INFO
Keywords:Radar remote sensingTopographyDEMCNNSegmentationFloodWaterABSTRACT
Flood incidents can massively damage and disrupt a city economic or governing core. However, ﬂood risk can be mitigated through event planning and city-wide preparation to reduce damage. For, governments, ﬁrms, and civilians to make such preparations,ﬂood susceptibility predictions are required. To predict ﬂood susceptibility nine environmental related factors have been identi ﬁed. They are elevation, slope, curvature, topographical wetness index (TWI), Euclidean distance from a river, land-cover, stream power index (SPI), soil type and pre-cipitation. This work will use these environmental related factors alongside Sentinel-1 satellite imagery in a modelintercomparison study to back-predict ﬂood susceptibility in Jakarta for the January 2020 historic ﬂood event across 260 key locations. For each location, this study uses current environmental conditions to predict ﬂood status in the following month. Considering the imbalance between instances of ﬂooded and non-ﬂooded condi- tions, the Synthetic Minority Oversampling Technique (SMOTE) has been implemented to balance both classes inthe training set. This work compares predictions from arti ﬁcial neural networks (ANN), k-Nearest Neighbors algorithms (k-NN) and Support Vector Machines (SVM) against a random baseline. The effects of the SMOTE arealso assessed by training each model on balanced and imbalanced datasets. The ANN is found to be superior to theother machine learning models.
1. IntroductionWhen compared to other meteorologically driven natural disasters,ﬂooding is one of the most disastrous phenomena as it can lead tomassive damage to both properties and fatalities worldwide ( Hinkel, 2020;Tehrany et al., 2015). Indonesia is a country that has signiﬁcant ﬂood risk in most of its provinces, with the islands of Java, Bali, andSumatera as the largest at-risk areas ( Bappenas, 2010). Jakarta, ofﬁcially called Special Capital Region of Jakarta, is the capital city of Indonesiaand is located on Java Island. Jakarta has a population of over 10 millioninhabitants (as of 2019) within a 662.2 km
2area, as a result Jakarta is the most densely populated province in Indonesia ( BPS Jakarta, 2019). Jakarta has been known toﬂood since the 5th century AD (Widya- ningrum, 2019) and modern Jakarta is still at risk due to being located on adeltaic plain crisscrossed by 13 natural rivers and more than 1400 km ofman-made waterways. About 40 percent of the city is below sea level,which contributes toﬂood risk (Baker, 2012). A range of factors including climate change accelerated sea-level rise, extreme meteorological events,along with land subsidence from multiple causes are worsening the ﬂood risk in Jakarta (Abidin et al., 2011;World Bank, 2019).On January 1, 2020, Jakarta was hit by the most intense rainfall event(peaking at 377 mm/day) since records began in 1866 ( BMKG, 2020). This several-day rainfall event resulted in widespread ﬂooding causing 16 deaths, and displacing more than 30,000 people ( BNPB, 2020). The severity of theﬂood event caught city ofﬁcials off-guard, with the huge number of affected persons paralyzing Indonesia's main economic andpolitical hub. Therefore, to mitigate such incidents and allow a timelypreparation, it is paramount to develop an ability to predict and evaluatethe areas of Jakarta that are most susceptible to ﬂooding. In recent years, machine-learning models, particularly arti ﬁcial neu- ral networks (ANN), have been increasingly used for ﬂood susceptibility modelling. Previous research has used precipitation and other environ-mental factors as input to ANNs and to output water levels and aninferredﬂood map (Kia et al., 2012). Although the previously mentionedﬂood events were mainly caused by the heavy rainfall ( BMKG, 2020), a range of researchers have proven that several other factors havecontributed to the disastrousﬂooding in the area. These include eleva-tion, curvature, stream power index (SPI), topographic wetness index(TWI), soil type, distance from rivers, and others ( Kia et al., 2012;Teh- rany et al., 2015).
* Corresponding author.E-mail addresses:stela.priscillia.20@ucl.ac.uk(S. Priscillia),calogero.schillaci@ec.europa.eu (C. Schillaci),aldo.lipani@ucl.ac.uk(A. Lipani).
Contents lists available atScienceDirect
Artiﬁcial Intelligence in Geosciences
journal homepage:www.keaipublishing.com/en/journals/artiﬁcial-intelligence-in-geosciences
https://doi.org/10.1016/j.aiig.2022.03.002Received 6 January 2022; Received in revised form 19 March 2022; Accepted 19 March 2022Available online 8 April 20222666-5441/©2022 The Authors. Publishing Services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the CC BY-NC-NDlicense (http://creativecommons.org/licenses/by-nc-nd/4.0/ ).Artiﬁcial Intelligence in Geosciences 2 (2021) 215 –222There are several factors that could causeﬂood which have been used as bothﬁxed and temporal attributes to predictﬂood susceptibility. However, it is still unknown if those factors combined and inputted intoan ANN model will be able to create a reliable result that could predictﬂood susceptibility in Jakarta. Therefore, the authors of this work seek todevelop a suite of machine learning models that uses as inputs theseenvironmental factors to predictﬂood susceptibility in Jakarta but in anovel manner with a temporal aspect.A novel experimental methodology is used to predict ﬂood suscepti- bility. Commonly used environmentalﬂood risk factors (Tehrany et al., 2015;Shahabi, 2020) have been used in classiﬁcation tasks to predict ﬂood susceptibility for multiple areas using all historical ﬂooding. The novel addition is that unlike theseﬂood susceptibility studies; a rainfalltime series has been included allowing susceptibility predictions acrosseach area for each month. This temporal element is similar to the study ofKia et al. (2012), which utilizes the same environmentalﬂood risk factors and a rainfall time series in a regression task to predict a ﬂow hydrograph at the bottom of the study area when using an ANN. These ﬂow pre- dictions can then be converted to a river stage (water height) reading andthen used to inferﬂooded areas through‘bathtub approaches’in a Geographic Information System (GIS). This approach is not possible inthe Jakarta study area due to the shortage of gauging data ( Kure et al., 2013) and insufﬁcient lead times for predictions based on upstreamwater levels (Miyamoto et al., 2012). Therefore, this study uses ANNs, and other MLs to skip the prediction of the hydrograph and go straight topredicting whether an area wasﬂooded or not.This work aims to create a tool which can be used to prioritize allo-cation ofﬂood defense resources for city ofﬁcials and inform civilians of ﬂood risk when extreme rainfall is forecasted. This research will also aimtoﬁnd an optimal model through comparing: ANNs, k-NN, and SVMmodels against a random baseline. Novel approaches such as those pre-sented in this work are encouraged in natural hazard susceptibilitymodelling (Chen et al., 2019a) as there is no universal consensus aboutwhat the best modelling tool is (Chen et al., 2019b). An overview of models previously employed inﬂood susceptibility studies can be foundinIslam et al. (2021). The work comprises three key topics; theenvironmentalﬂood risk factors in the study area, Sentinel-1 SyntheticAperture Radar (SAR) imagery used to monitor ﬂ
oods, and the machine learning models used to predictﬂood susceptibility.2. Material and methods2.1. Environmentalﬂood risk factorsThe environmentalﬂood risk factors can be divided according to theirtemporally static or varying natures. The eight static factors identi ﬁed in similar studies (Kia et al., 2012;Tehrany et al., 2015;Vojtek, 2019) are (seeFig. 1for the maps produced for each attribute): elevation, slope,curvature, stream power index (SPI), topographic wetness index (TWI),distance from river, land cover and soil type. The main temporally var-iable factor determiningﬂood-susceptibility is precipitation recorded asdaily time steps (Bappenas, 2010).Elevation.It is a key factor in determining whether land is suscep-tible ofﬂooding. Data source is the National DEM (see Table 1for de- tails). Regions at higher elevations are less likely ﬂooded when compared to those at lower elevations (Botzen et al., 2012). Globally, regions with low-lying areasﬂood much more frequently, with average annual risk oflargeﬂood at around 4.9% for cities that are up to 10 m above sea level(Kocornik-Mina, 2016). This is a much higher average annual chance ofﬂooding than cities located above 10 mamsl which only have a 1.3%chance ofﬂooding each year (Kocornik-Mina, 2016). Slope Degree.It is calculated as theﬁrst-order derivative of elevation and it is another key terrain-derived factor affecting ﬂood risk (Tehrany et al., 2015). As ground slopes increase and runoff travels faster downhillthis results in a decrease in the time available for surface in ﬁltration (Schillaci et al., 2015). The decrease in surface inﬁltration allows more runoff to enter the rivers and drainage systems and can be the mostcritical factor in determiningﬂood risk (Vojtek, 2019). Slope Curvature.The curvature of the slope, the second order de-rivative of elevation, plays an important part in determining ﬂood sus- ceptibility. Curvature contains information on the erosive characteristicsof water that include topography-controlled runoff conditions and it has
Fig. 1.Raster image forﬁx attributes.S. Priscillia et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 215 –222
216been found to be positively correlated with ﬂood susceptibility in similar studies (e.g.,Mind'je et al., 2019).Stream Power Index.The stream power index (SPI) is a metric ofwaterﬂow strength for erosive processes. SPI is determined by processesof catchment hydrology, hydraulic channel-geometry and water's con-servation of mass, shear stress,ﬂood interval, climate, and bedrockerodibility among others (Irawan et al., 2021). The SPI will be estimated based on the slope at each location and the contributing upstream area.Topographical Wetness Index.The topographic wetness index (TWI) is a metric of moisture likelihood based on the principle of up-stream contributing area. The TWI is calculated through spatiallydistributed terrain models or by using contours derived from thesemodels. The TWI is also proven to be an early-stage indicator of ﬂood- prone areas in residential development planning ( Pourali et al., 2016). More advanced applications of the TWI include a calculation methodusing a maximum likelihood estimation procedure ( Motevalli and Vafa- khah, 2016). In this study, the TWI was shown to be a useful light weightalternative to hydraulic modelling as a high correlation between TWIwithﬂood depth from a hydraulic model were observed ( Motevalli and Vafakhah, 2016).Distance from rivers.Across natural catchments, the distance fromrivers or waterbodies has been proven to be the most dominating factorthat inﬂuencesﬂood-susceptibility (Giovannettone et al., 2018). In ur- banized catchments with more complex drainage, the distance fromwaterbodies is still the second-most important factor behind elevation(Giovannettone et al., 2018). Theﬂood susceptibility mechanism relatesto the planar distance the waterbody must grow by to encroach on land,where the closer to an area is to a river or a body of water, the more likelythat area is toﬂood (Glenn et al., 2012).Land Use Land Cover.The Global Land Cover Characterization(GLCC) is another factor potentially linked to ﬂood susceptibility. The data source is the United States Geological Survey (USGS) global landcover product at 1 km spatial resolution, accessed from: http://earth explorer.usgs.gov/. Flood likelihood and areas of high vegetation den-sity have been noted to be negatively correlated ( Tehrany et al., 2015). Vegetated areas have higher interception and in ﬁltration rates of rain- water resulting in less surface runoff. Conversely non-vegetated areastend to have higher surface runoff and therefore greater ﬂood suscepti- bility (Lee et al., 2012). Cases of vegetation decrease, or urbanization,have been proven to be positively correlated to ﬂood frequency and damage costs (Adnan et al., 2020).Soil Type.Working on the same principle of controlling runoff rates,the soil type is another important factor affecting ﬂood susceptibility. The data source is the FAO Soil Map of the World at 1:5,000,000 scale.The project was completed over a span of twenty years and uses the Soiltaxonomy framework to classify soil units, accessed from: https://www. fao.org/soils-portal/data-hub/soil-maps-and-databases/faounesco-soil-map-of-the-world/en/. In the Jakarta study area however, the ﬂood mechanism soil type exerts is through the differing subsidence rates ofdifferent soils (Abidin et al., 2011). Natural consolidation of alluvial soilscoupled with heavy loads due to construction results in highly com-pressed soil during subsidence (Abidin et al., 2011). In addition to reducing elevation, the compression of sediments results in less in ﬁltra- tion (Herda Adeline et al., 2020) and therefore greater likelihood ofﬂooding (van Leeuwen et al., 2019).Precipitation Time Series.Differing from the aforementioned eightfactors, theﬁnal factor of precipitation is a temporal factor. According toIndonesian National Atlas (ANI), Java has the most extreme precipitationrates of up to 400 mm/month (Bappenas, 2010). As mentioned earlier the January 2020ﬂoods occurred during the most extreme rainfall in the citysince 1866 (BMKG, 2020). Furthermore, monthly rainfall intensity inJakarta has increased 100 mm from 1900 to 1970. These monthly in-creases have been consistent throughout the year, as well as during peakrainfall seasons (Bappenas, 2010). Finally in pluvial andﬂuvialﬂooding, the rate of water input to the system drives the response from thecatchment. Therefore, rainfall intensity has been included as a time seriesrather than as a‘static’yearly/decadal average.The temporallyﬁxed environmentalﬂood risk factors for the study area are displayed inFigs. 1and2.Table 1Summary of Environmental Factors.
Factor Description SourceElevation Terrain proﬁle represented asheight above reference datum. 2015 Jakarta DEM fromJakarta's Regional DisasterRelief Agency (BPBD)Geoportal. Slope Degree Theﬁrst-order derivative ofelevation. Derived from Jakarta DEM.Slope Curvature The second order derivative ofelevation. Derived from Jakarta DEM.TWI A metric of moisture likelihoodbased on the principle ofupstream contributing area.Derived from Jakarta DEM.TWI¼ln
α
tanβ
α(m2m-1) is the local upslopearea draining through a certainpoint per unit contour length.tanβ(radian) is the local slopegradients. (Kirkby and Beven,1979;Moore et al., 1991). SPI A metric of water ﬂow strengthfor erosive processes. Derived from Jakarta DEM.SPI¼
α/C2tanβ
αandtanβsame as above Dist. from River Euclidean planar distance. Derived from Jakarta River Map from BPBD Geoportal. LC Categorizing the Global LandCover Characterization (GLCC)types in the study area.USGS,https://www.usgs.gov/special-topics/land-use-land-cover-modeling. Soil Type Soil Units in the Jakarta region,Inceptisol; Oxisol; Ultisol;Entisol; Histosol.FAO Digital soil map report,polygons rasterized, scale1:5000000. PrecipitationTime SeriesJakarta monthly average rainfallNovember 2015 until December2020.Indonesian Agency ofMeteorology, Climatologyand Geophysics (BMKG)database.
Fig. 2.Sentinel-1 (mean) Jan 2020.S. Priscillia et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 215 –222
2172.2. Sentinel-1 imageryImagery from the Sentinel-1 C-band radar imaging satellite has beenused to provideﬂood extent information during the January 2020 ﬂood event. This active remote sensing system provides regular coveragethrough both day and night, and it is not affected by atmospheric pro-cesses such as cloud cover and so has been widely used to monitor ﬂood events (Conde and Munoz, 2019;Tsyganskaya et al., 2019;Martinis et al., 2018;Qiu et al., 2021).The Sentinel-1 imagery has been sourced through Google Earth En-gine (GEE,Gorelick, 2017). Using the GEE cloud platform's data cata-logue allows rapid and computational light access to the study area.These characteristics mean that GEE is suitable for emergency responseapplications, and it has been used in a range of formats in ﬂood response systems (Cheng-Chien et al., 2018;De Vries, 2020;Pourghasemi et al., 2021).Sentinel-1 imagery has been included as an input variable becausecould be used by the model as a proxy to sense the overall presence ofwater across the study area. This is through soil moisture of non-urbanized areas, vegetation intensity, and in terms of prevalence ofopen bodies of water. Antecedent soil moisture, or channel-capacityconditions are particularly important in determining the response of anarea during successive rainfall events ( Truckenbrodt et al., 2019). Sentinel-1 scenes of each month were averaged and as a result the valuefor each individual pixel is different.2.3. Machine learning models for classiﬁcationMachine learning (ML) is a group of computational algorithms andstatistical models which are designed to learn from their environment(Naqa and Murphy, 2015). Under a supervised learning paradigm, amodel learns to improve its performance at a given task through expe-rience. The following models are commonly used in predictive classi ﬁ- cation tasks and a brief overview of their learning mechanisms areprovided. These models are Support Vector Machines (SVMs), k-NearestNeighbors algorithms (k-NNs), and Artiﬁcial Neural Networks (ANNs).2.3.1. Support Vector MachinesSVM is a model suitable for two-class classi ﬁcation problems and is based on the principle of the minimization of structural risk ( Belousov et al., 2002). SVMs aim to create a hyper-plane to separate the two classesin a n-dimensional space, as determined by n-attributes ( Marjanovi/C19c et al., 2011). The SVM can be mathematically represented below as aprimal optimization problem (Chang and Lin, 2011):min
w;b;ε12wTwþCXli¼1εi
subject to y iðwTΦðx iÞþbÞ/C211/C0 εi;
εi/C210;i¼1;…;l;Where they2ℝ
tresponse vector can assume values/C01o r1 .Φðx iÞmaps each attribute,x
i2ℝn, into a higher dimensional space. C/C210 is the penalty parameter on the error term.In addition toﬁnding a maximum margin of separation betweenclasses (Pradhan, 2013), a unique advantage of the SVM is that a toler-ance on misclassiﬁcation can be speciﬁed for non-linearly separable problems. This width of the soft margin tolerance is a tunable cost ( C) parameter where decision boundaries with narrower margins utilizefewer data points (support vectors) to separate the two classes.Another way of solving non-linear problems is by employing a non-linear kernels in SVMs to plot non-linear decision boundaries ( Cao et al., 2008). By replacing thex
Tixjterm with a kernel function,kðxTixjÞ,the data can be mapped into a higher dimensional space. One such ker-nels which has been found to be successful in many problem domains isthe Radial Basis Function (RBF) kernel ( Yao et al., 2008), whereðxTixjÞ¼ expðγ/C12/C12/C12/C12/C12x
i/C0x j/C12/C12j2Þ. The RBF kernel has a tunable parameter ( γ) controlling the kernel width and sphere of inﬂuence of individual data points uponthe decision boundary (Chang and Lin, 2011).2.3.2. k-Nearest Neighbors Algorithmsk-NN models simply classify new data points according to the mostsimilar data point observed during training. Multiple neighboring pointscan be used to measure similarity through a distance weighted score ormajority voting (Cunningham and Delany, 2007). The probability of a new instance belonging to a class corresponds with the proportion ofk-nearest neighboring points with each class label, as shown below withΩ
0being the set of k-nearest neighbors to x ( Aristizabal et al., 2020).PðY¼yjX¼xÞ¼
1kXkj
εΩ0I/C0yj¼y/C1where I/C0y
j¼y/C1¼/C260when yj6¼y1when y
j¼yThe tunable hyperparameterk, the number of neighboring data pointsto consult, is commonly determined by using the square root of N, where Nis the number of points in the dataset. The other hyperparameter thatneeds to be tuned is the distance metric used to ﬁnd the nearest data points. Four distance metrics have been tested. They are the Euclidean,Manhattan, Cosine, and Minkowski distances. An overview of thesemetrics is provided inAlfeilat et al. (2019).2.3.3. Artiﬁcial Neural NetworksANNs are complex ML models which are comprised of networks ofinterconnected nodes (or neurons). Each neuron takes a vector of featurevalues as input. Then, it multipies a column-verctor of weights to thisinput vector and adds an additional weight named bias. Finally, the resultof this multiplication is input to an activation function and its resultreturned as output. In a network of connected neurons information ﬂows between each neuron from the model inputs to the model classi ﬁcation output. By incorporating multiple neurons to build networks of arbitrarywidth and depth, ANNs of arbitrary complexity can be built in response tothe complexity of the problem. The network structure is only one of thetunable hyperparameters (Atkinson and Tatnall, 1997). Other hyper- parameters include the activation function used within each neuron tocombine the inputs into an output (Kia et al., 2012). The Sigmoid func- tion is commonly used (Bishop, 1994). Other activation functions which were tested during hyperparameter-tuning include the; Identity, Logistic,ReLU, and Tanh functions (Agatonovic-Kustrin and Beresford, 2000 ). The weights for each neurons are learned during training throughbackpropagation. Two more hyperparameters of an ANN are the learningrate and the
αregularization term. The learning rate controls the size ofthe update to neuron weights during training ( Gurney, 1997). The
α
regularization term constrains the size of the weights to prevent over-ﬁtting to the training data (Gurney, 1997). ANNs are favored in a range of problem domains due to their robustcapability in modelling nonlinear relationships between explanatoryvariables and target variables (Kia et al., 2012). The ANN differs from the other two ML models as an ANN, when having many layers, can learnnew features automatically (deep learning). The SVM and k-NN modelstreat each data point's attributes as a vector with equal weight assigned toeach. This means that these two learners can suffer from the curse ofdimensionality (Bellman, 1958) but also cannot make context-awarepredictions that ANNs can. This is where in different contexts andareas of the parameter space, different attributes can have differing levelsS. Priscillia et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 215 –222
218of importance on theﬁnal prediction (Anderson-Bell et al., 2021;James et al., 2021).2.4. Methodology2.4.1. Experiment designThe models take as input the environmental factors ﬂood risk factors for each month (T) and will make predictions as to whether a locationﬂooded or did notﬂood in the following month (Tþ1). The input at- tributes span from November 2014–November 2020 and the label attri-butes span from December 2014–December 2020.As computational resource is limited, rather than running the modelfor every grid cell in the study area forﬁve years, the modelling has been undertaken at the polygonal administrative unit of the village. Jakarta iscomprised of 260 administrative village units as displayed in Fig. 3. To prove that the models are better than random, they will becompared against a random baseline, i.e., that randomly guesses whethera location wasﬂooded or not. This model represents the theoretical worstperformance a ML model can attain on a binary classi ﬁcation task.2.4.2. Data preparationBecause only monthly precipitation data is available the modellinghas been undertaken at the monthly timestep. Choosing this unit allowedthe inclusion of composite Sentinel-1 images as acquisition dates variedfor each month in each year. For each calendar month betweenNovember 2014 and December 2020, available Sentinel-1 scenes havebeen averaged to monthly composites. Because of the strong meteoro-logical signal of the Monsoon season in Jakarta ( BMKG, 2021), each month can be broadly typiﬁed as in the‘dry season’(May–September) or ‘rainy season’(October–April).The labels for the dataset were provided through private communi-cation with the BMKG. Each administrative village area is classi ﬁed as ﬂooded or notﬂooded in each month. The centroids of the 260 Villageswere matched up with the static environmental ﬂood risk factors to assign attributes to each village. The temporal rainfall values and spatio-temporal composite Sentinel-1 values at each village centroid wereadded to create a monthly time series for each village. The 10-attributetime series for each village has been combined into a single datasetwith an example shown below.As the models used cannot handle missing values, records which didnot have full attribute values have been dropped. This has led to un-derrepresentation in 2014 where only two months (November andDecember) contained full data. This resulted in a slightly smaller dataset(~ 0.08%).We examined variable collinearity and only a moderate correlation(0.63) was noted between variables. Temporal autocorrelation was notassessed as the models used both temporal and ﬁxed variables to make their predictions.As raw values range dramatically between attributes, min-maxscaling has been used for all models to improve model performances,particularly for the ANN. This is needed as the gradient descent algorithmconverges much faster when feature scaling or normalization is imple-
mented (Ioffe, 2015).2.4.3. Model trainingTheﬁnal dataset of 18,965 records (inTable 2we show two samples) has been divided into three sets of: training, validation, and test sets. Thetraining and validation sets are randomly sampled from records of the 73months between 2014 and 2019 and comprise of 67.93% and 16.98% ofthe full dataset. The test set has been created from records in the 12months of 2020, which represents 15.08% of the full dataset.Asﬂoods do not happen every day, the combined training and vali-dation datasets contains an imbalance with signi ﬁcantly more instances of the non-ﬂood class (91.15%), than theﬂood class (8.85%). As highly imbalanced training datasets produced biased classi ﬁers (Jiawei et al., 2012) the Synthetic Minority Oversampling TEchnique (SMOTE) ( Chawla et al., 2002) was implemented to oversample the minority class to thesame prevalence as the majority class. SMOTE ﬁrstly identiﬁes examples of the minority class that are nearby in the attribute feature space. SecondlySMOTE draws lines between them, and samples new synthetic points alongthese lines. New examples are generated as a combination of two chosenexamples. A downside of this approach is the potential creation ofambiguous examples should the two classes overlap in the attribute featurespace. For more information seeChawla et al. (2002). All SVM and k-NN model hyperparameters have been tuned via a gridsearch using a 5-fold cross validation combining the training and vali-dation set. As ANNs take longer to train, the tuning of their hyper-parameters has been performed by using the validation set. See Table 3 and4for the details about the tuned hyperparameters.2.4.4. Performance metricsGiven the sparsity of the natural phenomenon we want to predict – the dataset contains far fewerﬂood instances (positive class) than non-ﬂood instances (negative class) –we evaluated our classiﬁers using Precision, Recall and the F1-Score.The F1-Score is the harmonic mean of Precision and Recall with0 being the worst value and 1 the best value. Precision is de ﬁned as the proportion of predicted positive samples that are true positive. Recall isproportion of true positive that have been correctly predicted as positiveclass.Following we report the equations used to compute Precision, Recalland the F1-Score, where we consider as the positive class the ﬂood in- stances:Precision¼
TPTPþFP;Recall¼
TPTPþFN;F1/C0Score¼
2TP2TPþFPþFN¼2 Precision*RecallPrecisionþRecall;where TP, FN and FP are the true positives, false negatives, and falsepositives.
Fig. 3.Distribution of the 260 villages in the study area. Each dot is a poly-gon centroid.S. Priscillia et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 215 –222
2193. ResultsThe following results are reported on models trained on both theoriginal imbalanced dataset and the balanced dataset using SMOTE. Thishas been done to assess the effect of SMOTE on the three models. Modelresults are presented on the training, validation, and test sets. The resultsfor the random baselines have also been presented alongside.InTable 5, we observe that the performance of all models using theimbalanced dataset is poor. In particular, both SVM and ANN are unableto generalize and learn to predict always that there is no ﬂood. When trained on the balanced dataset, the ANN was found to performs thehighest (0.45 F1) and the only model to perform better than the randomclassiﬁer (0.24 F1).4. DiscussionThe effects of the SMOTE to rebalance the training datasets isimportant when predictingﬂoods. The effect of this technique is clearwhen comparing the ANN trained with the imbalanced set vs. thebalanced set. However, this contrasts with the SVM and k-NN models inwhich rebalancing the training data did not have any signi ﬁcant effect. The k-NN model performed minimally better in predicting ﬂood when trained on the rebalanced data, while the k-NN model's score for the non-ﬂood class remained the same. In the SVM model the scores for bothclasses remained unchanged when training on the balanced dataset.The difference in performance we observe between the validation andtest sets could be attributed to the fact that the validation set consists ofdatapoint between 2014 and 2019, while the test set consists only ofdatapoints in 2020. Another reason for this difference in performancecould be attributed to the fact that the rainfall and ﬂooding in the year2020 was higher than experienced previously. ML models struggle toextrapolate outside of their known range of their training data if the datadistribution used for testing is different from the one used for training.Should ML models be used in a real scenario, it is important to recognizethis limitation and retrain the model periodically.Overall, only the ANN was able to perform better than random whenpredictingﬂoods demonstrating that by using this model we could pre-dict which villages are susceptible toﬂooding in the upcoming month. The novel nature of this work unfortunately limits its comparability tothe wider literature. While the environmental input factors used arecommon throughout the MLﬂood susceptibility literature (e.g.,Kia, et al., 2012;Shahabi, 2020;Tehrany et al., 2015) the setup of predicting ﬂood susceptibility classiﬁcation across time is novel. The higher per-formance of the ANN is suspected to be due to the complexity of theclassiﬁcation problem faced:Firstly, the problem is non-linear and suited to a mixed-effects modelwhere the relationships between input variables and output vary acrossspace (each village) and across time (month during the monsoon cycle).Secondly, when predictingﬂood status in monthTþ1 using environ- mentalﬂood risk factors in monthT,the strength of the relationship to the following month'sﬂood status will vary depending on the month'sposition in the monsoon cycle. In months heading towards the monsoonpeak the same volume of rainfall would be expected to be correlated withgreaterﬂooding than the same rainfall volume in a month heading to-wards the dry season peak.The model might be improved in the future; this exercise offered anoverview of the ANN application with selected attributes that are strictlyrelated withﬂoods in an area that suffered in the past for similar events.
In Jakarta, theﬂood is predicted yearly withﬂooding risk rating all the villages together. The data shows that all villages have a medium risk forall month in year 2020. Using a model that can give predictions for eachof the village on a monthly basis, government, ﬁrms, civilians can be on alert and prepare the disaster recovery plan.5. ConclusionsAﬂood susceptibility study comparing k-NN, SVM, and ANN modelswas undertaken for the Jakarta study area. The model was trained on2014–2019 monthly data and tested on 2020 data across Jakarta's 260administrative villages. Two sets of models' groups were ran using theoriginal dataset and the rebalanced dataset with SMOTE.Table 2Two example records in the dataset for two different villages taken during November 2014.
Long Lat Year Mon. Alt. Slope Curv. SPI TWI Soil Riv. Dist. LULC Rain-fall Sentinel-1 Floodxx xx 2014 11 12 2.5 0.8 0.2 89 3 913 13 0.6 13.45 1xx xx 2014 11 9 8.9 0.3 /C01.1/C044 3 1319 13 0.6 16.83 0
Table 3List of tuned hyperparameters.
Model Tuned Hyperparametersk-NN/C15Weight: uniform, distance/C15Number of neighbors: range 1–11 /C15Distance Metric: Euclidean, Manhattan, cosine, MinkowskiSVM/C15Kernel: linear, RBF/C15C: range 1–11 ANN/C15Hidden layer sizes/C15Maximum epochs/C15Activation function/C15Learning rate: Adaptive or Fixed
Table 4The optimal hyperparameters used in each model.
Tuned Hyper parameters implementsDataset Imbalanced Training data Balance training datak-NN/C15Weight: distance /C15Weight: distance /C15Number of neighbors: 1 /C15Number of neighbors: 4 /C15Distance Metric: cosine /C15Distance Metric: Manhattan SVM/C15Kernel: linear, RBF /C15Kernel: linear, RBF /C15C: 9 /C15C: 10 ANN/C15Hidden layer sizes: 1 hidden layer of 20 nodes/C15Maximum epochs: 400/C15Activation function: logistic sigmoid/C15Optimizer: Adam/C15Alpha: 0.01/C15Learning rate: AdaptiveTable 5Model performances. Note that the test set is never oversampled.
Imbalanced Sets Balanced Sets (withSMOTE)Model Metric Train Valid. Test Train Valid. TestRandom P––0.15–– 0.15 R––0.52–– 0.52 F1–_ 0.24–– 0.24 k-NN P 1.00 0.33 0.56 1.00 0.87 0.32R 1.00 0.31 0.01 1.00 0.96 0.02F1 1.00 0.32 0.02 1.00 0.92 0.03SVM P 0.73 0.92 0.00 0.77 0.76 0.00R 0.03 0.05 0.00 0.86 0.86 0.00F1 0.06 0.09 0.00 0.81 0.80 0.00ANN P 0.00 0.00 0.00 0.94 0.67 0.37R 0.00 0.00 0.00 0.66 0.75 0.59F1 0.00 0.00 0.00 0.75 0.71 0.45S. Priscillia et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 215 –222
220This analysis shows the importance of rebalancing the dataset. Thebest scores were obtained in the ANN model. The SVM and k-NN modelsperformed similarly poorly across both imbalanced and balanced data-sets. The novelty of the approaches used in this study limits its compa-rability to the literature but the context-speci ﬁc spatial and temporal patterns within the problem are theorized to be the reason why the ANNmodel had the highest performance. The SVM and k-NN models aresuspected to suffer from the curse of dimensionality.Further work could examine a spatial breakdown of the models'performance to identify if some villages consistently perform worse thanothers. Similarly, a temporal breakdown could be undertaken to examinemonths or seasons of poorer performance.Declaration of competing interestThe authors declare that they have no known competing ﬁnancial interests or personal relationships that could have appeared to in ﬂuence the work reported in this paper.AcknowledgmentsThe authors are grateful to the data providers, Indonesian RegionalDisaster Relief Agency (BPBD) Geoportal, and the anonymous reviewersfor their useful comments and suggestions.References
Abidin, H.Z., et al., 2011. Land subsidence of Jakarta (Indonesia) and its relation withurban development. Nat. Hazards 59, 1753 . Adnan, M.S.G., Abdullah, A.Y.M., Dewan, A., Hall, J.W., 2020. The effects of changingland use andﬂood hazard on poverty in coastal Bangladesh. Land Use Pol. 99 . Agatonovic-Kustrin, S., Beresford, R., 2000. Basic concepts of arti ﬁcial neural network (ANN) modeling and its application in pharmaceutical research. J. Pharmaceut.Biomed. Anal. 22 (5), 717–727. Alfeilat, Abu, et al., 2019. Effects of distance measure choice on k-nearest neighborclassiﬁer performance: A review. Big Data. https://doi.org/10.1089/big.2018.0175 . Anderson-Bell, J., Schillaci, C., Lipani, A., 2021. Predicting non-residential building ﬁre risk using geospatial information and convolutional neural networks. Remote Sens.Appl. Soc. Environ. 21, 100470. https://doi.org/10.1016/j.rsase.2021.100470 . Aristizabal, F., Judge, J., Monsivais-Huertero, A., 2020. High-resolution inundationmapping for heterogeneous land covers with synthetic aperture radar and terraindata. Rem. Sens. 12.https://doi.org/10.3390/RS12060900 , 900 12, 900, 2020. Atkinson, P.M., Tatnall, A.R.L., 1997. Neural network in remote sensing. Int. J. Rem. Sens.18, 699–709.Baker, J., 2012. Climate Change, Disaster Risk, and the Urban Poor: Cities BuildingResilience for a Changing World. World Bank, Washington, DC . Bappenas, 2010. Indonesia Climate Change Sectoral Roadmap. BAPPENAS, Jakarta . Bellman, Richard, 1958. Dynamic programming and stochastic control processes. Inform.Contr.https://doi.org/10.1016/S0019-9958(58)80003-0 . Belousov, A., Verzakov, S., Von Frese, J., 2002. Applicational aspects of support vectormachines. J. Chemom. 16 (8–10), 482–489. Bishop, C.M., 1994. Neural networks and their application. Rev. Sci. Instrum. 65 (6),1803–1830.BMKG, 2020. Kompas.com [Online] Available at: https://nasional.kompas.com/read/20 20/01/03/10141971/bmkg-sebut-curah-hujandi-jakarta-awal-2020-paling-ekstrem-dalam-sejarah[Accessed 8 August 2021].BMKG, 2021. Prakiraan Musim Hujan 2021/2022 Indonesia. BMKG, Jakarta . BNPB, 2020. tirto.id [Online] Available at: https://tirto.id/penyebab-banjir-jakarta-2020 -dan-daftar-jumlah-korban-meninggalep9p [Accessed 8 August 2021]. Botzen, W., Aerts, J., Bergh, V.D.J., 2012. Individual preferences for reducing ﬂood risk to near zero through elevation. Mitig. Adapt. Strategies Glob. Change 18, 229224 . BPS Jakarta, 2019. Penduduk, Laju Pertumbuhan Penduduk, Distribusi PersentasePenduduk Kepadatan Penduduk. Rasio Jenis Kelamin Penduduk Menurut Provinsi/Kabupaten/Kota, Jakarta: s.n . Cao, H., Naito, T., Ninomiya, T., 2008. The 1st International Workshop on MachineLearning for Vision-Based Motion Analysis - MLVMA ’08. HAL, Marseille. Chang, C.C., Lin, C.J., 2011. LIBSVM. ACM Trans. Intell. Syst. Technol. 2, 27. https:// doi.org/10.1145/1961189.1961199 . Chawla, N.V., Bowyer, K.W., Hall, L.O., Kegelmeyer, W.P., 2002. SMOTE: syntheticminority over-sampling technique. J. Artif. Intell. Res. 16, 321 –357. Chen, W., Panahi, M., Tsangaratos, P., Shahabi, H., Ilia, I., Panahi, S., Li, S., Jaafari, A.,Ahmad, B.B., 2019a. Applying population-based evolutionary algorithms and aneuro-fuzzy system for modeling landslide susceptibility. Catena 172, 212 –231. Chen, W., Hong, H., Li, S., Shahabi, H., Wang, Y., Wang, X., Ahmad, B.B., 2019b. Flood
susceptibility modelling using novel hybrid approach of reduced-error pruning treeswith bagging and random subspace ensembles. J. Hydrol. 575, 864 –873.Cheng-Chien, L., Ming-Chang, S., Ming-Syun, K., Wang, K., 2018. Flood prevention andemergency response system powered by Google Earth Engine. Rem. Sens. 10 (8),1283.Conde, Francisco, Munoz, Maria, 2019. Flood monitoring based on the study of sentinel-1SAR images: the Ebro river case study. Water 11 (12), 2454. https://doi.org/ 10.3390/w11122454.Cunningham, P., Delany, S., 2007. K-nearest neighbour classi ﬁers. Mult. Classif. Syst. 54. De Vries, B., et al., 2020. Rapid and robust monitoring of ﬂood events using Sentinel-1 and Landsat data on the Google Earth Engine. Remote Sens. Environ. 240, 111664 . Giovannettone, J., Copenhaver, T., Burns, M., Choquette, S., 2018. A statistical approachto mappingﬂood susceptibility in the lower Connecticut river valley region. WaterResour. Res. 54 (10\\), 7603–7618. Glenn, E., et al., 2012. Roles of saltcedar (Tamarix spp.) and capillary rise in salinizing anonﬂooding terrace on aﬂow-regulated desert river. J. Arid Environ. 79, 56 –65. Gorelick, Noel, et al., 2017. Google Earth Engine: Planetary-scale geospatial analysis foreveryone. Remote Sens. Environ. https://doi.org/10.1016/j.rse.2017.06.031 . Gurney, K., 1997. An Introduction to Neural Networks. UCL Press, London . Herda Adeline, E., Sari Hasibuan, H., Sarwanto Moersidik, S., 2020. In ﬁltration Capacity in Flood Mitigating Jakarta.https://doi.org/10.4108/EAI.22-10-2019.2292391 . Hinkel, Jochen, et al., 2020. Coastal ﬂood damage and adaptation costs under 21st century sea-level rise. PNAS. https://doi.org/10.1073/pnas.1222469111 . Ioffe, S.S.C., 2015. Batch Normalization: Accelerating Deep Network Training byReducing Internal Covariate Shift. Cornel University . Irawan, L.Y., et al., 2021. Combination of machine learning model (LR-FR) for ﬂashﬂood susceptibility assessment in Dawuan Sub watershed Mojokerto Regency, East Java.IOP Conf. Ser. Earth Environ. Sci. 739 . Islam, A.R.M.T., Talukdar, S., Mahato, S., Kundu, S., Eibek, K.U., Pham, Q.B., Kuriqi, A.,Linh, N.T.T., 2021. Flood susceptibility modelling using advanced ensemble machinelearning models. Geosci. Front. 12 (3), 101075 . James, T., Schillaci, C., Lipani, A., 2021. Convolutional neural networks for watersegmentation using sentinel-2 red, green, blue (RGB) composites and derived spectralindices. Int. J. Rem. Sens. 42, 5342 –5369.https://doi.org/10.1080/ 01431161.2021.1913298. Jiawei, Han, Pei, Jian, Kamber, Micheline, 2012. Data Mining Concepts and Techniques,3 ed. Elsevier, Waltham.Kia, M.B., et al., 2012. An artiﬁcial neural network model forﬂood simulation using GIS: Johor River Basin, Malaysia. Environ. Earth Sci. 67, 251 –264. Kirkby, M., Beven, K., 1979. A physically based, variable contributing area model of basinhydrology. Hydrol. Sci. J. 24 (1), 43 –69. Kocornik-Mina, Adriana, et al., 2016. Flooded Cities. Am. Econ. J.: Appl. Econ. 12 (2).https://doi.org/10.1257/app.20170066. April 2020. Kure, S., Jang, S., Ohara, N., Kavvas, M.L., Chen, Z.Q., 2013. WEHY-HCM for modelinginteractive atmospheric-hydrologic processes at watershed scale. II: modelapplication to ungauged and sparsely gauged watersheds. J. Hydrol. Eng. 18 (10),1272–1281.Lee, M., Kang, J., Jeon, S., 2012. Application of frequency ratio model and validation forpredictiveﬂooded area susceptibility mapping using GIS. IEEE Int. Geosci. RemoteSens. Symp. 895–898.Marjanovi/C19c, M., Kova/C20cevi/C19c, M., Bajat, B., Vo/C20zenílek, V., 2011. Landslide susceptibility assessment using SVM machine learning algorithm. Eng. Geol. 123 (3), 225 –234. Martinis, Sandro, Plank, S., /C19Cwik, K., 2018. The use of sentinel-1 time-series data toimproveﬂood monitoring in arid areas. Rem. Sens. 10 (4), 583, 10 . Mind'je, R., et al., 2019. Flood susceptibility modeling and hazard perception in Rwanda.Int. J. Disaster Risk Reduc. 38 . Miyamoto, M., Sugiura, A., Okazumi, T., Tanaka, S., Nabesaka, S., Fukami, K., 2012. July.Suggestion for an advanced early warning system based on ﬂood forecasting in Bengawan Solo River basin, Indonesia. In: Proceedings of 10th InternationalConference on Hydroinformatics. IWA IAHR. No. 394) . Moore, I., Grayson, R., Ladson, A., 1991. Digital terrain modeling: a review ofhydrological, geomorphological, and biological applications. Hydrol. Process. 5,3–30.Motevalli, A., Vafakhah, M., 2016. Flood hazard mapping using synthesis hydraulic andgeomorphic properties at watershed scale. Stoch. Environ. Res. Risk Assess.1889–1900.Naqa, I.E., Murphy, M.J., 2015. What is Machine Learning?.s.L. Springer, Cham. Pourali, S., Arrowsmith, C., Chrisman, N., 2016. Topography wetness index application inFloodRisk-based land use planning. Appl. Spatial Anal. 9, 39 –54. Pourghasemi, H.R., et al., 2021. Assessment of urban infrastructures exposed to ﬂood using susceptibility map and Google Earth Engine. IEEE J. Sel. Top. Appl. Earth Obs.Rem. Sens. 14, 1923–1937. Pradhan, B., 2013. A comparative study on the predictive ability of the decision tree,support vector machine and neuro-fuzzy models in landslide susceptibility mappingusing GIS. Comput. Geosci. 350 (365), 51 . Qiu, J., et al., 2021. Flood monitoring in rural areas of the Pearl river basin (China) usingSentinel1 SAR. Rem. Sens. 13 (7), 1384 . Schillaci, C., Braun, A., Krop /C19a/C20cek, J., 2015. 2.4.2. Terrain Analysis and LandformRecognition. Available at.https://www.tribunnews.com/nasional/2021/08/26/prediksi-bmkg-puncak-musimhujan-akan-terjadi-pada-januari-februari-2022 [Accessed 5 September 2021].Shahabi, H., 2020. Flood detection and susceptibility mapping using sentinel-1 remotesensing data and a machine learning approach: hybrid intelligence of baggingensemble based on K-nearest neighbor classi ﬁer. Rem. Sens. 12 (2), 266. Tehrany, M., Pradhan, B., Jebur, M., 2015. Flood susceptibility analysis and itsveriﬁ
cation using a novel ensemble support vector machine and frequency ratiomethod. Stoch. Environ. Res. Risk Assess. 29 (4), 1149 –1165.S. Priscillia et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 215 –222
221Truckenbrodt, J., Freemantle, T., Williams, C., Jones, T., Small, D., Dubois, C., Thiel, C.,Rossi, C., Syriou, A., Giuliani, G., 2019. Towards sentinel-1 SAR analysis-ready data: abest practices assessment on preparing backscatter data for the cube. Data 4. https:// doi.org/10.3390/data4030093 . Tsyganskaya, V., Martinis, S., Marzahn, P., 2019. Flood monitoring in vegetated areasusing multitemporal sentinel-1 data: impact of time series features. Water 11 (9),1983.van Leeuwen, Kees, Hofman, Jan, Driessen, Peter, Frijns, Jos, 2019. The challenges ofwater management and governance in cities. Water. https://doi.org/10.3390/ w11061180.Vojtek, M.V.J., 2019. Flood susceptibility mapping on a National scale in Slovakia usingthe analytical hierarchy process. Water 2 (364), 364 . Widyaningrum, G., 2019. Sejarah Banjir di Jakarta, Sudah Terjadi Sejak ZamanTarumanegara. National Geographic Indonesia, Jakarta . World Bank, 2019. IMPLEMENTATION COMPLETION AND RESULTS REPORT. ReportNo: ICR00004907 Available from. https://documents1.worldbank.org/curated/en/ 153081567169469254/pdf/Indonesia-Jakarta-Urgent-Flood-Mitigation-Project.pdf[Accessed 21 November 2021].Yao, X., Tham, L., Dai, F., 2008. Landslide susceptibility mapping based on support vectormachine: a case study on natural slopes of Hong Kong, China. Geomorphology 101(4), 572–582.S. Priscillia et al. Artiﬁcial Intelligence in Geosciences 2 (2021) 215 –222
222