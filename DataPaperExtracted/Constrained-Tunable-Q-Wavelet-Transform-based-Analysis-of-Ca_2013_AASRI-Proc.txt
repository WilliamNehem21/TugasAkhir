 AASRI Procedia   4  ( 2013 )  57 – 63 
2212-6716 © 2013 The Authors. Published by Elsevier B.V.
Selection and/or peer review under responsibility of American Applied Science Research Institute
doi: 10.1016/j.aasri.2013.10.010 ScienceDirect
2013 AASRI Conference on Intelligent Systems and Control 
Constrained Tunable-Q wavelet Transform based Analysis of 
Cardiac Sound Signals  
Shivnarayan Patidar, Ram Bilas Pachori* 
Discipline of Electrical Engineering, Indian Institute of Technology Indore, Indore, 452017, India 
 
Abstract 
In this paper, we present a new method for analysis of cardiac sound signals containing murmurs using constrained 
tunable-Q wavelet transform (TQWT). The fundamental heart sounds (FHS) and murmurs are separately reconstructed by 
suitably constraining TQWT. The segmentation of reconstructed m urmurs into heart beat cycles  is achieved using cardiac 
sound characteristic wave-form (CSCW) of reconstructed FHS. The frequency domain based approximate entropy, 
spectral entropy, Lempel-Ziv complexity, and time domain Shannon entropy are computed for each segmented heart beat 
cycles for least squares support vector machine (LS-SVM) based classification. The experimental results are included to 
show the effectiveness of the proposed method. 
 
© 2013. Published by Elsevier B.V. 
Selection and/or peer review under responsibility of American Applied S cience Research Institute 
 
Keywords:  Cardiac sound signals; heart beat cycles; murmurs; tunable-Q wavelet transform; least squares support vector machine; 
1. Introduction 
The cardiac sound signals contain a lot of inform ation about the functioning of heart valves and 
hemodynamics. Detection of heart valve disorders eith er by visual scanning of cardiac sound signal or 
auscultation needs thorough skills and long term experien ce. The presence of murmur s is often associated with 
pathology of the heart valves [1]. Thus, detection of murm urs in the cardiac sound signals is an important part 
for the diagnosis of heart valve disorders. 
 
 
* Corresponding author. Tel.: +91-0732-4240716; 
E-mail address: pachori@iiti.ac.in  
Available online at www.sciencedirect.com
© 2013 The Authors. Published by Elsevier B.V.
Selection and/or peer review under responsibility of American Applied Science Research InstituteOpen access under CC BY -NC-ND  license.
Open access under CC BY -NC-ND  license.58   Shivnarayan Patidar and Ram Bilas Pachori  /  AASRI Procedia   4  ( 2013 )  57 – 63 
The parameters extracted from the segmented cardiac soun d signals can be very useful in diagnosis of heart valve disorders. These parameters can belong to time domain, frequency domain or time-frequency domain. The time domain parameters such as the time intervals of the systole and diastole and the presence of murmurs in the systole and diastole have been used fo r detecting heart valve disorders [2, 3]. The clustering based diagnosis of heart valve disorders using CSCW have been proposed in [3]. The time domain based analysis is suitable for distinguishing the normal and abnormal cardiac sound signals but it is not helpful in identifying the types of murmur [4]. Therefore, in order to classify murmurs, different spectral characteristics of murmurs in cardiac sound signals have been proposed as described in [4-6]. Moreover, the traditional time- frequency methods like short-time Fourier transform, wa velet transform and wavelet packet decomposition have been employed for classifying the type of murmur using cardiac sound signals [7-10]. The classification of murmurs is a multi-class classification problem. The classifiers which are used most commonly for the cardiac sound signals are neural network [5], [7-8] and support vector machine (SVM) [4], [10-12].  In this paper, we present a new method for segmen tation and classification of cardiac sound signals containing murmurs using constrained TQWT. The TQWT is powerful technique with three input parameter for analysis and processing of oscillatory signals [14]. The proposed method is based on constraining TQWT with adaptive selection of its input variables. The FH S and murmurs are separately reconstructed by suitably constraining TQWT. The reconstructed FHS is used for envelope based segmentation of reconstructed murmurs into heart beat cycles using CSCW. The freq uency domain approximate entropy, spectral entropy, Lempel-Ziv complexity and time domain Shannon entropy are computed for each heart beat cycles of reconstructed murmurs and have been used as an input to least squares support vector machine (LS-SVM) for classifying the murmurs. The proposed constrai ned TQWT based segmentation and LS-SVM based classification of segmented reconstructed murmurs have provided better segmentation rate and classification rate. 2. Tunable Q-wavelet transform TQWT is a flexible fully discrete wavelet transform that facilitate tuning of its Q-factor denoted as Q and specifying its over-sampling rate or redundancy denoted as r along with number of levels of decomposition ( j) [13]. The implementation of j
th level TQWT based decomposition is achieved by iteratively applying two channel filters banks to the low-pass sub-band signal. At first level, the generation of low-pass sub-band c
1[n] uses low-pass filter H
o() followed by low-pass scaling which is denoted as LP scaling , and similarly the generation of high-pass sub-band d
1[n] uses H 1() and HP scaling . The details of involved scaling operation can be found in [13]. The equivalent system for j
th level TQWT based decomposition of input signal s[n] to generate the low-pass sub-band signal c 
j [n] and the high-pass sub-band signal d j [n] is shown in Fig.1. The equivalent frequency response for low-pass and high-pass sub-band signals generated after j
th level is given by H
o(j)() and H 1(j)() respectively which are defined as [13]:  
],[,0)1(,)()()(,0,)()(1 1 2
0011 )(11
00 )(0
otherforHHHHHj j j
mm j jjj j
mm j
       (1)       
][ndj 
Fig. 1. (a) The equivalent system for jth level TQWT based decomposition of input signal s[n] to generate (a) the low-pass sub-band signal c 
j [n] and (b)  the high-pass sub-band signal d j [n] [13].   )(0jH  LP Scaling j ][ncj
)(1jH  LP Scaling 1j      HP Scaling   59  Shivnarayan Patidar and Ram Bilas Pachori  /  AASRI Procedia   4  ( 2013 )  57 – 63 
The original signal can be reconstructed using the synthesis filter banks as illustrated in [13]. The redundancy and Q-factor are related to filter bank parameters  
 and  as follows [13]:  
2,1Qr                                                                                                                      (2) The parameter Q controls the oscillatory behavior of wavelet and the parameter r controls the excessive ringing in order to localize the wavelet in time without affecting its shape. 3. Methodology 3.1. Pre-processing of cardiac sound signals In order to reduce the time of execution of the algorith m, the input cardiac sound signal is decimated by a factor of 32 [12]. This process may not affect th e FHS containing low frequency components. Even the diagnostic murmurs may not be affected significantly  because most of the murmurs have frequency range between 100 Hz to 600 Hz [7]. Moreover, pre-processi ng includes amplitude normalization which takes into account the variations in the recordings due to changes in pressure applied on the chest surface and the amplifier setting.  3.2. Constrained TQWT based segmentation of reconstructed murmurs The murmurs are often spread in time duration with r elatively smaller amplitude as compared to FHS. The murmurs and FHS have nearly Gaussian and super-Gaus sian distribution respectively. The distribution of FHS has sharper peak and skewness is toward left with relatively larger value of the kurtosis as compared to murmurs [14]. This knowledge about statistical proper ties of FHS and murmurs can be used to constrain the TQWT during decomposition such that the reconstructed signal contains only the desired component of interest. In order to separate and reconstruct the FH S and murmurs from the cardiac sound signals, the input parameters of TQWT based decomposition can be adaptiv ely selected such that low frequency FHS having maximum kurtosis are obtained at the low-pass sub-band at last output stage. This low-pass sub-band based reconstructed FHS can be used for segmentation of recons tructed murmurs into heart beat cycles using CSCW. The timing information about the heart beat cycles ca n be obtained from CSCW with peak detection method that includes the picking up of the required peaks of FHS and rejecting the extra peaks followed by application of proper threshold either manually or au tomatically by fuzzy c-means clustering as suggested in [3, 15]. A segmented heart beat cycle begins and ends with  any one of the FHS of the two consecutive heart beat cycles. Therefore, after the identification of peaks of FHS in CSCW, the approximate boundaries of either S1 or S2 heart sound can be used to extract the heart beat cycles of reconstructed murmurs as described in [3, 10, 15]. The murmurs are high frequency component therefore only the high-pass sub-bands of each output stage of TQWT based decomposition are considered for reconstruction of murmurs. The heart beat cycles of these reconstructed murmurs are used for feature extraction and classification as described in next subsections.  During constraining the TQWT, the input parameters can be adapted by using any suitable optimization method. Many optimization methods have been proposed in the literature but genetic algorithms are found to be more effective in global optimization [16]. Therefore,  in this study genetic algorithm has been used to optimize the TQWT based decomposition for maximizing in formation of the desired signal component in the reconstructed signal. 3.3. Feature extraction and LS-SVM based classification of reconstructed murmurs The spectral characteristic of murmurs has been fou nd useful for classifying cardiac sound signals containing murmurs. Therefore, in this study, approximate entropy and Lempel-Ziv complexity are used as 60   Shivnarayan Patidar and Ram Bilas Pachori  /  AASRI Procedia   4  ( 2013 )  57 – 63 
frequency domain parameters as computed from fast Fourier transform (FFT) based frequency spectrum of the heart beat cycles of reconstructed murmurs. Th e features employed are briefly described as follows: 3.3.1 Shannon entropy: Shannon entropy is based on the notion of probability and measures the uncertainty of a signal [17]. The normalized form of Shannon entropy which is denoted by ShEn is defined as: 
)log()log(mppShEnnnn
                                                                                                                                     (3) Where n is the range of signal amplitude, pn is the probability of the signal having amplitude a n. In this study, the probability density function of the reconstruc ted murmurs is estimated over the discrete values of a
n by using histogram technique. For the signal samples, say N, the amplitude range of signal is linearly divided into m bins such that the ratio m/N remains constant. In this study, the ratio m/N is kept at 0.01. 3.3.2 Approximate entropy: The approximate entropy (ApEn) is a non-linear statistical property which is used to measure the complexity of the system [18]. The ApEn is defined as follows: 
1)()(,)(ln1)(ln11),,(
11 11mNiNiSiSmNiSmNNrmApEnmmrmNimrmNimr                                                   (4) Where m is the embedding dimension, N is the number of samples of the sequence, N
m(i)  is the number of matching vectors within the tolerance window r. In this study, ApEn is computed with FFT based spectrum as input sequence and m and r set as 2 and 0.1 times the standard deviation respectively.  3.3.3 Lempel-Ziv complexity: Lempel-Ziv complexity is a non-parametric measure of complexity of finite sequences. It reflects the presence of number of distinct sub-sequences (patterns) and the rate of their occurrence along the sequence. The Lempel-Ziv complexity analysis is based on transforming the time-series into a finite symbol string. In this study, sequence obtained using the FFT based spectrum is transformed into a binary sequence by assigning ones and zeros based on median as threshold. The complete algorithm to evaluate the Lempel-Ziv complexity is described well in [19, 20]. 3.3.4 Spectral entropy: Spectral entropy is based on the power spectrum of reconstructed murmurs and describes the irregularity of the spectrum. The normalized  form of Spectral entropy which is denoted by SpEn is defined as [20]: 
)log()log(
ff
fjjjNPPSpEnH
L                                                                                                                                   (5) Where P
j is the power density of the signal in the defined frequency band [ f L, fH] and N f is the number of frequencies within this band. In this work the frequency band is specified as [100, 600] Hz.  The classification of heart valve disorders can be considered as a multi-class classification problem. Moreover, the performance of proposed features in cla ssifying murmurs can be evaluated using a multi-class LS-SVM [21]. The classifier is trained with data { x
i  yki } (i=1, 2, …n and k=1, 2, …m) , where, x i is the input and y
ik is the  kth output unit for pattern i, n is the number of training pairs and m is the number of hyperplane. The detail derivation of the LS-SVM is available in [11]. In this work the radial basis function (RBF) with width controlling parameter 
k is used as the kernel, which is defined as: 
222-exp),(ki ikxxxxK
                                                                                                                         (6) 4. Experimental results and discussion The dataset used in this paper is the heart sounds pod  cast series (2011) produced by the Robert J. Hall Heart Sounds Laboratory of Texas Heart Institute at St . Luke’s Episcopal Hospital. The dataset contains 50 abnormal cardiac sound signals acquired from variety of subj ects with relevant chest positions and different 61  Shivnarayan Patidar and Ram Bilas Pachori  /  AASRI Procedia   4  ( 2013 )  57 – 63 
patient maneuver. The sampling frequency of most of the data is 44.100 kHz except for few cases. For more information regarding the dataset, this series is available at www.texasheartinstitute.org. The illustration of the effectiveness of proposed method in separating FHS and murmurs for one heart beat cycle of mitral regurgitation and aortic stenosis has be en shown in Fig. 2. For mitral regurgitation, the reconstructed signals are obtained after adaptively selecting the parameters r and j as 8 and 10 respectively when Q = 1. The values of these parameters for aortic stenosis are r and j as 8 and 12 respectively when Q = 1. It can be seen that the constrained TQWT is effective in separating FHS and murmurs. The experimental results are found satisfactory when Q =1 and usually with high value of r due to better matching of wavelet with FHS. Moreover, when murmurs are severe the required levels of the TQWT based decomposition ( j) would be more and if they overlap with FHS the requir ed redundancy would be more so that the FHS are well localized in time. Table 1 shows the statistics of performance of CSCW based segmentation and classification using constrained TQWT based reconstructed FH S and reconstructed murmurs respectively. The frequency domain based approximate entropy, spectral entropy, Lempel-Ziv complexity, and time domain based Shannon entropy are computed for the segmented reconstructed murmurs and are used as an input feature set to LS-SVM for classifying the murmur s. The RBF kernel in the LS-SVM classifier with 
k = 1 has provided satisfactory classification rate. The used features are found to be collectively effective in classifying the type of murmur. The actual number of heart beat cycles comprised in each clinical case of the tabulated results is manually labelled by an experienced cardiologist. 
 
 Fig. 2.(a) The examples of constrained TQWT based separation of FHS and murmurs for a heart beat cycle: (a)-(c) mitral regurgit ation signal, high pass reconstructed signal (murmur) , and low pass reconstructed signal (FHS) respectively; (d)-(f) aortic stenosis signal, high pass reconstructed signal (murmur) , and low pass reconstructed signal (FHS) respectively.  Table1.  The segmentation and classification statistics of cardiac sound signals containing murmurs using constrained TQWT. Type of disease Cases Segmented beats/Total beats Training beats/Testing beats Classification rate (%) 
Aortic stenosis case1 21/25 13/12 99.42 62   Shivnarayan Patidar and Ram Bilas Pachori  /  AASRI Procedia   4  ( 2013 )  57 – 63 
 case2 40/46 23/23 99.31 Aortic regurgitation  Mitral stenosis  Mitral regurgitation  case1 case2              case1 case2 case1 case2a  29/31 32/32 15/16 14/14 16/18 8/9 16/15 16/16 8/8 7/7 9/9 5/4 97.35 97.50 100 100 99.15 98.75 
5. Conclusion The TQWT is useful transform with sufficient num ber of adaptable input parameters for separating the murmurs and FHS from cardiac sound signals containi ng murmurs. The segmentation of the reconstructed murmurs into heart beat cycles and classification of th e same have provided promising results. Finally, in order to establish the clinical use of the proposed method, it is necessary to test it on out-of-sample dataset. 6. Acknowledgements The authors would like to thank Dr. Niranjan Garg, Ca rdiologist, Bombay Hospital, Indore, India for his valuable clinical suggestions and discussions. References 
[1] Rangayyan RM, Lehner RJ. Phonocardiogram signal analysis: a review. Crit Rev Biomed Eng 1987; 15: 211-236. [2] Chung YJ. Classification of continuous heart sound signals using the ergodic hidden markov model. In: Pattern Recognition a nd Image Analysis, LNCS 2007; Springer 4477: 563-570. [3] Choi S, Jiang Z. Comparison of envelope  extraction algorithms for cardiac sound sign al segmentation. Expert Syst Appl 2008;  34 (2): 1056-1069. [4] Choi S, Jiang Z. Cardiac sound murmurs classification with au toregressive spectral analysis and multi-support vector machin e technique. Comput Biol Med 2010; 40: 8-20.  [5] Chauhan S, Wang P, Lim CS, Anantharaman  V. A Computer-aided MFCC-based HMM System for automatic auscultation. Comput Biol Med 2008; 38: 221-233. [6] Iwata A, Ishii N, Suzamura N, Ikegaya K. Algorithm for detecting the first and the second heart sounds by spectral tracking . Med Biol Eng Comput 1980; 18: 19-26. [7] Turkoglu I, Arslan A, Ilkay E. An intelligent system for diagnosis of the heart valve diseases with wavelet packet neural n etworks. Comput Biol Med 2003; 33 (4): 319-331. [8] Gupta CN, Palaniappan R, Swaminathan S, Krishnan SM. Neur al network classification of homomorphic segmented heart sounds. Appl Soft Comput 2007; 7: 286-297. [9] Choi S. Detection of Valvular Heart Disorders using wavelet p acket decomposition and support vector machine. Expert Syst Ap pl 2008; 35:1679-1687. [10] Ari S, Saha G. In search of an optimization technique for artificial neural network to classify abnormal heart sounds. App l Soft Comput 2009; 9: 330-340. [11] Suykens JAK, Vandewalle J. Multiclass least squares support vector machines. International Joint Conference on Neural Netw orks  IJCNN 1999; 2: 900-903. [12] Patidar S, Pachori RB. A continuous wa velet transform based method for detecting heart valve disorders using phonocardiogr aph signals. ICHIT 2012; 310: 513-520. [13] Selesnick IW. Wavelet transform with tunable Q- factor, IEEE Trans Sig Process 2011; 59 : 3560-3575 [14] Sanei S, Ghodsi M, Hassani H. An adaptive singular spectrum  analysis approach to murmur detection from heart sounds. J Med  Eng Phys 2011; 33(3): 362 -367. [15] Liang H, Lukkarinen S, Hartimo IO. Heart sound segmentation algorithm based on heart sound envelogram. IEEE Comput Cardiol  1997: 105-108. [16] Yuan J, He Z, Zi Y. Gear fault detection using customi zed multiwavelet lifting schemes. Mech Syst Sig Process 2010; 24 (5) : 1509- 1528. [17] Shannon CE, Weaver W. The mathematical theory of communication. University of Illinois Press; 1971 63  Shivnarayan Patidar and Ram Bilas Pachori  /  AASRI Procedia   4  ( 2013 )  57 – 63 
[18] Pincus SM. Approximate entropy as a measure of system complex ity. In: Proceedings of the National Academy of Sciences 1991 ; 88 (6): 2297-2301. [19] Lempel A, Ziv J. On the complexity of finite se quences. IEEE Trans Inf Theory 1976; 22 (1):75-81. [20] Sabeti M, Katebi S, Boostani R. Entropy and complexity me asures for EEG signal classification of schizophrenic and control  participants. 
J Art Intell Med 2009; 47: 263-274. [21] Bajaj V, Pachori RB.  Classification of seizure and nonseizure EEG signals using empirical mode decomposition.  IEEE Trans  Inf Technol Biomed 2012; 16 (6): 1135-1142. 