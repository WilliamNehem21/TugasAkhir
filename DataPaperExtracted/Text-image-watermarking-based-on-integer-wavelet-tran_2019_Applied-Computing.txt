Original Article
Text-image watermarking based on integer wavelet transform (IWT) anddiscrete cosine transform (DCT)
Reem A. Alotaibia,b,⇑, Lamiaa A. Elrefaeia,c,1
aComputer Science Department, Faculty of Computing & Information Technology, King Abdulaziz University, Jeddah, Saudi Arabia
bComputer Science Department, Faculty of Computing & Information Technology, Taif University, Taif, Saudi Arabia
cElectrical Engineering Department, Faculty of Engineering at Shoubra, Benha University, Cairo, Egypt
article info
Article history:Received 4 March 2018Revised 18 June 2018Accepted 20 June 2018Available online 23 June 2018Keywords:WatermarkingIWTDCTPSNRabstract
Text-images still have a great importance, despite the spread of electronic texts. Text-images areprotected using digital watermarking. This paper proposes a watermarking method applied to text-images. This method integrates two transforms: integer wavelet transform (IWT) and discrete cosinetransform (DCT). For the watermark embedding, IWT is performed on the cover image and DCT is appliedto the low frequency sub-band LL. The watermark image is inserted in the lower to medium DCT coefﬁ-cients to achieve a high degree of robustness and imperceptibility. Experiments using different Arabictext-images are performed to evaluate the proposed method in terms of imperceptibility and robustness.Results show that the proposed method has higher imperceptibility compared to other existing methodsapplied to Arabic text-images. Also, the proposed method provides good robustness results, especiallyagainst compression and noise./C2112018 The Authors. Production and hosting by Elsevier B.V. on behalf of King Saud University. This is anopen access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/4.0/ ).
1. IntroductionWith the rapid development of electronic communication tech-nologies, it has become easy to access and share information, andas a result, online piracy has spread. Textual information is themost widely used in comparison to images, audio and video. It rep-resents the easiest way to translate speech. It is the main compo-nent of publications and contributes greatly to the educationalprocess. Text-images are no less important than electronic text.They are still in use in ofﬁcial transactions and some authors pub-lish their books as a text-image. However, text-images face someissues related to the protection of intellectual rights and unautho-rized use. Watermarking technology is used to solve these issues.Using digital watermarking technology depends on stashingdata in a digital media. The media may be an image, text, videoor audio. The stashed data called a watermark, the watermarkdescribes the information regarding the owner of the digital media.The watermarking method may be visible like logos or invisible. Ininvisible watermarking, the watermark is embedded or stashed inthe cover media in a way that the human eyes cannot noticed theembedded watermark[1]. Two basic stages of any watermarkingmethod: embedding and extraction processes. The basic water-marking requirements are robustness, imperceptibility, securityand capacity[2]. The watermarking method which is resistantagainst attacks is called a robust method. Otherwise, it is called afragile method. Imperceptibility means that the watermark doesnot affect the value of the media or causes distortion. The water-marked media must look like the cover or original media. Securityincludes keeping the watermark, embedding and extraction pro-cesses secure. Capacity is the amount of embedded data comparedto the cover media.Text-image watermarking has many challenges and difﬁculties.The text-image has a little information redundancy for watermarkembedding compared to general images. Normal or general imagescontain a lot of details that can be exploited for watermark inser-tion without notice by the human eye. However, text images havea difference or contrast between the background and the typedtext. Simple changes in a text-image can be noticed because ithas a clear separation between foreground and background [3].
https://doi.org/10.1016/j.aci.2018.06.0032210-8327//C2112018 The Authors. Production and hosting by Elsevier B.V. on behalf of King Saud University.This is an open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/4.0/ ).⇑Corresponding author at: King Abdulaziz University, Female Campus, BuldingNo. 61 Room No. s109, P.O Box 80221, Jeddah 21589, Saudi Arabia.E-mail addresses:reem.a.safran@gmail.com(R.A. Alotaibi),laelrefaei@kau.edu. sa,lamia.alrefaai@feng.bu.edu.eg (L.A. Elrefaei).
1Postal address: King Abdulaziz University, Female Campus, Bulding No. 61 RoomNo. s109, P.O Box 80221, Jeddah 21589, Saudi Arabia.
Peer review under responsibility of King Saud University.
Production and hosting by ElsevierApplied Computing and Informatics 15 (2019) 191–202
Contents lists available atScienceDirect
Applied Computing and Informatics
journal homepage: www.sciencedirect.com
Text-image watermarking methods are classiﬁed based on thedomain into spatial and transform methods [4]. Spatial domain methods add watermark bits by directly changing the pixels valuesin the image while watermarking methods based on transformmodify the coefﬁcients of the transform. Currently, text-imagewatermarking based on the spatial domain are not resistantenough to lossy image compression and other image processingoperations[5,6]. Some of these methods require high complexityor font size/style dependency. Recently, watermarking text imageis done in transform domain because of its huge robustness com-pared to spatial domain methods. Not all methods applied to thegeneral images could be performed on the text-images. The text-image needs a watermarking method which satisﬁes the impercep-tibility requirement and balanced with the robustness at the sametime. The problem is how to embed watermark bits into the text-image without noticeable degradation and satisfy high robustnessagainst possible attacks.In this paper, a text-image watermarking method is proposed inthe frequency domain with the contribution of using the combina-tion of two transforms IWT and DCT. Discrete Wavelet Transform(DWT) watermarking methods provide high imperceptibilitybecause DWT transform is compatible with the Human Visual Sys-tem (HVS)[6]. It means that the human eye is less sensitive tochanges in the image (the inserted watermark). Integer wavelettransform (IWT) watermarking can exploit the characteristics ofDWT with more advantages. IWT is much faster because it dealsonly with integers. The image can be reconstructed without anyloss using IWT and can be stored without rounding off the errors[7]. Discrete cosine transform (DCT) watermarking methods aremore robust than spatial domain watermarking methods [5]. DCT watermarking methods have high robustness against compressionand image processing. Also, it is a fast transform. So, the using ofIWT and DCT is suitable for text-image watermarking. This combi-nation is used to achieve acceptable results of robustness andimperceptibility.The embedding is done in the lower frequency coefﬁcients toincrease the robustness. The LL sub-band (low frequency sub-band) is selected after applying IWT which has the lower frequen-cies. The lower to medium coefﬁcients are taken after applyingDCT. In the experiments, four different numbers of coefﬁcientsare tested to ﬁnd the relationship between the number of coefﬁ-cients and imperceptibility and robustness.The rest of the paper is organized as follows: Section 2discusses the related methods towards text-image watermarking. Section 3 presents an overview of the used transforms in the proposedwatermarking method. The proposed method is discussed in Sec-tion4with its embedding and extraction processes. Section 5pre- sents the experimental setup. Section 6reports the experimental results in terms of imperceptibility and robustness. Section 7con- cludes the paper and highlights the future work.2. Related workIn this section, watermarking methods which performed ontext-image will be discussed and compared. Text-image water-marking methods in the spatial domain are presented ﬁrst, thenwatermarking methods which are performed in the transformdomain.2.1. Spatial domain text-image watermarkingYang and Kot[8]proposed a blind watermarking method in theLatin text-image by integrating spaces between characters andword space. The watermark is embedded by shifting the characterinto right or left to denote ‘‘0” or ‘‘1” using overlapping window.This window takes three characters each time along the line. Theword space is the inter character space which is larger than themaximum space between two characters. This method achieveda high degree of transparency and improved the capacity com-pared to line shifting and word shifting. However, it is not robustagainst image attacks.The researchers in Ref.[9]proposed a watermarking method bymodifying the spaces between words in the text line. They foundedthat the average word spaces of multiple lines in the text-imagerepresent a sine wave. The frequency, phase and amplitude ofthe sine waves used to encode the watermarking signal. The water-marking method is implemented in both blind and non-blind algo-rithms. This method suffers from low coding capacity.A new word shifting method based on word classiﬁcation wasdeveloped in Ref.[10]. The words are classiﬁed depending on its
width. A group of adjacent words composes a segment, the seg-ments are classiﬁed based on word class information within eachsegment. The words are shifted left or right to encode the water-mark data. This method has higher imperceptibly than traditionalword shifting, since it shifts a small amount using the statistics.However, it consumes more time for calculations.Yang et al.[11]developed a blind watermarking method in bin-ary text-images by ﬂipping pixels. The binary image is divided intoblocks of size 5/C25. The overlapping window of size 3 /C23 is used to determine the ability of a pixel to ﬂip. This watermarkingmethod consumes the time very much and needs lots of calcula-tions. The authors in Ref.[12]also used the ﬂipping of pixels towatermark binary text-image. They ﬂip only the edge pixels ofthe connected components. The watermark is embedded in theouter boundary of a character using vertical and horizontal edges.The visible distortion is less than in Ref. [11]but, it decreases the capacity.Kim and Oh[3]inserted the watermark in grayscale text-images using edge direction histograms. They divide the imageinto sub-blocks, the ﬁrst three blocks considered as mother blocks.The watermarking is done in the remaining blocks. Each block isused to encode one watermarking bit. The length of diagonal edgedirections is modiﬁed and then compared to the lengths in motherblocks to extract the watermark. This algorithm is not robustagainst binarization attack.The principle of entropy is used in Ref. [13]to identify the suit- able location of watermark embedding in the binary text-images.The image is divided into sub-blocks and the entropy is calculatedfor each block. Entropy variation is used to ﬁnd smaller font sizeregions which have a higher occurrence in the document. Thewatermark is embedded in these regions as ASCII values of a smalltext. This method does not require anything else the watermarkedimage in the extraction phase. However, it has a lot of calculations.The researchers in Ref.[14]proposed a blind watermarking algo-rithm in binary text-images based on entropy. They reduced thecomplexity of the previous method [13]and enhance the imper- ceptibility. Watermark data is embedded in the central pixels ofblocks having small fonts. Aslam and Alimgeer [15]developed a new entropy-based watermarking method in grayscale text-images. They ﬂipped the pixels which are in the small size regions.Only the minimum pixel values are used after computing XOR ofthe desired blocks. This method overcomes the previous similarmethods[13,14]in terms of capacity and imperceptibility.Little text-image watermarking researches [16–18]are done on Arabic and Persian images in the spatial domain. The authors in[16]proposed a watermarking method by shifting the points whichare located above or under the Arabic/Persian letters. This methodhas a high capacity since most of their letters have points. Davar-zani and Yaghmaie[17]changed the slope of the letters:
to encode bit ‘‘1” and remain them the same to encodebit ‘‘0”. This method is easy to use and has higher capacity192 R.A. Alotaibi, L.A. Elrefaei / Applied Computing and Informatics 15 (2019) 191–202compared to line or word shifting. Another characteristic of theselanguages is the existence of curvaceous letters which is utilizedin the watermarking process. The curvaceous letters
for watermarking are used in Ref. [18]. The researchers modiﬁed the curve of the letter with the baseline ifthe watermark bit is ‘‘1” and nothing is changed in case of bit‘‘0”. This method is robust against resizing the text-image.These methods[16–18]share the drawback of they are notrobust to image attacks and require special font in the text-image.2.2. Transform domain text-image watermarkingA zero-watermarking method for text-images based on DCT isdeveloped in Ref.[19]. The watermark is generated from thetext-image using the lower frequency coefﬁcient of each DCT blockand logistic mapping. Then, the watermark is registered as thecopyright of the text-image. This method provides very highimperceptibility since nothing added actually to the original image.However, the watermark is only generated from the original imagenor external image or text watermarks are used. It is robust againstcompression and noise but weak against mean ﬁltering.Li and Wu[20]developed a watermarking method in binarytext-images using both DWT and DFT. The feature vectors areobtained from the original image by ﬁrstly applying one levelDWT then DFT to the lower frequency band of DWT. The sign oflower DFT-DCT coefﬁcients to form the visual feature vector. Theauthors combined the feature vectors with the watermark to gen-erate the key. The key is used in watermark extraction and authen-tication process. This method provides less robustness againstcompression and rotation attacks. The authors use the same prin-ciple, but instead of using DFT they use DCT in Ref. [21]. They found the same results with the previous one.A watermarking method for sensitive text-image based on DCTis proposed in Ref.[22]. Linear interpolation of the watermarkimage and the original image is used to generate the watermarkedimage. This method uses a scaling parameter to specify the degreeof visibility of the watermark. It is robust against compression andnoise but weak against geometric attacks except rotation with 45.The researchers in Ref.[23]proposed watermarking Techniqueof sensitive text-images based on SVD. The original image isdecomposed into three components using SVD. The second compo-nent is interpolated with the watermark image in the watermarkembedding process using linear interpolation. This method hasgood robustness and security. However, the inverse of SVD canresult in information loss unlike to the inverse of DCT [22]. Tables 1 and 2show a comparison of text-image watermarkingmethods in spatial and frequency domains respectively. Spatialmethods are weak against most types of image attacks andrestricted to certain font styles or sizes and some of them requirecomplex calculations. While, transform methods showed immu-nity against attacks, but they poorly applied to the text-images.We propose a text-image watermarking in the transformdomain. The combination of IWT and DCT is used in the proposedmethod. The embedding is done in the lower frequency coefﬁcientsto increase the robustness. The LL sub-band (low frequency sub-band) is selected after applying IWT which has the lower frequen-cies. The lower to medium coefﬁcients are taken after applyingDCT. Overview of IWT and DCT transforms is presented inSection3.3. PreliminariesTransforms are used to convert the original image from time tofrequency domain and vice versa. Time (spatial) domain refers to
Table 1Comparison of text-image watermarking methods in the spatial domain.
Author(s) The used watermarking featureText-image Advantages DrawbacksHuang and Yan (2001)[8]Word spacemodiﬁcationEnglish Robust against interference Low capacityKim et al. (2003)[9]Words shifting English Blind watermarking High imperceptibility Low capacity High complexity Yang and Kot (2004)[10]Word spacemodiﬁcationEnglish Blind watermarking More capacity than lineand word shifting Not robust against noiseShirali-Shahreza and Shirali-Shahreza (2006)[16]Points shifting Persian Arabic High capacity Font dependency Not robust against image attacks Davarzani and Yaghmaie (2009)[17] Change the slope of
Persian Arabic Blind watermarking Font dependency Not robust against image attacks Yazdani et al. (2013)[18]Change the curve of
Persian Arabic Blind watermarking Robust against resizing Font dependency Not robust against image attacks Yang et al. (2005)[11]Pixel ﬂipping English Blind watermarking High capacity Time consuming Tirandaz et al. (2009)[12]Edge pixels ﬂipping English, Persian,ChineseBlind watermarking High imperceptibility Low robustnessKim and Oh (2004)[3]Modify edge directionhistogramKorean, Chinese,EnglishApplied in different languages Not robust against binarization attack Kurup et al. (2005)[13]Entropy based English Blind watermarking Time consuming Font size dependant Khan et al. (2011)[14]Entropy based English Blind watermarking Good visual quality Font size dependant Aslam and Alimgeer (2013)[15]Entropy based English Blind watermarking Good visual quality Font size dependant
Table 2Comparison of text-image watermarking methods in the transform domain.
Author(s) The used transform Text-image Advantages DrawbacksLaouamer and Tayan (2015) [22]DCT Arabic Dynamic visibility Semi blind watermarking Weak against geometric attacks Feng and Huang (2012)[19]DCT Chinese High imperceptibility No external image watermark Weak against mean ﬁltering Li and Wa (2013)[20]DWT and DFT Chinese High imperceptibility Less robustness against compression and rotation attacks Wa et al. (2015)[21]DWT and DCT Chinese High imperceptibility Less robustness against compression and rotation attacks Laouamer and Tayan (2013) [23]SVD Arabic Good robustness and security Loss information in ISVDR.A. Alotaibi, L.A. Elrefaei / Applied Computing and Informatics 15 (2019) 191–202 193the variation of the signal over time, while frequency domainrefers to the distribution of the signal’s energy over a range of fre-quencies[4]. Transforms do not change the image data, but repre-sent it in another way suitable for some analysis. Imagewatermarking methods in transform domain are more robust thanmethods in spatial domain. They are also compatible with humanvisual system (HVS)[24].Discrete cosine transform (DCT), and integer wavelet transform(IWT) are the used transforms in the proposed method. They areexplained in the following subsections.3.1. Discrete cosine transform (DCT)DCT is a mathematical transform which converts the functionfrom time domain into the frequency domain. It results with manycoefﬁcients: single direct current (DC) and a set of alternating cur-rents (AC).Fig. 1shows the DCT matrix bands in 8 * 8 block. Low fre-quency coefﬁcients located in the upper left corner of DCT matrix.The coefﬁcients in the middle are medium frequency coefﬁ-cients. The coefﬁcients in the lower right corner are high frequencycoefﬁcients[25].The image f(x,y) with size M/C2N in spatial domain transformedinto DCT domain using the following equation:
Fðu;vÞ¼2ﬃﬃﬃﬃﬃﬃﬃﬃMNpCðuÞCðvÞXN/C01x¼0XM/C01y¼0fðx;yÞ/C2cos
pð2xþ1Þu2N/C20/C21cos pð2yþ1Þ v
2M/C20/C21ð1Þ
for u = 0, 1,...,N/C01 and v = 0, 1,...,M/C01, where
CðKÞ¼1ﬃﬃ
2p;for k¼01;otherwise( ð2Þ
The inverse DCT, which is used to convert the DCT image intothe original one is computed as:
fðx;yÞ¼2ﬃﬃﬃﬃﬃﬃﬃﬃMNpXN/C01x¼0XM/C01y¼0CðuÞCð vÞFðu;vÞ/C2cos
pð2xþ1Þu2N/C20/C21cos pð2yþ1Þ v
2M/C20/C21ð3Þ
F(0,0) is the DC coefﬁcient, which involves the most energy ofthe image. The high frequency coefﬁcients represent the edge anddetailed information of the image. The details are increased bymoving to the bottom right[26]. Low frequency coefﬁcients aremodiﬁed in robust watermarking method, while in imperceptiblewatermarking method the high frequency coefﬁcients are changed.DCT is widely used in digital image watermarking because it iscompatible with JPEG compression and its output is real matrix.3.2. Discrete wavelet transform (DWT)DWT is a mathematical analytical method used to address sig-nals for many applications. It captures both spatial and frequencyimage information. DWT is used widely in image watermarkingand compression since it provides a good visual image.DWT decompose the image into one low frequency sub band(LL) and three high frequency sub bands (LH, HL, and HH). LL con-tains the most image information and this band is closer to theoriginal image. LH represent the horizontal details, HL representsthe vertical details and HH represents the diagonal details of theimage. The image is reconstructed from these sub bands usinginverse DWT. The image also could be decomposed more thanone time, LL decomposed into four sub band and so on [27]. The outputs of DWT are ﬂoating point coefﬁcients. The round-ing error of the coefﬁcients may lead to data loss. Also, dealing withﬂoating point numbers in the watermark embedding and extrac-tion requires high computations. Integer wavelet transform (IWT)maps the original image into integer coefﬁcients. It is implementedby modifying DWT using lifting scheme proposed by Sweldens[28]. It is faster, easier to invert and does not require auxiliarymemory compared to DWT.Fig. 2shows the difference between DWT and IWT applied to text-image.4. The proposed IWT-DCT based methodThe goal of this research work is to ﬁnd a watermarking methodfor text-images using transforms. Watermarking using DCT pro-vides high robustness against compression, especially JPEG. DWTwatermarking has good imperceptibility, reconstruction and morecompatible with HVS. IWT overcomes DWT, while it is faster andhas no rounding errors (dealing only with integers).4.1. Embedding processThe cover image is decomposed into four sub-bands: LL, LH, HLand HH after applying IWT. The LL image is very close to the coverimage which means that it contains the most energy and otherbands contain the details. This is the ﬁrst step to develop a robustwatermarking method. Then DCT is applied to the LL sub-band andagain taking the lowest coefﬁcients. The numbers of the chosencoefﬁcients in each DCT block are: 9, 16, 25 and 36. In the proposedIWT-DCT-9, the ﬁrst 9 pixels in the watermark image are embed-ded in the 9 DCT coefﬁcients (the ﬁrst coefﬁcient (DC) does notchange) in the ﬁrst block. The second 9 pixels in the watermarkimage are embedded in the 9 DCT coefﬁcients (the ﬁrst coefﬁcient(DC) does not change) in the second block, and so on until the lastDCT block in the LL sub-band. The proposed IWT-DCT-16, proposedIWT-DCT-25 and proposed IWT-DCT-36 follow the same procedurewith changing the number of the chosen DCT coefﬁcients. Fig. 3 shows the block diagram of the embedding process for the pro-posed IWT-DCT method.The embedding process follows the following steps:Step 1: Perform one level IWT to the cover image A of size m /C2n.
½LL;LH;HL;HH/C138¼IWTðAÞð4Þ
Step 2: Apply 8 * 8 block DCT to LL sub-band which is of sizem2/C2n2
and take the coefﬁcients from low to medium except theﬁrst coefﬁcient DC. Each block has 64 coefﬁcients.
fDC b;AC b;1;AC b;2;...;AC b;N;...;AC b;63g¼DCTðLLÞfor b¼1:Bð5Þ
Fig. 1.DCT coefﬁcients matrix and frequency bands.194 R.A. Alotaibi, L.A. Elrefaei / Applied Computing and Informatics 15 (2019) 191–202where N is the number of the chosen coefﬁcients per blockand B is the number of 8 * 8 DCT blocks which is calculatedas:
B¼m/C3n256 ð6Þ
Step 3: Resize of the watermark image wto be of size r/C2r.
r¼ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃB/C3Np ð7Þ
Step 4: Convert the watermark image winto a vectorVof size 1/C2r
2.Step 5: Embed the vectorVwhich represents the watermarkimage in the chosen DCT coefﬁcients from AC
b;1toAC b;N
in each block using the following equation:AC0b;i¼AC b;iþða/C3Vðiþðb/C01Þ/C3NÞÞfor i¼1:N;b¼1:Bð8Þ
whereAC b;iis indicating to DCT coefﬁcient, aindicates the scaling factor andVindicates the vector representing thewatermark image.
Step 6: Inverse DCT (IDCT) to each block in the LLsub-band.
LL0¼IDCTðfDC b;AC0b;1;AC0b;2;...;AC0b;N;...;AC b;63gÞ ð9Þ
Step 7: Inverse IWT (IIWT) using the modiﬁed LL0sub-band and other bands: LH, HL and HH to get the watermarkedimage A
w.
Aw¼IIWTð½LL0;LH;HL;HH/C138Þ ð10Þ
4.2. Extraction processThe proposed IWT-DCT based method is a non-blind methodbecause it needs the cover image in the extraction process. Theextraction process includes IWT decomposition of the water-marked and cover images. Then, taking each LL sub-band of both.The DCT is applied and determine the number of coefﬁcients asin the embedding process. Finally, inverse the equation to extractthe watermark image.Fig. 4illustrates the block diagram of theextraction process for the proposed IWT-DCT method.The extraction process follows the following steps:Step 1: Perform one level IWT to the cover image Aof size m/C2n.
½LL;LH;HL;HH/C138¼IWTðAÞð11Þ
Step 2: Apply 8 * 8 block DCT toLLsub-band and take the coefﬁ-cients from low to medium except the ﬁrst coefﬁcientDC. Each block has 64 coefﬁcients.
Fig. 2.Wavelet decomposition of cover image. (a) DWT and (b) IWT.
Fig. 3.Block diagram of the embedding process.R.A. Alotaibi, L.A. Elrefaei / Applied Computing and Informatics 15 (2019) 191–202 195fDC b;AC b;1;AC b;2;...;AC b;N;...;AC b;63g¼DCTðLLÞfor b¼1:Bð12Þ
where N is the number of the chosen coefﬁcients per blockandBis the number of 8 * 8 DCT blocks which is calculated as:
B¼m/C3n256 ð13ÞStep 3: Perform one level IWT to the watermarked image A w
of size m/C2n.
½LL0;LH0;HL0;HH0/C138¼IWTðA wÞð14Þ
Step 4: Apply 8 * 8 block DCT toLL0sub-band and take thecoefﬁcients from low to medium except the ﬁrstcoefﬁcient DC. Each block has 64 coefﬁcients.
Fig. 4.Block diagram of the extraction process.
Fig. 5.GUI of watermarking text-image.196 R.A. Alotaibi, L.A. Elrefaei / Applied Computing and Informatics 15 (2019) 191–202fDC0b;AC0b;1;AC0b;2;...;AC0b;N;...;AC0b;63g¼DCTðLL0Þfor b¼1:Bð15Þ
where N is the number of the chosen coefﬁcients per blockandBis the number of 8 * 8 DCT blocks.
Step 5: Extract the vectorVwhich represents the watermarkimage by comparing the DCT coefﬁcients from AC
b;1to AC
b;Nfrom the cover image and the DCT coefﬁcients fromAC
0b;1toAC0b;Nfrom watermarked image using the followingequation:Vðiþðb/C01Þ/C3NÞ¼ðAC0b;i/C0AC b;iÞ=afor i¼1:N;b¼1:Bð16Þ
The resulting vectorVis with size of 1/C2r2,r2is calculated as:
r2¼B/C3N ð17Þ
Step 6: Convert the vectorVinto watermark imagewof size r/C2r.
)1_c()1_b(
(b_2) (c_2) 
(a) (b_3) (c_3) 
(b_4) (c_4) 
Fig. 6.(a) Watermark image, (b) Cover images, (c) Watermarked images.R.A. Alotaibi, L.A. Elrefaei / Applied Computing and Informatics 15 (2019) 191–202 197The embedding and extraction processes of the proposedmethod are simple. IWT is applied to the cover image. Then, DCTis performed to the LL sub-band. The watermark image is embed-ded in the low to medium DCT coefﬁcients. Inverse DCT followedby Inverse IWT to get the watermarked image.For the extraction process, IWT is applied to the cover andwatermarked images. Then, DCT is performed to the LL sub-bandof both the cover and watermarked images. The watermark imageis extracted by comparing the DCT coefﬁcients from the cover andwatermarked images.5. Experimental setup5.1. Studied imagesThe proposed IWT-DCT method has been implemented usingMatlab (R2015a),Fig. 5shows the GUI for our implementation. FiveArabic text-images with size of 512 /C2512 are used as a cover image and the logo of KAU is used as a watermark image with dif-ferent four sizes: 96/C296, 128/C2128, 160/C2160 and 192/C2192. Using a logo as a watermark image has a good advantage wherethe extracted image can be correlated with the embedded one bya human observer[29]. Both of cover and watermark images aregrayscale. These images are shown in Fig. 6. The value of alpha is set to 0.9 in the embedding and extraction processes.5.2. Evaluation metricsExperiments were performed to evaluate the proposed methodin terms of imperceptibility and robustness. Some criteria are usedto analyze the effect of embedding the watermark image in thecover image and to measure how much the watermarked imageis resistant against attacks. These criteria are called image qualitymetrics. The most important criteria are Mean Squared Error(MSE)[30], Peak Signal to Noise Ratio (PSNR)[31], Universal Qual- ity Index (UQI)[32], Structural Similarity Index (SSIM) [33]and Normalized cross-correlation (NC) [34]. They are described with their equations inTable 3.6. Experimental results6.1. Imperceptibility evaluation resultsThe embedding process applies to different ﬁve text-imageswhich are shown inFig. 6. The watermarked images preserve goodvisible quality as shown inFig. 6. There is no visual distortion inthe watermarked images.Table 4shows the imperceptibility results of the proposed IWT-DCT method with a different numberof the used bits. The greater number of the hidden bits, the lesstransparency, but with very few differences. For exampleTable 3Description of image quality metrics.
Metrics Equation DescriptionMean Squared Error(MSE)[30]MSE¼
1MNPM/C01i¼0PN/C01j¼0ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃfði;jÞ/C0f0ði;jÞq Finds the error between original image f(i, j) and watermarked image f0(i, j) Both images of the same size [MxN] Peak Signal to NoiseRatio (PSNR)[31]PSNR¼10log
102552
MSEno Measures the amount of noise in the distorted imageUniversal QualityIndex (UQI)[32]UQI¼
4rxylxly
ðrxþryÞðlxþlyÞFinds the distortion between two images based on distortions of correlation, luminance, andcontrast, Where
lxandlyare the averages of the original and distorted images respectively. rx
andryare the variances and rxyis the covariance Structural SimilarityIndex (SSIM)[33]SSIM¼
ð2lxlyþc1Þð2rxyþc2Þð
l2xþl2yþc1Þðr2xþr2yþc2ÞCompares the structural information between original and distorted imagesWherec
1andc 2are constants Normalized cross-correlation (NC)[34]NC¼PM/C01i¼0PN/C01j¼0½ðfði;jÞ/C0 lfÞðf0ði;jÞ/C0lf0Þ/C138ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃP
M/C01i¼0PN/C01j¼0½fði;jÞ/C0 lf/C1382q ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃP
M/C01i¼0PN/C01j¼0½f0ði;jÞ/C0lf0/C1382qMeasures the similarity between two images f(i, j) and f0(i, j). Where lfandlf0are the averages of the original and distorted images respectively
Table 4Imperceptibility results of the proposed IWT-DCT method.
Test Image No. of bits MetricsPSNR SSIM MSE NC UQITest-image-1 Shown inFig. 6(b_1) 9 58.17 0.99 0.09 0.99 0.9916 57.99 0.99 0.09 0.99 0.9925 57.89 0.99 0.10 0.99 0.9936 57.45 0.99 0.11 0.99 0.99 Test-image-2 Shown inFig. 6(b_2) 9 58.55 0.99 0.08 0.99 0.9916 58.31 0.99 0.09 0.99 0.9925 58.19 0.99 0.09 0.99 0.9936 57.73 0.99 0.1 0.99 0.99 Test-image-3 Shown inFig. 6(b_3) 9 58.54 0.99 0.08 0.99 0.9916 58.29 0.99 0.09 0.99 0.9925 58.17 0.99 0.09 0.99 0.9936 57.71 0.99 0.1 0.99 0.99 Test-image-4 Shown inFig. 6(b_4) 9 57.93 0.99 0.1 0.99 0.9916 57.75 0.99 0.1 0.99 0.9925 57.71 0.99 0.1 0.99 0.9936 57.33 0.99 0.11 0.99 0.99 Test-image-5 Shown inFig. 6(b_5) 9 58.14 0.99 0.09 1 0.9916 57.94 0.99 0.1 1 0.9925 57.91 0.99 0.1 0.99 0.9936 57.51 0.99 0.11 1 0.99198 R.A. Alotaibi, L.A. Elrefaei / Applied Computing and Informatics 15 (2019) 191–202IWT-DCT-9 is higher than IWT-SCT-36 because less coefﬁcients aremodiﬁed.The imperceptibility of the proposed IWT-DCT method is about58 dB as shown inTable 4which is a high PSNR value.Fig. 6shows the cover and watermarked images using the ﬁve text-imageswhen the number of the taken coefﬁcients is equal to 9. It is shownthat no visual difference between the cover and watermarkedimages.Table 5compares the imperceptibility results of the pro-posed IWT-DCT method with other methods: IWT–SVD [34], IWT–SVD[35], DCT-DWT[36], DWT-DCT[37], DCT-SVD[38]and IWT-DCT[39]. The averages of PSNR results of the ﬁve text-images are used in the comparison. IWT–SVD [34]used the combi- nation of IWT and SVD. IWT is performed on the original image,Table 5Imperceptibility comparison results using averagesPSNR.
Watermarking method PSNRProposed IWT-DCT-9 58.17Proposed IWT-DCT-16 57.99Proposed IWT-DCT-25 57.89Proposed IWT-DCT -36 57.45IWT–SVD[34] 50.11 IWT–SVD[35] 43.67 DCT-DWT[36] 50.028 DWT-DCT[37] 36.52 DCT-SVD[38] 41.66 IWT-DCT[39] 45.09
Table 7Robustness results of the proposed IWT-DCT method against geometric attacks.
Geometric attack type Watermarked Image Extracted watermark after geometric attackIWT-DCT-9 IWT-DCT-16 IWT-DCT-25 IWT-DCT-36Scaling([512, 512]?[256, 256]?[512, 512])
Scaling([512, 512]?[1024, 1024]?[512, 512])
Rotation (45/C176)
Rotation (15/C176)
Cropping
Cropping
If the number of authors on a reference is greater.Table 6Robustness results of the proposed IWT-DCT method against some attacks.
Attack type Watermarked Image Extracted watermark after attackIWT-DCT-9 IWT-DCT-16 IWT-DCT-25 IWT-DCT -36Without attack
Histogram equalization
Median ﬁlter
Salt & pepper noise 0.001
R.A. Alotaibi, L.A. Elrefaei / Applied Computing and Informatics 15 (2019) 191–202 199then SVD is applied in all sub-bands. The watermark image isembedded by modifying the singular values of LL, LH, HL, HH.IWT–SVD[35]also used IWT and SVD in addition to digital signa-ture. DCT-DWT[36]applied DCT to the watermark image, thenembedded it in the smooth sub-block of the high frequency DWTsub-band. The smoother sub-block is a sub-block which has a smallvalue of entropy. DWT-DCT[37]decomposed the original imagefour level DWT followed by DCT. The watermark image is embed-ded in the coefﬁcients of HL14 and LH24 sub-bands of DWT. DCT-SVD[38]performed DCT to the original image then applied SVD.The watermark is embedded in the middle DCT coefﬁcients. InIWT-DCT[39], HH sub-bands of three levels of IWT are selectedfor embedding a binary image of size 32 /C232 into a cover image of size 512/C2512. Integer cosine transform at 8x8 block level isperformed on all selected HH3 sub-bands. The watermark bitsare inserted by swapping speciﬁc DCT coefﬁcients.IWT watermarking has high imperceptibility as we see in IWT–SVD[34]fromTable 5. DCT-DWT[36]also has high imperceptibil- ity due to use of entropy to determine the suitable sub-block ofDWT sub-band. Using multi-level IWT or DWT in DWT-DCT [37] and IWT-DCT[39]provides lower imperceptibility results com-pared to other methods as shown in Table 5. Also, these methods have higher complexity than the proposed IWT-DCT methodbecause of applying wavelet transform at multi-levels. It can beseen fromTable 5that the combination of the two transformsIWT-DCT in the proposed method gives the best results in termsof imperceptibility than others, even of these methods are usedfor watermarking general images not text-images.6.2. Robustness evaluation resultsRobustness is one of the most important ingredients of water-marking. The robustness of the proposed method was testedagainst many attacks using test-image-1 as shown in Tables 6 and 8. PSNR is used to measure the difference between originalwatermark image and extracted one. Common attacks like his-togram equalization, scaling (enlarge or reduce), rotation, ﬁltering,noise and JPEG compression are used in the robustness test. Therobustness results of the proposed method with 9, 16, 25 and 36DCT coefﬁcients are convergent.In general, the biggest coefﬁcients used (9, 16, 25, 36) increasedthe robustness. IWT-DCT-36 has the highest robustness in mostattacks except in compression, enlarge and noise, IWT-DCT-25has the highest value. The averages of the ﬁve test-images are usedto compare the proposed method with other methods from the lit-erature.Fig. 7shows the averages PSNR values of the proposed
Table 8Robustness results of the proposed IWT-DCT method against JPEG compression attacks.
Quality factor Watermarked Image IWT-DCT-9 IWT-DCT-16 IWT-DCT-25 IWT-DCT-36Q=1 0
Q=2 5
Q=5 0
Q=7 5
Q=9 0
Q = 100
Fig. 7.The averages PSNR values of the proposed method robustness using the ﬁve test-images.200 R.A. Alotaibi, L.A. Elrefaei / Applied Computing and Informatics 15 (2019) 191–202method robustness using the ﬁve test-images. Fig. 8summarized the results obtained after JPEG compression using several qualityfactors using the ﬁve test-images. The proposed IWT-DCT methodshows good robustness results especially against compression andnoise, but weak robustness in case of rotation and histogramequalization.Table 9compares the proposed IWT-DCT methodwith four text-image watermarking methods in the transformdomain: DWT-DFT[20], DCT[22], SVD[23]and DWT-DCT[21]. The proposed method overcomes DWT-DFT [20]and DWT-DCT [21]. As known watermarking in DCT domain withstands compres-sion attack. DCT[22]has a very good robustness against compres-sion, but our proposed method improved the robustness againstnoise. The proposed method compared to SVD [23]has a higher robustness against compression and noise. But the main drawbackis in case of rotation attack.The data from this section shows the contribution of the studyconducted. From Section6.1we found that the proposed IWT-DCTmethod is an imperceptible watermarking method. The logo is stilldetectable after most attacks as shown in Tables 6 and 8from Sec- tion6.2except in rotation and compression with small factors. So,the proposed IWT-DCT method has achieved high imperceptibilityand robustness results.7. ConclusionIn this paper, an invisible watermarking method for text-imageis proposed using the combination of integer wavelet transform(IWT) and discrete cosine transform (DCT). This hybrid methodincludes high robustness against most attacks from DCT and highimperceptibility from IWT. The lower coefﬁcients from each trans-form are used to increase the robustness while maintaining theimperceptibility by choosing a good value for the scaling factor.Four values are used to determine the suitable DCT coefﬁcients:9, 16, 25 and 36. Their results are too close in imperceptibilityand robustness, but differ in capacity. The more coefﬁcients usedthe more capacity. The proposed IWT-DCT method overcomesother methods from literature against most attacks especiallynoise attack. It has higher imperceptibility compared to otherwatermarking methods. However, it has low PSNR values whentesting its robustness against rotation and histogram equalization.In the proposed IWT-DCT method, the gray scale watermarkimage is embedded as it is. As a future work, Binary watermarkimage can be used and scrambled before the embedding to ensurethe security. The proposed IWT-DCT method are used in water-marking Arabic text-image and can be extended for coloredimages. In the proposed IWT-DCT method, LL sub-band is selectedwith the lower DCT coefﬁcients, other bands: HL, LH and HH can beused with the lower DCT coefﬁcients.References
[1]I.I. Cox, M. Miller, J. Bloom, J. Fridrich, T. Kalker, Digital Watermarking andSteganography, second ed., Morgan Kaufmann, United States, 2007
. [2]
S. Stankovic´, O. Irena, S. Ervin, Multimedia Signals and Systems, Springer, US,New York, 2012
.[3]
Y.-W. Kim, I.-S. Oh, ’ Watermarking text document images using edge directionhistograms, Pattern Recognit. Lett. 25 (2004) 1243–1251
. [4] Practical Introduction to Frequency-Domain Analysis – MATLAB & SimulinkExample – MathWorks United Kingdom, http://www.mathworks.com/help/ signal/examples/practical-introduction-to-frequency-domain-analysis.html(accessed 14 October 2016).[5]
S. Tyagi, H.V. Singh, R. Agarwal, S.K. Gangwar, Digital watermarking techniquesfor security applications, in: International Conference on Emerging Trends inElectrical Electronics & Sustainable Energy Systems (ICETEESES), 2016, pp.379–382
.[6]
M.S. Hsieh, D.C. Tseng, Y.H. Huang, Hiding digital watermarks usingmultiresolution wavelet transform, IEEE Trans. Ind. Electron. 48 (5) (2001)875–882
.[7]
R. Harshitha, S.S. Vidya, Robust and high limit watermarking using DWT-IWT,Int. J. Adv. Sci. Res. Manage. 2 (4) (2017) 18–21
. [8] H. Yang, A.C. Kot, Text document authentication by integrating inter characterand word spaces watermarking, in: 2004 IEEE International Conference onMultimedia and Expo (ICME), Taipei, Taiwan, June, 2004, pp. 955–958.[9]
D. Huang, H. Yan, Interword distance changes represented by sine waves forwatermarking text images, IEEE Trans. Circuits Syst. Video Technol. 11 (2001)1237–1245
.[10] Y.-W. Kim, K.-A Moon, I.-S. Oh, A text watermarking algorithm based on wordclassiﬁcation and inter-word space statistics, in: Proceedings of the SeventhInternational Conference on Document Analysis and Recognition (ICDAR2003), Edinburgh, UK, 2003, pp. 775–779.[11] H. Yang, A.C. Kot, J. Liu, Semi-fragile watermarking for text document imagesauthentication, in: 2005 IEEE International Symposium on Circuits andSystems, Japan, 2005, pp. 4002–4005.[12] H. Tirandaz, R. Davarzani, M. Monemizadeh, J. Haddadnia, Invisible and highcapacity data hiding in binary text images based on use of edge pixels’, in:
Fig. 8.The averages PSNR values of the proposed method robustness using the ﬁve test-images against compression.
Table 9Robustness comparison results for text-image watermarking methods using PSNR.
ProposedIWT-DCT-9ProposedIWT-DCT-16ProposedIWT-DCT-25ProposedIWT-DCT-36DWT-DFT[20]DCT[22]SVD[23]DWT-DCT[21]JPEG compression Q = 10 40.32 40.91 41.4841.07 17.71 NA NA 17.71 JPEG compression Q = 20 44.46 44.78 44.8744.47 19.95 NA NA 19.95 JPEG compression Q = 25 43.77 44.6 44.944.83 21.60 NA NA 21.60 JPEG compression Q = 30 40.32 40.91 41.4841.07 23.07 NA NA 23.07 Rotation (15/C176) 14.51 15.98 17.36 18.66 5.239 NA NA 5.239 Salt &pepper noise 40.18 40.21 40.5339.58 NA 37.82 37.59 NANA: not available in the resources.R.A. Alotaibi, L.A. Elrefaei / Applied Computing and Informatics 15 (2019) 191–202 2012009 International Conference on Signal Processing Systems, Singapore,Singapore, 2009, pp. 130–134.[13]S. Kurup, G. Sridhar, V. Sridhar, Entropy based data hiding for documentimages, World Acad. Sci. Eng. Technol. (2005) 248–251
. [14]
A. Khan, M. Khanam, S. Bashir, M.S.H. Khiyal, A. Iqbal, F.H. Khan, Entropy baseddata hiding in binary document images, Int. J. Comput. Electr. Eng. 3 (2011)503–506
.[15]
S. Aslam, K.S. Alimgeer, Entropy based data hiding on document imagesapplied on DRDM approach, Int. J. Technol. Res. 1 (2013) 1–7
. [16] M.H. Shirali-Shahreza, M. Shirali-Shahreza, A new approach to persian/arabictext steganography, in: Proceedings of the 5th IEEE/ACIS InternationalConference on Computer and Information Science and 1st IEEE/ACISInternational Workshop on Component-Based Software Engineering,Software Architecture and Reuse (ICIS-COMSAR’06), Honolulu, HI, USA, 2006,pp. 310–315.[17] R. Davarzani, K. Yaghmaie, Farsi text watermarking based on character coding,in: 2009 International Conference on Signal Processing Systems, Singapore,Singapore, 2009, pp. 152–156.[18]
V. Yazdani, M.A. Doostari, H. Yazdani, A new method to persian textwatermarking using curvaceous letters, J. Basic Appl. Sci. Res. 3 (2013) 125–131
.[19] G. Feng, X. Huang, An improved DCT based zero-watermarking algorithm fortext image, in: 2014 International Conference on Anti-counterfeiting, Security,and Identiﬁcation (ASID), China, 2014, pp. 1–4.[20] J. Li, F. Wu, Robust watermarking for text images based on arnold scramblingand dwt-dft, in: Proceedings 2013 International Conference on MechatronicSciences, Electric Engineering and Computer (MEC), Shenyang, China, 2013,pp. 1182–1186.[21] F. Wu, M. Huang, J. Li, Robust watermarking for text images based on Arnoldscrambling and DWT-DCT, in: 2015 International Conference on Mechatronics,Electronic, Industrial and Control Engineering (MEIC 2015), Shenyang, China,2015, pp. 568–572.[22]
L. Laouamer, O. Tayan, A semi-blind robust DCT watermarking approach forsensitive text images, Arab. J. Sci. Eng. (Springer Science & Business Media BV)40 (2015) 1097–1109
.[23]
L. Laouamer, O. Tayan, An enhanced SVD technique for authentication andprotection of text-images using a case study on digital Quran content withsensitivity constraints, Life Sci. J. 10 (2013) 2591–2597
. [24]
S. Mishra, A. Mahapatra, P. Mishra, A survey on digital watermarkingtechniques, Int. J. Comput. Sci. Inform. Technol. 4 (2013) 451–456
. [25]
S.D. Lin, S.-C. Shie, J.Y. Guo, Improving the robustness of DCT-based imagewatermarking against JPEG compression, Comput. Stand. Interfaces 32 (2010)54–60
.[26] Discrete Cosine Transform, https://en.wikipedia.org/wiki/ Discrete_cosine_transform(accessed 25 November 2016). [27]N. Goel, G. Singh, Study of wavelet functions of discrete wavelettransformation in image watermarking, Int. J. Eng. Sci. 17 (1) (2016) 154–160
. [28]
W. Sweldens, The lifting scheme: a construction of second generationwavelets, SIAM J. Math. Anal. 29 (1998) 511–546
. [29] L.A. Elrefaey, M.E. Allam, H.A. Kader, M. Selim, Robust blind image-adaptivewatermarking, in: Twenty Fifth National Radio Science Conference NRSC 2008,Tanta, Egypt, 2008, pp. 1–13.[30]
T. Samajdar, M.I. Quraishi, Analysis and evaluation of image quality metrics,in: Information Systems Design and Intelligent Applications, Springer, 2015,pp. 369–378
.[31] P.B. Nguyen, M. Luong, A. Beghdadi, Statistical analysis of image qualitymetrics for watermark transparency assessment, in: Paciﬁc-Rim Conferenceon Multimedia: Advances in Multimedia Information Processing – PCM 2010,Shanghai, China, 2010, pp. 685–696.[32]
Z. Wang, A.C. Bovik, A universal image quality index, IEEE Signal Process. Lett.9 (2002) 81–84
.[33]
Z. Wang, A.C. Bovik, H.R. Sheikh, E. P, Image quality assessment: from errorvisibility to structural similarity, IEEE Trans. Image Process. 13 (2004) (2004)600–612
.[34]
N.M. Makbol, B.E. Khoo, A new robust and secure digital image watermarkingscheme based on the integer wavelet transform and singular valuedecomposition’, Digital Signal Process. 33 (2014) 134–147
. [35]
U.M. Gokhale, Y.V. Joshi, A semi fragile watermarking algorithm based on SVD-IWT for image authentication, Int. J. Adv. Res. Comput. Commun. Eng. 1 (4)(2012) 217–222
.[36]
M. Jiansheng, L. Sukang, T. Xiaomei, A digital watermarking algorithm basedon DCT and DWT, in: International Symposium on Web Information Systemsand Applications, 2009, pp. 104–107
. [37] A. Akter, M.A. Ullah, Digital image watermarking based on DWT-DCT: evaluatefor a new embedding algorithm, in: 2014 International Conference onInformatics, Electronics & Vision (ICIEV), University of Dhaka, Dhaka,Bangladesh, 2014, pp. 1–6.[38] S. Mukherjee, A.K. Pal, A DCT-SVD based robust watermarking scheme forgrayscale image, in: Proceedings of the International Conference on Advancesin Computing, Communications and Informatics, Chennai, India, 2012, pp.573–578.[39] S.L. Agrwal, A. Yadav, U. Kumar, S.K. Gupta, Improved invisible watermarkingtechnique using IWT-DCT, in: 2016 5th International Conference on Reliability,Infocom Technologies and Optimization (Trends and Future Directions)(ICRITO), Noida, 2016, pp. 283–285.202 R.A. Alotaibi, L.A. Elrefaei / Applied Computing and Informatics 15 (2019) 191–202