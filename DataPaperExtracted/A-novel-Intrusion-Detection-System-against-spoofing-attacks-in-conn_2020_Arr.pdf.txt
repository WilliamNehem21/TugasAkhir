A novel Intrusion Detection System against spooﬁng attacks in connectedElectric Vehicles
Dimitrios Kosmanosa, Apostolos Pappasa, Leandros Maglarasb,*, Sotiris Moschoyiannisc, Francisco J. Aparicio-Navarro
b, Antonios Argyrioua, Helge Janicked
aDepartment of Electrical and Computer Engineering, University of Thessaly, Volos, Greece
bFaculty of Computing, Engineering and Media, De Montfort University, Leicester, UK
cDepartment of Computer Science, University of Surrey, GU2 7XH, UK
dCyber Security Cooperative Research Centre, and Edith Cowan University, Australia
ARTICLE INFO
Index Terms:Connected vehiclesCyber securityElectric vehiclesIntrusion detection systemsSpooﬁng attackABSTRACT
The Electric Vehicles (EVs) market has seen rapid growth recently despite the anxiety about driving range. Recentproposals have explored charging EVs on the move, using dynamic wireless charging that enables power exchangebetween the vehicle and the grid while the vehicle is moving. Speci ﬁcally, part of the literature focuses on the intelligent routing of EVs in need of charging. Inter-Vehicle communications (IVC) play an integral role inintelligent routing of EVs around a static charging station or dynamic charging on the road network. However,IVC is vulnerable to a variety of cyber attacks such as spoo ﬁng. In this paper, a probabilistic cross-layer Intrusion Detection System (IDS), based on Machine Learning (ML) techniques, is introduced. The proposed IDS is capableof detecting spooﬁng attacks with more than 90% accuracy. The IDS uses a new metric, Position Veri ﬁcation using Relative Speed (PVRS), which seems to have a signi ﬁcant effect in classiﬁcation results. PVRS compares the distance between two communicating nodes that is observed by On-Board Units (OBU) and their estimateddistance using the relative speed value that is calculated using interchanged signals in the Physical (PHY) layer.
1. IntroductionTwo of the main prohibiting factors for the adoption of the ElectricVehicles (EVs) across Europe are the driving range (i.e. the distance thevehicle can cover before it needs to recharge), and the lack of supportingcharging infrastructure. One solution to these pivotal factors would bethe implementation of stochastic optimisation techniques for thecharging procedure of EVs [1]. However, this research area has speciﬁc limitations regarding the optimal placement of charging stations in a city,queue stability issues, especially when few charging stations must facil-itate a large number of requests, among others. Furthermore, thedeployment of charging infrastructure requires changes to the existingcivil infrastructure, which are costly and take a long time to implement.To overcome these prohibiting factors, it is important that novel andcost-effective approaches to help in the adoption of EVs are proposed.A novel solution initially proposed in Refs. [ 2,3] to increase the driving range of EVs is the use of city buses as energy sources on themove. The EVs can make efﬁcient use of Mobile Energy Disseminators(MED), which operate as mobile charging stations, and Static ChargingStations (SCS) [2]. The role of a MED can be taken over by city buses thatfollow a predeﬁned route across the city. Inner-city busses repeatedlymove along a predeﬁned route. An EV can establish a communicationwith a MED and approach it at a speciﬁc location along the predeﬁned route to complete the charging process. The proposed method exploitsInter-Vehicle Communication (IVC) in order to eco-route EVs. Thisinnovative approach drives the investigation towards integrated solu-tions that allow EVs to charge while moving through the city, without theneed for a signiﬁcant change in the existing road infrastructure.Dynamic Wireless Charging (DWC) is a technology with great po-tential, but further R&D may still be required towards its applicability. Anumber of companies are actively developing DWC solutions, both in theresearch and testing phases [4–7]. In Ref. [8] the authors have proposed an intelligent routing technique that can be used to implement a dynamiccharging model on existing road infrastructures. The proposed system forDynamic Wireless Charging is based mainly on wirelessVehicle-to-Vehicle (V2V) communications and uses a route optimisationsolution. The usage of wireless communication among EVs and MEDcoordinates the real-time booking procedure for either the SCS or the
* Corresponding author.E-mail address:leandros.maglaras@dmu.ac.uk(L. Maglaras).
Contents lists available atScienceDirect
Array
journal homepage:www.elsevier.com/journals/array/2590-0056/open-access-journal
https://doi.org/10.1016/j.array.2019.100013Received 23 October 2019; Received in revised form 25 November 2019; Accepted 26 November 2019Available online 2 December 20192590-0056/©2019 The Authors. Published by Elsevier Inc. This is an open access article under the CC BY license ( http://creativecommons.org/licenses/by/4.0/ ).Array 5 (2020) 100013MED, optimizing waiting times. Speciﬁcally, nodes that enter the system broadcast periodically beacon messages, known as Cooperative Aware-ness Message (CAM), to inform of their presence. Every beacon messagecontains a Node Identiﬁer, GPS coordinates, GPS speed, current Time-stamp and MAC address of the EV. These messages are transmittedseveral times per second using Dedicated Short Range Communication(DSRC) and Wireless Access in Vehicular Environments (WAVE) tech-nology, based on the IEEE 802.11p standard. However, these messagesare vulnerable to a wide range of cyber threats, such as eavesdropping,spooﬁng and modiﬁcation attacks.In particular, a spooﬁng attack against the communication betweenEVs could allow an attacker to modify the charging process (e.g. changingthe order of charging) either on a MED or on a SCS for its bene ﬁt, affecting legitimate EVs. A spooﬁng attack is one of the most dangerousattacks for route optimisation systems. This type of attack allows anattacker to spoofs its real geographical position in the information sentwithin CAM messages, making other nodes believe that the vehicle is inanother position [9]. This way an attacker can beneﬁt against competing EVs, since the charging sequence is based on navigation decisions. EveryEV has a table that contains the locations and the node identi ﬁers of every other EV in its vicinity. The information about the location of everyvehicle is extracted from their GPS system and sent to its neighborsthrough CAM messages. An attacker can create an illusion that he ispresent at a speciﬁc location by altering the location table of the GPSSystem or by generating and sending stronger fake location signals to itsGPS receiver. The presence of an Intrusion Detection System (IDS)capable of detecting GPS falsiﬁcation is essential in such a system.Moreover, the spooﬁng attack disrupts the legitimate communicationbetween two nodes, causing similar effects to those of a Denial of Service(DoS) attack. At the same time it is more dif ﬁcult to be detected since it requires only a very small number of malicious packets to be produced.The proposed IDS uses an additional metric from the Physical (PHY)layer: the estimated relative speed along with the GPS parameters aremaking it more efﬁcient in detecting such attacks.Motivation: The main motivation of this paper is to investigate howthe presence of a spooﬁng attacker as an inner node of the system affectsthe total travel time that must be optimized in Ref. [ 8]. Speciﬁc examples are described in which the presence of an attacker can violate the rightorder for the charging of EVs using the MED or the SCS. These examplesare not unique, however they are highly probable and can incur a sig-niﬁcant increase in the total travel time. This indicates that moreadvanced attacks, possibly involving numerous coordinated attackers,can impact and degrade the operation of the system. However, thedetailed analysis of coordinated attack models is out of scope of thispaper. Here, we show that a probabilistic IDS is appropriate in order todetect and mitigate the presence of at least one attacker.Concluding, an IDS based on Machine Learning (ML) is developed inorder to detect spooﬁng attackers. Based on the outcomes of the IDS,attackers are excluded from the Dynamic Wireless Charging mechanism.Another contribution of the article is the introduction of a novel metricthat is used as a separate feature for the ML algorithms. This metricnamed Position Veriﬁcation using Relative Speed (PVRS) is based on therelative speedΔuwhich is estimated through interchanged signals in thePHY layer. PVRS compares the distance between two communicatingnodes through their on-board Units (OBU) and the estimated distancethat is calculated using the
Δuvalue. The effect of the proposed PVRSmetric in the performance of the probabilistic IDS was an increase of 6%in accuracy. Therefore, PVRS is an appropriate metric especially for thedetection of a spooﬁng attack. This is theﬁrst proposed ML IDS in the literature that can effectively detect a spoo ﬁng attacker in a realistic application, alleviating also its effects. The detection engine of the pro-posed IDS is based on several ML algorithms, such as Random Forest (RF)andk-Nearest Neighbour (k-NN), using metrics in a cross-layer approach.Both supervised learning techniques are very popular, with the k-NN being robust against noisy training data like the ones obtained from areal-life urban environment and RF being one of the most accuratealgorithms, reducing the chance of over-ﬁtting. The outcomes of both supervised ML approaches are correlated using data fusion techniques inorder to improve the overall performance of the IDS.The rest of this paper is organised as follows. Section 2provides an overview of related work in the domain of spoo ﬁng attack detection. Section3describes the topology and the types of the implemented at-tacks. Section4describes the proposed probabilistic IDS and the newlyintroduced PVRS metric. Section5presents the experimental evaluationsetup, the impact of the implemented attack in V2V communication andthe proposed system for Dynamic Wireless Charging. It also includes theexperimental results of the probabilistic IDS. Section 6contains a dis- cussion of recent authentication and key-distribution techniques that areused in VANETs in order to strengthen and secure the communicationprocess. Finally, Section7summarises ourﬁndings and concludes our work.2. Related workThe literature in the area of spooﬁng attacks in VANETs is divided in two distinctive areas of interest. Firstly, techniques that use metrics fromthe Application layer (APP), e.g. speed-deviation, such as AcceptanceRange Threshold (ART) [10]. Speed Deviation Veriﬁcation at consecutive time intervals has been also used for the veri ﬁcation of each vehicle location. However, this metric is vulnerable against GPS spoo ﬁng attacks. Swaszek et al. [11] consider the use of range-only information to detectGlobal Navigation Satellite System (GNSS) spoo ﬁng of a platoon of ve- hicles equipped with inter-vehicle communications. This paper considersthe use of short range only information communicated amongst a platoonof vehicles to detect GNSS spooﬁng. So the ability to detect spooﬁng depends largely on the relative platoon geometry and the direction ofspooﬁng. These methods are mainly based on upper layer metrics, thehonesty of nearby vehicles and the trafﬁc density of spooﬁng attackers. However, there is a scarce number of proposed detection systems that usea cross-layer approach.Secondly, there is a speciﬁc area in which the publications also usemetrics from the PHY layer, such as the Received Signal Strength (RSS),and metrics from the Application (APP) layer, such as speed-deviation ofnodes [12]. In various publications, the strength distribution analysis isused to detect Sybil or Spooﬁng attacks [13]. The proposed is a cooper- ative detection method, in which multiple neighbouring nodes cooperateto measure the signal strength distribution of a suspicious node andverify its physical position. However, the simulation results of [ 13] indicate that given the unstable nature of radio propagation, this basiccooperative method can only afford quite limited accuracy. To solve thislimited accuracy of the proposed model due to propagation delay orpacket losses, especially in VANETs, the concept of Presence EvidenceSystem (PES) is proposed in order to be ensured that nodes in theopposite trafﬁc are physical nodes and we can have them as the trustysources of signal strength measurements. However, the ability to detectspooﬁng depends largely on this assumption that the opposite traf ﬁci s trusty sources. The authors in Ref. [14] propose a solution to correct the wrong position given by the fake GPS. The correction is based on avalidation process by comparing the given position to an Roadside Unit(RSU) using the wireless Vehicle-to-Infrastructure communication (V2I).However, the wireless communication between the transmitter and theRSU can be impaired by fast fading characteristics such as shadowingfrom buildings or other obstacles that exist in VANETs. Therefore, arealistic IDS for a VANET must take into account parameters from thePHY or MAC layer that indicate the communication problem. Moreover,it is obvious that the proposed IDS is based on V2V communication onlyand can be applied to a VANET without any extra infrastructure such asRSUs.Existing literature [13,14] uses RSUs as verifying base stations, withpublicly known true locations. The RSUs located in the transmissionrange of the vehicles are used to verify the real received position fromsatellite against the spoofed GPS transmitter. However, it is not clearD. Kosmanos et al. Array 5 (2020) 100013
2explained how these RSU stations can be assumed as non-malicious. Avariety of approaches have been proposed in the literature to recognizespooﬁng. Of interest here are methods which compare Global NavigationSatellite System (GNSS) information to measurements available fromother, non-GNSS sensors [11]. In Ref. [15] Carson and Bevly discussed the use of range and bearing information with GPS positions to detectspooﬁng for a platoon of vehicles. They assumed the availability ofRelative Position Vectors (RPVs) between pairs of vehicles from the radarsensor. To detect spooﬁng of a single vehicle they compared these RPVsto the corresponding GPS difference vector, declaring spoo ﬁng if the difference was too great. Their focus was on a pair of vehicles only. Allthe above mentioned techniques use the IVC for the interchange ofranging information between nodes to detect anomalies that indicatespooﬁng of the GPS positions. However, the wireless V2I communicationconfronts the wireless interference from the entire location as well thefading characteristics.Last, extensive works present applications of spatial processingmethods for GPS spooﬁng detection and mitigation that use either PhaseDelay Measurements [16] or the Angle of Arrival (AoA) estimation [ 17] from the PHY layer to verify the message originator. From an attackerperspective, an illegitimate node may intentionally falsify information toachieve a certain goal that might be rational in some scenarios. Adrawback of using metrics from the PHY layer is the incorrect GPSspooﬁng detection (e.g. false alarms) that may occur in situations wheremultiple correct satellite signals are received from similar directions andphase delay differences are below a predeﬁned threshold. All the above publications do not use ML approaches for detectingspooﬁng attacks. On the other hand, several articles such as [ 18,19] introduce the Received Signal Strength Indicator (RSSI)-based schemesfor detecting spooﬁng attacks in Wireless Sensor Networks (WSNs) usingML techniques without using a cross-layer architecture. based on detailedanalytical models for the mobile radio channel, the proposed algorithmcombines two classiﬁers to process and analyze the instant samples ofreceived signal strength to detect attacks. The algorithm is optimized forscenarios where the legitimate node and the attacking node are at thesame distance or at a very close distance from each other in relation to alandmark, which is the worst case scenario. A novel cross-layer IDS ispresented in Ref. [20] with high accuracy results. However, this IDS hasonly been tested only in a platoon of vehicles application. Last, inRef. [21] an IDS is proposed based on a deep convolutional neuralnetwork (DCNN) to protect the controller area network (CAN) bus of thevehicle. The DCNN learns the network traf ﬁc patterns and detects mali- cious trafﬁc without hand-designed features. The experimental resultsdemonstrate that the proposed IDS has signi ﬁcantly low false negative rates and error rates when compared to the conventionalmachine-learning algorithms, increasing also the complexity of thesystem.In contrast to all the aforementioned works for the detection of aspooﬁng attack using position veriﬁcation techniques that is observed bythe GPS. We use an additional prototype metric named PVRS that com-pares the distance traveled and is observed by the On-Board Units (OBU)sensors with the estimated traveled distance using the relative speed
(Δu)metric between the sender and the receiver [ 22,23]. The novelty of theΔumetric is that it can be estimated by the wireless channel of thePHY layer using the effect of the Doppler phenomenon without extrasensors or infrastructure. This estimated metric can be combined withsocial mobility patterns constructing the PVRS metric. Relative speed as ametric can be combined with other metrics from the APP and the PHYlayer leading to a cross-layer detection approach. From the PHY layerdifferent metrics such as the RSSI, the Signal to Interference and NoiseRatio (SINR) and Packet Delivery Ratio (PDR) for the effective detectionof a spooﬁng attack are used.3. System model3.1. System description and topologyTwo different charging systems are compared: one that uses a StaticCharging Station (SCS) only, and one that combines a SCS and a MobileEnergy Disseminators (MED). We use different initial energy conditionsfor all the EVs of the simulation. Our intelligent route search methodtakes into account the waiting time either for the MED-EV appointmentor for the waiting time at the queue of an SCS, in the presence of aspooﬁng attacker among the inner nodes of the system. It is shown thatthe proposed method decreases signiﬁcantly the waiting time for the charging procedure and the charging time that is needed for an EV,because the EV continues to charge along its route.However, the presence of a spoofer in the system can either cause thestarvation of speciﬁc EVs for a long time interval or cause the rerouting ofthe EVs for charging, which results in a signi ﬁcant increase in the overall travel time. At initialisation, the system model is populated with anumber of EVs (50–200). From this point onwards, every node broad-casts, at a time interval ofδðtÞ¼0:1 seconds, a CAM message to informeither the SCS or the MED of its presence. All EVs are informed of thewaiting time either by the SCS or by the MED. This comes as a responsethrough the periodical communication with MEDs or SCS using the CAMmessages. Based on this information, an EV can choose either the SCS orthe MED for its charging needs whilst selecting the best route from itsstarting point to itsﬁnal destination.For our simulated scenario, we use 3 inner nodes - vehicles of acharging system. The 2ﬁrst vehicles represent the pair Attacker-Receiver. The third vehicle is a legitimate vehicle, the Victim, whoseidentity is spoofed by the attacker. The nodes that enter the systembroadcast periodically beacon messages, to inform of their presence andupdate the MED and the SCS with information about their current loca-tion. This beacon message contains a Node Identi ﬁer; the GPS co- ordinates; the GPS speed; the current Timestamp and the MAC address. InFig. 1the attacker (EV A) initially intercepts the Node Identi ﬁer (ID) of EV I, when the EV I broadcasts the CAM to inform about its presence.Then, the attacker immediately spoofs the ID of EV I to transmit CAMswith false GPS location coordinates earlier than the legitimate CAMs sentby the EV I. This means that most of the legitimate CAMs sent by the EV Iare lost or delayed due to the MAC backoff procedure. After that, thereceiving MED would be misdirected to an incorrect location, differentfrom the one agreed with EV I, interfering with the charging process.The above scenario is not the only one that may occur. For example, aspooﬁng attacker may launch a spooﬁng attack not only for their own beneﬁt. The attacker may aim to disrupt the operation of the system as aform of Denial of Service (DoS) by virtue of the V2V communicationproblem between EV I and EV B (see Section 3.2). In any case, thedeveloped IDS would need to distinguish between both legitimate CAMssent by EV I, and spoofed CAMs sent by EV A, both transmitted with theID of EV I.It is well known that for broadcasting a packet in the 802.11p pro-tocol, relay nodes may be involved in routing this packet to its ﬁnal
Fig. 1.Topology. Beacon routing from EV A to the MED or the SCS. IDSplacement at the EV B.D. Kosmanos et al. Array 5 (2020) 100013
3destination. The localisation of the proposed IDS is decided to be one stepbefore the SCS or the MED as can be seen in Fig. 1, which is located at the transmission range (1000 m) of both the SCS and the MED. This role ofrelay node has the EV B in which located the IDS and re-transmit a packetfrom the EV I (which is the victim) either the EV A (which is the attacker)until the destination which is either the MED or the SCS.A speciﬁc example of the Dynamic Wireless Charging System that issusceptible to a spooﬁng attack is described inFig. 2. Firstly,Fig. 2a shows the attacker that is randomly selected from one of the inner nodesof the system. The attacker can either be located on a road which is in avertical position to the road the EV I is located on, or on the same roadand hence following the EV I. We investigate the case that the attacker isinitially located on a vertical road in relation to EV I, since the results aresimilar in both cases.Next, EV A intercepts the ID of EV I. As a consequence of the spoo ﬁng attack, EV I loses its turn for charging (see Fig. 2b 2c). From this situation the attacker EV A has beneﬁted since it is that vehicle that ends upfollowing the MED for charging (see Fig. 2d). So, the victim can charge only after the termination of the spooﬁng attack, greatly increasing its waiting time for charging.The blocking of the EV I must be detected by the proposed IDS tomaintain satisfactory levels for the overall travel time of the DynamicWireless Charging System. A long term mitigation strategy could involvethe localisation of the attacker EV A and its exclusion by the chargingprocess.3.2. Spooﬁng attack in V2V communicationAll EVs in the proposed charging system periodically broadcast CAMs,known as beacon messages, in order to inform neighbouring vehicles oftheir presence. Each CAM comprises several ﬁelds such as Vehicle Identiﬁer (ID), Time instance, the MAC address and current vehicle GPSlocation and speed.Safety applications are very challenging for the design of a MACprotocol in VANETs due to their low latency (less than 100 ms) and highreliability requirements. However, the performance of the 802.11p MACprotocol is highly affected by some key parameters, such as the packetsize of safety related message, the message generation function, thevehicle density, the communication range, etc. Some of these parametersare not set properly in recent proposed evaluations. Furthermore, asstated in Ref. [24], there is signiﬁcant concern if BSMs (Basic SafetyMessages) are constrained to be sent on the central control channel(CCH) during the 50 ms CCH interval. This is because there could behundreds of devices in a given area and the collision rate could be veryhigh.According to the IEEE 1609.4 coordination scheme, the channel timeis divided into synchronization intervals with a ﬁxed length of 100 ms, consisting of 50 ms (including 4 ms guard interval) alternating betweenCCH and service channels (SCH). All vehicles stay in the control channelduring the CCH 50 ms period and switch to one of the six service channelsduring the SCH 50 ms period. However, the ID and the MAC address ofthe sender in the WAVE Service Advertisement (WSA) frame [ 25] can be modiﬁed by a spoofer. In addition, this spooﬁng attack can increase the collision probability which has a negative effect on the performance ofthe IEEE 802.11p MAC protocol, speciﬁcally in safety applications using the above mentioned CCH intervals [ 26]. This situation arises if a node stays in the CCH channel for a time interval longer than 50 ms. Otherfactors need to be also deﬁned, such as the number of vehicles than canbe accommodated in VANET safety applications with these speci
ﬁc CCH intervals. The implications of the implemented spoo ﬁng attack are pre- sented in more detail in Section5.2..For the simulated attack scenario, initially, the EV I and EV B vehicleshave a wireless connection established using the IEEE 802.11p MACprotocol. The attacker EV A approaches the EV I and EV B vehicles. When
Fig. 2.Spooﬁng Attack effects on MEDs.D. Kosmanos et al. Array 5 (2020) 100013
4the EV A approaches the EV B in a distance within the transmission rangeof 1000m, the attacker intercepts the ID and MAC address of EV I from thebroadcasting CAMs and starts its spooﬁng attack. During the spooﬁng attack, EV A also broadcasts a CAM message every 0.1 s, using the ID ofEV I, in order to inform the EV B about an incorrect GPS location andspeed value. Since the attacker replicates the ID and MAC address of EV I,during the spooﬁng attack, there would be WSA frames showing dis-crepancies between the identity and the physical characteristic of theframes.The routingﬂow that is selected in the transport layer is based on theincorrect spoofed MAC address of the transmitter EV I. This results inframe losses in the PHY layer due to path losses and fast fading factors, ordue to the strict delay constraints of the backoff procedure in the MAClayer. Hence, many CAMs sent by EV I are lost in the MAC layer and arenever acknowledged by the client, which increases the Packet Error Rate(PER) and also decreases the throughput. So it is clear that the spoo ﬁng attack affects the communication channel. This attack can be also used asan another kind of a DoS attack. The designed IDS aims to detect thesediscrepancies in the communication channel.As discussed earlier, the attacker exploits these ﬁelds to transmit false GPS location coordinates within the CAMs, which misdirects the EV I toan incorrect location. As a consequence the observed RSSI values of thewireless communication betweenTransmitter- EV I(Tx) andReceiver- EV B(Rx) to move to a different level, indicating the spoo ﬁng attack. Fig. 3shows a comparison between the RSSI values obtained at thereceiver that corresponds to different distances between the Transmitter andReceivervehicles during theﬁrst two stages of the simulation (i.e., theinitial period of normal trafﬁc and the spooﬁng attack). The initial period of normal trafﬁc is between the time interval (10 –70 s), while the spooﬁng attack is conducted in the time interval between (70 –85 s). When the position of the transmitter, which is the spoofer during thespooﬁng attack, is quite different from the legitimate vehicle ’s position, the level of the RSSI values change signiﬁcantly as can be seen inFig. 3. This can indicate the spooﬁng attack, but also shows that the RSSI maybeis a crucial metric for the detection of a spoo ﬁng attack in a cross-layer ML approach.4. The probabilistic IDS4.1. Supervised ML techniquesThek-NN is a simple Machine Learning (ML) technique for patternrecognition, based on feature similarity [ 27]. When we say a technique is non-parametric, it means that it does not make any assumptions on theunderlying data distribution. Therefore, k-NN could and probably should
be one of theﬁrst choices for a classiﬁcation study when there is little or no prior knowledge about the distribution of the data points. k-NN is also alazyalgorithm (as opposed to aneageralgorithm). What this means is that it does not use the training data points to do any generalisation. Inother words, there is no explicit training phase or it is very minimal. Inother words, the training phase is pretty fast. So, the k-NN algorithm isalso useful for non-linear data, which is the case for the data we use fortraining in this study.TheRandom Forest(RF) is a supervised learning algorithm, based ondecision tree models that split a subset of features at training time andoutput the class that has the majority votes of the classes of the individualtrees [28]. This supervised learning algorithm is preferred over others forthe following reasons. Firstly, it can be used for both classi ﬁcation and regression tasks, providing high accuracy. Secondly, if there are moretrees, it does not allow overﬁtting trees in the model. It has the power tohandle a large data set with higher dimensionality. Lastly, the RF clas-siﬁer can handle missing values while maintaining the accuracy of a largeproportion of data.Each of the classiﬁcation algorithms is able to generate accurate re-sults when implemented independently. However, the combined use ofthese algorithms may help improve the overall performance of an IDS[29]. Different methodologies were evaluated to assess whether theclassiﬁcation results could be improved, for instance, by applying datafusion techniques.Ensemble learning has been used to combine the outputs fromdifferent classiﬁcation techniques. Ensemble learning is the process inwhich multiple classiﬁers are strategically selected and combined inorder to solve a particular computational intelligence problem. Ensemblelearning is primarily used to improve the classi ﬁcation performance of a model. One of the most commonly used ensemble learning algorithms isknown as Bagging [30]. In this algorithm, bootstrapped replicas of thetraining data for each classiﬁer (RF,k-NN) are used. During the last step of Bagging, the majority voting combination rule is used. Since theintended output of the IDS is a probabilistic IDS, the conditional proba-bilities are estimated for each classiﬁer in the presented IDS using the Bayesian rule as a data fusion technique.4.2. Position veriﬁcation metric and localisation of the attackerThe presented IDS uses cross-layer metrics for training from both thePHY and APP layers. From the PHY layer we extract the RSSI, the SINRand the PDR. From the APP layer we extract the relative speed ( Δu) and the GPS coordinates, each one used for the generation of the PositionVeriﬁcation using Relative Speed (PVRS) metric. We must also comparethe GPS location observed by the On-Board Unit (OBU) with the esti-mated location using the relative speed metric. This procedure results ina new novel metric called PVRS. All these metrics, listed in Table 1, are used in a cross-layer approach to improve the detection accuracy of theIDS. Furthermore, for the training-testing procedure of the proposed IDS,the data have been divided into 70% for training and 30% for testing.The relative speed (Δ u), introduced in Ref. [23], indicates the relative speed between an attacker EV A and the receiver EV B:Δu
A¼ju!A/C0u!Bj (1)whereu!
A,u! Bare the speed of the attacker and the receiver, respec-tively. The metricΔucan be effectively estimated by the RF signals ’ interchange in the PHY layer. The novelty of this metric is that it can beestimated by the physical properties of the wireless channel, using theeffect of the Doppler phenomenon [22].To create the proposed PVRS metric we must make some fundamentalassumptions. Speciﬁcally, we assume as reliable the communication be-tween theTx-Rxat the initial time instant and an initial distance dx
Fig. 3.Different RSSI levels during the normal operation and spoo ﬁng attack.Table 1Metrics that are jointly processed by the classi ﬁcation algorithms.
ID Model Feature Short Description1PVRSPosition Veriﬁcation using estimatedΔu 2 RSSI Signal Strength Indicator (dBm)3 SINR Signal Quantity Indicator (dB)4 PDR Packet Delivery RatioD. Kosmanos et al. Array 5 (2020) 100013
5between the two nodes. From this time onward the difference ΔðxÞbe- tween distanced
xðt/C01ÞbetweenTx-Rxat the timet/C01 and distance d
xðtÞafter a verifying time interval of δðtÞ¼0:1 is used as veriﬁcation distance. This relative movementΔðxÞof the transmitter-receiver pair is calculated by their OBUs, according to the transmitter-receiver GPS co-ordinates in two dimensions with respect to the traf ﬁc ahead. This mobility pattern can be justiﬁed by the social mobility patterns that are introduced in Ref. [31] for clustering needs. So we can comparethe distanceΔðxÞobserved by the OBU with the estimated distanceΔðxÞ
estusing the estimated relative speed valueΔubetweenTx-Rx. This estimated distance is in essence a relative mobility parameter k
ijxbe- tween the nodesi-j, which is a parameter indicating whether the forceamong the nodes is positive or negative (acceleration or deceleration).This value depends on whether the vehicles are approaching or movingaway along the corresponding axis.ΔðxÞ
est¼ΔuδðtÞδðtÞ 2(2)where thek
TxRx¼ΔuδðtÞis the rate of change of speed (acceleration or thedeceleration value) indicating the ratio of divergence or convergenceamong moving nodesTx-Rxat the durationδðtÞ¼0:1s. Comparing the estimated distanceΔðxÞ
estwith the distanceΔðxÞthat is observed by OBU, we can get the proposed metric PVRS.It can be seen that the Algorithm 1 for the generation of the PVRSmetric is based on position veriﬁcation. The algorithmﬁrstly examines if theTxandRxvehicles approach each other or move away from eachother. This is determined by the sign of the dduvalue, which is the dif- ference between the previous relative speed value at the time instant t/C01 and the current relative speed value at the time instant t. Afterwards, if the difference between theΔðxÞ
estandΔðxÞvalues is in the range of an apriori average spooﬁng deviation value (r¼10 m), this indicates the normal operation of the system although we note this valueis a quite small threshold for the detection of a spoo ﬁng attack. So, we can set the PVRS value equal to the previous value in Algorithm 1. Otherwise,there is a quite large deviation between the estimated distance and thedistance observed by the GPS. In that case, the PVRS value will beincreased by one indicating the start of a spoo ﬁng attack. The PVRS value will change again at the end of the spooﬁng attack, because the legitimate transmitter is located in a different position to the spoofer.Using this approach, a continuous line can be constructed which willjoin the points that indicate either the normal behavior or the spoo ﬁng attack as a form of linear interpolation technique [ 32]. The spooﬁng deviation value is an average error which is added in the difference indistance between a claimed position and the real physical position.This algorithm for the PVRS metric which is based on the positionveriﬁcation is presented in Algorithm 1. Therefore, the entire area is thenpartitioned into small areas (called subnetworks) that can be investigatedin isolation for the detection of a spooﬁng attacker. A subnetwork can be assumed an ellipse whose foci are the Tx and Rx vehicles. This ensuresthat all objects whose sum of distances from Tx and to Rx (i.e., from Tx toobject and from object to Rx) is less than 1000 m, (this is the maximumcommunicating distance for 802.11p) are accounted for.
Algorithm 1PVRS AlgorithmM¼number of observations at consecutive time instantsr¼10mt¼0PVRS←matrixðnrow¼M;ncol¼1ÞΔðxÞ←matrixðnrow¼M;ncol¼1Þmaxtrix of OBU’s observations Δu←matrixðnrow¼M;ncol¼1Þmaxtrix of estimated relative speed tþþwhileðt<¼MÞdodduðtÞ¼Δu
estðt/C01Þ/C0Δu estðtÞifdduðtÞ>0thenΔðxÞ
estðtÞ←ΔðxÞestðt/C01Þ/C0dduðtÞδðtÞδðtÞ 2
(continued on next column)(continued)
Algorithm 1PVRS AlgorithmifΔðxÞ
estðtÞ/C0r<¼ΔðxÞthenPVRSðtÞ←PVRSðt/C01ÞelsePVRSðtÞ←PVRSðt/C01Þþ1end ifelseΔðxÞ
estðtÞ←ΔðxÞestðt/C01ÞþdduðtÞδðtÞδðtÞ 2
ifΔðxÞestðtÞþr>¼ΔðxÞthenPVRSðtÞ←PVRSðt/C01ÞelsePVRSðtÞ←PVRSðt/C01Þþ1end ifend ifend whilereturnPVRS
An example inFig. 4indicates the different values that get the PVRSmetric for a spooﬁng or a normal trafﬁc during a time interval. Every change in the value of the PVRS metric indicates the end or the start of aspooﬁng attack.After the detection of the spooﬁng attack the node that launches thistype of attack must be localised and excluded from the system. Given theinitial distanced
xðt¼0ÞbetweenTx-Rxas reference distance and the estimated distanceΔðxÞ
estafter the speciﬁc time interval that is estimated in Algorithm 1, we can estimate the accurate location of the attacker. Wehave already mentioned that the transmitter ’s GPS coordinates are known to theRx. This technique for the localisation of the attacker can beseen as being similar to the one proposed in Ref. [ 19] where the spatial correlation of the received RSSI inherited from wireless nodes can beused for determining the true location. Both techniques use the values ofthe wireless communication in the physical layer of the 802.11p protocolfor the localisation. Either the estimated relative speed value Δuthat is estimated through the physical layer or the RSSI value at the Rx.5. Experimental evaluationTo evaluate the effect of a spooﬁng attack on the Dynamic WirelessCharging of EVs, our experimental evaluation has been conducted usingsimulations in the city of Erlangen, as shown in Fig. 5. We used the Simulation of Urban Mobility (SUMO) and the OMNET þþ/VEINS [33]. SUMO is adopted as our trafﬁc simulator and OMNETþþis used to simulate the wireless communication. Furthermore, the GEMV (ageometry-based efﬁcient propagation model for V2V) [34] tool was in- tegrated into the VEINS network simulator for a more realistic simulationof the PHY layer. For describing the modeled area GEMV uses the out-lines of vehicles, buildings and foliage. Based on the outlines of the ob-jects, it forms R-trees. R-tree is a tree data structure in which objects intheﬁeld are bound by rectangles and are hierarchically structured based
Fig. 4.Different PVRS value levels during the normal operation and spoof-ing attack.D. Kosmanos et al. Array 5 (2020) 100013
6on their location in space. Hence, GEMV employs a simplegeometry-based small-scale signal variation model and calculates theadditional stochastic signal variation and the number of diffracted andreﬂected rays based on the information about the surrounding objects.GEMV was conﬁgured and modiﬁed to be portable to the VEINS simu-lator and incorporated into this. Last, to setup and test our classi ﬁcation algorithms for the spooﬁng attacks detection on the previously obtaineddata, we chose to use the programming language R [ 35].5.1. Evaluation setupAs can be seen inFig. 5, a bus which follows a speciﬁc route acts as MED. The route followed by the MED is represented in yellow. Further-more, an SCS is found at aﬁxed location at the road side of the corre-sponding city district. All the parametric side roads of the area in whichthe SCS and MED charging models are located are used as starting pointsðs
kÞfor the Dynamic Wireless Charging System with the same probability.The point at which the EVs are introduced in SCS or MED system is showninFig. 5with (m
b;sbrespectively).There are between 50 and 200 EVs in the simulated environment.Additionally, each EVkentering the simulation has starting energycharge (
εks)d eﬁned according to a uniform distribution with values be-tween 1 and 6 kWh. 60% of the EVs need recharging and are consideredas anxious drivers (i.e the starting energy charge is smaller than theenergy required to complete its travel).The only communication paths available are via the ad-hoc networkand there is no other communication infrastructure. All the above pa-rameters and the selected evaluated area were chosen in way that doesnot favour any charging method (MED or SCS). The power of the antennaisPtx¼18dBmand the communication frequency fis 5:9Ghz. In our simulations, we use a minimum sensitivity (Pth) of /C069dBmto/C085dB, which gives a transmission range of about 1000 m, as can be seen inTable 2. As a result of the above transmission range, there is nocommunication with a few EVs. So, a number of EVs are excluded fromthe charging procedure because of the communication lost between EVs.This happens when the SINR threshold is below 10 dB due to attenuationthat is caused by the building obstacles of the city.After 60 s of normal operation of the proposed Dynamic WirelessCharging a spooﬁng attacker node is inserted in the systems and conductsa spooﬁng attacks with duration about 25 s. The overall simulation uti-lizes a set of 1000 observations equally split into the two implementedscenarios examined (normal operation and spoo ﬁng attack). To avoid overﬁtting1only 30% of the total number of the observations are used fortraining while the remaining 70% for testing.5.2. Effect of spooﬁng attack in the V2V MAC layerIn order to show the effect of the spooﬁng attack on the communi- cation between the Transmitter (Tx) and Receiver (Rx) vehicles, the throughput has been plotted inFig. 6. The Y-axis represents the throughput in Mbps, whereas the X-axis represents the time in seconds.The normal (i.e., without attack) communication between the Tx-Rx vehicles is represented inpinkand the spooﬁng attack is represented in blue. The effective packets interchange without interfering the attackerbetween theTxandRxvehicles is the time interval between 0 and 60 s.The spooﬁng attack is launched during the time interval 60 –85 s. As can be seen inFig. 6, the average throughput for the normalcommunication is 18 Mbps, approximately. When the spoo ﬁng attack is launched, the average throughput drops to 8 Mbps. This change in thethroughput clearly shows that the modiﬁcation of the GPS coordinates and speed values within the CAM messages has a clear effect upon thecommunication between the connected vehicles.Focusing on the effect of the spooﬁng attack on the IEEE 802.11p MAC layer, the IEEE 802.11p protocol employs Hybrid CoordinationFunction (HCF) contention-based channel access Enhanced DistributedChannel Access (EDCA) as the MAC method. This is an enhanced versionof the Distributed Coordination Function (DCF) of the IEEE 802.11 pro-tocol. The EDCA uses Carrier Sense Multiple Access with collisionavoidance (CSMA/CA). In the EDCA scheme, a node willing to transmitwill sense the medium, and if the medium is idle for greater than or equalto an Arbitration Inter-Frame Space [Access Class] (AIFS[AC]) period,the node starts transmitting directly. If the channel becomes busy duringthe AIFS[AC], the node will defer the transmission by selecting a randombackoff time. The spooﬁng attack of node EV A has as effect when thelegitimate EV I wants to transmit andﬁnd the channel busy initiating the backoff procedure. InFig. 7, thebusy timefor every MAC transmission every Time Step (in total 200 Time Steps) from the victim node EV I tothe receiver EV B is shown. From the results in Fig. 7, the effect of the spooﬁng attack in MAC layer is evident. Without the spoo ﬁng attack, the maximum busy time value reaches only 3.8 ms, whereas the maximumbusy time reaches about 8.5 ms when the spoo ﬁng attack is conducted, increasing substantially the probability of collisions.Fig. 8shows the average MAC delayT
MACfor different density of
Fig. 5.Section of the Erlangen city map used to conduct the simulations. TheMED route is marked in yellow. The position of the SCS is marked in green. Thearrows in cyan point at the journey starting points of the EVs. The buildings arerepresented for the Non-Line of Sight (NLOS) links to be considered in the V2Vcommunication.
Table 2Evaluation parameters.
Independent parameters Range of valuesNumber of vehicles 50 –200 Initial Energy (
εks) 1-6 kWh P
tx 18dBm f 5.9Ghz Packet length 750 bitsPacket Header length 256 bitsMinimum sensitivityðP
thÞ/C0 69dBm to/C085dB Transmission range 1000 metersFig. 6.Throughput (Mbps) of the communication between the TxandRxve- hicles during the experimental simulation. The normal communication withoutattack inpinkand spooﬁng attack inblue.
1Overﬁtting occurs when the classiﬁer tends to memorize the training set and thus generalize poorly when facing previously unseen data.D. Kosmanos et al. Array 5 (2020) 100013
7vehicles with the standard central control channel (CCH) interval settingof 50 ms. TheT
MACis the time delay that occurs at the MAC layer sincethe safety message arrived to MAC layer until the message is ﬁnally sent out. The end-to-end delayT
E2Edepends mostly onT MACand the propa- gation delay. This work only focuses on T
MACincrease caused by spooﬁng attacks. As it can be seen inFig. 7, theT
MACincrease is directly propor- tional to the density of vehicles. An increase in the number of vehicles, aswell as a decrease of the CCH interval will cause more contention andmore backoff time. Hence, the MAC delay T
MACis mostly driven by the backoff time.Moreover, the MAC delay is always less than 100 ms in all thesimulated scenarios. It indicates that IEEE 802.11p MAC protocol cansatisfy the latency requirement (i.e. less than 100 ms) in VANET safetyapplications [26]. It can be observed inFig. 8that, with the presence of spooﬁng attack in Dynamic Wireless Charging System, the T
MACdelay reaches over 45 ms with a trafﬁc density of 200 EVs per kilometer ( EVs= km) in need of charging in the area. This value of MAC delay is very closeto the CCH interval, which is 50 ms. As a result, it becomes dif ﬁcult for EV I to have access to one of the six service channels (SCH) channels. Thiscombination of the MAC delay with the traf ﬁc density can be assumed as a marginal threshold for the proposed dynamic charging system. This isbecause if theT
MACdelay exceeds the 50 ms (CCH interval) the estab-lished wireless connection using the IEEE 802.11p MAC protocol be-tween two EVs in fact will be questionable due to the collision probabilityincrease.5.3. Effect of spooﬁng attack on the overall travel timeThis section compares two different charging system scenarios, withand without a spooﬁng attack. Theﬁrst charging system scenario con- tains only an SCS, and the second scenario contains both an SCS and aMED. In the two scenarios with a spooﬁng attack, the malicious node replicates the identity of the EV A ( ID¼40).Fig. 9represents average travel times for a total number of 100 EVs in the system. It is obviousfrom the results that the insertion of the spoo ﬁng node withID¼40 causes a signiﬁcant increase in average travel time. The routing optimi-sation [8] which is applied to the Dynamic Wireless System is negativelyaffected. The optimum EVs charging order is altered, which causes anincrease in the average travel time value of the system.Focusing speciﬁcally on the system that uses only an SCS, the dif-ference of the average overall travel time with and without the presenceof spooﬁng attack is about 5min, which increases the average total traveltime by 10%. This increase is even more noticeable in the scenario withan SCS and a MED. In this case, travel time difference with and withoutthe presence of spooﬁng attack is about 8min, increasing the averagetotal travel time by 13%. The travel time difference is slightly higher inthis second scenario because the MED, which is a mobile node, contrib-utes with additional propagation delay in the V2V communication. Thisis also caused by the spooﬁng attack.Additionally,Fig. 10a compares the average waiting time of each EVat the point that it is planned to meet and follow the MED when thespooﬁng attack is conducted with the average waiting time of each EVafter the mitigation of the spooﬁng attack. It can be seen that the spooﬁng attack increases the waiting time by 10%. Similarly, Fig. 10b compares the average queue time in the SCS when a spoo ﬁng attacker enters the system and the average queue time after the exclusion of this node fromthe charging process after the mitigation of the spoo ﬁng attack. The ef- fect of the attack is clearly shown with the high difference between thetwo values. The queue time increases about 30% after the EV with ID¼ 40 launches the spooﬁng attack. This is due to the re-ordering of thedynamic charging process after the presence of the spoo ﬁng attacker. Hence, this delays the overall dynamic charging process. As a conse-quence, most EVs would select the SCS for charging, which in turn in-creases signiﬁcantly the queue time.Finally, it is also noticeable that, with the presence of a spoo ﬁng attacker in the system, the average waiting time increases with the samerate as the average queue time. Thisﬁnding also veriﬁes that the spooﬁng attack violates the right order of charging process having as consequencethe increase of the waiting time for the proposed charging system (SCS þ MED), as the number of EVs is increased. Therefore, this balances theperformance of the two charging system scenarios (i.e. SCS and SCS þ MED). On the contrary, after the mitigation of the spoo ﬁng attacker, as the simulation time increases, the waiting time for MED and the queuetime for SCS both increase and decreases irregularly. This happensbecause there are two choices for charging of EVs (MED or SCS) that arequickly interchanged.5.4. IDS performanceWe evaluated the performance of our attack detector by using adetection rate and receiver operating characteristic (ROC) curve, whichFig. 7.Busy Time (ms) of the communication between EV I and EV B vehiclesduring the experimental simulation. The normal communication without attackinpinkand has a duration of 200 Time Steps (20 s), whereas the spoo ﬁng attack inbluehas a duration of 170 Time Steps (17 s).
Fig. 8.MAC Layer DelayT MAC(ms) of the communication between EV I and EVB vehicles during the experimental simulation using a range of 200 EVs=km. The normal communication without attack in pink. While the spooﬁng attack inblue.Fig. 9.Average Travel Time comparison between the two different chargingsystem scenarios, with and without a spoo ﬁng attack.D. Kosmanos et al. Array 5 (2020) 100013
8is a probability curve since the proposed system is probabilistic. Anotherevaluation metric used is the area under curve (AUC) which representsthe degree or measure of separability between classes. Thus, the higherAUC score, the better our model can distinguish between classes. The lastmetric that we use for the evaluation of the proposed cross-layer IDS isthe accuracy. Informally, accuracy is the fraction of predictions ourmodel got right in the total of predictions.In order to evaluate the adaptability of the presented IDS in detectinga spooﬁng attack in a Dynamic Wireless Charging System, additionalexperiments have been conducted. These experiments combine theimplemented spooﬁng attack with the normal operation of DynamicWireless Charging System as two separates classes. Our proposed IDS,using thek-NN and RF algorithms, was trained and tested on both theabsence and presence of the PVRS feature. The presence of the PVRSfeature in our data set played a major role in detecting the attack, sincebothk-NN and RF algorithms achieved high, and equal, accuracy scoresof 91:3%. Although the accuracy of each model is the same, they producevery different AUC scores. The RF algorithm excels, having a score of0.986 as can be seen inFig. 12, while thek-NN algorithm has an AUC score of 0.935. On the other hand, the absence of the PVRS feature im-pacts our results negatively. The accuracy of both the k-NN and RF al- gorithms drops to 84:9% and 85:6% respectively. The AUC score dropsslightly (0.956) for the Random Forest in comparison to the higher drop(0.839) noticed in thek-NN algorithm. This is shown inFig. 11. It can be seen from the previous experiments that most of the dis-crepancies between the two ML algorithms used for the classi ﬁcation results are observed when the PVRS is not used for training and testing.So, a data fusion method for our Dynamic Wireless Charging Systemcould be used in this case. The Data Fusion approach combines theoutcome of the two supervised ML classiﬁers. As observed inFig. 13, thedata fusion method combines the two algorithms and actually produces abetter result.Last, inTable 3we summarize the classiﬁcation accuracy, exploiting the usage of the proposed PVRS metric as an extra feature for training andtesting or not using both thek-NN andk-NN algorithm. Comparing the accuracy results with the usage of the PVRS metric with those without theFig. 11.Spooﬁng Attack Detection: ROC curve for cross-layer approach usingthek-NN algorithm.
Fig. 12.: Spooﬁng Attack Detection: ROC curve for cross-layer approach usingthe RF algorithm.Fig. 10.Average Waiting Time for MED, Queue Time of SCS with the presenceof spoofer and after the mitigation procedure; (a) Average Waiting Time forMED with the presence of spoofer attacker vs Average Waiting Time for MEDafter the mitigation with excluding the EV with ID¼40 from the charging process; (b) Queue Time of SCS with the presence of spoofer attacker vs QueueTime of SCS after the mitigation with excluding the EV with ID¼40 from the charging process.
Fig. 13.Spooﬁng Attack Detection: ROC curves for cross-layer approach usingthe Data Fusion between two supervised ML algorithms.
Table 3Classiﬁcation accuracy percentages exploiting the usage of the PVRS metric ornot.
k-NN RFPVRS metric 91.3% 91.3%without PVRS metric 84.9% 85.6%D. Kosmanos et al. Array 5 (2020) 100013
9usage of PVRS metric we can observe an 6 :4% accuracy increase for thek- NN algorithm and a corresponding 5 :7% accuracy increase for the RF algorithm.6. DiscussionToday security and anonymity in group communications play evenmore vital role due to the increased level of threats that appear on a dailybasis. A strong difference is that now the new generation networkspossess highly dynamic characteristics through information exchangeamong automated vehicles. Moreover, when speci ﬁc time critical appli- cations are running on top of communication between cars, as the dy-namic charging framework described in this article, security is even moreimportant. Authentication and key-distribution methods can be used inorder to strengthen and secure the communication process amongst thevarious entities of the system. Many research works that can providesecurity and privacy in VANETs have been proposed during the last years.Authors in Ref. [36] proposed the use of anonymous certiﬁcates and a modiﬁcation of Public Key Infrastructure (PKI) for the provision ofauthentication and integrity. The OBUs which are on board the vehiclesare equipped with a large number of public and private key pairs that canuse for communicating with neighbouring cars. Authors in Ref. [ 37] came out with an anonymous authentication scheme in order to make aVANET robust to several attacks, including an impersonation attack.Finally authors in Ref. [38] present a detailed analysis of privacy pres-ervation methods for ad hoc social networks, including VANETs. Asfuture work we plan to combine the proposed IDS with a Key DistributionSystem that would increase the security without increasing computa-tional cost thus demanding central entities, such as RSUs to act as centralauthorities.7. ConclusionsIn this paper, an Intrusion Detection System (IDS) based on super-vised Machine Learning (ML) algorithms was developed to detectspooﬁng attackers and exclude them from the proposed system for Dy-namic Wireless Charging with Mobile Energy Disseminators (MEDs), as amitigation approach. Speciﬁc showcases of the proposed DynamicWireless Charging with MEDs are investigated with the presence of aninner node of the system as a spooﬁng attacker. These cases show that theaverage total time is increased by about 13% in the system (SCS þMED), because of the re-ordering of the charging process Dynamic WirelessCharging System with MEDs. This re-ordering of the charging processwith MEDs increases the requests for charging with SCS, and results in anincrease of the average queue time in SCS by about 30%. While the in-crease of the average waiting time for MED due to the spoo ﬁng attack is at about 10%.The above results point to the need of a probabilistic IDS to detect andmitigate the spooﬁng attacker. The proposed cross-layer IDS achieves agood accuracy at about 91% using either the k-NN or the RF algorithm. Moreover, a new metric Position Veriﬁcation using Relative Speed (PVRS) is proposed that compares the distance between two communi-cated nodes that is observed by on-board Units (OBU) and the estimateddistance that is estimated using theΔuvalue estimated by the inter- changed signals in the PHY layer. The effect of this new PVRS metric inthe performance of the proposed probabilistic IDS has proved to be anincrease in accuracy by about 6%, using both supervised ML algorithms.Furthermore, due to the discrepancies that occurred in the classi ﬁcation performance of the two ML algorithms without using the PVRS metric, adata fusion method between these algorithms (k-NN, RF) has proved tohave clearly superior performance compared with each individual MLalgorithm.Lastly, this paper has demonstrated the communication problem thatis provoked on Dynamic Wireless Charging System with MEDs with anattacker, and can be considered as a trigger for more complex attackswith more attackers.Author contributionAll authors contributed equally to this manuscript.
Declaration of competing interestThe authors declare no conﬂict of interest.8 AcknowledgementsWe thankfully acknowledge the support of the CONCORDIA H2020(GA no. 830927) EU project, and the EPSRC IAA project AGELink (EP/R511791/1).References
[1]Chrysanidis G, Kosmanos D, Argyriou A, Maglaras L. Stochastic optimization ofelectric vehicle charging stations. IEEE Smart World Congress (SWC) ; 2019. [2]Maglaras L, Topalis FV, Maglaras AL. Cooperative approaches for dymanic wirelesscharging of electric vehicles in a smart city. In: Energy conference (ENERGYCON),2014 IEEE international. IEEE; 2014 . [3]Maglaras L, Jiang J, Maglaras A, Topalis F, Moschoyiannis S. Dynamic wirelesscharging of electric vehicles on the move with mobile energy disseminators. Int ’lJ Adv Comput Sci Appl 2015;6:239 –51. [4]Luke H, Ben W, Bani A, Denis N. Potential of wireless power transfer for dynamiccharging of electric vehicles. In: IET intelligent transport systems, vol. 13. IET;2019. p. 3–12.[5] Graeme D.https://www.qualcomm.com/news/onq/2017/05/18/wireless-dynamic-ev-charging-evolution-qualcomm-halo ; 2017. [6] Maglaras L. How to charge your electric car ’on theﬂy’.www.brinknew s.com/how-to-charge-your-electric-car-on-the- ﬂy/; 2017. [7] Yamauchi M.https://www.pluglesspower.com/gen2-tech-specs/ ; 2019. [8]Kosmanos D, Maglaras L, Mavrovouniotis M, Moschoyiannis S, Argyriou A,Maglaras A, Janicke H. Route optimization of electric vehicles based on dynamicwireless charging. IEEE Access 2018;vol. 6. 42 551 –42 565. [9]Sparsh S, Ajay K. A survey on intrusion detection systems and honeypot basedproactive security mechanisms in vanets and vanet cloud. In: Vehicularcommunications, vol. 12. Elsevier; 2018. p. 138 –64. [10]van der Heijden RW, Al-Momani A, Kargl F, Abu-Sharkh OMF. Enhanced positionveriﬁcation for VANETs using subjective logic. In: IEEE 84th vehicular technologyconference. VTC-Fall; 2016. [11]Swaszek PF, Hartnett RJ, Seals KC. Using range information to detect spoo ﬁng in platoons of vehicles. In: 30th international technical meeting of the satellite.Division of The Institute of Navigation (ION GNSS); 2017. p. 2838 –53. [12]Grover J, Prajapati NK, Laxmi V, Gaur MS. Machine learning approach for multiplemisbehavior detection in vanet. In: International conference on advances incomputing and communications, vol. 192. SpringerLink; 2011. p. 644 –53. [13]Yu B, Xu C-Z, Xiao B. Detecting sybil attacks in VANETs. In: Journal of parallel anddistributed computing, vol. 73. Elsevier; 2013. p. 746 –56. [14]Anouar B, Mohammed B, Abderrahim G, Mohammed B. Vehicular navigationspooﬁng detection based on V2I calibration. In: 4th IEEE international colloquiumon information science and technology (CiSt); 2016 . [15]Carson N, Bevly D. A robust method for spoo ﬁng prevention and position recovery in attacks against networked gps receivers. In: Proceedings of the 2015
international technical meeting of the institute of navigation. Dana Point,California: ION; 2015. p. 623 –32. [16]Magiera J, Katulski R. Detection and mitigation of GPS spoo ﬁng based on antenna array processing. In: Journal of applied research and technology, vol. 13.ScienceDirect; 2015. p. 45 –57. [17]Abdelaziz A, Burton R, Koksal CE. Message authentication and secret key agreementin VANETs via angle of arrival. In: 2016 IEEE vehicular networking conference(VNC); 2016.[18]de Lima Pinto EM, Lachowski R, Pellenz ME, Penna MC, Souza RD. A machinelearning approach for detecting spoo ﬁng attacks in wireless sensor networks. In: 32nd IEEE international conference on advanced information networking andapplications. AINA); 2018. [19]Chen Y, Yang J, Trappe W, Martin RP. Detecting and localizing identity-basedattacks in wireless and sensor networks. In: IEEE transactions on vehiculartechnology, vol. 59; 2010. p. 2418 –34. [20]Kosmanos D, Pappas A, Francisco LM, Aparicio Navarro J, Janicke H, Boiten E,Argyriou A. Intrusion detection system for platooning connected autonomousvehicles. In: SEEDA-CECNSM conference; 2019 . [21]Hyun Min S, Jiyoung W, Huy K. In-vehicle network intrusion detection using deepconvolutional neural network. In: Vehicular communications. Elsevier; 2019 . [22]Kosmanos D, Argyriou A, Maglaras L. Estimating the relative speed of RF jammersin VANETs. Secur Commun Netw November 2019;2019 . [23]Karagiannis D, Argyriou A. Jamming attack detection in a pair of RFcommunicating vehicles using unsupervised machine learning. Veh Commun July2018;13:56–63.[24]Kenney JB. Dedicated short-range communications (dsrc) standards in the UnitedStates. In: Proc. IEEE, vol. 99. IEEE; 2013. p. 1162 –82. no. 7.D. Kosmanos et al. Array 5 (2020) 100013
10[25]Campolo C, Cozzetti HA, Molinaro A, Scopigno R. Augmenting vehicle-to-roadsideconnectivity in multi-channel vehicular ad hoc networks. In: Journal of networkand computer applications, vol. 36. Elsevier; 2013. p. 1275 –86. no. 5. [26]Lusheng M, Karim D, Barend VW, Jacobus, Yskandar H. Performance evaluation ofieee 802.11p mac protocol in vanets safety applications. In: 2013 IEEE wirelesscommunications and networking conference (WCNC). IEEE; 2013 . [27]Sutton O. Introduction to k nearest neighbour classi ﬁcation and condensed nearest neighbour data reduction. In: University lectures. University of Leicester; 2012. [28]Liaw A, Wiener M, et al. Classiﬁcation and regression by random forest. In: R news. vol. 2; 2002. p. 18–22. no. 3. [29]Aparicio-Navarro FJ, Kyriakopoulos KG, Parish DJ. A multi-layer data fusion systemfor wi-ﬁattack detection using automatic belief assignment. In: World congress oninternet security. WorldCIS; 2012. p. 45 –50. [30]Gaikwad DP, Thool RC. Intrusion detection system using bagging ensemble methodof machine learning. In: IEEE international conference on computingcommunication control and automation; 2015 .[31]Maglaras LA, Al-Bayatti AH, He Y, Wagner I, Janicke H. Social internet of vehiclesfor smart cities. J Sens Actuator Netw 2016;5(1):3 . [32] Bayen AM, Siauw T. Interpolation. An Introduction to MATLAB Programming andNumerical Methods for Engineers, 2015, https://www.sciencedirect.com/topics/e ngineering/linear-interpolation ; 2015. [33]Sommer C, German R, Dressler F. Bidirectionally coupled network and road traf ﬁc simulation for improved IVC analysis. IEEE Trans Mob Comput 2015;10(1):3 –15. [34]Boban M, Barros J, Tonguz OK. Geometry-based Vehicle-to-Vehicle channelmodeling for large-scale simulation. IEEE Trans Veh Technol 2016;63:4146 –64. [35] What is r?.https://www.r-project.org/about.html ; 2017. [36]Raya M, Hubaux J-P. Securing vehicular ad hoc networks. J Comput Secur 2007;15(1):39–68.[37]Bayat M, Barmshoory M, Rahimi M, Aref MR. A secure authentication scheme forvanets with batch veriﬁcation. Wirel Netw 2015;21(5):1733 –43. [38]Ferrag MA, Maglaras L, Ahmim A. Privacy-preserving schemes for ad hoc socialnetworks: a survey. IEEE Commun Surve Tutorials 2017;19(4):3015 –45.D. Kosmanos et al. Array 5 (2020) 100013
11