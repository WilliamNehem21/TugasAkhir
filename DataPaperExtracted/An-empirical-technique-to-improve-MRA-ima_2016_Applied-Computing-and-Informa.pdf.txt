ORIGINAL ARTICLE
An empirical technique to improve MRA imaging
Sonia Raufa, Kalim Qureshib,*, Jawad Kazmia, Muhammad Sarfrazb
aDepartment of Computer Science, COMSATS University, Abbottabad, Pakistan
bDepartment of Information Science, College of Computer Sciences and Engineering, Kuwait University, P.O. Box 5969,Safat 13060, KuwaitReceived 31 August 2014; revised 8 June 2015; accepted 8 June 2015
Available online 16 June 2015
KEYWORDSImage processing;Segmentation;Region growing;Medical imaging;Vessels;MRAAbstract In the Region Growing Algorithm (RGA) results of segmentation are totally dependenton the selection of seed point, as an inappropriate seed point may lead to poor segmentation. How-ever, the majority of MRA (Magnetic Resonance Angiography) datasets do not contain requiredregion (vessels) in starting slices. An Enhanced Region Growing Algorithm (ERGA) is proposedfor blood vessel segmentation. The ERGA automatically calculates the threshold value on the basisof maximum intensity values of all the slices and selects an appropriate starting slice of the imagewhich has a appropriate seed point. We applied our proposed technique on different patients ofMRA datasets of different resolutions and have got improved segmented images with reductionof noise as compared to tradition RGA.
ª2015 The Authors. Production and hosting by Elsevier B.V. on behalf of King Saud University. This isan open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/4.0/ ).
1. Introduction
In the ﬁeld of medical imaging blood vessels segmentation isan important task for diagnosis of different diseases. Seg-mented blood vessels provide meaningful information aboutthe structure and position of the vessels which plays a criticalrole in many medical applications such as diagnosis, surgeryplanning and radiation treatment planning.
Medical image segmentation is considered as a difﬁcult taskdue to variable shapes of objects and different qualities ofimages causing noise. Although a bundle of segmentation tech-
niques have been developed[1–5]still there is no singlesegmentation technique that is applicable for all imaging appli-cations. The most common region segmentation method isbased on threshold value, which is most often used as an initialstep in the majority of image processing applications.
A lot of research has been done in this area but regiongrowing technique has got more attention due to its simplicity,noise suppression, automation and whole tree detection of ves-sels. In region growing algorithm results of segmentation aretotally dependent on the selection of seed point. An inappro-priate seed point leads toward poor segmentation. The major-ity of MRA datasets do not contain required region (vessels) instart of slices. We have been studying and published papers inMRI enhancement[6,7].
The paper is organized as follows: In Section 2, we give a brief literature survey, the details of proposed ERGA is pre-sented in Section3, while Section4demonstrates the measuredresults and conclusion is given in Section5.*Corresponding author.E-mail addresses:soniarauf@ciit.net.pk(S. Rauf),kalimuddinqure- shi@gmail.com(K. Qureshi),jawajkazmi@ciit.net.pk(J. Kazmi). Peer review under responsibility of King Saud University.
Production and hosting by ElsevierApplied Computing and Informatics (2016) 12, 128–133
Saudi Computer Society, King Saud University
Applied Computing and Informatics
(http://computer.org.sa)www.ksu.edu.sawww.sciencedirect.com
http://dx.doi.org/10.1016/j.aci.2015.06.0022210-8327ª2015 The Authors. Production and hosting by Elsevier B.V. on behalf of King Saud University.This is an open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/4.0/ ).2. Related work
In MRA, the blood vessels show a wide range of intensity val-ues due to the amount of blood ﬂow. This is similar to theregion growing technique where the rate of growth is alsobased upon the range of intensity values. Therefore, the con-ventional region growing technique fails to extract whole ves-sels tree. In order to solve the intensity range problem for thesegmentation of blood vessels, a range of strategies based uponregion growing have been proposed by various authors. Pau-lina et al.[1]implemented the idea of both global thresholdingand local thresholding. Global thresholding is applied to theselection of seed points and local thresholding serves as a cri-terion to put a stop to region growing. Average intensity valuesof images are calculated and applied to the formula of quadra-tic polynomial, which gives a global threshold value. Seedpoints are obtained after applying global thresholding.Abdel-Dayem and El-Sakka[8]recommended the fuzzy regiongrowing technique for the segmentation of carotid artery ultra-sound images. Ultrasound images usually have problems ofnoise and low contrast. To overcome these problems, two pre-processing steps are performed. Histogram equalization isapplied in order to increase the dynamic range of the imagegray levels. For noise removal, a median ﬁlter was appliedon the histogram equalized image. Dokladal et al. [9]proposed a branch-based region growing technique for the segmentationof blood vessels of MRA. According to this technique, seg-mentation is performed individually branch by branch. Ini-tially a single seed point is selected manually and then itbegins the search for a branch.
Another region growing based technique for the extractionof liver blood vessels from X-ray images is applied by Passatet al.[10]. Their proposed algorithm maintains hierarchicalpriority lists based upon ‘‘ﬁrst in ﬁrst out’’ where the priorityto each list was assigned according to the value of luminosity.For the insertion of new points, lists are accessed randomly.Kim et al.[11]proposed an atlas based automatic approachfor region-growing segmentation of brain vessels. They haveimplemented the concept of two threshold values: a higherand lower value respectively to cover all the vessels in tree.Multiple seed points are chosen with the help of a higherthreshold value.
Kim and Park[12]have proposed a local adaptive thresh-olding based technique for the segmentation of carotid arteryusing MRA slices. This technique automatically computesthe threshold value by considering a midpoint of maximumand minimum gray levels of only ﬁrst slice. In addition, theapplication of the threshold value ﬁlters the ﬁrst slice. Takinginto account the anatomical structure of the left and right car-otid arteries, the ﬁltered slice is divided into two subregions.Seed points of each subregion are calculated and their eightconnecting neighbors are labeled in order to get the regionof interest.
Almi’ani and Barkana[13]proposed a modiﬁed regiongrowing algorithm to extract cerebral vessels of MRA images.The image segmentation, pre-processing step, gamma correc-tion and spatial operations were the components of proposedtechniques. The proposed technique shows performanceimprovement in terms of noise attenuation, vessel enhance-ment and segmentation.Priyadharshini and Anitha[14]applied region growing
algorithm to diagnose glaucoma in eye. The pre-processingimaging technique and morphological operations such as dila-tion and erosion were incorporated and median ﬁlter wasapplied in the proposed technique. The technique shows per-formance improvement in terms of image quality and imageedges compared to the thresholding techniques.
Wen et al. proposed[15]cerebrovascular segmentationalgorithm to obtain accurate vessel. The ﬁnite mixture model,Gaussian distribution function and Rayleigh distribution func-tion were used. The proposed have two limitations that are, (i)proposed algorithm iteration runs sequentially to achieve astable state and (ii) proposed algorithm does not considerthe neighborhood relationships between the voxels.
In this paper, we proposed few enhancements in regiongrowing algorithm. Our main contribution is to determineappropriate threshold value of slice, seed point and startingslice number. We also developed a two pass algorithm forgrayscale 8-connected neighbors. We applied all these compo-nents in RGA and evaluate the performance in terms of imageenhancement. The region growing algorithm that applies inour proposed system is driven from[16].
3. Enhanced Region Growing Algorithm (ERGA)
In the traditional region growing algorithm, results of segmen-tation are totally dependent on the selection of seed point. Anappropriate seed point results in quality segmentation. How-ever, in the majority of MRA datasets, the start of the slicesdoes not contain any required information. As a result of this,we have not applied region growing algorithm directly on theﬁrst slice. In order to begin from the required region, we havedeveloped an automatic threshold value. To calculate thethreshold, the maximum intensity value of each slice isobtained and stored in an array denoted as max_list. From thismax_list, we then ﬁnd the maximum and minimum intensityvalues, i.e.m
1andm 2respectively. Finally the differencebetweenm
1andm 2is gained.
T¼m 1/C0m 2 ð1Þ
The maximum intensity of each slice is compared withthresholdTgiven in Eq.(1). Slices are checked in a sequencein ascending order. Any slice with an intensity value greateror equal to the threshold value is selected as a ﬁrst slice F
1. Region growing algorithm is then applied to F
1and onward slices only. In this way, the starting slice F
1is different for each dataset and is selected automatically according to max-imum intensity values. The steps for ERGA are given asfollows:
3.1. Steps for slice selection algorithm
1.Initialize n with total number of slices in a dataset2.Read all MRA slices of sequence images3.Find maximum intensity value of each slice and store in anarray, i.e. max_list, in ascending order.4.Find maximum intensity value from max_list, i.e. m
1
5.Find minimum intensity value from max_list, i.e. m 2
6.Find threshold T by taking the difference of m 1and m 2values 7.Start loop from j = 1 to nAn empirical technique 129i.If max_list (j)PT
a.The jth slice will be selected as a starting slice forregion growingb.Assign value of j to F
1(ﬁrst slice)c.Break
8.Pass selected slices to region growing algorithm, i.e. F 1to n. 9.Apply RGA for segmentation of vessels[16].
3.2. Grayscale 8-connected neighbors for region growingalgorithm
Region growing algorithm is based on the idea of neighbor’sconnectivity. We have used 8-connected neighbors’ criterionfor region growing. The algorithm used for labeling of 8-connected neighbors is called ‘‘two pass algorithm’’, whichmakes two passes over the image. One pass records the equiv-alences and assigns temporary labels. During second pass, eachtemporary label is replaced by the label of its equivalence class.In order to apply two pass algorithms on grayscale imagesthreshold value is required. We have selected two thresholdvalues, i.e. higher and lower. Higher threshold is assigned withthe value of homogeneity criterion, i.e. the average of currentsegmented slice region and next un-segmented slice region. Forlower threshold value we subtracted a constant value 10 fromhigher threshold value. The pseudo code of pass 1 and pass 2 islisted below.
Pass 1:/C15Assign the value of calculated homogeneity criterion to higherthreshold value, T1/C15Find lower threshold value, T2=T1/C010 /C15for seed point (current pixel) to the end of an image1. if the current pixel is greater than or equal to T2 & less than orequal to T1i. if 4 of neighbors (above/left) have lesser intensity valuesthan T2(a) Create a new label and label itii. else if 4 of neighbors (above/left) have same labels(a) Assign pixel with same labeliii. else if any one of 4 neighbors (above/left) has label(a) Assign that label to the pixeliv. else if neighbors have diﬀerent labels(a) Assign pixel with the largest label(b) Mark the smaller label as a parent of larger one.Pass 2:/C15Divide all labels into equivalence classes./C15Replace each label with the number of its equivalence class.4. Experiment setup and measurement results
Details of datasets used in the experiment are given inTable 1, the investigated images are ToF withT1 relaxation and 16 bit. FromTable 1, the obtained value of starting slicefor the enhancement and maximum intensity value of startingslice will be used for enhancement. The vessels segmentationof head MRA for dataset 1, using a region growing algorithmwithout any enhancement, is shown inFig. 1. The maximum intensity value of the ﬁrst slice is 356, which is very low com-pared to the maximum intensity value of the entire dataset,i.e. 988. The ﬁrst slice does not give the required information(vessels) as shown inFig. 1a. The threshold is selected bytaking an average of the difference between maximum andminimum intensity values, i.e.T= 178. After applyingT on the ﬁrst slice grayscale image, a binary image is con-structed. This is presented inFig. 1b. The segmented noisyresult of the ﬁrst slice image following region growing isdescribed inFig. 1c, which does not contain any requiredvessel. The region growing technique is totally dependenton the selection of seed point. An inappropriate seed pointresults in poor segmentation, shown inFig. 1d. In the ﬁrst slice, there is no appropriate seed point. So the region isgrown according to the noise (unwanted region) leading topoor segmentation.
Fig. 2a shows the grayscale (slice 27) image that is maxi-mum and minimum intensity values are 644 and 0 respectively.The threshold value for the starting slice is 322. Fig. 2b is the threshold binary image of the starting slice. The segmentationresult of the starting slice is described byFig. 2c. As soon as an appropriate starting point is selected, head vessels areextracted correctly (seeFig. 2d).
As in the ﬁrst slice (Figs. 1a and2a), there is no appropri-ate seed point, so the region grows according to the noise(unwanted region) which results in poor segmentation. Thisis one of the main reasons that, in order to ﬁnd the correct seedpoint, we have proposed this very algorithm based on thresh-olding. The maximum intensity value of each of the 118 slicesis obtained and stored in an array, i.e. max_list. Once again, toobtain the maximum value from max_list, i.e. 988, and mini-mum value from max_list, i.e. 356, the difference betweenthe maximum and minimum values is calculated, which is632. The result is selected as the threshold. The maximumintensity value of each slice is compared with the threshold.Slice 27 is the ﬁrst slice with a maximum intensity value greaterthan 632, so it is selected as a starting slice for the proposedregion growing algorithm.
Like datasets 1 and 2 the results obtained by using datasets3 and 4 are not listed as listed inFigs. 1 and 2. This is due to
Table 1MRA datasets used in the experiment.
Dataset#Dataset type(MRA)DatasetdimensionsTotal no. ofslicesMaximum intensityvalue of 1st sliceStarting slice forenhancementMaximum intensity value of startingslice for enhancement 1 Head 576·576 118 356 27 6442 Head 576·448 120 476 53 7323 Renalarteries576·448 72 99 9 1634 Head 576·448 110 367 36 610130 S. Rauf et al.similarity of and to save the space. For datasets 3 and 4 theenhancement start by slice 36 and 8 respectively as listed inTable 1. By viewingFig. 3for each dataset it is observed that the image obtained after applying ERGA has better results in
terms of contract, better visibility of vessels including the thinvessels and unwanted noise is eliminated.(a) (b)
(c) (d)
Figure 2Segmentation of head vessels of dataset 1 using region growing after enhancement, (a) selected starting slice (27) image of headdataset. (b) Thresholded image of starting slice. (c) Result of starting slice after region growing. (d) Final result of segmentation afterregion growing of 92 slices (27–118).(a) (b) 
(c) (d)
Figure 1Segmentation of head vessels for dataset 1 using region growing before enhancement. (a) First slice image of head dataset. (b)Threshold image of ﬁrst slice. (c) Result of ﬁrst slice after region growing. (d) Final result of segmentation after region growing of all (118)slices.An empirical technique 1315. Conclusion
The segmentation of blood vessels is an active research areawhich plays a signiﬁcant role in many medical applicationsincluding diagnosis, surgery planning and radiation treatment.The quality of segmentation in the case of the region growingalgorithm completely relies on the selection of seed point. Incases where the selected seed point does not belong to theregion of interest (vessels), the whole region will be grown
incorrectly. MRA, which is used speciﬁcally for images ofblood vessels, does not contain the required region in startof slices. Applying a region growing algorithm directly fromthe ﬁrst slice will result in an inappropriate seed point, therebyleading to poor segmentation. In order to overcome this prob-lem, an ERGA has been proposed. The vessel images gener-ated by ERGA are improved quality as compared to genericRGA.Data set 1: Before Enhancement (RGA) Data set 1: After Enhancement (ERGA)
Data set 2: Before Enhancement (RGA) Data set 2: After Enhancement (ERGA)
Data set 3: Before Enhancement (RGA) Data set 3: After Enhancement (ERGA)
Data set 4: Before Enhancement (RGA) Data set 4: After Enhancement (ERGA)
Figure 3Comparison of obtained images by applying RGA and with ERGA.132 S. Rauf et al.References
[1]M. Paulinas, D. Miniiniotas, O.M. Meilunas, A. Usinskas, Analgorithm for segmentation of blood vessels in images, Electron.Electr. Eng. 83 (2008) 25–28
.
[2] S. Eiho, H. Sekiguchi, N. Sugimoto, T. Hanakawa, S. Urayama,Branch-based region growing method for blood vesselsegmentation, 2005.
[3] P. Dokladal, C. Lohou, L. Perroton, G. Bertrand, Liver bloodvessels extraction by a 3-D topological approach (1999) 95–105.
[4]N. Passat, C. Ronse, J. Baruthio, J. Armspach, C. Maillot, C.Jahn, Region-growing segmentation of brain vessels: an atlas-based automatic approach, J. Magn. Reson. Imaging 21 (2005)715–725
.
[5]S. Ehio, H. Sekiguchi, N. Sugimoto, T. Hanakawa, S. Urayama,Branch-based region growing method for blood vesselsegmentation, J. Syst. Comp. Japan 36 (2005)
.
[6] Mubbashar Saddique, Jawad Haider Kazmi, Kalim Qureshi, Ahybrid approach of using symmetry technique for brain tumorsegmentation, J. Comput. Math. Meth. Med. 2014 (2014) 1–13(Article ID 712783).
[7]J.H. Kazmi, K. Qureshi, H. Rasheed, An implementation ofSAN ﬁlter and edge sharpening method for MRA images,Malay. J. Comp. Sci. 20 (2007) 99–114
.
[8] A.R. Abdel-Dayem, M.R. El-Sakka, Carotid artery ultrasoundimage segmentation using fuzzy region growing, in: Proceedingsof the Second International Conference on Image Analysis andRecognition, 2005, pp. 869–878.
[9] P. Dokladal, C. Lohou, L. Perroton, G. Bertrand, Liver bloodvessels extraction by a 3-D topological approach, in: MedicalImage Computing and Computer-Assisted Intervention
MICCAI’99, Lecture Notes in Computer Science, vol. 1679,1999, pp. 98–105.
[10]N. Passat, C. Ronse, J. Baruthio, J.P. Armspach, C. Maillot, C.Jahn, Region-growing segmentation of brain vessels: an atlas-based automatic approach, J. Magn. Reson. Imaging 21 (2005)715–725
.
[11]D.Y. Kim, S.M. Chung, J.W. Park, Automatic navigation pathgeneration based on two-phase adaptive region-growingalgorithm for virtual angioscopy, Med. Eng. Phys. 28 (4)(2006) 339–347
.
[12]D.Y. Kim, J.W. Park, Multiple-phase segmentation approachfor blood vessel extraction on cervical MRA image sequence,Magn. Reson. Imaging 27 (2) (2009) 256–263
.
[13] Muder M. Almi’, Buker D. Barkama, Vascular segmentation inmagnetic resonance angiography: a modiﬁed region growingapproach, in: IEEE Signal Processing in Medicine and BiologySymposium, SPMB 2012, 2012.
[14] Lydia Glory, M. Priyadharshini, J. Anitha, A region growingmethod of optic disc segmentation in retinal images, in:International Conference on Electronics and CommunicationSystems, ICECS 2014, 2014.
[15] Lei Wen, Xingce Wang, Zhongke Wu, Mingquan Zhou, Jesse S.Jin, A novel statistical cerebrovascular segmentation algorithmwith particle swarm optimization, J. Neurocomput. 148 (2015)569–577.
[16] Huiyan Jiang, Baochun He, Di Fang, Zhiyuan, A regiongrowing vessel segmentation algorithm based on spectruminformation, Comput. Math. Meth. Med. (2013) 413–426(Article ID 743809).An empirical technique 133