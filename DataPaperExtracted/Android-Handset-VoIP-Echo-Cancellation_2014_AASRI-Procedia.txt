 AASRI Procedia   8  ( 2014 )  88 – 92 Available online at www.sciencedirect.com
2212-6716 © 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).Peer-review under responsibility of Scientific Committee of American Applied Science Research Institutedoi: 10.1016/j.aasri.2014.08.015 
ScienceDirect
2
Abst
In th
resea
2G/3
adeq
them
built 
probl
cance
© 20
Sele
Keyw
1.In
O
echo
M
E2014 AAS R
tract 
his study, the a
arched. The ec h
3G circuit-swit c
quate. In the fu t
main applicatiointo its chip, 
lem. This pap e
ellation metho d
014. Publishe d
ection and/or p
words:android; e c
ntroduction 
On the Andro i
o paths can b e
Ming-Che Yeh. T e
E-mail address:t pRI Confere n
Andro i
Ming-C
NTUT, Elect r
NCUT, Ele c
NTUT, Elect r
acoustic echo p
ho problem is c
ch (CS) mode, t
ture 4G/LTE e n
n for personal the Androi
d-ba
er presents an 
d.
d by Elsevier 
peer review u n
cho cancellation; 
idplatform, t
e determined. 
el.: +886-919-09 7
p26610@gmail.c once on Spo r
id Hand s
he Yeh*, C
rical Engineerin g
ctrical Engineeri n
rical Engineerin g
problem and c a
consequential f
the acoustic ec h
nvironment, all -
speech comm u
ased VoIP on analysis of t
h
B.V.
nder responsi b
echo suppressor ;
the micropho n
The first pat h
7744;. 
omrts Enginee r
set VoI P
Cheng-Yu 
g, #1, Sec. 3, Chu n
ng, #57, Sec. 2, Z h
g, #1, Sec. 3, Chu n
ancellation me t
for Android p h
ho is cancelled b
-IP packet co m
unication syste m
3.5G/WiFi wi l
he acoustic ec h
bility of Ame r
;
ne and speak e
h is the air, aring and Co m
P Echo C
Yeh, Sha w
ng-hsiao East R d
hongshan Rd., Ta i
ng-hsiao East R d
thod of Andro i
hone-based VoI
by the hardwa r
mmunication wi l
ms. Before the 
ll continue to u
ho on Androi d-
rican Applied 
er environme n
and the secon dmputer Sci e
Cancella t
w-Hwa H w
d., Taipei, Taiwa n
ichung, Taiwan, R
d., Taipei, Taiwa n
id-platform- bas
P applications. 
re chip, and the 
ll be achieved. introduction o
undergo the a fo
-based VoIP a
Science Res e
nt creates th e
d is the hand sence (SEC S
tion
wang 
n, ROC
ROC
n, ROC
sed VoIP was However, in 
t
quality of co m
The IMS/VoI P
f 4G with ech o
forementioned a
and proposes a 
earch Institute 
e acoustics. T
set case. In t hS 2014) 
analyzed and 
the traditional 
mmunication is 
P will become 
o cancellation 
acoustic echo simple echo 
wo acoustic 
he traditional 
© 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).Peer-review under responsibility of Scientific Committee of American Applied Science Research Institute89  Ming-Che Yeh et al.  /  AASRI Procedia   8  ( 2014 )  88 – 92 
2G/3
Thesoft
w
canc
First
proc
poin
meth
Fig.1
1
T
impl
evid
2I
n
preshar
d
code
The3
T
audi
impo
the m
4
T
coor
the p3G circuit sw i
LMS algori t
ware app. T h
cellation mus t
t, the LMS- ba
cess on the A n
nts), thus leng t
hods that hav e
. Acoustic Echo 
.Android 
This was add e
lemented int o
dent. .Android 
n this study, a
ent and the v
dware or the c
e for the CS s
echo was ca n
.Softwar e
This algorith m
io data at a ti m
ossible. The t
most crucial fe
.Softwar e
This is the s i
rdinated perfe
playing and r eitch communi
thm is com m
he communic a
t all be impl e
ased echo can c
ndroid platfo r
thening the f i
e been propos e
API: Class a c
edto the An d
o the authors’ GSM codec 
attempts were 
voice quality 
chip had to b e
session. The s
ncelled by the 
e computatio n
m is used to ca p
me slot. The L
time delay of 
feature of the V
e computatio n
implest appr o
ctly. The ech o
ecording of a ncation mode, 
monly used f o
ation protoco
emented by s o
cellation algo r
rm is conduct e
ilter length a n
ed for the An d
coustic echo c
droid API levVoIP applic
a
made to use a
was excelle n
e determined b
segment of c o
hardware an d
n: Least mean 
pture echo a u
LMS requires a
voice over V
VoIP system. 
n: Echo suppr e
oach to imp l
o canceller de t
n audio devic e
Audio Signal the acoustic e
or echo canc e
l, SIP/RTP, t
oftware. Aco u
rithm require s
ed frame by f
nd computatio n
droidplatfor m
canceler el 19. In this
ation. Howev e
a traditional 2
nt. Hence, w h
by reading th e
ode was then u
d then passed t
squares [1] 
udio samples. 
a high-order b
VoIP is too lo n
essor [2] 
lement, and y
termines the c
e. The followi n
Spe
Micro pecho cancella t
ellation. Ho w
the speech c o
ustic echo ca n
s high compu t
frame. The m
n of the LM S
m are listed as 
 study, atte
m
er, it did not w
2G/3G circuit 
hether the ec
e android sou r
used to simu l
to the VoIP.Most android
buffer length a
ng for comm u
yields a hig h
characteristic s
ng section de t
eaker
phone tion function i
wever, Andro i
odec, G.711/ G
ncellation is d
tational power
inimal frame 
S algorithm. Pfollows: 
mpts were ma d
work, or the e
switch (CS) s
ho canceller 
rce code and 
late the echo system audi
o
and computat i
unication. Re a
h-quality voi c
s of the audio 
tails this appr o
is built into t h
id-based VoI P
G729, and a c
difficul t for t
r. Second, th e
size is 10 m s
revious echo 
de for this fu n
echo cancella t
session. The e
was implem e
retrieving th e
function in t h
o drivers capt u
ional power, w
al-time com m
ce when par
data relation s
oach.he GSM chip. 
P is a pure 
coustic echo 
two reasons: 
e record/play 
s (80 sample cancellation 
nction to be 
tion was not 
echo was not 
ented in the 
e segment of 
he hardware. 
ure 10 ms of 
which seems 
munication is 
rameters are 
ship between 90   Ming-Che Yeh et al.  /  AASRI Procedia   8  ( 2014 )  88 – 92 
2.E
Fig.2
In
cont
T
In
play
depe
1
T
the r
2
T
samp
caus
and1cho suppress
. Block diagram o
n the echo su p
tains 80 samp l
The value F e x
n comparing t
yback frame e
ends on the fr a
.Ifܧ௉ሺݐሻ൑
The audio fra m
recorded spea k
.Ifܧ௉ሺݐሻ൐
This indi c
of the listenBased on thi
s
Theprevious d
pled in real ti m
ses the echo s u
playback mu s
.Ifܧ௉ሺݐሻ൑sor al gorith m
of an echo suppr e
ppressor app r
le points. 
xpresses an a u
the energy of 
energy is ܧ ௉a
ame (10 ms): 
ࡱ
ࡱ
൑ܧோሺݐሻ,
me energy do e
king voice. T h
൐ܧோሺݐሻ,
cates tha t a re
er. This is a 
s characterist i
discussion do e
me. The reco r
uppressor to c
st be determi n
൑ܧோሺݐെܦሻ ,dm 
ession system 
roach, each s a
ܨ
udio frame. T h
ܧൌට
playback an d
and the recor d
ࡱ࢖ൌ൛ ܧ௣ሺݐሻǡܧ
ࡱࡾൌሼܧோሺݐሻǡܧ
es not echo. E
hus, the echo 
emote user is s
real situatio n
ic, the echo s u
es not consid e
rding has an A
cancel the rea l
ned. The cond i
disabling the e
Echo
ample value i s
ܨൌሼ ܵଵǡܵଶǡܵଷ
he energy of e
ටܵଵଶ൅ܵଶଶ൅ܵ
d recording, n u
ding frame e n
ܧ௣ሺݐെͳሻǡܧ௣ሺ
ܧோሺݐെͳሻǡܧோ
Even recordi n
suppressor is 
speaking. A p
n in human c o
uppressor is e n
er the effect o
A/D converter 
l voice, not t h
itional equati o
echo suppres s
o suppressorEcho/Sp e
classifier
sS, and the e
ଷǡǥǡ଼ܵ଴ሽach frame is
ܵଷଶ൅ڮ൅଼ܵ଴ଶ
umerous situ a
nergy isܧ ோ.A
ሺݐെʹሻǡǥǡܧ ௣
ሺݐെʹሻǡǥǡܧோ
ng data conta i
disabled in t h
person who is
ommunicatio n
nabled in this f time delay. and the play
b
he echo. Ther e
on is modifie d
sor.
MS
eech 
energy of eac h
ations and rul
Audio frame e
௣ሺݐെ݊ሻൟ
ோሺݐെ݊ሻሽn an echo el
e
his situation.speaking the
n. One speaksituation. In Android a
u
back has D/A 
efore, the tim e
d as follows:
MicrophoneSpeaker
h frame is E.
es can be co
n
energy is a s e
ement, but ar e
y does not h e
s while the o
udio devices, converter. T
h
e delay betwe eEach frame 
ncluded. The 
equence that 
e masked by 
ear the voice 
other listens. audio is not 
he time delay 
en recording 91  Ming-Che Yeh et al.  /  AASRI Procedia   8  ( 2014 )  88 – 92 
2. Ifܧ௉ሺݐሻ൐ܧோሺݐെܦሻ , enabling the echo suppressor. D is the time delay between sound playback an d recording. The impulse response of playback and recording is presented in Fig. 3. 
Fig.3. Echo response. 
Fig.4. Echo suppressor envelope. 
The echo response could be determined in this study, and an adverse echo response was generated accordingly. The involved equation can be modified as follows: 1. If
ܧ௉ሺݐሻ൑ܧݎோሺݐെܦሻ , disabling the echo suppressor. 2.If
ܧ௉ሺݐሻ൐ܧݎோሺݐെܦሻ , enabling the echo suppressor envelope function. Where r is the rate of decay in echo, ½ሾǤሿ is the echo suppressor envelope, D is the time delay, and ƫ[.] is the norm
 alized response from h[.].3. Experiment results 
Fig.5. Voice in playback 
92   Ming-Che Yeh et al.  /  AASRI Procedia   8  ( 2014 )  88 – 92 
Fig.6. Voice in recording 
Fig.7. Voice recorded through the echo suppressor 
Fig. 5 shows the original playback voice. Fig. 6 depicts the microphone recording, which contains some echoes. Evidently, as shown in Fig. 7, the playback ec ho was cancelled and disappeared. The experimental result shown in Fig. 7 confirms the high performance of the proposed approach. 4. Conclusion This study analyzed the acoustic echo for Android-platform VoIP. A simple acoustic echo cancellation m
ethod is proposed. The experimental results confirm high performance. References [1] J. Benesty, T.Gänsler, D.R. Morgan, M. M. Son dhi, and S.L. Gay 2001. Advances in Network and Acoustic Echo Cancellation [2] Eberhard Hänsler, and Gerhard Schmidt 2004. Acoustic echo and noise control: a practical approach. 
