 AASRI Procedia   6  ( 2014 )  34 ‚Äì 40 Available online at www.sciencedirect.com
2212-6716 ¬© 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).Peer-review under responsibility of Scientific Committee of American Applied Science Research Institutedoi: 10.1016/j.aasri.2014.05.006 ScienceDirect
2013 2nd AASRI Conference on Computational Intelligence and Bioinformatics 
A Novel Improved Truncated Unscented Kalman Filtering Algorithm
Chao Hou, Liang-qun Li* 
ATR Key Laboratory, Shenzhen University, Shenzhen, GuangDong 518060, P.R.China 
Abstract 
For the conventional truncated unscented Kalman filtering (TUKF) algorithm requires the measurement to be a bijective function, a novel improved truncated unscented Kalman filtering is proposed. In the proposed algorithm, we linearize the bijective measurements function based on the statistical linear regression (SLR) in order to obtain the only inverse function of the measurement function. It is a modified algorithm which extends the range of practical application of the filtering problems. Finally, the experiments show that th
 e performance of the proposed algorithm is better than the unscented Kalman filter (UKF) and the quadrature Kalman filter (QKF). This approach can efficiently deal with this problem that measurement functions are not bijective.  
¬© 2013 Published by Elsevier B.V. Selection and/or peer review under responsibility of American Applied Science Research Institute 
Keyword: Truncated Unscented Kalman Filtering; Statistical Linear Regression; Linearization of the Measurements Function 
1. Introduction Estimation refers to estimate the parameters or some  state variables from the observed data with random error. Filtering is estimating the current signal value of the state of the process by the observed value from real time indirect measurement. The optimal approximation to the non linear filtering problem demands a complete 
* Corresponding author. Tel.: +0-755-2673-2055; fax: +0-755-2673-2049. E-mail address: lqli@szu.edu.cn. 
¬© 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).Peer-review under responsibility of Scientific Committee of American Applied Science Research Institute35  Chao Hou and Liang-qun Li  /  AASRI Procedia   6  ( 2014 )  34 ‚Äì 40 
representation of the obtained posterior distribution. For most problems the posterior probability density function (PDF) of the state is difficult to handle so approximations are required which involves two steps: prediction and update 
[1] .UKF approximates the nonlinear distribution through deterministic sam pling to capture the Gaussian  variables with covariance and mean. The accuracy and stability is superior to EKF. UKF is increasingly concerned and has been widely used. The truncated Kalman filter (TKF) proposes a modified prior PDF in the Kalman filtering process, which improves th e performance of Kalman filtering effectively. TUKF approximates the TKF when the measurements are informativ e. The main limitation of TUKF is that it requires the measurement function of the state be bij ective. This paper modifies the limitations of TUKF algorithm using SLR for linearization of measurement functions. The simulations show that the computation of the presented algorithm is equivalent to other Gaussian approximation, but the filtering performance is better than other filtering method.  The outline of this paper is arranged as follows. In Section 2, the nonlinear model of Kalman filtering is presented. In Section 3, a novel improved truncated unscented Kalman filtering is present, including the principle and concrete steps of the algorithm. The experiment and analysis are provided in Section 4.  2. Kalman Filter for Nonlinear Environment Consider a discrete nonlinear system, we assume the measurement equation as follows: 
k kkw x h z  ) (                                                                                                                                             (1) where 
xnkR x¬èdenotes the system state, znkR z¬è denotes the measurement of the system, ) (¬òhdenotes a known nonlinear function, the measurement noise 
kw is presumed to be Gaussian with covariance ) (k Ri and zero mean. We suppose
) (0¬òp the prior distribution of kx, the MMSE k kx|ÀÜ and covariance k kP|of kxgiven kz
are[2]:
] [ÀÜ|k kk k z x E x                                                                                                                                              (2) 
] )ÀÜ)(ÀÜ( [||| kTk k k k k k k k z x x x x E P                                                                                                                   (3) Calculating 
k kx|ÀÜ and k kP| directly is very difficult due to the integration. Kalman filtering provides the linear MMSE estimator of 
kx given kz,0 ,ÀÜux[3] 
)ÀÜ(ÀÜ ÀÜ011 | , 1 | , 1 | , 0 , | , 0 ,z z P P x xk k kzzk kxzk k p k k u   
                                                                                                   (4) Where 
¬≥  kk kkdxx p x z E z E z) ( ] [ ] [ÀÜ0 0                                                                                                                  (5) 36   Chao Hou and Liang-qun Li  /  AASRI Procedia   6  ( 2014 )  34 ‚Äì 40 
¬≥     kkTkkkk kzz dxx p x z z z z E z P) ( ] | )ÀÜ)(ÀÜ[(] cov[000 1 | ,                                                                                              (6) 
¬≥     kkTk p k k kk kxz dxx p x z z x x E z x P ) ( ] | )ÀÜ)(ÀÜ[(] , cov[000 , 1 | ,                                                                         (7) where 
1 | , 0 ,ÀÜk k p x denotes the mean of the prior probability of kx.Then the updated covariance can be estimated as follows 
Tk kxzk kzzk kxzk k p k k uP P P P P1 | ,11 | , 1 | , 1 | , 0 , | , 0 ,                                                                                                           (8) where
1 | , 0 ,k k p P  is the covariance of the prior probability. 3. Modified Truncated Unscented Kalman Filter 3.1. Truncated unscented Kalman filter Consider a discrete nonlinear system, we assume the measurement equation as follows: 
k kkw a h z  ) (                                                                                                                                            (9) where 
) (¬òh is the nonlinear function of ka. Supposing ) (¬òh is bijective and the PDF of the additive noise is bounded, then the joint prior PDF
) (2¬òp is defined based on ) ; (1k kz x pand ) (0kx pas follows[5]:
) ( ) 1 ( ) ; ( ) ; (0 0 1 0 2 k k k k k x pz x p z x pD D                                                                                                           (10) where
] 1 , 0 [0¬èD . Suppose 1 ,ÀÜpx and 
1 ,pPdenote the mean and covariance matrix of ) (1¬òp respectively, the updated covariance and mean is 
0 ,1 ,2 ,ÀÜ) 1 (ÀÜ ÀÜuuuxx xD D                                                                                                                                  (11) 
] )ÀÜ ÀÜ)(ÀÜ ÀÜ()[1 ( ] )ÀÜ ÀÜ)(ÀÜ ÀÜ( [2 , 0 , 2 , 0 , 0 , 2 , 1 , 2 , 1 , 1 , 2 , Tu u u u u Tu u u u u u x x x x Px x x x P P         DD                                                             (12) where 
] ) 1 ( [1 000H D DDD  , ] 1 , 0 [¬èD  maintains the degree of freedom of 0D. The detailed derivation of the TUKF algorithm can be found in [6]. 3.2. Approximation of 
) (1kz h
To approximately compute ) (1
kz h, our purpose is to get a linear estimation of kz,k k k kd x H z  ÀÜ, where 
kH is a matrix andkdis a vector. They are depend on the minimum of  the mean-squared error [7] using SLR 
) ( min arg } , {kTk k ka a Ed H                                                                                                                       (13) 
11 11] ))(( [ ] ))(( [    u     ¬¶¬¶Tk k k kmllT Tk k k kmllxxTxzkx x x x wz z x x w P P H
l l l l                                                                  (14) 
k k k kx H z d                                                                                                                                             (15) 37  Chao Hou and Liang-qun Li  /  AASRI Procedia   6  ( 2014 )  34 ‚Äì 40 
3.3. Modified truncated unscented Kalman filtering algorithm Assume at time
1kthat the mean1 | 1 ÀÜ k kxand variance1 | 1 k k Pof the state is known, and the process noisekwand the measurement noise 
kvare independent, whose means are zero and covariances are kQandkR. Our objective is approximately calculate the first two moments
k kx|ÀÜandk kP|of the posterior PDF k kz x p: 1|based on the current measurement
kz.3.3.1. Unscented transformation and time update According t
o the reference [6], we can first obtain 
1 2  an N sigma pointsN02010..., ,O O O and the associated weights
Nw w w,..., ,2 1 using UT[8], wherew v x an n n n   , The one-step predicted sigma points are acquired using the nonlinear state function
) (¬òf:
Ni fiik k, , 2 , 1),(01 | , 0   OF                                                                                                                 (16) Therefore, the first two moments of the predicted PDF 
1 : 1 0|k kz x p can be approximated as  
ik kNiik k pwx1 | , 011 | , 0 , ÀÜ ¬¶ F
                                                                                                                                (17) 
¬¶
   NiTpik kpik k i kk k pxxw Q P
1 0 , 1 | , 0 0 , 1 | , 0 1 | , 0 ,)ÀÜ)(ÀÜ(FF
                                                                                                  (18) 3.3.2. Measurement update A. Update measurement based on the prior 
x p0
To approximately compute the predicted measurement1 | , 0 ÀÜk kz , the one-step predicted sigma points
^`Niik k11 | , 0 F are propagated through the measurement model ) (¬òhas follows: 
N i h zik kik k, , 2 , 1),(1 | , 01 | , 0   F                                                                                                                 (19) the predicted measurement can be estimated as  
¬¶
  Nijk kik kz wz
11 | , 01 | , 0ÀÜ
                                                                                                                                    (20) according to (19) and (20), the innovation covariance is estimated as  
¬¶
   miTk kik k k k ik k ik k kzzz z z z w R P
1 1 | , 0 1 | , 0 1 | , 0 1 | , 0 1 | ,)ÀÜ)(ÀÜ(
                                                                                     (21) the cross covariance is calculated as 
¬¶
  miTk kik kk k p ik k i k kxzz z xwP
1 1 | , 0 1 | , 0 1 | , 0 , 1 | , 0 1 | ,)ÀÜ)(ÀÜ( F
                                                                                       (22) the error covariance is computed as 
Tk k pik k k k p ik kmiik kxxxx wP )ÀÜ)(ÀÜ(1 | , 0 , 1 | , 0 1 | , 0 , 1 | , 0 11 | ,   ¬¶ FF
                                                                                              (23) 38   Chao Hou and Liang-qun Li  /  AASRI Procedia   6  ( 2014 )  34 ‚Äì 40 
Consequently, according to (21-23), the first two moments of the posterior PDF k kz x p: 1 0|based on the prior
x p0can be approximately computed as follows: 
)ÀÜ(ÀÜ ÀÜ1 | , 011 | , 1 | , 1 | , 0 , | , 0 ,   k k k k kzzk kxzk k p k k uz z P P x x                                                                                              (24) 
Tk kxzk kzzk kxzk k p k k uP P P P P1 | ,11 | , 1 | , 1 | , 0 , | , 0 ,                                                                                                    (25) B. Measurement update based on the modified prior According to (14) and (15) in section 3.2, the linear regression coefficients
kHandkdcan be computed by using the (22-23) as 
11 | , 1 | , k kxxTk kxzkP P H                                                                                                                             (2 6)
1 | , 0 ,1 | , 0ÀÜÀÜ  k k p kk kkx H z d                                                                                                                          (27) Then, the measurement equation (1) can be written as a linear function: 
k k k k k k k w d x H w x h z     ) (                                                                                                                     (28) The first two moments
1 | , 1 , ÀÜk k p xand1 | , 1 ,k k p Pof x p1 can be approximately computed as 
¬ª¬º¬∫¬´¬¨¬™ 1 ,1 ,1 | , 1 , ÀÜ
bak k pxPP                                                                                                                                        (29) 
1 ,aP in (29) can be approximately calculated as 
k k k k k k k k a d z H z hdaz a p a     ¬≥) ( ) ; (1 11 ,P                                                                                               (30) 
¬ª¬ª¬º¬∫¬´¬´¬¨¬™ ¬¶ ¬¶¬¶ ¬¶1 ,1 ,1 ,1 ,1 | , 1 ,) (bTababak k pP
                                                                                                                      (31) where 
1 ,bP,¬¶1 ,a¬¶1 ,band¬¶1 ,abcan be computed according to [6]. Since the sigma points
^`iiw,0O  do not reflect the uncertainty due to the modified prior x p1, we draw 
Nsigma points Nk kk k k k1 | , 121 | , 111 | , 1, , ,F F Fwith the associated weights Nw w w,...... ,2 1 using the UT based on the mean
1 | , 1 , ÀÜk k p x and variance1 | , 1 ,k k p P. The predicted measurement and covariance is similar to the (19-23), then the first two moments of the posterior PDF
k kz x p: 1 1|based on the prior x p1can be approximately computed as follows: 
)ÀÜ(ÀÜ ÀÜ1 | , 111 | , 1 1 | , 1 1 | , 1 , | , 1 ,  k k k k kzzk kxzk k p k k uz z P P x x                                                                                     (32) 
Tk kxzk kzzk kxzk k p k k uP P P P P1 | , 111 | , 1 1 | , 1 | , 1 , | , 1 ,                                                                                                 (33) Finally, the update mean and covariance are 
k k uk k u k kxx x| , 0 ,| , 1 ,|ÀÜ) 1 (ÀÜ ÀÜD D                                                                                                                        (34) 
> @Tk k k k u k k k k u k k u Tk k k k u k k k k u k k u k kx x x x P x x x x P P )ÀÜ ÀÜ)(ÀÜ ÀÜ( ) 1 ( ] )ÀÜ ÀÜ)(ÀÜ ÀÜ( [| | , 0 , | | , 0 , | , 0 , | | , 1 , | | , 1 , | , 1 , |          DD                         (35) Where 
) ( ) 1 ( ) () (0 , 0 ,0 ,a aatrtrtr¬¶   ¬¶¬¶ JJJD can be found in [6]. 39  Chao Hou and Liang-qun Li  /  AASRI Procedia   6  ( 2014 )  34 ‚Äì 40 
4. Simulation Results In this section, we present the result using a nonlinear model. The DSS equations for this model can be written as 
kw tx x x x f         ) 2 . 1 cos( 8 ) 2 ^ 1/( 255 . 0 ) (
¬Ø¬Æ¬≠!  d  30, 2 * 5 . 030, * 2 . 0) (32k v xk v xx hkk
where) 5 , 0 ( ~),1 , 0 ( ~N v N wkk . Data were produced using 2 , 0 , 1   NED .We compare the performance of the improved TUKF with UKF and QKF using Monte Carlo simu lation with 100 runs. The estimation of the state using improved TUKF, UKF, QKF and the real state are present in Fig.1. 
0 10 20 30 40 50 60-25-20-15-10-50510152025
The real state
UKF
QKF
improved TUKF
Fig. 1. The Mean and Covariance 
0 10 20 30 40 50 60024681012141618
UKF
QKF
improved TUKF
Fig.2. The Performance of Filters 
The MSE of UKF, QKF and improved TUKF are shown in Fig.2. We should realize that the mean and covariance of improved TUKF is lower than UKF and QKF. The performance of improved TUKF is higher than other filters.  Finally, in order to take into account the influence of parameters in the algorithm, we change the value of the covariance of measurement noise 
Q and process noise R, the performance of algorithm is shown in table 1. 
Table 1. The mean and covariance of filters for different process noise parameters parameters Improved TUKF QKF UKF 
Mean Covariance Mean Covariance Mean Covariance 40   Chao Hou and Liang-qun Li  /  AASRI Procedia   6  ( 2014 )  34 ‚Äì 40 
1 , 1  R Q 3.6121 14.7504 8.0247 22.7289 17.6235 481.5755 
2 , 1  R Q 3.741 15.2822 6.8923 8.0638 13.8717 150.0981 
3 , 1  R Q 3.7263 15.1242 6.8689 9.9092 9.6105 39.892 
4 , 1  R Q 3.7361 13.8912 7.6627 9.5067 9.0108 22.202 
5 , 1  R Q 3.6858 13.3754 7.0458 7.7285 7.3666 11.5767 
According to the simulation results above, it is clear that the function of the algorithm is preferable if the measurement noise is larger. However, if the process noise is smaller, the results is not good enough, even the performance of improved TUKF is not as good as UKF and QKF. 5. Conclusions The proposed algorithm linearizes the measurement function using SLR based on TUKF for the nonlinear filtering. It can deal with the situation when the measurement is not bijective. On this condition the algorithm extends the range of application of the filter. Simulations show that in general, the improved TUKF performs better than UKF and QKF. Acknowledgements This work was supported by the National Natural Science Foundation of China (61301074, 61271107), Research Fund for the Doctoral Program of Higher Education of China (20104408120001), Natural Science Foundation of the Guangdong Province of China (S2012010009417), Key Project of National Science & technology of pillar program (2011BAH24B12). References [1] M. Arulampalam, S. Maskell, N.Gordon, and T. Clapp, ‚ÄúA tutorial on particle Filter for online nonlinear/non-Gaussian Bayesian tracking,‚Äù IEEE Trans. Signal Process., vol. 50, no. 2, pp.174-188,Feb.2002. [2]Y. Bar-Shalom, T. Kirubarajan , and X. R. Li, Esti mation with Applications to Tracking and Navigation . Hoboken, NJ: Wiley, 2001. [3] S. M. Kay, Fundamentals of Statistical Signal Processing: Estimation Theory. Englewood Cliffs, NJ: Prentice-Hall, 1993. [4] K. Burdett, ‚ÄúTruncated means and variances,‚Äù Econ. Lett., vol. 52, pp.263‚Äì267, 1996. [5] A. F. Garc√≠a-Fern√°ndez, M. R. Morelande, and J. Grajal, ‚ÄúN onlinear filtering update phase via the single point truncated unscented Kalman filter,‚Äù in Proc. 14th Int. Conf. Inform. Fusion, 2011, pp. 17‚Äì24. [6] √Ångel F.Garc√≠a-Fern√°ndez, Mark R.Morelande, Jes√∫s GrajalÀà‚ÄúTruncated Unscented Kalm
an FilteringÀà‚Äù IEEE Trans. Signal Process., vol. 60, no. 7,July 2012. [7]Ienkaran 
Arasaratnam, Simon Haykin, ‚ÄúDiscrete-Time Nonlinear Filtering Algorithms Using Gauss‚Äì Hermite Quadrature,‚Äù PROC.IEEE,vol.95,no.5,May 2007. [8] S. J. Julier and J. K. Uhlmann, ‚ÄúUnscented filtering and nonlinear estimation, ‚ÄùProc. IEEE, vol. 92, no. 3, pp. 401‚Äì422, Mar. 2004. 