Array 19 (2023) 100302
Available online 8 July 2023
2590-0056/© 2023 The Authors. Published by Elsevier Inc. This is an open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-
nc-nd/4.0/ ).An optimized hybrid methodology for non-invasive fetal electrocardiogram 
signal extraction and monitoring 
Theodoros Lamprosa, Konstantinos Kalafatakisa,b, Nikolaos Giannakeasa, 
Markos G. Tsipourasc, Euripidis Glavasa, Alexandros T. Tzallasa,* 
aHuman-Computer Interaction Laboratory, Department of Informatics and Telecommunications, School of Informatics and Telecommunications, University of Ioannina, 
47100, Arta, Greece 
bInstitute of Health Sciences Education, Barts and the London School of Medicine & Dentistry, Queen Mary University of London (Malta Campus), Triq L-Arlcisqof Pietru 
Pace, VCT 2520, Victoria (Gozo), Malta 
cDepartment of Electrical and Computer Engineering, School of Engineering, University of Western Macedonia, 50100, Kozani, Greece   
ARTICLE INFO  
Keywords: 
Fetal electrocardiogram 
ICA 
EMD 
Wavelet thresholding 
Signal quality indices 
Correlation analysis ABSTRACT  
Background and objective: Electronic fetal heart monitoring is currently used during pregnancy throughout most 
of the developed world to detect risk conditions for both the mother and the fetus. Non-invasive fetal electro -
cardiogram (NI-fECG), recorded in the maternal abdomen, represents an alternative to cardiotocography, which 
could provide a more accurate estimate of fetal heart rate. Different methodologies, with varying advantages and 
disadvantages, have been developed for NI-fECG signal detection and processing. 
Methods: In this context, we propose a hybrid methodology, combining independent component analysis, signal 
quality indices, empirical mode decomposition, wavelet thresholding and correlation analysis for NI-fECG 
optimized signal extraction, denoising, enhancement and addressing the intrinsic mode function selection 
problem. 
Results: The methodology has been applied in four different datasets, and the obtained results indicate that our 
method can produce accurate fetal heart rate (FHR) estimations when tested against different datasets of variable 
quality and acquisition protocols, on the FECGDARHA dataset our method achieved average values of Sensitivity 
98.55%, Positive Predictive Value 91.73%, F1 94.92%, Accuracy 90.91%, while on the ARDNIFECG 
dataset it achieved average values of Sensitivity 92.96%, Positive Predictive Value 91.66%, F1 93.60%, 
Accuracy 90.45%. 
Conclusions: The proposed methodology is completely unsupervised, has been proven robust in different signal- 
to-noise ratio scenarios and abdominal signals, and could potentially be applied to the development of real-time 
fetal monitoring systems.   
Credit author statement 
Conceptualization, Thodoris Lampros, Konstantinos Kalafatakis, 
Nikolaos Giannakeas, Markos Tsipouras, Euripidis Glavas and Alexan -
dros Tzallas; Data curation, Thodoris Lampros, Markos Tsipouras, 
Alexandros Tzallas; Formal analysis, Thodoris Lampros, Markos Tsi-
pouras and Alexandros Tzallas; Funding acquisition, Alexandros Tzallas; 
Investigation, Thodoris Lampros, Konstantinos Kalafatakis, Nikolaos 
Giannakeas, Markos Tsipouras, Euripidis Glavas, and Alexandros Tzal-
las; Methodology, Thodoris Lampros, Konstantinos Kalafatakis, Nikolaos Giannakeas, Markos Tsipouras, Euripidis Glavas and Alexandros Tzallas; 
Project administration, Alexandros Tzallas; Software, Thodoris Lamp -
ros; Supervision, Konstantinos Kalafatakis, Nikolaos Giannakeas, Mar-
kos Tsipouras, Euripidis Glavas and Alexandros Tzallas; Validation, 
Nikolaos Giannakeas and Alexandros Tzallas; Visualization, Alexandros 
Tzallas; Writing – original draft, Thodoris Lampros, Konstantinos Kala-
fatakis, Nikolaos Giannakeas, Markos Tsipouras, Euripidis Glavas and 
Alexandros Tzallas; Writing – review & editing, Thodoris Lampros, 
Konstantinos Kalafatakis, Nikolaos Giannakeas, Markos Tsipouras, 
Euripidis Glavas and Alexandros Tzallas. 
*Corresponding author. Department of Informatics & Telecommunications School of Informatics & Telecommunications University of Ioannina Kostakioi, GR- 
47100, Arta Greece 
E-mail address: tzallas@uoi.gr (A.T. Tzallas).  
Contents lists available at ScienceDirect 
Array 
u{�~zkw! s{yo|kr o>!ÐÐÐ1�mtoz mont~om�1m{ y2u{�~zkw2k ~~kÞ!
https://doi.org/10.1016/j.array.2023.100302 
Received 14 November 2022; Received in revised form 20 June 2023; Accepted 24 June 2023   Array 19 (2023) 100302
21.Introduction 
Prenatal cardiac monitoring is an extremely important aspect in the 
early detection of pathological conditions of the fetus. Electronic fetal 
heart monitoring is currently used in most of the developed world to 
detect risk conditions for both mother and fetus. The main goals are to 
rule out possible conditions that could lead to fetal morbidity or even 
death. Early and more effective detection of fetal abnormalities can help 
obstetricians and pediatric cardiologists prescribe appropriate medica -
tions in a timely manner or take necessary precautions during delivery 
or after birth. The main purpose of fetal monitoring during childbirth is 
the early recognition of intrauterine hypoxic infection, to lead the 
clinician to timely intervention to avoid any complications in the health 
of the fetus. Suffocation during childbirth causes 10–15% of all cases of 
cerebral edema in newborns [1]. Modern methods of assessing and 
monitoring the general condition of the fetus help to significantly reduce 
the risk of endometrial death by suffocation and the risk of giving birth 
to a newborn with respiratory problems. 
Non-invasive fetal electrocardiogram (NI-fECG), recorded in the 
maternal abdomen represents an alternative to cardiotocography, which 
could provide a more accurate estimate of fetal heart rate. Moreover, 
electrocardiographic fetal heart activity could be obtained by studying 
the morphology of the ECG. However, the fetal ECG (fECG) is difficult to 
be extracted by the mixed abdominal signal, mainly due to the poor 
signal-to-noise ratio (SNR), which has limited its use to date. Noninva -
sive fetal ECG has some limitations and potential problems that should 
be considered.  
≡Signal quality: Noninvasive fetal ECG signals can be affected by 
maternal and fetal movements, uterine contractions, and other 
external interferences. This can lead to poor signal quality and affect 
the accuracy of the measurements.  
≡Gestational stage limitations: Noninvasive fetal ECG is generally 
more accurate in the later stages of pregnancy when the fetus is 
larger and has a stronger signal. In early gestational stages, the signal 
can be weak, and the accuracy of the measurements can be affected.  
≡Fetal position: The position of the fetus can affect the quality of the 
noninvasive fetal ECG signal. For example, if the fetus is in a breech 
position, the electrodes may not be able to pick up the signal 
effectively.  
≡Interference with other devices: The use of other electronic devices 
such as cell phones or wireless networks in close proximity to the 
fetal ECG device may interfere with the signal quality. 
After the Covid-19 pandemic, it became evident that there was a 
need to advance the digitization of prenatal healthcare further. In a 
recent study [2], pregnant women reported that the frequency of their 
regular checkups was cut back during the pandemic. They frequently 
changed hospitals and doctors to receive proper prenatal care and 
advice. The increasing sophistication of technologies for monitoring 
fetal well-being during gestation, though still requiring improvement, 
enables more comprehensive prenatal care for women across a broader 
range of circumstances. Fetal ECG monitoring can help detect potential 
complications earlier, reduce the need for unnecessary in-person visits, 
and provide timely interventions or guidance when necessary. 
Recently developed fetal monitoring systems utilizing noninvasive 
fetal electrocardiography have become commercially accessible to 
expectant parents as alternatives to conventional prenatal care practices 
[3,4]. Some other alternative monitoring systems [5,6], which allow for 
the remote collection and real-time sharing of critical maternal and fetal 
biometrics, include the beltless pod and patch duo transmitting elec-
trocardiographic (ECG) and electromyographic (EMG) data signaling 
fetal and maternal heart rates and uterine action. While there have been 
advancements in the development of fetal ECG monitoring devices, the 
analysis and interpretation of the recorded abdominal ECG signals can 
still be challenging due to the abovementioned reasons. 2.Motivation for our hybrid approach 
Developing robust and efficient signal processing techniques for 
extracting fetal ECG signals from noisy recordings remains a research 
challenge. Noise from maternal ECG, uterine contractions, and move -
ment artifacts can significantly affect the quality of the fetal ECG signal. 
Further research is needed to improve the accuracy of signal processing 
algorithms for better fetal ECG extraction. Although currently, available 
fetal electrocardiogram monitoring systems have primarily focused on 
temporary, short-term surveillance, An overhaul of the current ap-
proaches to investigating fetal heart function will be necessary if we are 
to engineer unobtrusive technologies sophisticated enough to scrutinize 
cardiac rhythms indefinitely, allowing for continuous evaluation of the 
developing heart ’s pulsations over protracted intervals, such as during 
precarious gestations or when congenital anomalies are suspected. 
Accurate acquisition of the fetal cardiac signal is an open problem 
consisting of two main aspects. i) Extraction of the raw fetal ECG 
component from abdominal recordings and ii) Denoising the extracted 
fECG in order to improve SNR and enhance fetal heart rate (FHR) 
detection. In the context of fECG extraction, signal processing tech-
niques such as Template Subtraction [7–9], Blind Source separation 
(BSS) [10–12], Adaptive Filtering [13–16], Artificial Neural Networks 
[17,18] have been proposed in the literature. In order to denoise and 
enhance the fECG, some of the most common approaches are Empirical 
Mode Decomposition (EMD) [19–21], Wavelet-Based denoising (WD) 
[22–24] and Extended Kalman Smoothing (EKS) [25,26]. Hybrid 
methods [27–30], a combination of adaptive and non-adaptive tech-
niques can provide improved results compared to the use of only one 
technique, albeit at the cost of increased computational complexity. 
Independent Component Analysis [31] is a signal decomposition 
technique frequently used in fECG extraction [31–33]. ICA extracts 
statistically independent sources (called independent components- IC’s) 
from a set of recorded signals. In the ICA method, the mixture is modeled 
as a matrix, which is considered unchangeable during the process. This 
is related to the assumption that the mixed signals are stationary. 
However, physiological processes often produce mixtures of multivar -
iate signals that are not stationary [34], and therefore, their proportions 
in the mixture can change over time, although the mixing matrix can be 
considered stationary for short time periods [35]. In a fECG extraction 
scenario, this could lead to the fetal component being corrupted and not 
useful for further processing. 
Since its introduction, Empirical Mode Decomposition (EMD) [36] 
has widely been used to denoise non-linear and nonstationary mixed 
signals. In EMD based techniques, signals are decomposed into a set of 
oscillatory components, which are called intrinsic mode functions (IMF). 
Denoising in the EMD domain translates into a partial reconstruction of 
the signal using only IMFs containing useful information and rejecting 
IMFs that carry mainly noise. Determining and removing the 
noise-dominant IMF’s is the core process of denoising a signal using 
EMD, however the IMF selection problem remains a subject of research 
until this day, mostly due to mode mixing, which can be described as the 
occurrence of very different oscillations in one mode, or very similar 
oscillations in different modes [37]. 
This work introduces a hybrid algorithm based on the above- 
mentioned techniques and several optimizations that enable real-time, 
continuous, and efficient monitoring of fetal status. Our goal is to 
facilitate the development of robust automated fetal monitoring systems 
for remote assessment in several stages of pregnancy. 
3.Materials and methods 
The algorithm proposed in this work consists of two distinct pipe-
lines. In the extraction stage, Independent Component Analysis (ICA) is 
applied on the mixed abdominal signal to separate the maternal, fetal 
and noise components and the produced Independent Components (IC) 
are assessed using fetal signal Quality Indices. In the denoisisng stage the T. Lampros et al.                                                                                                                                                                                                                                Array 19 (2023) 100302
3selected raw fetal ECG (rfECG) is decomposed into Intrinsic Mode 
Functions (IMF ’s) using Empirical Mode Decomposition, and undesired 
artifacts, such as baseline wander and high frequency noise, are 
removed by Wavelet thresholding. Finally, we introduce an algorithm- 
based correlation analysis to detect the optimal IMF subset, and the 
fetal ECG signal is reconstructed from the selected IMF’s. 
Our proposed hybrid method introduces several improvements in the 
application of the techniques, which allow for high-quality fetal ECG 
acquisition from abdominal recordings. In the extraction stage, we 
proposed the application of signal quality indices (sQi’s) that take into 
account the linear and non-linear characteristics of the fetal ECG. These 
indices can identify if the ICA algorithm has achieved an accurate sep-
aration of the fetal component and determine if the fetal ECG extracted 
is suitable for further processing. Also, they provide an automatic 
method for the selection of the fetal ECG, something that was mostly 
achieved through visual inspection of the IC’s. To further enhance the 
extracted fetal ECG signal we introduced a novel combination of 
Empirical mode Decomposition with Wavelet Thresholding that can 
successfully remove the residue maternal ECG (mECG) presence. The 
application of Wavelet Transform in the EMD domain is proven to 
greatly enhance Fetal Heart Rate (FHR) estimation even in low SNR 
scenarios. We also addressed a significant issue with Empirical Mode 
Decomposition which is the IMF selection problem, by introducing a 
novel correlation algorithm that can determine which IMF’s should 
contribute in reconstructing the enhanced fetal ECG. Finally, we pro-
vided quantitative data that demonstrate the importance of accurate 
selection of the intrinsic functions derived from EMD in improving FHR 
estimation. The improved hybrid method that is proposed in this work is 
proven to be robust in producing highly accurate FHR estimations when 
dealing with abdominal ECG recordings of varying quality and acqui -
sition protocols. Furthermore, the low computational complexity of our 
algorithm makes it suitable for real-life fetal ECG monitoring applica -
tions. An overview of the method can be seen in Fig. 1. 3.1. extraction 
To extract the raw fetal ECG from the mixed-channel abdominal 
signal we employed a technique based on Blind Source Separation for 
component separation and Signal Quality Indices to verify that the 
selected fetal component is of sufficient quality for accurate FHR 
estimation. 
3.1.1. independent component analysis 
The Blind Source Separation problem in the context of ECG signals 
can be described as: suppose an ECG recording consists of p channels, 
and suppose p independent channels s1tCs2t…Csptand respectively 
p observed mixed signals m1tCm2tCBBBCmpt. The observed signals m(t) 
are a linear combination: 
mit̂p
j1aijsjtCi1C2…pCaij∃RB (1) 
Using array notation, the set of m equations of the above form is 
equivalent to: MASCwhere Ss1tCs2tC…CsptT is a vector col-
umn representing the source signals, Mm1tCm2tC…CmptT a 
corresponding vector representing the observed signals and A is the p×
p mixing matrix. 
Independent Component Analysis (ICA) algorithms estimate the 
unmixing matrix W by exploiting the non-Gaussianity of the individual 
signals. The purpose of ICA is to carry out a transformation that will 
separate the mixed signal recorded in the abdomen in its distinct com-
ponents, which, in the context of fECG extraction, include the fetal 
signal, the maternal ECG and various residual noise signals. 
In order to extract the raw fetal ECG, the FastICA algorithm was 
employed (Fig. 2). Typically, the FastICA algorithm can be described in 
the following steps. 
Fig. 1.Overview of the proposed method.  T. Lampros et al.                                                                                                                                                                                                                                Array 19 (2023) 100302
4≡Centering: Normalization of the signals so they have zero mean and 
unit variances.  
≡Whitening: Using a linear transform like Principal Component 
Analysis (PCA) to obtain the matrix ZVX where V is a whitening 
matrix such that E⊔ZZT⊓I. The total unmixing matrix is then W← 
WV.  
≡Choose initial vectors wi to form WB
≡Iteration: after the pre-processing of the data, an iterative algorithm 
is used to detect the independent elements.  
 Update w: wi←E⊔zfwiTz⊓ E⊔zfwiTz⊓wiCwi∃kWCz∃Z.  
 Orthogonize w: wi←wi ⋃i 1
j1wiTwjwjwi∃kWB
 Normalize w: wi←wi
‡wi‡Cwi∃WB
3.1.1.1. signal quality indices. The performance of the ICA algorithm in 
fECG recordings can be greatly hindered by the assumption of a sta-
tionary composite signal. In real life scenarios, fetal movements that 
occur inside the uterus can lead to a variation in the position of the fetal 
heart in respect to the abdominal electrode positions [38]. These 
amplitude modulations can potentially obstruct the performance of the 
ICA process and the quality of the separated signals can be reduced. 
Furthermore, ICA application on the four abdominal channels results in 
four IC’s, consisting of the fetal and maternal signal in addition to re-
sidual signals containing various noise artifacts. However, there is no 
certain order in which the IC’s are derived from the algorithm which, in 
most cases leads to a need for visual inspection of the produced IC’s to 
identify the fetal component. In order to assess the accuracy of the 
separation algorithm and to identify the signal of interest automatically 
out of all other contaminations after ICA post-processing rather than 
depending only on visual observations, we propose the use of fetal 
Signal Quality Indices (sQi’s) proposed in the literature. The sQi’s used 
in this study are described in detail in the experiments section. 3.2. FECG denoising 
The fECG component obtained by the ICA method is not completely 
noise-free, i.e. a perfect separation is not achieved. It still contains 
several types of noise, such as electrode artifacts, baseline wander, and 
other high frequency noise that can be attributed to maternal ECG 
interference. In order to remove such artifacts that can affect further 
fECG analysis a denoising algorithm needs to be applied in the rFECG 
extracted from the abdominal channels. The proposed algorithm con-
sists of the following steps. 
Step 1.The rFECG is decomposed by EMD into their respective IMF’s. 
Step 2.The IMF’s are denoised by Wavelet soft thresholding. 
Step 3.The reference thECG which is considered to contain mainly the 
maternal signal is also denoised by Wavelet Decomposition and a soft 
thresholding function. This step is useful as it improves the correlation 
process in the next step. 
Step 4.An algorithm based on correlation analysis produces the 
optimal IMF subset. 
Step 5.After the IMF selection process, the fECG signal is recon -
structed based on the optimal IMF subset. 
3.2.1. Empirical mode decomposition 
Empirical Mode Decomposition, proposed by Huang [36], is a 
time-frequency analysis technique that produces all the oscillation levels 
contained in a signal without requiring linearity or some periodicity of 
the signal. The generated instantaneous frequencies are well defined 
(accurate estimation of information) and can be hypothetically related 
to specific physical aspects of the phenomenon under investigation. Any 
complex set of elements can be decomposed through Empirical Mode 
Decomposition into a finite and small number of intrinsic mode func-
tions (IMF). Decomposition is based on the local characteristics of the 
elements (amplitude-frequency). The basic functions of EMD are driven 
entirely by the data itself, which makes it efficient for processing 
non-linear and non-static signals. 
The EMD algorithm includes the following steps (Fig. 3).  
1. Find all maxima and minima of x(t),  
2. Interpolate all maxima to get the upper envelope curve xut. 
Respectively, all the minima in the lower envelope curve xlt.  
3. Calculate the local mean of xut, xlt, 
mtxutxlt (2)    
4. Calculate the deviations from the mean, 
dtxt mt (3) 
Two conditions must be checked for d(t).  
≡If d(t) satisfies the IMF conditions, IMF is generated. Replace x(t) 
with 
rtxt–dt (4)    
≡If d(t) is not an IMF: xtdt.  
5. Repeat steps 1 through 5 until we have a monotonic residual or a 
residual that satisfies a predefined stopping criterion. 
At the end of the process, the signal x(t) can be expressed as: 
xt̂N
i1citrNtC (5)  
where Ni represents the IMF’s and rN the residual. 
Fig. 2.Overview of the FastICA algorithm.  T. Lampros et al.                                                                                                                                                                                                                                Array 19 (2023) 100302
53.2.2. Wavelet thresholding 
Wavelet transform is a signal processing tool that is widely used in 
biomedical signal processing because of its ability to produce a sparse 
representation for many real-world signals [39]. In the context of fetal 
ECG processing wavelet transforms have been used as a denoising tool in 
the form of Wavelet Thresholding (WT) [40]. Taking into advantage the 
ability of wavelets localize data on different scales, WT can preserve 
important signal features while removing noise. Denoising a signal using 
wavelets usually consists of three main steps.  
≡The Discrete Wavelet Transform (DWT) decomposes the signal into a 
few large-magnitude wavelet coefficients called detail coefficients 
(decomposition).  
≡Wavelet coefficients which are small in value are typically noise and 
can be “shrinked ” or removed without affecting the signal or image 
quality (thresholding).  
≡After the coefficients are thresholded, the data is reconstructed using 
the inverse wavelet transform (Synthesis). 
In this work, we propose the use of WT in the EMD domain, i.e. 
applying WT to each of the IMF’s. A description of our proposed 
approach is presented in the experiments section. 
3.3. Experimental setup 
This section describes in detail the datasets used in this study as well 
as the parameters and optimizations of all the algorithms used in the 
proposed hybrid system. We also describe in detail a new method for 
identifying the most useful IMF’s that are produced after the EMD 
process. 
3.3.1. Datasets 
3.3.1.1. Simulated dataset. Simulated signals were produced using the 
fecgsyn simulator, which can create maternal-fetal ECG mixtures with 
realistic width, morphology, heart rate variability, heart rate changes and noise [41]. Two different cases are examined, namely the normal 
state of the fetus (Case 1) and the case of uterine contractions (Case 2). 
Each simulation consists of 5-min abdominal mixtures projected on 34 
channels (32 ventricular electrodes and 2 reference thoracic electrodes). 
A total of 40 simulated signals corresponding to 3.3 h of recording are 
produced, with a sampling frequency of 1 KHz (Fig. 4). 
3.3.1.2. Real datasets. To test the performance of the proposed method 
in real data, the following datasets were used: A dataset available in the 
PHYSIONET database [42], namely the Abdominal and Direct Fetal ECG 
Database (ADFECGDB) [43] from here on denoted db1, the Fetal Elec-
trocardiograms, Direct and Abdominal with Reference Heartbeats Annota -
tions (FECGDARHA ) [44] dataset, openly available in figshare repository 
[45] denoted db2 and the recently published Annotated Real Dataset for 
Non-Invasive Fetal Electrocardiography (ARDNIFECG) [46] denoted db3 
(Fig. 5). A brief description of the datasets as well as their use in this 
study is presented below.  
≡db1 contains five multichannel signals recorded in labor, between 38 
and 41 weeks of gestation. Four channels were acquired from 
maternal abdomen, and a direct electrocardiogram was recorded 
simultaneously from fetal head. The positioning of electrodes was 
constant during all recordings and the sampling rate was 1 kHz. For 
the purposes of this work, db1 was utilized to test the hypothesis that 
removal of IMF’s during the fECG reconstruction stage can provide 
an improvement in FHR estimation.  
≡db2 [41] consists of 10 recordings obtained from pregnant women 
between the 38th and 42 nd week of gestation. The recordings were 
obtained using the KOMPOREL system with a sampling frequency of 
500 Hz, and each signal duration is 20 min long. Each recording 
contains four abdominal signals after preliminary filtering and four 
indirect fECG signals after the suppression of the interfering MECG 
by subtracting the maternal PQRST complex pattern and the first 
derivative of the QRS complex. Additionally,a maternal signal con-
taining the fiducial points of the MECG is provided for each record. 
Fig. 3.Overview of the EMD algorithm.  T. Lampros et al.                                                                                                                                                                                                                                Array 19 (2023) 100302
6≡db3 [43] consists of 18 signals originated from pregnant women 
between the 21st and 27th weeks of gestation. Signals were sampled 
at 2048 Hz, with a duration of 15 s each. Each signal contains three 
differential maternal channels extracted from the thorax, and three 
unipolar abdominal leads. db2 and db3 were employed in order to 
provide quantitative results of the algorithm in terms of FHR 
estimation. 
3.3.2. System setup 
3.3.2.1. FastICA. In this work, the Independent Components (ICs) were 
extracted with a deflation approach. PCA deflation is a way to iteratively 
compute the principal components of a dataset. It starts by computing 
the first principal component and removing its effect from the data. This 
is done by projecting the data onto the first principal component and 
subtracting the resulting projection from the original data. The process 
is then repeated with the new, deflated data to compute the second 
principal component, and so on. The nonlinearity in the fixed-point al-
gorithm is calculated using the hyperbolic tangent function: 
fwtanha∗wB (6) 
The FastICA algorithm produced four components, corresponding to 
the maternal ECG, the abdominal ECG signal containing the fetal ECG 
component and a noise signal. Fig. 6 shows the output of the FastICA 
algorithm on a multichannel abdominal fetal ECG. 
3.3.2.2. signal quality indices. sQi’s can be calculated using various 
methods, such as time-domain analysis, frequency-domain analysis, and wavelet analysis. They can be used to identify low-quality signals after 
the application of the ICA. An average sQI computed from the above 
indices is used to determine if accurate fECG separation is achieved. The 
indices used in this study are.  
≡bSQi [47]: The bSQi index uses the detection of QRS complexes by 2 
detection algorithms and detects the percentage of common strokes 
in algorithms. The QRS detection algorithms used on this work are 
the JQRS detector [45], and the MaxSearch algorithm available in 
Open-Source Electrophysiological Toolbox (OSET) [46]. The index is 
then computed as: 
bSQIkNmatchedkCwENallkCwC (7)  
where Nmatched is the number of common values of the algorithms (in a 
150 m s window) and Nall is the number of all beats detected by an al-
gorithm (without double counting of the corresponding beats). bSQI 
ranges from 0 to 1. For N rhythms, there are N windows that have a 
length w 10sec., centered ±5 s around the k beat.  
≡xSQi [48]: A measure of contrast between the detected QRS complex 
and the embedded noise. Using a ~25 m s window around the po-
sition of each individual EQRS, the ECG peak range is compared to 
the signal strength within three times the window length. Therefore, 
xSQI calculates a measure representing how strong the currently 
detected beat is compared to ambient noise.  
≡kSQi: fourth moment (Kurtosis) of signal. Kurtosis is a widely used 
measure of the non-Gaussianity of a signal. When several non- 
Gaussian signals are added, the resulting mixed signal gains 
Fig. 4.Examples of signals generated with the fecgsyn simulator.  T. Lampros et al.                                                                                                                                                                                                                                Array 19 (2023) 100302
7Gaussianity over the addend signals. A high Kurtosis index would 
therefore indicate the presence of an independent signal. 
3.3.2.3. Empirical mode decomposition. To estimate the upper and lower 
envelopes we implemented the use of Hermite Polynomials, proposed in 
Ref. [49]. Hermite polynomial Interpolation can be described as such: 
:Suppose yitare the local maxima and minima of a time series at 
each given time xit, and di is the fist derivative of yi at each given time xi: didytEdxt. The rational Hermite interpolation can be con-
structed in each ⃦⃦xkCxk1C⃦⃦Ck0C1C…BN 1 as: 
skxFityiFi1tyi1GithidiGi1thi1di1B (8)  
Where hixi1 xi, tx xiEhi (9) 
And Fit, Gitare the basis functions of the rational Hermite 
interpolation. Also, after experimenting with the number of IMF’s pro-
duced to optimize the efficiency of FHR estimation, we set a stopping 
Fig. 5.Examples of abdominal signals in db3.  
Fig. 6.Output of ICA algorithm (db3).  T. Lampros et al.                                                                                                                                                                                                                                Array 19 (2023) 100302
8criterion at 10 IMF’s (Fig. 7). 
3.3.2.4. Wavelet thresholding. In this work we applied the Wavelet 
Thresholding directly in each IMF produced in the EMD domain. This 
approach takes advantage of the Fact that EMD uses data-driven basis 
functions adaptively which means that no fixed wavelet base function 
needs to be specified for the wavelet decomposition. 
Suppose that IMFnis the noisy IMF and √IMFnindicates the 
denoised IMF. Then: 
√IMFThrIMFCε (10)  
where Thr is the threshold operator and ε is the threshold value. Each 
IMF is decomposed into four levels using the seventh order Symlet 
wavelet (Sym7) [50]. The threshold value is calculated according to the 
equation: 
εσ√2logN (11)  where, σ and N denote the standard deviation and the length of the 
wavelet coefficients at a given level. We use a soft thresholding function 
as, 
Ẃi7〉
†Wi7† εiC†Wi7†≽εiC
0C†Wi7†DεiC(12)  
where WCẂ are the initial and thresholded wavelets. Fig. 8 illustrates 
the results of the proposed approach. 
3.3.2.5. IMF selection-fECG reconstruction. Accurate and automatic 
distinguishing of effective IMFs for real-time signal processing and how 
to process different types of IMF’s remains an open problem. While it is 
always possible to decompose a signal by EMD, an extensive interpre -
tation of the derived IMFs and their features has to be done. When 
dealing with nonlinear and nonstationary time series such as the ECG, 
although the derived decomposition is always correct from a mathe -
matical standpoint, it may be the case that there is not a corresponding 
Fig. 7.Empirical Mode Decomposition applied on rFECG.  T. Lampros et al.                                                                                                                                                                                                                                Array 19 (2023) 100302
9evident physical meaning of each IMF. If not properly handled, this 
could lead to an artefact-prone decomposition of the original signal 
causing significant information losses in the reconstructed fetal ECG 
signals. To address these problems, we developed an algorithm based on 
cross-correlation that considers each IMF’s specific presence in both the 
extracted fetal ECG signal and the reference thoracic The proposed al-
gorithm computes the Pearson ’s correlation coefficient of the produced 
IMF ‘S, both with the raw fetal ECG as well as with the maternal thoracic 
ECG signals. A sensitivity factor is computed based on the computed 
coefficients and the IMF’s are ranked accordingly. Finally a distance 
criterion is used to select the optimal number of IMF’s that will be used 
in partially reconstructing the denoised. fECG signal. The algorithm is 
presented below (Fig. 9). 
Correlation Algorithm for selecting the optimal IMF subset based on Correlation 
Analysis (using thoracic ECG)    
1 Input: S {IMF1 … …. IMFn}   
2 Correlate IMF(j) with fECG signal 
ajCorrIMFjCfECGCj1……n      
3 Correlate IMF(i) with thECG 
(continued on next column )  (continued ) 
bjCorrIMFjCthECGCj1……n      
4 Compute the coefficients 
cjaj1 bj
5 Normalize the coefficients 
djcj minc
maxc mincEEsensitivity factorEE
6 Rank the sensitivity factor of the IMF’s in descending order: 
d′
1≽d′
2……≽d′
j 1≽d′
jEEthese correspond toIMF ranking      
7 Rank the IMF’s according to their respective sensitivity factors dj   
8 Calculate the highest difference between adjacent factors 
mmax(
d′
j d′
j 1)
9 Select the first m IMF’s (ranked by the sensitivity factor) 
(continued on next page) 
Fig. 8.A) The produced IMF’s before application of the Wavelet Thresholding. B) The IMF’s after the denoising process.  
Fig. 9.Overview of the proposed IMF selection algorithm.  T. Lampros et al.                                                                                                                                                                                                                                Array 19 (2023) 100302
10(continued )   
10 Reconstruct the FECG signal as the sum of the selected IMF’s as 
fECG̂m
I1IMFiCwhere mmax(
d′
j d′
j 1)
3.3.3. IMF selection problem 
Denoising using EMD consists of removing non-essential IMF’s and 
partially reconstructing the signal using the IMF’s that contain the most 
useful information. Each IMF indicates the oscillation characteristics of 
the signal [51]. Initial IMFs contain high-frequency information, and 
higher-order IMFs express low-frequency information [52]. The initial 
attempt to use EMD as a denoising tool arose from the need to know if a 
particular IMF contains useful information or mainly noise. If one is 
aware of the energy of IMF resulting from the decomposition of a single 
signal, then in real case signals that include information and noise with 
specific characteristics, a significant deviation between the energy of an 
IMF and the corresponding noisy ECG signal indicates presence of useful 
information. 
Nonstationary and nonlinear signals can be decomposed into IMFs, 
and this basis functions can reflect the components of the main signal. 
However, some of these components are not useful, while some of them 
reflect the characteristics of the original signal. Hence, selecting the 
effective IMFs has been an important process while processing signals in 
the EMD domain. 
To date, no quantitative study exists that examines the results of optimal IMF selection in the context of improving Fetal Heart Rate 
estimation. To provide such data, we used the publicly available 
Abdominal and Direct Fetal ECG Database (db1). This database was 
considered optimal for this test since the fetal heart rate was extracted 
from the fetal scalp electrode, thus providing an accurate FHR reference. 
After extracting and enhancing the fetal ECG signal using our proposed 
methodology, we employed a heuristic search algorithm in order to 
search for the IMF subset that optimizes FHR. The algorithm steps are 
described below (Fig. 10). A detailed presentation of the optimization 
results can be found at the results section. 
Heuristic Algorithm for selecting the optimal IMF subset Based on QRS detection  
Input: S {IMF 1 … …. IMF i} i 1 … …N.  
1 for i 1: N compute all the possible subsets of set S.  
2 Detect estimated R peaks for each subset.  
3 Compute detection performance measures based on reference R peaks.  
4 The subset with the highest performance measures is selected as the optimal subset.  
4.Results 
R-peak detection was performed using the JQRS detector [53,54 ], 
which is an implementation of the Pan&Tompkins algorithm [55] 
modified for fetal ECG QRS detection with the following parameters: 0.6 
detector threshold, 15-s window size, 150-ms refractory period. 
The efficiency of the proposed methodology is evaluated in simu-
Fig. 10.Overview of the optimal search algorithm.  T. Lampros et al.                                                                                                                                                                                                                                Array 19 (2023) 100302
11lated and real data by comparing the detected QRS complexes (QRSdet) 
with the reference QRS provided in the datasets (QRSref). There are 
several statistics that should be mentioned when evaluating the per-
formance of any NI-fECG extraction algorithm. The classic statistics for 
evaluating a QRS detection algorithm, which were also used in this study 
include: The Sensitivity (SE), Positive Predictive Value (PPV), Accuracy 
(ACC), and F1 score (F1). Beyond these metrics, we also calculated the 
Mean Average Error (MAE), which represents the absolute time differ -
ence, expressed in milliseconds between the reference QRS values and 
the detected QRS values. The statistical measures used in this study are 
described below: 
SETP⁄TPFN (13)  
PPVTP⁄TPFP (14)  
ACCTPETPFPFNB (15)  
F12∗SE∗PPVESEPPV (16)  
MAE̂TP
in⃦⃦QRSref
i QRSdet
i⃦⃦⃦⃦⃦(17)  
Where TP stands for True Positive, FP for False Positive and FN for False 
Negative. 
4.1. IMF selection algorithm evaluation 
Tables 1 and 2 demonstrate the results of optimal IMF subset selec-
tion after EMD decomposition in db1. Statistical measures were obtained 
using the reference R peaks included in the dataset. In Table 1 the signal 
was reconstructed as a sum of all the produced IMF’s while Table 2 
presents the IMF subset that achieved the highest scores in terms of FHR 
estimation as well as the IMF’s that were removed. Results have shown 
an improvement in FHR estimation and therefore demonstrate the 
effectiveness of the EMD decomposition/IMF selection approach to 
processing fetal ECG signals. 
4.2. Fetal heart rate estimation 
4.2.1. Simulated data 
Each simulation is repeated 5 times, with different abdominal mix-
tures and different FHR/MHR.Four different levels of additional noise 
(0, 3, 6 and 9 dB) are included in each case. Table 3 shows the average 
scores in every simulation. 
4.2.2. Real data 
An automated multi-stage procedure to detect FQRS complexes was 
developed in order to provide the reference QRS complexes contained in 
the dataset. The determined locations of all fetal heartbeats (R waves) 
were validated by clinical experts, and each identified R-peak is com-
plemented by a verification flag provided by the expert. For coherence 
reasons, only the first three abdominal channels are maintained. The 
results of our approach are presented in Table 4. 5.Discussion 
Recent advances in the field of noninvasive fetal ECG analysis have 
shown that hybrid systems that combine adaptive and non-adaptive 
algorithms can outperform the use of singular methods, both in the 
context of fECG extraction as well as its denoising and enhancement. 
Studies that combine ICA with adaptive filters like the Recursive least 
Squares (RLS) [56] algorithm, the Least Mean Squares (LMS) [57] filter, 
decomposition techniques as the ensemble EMD or Wavelet Decompo -
sition or more advanced methods as Artificial Neural Networks like an 
Adaptive Neuro-Fuzzy System (ANFIS) [58] have recently been pro-
posed in the literature. However, implementation of such complex 
techniques comes at the cost of high computational complexity which 
makes them unsuitable for real-time applications. An overview of 
recently published studies in the field of NI-fECG extraction with a brief 
comment on their advantages and limitations is presented below 
(Table 6).  
≡The authors in Ref. [59] presented an algorithm based on using ICA 
to obtain the raw fetal ECG from the abdominal mixture and per-
formed Template Subtraction using PCA to remove the maternal 
signal presence. They tested their algorithm on 75 recordings con-
tained in the Physionet 2013 challenge dataset and reported average 
values of SE 93.8%, PPV 92,2%, F1 93%. The method was 
reported to have the advantage of a low computational load. Its 
limitations included the distortion of the extracted signal 
morphology and a decrease in performance in the presence of ectopic 
beats.  
≡In Ref. [60] the authors used EMD to directly in the multichannel 
abdominal signal and Non-Negative Matrix factorization to separate 
the maternal and fetal ECG. The method was tested in the MiT 
Arrhythmia Database but no statistical results were reported and by 
visual comparison of the extracted figures there is not enough evi-
dence that fECG extraction was achieved.  
≡In Ref. [61], a combination of Discrete Wavelet Transform with a 
Recursive Inverse algorithm was tested. The authors reported 
average values of SE 100%, PPV 91, 3% when testing on the 
DAISY dataset. It is important to mention however that the DaISy 
dataset consists of a single 8-lead signal, 10 s long which is obviously 
not enough data to provide acceptable statistical results.  
≡A combination Short Time Fourier transform and Generative 
Adversarial Neural Networks was proposed in Ref. [62]. The re-
ported results were SE 92.7%, PPV 90.32%, F1 93.69% in the 
challenge dataset and SE 89.7%, PPV 93.02%, F1 90.05% 
when tested on the ADFECGDB which are worse results than those 
achieved in this study. The authors report that use of a neural 
network eliminates the need for maternal ECG suppression. How-
ever, being a data driven method, training the model requires the use 
of many similar data, which limits its usability in real-world 
scenarios.  
≡In Ref. [63], the authors devised a time-specific fetal quality index 
for fECG extraction. When tested on the challenge Dataset, results 
reported average values of SE 99.38%, PPV 99.38%, F1 
99.38%. However, their approach included an MECG cancelling step 
and the Quality index devised did not consider the non-linear char-
acteristics of a fECG signal.  
≡In Ref. [64] a hybrid method using Short-Time Vibrational Mode 
Decomposition and PCA was devised by the authors. The challenge 
2013 was used to test the algorithm and the reported results were SE 
90.50%, PPV 89.40%, F1 80.50%. Although the method was 
reported to be computationally efficient, it did not perform well on 
low SNR scenarios. 
≡A combination of Wavelet based preprocessing and a clustering al-
gorithm was proposed in Ref. [65]. The authors reported average 
values of SE 97.30%, PPV 98.40%, F1 98.86%, ACC 98.63% 
on the challenge dataset and SE 97.08%, PPV 97.93%, F1 Table 1 
Results before the IMF removal Process.  
BEFORE NON-USEFULL IMF REMOVAL 
RECORD MEAN HR PPV (%) SE (%) F1 (%) ACC (%) MAE (ms) 
r01 143.67 92.59 95.03 93.79 88.31 7.84 
r04 146.45 87.33 89.4 88.35 79.13 12.47 
r07 125.91 94.14 83.73 90.28 82.29 9.58 
r08 142.97 92.08 91.09 91.58 84.47 7.19 
r10 141.71 92.85 91.68 92.26 85.63 10.55 
Average 140.142 91.79 90.18 91.25 83.966 9.39  T. Lampros et al.                                                                                                                                                                                                                                Array 19 (2023) 100302
1297.91%, ACC 98.52% on the ADFECGDB dataset, which are better 
than the results reported in this study. While the method is reported 
to produce consistent results across multiple datasets, it requires 
extensive parameter optimization which makes it difficult to imple -
ment in real-time medical applications.  ≡In Ref. [66], the authors propose a hybrid algorithm consisting of ICA 
and Recursive Least Squares Adaptive filtering with Wavelet 
Thresholding. According to the statistical evaluation, worse results 
were achieved for recordings from the FECGDARHA database (SE 
89.70%, PPV 92.41%, F1 90.99%, ACC 85.92%) than those 
achieved using the algorithm proposed in the present paper. The 
authors also excluded low quality inputs from their study.  
≡Finally the authors in Ref. [67] tested an algorithm combining ICA 
with a Fast Transversal Adaptive Filter and Complete Ensemble EMD 
with Adaptive Noise. The reported results on the FECGDARHA 
dataset (SE 95.33%, PPV 96.49%, F1 95.86%, ACC 92.8%) 
are better than the ones reported in this study. The proposed hybrid 
system is reported to achieve high quality fECG extraction across 
different noise scenarios However, the system is reported to require 
extensive parameter optimization in order to operate consistently 
across different datasets. Furthermore the use of Complete Ensemble 
EMD increases the computational load of the algorithm. Table 2 
Results after IMF removal Process.  
AFTER NON-USEFULL IMF REMOVAL 
RECORD MEAN HR PPV(%) SE (%) F1 (%) ACC (%) MAE IMF’S removed 
r01 141.43 94.41 97.05 95.71 91.78 4.43 3,7,8,9,10 
r04 131.38 94.68 87.34 90.86 84.01 6.34 2,3,8 
r07 125.09 97.95 92.19 93.15 87.18 9.57 1,2,6 
r08 138.6 94.13 93.55 93.84 88.39 5.38 6,8,9 
r10 142.11 93.17 92.15 92.66 87.32 10.03 2,5,9,10 
Average 135.722 94.86 92.45 93.24 87.736 7.15   
Table 3 
Simulated data results (average values).   
SNR SE (%) PPV (%) ACC (%) F1 (%) 
Case 1 0 94.3 94.9 94.8 97.1 
3 95.7 100.0 95.3 97.8 
6 97.9 98.9 94.0 95.0 
9 93.4 99.7 93.3 94.2 
Case 2 0 99.3 90.8 92.2 94.9 
3 98.6 84.3 90.6 92.6 
6 97.1 89.6 87.2 93.1 
9 91.3 95.5 87.9 89.1  
Table 4 
Results of the algorithm in db2. The R-peaks annotations provided in db3 were used to produce the statistical metrics. Annotation of the fetal QRS complexes was 
performed manually and validated by a cardiologist with the help of a simultaneous cardiac fetal pulsed-wave Doppler signal recorded during the procedure. Table 5 
presents the results of our approach.  
Record REFqrs TP FP FN SE (%) PPV(%) F1 (%) ACC(%) MAE (ms) 
B1_01 3120 2813 307 22 99.92 90.16 95.37 90.53 8.17 
B1_02 2801 2429 375 36 98.54 86.63 92.29 85.53 11.47 
B1_03 2565 2209 356 11 99.5 86.12 92.23 85.75 9.37 
B1_04 2774 2693 81 3 99.89 97.18 98.46 96.98 4.32 
B1_05 2770 2704 66 2 99.93 97.62 98.76 97.55 2.81 
B1_06 2889 2456 433 43 98.28 85.61 91.17 84.95 11.38 
B1_07 1969 1830 1 140 92.89 99.95 96.29 92.84 5.91 
B1_08 2911 2751 160 0 100 90.18 94.84 94.18 4.36 
B1_09 2866 2485 381 17 99.32 86.71 92.59 86.19 10.43 
B1_10 2592 2519 73 71 97.26 97.18 97.22 94.59 4.41 
Average     98.55 91.734 94.92 90.90 7.26  
Table 5 
Results of the algorithm in db3.  
Record QRSref TP FP FN SE (%) PPV(%) F1 (%) ACC(%) MAE (ms) 
Real_traces_1 34 32 1 1 96.97 96.97 96.97 94.12 10.31 
Real_traces_2 32 31 2 1 96.88 93.94 95.38 91.18 7.17 
Real_traces_3 34 34 1 0 100.0 97.14 98.55 97.14 11.97 
Real_traces_4 39 37 3 2 94.87 92.5 93.67 88.14 17.79 
Real_traces_6 34 33 3 1 97.06 91.67 94.29 89.19 8.36 
Real_traces_7 34 34 3 0 100.0 91.89 95.77 91.89 13.53 
Real_traces_8 38 38 6 0 100.0 89.17 88.37 89.17 11.29 
Real_traces_10 36 34 2 2 94.44 94.44 94.44 89.47 14.18 
Real_traces_11 34 34 8 0 100.0 90.95 89.47 90.95 15.79 
Real_traces_12 36 36 4 0 100.0 91.82 94.05 91.82 18.89 
Real_traces_13 34 34 3 0 100.0 91.89 95.77 91.89 16.85 
Real_traces_14 32 30 2 2 97.55 93.75 93.75 88.24 7.73 
Real_traces_15 34 34 2 0 100.0 94.44 97.14 94.44 5.35 
Real_traces_16 34 34 4 0 100.0 89.47 94.35 89.47 5.36 
Real_traces_18 38 38 5 0 97.37 88.37 93.83 88.37 7.92 
Real_traces_19 35 35 7 0 100.0 86.09 86.42 86.09 8.23 
Real_traces_20 35 34 6 1 97.14 85.95 88.31 87.07 5.23 
Real_traces_21 34 34 4 0 100.0 89.47 94.23 89.47 3.68 
Average     92.96 91.662 93.60 90.45 10.54  T. Lampros et al.                                                                                                                                                                                                                                Array 19 (2023) 100302
13Evaluation of ECG signal quality has been addressed in several 
studies in adult ECG monitoring [68,69]. However, in the case of fetal 
ECG processing the presence of a Maternal ECG signal can greatly distort 
the Quality Indices performance. Andreotti et al. [70] proposed specific 
sQI’s targeted at NI-FECG applications and tested their applicability on 
previously extracted fECG signals. In this work we propose a combina -
tion of an ICA algorithm with fetal quality indices that can extract a raw 
unprocessed fECG signal from multichannel abdominal recordings of 
different noise levels and acquisition quality. 
Accurate and automatic distinguishing of IMFs for real-time signal 
processing and how to process different types of IMFs remains an open 
problem. In the conventional EMD noise reduction method, higher order 
IMFs are often discarded to reduce noise. However, this process causes 
significant information losses in the reconstructed signals. Algorithms 
for assessing the importance of IMFs were developed by Flandrin et al. 
[71] and Wu et al. [72] based on the statistical analysis of the functions 
resulting from the decomposition of the signals. In the field of nonin -
vasive fetal ECG analysis there is a lack of research on the selection of 
optimal IMFs while using EMD and other similar decomposition 
methods. The correlation algorithm presented in this work takes 
advantage of signal specific characteristics of the produced IMFs to 
partially reconstruct a fECG signal that improves FHR detection. 
Results presented in this paper show that our method can produce 
accurate FHR estimations when tested against different datasets of 
variable quality and acquisition protocols. When tested on the FECG -
DARHA database our method achieved average values of SE 98.55%, 
PPV 91.73%, F1 94.92%, ACC 90.91%. Testing on the ARDNI -
FECG achieved average values of SE 92.96%, PPV 91.66%, F1 
93.60%, ACC 90.45%.The heuristic search on algorithm showed that 
optimal IMF selection demonstrated an improvement on FHR estimation 
on the ADFECGDB by average values of SE 3.07%, PPV 2.27%, F1 
2.00%, ACC 3.77%. It should be noted that our results were consistent 
across all datasets tested in this work. 
The proposed system has several advantages in speed, efficient FECG 
processing and adaptability. More specifically.  
≡The FastIca algorithm selected for abdominal signal separation is 
computationally efficient and requires less memory than other blind 
source separation algorithms, for example Infomax. Another advantage is that the independent components can be evaluated one 
by one, which further reduces the computational burden.  
≡The application of quality indices to the results of FastIca allows the 
automatic and accurate selection of the component of interest.  
≡The noise reduction algorithm is adaptive, in the sense that during 
the noise reduction process the noise-dominated IMFs can be 
distinguished from the total signal adaptively. That is, the correlation 
algorithm can decide which IMFs should be processed according to 
the signal itself. In addition, the level of wavelet decomposition can 
be adjusted to achieve the optimal enhancement of the IMF’s without 
distorting their morphology. 
5.1. Limitations and future work 
The hybrid system proposed in this work focuses on improving the 
performance of some frequently used algorithms in the field of fetal ECG 
processing. While our method is proven to be highly efficient and robust 
in extracting an accurate FHR estimation from multichannel abdominal 
recordings, some limitations should be considered. First, the usage of a 
maternal thoracic electrode could be unsuitable for real-time fetal 
monitoring applications as it could discomfort the mother during the 
monitoring process. Furthermore, the application of Wavelet Threshold 
in the EMD domain has a negative effect on the reconstructed signal 
morphology, thus impeding further analysis. Finally the fastICA algo-
rithm requires the use of multiple abdominal electrodes in order to 
produce reliable results. 
Future work will focus on addressing these shortcomings by 
exploring the applicability of more sophisticated source separation 
techniques such as the Non-Negative matrix factorization [73] which 
could allow for fetalECG extraction from single channel abdominal re-
cordings as well as newly introduced decomposition algorithms such as 
the Empirical Wavelet Transform (EWT) [74], recently applied to adult 
ECG analysis by Singh et al. [75], and the research and development of 
IMF selection algorithms that do not require the use of a reference 
thoracic electrode. We also aim at using our algorithm on the classifi -
cation of fetal ECG signals based on their Heart Rate variability mea-
sures. Since our method can produce accurate FHR estimations, 
combining it with machine learning algorithms such as k-Nearest Table 6 
Comparison of recent studies on FHR estimation metrics. (Average values of records tested in each study).  
Author(s) Methodology Dataset Results Advantages/limitations 
SE (%) PPV 
(%) F1 (%) ACC 
(%) 
Behar et al. [59] ICA -TSPCA Challenge 2013 93.8 92.2 93.0 – -Does not preserve signal morphology 
-Poor performance on presence of ectopic beats 
He et al. [60] EMD-NMF MIT Arrhythmia 
Database – – – – Single channel method suitable for multiple births 
- Not tested on actual recordings 
Al-Sheikh et al. [61] DWT- RI DAISY 100 91.3 – 91.3 Effective on low SNR scenarios 
-Use of a reference electrode 
Zhong et al. [62] STFT-GAN Challenge 2013 
ADFECGDB 92.7 
90.32 93.69 
89.7 93.02 
90.05 – 
– No need for MECG suppression 
-Poor performance in case of overlapping Signals 
Billecci & Varanini 
[63] BSS-QIO Challenge 2013 99.38 99.38 99.38 – Unsupervised method, robust to high noise level 
-Requires maternal ECG cancelling 
Lee et al. [64] STVD -PCA Challenge 2013 90.50 89.40 89.90 – Computationally efficient 
-Poor performance for low SNR levels 
Castillo et al. [65] WT-CLUSTERING Challenge 2013 
ADFECGDB 97.30 
97.08 98.40 
97.93 98.86 
99.11 98.63 
98.52 Stability across different datasets 
-Requires extensive parameter optimization 
Jaros et al. [58] ICA-RLS-WT FECGDARHA 
Challenge 2013 85.92 
68.25 89.70 
72.60 92.41 
81.31 90.99 
75.68 Robust FHR estimation 
-Requires high quality signal inputs 
Singh et al. [66] K/ICA-WT ADFECGDB 96.1 98.5 97.3 94.8 Fast convergence of the ICA algorithm 
-Not tested on datasets with variable SNR 
Barnova et al. [67] ICA-FTF-CEEMDAN FECGDARHA 
Challenge 2013 95.33 
82.06 96.49 
87.9 95.86 
84.62 92.8 
78.47 High Quality extraction of fECG signal on variable noise 
scenarios 
-Requires continuous parameter optimization 
Proposed Method ICA/sQIEMD/WT- 
CA ADFECGDB 
FECGDARHA 
ARDNIFECG 92.45 
98.55 
92.96 94.86 
91.73 
91.66 93.24 
94.92 
93.60 87.73 
90.91 
90.45 Fully automated FHR estimation process 
Computationally efficient Due to the use of EMD and WT, 
-Requires a thoracic reference electrode  T. Lampros et al.                                                                                                                                                                                                                                Array 19 (2023) 100302
14Neighbors (kNN), Random Forests [76] or Support Vector Machines 
could provide insight into pathological conditions related to fetal ar-
rhythmias. Such classification approaches are nowadays becoming 
growingly popular in daily clinical practice, solving diagnostic and 
prognostic challenges in various medical settings, such as the moni -
toring of the recent COVID-19 pandemic [77]. 
6.Conclusion 
Non-invasive fetal ECG is becoming an increasingly popular 
approach to fetal heart monitoring since its application is relatively 
simple and thus can be used for long-term recordings to assess fetal 
cardiac status. We presented a comprehensive methodology for the non- 
invasive extraction of the fetal electrocardiogram from abdominal re-
cordings, denoising and enhancement of the extracted fECG, and the 
extraction of the Fetal Heart Rate, using Blind Source Separation to 
separate the mixed abdominal signal in its Independent Components, 
signal specific indices to select the IC that carries the most information 
related to the fetal ECG, a hybrid method based on Empirical Decom -
position and Wavelet thresholding of each IMF to remove noise artifacts 
and enhance the extracted fetal component and a novel algorithm based 
on correlation analysis in order to partially reconstruct the fECG from 
the IMF’s. We provided quantitative data that demonstrate the impor -
tance of accurate selection of the intrinsic functions derived from EMD 
in improving FHR estimation. Our method was evaluated on a simulated 
dataset as well as two real datasets, providing adequate results to sup-
port our approach, and the results were compared with other method -
ologies published on the same problem. The methodology we presented 
in this work is completely unsupervised and has proven to be robust in 
different SNR scenarios and variable abdominal signals while its low 
computational complexity makes it suitable for the development of 
efficient real-time fetal monitoring applications. 
Declaration of competing interest 
The authors declare the following financial interests/personal re-
lationships which may be considered as potential competing interests: 
Alexandros Tzallas reports financial support was provided by University 
of Ioannina - Arta. Alexandros Tzallas reports a relationship with Uni-
versity of Ioannina - Arta that includes: non-financial support. 
Data availability 
Data will be made available on request. 
Acknowledgments 
We acknowledge support of this work by the project “Immersive 
Virtual, Augmented and Mixed Reality Center Of Epirus” (MIS:5047221) 
which is implemented under the Action “Reinforcement of the Research 
and Innovation Infrastructure”, funded by the Operational Programme 
“Competitiveness, Entrepreneurship and Innovation” (NSRF 
2014–2020) and co-financed by Greece and the European Union (Eu-
ropean Regional Development Fund). 
References 
[1]Lawn JE, Blencowe H, Pattinson R, Cousens S, Kumar R, Ibiebele I, Gardosi J, 
Day LT, Stanton C. Stillbirths: where? When? Why? How to make the data count? 
Lancet 2011;377(9775):1448–63. https://doi.org/10.1016/s0140-6736(10) 
62187-3. 
[2]Karavadra B, Stockl A, Prosser-Snelling E, Simpson P, Morris E. Women’s 
perceptions of COVID-19 and their healthcare experiences: a qualitative thematic 
analysis of a national survey of pregnant women in the United Kingdom. BMC 
Pregnancy Childbirth 2020;20(1):600. https://doi.org/10.1186/s12884-020- 
03283-2. 
[3]Mindchild. https://www.mindchild.com. 
[4]Nemo Healthcare. https://nemohealthcare.com. [5]Avalon Fetal Monitor. https://www.usa.philips.com/healthcare/resources/landi 
ng/avalon. 
[6]Mhajna M, Schwartz N, Levit-Rosen L, Warsof S, Lipschuetz M, Jakobs M, et al. 
Wireless, remote solution for home fetal and maternal heart rate monitoring. Am J 
Obstet Gynecol MFM 2020;2(2):100101. https://doi.org/10.1016/j. 
ajogmf.2020.100101. 
[7]Martens SMM, Rabotti C, Mischi M, Sluijter RJ. A robust fetal ECG detection 
method for abdominal recordings. Physiol Meas 2007;28(4):373–88. https://doi. 
org/10.1088/0967-3334/28/4/004. 
[8]Vullings R, Peters CHL, Sluijter RJ, Mischi M, Oei SG, Bergmans JWM. Dynamic 
segmentation and linear prediction for maternal ECG removal in antenatal 
abdominal recordings. Physiol Meas 2009;30(3):291–307. https://doi.org/ 
10.1088/0967-3334/30/3/005. 
[9]Liu H, Chen D, Sun G. Detection of fetal ECG R wave from single-lead abdominal 
ECG using a combination of RR time-series smoothing and template-matching 
approach. IEEE Access 2019;7:66633–43. https://doi.org/10.1109/ 
access.2019.2917826. 
[10] Ghazdali A, Hakim A, Laghrib A, Mamouni N, Raghay S. A new method for the 
extraction of fetal ECG from the dependent abdominal signals using blind source 
separation and adaptive noise cancellation techniques. Theor Biol Med Model 
2015;12(1). https://doi.org/10.1186/s12976-015-0021-2. 
[11] Zarzoso V, Nandi A. Noninvasive fetal electrocardiogram extraction: blind 
separation versus adaptive noise cancellation. IEEE (Inst Electr Electron Eng) Trans 
Biomed Eng 2001;48(1):12–8. https://doi.org/10.1109/10.900244. 
[12] Ramli DA, Shiong YH, Hassan N. Blind source separation (BSS) of mixed maternal 
and fetal electrocardiogram (ECG) signal: a comparative study. Proc Comput Sci 
2020;176:582–91. https://doi.org/10.1016/j.procs.2020.08.060. 
[13] Liu SJ, Liu DL, Zhang JQ, Zeng YJ. Extraction of fetal electrocardiogram using 
recursive least squares and normalized least mean squares algorithms. In: 3rd 
international conference on advanced computer control; 2011. https://doi.org/ 
10.1109/icacc.2011.6016426. 2011. 
[14] Martinek R, Kahankova R, Skutova H, Koudelka P, Zidek J, Koziorek J. Adaptive 
signal processing techniques for extracting abdominal fetal electrocardiogram. In: 
10th international symposium on communication systems, networks and digital 
signal processing (CSNDSP); 2016. https://doi.org/10.1109/ 
csndsp.2016.7573974. 2016. 
[15] Behar J, Johnson A, Clifford GD, Oster J. A comparison of single channel fetal ECG 
extraction methods. Ann Biomed Eng 2014;42(6):1340–53. https://doi.org/ 
10.1007/s10439-014-0993-9. 
[16] Swarnalath R, Prasad D. A novel technique for extraction of FECG using multistage 
adaptive filtering. J Appl Sci 2010;10(4):319–24. https://doi.org/10.3923/ 
jas.2010.319.324. 
[17] Zhong W, Liao L, Guo X, Wang G. A deep learning approach for fetal QRS complex 
detection. Physiol Meas 2018;39(4):045004. https://doi.org/10.1088/1361-6579/ 
aab297. 
[18] Вin Ibne Reaz M, Lee Sze Wei. Adaptive linear neural network filter for fetal ECG 
extraction. In: International conference on intelligent sensing and information 
processing, 2004. Proceedings of; 2004. https://doi.org/10.1109/ 
icisip.2004.1287675. 
[19] Pal S, Mitra M. Empirical mode decomposition based ECG enhancement and QRS 
detection. Comput Biol Med 2012;42(1):83–92. https://doi.org/10.1016/j. 
compbiomed.2011.10.012. 
[20] Li H, Wang X, Chen L, Li E. Denoising and R-peak detection of electrocardiogram 
signal based on EMD and improved approximate envelope. Circ Syst Signal Process 
2013;33(4):1261–76. https://doi.org/10.1007/s00034-013-9691-3. 
[21] Zhang SC, Sui LL. A new denoising method via empirical mode decomposition. 
Appl Mech Mater 2014;651–653:2090–3. https://doi.org/10.4028/www.scientific. 
net/amm.651-653.2090. 
[22] Wang Y, Fu Y, He Z. Fetal electrocardiogram extraction based on Fast ICA and 
wavelet denoising. 2018 2nd IEEE advanced information management, 
communicates. In: Electronic and automation control conference (IMCEC); 2018. 
https://doi.org/10.1109/imcec.2018.8469501. 
[23] Ishikawa Y, Horigome H, Kandori A, Toda H, Zhang Z. Noise reduction by perfect- 
translation-invariant complex discrete wavelet transforms for fetal 
electrocardiography and magnetocardiography. Int J Wavelets, Multiresolut Inf 
Process 2014;12(4):1460008. https://doi.org/10.1142/s021969131460008x. 
[24] Ahmadi M, Ayat M, Assaleh K, Al-Nashash H. Fetal ECG signal enhancement using 
polynomial classifiers and wavelet denoising. In: Cairo international biomedical 
engineering conference; 2008. https://doi.org/10.1109/cibec.2008.4786095. 
2008. 
[25] Li G, Zeng X, Zhou X, Li G, Liu Q. Robust adaptive fetal heart rate estimation for 
single-channel abdominal ECG recording. In: 5th international conference on 
BioMedical engineering and informatics; 2012. https://doi.org/10.1109/ 
bmei.2012.6513193. 2012. 
[26] Panigrahy D, Sahu PK. Extraction of fetal electrocardiogram (ECG) by extended 
state Kalman filtering and adaptive neuro-fuzzy inference system (ANFIS) based on 
single channel abdominal recording. Sadhana 2015;40(4):1091–104. https://doi. 
org/10.1007/s12046-015-0381-7. 
[27] Taha LY, Abdel-Raheem E. Fetal ECG extraction using input-mode and output- 
mode adaptive filters with blind source separation. Can J Electr Comput Eng 2020; 
43(4):295–304. https://doi.org/10.1109/cjece.2020.2984602. 
[28] Gupta A, Srivastava MC, Khandelwal V, Gupta A. A novel approach to fetal ECG 
extraction and enhancement using blind source separation (BSS-ICA) and adaptive 
fetal ECG enhancer (AFE). In: 6th international conference on information, 
communications & signal processing; 2007. https://doi.org/10.1109/ 
icics.2007.4449716. 2007. T. Lampros et al.                                                                                                                                                                                                                                Array 19 (2023) 100302
15[29] Ionescu V. Fetal ECG extraction from multichannel abdominal ECG recordings for 
health monitoring during labor. Procedia Technology 2016;22:682 –9. https://doi. 
org/10.1016/j.protcy.2016.01.143 . 
[30] Liu G, Luan Y. An adaptive integrated algorithm for noninvasive fetal ECG 
separation and noise reduction based on ICA-EEMD-WS. Med Biol Eng Comput 
2015;53(11):1113 –27. https://doi.org/10.1007/s11517-015-1389-1 . 
[31] Hyvarinen A, Oja E. Independent component analysis: algorithms and applications. 
Neural Network 2000;13(4 –5):411 –30. https://doi.org/10.1016/s0893-6080(00) 
00026-5 . 
[32] Manorost P, Theera-Umpon N, Auephanwiriyakul S. Fetal electrocardiogram 
extraction by independent component analysis. In: 2017 7th IEEE international 
conference on control system, computing and engineering (ICCSCE); 2017. https:// 
doi.org/10.1109/iccsce.2017.8284408 . 
[33] Yuan L, Zhou Z, Yuan Y, Wu S. An improved FastICA method for fetal ECG 
extraction. Comput Math Methods Med 2018:1 –7. https://doi.org/10.1155/2018/ 
7061456 . 2018. 
[34] Rieta JJ, S˘anchez C, Sanchis JM, Castells F, Millet J. Mixing matrix 
pseudostationarity and ECG preprocessing impact on ICA-based atrial fibrillation 
analysis. Independent Component Analysis and Blind Signal Separation 2004: 
1079 –86. https://doi.org/10.1007/978-3-540-30110-3_136 . 
[35] Nejad MRE, Rizi FY. An adaptive FECG extraction and analysis method using ICA, 
ICEEMDAN and wavelet shrinkage. In: Electrical engineering (ICEE), Iranian 
conference on; 2018. https://doi.org/10.1109/icee.2018.8472478 . 
[36] Huang NE, Shen Z, Long SR, Wu MC, Shih HH, Zheng Q, Yen NC, Tung CC, Liu HH. 
The empirical mode decomposition and the Hilbert spectrum for nonlinear and 
non-stationary time series analysis. In: Proceedings of the royal society of london. 
Series A: mathematical, physical and engineering sciences, 454; 1998. p. 903–95. 
https://doi.org/10.1098/rspa.1998.0193 . 1971. 
[37] Liu T, Luo Z, Huang J, Yan S. A comparative study of four kinds of adaptive 
decomposition algorithms and their applications. Sensors 2018;18(7):2120. 
https://doi.org/10.3390/s18072120 . 
[38] Rooijakkers MJ, Song S, Rabotti C, Oei SG, Bergmans JWM, Cantatore E, Mischi M. 
Influence of electrode placement on signal quality for ambulatory pregnancy 
monitoring. Comput Math Methods Med 2014:1 –12. https://doi.org/10.1155/ 
2014/960980 . 2014. 
[39] Wu S, Shen Y, Zhou Z, Lin L, Zeng Y, Gao X. Research of fetal ECG extraction using 
wavelet analysis and adaptive filtering. Comput Biol Med 2013;43(10):1622 –7. 
https://doi.org/10.1016/j.compbiomed.2013.07.028 . 
[40] Vigneron V, Paraschiv-Ionescu A, Azancot A, Sibony O, Jutten C. Fetal 
electrocardiogram extraction based on non-stationary ICA and wavelet denoising. 
In: Seventh international symposium on signal processing and its applications. 
Proceedings; 2003. https://doi.org/10.1109/isspa.2003.1224817 . 2003. 
[41] Behar J, Andreotti F, Zaunseder S, Li Q, Oster J, Clifford GD. An ECG simulator for 
generating maternal-foetal activity mixtures on abdominal ECG recordings. Physiol 
Meas 2014;35(8):1537 –50. https://doi.org/10.1088/0967-3334/35/8/1537 . 
[42] Jezewski J, Matonia A, Kupka T, Roj D, Czabanski R. Determination of fetal heart 
rate from abdominal signals: evaluation of beat-to-beat accuracy in relation to the 
direct fetal electrocardiogram. Biomedizinische Technik/Biomedical Engineering 
2012;57(5). https://doi.org/10.1515/bmt-2011-0130 . 
[43] Goldberger AL, Amaral LAN, Glass L, Hausdorff JM, Ivanov PC, Mark RG, 
Mietus JE, Moody GB, Peng CK, Stanley HE. PhysioBank, PhysioToolkit, and 
PhysioNet. Circulation 2000;101(23). https://doi.org/10.1161/01.cir.101.23. 
e215. 
[44] Matonia A, Jezewski J, Kupka T, Jezewski M, Horoba K, Wrobel J, Czabanski R, 
Kahankowa R. Fetal electrocardiograms, direct and abdominal with reference 
heartbeat annotations. Sci Data 2020;7(1). https://doi.org/10.1038/s41597-020- 
0538-z . 
[45] Figshare. Fetal electrocardiograms. direct and abdominal with reference heartbeat 
annotations 2020. June 17, https://springernature.figshare.com/articles/dataset/ 
Fetal_electrocardiograms_direct_and_abdominal_with_reference_heart_beats_annota 
tions/10311029?backTo /collections/Fetal_electrocardiograms_direct_and_a 
bdominal_with_reference_heart_beats_annotations/4740794 . 
[46] Baldazzi G, Sulas E, Urru M, Tumbarello R, Raffo L, Pani D. Annotated real and 
synthetic datasets for non-invasive foetal electrocardiography post-processing 
benchmarking. Data Brief 2020;33:106399. https://doi.org/10.1016/j. 
dib.2020.106399 . 
[47] Li Q, Mark RG, Clifford GD. Robust heart rate estimation from multiple 
asynchronous noisy sources using signal quality indices and a Kalman filter. 
Physiol Meas 2007;29(1):15 –32. https://doi.org/10.1088/0967-3334/29/1/002 . 
[48] Andreotti F, Grasser F, Malberg H, Zaunseder S. Non-invasive fetal ECG signal 
quality assessment for multichannel heart rate estimation. IEEE (Inst Electr 
Electron Eng) Trans Biomed Eng 2017;64(12):2793 –802. https://doi.org/10.1109/ 
tbme.2017.2675543 . 
[49] Liu Shulin, Zhao Haifeng, Wang Hui, Ma Rui. Application of improved EMD 
algorithm for the fault diagnosis of reciprocating pump valves with spring failure. 
In: 9th international symposium on signal processing and its applications; 2007. 
https://doi.org/10.1109/isspa.2007.4555473 . 2007. 
[50] Donoho D. De-noising by soft-thresholding. IEEE Trans Inf Theor 1995;41(3): 
613–27. https://doi.org/10.1109/18.382009 . 
[51] Boudraa AO, Cexus JC. Denoising via empirical mode decomposition proceedings 
of the IEEE international symposium on control. Communications and Signal 
Processing (ISCCSP ‘06) 2006;4 . [52] Li H, Wang X, Chen L, Li E. Denoising and R-peak detection of electrocardiogram 
signal based on EMD and improved approximate envelope. Circ Syst Signal Process 
2013;33(4):1261 –76. https://doi.org/10.1007/s00034-013-9691-3 . 
[53] Johnson AEW, Behar J, Andreotti F, Clifford GD, Oster J. Multimodal heart beat 
detection using signal quality indices. Physiol Meas 2015;36(8):1665 –77. https:// 
doi.org/10.1088/0967-3334/36/8/1665 . 
[54] R. Sameni, OSET: The open-source electrophysiological toolbox. Version 3.14,URL: 
https://www.oset.ir . 
[55] Pan J, Tompkins WJ. A real-time QRS detection algorithm. IEEE Transactions on 
Biomedical Engineering, BME- 1985;32(3):230 –6. https://doi.org/10.1109/ 
tbme.1985.325532 . 
[56] Jaros R, Martinek R, Kahankova R, Danys L, Baros J, Ladrova M, Sidikova M. 
Optimization of RLS algorithm for hybrid method ICA-RLS. IFAC-PapersOnLine 
2019;52(27):530 –5. https://doi.org/10.1016/j.ifacol.2019.12.718 . 
[57] Praneeth CNVS, Abel JDK, Samiappan D, Kumar R, Kumar SP, Nitin PV. 
A comparison on variants of LMS used in fir adaptive noise cancellers for fetal ECG 
extraction. Biomed Eng: Applications, Basis and Communications 2020;32(4): 
2050026. https://doi.org/10.4015/s101623722050026x . 
[58] Jaros R, Martinek R, Kahankova R, Koziorek J. Novel hybrid extraction systems for 
fetal heart rate variability monitoring based on non-invasive fetal 
electrocardiogram. IEEE Access 2019;7:131758 –84. https://doi.org/10.1109/ 
access.2019.2933717 . 
[59] Behar J, Oster J, Clifford GD. Combining and benchmarking methods of foetal ECG 
extraction without maternal or scalp electrode data. Aug Physiol Meas 2014;35(8): 
1569 –89. https://doi.org/10.1088/0967-3334/35/8/1569 . Epub 2014 Jul 29. 
PMID: 25069410. 
[60] He P, Chen X. A method for extracting fetal ECG based on EMD-NMF single channel 
blind source separation algorithm. Technol Health Care 2015;24(s1):S17 –26. 
https://doi.org/10.3233/thc-151044 . 
[61] Al-Sheikh B, Salman MS, Eleyan A, Alboon S. Non-invasive fetal ECG extraction 
using discrete wavelet transform recursive inverse adaptive algorithm. Technol 
Health Care 2020;28(5):507 –20. https://doi.org/10.3233/thc-191948 . 
[62] Zhong W, Zhao W. Fetal ECG extraction using short time Fourier transform and 
generative adversarial networks. Physiol Meas 2021;42(10):105011. https://doi. 
org/10.1088/1361-6579/ac2c5b . 
[63] Billeci L, Varanini M. A combined independent source separation and quality index 
optimization method for fetal ECG extraction from abdominal maternal leads. 
Sensors 2017;17(5):1135. https://doi.org/10.3390/s17051135 . 
[64] Lee K, Lee B. Sequential total variation denoising for the extraction of fetal ECG 
from single-channel maternal abdominal ECG. Sensors 2016;16(7):1020. https:// 
doi.org/10.3390/s16071020 . 
[65] Castillo E, Morales DP, García A, Parrilla L, Ruiz VU, ˘Alvarez-Bermejo JA. 
A clustering-based method for single-channel fetal heart rate monitoring. PLoS One 
2018;13(6):e0199308. https://doi.org/10.1371/journal.pone.0199308 . 
[66] Singh R, Rajpal N, Mehta R. An empirical sequence to extract fetal 
electrocardiogram using the Kernel and wavelet optimization. J Inf Optim Sci 
2020;41(1):107 –18. https://doi.org/10.1080/02522667.2020.1715562 . 
[67] Barnova K, Martinek R, Jaros R, Kahankova R, Behbehani K, Snasel V. System for 
adaptive extraction of non-invasive fetal electrocardiogram. Appl Soft Comput 
2021;113:107940. https://doi.org/10.1016/j.asoc.2021.107940 . 
[68] Shahriari Y, Fidler R, Pelter MM, Bai Y, Villaroman A, Hu X. Electrocardiogram 
signal quality assessment based on structural image similarity metric. IEEE (Inst 
Electr Electron Eng) Trans Biomed Eng 2018;65(4):745 –53. https://doi.org/ 
10.1109/tbme.2017.2717876 . 
[69] Zhao Z, Zhang Y. SQI quality evaluation mechanism of single-lead ECG signal 
based on simple heuristic fusion and fuzzy comprehensive evaluation. Front 
Physiol 2018;9. https://doi.org/10.3389/fphys.2018.00727 . 
[70] Flandrin P, Gonçalv ˇes P, Rilling G. Emd equivalent filter banks, from interpretation 
to applications. Hilbert-Huang Transform and Its Applications 2005:57 –74. 
https://doi.org/10.1142/9789812703347_0003 . 
[71] Andreotti F, Grasser F, Malberg H, Zaunseder S. Non-invasive fetal ECG signal 
quality assessment for multichannel heart rate estimation. IEEE (Inst Electr 
Electron Eng) Trans Biomed Eng 2017;64(12):2793 –802. https://doi.org/10.1109/ 
tbme.2017.2675543 . 
[72] Wu Z, Huang NE. Statistical significance test of intrinsic mode functions. 
Interdisciplinary Mathematical Sciences 2014:149 –69. https://doi.org/10.1142/ 
9789814508247_0007 . 
[73] Wang H, Wang M, Li J, Song L, Hao Y. A novel signal separation method based on 
improved sparse non-negative matrix factorization. Entropy 2019;21(5):445. 
https://doi.org/10.3390/e21050445 . 
[74] Gilles J. Empirical wavelet transform. IEEE Trans Signal Process 2013;61(16): 
3999 –4010. https://doi.org/10.1109/tsp.2013.2265222 . 
[75] Singh O, Sunkaria RK. ECG signal denoising via empirical wavelet transform. 
Australas Phys Eng Sci Med 2016;40(1):219 –29. https://doi.org/10.1007/s13246- 
016-0510-6 . 
[76] Abdullayeva Fargana J, Suleymanzade Suleyman. Diagnosis of pneumonia in the 
lungs in the conditions of the COVID-19 pandemic using ensemble learning 
methods. Int J Reas base Intell Syst 2022;14(2 –3):114 –22. 
[77] Abdullayeva Fargana J. Internet of Things-based healthcare system on patient 
demographic data in Health 4.0. CAAI Transactions on Intelligence Technology 
2022;7(4):644 –57. T. Lampros et al.                                                                                                                                                                                                                                