Array 18 (2023) 100289
Available online 11 May 2023
2590-0056/© 2023 The Authors. Published by Elsevier Inc. This is an open access article under the CC BY license ( http://creativecommons.org/licenses/by/4.0/ ).E-HFWN: Design and performance test of a communication and sensing 
integrated network for enhanced 5G mmWave☆ 
Chaoyi Zhanga, Zhangchao Maa, Xiangna Hanb, Jianquan Wanga,* 
aIndustrial Internet Institute, Automation and Electronic Engineering College, University of Science and Technology Beijing, Beijing, China 
bInstitute of Cultural Heritage and History of Science & Technology, University of Science and Technology Beijing, Beijing, China   
ARTICLE INFO  
Keywords: 
Communication and sensing 
Integrated network 
5G 
6G 
mmWave 
Air interface technology 
Network performance ABSTRACT  
Communication and sensing integrated networks (CSINs) refer to the ability of physical digital space perception 
and ubiquitous intelligent communication at the same time. These networks realize the perception and coop-
erative communication of multidimensional resources through the cooperative work of communication and 
sensing resources and have the ability of intelligent interaction and processing of new information flow. First, 
this study proposes the technical architecture of an enhanced CSIN (E-HFWN), studies its key technologies and 
performance indicators, and explains the air interface technology, including frame structure design, carrier 
aggregation, channel detection, physical skyline mapping, beamforming and management, resource allocation 
and scheduling. In the resource allocation scheme, an actor-critic reinforcement learning (RL) framework is used 
to divide the wireless resources. The goal is to maximize the amount of mutual information (MI) and minimize 
the end-to-end delay of the sensing terminal. Then, the performance of the E-HFWN is tested, including nu-
merical simulation of wireless resource management, system peak rate, capacity, end-to-end delay and 
communication perception waveform sidelobe ratio. Finally, from the results of the E-HFWN index test, the E- 
HFWN is further enhanced on the basis of 5G mmWave. The enhanced sensing function can provide a priori 
information for the optimal and rapid scheduling of distributed computing power and provide richer data sources 
for artificial intelligence (AI) services and applications to enhance the robustness of the training model. The E- 
HFWN can contribute to the development of technologies related to 6G synaesthesia computing integrated 
networks, promote the consensus between academia and industry.   
1.Introduction 
There is a large amount of intelligent automation equipment with 
highly differentiated capabilities in typical 6G application scenarios 
represented by smart factories, and the communication requirements for 
extremely low latency, high reliability, ultralarge bandwidth, and 
massive access are becoming increasingly stringent. Applications in 
factories also require high precision and resolution for perception ca-
pabilities [1]. On the one hand, the proliferation of wireless communi -
cation and sensing devices has made the contradiction between the 
endless growth of business needs and the limited wireless resources 
increasingly prominent; on the other hand, the realization of 6G vision 
requires the acquisition of environment perception information, intel-
ligent information processing, and control closed-loop information flow processing where information is distributed layer by layer [2]. The 
existing wireless network architecture and related technologies have 
been unable to meet the emerging application needs beyond the 5G 
(B5G)/6G era. It is urgent to develop new network architectures and 
enabling technologies that efficiently utilize resources and intelligently 
adapt differentiated applications [3]. 
In response to the above challenges, research and technological 
development in academia and industry have great potential [4,5]. On 
the one hand, in the B5G era, the high frequency bands used by wireless 
communication networks and the radio sensing frequency bands are 
gradually approaching or even overlapping [4]; on the other hand, 
communication and sensing systems have similar characteristics in 
terms of radio frequency transceivers, channel characteristics, and 
signal processing, which gave birth to the research and development of 
☆Chaoyi Zhang, Zhangchao Ma and Xiangna Han are with the University of Science and Technology Beijing, e-mail: (zhangchaoyi@ustb.edu.cn ; mazhangchao@us 
tb.edu.cn ; jayna422@126.com ). This work is supported by the National Key R&D Program of China (2020YFB1708800, 2020YFC1522404). 
*Corresponding author. 
E-mail address: wangjianquan@ustb.edu.cn (J. Wang).  
Contents lists available at ScienceDirect 
Array 
u{�~zkw! s{yo|kr o>!ÐÐÐ1�mtoz mont~om�1m{ y2u{�~zkw2k ~~kÞ!
https://doi.org/10.1016/j.array.2023.100289 
Received 17 October 2022; Received in revised form 11 January 2023; Accepted 23 April 2023   Array 18 (2023) 100289
2synaesthesia integrated network architectures and related technologies 
[5]. In addition, the rise of AI technologies represented by machine 
learning, RL, neural networks, etc., has had a broad and profound 
impact in various fields, such as communication network optimization, 
intelligent perception and control applications, and has promoted the 
improvement of the overall performance of communication and sensing 
integration [6]. 
Based on this, if 6G realizes the integration and symbiosis of 
communication and sensing capability on the basis of AI technology, it 
will give 6G networks the ability to perceive the physical world all the 
time and everywhere. They will not only fully meet the blending and 
interworking of multidimension intelligent perception of network nodes 
but also support wide area intelligent cooperation based on communi -
cation capability [7], realizing the vision of 6G CSIN. AI services and 
applications will also be sent to thousands of households with the help of 
6G CSIN to help thousands of industries to realize the ubiquitous 
interconnection of man-machine and objects, intelligent cooperation, 
and the interaction of the physical world and digital world. 
A CSIN refers to a physical digital space perception and ubiquitous 
intelligent communication. Through the collaboration of synaesthesia 
software and hardware resources, each network element device realizes 
the deep integration of multidimensional perception and collaborative 
communication so that the network has the ability of new closed-loop 
information flow intelligent interaction and processing wide area 
intelligent cooperation, providing support for 6G smart cities, smart 
transportation, smart homes and other typical application scenarios [8]. 
In future intelligent factories, there will be ultradense data interaction 
applications, which have higher requirements for the throughput and 
reliability of communication and sensing systems. It is predicted that 
when the UPF sinks to the edge, 6G networks will need a system 
throughput performance of 10 Gbps, which will require the mmWave of 
communication and sensing integration to realize the seamless progress 
of cooperative communication and environment perception and reduce 
the signaling overhead [9]. In addition, the integration of communica -
tion and sensing for intelligent factories requires a machine end-to-end 
delay of less than 10 ms, centimeter-level positioning accuracy and 
reliability of at least 99.999%. These indicators need to further 
strengthen the air interface design of existing mmWave networks to 
ensure the application of industrial machines with a large order of 
magnitude [10]. The contributions and arrangements of this paper are as 
follows: 
1)An air interface structure of an enhanced CSIN (E-HFWN) is pro-
posed, including key technologies such as enhanced mmWave frame 
structure design, system carrier aggregation, wireless channel 
detection, physical antenna mapping, beamforming and manage -
ment, system resource allocation and scheduling. These key air 
interface technologies are further enhanced on the basis of the 
existing 5G mmWave, especially the frame structure design in the 28 
GHz band. The uplink time slot is increased, which greatly improves 
the transmission efficiency of uplink data. It is especially suitable for 
uplink data intensive scenarios such as intelligent factories.  
2) An AI RL method is introduced into the E-HFWN system, which is 
aimed at the channel resource allocation and scheduling algorithm of 
communication and sensing. In this study, an actor-critic RL frame -
work is used to divide the wireless resources. The goal is to maximize 
the amount of MI and minimize the end-to-end delay of the 
perception terminal.  
3) Construction and testing of the experimental platform. For the E- 
HFWN system, this study tests platform performance with commu -
nication and sensing. First, the RL is simulated to allocate the 
communication perception channel resources, and the actor-critic 
learning framework is fitted from convex optimization theory to 
achieve the goal of maximizing the MI amount of the system 
perception signal. Second, the communication performance of the E- 
HFWN system is tested, including the peak rate, capacity and end-to- end delay. Compared with 5G and 5G mmWave networks, the 
enhancement effect brought by air interface technology is compared 
and analyzed. Then, a sensing performance test of the E-HFWN 
system is used to calculate the sidelobe ratio of communication and 
sensing waveform and obtain the peak and integral sidelobe ratio. 
This result shows that the E-HFWN system has a strong environment 
sensing ability. 
2.Related work 
To realize CSIN, the design problem of CSIN air interface technology 
needs to be solved. To obtain multidimensional perception information, 
such as the direction, distance and relative motion speed of an envi-
ronment target, the CSIN can not only realize broadband communica -
tion but also receive the echo signal to enhance the perception ability of 
the carrier array antenna. However, the receiving process of commu -
nication signals and perceptual echoes will face problems such as mutual 
interference and collision. Therefore, it is necessary to carry out the joint 
optimal design of the CSIN air interface from the aspects of the physical 
layer, multiple access, wireless resource management and control. On 
the one hand, physical layer technologies such as the working frequency 
band, waveform, frame structure design of synaesthesia integration and 
large-scale array antenna beamforming are the basis for the ground 
application. On the other hand, to solve the problems of mutual inter-
ference between communication and sensing signals, research on CSIN 
multiple access, wireless resource management and control technology 
is also necessary. In addition, the key technology of the CSIN air inter-
face needs to be verified and evaluated by building an experimental 
system. 
2.1. CSIN spectrum characteristics 
The research of this study is in the 28 GHz band, which belongs to the 
millimeter wave. This band is characterized by large bandwidth and 
short wavelength. Therefore, the communication rate is faster, the sys-
tem capacity is larger, and the sensing resolution and accuracy are 
higher. It is especially suitable for combination with beamforming 
technology. The direction discrimination ability of beam alignment is 
better, which is suitable for intelligent factories [11]. In addition, due to 
the high frequency and long wavelength, it is easy to cause an attenu -
ation phenomenon in the process of electromagnetic wave transmission, 
which makes the coverage of millimeter waves smaller and based on 
sight distance. In complex environments, such as industrial sites, more 
compact, complex physical and MAC layer protocols are designed to 
compensate for mmWave transmission loss [12,13]. At the same time, a 
number of hardware terminal devices suitable for the mmWave fre-
quency band have emerged [14], which has laid a solid foundation for 
the application of CSIN in the mmWave frequency band. 
2.2. CSIN channel model 
Due to the characteristics of operating in a high frequency band, the 
CSIN reaches the line of sight (LOS) communication receiving end 
through one-way propagation, and then the echo signal is reflected by 
the signal receiving terminal. The echo signal reaches the CSIN trans -
mitting end after the second LOS space loss [15]. In the process of 
electromagnetic wave transmission, the propagation delay related to the 
LOS path distance determines the large-scale space loss, and the 
reflection coefficient (including the radar cross-section parameters of 
the perceived object) determines the amplitude and phase fading 
introduced by the signal reflection and scattering process [16]. The 
propagation delay and reflection coefficient reflect the fading relation -
ship between the spatial sensing channel and single path propagation. 
Therefore, the key to constructing an integrated communication and 
sensing channel model under a unified spatial scale and propagation law 
is ① modeling the twice propagation distance/delay of perception echo C. Zhang et al.                                                                                                                                                                                                                                   Array 18 (2023) 100289
3and ② the relative fading coefficient of the perceptual communication 
channel generated by additional target reflection. With these two pa-
rameters, the CSIN correlation channel model can be constructed [17, 
18], as show in Fig. 1. 
2.3. CSIN waveform design 
At present, the waveform design of the CSIN has three technical 
routes [19]: ① communication centered integrated waveform design, ② 
sensing centered integrated waveform design, and ③ communication 
and sensing combined integrated waveform design.  
1) The integrated waveform centered on communication realizes the 
function of perception based on the existing communication wave -
form. Constant envelope waveform design should be considered so 
that the perception can transmit signals with a maximum available 
power budget without signal distortion. It has good correlation 
characteristics, which minimizes the sidelobe levels of the spatial 
spectrum and reduces the false detection rate of target detection. In 
the integrated waveform design scheme based on cellular mobile and 
Wi-Fi networks, OFDM and FMCW waveforms are combined to 
improve the resolution and accuracy performance of endogenous 
sensing to increase the time-bandwidth product [20].  
2) The integrated waveform design idea centered on sensing embeds 
communication data into the sensing waveform, to which radar 
sidelobe beams send digital communication information and opera -
tions such as embedding communication symbols in the time/fre -
quency domain of radar waveforms are included [21]. Most schemes 
use interpulse modulation instead of intrapulse modulation, which 
results in lower communication rates and spectral efficiency, so radar 
waveforms are limited to medium/low data rate scenarios [22].  
3) Unified design of the CSIN waveform from bottom to top provides 
more flexibility and freedom, for example, in the total transmit 
power and peak-to-average power ratio (PAPR), it is an integrated 
waveform design method that minimizes downlink Multi-User 
Interference (MUI) under the constraints, adds compromise param -
eters to adjust the priority between sensing and communication 
system [23]. The difficulty of this design is that the complexity is 
increased and the hardware is difficult to achieve; it is still in the 
research stage. 
2.4. CSIN frame structure design 
Due to the high frequency, the frame structure of the CSIN is more 
compact and denser. Spectrum characteristics, service requirements, 
time slot distribution and other contents need to be considered. A frame in a period needs to carry more information elements in order to adapt 
large bandwidth and low time delay, high reliable transmission re-
quirements, and more accurate perception of the surrounding environ -
ment [24]. In addition, the frame structure also needs to consider the 
equipment capabilities of different links, as well as the differences in 
transmitted signals in the process of beam scanning, beam matching, 
channel estimation, uplink and downlink data transmission. The design 
of the overall frame structure is based on these changing needs, resulting 
in the integration of communication and sensing functions endogenous 
to the system [25]. 
2.5. CSIN beamforming technology 
The CSIN can realize communication and sensing functions in one 
direction at the same time by adjusting the alignment direction of the 
beam. In addition, the system can be combined with beamforming 
technology to form the direction of multiple beams, which has the 
function of multiple directions. 
Taking the Internet of Vehicles as an example [26], the traditional 
beamforming method does not define the wireless channel environment 
and the pointing relationship of the beam, resulting in the beam often 
failing to aim at the target. A sensor-integrated device can learn the 
wireless channel environment from the acquired sensor information and 
then combine with AI technologies such as machine learning to adapt to 
environmental changes [27], as shown in Fig. 2. 
2.6. CSIN wireless resource management 
Due to the characteristics of integrated hardware devices (rich and 
limited resources) and different business types (time delay tolerance and 
sensitivity), the service requirements for each device or business are also 
different. To improve the system throughput and spectral efficiency, the 
management of wireless resources needs to allocate channel resources 
according to the occupancy status of wireless links, optimization of 
synaesthesia joint performance, and constraints [28]. 
In future smart factories, the dense access of a large number of ter-
minals will bring the problem of network resource congestion and 
interference. Under the premise of ensuring the basic CSIN performance 
constraints of the business, the terminal nodes of dense access can utilize 
resources in various dimensions to achieve the purpose of optimizing 
other indicators. For example, reasonable allocation of shared band-
width for sensing communication, optimization of target positioning 
performance under power constraints, control power allocation of sub-
carriers to optimize system performance, etc. [29]. 
Fig. 1.CSIN correlation channel model.  
Fig. 2.Schematic diagram of intelligent beamforming integrated with 
communication and sensing integrated network. C. Zhang et al.                                                                                                                                                                                                                                   Array 18 (2023) 100289
43.Design of the E-HFWN physical and MAC layer 
This chapter focuses on the PHY and MAC layer design of the E- 
HFWN and introduces two important upgrades to improve the spectral 
efficiency and system capacity of mmWave communications: optimiza -
tion on FWA services and DC enhancement. Although the E-HFWN in-
herits the relevant definitions and principles of the 3GPP R17 version, it 
does not strictly comply with the 3GPP R17 specification. For example, 
the E-HFWN introduces n257/n258 frequency band FWA terminal 
maximum TRP with 23 dBm, multi-RAT DC enhancement, more efficient 
activation and deactivation features for single SCG and SCell, support for 
condition PSCell changes and additions, etc. 
3.1. Subcarrier bandwidth and frame structure design 
The E-HFWN is based on the subcarrier bandwidth and frame 
structure of 5G mmWave. The frequency range is from 28.1 GHz to 28.9 
GHz and has a short data packet design with limited low delay on the 
MAC layer. The E-HFWN adopts cell topology, the base station (BS) and 
access points (UEs) are connected, and the 5G carrier modulation is 
continued based on two waveforms of 802.11OFDM PHY: downlink (DL) 
waveform (frame from BS to UEs) and uplink (UL) waveforms (frame 
from UEs to BS). The frame structure is enhanced and varies with the 
choice of subcarrier spacing. The E-HFWN enhanced frame structure 
proposed for CSIS is designed based on the 5G NR protocol. The new 
structure definition is shown in Fig. 3. 
Fig. 3 shows the frame structure of the NI mmWave CSIS based on 5G 
NR. Each frame is consisted with two half-frames, and contains 10 
subframes, each subframe contains 8 time slots, of which first time slot is 
SF Type0, includes the primary synchronization signal (PSS), the other 
49 time slots are SF Type1, SF Type0 and Type1 can occupy the fre-
quency domains of sensing and communication functions in time and 
space, subslot is 0.125 ms, each time slot contains 14-bit OFDM symbols 
(including CP), the interval of subcarriers is 120 kHz, the duration of 
each subcarrier is 8.33 μs, the system bandwidth is 800 MHz, and 8 
component carriers (CC) are used, each containing 1200 subcarriers. 
The system redesigns the Physical Downlink Shared Channel (PDSCH) as 
a sensing time slot bit and completes the sensing of target location in-
formation through a symbol bit. According to the actual service re-
quirements, it can adjust the position and quantity ratio of sensing 
symbols in the frame structure and achieve efficient utilization of the 
time-frequency resources required for various functions of communi -
cation and sensing. The E-HFWN supports a semistatic or dynamic configuration of up-
link and downlink ratios through RRC signaling or DCI scheduling. Most 
high-frequency frame structures have 5 time slots in one uplink and 
downlink conversion cycle, as shown in Fig. 4. According to different 
needs, different uplink and downlink ratios are chosen, among which 
the pure downlink time slot (marked as D), pure uplink time slot 
(marked as U), uplink and downlink converted time slot (marked as S). 
In the S time slot, GP symbols are reserved for uplink and downlink 
handover, and the number of symbols reserved by GP depends on the 
time of uplink and downlink handover on the UE side and the planned 
cell radius. 
The design of the E-HFWN frame structure is related to the appli -
cation scenarios. This research is aimed at the construction of private 
networks in the field of smart factories. It is used in scenarios where 
upstream services are dominant, and a large number of terminals, 
sensing equipment, and industrial video data uploads are used. The 
dominant frame structure DSUUU has advantages in uplink coverage 
and capacity. 
3.2. E-HFWN carrier aggregation 
The DL waveform uses IEEE 802.11’s preamble, which is quite large 
Fig. 3.E-HFWN frame structure.  
Fig. 4.E-HFWN uplink enhanced frame structure DSUUU (smart fac-
tory scenario). C. Zhang et al.                                                                                                                                                                                                                                   Array 18 (2023) 100289
5structure; therefore, it is not very effective for communicating short 
packets. To provide high efficiency, RT data frames sent by UE to 
different BSs are concatenated into a single frame-through-frame ag-
gregation. The E-HFWN inherits the carrier aggregation function in the 
NR standard. It can support up to 16 carrier aggregations, so there will 
be a service bandwidth of 16 ×400 MHz 6.4 GHz, which exceeds the 
typical spectrum allocation requirements. These carriers can have 
different carrier bandwidths or duplex modes. 
Starting from the terminal, a terminal that supports carrier aggre -
gation can send and receive data on multiple component carriers at the 
same time, and a terminal that does not support carrier aggregation can 
access one component carrier to send and receive data. 
In the E-HFWN, due to the business requirements of certain work -
shops in smart factories, one main cell is set up, and the network can be 
activated to meet the changes in business requirements. Different ter-
minals are configured in this cell, and uplinks and downlinks can 
aggregate different carriers (or cells). Due to the frame structure design 
of Fig. 3, the carrier aggregation needs to be redesigned here. In the 
carrier component of the E-HFWN frame structure, the communication 
and sensing component carriers need to be aggregated and scheduled. 
Since there is only one primary cell, the self-scheduling method is 
adopted, and the grant and transmission data are sent on the same 
carrier, but the communication and sensing subcarriers need to be 
separately processed during self-scheduling, as shown in Fig. 5. 
In terms of control signaling, carrier aggregation needs to support 
Layer 1/Layer 2 uplink control signaling as in the single-carrier case. For 
example, the gNB needs a terminal to feed back the HARQ confirmation 
message so that the gNB can know whether the sensing data are trans -
mitted. The design of carrier aggregation is to transmit uplink feedback 
information in the primary cell, which is convenient to support asym -
metric carrier aggregation (the number of uplink and downlink carriers 
are different in Fig. 4), but in the E-HFWN, the terminals designed for 
smart factories are configured with multiple uplink carriers, and one 
downlink carrier is configured. The downlink carrier will carry a large 
amount of feedback information. To avoid downlink overload, the E- 
HFWN allows two PUCCH groups to be configured. As shown in Fig. 6, 
the first group of communication carriers is configured in the downlink 
primary cell, and the other group is configured in PUCCH as the sensing 
carrier. 
If the aggregated carrier is configured, the terminal can receive or 
send data on multiple carriers. Therefore, while keeping the carrier 
aggregation configuration unchanged, the E-HFWN can activate some 
unused carriers and activate or deactivate component carriers. This is 
done through MAC layer signaling (MAC control cells). 3.3. Channel detection 
To meet the needs of smart factories integrating communication and 
sensing, the E-HFWN has redesigned the CSI-RS structure under the 
original NR. An important design principle of NR is to avoid “always on” 
signals as much as possible. The E-HFWN continues to follow this 
principle. It keeps the synchronization signal block SSB open and ex-
pands the function to better support beam management and mobility as 
a supplement to SSB. 
3.3.1. Downlink channel detection of the E-HFWN: CSI-RS 
The downlink CSI-RS structure of the E-HFWN is given. Due to the 
operation in the 28 GHz frequency band and the description in Sections 
3.1-3.2 , the CSI-RS supports 32 different antenna ports, and each an-
tenna port is one channel that needs to be detected. mmWave phased 
array antennas and beamforming are described in Section 3.4. 
In the E-HFWN, each terminal can configure the CSI-RS. A set of 
multiport CSI-RSs can be regarded as multiplexing mutually orthogonal 
signals on a set of resource unit blocks. The multiplexing method in-
cludes CDM, FDM, and TDM. Different CDM methods can be used 
together with FDM and TDM to support different multiantenna ports 
(CSI-RS mapping). Generally, a CSI-RS of N ports in one resource block/ 
slot occupy a total of N resource units. The 32-port structure of the E- 
HFWN is given below, as shown in Fig. 7, which includes 8✕CDM, uses 4 
times of frequency domain multiplexing at the same time, so that the 
design cannot occupy continuous subcarriers. 
For the downlink channel detection in the 28 GHz frequency band, 
the 32-port CSI-RS design of the E-HFWN structure, the ports are 
numbered from the code domain, then the frequency domain, and 
finally the time domain, as shown in Fig. 7. In the case of 8✕CDM, the 
CSI-RS of 8 adjacent antenna ports are multiplexed together by CDM. 
For the resource block of FDM TDM, in Fig. 7, the sensing functions of 
port groups 0–7 and 16–23 have the same OFDM symbols. The 
communication functions of ports 8–15 and 24–32 are sent within the 
same other group with OFDM symbols. 
CSI-RS frequency domain structure configuration: The E-HFWN 
configures CSI-RS in the entire 800 MHz bandwidth. Due to the large 
number of ports, each resource block is configured with one CSIS-RS, 
and the density is 3. In the CSI-RS configuration, the information spec-
ifies the part of the resource block that carries the communication and 
sensing, three subcarriers that carry the CSI-RS in one resource block, 
which are used to track the reference signal configuration. 
CSI-RS resource set: The E-HFWN adopts periodic transmission. Due 
to the strong periodicity of data transmission in smart factories, the 
transmission period of the CSI-RS is configured as 4, and the time slot 
offset is 3; that is, the terminal sends every 4 time slots. Then, the CSI-RS 
can be correctly found where the time domain offset is 3 slots. 
Tracking the reference signal: Due to the nonideal nature of the 
crystal oscillator, the terminal must track and compensate for the 
reference model in the time and frequency domains to ensure the 
Fig. 5.E-HFWN cell carrier aggregation self-scheduling.  
Fig. 6.Allocation of multiple PUCCH groups.  
Fig. 7.32-port CSI-RS support E-HFWN structure.  C. Zhang et al.                                                                                                                                                                                                                                   Array 18 (2023) 100289
6successful reception of downlink data. The E-HFWN tracking reference 
signal contains 4 single-port CSI-RSs with a density of 3. These CSI-RSs 
are distributed in two consecutive time slots. As shown in Fig. 8, the CSI- 
RS in the resource set, that is, TRS, has a period of 10 ms, and the in-
terval between two CSI-RSs is 4 OFDM symbols in each time slot in the 
time domain. The spacing of the reference signal in the time domain (4 
subcarriers) limits the maximum estimable frequency and timing error. 
Because the TRS design of the E-HFWN has one antenna port and 
occupies two time slots in the cycle, the overhead introduced is smaller 
than that of 5G. 
3.3.2. Uplink channel detection of the E-HFWN: SRS 
Since the uplink SRS and downlink CSI-RS are both detection chan-
nels (different directions), there are similarities. Here, the SRS structure 
diagram of the E-HFWN is given, as shown in Fig. 9, and the imple -
mentation details of the SRS are described. 
The E-HFWN continues the SRS structure design idea and places the 
OFDM symbols of the SRS in the last two positions in a time slot period. 
In the frequency domain, the SRS selects one subcarrier for every two 
subcarriers to carry SRS. In addition, according to the communication- 
sensing integration feature, the SRS signals sent by terminals with 
different functions will be multiplexed in the same frequency range. For 
the configuration in Fig. 9, the SRS sent by the communication or 
sensing terminal will occupy one of the two OFDM symbols so that the 
frequency domain multiplexing of 2 SRSs can be realized. 
SRS sequence and Zadoff-Chu sequence: The design of the E-HFWN 
transmission SRS sequence is based on the Zadoff-Chu sequence [30]. 
Since there are many citations about this sequence, it will not be 
repeated here, but its definition is given: 
zu
ie jπuii1
M0≼iDM (1)  
where u is the root index of Zadoff-Chu. For a Zadoff-Chu sequence of 
fixed length (M, generally a prime number), the root index can generate 
a unique Zadoff-Chu sequence. 
Multiport SRS: The E-HFWN supports multiantenna port channel 
detection. Different ports can use the same resource unit and SRS 
sequence. The SRS sequences sent by each antenna port are 
Fig. 8.TRS is distributed in two consecutive time slots, CSI-RS: including 4 
single-port, density is set as 3. 
Fig. 9.Communication-sensing terminal multiplexing with two different 
functions, SRS frequency domain multiplexing structure. 
Fig. 10.Different phase rotation of SRS sequence to distinguish multi- 
antenna ports. 
Fig. 11.CSI-RS and SRS are mapped to physical antennas through spatial filter 
F (N » M). 
Fig. 12.Different spatial filter F designs for downlink CSI-RS and uplink SRS.  C. Zhang et al.                                                                                                                                                                                                                                   Array 18 (2023) 100289
7distinguished from each other by phase rotation, as shown in Fig. 10. 
SRS resource set: The E-HFWN configures multiple SRS resource sets 
for communication and sensing terminals. Each resource set contains 
multiple SRSs, a single SRS is sent periodically, and the SRS in the 
resource set must be the same type (such as communication or sensing). 
The SRS is triggered by DCI signaling in the resource set, which includes 
2-bit SRS-request activation transmission. 
3.3.3. Physical antenna mapping of the E-HFWN 
A multiport CSI-RS or SRS can provide sounding reference signals for 
channels corresponding to a group of antenna ports. The channels 
detected by the terminal through CSI-RS or SRS are not wireless chan-
nels corresponding to physical wireless. Before the RS is mapped to the 
physical antenna, a spatial filter F is used to transform the CSI-RS or SRS 
(linear transformation). The CSI-RS and SRS of the E-HFWN use the 
same set of logical structure diagrams, as shown in Fig. 11. 
From the perspective of the terminal, logical channels (CSI-RS or 
SRS) of M ports are used for channel estimation, while the N physical 
antennas and spatial filter F are invisible to the terminal. 
The F filters are different for downlink and uplink. In the downlink, 
the E-HFWN designs a different F for each configured CSIS-RS so that the 
CSIS-RS beams can be shaped in different directions, as shown in Fig. 12 
(a). In this design, although the two CSI-RSs share the same set of an-
tennas and physical channels, from the perspective of the terminal, two 
CSI-RSs are sent through two different channels, and different CSI-RSs 
can represent communication ports or sensing ports so that the 
communication-sensing is separated for channel detection. 
In the uplink, the terminal adjusts the direction of multiple antenna 
panels at a high frequency. At this time, SRS maps the SRS antenna port 
to a set of physical antennas on the antenna panel through F, and each 
antenna panel has a different spatial filter, as shown in Fig. 12(b). The 
advantage of this design is that the transmitted beam has a specific di-
rection or angle in space. 
3.4. Large-scale antenna technology (beamforming) 
E-HFWN beamforming needs to consider both communication and 
sensing requirements of network nodes. The sensing function needs to 
generate a beam scanning effect to achieve a wider range of target 
detection, while the communication function needs to generate a beam 
that is aimed at the communication receiver to ensure reliable and stable 
large-capacity communication. The high frequency band and short 
wavelength of the 28 GHz mmWave give it a space advantage in design and deployment, and it is suitable for combining with beamforming 
technology to enhance performance and reduce interference. 
At the high frequency of the E-HFWN, considering a limited number 
of digital channel MIMO schemes, joint beamforming is performed 
through digital and analog domains; that is, analog-digital hybrid 
beamforming technology is used, as shown in Fig. 13. The transmitter 
(or receiver) consists of multiple subarrays to form an antenna array, 
where each subarray can steer the beam using an RF phase shifter. In the 
analog domain, a low-cost phase shifter is used to realize beamforming 
in a single propagation direction of high-frequency signals; in the digital 
domain, a baseband processor is used to realize the joint beamforming of 
multiple propagation directions. Through the CSI feedback of the UE or 
the measurement of the uplink signal, the weighting coefficient of each 
array element in the antenna array is adjusted to generate a direction 
beam so that a significant array gain can be obtained. 
The design of transmission matrix W of the E-HFWN is given below: 
The E-HFWN inherits the design of Release-16 Type II CSI precoder, but 
here the communication and sensing signals are separated, and we make 
an enhanced design, import the concept of frequency domain unit to 
achieve, which supports compressed frequency domain operations. As 
shown in Fig. 13, given k layers, the precoders of all communication- 
sensing frequency domain units can be expressed as: 
[
w1
kC⋯CwN
kCwN1
kC⋯CwNM
k]
W√W2CkWH
fCk (2)  
WW1W2 (3)  
where N and M are the number of frequency domain units reported by 
sensing and communication, w1
kC⋯CwN
krepresents the vector set 
composed of precoders corresponding to all frequency domain units in 
the sensing layer, wN1
kC⋯CwNM
krepresents the vector set composed of 
precoders corresponding to all frequency domain units in the commu -
nication layer, W is the transfer matrix (matrix dimension is (N M)K×
(N M)), W is mapped to (N M)K physical antennas, the output is y, 
W1 represents long-term and frequency-independent channel charac -
teristics, the terminal reports one W1 for the entire reporting bandwidth 
(bandwidth reporting), W2 indicates the frequency-related channel 
characteristics captured in the short term, and the terminal reports one 
W2 for each subband. Here, W1 can be regarded as a beam pointing in a 
specific direction, which can be expressed as: 
W1⌊
B0
0B⌋
(4)  
where each column of matrix B corresponds to L selected beams, as 
shown in Fig. 13, Eq. (4) has a 2 ×2 structure, two diagonal blocks 
correspond to two polarization directions because W1 capture long-term 
and frequency-independent channel information, so the same beam is 
used in these two polarization directions. At this time, W1 or B is 
selected, which actually selects a specific beam from possible beams, so 
W1 is actually the beam direction. 
To distinguish communication and sensing signals, the E-HFWN sets 
the rank of matrix W to 2. At this time, W1 defines four adjacent beams 
corresponding to four columns of B, so the function of W2 is to choose 
which direction to transmit. Since W2 reports each subband information, 
the beam direction and interpolarization phase can be adjusted, so W1 
and W2 can adjust the directions of the sensing and communication 
beams, respectively. 
In E-HFWN-enhanced CSI, it can be seen from Eq. (2) that there are k 
transmission layers, and there are k precoding vector sets. Each set 
contains N sensing and M communication precoding vectors. After this 
design, for a certain frequency domain unit n (sensing) or m (commu -
nication), the precoding matrix that maps the transport layer to each 
antenna port can be obtained, expressed as: 
Wn√
wn
1C⋯Cwn
kCwm
k1C⋯Cwm
kM⇑
(5) 
Fig. 13.Hybrid beamforming (analog digital).  C. Zhang et al.                                                                                                                                                                                                                                   Array 18 (2023) 100289
8The precoding vector corresponding to a specific transport layer is 
w1
kC⋯CwN
kCwN1
kC⋯CwNM
k. 
In addition, in Eq. (2), WH
fCk is the enhanced compression matrix 
introduced by the E-HFWN, and its dimension is (N M)×(N M)K. 
The compression matrix performs DFT on (N M)K frequency domain 
units, converts the beam domain into the delay domain, and then selects 
the smaller (N M) row value. Since WH
fCk is a frequency-independent 
matrix, all frequency-domain resource blocks share the compression 
matrix, and each layer is separately reported. √W2Ck is a matrix introduced 
by the E-HFWN to map the delay domain back to the beam domain, and 
its dimension is 2L ×(N M), which is a different mapping from the 
frequency domain to the beam domain in Eq. (3), mapping from the time 
domain can reduce the reporting overhead. 
3.5. Beam management 
After beamforming in the previous section, it needs to be managed. 
The beam management of the E-HFWN includes functions such as beam 
scanning and tracking. The purpose of beam management is to improve 
the signal transmission gain of BS and UE, increase the data transmission 
rate, and enhance network coverage. On the one hand, based on inte-
grated synaesthesia waveform technology, the dual functions of 
communication and sensing can be realized by adjusting the beam di-
rection; on the other hand, beamforming technology can also be used to 
construct multiple beams to achieve the dual functions of communica -
tion and sensing in different directions. 
To ensure sufficient signal gain, the beam generated by a large-scale 
antenna array needs to be narrow, and the BS needs to use a large 
number of narrow beams to ensure that UEs can be covered in any di-
rection of the cell. To align the beam, the E-HFWN adopts a hierarchical 
scanning strategy, that is, scanning from wide to narrow. Hierarchical 
scanning can be carried out at any time according to the needs of the 
terminal, and the optimal beam can be switched with the terminal 
location. At the same time, to better track UE, beam tracking needs to be 
used, as shown in Fig. 14. 
3.5.1. Beam capture in the access phase 
The terminal in the idle state scans the SSB signal in turn to find the 
SSBID1 with the best signal on the BS and the best receiving beam on the 
terminal. Then, the terminal sends Msg1 on the RO (Rach Occasion) 
resource corresponding to this SSBID. The BS receives Msg1 and knows 
which beam to use to communicate with this terminal. The beam cor-
responding to this SSBID is used in the synchronization and access 
process of subsequent beam capture. 3.5.2. Beam scanning and tracking in the connected state 
P1 process : Both BS and UEs use wide beams, the UE performs beam 
scanning and then informs BS through the CSI report. The wide beam 
that UE receives from the BS has the best signal quality. 
P2 process : In an industrial scene, to meet the traffic requirements of 
edge terminals, some narrower beams, called refined beams, are 
designed for remote UEs. Through the P1 process, the receiving beam of 
the UE is determined, and then through the P2 process, the refined beam 
is determined. P2 process is that the receiving beam on UE remains 
unchanged, BS transmits the refined beams in turn, UE informs BS 
through CSI report, which refined beam has the best signal quality, BS 
can use refined beam to communicate with UE in traffic channel, to 
obtain higher gain, this process also called beam alignment. 
P3 process : Sometimes high-precision terminals (such as mmWave 
radars) also have their own refined beams. At this time, the P3 process is 
used to determine the refined beams used by the terminal. In the P3 
process, the transmit beam on the BS remains unchanged, the UE 
switches the receive beam and then selects the beam with the best signal 
quality as the beam of the service channel. The beam selection and 
switching on UE are not perceived by BS. 
3.6. E-HFWN resource allocation and scheduling 
In the E-HFWN, the focus is the optimization of communication- 
perception wireless resource management. Millimeter-wave radar can 
obtain the knowledge map information of targets in medium- and high- 
frequency bands, such as distance, direction, speed, and attitude. The 
physical quantity information collected by the E-HFWN is larger than 
that of traditional sensors, and E-HFWN performance optimization is a 
multitarget (dual-target) problem that optimizes the performance of 
perception radar and communication systems. The solution is to obtain 
the Pareto optimality of the objective function. To maximize the amount 
of information detected by radar, the E-HFWN can be modeled as a 
perceptual radar maximization problem with channel capacity. Ac-
cording to Ref. [31], the optimization problem can be defined as: 
max
aIrad (6)  
sBtBC1Ban∃ΩtC⊥n  
C2BIsen
i≼Icom
i  
C3BΔi≼Δmax
i  
where Irad represents the total channel MI, which can be expressed as 
Irad⋃N
i1Irad
i, and Irad
i represents the i-th communication-sensing 
channel within the coverage of the BS. The goal of E-HFWN resource 
optimization is to maximize Irad. ana1Ca2C⋯Candenotes the time slot 
duration sequence of the sensing resource block, n denotes the time 
index, and Ωt denotes the set values of an, that is, the extent of the slot. In 
Fig. 14.Communication-sensing beam scanning and tracking process.  
1 Communication waveforms, sensing waveforms, communication-sensing 
integrated waveforms are distinguished by SSBID. C. Zhang et al.                                                                                                                                                                                                                                   Array 18 (2023) 100289
9a cycle, Isen
i and Icom
i represent the perceptual channel capacity and 
communication channel capacity in the i-th channel, respectively. Δi 
represents the age of information (AoI) of the i-th signal, and Δmax
i 
represents the maximum link time. Constraint C1 provides the duration 
of each sensing terminal, Constraint C2 ensures that the sensing infor-
mation of each terminal can exist, and Constraint C3 ensures that the 
data transmission efficiency is lower than a certain threshold when the 
packet transmission is successful. 
In Eq. (6), the channel MI is a measure of the communication and 
sensing channel. For the convenience of processing in the following al-
gorithm, Eq. (6) can be redefined as: 
γrad
iρsenIsen
iρcomIcom
i (7)  
where ρsen and ρcom are service weight values for distinguishing sensing 
and communication identifiers, ρsen ρcom 1, and the service weight 
value can be adjusted to set the priority of communication and sensing 
channels [32]. adopts a game theory-based algorithm for Eq. (7). Due to 
the randomness of indoor perception signals and service requests in 
smart factories, the actor-critic-based algorithm is adopted in this paper. 
The RL framework divides the resources of Eq. (7), the goal is to maxi-
mize the amount of MI for generating sensing signals and minimize the 
end-to-end delay of the sensing terminal. 
3.6.1. Policy and value function 
The allocation strategy is to choose a long-term performance opti-
mization behavior. As mentioned, the industrial scene is complex, and 
the sensing signal and service request have a certain randomness. 
Therefore, a random strategy πan†IiPrasen
ian⃦⃦Isen
iIiis adopted 
for the allocation strategy of MI in the sensing channel; that is, according 
to the E-HFWN frame structure, the random strategy is determined by 
the probability distribution of the arrival time in the sensing time slot. 
The Q-value is defined as starting at time t, the channel MI is Ii, and the 
time slot duration is an, expressed as: 
QπIiCanE\̂N
k0βkγrad
k⃦⃦πCIsen
iIiCasen
ian〈
(8)  
where β∃0C1is the discount factor, and the optimal Q-value is the 
maximum achievable with optimal action for all decisions. When using 
this value to estimate the channel state and the optimal Q value of slot 
permutation (Ii, an), it is necessary to choose greedy permutation to 
obtain the policy, which is: 
πan†Iiarg max
anQπIiCan (9)  
3.6.2. Value function approximation using a DNN 
Due to the large number of subcarriers in the E-HFWN, the channel 
estimation and time slot allocation dimensions of solving Eq. (9) are 
high, and the calculation of the channel state and time slot arrangement 
is expensive. In recent years, due to the progress of machine learning, it 
has been easy to solve a problem that satisfies a certain law in the 
probability space, especially when DNN technology is used to approxi -
mate the Q-value. Here, QπIiCanis denoted as QwIiCan, the DNN is 
used to connect multiple hidden layers, and the weight is set as w⊔w1C
w2C⋯Cwn⊓. The input layer of the DNN has two units to import systems Ii 
and an into the hidden layer and uses ReLU as the nonlinear activation 
function. The output of the j-th neuron in the i-th layer can be expressed 
as: 
yijmax}
0C 
wi⋅xibij)〈
(10)  
where yij is the output value, xi is the input of the i-th layer, wi is the 
input weight of the corresponding neuron, and bij is the bias. The output 
layer of the DNN provides the estimated Q-value QwIiCan. All that needs 
to be done is to minimize the loss function and train the DNN to deeply learn the best fit weights w. 
LwE⌊
γrad
iβmax
an1QwIi1Can1 QwIiCan⌋2
(11)  
where w is the parameter of the neural network and Lwis the error 
value corrected by the DNN. The difference between the target and 
estimated value is called the adjustment error and is expressed as γrad
i
βmax
an1QwIi1Can1 QwIiCan. 
For the solution of Eq. (9)~(11), there are: 
Critic network : The critic is responsible for the estimation or 
approximation of the value function, i.e., QπIiCan≪QwIiCan, the DNN 
can be used to represent the critic structure in deep RL. However, due to 
the nonstationarity of the target and correlation between samples, the 
neural network may cause the RL algorithm to diverge or fail to learn. 
Therefore, a fixed target network [33] and experience replay [34] are 
used to establish the critic network to avoid the divergence of the 
learning algorithm. 
Actor network : The actor uses the policy gradient algorithm to 
evaluate and improve policy, mainly by the agent observing a large 
number of training samples, among which for a certain signal (such as 
communication), a higher priority is a positive reward, and a lower 
priority for another signal (sensing signal) is a negative reward, thereby 
increasing the probability of network communication and reducing the 
probability of sensing occurring. Usually, the initialization of the strat-
egy is to design a set of parameters θ⊔θ1Cθ2C⋯Cθn⊓and then use 
another set of parameterized DNNs to represent the actor structure. With 
the goal of maximizing MI, the strategy is iteratively improved, which is 
defined as the strategy objective function given by Ref. [35]: 
JπθEQπIiCan̂
Sds̂
Aπθan†IiQπIiCan (12)  
where dsis the channel state distribution. Partial differentiation of the 
objective function with respect to the parameter θ can obtain the 
gradient of the optimal solution and then find the fastest direction of 
gradient change, which is the final strategy for the actor network 
solution. 
The Lwof the error calculation can be calculated by the output of 
the critic network plus the instantaneous channel MI; the process is 
shown in Fig. 15. 
3.6.3. Actor –critic RL algorithm 
According to the aforementioned optimization objective and 
constraint form, as well as the definition of each parameter, the 
actor –critic RL algorithm is given:  
1) The actor network initializes random policy πθan†Ii, the critic 
network defines parameterized value function approximation QwIiC
an, and both target networks are initialized with random weights θi 
and wi. 
Fig. 15.Actor-critic deep learning-based E-HFWN resource allocation.  C. Zhang et al.                                                                                                                                                                                                                                   Array 18 (2023) 100289
102) The actor network is generated at time t, according to current policy 
πθan†Iiand channel MI’s Isen.  
3) The RL observes the next state of Ii1 in sensing channel MI, and γrad
i 
in total channel MI stores tuple (IiCanCγrad
iCIi1) in buffer D.  
4) Randomly sample a mini-batch of S-tuples from the buffer.  
5) For any sample s ∃S, the critic estimates the Q-value approximately 
QwIiCanand computes the error Lw, indicating whether the 
(critique) operation (current policy) performs well and updates the 
parameter w using the mean value of the mini-batch to minimize the 
loss function.  
6) For any sample s ∃S, the Actor uses the output (loss function and 
estimated Q-value) to calculate the gradient value; at the same time, 
updates the parameter θ in the direction where the average gradient 
of the sample changes the fastest to update the output.  
7) The actor and critic network are jointly allocated resources, and the 
obtained E-HFWN resource scheduling parameters are updated and it 
iterates once when LwFLwmax, which is the resource allocation 
rate. 
The above algorithm process is written in pseudocode form as shown 
in Table 1. 
4.Numerical simulations 
Since the allocation of communication and sensing channels is 
crucial in the E-HFWN, starting from data acquisition, determines the 
basis of service quality in the entire system. The actor-critic deep RL 
algorithm performed numerical simulations. First, parameters are set. 
When simulating the E-HFWN numerically, the number of BSs is set to 1, 
and the number of UEs is set to 20, including N communication modules 
and M sensing terminals, N M 20. Each time a decision is made, the 
number of BSs and UEs remains the same, and only the number of car-
riers for communication and sensing channels changes. Since the service 
request can be divided into multiple subtasks, the channel can be 
divided into multiple subchannels and carriers, the communication or 
sensing ID of each UE can be determined at a specific time (i.e., multiple 
time slots), and the service of each terminal can be determined. The 
service request can be regarded as a subcarrier in each time slot, which is 
mapped to a time-frequency resource block. After this setting, each UE 
has a fixed service request type in each time slot. Without loss of generality, the average channel MI is set as {1, 4, 8, 
16, 32} in a time slot, where γ1 means MI is the worst, and γ32 
means MI is the best. These five channel states allocate time slot re-
sources on MI between UE and BS according to the channel conditions of 
the industrial field environment. As mentioned above, the total band-
width is 800 MHz, 8 component carriers (CCs) are used, and each CC 
contains 1200 subcarriers. When the equipment terminal allocates a CC 
(communication or sensing channel), the information rate of UE belongs 
to {1, 2,3,4,5}, the E-HFWN sets a connected DNN, it has two hidden 
neuron layers, the number of neurons in hidden layer is set as 300, it is 
verified that the DNN is trained offline at this time, the computational 
complexity is low. In the actual situation (Chapter 4), the number of 
neurons is set according to the computational capability of the field 
terminal. To improve the efficiency of resource allocation and maximize 
the MI, actor-critic generates two independent training networks. When 
LwDLwmax, the network updates the parameters, sets the size of 
network data buffer D to 10,000, the sample space S is set as 64, the 
duration of the time slot sequence is 0.125 ms, a single step is 8.33 μs, 
and the service weights of actor-critic are ρsen ρcom 0.5. 
First, from the numerical simulation results, the mathematical 
analysis of the channel resource block allocation of the E-HFWN, espe-
cially in the optimization strategy of communication-sensing resource 
allocation, verifies the convergence of the natural gradient ascent 
method and the standard gradient ascent method. In contrast, the nat-
ural gradient ascent method is suitable for the joint optimization of Table 1 
Actor-critic deep RL algorithm with communication-sensing resource allocation.  
Initialization 
Initialization the actor network ’s θ and its target θn, 
Initialization the critic network ’s w and its target wn, 
Initialization the error Lwmax, 
network buffer D 
for sample 1 to S do 
set environment channel (com sen) MI I1, and set 
γrad
i0, θθi, wwi 
for time step 1 to amax do 
generate a time slot ai according to πθan†Ii
generate subcarrier channel Ii according to QwIiCan
observe sensing MI Ii1 and subsequent channel MI 
γrad
i, store the tuple (IiCanCγrad
iCIi1) in D 
small batch samples of S-tuples are extracted from D 
for s ∃S do 
if LwDLwmax, 
update the critic network weight: 
γrad
iβmax
an1QwIi1Can1 QwIiCanw →  w 
update the actor network weight: ⋃
Sds⋃
Aπθan†IiQπIiCanθ→ θ 
else LwFLwmax 
network proceeds to the next iteration 
end for 
end for  
Fig. 16.Algorithm solve trajectories using Standard gradient (dashed) and 
Natural gradient (solid). C. Zhang et al.                                                                                                                                                                                                                                   Array 18 (2023) 100289
11multiple objectives. The resource allocation of communication-sensing 
channels in the E-HFWN belongs to this optimization problem, while 
the standard gradient method is suitable for the design of a single 
optimization objective. The convex optimization modeling graph of 
Jπθin Eq. (12) uses the natural gradient method (black solid curve) 
and standard gradient method (black dashed curve) to optimize and 
solve, as shown in Fig. 16. The horizontal ordinate represents the in-
terval in which the time slot is the step size, and the vertical axis rep-
resents the optimized objective function (Channel MI). 
It can be seen from Fig. 16 that the actor-critic algorithm can search 
for the optimal point of the objective function in the steepest ascent 
direction, near (1.2,  1.7); when using the standard gradient or other 
optimization methods, the trajectory is deviated for finding the optimal 
solution in resource allocation, and it obtains (1.5, 0.9), (0.6,  0.7), 
(2.2, 0.1) and other local optimal points, leading to a decrease in the 
efficiency of system resource allocation, which cannot meet the needs of 
multiple services. 
5.Results and analysis 
The E-HFWN has designed a software simulation platform and 
hardware test system. Under the premise of the actor-critic-based 
communication-sensing resource allocation algorithm, the mmWave 
performance in sections 3.1-3.5 is verified, divided into communication 
and sensing. The communication indicators include the peak rate, sys-
tem capacity, and network delay, and the sensing performance in-
dicators include the sidelobe ratio and spatial resolution. Various 
functional analyses of the built E-HFWN hardware test platform verify 
the feasibility of the 28 GHz millimeter-wave. Table 2 lists the technical 
parameters of the E-HFWN system. The transceiver gain of the radar 
wave antenna is the same as that of the communication system, the main 
lobe beam width is set to 18 dB, and the transmit power of the 
communication and radar system is 10 W [36]. The specific system 
parameters are shown in Table 2. 
To meet the coverage requirements of millimeter waves, the E- HFWN is built in the laboratory environment, and the coverage radius is 
less than 10 m, so this experiment did not verify the system coverage. 
Several mmWave radars and communication terminals are distributed in 
the laboratory. The fading factor of line-of-sight transmission between 
BS and UE is 2.35. The wireless channel is a frequency selective channel, 
and the Rayleigh flat fading channel model is adopted. 
The E-HFWN realizes the radar detection function in the sensing 
stage. A set of FPGA hardware test boards is designed to load the E- 
HFWN frame structure in Section 3.1 based on the 5G NR mmWave 
frame. The E-HFWN operates on a 28 GHz frequency band and consists 
of two NI 5G mmWave platforms and two 64-element phased array 
antennas, as shown in Fig. 17. 
The structure of the E-HFWN test platform is shown in Fig. 17, in 
which both the transmitter and receiver are connected to the phased 
array antenna. In the working stage, the receiver first operates in radar 
mode, indicated by the yellow line in the figure. It detects the sensing 
information and marks the ID in front of the data bit. Then, the 
communication-sensing integrated FPGA processing board connected to 
the antenna switches to the communication mode, establishes the 
Sender →UE→Receiver mmWave link through beamforming and man-
agement mechanism designed in sections 3.4-3.5 , as shown by purple 
and blue lines in Fig. 17, and transmits the sensing data in the previous 
stage of radar mode operation to the receiver side. The final formed field 
test platform is shown in Fig. 18. 
The hardware test bench is shown in Fig. 18. In a laboratory envi-
ronment, protocol processing center ④ of the E-HFWN is connected to 
the fronthaul network RRU ① side through southbound interface ⑤. In 
the RRU, two phased array antennas are connected to the Tx and Rx ends 
of the radio head as a transmitter and receiver. Table 2 
Technical parameters of E-HFWN.  
Parameter Value 
Cell radius 10 m 
Center frequency 28 GHz 
System bandwidth B 800 MHz 
Subcarriers 1200 
Subcarrier spacing 120 kHz 
Duration of subcarrier 8.33us 
Noise power spectral  174dBm/Hz 
BER 10–4 
BS maximum power 10w 
Tx/Rx antenna gain 18 dB 
Distance between terminals D10 m  
Fig. 17.Testbed architecture of E-HFWN system.  
Fig. 18.Hardware testbed of E-HFWN system (Scene 1).  
1. mm-wave RRU and phased array antenna. 2. Terminal controller 3. Terminal 
4. Communication-sensing integrated control processing card of E-HFWN 5. 
feedforward network and interface C. Zhang et al.                                                                                                                                                                                                                                   Array 18 (2023) 100289
12On the terminal side, it is composed of a mmWave sensor ③ and 
controller ②. This experiment collects and detects physical quantities 
such as the number of people, moving trajectories, and speed in the 
environment space. To test the functions of the mobile terminal for E- 
HFWN beamforming and management, a set of test field environments 
are added, as shown in Fig. 19. It is a mobile sliding table. The mmWave 
sensor can move with the sliding table at a certain speed, and the beam 
direction will change with the angle of the sensing probe facing antenna 
①. 
In Fig. 19, the moving speed of slider ② is 0.1 m/s, and the data 
refresh interval of the mmWave radar is 10 ms. This scenario verifies the 
ratio of the main lobe and side lobe of the E-HFWN beam and the beam 
accuracy toward mmWave radar. The receiver Rx performs 4096-point 
inverse fast Fourier transform (IFFT) processing on the reflected echo. 
The measurement results show that the moving speed of target ② is 
0.0996 m/s, the accuracy is ±0.0004 m/s, and the detection error of the 
mmWave is within 0.4%. 
5.1. Peak rate of the E-HFWN 
In 3GPP TS 38.306, the calculation method for the peak rate is as 
follows: 
PRMbps
10 6⋅̂J
j1⌊
Vj
Layers ⋅Qj
m⋅Fj⋅Rmax⋅NBWjCμ
PRB ⋅12
Tμ
S⋅ 
1 OHj)⌋
(13)  
where PR represents the peak value rate, J represents the number of 
carriers, μ represents the order number, Vj
Layers represents the number of 
space reuse layers, Qj
m represents the number of modulation orders, Fj
represents a proportional factor, and Rmax represents the maximum 
channel coding rate. NBWjCμ
PRB represents the total number of PRBs, Tμ
S 
represents the time for OFDM symbols, and OHjrepresents system 
overhead. The peak rate of the E-HFWN can be increased by increasing 
available resources and reducing overhead. The mmWave band is a TDD 
multiplex, and different TDD frame structure configurations can affect the uplink peak rate. 
According to Eq. (13), this study compares three systems, 5G and 5G 
mmWave and the E-HFWN, and performs a performance analysis of the 
UE peak rate and cell peak throughput. The construction and operation 
of 5G and 5G mmWave systems are in the previous research foundation 
of our laboratory [37]. For a 28 GHz consecutive 800 MHz bandwidth 
spectrum, the current single user can support SU-MIMO carrier aggre -
gation transmission of downlink 8 ×100 M or 4 ×200 M, uplink 2 ×100 
or 2 ×200 M. The community can support the uplink and downlink 800 
M, 4-run MU-MIMO transmission, and the TDD uplink and downlink 
timing ratio is 3:1, as shown in Fig. 20. 
According to the number of terminals and network services (sensors, 
controllers, motors, etc.) in the experimental environment, the Monte 
Carlo service model is used to implement and verify the performance of 
5G/5G mmWave/E-HFWN data services, 12 mmWave sectors are 
deployed in the laboratory environment, and the average number of 
CPEs with valid service connections is 2 (related to the service activation 
model) in each sector. As seen in Fig. 20, the more flexible frame 
structure scheme DSUUU proposed by the E-HFWN is suitable for large 
uplink services such as factories and laboratories, and it can be allocated 
according to service requirements to meet service differentiation. The 
experimental platform shows that the average single-user PR of the E- 
HFWN can reach up to 2.15 Gbps under 64QAM modulation and 3.5 
Gbps under 256QAM modulation; in cell mode, it can reach up to 4.35 
Gbps under 64QAM modulation and up to 4.35 Gbps under 256QAM 
modulation. Up to 6.45 Gbps, the performance of PR is better than that 
of the 5G and 5G mmWave systems, and the PR of 5G is approximately 
half that of the E-HFWN, which shows that the mmWave physical and 
MAC layers designed have been enhanced. 
5.2. Capacity of the E-HFWN 
For high-frequency network performance, the main indicators are 
the number of users and average throughput rate of the cell. The number 
of users can be represented by the number of RRC connected terminals, 
CAPS and the number of terminals per scheduling period. The cell 
throughput rate can be calculated from the average and edge throughput 
Fig. 19.Hardware testbed of E-HFWN system (Scene 2). 
1.mm-wave RRU and phased array antenna. 2. Move slider 3. Electric ma-
chinery 4. Guide rail 
Fig. 20.Downlink PR with same frame structure, different network system and 
modulation order. 
Fig. 21.System capacity under Uma model (coverage radius D50 m).  C. Zhang et al.                                                                                                                                                                                                                                   Array 18 (2023) 100289
13rates. The number of high-frequency terminals is related to the wireless 
resource configuration of uplink and downlink control channels, which 
can be analyzed from channel capacity indicators such as PDCCH, 
PUCCH, and SRS. Similarly, this study verifies and analyzes the network 
capacity of 5G, 5G mmWave and E-HFWN systems. The capacity com-
parison results obtained are shown in Fig. 21, where the CPE transmit 
power is 40 dBm. 
The throughput of high-frequency waves is related to the environ -
ment and the capabilities of the system itself. Because the network is 
formed in a laboratory environment, the channel impact of the scene is 
small, mostly line-of-sight propagation, and the terminal is placed in an 
obvious space environment. It is distributed where the signal power is 
stronger; the capability of the system itself includes technical indicators 
such as system bandwidth, beamforming capability, resource sched -
uling, and anti-interference. Based on the above conditions, the design 
of the E-HFWN system has a significant improvement in cell throughput. 
On the basis of the original 5G mmWave, the system bandwidth is 
increased, MU-MIMO pairing is optimized, and the MU-MIMO ratio is 
increased. At the same time, the actor-critic deep learning 
communication-sensing resource allocation algorithm (section 3.6) im-
proves the efficiency of resource allocation and further improves the cell 
throughput rate. 5.3. End-to-end delay of the E-HFWN 
Another major feature of the E-HFWN is the low end-to-end trans -
mission delay. In 5G, data are scheduled in units of time slots. The 
shorter the air interface time slot length is, the smaller the transmission 
delay at the physical layer. The air interface time slot length of the E- 
HFWN is 0.125 ms, which is 1/4 of the current mainstream 5G medium- 
and low-frequency systems. Therefore, the E-HFWN is lower than the air 
interface delay of the 5G/5G mmWave system. The E-HFWN air inter-
face delay measured can be less than 1 ms in the laboratory, which ex-
ceeds the service quality requirements of 5G URLLC. 
Next, the end-to-end (sensor-to-actuator) delay of the E-HFWN sys-
tem is analyzed by calculation. The parameter settings of the network 
data stream (F) and frame (f) are shown in Table 3, f ∃F. 
The above parameters are used to establish data transmission models 
with different rates, link utilization and queuing delay. To simplify the 
calculation, the transmission interval of interference flow and BE flow 
(best effort) is known; then, the delay calculation of each node on the 
path is as follows: 
ti
arriveBSCjttrantproptprocti
sendCj (14)  
ttranSi∗8\
c (15)  
tsittrantprop (16)  
ti
sendCj|
⨆⨆〈
⨆⨆⎜start timej1
ti
sendCj 1tsi 
tsi≽diand jF1)
j 1di 
tsi≼diand jF1)(17) 
For ti
queneCj, in the QCI protocol of the E-HFWN, a gate control list is set 
on the outgoing port of the air interface. In the delay design of the E- 
HFWN, the time is divided into three time-slot windows: protected 
window, unprotected window, and guard. In each slot window, a 
different stream is transmitted. Therefore, for the service flow, if it ar-
rives at the switch at the same time, it is sent according to its priority, 
and the following variables are set: 0⊃T0 is protected window, which 
transmits general service flows (i 1), T0⊃T1 is unprotected window, 
transmits BE flow (i 2) and the interference flow (i 3), T1⊃T2 is the 
guard, and all business flows are not transmitted. First, we analyze the 
transmission in the first cycle, that is, under the condition 
(ti
arriveBSC1≼T0): Table 3 
Delay parameter of E-HFWN data stream and frame.  
Parameters Meaning 
Si The packet size of i-th data flow 
pi The priority of i-th data flow 
di Packet interval of i-th data stream 
ti Start time of i-th data stream sent from terminal A 
tsi The time that i-th data flow occupies wireless link 
ti
sendCj The time when j-th packet of i-th data stream is sent from terminal A to 
BS 
ti
queneCj The time when j-th packet of i-th data flow is queued 
tli
j The end-to-end delay of j-th packet of i-th data flow 
ti
serviceCjCk In kth cycle, the time when j-th packet of i-th data stream is sent from 
BS to terminal B 
ti
arriveBSCj The time when j-th packet of i-th data stream arrives at BS 
ρ Link utilization of BS and terminal 
ttran Send delay 
tprop Propagation delay 
tproc Processing delay  
Fig. 22.E-HFWN end-to-end transmission delay without interference.  C. Zhang et al.                                                                                                                                                                                                                                   Array 18 (2023) 100289
14t1
serviceCjC1t1
arriveBSC1i1Cnormal QCI service istransmitte (18)  
t2
serviceC1C1\
t1
serviceC1C1ts1⋅t2
arriveBSC1Ct1
serviceC1C1ts1FT0
T0⋅t2
arriveBSC1Ct1
serviceC1C1ts1≼T0 
i 2, Best Effort Business is transmitted (19) 
t3
serviceCjC1\
t2
serviceCjC1ts2Cj1
t3
serviceCj 1C1ts3⋅t3
arriveBSCjCjF1 
i 3, jamming stream business is joined (20) 
Therefore, in one cycle, the queuing delay of various services of the 
E-HFWN can be obtained: 
ti
queneCjti
serviceCjC1 ti
arriveBSCj (21) 
The link utilization in one transmission cycle is: 
ρ1ts1ts2j×ts3
T2(22) From t3
serviceCjC1DT1, j can be obtained, assuming that j n is obtained, 
and n represents the number of frames of interfering streams that BS can 
process in one cycle when the transmission period for interference flow 
is a certain value. From this, the delay of the k-th cycle can be obtained: 
t1
serviceC1Ckt1
arriveBSC1⋅t2
serviceC1Ck  
\
t1
serviceC1Ckts1⋅t2
arriveBSC1Ct1
serviceC1C1ts1FT0
k 1×T2T0⋅t2
arriveBSC1Ct1
serviceC1C1ts1≼T0(23)  
t3
serviceCjCk\
t3
serviceCj 1Ckts3⋅t3
arriveBSCjCjF1
k 1×T2t2
serviceC1Ckts2Cj1(24) 
Similarly, the queuing delay of the E-HFWN in the k-th cycle can be 
calculated as: 
ti
queneCjCkti
serviceCjC1k ti
arriveBSCj (25) 
For multiple cycles of packet transmission, the link utilization is: 
Fig. 23.Transmission delay after interference flow is imported into E-HFWN, packet sending interval is 10us.  C. Zhang et al.                                                                                                                                                                                                                                   Array 18 (2023) 100289
151
k̂k
i1pi1
k×̂k
i1ts1ts2n×ts3
T2p (26) 
From this, the relationship between the sending interval of the data 
packet and its queuing delay and link utilization rate is obtained. Several 
sets of the E-HFWN end-to-end transmission delay results derived from 
Eqs. 14–26 are given in Fig. 22, which shows the end-to-end delay of 
data packets under the condition without interference. The abscissa is 
the time when the packet arrives at the receiving terminal. The results 
show that the QCI index of normal services has a large interval for 
sending packets in time. Under the time slot action mechanism of the E- 
HFWN frame structure, the end-to-end delay is determined, and there is 
no interference flow affected. 
After the interference flow is imported into the system, it is closer to 
the actual situation. Since the interference flow has a queuing delay at 
the BS, Fig. 23 shows the result, and the abscissa is the arrival time at the 
receiving node. When the packet sending interval is 10 μs, the genera -
tion rate of packets is lower than the service rate of the link, so that the 
queuing delay of data packets at the BS decreases in each cycle. How-
ever, due to the accumulation of data packets in the guard band, there is 
still a step-up trend in different periods. 
Fig. 24 shows the end-to-end delay of interference flow, and the 
abscissa is the time to reach the receiving node. The results show that 
when the transmission interval is 20 μs, the packet generation rate is 
lower than the link service rate, which makes the queue appear idle for a 
long time. In this state, the queuing delay of only a few data packets is 
caused by the scheduling mechanism of the E-HFWN (section 3.6), so 
that the end-to-end delay of data packets is on the whole in a straight 
line, with occasional delay oscillations (jitter). 
5.4. Communication and sensing beam sidelobe ratios of the E-HFWN 
In the environment detection of the E-HFWN, it focuses on the in-
formation of the surrounding environment rather than individual tar-
gets. The sidelobe ratio performance of communication and sensing 
beams is important. In radar sensing, the total energy of a single pixel 
should come from a single spatial resolution. In this section, the peak 
side lobe ratio (PSLR) and integral side lobe ratio (ISLR) are used to 
evaluate energy leakage and describe the discrimination between the 
target and surrounding area. The PSLR and ISLR were numerically fitted 
to obtain the perceptual performance curve of the E-HFWN under 
operating conditions, as shown in Fig. 25. 
Through the actual test of the E-HFWN, the evaluation indicators of 
the sidelobe ratio are the point target range and azimuth peak 
Fig. 24.Interference flow end-to-end delay of E-HFWN (packet sending interval 20us).  
Fig. 25.PSLR and ISLR of communication and sensing signals in E-HFWN 
(cross-section). C. Zhang et al.                                                                                                                                                                                                                                   Array 18 (2023) 100289
16coordinates, PSLR, one-dimensional ISLR, and two-dimensional ISLR. 
From Fig. 25 (a), it can be calculated that the range-ISLR of the 
communication and sensing signal is  9.06 dB, the range-to-PSLR is 
 12.23 dB, the 3 dB system attenuation bandwidth is 1135 MHz, and the 
range-direction resolution of the E-HFWN is 0.17. From Fig. 25(b), it can 
be calculated that the azimuth ISLR of the communication and sensing 
signals is  9.48 dB, the azimuth PSLR is  12.29 dB, and the 3 dB system 
attenuation bandwidth is 1821 MHz, which satisfies the system services. 
At this bandwidth, the range resolution of the E-HFWN is 0.27. The 
above results meet the performance requirements of communication- 
perception integration; that is, the E-HFWN system allocates the 
beams of the communication and perception function so that it can meet 
the business requirements in general industrial scenarios. 
6.Conclusion 
Through the deep integration of multi-dimension sensing and intel-
ligent communication, the communication-sensing integrated network 
enables the network to have high-speed closed-loop information flow 
transmission, improves spectrum utilization efficiency, and the ability of 
wide-area intelligent collaboration. 
Based on the previous millimeter-wave air interface technology, this 
paper proposes an integrated system structure of E-HFWN for 28 GHz 
frequency band, focusing on the enhancement design of key air interface 
technologies, including frame structure design, carrier aggregation, 
channel detection, physical antenna mapping, beamforming and man-
agement, resource allocation and scheduling key technologies, then this 
paper introduces intelligent algorithms into the air interface wireless 
resource allocation scheme to allocate communication and sensing 
channel resources, minimize the end-to-end transmission delay. Finally, 
a set of E-HFWN system is built, the communication and sensing per-
formance are tested. The results show that the enhanced E-HFWN has 
the advantages of capacity, transmission rate, end-to-end delay, and 
perception of environment physical information. This research result 
can be used as pre-research basis for 6G and provide a reference for 6G 
performance evaluation index system. However, the related research on 
communication-perception integrated network is in its infancy, there 
are many difficulties and challenges before the technology is mature and 
commercialized, including: 1) the multi-source information fusion 
mechanism of communication-perception integrated network; 2) the 
wireless resources of whole network pooling and efficient deployment 
methods; 3) communication-perception integrated network efficient 
configuration, intelligent management and control technology. 
Credit author statement 
Chaoyi Zhang : Conceptualization, Methodology, Supervision, 
Zhangchao Ma: Investigation, Formal analysis, Writing – original draft, 
Writing – review & editing, Xiangna Han: Physical process analysis, 
Funding acquisition, Jianquan Wang : Project administration, Re-
sources, Funding acquisition. 
Declaration of competing interest 
The authors declare the following financial interests/personal re-
lationships which may be considered as potential competing interests: 
Jianquan Wang reports financial support was provided by Ministry of 
Science and Technology of China. Jianquan Wang reports a relationship 
with Ministry of Science and Technology of China that includes: funding 
grants, Xiangna Han reports financial support was provided by Ministry 
of Science and Technology of China. Xiangna Han reports a relationship 
with Ministry of Science and Technology of China that includes: funding 
grants. Data availability 
We have submit our data at ’Attach Files Step ’ 
Acknowledgments 
The authors would like to thank the anonymous reviewers for their 
constructive comments. 
References 
[1]Lin JCW, Srivastava G, Zhang YY, Djenouri Y, Aloqaily M. Privacy-preserving 
multiobjective sanitization model in 6G IoT environments. IEEE Internet Things J 
2021;8(7):5340 –9. 
[2]Huang CW, Hu S, Alexandropoulos GC, Zappone A, et al. Holographic MIMO 
surfaces for 6G wireless networks: opportunities, challenges, and trends. IEEE 
Wireless Commun 2020;27(5):118 –25. 
[3]Zhang Y, Xiao LX, Jiang T. Cloud-based cell-free massive MIMO systems: uplink 
error probability analysis and near-optimal detector design. IEEE Trans Commun 
2022;70(2):797 –809. 
[4]ITU-T Technical Report. Representative use cases and key network requirements 
for Network 2030. 2020 . 
[5]Raza A, Ijaz U, Ishfaq MK, Ahmad S, et al. Intelligent reflecting surface-assisted 
terahertz communication towards B5G and 6G: state-of-the-art. Microw Opt 
Technol Lett 2022;64(5):858 –66. 
[6]Xiong JB, Zhao MF, Bhuiyan MZA, Chen L, Tian YL. An AI-enabled three-party 
game framework for guaranteed data privacy in mobile edge crowdsensing of IoT. 
IEEE Trans Ind Inf 2021;17(2):922 –33. 
[7]Wang ZQ, Du Y, Wei KJ, Han KF, et al. Vision, application scenarios, and key 
technology trends for 6G mobile communications. Sci China Inf Sci 2022;65(5): 
1–27. https://doi.org/10.1007/s11432-021-3351-5 . 151301. 
[8]Javaid S, Zeadally S, Fahim H, He B. Medical sensors and their integration in 
wireless body area networks for pervasive healthcare delivery: a review. IEEE 
Sensor J 2022;22(5):3860 –77. 
[9]Wang YL, Chen W, Poor HV. Ultra-reliable and low-latency wireless 
communications in the high snr regime: a cross-layer tradeoff. IEEE Trans Commun 
2022;70(1):149 –62. 
[10] Mahmood A, Beltramelli L, Abedin SF, Zeb S. Industrial IoT in 5G-and-Beyond 
networks: vision, architecture, and design trends. IEEE Trans Ind Inf 2022;18(6): 
4122 –37. 
[11] Han Y, Shi SJ, Jin RT, Wang YX, Qiu Q. Integrated waveguide true time delay 
beamforming system based on an SOI platform for 28 GHz millimeter-wave 
communication. Appl Opt 2020;59(26):7770 –8. 
[12] Gomez-Cuba F, Zugno T, Kim J, Polese M, et al. Hybrid beamforming in 5G 
mmWave networks: a full-stack perspective. IEEE Trans Wireless Commun 2022;21 
(2):1288 –303. 
[13] Ghafoor S, Boujnah N, Rehmani MH, Davy A. MAC protocols for terahertz 
communication: a comprehensive survey. IEEE Communications Surveys and 
Tutorials 2020;22(4):2236 –82. 
[14] Polese M, Jornet JM, Melodia T, Zorzi M. Toward end-to-end, full-stack 6G 
terahertz networks. IEEE Commun Mag 2020;58(11):48 –54. 
[15] da Silva JC, Costa E. A ray-tracing model for millimeter-wave radio propagation in 
dense-scatter outdoor environments. IEEE Trans Antenn Propag 2021;69(12): 
8618 –29. 
[16] Xing YC, Rappaport TS. Millimeter wave and terahertz urban microcell 
propagation measurements and models. IEEE Commun Lett 2021;25(12):3755 –9. 
[17] Wu XD, Yang X, Ma SD, Zhou BG, Yang GH. Hybrid Channel estimation for UPA- 
assisted millimeter-wave massive MIMO IoT systems. IEEE Internet Things J 2022; 
9(4):2829 –42. 
[18] Smith PJ, Senanayake R, Dmochowski PA, Alnajjar KA, Giorgetti A. The impact of 
channel type on spectrum sensing. IEEE Wireless Communications Letters 2022;11 
(2):230 –4. 
[19] Wang XY, Fei ZS, Huang JX, Yu HX. Joint waveform and discrete phase shift design 
for RIS-assisted integrated sensing and communication system under cramer-rao 
bound constraint. IEEE Trans Veh Technol 2022;71(1):1004 –9. 
[20] Ng HJ, Hasan R, Kissinger D. A scalable four-channel frequency-division 
multiplexing MIMO radar utilizing single-sideband delta-sigma modulation. IEEE 
Trans Microw Theor Tech 2019;67(11):4578 –90. 
[21] Bekar M, Baker CJ, Hoare EG, Gashinova M. Joint MIMO radar and communication 
system using a PSK-lfm waveform with TDM and CDM approaches. IEEE Sensor J 
2021;21(5):6115 –24. 
[22] Shi SZ, Zhao ZY, Liu JN. Comparison of radar waveforms combining pseudo- 
random binary phase coding and chirp modulation for an high-frequency 
monostatic radar. IET Radar, Sonar Navig 2016;10(5):935 –44. 
[23] Dore JB, Gerzaguet R, Cassiau N, Ktenas D. Waveform contenders for 5G: 
description, analysis and comparison. Physical Communication 2017;24:46 –61. 
[24] Zhang QX, Wang XN, Li ZH, Wei ZQ. Design and performance evaluation of joint 
sensing and communication integrated system for 5G mmWave enabled CAVs. 
IEEE Journal of Selected Topics in Signal Processing 2021;15(6):1500 –14. 
[25] Lin MT, Xu M, Wan X, Liu HB, et al. Single sensor to estimate DOA with 
programmable metasurface,. IEEE Internet Things J 2021;8(12):10187 –97. 
[26] Chen Z, Han C, Wu YZ, Li LX, et al. Terahertz wireless communications for 2030 
and beyond: a cutting-edge frontier. IEEE Commun Mag 2021;59(11):66 –72. C. Zhang et al.                                                                                                                                                                                                                                   Array 18 (2023) 100289
17[27] Maier M, Ebrahimzadeh A, Rostami S, Beniiche A. The Internet of No things: 
making the Internet disappear and "see the invisible". IEEE Commun Mag 2020;58 
(11):76 –82. 
[28] Sun W, Song QY, Zhao J, Guo L, Jamalipour A. Adaptive resource allocation in 
SWIPT-enabled cognitive IoT networks. IEEE Internet Things J 2022;9(1):535 –45. 
[29] Heng Yang, Zhiqing Wei, Zhiyong Feng, et al. Queue-aware dynamic resource 
allocation for the joint communication-radar system. IEEE Trans Veh Technol 
2021;70(1):754 –67. 
[30] Pitaval RA, Popovic BM, Wang P, Berggren F. Overcoming 5G PRACH capacity 
shortfall: supersets of zadoff-chu sequences with low-correlation zone. IEEE Trans 
Commun 2020;68(9):5673 –88. 
[31] Chen L, Liu F, Wang WD, Masouros C. Joint radar-communication transmission: a 
generalized Pareto optimization framework. IEEE Trans Signal Process 2021;69: 
2752 –65. 
[32] Bagheri A, Ebrahimzadeh A, Najimi M. Game-theory-based lifetime maximization 
of multi-channel cooperative spectrum sensing in wireless sensor networks. 
Wireless Network 2020;26(6):4705 –21. 
[33] Mnih V, Kavukcuoglu K, Silver D, Rusu AA, et al. Human-level control through 
deep reinforcement learning. Nature 2015;518(7540):529 –33. 
[34] Schaul T, Quan J, Antonoglou I, Silver D. Prioritized experience replay. In: Proc. 
Int. Conf. Learn. Represent. Puerto Rico: San Juan; May 2016. p. 1–21. 
[35] Bhatnagar S, Sutton RS, Ghavamzadeh M, Lee M. Natural actor-critic algorithms. 
Automatica 2009;45(11):2471 –82. 
[36] Yi W, Liu Y, Deng Y, Nallanathan A, Heath RW. Modeling and analysis of mmWave 
V2X networks with vehicular platoon systems. IEEE J Sel Area Commun 2019;37 
(12):2851 –66. 
[37] Sun Lei, Wang Jianquan, Lin Shangjing, Ma Zhangchao, Wei LI, Liang Qilian, 
Huang Rong. Research on 5G-TSN joint scheduling mechanism based on radio 
channel information. J Commun 2021;42(12):65 –75.  
ChaoYi Zhang born in December 1985, received his Bachelor ’s 
degree in Measurement control technology and instruments 
from Beijing University of Posts and Telecommunications, 
Beijing, China, at 2003 –2007, received his Master and Ph.D 
degree in Communication and Information System from Bei-
jing University of Posts and Telecommunications, Beijing, 
China, at 2007 –2012. He worked in Beijing Forestry University 
as a lecture and associate professor at 2012 –2020, Since 
November of 2020, he worked in University of Science & 
Technology Beijing as associate professor. His research in-
terests include Communication and sensing integrated 
network, 5G mmWave, Air interface technology, and he has 
great interest in 6G technologies.  
Zhangchao Ma received his bachelor, graduate and doctor 
degree in communication engineering from Beijign University 
of Posts and Telecommunications at 2002 –2011, then, he 
worked in Network Technology Research Institute of China 
Unicom Research Institute from 2011 to 2017, from 
2017 –2020, he worked in Guoke quantum communication 
network Co., Ltd. Since May of 2020, he worked in University 
of Science & Technology Beijing as associate professor. He is 
interested in researching in Industrial delay sensitive network, 
network endogenous security, wireless communication, B5G.  
Xiangna Han received her graduate and doctor degree in 
Institute of Physics and Chemistry from Chinese Academy of 
Sciences at 2008 –2013, then she enter the post-doctoral mobile 
station of the department of Zhejiang University at 2014 –2016. 
From 2016, she worked in University of Science & Technology 
Beijing as associate professor. She is interested in physical 
phenomena in communication systems.  
Jianquan Wang received his doctor degree in communication 
engineering from Beijign University of Posts and Telecommu -
nications at 1998 –2003, then he worked in post-doctor work -
station in BUPT- China Unicom at 2003 –2005, from 2005 to 
2017, he worked in Network Technology Research Institute of 
China Unicom Research Institute, from 2017 to 2020, he 
worked in Guoke quantum communication network Co., Ltd, 
Beijing Shenzhou Tianhong Technology Co., Ltd. Since May of 
2020, he worked in University of Science & Technology Beijing 
as professor. He is the leader of scientific and technological 
innovation of the national “ten thousand talents program ”, the 
young and middle-aged leading talents of the Ministry of sci-
ence and technology, the expert enjoying the special allowance 
of the State Council. He presided over and participated in more than 10 special projects, 
including “863∕∕, NSFC, major projects supported by the Ministry of science and technol -
ogy, National science and technology major special projects. More than 100 articles have 
been published, more than 40 invention patents have been authorized; more than 60 in-
ternational standard manuscripts have been submitted. He is interested in researching in 
Industrial Internet and heterogeneous network collaboration, network system, key tech-
nology and network security. C. Zhang et al.                                                                                                                                                                                                                                   