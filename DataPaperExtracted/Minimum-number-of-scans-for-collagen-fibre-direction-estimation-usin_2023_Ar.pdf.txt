Array 17 (2023) 100273
Available online 23 December 2022
2590-0056/Â© 2022 The Author(s). Published by Elsevier Inc. This is an open access article under the CC BY license ( http://creativecommons.org/licenses/by/4.0/ ).
Contents lists available at ScienceDirect
Array
journal homepage: www.elsevier.com/locate/array
Minimum number of scans for collagen fibre direction estimation using
Magic Angle Directional Imaging (MADI) with a priori information
Harry Lanzâˆ—, Mihailo Ristic, Karyn E. Chappell, John V.M. McGinley
Mechanical Engineering Department, Imperial College London, London, UK
A R T I C L E I N F O
Keywords:
Collagen
Magic angle
Magnetic resonance imaging
Tractography
Soft registrationA B S T R A C T
Tissues such as tendons, ligaments, articular cartilage, and menisci contain significant amounts of organised
collagen which gives rise to the Magic Angle effect during magnetic resonance imaging (MRI). The MR
intensity response of these tissues is dependent on the angle between the main field, ğµ0, and the direction
of the collagen fibres. Our previous work showed that by acquiring scans at as few as 7â€“9 different field
orientations, depending on signal to noise ratio (SNR), the tissue microstructure can be deduced from the
intensity variations across the set of scans. Previously our Magic Angle Directional Imaging (MADI) technique
used rigid registration and manual final alignment, and did not assume any knowledge of the target anatomy
being scanned. In the present work, fully automatic soft registration is incorporated into the MADI workflow
and a priori knowledge of the target anatomy is used to reduce the required number of scans. Simulation studies
were performed to assess how many scans are theoretically necessary. These findings were then applied to MRI
data from a caprine knee specimen. Simulations suggested that using 3 scans might be sufficient, but in practice
4 scans were necessary to achieve high accuracy. 5 scans only offered marginal gains over 4 scans. A 15 scan
dataset was used as a gold standard for quantitative voxel-to-voxel comparison of computed fibre directions,
qualitative comparison of collagen tractography plots are also presented. The results are also encouraging at
low SNR values, showing robustness of the method and applicability at low field.
1. Introduction
Magnetic Resonance Imaging (MRI) is routinely used for diagnos-
tic imaging of various parts of the body because it offers unrivalled
soft tissue contrast and it is safe, owing to the absence of harmful
ionising radiation. However, conventional MRI does not provide suf-
ficient information for accurate diagnostics of tissues containing large
amounts of collagen, such as ligaments, tendons, articular cartilage,
and the meniscus [ 1â€“4]. Particularly hard to diagnose are injuries
such as partial ligament tears, for which surgical techniques such as
arthroscopy remain the diagnostic gold standard, although they are
normally undertaken only as therapy [ 1,5,6].
In these tissues the large collagen molecules are organised in fibre
structures, and the MRI signal is produced by the hydrogen nuclei of
the water molecules bound to collagen. Here, the major signal decay
mechanism is the unaveraged dipolar coupling, resulting in extremely
short relaxation time ğ‘‡2and consequently a very low MRI signal. Such
tissues normally appear very dark or even black, and any bright regions
might be a sign of disease or injury, but they could also be caused by the
well-known Magic Angle (MA) effect. Analysis of dipolar interactions
leads to a simple formula showing that these interactions are minimised
âˆ—Corresponding author.
E-mail address: harry.lanz15@imperial.ac.uk (H. Lanz).when the angle between the collagen fibres and the main magnetic field
ğµ0isğœƒ= 54.7â—¦, the Magic Angle. Therefore, for collagen molecules
oriented at this angle, the time ğ‘‡2can be significantly extended (from
1â€“2 ms to perhaps 20 ms) to result in a strong MRI signal.
The MA effect has long been considered as an unwanted source
of imaging artifacts [ 7] that can be reduced using certain techniques.
However, this effect can also be employed to provide valuable new
information about the tissue microstructure. By analysing image inten-
sities in scans obtained at various orientations to the main field, ğµ0,
it is possible to estimate the collagen fibre orientation in a voxel and
to obtain 3D tractography plots of the fibre structures. For example,
Szeverenyi et al. scanned a goat knee meniscus at 15 orientations to
ğµ0, and used correlation between the measured intensities and those
predicted using theoretical relationships for a large set of predefined
candidate directions [ 8]. Seidel et al. performed a similar study on a
human iliotibial tract sample [ 9]. They performed 35 scans constrained
to two planes and computed the fibre directions by analysing the
maxima of the intensity vectors versus simulated fibre directions.
In view of the practical difficulties of performing lengthy scanning
of humans, our previous work [ 10,11] was aimed at minimising the
https://doi.org/10.1016/j.array.2022.100273
Received 18 October 2022; Received in revised form 14 December 2022; Accepted 14 December 2022Array 17 (2023) 100273
2H. Lanz et al.
number of scan directions required for accurate estimation of fibre
directions, for the case when no a priori knowledge about the expected
fibre directions is available. We proposed the MAgic Angle Directional
Imaging (MADI) method as an extension of the methodology of Szev-
ernyi et al. [8], by choosing the scanning orientations evenly spread
over the hemisphere, and by employing an optimisation step to max-
imise the accuracy of the computed fibre direction. We found that by
doing this it is possible to use only 7 scan directions to robustly estimate
fibre directions, even for images with relatively low signal-to-noise
ratios (SNR).
The present work addresses the need to minimise the number of
scans necessary for the MADI technique, improving on our previous
work from [10] by taking a priori knowledge of target anatomy into
account. Clinical application of the MADI technique is limited by data
acquisition time and geometry requirements for the scans at various
orientations. A single scan can take several minutes, and conventional
MRI scanners are static and patients cannot be easily moved relative
to them. Geometrical issues are addressed by our research groupâ€™s
development of a prototype rotatable scanner [12], yet it is still im-
portant to reduce data acquisition time by taking the fewest number
of scans possible. This necessitates calculation of the optimal scanning
orientations to use. The present work is therefore important to improve
and assess the clinical feasibility of the MADI technique.
In this paper we set out to investigate how a priori information
about the expected fibre directions may be employed to further reduce
the required number of scanning orientations, whilst maintaining the
accuracy of the technique. Simulation studies were performed on a vir-
tual collagen fibre with known orientation in order to find theoretical
optimal scanning orientations within a certain tolerance. MADI was
then applied to real MRI data of a caprine knee specimen using 15
scanning orientations. MADI was then also applied to subsets of this
15 scan dataset, using scanning orientations found in the simulation
studies, to assess whether only 3, 4, or 5 scans would be necessary.
In clinical practice, scout scans are normally used to capture the
overall anatomy and plan the detailed scans. These can also be read-
ily used by a medical specialist to define the expected healthy fibre
directions in order to define the field orientations for the subsequent
detailed scans. For example, in the case of ligaments, the expected
fibre orientation would clearly be along the ligament to result in its
maximum tensile strength, and local deviations from this could be a
sign of injury or disease.
We have also updated the overall image processing pipeline to in-
clude soft registration. In our previous work we introduced registration
based on fiducial markers as a method to align 3D images obtained at
various directions of ğµ0, instead of relying on the measurements of the
rotation angles that was employed by other researchers. However, MR
images inevitably involve a certain amount of geometric distortion due
to the linearity tolerances of the gradient field as well as the main field,
which can make fiducial-based rigid registration insufficiently accurate
in high-resolution images and demands manual fine adjustment, though
often of no more than one or two voxels. Our aim was therefore to
establish that soft registration could be adequately employed to fully
automate this task while achieving accurate results.
2. Methods
2.1. Magic Angle Directional Imaging (MADI)
Fullerton and Rahal [13] found that at physiological hydration
levels, 89% of the water in collagen rich tissues is â€˜orientationally
restrictedâ€™. Dipoleâ€“dipole interactions between the proteins that make
up collagen and the water molecules orient the water molecules trans-
versely to the collagen fibre direction in a regular repeating structure.
Due to this there are residual dipolar couplings oriented in the fibre
direction, giving collagen rich tissues a very short T2 which yields
low MR signal intensity. However, when the fibres are oriented at theMagic Angle relative to ğµ0, the dipole interactions are overcome and
the relaxation time of collagen rich tissues is increased, thus increasing
the measured signal as shown in Fig. 1. Szeverenyi and Bydder [8]
modelled the resulting MR angle sensitivity of collagen fibres as:
ğ¼=ğ´â‹…exp(âˆ’ğµâ‹…(3 cos2ğœƒâˆ’ 1)2) (1)
whereğ¼is the recorded intensity, ğ´andğµare constants, and ğœƒis
the angle between the collagen fibre direction and ğµ0. Knowing this
relationship, it is possible to deduce the orientation of collagen fibres
from multiple scans of the same subject at different ğµ0orientations.
Eachğµ0orientation, defined in the scanned subjectâ€™s reference frame,
is referred to as a scanning orientation.
Following our previous work [10,11], the overall MADI method may
be summarised as follows:
1. Acquire ğ‘scans of the subject using ğ‘differentğµ0orientations.
2. Register the acquired ğ‘volume images.
3. Detect voxels with significant intensity variation as the likely
collagen-containing voxels; on this basis segment the region of
interest (ROI).
4. For a predefined set of candidate directions, use Eq. (1) to
calculate theoretical intensities corresponding to ğ‘scans.
5. Estimate fibre direction for each voxel in ROI:
(a) Find the candidate direction in the set, which has the
theoretical intensities with the highest correlation to the
measured ones, and use it as the initial guess for the
optimisation step.
(b) Use an optimisation process to compute the fibre direction
that maximises the correlation between the theoretical
and measured intensities.
The predefined candidate directions in step 4 were a bouquet of
400 directions uniformly distributed on a hemisphere, which had been
previously shown to lead to robust initial guess for the subsequent
simplex minimisation [10]. In the cases considered here, where a
priori knowledge was available, this was reduced to a subset of 100
candidates, with a higher density near the assumed direction. However,
the whole hemisphere was still spanned to avoid overfitting.
The optimisation step 5b was performed using the Nelderâ€“Mead
simplex algorithm to minimise:
ğ¶(ğ±) =ğ‘âˆ‘
ğ‘˜=1(ğ¼ğ‘€
ğ‘˜âˆ’ğ¼ğ¶
ğ‘˜(ğ±))2(2)
whereğ¶(ğ±)is the cost as a function of the current computed fibre
direction ğ±withğ‘associated intensity values, ğ¼ğ‘€
ğ‘˜is the measured
intensity (see Fig. 2) and ğ¼ğ¶
ğ‘˜(ğ±)is the computed theoretical intensity
of a fibre with orientation ğ±.
2.2. Soft registration
The acquired volume images were first pre-aligned using rigid body
registration based on fiducial markers, followed by soft registration
which also allowed for any geometric distortions. The pre-alignment
stage relies on 3 fiducial markers attached to the specimen, represented
by 10 mm diameter water filled spheres (.43 Caliber Clear Paintballs
8000, Rap4 UK). Following the methodology of de Oliveira et al.
[14] and Brujic et al. [10], these spheres were located in the MR
images using the template matching technique and the Fourier filtering
method [15]. This method was found to give a localisation accuracy of
<0.3voxels by Franco et al. [16]. Since the markers were arranged in an
irregular triangle, each vertex was uniquely defined by which two side
lengths of the triangle associated with it, allowing each marker to be
unambiguously identified in a given 3D image. Rigid body registration
was therefore performed as the translation and the rotation about the
image centre of mass and to align the markers.Array 17 (2023) 100273
3H. Lanz et al.
Fig. 1. Sample images of a caprine knee specimen obtained at different orientations to ğµ0. The attachment points of the patella tendon are shown by the white arrows. The Magic
Angle effect is illustrated here as the patella tendon is dark in 1(a) yet much brighter in 1(b) as the main field was at approximately 55â—¦to the collagen fibres in the tendon.
Fig. 2. An example set of six scans with different scanning orientations that have been registered. The dark inner area is representative of collagen and hence shows variable
intensity. The red and blue lines show corresponding voxels in collagen rich and non-collagen rich regions respectively. (For interpretation of the references to colour in this
figure legend, the reader is referred to the web version of this article.)
Soft registration was then performed by optimising a B-spline trans-
form from the fixed to the moving image, and then assigning the
interpolated values in the moving image to the corresponding vox-
els in the fixed image [ 17]. The parameterisation of the B-spline
transform [ 17,18] was:
ğ‘‡ğ‘ğ‘˜(ğ±) =ğ±+âˆ‘
ğ±ğ‘˜âˆˆğ‘ğ±ğ‘ğ‘˜ğ›½3(ğ±âˆ’ğ±ğ‘˜
ğœ)
(3)
where ğ±is the 3D coordinate being transformed, ğ±ğ‘˜are the control
points,ğ‘ğ±is the set of all the control points within the compact
support at ğ±,ğ‘ğ‘˜are the B-spline coefficient vectors, ğœare the B-spline
control point spacings [ 17], andğ›½3(ğ±)is the cubic multidimensional B-
spline polynomial [ 19]. The coefficient vectors ğ‘ğ‘˜are the optimisation
parameters and not ğ±ğ‘˜. Changes to ğ‘ğ‘˜affect the position of the control
points and hence are used to optimise the transform rather than move
ğ±ğ‘˜directly.
The images obtained experimentally in this work were 256 Ã—256
Ã—208 (1 mm voxel size in each dimension) and the collagen structures
of interest existed on length scales of îˆ»(100)andîˆ»(101) mm . Based on
this, the control point spacing ğœwas set to 16 voxels (16 mm) in each
direction allowing sufficiently fine control over the B-spline transforms
without the need for heavy regularisation. Bending energy was used
to penalise excessive curvature of the B-splines based on their second
spatial derivatives [ 17], however, a low weight of 1 was assigned to
this regularisation term, as spurious bending mainly occurs in large
homogeneous regions due to lack of information, which was not an
issue for our ROI.The metric employed to quantify registration accuracy was the
Mutual Information (MI) [ 20â€“22], defined by ThÃ©venaz and Unser [ 23]
as:
ğ‘€ğ¼(ğœ‡;ğ¼ğ¹;ğ¼ğ‘€) =âˆ‘
ğ‘šâˆˆğ¿ğ‘€âˆ‘
ğ‘“âˆˆğ¿ğ¹ğ‘(ğ‘“,ğ‘š;ğœ‡)â‹…log2(ğ‘(ğ‘“,ğ‘š;ğœ‡)
ğ‘ğ¹(ğ‘“)â‹…ğ‘ğ‘€(ğ‘š;ğœ‡))
(4)
whereğœ‡are the transform parameters, ğ¼ğ¹is the fixed image, ğ¼ğ‘€is the
moving image, ğ¿ğ¹andğ¿ğ‘€are regularly spaced intensity bin centres
for the fixed and moving images, ğ‘is the discrete joint probability, ğ‘ğ¹
andğ‘ğ‘€are the marginal discrete probabilities of the fixed and moving
images â€” obtained by summing ğ‘overğ‘€andğ¹respectively [ 17].
Histogram bin widths were chosen based on the dynamic range of the
images. The images in this work had fairly low dynamic range, the
maximum voxel intensity was <400, therefore 32 histogram bins were
used. MI is suitable for registration of multi modal images [ 17] as using
MI helps to align features despite potential intensity differences, rather
than simply matching intensities. Our data was single mode, but the
angle-sensitivity of collagen rich tissues meant that certain structures
showed significant intensity changes, necessitating a transform metric
that was robust to intensity variations.
The B-spline transformation in Eq. (3) was optimised in terms of
parameters ğœ‡=ğ‘ğ‘˜, based on the metric MI. The adaptive stochas-
tic gradient descent method [ 24] was employed to optimise over a
maximum of 1000 iterations. Once the transformation was optimised,
the registered image was reconstructed from the moving image by
transforming a voxel coordinate from the fixed to the moving image,Array 17 (2023) 100273
4H. Lanz et al.
in which the intensity at this coordinate was obtained using cubic B-
spline interpolation. This intensity was then recorded in a reconstructed
image, at the original fixed image voxel coordinate.
When registering multiple scans, one of the 3D images was des-
ignated the fixed image and all other images where registered to it.
Registration was further improved by applying a binary mask to the
fixed image in order to exclude from the scope of the registration the
noisy air surrounding the sample. The mask was produced by applying
a 3D Gaussian blur with a kernel size of 61 and ğœ= 10 to the fixed
image. A threshold value based on the noise in the air then turned the
blurred image into a 3D Boolean mask which included the specimen
and a few layers of air around it for registration, whilst excluding the
majority of the empty space.
Both the rigid and the soft registration steps were implemented
using the elastix toolbox [17] as the functionality offered was
sufficient for our needs.
2.3. Simulation studies
Assuming perfect registration, simulation studies involving a single
collagen-rich voxel were performed to assess the overall performance
for different numbers of scans ğ‘= 3,4,5, at angles ğœƒ1...ğ‘in the range
15â—¦â€“85â—¦in1â—¦increments. Eq. (1) was used to simulate MR image
intensity in the voxel with added noise, and the fibre direction was
then estimated using the MADI technique described above. The error
angle between the computed fibre direction and the ground truth was
recorded and stored in an ğ‘-dimensional matrix. The ground truth
collagen orientation was along the ğ‘axis. Intensity values for different
anglesğœƒwere with constants ğ´= 300 andğµ= 1 in Eq. (1). The
final intensity value was taken from a normal distribution with ğœ‡=ğ¼
from Eq. (1), and ğœ= 20 which was chosen to approximate the standard
deviation seen in the real MR data from Section 2.4. Absolute values
were taken to avoid negative intensities in low signal regions far from
the Magic Angle.
2.4. MRI data acquisition
We have previously conducted extensive experiments [10,11] to ob-
tain reference MRI scan data of a caprine knee specimen. The specimen
was mounted inside a plastic sphere with marking which allowed the
sample to be rotated in order to achieve known orientations relative
toğµ0. Scans were obtained at 15 different orientations which were
chosen to be equally distributed on a hemisphere. A 12-channel head
coil was the signal receiver. Volume scans were performed using a
3T hospital scanner (Magnetom Verio, Siemens, Erlangen, Germany),
using a 3D T1 FLASH (Fast Low Angle SHot) sequence: TR 13 ms, TE
4.9 ms. The image resolution was 1mm3voxels with an image volume
of 256 Ã—256 Ã—208 voxels. This data allowed for comparison of the
updated MADI technique to previous work and also served as a gold
standard reference for subset studies in Section 3.2.
2.5. Studies using MRI data
The reference dataset consisting of all 15 scans was first used with
the MADI method described above with no assumed a priori knowledge
about the collagen orientation. In this way we generated reference
tractography results for the patella tendon, which was subsequently
used as the basis for evaluation of results involving reduced number of
scans and added image noise. Justification for this approach was our
previous work [10], which has shown that accurate results are obtained
using 7 scans in the case when no a priori knowledge is available,
therefore we assumed that using 15 scans with high SNR (SNR >50) is
more than adequate to provide a gold standard of method performance.
In subsequent studies we used subsets of ğ‘= 3,4,5from the full set
of 15 reference scans, with orientations that were closest to the desired
ones. Therefore this assumed that the orientation could be controlledTable 1
The average angle the computed fibres in the patella tendon made with ğµ0for each
scan.
Scan 1 2 3 4 5 6 7 8 9 10â€“15
Meanğœƒ[â—¦] 9.3 34.0 24.6 29.0 35.4 62.0 68.8 61.8 56.5 80â€“85
with an accuracy of about Â±7â—¦, which is considered reasonable for
practical situations.
The effect of noise was analysed by adding Rician noise to the
images [25] corresponding to certain SNRs. SNR was calculated as:
ğ‘†ğ‘ğ‘… =|ğ‘†ğ‘–ğ‘”ğ‘›ğ‘ğ‘™|
ğ‘†ğ‘¡ğ·ğ‘’ğ‘£ (ğ‘ğ‘œğ‘–ğ‘ ğ‘’ )(5)
where|ğ‘†ğ‘–ğ‘”ğ‘›ğ‘ğ‘™|is the mean signal, calculated by taking the mean
of all intensities in a dataset within a mask of the specimen, and
ğ‘†ğ‘¡ğ·ğ‘’ğ‘£ (ğ‘ğ‘œğ‘–ğ‘ ğ‘’ )is the standard deviation of the noise in the air around
the specimen. The mask used for the mean signal calculation was a
slimmed version of the registration mask, so not to include the air
surrounding the specimen, while an expanded version of the same mask
was used to calculate the standard deviation of noise in the air and to
exclude any signal from the specimen.
In all studies, the collagen-rich regions of the images were seg-
mented via two interactive steps. A cuboid ROI was first selected
interactively on the fixed image, and then applied to the subsequent
registered images. Standard deviation of the intensity was calculated
across all corresponding voxels in the ROI to produce a standard
deviation image, where bright, high standard deviation voxels were
likely to contain collagen. The standard deviation was normalised by
the maximum value and the user then iteratively set a threshold,
[0...1], to isolate voxels with significant standard deviation. The user
was presented with a 3D plot of all the voxels in the ROI above the
threshold. This visualisation ensured the collagen structure of interest
was suitably captured before fibre direction computation. Discretion
was required to avoid inclusion of too many non-collagen containing
voxels resulting from artefacts, such as the partial volume effect or
registration errors. Once chosen, the user then selected a contiguous
collection of voxels that represented the collagen structure of interest
to be segmented.
To quantify how accurate a given test configuration was, the angular
separation (deviation) was recorded for each set of corresponding
voxels between each ğ‘= 3,4,5subset and the ğ‘= 15 scan dataset. The
deviations were binned into histograms with bin sizes of 5â—¦â€“25â—¦and the
proportion of angles in each bin was recorded. This necessitated that
the same segmentation label was used for ğ‘= 15 and its subsets.
3. Results
The MADI technique was applied to the ğ‘= 15 scan dataset, the
scanning orientations used were chosen to allow for any collagen fibre
direction to be estimated and to serve as a gold standard for subsequent
comparisons using subsets of this dataset. The patella tendon shown in
Fig. 1 was segmented and represented by 2080 voxels, or 2080 Ã—15
corresponding voxels across all scans, yielding 2080 estimated fibre
directions. Fig. 3 shows the measured intensity vs the angle to ğµ0
for each computed fibre direction for each scan. Each computed fibre
direction relates to 15 data points in Fig. 3, where the straightness of
the patella tendon is illustrated by the data points for each scan being
grouped together. The theoretical intensity variation from Eq. (1) is
shown to fit well with the measured data, particularly around the Magic
Angle.
Table 1 contains the mean of all 2080 fibre directions for each
scan relative to B0 for that scan, since the patella tendon is relatively
straight, these means were used to quantify the macroscopic tendon
orientation relative to ğµ0.
Fig. 3 shows that the intensity response of the collagen is well
sampled over the full spectrum of angles when using ğ‘= 15 evenArray 17 (2023) 100273
5H. Lanz et al.
Fig. 3. Intensity vs. ğœƒfor each computed fibre direction in the ROI across all ğ‘= 15 scans, points in each scan indicated by a distinct colour. (For interpretation of the references
to colour in this figure legend, the reader is referred to the web version of this article.)
spaced scanning orientations. We hypothesised that a set of ğ‘= 3
scanning orientations would be sufficient to estimate fibre directions
if the peak intensity response was sampled at the Magic Angle as well
as one data point either side. To identify suitable choices of scanning
orientations we performed simulation studies on a single voxel with
known collagen fibre direction along the ğ‘axis. With ğ‘= 3,4,5
the deviation of the computed fibre direction from ground truth was
recorded in an ğ‘dimensional matrix.
3.1. Simulation study results
Fig. 4 aâ€“f shows the deviation surfaces formed by the recorded
deviations with ğœƒ1andğœƒ2in the range 15â—¦â€“85â—¦and the remaining angles
at chosen static values in order to visualise the deviations as a 3D
surface. The blue regions highlight areas with deviation of less than
10â—¦. The results show symmetry along the ğœƒ1âˆ¶ğœƒ2diagonal as expected.
Fig. 4a shows a low deviation region at [ğœƒ1,ğœƒ2,ğœƒ3] =[40â—¦,70â—¦,55â—¦] in
agreement with our hypothesis. Fig. 4d shows the results when ğœƒ3=
50â—¦showing that the method is robust even if the intensity peak at the
Magic Angle is not perfectly captured.
Fig. 4b shows a similar deviation surface with ğœƒ1andğœƒ2in the
range 15â—¦â€“85â—¦andğœƒ3= 55â—¦andğœƒ4= 70â—¦. The low deviation regions
have expanded suggesting an increased robustness of using 4 scanning
orientations relative to 3. ğœƒ4was chosen to visualise the data in Fig. 4b
from the region of low deviation in Fig. 4a. Again Fig. 4e shows the
results with ğœƒ3= 50â—¦illustrating robustness across a range of ğœƒ3.
Fig. 4c shows a deviation surface with ğœƒ1andğœƒ2in the range 15â—¦â€“85â—¦
andğœƒ3= 55â—¦,ğœƒ4= 40â—¦andğœƒ5= 70â—¦where the entire surface is a low
deviation region. Since the static angles ğœƒ3,ğœƒ4,ğœƒ5are already good low
deviation choices for scanning orientations, any additional choice of
anglesğœƒ1andğœƒ2also yield low deviation. The central region of Fig. 4c
nearğœƒ1=ğœƒ2=ğœƒ3shows the highest deviation as the additional scans
are redundant. Fig. 4f shows the surface with ğœƒ3= 50â—¦, also an entirely
low deviation surface.
The results from the simulation studies and Table 1 were used to
select theğ‘= 3,4,5subsets to test the MADI technique with fewer
scans. We chose scanning orientations in the low deviation regions
found in the simulation studies. The patella tendon was relatively
straight hence the means in Table 1 are representative of the tendonâ€™s
angle toğµ0for a particular scan. The chosen subsets and their mean
orientations to ğµ0are given in Table 2.Table 2
Scans chosen for ğ‘= 3,4,5subsets and the mean angle of the patella tendon relative
toğµ0for each scan.
N Scans
3 5 ( 34.5â—¦), 7 ( 68.8â—¦), 9 ( 56.5â—¦)
4 4 ( 29.0â—¦), 5, 7, 9
5 4, 5, 7, 9, 13 ( 80.0â—¦)
3.2. MRI data subset results
When imaging a healthy tendon, there is a high degree of fibre
alignment which is what the a priori knowledge is based on. Damaged
areas can be detected with the MADI technique as shown by Chappell
et al. [11] in our previous work. Damaged/ruptured tendons were
identified from tractography and fibre direction data as areas with
discontinuous or misaligned fibres. The damage in these regions was
subsequently confirmed via dissection. In our previous work, 9 scans
were used to achieve these results hence any fibre direction would
be very likely to be resolvable. When using only 4 scans and a priori
knowledge, we would expect that a damaged area will show mis-
aligned/discontinuous fibres or the fibre directions will not converge
in this region due to being too far from the a priori assumption; thus
damaged areas will still be identifiable. However, the scope of the
present work focuses on assessing the accuracy of fibre estimation using
minimal numbers of scans, hence we chose to study a healthy caprine
patella tendon since it has fairly simple geometry and highly aligned
fibres.
Fig. 5 shows the fibre directions assigned to each voxel for ğ‘= 3.
This vector field-like representation of the fibres allows for a detailed
view of the local fibre directions within the tendon. Each fibre direction
estimation is denoted with a coloured line pointing from a voxel loca-
tion, marked as a black dot. The RGB colour of the line is determined
by the axes it aligns with, alignment along the ğ‘¥axis would only have
a red component, and only blue and only green for the ğ‘¦and z axes
respectively. For directions not perfectly aligned with an axes the RGB
values are interpolated. Fig. 5 shows a high degree of fibre alignment
as the fibres can be seen to flow into each other from voxel to voxel and
almost all of them are marked green or a shade of green. If damage were
present this visualisation technique would be useful for a detailed voxel
level view of the region. However, to better understand the tendon
structure in 3D and in the context of other anatomy, tractography was
generated.Array 17 (2023) 100273
6H. Lanz et al.
Fig. 4. Deviation surfaces from single voxel simulation studies. The top row has ğœƒ3= 55â—¦and the bottom row has ğœƒ3= 50â—¦. (a) and (d) show the deviation surface using 3
scanning orientations, (b) and (e) with 4 scanning orientations with ğœƒ4= 70â—¦, and (c) and (f) with 5 scanning orientations with ğœƒ4= 70â—¦and withğœƒ4= 40â—¦. (For interpretation
of the references to colour in this figure legend, the reader is referred to the web version of this article.)
Fig. 5. Fibre directions assigned to each set of corresponding voxels for ğ‘= 3. (For interpretation of the references to colour in this figure legend, the reader is referred to the
web version of this article.)
Tractography results for ğ‘= 3,ğ‘= 4andğ‘= 15 scans are shown
in Fig. 6, using the same colouring scheme as in Fig. 5. Tractography
visualisation of the tendons in Fig. 6 was produced using Slicer [ 26]
with the diffusion tensor imaging extension [ 27], by converting our
fibre direction estimations into synthetic diffusion tensors. The bones
were hand-segmented from the images to provide context to the tendon.
Qualitatively, the quality of the tractography improves noticeably from
ğ‘= 3toğ‘= 4, withğ‘= 15 displaying the gold standard. ğ‘= 4is
of comparable quality to ğ‘= 15.ğ‘= 5tractography is not shown
here but was almost identical to ğ‘= 4. The tractography results show
highly aligned fibres along the tendon indicating similarly to Fig. 5.
We used the same segmentation label for ğ‘= 15 on all the subsets in
order to allow for direct voxel to voxel comparison between the gold
standard and the ğ‘= 3,4,5studies.
To quantify how accurate a given test configuration was, the angular
separation (deviation) was recorded for each set of corresponding
voxels between each ğ‘= 3,4,5subset and the ğ‘= 15 scan dataset.
The deviations were binned into histograms with bin sizes of 5â—¦â€“25â—¦
and the proportion of angles in each bin was recorded.
Figs. 7, 8, and 9 show the accuracy of the ğ‘= 3,4,5scan subsets at
different SNRs using voxel to voxel comparison to the gold standard.ğ‘= 3 yields a large spread of deviations with only 35% and 50%
of computed directions being within 5â—¦and 10â—¦respectively. The
improvement when using ğ‘= 4is evident as the proportion angles
within 5â—¦and10â—¦of the gold standard increases to 70% and 95%. The
improvement from ğ‘= 4toğ‘= 5is less pronounced with less than
a 5% increase for angles within 5â—¦and less than 2% for angles within
10â—¦of the gold standard. Figs. 7â€“9 all show a consistent accuracy until
approximately an SNR of 25 at which point there is a steep decline as
the data becomes too corrupted to estimate fibre directions.
Fig. 10 shows the alignment index of the patella tendon for ğ‘= 3,
ğ‘= 4, andğ‘= 15. We previously used alignment index as a measure
of anisotropy of the computed fibre directions which we correlated with
tendon maturity [ 11]. The alignment index was calculated by
ğ´ğ¼=ğ‘›ğ‘€âˆ’ğ‘›ğ‘Ÿğ‘›ğ‘‘
ğ‘›ğ‘¡ğ‘œğ‘¡ğ‘ğ‘™âˆ’ğ‘›ğ‘Ÿğ‘›ğ‘‘ifğ‘›ğ‘š>ğ‘›ğ‘Ÿğ‘›ğ‘‘elseğ´ğ¼= 0 (6)
whereğ‘›ğ‘¡ğ‘œğ‘¡ğ‘ğ‘™was the total number of fibre directions computed, ğ‘›ğ‘€was
the number of fibre directions within 20â—¦of a specified orientation,
andğ‘›ğ‘Ÿğ‘›ğ‘‘is the number of random directions within 20â—¦of the specified
orientation out of ğ‘›ğ‘¡ğ‘œğ‘¡ğ‘ğ‘™random orientations. In our previous work we
found that more mature tendons had a higher alignment index thanArray 17 (2023) 100273
7H. Lanz et al.
Fig. 6. Application of the Magic Angle Directional Imaging technique to render the patella tendon of a caprine knee specimen using tractography. Left to right shows the results
from 3, 4 and 15 scans respectively, where 15 scans is the gold standard for comparison. The tract colour is a function of its local orientation. Greener regions align more with
theğ‘¦axis.
Fig. 7. Accuracy and SNR robustness of 3 scan subset when compared to 15 scan gold standard.
Fig. 8. Accuracy and SNR robustness of 4 scan subset when compared to 15 scan gold standard.Array 17 (2023) 100273
8H. Lanz et al.
Fig. 9. Accuracy and SNR robustness of 5 scan subset when compared to 15 scan gold standard.
Fig. 10. The alignment indices for 10(a) :ğ‘= 3, 10(b) :ğ‘= 4, 10(c) :ğ‘= 15 plotted on a unit sphere.
younger tendons provided the tendon was healthy. This result is again
shown in the present work in Fig. 10(c) for theğ‘= 15 gold standard.
Fig. 10(a) shows the ğ‘= 3alignment index which has two obvious
regions of alignment shown by the dual lobes. Fig. 10(b) shows the
alignment index for ğ‘= 4which is very similar to the ğ‘= 15 result.
4. Discussion
Previously we have shown that 7âˆ’9scans are sufficient to accurately
estimate any collagen fibre direction, with no a priori knowledge
of their orientations, depending on SNR. However, for a given fibre
direction, some scans are likely to be redundant due to sampling the
same domain of the intensity response as each other. This effect is
evident in Fig. 3 where the data from multiple scans overlaps. In the
present work we have shown that with some a priori knowledge of the
target anatomy this can be avoided and theoretically 3 scans can be
used, but in practice 4 scans are necessary to yield sufficiently accurate
results. The voxel-to-voxel comparisons and alignment indices shown
in Figs. 7â€“10 illustrate that ğ‘= 4 can yield comparable results to
the gold standard with some a priori knowledge. This is also evident
qualitatively from the tractography in Fig. 6.
Using 3 scans gave somewhat reasonable results, yet with only 3
scans the potential for some directions to be under-constrained was
higher. This is particularly evident in the difference between Figs. 10(a)
and 10(b) where the addition of one more scanning orientation was
sufficient to correct the alignment of a significant portion of the fibres.
Our initial hypothesis was partly correct in that we did have success
when sampling the peak intensity response plus one scan either side
of it, but we found it necessary to add an additional scan to properly
estimate the directions. Since we used data collected assuming no
a priori knowledge of the target anatomy, the subsets of scanning
orientations used were chosen as they were close enough on averageto what the simulation studies suggested. In future work further gains
in accuracy could be made with precise control over the scanning
orientations relative to target anatomy, perhaps increasing the viability
of using only 3 scans, or further improving the 4 scan results.
With the eventual aim to apply the MADI technique using our
prototype low field scanner [ 12], fewer scans for accurate results is
of practical importance to reduce data acquisition time. A scout scan
will likely be necessary to establish a priori knowledge of the target
anatomy, and then the data acquisition will follow. The diminishing
returns of increasing from ğ‘= 4toğ‘= 5suggest that it would not be
worthwhile to perform an additional scan unless the target anatomy
was particularly complex. A curved tendon would in theory require
extra scans to compute its fibre directions for the whole tendon as the
relative scanning orientation would vary across the structure. In the
present work this was not an issue as the patella tendon was relatively
straight.
Since voxels are on the order of îˆ»(10âˆ’1)toîˆ»(100)mm3in size,
fibres can be considered straight at this scale, hence the method is
always valid for a single given voxel. On a more macroscopic scale such
as a tendon, which generally have sizes on the order of îˆ»(101)mm,
significant bending or curvature can occur at this scale thus moving the
fibres away from the desired relative scanning orientations. However, if
the ROI is small, a minimal number of scans would still be sufficient as
the target anatomy would be locally straight enough for MADI to work
with the chosen scanning orientations. Deviations as much as 10â—¦were
allowed for when choosing scanning orientations, therefore allowing
for some local bending/curvature before more scans are necessary.
Because the MADI technique will most likely be applied at low
field, the robustness of the method at low SNR is important. Figs. 7â€“9
all show that the MADI technique remains accurate until an SNR of
roughly 20. Furthermore, since the scanning orientations found in the
present work attempt to capture the peak of the Magic Angle effect andArray 17 (2023) 100273
9H. Lanz et al.
the domain relatively close to it, the signal in the region of interest will
boosted.
5. Conclusion
The main result presented here is that with a priori knowledge, 4
scanning orientations can be used to accurately estimate the collagen
fibre orientations in target anatomy, such as the patella tendon using
the MADI technique. The scanning orientations chosen should capture
the peak and at least one point either side of it, with an additional
scanning orientation to provide extra constraints on the estimated fibre
directions. In the case of the patella tendon studied here, the main field
should be oriented at 30â—¦,40â—¦,55â—¦,70â—¦, relative to the tendon as found
from the simulation studies. The simulation studies suggest there is
â‰ˆ10â—¦of tolerance which enabled the use of (mean) orientations of 29.0â—¦,
34.5â—¦,56.5â—¦,68.8â—¦relative to the patella which yielded accurate results
in comparison to the gold standard reference data.
In practice, application of the technique in vivo would likely consist
of a scout scan and then a set of 4 scans based on information from the
scout. Even with fairly accurate a priori information, it is unlikely that
ğµ0can be precisely oriented relative to the target anatomy. The lenient
tolerances on the selection of scanning orientations therefore serves to
counter this imprecision. The MADI technique itself has successfully
been updated to use fully automatic soft registration which will aid
with correction of geometric distortions in the images due to imaging
at low field, gradient non-linearities, and soft body deformations. This
is a large upgrade over our previous work as registration by manual
adjustment is no longer necessary. The technique also shows robustness
to low SNR, which will be unavoidable at the low field strength of
our prototype scanner. Our scanner can yaw and rotate to capture the
necessary images at the angles required for MADI.
In the present work the gold standard dataset was used to generate
the segmentation label using standard deviation across the image set as
a metric. The same segmentation label was used for all datasets/subsets
in order to allow for direct voxelâ€“voxel comparison between them.
However, with only 4 scans the standard deviation metric is not as
powerful. In lieu of using this metric, manual segmentation of the target
anatomy could be performed on the ROI of the fixed image, which
could then be applied to the registered images as well. Future work
will also focus on other automatic segmentation techniques of the target
anatomy such as applying the MADI technique to the whole ROI and
then selectively pruning voxels unlikely to contain collagen based on
fibre alignment metrics. Even though current segmentation metrics may
suffer when using fewer scans, we have shown that fibre estimation
accuracy is retained with as few as 4 scans hence allowing for detection
of pathologies.
The scope of future work will cover application of MADI on our
prototype scanner and detection and assessment of pathologies in sam-
ples and in vivo. Having shown that ğ‘= 4is sufficient to render fibre
directions that are close to the assumed direction of the target anatomy,
we predict that MADI with minimal scans will detect these regions by
either rendering them correctly â€“ if the fibres are within the scanning
orientation tolerance â€“ or the fibre directions will not converge in a
damaged region. Either scenario would indicate a damaged or diseased
region, however, this is something that will be explored as our work
develops.
CRediT authorship contribution statement
Harry Lanz: Conceptualization, Methodology, Software, Validation,
Formal analysis, Investigation, Data curation, Writing â€“ original draft,
Writing â€“ review & editing, Visualization. Mihailo Ristic: Conceptual-
ization, Methodology, Resources, Writing â€“ review & editing, Supervi-
sion, Project administration, Funding acquisition. Karyn E. Chappell:
Methodology, Validation, Investigation, Resources, Data curation. John
V.M. McGinley: Methodology.Declaration of competing interest
The authors declare that they have no known competing finan-
cial interests or personal relationships that could have appeared to
influence the work reported in this paper.
Data availability
Data will be made available on request.
Acknowledgement
This work was partly supported by the Wellcome Trust Innovator
Award WT215908/Z/19/Z.
References
[1] Devitt BM, Oâ€™Sullivan R, Feller JA, Lash N, Porter TJ, Webster KE, Whitehead TS.
MRI is not reliable in diagnosing of concomitant anterolateral ligament and
anterior cruciate ligament injuries of the knee. Knee Surg Sports Trauma-
tol Arthroscopy: Off J ESSKA 2017;25(4):1345â€“51. http://dx.doi.org/10.1007/
s00167-017-4538-2.
[2] Temponi EF, de Carvalho JÃºnior LH, Sonnery-Cottet B, Chambat P. Partial tearing
of the anterior cruciate ligament: diagnosis and treatment. Rev Bras Orthop (Engl
Ed) 2015;50(1):9â€“15. http://dx.doi.org/10.1016/j.rboe.2015.02.003.
[3] Van Dyck P, Vanhoenacker FM, Gielen JL, Dossche L, Van Gestel J, Wouters K,
Parizel PM. Three tesla magnetic resonance imaging of the anterior cruciate
ligament of the knee: can we differentiate complete from partial tears? Skelet
Radiol 2010;40(6):701â€“7. http://dx.doi.org/10.1007/s00256-010-1044-8.
[4] Tjoumakaris FP, Donegan DJ, Sekiya JK. Partial tears of the anterior cru-
ciate ligament: diagnosis and treatment. Am J Orthop (Belle Mead NJ)
2011;40(2):92â€“7.
[5] Amin NH, Hussain W, Ryan J, Morrison S, Miniaci A, Jones MH. Changes
within clinical practice after a randomized controlled trial of knee arthroscopy
for osteoarthritis. Orthop J Sports Med 2017;5(4):2325967117698439. http:
//dx.doi.org/10.1177/2325967117698439.
[6] Hamilton DF, Howie CR. Knee arthroscopy: influence of systems for delivering
healthcare on procedure rates. BMJ (Online) 2015;351:h4720. http://dx.doi.org/
10.1136/bmj.h4720.
[7] Bydder M, Rahal A, Fullerton GD, Bydder GM. The magic angle effect: A source
of artifact, determinant of image contrast, and technique for imaging. J Magn
Reson Imaging 2007;25(2):290â€“300. http://dx.doi.org/10.1002/jmri.20850.
[8] Szeverenyi NM, Bydder GM. Dipolar anisotropy fiber imaging in a goat knee
meniscus. Magn Reson Med 2011;65(2):463â€“70. http://dx.doi.org/10.1002/mrm.
22645.
[9] Seidel T, Hammer N, Garnov N, Schneider G, Steinke H. An algorithm for the
calculation of three-dimensional collagen fiber orientation in ligaments using
angle-sensitive MRI. Magn Reson Med 2013;69(6):1594â€“602. http://dx.doi.org/
10.1002/mrm.24408.
[10] Brujic D, Chappell KE, Ristic M. Accuracy of collagen fibre estimation under noise
using directional MR imaging. Comput Med Imaging Graph 2020;86:101796.
http://dx.doi.org/10.1016/j.compmedimag.2020.101796.
[11] Chappell KE, Brujic D, Van Der Straeten C, Meeson R, Gedroyc W, McRobbie D,
Ristic M. Detection of maturity and ligament injury using magic angle directional
imaging. Magn Reson Med 2019;82(3):1041â€“54. http://dx.doi.org/10.1002/mrm.
27794.
[12] McGinley JV, Ristic M, Young IR. A permanent MRI magnet for magic an-
gle imaging having its field parallel to the poles. J Magn Reson (1997)
2016;271:60â€“7. http://dx.doi.org/10.1016/j.jmr.2016.08.001.
[13] Fullerton GD, Rahal A. Collagen structure: The molecular source of the tendon
magic angle effect. J Magn Reson Imaging 2007;25(2):345â€“61. http://dx.doi.org/
10.1002/jmri.20808.
[14] de Oliveira A, Rauschenberg J, Beyersdorff D, Semmler W, Bock M. Automatic
passive tracking of an endorectal prostate biopsy device using phase-only cross-
correlation. Magn Reson Med 2008;59(5):1043â€“50. http://dx.doi.org/10.1002/
mrm.21430.
[15] Parker JR. Algorithms for image processing and computer vision. New York:
Wiley; 1997.
[16] Franco E, Brujic D, Rea M, Gedroyc WM, Ristic M. Needle-guiding robot for laser
ablation of liver tumors under MRI guidance. IEEE/ASME Trans Mechatronics
2016;21(2):931â€“44. http://dx.doi.org/10.1109/TMECH.2015.2476556.
[17] Klein S, Staring M, Murphy K, Viergever M, Pluim J. elastix: A tool-
box for intensity-based medical image registration. IEEE Trans Med Imaging
2010;29(1):196â€“205. http://dx.doi.org/10.1109/TMI.2009.2035616.
[18] Rueckert D, Sonoda L, Hayes C, Hill D, Leach M, Hawkes D. Nonrigid registration
using free-form deformations: application to breast MR images. IEEE Trans Med
Imaging 1999;18(8):712â€“21. http://dx.doi.org/10.1109/42.796284.Array 17 (2023) 100273
10H. Lanz et al.
[19] Unser M. Splines: a perfect fit for signal and image processing. IEEE Signal
Process Mag 1999;16(6):22â€“38. http://dx.doi.org/10.1109/79.799930.
[20] Maes F, Collignon A, Vandermeulen D, Marchal G, Suetens P. Multimodality
image registration by maximization of mutual information. IEEE Trans Med
Imaging 1997;16(2):187â€“98. http://dx.doi.org/10.1109/42.563664.
[21] Viola P, Wells WM. Alignment by maximization of mutual information. Int J
Comput Vis 1997;24(2):137â€“54. http://dx.doi.org/10.1023/A:1007958904918.
[22] Mattes D, Haynor D, Vesselle H, Lewellen T, Eubank W. PET-CT image reg-
istration in the chest using free-form deformations. IEEE Trans Med Imaging
2003;22(1):120â€“8. http://dx.doi.org/10.1109/TMI.2003.809072.
[23] ThÃ©venaz P, Unser M. Optimization of mutual information for multiresolution
image registration. IEEE Trans Image Process 2000;9(12):2083â€“99. http://dx.doi.
org/10.1109/83.887976.
[24] Klein S, Pluim J, Staring M, Viergever M. Adaptive stochastic gradient descent
optimisation for image registration. Int J Comput Vis 2009;81(3):227â€“39. http:
//dx.doi.org/10.1007/s11263-008-0168-y.[25] Ridgway G. Rice/rician distribution. 2008, https://uk.mathworks.com/
matlabcentral/fileexchange/14237-rice-rician-distribution. [Online; accessed
Dec 20, 2021].
[26] Fedorov A, Beichel R, Kalpathy-Cramer J, Finet J, Fillion-Robin J-C, Pujol S,
Bauer C, Jennings D, Fennessy F, Sonka M, Buatti J, Aylward S, Miller JV,
Pieper S, Kikinis R. 3D slicer as an image computing platform for the quantitative
imaging network. Magn Reson Imaging 2012;30(9):1323â€“41. http://dx.doi.org/
10.1016/j.mri.2012.05.001.
[27] Zhang F, Noh T, Juvekar P, Frisken SF, Rigolo L, Norton I, Kapur T, Pujol S,
Wells W, Yarmarkovich A, Kindlmann G, Wassermann D, San Jose Estepar R,
Rathi Y, Kikinis R, Johnson HJ, Westin C-F, Pieper S, Golby AJ, Oâ€™Donnell LJ.
SlicerDMRI: Diffusion MRI and tractography research software for brain cancer
surgery planning and visualization. JCO Clin Cancer Inform 2020;4(4):299â€“309.
http://dx.doi.org/10.1200/CCI.19.00141.