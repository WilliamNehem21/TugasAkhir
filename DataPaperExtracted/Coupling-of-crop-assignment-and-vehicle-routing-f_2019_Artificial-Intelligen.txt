Coupling of crop assignment and vehicle routing for harvest planningin agriculture
Mogens Graf Plessen
MGP is an independent researcher
abstract article info
Article history:Received 11 June 2019Received in revised form 25 July 2019Accepted 25 July 2019Available online 6 August 2019A method for harvest planning based on the coupling of crop assignment with vehicle routing is presented. Givena setting with multipleﬁelds, a path network connecting these, multiple depots at which a number of harvestersare initially located, the main question addressed is: Which crop out of a set of different crops to assign to eachﬁeld when accounting for the given setting? It must be answered by every farm manager at the beginning ofevery work-cycle starting with plant seeding and ending with harvesting. Rather than solving an assignmentproblem only, it is here also accounted for the connectivity between ﬁelds. In practice,ﬁelds are often located dis- tant apart. Traveling costs of machinery and limited harvesting windows demand optimized operation and routeplanning. Therefore, the proposed method outputs crop assignments to ﬁelds and simultaneously determines crop-tours, i.e., optimized sequences in which to service ﬁelds of the same crop during harvest. It is of particular relevance for larger farms and groups of farms that collaborate and share machinery. Integer programming basedexact algorithms are derived. For large numbers of ﬁelds, where these algorithms may not be tractable due to computational constraints, elements of clustering and the solution of local Traveling Salesman Problems areadded, thereby on the one hand rendering the method heuristic and in general suboptimal, but on the otherhand maintaining large-scale applicability.© 2019 The Author. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is an open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/4.0/ ).
Keywords:Agricultural logisticsAssignment problemVehicle routingInteger programmingDecision support system
1. IntroductionAgriculture is a diverseﬁeld ranging from biotech to autonomousrobots andﬁnance. It is also closely related to logistics. According toAhumada and Villalobos (2009), there are four main functional areasfor the agri-food supply chain: production, harvesting, storage and dis-tribution. This paper focuses on model-based production planning. Infact, in view of the recent plunges of agricultural commodity prices ac-cording to theFinancial Times (2016)that threaten the sustainability of not few farmers, efﬁciency improvements in production are essential.The decision on the assignment of crops to ﬁelds is crucial in that it de- termines the complete work-cycle. In common practice today, ﬁelds are oftenﬁrst manually clustered according to geographical locations be-fore a crop is assigned uniformly to allﬁelds of each cluster, whereby it is often accounted for crop rotation ( Havlin et al., 1990) in order to re- duce soil erosion and to increase soil fertility. The spatial clustering isdone for faster harvesting. A trend among farmers in Europe is to collab-orate in form of limited companies for the sharing of machinery. Notseldomly conﬂicts arise about the sequence in which to harvest multipleﬁelds of identical crops but various owners. This paper is motivated byproviding a mathematical modeling framework for crop assignment toﬁelds when also accounting for the path network connecting theseﬁelds and depots of harvesters.The basic multiple Traveling Salesman Problem (mTSP) describesthe objective ofﬁnding total tour cost-minimizing routes for multiplesalesmen that all start and end at a single depot, whereby all verticesare visited once by exactly one salesman, see Bektas (2006).N o n n e g a - tive edge cost can refer to, e.g., monetary, space or time units. When ac-counting for various demands at each vertex and limiting the capacity ofvehicles (salesmen), the problem is referred to as the capacitated Vehi-cle Routing Problem (VRP). Variations include the VRP with time win-dows, with backhauls and with pickup and delivery, see Toth and Vigo (2014). The applications are manifold. For example, for vehicle routingwith real-time information seeKim et al. (2005)and the references therein. Recently, there has been increased interest in applying logisticaloptimization in agriculture for scheduling, routing and ﬂeet manage- ment, seeBasnet et al. (2006), Ferrer et al. (2008), Marques et al.(2014), Conesa-Muñoz et al. (2016a) and Sørensen and Bochtis(2010). Special focus was on the coordination of machinery teams dis-tinguishing between primary (harvester) and service (transport) unitsreferred to as PUs and SUs, seeBochtis and Sørensen (2009), Jensenet al. (2012), Seyyedhasani and Dvorak (2017) and Orfanou et al.(2013). All of these references assume thatﬁelds with assigned crops are given. To the best of the author's knowledge, the optimizedArtiﬁcial Intelligence in Agriculture 2 (2019) 99 –109
E-mail address:mgplessen@gmail.com(M. Graf Plessen).
https://doi.org/10.1016/j.aiia.2019.07.0012589-7217/© 2019 The Author. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is an open access article under the CC BY-NC-ND license(http://creativecommons.org/licenses/by-nc-nd/4.0/ ).
Contents lists available atScienceDirect
Artiﬁcial Intelligence in Agriculture
journal homepage:http://www.keaipublishing.com/en/journals/artificial-intelligence-in-agriculture/assignment of crops toﬁelds andsimultaneouslyaccounting for vehicle routing and other constraints for optimized harvest planning has notbeen discussed in the literature before. Such strategic assignmentmust be conducted once per year and at the beginningof the (yearly) work-cycle, thereby decisively affecting the complete agriculturalproduction-cycle, as theﬁrst step within a two-layered framework.The second layer involves coordinations of PUs and SUs, exploiting allof the aforementioned references, and is to be conducted at the endof the work-cycle during harvest.The contribution of this paper is a novel method that can (a) assistfarm managers in the planning of crop assignments to available ﬁelds and (b) simultaneously determines crop-tours, i.e., optimized se-quences in which to serviceﬁelds of the same crop during harvest.Eight different integer programs (IPs) are formulated corresponding todifferent problem setups.The remaining of the paper is organized as follows. Problem and no-tation are formulated inSection 2. Algorithms are derived inSection 3. Extensions are discussed inSection 4. Numerical examples are given inSection 5before concluding withSection 6.2. Problem formulation and notationThe general problem is formulated in literal form. Then, mathemat-ical notation is introduced based on which the preferred eight IPs andthe main algorithm are derived and discussed in Section 3.2.1. Problem formulationProblem 1.Suppose a setting in which multipleﬁelds, a path network connecting theseﬁelds, multiple depots, and potentially multiple har-vesters located initially at each depot are given. Then, at the beginningof every work-cycle (beginning with planting and ending with harvest-ing), a crop has to be assigned to all available ﬁelds. This entails the fol- lowing questions:1Whichcropto optimally assign to eachﬁeld? 2In whatsequenceto optimally service allﬁelds during harvest? 3How to optimally dispatchmultiple harvesters, that initially may be lo- cated at multiple depots, to the multipleﬁelds? 4Whichﬁelds should be serviced, whichleased, and at what prices? Theﬁrst question decides the complete work-cycle. For optimizedharvest planning, its answer must simultaneously account for questions2) to 4). See alsoFig. 1for problem visualization and illustration of real-world relevance due to signiﬁcant inter-ﬁeld distances. It is stressed that at the beginning of every work-cycle of a farm, planning decisionsaccording toProblem 1mu
st be taken. Therefore, in this paper, optimi-zation problems subject to constraints are derived that permit to inputdata such as, e.g., cost coefﬁcients or revenues perﬁeld and crop. Note that at the end of every work-cycle, i.e., at harvest, deviations from ini-tial modeling have occurred. For example, the actual amount of cropharvested perﬁeld is different from the predicted one, and weather isinﬂuencing potential harvesting-windows. Thus, at the end of thework-cycle, the aforementioned second framework-layer becomes rele-vant, involving the coordination of PUs and SUs. However, in this paperthe focus is exclusively on theﬁrst framework-layer.2.2. NotationNotation is mainly adopted fromToth and Vigo (2014). A complete graph is denoted byG¼ð V,EÞ,w h e r eV¼f0,...,D/C01,D,...,Dþ L/C01gandEare vertex and edge set, respectively. Throughout, an arc is referred to as a directed edge. The cardinality of a set of vertices is de-noted by |⋅|. Verticesi∈D¼f0,...,D/C01gandi∈ℒ={D,…,D+L− 1} correspond toDdepots andLﬁelds. TheKdifferent crops are indexed byK¼f0,...,K/C01g. Let the number of harvesters located at a depotand suitable for a speciﬁcc r o pb ed e n o t e db yNharv,kd,∀d∈D,∀k∈K. Let the normalized nonnegative traveling cost per harvester and cropkbetween a depotdand aﬁeldj, or between twoﬁeldsiandj,b ed e - noted by~c
kdjand~ckij, respectively. Then, abbreviatingN
harv,k¼∑ d∈DNharv,kd, edge costs are deﬁned as:c
kij¼Nharv,k~ckij,∀i,j∈L,∀k∈K,ð1aÞc
kdj¼Nharv,k~ckdj,∀d∈D,∀j∈L,∀k∈K,ð1bÞc
k,kmin
dj¼∑
~d∈DNharv,k~d ~ck~dj,∀j∈L,∀k∈K,ð1cÞwhere graphGis in general based onc
kijandckdj. Note thatckijandckdjare here deﬁned as uniformly scaled byN
harv,k, and that, in practice,~ckijand ~c
kdjare proportional to inter-ﬁeld path lengths. As will be shown, ck,kmin
dj
are used for speciﬁc IP formulations. Similarly to Eqs. (1b)a n d(1c)ckjd
andck,kmax
jdare deﬁned. In general, traveling costs along the same geo-graphical paths may vary for different kdue to different crop- dependent harvesting machinery. Suitably, they may be modeled asvarying by a constant offset. The expected revenue from growing andmarketing of cropk∈Konﬁeldl∈ℒis denoted byr
kl. Maintenance cost per depot are given byz
d,∀d∈D.W ea s s u m eaﬁxed cost ofmin- curred for every crop. All costs shall be in monetary units, here Euros(€). Furthermore, throughout it is assumed that arc/edge costs satisfythe triangle inequality (seeFleming et al., 2013). Decision variables are discussed. It is distinguished between twomajor classes: natural and auxiliary decision variables. The ﬁrst class comprises binaryx
kij∈f0, 1g,∀i,j∈V,∀k∈K,w i t hxkij¼1i n d i c a t i n g arc (i,j) to be element of the optimal route for crop k. For the symmetric case withx
kji¼xkij, (a) decision variablexkjican be dismissed, and (b)x
kdj∈f0, 1, 2g,∀d∈D,∀j∈L,∀k∈Kis used, which permits to in- dicate a visit of onlyﬁeldjfor a route corresponding to cropk. Further- more, binaryδ
kl∈f0, 1g,∀l∈L,∀k∈K, withδkl¼1 indicating that cropkis assigned toﬁeldl. Integerγis such that 1≤γ≤Kand indicates
Fig. 1.Problem visualization by example. Yellow markers indicate ﬁelds to be served by 3 collaborating farms. Overall, there are 85 ﬁelds. The satellite image shows an area of 15.9 × 16.3 km. The path network connecting the ﬁelds is curvy and often along rural gravel roads only permitting slow traveling speeds. The overall ﬁeld coverage area is more than 1700 ha. Traveling distances between pairs of ﬁelds is between meters up to dozens of km.M. Graf Plessen Artiﬁcial Intelligence in Agriculture 2 (2019) 99 –109
100the number of active crops in the optimal solution. As will be shown,auxiliary decision variables result from incorporating various logical constraintsinto the IP formulations.3. Problem solution3.1. Assumptions and motivation of harvester group travelThe derivation of the proposed eight IPs in Section 3.2is based on the following assumptions and discussion.Assumption 1.Throughout the harvest of any crop, harvesters arerefueled and maintained on the corresponding ﬁelds growing that crop. Thus, there is no return to depots prior to the complete coverageof all of theseﬁelds.Assumption 2.Aﬁxed number of harvesters is assigned for the harvestof every crop. Then, during the coverage of all ﬁelds associated with a crop, harvesters travel as a group. Thus, it is assumed that there is nodispatch of individual harvesters to individual ﬁelds. Assumptions 1, 2and cost coefﬁcients (1) are deﬁned for practical con- siderations discussed below. Thus, in the most general sense of Problem 1they are limiting. However, on the other hand, they permit to ap-proachProblem 1based on planning routes for each crop (in the follow-ing referred to ascrop-tours) similar to the mTSP-framework (Bektas, 2006). Thus, a route for each crop and theﬁelds correspond to a travel- ing salesman route and cities to be visited, respectively. Note, however,despite this basic analogy, the mTSP-framework is insuf ﬁcient to ad- dressProblem 1. In particular, crop assignment, multiple depots and ad-ditional constraints are not addressed. Therefore, eight customized IPsare derived inSection 3.2. First, however, it is further elaborated onAssumption 2.Proposition 1.Suppose that multiple harvesters are initially located atone depot to which they must return after processing all ﬁelds associated with a crop. Suppose further a graph with cost coef ﬁcients according to Eqs. (1a) and (1b). Then, an optimal policy is that all harvesters covertheﬁelds as a group, i.e., without distributing harvesters to different ﬁelds of the same crop.Proof.The proof is by construction. For the asymmetric case with dif-ferentﬁelds ripening at different times, a unique optimal working se-quence is already implied. For the symmetric case, a cost-minimizingroute exists and includes exactly two edges incident to the depot vertex.This is due to nonnegativity of traveling costs and the fact that cost co-efﬁcients (1a)a n d(1b) are invariant to the number of harvesters trav-eling along inter-ﬁel
d paths (uniform scaling byNharv,k). Any other initial distribution of harvesters toﬁelds not connected to the depot ver-tex along the two aforementioned edges is thus suboptimal and har-vester group travel is thus an optimal policy.Several comments are made. First, accumulated inter- ﬁeld path length minimization(invariant to the number of harvesters travelingalong the path) is of interest for minimization of total non-harvestingtime. By nonnegativity of edge path lengths there exists a shortestpath crop-tour. Since harvesters can always work in parallel on ﬁelds since they are not constrained by each other, this shortest path shouldbe followed by all harvesters.Second, harvester group travel bears more practical advantages. Ingeneral, SUs must ideally be operated such that PUs (harvesters) can op-erate continuously, such that any waiting times due to absent SUs forunloading are avoided. In general, the rate at which harvesters are ﬁlled is not easily predictable due to varying crop returns even within oneﬁeld. Therefore, the concentration of all SUs to one ﬁeld is beneﬁcial for robustness in the sense that multiple harvesters can be served (in-stead of speciﬁc SU-PU couples), according to short-term freedcapacities. An additional advantage is the facilitated supervision by thefarm-manager.Third,Proposition 1assumes a single depot. In order to differentiatebetween the cases that (a) all available harvesters are initially located atone speciﬁc depot, and that (b) all available harvesters are initially dis-tributed among multiple depots,ck,kmin
djis deﬁned according to Eq. (1c)i n contrast toc
kdjin Eq. (1b). Then, in the IP formulations ofSection 3.2har- vester group travel is assumedfrom theﬁrstﬁeld on, and consequently using cost coefﬁcients according to Eq. (1a). Note that such harvester group travel starting from theﬁrstﬁeld of a crop-tour is practical. Thisis since a timely agreement upon harvest-start, e.g., a day ahead, permitsthat all harvesters (from different depots) plan their travel in time andconsequently startﬁeld and route coverage coordinatedly and together.Fourth, it is remarked that if different crops have different non-overlapping harvesting times, then the same harvesters can in principlebe employed sequentially for the different crop-tours. In this paper, thisscenario is assumed and we order crops inKsuch that a lower index in- dicates an earlier harvesting time. For an application example, considerthe crops in order barley, rapeseed and wheat. The alternative scenariois that harvesting times are overlapping or different crops require en-tirely different harvester machinery. This latter scenario is left for futurework and can be approached by partitioning of harvester groups, for ex-ample, weighted (a) according to overall crop-area, or (b) according tothe predicted total crop-harversing time.Finally, note that throughoutSection 3for the subsequent derivation of IPs it is assumed thatallﬁelds must be served. The relaxation of thisassumption is treated inSection 4when discussingﬁnancial consider- ations regarding the leasing of subsets of ﬁelds.3.2. Eight integer linear programsEight different IPs are formulated for the eight different problemsetups considered to be most relevant for harvest planning. First, theseproblem are stated only literally. Relevant constraints are summarizedcompactly, whereby it is distinguished between constraints used inﬁnal numerical simulations and additional constraints. Then, for brevityonly the two most general IPs are stated mathematically. Nevertheless,in theﬁnal numerical experiments ofSection 5all eight IPs are evaluated.3.2.1. Literal formulationsEight integer linear programs, IP-1,…, IP-8, are summarized below. IP-1 There is a single depot,D= 1, from which all harvesters start andto which all harvesters return after each crop-tour. Any subset ofKcrops can be used for planting.IP-2 There are multiple depotsD≥1. After every crop-tour, harvestersmust return to the depot from which they started. Any subset ofKcrops can be used for planting.IP-3 AmongD> 1 potential depots, the best depot w.r.t. a cost crite-rion is selected. Then, all available harvesters are assigned tothis best depot. Note that this problem could also be addressedby separately solving IP-1 for each of the Ddepots and then selecting the best solution. However, here it is solved by a singleIP-formulation. Any subset ofKcrops can be used for planting.IP-4 Multiple harvesters are initially located at multiple depots D≥1. These harvesters assemble at theﬁrstﬁeld
 of theﬁrst crop-tour. Then, all these harvesters travel as a group for the remainder oftheﬁrst and all remaining crop-tours. Then, only after coverageof the lastﬁeld of the last crop-tour these harvesters return totheir initial depots. ForD= 1, IP-4 is identical to IP-2. For D> 1, for all crop-tours except theﬁrst crop-tour IP-4 requires to se-lect an optimal depot similarly to IP-3. Any subset of Kcrops can be used for planting.IP-m Like IP-nfor alln=1 ,…,4, butallof theKcrops must now be used: IP-mform=5 ,…,8.M. Graf Plessen Artiﬁcial Intelligence in Agriculture 2 (2019) 99 –109
1013.2.2. Constraints and modelingIn order to realize the literal problem formulations above, objectivefunction and constraints are compactly summarized.1. The IPcost functionmay include accumulated edge costs c
kijxkij,n e g a - tive proﬁts/C0r
klδkl, depot maintenance costszdξdand crop costs mγ,w h e r e b yc
kij,rkl,zdandmdenote the predicted data which mustbe assumed at the time of harvest planning.2.Degree equations forﬁeldsensure thatﬁelds are visited exactly once per crop-tour. For example, for IP-3 with symmetric edge costs thedegree equations read:∑
d∈Dxkdlþ∑i<lxkilþ∑l<jxklj¼2δkl,∀l∈L,∀k∈K.F o ra n asymmetric formulation, degree equations are split into two, differ-entiating an in-degree (sum of arcs entering) and out-degree (sumof arcs leaving) equation, both equal to δ
kl,∀l∈L,∀k∈K. 3.Degree equations for depotsare conceptually identical to degree equa-tions forﬁelds. However, the cardinality of depot-vertices is not nec-essarily two. Furthermore, the resulting degree equations may benonlinear in the original optimization variables. Then, in order to for-mulate linear IPs, nonlinear degree equations can be rendered linearby the introduction of (a) auxiliary variables, and (b) the applicationoflogical constraints(speciﬁed below) which introduce additionallinear inequality constraints. For example, for IP-3 the nonlinear de-gree equations are:∑
k∈K∑j∈Lxkdj¼2γξd,∀d∈D,w i t h x
kdj∈f0, 1, 2g,ξd∈{0,1}, 1≤γ≤Kand∑d∈Dξd¼1. 4.Uniqueness of crop-assignments toﬁeldsis guaranteed through con- straints∑
k∈Kδkl¼1,∀l∈L.5. Three classes oflogical constraintsare of particular interest. They canbe translated into integer linear inequalities according to Williams (2013). Because of their importance, three logical constraints arehere repeated. Letϵ> 0 be a small number (e.g., the machine preci-sion),b,b
1,b2,b3∈{0,1},y∈ℝ,a n df(x)s u c ht h a tf:Rnx!Ris linear, n
xthe variable dimension, fmax¼max x∈XfðxÞand f
min¼min x∈XfðxÞ,w h e r eXis a given bounded set.(a) The statement“b= 1 if and only iff(x)≤0a n db= 0 otherwise”is equivalent tofðxÞ≤f
maxð1/C0bÞ,fðxÞ≥ϵþðfmin/C0ϵÞb:ð2Þ(b) The statement“b
3= 1 if and only ifb 1= 1 andb 2=1 ,a n db 3=0 otherwise”is equivalent tob
3=b 1b2and is equivalent to b
1þb2/C0b 3≤1,b 3≤b1,b 3≤b2:ð3Þ(c) The statement“y=f(x)i fb= 1 andy= 0 otherwise”is equiva- lent toy=bf(x) and is equivalent toy≥f
minb,y≤fðxÞ/C0fminð1/C0bÞ,ð4aÞy≤f
maxb,y≥fðxÞ/C0fmaxð1/C0bÞ:ð4bÞ6. Under the assumption of a symmetric formulation (with undirectededges instead of directed arcs) and dropping crop-index kfor gener- ality, thesubtour elimination constraints(SECs) according toLaporte (1992)are given by∑
i<j;i;j∈S xij≤jSj−1;3≤jSj≤N−3;∀S⊆V∖f0;N −1g. Note that there is an exponential number of SECs.Additional constraints are summarized as follows.1.Crop rotation constraints(seeHavlin et al., 1990), and constraints similarly related to soil considerations where speci ﬁc soils only admit speciﬁc crops can be formulated as equality constraints,δ
kl¼0, for prohibited combinations of speciﬁcﬁeldland cropk.2.Diversiﬁcation constraintsread∑l∈Lgklδkl≤Gk,∀k¼0,...,K/C02, withg
kl≥0 denoting weights (for example the hectares-coverage orrequired production means forﬁeldland cropk)a n dG
k≥0 the cor- responding crop-related bounds. Crop indexed by k=K−1 is left unconstrained for feasibility. In general, when combining both hardand inequality constraints without additional precaution, feasibilityof the resulting IP cannot be guaranteed. Infeasibility results ifthese constraints enforce∑
k∈Kδkl¼0. 3.Time constraintscan be formulated as∑
d∈D∑ j∈Lhkdjxkdjþ∑ i<jhkijxkij≤Tkwin/C0∑ l∈LTharv,klδkl,k∈K, where, for generality, the multi-depot case is assumed, and where h
kdj
andhkijmay denote travel time along corresponding edges, T winkthe length of the harvesting window for each crop k(e.g., multiple days), andT
harv,klthe required harvesting time (e.g., inversely propor-tional to the number of used harvesters) per ﬁeldland cropk.I n practice, optimal harvesting time windows may be very short dueto weather constraints.4. To account for a priori experience about different sequences in ripe-ness ofﬁelds,priority constraintscan be formulated. For example, re-lating to uncertainties, the sequence in which ﬁelds of the same crop ripe may vary, e.g., due to hillsides and varying soil. W.l.o.g., considera statement such as“ifﬁeldsaandbare among the ones assigned tocropk, then the corresponding sequence for harvest shall be in ordersuch thatais harvested immediately afterb”. This can be modeled as nonlinear constraintx
kba¼δkbδka, and can therefore be translated tolinear inequalities by means of Eq. (3). Note that an asymmetric for-mulation has to be employed for all connections between vertices forwhich priorities are deﬁned. For above example, we therefore re-quire, e.g.,x
kba≠xkab.3.2.3. Two concrete IP formulationsThe two most relevant IP formulations, IP-3 and IP-4, are stated.These are most relevant since they can be simpli ﬁed to all six remaining IPs. For IP-1,D= 1 is enforced in IP-3. For IP-2 cost coefﬁcients from IP-1 must be adapted. For IP-5 until IP-8, the inclusion of all Kcrops is enforced. Accordingly, their counterparts IP-1 until IP-4 simplify.For IP-3 the following is proposed:min∑
d∈D∑
k∈K∑
j∈Lckdjxkdjþ∑
k∈K∑
i<jckijxkij/C0∑
l∈L∑
k∈Krklδklþ∑
d∈Dzdξd
þmγ ð5aÞs:t:∑
d∈Dxkdlþ∑
i<lxkilþ∑
l<jxklj¼2δkl,∀l∈L,∀k∈K,ð5bÞ∑
k∈Kδkl¼1,∀l∈L, ð5cÞ∑
k∈K∑
j∈Lxkdj¼2pd,∀d∈D,ð5dÞ∑
d∈Dξd¼1, ð5eÞξ
d≤pd≤Kξd,∀d∈D, ð5fÞp
d≤γ/C0ð1/C0ξdÞ,∀d∈D,ð5gÞp
d≥γ/C0Kð1/C0ξdÞ,∀d∈D,ð5hÞ∑
i,j∈Sk,i<jxkij≤Sk/C12/C12/C12/C12/C12/C12/C01,Sk⊆V∖dfg,3≤Sk/C12/C12/C12/C12/C12/C12≤N/C01,∀k∈K,∀d∈D, ð5iÞwith decision variablesx
kdj∈f0, 1, 2g,∀d∈D,∀j∈L,∀k∈K,ð6aÞM. Graf Plessen Artiﬁcial Intelligence in Agriculture 2 (2019) 99 –109
102xkij∈f0, 1g,0≤i<j,∀k∈K,ð6bÞδ
kl∈f0, 1g,∀l∈L,∀k∈K,ð6cÞ 1≤γ≤K, ð6dÞξ
d∈f0, 1g,∀d∈D, ð6eÞp
d∈f0, 1,...,Kg,∀d∈D,ð6fÞ Thus, IP-3 hasN
z¼KDLþK∑L/C02q¼0L/C01/C0qþKLþ1þ2Dinteger decision variables. It differs from IP-1 by D> 1. Therefore, the decision about starting from the optimal depot w.r.t. the given cost criterion ismodeled as constraints∑
k∈K∑
j∈Lxkdj¼2γξd,∀d∈D,ð7Þwithx
kdj∈f0, 1, 2g,ξd∈{0,1}, 1≤γ≤Kand∑d∈Dξd¼1. Since Eq. (7)i s nonlinear, auxiliary variablesp
d¼γξd,∀d∈Dare introduced. Then, Eq. (7) can be translated to linear inequality constraints ( 5f), (5g)a n d (5h) following Eq. (4). Finally, note that from Eq. (5e)a n dt h ed eﬁnition ofp
d, the number of decision variables can be reduced by γwhen substitutingγ¼∑
d∈Dpdin Eq. (5).For IP-4 the following is proposed:min∑
d∈D∑
k∈K∑
j∈Lck,kmin
djvkdjþckdjxkdj/C0ckdjvkdjþ∑
k∈K∑
i<jckijxkij/C0∑
l∈L∑
k∈Krklδklþ∑
d∈Dzdξd
∑
d∈D∑
k∈K∑
j∈Lck,kmax
jdwkjdþckjdxkjd/C0ckjdwkjdþmγð8aÞs:t:∑
d∈Dxkdlþ∑
i<lxkilþ∑
l<jxkljþ∑
d∈Dxkld¼2δkl,∀l∈L,∀k∈K,ð8bÞ∑
k∈Kδkl¼1,∀l∈L, ð8cÞ∑
k∈K∑
j∈Lxkdjþxkjd¼2pd,∀d∈D,ð8dÞ∑
d∈Dξd¼1,∑
k∈K~ak¼1,∑
k∈K~βk¼1,ð8eÞ~α
0¼α0,~βK/C01¼αK/C01,ð8fÞ∑
d∈D∑
j∈L∑
k∈Kvkdj¼1,∑
d∈D∑
j∈L∑
k∈Kwkjd¼1ð8gÞ∑
j∈Lxkdj¼ξd,∀d∈D,∀k∈K,ð8hÞ∑
j∈Lxkjd¼ξd,∀d∈D,∀k∈K,ð8iÞξ
d≤pd≤K,∀d∈D, ð8jÞp
d≤γ/C0ð1/C0ξdÞ,∀d∈D,ð8kÞp
d≥γ/C0Kð1/C0ξdÞ,∀d∈D,ð8lÞ1/C0∑
l∈Lδkl≤1/C0αk,∀k∈K,ð8mÞ1/C0∑
l∈Lδkl≥ϵþð/C0Lþ1/C0ϵÞαk,∀k∈K,ð8nÞα
kþð1/C0∑k/C01τ¼0~ατÞ/C0~αk≤1,∀k¼1,...,K/C01,ð8oÞ~α
k≤αk,~αk≤1/C0∑k/C01τ¼0 ~ατ,∀k¼1,...,K/C01:ð8pÞαK/C02/C0kþ1/C0∑1þkτ¼1~βK/C02/C0kþτ/C16/C17/C0~βK/C02/C0k≤1,∀k ¼0,...,K/C02, ð8qÞ~β
K/C02/C0k≤αK/C02/C0k,∀k¼0,...,K/C02,ð8rÞ ~β
K/C02/C0k≤1/C0∑1þkτ¼1~βK/C02/C0kþτ,∀k¼0,...,K/C02,ð8sÞ~α
kþxkdj/C0vkdj≤1,vkdj≤~αk,vkdj≤xkdj,∀d∈D,∀j∈L,∀k∈K,ð8tÞ~β
kþxkjd/C0wkjd≤1,wkjd≤~βk,wkjd≤xkjd,∀d∈D,∀j∈L,∀k∈K,ð8uÞ∑
i,j∈Sk,i<jxkij≤Sk/C12/C12/C12/C12/C12/C12/C01,Sk⊆V∖dfg,3≤Sk/C12/C12/C12/C12/C12/C12≤N/C01,∀k∈K,∀d∈D, ð8vÞwith decision variablesx
kdj∈f0, 1g,∀d∈D,∀j∈L,∀k∈K,ð9aÞx
kij∈f0, 1g,0≤i<j,∀k∈K,ð9bÞδ
kl∈f0, 1g,∀l∈L,∀k∈K,ð9cÞ 1≤γ≤K, ð9dÞξ
d∈f0, 1g,∀d∈D, ð9eÞp
d∈f0, 1,...,Kg,∀d∈D,ð9fÞα
k,~αk,~βk∈f0, 1g,∀k∈K,ð9gÞv
kdj,wkjd∈f0, 1g,∀d∈D,∀j∈L,∀k∈K,ð9hÞx
kjd∈f0, 1g,∀d∈D,∀j∈L,∀k∈K:ð9iÞ For the formulation of crop- and depot-dependent cost coef ﬁcients, the minimum and maximum active crop-indices need to be identi ﬁed. Let thereforeα
k∈{0,1} indicate if cropkis active in the sense ofαk=1i f ∑
l∈Lδkl≥1. By Eq. (2), this translates to Eqs. (8m) and (8n). We intro- duced auxiliary variables~α
k,~βk∈f0, 1gindicating if cropkis the smallest- or largest-indexed active crop, respectively ( k¼k
minand k¼k
max). It holds that∑k∈K~αk¼1 and∑k∈K~βk¼1. We then de- rive the nonlinear relations ~α
0¼α0,~α1¼α1ð1/C0~α0Þ, ~α
2¼α2ð1/C0~α1/C0~α0Þ,…, which can be translated to~α
0¼α0, ð10aÞα
kþð1/C0∑k/C01τ¼0~ατÞ/C0~αk≤1,∀k¼1,...,K/C01,ð10bÞ~α
k≤αk,~αk≤1/C0∑k/C01τ¼0 ~ατ,∀k¼1,...,K/C01:ð10cÞ Similarly, starting the iteration from highest k=K−1w i t h ~β
K/C01¼αK/C01, we can derive nonlinear relations for ~βkto ultimately obtain Eqs. (8q), (8r) and (8s). Suppose thepath-dependentpart of the cost function taking the nonlinear form∑
d∈D∑k∈K∑j∈L ck,kmin
dj~αkþckdjð1/C0~αkÞ/C16/C17xkdjþ- ∑
d∈D∑k∈K∑j∈L ck,kmax
jd~βkþckjdð1/C0~βkÞ/C16/C17xkjd,w i t hck,kmin
dj≥0a n d furtherc
k,kmax
jd≥0 denoting cost-coefﬁcients that are distinct for theﬁrst (i.e.,k¼k
minor~αk¼1) and last (i.e.,k¼kmaxor~βk¼1) crop-route, re- spectively. Then, auxiliary variables v
kdj∈f0, 1gandwkjd∈f0, 1gneed to be introduced with∑
d∈D∑j∈L∑k∈Kvkdj¼1a n d ∑
d∈D∑j∈L∑k∈Kwkjd¼1 . They are related according to vkdj¼ ~α
kxkdjandwkjd¼~βkxkjd,∀d∈D,j∈L,k∈K, and can be translated to in- teger linear inequalities according to Eq. ( 3). The objective function partM. Graf Plessen Artiﬁcial Intelligence in Agriculture 2 (2019) 99 –109
103above can now be expressed linearly dependent on decision variables,see Eq. (8a).. Main algorithmThe main algorithm of this paper is summarized as follows:Algorithm 1.CApR-n
The name is derived from its purpose: Crop Assignment plus Routing (CApR). SeeFig. 2for visualization. The reversing of a list or sequenceof elements is denoted by theﬂip(⋅)-operator. The monetary proﬁti s denoted byJ
CApR−nand is always composed of all of (a) revenues fromgrowing crops, (b) accumulated edge costs, (c) relevant depot mainte-nance costs and (d)ﬁx e dc r o pc o s t s .T h u s ,al a r g eJ
CApR−nis beneﬁcial. For clariﬁcation, for~k¼Lthe proﬁtJ
CApR−nis equal to the negative ob- jective value of IP-n,J
IP−n, when all of (a) to (d) are accounted for. Anal-ysis is provided next.. Analysis and discussion of the main algorithmSeveral comments are made. First, clustering Step 2 is introduced toupscale the number ofﬁelds that can be handled for the coupling of cropassignment and routing. This is relevant if the available combination ofcomputational power and IP-solver is prohibiting to solve a large-scaleIP-nwith manyﬁelds. However, it is here explicitly emphasized thatclustering induces suboptimality in the solution. This aspect isexemplatorily quantiﬁed in Experiment 2 ofSection 5.3.2, and further discussed in the outlook of the conclusion in Section 6. Note that the clustering Step 2 does not necessarily have to be conducted accordingto spatial proximity ofﬁelds. Fields can be clustered arbitrarily. Also, sin-gleﬁelds can be assigned to a single cluster for special analysis. Cluster-ing Step 2 entails Step 4, which solves multiple instances of a TSP with different start and end vertexand thus generates routes within clustersofﬁelds planting the same crop. Therefore, omitting superscript kfor brevity, the general IP ismin∑i<jcijxij ð11aÞs:t:∑
N/C02j¼1x0j¼1,∑N/C02j¼1xjN/C01¼1,ð11bÞ∑
i<lxilþ∑
l<jxlj¼2,l¼1,...,N/C02,ð11cÞ∑
i,j∈Si<jxij≤jSj/C01,∀S⊆V∖f0,N/C01g,3≤jSj≤N/C03,ð11dÞx
ij∈f0, 1g,0≤i<j,j¼1,...,N/C01,ð11eÞ where vertex-indices 0 andN−1a r ed eﬁned as the start and end ver- tex of thetraveling salesman tour(TSP) connecting theNvertices of a given cluster, respectively. See Step 4 of CApR- nfor its application and the speciﬁc method for the selection of start and end vertices. See alsoFig. 2for further visualization. Constraints (11b) and (11c) indicate that start and end vertex are incident to one edge, and all other vertices inci-dent to two, respectively. Under the assumption of symmetry, thesubtour elimination constraints(SECs) according toLaporte (1992)are given by Eq. (11d).Second and importantly, note that if the number of clusters is equalto the number ofﬁelds, i.e.,~k¼L, the algorithm is reduced to the IP-formulations of Step 3. Then, CApR- nis equivalent to IP-n,a n dJ
CApR−n
=JIP−n.Remark 1.It is stressed that for~k<L, because of the clustering Step 2, there can be examples constructed in which a hierarchical methodthat (a)ﬁrst solves an assignment problem withoutaccounting forany spatialﬁeld-proximity, before (b) then computing crop-tours can bemore cost-efﬁcient than a corresponding CApR-solution. However, thiscannot occur for~k¼L. This is since the hierarchical solution is a feasiblesolution of the method coupling crop assignment and vehicle routing.Therefore, in practice, to optimize the monetary result the number ofclusters must always be increased as much as computational powerand available IP-solver permit, ideally, until ~k¼L. For completeness, a basic IP for pure crop assignment to ﬁeldswith- out accounting for anyﬁeld-connectivity informationis minf−∑
l∈L
∑k∈Krklδkl:∑k∈Kδkl¼1;∀l∈L;δkl∈f0;1g;∀l∈L;∀k∈Kg. Under the ad- ditional assumption ofﬁeld-uniformr
kl¼rk,∀l∈L, its optimal solution always assigns the most proﬁtable crop indexed byk
★¼argmax k∈Krk
toallﬁelds. Furthermore, when including both crop rotation and diver-siﬁcation constraints, and introducing the relaxation ∑
k∈Kδkl≤1,f e a - sibility of the assignment IP is always guaranteed. This is since theseconstraints can always be satisﬁed byδ
kl¼0. Moreover, note that the so- lution of the LP-relaxation of the assignment IP, and also including crop rotation constraints,i sinteger feasible, and thus solves these problems asM. Graf Plessen Artiﬁcial Intelligence in Agriculture 2 (2019) 99 –109
104well. The proof is omitted for brevity, but it follows from the integrality property of the LP-relaxation of the assignment IP, see Schrijver (1998) and Heller and Tompkins (1956). Consequently, very large instances(with manyﬁelds and crops) of the assignment OP can easily be solved.As a remark, the aforementioned inequality relaxation does not affectthe integrality property. This is since slack variables s
lcan be introduced such that∑
k∈Kδklþs l¼1,s l∈f0,1g,∀l∈L. In contrast, by adding diversiﬁcation constraints, in general, the LP-relaxation isrendered to not be integer feasible anymore.Third, the relations between different IP- nare discussed. Proposition 2.It always holds J
IP−3≥JIP−2. Proof.The proof is by contradiction. Assume J
IP−2>JIP−3.JIP−2andJIP−3
differ by cost coefﬁcientsckdj¼ck,kmin
dj,∀k∈Kandckdjin Eq. (1b), re- spectively. By linearity ofJ
IP−2and the deﬁnition ofck,kmin
dj according to Eq. (1c), and by nonnegativity of~c
k~dj,JIP−2can always be increased by concentrating all harvesters,∑
~d∈DNharv,k~d, to the most cost-efﬁcient depot. This is the IP-3 solution and therefore contradicts our assump-tion. The equality-part is because a special case of IP-2 is that none har-vesters are initially located at any of the depots except the optimal oneaccording to IP-3.□It also always holds thatJ
IP−3≥JIP−1. This is since the latter single depot case is a feasible solution of the former multiple depot case. Gen-eralizing statements regardingJ
IP−1versusJIP−2, and likewise forJIP−3
vs.JIP−4cannot be made. This is because it is always possible to createcounterexamples in favor of one or another solution. However, it alwaysholds thatJ
IP−n≥JIP−(n+4),∀n=1 ,…,4. This is since the method of enforcingallcrops as for IP−(n+ 4) is always a feasible solution ofIP-n.Fourth, the relations between various J
IP−n,∀n=1 ,…,8, as discussed before, can in generalnotbe translated to the corresponding CApR- nso- lutions for~k<L.T h i si sb e c a u s eo ft h ec l u s t e r i n g - h e u r i s t i ci nC A p R - n. For instance,J
CApR−3≥JCApR−2can in general not be guaranteed.Fifth, it is elaborated on Step 4 of CApR- n. Under the absence of pri- ority constraints, there exist two directions in which to traverse anycrop-tour. The traversal direction affects the closest ﬁelds between any pair of consecutive clusters. Consequently, the TSP-solution foreach cluster, and thereby ultimately the total path length of the crop-tour, is affected, too. This motivated to test both cluster-sequences as in-dicated in Step 4. As stated, CApR- ndoes not account for priority con-straints, i.e., for a priori modeling of ﬁeld ripeness sequences. Therefore, Step 2 and 4 require modiﬁcation and clustering must be conducted according to an objective accounting for ripeness level. As aconsequence, the traversal direction for Step 4 would also be ﬁxed. Sixth, the result of CApR-ncould be further reﬁned by including an additional step (before Step 5) for heuristic local searches thatiteratively tests and exchangesﬁeld-pairs within a crop-tour sequenceif it improves theJCApR−n-result. Alternatively, localﬁeld sequences could here also be exchanged manually according to heuristic prefer-ences of the farm operator.. Extensions. Financial considerations regarding leasingFor leasing considerations, thepartialservice of a subset ofﬁelds is of interest. Let subset~L⊆Ldenote allﬁelds for which we do not necessarilywant to enforceﬁeld service but contemplate leasing options. Then, forIP-3, we maintain equality constraints ( 5b) and (5c) only forL∖~L,a n d deﬁne relaxed inequalities∑
d∈Dxkdlþ∑ i<lxkilþ ∑
l<jxklj≤2δkl,∀l∈~L,∀k∈Kand∑ k∈Kδkl≤1,∀l∈~L. We similarly relax corresponding constraints for all other IP- n.A n yC A p R -nincluding such constraints, shall be denoted as the relaxed CApR- n. In constrast, the original problem according toSection 3.3is referred to as the stan- dard CApR-n.An importantﬁnancial consideration for every farm is to decideuponeitherservicingorrenting out of one'sﬁelds, and additionally the decision upon taking of leases on additional ﬁelds for coverage. Let us denote the sets of correspondingﬁelds byℒ
own(farmer's ownﬁelds), ℒ
pro⊆ℒown(potential rent outs) andℒptl(potentialﬁelds for taking leases upon), respectively. Then, the following algorithm providesguidelines for decision making:
Fig. 2.Illustration of Steps 1 to 4 of CApR- n. (Plot 1) Three depots (D0, D1 and D2) and 50 ﬁelds are visualized by the black and green balls, respectively. (Plot 2) The ﬁelds are assigned to ~k¼10 clusters (C0,…,C9). Allﬁelds belonging to the same cluster are colored correspondingly. The cross-signs indicate the ~kcentroids and are labeled accordingly. (Plot 3) Results of IP-7 applied to the~kcentroids. (Plot 4) Results of CApR-7. For visualization, the ﬁelds are colored according to the clustering result. Labels k=0 ,k= 1 andk= 2 indicate theﬁrst edge traversal of each crop-tour, whereby a crop-tourdenotes the harvesting routes associated with a speci ﬁcc r o pk.
Main nomenclatureDSet ofDdepots, indexed byd,i,j∈D.ℒSet ofLﬁelds, indexed byl,i,j∈ℒ. KSet ofKcrops, indexed byk∈K. x
kij Decision variable for edge(i,j)and cropk. δ
klDecision variable for vertexland cropk. ξ
dDecision variable for depotd. γDecision variable for the nr. of active crops.~c
kijCost per harvester for arc(i,j)and cropk. c
kij Cost for arc(i,j)and cropk. r
kl Monetary return for cropkonﬁeldl. z
dCost coefﬁcient for active depotd. mCost coefﬁcient per active crop.N
harv,kdNr. of harvesters at depotdfor crop-tourk. ~kParameter for~k-means clustering.JMonetary return (revenue minus costs).AbbreviationsIP/LP Integer/linear programmingTSP/mTSP Traveling Salesman Problem/multiple TSPM. Graf Plessen Artiﬁcial Intelligence in Agriculture 2 (2019) 99 –109
105Algorithm 2.Renting out and taking leases
It is elaborated on Step 4. Suppose the inclusion of a ﬁeld does not improve the totalﬁnancial return. This may be because of too expensiveproduction costs, for example, whenﬁelds are located very distant apart from depots or due to limited harvesting windows. Then, renting out isproﬁtable essentially already for any positive return. Let us also discussStep 9. In contrast to pure assignment problems, the maximum leasingrateΔJcannot easily be distributed among corresponding ﬁelds. This is because monetary proﬁts are nonlinearly related to crop returns be-cause of the coupling with routing decisions. Importantly, the precisedistribution of leasing rates of individual ﬁelds is not relevant as long as it overall does not surpassΔJ. Thus,ΔJprovides the farmer with an upper bound on proﬁtable leasing rates. IfΔJcannot be attained in nego- tiations, differentℒ
ptlshould be selected and the algorithm solvedagain. This is repeated until a corresponding upper bound can be satis-ﬁed, or, ultimately,ℒ
own∖ℒroare serviced.The secondﬁnancial consideration is motivated by the comparisonof monetary returns for CApR-n. It permits to determine“fair”prices for leasing when sheltering machinery at the various depots. It isenvisioned that all collaborating farmersﬁrst involve in accurate system modeling of cost coefﬁcients, before then solving either all of CApR- n, ∀n=1 ,…,4, or all of CApR-n,∀n=5 ,…,8. Speciﬁcally, the difference in objective values between CApR-2 (or CApR-7 for enforcement of allKcrops in the solution) and the remaining CApR- nthen permits to de- termine an upper bound on leasing rates for depot usage.Finally, even though a detailed discussion is here out of scope, theimportance of a suitable method for sharing of pro ﬁts is underlined. It is fundamental for providing incentives for farmers to collaborate andadopt proposed planning methods. See Andersson et al. (2005)for a dis- cussion about how farm cooperation can improve both sustainabilityand proﬁtability.. Application in practiceModeling of parameters listed in Step 1 of CApR- nis largely affecting the overall result and may be based on historical ﬁeld and crop yield data. By the selection ofc
kij, computational complexity can be reducedby pruning speciﬁc undesiredﬁeld connections from a path network,thereby implicitly also inﬂuencing priority constraints. Largeﬁelds often have multiple possibleﬁeld entrance and exit points, which maysigniﬁcantly affect inter-ﬁeld travel distances. Therefore,ﬁeld coveragepatterns and in-ﬁeld navigation (seeJensen et al., 2012, Conesa-Muñozet al., 2016b, Plessen, 2018, Plessen, 2019 ) could also be co-planned to account for crop-tours efﬁciently linkingﬁelds that plant the same crops. This may be subject of future work.. Numerical simulationsThis section summarizes the experimental data setup, the methodsused to solve proposed IPs, andﬁnally some numerical simulation re-sults.. Experiment data setupFor numerical simulations one data set is composed of 10 differentrandom instances. InSection 5.3the mean evaluation results are re-ported for these instances. Problem data is generated syntheticallybased on realistic parameter settings from farming in NorthernGermany. The data generation for each instance is as follows. The num-ber of available depots, crops andﬁelds is set asD=3 ,K= 3 andL=5 0 , respectively. Field and depot locations are generated randomly accord-ing to a Gaussian distribution centered at the origin with standard devi-ationsσd=1 0 k m ,∀d∈D,a n dσ l=1 5 k m ,∀l∈ℒ.T oe a c hd e p o t ,w e randomly assign a number of harvesters according N
harv,kd¼ maxð1,⌊5u
d⌋Þ,u d∼Uð0,1Þ,∀d∈D, whereUð0,1Þdenotes the Uniform distribution with zero mean and unit variance, and ⌊⋅⌋denotes rounding to the next smallest integer. Normalized traveling costs perharvester and km are set uniformly (for all inter-depot and inter- ﬁeld distances) as~c¼30
km.Ac o s to fm=1 0 0 0€for every planted crop is as- sumed. Maintenance costs are assumed to be identical for all depots.Therefore, w.l.o.g.z
d¼0,∀d∈Dis set. Realistic normalised monetaryreturns in€per ha and crop are determined as mean values from inter-mediate soil qualities and crop yields in Northern Germany. These aresummarized inTable 1. Two options were considered for monetary re-turn perﬁeld and crop. First,ﬁeld sizes were generated according tos
l¼maxð20þ10u d,1Þ,u d∼Nð0,1Þ,∀l∈L,w h e r eNð0,1Þdenotes the Gaussian distribution with zero mean and unit variance. In combinationwithL= 50 this results approximately in a total coverage size of 1000ha. According to the survey byStatistisches Bundesamt Deutschland(2016), in all of Germany there are 299,134 farming businesses ofwhich only 1502 have a size of more than 1000 ha. Field sizes werethen multiplied with~r
kaccording toTable 1,t oy i e l drkl¼ s
l~rk,∀l∈L,k∈K. This method of data generation is intuitive. However,since normalised monetary return is considerably higher for wheat incontrast to barley and rapeseed, the application of CApR- ntypically as- signs wheat to allﬁelds, unless crop rotation constraints, or diversi ﬁca- tion constraints, as in CApR-nforn=5 ,…,8, are included. Thus, in the latter cases, the crop with smallest monetary return is assigned to thecluster with smallestﬁeld area, and the crop with second-smallest re-turn to the second-smallest area and so forth. In a second setting, andto add more variety, monetary returns per ﬁeld and crop were therefore generated differently according to r
kl¼maxð20þ 10u
kl,1Þ~rk,∀l∈L,k∈K, withukl∼Nð0,1Þ. ThroughoutSection 5.3, the second setting is used for data generation.. Solution of integer programsFor the solution of IPs in CApR-n, three open-source IP-solver candi-dates were considered: CBC (Forrest, 2012), GLPK_MI (Makhorin, 2008), and ECOS_BB (Domahidi et al., 2013). All of these solvers were called through the domain-speciﬁc language CVXPY for optimizationembedded in Python (Diamond and Boyd, 2016). All numerical experi- ments were conducted on a laptop running Ubuntu 16.04 equippedwith an Intel Core i7 CPU @2.80GHz×8 and 15.6 GB of memory. Forthe present applications and in preliminary tests (e.g., stochastic exper-iments forL= 50 and various~k), the GLPK_MI consistentlyM. Graf Plessen Artiﬁcial Intelligence in Agriculture 2 (2019) 99 –109
106outperformed the other two considered IP-solvers. Therefore, it wasused for all numerical experiments of Section 5.3. For clariﬁcation, the focus of this paper was on problem modelingfor a broad variety of set- tings typical in an agricultural context. The scope of this paper is notdiscussing or applying the most efﬁcient (commercial) problemsolver. A remark to incorporating SECs in Integer Program is made. The pro-posed optimization problems include an exponential number of SECs(see alsoLaporte, 1992for a general discussion). Therefore, in thispaper SECs are approached in form of separation algorithmsaccording toPataki (2003). Thus, SECs are added sequentially as they are needed.For instance, with regard of Eq. (11), it isﬁrst solved without Eq. (11d). Then, if the result does not return any subtour, the optimal solution hasbeen found. Otherwise, all detected subtours are added to Eq. (11) asSECs, and the IP is solved again. This is repeated until a solution withoutsubtours is found (the optimal solution), or a maximal number of SEC-iterations is reached.The sequential inclusion of SECs as they are needed offers the advan-tage of simplicity. Furthermore and importantly, as will be shown em-pirically inSection 5.3, for the preferred IP-settings and ~k¼10very few (low single digit) SEC-iterations were required to ﬁnd an integer solu- tion without subtours, which thus also implies ef ﬁciency. Nevertheless, it is here clariﬁed that it may not be the most efﬁcient method to handle SECs. This is further discussed in the outlook of Section 6, including sug- gestion of future work.. Experimental resultsThis section is partitioned into two parts. First, all proposed methodsCApR-nforn=1 ,…,8 are compared in experiments according toSection 5.1for two different numbers ofﬁeld-clusters. Second, the im- provement potential of solving CApR-problems withoutany clustering is illustrated, i.e., for~k¼L.Evaluation criteria are averaged over 10 simulation experiments,and indicated by/C22yfor a criteriony. The percentage out of the 10 simu-lation experiments for which an IP- nsolution could be found in less than 200 SEC-iterations is denoted by P
convIP−n. The average number of decision variables, SEC-iterations plus the initial IP-iteration withoutSECs, number of equality constraints, inequality constraints when ﬁrst omitting SECs and for theﬁnal SEC-iteration (before convergence) aredenoted byN
IP/C0nz ,/C22NIP/C0niterSECþ,Neq,IP−n,Nineq,NoSECIP−n and/C22NIP/C0nineq;finalIP, respectively. Average accumulated CPU-time for the solution of allSEC-iterations and all TSP-problems are /C22T
IP/C0nCPUand/C22TTSPsCPU,r e s p e c t i v e l y . The average number of required SEC-iterations for the solution of allTSPs (which includes all SEC-iterations plus the initial IP-solution with-out SECs) is denoted by/C22N
TSPsiterSECþ..E x p e r i m e n t1The results of Experiment 1 are summarized in Table 2.F o r~k¼20, /C22J
CApR/C01and/C22JCApR/C02are not reported in the comparison since only90% and 30% of experiments could be solved within 200 SEC-iterations. Several remarks can be made. First, it is noted how quicklycomputational complexity rises with increasing ~k. For example, /C22T
IP/C01CPU¼0:07s for~k¼10,b u t/C22TIP/C01CPU¼63:09s for~k¼20. Second,ﬁxing the number of serviced crops as done for CApR- n,n=5 ,…,8, notably re- duces CPU-time; compare/C22T
IP/C0nCPUvs./C22TIP/C0ðnþ4ÞCPUforn=1 ,…,4 and~k¼20. Similarly, the average number of SEC-iterations /C22N
IP/C0niterSECþis affected. For every additional SEC-iteration, an additional IP with an increased num-ber of SECs has to be solved. Third, for ~k¼20CApR-2 had difﬁculties in ﬁnding a solution within 200 SEC-iterations, see P
convIP−2. The intuitive explanation is that the optimal solution when optimizing over anysubset ofKcrops in combination with characteristic cost coef ﬁcient (1c) is very sensitive to newly added SECs and accordingly quicklychanges, which explains the many SEC-iterations, often exceeding the200 SEC-iteration bound. Fourth, for ~k¼10on average only 1 SEC- iteration was required forCAPR-8 (recall that/C22TIP/C0nCPUand/C22NIP/C0niterSECþcount all IPs including the initial onewithoutany SECs). Thus, for (a) small ~k (such as~k¼10) and (b)n=5 ,…,8 the method according to Section 5.2adding SECs as they are needed appears appropriate. Fifth,proﬁt/C22J
CApR/C0nincreases with~k. This concept is further emphasized inthe next Experiment 2.. Experiment 2The purpose of Experiment 2 is to illustrate the bene ﬁto np r oﬁt when solving for~k¼L, i.e., dismissing the heuristic clustering-step.For brevity, results are reported only for CApR-5. However, they are bytrend comparable for all other 7 methods. In contrast to Experiment 1withL= 50, the results for IP-5 are summarized in Table 3forL=4 0 (due to an exploding computational complexity). For ~k¼40there are 2580 integer variables and 2580 inequality constraints even without in-corporation of any SECs. Note that for the given experiment with themaximum possible number of clusters ~k¼La notable improvement of 15.4% over the solution for ~k¼10could be observed. This underlinesthe economic incentive for attempting to solve IPs for ~k¼Las stressed inRemark 1, if this is permitted by the available combination of compu-tational hardware and IP-solver.. ConclusionAﬂexible framework for the coupling of crop assignment with vehi-cle routing for harvest planning was presented. This problem is relevantsince the decision about crop assignment must be addressed by everyfarm manager at the beginning of every work-cycle starting with plantseeding and ending with harvesting. The main contribution was theproposal of 8 different IP formulations. It was found in numerical exper-iments that the 4 cases with enforced inclusion of any crop out of a set ofcrops to be computationally notably more ef ﬁcient. This enforcement is applicable in practice since the list of eligible crops typically is very lim-ited. For large-scale applications where sole IP formulations are not trac-table anymore, a heuristic algorithm was proposed combining the IP-formulations with clustering ofﬁelds and the solution of local TSPs.The focus of this paper was on problem modelingfor a broad variety of settings typical in agriculture. For future work the main task is devel-opment of an efﬁcientsolution method.T h i si sm o t i v a t e db yt h ef a c tt h a t the output of CApR-nremains heuristic and in general suboptimal for all~k<Ldue to the clustering step. Thus, IP-solution methods must be de-veloped that enable to solve in reasonable time for ~k¼Land for largeL, e.g.,L≈10
0. Therefore, two main approaches are envisioned. First, by(a) focusing on one speciﬁc IP-formulation (e.g., IP-5 since IP-6 can bereduced to it and IP-7 can be solved by solving IP-5 for all available de-pots) the problem formulation can be standardized, before (b) a cus-tomized IP-solver, e.g., a branch-and-cut algorithm may be developed.Reformulations of the SECs, for example, in form of MTZ-SECs ( Miller et al., 1960), which introduce additional continuous variables for SECsand thereby render the problem of mixed integer nature may also be ex-plored. Alternatively and secondly, optimization by simulationalgo- rithms, e.g., Tabu search heuristics similar to Gendreau et al. (1994), may be tested to solve the proposed IP-problems.Table 1Normalized and averaged monetary returns in Northern Germany that were used in sim-ulations.Barley Rapeseed Wheat Unitk0 1 2 − ~r
k 570600750€/haM. Graf Plessen Artiﬁcial Intelligence in Agriculture 2 (2019) 99 –109
107Declaration of competing interestThe authors declare that they have no known competing ﬁnancial interests or personal relationships that could have appeared to in ﬂu- ence the work reported in this paper.References
Ahumada, O., Villalobos, J.R., 2009. Application of planning models in the agri-food supply chain: a review. Eur. J. Oper. Res. 196, 1 –20. Andersson, H., Larsén, K., Lagerkvist, C.J., Andersson, C., Blad, F., Samuelsson, J., Skargren,P., 2005.Farm cooperation to improve sustainability. AMBIO:J. Hum. Environ. 34,383–387.Basnet, C., Foulds, L.R., Wilson, J., 2006. Scheduling contractors' farm-to-farm crop har- vesting operations. Int. Trans. Oper. Res. 13, 1 –15. Bektas, T., 2006.The multiple traveling salesman problem: an overview of formulationsand solution procedures. Omega 34, 209 –219. Bochtis, D., Sørensen, C.G., 2009. The vehicle routing problem in ﬁeld logistics part I. Biosyst. Eng. 104, 447–457.Conesa-Muñoz, J., Bengochea-Guevara, J.M., Andujar, D., Ribeiro, A., 2016a. Route plan- ning for agricultural tasks: a general approach for ﬂeets of autonomous vehicles in site-speciﬁc herbicide applications. Comput. Electron. Agric. 127, 204 –220. Conesa-Muñoz, J., Pajares, G., Ribeiro, A., 2016b. Mix-opt: a new route operator for opti- mal coverage path planning for a ﬂeet in an agricultural environment. Expert Syst. Appl. 54, 364–378.Diamond, S., Boyd, S., 2016.CVXPY: a python-embedded modeling language for convexoptimization. J. Mach. Learn. Res. 17, 1 –5. Domahidi, A., Chu, E., Boyd, S., 2013. ECOS: An SOCP solver for embedded systems. IEEE European Control Conference, Switzerland: Zurich, pp. 3071 –3076. Ferrer, J.C., Mac Cawley, A., Maturana, S., Toloza, S., Vera, J., 2008. An optimization ap- proach for scheduling wine grape harvest operations. Int. J. Prod. Econ. 112, 985 –999. Financial Times, 2016. Wheat price falls to lowest level in a decade. https://www.ft.com/ content/75fdb856-6b0c-11e6-ae5b-a7cc5dd5a28c . Fleming, C.L., Grifﬁs, S.E., Bell, J.E., 2013.The effects of triangle inequality on the vehicle routing problem. Eur. J. Oper. Res. 224, 1 –7. Forrest, J., 2012. CBC (coin-or branch and cut) open-source mixed integer programmingsolver.https://projects.coin-or.org/Cbc Version 2.9.9. Gendreau, M., Hertz, A., Laporte, G., 1994. A tabu search heuristic for the vehicle routing problem. Manag. Sci. 40, 1276 –1290. Havlin, J., Kissel, D., Maddux, L., Claassen, M., Long, J., 1990. Crop rotation and tillage ef- fects on soil organic carbon and nitrogen. Soil Sci. Soc. Am. J. 54, 448 –452. Heller, I., Tompkins, C., 1956.An extension of a theorem of Dantzig's. Linear Inequalitiesand Related Systems. 38, pp. 247 –254. Jensen, M.A.F., Bochtis, D., Sørensen, C.G., Blas, M.R., Lykkegaard, K.L., 2012. In-ﬁeld and inter-ﬁeld path planning for agricultural transport units. Comput. Ind. Eng. 63,1054–1061.Kim, S., Lewis, M.E., White, C.C., 2005. Op
 timal vehicle routing with real-time traf ﬁc infor- mation. IEEE Trans. Intell. Transp. Syst. 6, 178 –188. Laporte, G., 1992.The traveling salesman problem: an overview of exact and approximatealgorithms. Eur. J. Oper. Res. 59, 231 –247. Makhorin, A., 2008. GLPK (GNU linear programming kit). Version 4.64.. https://www.gnu. org/software/glpk/.Marques, A.S., Audy, J.F., D’Amours, S., Rönnqvist, M., 2014. Tactical and operational har- vest planning. The Management of Industrial Forest Plantations. Springer,pp. 239–267.Miller, C.E., Tucker, A.W., Zemlin, R.A., 1960. Integer programming formulation of travel- ing salesman problems. J. ACM 7, 326 –329. Orfanou, A., Busato, P., Bochtis, D., Edwards, G., Pavlou, D., Sørensen, C.G., Berruto, R., 2013.Scheduling for machineryﬂeets in biomass multiple-ﬁeld operations. Comput. Elec- tron. Agric. 94, 12–19.Pataki, G., 2003.Teaching integer programming formulations using the traveling sales-man problem. SIAM Rev. 45, 116 –123. Plessen, M.G., 2019. Optimal in-ﬁeld routing for full and partialﬁeld coverage with arbi- trary non-convexﬁelds and multiple obstacle areas. arXiv preprint 1906.04264.Table 2Summary of Experiment 1. The results of CApR- nforn=1 ,…,8 are compared for two different ~k.~k¼10Unitn=1n=2n=3n=4n=5n=6n=7n=8/C22J
CApR/C0n €722,075 718,132 723,664 715,732 715,442 711,435 718,474 715,732 /C22T
IP/C0nCPU s0.070.590.090.070.030.020.020.02 /C22N
IP/C0niterSECþ −10.10 31.30 9.40 2.00 4.30 3.50 2.80 2.00N
IP/C0nz −196 196 262 541 195 195 258 348 N
eqIP−n −41 41 44 68 43 43 50 68 N
ineq,NoSECIP−n −197 197 275 1112 195 195 258 348 /C22N
IP/C0nineq;finalIP −208.70 232.6 285.6 1113.0 199.0 197.9 260.1 349.0/C22T
TSPsCPU s0.030.030.030.030.910.820.030.03 /C22N
TSPsiterSECþ −12.6 13.7 13.5 12.9 16.8 14.2 13.2 12.9 P
convIP−n %100100100100100100100100~k¼20n=1n=2n=3n=4n=5n=6n=7n=8/C22J
CApR/C0n €−− 748,851 747,230 746,431 742,329 748,379 747,230 /C22T
IP/C0nCPU s63.09220.7249.2446.060.220.1444.838.14 /C22N
IP/C0niterSECþ −73.8 124.0 82.6 24.2 9.0 5.8 24.3 24.2N
IP/C0nz −691 691 817 1366 690 690 813 993 N
eqIP−n −81 81 84 108 83 83 90 108 N
ineq,NoSECIP−n −692 692 830 2477 690 690 813 993 /C22N
IP/C0nineq;finalIP −815.8 918.0 958.1 2504.3 702.1 698.5 855.5 1020.3/C22T
TSPsCPU s0.020.020.020.020.020.020.020.02 /C22N
TSPsiterSECþ −14.4 14.3 14.6 14.5 14.6 14.6 14.6 14.5 P
convIP−n %9030100100100100100100
Table 3Summary of Experiment 2 for CApR-5. The improvement potential of solving CApR-5 with- outany clustering step for~k¼Lis illustrated.CApR-5Unit~k¼10~k¼40Δ
rel[%]/C22J
CApR/C0n €590,911 681,900 15.4 /C22T
IP/C0nCPU s0.01160.11.6e6 /C22N
IP/C0niterSECþ −1.9 39.9 2000N
IP/C0nz −195 2580 1223 N
eqIP−n −43 163 279 N
ineq,NoSECIP−n −195 2580 1223 /C22N
IP/C0nineq;finalIP −196.2 2650.0 1251/C22T
TSPsCPU s0.030−100 /C22N
TSPsiterSECþ −12.20 0 −100 P
convIP−n %1001000M. Graf Plessen Artiﬁcial Intelligence in Agriculture 2 (2019) 99 –109
108Plessen, M.M.G., 2018.Partialﬁeld coverage based on two path planning patterns. Biosyst.Eng. 171, 16–29.Schrijver, A., 1998.Theory of Linear and Integer Programming. John Wiley & Sons.Seyyedhasani, H., Dvorak, J.S., 2017. Using the vehicle routing problem to reduce ﬁeld completion times with multiple machines. Comput. Electron. Agric. 134, 142 –150. Sørensen, C.G., Bochtis, D.D., 2010. Conceptual model ofﬂeet management in agriculture. Biosyst. Eng. 105, 41–50.Statistisches Bundesamt Deutschland, 2016. Land- und Forstwirtschaft. https://www. destatis.de/DE/Publikationen/StatistischesJahrbuch/LandForstwirtschaft.pdf?blob=publicationFile.Toth, P., Vigo, D., 2014.Vehicle Routing: Problems, Methods, and Applications. SIAM.Williams, H.P., 2013.Model Building in Mathematical Programming. John Wiley & Sons.M. Graf Plessen Artiﬁcial Intelligence in Agriculture 2 (2019) 99 –109
109