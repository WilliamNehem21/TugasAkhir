 AASRI Procedia   3  ( 2012 )  54 – 59 
2212-6716 © 2012 The Authors. Published by Elsevier B.V. Selection and/or peer review under responsibility of American Applied Science Research Institutedoi: 10.1016/j.aasri.2012.11.010 
 
 2012 AASRI Conference on Modeling, Identification and Control 
An United Recursive Robot Dynamics Based on Screws  
Bing Shao *, En-tao Yuan 
College of Mechanical Engineering, Shanghai Dianji University, Jiangchuan Road 1201 of minhang district, Shanghai 200240, China   
Abstract 
The key point of robot dynamics is optimal design and contro l. The efficiency of robot dynamics has been the goal of researchers in recent years. Screws are used to describe dy namic problems in this paper, and an O(N) recursive robot forward dynamic algorithm is given on this. It can be easily extended to tree topology, closed loop and spatial robot systems. And three classic methods of robot dynamics are compared for easy of use. The results show that dynamics described with screws are helpful in high efficient dynamics modelling. The dynamical expressions based on screws are concise and clear. It
s efficiency is high of O(N) and is linear to the degree of freedom. With the improvement of computation efficiency, it will make the real-time dynamics control become possible. 
 © 2012 Published by Elsevier B.V. Selection and/or peer review under responsibility of American Applied Science Research Institute  
Keywords: Robot, dynamics, recursive algorithm, screws 
1. Introduction For the simulation and control of astronautics robot s and complex mechanical systems, computation efficiency is very important. In the many methods of analyzing space machine, screw is an efficient tool. Screw can be expressed by a pair of vectors, such as  angular velocity and linear velocity, force and moment. In 3-D space, screw can be described as six scalar quan tities. The use of screw theory has been very effective. 
  * Corresponding author. Tel.: +86-15021216409. E-mail address: shaobox@tom.com. 
Available online at www.sciencedirect.com
© 2012 The Authors. Published by Elsevier B.V. Selection and/or peer review under responsibility of American Applied Science Research Institute Open access under CC BY-NC-ND license.
Open access under CC BY-NC-ND license.55  Bing Shao and En-tao Yuan  /  AASRI Procedia   3  ( 2012 )  54 – 59 
 Also, it is important in developing algorithms which have applicability to robotic mechanisms with general geometries and joint structures. So it is easily applied  in kinematics and dynamics and it is excellent in clear geometry conception and simple expression form. The Lie algebras are the algebraic structure of Lie groups 
(3)SE expressed by screws. The Lie groups and Lie algebras have been very effective in the methods of analyzing space machines. Also, it is important in developing algorithms which have applicability to mechan isms with general geometries and joint structures.  The classical dynamical modelling method is the Lagrange method [1], it leads to O(N
4) algorithms. For inverse robot dynamics, the first O(N) algorithm was the Newton-Euler(NE) formula [2]. The inverse dynamical algorithm of Walker and Orin [3] was the basic of forward dynamics which computed the inertial parameters of composite sets of rigid bodies at the outer end of the manipulator chain. The algorithm was O(N
3). The O(N) algorithm of Featherstone was called the Artic ulated-Body Algorithm (ABA) [4]. In terms of the total number of arithmetic operations required, the AB A was more efficient than the CRBA for N > 9 .  Rodriguez [5] recognized the similarities between the forward dynamics problem and the concepts of Kalman filtering, and developed an O(N) algorithm called the spatial operator algebra(SOA) method for the multi-body dynamics. Jain [6] used the spatial operator algebra framework to provide a unified formulation for manipulator dynamics. He compared the various O(N
3), O(N2), and O(N) algorithms that had been previously published. J. García de Jalón[7] put forward a dynamical algorithm based on full Cartesian coordinates, it can also obtain O(N) complexity. In this paper, an O(N) recursive robot forward dynamic algorithm is described on Screws. Then the computation complexity is interpreted in detail and compared with other methods. At last it gives the different notations of three classic O(N) recursive dynamics for ease of understanding.  2. Inverse and Forward Recursive Dynamics  2.1. The inverse dynamics of Newton-Euler(NE) in screw theory In recent years, modern differential geometry has been very important in robotics. So we define motion screw as: 
6 Tvv R , and force screw as: 6 Tff R . A robot mechanism can be expressed by: N rigid body links, marked as 
, a fixed base, a set of N joints which join the base and the links together. Figur e 1 is the velocity and acceleration of two adjacent links, the velocity of link i is 
iv, and 
1 ii i ivv h q                                                                                                                                            (1) Where 
6ihR  spanning the motion freedom subspace of joint i, and iq is the vector of joint velocity. The time-derivative of above equation is:
 
1 ii i i iaa h q c                                                                                                                                     (2) Where 
ia is the acceleration of link i, composed by the angular acceleration and line acceleration. iq is a vector of joint acceleration. 
icis the bias acceleration contains the centrifugal acceleration and the Coriolis acceleration, and 
ii ich q . 56   Bing Shao and En-tao Yuan  /  AASRI Procedia   3  ( 2012 )  54 – 59 
 1110 00
10iiiiRRrR r R R                                                                                        (3) Where 
1ii is the coordinate transformation matrix from i-1 to i, then   The algorithm of NE in screw is: 
00
11
110; 01:
iii i i iii iiii i i i i ivafor i nvv h qhv ha a hq hqend
                                                                                                                    (4) 
2.2. The forward dynamics in screw theory According to Featherstone, there are a matrix and a vector which 
IA Aii i ifI a Z                                                                                                                                          (5) Where 
AiI is the articulated body inertia of link i independent of joint velocity. AiZ is the articulated body zero force of link i independent of joint acceleration. Force of any body in figure 2 can be written as: 
11 111IOii iiifI a Zf                                                                                                                           (6)    The superscript of I and O represent the in ward joint force and outward force acting on body B
i separately.  
11 Oi Iii iff                                                                                                                                           (7) Substitute equation 7 in 6 and then in equation 5,  
1 11 11()Ii AA ii ii i i i ifI a Z I a Z                                                                                                       (8) Substitute equation 2 in the above equation 
1111 1 1 1()( )IiAi i A A A ii i i i i i i i i i i i if I I a Z Z Ic Ih q                                                                   (9) The fore 
if projecting on the axe is the drive force of joint. Tii iQh f , combine this with equation 2 and 7, 57  Bing Shao and En-tao Yuan  /  AASRI Procedia   3  ( 2012 )  54 – 59 
 11()TA i T A ii ii i i i i i iQh I a q hc h Z                                                                                                     (10)  From which the acceleration can be solved: 
11 ()TA i T A Aii i i i ii i ii TAiii Qh I a h Z I cqhIh                                                                                                  (11)  Substitute equation 12 in equation 10 
1111 1 1 1AT A A AT A ii i i i ii Ii A i i A A ii ii ii i i i i i i i i iTA TA iii iiiIh Q h Z IcIh hIfI Ia Z Z I chIh hIh     (12) Compare this with equation 7, it can be concluded that: 
111 1AT A Ai A i ii ii ii i i i TAiiiIh hIII IhIh                                                                                                   (13) 
111AT A Aii i i i ii Ai A A iii i i i TAiiiIh Q h Z IcZZ Z I chIh                                                                   (14) Where 
AnnII , AnnZZ . All these above equations lead to O(N) forward dynamics in screw theory: 
1:
0
0iii iiiiii ifor i nmgiZIMIIcv hend
111 1111:2
AT A Ai A i ii ii ii i i iTAiiiAiiiiAT A Aii i i i iiAAii i TAiiifor i nIh hIII IhIhZZIh Q h Z IcZI chIhend
11
111:
()TA i T A Aii i i i ii i ii TAiiiiii i i i ifor i nQh I a h Z I cqhIhaa c h qend
 (15) Equations 15
 are forward dynamics of robots, composed by four steps: 1. Recursively computing velocity for each link from base to end. 2. Initializing 
iZ and iI, computing bias acceleration ic. 3. Recursively computing articulated body inertia and zero acceleration force for each link from end to base. 58   Bing Shao and En-tao Yuan  /  AASRI Procedia   3  ( 2012 )  54 – 59 
 4. Recursively computing the acceleration force for each link from base to end. It can be seen that the computation complexity of abov e equations grows linearly with DOFs of robot, that is the algorithm is O(N). The above-mentioned algorithms can be easily extended to tree topology, closed loop and spatial robot systems.
 
3. Computational complexity Table 1 shows the computation complexity of three kinds of different forward dynamics cost. The algorithms in screw and that of Rodriguez are both O(N) methods. But the SOA method presented by Rodriguez lead to a complex process of forward dynam ics. The algorithm put forward by Walker and Orin is O(N
3). When the DOF of a robot is N 6, the above methods are the same. If the robot is complex of N 17, the O(N) method is more efficient of half cost. 
Tab.1 : Computational complexity of forward dynamics 
Forward dynamics algorithms Computational complexity N =6 N =17 
Walker and Orin[3] (1/3)N3+65N2+(197/6)N-33 2567 18948 
Rodriguez formula [6] 477N-503 2359 7606 
Screw formula 594N-567 2997 9531 
4. Three classic methods of O(N) recursive dynamics Table 
2 gives the different notations of the above three O( N) recursive dynamics for ease of understanding.  
Tab.2 Notations of three O(N) recursive dynamics 
O(N) recursive dynamics SOA  ABA Lie algorithm 
Body count 1nk k k 
Joint velocity ()k kq kq 
From joint to state space *()Hk  ks ks 
Move velocity to prior link *(1 , )kk  1 kkX  1,1kkTAd  
Move force to next link (1 , )kk  
1*
k kX  1,1*
kkTAd  
Spatial velocity ()Vk  kv kV 
Spatial acceleration ()k ka kV 
Spatial force ()fk kf kF 
Rigid link inertia ()Mk kI kJ 
Kalman gain *1() () () ()Gk PkH kD k  **AkkAkk kIssI s **kkkk kJssJs 
Articulated inertia ()Pk AkI kJ 59  Bing Shao and En-tao Yuan  /  AASRI Procedia   3  ( 2012 )  54 – 59 
 Force of zero acceleration ()zk AkP kB 
There are three kinds of O(N) recursive dynamics, the spatial operator algebra(SOA), the articulated body algorithms(ABA) and the Lie Algebras. For inverse dy namics, these dynamical algorithms are all based on recursive Newton-Euler algorithm. It can be seen the same from this point of view. For forward dynamics, the authors of SOA recognized the analogy between Kalman filtering and robot dynamics and got the inverse of the mass matrix. The ABA used the articulated body to cr eatively divide the spatial force into two parts, the force related to acceleration and the force of zero acceleration. The Lie Algebras also applied the articulated body and put forward two dual Adjoint operators. The mechanism in these three recursive methods is: mo vement parameters and their changes in accordance with the articulated body inertia are linked the outward and inward force. The end of the movement is the burden of low order body. The implication is the role of the relationship between the force and the reaction force. The body is linked with outside articulated body de finitely which determine the basis of recursion. This relationship is an objective reality, different scholars have proposed three awareness means.  5. Conclusions Screw is used to describe the robot dynamics in this paper. Similar to Newton-Euler(NE) formula, the inverse dynamics in screw theory is of more simple ex pression form and applicable to large robot systems. The O(N) recursive forward dynamics in screw can be clearly expressed by equations 15. This algorithm can be easily extended to closed loop robot systems, flex ible robot systems and spaceflight robot systems. The O(N) algorithm is efficient especially for large systems. It can be seen that screw is helpful to high efficient dynamics modelling and the formulae of robot dynamics in screw are concise and clear. It also gives the different notations of three O(N) recursive dynamics for ease of understanding. Acknowledgements This research is partially supported by Leading Ac ademic Discipline Project of Shanghai Municipal Education Commission (project number: J51902) and Scien tific Research Project Start-up Fund of Shanghai Dianji University (project number: 11c404). References [1] M. E. Kahn and B. Roth, The Near Minimum time Co ntrol of Open-loop Articulated Kinematic Chains[J], Journal of Dynamic Systems, Measurement, and Control, vol. 93, pp. 164-172, 1971. [2] Xiong Y. L, The basic of Robot Technology [M], Huazhong University of Science and Technology Press, 2002. [3] M. W. Walker and D. E. Orin, Efficient Dynamic Co mputer Simulation of Robotic Mechanisms[J], Trans. ASME, J. Dynamic Systems, Measurement & Control, vol. 104, pp. 205-211, 1982. [4] R. Featherstone, Efficient Factorization of the Join t Space Inertia Matrix for Branched Kinematic Trees [J], Int. J. Robotics Research, vol. 24, no. 6, pp. 487-500, 2005. [5] A. Jain, G. Rodriguez, Multibody Mass Matrix Se nsitivity Analysis Using Spatial Operators [J], Int. Journal for Multiscale Computational Engineering, vol.1, Issue 2-3, 2003. [6] A. Jain, Unified Formulation of Dynamics for Serial Rigid Multibody Systems [J], Journal of Guidance, Control, and Dynamics, vol. 14, no. 3, pp. 531-542, 1991. [7] J. García de Jalón, Twenty-five years of natural co ordinates, Multibody System Dynamics [J].  vol.18, pp. 15
33, 2007. 