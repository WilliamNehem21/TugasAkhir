 AASRI Procedia   4  ( 2013 )  96 – 103 
2212-6716 © 2013 The Authors. Published by Elsevier B.V.
Selection and/or peer review under responsibility of American Applied Science Research Institute
doi: 10.1016/j.aasri.2013.10.016 ScienceDirect
2013 AASRI Conference on Intelligent Systems and Control 2013
A Lyapunov-based Adaptive Control Law for an
Electromagnetic Actuator
Paolo Mercorelli
Leuphana University of Lueneburg
Institute of Product and Process Innovation
V olgershall 1, D-21339 Lueneburg, Germany
Tel.: +49-(0)4131-677-5571, Fax: +49-(0)4131-677-5300
mercorelli@uni.leuphana.de
Abstract
Electromagnetic devices in industrial systems are utilised for problems of positioning and tracking control. A direct
adaptive non-linear control framework for a non-linear electromagnetic actuator is presented in this paper. Starting from
a Lyapunov approach a continuous control law is calculated for the actuator. After that, an approximated sampled ﬁnal
control law is proposed. The resulting control strategy is an adaptive one in which the main parameter depends on the
variable inductance of the actuator itself. This aspect seems to be important to prevent saturation during the control
phase.
c/circlecopyrt2011 Published by Elsevier Ltd. Selection and/or peer-review under responsibility of American Applied Research
Institute
Keywords:
Actuators; adaptive control; Lyapunov approach
1. Introduction and motivation
With the recent rapid progress in permanent-magnet technology, very compact and high-performance
electromagnetic linear actuators are already available in a wide range of applications. They open new
possibilities for high-force motion control in mechatronic applications. Recent contributions are given in this
direction in [1] and in [2] where different electromagnetic actuators are presented together with most of their
important control problems. In particular, control and optimal trajectory generation are analyzed. In [3] and
in [4] an electromagnetic actuator and its sensorless control using Kalman Filter are presented. In industrial
systems, mechanical and/or hydraulic-mechanical components have been often replaced by electromagnetic
ones, see [5] and [6]. One of the most utilized kinds of actuator is the linear electromagnetic one. There are,
beside linear electromagnetic actuators, other types of electromagnetic actuators with different advantages,
corporations, such as BMW [7], GM [8], DaimlerChrysler AG [9], Renault [10] and Siemens [5, 11] have
based their prototype developments on the electromagnetic actuator design. A typical set-up for this kind
of electromagnetic valve actuator, see the left side of Fig. 1, is equipped with two electromagnets and two
springs and a moving armature. The upper coil is responsible for the closing phase and the lower coil is
Available online at www.sciencedirect.com
© 2013 The Authors. Published by Elsevier B.V.
Selection and/or peer review under responsibility of American Applied Science Research InstituteOpen access under CC BY -NC-ND  license.
Open access under CC BY -NC-ND  license.97  Paolo Mercorelli  /  AASRI Procedia   4  ( 2013 )  96 – 103 
Fig. 1. Left: V alve actuator cross-sections. Right: Half valve actuator cross-sections
responsible for the opening phase of the valve. Since the inductance depends on the air gab between thearmature and the pole, the magnetic force is very sensitive to the variation of the air gap. The force increasesin a non-linear relation with respect to the air gap. Because of that, the input voltage should change veryfast to compensate these force variations. In this paper a direct adaptive non-linear control framework for anon-linear electromagnetic actuator is proposed in which, starting from a Lyapunov approach, a continuouscontrol law is derived for the actuator. After that, an approximated sampled ﬁnal control law is proposed.The resulting control strategy is an adaptive one in which the main parameter depends on the variableinductance of the actuator itself. This aspect seems to be important to prevent saturation during the controlphase. The proposed control law seems to be suitable to avoid rapid changes in the input voltage which cangenerate saturation. In fact, the proposed control law compensates this variability effect of the inductancedue to the movement of the armature using basically a cancelation. The paper is organised in the followingway. Section 2 is devoted to the model description of the considered actuator. Section 3 proposes an analysisto derive the control law. Conclusions and future work close the paper.2. Model descriptionIn Fig. 2 the scheme of the magnetic circuit is drawn. State vector x(t)=[i(t),s(t),v(t)]and input u
in(t)are taken under consideration for the representation of the system. Currenti(t), armature positions(t), velocityv(t)and input voltage byu
in(t)are the state variables. The dynamics of the electrical part of the actuator is the following:u
in(t)−R cui(t)−u q(t)=0.(1) Considering that:Φ
Coil(t)=L(t)i(t), (2) withΦ
Coil(t)the magnetic ﬂux is indicated. The induced voltage is:u
q(t)=∂L(t)∂ti(t)+L(t)∂i(t) ∂t.(3) Inserting equation (3) into (1) the following expression is obtained:∂i(t)
∂t=1L(t)/parenleftBiguin(t)−R cui(t)−∂L(t)∂ti(t)/parenrightBig,(4)98   Paolo Mercorelli  /  AASRI Procedia   4  ( 2013 )  96 – 103 
wherei(t)is the current,u(t)is the supply voltage,R cuis the resistance andLindicates the inductance. InductanceLdepends on currenti(t)and on distances(t). The mechanical dynamics are represented by:∂s(t)
∂t=v(t) (5)∂v(t)
∂t=1 M/parenleftbig−kfs(t)+F in(t)−k vv(t)+d(t)/parenrightbig.(6) From [12] and considering the hypothesis of a uniformly distributed ﬂux, the following expression for themagnetic force is obtained:F
in(t)=i2(t)N2
R2(s(t))A Fe1μ0. (7) Mis the mass of the armature,k
fis the constant which characterizes the spring,A Fe1 the magnetic pole cross-sectional area,Nis the number of the windings of the coils,k
vis the friction coefﬁcient,d(t)repre- sents the force acting against the cylinder because of the burning phase of the engine.μ
0is the magnetic air permeability andRis the magnetic reluctance from the air gap point of view. The parametersk
fandkv
are considered constant here. In the right part of Fig. 2 a polynomial approximation of the inductance as afunction of the valve position is shown.
RmFe1
2
ΦAir>ΦCoilRmFe1
2ΘCoil
ΦσRmσ
R
mAir
2
RmFe2∨
RmAir
2∨
0 2 4 6 8 10 1200.10.20.30.40.50.60.7
Valve position (mm)Inductance (mH)
Fig. 2. Left: Magnetic equivalent circuit of the actuator. Right: Polynomial approximation of the inductance as a function of the valveposition.
It holds:Θ
Coil=i(t)N, (8)Φ
Coil=ΘCoil
Rmsum. (9) Moreover it is possible to write that:R
msum=RmHe1+Rmp, (10) whereR
mFe1represents the ferromagnetic pole reluctance andR
mp=Rmσ(RmFe2+RmAir)
Rmσ+RmFe2+RmAir(11)99  Paolo Mercorelli  /  AASRI Procedia   4  ( 2013 )  96 – 103 
is the parallel reluctance. In (11),R mσis the reluctance related to the leakage ﬂux andR mFe2 is the armature magnetic reluctance.Moreover,R
mFe1=/lscriptFe1
μ(H Fe1)AFe1,RmFe2=/lscriptFe2
μ(H Fe2)AFe2, whereμ=
BFe1
HFe1,/lscriptFe1 is the ferromagnetic pole length,μ=BFe2
HFe2,/lscriptFe2 is the armature length andA Fe2 is its cross-section.In addition,R
Air=2s(t)
μ0AFe1,Rmσ=RmFe2 RAir
k0s(t), wherek
ois a constant. Through mathematical calculations, the following expression is obtained:Φ
σ=Φcoil(RmFe2+RmAir)
Rmσ+RmFe2+RmAir(12) andΦ
Air=ΦcoilRmσ
Rmσ+RmFe2+Rmair.(13) The reluctance from the air gap point of view can be calculated as follows:R=(R
mσ+RmFe2+RmAir)Rmsum
Rmσ.(14) The uniform magnetic density ﬂuxes are calculated in the following way:B
Fe1=ΦCoil
AFe1,BFe2=ΦAir
AFe2,BAir=ΦAir
AFe1.(15) Note that the reluctanceR
mAir andRmσare strongly dependent on the armature position.3. An adaptive Lyapunov Based ControllerIt is known that inductanceL(t)depends on positions(t), and thus starting from equations (4)–(6) the following differential equations are obtained:∂i(t)
∂t=1 L(s(t))/parenleftBiguin(t)−/parenleftbigR cu+∂L(t)∂t/parenrightbigi(t)/parenrightBig(16)∂L(t)
∂t=∂L(t) ∂s(t)∂s(t)∂t (17)∂s(t)
∂t=v(t) (18)∂v(t)
∂t=1 M/parenleftbig−kfs(t)+F in(t)−k vv(t)+d(t)/parenrightbig.(19) The system represented by equations (16)–(19) can be represented as follows:˙x(t)=⎡⎢⎢⎢⎢⎢⎢⎣
∂i(t)
∂t∂L(t)
∂t∂s(t)
∂t∂v(t)
∂t⎤⎥⎥⎥⎥⎥⎥⎦=f(x(t))+g(x(t))u
in(t)+Dd(t)(20)100   Paolo Mercorelli  /  AASRI Procedia   4  ( 2013 )  96 – 103 
with ﬁeldsf(x(t)) =⎡⎢⎢⎢⎢⎣−
1
L(s(t))/parenleftBigR
cui(t)+∂L(t)
∂ti(t)/parenrightBig
∂L(t)
∂s(t)v(t)v(t)
1
M/parenleftbig−k
fs(t)+F in(t)−k vv(t)/parenrightbig⎤⎥⎥⎥⎥⎦,g(x)=⎡⎢⎢⎣1
L(s(t))
000⎤⎥⎥⎦,D=⎡⎢⎢⎣000
1
M⎤⎥⎥⎦.(21)If the following controller is deﬁned:K(t)=G/parenleftbigx
d(t)−x(t)/parenrightbig, (22) whereG=/bracketleftbigP
i0PsPv/bracketrightbig, in whichP
i,PsandPvare constant to be set.x d(t)represents the vector of the desired state variables of the actuator. Equation (22) becomes as follows:K(t)=/bracketleftbigP
i0PsPv/bracketrightbig⎡⎢⎢⎣id(t)−i(t)L
d(t)−L(t)s
d(t)−s(t)v
d(t)−v(t)⎤⎥⎥⎦(23)withP
i,PsandPvare the parameters of the controller. If the following Lyapunov function is deﬁned:V(K)=K
2(t)
2, (24) then it follows that:˙V(K)=K(t)˙K(t). (25) To ﬁnd the stability condition of solutionK(t)=0, the following Lyapunov function is considered:˙V(K)=−η(t)K
2(t), (26) withη>0. Comparing (25) with (26), the following relation is obtained:K(t)˙K(t)=−ηK
2(t), (27) and to conclude it follows that:K(t)/parenleftbig˙K(t)+ηK(t)/parenrightbig=0. (28) The constructive solution is obtained using the following condition:˙K(t)+ηK(t)=0. (29) From (22) it follows:˙K(t)=G/parenleftbig˙x
d(t)−˙x(t)/parenrightbig=G˙x d(t)−G˙x(t).(30) The basic idea is to calculate au
eq(t), an equivalent input, and after that au in(t), such that˙x(t)=˙x d(t). For that, from (20), ifd(t)=0, then:˙x(t)=˙x
d(t)=f(x d(t))+g(x d(t))uin(t),(31) and from (30) it follows:˙K(t)=G˙x
d(t)−Gf(x d(t))−Gg(x d(t))uin(t)=Gg(x d(t))/parenleftbigueq(t)−u in(t)/parenrightbig,(32) whereu
eq(t)is the equivalent input and it follows that:u
eq(t)=/parenleftbigGg(x d(t))/parenrightbig−1G/parenleftBig˙xd(t)−f(x d(t))/parenrightBig.(33)101  Paolo Mercorelli  /  AASRI Procedia   4  ( 2013 )  96 – 103 
After inserting (32) into (29) the following relation is obtained:Gg(x
d(t))/parenleftbigueq(t)−u in(t)/parenrightbig+ηK(t)=0,(34) and in particularu
in(t)=u eq(t)+/parenleftbigGg(x d(t))/parenrightbig−1ηK(t).(35) Normally, calculatingu
eq(t)could be difﬁcult. Using Euler approximation, equation (32) can be rewrittenin a discrete form as:K((k+1)T
s)−K(kT s)
Ts=Gg(x d(t))/parenleftbigueq(kTs)−uin(kTs)/parenrightbig.(36) Considering Euler approximation for equation (35), the following equation is obtained:u
in(kTs)=ueq(kTs)+/parenleftbigGg(x d(t))/parenrightbig−1ηK(kT s).(37) Equation (36) can be also rewritten as:u
eq(kTs)=uin(kTs)+/parenleftbigGg(x d(t))/parenrightbig−1K((k+1)T s)−K(kT s)
Ts.(38) Equation (38) is equivalent to:u
eq((k−1)T s)=uin((k−1)T s)+/parenleftbigGg(x d(t))/parenrightbig−1K(kTs)−K((k−1)T s)
Ts.(39) Because ofu
eq(t)is a continuous function, then:u
eq(kTs)≈ueq((k−1)T s).(40) Considering equation (40), then equation (39) becomes:u
eq(kTs)=uin((k−1)T s)+/parenleftbigGg(x d(t))/parenrightbig−1K(kTs)−K((k−1)T s)
Ts.(41) Inserting (41) into (37):u
in(kTs)=uin((k−1)T s)+/parenleftbigGg(x d(t))/parenrightbig−1/parenleftBigηK(kT
s)+K(kTs)−K((k−1)T s)
Ts/parenrightBig,(42) and ﬁnally:u
in(kTs)=uin((k−1)T s)+/parenleftbigGg(x d(t))Ts/parenrightbig−1/parenleftBigηT
sK(kTs)+K(kT s)−K((k−1)T s)/parenrightBig.(43) Remark 1.It is to notice that/parenleftbigGg(x
d(t))Ts/parenrightbig−1=L(s(t))
PiTs. Factor/parenleftbigGg(x d(t))Ts/parenrightbig−1represents the main weight of the control. The resulting control law is an adaptive one in which the main parameter dependson the variable inductance of the actuator itself. This aspect seems to be important to prevent saturationduring the control phase. Because of the presence of the inductance value in the numerator of this factor ,from equation (16), the control law cancels the effect of this nonlinearity. /square4. SimulationsSimulated results are visible in Figs. 3 and 4. This trajectory corresponds to 6000 rounds per minute.The power involved for each exhaust valve does not exceed the mean value of 60 W in the case of 6000 rpm.A sampling time equal to20×10
−6sec.is used.102   Paolo Mercorelli  /  AASRI Procedia   4  ( 2013 )  96 – 103 
0.01 0.02 0.03 0.04 0.05 0.06 0.07−15−10−5051015
Time (sec.)Position (mm)
Desired valve position
Obtained valve position
0.018 0.02 0.022 0.024 0.026−2024681012
Time (sec.)Position (mm)
Desired valve position
Obtained valve position
Fig. 3. Left: Position (6000 rpm). Right: Detail of the position (6000 rpm)
0.01 0.02 0.03 0.04 0.05 0.06 0.07−15−10−5051015
Time (sec.)Velocity (m/sec.)
0.018 0.02 0.022 0.024 0.026−4−202468
Time (sec.)Velocity (m/sec.)Desired valve velocity
Obtained valve velocity
Fig. 4. Left: V elocity (6000 rpm). Right: Detail of the velocity (6000 rpm).
5. Conclusions and future workA direct adaptive non-linear control framework for a non-linear electromagnetic actuator is presented inthis paper and starting from a Lyapunov approach a continuous control law is calculated for the actuator.After that, an approximated sampled ﬁnal control law is proposed. The resulting control law is an adaptiveone in which the main parameter depends on the variable inductance of the actuator itself. This aspect seemsto be important to prevent saturation during the control phase.5.1. Future workThe results which have been presented are based on the assumption that the inductance, as a function ofthe position of the armature, is known. To apply this algorithm in practical applications a robust analysis isrequested.References
[1] P . Mercorelli, An anti-saturating adaptive pre-action and a slide surface to achieve soft landing control for electromagneticactuators, IEEE/ASME Transactions on Mechatronics 17 (1) (2012) 76–85.103  Paolo Mercorelli  /  AASRI Procedia   4  ( 2013 )  96 – 103 
[2] A. Fabbrini, A. Garulli, P . Mercorelli, A trajectory generation algorithm for optimal consumption in electromagnetic actuators,IEEE Transactions on Control System Technology 20 (4) (2012) 1025–1032.[3] P . Mercorelli, A two stage augmented extended kalman observer for sensorless valve control in camless internal combustionengines, IEEE Transactions on Industrial Electronics 59 (11) (2012) 4236–4247.[4] P . Mercorelli, A hysteresis hybrid extended kalman ﬁlter as an observer for sensorless valve control in camless internal combus-tion engines, IEEE Transactions on Industry Applications 48 (6) (2012) 1940–1949.[5] S. Butzmann, J. Melbert, A. Koch, Sensorless control of electromagnetic actuators for variable valve train, in: Proc. SAE Tech-nical Paper 2000-01-1225 (http://www.sae.org/automag/), Detroit, 2000.[6] K. Peterson, A. Stefanopoulou, Rendering the elecreomechanical valve actuator globally asymptotically stable, in: Proc. 42ndIEEE Conference on Decision and Control, Maui, Maui, 2003.[7] R. Flierl, M. Kl¨uting, The third generation of valvetrains - new fully variable valvetrains for throttle-free load control, in: SAE,2000-01-1227 (http://www.sae.org/automag/), 2000.[8] M. A. Theobold, B. Lequesne, R. Henry, Control of engine load via electromagnetic valve actuators, in: SAE, 940816(http://www.sae.org/automag/), 1994.[9] M. Gramann, M. Nagel, T. Rockl, R. Wilczek, Electromagnetic actuator, in: US Pat. 6,037,851, 2000.[10] S. Birch, Renault research, in: Automotive Engineering International Online (http://www.sae.org/automag/), 2000.[11] M. Schechter, M. Levin, Camless engine, in: SAE, 960581 (http://www.sae.org/automag/), 1996.[12] F. Moon, Magneto-solid Mechanics, John Wiley and Sons, New Y ork, 1984.