Optimization techniques in deep convolutional neuronal networksapplied to olive diseases classiﬁcation
El Mehdi Raouhia,⁎,M o h a m e dL a c h g a ra, Hamid Hrimechb,A l iK a r t i ta
aLTI Laboratory, ENSA, Chouaib Doukkali University of El Jadida, El Jadida, Morocco
bLAMSAD Laboratory, ENSA, Hassan First University, Berrechid, Morocco
abstract article info
Article history:Received 24 February 2022Received in revised form 29 May 2022Accepted 1 June 2022Available online 7 June 2022
Keywords:Convolutional neuronal networks (CNN)ClassiﬁcationOptimizationGradient descentPlant diseasesOlive dataset diseases (ODD)Plants diseases have a detrimental effect on the quality but also on the quantity of agricultural production. How-ever, the prediction of these diseases is proving the effect on crop quality and on reducing the risk of productionlosses. Indeed, the detection of plant diseases -either with a naked eye or using traditional methods- is largely acumbersome process in terms of time, availability and results with a high-risk error. The present work introducesa depth study of various CNN architectures with different optimization algorithms carried out for olive diseasedetection using classiﬁcation techniques that recommend the best model for constructing an effective disease de-tector. This study presents a dataset of 5571 olive leaf images collected manually on real conditions from differentregions of Morocco, that also includes healthy class to detect olive diseases. Further, one of the goals of this re-search was to study the correlation effects between CNN architectures and optimization algorithms evaluatedby the accuracy and other performance metrics. The highest rate in trained models was 100 %, while the highestrate in experiments without data augmentation was 92,59 %. Another subject of this study is the in ﬂuence of the optimization algorithms on neuronal network performance. As a result of the experiments carried out, theMobileNet architecture using Rmsprop algorithms outperformed the others combinations in terms of perfor-mance and efﬁciency of disease detector.© 2022 The Authors. Publishing servic es by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is an openaccess article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/4.0/ ).
1. IntroductionThe olive tree is considered as the most cultivated and oldest domes-ticated fruit trees in the world since old ages ( Chliyeh et al., 2014). It is between the scopes 30°–45° in the northern and southern halves of theglobe in climatic locales of Mediterranean sort. In this manner, 97% ofthe world's horticultural region (roughly 10.5 million hectares) is gath-ered in the Mediterranean basin. Morocco occupies the fourth spot be-hind Spain, Italy and Greece, the olive-developing region is around784,000 ha, with a production of 1,483,510 tons of olives each year.Likewise, it serves to contribute effectively in the development of thecountry's populace by producing in excess of thousand million workingdays (Vega-Márquez et al., 2020). 5.6% of the region's general surface(PMMA, 2011) spread more than three fundamental regions: The Rif(Taounate, Chefchaoune), the middle (Fes, Meknes, Taza) and thesouth (Haouz, Tadla and the seaside district among Sa ﬁand Essaouira). Lamentably, the olive is exposed to the assault of different micro-organisms, which inﬂuences its wellbeing, its yield and the nature ofits oil. Either building new olive tree manors, or the effect of watersystem on the event of plant infections and the passing of youthfultrees have equally expanded, disturbing olive producers ( Abade et al., 2021). Otherwise, the exponential increase in the global population isa fact and it tends towards 9.5 billion by 2025, the need of the popula-tions for food will be much higher in the future. Losses of agriculturalland (Uguz and Uysal, 2020), climate change and prediction limits forplant diseases mainly explain why the demand for food cannot bemet. The challenge on plant pests presents one of the most interestingﬁelds of research in agriculture in terms of dif ﬁculty and risks associated with thisﬁeld. It appears from literature studies that signi ﬁcant in- creases in yield have been detected in many agricultural products as aresult of the control of numerous plant pests ( Liu and Wang, 2021). Some of the causes of plant diseases include living agents such asfungi, bacteria and viruses, as well as environmental factors such asbad weather and burning chemicals ( Moorthy et al., 2020; Esgario et al., 2019; Uguz and Uysal, 2020; Gavhale and Gawande, 2019 ). To re- spond to these challenges. The current review was done in Morocco toadd to the identiﬁcation disease (ID) of the sicknesses which in ﬂuence the olive tree, through the constitution of a bunch of information gath-ered under genuine conditions on various districts of the nation and forvarious illnesses which inﬂuence plants and particularly the olive tree,inside and outside learning regions introduce themselves as a basicArtiﬁcial Intelligence in Agriculture 6 (2022) 77 –89
⁎Corresponding author.E-mail address:raouhi@gmail.com(E.M. Raouhi).
https://doi.org/10.1016/j.aiia.2022.06.0012589-7217/© 2022 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is an open access article under the CC BY-NC-ND license (http:// creativecommons.org/licenses/by-nc-nd/4.0/ ).
Contents lists available atScienceDirect
Artiﬁcial Intelligence in Agriculture
journal homepage:http://www.keaipublishing.com/en/journals/artificial-intelligence-in-agriculture/answer to distinguish the discovery and spread of olive tree infections,early ID in theﬁeld is a vital initial step (Foysal et al., 2019). This nor- mally prompts moving toward the idea of Deep Learning, which is es-sential for AI that trains preparing information utilizing networklayers with numerous neurons (Hussain et al., 2018), by this CNNs are the best learning calculations for understanding picture content andshown high performance in undertakings identi ﬁed with picture divi- sion, order, recognition and extraction. The accomplishment of CNNshas drawn consideration past scholarly community. In industry, organi-zations, for example, Google, Microsoft and Facebook have createddynamic examination gatherings to investigate new CNN model struc-tures. Today, a large portion of the pioneers of picture handling and PCvision (CV) contests use CNN-based models ( Pantazi et al., 2020). So, the main areas of this work can be summarized as follows. First, the pre-sentation of CNN architectures and plant diseases used mainly in the lit-erature for olive plant diseases classiﬁcation. Second, this work presentsan exploratory analysis with performance analysis simulation of theassembled dataset for olive tree diseases presented previously. Inaddition, the fundamental aim of this review is to distinguish the sideeffects of classes of six olive plant leaves illnesses generally seen.The dataset is composed with 5571 images assembled to demonstratethe performance of the system detector as well as m a benchmark forrelative works. Research collected have demonstrate that olive plantleaves diseases can be detected with high performance without havingto ask for the help of an expert in theﬁeld. with the aim of improving classiﬁcation performance. This work seeks to answer the followingquestions:•What's the effects of CNN Model on the performance of olive diseaseclassiﬁcation? (How performant is the CNN model in classifyingolive diseases?)•What's the effects of optimization on the performance of olive diseaseclassiﬁcation? (What optimization algorithm gives the best perfor-mance in classifying olive diseases?)•Is there a correlation between CNN Model used for classi ﬁcation and algorithm used to optimize loss function? (Is there a correlationbetween the CNN model as a classiﬁer and the various loss functionoptimization algorithms selected?)The structure of the remainder of this paper is organized as follows.Firstly,Section 2presents Materials and Methods introduced by thebackground and related works then describes the simulation work ﬂow processed. Secondly,Sections 3and4covers the experimental setup de-tailed by the result of simulations and discussions. Finally, Section 4 states some conclusions and some perspectives opening for futurework.2. Materials and methods2.1. Convolution neuronal networkFrom 1989 to nowadays, various technological feats in the engineer-ing of neural networks have been demonstrated ( Pedrycz, 2020). These innovations can be ordered in the form of improved classi ﬁcation and regularization constraints. In a sense of continuous performance en-hancement of its intelligent systems and according to the elaborationof the use cases.2.1.1. AlexNetIn comparison to conventional techniques this architecture was oneof the main deep structures to evolve the performance of ImageNet clas-siﬁcation by a crucial step, the AlexNet introduced a new engineering inthe works of the works (Alruwaili et al., 2019), using the recti
ﬁed linear unit ReLu for the nonlinear fraction, instead of a tangent hyperbolicTanh or Sigmoid function, which before integrated classical neural net-works. ReLu is given by:fðxÞ¼maxð0, xÞð 1ÞThe strong point of the function of ReLu compared to the sigmoid func-tion is the computation time justiﬁed by the fact that the function needsto choose max (0, x) instead of performing exponential operations inthe execution time which is more expensive, sigmoid turns out to betiny in the immersion area and therefore weight updates almost disap-pear. This is labeled the vanishing gradient problem.Fig. 1shows a basic layout of AlexNet architecture showing its ﬁve convolution layers and three fully connected layers.
Fig. 1.Classical structure of AlexNet deep neural network.E.M. Raouhi, M. Lachgar, H. Hrimech et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 77 –89
782.1.2. VGGArchitectural design research has increased following the success ofCNN networks especially in image recognition tasks. In this view the au-thors of this work presented inPedrycz (2020), which recommends a simple and powerful plan directive for CNN structures. Their layeredpresentation, called VGG, was separate. Unlike AlexNet, VGG relies on16 or 19 deep layers to draw inspiration from the relationship ofdepth with the capacity to represent the composition of the layers(Uguz and Uysal, 2020).Fig. 2shows a basic layout of VGG architecture.2.1.3. GoogleNetThe GoogleNet is introduced to challenge a simple objective in orderto achieve the best performance with the lowest cost ( Pedrycz, 2020). This was made possible through the revolutionary idea of the beginningblock in CNN, it joins convolutional modi ﬁcations at different scales using the concept of division, change and union. In GoogleNet, conven-tional convolutional layers are exchanged by small squares as underly-ing to each layer with miniature neural networks as presented in Fig. 3.2.1.4. Residual networkResNet redesigned the engineering of CNN by introducing theidea of continuing to develop in CNNs for the preparation of deeporganizations. Taking the example of road networks, each of the pastmodels used deep neural conﬁgurations in which they coherentlysuperimposed several layers of convolution. The authors in Pedrycz (2020)found that deeper conﬁgurations are more efﬁcient. In order to overcome these constraints, the authors of the ResNet architecture pre-sented inFig. 4introduced jump associations with the speculation thatthe deeper layers will allow learning similar to that achieved by theshallower layers.2.1.5. CNN characteristicsDeep CNN performs well in time series data or in grid type topology.Notwithstanding, there are other challenges, among which a deep CNNarchitecture has been applied. The fundamental dif ﬁculties related with the distinctive CNN models are referenced on Table 1with a signiﬁcant strength and prattles.Deep CNN works well in time series data or in grid type topology.However, there are other challenges, among which a deep CNN archi-tecture has been applied. The main challenges associated with thedifferent CNN architectures are mentioned on Table 1with major strength and gabs.2.2. Olive diseasesMore than 95% of the 750 million hectares are cultivated in the Med-iterranean region. it is important to note that various factors can impactthis crop including insects, nematodes and pathogens, the latter causingserious damage to the olive crop production overall the European Union(Pedrycz, 2020). Commercial operations of goods and people, climatechange and changes in agricultural practices have favored the introduc-tion, spread and establishment of certain diseases in olive production(Sinha and Shekhawat, 2020). However, many pathogenic and pest fac-tors negatively impact the yields of olive trees ( Moorthy et al., 2020; Chliyeh et al., 2014)Fig. 5. Diseases such as:2.2.1. Black olive diseaseThe Black Olive disease presented inFig. 6is characterized as a fun- gus spread by mealybugs. The leaves are overcast by black dust andblock the tree's breathing process. Laying females have between 1000and 2000 eggs under their shells. There are two types of impact, directimpacts on the leaves and twigs (by extracting the sap), causing theleaves to drop, weakening the vitality of the trees and the death of thetwigs in the event of a severe infestation ( Alves et al., 2019). The main damage is the indirect damage caused by the secretion of a largeamount of soot-covered honeydew, which covers the fruits and leaves
with a dense black substance. As a consequence, the leaves fall off, theolives quality deteriorates and the shoots become wilted ( Sinha and Shekhawat, 2020)Fig. 5.2.2.2. Peacock eye diseaseThe Cycloconium or“peacock's eye”presented inFig. 7is a disease in the effects are the most serious because it attacks both the leaves andthe fruit, it appears as a spot of an interval between 2 and 10 mm diam-eter circular yellow or brown and are mainly found on the upper surfaceof the leaves, stems or even directly on the fruit mainly infecting theplant photosynthetic ability, these complications can be presented byleaf drop or a signiﬁcant reduction of production in the second year par-ticularly. Newly sprouted leaves are likely to be asymptomatic over along period of several months, under conditions of high humidity andrain (Sinha and Shekhawat, 2020).2.2.3. Verticulosis diseaseThe Verticillum dahliae presented in Fig. 8occurs as a microscopic fungus that spreads in the soil and infects the tree through a rise ofsap. Contagion develops through root wounds or through pruningusing infected tools (Sinha and Shekhawat, 2020). The external patho- logical symptoms of the disease manifest itself in an acute form inyoung trees and a speciﬁc form in older trees. In addition, the symptoms
Fig. 2.Classical structure of VGG deep neural network.E.M. Raouhi, M. Lachgar, H. Hrimech et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 77 –89
79of stroke appear in the period of late winter or early spring. It is charac-terized by a rapid and signiﬁcant wilting of the twigs, secondary andmain branches with a brown bark that tends towards purple developingfrom tip to base. These leafy organs have leaves that curl towards theirunderside and whose greenish color degrades to turn light brown,which makes them completely dry(Singh et al., 2020).2.2.4. Anthracnose diseaseWidespread throughout the Mediterranean basin. Anthracnose pre-sented inFig. 9is one of the illness that most affects the olive tree. Man-ifests throughout the maturation and growing of the fruit and throughfurther than one cycle throughout the year. appears in the form of a par-asite manifested by the phyto pathogenic growth alluding to the enor-mous types of Colletotrichum, this disease is probably the main foliarfungus of the olive tree and the main infection of the natural product.These characteristics in general are rotting and mummi ﬁcation of olives (Sinha and Shekhawat, 2020).2.2.5. Tuberculosis diseaseThe disease is mainly manifested by the appearance of protuber-ances on branches, trunks and roots in spring and summer, usually atthe nodes at the base of leaves and fruit stems. Generally, the Tubercu-losis disease impacts directly the production ( Sinha and Shekhawat, 2020). Olive knots presented inFig. 10are visible and very responsive on the tree. Has aerial tumors instead of the typical leaf necrosis andulcer. A hyperplastic growth (galls or nodules) on the branches andstems of the tree and sometimes on the leaves and fruits presents char-acteristic symptoms of the disease.2.2.6. Saissetia oleae diseasePart of the coccidae family. The Saissetia Oleae is a cochineal pre-sented inFig. 11. it is spread over a good number of wild and leafyplants. it manifests itself on different crops, in particular ﬁg trees, citrus fruits, apricots and olive trees. It manifests mainly on the branches untilthey are completely covered in some cases [9]. the disease weakens theplant leading to the destruction of its vital organs. Through the secretionof honeydew on leaves and twigs. As it happens allows the expansion ofsoot (Sinha and Shekhawat, 2020).2.3. Related workRelated work can be classiﬁed into two categories: Firstly, tech-niques for detecting plant diseases and secondly, techniques used inthe literature particularly for olive plant diseases classi ﬁcation.2.3.1. Techniques for detecting plant diseasesThis section describes the techniques used in the literature for theidentiﬁcation of plant diseases. Firstly, some works ( Gavhale and Gawande, 2019; Saleem et al., 2019; Esgario et al., 2019 ) used datasets based on leaves images, but did not specify whether the datasets werebalanced or unbalanced. The authors in Moorthy et al. (2020)used spec- troscopy to study the interactions between materials and light, regard-ing the frequencies that will be joined or mirrored, the reviewcontended that the majority of the early work on leaves pictures utilizedas a key information section, additionally when the side effect is shown,it shows that the sickness is as of now at a high-level stage and practi-cally speaking there is no hope to save the tainted plants. Henceforththe requirement for elective means and strategies like spectroscopy to
Fig. 3.Classical structure of Google net deep neural network.E.M. Raouhi, M. Lachgar, H. Hrimech et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 77 –89
80recognize and then obstruct the disease at an early phase. Furthermore,the author ofFoysal et al. (2019)proposed a useful and appropriate so-lution for recognizing the classifying areas of sicknesses in tomatoplants. The goal is to track down a profound learning engineering tohandle units more appropriate than the strategy for of acquiring actualexamples (leaves, plants) and to dissect it in the lab as in previous work.Afterwards, at that point, the exploration proposed in Saleem et al. (2019)utilized the Inception v3 engineering to prepare theconvolutional neural networks organization on the cassava infectionpicture dataset collected in Tanzania. To distinguish three sicknessesand two bugs, they demonstrated thatﬁguring out how to relocate is a decent instrument for robotized illness discovery. The model is con-veyed on cell phones to recognize disease of cassava plants progres-sively through a Tensor Flow application. At last, the exploration workintroduced (Abade et al., 2021), treats some compositional models, forexample, AlexNet, GoogLeNet and VGG framed on a public dataset con-taining 87,848 pictures, including 25 unique plants. In a bunch of 58 par-ticular classes of plant sickness types, incorporating sound plants withthe best outcomes exhibitions arriving at a triumph pace of 99.53%.Other works address a very important area regarding the limitationsof data augmentation techniques, In fact, the authors in Tassis et al. (2021)propose an integrated framework using different convolutionalneural networks (CNN) to automate the detection/recognition of lesionsfromﬁeld images collected via a smartphone containing part of the cof-fee tree. In addition, authors inSharma et al. (2020)investigate apotential solution to the model generalization problem on independentdata, by using segmented image data to train convolutional neural net-work (CNN) models. The present experience builds on this previouswork, except that it uses a proper dataset with an improved classi ﬁca- tion model.2.3.2. Techniques for detecting olive leaf diseasesIn the methodology proposed inWaleed et al. (2020), using segmen- tation of the k-mean algorithm which offers greater precision, textureanalysis is applied usingﬁrst to fourth order moments, this helped toidentify the relation of infection with one or more textures using ﬁrst to fourth order moments, in this case this allowed us to identify the in-fection relationship with a high correlation between the area of infec-tion and texture features acting as homogeneity, entropy, which alsohelped to classify the two homogeneous diseases of neofabrie and leafspot of peacock. Subsequently inChandra and Matthias (2017), the au- thors present a proﬁcient model utilizing the idea of move learning ap-plied to distinguish olive tree diseases, a savvy increment of informationwith a weighted number of pictures in each class, and it works in morecomposite conditions with a broadened and further developed informa-tional index. In the simulation results authors exhibit that the optimizedmodel proposed accomplishes higher estimations, as far as exactness,accuracy, recall and F1 estimation with a general precision of 99.11%.Then inWaleed et al. (2020), the authors introduced an automaticolive tree detection system using an improved K-Means algorithm,
Fig. 4.Classical structure of residual network deep neural network.E.M. Raouhi, M. Lachgar, H. Hrimech et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 77 –89
81they propose an automated detection approach of olive trees disease in-cluding an implementation model based on the classi ﬁcation in several steps. Therefore, Random Forest outperformed the others with an over-all accuracy of 97.5% with a 70 –30 ratio between training and testing.In addition to the research presented previously, the experi-mental studies ofUguz and Uysal (2020)using data augmentationtechniques in the trained models obtained a performance rate of95%, while in the experiments without this techniques, the highervaluer was 88%. One more subject of this work is the impact andconnection of the Adam, AdaGrad, SGD and RMSProp streamliningcalculations on network performance. Because of the performedanalyses, the authors presumed that the Adam and SGD by andlarge have unrivaled outcomes. Eventually, when implementingthe Random Forest algorithm to Olive Anthracnose, the resultswere acceptable but could be improved if real data had been col-lected. TheTable 2summarizes the results obtained of the relatedwork carried out in the literature of olive plant diseases classi ﬁca- tion and parameters used in terms of augmentation techniques,number of classes, transfer learning, CNN architecture and data-set volume.TheTable 2summarize the results obtained of the related workcarried out in the literature for the classi ﬁcation of olive tree dis- eases and parameters used in terms of augmentation techniques,number of classes, transfer learning, CNN architecture and data-set volume.Table 1Major challenges associated with implementation of depth based CNN architectures.Architecture Strength ShortcomingsAlexNet - No more convultive layers andparameters used to adapt to the highvolume data set.- Limited efﬁciencycompared to new CNNarchitectures. - The introduction of the rectiﬁed unit and the preprocessing represent animportant advance in computer visiontasks.ResNet - Simpliﬁcation of the process ofknowledge as an extential layer inneuronal networks as an identityfunction.- Overﬁtting due tostacking the samemodules.- Inputs can propagate faster viaresidual connections between layers.- The convolutional and sequentialcharacteristic of the network.VGG - Based on a compact and ef ﬁcient design of complex networks. - The cost of calculationusing fully associatedlayers. - Multitudes of layers of deep andreduced convolutions performed betterthan fewer layers of widerconvolutions.GoogLeNet - Convolutions 1×1 minimize thedimensionality of the channel on thepixel pane. Thus the maximum poolingreduces the resolution.- Risk of data loss due to abottleneck- Offers a validation performance closeto similar architectures with acomplexity (it can’t be considered as anadvantage I guess) and a more optimalcalculation time.
Fig. 5.Sample of olive dataset diseases used in experimentation (A,B) Anthracnose (C) Verticilliose, (D) Fumigina, (E) Saissetia oleae, (F) Cyclonium OP.
Fig. 6.Sample of black olive disease.E.M. Raouhi, M. Lachgar, H. Hrimech et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 77 –89
822.4. SimulationsThe simulation process presented in the Fig. 12below gives a general idea of the process adopted for the implementation of the optimizationtechniques studied and the approach followed to obtain the best results.2.4.1. Simulation workﬂowThe unknown samples in the training dataset are used to train theclassiﬁcation algorithm to determine the CNN models that are mostsuitable for detecting a speciﬁc disease. Finally, suitable model associ-ated with best optimizer were obtained, and the results were evaluatedusing different performance indicators. The analysis shows the optimalmethodology of feature selection employing suitable methods forclassiﬁcation. The most important tasks associated in the image classi ﬁ- cation techniques detailed in the schema above are the designation of asuitable classiﬁer, the extraction of features, the choice of a trainingsample, the preprocessing of the images and determining the optimalclassiﬁcation model, optimization algorithm, processing after classi ﬁca- tion and lastly analyzing the accuracy and performance of the evalua-tion (Dhingra et al., 2018).2.4.2. Context of simulationsBelow is the description of the conﬁguration of the computer hard- ware used for the simulation.•CPU: Processeur i5-8250U @ 1.6 GHz (8 cpu)•RAM: 16384MB•Langage de programmation: Python Version 3.7•Software: Anaconda 3 / Spyder Version 3.3.62.4.3. Data collectionThe dataset contains 5571 images of different plant leaves classes(health and diseases) taken in real conditions from the crop olive ﬁelds. It's composed with seven class diseases with an unbalanced ditributiondiscribed inFig. 13including healthy one.It is important to note that the dataset contains a variety of imagestaken at different stages of the evolution of the olive diseases presentedand this makes it possible to enrich the learning set and thus allow theclassiﬁer to obtain best result on the validation set ( Yousuf and Khan, 2021). At the beginning of this work, many human and material re-sources were devoted to the collection of diseased olive because fewsuitable datasets were available for the real-time detection of olive
Fig. 7.Sample of peacock eye disease.
Fig. 8.Sample of verticulosis disease.
Fig. 9.Sample of anthracnose disease.
Fig. 10.Sample of tuberculosis disease.E.M. Raouhi, M. Lachgar, H. Hrimech et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 77 –89
83diseases. The disease patterns of olive vary with the season and withother factors such as the humidity, temperature and radiance. For exam-ple, rainy weather is conducive to the generation and spread of germs,thereby resulting in the expansion and diffusion of the disease spotson affected leaves. Taking that into consideration, images are collectedunder various weather conditions for more comprehensive applica-tions. Finally, all diseased images in the dataset are annotated manuallyby experts.2.4.4. Data preprocessingThe data preprocessing tasks begins by spanning the data points.Secondly, an achievement of a split on the data using 80 of the imagesfor training and 20 for testing. In addition improvement approacheswere applied for the upgrade of the distribution of pixels over an expan-sive range of intensities, direct discrepancy stretching was applied onthe images.2.4.5. Data annotationImage annotation is a vital step in which the objective is to label thepositions and classes of object spots in the diseased images. In this stage,an algorithm that provides a frame selection function is developed inPython. With this algorithm and together with the knowledge providedby experts in agriculture, the diseased areas of an image can be selectedand assigned to the corresponding classes ( Pantazi et al., 2020). Annota- tions are provided as images in the same size as the originals, stored inJPG or JIFF format. A black colored pixel indicates the background, whileall other colors are used to uniquely identify the leaves of the plants inthe scene. Across the time-lapse footage, the approach consistentlyused the same color code to label occurrences on the same sheet.Then, within the binary mask of each plant, by the delimitation of theleaves, branches and fruits individually, following an approach basedsolely on manual labeling (Garcia and Barbedo, 2018).2.4.6. Data augmentationThe overﬁtting problem in the training stage of CNNs can be over-came via data augmentation. The overﬁtting problem occurs when it is random noise or errors are described, rather than the underlying rela-tionship, seeCap et al. (2020). With more images after expansion viadata augmentation techniques, the model can learn as many irrelevantpatterns as possible during the training process, thereby avoidingoverﬁtting and realizing higher performance. For this end, severaltechniques are used for data augmentation operations, including rota-tion transformations, horizontal and vertical ﬂips, and intensity distur- bance, which include disturbances of brightness, sharpness andcontrast. A Gaussian noise processing operation is also applied. Via theabove operations, new diseased images are generated from eachimage (Cap et al., 2020). The authors use cross-validation before the ap-proach of over-sampling the olive dataset classes ( Vega-Márquez et al., 2020), just as how feature selection should be implemented. Only by re-sampling the data repeatedly, randomness can be introduced into theolive disease dataset to make sure that there won ’t be an overﬁtting problem.TheFig. 14present the distribution of olive disease dataset after ap-plying the augmentation techniques detailled on the above paragraphs.The data augmentation process is carried out by ﬁne-tuning the follow- ing parameters includes rotation_range = 15, width_shift_range = 0.2,height_shift_range = 0.2, shear_range = 0.2, zoom_range = 0.2,horizontal_ﬂip = True,ﬁll_mode =‘nearest’.2.4.7. Feature extractionSome variables or characteristics are very important in forming thedifferent models. In this case, and in order to keep only the most rele-vant variables and eliminate the harmful characteristics that can disturbthe learning of the proposed system, a selection process of variables isthen applied. To this extent, the methods of variable selection used inthis study are the sequential backward selection of variable selection.2.4.8. ClassiﬁcationClassiﬁcation is a function that need the use of machine learning al-
gorithms that learn how to assign a marker to different classes from theproblem sphere. An easy illustration example to understand is classify-ing emails spam. Multi-class classiﬁcation cites to those classiﬁcation functions and characteristics that have further than two class markers.2.4.9. EvaluationPerformance metrics provide inttekigence for decision makers tosupport evaluation. The results are evaluated using distinctive perfor-mance metrics like Accuracy, Error Rate, Kappa, Precision, Recall, F1Score, Mean Absolute Error, and Log Loss to recommend the appropriatefeature selection method for prediction [5]2.4.9.1. Accuracy.Accuracy is calculated according to the formula below.Accuracy¼
TPþTNTPþTNþFPþFN ð2ÞWhere, TP- True Positive; TN- True Negative; FP- False Positive; FN-False Negative.2.4.9.2. Precision.The present of predicted positive that is in fact positive.It also called as Positive Predicted Value (PPV).Precision¼
TPTPþFD ð3Þ2.4.9.3. Recall.The proportion of positive results out of the number ofsamples which were in fact positive. It is recognized as Sensitivity.
Fig. 11.Sample of saissetia oleae disease.
Table 2Related works carried out of olive disease classi ﬁcation.Paper Validation accuracyAugmentation Nb. of classes Transfer learningArchitecture Dataset Country source of imagesSinan Uguz, 2020 95% Yes (2 + 1 healthy) Yes VGG16 and VGG19 architectures 3400 olive leaves images TurkeySinan Uguz, 2020 96% Yes (1 + 1 healthy) No SSD architecture 1460 olive leaves images TurkeyMario Milicevic, 2020 97.20% ± 0.57% Yes (1 + 1 healthy) No VGG-inspired network 1000 images CroatiaMadallah Alruwaili et al, 2019 99.11% ± 0.75% Yes (6 + 1 healthy) No Alexnet architecture 2287 olive leaves images -E.M. Raouhi, M. Lachgar, H. Hrimech et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 77 –89
84Recall¼TpTPþFN ð4Þ2.4.9.4. F1 score.F1 Score is designed as the geometric mean of Precisionor PPV and Recall or True Positive Rate (TPR).F1Score¼2/C3
PPV:TPRPPVþTPR ð5Þ2.4.9.5. Loss.The paired cross entropy misfortune work ascertains the d\scale90%eﬁciency of a model byﬁguring the accompanying normal:Loss¼/C0
1output∑outpeti¼1yi/C1log^yi
þ1/C0yi ðÞ /C1log 1/C0^yi ðÞ ð6Þwhere^y
iis the i-th scalar worth in the model yield, y iis the relating objective value, and yield size is the quantity of scalar qualities in themodel output/result.3. ResultsModels are implemented, using the appropriate optimizer, to ﬁnd accurate olive characteristics for predicting speci ﬁc diseases. Classiﬁca- tion methods are optimized with augmentation techniques to ﬁnd the most suitable model for a particular disease. The techniques areevaluated thereafter, using metrics such as Accuracy, Loss and Areaunder the ROC Curve (AUC).Fig. 15displays a chart analyzing the results of models using thealgorithm of optimisation.Looking atFig. 15, the CNN MobileNet model offers superior re-sults. The optimal number of epochs using Early Stopping call backfunction whereﬁxed to 100 iterations. So the augmentation of thetotal of iterations will further minimize the loss graph oscillations.Also, the augmentation would extend the duration of the experimentssigniﬁcantly. The model should be trained for an optimal number ofepochs to reduce overﬁtting and increase the neural network's gener-alization capacity. Training dataset part is set aside for model valida-tion, which involves evaluating the model's performance after eachepoch of training. Loss and accuracy on both the training and valida-tion sets are monitored to determine the epoch number at whichthe model begins over-ﬁtting. The best performances in terms of pre-cision values were obtained on validation dataset by the MobileNetmodel at 0.98 for the six disease classes using the Rmsprop optimiza-tion algorithm,Fig. 15show precision and loss value graphs relatingonly to models developed with the Adam, Adagrad, Rmsprop andSGD algorithms. The precision and loss value results of the trainingand validation datasets with the application of data augmentationtechniques can be seen onTable 3.Fig. 16show the ROC curve of the best models using Rmsprop algorithm, that is plotted with TPR(true positive rate) against FPR (the false positive rate) of each theseven olive plant category including health class.The results mentioned in the classiﬁcation report mention that the classes 2 and 4 outperforms the other classes in terms of precision.
Fig. 12.General schema for the experimental study.
Fig. 13.Unbalanced distribution of olive disease dataset.
 Fig. 14.Balanced distribution of olive disease dataset.E.M. Raouhi, M. Lachgar, H. Hrimech et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 77 –89
85classiﬁcation of olive diseases. So this leads us to deduce that exceptfrom the quality and the quantity of image also serves to amelioratethe performance as well as the types of classes used. Also the ROC curvesclearly show that the MobileNet model associated with the Rmspropoptimization algorithm offered the best results. In addition, the AUC ob-tained conﬁrm the performance of this combination and more detailswill be provided in the following discussion.4. DiscussionsFirslty, the results obtained detailed in the Table 4show that the Adam and Adagrad algorithms, present the weakest performanceswith the largest average absolute errors, respectively 0.3346 and0.2682, as well as the greatest number of iterations 190 for the Rmspropalgorithm (the number of iterations isﬁxed at 75 for the stochastic gra- dient). The CNN MobileNet model represents superior performance formean absolute error as well as for accuracy. Also the results indicated asigniﬁcant difference between the solvers, for example Adam's algo-rithm converged in only 70 iterations, however Adagrad's andRmsprop's algorithms converged in 143, 190 iterations respectively.Furthermore, the RMSProp and Adagrad algorithms represents thebest MAEs which are of the order of 0.2071 and 0.2682 respectively,with an increase in the number of iterations, 190 and 143 iterationsfor RMSProp and Adagrad respectively. Among the algorithms studied,the Stochastic algorithm is of great interest for use on a mobile phonegiven its good performance in terms of convergence speed and MAE.Secondly, to the best of our knowledge this research paper hasunprecedently addressed the problem of the choice of optimizationtechniques at the level of convolutional neural networks and its impacton the performance of the latter. Thud, CNN models used on simulationhad the lowest performance compared to the MobileNet model using
Fig. 15.Comparison of models performances: Rmsprop.
Table 3Performance evaluation results of CNN models based on the applied optimization algo-rithms (10 epochs).Optimization CNN model Training lossTrainingaccuracyValidationlossValidationaccuracyAdamConvNet0,5394 0,9479 0,5399 0,8958EfﬁcientNetB70,8908 0,6838 0,1418 0,8531InceptionV30.1991 0,9051 0,3465 0,9187MobileNet0.0327 1.000 0,1385 0,9792DenseNet0.2038 0,957 0,2404 0,9187VGG190.2048 0,8695 0,3391 0,9187ResNet500.4667 0,834 0,3907 0,8969VGG160.2796 0,8941 0,4325 0,8531 AdagradConvNet0.1809 0,9242 0,305 0,8749EfﬁcientNetB70.9578 1.000 0,1899 0,1968InceptionV30.4050 1.000 0,1885 0,9625MobileNet0.0664 1.000 0,0159 0,9792DenseNet0.2370 0,9843 0,0946 0,9583VGG190.4084 0,9686 0124 0,8333ResNet500.5161 0,8340 0,5074 0,7875VGG160.4037 1.000 0,1483 0875 RmspropConvNet0.2928 0,9598 0,2799 0,8969EfﬁcientNetB70,5352 0,8872 0,5948 0,8749InceptionV30.2192 0,9652 0,1963 0,9375MobileNet0.0257 1.000 0,0160 0,9843DenseNet0.2267 1.000 0,1621 0,9792VGG190.0269 1.000 0,1370 0,9583ResNet500.4752 0,8494 0,3795 0,8749VGG160.1908 0,9543 0,2718 0,8969 SGDConvNet0.1479 0,9982 0,2661 0,8969EfﬁcientNetB70,1601 0,9351 0,2714 0,8749InceptionV30.1534 0,9952 0,1244 0,9792MobileNet0.0241 1.000 0,0435 0,9801DenseNet0.1228 1.000 0,1937 0,9625VGG190.3500 0,8831 0,2936 0,8969ResNet500,1855 0,9707 0,2777 0,8312VGG160.2581 0,9460 0,2488 0,9405E.M. Raouhi, M. Lachgar, H. Hrimech et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 77 –89
86Fig. 16.ROC curve by class using Rmsprop.E.M. Raouhi, M. Lachgar, H. Hrimech et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 77 –89
87the most optimal optimization algorithm namely Rmsprop. The batchnorm and ReLU are the primary features that characterize MobileNet ar-chitecture from another CNN. The MobileNet was built to support clas-siﬁcation, identiﬁcation, and segmentation. Due to the number ofparameters and layers, the capability to run deep networks on terminalmobile devices promotes user experience, providing the advantagesand characteristics in terms of security and energy consumption of mo-bile applications. Thirdly, the enhancement of a model that performsbetter than the pre-trained model deﬁnitely depends on more simula- tions with parameter values. Again, if augmenting the number of simu-lations and periods has a positive impact on performance, it willalso take more time in terms of model compilation. Furthermore,The performance of the same solver will change if a different set ofhyperparameters and starting conditions are applied. So Larger learningrate values tend to exceed the gradient value, making it dif ﬁcult for the weights to converge to the global minimum. Also, small values of thelearning rate make the progress of the global minimum very slow,which can be seen in the validation and training losses. But the optimalvalue of the learning rate leads to a global minimum, which can be visu-alized by a steady reduction in the loss. So if it is to develop real time dis-ease identiﬁcation research via a mobile application, it would be moreappropriate to converge quickly, since different objects will bringabout some effects in the background of the objects and make the learn-ing phase slower. Then, the exploration related to olive trees bandied inthis exploration is truly limited. So the present work differs from re-searches (Foysal et al., 2019) at many levels. Some of the differencesare the types of diseases identiﬁed, the CNN architecture used, and theincrease in data. One of the infections that the authors of Altarawneh (2015)is trying to identify is olive peacock spot, which was also studied.Using the CNN model proposed in this research, the disease accuracy is95%. The author's work obtained an accuracy of 90.2%. The comparisonof the loss functions employed in this study, in addition to compilationtime, were not addressed not only in these investigations, but also onother plant species studies. Various diseases found on fruits, leaves,and branches can also be investigated in this subject. The challenge isto be able to collect data of these plant diseases over different regionsand particularly when they occur. For the reason that some infectionsare only seen in particular areas, then obtaining these photos may bedifﬁcult. As a result, each study on plant disease detection and particu-larly in this original dataset is regarded as a valuable case of the linkedresearch provided (Kurmi et al., 2020). After, the classiﬁcation of differ- ent diseases classes was conducted in this study. The challenge to in-crease the number of class diseases without impacting the successrate. Because diseases of the same type of plant can have similar symp-toms. The optimization performed in thisﬁeld are considered promising because of the difﬁculty of the success rate. When the ROC curve pre-sented by olive tree disease class provides more relevant informationon the quality of learning than the simple error rate. This is concretelypresent in this case because the classes are very unbalanced in termsof the number and quality of the images appearing at the level of eachclass, in addition to the moment that the cost of bad prediction or as-signment is likely to change. Finally, some researchers around theworld are carrying out studies using deep learning techniques for iden-tifying plant diseases. One of the biggest challenges is collecting enoughdata. For this reason, sharing datasets in papers has become quite im-portant. As a consequence the development and public availability ofdatasets related to plant diseases is very important to advance detectionsystems based on artiﬁcial intelligence, in particular Machine Learning,the enrichment of existing datasets goes without saying. to improveand optimize applications intended for the farmer with the objectiveof increasing agricultural productivity as well as the social developmentof farmers whose crops are low yielding but also for adaptation to futurechanges that may impact agricultural crops with a view to parasitic di-versity and direct or indirect environmental factors.5. ConclusionsIt is crucial to diagnose diseases of growing agricultural products atan early stage, consequently, it helps farmers take the required preven-tive measures, thereby reducing costs. In addition, the extracted oil'squality and quantity depend both on the fruits ’health process. There- fore, disease detection at different growth stages would play a consider-able role in the olive food industry. The current article aims to an Olivedisease dataset (ODD) collected from different regions of Morocco at
different growth stages based on seven classes, six of them being illand the seventh healthy. The novelty in the classi ﬁcation approach here lies in theﬁne-tuning based on the MobileNet model architecturewhich outperformed eight other contenders among standard CNNs, be-sides being tested with four optimizers, where Rmsprop turned out tobe most performant. Admittedly, the suggested model signi ﬁcantly dis- tinguished all the seven olive diseases classes with a high precision, tak-ing into account the fruit texture characteristics and the factors thatimpact its effectiveness and its efﬁciency, with consideration of the chal-lenge of classifying the disease spreading in foliage, fruit and branches.Although the proposed method for automatic identi ﬁcation of olive dis- eases has obtained satisfactory results, further work is needed in the fu-ture to improve its accuracy and reliability. Therefore, future work willfocus on:•Further develop the olive tree disease dataset and set up an intelligentolive tree disease diagnosis system based on the use of drones.•Integrate a layer for image segmentation to increase system accuracy.•Investigate other architectures of deep neural networks, in order toimprove the classiﬁcation accuracy, reliability and robustness ofdiagnostic systems for olive diseases.Credit authorship contribution statementEl Mehdi Raouhi:Conceptualization, Formal analysis, Software,Data curation, Implementation, Investigation, Writing –original draft, Writing–review & editing, Visualization.Mohamed Lachgar:Concep- tualization, Methodology, Study design, Formal analysis, Software, Im-plementation, Investigation, Validation, Writing –original draft, Writing–review & editing, Visualization.Hamid Hrimech:Methodol- ogy, Study design, Supervision, Formal analysis, Software, Resources,Implementation, Validation, Investigation. Ali KartitSupervision, Pro- ject administration, Funding acquisitionDeclaration of Competing InterestThe authors have no conﬂicts of interest to declare that are relevantto the content of this article.References
Abade, A., Ferreira, P.A., Vidal, F.B., 2021. Plant diseases recognition on images usingconvolutional neural networks: A systematic review. Computers and Electronics inAgriculture. Elsevier,https://doi.org/10.1016/j.compag.2021.106125 . Alruwaili, M., Alanazi, S., El-Ghany, S.A., Shehab, A., 2019. An ef ﬁcient deep learning model for olive diseases detection. Int. J. Adv. Comput. Sci. Appl. 10, 486 –492. https://doi.org/10.14569/ijacsa.2019.0100863 . Altarawneh, M., 2015. An empirical investigation of olive leave spot disease using auto-cropping segmentation and fuzzy c-means classi ﬁcation. World Appl. Sci. Emp. In- vest. Olive Leav. Spot Diseas.https://doi.org/10.5829/idosi.wasj.2013.23.09.1000 .Table 4Comparison of the performances of studied algorithms.Algorithm Number of iterations MAE Tensor ﬂowAdam 70 0,3346 AdamOptimizerAdagrad 143 0,2682 AdagradOptimizerRmsprop 190 0,2071 RMSPropOptimizerStochastic 75 (ﬁxed) 0,2263 SGDRegressorE.M. Raouhi, M. Lachgar, H. Hrimech et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 77 –89
88Alves, L., Silva, R.R., Bernardino, J., 2019. System to predict diseases in vineyards and olivegroves using data mining and geolocation ICSOFT 2018. Proceedings of the 13thInternational Conference on Software Technologies, pp. 679 –687https://doi.org/10. 5220/0006914306790687. Cap, Q.H., Uga, H., Kagiwada, S., Iyatomi, H., 2020. LeafGAN: an effective data augmenta-tion method for practical plant disease diagnosis. IEEE Trans. Autom. Sci. Eng.https://doi.org/10.1109/TASE. 2020.3041499 . Chandra, M., Matthias, M., 2017. SC-Adagrad and SC-RMSProp. arXiv:1706.05507v2. Chliyeh, M., Selmaoui, K., Touhami, A.O., Abdelkarim, F., 2014. Survey of the fungal species associated to olive-tree (Olea europaea L.). IJRB Survey of the Fungal Species Associ-ated to Olive-tree (Olea europaea L.) in Morocco.Dhingra, G., Kumar, V., Joshi, H.D., 2018. Study of digital image processing techniques forleaf disease detection and classi ﬁcation. Multimed. Tools Appl. 77, 19951 –20000. https://doi.org/10.1007/s11042-017-5445-8 . Esgario, J.G., Krohling, R.A., Ventura, J.A., 2019. Deep Learning for Classi ﬁcation and Sever- ity Estimation of Coffee Leaf Biotic Stress. http://arxiv.org/abs/1907.11561 . Foysal, F.A., Islam, M.S., Abujar, S., 2019. A Novel Approach for Tomato Diseases Classi ﬁca- tion Based on Deep Convolutional Neural Networks A Novel Approach for TomatoDiseases Classiﬁcation Based on Deep Convolutional Neural Networks. July. Springer,Singaporehttps://doi.org/10.1007/978-981-13-7564-4 . Garcia, J., Barbedo, A., 2018. Impact of dataset size and variety on the e ff ectiveness ofdeep learning and transfer learning for plant disease classi ﬁcation. Comput. Electron. Agricult. 153, 46–53.https://doi.org/10.1016/j.compag.2018.08.013 . Gavhale, M.K.R., Gawande, P.U., 2019. An Overview of the research on plant leaves diseasedetection using image an overview of the research on plant leaves. Diseas. Detect.Image Proess. Techn.https://doi.org/10.9790/0661-16151016 . Hussain, S.A., Hasan, R., Hussain, S.J., 2018. Classiﬁcation and Detection of Plant Disease using Feature Extraction Methods13 pp. 4219 –4226. Kurmi, Y., Gangwar, S., Agrawal, D., Kumar, S., Srivastava, H.S., 2020. Leaf Image Analysis-Based Crop Diseases Classiﬁcation Orre Cted Unc Pro Of. Signal, Image and VideoProcessing. Springer-Verlag London Ltd., part of Springer Nature 2020 https://doi. org/10.1007/s11760-020-01780-7 . Liu, J., Wang, X., 2021. Plant diseases and pests detection based on deep learning: a re-view. Plant Meth., 1–18https://doi.org/10.1186/s13007-021-00722-9 .Moorthy, S.G., Meenakshi, K., Nithya, M., 2020. Plant leaf disease classi ﬁcation and detec- tion system using machine learning plant leaf. Diseas. Classi ﬁc. Detect. Sys. Mach. Learn.https://doi.org/10.1088/1742-6596/1712/1/012012 . Pantazi, X.E., Moshou, D., Bochtis, D., 2020. Arti ﬁcial Intelligence in Agriculture. Intelligent Data Mining and Fusion Systems in Agriculture. Springer, pp. 17 –101https://doi.org/ 10.1016/b978-0-12-814391-9.00002-9 . Pedrycz, W., Chen, S.m., 2020. Deep Learning: Algorithms and Applications. Studies inComputational Intelligence865. Springer. https://doi.org/10.1007/978-3-030-31760-7 . Saleem, M.H., Potgieter, J., Arif, K.M., 2019. Plant disease detection and classi
ﬁcation by deep learning. Plants 8, 32 –34.https://doi.org/10.3390/plants8110468 . Sharma, P., Berwal, Y.P.S., Ghai, W., 2020. Performance analysis of deep learning CNNmodels for disease detection in plants using image segmentation. Inf. Process.Agricult. 7, 566–574.https://doi.org/10.1016/j.inpa.2019.11.001 . Singh, D., Jain, N., Jain, P., Kayal, P., Kumawat, S., Batra, N., 2020. PlantDoc: a dataset forvisual plant disease detection. ACM Int. Conf. Proceed. Ser., 249 –253https://doi.org/ 10.1145/3371158.3371196. Sinha, A., Shekhawat, R.S., 2020. Olive spot disease detection and classi ﬁcation using anal- ysis of leaf image textures. Proc. Comput. Sci. 167, 2328 –2336.https://doi.org/10. 1016/j.procs.2020.03.285.Tassis, L.M., Tozzi de Souza, J.E., Krohling, R.A., 2021. A deep learning approach combininginstance and semantic segmentation to identify diseases and pests of coffee leavesfrom in-ﬁeld images. Comput. Electron. Agricult. 186. https://doi.org/10.1016/j. compag.2021.106191.Uguz, S., Uysal, N., 2020. Classiﬁcation of olive leaf diseases using deep convolutional neu-ral networks. Neur. Comput. Appl. 5. https://doi.org/10.1007/s00521-020-05235-5 . Vega-Márquez, B., Nepomuceno-Chamorro, I., Jurado-Campos, N., Rubio-Escudero, C.,2020. Deep learning techniques to improve the performance of olive oil classi ﬁcation. Front. Chem. 7, 1–10.https://doi.org/10.3389/fchem.2019.00929 . Waleed, M., Um, T.W., Khan, A., Khan, U., 2020. Automatic detection system of olive treesusing improved K-means algorithm. Rem. Sens. 12, 1 –16.https://doi.org/10.3390/ rs12050760.Yousuf, A., Khan, U., 2021. Ensemble Classi ﬁer for Plant Disease Detection. 1st. 10. IJCSMC, pp. 14–22.https://doi.org/10.47760/ijcsmc.2021.v10i01.003 .E.M. Raouhi, M. Lachgar, H. Hrimech et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 77 –89
89