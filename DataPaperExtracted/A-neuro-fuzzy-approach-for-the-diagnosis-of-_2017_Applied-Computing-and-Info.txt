ORIGINAL ARTICLE
A neuro-fuzzy approach for the diagnosis ofdepression
Subhagata Chattopadhyay*
Department of Computer Science and Engineering, National Institute of Science and Technology, Berhampur 761008, Odisha, IndiaReceived 22 May 2012; accepted 3 January 2014Available online 4 February 2014
KEYWORDSDepression;Diagnosis;Neuro-fuzzy controller;Hybrid toolAbstractDepression is considered to be a chronic mood disorder. This paper attempts to mathe-matically model how psychiatrists clinically perceive the symptoms and then diagnose depressionstates. According to Diagnostic and Statistical Manual (DSM)-IV-TR, fourteen symptoms of adultdepression have been considered. The load of each symptom and the corresponding severity ofdepression are measured by the psychiatrists (i.e. the domain experts). Using the Principal Compo-nent Analysis (PCA) out of fourteen symptoms (as features) seven has been extracted as latent fac-tors. Using these features as inputs, a hybrid system consisting of Mamdani’s Fuzzy logic controller(FLC) on a Feed Forward Multilayer Neural Net (FFMNN) has been developed. The output of thehybrid system was tuned by a back propagation (BPNN) algorithm. Finally, the model is validatedusing 302 real-world adult depression cases and 50 controls (i.e. normal population). The study con-cludes that the hybrid controller can diagnose and grade depression with an average accuracy of95.50%. Finally, it is compared with the accuracies obtained by other techniques.
/C2112016 Production and hosting by Elsevier B.V. on behalf of King Saud University. This is an open accessarticle under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/3.0/ ).
1. IntroductionMedical decision making as a whole is a complex process dueto handling of higher dimensional, raw, and subjective clinicaldata. Correct decision requires an orchestration of clinician’shigh level perceptions and intuitions toward understanding adisease process. Correctness of the diagnosis depends on thenumber of times symptoms are matched with the representa-tives of the reference diseases (which are called as ‘classical’cases). Manual diagnosis is often individualized and so asthe presentation of an illness. Therefore, the appropriatenessof the term classical becomes relative in clinical medicine.Applications of higher data mining technique(s) and conceptsof computational intelligence have tremendous research scopesin modeling the process of clinical diagnosis due to its opera-tional resemblance. It also invites an opportunity for thecross-disciplinary research.1.1. The manual process of medical decision making [1]In medical decision making there are basically two majorphases. The ﬁrst phase is known as thedifferential diagnosis(DD) and the second phase is termed asprovisionalorﬁnal diagnosis(PD). DuringDD, patients’ history and sign-
*Tel.: +91 680 24924321.E-mail address:subhagatachatterjee@yahoo.com. Peer review under responsibility of King Saud University.
Production and hosting by ElsevierApplied Computing and Informatics (2017) 13,1 0–18
Saudi Computer Society, King Saud University
Applied Computing and Informatics
(http://computer.org.sa)www.ksu.edu.sawww.sciencedirect.com
http://dx.doi.org/10.1016/j.aci.2014.01.0012210-8327/C2112016 Production and hosting by Elsevier B.V. on behalf of King Saud University.This is an open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/3.0/ ).symptoms are perceived by the clinicians as the inputs. Thisinformation, in turn, is processed or analyzed according totheir medical knowledge-base and experience to arrive into adiagnosis of overlapping look-alike diseases. According tothe perception, medical doctors possibly assign some arbitraryweights to symptoms to deﬁne its level of representation on theoverall disease load. Through multiple clinical assessments(i.e., iterations in computer science term), such weights arerepeatedly evaluated and if required, updated. In clinical med-icine there might be chances where different diseases presentwith similar patterns and vice versa. Hence, based on theinputs, doctors try to match the symptom patterns with classi-cal case of each of the possible diseases (obtained during DD) by measuring the similarity. Based on the degree of similarity,they then rank the possible diseases and management strategiesproposed aiming at the top most ranked disease. Results of theinvestigations and the preliminary treatment are closelymatched with all plausible diseases (obtained during DD) and ﬁnally best matched disease is diagnosed. This process isreferred to asPD. However, in reality, the process is not sotrivial and straight forward. There are several iterations,needed to arrive fromDDtoPD.Fig. 1shows the schematicrepresentation of clinical diagnosis process.1.2. Complexities in depression diagnosisPsychiatry is the most complex domain in Medical sciences.Psychiatric diseases are not directly measurable due to vaguesymptomatic presentations. Results of investigations and treat-ment are manually correlated with the course of morbidity andsuch correlations could lead to biased decision-making.The onset of depression is often unrecognizable. It mayoriginate from several non-psychiatric illnesses, for e.g., can-cers[2]or chronic joint pains[3]and so forth. It is oftennoticed that different diseases present with similar types ofsymptoms and vice versa. Also behind a set of symptoms thereis a possibility of multiple diseases evident in case of depressionwith mania[4]. Therefore, the process of depression screening(DD) to its formal diagnosis (PD) is quite lengthy and muchcomplex in clinical psychiatry. Moreover, manual diagnosismight be error-prone, slow, and highly dependent on the indi-vidual skill sets.Given these issues, theobjectiveof this paper is to mathe-matically model the clinical decision making process in psychi-atry using Soft computing and not to develop a full-ﬂedgedexpert tool. It is exclusively an application-based research inmental health and cross-disciplinary in nature. Unfortunately,the number of such cross-disciplinary research is small andhence, this is an attempt to add to the existing literature of‘mental health-informatics’ research. The way existing methodsare realized and implemented in a model is from the scratchand hence proposed to be new in the clinical study of depres-sion. However, this is a future scope and may be considered asthe next step toward automating the depression diagnosis.Thecontributionof this paper lies on the mathematicalmodeling of the manual depression diagnosis process. Further-more, within the model, research challenges are:(i) Mathematically managing the overlapping grades(expressed in qualitative terms, e.g., ‘mild’, ‘moderate’, ‘severe’ etc.) with the concept of fuzzy sets.(ii) Technically handling large rule base in Mamdani’s fuzzylogic controller, and(iii) Making a crisp ﬁnal decision with the feed-forwardbackpropagation part of the model.Rest of the paper is organized as follows. Section 2dis- cusses various applications of fuzzy set, fuzzy logic and neuralnetwork approaches in mental health research. Section 3 details the methodology of the study. Experimental resultsare shown and discussed in Section4. Finally, Section5dis- cusses the key outcomes and concludes the paper.2. Current literatureSoft computing techniques, such as Fuzzy sets and Fuzzylogic, Artiﬁcial Neural Networks (ANN), and Genetic Algo-rithms (GA) are useful in handling the uncertainty and vague-
Fig. 1The process of clinical diagnosis[1].A neuro-fuzzy approach for the diagnosis of depression 11ness associated with the real-world data. To complement eachother’s merits, hybrid techniques are now being popularly usedin several domains of health sciences.In psychiatry, applications of soft computing techniquesare more suitable as it can handle the issues, such as non-linearity, multidimensionality, and vagueness, compared tohard computing, such as probabilistic approaches. However,due to the lack of availability of the combined domain exper-tise (e.g., expertise in both psychiatry and computer science)the number of research attempts is less. Computer scientistsﬁnd difﬁculties in understanding and modeling the disease pro-cesses, its representations, and evaluation. On the other hand,psychiatrists ﬁnd it difﬁcult to realize the merits of algorithms,its coding and necessary implementations. Despite such hin-drances, however, attempts have been made by the researcherssince decades in screening and diagnosing psychiatric diseasesusing soft computing techniques. Some recent studies havebeen described in the following section.2.1. Applications of fuzzy sets and fuzzy logicResearchers attempted to use hard computing techniques, suchas heuristic and probabilistic algorithms in diagnosing psychi-atric diseases[5,6]. But, they found that such algorithms aretoo rigid to actually evaluate the morbidity. On the otherhand, the merit of fuzzy set and fuzzy logic lies on its capabilityto handle non-discrete qualitative inputs and analyze likehuman beings. Thus, these methods have been tried to screenand predict real-world adult psychiatric cases [7–11]. In these studies the authors at ﬁrst statistically modeled seven psychoticdiseases using the Brief psychiatric rating scale version-F2(BPRS-F2) and Plackett–Burman design (PBD) of experi-ments. Then using multiple regressions, the authors identiﬁedsigniﬁcant predictors behind each of these illnesses. Fromregression equations, more experimental data had been gener-ated. These were, in turn, clustered using Fuzzy C means(FCM) and Entropy-based fuzzy clustering (EFC) techniques(with its three possible extensions). Centroid properties ofthe clusters were then used for developing the correspondingFLCs (Takagi–Sugeno’s type). Outputs of those FLCs werethen optimized by a binary coded Genetic algorithm (GA).It was evident that FCM-based FLC predicted psychoses withmore accuracy compared to EFC and its extensions.In another study[12]a hierarchical decision-tree-basedfuzzy model was proposed to screen and grade ﬁfty cases ofpremenstrual syndrome (PMS), which falls under the cross-domain of gynecology and psychiatry. The authors used ﬁringstrength (FS) of fuzzy rules to evaluate the respective PMSgrades. Rules with higher FS had been considered signiﬁcantand had been used in designing the diagnostic rule base ofPMS. The study concludes that appropriate rule base couldbe constructed to diagnose complex cross-domain diseases,which often lack standardized diagnostic rule sets.Fuzzy set theory was applied in the classiﬁcation of depres-sion[13]. The authors adopted Beck Depression Inventory(BDI)-II to capture a group of young depressives. On this data,the authors attempted FCM and probabilistic based classiﬁca-tions (Wald’s and K-means) to classify the severity of depres-sion. After comparison, the study observed that FCM was thebest technique. The authors concluded that FCM more accu-rately realized the data structure than Wald’s and K-meansmodels.2.2. Applications of neural network and fuzzy-neural hybridsANN had been used to examine the correlation of recurrentsuicide attempts and the overall self-harm history of Taiwanesesoldiers[14]. They identiﬁed totally ten factors which mighthave inﬂuence on suicidal risks. Network training with thesefactors was conducted using the Radial basis function(RBF). The trained model showed about 82% sensitivity and86% speciﬁcity.The strength of RBF and a back propagation (BPNN)algorithm had been used to develop a decision support system(DSS) in assisting rural doctors to diagnose psychiatric ill-nesses[15,16]. The heart of the said system is the applicationof BPNN as the feature extraction algorithm. The authors con-cluded that the proposed DSS was able to diagnose psychiatricproblems with 98.75% accuracy.In a recent study, a group of researchers used a BPNN inclassifying a set of real-world adult depression cases basedon its severity/grade[17,18]. In order to do so, the authors atﬁrst collected ﬁfteen symptoms of depression under four majorconstructs, such as ‘motivational’, ‘emotional’, ‘cognitive’, and‘vegetative and physical’. Information about symptoms wasthen captured by a questionnaire. Answer to each questionwas then quantiﬁed and the corresponding grade was assignedas ‘mild’–‘moderate’–‘severe’ under a three-point scale. Theinformation was then fed to the network for training (incre-mental mode). Finally the study concluded that by the BPNNapproach the network was able to classify depression caseswith 89% average accuracy.Performance of a neuro-fuzzy model in predicting weightchanges in chronic schizophrenic patients exposed to atypicalor typical antipsychotics for more than a couple of years hadbeen examined[19]. The authors used FuzzyTECH 5.54 soft-ware package to generate the rule base. The model was ableto predict 93% of weight changes.To differentiate between epileptic and non-epileptic eventsvarious fuzzy arithmetic operations have been investigated[20]. A total of 244 patients were studied using the NEF-CLASS (NEuro Fuzzy CLASSiﬁcation) architecture with theArtiﬁcial Neural Network and Back propagation algorithm(ANNB). Finally they were able to detect the differences witha sensitivity of 85% sensitivity, while 95.65% was achieved byANNB.3. MethodologyThe paper aims to study a fuzzy-neural hybrid model to diag-nose the severity of real-world depression cases. It focuses onthe overlapping areas of diagnosis, i.e., the DDand attempts to make more discrete diagnosis, i.e., the PD
. The steps of the study are as follows,1. Depression data collection from hospitals and itsprocessing.2. PCA[21]has been chosen to extract the signiﬁcant features(i.e. symptoms) by reducing the number of symptoms (i.e.the data dimension). This step mimics the way medical doc-12 S. Chattopadhyaytors diagnose a disease (in this case it is depression) byextracting signiﬁcant features of the illness among manysuch.3. Creating input vector matrix with signiﬁcant symptoms.4. Fuzzy-neural hybrid model development using Mamdani’sfuzzy logic controller[22]mapped onto a FFMNN[23], and it’s tuning with a BPNN algorithm[24]. It may be noted that while training and testing the controller, thesample is divided randomly into two parts – 214 (i.e.approximately 70% of the sample) for training and remain-ing 88 (i.e., approximately 30%) for testing the hybridmodel using a 10-fold cross validation[25]. Sugeno’s con-troller has not been chosen because of difﬁculty involvedin mapping of the output polynomial function with the clin-ical decision making.5. Testing the performances of the proposed system on a set ofreal-world depression cases.3.1. Data collection and normalizationScores of fourteen symptoms of depression (see Table 1) have been considered in this study according to the DSM-IV-TRguidelines[26]. These symptoms denote independent factors.Corresponding grades of depression denote the dependent fac-tor. A group of specialist doctors (mean experience of10.4 years) consisted of ﬁve senior psychiatrists assign weights[0,1] of each of these factors/symptoms and the grades (mild,moderate, and severe) of depression. The weighted symptomsare nothing but the reﬂection of the load of the disease. Such‘symptom-grade’ relations have been established on the basisof the clinical experience and knowledge base of thepsychiatrists.Data of total 302 adult ‘psychotic depression’ cases havebeen collected from two hospital sources in India over the per-iod of eight months. The grades of these cases are known. Forfurther validation of the model, a control group (no depres-sion) has been considered. Appropriate ethical measures havebeen taken for preserving data privacies, i.e., the informationof subjects, doctors, and hospitals. Atypical symptoms,patients aged below 19 years and above 50 years have beenexcluded from the study to avoid accidental inclusion of child-hood depression, childhood schizophrenia and the early symp-toms of dementia (which occurs at the older age).The information of each case is now presented as a N
i*Mj
matrix (‘i’ varies from 1 to 302 and ‘j’ varies from 1 to 14),which is fed to the controller as the input. Among 302 totaldepression cases, 214 cases (i.e., 70%) are used for trainingthe proposed hybrid system and the remaining 30% are keptfor testing its performance. It is important to note that a 10-fold cross validation has been performed to partition trainingand test data.As data are raw and secondary in nature (constructed by agroup of medical doctors), it has been preprocessed by check-ing for noise, such as data redundancy, missing values etc.Finally data have been normalized [0,1] column-wise usingthe max–min normalization technique. Then, data reliabilityhas been measured by computing Cronbach’s alpha ( a)o n the whole dataset using 95% conﬁdence interval [27]. 3.2. PCAPCA is one useful statistical technique used to extract the hid-den features from multidimensional data. Also it reduces thedimension by pruning unwanted attributes. The objectivebehind such dimensionality reduction of the input space is tomake it lossless by preserving the original information as muchas possible. Another useful merit of PCA is that, it is indepen-dent of target data and therefore learns without supervision.The steps of the PCA method are Data collection; Subtractionofmeanof each dimension to produce a dataset having nullmean; Calculation of covariance matrix; Calculation of eigen- vectorsandeigenvaluesof the covariance matrix; Choosingcomponents and forming a feature vector; and ﬁnally Derivingnew dataset. It is important to mention that eigenvectors aresorted in descending order with the highest eigenvalueis the principal component (PC) of the dataset. These sorted valuesrefer to the signiﬁcant components and renders ﬂexibility sothat the components with lowereigenvaluescould be omitted to reduce the data dimension than that of the original dataset.A new feature vector is then nothing but the matrix of the PCsthat one ﬁnds signiﬁcant. The ﬁnal data are composed by ﬁrsttransposing the vector and then multiplying it on the left overmean-adjusted dataset, also transposed. PCA has been per-formed using MINITAB-14. In this study, symptoms witheigenvalues greater than 1 are found signiﬁcant based on thecross validation. It is worth noting that ahas been measuredonce again after the PCA to check the reliability of the datawith principal components as the signiﬁcant symptoms.3.3. The neuro-fuzzy modelThe study proposes and develops a fuzzy-neural hybridapproach in diagnosing the severity of depression. In doingso, Mamdani’s fuzzy logic controller (FLC) has been pro-posed. Asymmetric triangular membership function distribu-tions (TMFD) are considered for mapping inputs and theoutput, i.e., the symptoms and the grade of depression, respec-tively. Inputs and the output are arbitrarily assigned classlabels – ‘mild(‘m’)’, ‘moderate(‘M’)’,and‘severe(‘s’)’ with some numeric range. Its working steps are then mapped ontoa FFMNN (seeFig. 2), where theﬁrstlayer is the ‘input’ (I)layer;secondlayer represents hidden layer-1 (HL-1), which is
Table 1Depression Symptoms (Dsm-Iv) And The Corre-sponding Abbreviations.
Symptoms Abbreviations1 Feeling sad S2 Loss of pleasure P3 Weight loss W14 Insomnia I15 Hypersomnia H6 Loss of appetite A7 Psychomotor agitation P18 Psychomotor retardation P29 Loss of energy E10 Feeling of worthlessness W211 Lack of thinking T12 Indecisiveness I213 Recurrent thought of death D14 Impaired social/occupational functioning SOA neuro-fuzzy approach for the diagnosis of depression 13meant for the ‘fuzziﬁcation’ tasks i.e., calculation of member-ship (l) values using TMFD (see Eq.(1)); in thethirdlayer (i.e., HL-2) ‘AND operations’ are performed; respective ‘ﬁringstrength (FS)’ (refer to Eq.(2)) has been computed in thefourthlayer (i.e., HL-3) according to the ﬁred or activatedfuzzy prules (i.e., production rules), which are obtained fromthe domain experts; in theﬁfthlayer, Output (O) is calculatedafter the ‘OR operation’ (see Eq.(3)) using the sum of the cen-ter of the ﬁring areas (expressed with Eq.(4)). The predicted output is then compared with the target output for each caseand Mean Squared Error (MSE) is then computed. Finally,weights are updated during backpropagating with the errorand the training is said to be completed when the minimumMSE value is obtained. The equations are explained as followsto understand the working principle of the controller.l
xðAÞ¼Dðx;a;b;cÞð1Þ In this equation, ‘l
x’ is the membership of the crisp input ‘x’t o the triangular fuzzy set ‘A’, ‘ac’ is the base of the triangle, and‘b’ is its midpoint.FS¼minðl
x1ðA1Þ;lx2ðA2Þ; :::lxnðAnÞð2Þ Eq.(2)expresses the method, by which ﬁring strengths (FS) ofa particular rule has been computed. In this equation, ‘ l
x1,lx2, ...,l
xn’ are the membership values of the crisp inputs to the tri-angular fuzzy sets ‘A1,A2,...,An’.l
CðfÞ¼maxðlC1ðfÞ;lC2ðfÞ; :::lCnðfÞÞ ð3Þ An example of the combined control action ‘ C’ of the fuzzy controller (f) i.e.l
C(f) is given by Eq.(3). Here,ORoperation is performed.O
f¼Ppi¼1FA j/C2cn iPpj¼1FA jð4Þ Eq.(4)expresses the way defuzziﬁcation is carried out usingcenter of area method to obtain the output of the controller‘f’, denoted by ‘O
f’. Here, ‘FA j’ is the ﬁring area of the ‘jth’ rule, ‘cn
i’ is the centroid of theith area (AR) underconsideration.It is important to note that ‘l
ij’ values and ‘FS jk’ values resemble the connection strengths between ‘I’ and ‘HL-1’andare denoted by ‘w
ij’ and that between ‘HL-2’ and ‘O’ layerare denoted by ‘v
jk’. Throughout the nodal input–output pro-cessing, linear transfer functions have been considered. Thedeveloped model is then trained and tested with 214 and 88real-world depression cases, respectively.To measure the performance of the said hybrid controller,its sensitivity (S
n), speciﬁcity (S p), precision (P r), and average accuracy (A
cc) have been measured[28]. All values areexpressed in %. Eqs.5–8show how these are computed. Inthese equations ‘p’ and ‘n’ denote total positive and negativecases; ‘tp’ and ‘np’ are true and false positive cases and ‘N’i s the total number of cases.Sn¼tpp/C2100 ð5ÞS
p¼tnn/C2100 ð6ÞP
r¼tptpþfp/C2100ð7ÞA
cc¼S n/C2pNþS
p/C2NNþP/C20/C21/C2100ð8Þ4. Experimental results and discussionsThis section discusses the experimental results sequentially.4.1. Data processingThe calculated Cronbach’sais0.87, which is well-over 0.7, theassigned threshold[29]. Hence, the data are said to be inter-nally consistent and reliable for PCA.PCA measures eigenvectors and its eigenvalues of the cor-relation matrix.Table 2shows the eigenvalues of all factors.According to the concept of PCA, factors of higher eigenval-ues are the principal components (PC) and are interesting tostudy. It may be noted that ‘S’ (Feeling sad),‘P’(Loss of plea- sure), ‘W1’ (Weight loss), ‘I1’ (Insomnia), ‘H’ (Hypersom-
Fig. 2The proposed neuro-fuzzy model.Table 2Eigen Analysis.
Symptom EigenvalueS 1.3562 P 1.2868 W1 1.1925 I1 1.1480 H 1.1275 A 1.0410 P1 1.0127 P2 0.9880E 0.9302W2 0.8979T 0.8039I2 0.8014D 0.7243SO 0.689614 S. Chattopadhyaynia), ‘A’ (Loss of appetite),and‘P1’ (Psychomotor agitation)are the seven latent factors with eigenvalues higher than 1.0(seeTable 2) and hence are taken into consideration as princi-pal components (PC). Therefore, the initial input vector spacehaving 14-dimension initially has now been reduced to 7-dimension. It resembles the way psychiatrists extract the signif-icant symptoms from too many at the backdrop of the illnessduringDD.Fig. 3plots the components based on the respec-tive eigenvalues. Because the metric of the original datasethas now been changed to 302/C27,ahas been checked again,which is 0.72 in this experiment and above the assigned thresh-old 0.7[29].4.2. Fuzzy-neural hybrid controllerSeven symptoms, extracted by PCA and the level of ‘Depres-sion’ have been arbitrarily grouped as ‘mild’(m), ‘moderate’(M) and ‘severe’(s) with overlapping scales such asmild-to- moderate (mM), moderate-to-severe (Ms) and ‘very severe’(s)(referring to theDDphase of clinical diagnosis, discussedin section I) and are represented into asymmetric TMFD (refertoFig. 4). Such overlapping regions are the focus of this fuzzy-neural model that aims to differentiate it into ‘mild’, ‘moder-ate’ and ‘severe’ (i.e., thePDphase of the clinical diagnosis).A group of psychiatrists according to their experience assignedthe range A Mamdani’s FLC is then developed and modeledinto a FFMNN structure. There are a total of seven inputs,each with two possibilities one time. Hence, there are a totalof 27i.e., 128 rules that might ﬁre among 37, i.e., 2187 possiblerules. At ﬁrst, the FLC has been trained to optimize its rulebase and then tested with the optimized rule set after a 10-fold cross validation.a. Training:The FLC is then trained (ofﬂine) with 214 real-worlddepression cases obtained from 10-fold cross validation. Forone training case, there are seven inputs (i.e., seven symptoms)each having three Grades of Distributions (GD). For an input,maximum two GDs can take part and hence two membershipvalues (l) could be computed. Membership values havingabsolute belongingness (i.e., 1.0) or non-belongingness (i.e.,0.0) are discarded from the study. For the ﬁrst training case,‘S’, ‘I1’, ‘H’, and ‘A’ are considerable. The rule could be statedas per the domain experts ‘‘IF ‘S’ is ‘mM’ AND ‘I1’ is ‘mM’AND ‘H’ is ‘Ms’ AND ‘A’ is ‘mM’ THEN Depression is‘mM’”and the ‘FS’ of this rule is 0.34 (seeTable 3). Then the respective ‘FS’ was calculated. ‘FS’ valuesP0.5 are considered ‘strong’ according to the 10-fold cross valida-tion tests. These strong rules are used for computing the out-put of the controller and the rests are neglected.It may be noted that a total of38 rules(which is only 30%of the total ﬁred rules) have FSP0.5. An ‘OR’ operation hasthen been performed to obtain the membership of the com-bined control (seeTable 4). In the next step, ﬁring areas(FA) of all fuzzy output rules for ‘mM’, ‘Ms’, and ‘s’have been computed (refer toﬁg. 5).After defuzziﬁcation with the Centre of Area (COA)method, the ﬁnal combined output of the FLC is 0.1852i.e., it belongs to the class ‘mild’ (m). In addition, the MSEof all 214 training cases is low, i.e.,0.0008.
Fig. 3Scree plots of components.
Fig. 4Triangular membership function distribution of symp-toms (inputs) and the grades of depression (output).Table 3Fuzziﬁcation Of The 1st Training Case.
Il(mM)l(Ms)l(s) AND S (0.5) 0.66 0.34 – 0.34P (0.6) – 1.0 – –W1 (0.9) – – 1.0 –I1 (0.5) 0.66 0.34 – 0.34H (0.8) – 0.34 0.66 0.34A (0.7) – 0.66 0.34 0.34P1 (0.9) – – 1.0 –
Table 4Output Calculations.
#FA FA Center FA * CenterFA1 0.021 0.7911 0.016614FA2 0.084 0.25 0.00258FA3 0.0336 0.0767 0.219152FA4 0.0171 0.4681 0.116432FA5 0.1026 0.5 0.117398FA6 0.01995 0.3412 0.074607FA7 0.0248 0.3426 0.021FA8 0.1116 0.75 0.0513FA9 0.0155 0.2731 0.0837SUM = 3.79318 SUM = 0.702782A neuro-fuzzy approach for the diagnosis of depression 15b. TestingAfter the training, performance of the model is then testedfor 88 cases with the optimized rule set. It has also been vali-dated with 50 controls, i.e. normal population. Table 5shows the sequence of computations for one test case as described indetail in section III-‘C’. Similarly, remaining test cases arepassed one-by-one though the system and the correspondingMSEhas been calculated, which is found to be 0.0121.I t may be noted that the best value ofghas been selectedthrough a parametric study by varying the values of gfrom 0.05 to 0.95 (0.05 as the rate of increment) keeping the weights(i.e., ‘w
ij’ and ‘v jk’ values) constant all time (seeFig. 6). In the next step, the error needs to be minimized using aBPNN algorithm by updating the ‘w
ij’ and ‘v jk’ values, itera- tively keeping the ‘g’ equals to 0.70 (seeTable 6). It may be noted that the ‘w
ij’ and ‘v jk’ values are arbitrarily chosen as val-ues between 0 and 1. These values are iteratively updated whilereducing the error, so the initially considered values changeaccordingly.Table 6shows that the error could be further minimizedusing BPNN by iteratively updating the weight vectors.Because 1% error is negligible in medical diagnosis, especiallyin mental health, the weight (that resembles the information)-updating task has not been considered further.Finally, the average sensitivity (‘Sn’), speciﬁcity (‘S p’), pre- cision (‘P
r’), and accuracy (‘Acc’) of the hybrid controller have
Fig. 5Aggregated ﬁring area (FA1 to FA9).
Table 5Forward Calculations For One Test Case.
I HL-1 (I) HL-1(O) HL-2 (I = O) HL-3 (I) HL-3 (O) OL(I = O)S 0.62l(Ms) = 0.42;l(s) = 0.58; 0.42 IF ‘S’ is ‘Ms’ & ‘P’ is ‘mM’ ...& ‘P1’ is‘s’ THEN ‘Depression’ is ‘s’ (see table 5,rule # 112).0.52*0.42 0.2184P 0.38l(mM) = 0.33;l(Ms.)= 0.67; 0.33 0.52 *0.33 0.1716 W1 0.64l(Ms.) = 0.14;l(s) = 0.86; 0.14 FS = 0.52. 0.52 *0.14 0.0728 I1 0.36l(mM) = 0.66;l(Ms)= 0.34; 0.34 0.52 *0.34 0.1768 H 0.36l(mM) = 0.66;l(Ms)= 0.34; 0.34 0.52 *0.34 0.1768 A 0.36l(mM) = 0.66;l(Ms)= 0.34; 0.34 0.52 *0.34 0.1768 P1 0.64l(Ms.) = 0.14;l(s) = 0.86; 0.14 0.52 *0.14 0.0728P= 1.066
Fig. 6Parametric study to ﬁnd the best value of the learningrate.Table 6Updated weights for 1st test case.
Iteration ‘w ij’‘ v jk’M S E 0 0.42, 0.33, 0.14, 0.34, 0.34, 0.34, 0.14 0.52 0.01211 0.4219, 0.3315, 0.1406, 0.3416, 0.3416,0.3416, 0.1406 0.5153 0.0120
Table 7Prediction Analysis Of The Hybrid Controller OnTest Data.
Prediction ‘mM’ ‘Ms’ ‘s’tp 27 28 29fp 00 00 00tn 00 00 00fn 01 01 02Total28
29 31
Sn(%) 96.42 96.55 93.54S
p(%) 0.0 0.0 0.0P
r(%) 100% 100% 100%Acc(%) 92.03 (avg.)16 S. Chattopadhyaybeen measured by comparing with the target depression grades(seeTable 7). In case of 50 control data (i.e. normal popula-tion), none of the cases are misdiagnosed as ‘depression’.Hence, it is not shown as a table. The average accuracy ofthe hybrid controller is 95.50% (seeTable 7), which is compa-rable to the other controllers shown inTable 8. 4.2.1. ComparisonTable 8shows the comparison of the outcome of this studywith the previous works, where several soft computing tech-niques have been used in the diagnosis of depression.5. DiscussionsThis paper proposes a neuro-fuzzy model consisting of Mam-dani’s technique mapped onto a feedforward backpropagationneural network. The aim is to model the manual process ofclinical diagnosis of depression. On a sample of 302 real-world depression cases, the model has been trained and tested.The observations are as follows./C15The obtained depression data are reliable both before andafter PCA (Cronbach’savalue are over 0.7). While diag-nosing an illness, medical doctors also search for reliabilityof the information given to them by the patients and theirrelatives or the colleagues./C15PCA could reduce data dimension by extracting the signif-icant latent factors, such as ‘S’ (Feeling sad), ‘P’ (Loss of pleasure), ‘W1’ (Weight loss), ‘I1’ (Insomnia), ‘H’ (Hyper- somnia), ‘A’ (Loss of appetite), and ‘P1’ (Psychomotor agita-tion) to qualify for the depression state. It mimics theprocess by which medical doctors eventually reduce theamount of information based on the importance of theinformation pertinent to the illness./C15Out of total 3
7(i.e., 2187) rules, 27(i.e. 128) rules are ﬁred.Now, with 10-fold cross validation it is noted that the ruleshaving ﬁring strength >0.5 may be considered as ‘strong’rules, which are ultimately required to develop the ﬁnal rulebase of the controller. With this technique, 98.27% rules,which are not so important, are pruned. Such pruning isimportant to reduce the complexity of the controller. Med-ical doctors also possess their own rule bases depending ontheir levels of experiences. This technique mimics the waymedical doctors actually prune the number of unimportantrules to reduce the diagnostic complexity and converge intoa diagnosis. Hence, the paper argues that, it is the rule qual-ity and quantity that are important for decision-making./C15With the learning rate (g), the developed hybrid model isable to automate the diagnosis process, especially fromDD(i.e. overlapped diagnoses, which are handled by theprinciple of fuzzy sets) toPD(i.e. speciﬁc diagnoses, whichare the output of combined control process) with 100%average precision and 95.50% accuracy. It is therefore acomparable result with respect to several others works(seeTable 8). Medical doctors also learn either from obser-vations or by examples and iteratively converge to the diag-nosis. The qualitative information is modeled by theconcept of fuzzy sets and the interpretation is tuned itera-tively by adjusting the connector weights (i.e., their stateof knowledge base).Future work: Expert tool development is the next step ofany controller design. However, it is a time-taking process toachieve the required amount of standardization and user satis-faction. Keeping all these in mind, we propose that such ahybrid model could be implemented as a full-ﬂedged expertsystem and given to the psychiatrists for its’ initial use. Theauthors are currently working in the Graphic User Interface(GUI) development and its standardization.References[1] S. Chattopadhyay, Fuzzy Logic Based Screening and Predictionof Adult Psychoses (Ph.D. thesis), Indian Institute ofTechnology, Kharagpur, India, 2007.[2]
M. Gannon, M. Qasesem, V. Snow, Q. Snooks, Painmanagement and the primary care encounter opportunities forquality improvement, J. Prim. Care Community Health 2 (2011)37–44
.[3]
D.M. Clarke, Psychological adaptation, demoralization anddepression in people with cancer, in: D.W. Kissane, M. Maj, N.Sartorius (Eds.), Depression and Cancer, John Wiley & SonsLtd, Chichester, UK, 2010 (ch. 2)
.[4]
I. Pacchiarotti, L. Mazzarini, G.D. Kotzalidis, M. Valentı ´, A.M. A. Nivoli, G. Sani, C. Torrent, A. Murru, J. Sanchez-Moreno,B. Patrizi, P. Girardi, E. Vieta, F. Colom, Mania anddepression. Mixed, not stirred, J. Affect. Disord. 133 (1)(2011) 105–113
.[5]
S. Chattopadhyay, Psyconsultant I: a DSM-IV-based screeningtool for adult psychiatric disorders in Indian rural health center,Internet J. Med. Inform. 3 (2006) (Serial Online)
.Table 8Comparative studies of various soft computing techniques in automating depression.
Author(s) Year Technique(s) Sensitivity Speciﬁcity Accuracy (avg.) Tai & Chiu 2007 RBFN [14] 82% 86% – Lan et al. 2008 Fuzzy-Tech 5.54 software [19]– – 93% de Carvalho et al. 2008 Neuro-fuzzy NEFCLASS and ANNB techniques [20]– – 95.65% Suhasini et al. 2010 BPNN [15] – – 98.75% Suhasini et al. 2011 BPNN [16] – – -do- Chattopadhyay et al. 2011 BPNN [17] – – 89% Chattopadhyay et al. 2011 BPNN + ANFIS (neuro-fuzzy with Sugeno’s technique) [18] – – 97.33%Chattopadhyayet al.(currentstudy)2012 Neuro-fuzzy model with Mamdani’s technique ––95.50%A neuro-fuzzy approach for the diagnosis of depression 17[6]S. Chattopadhyay, A computerized tool for screening of adultpsychiatric illnesses: a third-world perspective, J. Clin. Inform.Telemed. 3 (2006) 1–5
.[7]
S. Chattopadhyay, D.K. Pratihar, S.C. De Sarkar, Some studieson fuzzy clustering of psychosis data, Int. J. Bus. Intell. DataMin. 2 (2007) 143–159
.[8] S. Chattopadhyay, P. Ray, M.B. Lee, H.S. Chen, Towards thedesign of an e-health system for suicide prevention, in:Proceedings of the Eleventh IASTED InternationalConference on Artiﬁcial Intelligence, Palma de Mallorca,Spain, 2010, pp. 191–196.[9]
S. Chattopadhyay, D.K. Pratihar, S.C. De Sarkar, Developingfuzzy classiﬁers to predict the chance of occurrence of adultpsychoses, Knowledge Based Syst. 20 (2008) 479–497
. [10]
S. Chattopadhyay, D.K. Pratihar, S.C. De Sarkar, Fuzzy logic-based screening and prediction of adult psychoses: a novelapproach, IEEE Trans. Syst. Man Cybern. A Syst. Hum. 39(2009) 381–387
.[11]
S. Chattopadhyay, D.K. Pratihar, S.C. De Sarkar, Statisticalmodelling of psychoses data, Comput. Methods ProgramsBiomed. 100 (2010) 222–236
.[12]
S. Chattopadhyay, U.R. Acharya, A novel mathematicalapproach to diagnose premenstrual syndrome, J. Med. Syst. 36(4) (2012) 2177–2186
.[13]
S.-C. Yu, Y.-H. Lin, Applications of fuzzy theory on healthcare: an example of depression disorder classiﬁcation based onFCM, WSEAS Trans. Info. Sci. Appl. 5 (2008) 31–36
. [14] Y.-M. Tai, H.-W. Chiu, Artiﬁcial neural network analysis onsuicide and self-harm history of Taiwanese soldiers, in:Proceedings of the Second International Conference onInnovative Computing, Information and Control (ICICIC),Kumamoto, Japan, 2007, p. 363.[15]
A. Suhasini, S. Palanivel, V. Ramalingam, Multi decisionsupport model for psychiatry problem, Int. J. Comput. Appl.1 (2010) 61–69
.[16]
A. Suhasini, S. Palanivel, V. Ramalingam, Multimodel decisionsupport system for psychiatry problem, Expert Syst. Appl. 38(2011) 4990–4997
.[17] S. Chattopadhyay, P. Kaur, F. Rabhi, U.R. Acharya, Anautomated system to diagnose the severity of adult depression,in: D. Jana, P., Pal (Eds.), Proceedings of Second InternationalConference on Emerging Applications of InformationTechnology (CSI EAIT-2011), IEEE Computer Society andConference Publishing Services, Kolkata, India, 2011, pp. 121–124.[18]S. Chattopadhyay, P. Kaur, F. Rabhi, U.R. Acharya, Neuralnetwork approaches to grade adult depression, J. Med. Syst. 36(5) (2012) 2803–2815
.[19]
T.H. Lan, E.W. Loh, M.S. Wu, P. Chou, T.Y. Lan, H.-J. Chiu,Performance of a neuro-fuzzy model in predicting weightchanges of chronic schizophrenic patients exposed toantipsychotics NFM performance on chronic schizophrenicpatients, Mol. Psychiatry 13 (2008) 1129–1137
. [20]
L.M.F. de Carvalho, S.M. Nassar, F.M. de Azevedo, H.J.T. deCarvalho, L.L. Monteiro, C.M.Z. Rech, A neurofuzzy system tosupport in the diagnostic of epileptic events and non-epilepticevents using different arithmetical operations, Arq.Neuropsiquiatr. 66 (2a) (2008) 179–183
. [21] K. Pearson, On Lines and Planes of Closest Fit to Systems ofPoints in Space, Philosophical Magazine, 1901. < http://stat. smmu.edu.cn/history/pearson1901.PDf>, 6, pp. 559–572. [22] E.H. Mamdani, Application of fuzzy algorithms for the controlof a simple dynamic plant, in: Proc. IEEE, 1974, pp. 121–159.[23]
F. Rosenblatt, The perceptron: a probabilistic model forinformation storage and organization in the brain, Psychol.Rev. 65 (1958) 386–408
.[24]
D.E. Rumelhart, G.E. Hilton, R.J. Williams, Learning internalrepresentations by error propagation, Parallel DistributedProcessing, vol. 1, MIT Press, Cambridge, MA, 1986, pp. 318–
362.[25]P.A. Devijver, J. Kittler, Pattern Recognition: A StatisticalApproach, Prentice-Hall, London, UK, 1982
. [26] Diagnostic and Statistical Manual (DSM-IV) of MentalDisorders, fourth ed., American Psychiatry Association, 1994.[27]
L.J. Cronbach, Coefﬁcient alpha and the internal structure oftests, Psychometrika 16 (1951) 297–333
. [28]
J. Han, M. Kamber, Data Mining: Concepts and Techniques,second ed., 2006, p. 361
.[29]
J. Nunnaly, Psychometric Theory, McGraw-Hill, New York,1978
.18 S. Chattopadhyay