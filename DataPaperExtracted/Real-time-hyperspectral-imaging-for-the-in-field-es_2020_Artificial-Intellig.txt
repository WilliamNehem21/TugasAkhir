Real-time hyperspectral imaging for the in-ﬁeld estimation of strawberryripeness with deep learning
Zongmei Gaoa, Yuanyuan Shaob,c,⁎, Guantao Xuanb,d,⁎⁎, Yongxian Wangb,Y iL i ub, Xiang Hanb
aCenter for Precision and Automated Agricultural Systems, Department of Biological Systems Engineering, Washington State University, Prosser, WA 99350, USA
bCollege of Mechanical and Electrical Engineering, Shandong Agricultural University, Tai'an 271018, China
cNanjing Institute of Agricultural Mechanization, Ministry of Agriculture and Rural Affairs, Nanjing 210014, China
dCollege of Agriculture, Food and Natural Resources, University of Missouri, Columbia, MO 65211, USA
abstract article info
Article history:Received 10 December 2019Received in revised form 26 April 2020Accepted 27 April 2020Available online 30 April 2020
Keywords:Strawberry ripenessHyperspectral imageryInﬁeldCNNStrawberry is one of the popular fruits with numerous nutrients. The ripeness of this fruits was estimated usingthe hyperspectral imaging (HSI) system in ﬁeld and laboratory conditions in this study. Strawberry at early ripe and ripe stages were collected HSI data, covered wavelength ranges from 370 to 1015 nm. Spectral feature wave-lengths were selected using the sequential feature selection (SFS) algorithm. Two wavelengths selected for ﬁeld (530 and 604 nm) and laboratory (528 and 715 nm) samples, respectively. Then, reliability of such spectral fea-tures was validated based on support vector machine (SVM) classi ﬁer. Performance of SVM classiﬁcation models had good results with receiver operating characteristic values for samples under both ﬁeld and laboratory condi- tions higher than 0.95. Meanwhile, the spatial feature images were extracted from the spectral feature wave-length and theﬁrst three principal components for laboratory samples. Pretrained AlexNet convolutionalneural network (CNN) was used to classify the early ripe and ripe strawberry samples, which obtained the accu-racy of 98.6% for test dataset. The above results indicated real-time HSI system was promising for estimatingstrawberry ripeness underﬁeld and laboratory conditions, which could be a potential application techniquefor evaluating the harvesting time management for farmers and producers.© 2020 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/4.0/ ).
1. IntroductionStrawberry fruit is favored by consumers for its characteristic fea-tures such as aroma, juicy texture, and sweetness and has been a criticalfruit in terms of economic value. The fresh fruits or prepared foods suchas preserves, juice and pies has been consumed in large quantities(Gunness et al., 2009). In 2017, there were 9.2 million tons of straw-berries produced over world, led by China with 21% of the total(FAOSTAT, 2017). While strawberry is a non-climacteric fruit, harvest-ing at the optimum stage of ripening often determines good quality ofthe fruit. Conventionally, strawberry ripeness has been evaluated withcertain objective criteria including color, texture, and chemical constit-uents, etc., by fruit expert or researchers ( Rico et al., 2007;Zhang et al., 2016). These methods even though with satisfactory accuracyare often destructive, time-consuming and labor intensive. Therefore,it is needed to develop a rapid and nondestructive method for straw-berry fruit ripeness evaluation.Spectral imaging techniques have been successfully applied to mea-surement of quality attributes in fresh fruits and vegetables ( Nicolaï et al., 2007). Hyperspectral imaging (HSI) technique, as a commonly ad-vanced nondestructive technique, integrates conventional imaging andspectroscopy technique, collecting spectral and spatial information inparallel. Further, it is chemical-free, and measuring rapidly with limitedsample preparation (Wu and Sun, 2013;Gao et al., 2019;Shao et al., 2019). With these advantages, HSI has been applied to estimate fruitripeness, including banana, astringent persimmon, strawberry,bananito fruit, etc. (Rajkumar et al., 2012;Wei et al., 2014;Zhang et al., 2016;Pu et al., 2019).Zhang et al. (2016)employed HSI, along with the support vector machine (SVM) for strawberry ripeness evalu-ation under the laboratory condition. With 380 to 1030 nm and 874 to1734 nm, set as the spectral range on HSI, respectively, optimal wave-lengths and the corresponding image features were extracted fromeach range for the ripeness analysis of strawberries (unripe, mid-ripeand ripe). The classiﬁer (SVM) results in the end revealed that thedataset of spectra ranging from 441.1 to 1013.97 nm outperform thosefrom 941.46 to 1578.13 nm in terms of accuracy, ef ﬁciency. This studyArtiﬁcial Intelligence in Agriculture 4 (2020) 31 –38
⁎Correspondence to: Y. Shao, College of Mechanical and Electrical Engineering,Shandong Agricultural University, Tai'an 271018, China.⁎⁎Correspondence to: G. Xuan, College of Agriculture, Food and Natural Resources,University of Missouri, Columbia, MO 65211, USA.E-mail addresses:syy007@sdau.edu.cn(Y. Shao),xuangt@sina.com(G. Xuan).
https://doi.org/10.1016/j.aiia.2020.04.0032589-7217/© 2020 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the C C BY-NC-ND license (http:// creativecommons.org/licenses/by-nc-nd/4.0/ ).
Contents lists available atScienceDirect
Artiﬁcial Intelligence in Agriculture
journal homepage:http://www.keaipublishing.com/en/journals/artificial-intelligence-in-agriculture/signiﬁcantly facilitated application of HSI on strawberry ripenessevaluation.To date, deep learning method has been used in a wide range ofareas as applications of end-to-end learning ( LeCun et al., 2015). Deep neural networks can offer a connection between the inputs i.e. animage of an object to an output such as the ripeness of fruits(Ferentinos, 2018). The layers in a neural network are mathematicalfunctions that make learning decisions from the extracted features(Schmidhuber, 2015;Mohanty et al., 2016;Zhang et al., 2018a;Zhang et al., 2018b).Krizhevsky et al. (2012)proposed that AlexNet convolutional neural network (CNN) architecture has a milestone con-tribution in image recognition and classiﬁcation.Sa et al. (2016)devel- oped a‘DeepFruits’to detect seven different fruits using deepconvolutional neural networks, which was helpful for fruit yield estima-tion and automated harvesting.Rahnemoonfar and Sheppard (2017)designed a DCNN for tomato target recognition that accurately identi-ﬁed tomato targets which were shaded, occluded by leaves, and over-lapped.Yu et al. (2019a)andYu et al. (2019b)built one Mask Region Convolutional Neural Network (Mask-RCNN) for detecting ripe and un-ripe strawberries based on RGB images. The fruit detection results of100 testing images demonstrated its robustness, with the average de-tection precision, recall and MIoU rates at 95.78%, 95.41% and 89.85%,respectively.Tian et al. (2019)proposed an improved YOLO-V3 algo-rithm to identify apples in different growth stages. The algorithm canrealize real-time detection of occlusion and overlapping apples andachieved good recognition results. In addition, there were a large num-ber of reports on fruit quality, crop quality, and crop pest detectionbased on deep learning (Le and Lin, 2019;Kamilaris and Prenafeta- Boldú, 2018;Yu et al., 2018;Yu et al., 2019a;Yu et al., 2019b; Geetharamani and Pandian, 2019).Though the application of hyperspectral imaging to identify the ripe-ness of strawberry fruits in laboratory has been performed ( Zhang et al., 2016), while it is still challenging to identify the ripeness of the straw-berry fruits inﬁeld, not even at early ripe stage. Therefore, this studywas aimed to estimate the ripeness of the strawberry fruits under in ﬁeld and laboratory conditions using hyperspectral imaging combined withdeep learning. Speciﬁcally, in this study, we carried out the strawberryfruit's ripeness estimation at two different ripening stages (early ripeand ripe) using HSI under bothﬁeld and laboratory conditions. Theobjectives of this study were to: 1) develop the hyperspectral imagingtechnique to evaluate strawberry ripeness in ﬁeld; 2) select spectral fea- ture wavelength from respectiveﬁeld and laboratory datasets; and3) validating the precision of the selected key wavelengths based onboth spectral and spatial information.
2. Related workDeep learning has emerged as one advanced technology to imageanalysis in precision agriculture throughout from growing to harvest-ing. Convolutional neural network (CNN) is one of the most used deepnetwork architectures, has been employed for image classi ﬁcation, seg- mentation, object detection etc.Zheng et al. (2019)developed CropDeep using YOLOv3 network for image classi ﬁcation and detection consisted by crop digital images from 31 different classes. Bargoti and Underwood (2017)applied CNN to segment images obtained by onedigital camera in apple orchard for counting fruits number and estimat-ing yield.Zhang et al. (2018a)employed the regions-convolutional neu-ral network (R-CNN) to deploy the object detection for detecting thebranch of apple trees based on the images taken using the depth-RGBsensor. The typical image classiﬁcation, segmentation and object detec-tion application in precision agriculture are summarized in Fig. 1. Fruit detetcion and ripeness estimation based on deep leanring hasbeen one recent interest for the resarchers aiming to practical applica-tion in orchard orﬁeld detection. Some studies were dedicated toapply deep learning to fruit detetcion industrially. Hossain et al. (2018)employed two deep learning frameworks, one was light modelwith six convolutional neural network layers and another one wasﬁne-tuned VGG model. The authors operated few experiments to classi-ﬁed different fruits based on such frameworks. The VGG model achievedgreat performance for classifying the fruits with accuracy higher than90%. In addition, various studies have applied deep learning forclassiﬁying the fruit ripeness for further harvesting and shelf storage.Halstead et al. (2018)presented a robotic vision system for estimatingthe sweet pepper ripeness based on one parallel FasterRCNN (FRCNN)framework. The accuracy for estimation of ripeness reached to 82.1%.Whiel the proposed method was not operated well for samll juvenilesweet pepper since the size of such frits were samll, leading to manymisclassiﬁed number of fruits. While, most of the stuidies employed
Fig. 1.The typical applications of convolution neural network for image classi ﬁcation, segmentation and object detection in precision agriculture, (a) crop classi ﬁcation (image fromZheng et al., 2019), (b) apple images segmentation (image from Bargoti and Underwood, 2017 ), and (c) apple branch detection (image from Zhang et al., 2018a).32 Z. Gao et al. / Artiﬁcial Intelligence in Agriculture 4 (2020) 31 –38the digital sensor for estimating ripeness of fruits as of today. The digitalsensing methods works well for fruits with signi ﬁcant color variations at different ripen stages, while it is still chanellenging for fruits with lesscolor diffeences.Recently, with the development of optical sensing technology,hyperspectral imaging has been applied as one powerful tool to noncon-tact detect the fruits quality including the ripeness for many fruits, suchas persimmon (Munera et al., 2017), olive (González-Cabrera et al., 2018), nectarine (Munera et al., 2017b), strawberry (Zhang et al., 2016), bananito (Musa acuminata,A A )(Pu et al., 2019), etc. While it is still challenging to employ the hyperspectral imaging in ﬁeld, with lim- itations in light source, winds, and crops overlapping etc. Furthermore,combined with hyperspectral imaging and deep learning is worth of ex-ploration for detailed information extraction and information under-standing with large amounts of dataset. As summarized in Table 1, most research applied CNN for the fruit quality detection based on dig-ital sensors for classiﬁcation. A wide spectrum of applications is worthyof exploitation combined with deep learning with the high-channelssensors.3. Materials and methods3.1. Inﬁeld samplingThe experimental site was a commercial strawberry farm located inTai'an, Shandong Province, China (36.2003° N, 117.0876° E). “Zhangji” cultivar strawberry was planted. The strawberry farm planting areawas 1080 m
2with planting row distance at 0.3 m. The length of eachrow was 9 m and 4 strawberries were planted within 1 m. Strawberryrows were selected randomly for the spectral imaging analysis. Earlyripe and ripe strawberries without disorders were respectively chosento take the hyperspectral images on March 22, 2019. The strawberryplants were randomly selected from the rows. In all, 26 early ripe and19 ripe strawberry plants were randomly selected for the hyperspectralimage acquisition. The real-time collected HSI in- ﬁeld images were shown inFig. 2, with the hyperspectral images being automatically col-lected. Meanwhile, another 60 early ripe and 60 ripe strawberries wererandomly detached from the corresponding ripening strawberry plants,respectively, for the reliability validation of in ﬁeld images.3.2. Hyperspectral imaging acquisitionA portable snapshot hyperspectral imaging system ( Fig. 3)w a s employed in this study (GaiaField-V10E, Dualix Instruments Co., Ltd.,Chengdu, China). The system was consisted by a spectrometer(GaiaField-V10E), lens (HSIA-OL23), light source (HSIA-LS-T-200 W),white panel (HSIA-CT-150 × 150), tripod (HSIA-TP-S), and the com-puter installed with the data collection software of SpecView. The spec-tral ranged from 370 to 1015 nm, with the spectral resolution at 2.8 nm.The image of each wavelength is with 1394 × 1040 pixels. During theHSI image collection in theﬁeld, the parameter optimization was re-quired. The sensor exposure time was set to 3 ms, and distance betweenthe lens and the ground was 0.87 m. Before collecting the strawberryimages, a white reference image was taken based on imaging a whitepanel, and a dark reference image was obtained by covering the lenswith the cap.Table 1Summary of studies using deep learning for various fruit applications.Reference Task Modality Method RemarksSa et al. (2016) Object detection RGB and NIR Faster R-CNN Detection of seven fruits using bounding box annotation Yu et al. (2018) Prediction Hyperspectral SAE-FNN SAE-FNN for predicting ﬁrmness and SSC of pear Zhang et al. (2018b) Classiﬁcation RGB CNN CNN based on augmented datasets for estimating tomato ripeness Hu et al. (2019) Object detection RGB Faster R-CNN Faster R-CNN based detection of tomatoes Ibrahim et al. (2018) Classiﬁcation RGB CNN CNN for classifying palm oil fresh fruit bunch Ge et al. (2019) Segmentation RGB-D CNN Strawberries ripeness detection Liu et al. (2019) Object detection RGB Mask R-CNN Mask R-CNN for detecting cucumber in greenhouse Mohtar et al. (2019) Classiﬁcation RGB CNN CNN for classifying mangosteen ripeness Steinbrener et al. (2019) Classiﬁcation RGB CNN and GoogleNet Preprocessed RGB extracted from hyperspectral images Toon et al. (2019) Classiﬁcation RGB CNN CNN for classifying tomato ripeness Wang et al. (2019) Object detection RGB and video MangoYOLO MangoYOLO, was used to detect fruit in each frame Yu et al. (2019a)andYu et al. (2019b)Segmentation RGB Mask R-CNN Mask-RCNN for identifying the strawberry Zeng et al. (2020) Classiﬁcation Thermal LeNet LeNet model for classi ﬁcation of bruise of pearNote: NIR: Near-infrared; SAE: stacked auto-encoders; FNN: fully connected neural network; SSC: soluble solid content; Faster R-CNN: faster region-CN N; RGB-D: RGB-depth.
Fig. 2.Inﬁeld hyperspectral images of strawberry at (a) early ripe, and (b) ripe stage.33 Z. Gao et al. / Artiﬁcial Intelligence in Agriculture 4 (2020) 31 –38To eliminate the impacts of uneven illumination and dark currentnoise, the raw hyperspectral images were calibrated using the whiteand dark reference images by calibration Eq. (1):R
c¼R0−DW−D ð1Þwhere,R
cindicates the calibrated hyperspectral image, R 0indicates the raw hyperspectral image, W is the white reference image and D is thedark reference. Each strawberry was selected as one region of interest(ROI) for extracting the spectral information of the strawberry. For in-ﬁeld samples, 60 individual early ripe and 60 individual ripe strawberrywere extracted from the corresponding ripeness plants as ROIs. The av-eraged spectral data was calculated from the pixels in each ROI.3.3. Feature wavelength selectionThe analysis of the hundreds of wavebands from hyperspectral im-ages would be computationally laborious. Therefore, the strategy to se-lect and focus on the analysis the feature wavelengths has often beenprevalent in theﬁeld. Herein, a few numbers of wavelengths with themost informative signiﬁcance and the minimum co-linearity and redun-dancy from full spectra were screened to reduce the data dimensionalityand complexity (Gao et al., 2019). In this study, the robust feature selec-tion algorithm, sequential feature selection (SFS) were utilized for fea-tures selection, which greatly improved the computational ef ﬁciency and reduced error of the model by removing irrelevant features or noise.This SFS algorithm, distinct from other feature selection algorithms,is consisted by two components: (1) The objective function, called thecriterion, with mean squared error (for regression models) and misclas-siﬁcation rate (for classiﬁcation models), seeking to minimize overallfeasible feature subsets. (2) A sequential search algorithm, determiningthe candidate subset during the criterion evaluation. Sequentialsearches are in one-way working modes, exclusively growing or shrink-ing the candidate set (Zhang et al., 2013). In particular, the SFS algo- rithm carries out a“bottom-up”search strategy, starting from anempty feature subset and adding one feature at a time, eventuallyachieves a feature subset with the desired cardinality. The SFS algorithmwith the forward direction was employed for selecting the featurewavelengths in this study. All of the data sample were used for selectingfeature wavelengths by SFS algorithm for ﬁeld and laboratory condi- tions, respectively. This procedure was performed in the MATLAB®(2019a, The MathWorks Inc., Natick, MA).3.4. Classiﬁcation modelsSVM is a supervised machine learning method based on the statisti-cal learning theory (Guo et al., 2010). Brieﬂy, SVM makes an effort to ﬁnd a hyperplane in the multidimensions to separate the different clas-ses, i.e. early ripe and ripe previously mentioned in this study. The hy-perplane is the optimal surface with the maximal distance betweenthe hyperplane and classes from each side, namely the margin, as statedin Eq.(2), depending on the number of classes ( N classes ), a different number of hyperplanes (N
hplanes ) is generated.N
hplanes ¼Nclasses /C2N classes−1ðÞ2 ð2ÞIn general, the classiﬁer will perform better when the margin withthe larger value. For training an SVM model is a process of ﬁnding the optimize hyperplane based on the training dataset. In the optimization,SVM adopts a structural minimum principle for avoiding the over-ﬁtting problems. SVM classiﬁer, in numerous research, has been dem-onstrated with superior performance on HSI classi ﬁcation (Fauvel et al., 2007). The samples were split into training and test dataset witha ratio of 70:30 for respectiveﬁeld and laboratory conditions. As a result,there were 43 early ripe and 41 ripe strawberries in training dataset forﬁeld condition. While there were 17 early ripe and 19 ripe strawberriesin test dataset collected inﬁeld. Similarly, there were 39 early ripe and45 ripe strawberries in training dataset for laboratory condition. Whilethere were 21 early ripe and 15 ripe strawberries in test dataset col-lected under laboratory.The receiver operating characteristic (ROC) curve visualizing theclassiﬁer's performance was used in this study for operating point selec-tions, or threshold decisions. The size of area under the ROC curve (AUC)proportionally indicates of classiﬁer's performance level, and thereforeis useful for comparing the performances of a number of different clas-siﬁcation schemes. The point closest to the top left corner of the ROCcurve was chosen as an optimal threshold value (where the true posi-tive rate equals 1 and the false positive rate equals 0). This procedurewas performed in the MATLAB® (2019a, The MathWorks Inc., Natick,MA).3.5. CNN archeriteAlexNet competed in the ImageNet Large Scale Visual RecognitionChallenge (ILSVRC), in 2012. The convolution layers could be optionallyfollowed by a normalization layer and a pooling. While ReLu non-linear
Fig. 3.Hyperspectral imaging system used in this study; (a) the diagram of the HSI system; (b) data collection of strawberry fruits in the ﬁeld.34 Z. Gao et al. / Artiﬁcial Intelligence in Agriculture 4 (2020) 31 –38activation units normally have associated with all the layers. Brie ﬂy, AlexNet containsﬁve convolution layers, three fully connected layers,and with one last layer of softmax. For the convolution layers, the ﬁrst two convolution layers (Conv1 and Conv2) are followed by a normaliza-tion and a pooling layer, respectively. While the ﬁfth convolution layer (Conv5) is followed by only one pooling layer. The ﬁnal fully connected layer (fc8) has two outputs, i.e. the number of classes (early ripe andripe), in the pretrained AlexNet in this study. Then, the softmax layernormalizes the input which obtained from layer (fc8), producing a dis-tribution of values across the two classes. Such values could be used forevaluating the performance of the network, with each input imagerepresenting one of the corresponding classes ( Szegedy et al., 2016; Mohanty et al., 2016).Fig. 4illustrates the trained CNN afterﬁne-tuning and training for the early ripe and ripe strawberry classiﬁcation. The input data were im- ages in 227 × 227 × 3. In theﬁrst convolution layer (Conv1 layer), thenetwork used 96 convolution kernels in size of 11 × 11 of each to extractthe image features using GPU. The rectiﬁed linear units (ReLu) activa- tion function was used to compress the results if convolution intorange of (0, +∞). The pool layer could reduce the spatial informationand parameters to integrate features and avoid over ﬁtting of the net. The dropout layer from the original layer AlexNet was not taken intoconsideration since the image dataset was relatively small.4. Results and discussion4.1. Spectral analysisThe average spectra of the early ripe and ripe strawberry fruits im-aged inﬁeld and laboratory were shown in Fig. 5, and signiﬁcantdifferences in reﬂectance ranged from 500 to 950 nm between theearly ripe and ripe strawberry samples collected in ﬁeld (Fig. 4(a)). Whereas the value gap in reﬂectance are mainly distributed from 400to 700 nm in laboratory (Fig. 4(b)). Interestingly, between 750 and950 nm, the average spectra of early ripe and ripe strawberry samplesin laboratory only are almost overlapped, indicating the rather close re-ﬂectance values under the laboratory condition. There were some partsin common between the inﬁeld and lab average spectra. For example,reﬂectance value divergence at the he wavelength of 535 nm indicateddistinct anthocyanin contents between the early ripe and ripe straw-berry samples, while that at wavelength of 675 nm was mainly causedby the chlorophyll content difference.4.2. Spectral feature selectionMassive amounts of wavebands in hyperspectral imagesexponentialize the time spent in computational analysis. The strategyof spectral feature wavelengths selection, via greatly reducing the di-mensionality while maintaining most important information from orig-inal data, could signiﬁcantly simplify the analyzing process. In thisstudy, two wavelengths were selected for strawberries from in ﬁeld (530 and 604 nm) and laboratory (528 and 715 nm), based on the crite-rion value i.e. 0.2 and 0.025 for inﬁeld, 0.067 and 0 for laboratory, re-spectively, using SFS algorithm, shown in Table 2.
Fig. 6shows the empirical distribution function (EDF) of the cumulative distribution ofcriterion values of selected wavelength based on SFS algorithm forearly ripe and ripe samples collected under in ﬁeld and laboratory condi- tions. This cumulative distribution function is a step function that jumpsup by 1/nat each of thendata points. In this study,nequaled to 2. The cumulative distribution function (CDF) value at any speci ﬁed value of
Fig. 4.Pretrained CNN architecture for classifying the early ripe and ripe strawberry images.
Fig. 5.Mean spectrum for early ripe and ripe strawberries collected in (a) ﬁeld; (b) laboratory.35 Z. Gao et al. / Artiﬁcial Intelligence in Agriculture 4 (2020) 31 –38the measured variable is the fraction of observations of the measuredvariable that are less than or equal to the speci ﬁed value. For example, the CDF value of criterion value of 530 nm for in ﬁeld strawberry was 1.0, while CDF value of criterion value of 604 nm was 0.5. Such CDFvalues indicated that the 530 nm had stronger discrimination powerthan 604 nm. Similarly, for laboratory strawberry samples, the 528 nmhad stronger discrimination power than 715 nm.To evaluate the reliability of selected feature wavelengths, the SVMclassiﬁer was applied to build models for demonstrating the resultingclassiﬁcations, with training dataset as the input for both laboratoryand inﬁeld datasets. Test dataset was used for validating the perfor-mance of the training models for laboratory and in ﬁeld, respectively. Table 2andFig. 7showed the ROC value of each training and test datasetfor respective laboratory and inﬁeld based on the selected spectral fea-ture wavelengths. Since the ROC curve for training and test datasetsachieved great results with ROC values reaching to 1 under laboratorycondition, so the curves were overlapped shown in Fig. 7(b). These re- sults revealed the possibilities of applying the hyperspectral imager toestimate the ripeness of strawberries inﬁeld. Meanwhile, the selected spectral feature wavelengths could provide support for building onecustomized multispectral module for estimating the strawberriesripeness.4.3. Spatial feature extraction and classi ﬁcationThe spatial features between the early ripe and ripe strawberries fa-vored in terms of signiﬁcant difference, thereby, was employed alongwith selected feature wavelengths above for classi ﬁcations. Meanwhile, the selected feature wavelength of 530 nm from in ﬁeld samples is adja- cent to the wavelength of 528 nm which was selected from the labora-tory samples. Thus, the grayscale images of the 530 nm were extractedfrom the laboratory samples, to validate the transferability of the featurewavelength of 530 nm from inﬁeld to laboratory condition. Further, thehyperspectral images containing 256 wavebands could be compressedinto few principal components (PCs) images based on principal compo-nent analysis (PCA). Each PC is a linear sum of the original HSI image atindividual waveband multiplies by the corresponding weighing coef ﬁ- cients. In this study, theﬁrst three PCs images were extracted from lab-oratory samples to reveal the main features of strawberry samples(Fig. 8).Overall, 60 images extracted from feature wavelength (530 nm) and180 images were extracted from theﬁrst three PCs using PCA for early rip strawberry. Similarly, 60 images extracted from feature wavelength(530 nm) and 180 images were extracted from the ﬁrst three PCs using PCA for ripe strawberries. Together, 240 images were obtained forTable 2Spectral feature wavelengths selected using SFS and the SVM models based on the se-lected feature wavelengths.Image scale Feature wavelength (nm) SVM ROC valueTraining TestInﬁeld 530,604 0.99 0.98Laboratory 528,715 1.00 1.00
Fig. 6.Empirical distribution function (EDF) of the cumulative distribution of criterion values of selected wavelength based on SFS algorithm for early ri pe and ripe samples collected under (a) inﬁeld; (b) laboratory conditions.
Fig. 7.ROC curves for SVM classiﬁcation between the early ripe and ripe strawberry samples collected using hyperspectral imaging system under (a) ﬁeld; and (b) laboratory condition.36 Z. Gao et al. / Artiﬁcial Intelligence in Agriculture 4 (2020) 31 –38respective early ripe and ripe strawberry samples, summing of 480 im-
ages. These grayscale images were resized as 227 × 227 pixels for each
image and used as input for the CNN classi ﬁcation architecture. At a
ratio of 70:30, all input images were split for training dataset (336)
and validating dataset (144), respectively.
The reliability evaluation was performed with the result shown in
Fig. 8 (a), both the accuracy and loss eventually included. In the respect
of training accuracy, indicated by blue curve, there was a sharp/growth
at epoch 2, with value of 100%. In contrast, there was a steep decline at
epoch 2 with its loss value has fallen to around 0.0 as shown by the or-
ange curve. For testing the performance of the trained model, validating
dataset images were as input for predicting the strawberry samples
classes (early ripe or ripe). Fig. 9 (b) showed the confusion matrix results
performance from the trained model based on the test images, of which
the overall accuracy was 98.6%.
In summary, results from this study ﬁrstly validated the divergency
in average spectral wavelengths. Based on that, feature wavelengths
were selected from images to overcome the redundant imaging data
problem, and employed in spatial feature analysis, of which the accu-
racy was demonstrated 98.6% based on validate dataset. It indicated
that the ripeness of strawberry between the early ripe and ripe stage
in the ﬁeld is distinguishable using the hyperspectral imagery according
to conventional standard. While there are still some limitations that
need to be addressed in this study. First, the strawberry fruits hidden
under the leaves cannot be identi ﬁed by the hyperspectral imagery.Second, the accuracy of the spectral and spatial features may need fur-
ther improvement to make this technique more practical for typical in-
ﬁeld application. Meanwhile, analyzing the in ﬁeld hyperspectral images
still has dif ﬁculties, we believe that a larger dataset for sample prepara-
tion and effective sample preprocessing before analysis will help esti-
mate the ripeness, which also will be part of our future work.
5. Conclusion
In this study, a portable hyperspectral imagery was used to estimate
the ripeness of strawberry in ﬁeld and laboratory, with images collected
from samples at early ripe and ripe stages. Spectral feature wavelengths
were selected using forward SFS algorithm. Two wavelengths were se-
lected for respective in ﬁeld (530 and 604 nm) and laboratory (528
and 715 nm) conditions. The SVM classi ﬁcation models were
established based on the selected feature wavelengths, which obtained
good results with ROC values higher than 0.95 in test dataset for both
ﬁeld and laboratory conditions. Since 530 nm and 528 nm was adjacent
wavelengths, the wavelength of 530 nm from in ﬁeld condition was con-
sidered as important wavelength to extract spatial feature images for
laboratory samples. Meanwhile, the ﬁrst three PCs images were ex-
tracted from laboratory samples based on PCA method. Further,
pretrained AlexNet CNN was applied to detect deep spatial features
based on the spatial images for classifying the early ripe and ripe sam-
ples in laboratory, with the prediction accuracy of 98.6% based on test
Fig. 8. Spatial feature images at feature wavelength of 530 nm and ﬁrst three PCs images for early ripe and ripe strawberries collected in laboratory for (a) early ripe and (b) ripe strawberry
samples.
Fig. 9. The training progress and test performance of the trained model. (a) Accuracy and loss values in the training process and (b) confusion matrix of test d ataset images.37 Z. Gao et al. / Arti ﬁcial Intelligence in Agriculture 4 (2020) 31 –38dataset. The results of this study indicated the potential of using porta-ble HSI system to estimate the strawberry ripeness real-timely, whichcould provide support for precision strawberry harvesting in ﬁeld. While analyzing the inﬁeld hyperspectral images is still challenging,we believe that a larger dataset for sample preparation and effectivesample preprocessing before analysis will help estimate the ripeness.In future study, more samples images will be collected with wider var-iations of external and internal quality of strawberry fruits at differentripeness stage.CRediT authorship contribution statementZongmei Gao:Formal analysis, Writing - original draft. Yuanyuan Shao:Conceptualization, Methodology, Writing - review & editing.Guantao Xuan:Investigation, Supervision.Yongxian Wang:Data curation, Validation.Yi Liu:Data curation.Xiang Han:Data curation.AcknowledgementsThis research was supported by National Natural Science Foundationof China (Nos. 31701325, 31671632). This work was also funded byChina Scholarship Council (No. 201709135004), Post-doctor Fund ofJiangsu Province. Zongmei Gao would like to acknowledge China Schol-arship Council for supporting her study at Washington State University.The team acknowledges help of Tai'an Xinlv farm in completion of thisstudy experiments.References
Bargoti, S., Underwood, J.P., 2017. Image segmentation for fruit detection and yield esti- mation in apple orchards. J. Field Robot. 34 (6), 1039 –1060. FAOSTAT, 2017.http://www.fao.org/faostat/en/#data/QC/visualize . Fauvel, M., Chanussot, J., Benediktsson, J.A., Sveinsson, J.R., 2007. Spectral and spatial clas- siﬁcation of hyperspectral data using SVMs and morphological pro ﬁles. 2007 IEEE In- ternational Geoscience and Remote Sensing Symposium. IEEE, pp. 4834 –4837 July, 2007.Ferentinos, K.P., 2018.Deep learning models for plant disease detection and diagnosis.Comput. Electron. Agric. 145, 311 –318. Gao, Z., Zhao, Y., Khot, L.R., Hoheisel, G.-A., Zhang, Q., 2019. Optical sensing for early spring freeze related blueberry bud damage detection: hyperspectral imaging for salientspectral wavelengths identiﬁcation. Comput. Electron. Agric. 167, 105025. Ge, Y., Xiong, Y., From, P.J., 2019. Instance segmentation and localization of strawberries infarm conditions for automatic fruit harvesting. IFAC-PapersOnLine 52 (30), 294 –299. Geetharamani, G., Pandian, A., 2019. Identiﬁcation of plant leaf diseases using a nine-layer deep convolutional neural network. Comput. Electr. Eng. 76, 323 –338. González-Cabrera, M., Domínguez-Vidal, A., Ayora-Cañada, M.J., 2018. Hyperspectral FTIR imaging of olive fruit for understanding ripening processes. Postharvest Biol. Technol.145, 74–82.Gunness, P., Kravchuk, O., Nottingham, S.M., D ’Arcy, B.R., Gidley, M.J., 2009.Sensory anal- ysis of individual strawberry fruit and comparison with instrumental analysis. Post-harvest Biol. Technol. 52 (2), 164 –172. Guo, L., Boukir, S., Chehata, N., 2010. Support vectors selection for supervised learning using an ensemble approach. 2010 20th International Conference on Pattern Recog-nition. IEEE, pp. 37–40.Halstead, M., McCool, C., Denman, S., Perez, T., Fookes, C., 2018. Fruit quantity and ripe- ness estimation using a robotic vision system. IEEE Robot. Autom. Lett. 3 (4),2995–3002.Hossain, M.S., Al-Hammadi, M., Muhammad, G., 2018. Automatic fruit classiﬁcation using deep learning for industrial applications. IEEE T. Ind. Inform. 15 (2), 1027 –1034. Hu, C., Liu, X., Pan, Z., Li, P., 2019. Automatic detection of single ripe tomato on plant com-bining faster R-CNN and intuitionistic fuzzy set. IEEE Access 7, 154683 –154696. Ibrahim, Z., Sabri, N., Isa, D., 2018. Palm oil fresh fruit bunch ripeness grading recognitionusing convolutional neural network. J. Telecomm. Electron. Comput. Eng. 10 (3 –2), 109–113.Kamilaris, A., Prenafeta-Boldú, F.X., 2018. Deep learning in agriculture: a survey. Comput. Electron. Agric. 147, 70–90.Krizhevsky, A., Sutskever, I., Hinton, G.E., 2012. Imagenet classiﬁcation with deep convolutional neural networks. Advances in Neural Information Processing Systems,pp. 1097–1105.Le, T.T., Lin, C.Y., 2019.
Deep learning for noninvasive classi ﬁcation of clustered horticul- tural crops–a case for banana fruit tiers. Postharvest Biol. Technol. 156, 110922.LeCun, Y., Bengio, Y., Hinton, G., 2015. Deep learning. Nature 521 (7553), 436 –444.Liu, X., Zhao, D., Jia, W., Ji, W., Ruan, C., Sun, Y., 2019. Cucumber fruits detection in green- houses based on instance segmentation. IEEE Access 7, 139635 –139642. Mohanty, S.P., Hughes, D.P., Salathé, M., 2016. Using deep learning for image-based plant disease detection. Front. Plant Sci. 7, 1419.Mohtar, I.A., Ramli, N.S.S., Ahmad, Z., 2019, September. Automatic classiﬁcation of Mango- steen ripening stages using deep learning. 2019 1st International Conference on Arti-ﬁcial Intelligence and Data Sciences (AiDAS). IEEE, pp. 44 –47. Munera, S., Besada, C., Aleixos, N., Talens, P., Salvador, A., Sun, D.W., ... Blasco, J., 2017.Non-destructive assessment of the internal quality of intact persimmon using colourand VIS/NIR hyperspectral imaging. LWT 77, 241 –248. Munera, S., Amigo, J.M., Blasco, J., Cubero, S., Talens, P., Aleixos, N., 2017b. Ripeness mon- itoring of two cultivars of nectarine using VIS-NIR hyperspectral re ﬂectance imaging. J. Food Eng. 214, 29–39.Nicolaï, B.M., Beullens, K., Bobelyn, E., Peirs, A., Saeys, W., Theron, K.I., Lammertyn, J., 2007.Nondestructive measurement of fruit and vegetable quality by means of NIR spec-troscopy: a review. Postharvest Biol. Technol. 46 (2), 99 –118. Pu, Y.-Y., Sun, D.-W., Buccheri, M., Grassi, M., Cattaneo, T.M.P., Gowen, A., 2019. Ripeness classiﬁcation of Bananito fruit (Musa acuminata, AA): a comparison study of visible spectroscopy and hyperspectral imaging. Food Anal. Methods 1 –12. Rahnemoonfar, M., Sheppard, C., 2017. Deep count: fruit counting based on deep simu- lated learning. Sensors 17 (4), 905.Rajkumar, P., Wang, N., EImasry, G., Raghavan, G.S.V., Gariepy, Y., 2012. Studies on banana fruit quality and maturity stages using hyperspectral imaging. J. Food Eng. 108 (1),194–200.Rico, D., Martín-Diana, A.B., Barat, J.M., Barry-Ryan, C., 2007. E x t e n d i n ga n dm e a s u r i n gt h e quality of fresh-cut fruit and vegetables: a review. Trends Food Sci. Technol. 18 (7),373–386.Sa, I., Ge, Z., Dayoub, F., Upcroft, B., Perez, T., McCool, C., ... McCool, C., 2016. DeepFruits: A Fruit Detection System Using Deep Neural Networks. Sensors 16 (8), 1222.Schmidhuber, J., 2015.Deep learning in neural networks: an overview. Neural Netw. 61,85–117.Shao, Y., Xuan, G., Hu, Z., Gao, Z., Liu, L., 2019. Determination of the bruise degree for cherry using Vis-NIR reﬂection spectroscopy coupled with multivariate analysis.PLoS One 14 (9).Steinbrener, J., Posch, K., Leitner, R., 2019. Hyperspectral fruit and vegetable classi ﬁcation using convolutional neural networks. Comput. Electron. Agric. 162, 364 –372. Szegedy, C., Vanhoucke, V., Ioffe, S., Shlens, J., Wojna, Z., 2016. Rethinking the inception architecture for computer vision. Proceedings of the IEEE Conference on ComputerVision and Pattern Recognition, pp. 2818 –2826. Tian, Y., Yang, G., Wang, Z., Wang, H., Li, E., Liang, Z., 2019. Apple detection during differ- ent growth stages in orchards using the improved YOLO-V3 model. Comput. Electron.Agric. 157, 417–426.Toon, O.P., Zakaria, M.A., Nasir, A.F.A., Majeed, A.P.A., Tan, C.Y., Ng, L.C.Y., 2019. Autono- mous tomato harvesting robotic system in greenhouses: deep learning classi ﬁcation. Mekatronika 1 (1), 80–86.Wang, Z., Walsh, K., Koirala, A., 2019. Mango fruit load estimation using a video based MangoYOLO—Kalmanﬁlter—Hungarian algorithm method. Sensors 19 (12), 2742. Wei, X., Liu, F., Qiu, Z., Shao, Y., He, Y., 2014. Ripeness classiﬁcation of astringent persim- mon using hyperspectral imaging technique. Food Bioprocess Technol. 7 (5),1371–1380.Wu, D., Sun, D.-W., 2013.Advanced applications of hyperspectral imaging technology forfood quality and safety analysis and assessment: a review —part I: fundamentals. Innov. Food Sci. Emerg. Technol. 19, 1 –14. Y u ,X . ,L u ,H . ,W u ,D . ,2 0 1 8 .Development of deep learning method for predicting ﬁrmness and soluble solid content of postharvest Korla fragrant pear using Vis/NIRhyperspectral reﬂectance imaging. Postharvest Biol. Technol. 141, 39 –49. Yu, X., Wang, J., Wen, S., Yang, J., Zhang, F., 2019a. A deep learning based feature extrac- tion method on hyperspectral images for nondestructive prediction of TVB-N contentin Paciﬁcw h i t es h r i m p(Litopenaeus vannamei). Biosyst. Eng. 178, 244–255. Yu, Y., Zhang, K., Yang, L., Zhang, D., 2019b. Fruit detection for strawberry harvesting robot in non-structural environment based on Mask-RCNN. Comput. Electron. Agric. 163,104846.Zeng, X., Miao, Y., Ubaid, S., Gao, X., Zhuang, S., 2020. Detection and classiﬁcation of bruises of pears based on thermal images. Postharvest Biol. Technol. 161, 111090.Zhang, C., Guo, C., Liu, F., Kong, W., He, Y., Lou, B., 2016. Hyperspectral imaging analysis for ripeness evaluation of strawberry with support vector machine. J. Food Eng. 179,11–18.Zhang, J., He, L., Karkee, M., Zhang, Q., Zhang, X., Gao, Z., 2018a. Branch detection for apple trees trained in fruiting wall architecture using depth features and regions-convolutional neural network (R-CNN). Comput. Electron. Agric. 155, 386 –393. Zhang, L., Jia, J., Gui, G., Hao, X., Gao, W., Wang, M., 2018b. Deep learning based improved classiﬁcation system for designing tomato harvesting robot. IEEE Access 6,67940–67950.Zhang, Y., Wang, S., Ji, G., 2013. A rule-based model for bankruptcy prediction based on animproved genetic ant colony algorithm. Math. Probl. Eng. 2013, 1 –10. Zheng, Y.Y., Kong, J.L., Jin, X.B., Wang, X.Y., Su, T.L., Zuo, M., 2019. CropDeep: the crop vi- sion dataset for deep-learning-based classi ﬁcation and detection in precision agricul- ture. Sensors 19 (5), 1058.38 Z. Gao et al. / Artiﬁcial Intelligence in Agriculture 4 (2020) 31 –38