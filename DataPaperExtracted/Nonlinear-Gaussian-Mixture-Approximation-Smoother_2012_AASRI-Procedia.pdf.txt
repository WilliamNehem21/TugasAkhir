 AASRI Procedia   3  ( 2012 )  402 – 408 
2212-6716 © 2012 The Authors. Published by Elsevier B.V. Selection and/or peer review under responsibility of American Applied Science Research Institutedoi: 10.1016/j.aasri.2012.11.063 
 
2012 AASRI Conference on Modelling, Identification and Control 
Nonlinear Gaussian Mixture Approximation Smoother 
Wang Xiaoxu,a* Pan Quana, Liang Yana, Cheng Yongmeia 
aInstitute of Control and Information, School of Automation, Northwestern Polytechnical University, Xi’an, Shaanxi 710072 China 
Abstract 
This paper presents a novel Gaussian mixture approximation smoother (GMA) for estimation the nonlinear system state. The smoothing implementation is transformed into computing some Gaussian weighted integrals, which triggers the development of the new GMA-UR TSS algorithm by applying unscented transformation (UT). Simulation application demonstrates the superior performance of the proposed method.  © 2012. Published by Elsevier B.V. Selection and/or peer review under responsibility of American Applied Science Research Institute  
Keywords: Nonlinear state, smoother, Gaussian mixture approximation, unscented transformation  
1. Introduction Nonlinear state smoothing estimation has been attr acting considerable research interests (see, e,g., [1]-[3] and the references therein) because of its widespread applications in signal processing, navigation and communication. The smoothing problem involves computing the probability density function (PDF) of a sto-chastic dynamic state
kxconditioned on a sequence of noisy measurements12{,,, , }Nk Nz zz z z . The gen- eral optimal fixed-interval smoothing scheme in conjunction with the Bayesian rule [4], is given by the func-tional recursive relations for computation of the PDFs
(|)kNpxz from +1(| )kNpxz for all {0 1, , }kN . For the nonlinear system, the exact description of such posterior smoothing PDFs by way of the Bayesian recur- sive equations is unavailable and intractable since the Bayesian solution requires the propagation of full prob-ability density which results in the computation intensive in numerical implementation [5]. Approximations 
 
 
* Corresponding author. Tel.: +86 029-88431306; fax: +86 029-88431306. E-mail address: woyaofly1982@163.com. 
Available online at www.sciencedirect.com
© 2012 The Authors. Published by Elsevier B.V. Selection and/or peer review under responsibility of American Applied Science Research Institute Open access under CC BY-NC-ND license.
Open access under CC BY-NC-ND license.403  Wang Xiaoxu et al.  /  AASRI Procedia   3  ( 2012 )  402 – 408 
are thus necessary, and the Gaussian approximation (GA) to such PDFs is widely accepted by the fact that the correspondingly derived GA smoother is always cost-effective with acceptable accuracy desirable in practical applications. So far, a large number of GA smoother have been proposed for smoothing the nonlinear state from a reentry tracking problem [1]-[2], including the extended Kalman smoother (EKS) based on the first-order linearization, the unscented Rauch–Tung–Striebel smoother (URTSS) based on the unscented transfor- mation (UT) , the quadrature Kalman smoother (QKS) based on the quadrature rule, the central difference Kalman smoother (CDKS) based on the polynomial inter polation and the cubature Klaman smoother (CKS) based on the cubature rule.     In general, the above-mentioned GA smoothers approximate the state PDF using a single Gaussian, such that they are only suitable for the case that the state PDF is the gaussian ity or unimodality, and that the system model is at most weakly nonlinear. However, a state which is initially Gaussian w ill inevitably become sig- nificantly non-Gaussian if propagated over a sufficiently long time span. In this situation, although the single GA smoother is better than the corresponding GA filter, it still inevitably results in inaccurate state estimate. Consequently, a Gaussian mixture approximation (GMA) to  the smoothing PDF is more appropriate than the GA as a result that: 1) it can effectively approximate any PDF as closely as desired (in the
1L norm) [6] by using a weighted sum of Gaussian densities, and 2) it enables a more accurate representation of the nonlineari-ties in the dynamics and measurement models. Therefore, there is a great demand to develop the correspond-ing GMA smoother for nonlinear system in a reentry tracking problem. Up to the present, an explicit and sys-tematic solution to the derivation of the GMA smoother has been seldom reported. Here, motivated by the fact that the GMA is more accurate than the GA, we present the GMA smoother for the ballistic reentry tracking problem. The rest of the paper is organized as follows. Section II formulates the investigated problem and recalls the standard GA f ilter and smoother. Section III derives the GMA smoother on the basis of the standard GA estimators. Section IV  gives the simulation application for the reentry track- ing problem. Some conclusions are drawn in section V. 2. Problem Formulation and Standard GA Estimator We consider the following discrete-time nonlinear stoc hastic system for generally describing the problem of tracking a ballistic target on reentry  
1 ()kk k kxf x w (1)
()kk k kzhx v (2) where
nkx is the state vector,mkz is the measurement vector, ()kf and ()kh are known nonlinear functions,
nkw andmkv are uncorrelated zero-mean Gaussian white noises satisfyingT[]kl k k lww Q  and
T[]kl kk lvv R  whereklis the Kronecker delta function, and the initial state is assumed to be Gaussian distribution with mean
0|0ˆxand covariance0|0P, which is independent of kwandkv. Our aim is to design the GMA smoother for the system in (1)-(2). In other words, we need to find the Gaus-sian mixture approximation to the smoothing PDFs
GMA(| )kN pxZ for all {0,k  1,2, , } N, where 
1 {}NNi iZz . Then, the smoothing estimation and the associated covariance in the GMA form can be ob-tained by computing the first two moments of
GMA(|)kN pxY .  In [6], Ito and Xiong presented a general GA filter, whose implementation can be separated into two steps including the state prediction and correction. Afterwards , [2] and [3] provided the GA smoother, which is implemented as follows. 404   Wang Xiaoxu et al.  /  AASRI Procedia   3  ( 2012 )  402 – 408 
1 || 1 | 1 | , 1 | 1 | T || 1 | 1 | ˆˆ ˆ ˆ[] ,   ,[] ,kN kk k k N k k k kk k k kkN kk k k N k k kxx A x x A P P  PP A P P A                                           (3) 
TT,1 | | || 1 | ˆˆ ˆ=( ) ( ; , )kk k k k k k kk kk k k k k k d P xf x x x P x x x N .                                              (4) In general, the GA smoother in (3) is a forward-backward smoother [3]. As seen from Fig. 1, in the forward pass, the GA smoother uses the GA filter to compute the filtering density up to
(|)NNpxZ . In the backward pass, it implements (3) for rolling backwards from
GA 1(| )NN pxZ toGA 0(| )N pxZ . Through initialization of
GA | |ˆ(|) ( ; , )NN N N N N N p xY xx P N , the GA smoother recursively operates by joint the analytical compu-tation in (3) and the Gaussian weighted integrals in (4). 
 
Fig. 1 The forward and backward passes in the GA smoother 
The heart of implementing the GA smoother is how to co mpute the nonlinear Gaussian weighted integrals in (4). However, for the nonlinearity of
()kf and ()kh , the GA smoother is only formal in the sense that it rarely can be directly used in practice since the model no nlinearity causes the intractability and infeasibility of analytically computing such integrals. For this reas on, some numerical methods are required for approximat- ing such integrals, e.g., the linearization and the corr esponding GA smoother is the existing GA-EKS in [2]. At the same time, as a result of the better precision of unscented transformation (UT) than the linearization, we can also develop the existing GA-URTSS in [2 ] by using UT for computing such integrals.  3. Problem Formulation and Standard GA Estimator For the derivation of GMA smoother, a standard resu lt about Gaussian functions in [7] is recalled. Lemma 1. Given
F,d,Q,mandPof appropriate dimensions, and that QandPare positive definition, it can be obtained that 
T(, + , ) (, , ) d = (, + , )xF dQ mP xF m dQ + F P FNNN .                               (5) Firstly, we have to find the GMA filter.  Step 1: The GMA filter. According to [6], given the Gaussian sum approximation  
GMA GA | | 11ˆ(|) (|) ( ; , )MMii i i ikk k kk k k k k k kiipp xZ xZ x x PN ,
11Miki,                       (6) the GMA filtering PDF can be obtained as follows 
GMA 1 1 1 GA 1 11(|) (| )Miikk k kkipp xZxZ11 1 | 1 1 | 11ˆ(; , )Mii ik k kk kkixx PN ,                    (7) where each filter is independent of the others and can be performed in a parallel manner, and the weights
1ik 405  Wang Xiaoxu et al.  /  AASRI Procedia   3  ( 2012 )  402 – 408 
are updated and normalized by learning from Eqs. (5.1)-(5.2) in [6] 
,11 | 1 |1 ,11 | 1 |1 ˆ(; , )ˆ(; , )ii zzi k k kk kkikMii zzi kk k k k kizz Pzz PNN,                                                              (8) Hence, the GMA filtering estimate and the correspondi ng covariance are obtained by computing the first two moments of the PDF in (7)     Step 2: The GMA smoother. The PDF
GMA1(, )kk k p x| x z can be expressed by the GMA method, i.e. 
GMA1GA11(, ) (, )Mii kk k k kk kipp x| x Zx| x Z|1 , |1 ,1ˆ(; , )Mii ikk k k k k k kixx PN ,                     (9) where
|1 ,ˆikk kx and|1 ,ikk kP are given in (10), and the weights ikare updated and normalized by learning from Eqs. (5.1)-(5.2) in [6] 
|1 , | 1 1 |T |1 , |1 |ˆˆ ˆ() ,=,ikk k kk k k k kikk k kk k k k kxx A x xPP A P A                                                       (10) 
11 | 1 |11 | 1 |1ˆ(; , )ˆ(; , )ii ik k kk kkikMii ikk k k k kixx Pxx PNN.                                                        (11)     Assume that the GMA smoothing PDF at
1k has been given 
GMA 1 1 GA 11(| ) (| )LjjkN k kNjpp xZxZ11 1 | 1 |1ˆ(; , )Ljj jkk k N k Njxx PN ,111Ljkj.            (12) Then through using Lemma 1, the smoothed PDF
GMA(|)kN p xY at k can be updated from (9) and (12) 
GMA GMA11(| ) ( , | ) dkN k k Nk pp xZ x x Z xGMA 1 GMA 11(| ) ( |, ) dkN k k k k pp xZ x x Z x  
T 1| 1 | 1| | 1 | 1| 11 ˆˆ ˆ{; [ ] , [ ] ( ) }MLiji i j i i i j i ikk k k k k k N k k k k k k N k k kijxx A x x P A P P AN    
GA | | 11ˆ(| ) ( ; , )ML MLss s s s kk N k k k N k Nssp xZ x x PN .                                                  (13) Hence, the GMA smoothing estimate and the corresp onding covariance are obtained by computing the first two moments of the PDF in (13) Note that as shown in (3), the GA smoother starts from the initial density
GA(|)NN p xY . Similarly, the GA smoother is the foundation of developing the GMA smoothe r, hence, according to (7), the GMA smoother is initialized as follows, i.e. 
GMA GA | | 11ˆ(|) (|) ( ; , )LLjj j j j NN N NN N N N N N Njjpp xYxY xx PN ,                               (14) 406   Wang Xiaoxu et al.  /  AASRI Procedia   3  ( 2012 )  402 – 408 
where 1ij L M and =j iNN.  In addition, the number of the GA terms in (13) grows exponentially, due to the fact that the posterior PDFs in (9) and (12) have a Gaussian mixture form. Therefore, in order to decrease the computational complexity, it is necessary to reduce the number of the GA terms. One simplest way of mixture reduction is to retain only a few Gaussians with highest weights, where, if
{, 1 ,, }jkj Lare the Lhighest weights all of {,s
k 
1, , }s ML , the GMA smoother in (13) becomes 
GMA | |1ˆ(| ) ( ; , )Ljj jk Nk k kN kNjp xZ x x PN ,
1j
jkkL
j
kj.                                              (15) About the other reduction ways, please see [8].  4. Simulation We describe the problem of tracking a ballistic target on reentry as the following  nonlinear dynamic model [9] 
1,1, +1 1, 2,2 2, +1 2, 2, 3,3, +1 3,,[( ) g ] ,.
kkkkxkk k kkkxxxxxe x xxx
                                                             (16) where
1xand2xare altitude and velocity, respectively;3xis a constant ballistic coefficient that depends on the target’s mass, shape, cross-sectional area and air density; 
g is gravity (2g=9.81m/s ) and the constant 
4=5 10 . For the model problem at hand, a radar is located at (0, H) and equipped to measure the range z at a sam- pling time interval of T. Hence, the measurement equation is given by 
221,=+ ( ) +kk kzM xH v ,                                                                    (17) where the measurement noise
(0, )kkvRN , and M is the horizontal distance. Here, we select the accumulative root mean square error (ARMSE) for comparing the GA and GMA smoothing performance. For the GMA in (7) and (15), the number of the GA terms is
50ML.in UT is chosen as 0. Each trajectory was simulated for 100s and a total of
=1000N .The experimental data is that 
=1.2kmH , =6kmM ,2=(20m)R , =0.5s , the initial true state4 0=[50km,2010m/s,7 10 ]x  and in si- mulation, the initial state estimation 
4 0|0 ˆ=[50km,2010m/s,10 ]x and covariance65 40|0=diag[10 ,10 ,10 ]P . The ARMSE results of altitude and velocity are sh own in Fig. 3 and Fig. 4, respectively.  407  Wang Xiaoxu et al.  /  AASRI Procedia   3  ( 2012 )  402 – 408 
0 10 20 30 40 50 60 70 80 90 10002468101214161820
Time / sARMSE of Altitude
  GA-EKS
GMA-EKS
GA-URTSS
GMA-URTSS
  0 10 20 30 40 50 60 70 80 90 10001234567
Time / s  ARMSE of VelocityGA-EKS
GA-URTSS
GMA-EKS
GMA-URTSS
 
Fig. 2 ARMSE of altitude                                            Fig. 3 ARMSE of velocity 
    In estimation accuracy, the proposed GMA-URTSS and GMA-EKS algorithms outperform the existing GA-URTSS and GA-EKS in [2], respectively. Moreover, expect for some time steps, the ARMSE of the GMA-URTSS is less than that of the GMA-EKS since the UT technique is superior to the first-order lineariza- tion in approximating the posterior mean and covariance of the nonlinear state. Fig. 2 and Fig. 3 make us be-lieve that the GMA smoother performs significantly bette r than the corresponding GA smoother in estimation precision. 5. Conclusion Motivated by the fact that the GMA is more accurate than the GA, based on the existing standard GA filter and smoother, we propose a general GMA smoother for es timating the nonlinear state from racking a ballistic 
target on reentry. Furthermore, the new GMA-URTSS al gorithm is developed by using UT for numerically 
computing the Gaussian weighted integrals in GMA sm oother. The simulations show that the proposed GMA- URTSS outperforms the corresponding GA-URSS by its superior estimation accuracy. Acknowledgements   The work is supported in part by the National Natural Science Foundation of China (61203234, 61135001, 61074179, 61075029 and 61074155), the Postdoctoral Science Foundation of China (20110491692). References [1] I. Arasaratnam  and S. Haykin, “Cubature Kalman smoother,” Automatica , 2011, 47(10): 2245-2250. [2] S. Särkkä, “Unscented Rauch-Tung-Striebel smoother,” IEEE Transactions on Automatic Control, 2008, 53(3), 845-849. [3] S. Särkkä and J. Hartikainen, “On Gaussian optimal smoothing of nonlinear state space models,” IEEE Transactions on Automatic Control, 2010, 55(8), 1938-1941. [4] H. E. Rauch, F. Tung, and C. T. Striebel, “Maximum likelihood estimates of linear dynamic systems,” AIAA Journal, 1965, 8(3), 1445–1450. [5] X. X. Wang, Y. Liang, Q. Pan, and F. Yang, “A Gaussian approximation recursive filter for nonlinear systems with correlated noises,” Automatica, 2012, doi:10.1016/j.automatica.2012.06.035. [6] K. Ito and K. Xiong, “Gaussian filters for nonlinear filtering problems,” IEEE Transactions on Automatic Control, 2000, 45(5): 910-927. 408   Wang Xiaoxu et al.  /  AASRI Procedia   3  ( 2012 )  402 – 408 
[7] B. N. Vo and W. K. Ma, “The Gaussian mixture probability hypothesis density filter,” IEEE Transactions on Signal Processing, 2006, 54(11): 1-13. [8] I. Arasaratnam and  S. Haykin, “discrete-time nonlinear filtering algorithms using Gauss-Hermite quadra-ture,” Proceedings of the IEEE, 2007, 95(5): 953-977. [9] B. Ristic, S. Arulampalam, and N. Gordon, Beyond the kalman filter. MA: Artech House, 2004. 