 AASRI Procedia   9  ( 2014 )  146 â€“ 151 Available online at www.sciencedirect.com
2212-6716 Â© 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).Peer-review under responsibility of Scientific Committee of American Applied Science Research Institutedoi: 10.1016/j.aasri.2014.09.023 
ScienceDirect
2014 AASRI Conference on Circuit and Signal Processing (CSP 2014) 
Simple Model Based Dead Time Compensation Using Fast Current Measurement 
Andras Futoa, Istvan Varjasia 
aBudapest University of Technology and Economics, MÄ¦egyetem rkp. 3, Budapest 1111, Hungary  
Abstract 
Nowadays the increasing utilization of alternative energy sources demand three phase power converters capable of delivering high quality energy to the low voltage grid. Good dead time compensation hardware and software are essential to keep low order harmonics at acceptable levels even at light load conditions, at acceptable costs. Low current waveforms with multiple zero crossings within a switching period are still problematic with today's technology. Such operating conditions often happen in PWM inverters and in variable frequency drives at or below 10% load. This paper describes a new method which uses a model for calculating the voltage error caused by dead time for each phase leg. The method is completely software based, but requires fast current measurement. A model splits each half period of the triangular carrier to time segments where the slopes of the currents in all phases, and the output voltage of all semiconductor phase legs are constant. It determines the duration of each of the time segments, and integrates the volt-seconds for a half period of the triangular carrier. The model is capable of handling discontinuous conduction as well. The resulting error voltage can be used to calculate a new, compensated duty factor which can be applied to the PWM modulator. The described algorithm was tested via computer simulation. A comparison was made with other, previous methods using the same inverter model. 
 Â© 2014 Andras Futo, Istvan Varjasi. Published by Elsevier B.V. Selection and/or peer 
review under responsibility of American Applied Science Research Institute  
Keywords: PWM; inverter; dead time; linearization; model; volt seconds; 
1. Introduction In symmetric three phase PWM controlled voltage sourced inverters, as seen on Fig 1., the switch controller always drives both controllable switches in a phase leg to the off state for a small time interval 
Â© 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).Peer-review under responsibility of Scientific Committee of American Applied Science Research Institute147  Andras Futo and Istvan Varjasi  /  AASRI Procedia   9  ( 2014 )  146 â€“ 151 
during switch-over to avoid shoot-through. This time is always more than what is needed for the switches to turn off for safety reasons. The remaining time is  called effective dead time. It is marked with t
d in this paper. During t
d only the anti-parallel diodes can conduct the output current. This will cause an error voltage on the output which needs to be compensated for, as recognized and described in [1]. If the dead time is long enough, discontinuous conduction may also appear. The presence of effective dead time thus introduces output waveform distortion and harmonic content in the output current of inverters. The effects become more severe at increased switching frequencies. 1.1. Existing compensation methods The main circuit of a general three phase inverter with inductive load can be seen on Fig. 1. Most classical software based methods, such as the ones described in [1] [2] and [3] intervene based on the signum(I) function and thus are only capable of compensating for large positive or negative current waveforms. From this point of view, these methods share the same limitations, even if there are huge differences in the number of sensors used and in the methods of the calculation of error voltage or volt-seconds lost due to dead time. Looking at the circuit diagram on Fig. 1. it can also be understood that for continuous current waveforms having zero crossings, most of the volt-seconds lost du ring one switch - over (which happens during positive current) are gained back during the next switch-ov er (during negative output current) within the same switching period. This state of operation is taken in to account in some compensation methods, like in [4]. There are methods which try to solve the problem by using extra detection hardware for each switching element as described in [5] and [6]. These are cheap compared to fast current measurement devices and fast A/D converters, but can detect the momentary current di rection when a switch-over is initiated. This detection might be problematic for current waveforms having mu ltiple zero crossings within one switching period. 1.2. Low current problems Handling continuous current waveforms with zero cr ossings is not always possible using conventional methods; this already requires an accurate measurement or at least calculation of the inverter currents. The threshold between large positive or negative currents and nearly zero currents is defined by the current ripple. 
LLL
ua ub ucubA ubB ubC
abcABC
N
uN2UDC
2UDC++0+
-
uLAuLBuLCiCaviLC iLB iLA
iBav
iAavSAH
SALSBH
SBLSCH
SCL
 
Fig.1. Main circuit of a general three phase inverter. 148   Andras Futo and Istvan Varjasi  /  AASRI Procedia   9  ( 2014 )  146 â€“ 151 
-Udc/2ubiL
ttd
tz
ioff
tUdc/20
uout
   -Udc/2ubiL
ttd
tz
ioff
tUdc/20
uout
 
Fig.2. Discontinuous conduction during dead time, (a) with zero crossing, and (b) without zero crossing. 
The maximal current ripple can be calculated from closed formulae, as described in [11]. An attempt was made to use a new algorithm capable of calculating the actual current ripple for dead time compensation, in [12]. This way continuous currents could be handled, even if only slow current measurement is available. More problematic current waveforms can include disc ontinuous conduction, as seen on Fig. 2. The error voltages caused by these were calculated from average phase current [10]. The problem is, that the complex formulae require large amount of computing power which makes such a dead time compensator expensive. 2
. Model based compensation method The basic idea behind this paper is to incorporate an accurate model into the controller which is capable of modeling low current situations and discontinuous conduction. The inputs of such a model are the instantaneous phase currents, the phase voltages, the rela tive slope of the triangular carrier (also marked with DIR, with values of +1 or -1), and the duty factor. Th e model generates the phase currents and phase leg voltage waveforms from these inputs for a half period of the triangular carrier. For that time period it also determines the resulting volt-seconds for each phase leg. A similar approach was described in D. SchrÃ¶der's paper [8] for a thyristor based DC drive. A significant di fference is, that for a DC drive it was relatively easy to determine the desired current waveform from the re quired average output current. In a three phase PWM system this is much harder, as the three phase legs affect each other through the potential of the neutral point. Because of this, the resulting voltage and current are determined instead for a given duty factor, and the intervention is done using an approximation formula. 2.1. Operation of the model The operation of the model can be understood based on Fig. 3. The model splits each half period of the triangular carrier to time segments. Phase currents and the state of the semiconductor switches are available at the beginning of each iteration of steps 1-7; these are st ored in the status vector as on Table 1. This vector is initialized on startup with the input measurement data. All initial switch states are determined by the slope of the triangular carrier (DIR) unless the duty factor is so small (or large) that the last switch-over has not been finalized. In the latter case, the phase leg is assumed as free-wheeling (state 0). The model determines the voltages across the circuit for th e actual time segment, and then it determines the length of the actual time segment (the time period for which the previously calculated voltages remain valid). When all information is available, it determines the currents and the switch states for the next iteration. A time segment can end two ways. Either a switch-ov er happens, which can be detected based on the previously sorted switching sequence table (Table 2.), or  one phase goes discontinuous. This decision is made 149  Andras Futo and Istvan Varjasi  /  AASRI Procedia   9  ( 2014 )  146 â€“ 151 
in step 5. If a switch-over happens, then the new switching state is loaded, and the switching sequence table is stepped one row further (i.e. the first row is removed). 
Table 1. The status vector time 
bridge voltages neutral voltage inductor voltages switch status phase currents 
tk u bR u bS u bT u N uLR uLS uLT SRSSSTIR IS IT 
Table 2. The switching sequence table time phase state
tsR R0
tsR + td R- D I R
tsS S0
tsS + td S- D I R
tsT T0
tsT + td T- D I R
T/2 don't care don't care
 
START
STOPDIR == 1 ? YES /2StD T Â˜ (1 ) / 2StD T  Â˜ NO
Initialize switching sequence tableSort switching sequence tableInitialize status variable
Is the switching sequence table empty?
STEP 2.     Calculate neutral point voltageSTEP 1.  Determine bridge voltage from switch status for continuous conduction statesNO
Is I==0 for a phase ?NO YES123
3B BBNuu uu 123
2B BpNuuuu 
STEP 3. Calculate inductor voltages for all continuous phases: .L BpN uuuu 
STEP 4. Determine bridge voltage for the discontinuous phase:B Np uuu 
STEP 5.         Determine next time point      .
For all free-wheeling phases calculate :                    , keep the minimal value  dt discpLILdtuÂ˜ 
dtdisc <  dt SW ?Calculate dt SW = t next-tact(tnext and t act comes from switching sequence table)
Interval length: dt = dt disc
Next time point = t act + dt disc
No change in switch statusInterval length: dt = dt SW, next time point = t act + dt SW
Load next status from switching sequence tableremove first elementfrom  switching sequence tableYES NO
STEP 6.  Calculate next currents /next act LpII U d t L Â˜
STEP 7.  Collect volt seconds for bridge outputsYESOutput: Volt seconds / (T/2)
 
Fig.3. Simplified flowchart of the model which determines the output voltage 150   Andras Futo and Istvan Varjasi  /  AASRI Procedia   9  ( 2014 )  146 â€“ 151 
modelD*
slope of carrier
I_inst
U_phub_av/Udc (D*-1 ) *Udcub_ideal
u_errD*dDDD
 
Fig.4. Block diagram of the model based dead time compensator 
The iterations are continued until the last element is cleared from the switching sequence table. A dummy element (T/2) is also added to the table, as seen on Table 2. to make sure that the output contains all volt- seconds for the corresponding half switching period. Du ring initialization, it is made sure that this dummy element is the last in the list (i.e. all time values are smaller). 2.2. Using the model for dead time compensation The model described in the previous section requires the following constants: switching frequency, circuit parameters, dc bus voltage, and the value of the effective dead time. The input variables are the phase voltages, the instantaneous phase currents, and the ideal duty factors  (D*) which are the outputs of the current controller, and are valid for a linear (ideal) inverter. The model is run twice in every switching period: once at the upper corner of the triangular carrier, and once at the lower corner. The compensator uses the output of the model to calculate a new duty factor, which - if applied on the inputs of the PWM generator - will result in approximately the same output voltage on the real inverter, as D* would on an ideal one. The bock diagram of this compensator can be seen on Fig. 4. It can be seen, that this method can only result in an estimation even if the m odel is correct, as the method on Fig. 4. gives accurate results only for the continuous cases; for discontinuous conduction this is only an approximation. 3. Simulation results To be able to test the method, the algorithms of Fig. 3. and Fig 4. have been implemented in Matlab Simulink. It was integrated into a test system which simulates the inverter seen on Fig. 1. The controller used in the simulation uses Park transformation and PI controllers for D and Q currents. A symmetrical / space vector modulator was also used. The simulation was run with settings for 400V 50Hz three phase grid connected operation. T
he component values were calculated for 50A nominal peak output phase current, using an inductor of 5% nominal load impedance. In the simula tion, the carrier frequency was fixed at 8kHz and the effective dead time was 3Î¼s. Fig. 4. shows the resulting THD values at various active (wattful) loads. The THD values were calculated for the first 40 harmonics.  A linear interpolation based dead time compensator on Fig. 5a. has also been used for reference using the current ripple formula from [11]. From the results on Fig. 5a. it can be seen that the new method is generally better than the linear interpolation based method if the load is at least 7%. Inaccuracies at very low loads can come from the direct calculation in the compensator on Fig. 4. Further plans are being considered to avoid this drawback, and give good THD values down to 1% load. 151  Andras Futo and Istvan Varjasi  /  AASRI Procedia   9  ( 2014 )  146 â€“ 151 
0,0010,010,11 110100THD (no compensation)
THD (linear interpolation)
THD (new  method)X axis: percent of nominal load
Y axis: TH D
 00Error voltage
Output currentSignum(I)
Linear interpolation
-IthrIthr
 
Fig.5. (a) simulation results: THD from di fferent compensation methods, LOG-LOG scale. (b) Linear interpolation method as refer ence 
Acknowledgements This work was partially supported by the Hungarian Government, managed by the National Development Agency, and financed by the Research and Technology In novation Fund through project eAutoTech (grant no.: KMR 12-1-2012-0188). The authors wish to thank the support to the Hungarian Research Fund (OTKA K100275) and the Control Research Group of the Hungarian Academy of Sciences. References [1] Seung-Gi Jeong, Min-Ho Park. The analysis and compensation of dead-time effects in PWM inverters. IEEE Transactions on Industrial Electronics; 1991, vol. 38, p. 108-14. [2] David Leggate, Russel J. Kerkman. Pulse Based Dead Time Compensator for PWM Voltage Inverters. IEEE Transactions on Industrial Electronics; 1997, vol. 44, p. 191-7. [3] Seon-Hwan Hwang, Jang-Mok Kim. Dead Time Co mpensation Method for Voltage-Fed PWM Inverter. IEEE Transactions on Energy Conversion; 2010, vol. 25, p. 1-10. [4] S. Bolognani, M. Ceschia, P. Mattavelli, A. Paccagnella, M. Zigliotto. Improved FPGA-based dead time compensation for SVM inverters. Proc. PEMD2004; p. 662-7. [5] L. Chen, F. Z. Peng. Elimination of Dead-time in PWM Controlled Inverters. Proc. APEC2007; p. 306-9. [6] Bin Zhang, Alex Q. Huang, Bin Chen. A Novel IGBT Gate Driver to Eliminate the Dead-Time Effect. Industry Applications Conference (2005); p. 913-7. [7] A. Cichowski, J. Nieznanski. Self-tuning dead- time compensation method for voltage-source inverters. IEEE Power Electronics Letters; 2005, vol. 3, p. 72-5. [8] Dierk F. SchrÃ¶der, Ralph Kennel. Model-Control PROMC-A New Control Strategy with Microcomputer for Drive Applications. IEEE Transactions on Indu stry Applications; 1985, vol. IA-21, p. 1162-7. [9] Alfredo R. Munoz, Thomas A. Lipo. On-Lin e Dead-Time Compensation Technique for Open-Loop PWM-VSI Drives. IEEE Transactions on Power Electronics; vol. 14, p. 683-9. [10] A. FutÃ³, I. Varjasi. Compensation of Discontinuo us Conduction in Three Phase PWM inverters. Proc. International Conference on Renewable Energy and Power Quality (ICREPQ'14); (accepted paper). [11] G. Grandi,  J. Loncarski. Evaluation of Current Ripple Amplitude in Three-Phase PWM Voltage Source Inverters. Proc. CPE (2013); p. 156 - 61. [12] A. FutÃ³ and I. Varjasi. Current Ripple Calculation for Dead Time Compensation in Three Phase PWM Inverters. IEEE Energycon 2014; (accepted paper) 