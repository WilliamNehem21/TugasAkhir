Mango internal defect detection based on optimal wavelength selectionmethod using NIR spectroscopy
Anitha Raghavendraa,⁎, D.S. Gurub,M a h e s hK .R a oa
aMaharaja Research Foundation, Maharaja Institute of Technology, Mysore, India
bDepartment of Studies in Computer Science, University of Mysore, Mysore, India
abstract article info
Article history:Received 8 June 2020Received in revised form 15 January 2021Accepted 16 January 2021Available online 10 February 2021
Keywords:Feature selection methodsFisher's linear discriminant analysisMango internal defect detectionNIR (near infrared spectroscopy)A non-destructive technique should be developed for performance analysis of mango fruits because the spongytissue or internal defects could lower the quality of mango fruit and incur a lack of productivity. In this study,wavelength selection methods were proposed to identify the range of wavelengths for the classi ﬁcation of defected and healthy mango fruits. Feature selection methods were adopted here to achieve a signi ﬁcant selec- tion of wavelengths. To measure the goodness of the model, the dataset was collected using the NIR (Near Infra-red) spectroscopy with wavelength ranging from 673 nm –1900 nm. The classiﬁcation was performed using Euclidean distance measure both in the original feature space and in FLD (Fisher's Linear Discriminant) trans-formed space. The experimental results showed that the lower range wavelength (673 nm –1100 nm) was the efﬁcient wavelength for the detection of internal defects in mangoes. Further to express the effectiveness ofthe model, different feature selection techniques were investigated and found that the Fisher's criterion basedtechnique appeared to be the best method for effective wavelength selection useful for classi ﬁcation of defected and healthy mango fruits. The optimal wavelengths were found in the range of 702.72 nm to 752.34 nm usingFisher's criterion with a classiﬁcation accuracy of 84.5%. This study showed that NIR system is a useful technologyfor the automatic mango fruit assessment which has the potential to be used for internal defects in online sorting,easily distinguishable by those who do not meet minimum quality requirements.© 2021 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an openaccess article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/4.0/ ).
1. IntroductionWith increasing urbanization, the needs of society are changing andhave an impact on the overall health status of the people. This has re-sulted in people leaning towards more nutritional choices such as fruitsand vegetables. India has emerged as the second-largest fruit producer(46 million tons), contributing almost 10% of the world production.India crops about 56% of the total world's mango. Markets in most ofthe countries have seen increasing demand for conventional mango va-rieties. Imports are restricted, in particular to developed countries,mainly due to their quarantine needs, lack of tools/techniques to meettheir requirements. The lack of an automated trading program focusedon non-destructive techniques to detect physiological disorders inAlphonso mango is a reason why India is still very poor in fruit export(Sandeep and Pradeep, 2014). Fruitﬂy, stone weevil, spongy tissue, etc., are the internal defects that occur in some mango varieties. Thesedefects must be identiﬁed before these mangoes are exported. Humaneyes cannot see the internal defects in mangoes and these defectivemangoes cannot be sorted manually. The internally defected mangoeshave no external symptoms either at the time of harvesting or duringripening. The affected part is visible only after slicing of the fruit(Manpreeth and Ramesh, 2010). For this reason, some countries speciﬁ- cally European countries have, until now, banned Indian mangoes. Thecausative factor for the presence of spongy tissue in the mango pulp por-tion has not been located so far, and there is no proven automation tomonitor it during the maturation/pre-harvesting period as it is now. Insuch a scenario, a quick priority is to identify physiological disorders inmangoes using a non-destructive technique for the purpose of consump-tion and export. Fruit sorting should be done on an individual basis to en-sure the quality of the product. In order to do so, an online method with ahigh sorting speed of at least 2 to 5 fruits per second should beestablished (Sang et al., 2006). Non-invasive identiﬁcation of internal de- fects in Alphonso mango is a new area and very little research has beendone to determine the internal quality of mangoes such as soluble solids,dry matter,ﬁrmness, starch and sugar content. To improve our under-standing of light penetration into fruit tissues, more research involvingnumerical simulation techniques are needed ( Bart et al., 2007). Anitha and Mahesh (2016)have discussed mangoes with all kinds ofdefects such as diseases, physiological disorders and pest-related dam-age; and reviewed non-intrusive methods used in some fruits to detectArtiﬁcial Intelligence in Agriculture 5 (2021) 43 –51
⁎Corresponding author.E-mail addresses:anithbg@gmail.com(A. Raghavendra), dsg@compsci.uni-mysore.ac.in (D.S. Guru),maheshkrao_ece@mitmysore.in (M.K. Rao).
https://doi.org/10.1016/j.aiia.2021.01.0052589-7217/© 2021 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the C C BY-NC-ND license (http:// creativecommons.org/licenses/by-nc-nd/4.0/ ).
Contents lists available atScienceDirect
Artiﬁcial Intelligence in Agriculture
journal homepage:http://www.keaipublishing.com/en/journals/artificial-intelligence-in-agriculture/internal defects. At Seoul National University in Korea, the model wasdeveloped for the detection of internal breakdowns in Fuji apples, Ko-rean pears and sweet potatoes using non-destructive technologies(Sang et al., 2006).Qiang et al. (2011)have developed a Vis/NIR hyperspectral imaging system covering the spectral region from408 nm to 1117 nm for bruise detection in kiwi fruits. Several researchstudies have been carried out since 1990 on determining certain indicesof internal quality, speciﬁcally on total soluble solid content, starch,acidity, chlorophyll (in fruits and vegetables), protein (in grains) andtotal nitrogen content (in leaves) using NIR spectroscopy as a non-destructive technique. Similar qualities have been evaluated on pota-toes, onions, peaches, apples, oranges, melons, mandarins, papaya anddates (Dospatliev et al., 2013).The increasing importance of NIR spectroscopy in post-harvest tech-nology is evident from the recent increase in the number of publica-tions, as well as from the fact that many on-line grading manufactureshave now introduced NIR systems to measure various qualities attri-butes (Bart et al., 2007).David and Carlos (1998)have used a non- destructive optical method for determining the internal quality ofKiwi fruit and the method based on NIR spectroscopic techniques.Non-destructive technology for the “on-line”assessment of the internal quality of fruits and vegetables using NIR spectroscopy is detailed insome publications which have been reviewed in ( Krivoshiev et al., 2000).Peiris et al. (1998)have successfully determined soluble solidscontent in processing tomatoes. NIR based technology has also beenused quite successfully to determine the ripeness of melons. Meurens and Feth (2001)conducted their research for the detection of variousinternal defects in apple: vitrescence, mealiness and internal discolor-ation (brown core) using Vis/NIR spectroscopy. Peirs et al. (2001) have investigated apples of 7 varieties and 3 orchards to determinethe harvest maturity using non-destructive methods. Considerableresults are obtained for measurement of maturity and detection of in-ternal defects in apples using Vis/NIR spectroscopy ( Holm, 2002). A non-destructive method has been developed for the measurement ofsoluble solids content in peaches“Blake”by NIR spectrometry (Peiris, 1997). With this knowledge, it is understood that the NIR spectroscopymay be one potentialﬁeld that can be used for internal defect tracking inmangoes thus helping with the export of the same for India.Using NIR spectroscopy, three different measurement setups can bemade for obtaining NIR spectra such as in the mode of re ﬂectance, trans- mittance and interactance. When choosing the measurement setup, it isimportant to be aware that the NIR radiation penetration into fruit tissuedecreases exponentially with the depth ( Lammertyn et al., 2000).Bart et al. (2007)found a penetration depth up to 4 mm in the wavelengthrange of 700–900 nm and between 2 mm to 3 mm in the range of900–1900 nm for apple. In a different optical con ﬁguration,Fraser et al. (2000)showed that the penetration depth was at least 25 mm in therange 700–900 nm in apple, while it became less than 1 mm in therange 1400–1600 nm. The limited penetration depth restricts the poten-tial of reﬂ
ectance or interactance measurements for detecting internaldefects and decreases the performance of NIR based measurements ofthick-skinned fruit, such as internal quality attributes of citrus. Hence,the selection of wavelength range is a very important task to providegood coverage. However, the wavelength useful for an application willoften be unique to the domain because different materials will have dif-ferent spectra. It is impossible to have a set of generic wavelengths for allthe applications (Mayank et al., 2015). As detection of internal defects inmangoes has not yet been attempted in any previous works, the task ofclassifying healthy and internally defected mangoes has been under-taken in this study. In order to express the effectiveness of the classi ﬁca- tion model, pattern recognition methods were introduced newly for theanalysis of NIR spectroscopic data and also for appropriate wavelengthselection. In view of the above challenges, the main objective of thisstudy was to develop a non-destructive technique that can be used to de-tect the internal defects in mangoes. The speci ﬁc objective was to select the optimal wavelength based on the feature extraction and featureselection techniques. Ultimately, this proposed system can be appliedto ofﬂine mango post-harvest procedures, because precision agriculture in horticulture aims to have efﬁcient utilization of resources for achiev-ing targeted production of fruits.2. Materials and methods2.1. Samples and spectral acquisitionFirst and foremost was to understand if it was possible to identify theinternal defects in the Mangoes. For this purpose, experiments wereconducted on mangoes of Alphonso variety using the Ocean OpticsNIR Spectroscopic instrument. The speciﬁcations of the NIR-Quest are the following:➢Detector- Hamamatsu G9208-512 W InGaAs linear array.➢Wavelength range: 700 nm–2500 nm w/Grating NIR.➢Integration time: 1 ms–200 ms.➢Signal to noise ratio: 10000:1 @ 100 ms integration.Initially, 76 mangoes were randomly picked from the market andlater the surface of the mango was wiped. This study was independentof post-harvesting time and temperature; hence these parameterswere not used for the purpose of classiﬁcation. In this study, the mea- surement setup was made in reﬂection mode. In reﬂection mode, the light source and detector were mounted under a speci ﬁc angle, e.g., 45 degree to avoid specular reﬂection (Bart et al., 2007). The schematic of STS NIR miniature spectrometer is shown in Fig. 1. The spectral range of the opticalﬁber was 673 nm to 1900 nm. Two optical ﬁber cables were used. One cable generates the spectral range between 673 nm to1100 nm and another cable provides 1100 nm to 1900 nm range ofwavelength. 1024 values of wavelength were obtained from the rangeof 673 nm to 1100 nm with the approximate period of 0.5 nm and512 values of wavelength were obtained from the range of 1100 nmto 1900 nm with the approximate period of 0.56 nm. There were noclues of internal defect on the mango surfaces detected as inspected vi-sually. Therefore, after obtaining the reﬂectance values, each of the mangoes had to be cut individually to con ﬁrm the internal defects as shown inFig. 2. Based on the above procedure, samples were segregatedas 43 defective and 33 healthy samples. Out of curiosity, an attempt wasmade to understand the reﬂectance spectrum of mangoes of depth pen-etration ability, though the research objective was only to classify inter-nally defected and non-defected samples. Only the area and depth of thedefects were measured but analysis was not done on that. The recordeddata indicates that out of a limited number of samples the defected areaarranges from 7 sqcm to 22 sqcm and depth ranging from 0.5 cm to
Fig. 1.Schematic of STS NIR Miniature Spectrometer.A. Raghavendra, D.S. Guru and M.K. Rao Artiﬁcial Intelligence in Agriculture 5 (2021) 43–51
441.5 cm. Our target was to develop a system capable of classifyingdefected samples irrespective of the degree of severity which is not ofgreat signiﬁcance from a consumer point of view.The obtained four spectroscopic data were directly plotted using Or-igin software which is depicted inFig. 3.I nFig. 3(a) and (b), lines B, C, D,Ea r et h er eﬂectance values of healthy samples and lines F, G, H, I are thereﬂectance values of defective samples. From the plots, the graph ap-pears to be separable from defective and healthy in lower range wave-length (673 nm to 1100 nm) compared to higher range wavelength(1100 nm to 1900 nm). Further, in order to express the effectiveness
Fig. 2.(a) Mango samples (b) Internal defects found after cutting of a mango.
Fig. 3.A plot of defective and healthy samples using origin software (a) Wavelength range 673 nm –1100 nm. (b) Wavelength range 1100 nm –1900 nm.A. Raghavendra, D.S. Guru and M.K. Rao Artiﬁcial Intelligence in Agriculture 5 (2021) 43–51
45of the classiﬁcation model, pattern recognition methods were intro-duced for the analysis of NIR spectroscopic data and also for the selec-tion of appropriate wavelength.3. Proposed wavelength extraction and selection modelIn view of the above challenges, a model was proposed which selectsthe suitable wavelength based on the feature extraction and the featureselection techniques. The feature extraction method is highlighted insection 3.1(Nemirko, 2016) and feature selection techniques are de-scribed insection 3.2 & 3.3(Artur and Mário, 2012;Chulmin and Jihoon, 2007;Guru et al., 2018;Huan et al., 2010;Isabelle and Andre, 2003;Jun et al., 2016;Włodzis et al., 2003). As the mean value of the spectroscopy data for defected and healthy samples were differentiable,initially Fisher's Linear Discriminant Transformation (FLDT) wasadopted, as the FLD Analysis works on the principle of inter-class varia-tion (variance between the mean of two classes) and intra-class varia-tion (mean of the variance of two classes).3.1. Wavelength extraction using Fisher's linear discriminanttransformationLet{Ai}be a set ofPsample column vectors of wavelength dimensionD. The mean vector of that is given by,μ
A¼1P∑Pi¼1A!ið1ÞLet there beKclasses{C
1.…C K}. The mean vector of the classKcon- tainingP
Kmembers is/C22
Ak¼1P
K∑
Ai∈C KA!ið2ÞThe inter-class scatter matrix is thus given byS
B¼∑2K¼1PKμAK/C131/C131!−μ
A/C131!/C16/C17μ
AK/C131/C131!−μ
A/C131!/C16/C17T
ð3ÞThe intra-class scatter matrix is given byS
W¼∑2K¼1∑
Ai∈C KAi!−μ
AK/C131/C131!/C16/C17A
i!−μ
AK/C131/C131!/C16/C17T
ð4ÞThe transformation matrix that repositions the data to be most sep-arable in the matrixWthat maximizes
detWTSBW/C16/C17detW
TSWW/C16/C17 ð5ÞW=[ W
1,W2………W D]gives a projection space of dimension D.T h e projection of vectorAinto a subspace of dimensionDis B¼W
TDA ð6ÞA projection space of dimensiond<Dcan be deﬁned by using the generalized Eigen vectors with the largest dEigen values to give W
D=[ W 1,W2,…………W d].The Eigen vector represents the directionor components for the reduced subspace of D, whereas Eigen values rep- resent the magnitudes for the directions. The generalized Eigen vectorsare Eigen vectors ofS
BSW−1.The next projection vectorAinto a subspace of reduced dimensiondisB¼W
TdA ð7ÞOnce the projection vectors ofBwith reduced wavelength are formed, the performance of FLD transformed features can be evaluated.Inverseﬁsher's linear discriminant transformation can also be donefrom Eq.(8)to know the normal wavelengths of the transformed dataspace.A¼B⁎W−1dð8Þ3.2. Fisher's ratio for wavelength selectionFor binary problems (c
j∈{0,1}), the Fisher's ratio (FiR), of the jth
feature is deﬁned as.FiR
j¼jX0ðÞjþX1ðÞjjﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃvarX
j/C0/C10ðÞþvarX j/C0/C11ðÞq ð9Þwhere
X0ðÞj,X1ðÞj,v a r (X j)(0)and var(X j)(1), are the samples means and variances of featurej, for the patterns of each class.3.3. Dispersion measures based wavelength selectionSome well-known dispersion measures that are used to computerelevance were adopted here.(a)The Mean Absolute Difference(MAD), deﬁned asMAD
j¼1n∑ni¼1∣Xji−Xj∣ ð10Þwhich computes the absolute difference from the mean value. TheMADis a scale-variant.(b)Ratio of Arithmetic Mean (AM)toGeometric Mean (GM)Another measure of dispersion applies the Arithmetic Meanand the Geometric Mean. For a given (positive) featureX
jon n patterns, theAM andGMare given by.AM
j¼Xj¼1n∑ni¼1Xji,GM j¼∏nj¼1Xji ! 1n
ð11ÞSinceAM
j≥GM j,with equality holding if and only ifX j1=X j2=X j3= ….=X
jn,then the ratio.R
j¼AM j
GM j∈1,þ∞ðÞ ð 12ÞEq.(12)can be used as a dispersion measure. Higher dispersion im-plies a higher value ofR
j,thus a more relevant feature. Conversely, whenthe entire feature samples have (roughly) the same value, R
jis close to 1, indicating a low relevance feature.(c)Mean Median (MM) differenceAnother dispersion measure, named Mean-Median differencegiven by.MM
j¼jXj−median X j/C0/C1jð 13ÞThis computes the absolute difference between the mean and me-dian ofX
j.
Once the dispersion measures described above of all the features arecomputed, the features are sorted in decreasing order and recommendto keep the top-m features. The computed measures are considered asrelevancy scores for validation.A. Raghavendra, D.S. Guru and M.K. Rao Artiﬁcial Intelligence in Agriculture 5 (2021) 43–51
46Fig. 4.Accuracy obtained using varying number of wavelength selected for the range 673 nm –1100 nm (a) Fisher's Ratio (b) AMGM (c) MM (d) MAD.A. Raghavendra, D.S. Guru and M.K. Rao Artiﬁcial Intelligence in Agriculture 5 (2021) 43–51
473.4. Estimation of the number of wavelengthsOnce the features were sorted in decreasing order with their rele-vancy scores, the selection of features relies on the following estimatesfor efﬁcient wavelength selection. Therefore, according to the high rele-vancy score, the wavelength can be selected by ﬁxing up the dimension experimentally for better classiﬁcation.3.4.1. Cumulative relevance (CR) measureLetr
i1………. ridbe the sorted relevance values and be the CRof the top-vmost relevant features.c
f¼∑vf¼1rif ð14ÞAt each step ofCRfeatures, evaluate the performance of the classi ﬁ- cation. It stops adding features until the best performance is obtained.3.4.2. Relevancy with their redundancy in the scoreLetr
i1………. ridbe the sorted relevance values. Ifr if=r idforf, d = 1, 2, ….v,performance can be evaluated for these features. Based on thehighest performance of both the features, only one feature can be con-sidered. Ifr
if≠rid,both the corresponding features can be retained.3.4.3. Selection of ranked wavelengthsLetr
i1………. ridbe the sorted relevance values from individual featureselection techniques. Selection of only top-1 ranked features at the be-ginning from all the feature selection techniques and evaluation to becarried out to verify the performance of the model. Then add the nextranked features to the top-1 ranked feature and continue to add furtherranked features cumulatively until the performance drops at somepoint. Performance can be evaluated at each stage of feature addition.3.4.4. Individual wavelength selectionFor all the feature selection techniques, performance can be evalu-ated by considering individual features at a time instead of cumulativeaddition of features until it reaches to top- vmost relevant features (ob- tained fromsection 3.3.1). Hence, selected features provide a peak inperformance and subsequently the same evaluation can be performedfor all the features.3.5. Performance analysisOnce the number of features was estimated, samples were dividedasT1%for training andT2%for testing samples. Let training sampleswere considered to beX
inumber of samples,i = 1, 2, 3……Nwithd number of wavelengths andY
jbe the testing samples,j = 1, 2, 3……M withdnumber of wavelengths.Distance measure was performed using Euclidean distance metric.Z
i¼ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ∑dr¼1Xri−Y ri ðÞ2sWhere,i¼1,2,3.........Nð15ÞThe above equation involves computing the square root of thesum of squares of the differences between corresponding samples.Euclidean distance measure was performed between each testingsampleY,withNnumber of training samples using the aboveequation.D¼C1 IfminZ
iðÞЄC1C2 If min Z
iðÞЄC2( ð16ÞAll samples from the testing set were measured using the Euclideandistance metric from Eq.(15). The confusion matrix was built based onthe result ofDand performance was evaluated based on the confusionmatrix.4. Results4.1. Performance of Fisher's linear discriminant transformationFisher's Linear Discrimination analysis projects data samples to a linethat maintains direction useful for classifying data of different classes.The FLD gives a projection matrix that reshapes the scatter of a datasetto maximize class separability, deﬁned as the ratio of the inter-classscatter matrix to the intra-class scatter matrix. This projection de ﬁnes features that are optimally discriminating. First, the FLD transformationtechnique was applied on a lower range of 1024 wavelengths and alsoon a higher range of 512 wavelengths separately. Later, 525 Eigen wave-lengths with non-zero Eigen values were obtained from 1024 wave-lengths and 260 Eigen wavelengths with non-zero Eigen values wereobtained from 512 wavelengths. Classiﬁcation accuracy was calculated with FLD subspace for both lower range and higher range of wavelengthby selecting non-zero Eigen wavelengths and non-negative Eigen wave-lengths. However, the accuracy result was 70% for 673 nm to 1100 nmrange of wavelength and 62% for 1100 nm to 1900 nm range of wave-length. Inverse transformation of FLD was also performed and mappedto original wavelengths using the obtained Eigen values from FLD trans-formation. Accuracy was calculated for mapped original wavelengthsand achieved 80.71% for the lower range and 68% for higher range as aclassiﬁcation result. As the depth of penetration is higher at lower wave-lengths (Fraser et al., 2000), it would be imperative to use the lowerwavelengths for the analysis. By considering the successful result ob-tained for lower range wavelength i.e. for 673 nm –1100 nm; feature se- lection techniques were applied to the only lower range of wave lengthsfor further analysis.4.2. Wavelength selection usingﬁlter techniquesFurther, feature selectionﬁlter techniques were implemented forlower range wavelengths, for efﬁcient wavelength selection.Fig. 4shows the comparison of four feature selection techniques forthe range of wavelength 673 nm–1100 nm. From Fisher's ratio, it wasobserved that accuracy of 84.78% was obtained for 135 wavelengths.From AMGM, 74.85% accuracy was obtained for 464 wavelengths.From MM, 82.71% accuracy was obtained for 1024 wavelengths andfrom MAD, 81.85% accuracy was obtained for 590 wavelengths.There were 135 wavelengths fromﬁsher's ratio, 464 wavelengths from AMGM, 1024 wavelengths from MM and 590 wavelengths fromMAD chosen as it provided the highest accuracy in individual feature se-lection technique. These wavelengths were randomly chosen and plot-ted inFig. 5to know how wavelengths were distributed over the rangeof 633 nm–1100 nm. Once the relevancy scores were calculated, scoreswere arranged in descending order and it was observed that there wasno redundancy in the scores as the relevancy scores were not the same.Computing the classiﬁcation accuracy by considering only top-1ranked wavelengths from different feature selection techniques, thencumulatively adding top-2 ranked wavelengths and could be continuedshown inTable 1. Classiﬁcation accuracy of 79.07% for top-1 rankedwavelengths, 77.64% for the fusion of top-1 and top-2 rank wavelengthsand 75.2% for the fusion of top-1, top-2 and top-3 rank wavelengthswere obtained shown inFig. 6. It was noticed that there was no overlap-ping of wavelengths between ranked wavelengths.Accuracy was calculated for individual wavelength instead of cumu-lative wavelengths shown inFig. 7.I nt h eﬁrst method, 80.71% of accu- racy was achieved for the wavelengths which were identi ﬁed at the peaks. In the second method, 81.42% of accuracy was obtained by onlyselecting and combining the wavelengths which resulted in more than80% accuracy. In the third method, 84.5% accuracy was obtained at723.35 nm which was identiﬁed at the highest peak. Considering theA. Raghavendra, D.S. Guru and M.K. Rao Artiﬁcial Intelligence in Agriculture 5 (2021) 43–51
48fusion of the highest peak wavelength and their three neighbor wave-lengths (722.88 nm and 723.82 nm) turned out to be 83.71% accurate.5. DiscussionIn this study, an internal defected and healthy mango classi ﬁcation model was attempted based on feature extraction and feature selectiontechniques for efﬁcient wavelength selection. Classiﬁcation accuracy of 82.71% for lower range wavelengths and 64.86% for higher range wave-lengths were obtained using the original features. Further, the FLDtransformation andﬁlter-based feature selection technique wereadopted to achieve a better result. It was observed that classi ﬁcation ac- curacy was 70% for lower range (673 nm –1100 nm) with 525 non-zeroEigen wavelengths and 62% for a higher range (1100 nm to 1900 nm)with 215 non-zero Eigen wavelengths using FLD transformation. Themodel provides 80.71% of accuracy for the lower range wavelengthsand 68% for the higher range wavelengths for the wavelengths whichwere identiﬁed after computing inverse FLD transformation. Hence, itwas noticed that lower range NIR spectroscopy wavelength was suitablefor identifying internal defects in mangoes. In order to choose an appro-priate wavelength range, a lower range wavelength was considered forfurther feature selection techniques.Fig. 5.Wavelength distribution over the range 633 nm –1100 nm using Fisher's ratio and different dispersion techniques.
Table 1Top-1 rank and top-2 rank wavelengths of ﬁsher's ratio, AMGM, MM and MAD.Feature selectiontechniques Wavelength at top-1rank Wavelength at top-2rankFisher's ratio 715.84 nm 716.31 nmAMGM 1123.73 nm 1114.26 nmMM 1122.24 nm 1121.74 nmMAD 1124.75 nm 1125.73 nm
Fig. 6.Classiﬁcation performance by cumulative addition of top-1, top-2 and top-3 rankedwavelengths.A. Raghavendra, D.S. Guru and M.K. Rao Artiﬁcial Intelligence in Agriculture 5 (2021) 43–51
49For further analysis, fourﬁlter-based feature selection techniqueswere used for the lower range of wavelength i.e. 673 nm –1100 nm. However it was observed fromFig. 4, Fisher's ratio technique outper- forms the dispersion measure techniques. Because 84.78% accuracywas obtained usingﬁsher's ratio for 135 cumulative wavelengthsbased on its relevancy score. The results showed that Fisher's criterionappeared to be the best technique and, further to have an ef ﬁcient wavelength, an optimized wavelength selection method was adoptedhere. FromFig. 5(a), two-wavelength ranges were found based onFisher's criterion. One with the range of 702.72 nm to 752.34 nm having105 wavelengths and another range of wavelength is 764.34 nm to778.07 nm having 30 wavelengths. 81.28% classi ﬁcation accuracy was obtained for considering 105 wavelengths and 74.14% for 30 wave-lengths. Out of the entire feature selection techniques, Fisher's criterionseems to be the best method of choosing the wavelength from the NIRfor the classiﬁcation of healthy and defective mango. Further, to designany model like NIR camera from the NIR spectrum, an appropriate rangeof wavelength is needed; hence, efﬁcient wavelength selection can bedone using Fisher's criterion.6. ConclusionAppropriate wavelength selection methods were proposed from NIRspectroscopy, data ranging from 673 nm−1900 nm for classiﬁcation of healthy and internally defected mangoes. Wavelength selectionmethods were proposed based on the feature extraction and feature se-lection techniques. Experimentation results showed that the wave-length range of 673 nm–1100 nm was the suitable range to detect theinternal defects compared to the range 1100 nm –1900 nm. Filter based feature selection techniques were used and ﬁsher's criterion was chosen to be the best wavelength selection technique comparedto other selection technique. The highest accuracy obtained was 84.5%with efﬁcient wavelengths. The optimal wavelength was found in therange of 702.72 nm to 752.34 nm using ﬁsher's criterion. This study laid a foundation for further development of the NIR camera/modelfor the spongy tissue detection on mango fruits.However, further tuning of our classi ﬁcation model towards predicting the degree of severity of defection would help us in furtherclassiﬁcation of defected samples into less defected, moderatelydefected and severely defected and this work is kept as our future re-search work. Future research in this direction will help to build a moreeffective model for a large dataset including an ef ﬁcient classiﬁcationalgorithm and speeding up the processing of data to ful ﬁll the goal of de- tecting internal defects on mango fruits in real-time.Credit Author StatementAnitha Raghavendra- Conceptualization, Methodologies, Software,writing original draft preparation, Writing-Reviewing and Editing.D.S. Guru-Supervision, Validation, Visualization, Writing- review andeditingMahesh.K.Rao-S u p e r v i s i o n .Conﬂicts of interestThere is no conﬂict of interest in our study.AcknowledgmentsMaharaja Research Foundation (MRF), Mysore, supports this re-
search work. We appreciate the support of MRF. We also appreciateShwetha and Jayakumar, Comtek Scientiﬁc Pvt. Ltd., Bangalore for pro- viding NIR spectroscopy to collect the dataset.Further, we are grateful to all the reviewers who have shared theircritical comments which made our manuscript more readable in addi-tion to enhancing the quality of the content.References
Anitha, Raghavendra, Mahesh, Rao, 2016. A survey on internal defect detection in fruits by non-intrusive methods. Int. J. Latest Trends Eng. Technol. 6 (3), 343 –348. Artur, J. Ferreira, Mário, A.T. Figueiredo, 2012. Efﬁcient feature selectionﬁlters for high- dimensional data. Pattern Recogn. Lett. 33 (13), 1794 –1804. Bart, M. Nicolai, Katrien, Beullens, Els, Bobelyn, Ann, Peirs, Saeys, Wouter, Karen, I. Theron,Jeroen, Lammertyn, 2007.Non-destructive measurement of fruit and vegetable qual-ity by means of NIR spectroscopy: a review. Post-Harv. Biol. Technol. 46, 99 –118. Chulmin, Yun, Jihoon, Yang, 2007. Experimental comparison of feature subset selectionmethods. IEEE Int. Conf. Data Min. https://doi.org/10.1109/ICDMW.2007.77 . David, C. Slaughter, Carlos, H. Crisosto, 1998. Non-destructive internal quality assessment of kiwifruit using near-infrared spectroscopy. Sem. Food Analys. 3, 131 –140. Dospatliev, L., Katrandzhiev, N., Kostadinova, G., 2013. Use of near infrared spectroscopy technology for assessment of the internal quality of some fruits and vegetables-review. For. Sci. Technol. 3, 39 –48. Fraser, D.G., Kunnemeyer, R., McGlone, V.A., Jordan, R.B., 2000. Near infrared light pene- tration into an apple. Postharvest Biol.Technol. 22, 191 –194. Guru, D.S., Mahamad, Suhil, Lavanya, Narayana, Raju, Vinay, Kumar, N., 2018. An alterna- tive framework for univariateﬁlter based feature selection for text categorization. Patt. Recogn. Lett. 103, 23–31.Fig. 7.Performance analysis for individual wavelengths using Fisher's criterion.A. Raghavendra, D.S. Guru and M.K. Rao Artiﬁcial Intelligence in Agriculture 5 (2021) 43–51
50Holm, F., 2002. European cooperation of the development of sensors for food quality as-sessment. Innovation workshopﬂair-ﬂow. Advanced sensor devices for on-line mon- itoring of food quality, Soﬁahttp://www.ceeri.res.in/main/x-ray%20imaging.pdf . Huan, Liu, Hiroshi, Motoda, Rudy, Setiono, Zheng, Zhao, 2010. Feature selection: an ever evolving frontier in data mining. JMLR: Workshop Conf. Proc. 10, 4 –13. I s a b e l l e ,G u y o n ,A n d r e ,E l i s s e e f f ,2 0 0 3 . An introduction to variable and feature selection. J. Mach. Learn. Res. 3, 1157–1182. Jun, Chin, Ang Andri, Mirzal, Habibollah, Haron, Haza, Nuzly, Hamed, Abdull, 2016. Super- vised, unsupervised, and semi-supervised feature selection: a review on gene selec-tion. IEEE/ACM Trans. Comput Biol Bioinform. 13 (5), 971 –989. Krivoshiev, G., Chalucova, R., Moukarev, M., 2000. A possibility for elimination of the peel disturbing effect in non-destructive determination of fruit and vegetables internalquality by Vis/NIR spectroscopy. Lebensm.-Wiss. Technol. 33, 344 –349. Lammertyn, Jeroen, Ann, Peirs, Joss, De Baerdemaeker, Bart, Nicolai, 2000. Light penetra- tion properties of NIR radiation in fruit with respect to non-destructive quality as-sessment. Postharvest biol. Technol. 18 (2), 121 –132. Manpreeth, Singh, Ramesh, Kumar, 2010. Quality parameters of mango and potential of non-destructive techniques for their measurement-a review. J Food Sci Technol-Springer. 47 (1), 1–14.Mayank, Goel, Eric, Whitmire, Alex, Mariakakis, Scott, Saponas T., Neel, Joshi, Dan, Morris,Brain, Guenter, Marcel, Gavriliu, Gaetano, Borriello, Shwetak, N. Patel, 2015.HyperCam: Hyperspectral Imaging for Ubiquitous Computing Applications.pp. 145–156 UbiComp’15.Meurens, M., Feth, F., 2001. Detection of Internal Defects Inside Defects Inside Apples byVis/NIR Transmission Spectroscopy. www.inapg.inra.fr/ens_rech/siab/asteq/ab- stract_3rdagm.Nemirko, A.P., 2016.Transformation of feature space Basedon Fisher ’sl i n e a rd i s c r i m i n a n t . Patt. Recogn. Image Analys. 26 (2), 257 –261. Peiris, K., 1997.Non-destructive determination of solids content of peach by near infraredspectroscopy. Sensors for Non-destructive Testing Measuring the Quality of FreshFruits and Vegetables. Processing from the Sensors for Non-Destructive Testing Inter-national Conference.Peiris, K., Dull, G., Lefﬂer, R., Kays, S., 1998.Near infrared spectroscopic technique for non destructive determination of soluble solids content in processing tomatoes. J. Amer.Soc. Hort. Sci 123, 1089–1093.Peirs, A., Touchant, K., Schenk, A., Nicolai, B., 2001. FT-NIR spectroscopy to evaluate pick- ing date of apples. ISHS Acta Horticult. 553, 477 –480. Qiang, Lu, Ming, Jie, Tang, Jian, Cai, Rong, Zhao, Jie-wen, Saritporn, Vittayapadung, 2011.Vis/NIR hyperspectral imaging for detection of hidden bruises on kiwifruits. CzechJ. FoodSci. 29 (6), 595–602.Sandeep, S. Musale, Pradeep, M. Patil, 2014. Database development of defective and healthy alphonso mangoes. Int. J. Adv. Agric. Environ. Eng. 1 (1), 2349 –2531. Sang, Ha, Kyu, N.O.H., CHOI, Hong, 2006. Nondestructive quality evaluation technolo- gies for fruits and vegetables. International Seminar on Enhancing. InternationalSeminar on Enhancing Export Competitiveness of Asian Fruits Corpus ID:9864344.Włodzis,Ław Duch, Tomasz, Winiarski, Jacek, Biesiada, Adam, Kachel, 2003. Feature selec- tion and ranking
ﬁlters. Artiﬁcial Neural Networks and Neural Information Processing –ICANN/ICONIP.A. Raghavendra, D.S. Guru and M.K. Rao Artiﬁcial Intelligence in Agriculture 5 (2021) 43–51
51