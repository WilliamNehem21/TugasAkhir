D4I - Digital forensics framework for reviewing and investigatingcyber attacks
Athanasios Dimitriadisa, Nenad Ivezicb, Boonserm Kulvatunyoub, Ioannis Mavridisa,*
aUniversity of Macedonia, Thessaloniki, Greece
bNational Institute of Standards and Technology, Gaithersburg, MD, USA
ARTICLE INFO
Keywords:Digital forensics frameworkArtifacts categorization and mappingExamination and analysisDigital reviewing and investigationABSTRACT
Many companies have cited lack of cyber-security as the main barrier to Industrie 4.0 or digitalization. Securityfunctions include protection, detection, response and investigation. Cyber-attack investigation is important as itcan support the mitigation of damages and maturing future prevention approaches. Nowadays, the investigationof cyber-attacks has evolved more than ever leveraging combinations of intelligent tools and digital forensicsprocesses. Intelligent tools (e.g., YARA rules and Indicators of Compromise) are effective only when there is priorknowledge about software and mechanisms used in the cyber-attack, i.e., they are not attack-agnostic. Therefore,the effectiveness of these intelligent tools is inversely proportional to the number of the never-seen-before soft-ware and mechanisms utilized. Digital forensic processes, while not suffering from such issue, lack the ability toprovide in-depth support to a cyber-attack investigation mainly due to insuf ﬁcient detailed instructions in the examination and analysis phases. This paper proposes a digital forensics framework for reviewing and investi-gating cyber-attacks, called D4I, which focuses on enhancing the examination and analysis phases. First, theframework proposes a digital artifacts categorization and mapping to the Cyber-Kill-Chain steps of attacks. Sec-ond, it provides detailed instructing steps for the examination and analysis phases. The applicability of D4I isdemonstrated with an application example that concerns a typical case of a spear phishing attack.
1. IntroductionTo realize the ultimate vision of Industrie 4.0 or digitalization,manufacturing devices, equipment, and software systems have to behighly-interconnected. These connected things cannot be con ﬁned to the four walls of a manufacturing enterprise because of today ’s nature of highly-distributed manufacturing, both physically and virtually, throughinternal and external software services. Therefore, cyber-attacks areimperative threats to smart manufacturing systems that every companyneed to be wary of [1]. Manufacturing companies have to protect sen-sitive data including intellectual property, ﬁnancial information, and personally identiﬁable information (PII) that can be manipulated andleveraged for malicious purposes. Despite many efforts in this area, thecontinued advances in technologies and changes of tactics by perpetra-tors have made the cyber-attackers seemingly invincible [ 2]. Security functions include protection, detection, response and inves-tigation [3]. Sophisticated tools such as YARA rules [ 4] and Indicators of Compromise (IoCs) [5] were developed to assist primarily in the pre-vention, detection and response [6]. They are mainly created or maturedbased on the outcome of an investigation and they contain pieces of fo-rensics data [6,7]. Their role in the investigation is to identify trace-s/evidence of an attack giving suggestions from where the investigationshould start whenever an attack is detected [ 6,8]. Structured Threat In- formation Expression (STIX) deﬁned by the OASIS Cyber Threat Intelli-gence (CTI) TC is a structure language for describing cyber threatinformation in JSON schema [5]. STIX enhanced IoCs so that they caninclude the step of a generalized attack model –Cyber-Kill-Chain that they belong to Ref. [5]. In addition to that, it provides objects that can beused to describe an attack such as TTPs and Observables [ 5]. However, both YARA and IoCs cannot be used as a forensics procedure to guide aninvestigation of a cyber-attack. Additionally, they are effective only if thesoftware and mechanism used in the attack are known a priori [ 9,10]. In other words, they are not attack-agnostic and are sensitive to new ormodiﬁed threats, such as in the case of zero-day attacks. In particular,they are of limited effectiveness if a cyber-attack uses completely newsoftware and mechanisms in every one of its steps [ 6]. Therefore, these tools have generated few results for the investigation of newcyber-attacks.
* Corresponding author.E-mail address:mavridis@uom.gr(I. Mavridis).
Contents lists available atScienceDirect
Array
journal homepage:www.elsevier.com/journals/array/2590-0056/open-access-journal
https://doi.org/10.1016/j.array.2019.100015Received 24 October 2019; Received in revised form 18 December 2019; Accepted 20 December 2019Available online 26 December 20192590-0056/©2020 The Authors. Published by Elsevier Inc. This is an open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-
nc-nd/4.0/ ).Array 5 (2020) 100015On the other hand, digital forensics processes have been proposed tohelp withﬁnding and analyzing the facts related to an incident [ 11,12]. They are based on generalized phases that include Collection, Exami-nation, Analysis, and Report, and so they can be used in attack investi-gation while being attack-agnostic [11]. As they are based on generalized phases, they are also inadequate because they do not describe the ex-amination and analysis phases of a cyber-attack investigation with suf-ﬁcient details for the digital forensics examiner to easily follow.Moreover, the exact details of these steps may also vary depending onmany needs; policies, guidelines and procedures [ 11,12]. Taken into consideration all the above, it may seem the perpetratorsare always a step ahead of the digital forensic examiners regardless of thetechnology that is being used during an investigation [ 13]. That may be true if all the digital forensics examiners choose to continue using pro-cesses that lack to provide adequate support. As such, it is with no doubtthat there is the need for a new approach in reviewing and investigatingcyber-attacks by providing digital forensics examiners with supportduring the critical investigation phases, viz examination, and analysis[12]. This paper proposes a digital forensics framework called D4I(Digital FOrensics framework for Reviewing and Investigatingcyber-attacks) whose aim is to enhance the examination and analysisphases of the digital forensics process. The linchpin of the D4I is ﬁrstly the proposed artifacts categorization and their mapping to theCyber-Kill-Chain steps of attacks, and secondly the proposed step-by-stepinstructing method for examining and analyzing cyber-attacks. D4I isdesigned to complement and enhance, not replace, other digital forensicsprocesses. In this way, forensic examiners can choose the digital forensicsprocess they prefer and conduct the examination and analysis phases toreview and investigate a cyber-attack by following the proposed D4Iframework.The paper is organized as follows: Section 2presents related work and introduces the theoretical background of this research. Section 3de- scribes the proposed framework, while section 4illustrates an application example of the D4I framework on a typical case of a spear phishingattack. Section5interprets, describes the work and compares it toexisting ones andﬁnally, Section6summarizes and discusses future work.2. Background“Digital forensics is the application of informatics to assure properpresentation of computer crime evidentiary data into a court by mainlypreserving the integrity of them and maintaining a strict chain of cus-tody”[11,14]. The ultimate goal of digital forensics is to obtain evidenceso that the 5Ws and How (5WH) questions can be answered [ 15–17]. The 5WH questions include What happened, Who was involved, When did ittake place, Where did it take place, Why did that happen, and How anincident occurred [18]. Answering these questions leads to conﬁrming or refuting allegations of an incident [18–20]. In order for the aforementioned questions to be answered, the digitalartifacts of a system have to be examined and analyzed by following oneof the digital forensics processes discussed in subsection 2.1. Although
there is not in the literature a formal de ﬁnition of the term“digital artifact”[21], it is widely accepted that its deﬁnition should be based on the notion of“artifact”in archaeology. That is, artifact is “an object made by a human being, typically one of cultural or historical interest ”[22]. Finally, an artifact has also been deﬁned as“an object of digital archaeological interest”[23,24].2.1. Related workTo accomplish the digital forensics goal, the 5WH questions areanswered following a digital forensics process [ 25–27]. Numerous pro- cesses have been proposed in the literature to date without one univer-sally accepted as the best practice [28]. These processes typically start with the data acquisition and end with the evidence reporting phases[11]. Based on existing surveys, all of them include one (analysis) or two(examination and analysis) phases during which the artifacts related tothe cyber-attack should be identiﬁed and analyzed [12][29–31][32]. Evidently, these two phases are of great importance not only becausethey are common among all digital forensics processes but also becausein them the actual investigation takes place [ 29,30,33]. Based on existing surveys in digital forensics processes, the majority of the processes do notelaborate examination and analysis in detail and so there is a dearth ofguidance and limited assistance on conducting these phases [ 25,29,32, 34]. In the following of this subsection, the processes whose examinationand analysis phases are further elaborated are discussed.The Systematic Digital Forensic Investigation Model (SRDFIM) fo-cuses on the investigation of cybercrime and cyber-fraud [ 14]. It consists of eleven phases, including the examination and analysis. According toSRDFIM, the examination phase aims at searching of evidence related tothe case, making it visible and preparing it in a form suitable for analysis.To this purpose, SRDFIM suggests data ﬁltering, validation, pattern matching, searching techniques, recovering ASCII and non-ASCII data aswell asﬁnding unusual hiddenﬁles or directories,ﬁle extension and signature mismatches etc. The analysis phase is a technical review of thedata acquired and extracted from the examination step to identify re-lationships between data, determine its signi ﬁcance, reconstruct events and draw conclusions. To this purpose, SRDFIM suggests time frameanalysis, hidden data analysis, application analysis, ﬁle analysis, identi- ﬁcation of relationships between fragments of data and analysis of hid-den data etc. It is evident therefore that the model is technique-centricwithout providing a structured and a step-by-step way to conduct theexamination and analysis phases.The Integrated Digital Forensics Process Model (IDFPM) proposes afour-step model to aid investigators in following a uniform approach ininvestigation of cyber-attacks [35]. IDFPM consists of the“Preparation”, “Incident”,“Digital forensics investigation ”and“Presentation”, phases. The“Digital forensics investigation ”phase includes the examination andanalysis. The examination focusing on acquiring hidden, obfuscated,deleted or visible digital evidence/data and transforming it into a humanreadable form. The analysis aims at identifying data relevant to thecase/hypothesis. As data can be quite large, the IDFPM proposes utilizingtechniques, such as hashes, toﬁnd known data. It also proposes digitalevidence with similar identifying patterns to be grouped together to helpidentiﬁcation of evidence faster. A proposed method to do so, is to utilizeknown classiﬁcations created in past similar incidents. In this way,however, it requires prior knowledge and therefore it is notattack-agnostic neither it is focused on artifacts. Finally, during analysis,the organized data is proposed to be tested against the hypothesisformulated which is a high-level recommendation.The Cyber Forensic Field Triage Process Model (CFFTPM) proposes anapproach for identifying, analyzing and interpreting digital evidence in ashort time frame [36]. The model focuses on decreasing the time neededto investigate a crime on scene which is considered to be a critical factor.The model proposes a series of phases that should be conducted to gatherinformation from a Windows system. The phases include: planning,triage, usage/user proﬁles, chronology/timeline, Internet activity, andcase speciﬁc evidence. The phases relevant to our work are the usa-ge/user proﬁles, chronology/timeline, Internet activity. The name ofeach phase is derived from the information that can be gained byexamining and analysis speciﬁc artifacts of a windows system belongingto this phase. Although it seems to be an artifact categorization it is notclearly deﬁned and it is a work relevant to work of SANS ( subsection 2.2). Also, CFFTPM does not specify how the artifacts and the categorization ofthem can be leveraged into investigation. Finally, the phases seem toprovide details on what is needed to be examined but not on how a casecan be investigated by utilizing them.In Ref. [11], a high-level digital forensics process is de ﬁned by Na- tional Institute of Standards and Technology (NIST) which consists of thefollowing phases (Fig. 1):A. Dimitriadis et al. Array 5 (2020) 100015
2/C15Collection, whose purpose is to identify any potential sources of datarelevant to the incident and then to label and record them. After-wards, the data located in those sources should be acquired whilepreserving the integrity of the sources./C15Examination, which involves assessing the acquired data from theCollection phase and extracting the data relevant to the incidentwhile preserving its integrity./C15Analysis, which involves studying the information extracted by theexamination to answer the 5WH questions or determine that no orpartial conclusion can be drawn./C15Reporting, which is the process of preparing and presenting theprocedure, methods and tools utilized in the investigation along withthe results from the analysis phase.In the following sections, we adopt the digital forensics process ofNIST, without limiting the ability to apply D4I along with other digitalforensics processes in order to further elaborate their corresponding ex-amination and analysis phases. More details about how the D4I can ﬁt into any other digital forensics process to achieve this goal are presentedin thesubsection 3.2and in particular inFig. 3.2.2. SANS artifacts categorizationSANS (SysAdmin, Audit, Network and Security) has released theposter termed“Windows Forensic Analysis–Poster: You can’t protect What You Don’t Know About”[37] the aim of which is to“help in- vestigators of cyber-attacks rapidly determine a clear picture of whichuser was involved, what the user was doing, when the user was doing it,and why”[37]. To this purpose, the artifacts that can be found on aWindows operating system (OS) were mapped into eight categories basedon what activity they describe.Table 1depicts these categories, each named by the action that can bedetermined by examining the artifacts the category contains. Forinstance, if a forensic examiner is to identify the USB devices mounted ona system, they should examine and analyze the artifacts belonging to thecategory“External Device/USB usage”. Be advised that one artifact can belong to multiple categories depending on the context the categorydeﬁnes. Ultimately, the poster can be utilized as a guide to help forensicexaminers focus their analysis on speciﬁc areas in Windows Systems that can“best help them answer simple but critical questions ”[37]. The SANS’s categorization of artifacts can help forensic examinersfocus their effort on speciﬁc areas in Windows. However, it lacks guid-ance on how the investigation (examination and analysis) should beconducted.2.3. Cyber Kill ChainThe Cyber Kill Chain (CKC) is an intelligence-driven model proposedby Lockheed Martin to be followed in the identi ﬁcation and prevention of cyber-attacks [6]. It adapts the United States military ’s kill chain process to the digital era to describe the following phases the adversaries passthrough to achieve their objectives (Fig. 2
):1. Reconnaissance (R): Attackers usually scan the internet to ﬁnd, identify, choose and gather information about their target.2. Weaponization (W): An apparently legitimate ﬁle to be sent to the target is developed. Thisﬁle is used to infect the target by a payload(malicious code) tailored to one or more vulnerabilities.3. Delivery (D): The attacker sends the above ﬁle to the target. 4. Exploitation (E): The payload is executed by exploiting vulnerabilitiesin the operating system or the installed applications.5. Installation (I): The payload is installed in a speci ﬁc location in the victim’s system to grant permanent existence (persistence)6. Command and Control (C2): The payload establishes a covertcommunication channel (e.g. using DNS queries) with its creator togain access to the target.7 Actions on Objective (A): Attackers accomplish their objectives.The CKC model serves two purposes [ 6]. It can be used for actionable intelligence so that defensive capabilities can be aligned to the steps anadversary follows and for analyzing intrusions. The analysis of intrusion,however, assumes that the detection of a cyber-attack was based on anIoC. Once an IoC is found, then the analysis should start from the phasethat this IoC belongs to (since STIX IoCs can contain the CKC) and goingback to prior phases as it is assumed that they have been executedalready. Hence, it is evident that CKC and IoCs can be used together ininvestigation provided that there is prior-knowledge about acyber-attack, i.e. at least one IoC needs to be found. Moreover, IoCs arenot a framework to be used in conducting an investigation so they can noguide it but only support it.3. The proposed D4I frameworkIn this section, the proposed D4I framework for reviewing andinvestigating cyber-attacks is presented. D4I is designed to complementand enhance, not replace, existing digital forensics processes. Conse-quently, digital forensics examiners can follow their preferred digitalforensics process in conjunction with the D4I during the examination andanalysis phases [12]. The D4I framework provides a step-by-step and asemi-automatic way of cyber-attack investigation regardless of nature,type and sophistication of the attack.The D4I framework has two pillars. First is the proposed
Fig. 1.Digital Forensics Process proposed by NIST.
Table 1Artifacts categorization by SANS [ 37].
Category Name ArtifactsFile download Open/Save MRU, Email Attachments, Skype History,Browser Artifacts, Downloads, ADS Zone.Identi ﬁer Program Execution User Assist, Windows 10 Timeline, RecentApps,Shimcache, Jump Lists, Amcache.hve, System ResourceUsage Monitor (SRUM), BAM/DAM, Last-Visited MRU,PrefetchFile/Folder Opening Open/Save MRU, Recent Files, Jump Lists, Shell Bags,Shortcut (LNK) Files, Prefetch, Last-Visited MRU, IE|Edgeﬁle://Deleted File or FileKnowledgeXP Search–ACMRU, Thumbscache, Thumbs.db, IE|EdgeFile://, Search–WordWheelQuery, Win7/8/10 RecycleBin, Last-Visited MRU, XP Recycle BinNetwork Activity/Physical LocationTimezone, Cookies, Network History, WLAN Event Log,Browser Search Terms, System Resource Usage Monitor(SRUM)External Device/USBusageKey Identiﬁcation, First/Last Times, User, PnP Events,Volume Serial Number, Drive Letter and Volume Name,Shortcut (LNK) FilesAccount Usage Last Login, Last Password Change, RDP Usage, ServicesEvents, Logon Types, Authentication Events, Success/FailLogonsBrowser Usage History, Cookies, Cache, Flash &Super Cookies, Session Restore, Google Analytics CookiesA. Dimitriadis et al. Array 5 (2020) 100015
3categorization artifacts and their mapping to CKC as presented in the nextsubsection. Second is the proposed step-by-step instructing method forthe examination and analysis phases, which is based on the above cate-gorization and mapping of artifacts. Hence, a detailed sequence of simpletasks an examiner can follow is provided. D4I aims at reviewing andinvestigating cyber-attacks with the same sequence of steps they haveoccurred, so as to easily and rapidly identify their traces, i.e. artifacts theyhave created.For the presentation of D4I elaborate on Windows OS artifacts asWindows is the most used operating system nowadays, except Android inMobile devices [38]. It is also popular in the Industry and its potentialvulnerabilities could more likely become subject to exploitation [ 39]. Windows workstations are also popular in networked control systems(NCSs) in Industry [40]. Microsoft technologies, such as Windows 10,Azure, Microsoft HoloLens and Surface, are used to allow manufacturersto keep up with their end customer needs [ 41]. The convergence of in- formation technology (IT) and Operational Technology (OT) is an op-portunity for attackers to move laterally across a manufacturing network[39]. There are many famous cases targeted Industrial Control Systems inwhich vulnerabilities in Windows OS were exploited by AdvancedPersistent Threats (APT) groups to accomplish their goals. Some famousexamples are the“Stuxnet”[42],“NotPetya”,“Duqu/Flame/Gauss”and “Night Dragon”[43]. However, artifacts of other kinds of systems canalso be categorized and mapped in a similar manner, such as artifacts ofother operating systems (e.g. Android, Unix and iOS), IoT (Internet ofThings) devices or even Industrial Control Systems [ 44].3.1. Categorization and mapping of digital artifactsIn the NIST’s examination phase [11], the examiner extracts and as- sesses the acquired data from the compromised system while preservingthe data integrity. However, a system might contain thousands of dataand OSﬁles; identifying those relevant to the attack, viz its traces, and soinvestigating the attack can be a highly demanding task.To cope with this problem, artifacts have been categorized andmapped into the phases of the CKC. In this way, digital forensics exam-iners will be able to identify all the traces/artifacts that the attack hasleft/created in each phase of CKC (NIST ’s examination phase). Utilizing the proposed categorization and mapping of artifacts in conjunction withthe step-by-step instructions described in the next subsection, analystscan focus their effort only on correlating artifacts between CKC phases.Therefore, the identiﬁcation of those relevant to the attack being inves-tigating becomes a straightforward task.Table 2illustrates a CKC-based mapping of artifacts identi ﬁed in the SANS Categorization. In addition to SANS artifacts, our research has alsoidentiﬁed and categorized other Windows artifacts. They are included inthe subrow termed“D4I”inTable 2and mapped to the CKC-phases. Eachartifact may belong to multiple categories depending on the contextbeing examined and analyzed. For instance, artifacts regarding USB de-vices can provide information about the devices used to deliver malware(malicious software) or ex
ﬁltrate data and so they belong to “Delivery” and“Actions on Objective”stage respectively. The categorization canthen be used in the step-by-step instructing method proposed in the nextsubsection.As mentioned in beginning of Section 3, D4I is not limited to Windows OS and can be expanded to other OS, such as Linux. In Linux, for instance,artifacts relevant to the ones being categorized and mapped into thephases of the CKC can be found as well. For example, the ﬁle“/etc/init.d” is used to run an application at startup of Linux. This ﬁle can be cate- gorized to start-up locations and mapped into the Installation CKC phase.Another example is theﬁle/var/log/kern.log which stores informationabout the USB devices connected to a Linux workstation. This artifact iscategorized to“External Device/USB usage”which is mapped to the Delivery CKC phase.3.2. Step-by-step instructing method for examination and analysisThe proposed step-by-step instructing method for the NIST ’s
Fig. 2.The phases of the Cyber Kill Chain.
Fig. 3.The proposed step-by-step instructing method.
Table 2Mapping artifact categories to CKC phases.
Phases Artifacts CategoriesR SANS: WLAN Event LogD4I: ICMP (windows events, netstat, ﬁrewall/IDS logs, PCAP trafﬁc both live and from RAM)W SANS:–D4I: File used to deliver a malware and its metadata (e.g. infecteddocument’s metadata can reveal the tool used to develop themalware embedded into it –payload of the document) D SANS: File/Folder Opening, File Download, External Device/USB usageD4I: Files/Folders where applications store attachments or ﬁles downloaded (e.g. viber.dbﬁle, Folder where uTorrent saves theﬁles),E SANS: Program Execution, Windows Application Log Files, Fileopening/creation, Account UsageD4I: Vulnerable applications identi ﬁed by vulnerability assessment itself or as a part of Risk Management, Files/Folders whereapplications store temporaryﬁles or auto saveﬁles (e.g. C:\ Documents and Settings\<username>\Application Data\Microsoft\Word) I SANS: ADS Zone Identi ﬁerD4I: Boot Sectors, MFT Slack, Start-up locations (e.g. registry run keys)C2 SANS: Program Execution, Network History, Network History, Shortcut(LNK) Files, Last-Visited MRU, Jump Lists, Open/Save MRUD4I: Network Connections (e.g. netstat), PCAP traf ﬁc both live and from RAM (e.g. DNS queries might be used to ex ﬁltrate data) A All Windows OS and applications artifacts, and Audit logA. Dimitriadis et al. Array 5 (2020) 100015
4examination and analysis phases consists of the following six steps(Fig. 3):1. Choose: Choose a CKC phase.2. Identify: Identify all artifacts belonging to the chosen CKC phase(examination) based on the proposed artifacts categorization.3. Correlate: Find correlations between the artifacts of the chosen CKCphase with artifacts belonging to the same, previous or next CKCphase (NIST’s examination). Artifacts can be correlated by either theirattributes (e.g. timestamp, name) or content (e.g. code of a MicrosoftWord VBScript and ADS of aﬁle).4. Construct Chain of correlated Artifacts (CoA): Keep every artifact thathas any kind of correlation with artifacts belonging to the same,previous or next CKC phase and add it to a chain. In effect, analysis isbeing performed since conclusions are already started being drawn.5. Repeat: Repeat the procedure (1 –4 steps) for all the phases of theCKC.6. Analyze CoA: Analyze the CoA to determine if it describes an attack(NIST’s analysis). As an attack follows the phases described in theCKC, this chain of artifacts is the trace the attack left behind.4. Application exampleIn this section, the D4I framework is applied on a case of a spearphishing attack in which an email containing a document attachmentinfected by a malicious code was sent to the victim. According to FireEye[45], Spear phishing is a targeted form of a phishing email attack. At-tackers focus their effort on carefully selected victims, disguising them-selves to appear as a trustworthy party that they can persuade theirvictims about the legitimacy of an email [ 45]. Doing so they can trick their victim into visiting a link or downloading/opening an attachment ofthe email so that they can gain access to the computer system or stealsensitive information [45].This type of spear phishing attack has been chosen because of its widepresence. Tripwire reports three-quarters of organizations suffered fromphishing attacks in 2017 [46]. PhishMe states 91% of cyber-attacks beginwith a spear-phishing email in 2016 [ 47]. Wombat estimates 83% of organizations claim they were targets of phishing attacks in 2018 [ 48]. Verizon determines 92.4% of malware is delivered via email andphishing is the top threat action [49,50]. Gartner states that, through 2020, email remains the primary targeting method of advanced attacks[51]. Additionally, there are several well-known cases focused on in-dustry in which spear phishing attack was utilized by APT groups toachieve their objectives. Some famous examples are: i) the “Havex”case a widespread espionage campaign targeting industrial control systems inEurope and the United States performed [ 52,53], ii)“Industroyer or Crashoverride”which is the biggest threat to power grids since Stuxnet[54]. This attack started by targeting IT workers and system adminis-trators who was persuaded to download an infected Word attachment[54], iii)“Ukraine Power Grid”infected an Ukrainian power companyand it is theﬁrst known attack to power-grid [55]. In this attack, Spear-phishing was used along with a malware exploiting the macros inMicrosoft Excel documents (xls) [
55], iv)“Night Dragon”targeted global oil, energy, and petrochemical companies [ 43]. In this attack, among others social engineering and spear phishing attack were utilized [ 43]. The modus operandi of applying D4I on a spear phishing attack isdescribed below.1. Reconnaissance: The attackerﬁnds the IP address of the targetedorganization’s website using“whois”databases and“tracert”. Then she visits the website and downloads a Microsoft Of ﬁce document (e.g., an Excelﬁle). Afterwards, she leverages data breaches to harvestthe emails of the employees of the organization. She chooses aparticular employee and gathers information about him using a usualsearch engine and social media sites. Finally, the attacker scans thenetwork of the organization trying to map it and to ﬁnd potential vulnerable services.2. Weaponization: The attacker examines the downloaded documentand detects an unknown (zero-day) vulnerability that she canleverage (most APT groups exploit zero-day vulnerabilities, namelyvulnerabilities that have not yet identiﬁed by the security community neither published in vulnerability databases, like NIST ’s National Vulnerability Database). Afterwards, she develops a malware tailoredto the particular vulnerability and creates an apparently legitimateﬁle containing this malware to be sent to the victim.3. Delivery: The attacker sends an email to the victim, pretending atrusted third party and having attached the above malware. To do so,the attacker has leveraged information about the victim gathered inthe Reconnaissance CKC phase.4. Exploitation: The employee receives email, opens the attached ﬁle, the malware exploits the vulnerability and executes itself.5. Installation: The malware creates an ADS (Alternate Data Stream),copies its code into it and grants permanent persistence to the hostingsystem by installing a registry key (Run registry key) which starts theADS in every reboot of the system.6. Command and Control: The malware establishes a covert communi-cation channel between the compromised system and its creator andstarts sending image screenshots.7. Actions on Objective: The attacker ’s goal is completed, e.g., data exﬁltration or moving forward to compromise Industrial ControlSystems (this occurred in many famous APT attacks like in “Ukraine Power Grid”case [55])Although the attack described above might use never-seen-beforetools (e.g., a zero-day vulnerability in a Microsoft Of ﬁce document downloaded from the target’s website) to overcome security measures,the modus operandi of the attack is the one described above. So, whenthe companyﬁnds out that sensitive data, such as a part design data, hasbeen exﬁltrated, an investigation is to be conducted. Following theframework, the steps might be the following:1. Starting the investigation from the Installation CKC phase (D4I -Choose), artifacts belonging to this phase are identi ﬁed based on the proposed categorization and mapping (D4I - Identify). Among them,it is determined that there is a Run registry key created that starts acode located into an ADS. The key and the ADS stream were created atX1 timestamp (D4I - Correlate). At this point, the chain of correlatedartifacts contains a registry key and an ADS belonging to the Instal-lation CKC phase (D4I - Construct CoA).CoA: [/C0], [/C0], [/C0], [/C0], [Run Registry key, ADS], [/C0], [/C0]2. Afterwards, the artifacts belonging to Exploitation CKC phase (D4I -Choose) are identiﬁed (D4I - Identify). Having the X1 timestamp, it isfound that almost the same time an xlsﬁle was run by examining the folder where Microsoft Ofﬁce creates temporaryﬁles (D4I - Corre- late). At this point, the chain of correlated artifacts contains a registrykey, an ADS and an xlsﬁle (D4I - Construct CoA).CoA: [/C0], [/C0], [/C0], [xlsﬁle], [Run Registry key, ADS], [], []3. Artifacts belonging to the “Delivery”CKC phase (D4I - Choose) are identiﬁed based on the proposed categorization and mapping (D4I -Identify). Having all these artifacts identiﬁed, it is found that this xls is attached to an email (Email attachments, see the Delivery phase oftheTable 2) (D4I - Correlate). By analyzing this email, the IP address,say IP2, is found. At this point, the chain of correlated artifacts con-tains a registry key, an ADS, an xlsﬁle and an email (D4I - ConstructCoA).CoA: [/C0], [/C0], [email], [xlsﬁle], [Run Registry key, ADS], [], []A. Dimitriadis et al. Array 5 (2020) 100015
54. As the Weaponization phase (D4I - Choose) usually takes place in theattacker’s facilities, no artifacts belonging to this phase might befound on the system being investigated. However, we can determinehow the attacker created this xlsﬁle and if it contains a malware byanalyzing this xlsﬁle. Having done the latter, it is determined that thexlsﬁle contains a malware which contains the code found in the ADSstream.5. Artifacts belonging to the Command and Control phase (D4I - Choose)are identiﬁed (D4I - Identify). A covert communication channel withthe IP1 address using DNS protocol to transfer image screenshots isrevealed based on the ADS code existing in the CoA. PCAP ﬁles extracted from RAM revealed imageﬁles sent from the compromised system to the IP1 address (D4I - Correlate). At this point, the chain ofcorrelated artifacts contains a registry key, an ADS, an xls ﬁle, an email, and an IP address (PCAP) (D4I - Construct CoA).CoA: [/C0], [/C0], [email], [xlsﬁle], [Run Registry key, ADS], [IP], []6. Reconnaissance phase is selected (D4I - Choose), and its artifacts areidentiﬁed by following the proposed categorization and mapping ofartifacts. IP1 address from“Windows Firewall logﬁles”are identiﬁed and IP2 is also found on the web server ’s logﬁles (D4I - Correlate). At this point the CoA is:[Logﬁles], [/C0], [email], [xlsﬁle], [Run Registry key, ADS], [IP], []7. Actions on Objectives (D4I - Choose): PCAP ﬁles extracted from the RAM (Identify) shows exﬁltration of numerous imageﬁles which proves the conclusion made on step 5 (D4I - Correlate). The CoA is:[Logﬁles], [/C0], [email], [xlsﬁle], [Run Registry key, ADS], [IP],[imageﬁles]This section showed that the attack was investigated in a step-by-stepway applying the D4I framework. It was found that a phishing emailattack took place with the purpose of exﬁltrating data by taking screen- shots of the compromised system. The described procedure can beaccomplished automatically by implementing an algorithm ﬁnding cor- relations and visualizing the results to help forensics examiners.5. DiscussionFollowing the D4I framework, an attack can be revealed in a step-by-step way, as every phase is a direct consequence of the previous oneaccomplished. As the possibility for two artifacts to be correlated ishigher when they belong to the same or adjacent CKC phases than whenthey belong to distant phases, the examiner can rapidly correlate themand develop an understanding of the cyber-attack in the NIST ’
s analysis phase. For instance, the timestamp of opening a document containing amalicious VBScript and the timestamp of the creation of a start-up reg-istry key used as a persistent mechanism of a malware is usually almostthe same (once a malicious VBScript is run, a registry key is usuallycreated).With the proposed artifact categorization and mapping, digital fo-rensics examiners are able to identify (NIST ’s examination phase) all the traces/artifacts that an attack has left/created in each phase of CKC. Asthe traces/artifacts are associated with CKC phases, the examiners canrapidly correlate them and develop a thorough understanding of cyber-attacks (NIST’s analysis phase). For instance, a digital forensics exam-iner may decide to start the investigation beginning with the artifactsbelonging to CKC’s Installation Phase based on the fact that in order formalware to run after a system reboot it has to be installed on a start-uplocation. This way, he canﬁnd a registry key containing maliciouscode. The timestamp of this registry key can point an application run inthe system (e.g., Microsoft Ofﬁce). This application can be found byanalyzing the artifacts belonging to the CKC ’s Exploitation phase (e.g., Program Execution category). Moving to the CKC ’s Delivery phase andutilizing the all the forenamed information found (name of the applica-tion, registry key, timestamp) the investigation can continue in the samemanner.Finally, the result can synthesize a graph where nodes are the artifactsof the different phases (traces of the attack in this phase) and the links arethe relationship between them in terms of correlation points, such astimestamps, IP addresses, and processes. Essentially, this graph will de-pict the modus operandi of the attack and its corresponding traces get leftbehind. Therefore, the D4I can also be used for attack visualizationpurposes in terms of constructing attack graphs and signatures. Fig. 4is a sample high-level graphical representation of an outcome of this process.Considering all the above, by following this framework not only canthe attack be investigated, but the modus operandi and the signature ofthe attack can also be determined. As the signature is created using ar-tifacts, the attack is contextualized with them. Taking all the above intoconsideration, the D4I framework can be used for:1. Examination and analysis of cyber-attacks in a step-by-step way.2. Determining the modus operandi.3. Conceptualization of attacks using artifacts.Compared to D4I, no other digital forensics process focuses onleveraging CKC and artifacts to provide a way to conduct investigation ofcyber-attacks while being attack-agnostic. In addition to that, they do notoffer the level of details that the D4I offers. The processes that tried toprovide more details on the examination and analysis are presented inSection2.1. Compared to D4I, the SRDFIM is limited to providing thetechniques that a digital forensics examiner can use during the exami-nation and analysis. Also, it does not take into consideration the phasesCKC neither corresponding artifacts. The IDFPM focuses on leveragingprevious attacks to investigate new ones and so it does not attack-agnostic as D4I. Also, compared to D4I, the IDFPM does not focus onCKC neither on artifacts. Moreover, the IDFPM offers a high level ofdetails in examination and analysis. Another existing work is the CFFTPMmodel. CFFTPM tried to leverage an artifact categorization to providesteps on examination and analysis. However, it is limited to categorizeartifact as SANS has done. The work of SANS however is much moredetailed. Compared to D4I, the steps of CFFTPM is limited to analyzingartifacts themselves and not how to leverage them into investigation asD4I does. In this way, it seems to be myopic regarding the investigation ofcyber-attacks.6. ConclusionIn this paper, we proposed a digital forensics framework called D4I,providing a systematic approach for reviewing and investigating cyber-attacks. The D4I framework has two folds. First, it proposes a digitalartifacts categorization and mapping to the generalized steps of attacksknown as Cyber-Kill-Chain. Second, it provides detailed instructing stepsfor the examination and analysis phases. As a result, the D4I framework
Fig. 4.D4I framework visualization.A. Dimitriadis et al. Array 5 (2020) 100015
6provides a step-by-step way to investigate cyber-attacks that is not onlyattack agnostic but also provides sufﬁcient details for repeatable and effective investigation. Moreover, the D4I framework is designed so thatit can be scaled to other types of systems such other Windows versions,other OS (e.g., Android, Unix and iOS) as well as systems operating inSmart Manufacturing, such as SCADA, by creating similar categorizationsand mapping of artifacts into CKC phases. In addition, the D4I can beused in conjunction with the NIST Cyber Security Framework (CSF) [ 3] and more speciﬁcally it can be utilized as an Informative Reference of thesubcategory“RS.AN-3: Forensics are performed ”of the outcome function “Respond (RS)”. The D4I framework is not a complete forensics processnor does it replace other forensics processes, such as the one proposed byNIST, but elaborates the most critical phases of an investigation of acyber-attack, namely examination and analysis. Therefore, digital fo-rensics examiners can follow their preferable digital forensics processand apply D4I during the examination and analysis phases which arecommon within most of digital forensic processes.Our future research effort aims at mapping the attacks into CKC usingontologies of digital artifacts, with the ultimate goal of developing aprototype tool used to support investigations.DisclaimerAny mention of commercial products is for information only; it doesnot imply recommendation or endorsement by NIST.CRediT authorship contribution statementAthanasios Dimitriadis:Conceptualization, Methodology, Writing -original draft.Nenad Ivezic:Methodology, Writing - original draft.Boonserm Kulvatunyou:Writing - original draft, Validation.Ioannis Mavridis:Conceptualization, Methodology, Writing - review&editing.References
[1] University of Cambridge. Cyber risk outlook 2018 [Online]. Available: htt ps://www.jbs.cam.ac.uk/ﬁleadmin/user_upload/research/centres/risk/downloads/crs-cyber-risk-outlook-2018.pdf . [Accessed 5 September 2019]. [2] Coats DR. Worldwide threat assessment of the US intelligence community. 13 2[Online]. Available:https://www.dni.gov/ﬁles/documents/Newsroom/Testimoni es/2018-ATA—Unclassiﬁed-SSCI.pdf. [Accessed 17 March 2019]. [3]National Institute of Standards and Technology. Framework for improving criticalinfrastructure cybersecurity. Gaithersburg: National Institute of Standards andTechnology; 2018.[4] Culling C. Which YARA rules rule: basic or advanced?, SANS insitute. 6 July[Online]. Available:https://www.sans.org/reading-room/whitepapers/tools/paper/38560. [Accessed 5 June 2019].[5] OASIS Cyber Threat Intelligence (CTI) TC. STIX™version 2.0. Part 2: STIX objects. OASIS Cyber Threat Intelligence (CTI) TC, [Online]. Available: http://doc s.oasis-open.org/cti/stix/v2.0/cs01/part2-stix-objects/stix-v2.0-cs01-part2-stix-objects.html#_Toc496714313 . [Accessed 15 October 2019]. [6] Hutchins EM, Cloppert MJ, Amin RM. Intelligence-driven computer networkdefense informed by analysis of adversary campaigns and intrusion kill chains[Online]. Available:https://www.lockheedmartin.com/content/dam/lockheed-martin/rms/documents/cyber/LM-White-Paper-Intel-Driven-Defense.pdf . [Accessed 19 January 2019].[7]Tixteco MdCP, Tixteco LP, S /C19anchez P/C19erez G, Toscano LK. Intrusion detection using Indicators of compromise based on best practices and windows event logs. In: Cimp2016 : the eleventh international conference on internet monitoring and protection;2016. Valencia, Spain.[8] Robertson C. Indicators of compromise in memory forensics. February[Online].Available:https://www.sans.org/reading-room/whitepapers/forensics/indicators-compromise-memory-forensics-34162 . [Accessed 7 February 2019]. [9] ENDGAME. Mind the Detection Gap. Three things SOC teams must consider forearliest detection of unknown threats [Online]. Available: https://www.endgame .com/sites/default/ﬁles/Mind%20the%20Protection%20Gap.pdf . [Accessed 5 August 2019].[10]Sabry S. Serious threat hunting: hunting for advanced adversaries withoutIndicators of compromise. Abu Dhabi: RSAConference; 2016 . [11]Grance T, Dang H, Kent K, Chevalier S. Guide to integrating forensic techniques intoincident response. Gaithersburg: National Institute of Standards and Technology;2006.[12]Sachowski J. Implementing digital forensic readiness. Elsevier; 2016 . [13]Kohn M, Olivier MS, Eloff JH. Framework for a digital forensic investigation. In:ISSA; 2006. p. 2006.[14]Agarwal A, Gupta S, Gupta S, Gupta M. Systematic digital forensic investigationmodel. Int J Comput Sci Secur 2011;5(1):118 –30. [15]Årnes A. Digital forensics. WILEY; 2017 . [16]Association of Chief Police Ofﬁcers. Practice advice on core investigative doctrine. Centrex; 2005.[17]Owen B. Exploiting digital evidence artefacts: ﬁnding and joining digital dots. semanticscholar; 2018.[18]Ieong RS. FORZA: digital forensics investigation framework that incorporate legalissues. In: DFRWS (digital forensics research conference). Lafayette; 2006 . [19]Anson S, Bunting S, Johnson R, Pearson S. Mastering windows network forensicsand investigation. SYBEX; 2012 . [20]Bryant R, Bryant S. Polishing digital crime. England: Ashgate; 2014 . [21]Harichandran VS, Walnycky D, Baggili I, Breitinger F. CuFA: a more formaldeﬁnition for digital forensic artifacts. In: Digital forensics research conference.DFRWS); 2016.[22] Lexico - artefact. OXFORD, [Online]. Available: https://www.lexico.com/en/deﬁni tion/artefact. Accessed 1 5 2019.[23]Van der Waag-Cowling N, Leenen L. ICCWS 2019 - proceedings of the 14thinternational conference on cyber warfare and security. Stellenbosch - South Africa;2019.[24]Shumba R. Exploring the use of graph databases to catalog artifacts for clientforensics. In: ADFSL conference on digital foreniscs. Security and Law; 2018 . [25]Du X, Le-Khac N-A, Scanlon M. Evaluation of digital forensic process models withrespect to digital forensics as a service. arXiv. Cornell University; 2017. 5 August . [26]Hassan NF, Jaber HM. Ofﬂine vs. Online digital forensics of cloud-based services20.Journal of Al-Nahrain University; 2017. p. 117 –24. December 4. [27] ISACA. Overview of digital forensics [Online]. Available: http://www.isaca.org/Kn owledge-Center/Research/ResearchDeliverables/Pages/overview-of-digital-forensics.aspx. [Accessed 15 July 2019].[28]Arshad H, Jantan AB, Abiodun OI. Digital forensics: review of issues in scienti ﬁc validation of digital evidence. J Inform Process Syst 2018;14(2):346 –76. [29]Patil PS, Kapse AS. Survey on different phases of digital forensics investigationmodels. Int J Innov Res Comput Commun Eng 2015;3(3). March . [30]Selamat SR, Yusof R, Sahib S. Mapping process of digital forensic investigationframework. IJCSNS Int J Comput Sci Netw Secur 2008;8(10):163 –9. October. [31]Yusoff Y, Ismail R, Hassan Z. Common phases of computer forensics investigationmodels. Int J Comput Sci Inf Technol 2011;3(3). June . [32]Kyei K, Zavarsky P, Lindskog D, Ruhl R. A review and comparative study of digitalforensic investigation models. In: International conference on digital forensics andcyber crime; 2012. Berlin. [33]Beebe NL, Clark JG. A hierarchical, objectives-based framework for the digitalinvestigations process. Digit Invest 2005;2(2):147 –67. June. [34]Peasah K, Quayson E, Agyei O, Danso Ansong E. Survey of digital forensic modelsand proposed thematic scheme. Int J Comput Appl 2017;169(11):975 –8887. [35]Kohn M, Eloff M, Eloff J. Integrated digital forensic process model. Comput Secur2013;38:103–15.[36]Rogers MK, Goldman J, Mislan R, Wedge T, Debrota S. Computer forensics ﬁeld triage process model. J Digital Foren Secur Law 2006;1(2) .
[37] SANS Institute. Windows forensics analysis [Online]. Available: https://www.sans. org/security-resources/posters/windows-forensic-analysis/170/download . [Accessed 21 August 2019].[38] statcounter-GlobalStats [Online]. Available: https://gs.statcounter.com/o s-market-share/desktop-tablet-console/worldwide/#monthly-201810-201910 . [Accessed 11 December 2019].[39] Trend Micro Research. Security in the era of industry 4.0: dealing with threats tosmart manufacturing environments. 3 3 TRENDMICRO 2019 [Online]. Available:https://www.trendmicro.com/vinfo/us/security/news/internet-of-things/security-in-the-era-of-industry-4-dealing-with-threats-to-smart-manufacturing-environments. [Accessed 11 December 2019].[40]Gaj P, Skrzewski M, St/C19oj J, Flak J. Virtualization as a way to distribute PC-basedfunctionalities. IEEE Trans Indus Inform 2015;11(3):763 –70. [41] Pidgeon E. Powering the industry 4.0 revolution in manufacturing with windows 10and Microsoft cloud," Microsoft. 24 3. 2017 [Online]. Available: https://www.mic rosoft.com/en-us/microsoft-365/blog/2017/04/24/powering-the-industry-4-0-revolution-in-manufacturing-with-windows-10-and-microsoft-cloud/ . [Accessed 11 December 2019].[42]Falliere N, Murchu LO, Chien E. W32.Stuxnet dossier. Symantec; 2011 . [43]Hemsley KE, Fisher E. History of industrial control system cyber incidents. UnitedStates: Idaho National Lab. (INL); 2018 . [44] Assante MJ, Lee RM. The industrial control system cyber kill chain. October[Online]. Available:https://www.sans.org/reading-room/whitepapers/ICS/industrial-control-system-cyber-kill-chain-36297 . [Accessed 9 May 2019]. [45] FireEye. Spear-Phishing Attacks Why they are successful and how to stop them[Online]. Available:https://www.ﬁreeye.com/content/dam/ﬁreeye-www/global /en/products/pdfs/wp-ﬁreeye-how-stop-spearphishing.pdf . [Accessed 19 April 2019].[46] Bisson D. Three-quarters of organizations experienced phishing attacks in 2017,report uncovers. January[Online]. Available: https://www.tripwire.com/state-of-se curity/security-data-protection/three-quarters-organizations-experienced-phishing-attacks-2017-report-uncovers/ ; 2018. 24 Accessed 11 April 2019. [47]PhishMe. 2019 state of the phish report protect your organization from phishingattacks. PhishMe; 2019. [48]Wombat Security Technologies. State of phish 2019 report. 2019. Wombat . [49]Verizon. 2018 data breach investigations report. 2018. Verizon . [50]Verizon. 2019 data breach investigations report. 2019. Verizon .A. Dimitriadis et al. Array 5 (2020) 100015
7[51] Gartner. Gartnerﬁghting phishing - 2020 foresight. 19 7[Online]. Available: https ://www.gartner.com/en/documents/3883275/ ﬁghting-phishing-2020-foresight . [Accessed 1 September 2019].[52]Piggin R. Industrial systems: cyber-security ’s new battlefront [Information Technology Operational Technology. Eng Technol 2014;9(8):70 –4. [53]Nelson N. The impact of dragonﬂy malware on industrial control systems. United States: SANS Institute; 2016.[54] Virsec. Virsec hack analysis: deep dive into industroyer (aka crash override). virsec,[Online]. Available:https://virsec.com/virsec-hack-analysis-deep-dive-into-industroyer-aka-crash-override/. [Accessed 9 December 2019]. [55]Whitehead DE, Owens K, Gammel D, Smith J. Ukraine cyber-induced power outage:analysis and practical mitigation strategies. In: 70th annual conference forprotective relay engineers. CPRE); 2017. p. 1 –8.A. Dimitriadis et al. Array 5 (2020) 100015
8