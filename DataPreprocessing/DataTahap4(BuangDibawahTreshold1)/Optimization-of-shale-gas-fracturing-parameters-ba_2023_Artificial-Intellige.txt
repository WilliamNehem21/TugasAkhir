Resource-rich shale gas plays a pivotal role in new energy types. The key to scientifically and efficiently developing shale gas fields is to clarify the main factors that affect the production of shale gas wells. In this paper, according to the shale gas reservoir characteristic of the Fuling marine Longmaxi Formation, a single-well geological model was established using the reservoir numerical simulation software CMG. Then, 10,000 different reservoir models were randomly generated for different formation physical parameters, completion parameters, and fracturing parameters using the Monte Carlo method, and these 10,000 models were simulated numerically. The machine learning model uses a dataset of 10,000 different geological, completion, and frac- turing parameters as input and 10,000 production curves as output. Multiple machine learning regression methods were used to train and test the dataset, and the optimal method (GBDT algorithm) was selected, and the accuracy R2 of the test set of the GBDT prediction model is 0.96. A fracturing parameter optimization workflow was constructed by combining a production prediction model with a particle swarm optimizer (PSO). The process can quickly optimize the fracturing parameters and predict the production for each time by targeting the cu- mulative gas production under different geological conditions. The optimized parameters are Fracture Spacing,

characteristics of shale gas reservoirs (Onwunalu and Durlofsky, 2009; Williams-Stroud, 2008; Xu et al., 2015). Curtis et al. (Curtis, 2002) introduced the concept of shale and shale gas. They analyzed and compared the maturity, gas adsorption coefficient, reservoir thickness, organic content, and total gas volume of five shale reservoirs in the

development and that successful extraction of shale gas reservoirs re- quires hydraulic fracturing. Zhang (Zhang et al., 2009) investigated the effect of reservoir parameters and hydraulic fracturing parameters on the productivity of shale gas reservoirs using Eclipse software. Unsteady gas flow from matrix to fracture and multi-component gas desorption were considered. The matrix-fracture coupling factor (sigma) and frac- ture permeability were used to characterize the fracture network caused by fracturing. The effects of matrix and fracture permeability, non-Darcy flow coefficient, porosity, matrix sub-grid, channeling coefficient, rock compressibility, half-length, and spacing of prominent fractures on production were analyzed. WeiYu et al. (Yu and Sepehrnoori, 2013) demonstrated the accuracy of multi-stage hydraulic fracture numerical simulations for valuable Barnett Shale production data by factoring in gas desorption effects. Based on the Barnett Shale data, six uncertain parameters within a reasonable range are determined to finalize the optimal design based on NPV maximization for different gas price con- ditions. This integrated technique optimizes well location and hydraulic fracture treatment design to produce the best drainage area around the well. It gives insight into hydraulic fracture interference between single

Plackett-Burman-type linear experimental design method. Parameters such as the practical reconstruction volume, the number of primary fractures, and the length of prior fractures were optimized through sensitivity analysis. Zhu Dawei et al. (Zhu et al., 2020) developed a coupled local grid encryption-embedded discrete fracture model for fractured well production prediction. They adopted an orthogonal design to optimize parameters, including fracture length, fracture con- ductivity, and the number of fracture sections.

developed by comparing the prediction accuracy and prediction mean square deviation of multiple models. The coefficient of determination (R2) of both the training and prediction sets of AdaBoost and RF algo- rithms were higher and the prediction results were better. However, the mean square error difference between the AdaBoost training and vali- dation sets was large, indicating that the AdaBoost method had the problem of overfitting. As a result, Wang proposed developing the production prediction model utilizing RF rather than the AdaBoost method. Tan Chaodong et al. (Tan et al., 2020) used the fracturing construction history data of 200 existing wells and reservoir physical characteristics to develop a Bayesian neural network model to optimize the fracturing parameters. Principal component analysis (PCA) was employed to decrease the dimensionality even further. The Bayesian

(1) The application of machine learning techniques in optimizing shale gas fracturing parameters and predicting shale gas production is currently a trending area of research that demands further exploration to unlock its full potential. (2) Most studies get one data point, e.g., final recovery, daily oil (gas) production, etc. They are not a complete pro- duction curve, so it is impossible to use machine learning for parameter optimization and production prediction. (3) Because of the complex physical properties of shale gas reservoirs, most research models tend to be idealized, which significantly weakens prediction accuracy. Geolog- ical conditions of shale gas reservoirs and historical production data should be needed to ensure the accuracy of prediction models. (4) In the above research investigation, the small data set resulted in an insuffi- cient amount of data. When machine learning is then performed on the data, overfitting occurs, thus making the established prediction models perform poorly.

This study proposes a complete workflow for optimizing fracturing parameters in horizontal shale gas wells, combining reservoir numerical simulation with machine learning to generate a machine learning model and using particle swarm algorithm (PSO) to optimize fracture param- eters. Section 2 describes the machine learning methods used in this study, and the workflow is illustrated. Section 3 develops the reservoir geological and numerical models for the target block. Section 4, a shale gas horizontal well-fracturing dataset is obtained by numerical simula-

This section describes the methodological principles and the work- flow of the main algorithms used in the study. The methods used include machine learning methods (Wang et al., 2023) (Linear Regression (Kavitha S et al., 2016; Lim, 2019), Support Vector Machines (SVM) (Cios et al., 2007; Vapnik, 1999), Decision Tree (DT) Regression (Wang and Xia, 2017), Gradient Boosting Decision Tree (GBDT) Regression, Random Forest (Brieman, 2001; Gamal et al., 2021)), and Particle Swarm Optimization (PSO).

The particle swarm optimization was first proposed by Kennedy (Kennedy and Eberhart, 1995), an American psychologist, and Ebert Art, an electrical engineer, in 1995 as a new parallel metaheuristic algo- rithm. The algorithm simulates the mechanism of cooperation in the flock foraging behavior of organisms such as flocks of birds and fish in nature to find the optimal solution to the problem (Fernandez-Martinez et al., 2008).

The Meta-heuristic Algorithm is a heuristic algorithm modification created by merging a stochastic algorithm with a local search algorithm. Meta-heuristics is an iterative generating process that allows for study- ing and exploiting the search space with heuristic algorithms via the clever mixing of many notions. Learning tactics are utilized in this process to collect and master knowledge to locate near-optimal solutions effectively.

prediction models and analyzing data effectively. To ensure the comparability of these parameters, it is necessary to standardize the original data. By applying data standardization techniques, we can eliminate the impact of varying magnitudes among the parameters, facilitating more reliable and meaningful analysis.

In the field of data standardization, two commonly employed methods are Z-score normalization (Jain et al., 2005; Zou et al., 2020) and Min-max normalization (Kim et al., 2021). Z-score normalization, also known as standardization, is a widely recognized data standardi- zation technique. It involves transforming raw data into a standard normal distribution with a mean of 0 and a standard deviation of 1. This method is useful as it eliminates the scale differences among different variables in the dataset, making the data comparable and facilitating meaningful analysis.

Step 2: Database generation. The 10,000 sets of varying reservoir models are randomly generated and simulated using the Monte Carlo method to obtain the corresponding 10,000 sets of production curves for the orientation of different reservoir physical parameters, completion parameters, and fracturing parameters. Multi-factor sensitivity analysis is performed on these parameters.

Step 3: Machine learning model building and application. The data set from Step 2 is used as the input for the machine learning model with 10,000 different sets of geological, completion, and fracturing parameters and 10,000 different sets of production curves as the output. The best method (GBDT algorithm) is then chosen by training the data set with various machine learning regression techniques.

Shale reservoirs have extremely low permeability and microfractures with different degrees of development. The overall performance is characterized by dual pore, so a dual pore dual permeability model is usually established to simulate the shale numerically. A single-well numerical model of a shale multi-stage fractured horizontal well is built using the geological characteristics of the Upper Ordovician Wufeng Formation reservoir and the engineering parameters of hori- zontal wells in the Sichuan Basin and its outlying areas.

prediction accuracy of the neural network model developed in this study (Ottah et al., 2015). The value of R2 runs from 0 to 1, and the higher the number, the better the model fit. The formula for calculating R2 is as follows.

ume increases to a certain level, a further increase in Langmuir volume significantly improves gas well production. As the Langmuir volume increases, the proportion of adsorbed gas in the matrix increases, although the free gas content does not change. With 30 years of cumu- lative production, the adsorbed gas recovery is increasing as the free gas is continuously recovered.

The Particle Swarm Optimization protocol (PSO), a well-known meta-heuristic global optimizer, to determine the optimal design of fracturing parameters. The PSO algorithm is combined with a trained Gradient Boosting Decision Tree (GBDT) model, which serves as a fitness evaluator for a large set of project design parameters. By employing the GBDT model, the computational burden of the optimization process is significantly reduced, allowing for a larger number of PSO iterations.

Different machine learning models have other production pre- diction effects. By comparing five production prediction models, we concluded that GBDT and Random Forest yielded R2 of 0.96 and 0.93, respectively, and they predicted models with better prediction performance than Linear, SVM, and Decision Tree Regressor. Through more in-depth testing and training, the final study concluded that the GBDT model was used to predict single well capacity and evaluate fracturing effectiveness.

