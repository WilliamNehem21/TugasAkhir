This paper aims to address the propagation delay problem by inves- tigating the hypothesis that a network overlay that considers geograph- ical displacement and latency between nodes will reduce information propagation delay. Specifically, this paper contributes and critically analyses new network clustering methods, which are named as follows: Locality Based Clustering (LBC), Ping Time Based Approach (PTBC), Super Node Based Clustering (SNBA), and Master Node Based Clus- tering (MNBC). We demonstrate that the proposed protocols mitigate the information propagation delay issue which reduces the chances of successful double spending attacks occurring. To complete our security evaluation of these protocols, we investigate the inherent tension be- tween forming organised, low information propagation delay networks and providing robustness to partition-style attacks. We present an anal- ysis of the security implications of these protocols, and show that these protocols can be applied in the Bitcoin network without significantly compromising security.

The rest of the paper is organised as follows. In Section 2, strate- gies for speeding-up information propagation are discussed. Section 3 presents the problem and lists the contributions. We describe the Bitcoin network and the proposed clustering protocols in Sections 4 and 5. The experimental setup and the performance evaluation results are presented in Section 6. In Section 7, a security evaluation of the proposed protocols is presented. We conclude in Section 8 and outline future research directions.

Several works have considered reducing the information propa- gation delay by minimising the time taken to complete information (transactions or blocks) verification. When a node receives a transac- tion, it verifies whether it is valid or not. If the transaction is valid, the node forwards it to its neighbours. Alternatively, invalid transactions are discarded. The idea of reducing block verification time was adopted in [2]. The authors proposed the minimise verification protocol as a

on several local computers at each node. As all parts represent the same user, the used public/private keys will be the same for all those parts. On the other hand, each part has a different portion of the public ledger. Results in [13] demonstrated that the verification time can be reduced by 71.42% if the blockchain is divided at a given node on five computers. It is hypothesised that an improvement in the information propagation delay could be achieved when the number of divisions

Research that focused on speeding-up information propagation in conjunction with minimising the blockchain size was proposed in [8]. This approach improved the scalability of the blockchain by increasing the security for off-chain blocks using the miners. In this approach min- ers are responsible for keeping track and protecting the soft forks that are linked to the main blockchain. Miners are considered to be a trusted third party and the approach provides them with more control over the Bitcoin network. This approach is contrary to the decentralisation concept of Bitcoin; it results in a reduction in security awareness. Such soft forks are subject to the so-called 51% attacks due to their reduced hash rates.

The network distance between the initiator of a block and the nodes is deemed to be one of the most important causes of the propagation delays in Bitcoin. The study in [2] claimed that information propaga- tion delays could be improved by increasing network connectivity. This can be achieved by creating a star sub-graph topology, which forms a central communication hub between nodes. A novel network topology

network from being controlled by malicious nodes [18]. Unfortunately, the proposed network topology introduces severe security risks due to the fact that nodes are permitted to maintain many connections to other nodes. This may enable malicious nodes to disturb and control the network.

Maximising proximity when establishing connectivity is the aim of the approach proposed in [6]. This change increases the geograph- ical connectivity of the Bitcoin network by making use of several coordinator nodes, known as CDN Bitcoin clients. These CDN Bitcoin clients are then distributed strategically across the Bitcoin network. Their role is to search and recommend Bitcoin network nodes to each other, based on geographical locations. A CDN client measures the geographical distance between the discovered nodes and other CDN

A transport protocol layer known as FIBER (Fast Internet Bitcoin Relay Engine), was introduced in [19] to reduce the information prop- agation delay. FIBER focused on the reduction of the delay caused by packet losses incurred in the UDP layer with forward error correction. FIBER reduces network traffic by using data compression. The approach in this paper introduces a Bitcoin network protocol that is easily inte- grated with FIBER. Finally, an optimisation protocol proposed in [20] increases network connectivity by making use of geographical prox-

peers into clusters. However, their paper does not carry out security evaluations to test if the proposed clustering protocol compromises security. In contrast, in this paper we evaluate the security of several brand new clustering protocols. As far as we are aware, this is the first work in which such a contribution is presented.

attack was measured in [2] by developing an analytical model of Bitcoin. The authors in [2] observed some correlation between the propagation delay and the size of a message. As adversarial forks of the blockchain can still introduce the possibility of double spending, the contributions in [8,9] suggested that reducing the possibility of accidental forks would help avoiding double-spending attacks. For the

spending attacks at the right time before delivering the products. A node adds a transaction to its pool and forwards it to the other nodes if the transaction is received for the first time. In the case where the received transaction has already been seen, the node forwards the transaction without adding it to its pool. This enables the reception

Finally, a prototype system was proposed by [21] to overcome double-spending attacks in vending machines. This system achieves a fast payment with a 0.088 probability of a double-spending attack occurring, by making use of a server that keeps track of transactions.

Performance Evaluation: We examine the role of clustering in the Bitcoin network to reduce the average latency of information delivery between peers without compromising security. We propose and evaluate four clustering approaches: (1) Location Based Clustering (LBC), (2) Bitcoin Clustering Based Ping Time protocol (PTBC), (3) Bitcoin Clustering Based Super Node (SNBA) and finally, (4) Master Node Based Clustering (MNBC). The LBC protocol aims to improve the connectivity in the Bit- coin network by prioritising geographically close connections between nodes. The PTBC approach seeks to optimise the overlay topology by creating distinct but connected clusters of peers, which have Peer-2- Peer (P2P) latencies specified under some intra-cluster threshold. The aim of the SNBA approach is to generate a set of geographically diverse clusters. The MNBC protocol relies on several nodes, known as masters, to achieve fully connected clusters based on Internet proximity and random peer selection.

Decentrality is one of the key features of Bitcoin. A distributed protocol is maintained to support the system [23]. Each peer runs the Bitcoin protocol and connects with other peers over a TCP chan- nel [24]. As the Bitcoin network topology is not established based on proximity, selecting which peers to connect with, is undertaken

nections [25]. Nodes can join and leave the network at any time. When a node re-joins, it asks other nodes for new blocks to complete its local copy of the blockchain [26,27]. To mitigate DoS attacks, only valid transactions and blocks are propagated on the network [28]. Bitcoin nodes take different roles in the network based on the functionality

that they support such as wallet services, routing, etc. As Bitcoin relies on distributed validation, an essential function is that of validating transactions in a distributed manner. This role is performed by all nodes in the network [25]. To participate in the Bitcoin network, all nodes have to support the routing function. This function includes validation and propagation of transactions, and maintaining connections to other nodes.

that are discovered. Establishing connections to other nodes is done without taking into account node proximity as the Bitcoin network topology is not established based on proximity [2,6]. To establish a TCP connection, a handshake with a known peer is handled by sending a version message which contains basic identifying information. A peer responds to the version message by sending a verack message. Each peer caches the IP addresses of peers that are connected to it. To stop peers misbehaving, each node assigns a penalty score to each node connected to it. The score is increased when an unreliable behaviour is announced.

can be returned by a single DNS query [25]. In the Bitcoin network, there are six DNS seeds that periodically crawl the entire network to obtain active IP addresses. There are two scenarios where DNS seeders are queried by other nodes. The first scenario is when a node that joins the network for the first time, tries to connect to active IP addresses. In the second scenario, the DNS seeder is queried by a node that restarts and attempts to reconnect to new peers. In this case, the DNS query is

In the PTBC protocol, the distributed algorithm principle is fol- lowed. Each node runs the protocol independently based on proximity information collected from local neighbours and discovered nodes. Each node gathers proximity knowledge about the discovered nodes by calculating the Internet distance between itself and the Bitcoin nodes that it has discovered. This can be done by measuring the round-trip

grouping peers based on a specific criteria. By grouping peers according to their geographical proximity, we can further speed-up information broadcasting in the network. A hierarchical Bitcoin overlay network that clusters nearby peers might achieve faster information propagation than the original Bitcoin system. In this paper, the concept of super- peers is applied to the Bitcoin network to increase connectivity between peers that are close in a geographical sense.

introduced in [27]. This simulator, and the parameters which guide its operation, are described first. These evaluations look to determine the gains achieved by the different delay reduction hypotheses investigated in this paper. Headings for these hypotheses and our conclusions are listed below to outline the structure of the rest of this section.

Geographical Distance vs. Latency: Protocols that attempt to form an overlay based on link latencies yield smaller information propagation delays. The PTBC protocol has a smaller delay variation compared to the LBC protocol. This is explained by the fact that geographically close nodes might in fact be far away when this distance is measured using Internet distance.

Clusters are fully connected by their edge nodes and master nodes with the aim of improving the security and performance of the MNBC protocol. Edge nodes are selected between every pair of clusters. They are selected to be the closest pair of nodes in the Internet that belong to two clusters and are selected using the same strategy of border node selection that is used by the LBC protocol in Section 5.1. The one difference is that the distance between the two nodes is a measure of the link latency.

the client heard back from the peer (reception of a pong message). The link latency was measured by calculating the time difference between sending a ping message to the peer, and receiving a pong message back. To maintain large scale and distributed measurements, the client periodically scanned the network and applied the same scenario of measuring the link latencies.

As the developed model simulates information propagation in the Bitcoin network, the size of the network matters because the number of nodes has a direct impact on the range of propagation delays that will be observed. The size of the Bitcoin network was measured using the same crawler in Section 6.1.1. The crawler was able to measure the size of the network by discovering the available IP addresses in the network and by trying to connect to them. The size of the Bitcoin network was

The experimental setup that is used to evaluate the performance of the LBC, PTBC, SNBA, and MNBC protocols is now explained. We consider four different simulation scenarios, one for each of the pro- posed protocols. In each simulation, the size of the network matters as the evaluation is based on the transaction propagation delay. The size of the network in each simulation matches the size of the real Bitcoin network which was measured in our previous work [22]. Each node

The most likely cause of the higher variances of delays in the SNBA protocol is the fact that the information flow between clusters in the SNBA protocol can only be achieved by supers peers. This causes a shortage of transmission channels between clusters which results in inefficient information distribution over the network. The lack of connections between clusters in the SNBA protocol was tackled in the MNBC protocol by considering the edge nodes technology, which added an extra connection channel between clusters. Faster information propagation was achieved by the MNBC protocol compared to the SNBA protocol. Even though the LBC protocol delivered faster transaction propagation compared to the SNBA protocol, the lowest variances of

We evaluate the potential for partition attacks occurring on the proposed protocols as well as on Bitcoin. Partition attacks split the network into a number of sub-partitions and block the data flow among them [45]. In the Bitcoin network, partition attacks affect the main system functions, which in turn, negatively impact user trust. We adopt an attack model, which consists of three steps:

networks exhibited more resistance to attacks. In summary, the larger the network, the greater the resistance to partition attacks. Crucially, we report that the Bitcoin protocol achieves the largest minimum vertex cut out of all evaluated protocols. The SNBA protocol has the minimum vertex cut. Both, the PTBC and LBC protocols have low resistance to

Robustness to partition attacks and double-spending attacks are achieved by different mechanisms. The larger the network, the greater the resistance to partition attacks. The faster the infor- mation propagation time, the greater the resistance to double- spending attacks. The Bitcoin protocol achieves the largest min- imum vertex cut, which is a measure of its resistance to parti- tion attacks, however, attackers would need significant computa- tional resources to split the network topologies generated by the protocols proposed in this paper.

