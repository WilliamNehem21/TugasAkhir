Detecting invertebrate pests on crops at early stages is essential for pest management. Traditionally, traps were used to sample pests and then human experts undertook classification and counting to estimate the levels of infestation, which is subjective, error-prone and labour intensive. Recently, semi-automatic pest detection is possible by using computer vision technologies to classify and count pest samples in laboratories or insect traps, however, the decision made by the laboratory-based or trap-based approaches are still too late for more optimised pest management decisions. Today, precision agriculture needs detection of pests on crops so that real-time actions can be taken or optimised decision can be made based on accurate information of time and location pest occurs. In this study, we used computer vision and machine learning technologies to detect inver- tebrates on crops in the field. We first evaluated the performances of the state-of-art convolutional neural net- works (CNNs) and proposed a standard training pipeline. Facing the challenge of rapidly developing comprehensive training data, we used a novel method to generate a virtual database which was successfully used to train a deep residual CNN with an accuracy of 97.8% in detecting four species of pests in farming environ- ments. The proposed method can be applied to a robotic system for proximal detection of invertebrate pests on crops in real-time.

Invertebrate pests are difficult to control and the losses caused by them are huge (Oerke 2006). Invertebrate pests can feed on leaves, af- fect photosynthesis and infect diseases (Nalam et al. 2019). In six major Australian grain crops, the estimated annual loss from inverte- brate pests is $359.8 million (Murray et al. 2013). Although there are bi- ological and chemical methods for pest control, biological control has to be carefully used for specific species and heavy doses and uniform pes- ticide applications have caused serious problems of pesticide resistance, environmental pollution and killing of beneficial species, such as bees (Liu et al. 2016b).

Increasing challenges for pest control and the need for better on- farm efficiencies are driving the implementation of integrated pest management (IPM) which involves pest detection, application of appro- priate management methods and recording the result of the manage- ment action applied (Boissarda et al. 2008; Kogan and Hilton 2009). Early pest detection and estimation of potential infestation and yield loss are essential for a successful IPM program. Traps, sweep net or beet sheets (GRDC 2014) are widely adopted for systematic pest

Early detection of pests on crops can ensure appropriate and timely management decisions. First, it can provide an accurate time when crops are attacked; second, it can provide the exact location where crops are infested; third, based on the time, location and species, a ro- botic system can take actions in real-time, such as selective spraying, or the information could be analysed in an IPM system to make more optimal decisions (Liu et al. 2016b). However, detecting pests in natural

nologies to detect common pests on crops in South Australia. First, we created a ten-class database to evaluate the performance of the state- of-art CNNs for pest classification and developed a standard training pipeline. Then we used a novel method to generate virtual images to create an optimised five-class database. The model trained using the vir- tual database had a high classification accuracy and can be applied to proximally detect pests on crops.

After evaluating the performances of the CNN models, the trained model on the 10C-database had the highest av was considered as the best model on this database and it was named M10C. The training pipe- line returning the M10C was considered as the standard training pipe- line. The standard training pipeline was applied to the 5C-database to train another model M5C. M10C and M5C were tested using indepen- dent images collected by smartphones in real farming environments. The images were either collected in day time using solar illumination or at night using artificial illumination and the background included multiple crops and fruit trees.

The M5C model achieved a positive testing result with an overall ac- curacy of 97.89%, true positive rate of 75.90% and true negative rate of 98.78%. This achievement was obtained by cutting down the intra-class variance of background, reducing the number of classes and enlarging the size of the database. The class of background in the 5C-database was mainly composed of green leaves without flowers and dry plant residuals so to simplify the classification. In real

