Understanding the context of the scene is one of the most important aspects for new generation of autonomous vehicles. It is a very trivial task for a human to recognize the scene context by only a single look at the picture, however, for a computer, it is still a challenging task. This problem can be solved by automatic data labeling using deep-learning models for scene classification. Relying on scene type labels we can select relevant scenes to prepare a balanced dataset to train more advanced instance detection models using data from a specific road condition.

This study presents a novel framework based on a deep convolutional neural network (CNN) for the automatic road scene classification of street-level automotive images. For the evaluation of our approach, we use a well-known autonomous benchmark dataset, from which we extract geo-position data and combine them with predictions from the scene classification model to get ground truth labels to train and evaluate a ResNet-50 model for scene classification. The results and comparison with state-of-the-art methods are presented.

Current achievements in image classification are significant, al- though the majority of efforts build to classify a wide range of image categories [1,2]. Deep convolutional neural networks have been show- ing impressive classification results and continuous improvement on the object-centric ImageNet classification benchmark [3]. However, scene categorization is an important step for further improvement of visual perception for autonomous driving. The scene-centric Places- CNN, for scene classification/recognition introduced in work [4], which has been trained on 2.5 million images from 205 scene categories of places, including outdoor scenes. An extended version of the dataset with 2.1 images for classification of 365 categories has been presented in work [5]. The scene-level task is more challenging in comparison to the object-centric task feature learning due to the larger diversity of scenes and the number of possible combinations in scenarios.

In most cases, autonomous datasets do not provide traffic scene labels, but only object-level attributes and a general description of the dataset in original paper [10]. In some cases, we have scene categories per video clip without precise per frame annotation [10]. However, the annotation of traffic condition is not provided. Visual analysis and labeling of road scenes would be very time-consuming for automotive datasets.

In this paper, we study image classification in the context of road scene classification for automotive datasets. Our focus is on scene categorization/classification is based on a single image for categories as urban, rural, highway road scenes. In order to achieve it, we use two convolutional neural networks, one to obtain a scene labels out of object-level classes. The image-based scene labels have been combined with the output of our map-based approach, which is using spatial

The remainder of the paper is organized as follows: Section 2 gives a review of related works and Section 3 explain our proposed methodology and system architecture. Section 4 presents the results of scene classification for proposed methods. Finally, we conclude by discussing of our results and avenues for further research.

Image classification in general. The problem of image classification was initially on developing classification systems which would archive the best possible accuracy results on PASCAL VOC competitions [1]. One of the best where best approaches [12,13] are based on extraction of many low-level local features, coined to one histogram and non-linear kernel classifiers such as Support-vector machine (SVM) are used to perform classification. The next step in performance has been obtained with spatial Fisher vectors (SFV) [14,15] which aggregate local descriptors features, encoding them with statistics, fit a Gaussian Mixture Model (GMM), and feeding them to kernel SVM classifiers. However, in 2012 it was shown that Convolutional Neural Networks (CNNs), so-called AlexNet [16] trained in a supervised fashion on ImageNet dataset outperformed the Fisher vectors. Next-generation of depth network architectures further improved classification accuracy: VGGNet [17], GoogLeNet [18], ResNet [11] shown that network depth is a crucially important for reach a success.

Traffic scene classification. Early work in the image-based scene clas- sification proposes to use the probability of each object detected on the image converted to a vector in order to classify the scene, where each object consider as a typical for one of the scene classes [19]. Another common approach for the scene classification is using semantic labels. In the work, [20] scene semantic segmentation labels were used to classify 13 urban texture classes, including different types of road layouts, the presence of cars, pedestrians, and a pedestrian crossing in front of the vehicle. In the papers [21,22] semantic labels used for the understanding of traffic scenes, CNN semantic segmentation network was trained on images taken from the same location, but under different weather or illumination conditions.

In the paper, [9] pooled features extracted from DenseNet-121 deep network architecture were used to train SVM classifier with RBF kernel for such traffic scene classification: highway, road, tunnel, exit, settlement, overpass, booth, traffic. Another recent work [23] presented a traffic scene classification method based on resent-50, fine-tuned and pretrained on the Places365 dataset. In addition, standard Long short- term memory modules (LSTM) architectures were added, which allow improving results by the temporal aspect.

Image classification for spatial data. An urban scene recognition based on spatial data, which in most cases satellite images, which has im- portant application value in improving urban land use rate and land use monitoring [24]. A deep-network strategy actively used in order to predict geographical objects by exploring deep features of the high- resolution imagery [25]. Such an approach helps to extract semantic contents of the area and generate high-resolution semantic maps, which might play a crucial role in carving out the path ahead for autonomous vehicles. Another way to get semantic labels is using OpenStreetMap (OSM) [26], the project is established to share a knowledge collective that provides user-generated street maps. Each map is consists from

The residual network ResNet-50, which was trained on a custom dataset containing images from popular autonomous datasets (e.g., KITTI, nuScenes) to detect the occurrence of urban, rural, and highway scenes, despite weather and light conditions, with distributed attention to a different level of details on the scene.

Urban condition. By urban area condition, we assume that it is a built- up area, with a high population density and infrastructure of the human-made environment. Mostly, it is a public road in the city district or residential neighborhood, with dens residential buildings, where potentially could be largely populated by people and many public places.

Rural condition. In the rural area condition, we could consider an opposite situation to urban, with a low-density population and with a low number of total man-made infrastructure. Such areas are away from the city, on the scene you can see a lot of vegetation.

Highway condition. The highway definition can be simply described as the main or public road. Most public roads have at least two lanes, one for traffic in each direction, separated by lane markings. The highway road is comparably easy to distinguish from urban and rural since the most distinctive feature is that the dominant place is taken by the road itself. However, highways can lay down through a city or countryside, which implies many elements inherent in urban and rural conditions. On most road maps the highway roads are usually marked as a dark yellow or orange color.

An architecture of Places-CNNs based on popular object detection CNNs architectures, AlexNet, GoogLeNet, and VGG16 convolutional- layer CNN. Visualization of the attention zone of the CNNs trained on Places shows that object detectors emerge as an intermediate represen- tation of scene classification. Places-CNN trained on a highly diverse number of scenes, more than 1.8 million images, to predict scene out

The residual network architecture archived top results for object de- tection and localization tasks in the 2015 ImageNet Large Scale Visual Recognition Challenge (ILSVRC), with 3.57% error on the ImageNet test set. ResNet-50 is a convolutional neural network that is 50 layers deep with a skip connection to fit the input from the previous layer to the next layer without any modification in shape. This allows improving the speed and performance of the network comparing with other

The experiment is implemented using PyTorch v1.8.1. Out of 3276, we left 1080 images to have the same number of images for each class. Then data was divided into train, validation, and test sets, in proportion 70/10/20, where 756 images belong to train, 108 images to validation,

The hyper-parameters for training are set as follows. The learning rate is initialized to 0.001 with momentum 9%, a decay learning rate by a factor of 0.1 every 7 epochs. The size of the batch is 4. Also, the last layer of the pretrained model is replaced with a new Softmax layer, which is relevant to the number of 3 classes.

In order to improve the training process, we apply random trans- formation functions. At first, with a certain probability algorithm crop a random portion of an image and resize it to size 224 to 224 pixels. Secondly, with a probability of 0.5, it horizontally flips our images. Finally, we do normalization of the images.

The paper [29] shown that data augmented by adding new images provide better results of accuracy and the training process goes faster comparing to the traditional way of data augmentation with the same amount of images to train on. In order to improve the result of our model, we decide to extend our dataset up to 1779 images, where 1419 images belong to train, and the same 177 images for validation and test sets respectively. Adding horizontally flipped images as a new image in combination with random crop and resize should provide the model more features and generalize the model.

Taking into account all those factors it is planned to experiment with other state-of-the-art datasets where image conditions might be different and more diverse. Another promising direction would be to use unsupervised methods for scene classification based on clustering techniques using embedding features from convolution layers. We be- lieve that scene condition labeling can be used for both online and offline applications such as semantic mapping of autonomous datasets and driving assistance.

