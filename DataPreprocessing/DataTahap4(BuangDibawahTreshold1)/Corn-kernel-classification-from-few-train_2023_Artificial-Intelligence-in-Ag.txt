This article presents an efficient approach to classify a set of corn kernels in contact, which may contain good, or defective kernels along with impurities. The proposed approach consists of two stages, the first one is a next-generation segmentation network, trained by using a set of synthesized images that is applied to divide the given image into a set of individual instances. An ad-hoc lightweight CNN architecture is then proposed to classify each instance into one of three categories (ie good, defective, and impurities). The segmentation network is trained using a strategy that avoids the time-consuming and human-error-prone task of manual data annota- tion. Regarding the classification stage, the proposed ad-hoc network is designed with only a few sets of layers to result in a lightweight architecture capable of being used in integrated solutions. Experimental results and com- parisons with previous approaches showing both the improvement in accuracy and the reduction in time are provided. Finally, the segmentation and classification approach proposed can be easily adapted for use with other cereal types.

of this cereal in the world economy, it is imperative to define standards in its commercialization processes and quality analysis is one of them. At present, the quality analysis of corn kernels is carried out manually by experts (e.g., Paulsen et al. (2019)), however, this task is tedious, complex, and prone to errors, since there is a visual and subjective in- spection process.

As mentioned above, it is necessary to define policies and standards that allow fair trade (e.g., Bacon (2005), Naylor (2017), Wilson (2010)); subjectivity should be eliminated from the quality analysis process. In recent years some approaches have been proposed for the analysis of the quality of different types of kernels. In general, these new approaches are based on the usage of deep learning techniques (e.g., Velesaca et al. (2020), Shamim et al. (2020), Singh and

instance segmentation, and classification, as normally proposed in these types of solutions Velesaca et al. (2021b). In the first stage, a novel strategy is proposed to avoid the time-consuming data annotation pro- cess. In the second stage, an efficient and lightweight architecture is proposed, which overcomes state-of-the-art corn kernel classification approaches The core idea is to implement an independent lightweight classification module that may be used independently in further appli- cations. The manuscript is organized as follows. Section 2 presents works related to the segmentation and classification problems. Section 3 presents the approach proposed for classifying elements from the given sample set, together with a summary of the dataset generated for the current work. Experimental results and comparisons with different approaches are given in Section 4. Finally, conclusions are presented in Section 5.

In Shao et al. (2021), similar to the previous work, the author per- forms the segmentation of grains on the ears, but with rice kernels, it uses the LC-FCN semantic segmentation network to perform the segmentation of rice ears, then applies the Watershed algorithm Roerdink and Meijster (2000) to obtain all individual instances present in the image. The experimental results obtained by the authors show better results than traditional machine learning methods and SSD object detection algorithms. The model allows the calculation of the number of ears of rice in the field and provides basic data to estimate the yields of rice production. Like the previous work, it has the problem that the im- ages were manually labeled, which represents a time-consuming task. The Watershed segmentation technique used by the authors is very sensitive to lighting conditions, resulting in an over-segmentation and generation of a greater number of instances than there are.

Once every single instance from the given image is segmented, they need to be classified according to the categories defined in the final application. Recently, some approaches for the corn kernel classification problem have been proposed, especially focused on determining the quality of the grain to minimize time and costs in the verification pro- cesses. For instance, in Cheng et al. (2019) the authors propose a pattern recognition-based technique to detect contaminated corn kernels using a back-propagation neural network; the main limitation of this approach lies in the fact that kernels should not touch each other. Also, there is another technique based on the Fourier transform using near-infrared images, with which the most representative characteris- tics were extracted to evaluate their quality Qiu et al. (2018). Another work focused on the corn kernel classification problem has been pre- sented in Qiu et al. (2019), where the authors introduce a corn classifi- cation algorithm that extracts the most representative features to differentiate between good and defective corn kernels. The success of this approach depends on a pre-processing and normalization process. Another approach that performs corn classification of three types of

grades (A, B, C) is presented by Wu et al. (2018). This technique is based on a support vector machine to perform the classification. In Ali et al. (2020) the authors also present a corn seed classification technique using hybrid features to determine the corn seed quality. This approach has been developed using Random Forest Breiman (2001), BayesNet Pearl (1985), LogitBoost Friedman et al. (2000) an MLP model, which reaches the best results.

Also, in Li et al. (2019), the authors propose a deep learning-based technique to discriminate different defective types of corns. In the same way, in Ni et al. (2019) the authors propose the use of very deep convolutional networks, such as VGG Simonyan and Zisserman (2015) and Residual Network (ResNet) He et al. (2016), which performs the task of classification on dual touching kernels. Recently, another classification technique has been presented in Javanmardi et al. (2021), it follows a multiclass classification approach of corn grain using a convolution network to extract the most representative charac- teristics. The authors just use the CNN to extract representative features, but not to perform the whole classification process.

The dataset generation process consists first of taking different samples of corn kernels according to the three categories considered in the current work (i.e., good grains, defective grains, and impurities). Samples from each category are manually grouped to avoid further image annotation tasks. Then, a set of images from each of the three clusters are acquired with a 12MP camera orthogonal to the background plane (A4 sheet) containing the samples in a natural lighting scenario. Each image contains just the A4 sheet with the instances regularly dis-

linear unit, which is an activation function based on a ReLU that serves to avoid sparse gradients at training time, not pruning the negative part to zero during backpropagation. To measure the loss of the training a cross-entropy loss function has been used. The model ends with two fully connected layers to flatten and connect the features extracted onto the output layer. The CK-CNNLW network has been trained with a learning rate of 0.00027, in order to generalize the model, which provides a faster convergence.

The model could be used to perform a multiclass classification problem, changing only the last layer according to the number of classes to be classified. In our case, this model has been used for a 2-class clas- sification (good or defective corn kernels) and a 3-class classification (good corn kernels, defective corn kernels, and impurities). The CK-CNNLW network has been trained from scratch using Nesterov ADAM (NADAM) optimizer with a learning rate of 0.000275, and leaky-relu of 0.15 for average pooling and max-pooling layers. A Titan V NVIDIA GPU was used to train our model, this process takes only 5 h given the simplicity of our model. The obtained results have been com- pared with the previous approaches, including networks of the state of the art like VGG Simonyan and Zisserman (2015) or ResNet He et al. (2016), these comparisons are presented in the next section.

images of impurities). Finally, regarding the validation process, a total of 2060 images are considered (700 images of good corns, 700 images of defective corns, and 660 images of impurities). All the images avail- able for the training and testing processes have been enlarged through the application of data augmentation techniques, performing opera- tions of rotation, flipping, and horizontal and vertical shifts, to ensure the effectiveness and faster convergence of the model to be trained.

segmentation Mask R-CNN algorithm. Results obtained by the Mask R-CNN network trained with synthetized datasets reach better perfor- mance, both IoU and AP than when training with manually annotated images. Then, as a second contribution, a novel and lightweight network is proposed (CK-CNNLW) to classify the obtained instances. This net- work is considerably lighter than previous approaches (six times fewer parameters than our previous approach and more than forty times fewer parameters than other state-of-the-art architectures). Furthermore, obtained results show better performance than all previ- ous approaches. In future work we will try to develop our own segmen- tation model, trying to obtain a lightweight architecture. Additionally, we plan to extend the proposed solution to other types of grains.

