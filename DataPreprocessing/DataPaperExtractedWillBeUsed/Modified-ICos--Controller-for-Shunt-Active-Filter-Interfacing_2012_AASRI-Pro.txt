 AASRI Procedia  2 ( 2012 )  62 – 68 
2212-6716 © 2012 Published by Elsevier B.V. Selection and/or peer review under responsibility of American Applied Science Research Institute 
doi: 10.1016/j.aasri.2012.09.015 
© 2012 Published by Elsevier B.V. Selection and/or peer review under responsibility of American Applied Science Research Institute
 
 
2012 AASRI Conference on Power and Energy Systems  
Modified ICosФ Controller for Shunt Active Filter Interfacing 
Renewable Energy Source and Grid 
Ilango Ka, Manitha P Vb Manjula G Nairc * 
Department of Electrical and Electronics Engineering, Amrita Vishwa Vidyapeetham University, 
Amrita School of Engineering (Bengaluru Campus), 5600035,India 
 
Abstract 
The grid integrated renewable energy sources are becoming a common area of interest for power generation in the recent 
times. The design and development of efficient interfacing technologies to interconnect renewable energy sources with 
grid is catching a lot of attention among the researchers these days. The interfacing unit becomes crucial as renewable 
energy sources when directly connected to grid, can inject harmonic components that may deteriorate the quality of 
power. This paper proposes a mechanism to use shunt active filter as an interface between renewable energy sources and 
grid with a modified and efficient control scheme. The shunt active filter with this modified controller controls the real 
power supplied by the grid (source) in addition to its usual functions such as reactive power compensation, power factor 
correction and harmonic elimination. The non-linear load is diode bridge rectifier feeding resistive load and the 
unbalanced load also introduced to verify the controller performance.  The simulation of the proposed system under both 
balanced and unbalanced load conditions have been done and the obtained results prove the effectiveness of using a shunt 
active filter as the interfacing unit for grid integrated renewable energy system. 
 
© 2012 The Authors. Published by Elsevier B.V. 
Selection and/or peer review under responsibility of American Applied Science Research Institute 
 
Keywords:Shunt Active  Filter,Renewable Energy Source, Interfacing unit, balanced and unbalanced loads, Diode bridge rectifier 
1. Introduction 
Renewable energy sources are becoming the core of power generation schemes in the recent days where 
 
 
* Manjula G Nair. Tel.:+91 80 28439565; fax:.080-2844 0092 
E-mail address:cp.manju@gmail.com 
AASRI
Procedia
www.elsevier.com/locate/procedia
Available online at www.sciencedirect.com
© 2012 Published by Elsevier B.V. Selection and/or peer review under responsibility of American Applied Science Research Institute
Open access under CC BY-NC-ND license.
Open access under CC BY-NC-ND license.
63
 Ilango K et al. /  AASRI Procedia  2 ( 2012 )  62 – 68 
 
the traditional energy generation schemes are showing the signs of its end. Often, renewable energy sources 
are not connected to grid directly. The operational characteristics are requires the use of some interface 
between the renewable energy source and grid. Certain special requirements need to be satisfied when 
connecting the renewable energy sources to grid in order to ensure safe and reliable operation. The fault 
clearing, reclosing and inadvertent islanded operation are major protection related concerns. The detailed 
survey of power quality problems, measurements, analysis and effects of harmonics have been reported in 
literature. [1-3].The harmonics have a number of undesirable effects on the distribution system, which cause 
additional losses, overheating, and overloading in power system equipment [1]. To mitigate the harmonics 
and improve the quality of power, two commonly used approaches are the passive filters and active filters [4, 
5]. The hybrid filters and improved power quality converters are also used as solutions to power quality 
problems [6- 8]. 
The different types of interfacing units are used for grid-renewable energy source interconnection as 
reported in literatures, describes about commonly used topologies such separately connected systems, micro-
grids, multi-port converter and custom power devices [9, 10]. The issues such as starting transients, energy 
conversion efficiency and power quality make the use of custom power interface like shunt active filter and 
STATCOM as better choice. The shunt active filters as interfacing units is a latest topology reported in [11-
12]. 
In this paper, a three phase shunt active filter with a modified IcosΦ controller is proposed as the interface 
between a renewable energy source and grid feeding diode bridge rectifier load and unbalanced linear RL load 
is also introduced between Phase A and Phase C to check the controller performance under unbalanced 
condition. The shunt active filter which is used as the interfacing unit between renewable energy source and 
grid is doing normal function such as harmonic elimination, power factor correction and reactive power 
compensation even under unbalanced condition. In addition to normal active filter functions, there is a control 
over the real power supplied by the grid (source) with the use of shunt active filter based on modified IcosΦ 
controller. 
2. Three phase shunt active filter as a interface between Renewable energy source and grid 
A three phase system supplying a set of non-linear load and unbalanced linear RL load is considered as the 
test system. Fig. 1 shows the schematic of the system under consideration. A three phase balanced AC source 
represents the grid and a 7 kVA rated diode bridge rectifier feeding resistive load is considered as the 
nonlinear load.. An unbalanced linear RL load is added at t=0.5seconds. The power generated by the 
renewable energy source is injected to grid through the shunt active filter, which is a three phase voltage 
source inverter. The shunt active filter transfers the power from renewable energy sources as well as does job 
of harmonic elimination, reactive power compensation and power factor correction by maintaining unity 
power factor at the source side. The real power supplied by the source is controlled by this shunt active filter 
with modified IcosΦcontroller. The real power transfer from renewable energy source is regulated by DC-DC 
converter, which is maintaining the DC link voltage as constant. 
64  
 Ilango K et al. /  AASRI Procedia  2 ( 2012 )  62 – 68 
 
 
 Fig. 1 Schematic of Shunt Active Filter Interfacing for Renewable energy source 
3. Modified IcosΦ controller for grid integrated Renewable energy source  
The control scheme used to generate the compensation signals forms the main part of active filtering unit. 
Instantaneous PQ theory [13], synchronous detection algorithm [14], DC bus voltage algorithm [15] and 
synchronous reference frame theory [16] are some of the widely used three-phase shunt active filtering 
algorithms. The existing control schemes are still requires fine-tuning to make the computation and the circuit 
implementations as simple and rugged as possible. A simple and effective control scheme enhances the speed 
of response and efficiency of the filter. The Icosф algorithm is one such a simple current compensation 
algorithm to compensate harmonics, reactive power and power factor under unbalanced condition [17]. 
3.1. IcosΦ Control Algorithm  
The IcosΦ algorithm is to provide harmonic, reactive power and unbalance compensation in a three phase 
system with balanced/unbalanced source and any load conditions (i.e) both balanced and unbalanced [17]. It 
uses minimum computational steps and simple to practically implement in the system conditions like distorted 
and asymmetrical AC source supplying non-linear unbalanced loads. The current drawn from the source 
(grid) is highly non-linear and reactive when it is supplying a non-linear load such as diode bridge rectifier, 
thyristor converter, and AC voltage controller based loads. The algorithm aims at limiting the percentage total 
harmonic distortion in source current within the IEEE standard limits in addition to achieving unity power 
factor at the source end. In the IcosΦ algorithm, the desired mains current is consider to be the product of the 
magnitude of IcosΦ and a unit amplitude sinusoidal in phase with the mains voltage. The mains (grid) is 
required to supply only the active portion of the load current and the shunt active power filter is expected to 
provide compensation for the harmonic and reactive portion of the three-phase load current, and also for any 
imbalance in the three-phase load currents. Hence, only balanced currents will be drawn from the mains 
which will be purely sinusoidal and in phase with the mains (grid) voltages. 
3.2. Modified IcosΦ Control Algorithm  
In general shunt active filters are expected to provide current harmonic compensation, reactive power 
support and imbalance condition. The real power demanded by the loads is met by the source/grid with power 
factor maintained close to unity.With the renewable energy backup, real power support can also be extended 
by the shunt active filter under proper control as and when needed. The modified IcosΦ control algorithm is 
65
 Ilango K et al. /  AASRI Procedia  2 ( 2012 )  62 – 68 
 
proposed here to achieve additional real power support from renewable energy source using shunt active 
filter.  The grid is required to supply only the fraction of active portion of the load current as determined by 
the controller. The remaining real power is met by renewable energy source through shunt active filter 
interface. The main advantage of proposed algorithm is that real power sharing between grid, renewable 
energy source and load. 
The reference compensation currents for the shunt active filter are deduced as the difference between the 
actual load current and the desired source current in each phase 
 -  
;
 -  
;
 -  
(
)
(
 )
(
)
(
 )
(
)
(
 )
I
I
I
I
I
I
I
I
I
a
La
sa
c
Lc
sc
comp
ref
b comp
Lb
sb ref
comp
ref
�
�
�
 
 
 
 
 
 
 
 
 
 
 
 
      (1) 
where, the desired (reference) source currents in the three phases are given as, 
(
 
I
U =K I
sin t; 
) sin(
-120 );
(ref )
(ref )
(ref )
(
 )
(
 )
I
b
s ref
K
I
K I
U
K I
t
sa
s
a
s
sb ref
s ref
�
�
�
�
�
�
�
�
(
 )
(
 ) sin(
120 )
(
 )
s ref
c
s ref
I
K I
U
K I
t
sc ref
�
�
�
�
�
�                                                             (2) 
where K   is the load factor which determines how much real power has to be supplied by the source/grid. 
 
Here Is(ref )  defined from the real part of all the three phase currents. 
(
 )
3
cos
cos
cos
3
La
a
Lb
b
Lc
c
I
I
I
La
Lb
Lc
Is ref
I
I
I
�
�
�
�
�
�
�
�
�
 
 
 
      (3) 
Ua , Ub  and Uc  are the unit amplitude templates of the phase to ground source voltages in the three phases 
respectively. 
 
U
a = 1.sinωt
;
1.sin(
-120 )
U
t
b
�
�
� ;
1.sin(
120 )
U
t
c
�
�
�
�   
 
 
 
      (4) 
The magnitude of the desired source current 
Is(ref )
 can be expressed as the magnitude of the real 
component of the fundamental load current in the respective phases .i.e. for phase ‘a’ it can be written 
as I
= Re(I
La )
s(ref )
. 
A zero crossing detector (ZCD) is used to detect the negative going zero crossing of the corresponding phase 
voltage. The ZCD has been designed with a tolerance of 5% to ensure that any oscillations around the zero-
crossing are taken care of. The phase-shifted fundamental current goes as the “sample” input and the ZCD 
output pulse goes as the “hold” input to the “sample and hold” circuit whose output is the magnitude 
IcosΦ = Is(ref ) . This magnitude is multiplied with unit amplitude sine wave in phase with input voltage and 
also desired fraction which determines how much real power is supplied by the source. Difference between 
load current and reference source current gives the reference filter current. This reference filter current and 
actual filter current are given to a hysteresis controller to get the pulses for the inverter. 
66  
 Ilango K et al. /  AASRI Procedia  2 ( 2012 )  62 – 68 
 
4. Modeling and Simulation of Shunt Active Filter Interface for Renewable Energy Source with 
modified IcosΦ Controller 
The simulations of the above described system is carried out in MATLAB Simulink to check the 
performance of shunt active filter based on modified IcosΦ control algorithm.Three single phase sources are 
connected in star considered as grid with voltage of 400V, 50Hz. This grid is supplying non-linear load of 
diode bridge rectifier feeding resistive load and unbalanced linear RL load. 
A three phase voltage source inverter (VSI) is considered as shunt active filter. The pulses for the VSI are 
derived by the controller using modified IcosΦ control algorithm. The shunt active filter parameters are 
chosen as coupling inductance =9 mH; DC link capacitance = 6mF and voltage across the capacitor =650V. 
4.1. Shunt Active Filter with modified  IcosΦ Controller as the Interfacing unit 
Initially the diode bridge rectifier is switched on and drawing power from source, at t=0.5sec an 
unbalanced linear RL load is also added with non-linear load. The unbalanced linear RL load having R=50Ω 
and L=1mH which leads to the total load power consumption as 10KW. The Fig. 2 (a) shows the three phase 
source/grid current for the test system. From Fig.2 (a), it is clear that after t=0.5sec, the current in phase A and 
phase C has been increased to some extent and current pattern in phase A and phase C is similar which can be 
seen clearly in Fig.2.(b). 
The shunt active filter used as the interfacing unit for the renewable energy source, grid and load should 
compensate reactive power and harmonics mitigation thereby maintaining unity power factor at source side. 
The Fig.2.(b) shows the modified IcosΦ controller performance, which includes the source/grid voltage, load 
current, reference filter current generated by the controller , actual filter current from the shunt active filter 
and desired source current respectively for the all three phases. The rich harmonic content in source current is 
due to presence of non-linear load and unbalanced load. From the Fig.2.(b) one can understand easily the 
actual filter current from the shunt active filter follows the reference filter current calculated by the modified 
IcosΦ controller . This implies that the proposed controller is working according to the desired functionalities 
as discussed earlier. 
 
 
 
Fig.2. (a) Three phase source current wave forms before compensation (b) Modified IcosΦ controller 
performance (c) Source voltage and current wave forms before and after compensation 
4.2. Modified IcosΦ Controller Performance under unbalanced condition 
The Fig.2.(c) shows the proposed controller performance under unbalanced load condition, which includes 
source voltage and current drawn by the load before compensation and source current after compensation for 
67
 Ilango K et al. /  AASRI Procedia  2 ( 2012 )  62 – 68 
 
all the three phases. It is observed that before introducing shunt active filter with modified IcosФ controller, 
the current in all the three phases are not same .The current in Phase A and phase C are with diode bridge 
rectifier with unbalanced linear RL load  drawing more current than the phase B and also current pattern 
different for phase A and phase C . To compensate unbalance and harmonic current, the proposed control 
algorithm has been generating reference current as shown in Fig.2.(c).The controller is doing the job of 
harmonic elimination, reactive power compensation and power factor correction by maintaining the source 
voltage and current in phase and the magnitude in all three phases are equal. 
4.3. Power sharing between Renewable energy source and Grid 
The Table 2 gives the details of real power sharing between grid/source and renewable energy resource 
for the above mentioned test system. The simulation has been done based on the various load factor i.e. 
fraction of real power ,which has to be supplied by the source .From Table.2 it is clear that, depending upon 
the factor the real power sharing between gird and renewable energy sources has been taking place. The total 
reactive power required by load has been fully compensated by the filter even under unbalanced condition. 
Table2. Power sharing between renewable energy source and grid 
L.F 
PL(kW) 
QL(kVA) 
PS(kW) 
QS(kVA) 
PRES (kW) 
QRES(kVA) 
1 
10 
0.16 
11.8 
-0.30 
-1.8 
0.46 
0.75 
10 
0.16 
9.2 
-0.35 
0.8 
0.51 
0.50 
10 
0.16 
6.7 
-0.40 
3.3 
0.56 
0.25 
10 
0.16 
4.1 
-0.50 
5.9 
0.66 
LF = Load factor, fraction of real power which is be supplied by the source/grid 
 
When the load factor is 1, the source (grid) supplies entire load power. In addition to this, in all the above 
cases the source is supplying some extra power to compensate the losses taking place in the interfacing unit 
(approximately 1.8kW). For different fractions power sharing between gird and renewable energy source is 
tabulated in Table2, to meet the load of 10kW with load factor .5, the source (grid) should supply only 5 kW 
and renewable energy source should supply 5kW, where source/grid is supplying 6.7kW to compensate the 
losses in the interfacing unit. 
From all the above results it is observed that a shunt active filter when used as the interfacing unit for 
renewable energy source and grid achieves all compensation requirements effectively in addition to extending 
real power sharing of load along with the grid. 
5. Conclusions 
The proposed modified IcosΦ controller based shunt active filter as an interface between renewable energy 
sources and grid has been simulated and performance has been analyzed under balanced and unbalanced load 
conditions. The modified IcosΦ controller has ability to inject the real power from the renewable energy 
source to grid through the shunt active filter interface and also has the control over real power of source 
(grid). The proposed controller performing regular shunt active filter as harmonic elimination, reactive 
power compensation and power factor even under balanced/unbalanced condition. 
68  
 Ilango K et al. /  AASRI Procedia  2 ( 2012 )  62 – 68 
 
Acknowledgements 
This work has been funded by DST SERC under Fast Track Scheme for Young Scientists No: 
100/IFD/2769. The authors are also grateful to Amrita Vishwa Vidya Peetham University, Amrita School of 
Engineering, Bengaluru campus for extending support for this project. 
References 
[1] W. M. Grady and S. Santoso, “Understanding Power System Harmonics,” IEEE Power Engineering 
Review, vol. 21, no. 11, pp. 8-11, 2001.  
[2] J. Arrilaga, D. A. Bradley and P. S. Bodger, “Power System Harmonics”, Chichester, UK, Wiley, 1985 . 
[3] W. E. Kazibwe and  M. H. Sendaula. “Electric Power Quality Control Techniques”, Van Nostrand 
Reinhold, 1993, New York, USA.  
[4] Bhim Singh, Kamal Al-Haddad and Ambrish Chandra, “A Review of Active Filters for Power Quality 
Improvement”, IEEE Transactions on Industrial Electronics, Vol 46, No 5, October 1999. 
[5] M.El-Habrouk, M.K.Darwish and P.Mehta“Active power filters: A review”, IEE Proc-Electr. Power 
Appli.,vol.147,No.5,September 2000 
[6] Zainal Salam, Tan Perng Cheng and AwangJusoh,  “Harmonics Mitigation using Active Filter: A 
Technological Review”, ELEKTRIKA VOL. 8, NO. 2, 2006, 17-26. 
[7] Bhim Singh, B.N Singh, Ambrish Chandra, Kamal Al-Haddad, Ashish Pandey and D P Kothari, “A 
Review of Single Phase Improved Power Quality AC – DC Converters”, IEEE Transac. On Ind. Electron, Vol 
50, October 2003. 
[8] Bhim Singh,  B.N Singh, Ambrish Chandra, Kamal Al-Haddad, AshishPandey and D P Kothari, “A 
Review of Three Phase Improved Power Quality AC – DC Converters”, IEEE Transac. On Ind. Electron, 
2004. 
[9] Joseph A. Carr, Juan Carlos Balda, H. Alan Mantooth, “A Survey of Systems to Integrate Distributed 
Energy Recourses and Energy Storage on the Utility Grid”, IEEE Energy 2030 Atlanta, Georgia, USA, 17-18 
November 2008 
[10] L. G. B. Rolim, A. Ortiz, M. Aredes, R. Pregitzer, J. G. Pinto, Joao L. Afonso, “Custom Power Interfaces 
for Renewable Energy Sources”, 1-4244-0755-9/07 IEEE 2007. 
[11] Pedro Neves, D Goncalves, J G Pinto, Renato Alves, Joao L. Afonso, “Single Phase Shunt Active Filter 
Interfacing Renewable Energy Sources with power Grid”. 
[12] J. G. Pinto, R. Pregitzer, Luis F. C. Monteiro, Joao L. Afonso, “3-Phase 4-Wire Shunt Active Power 
Filter with Renewable Energy Interface”. 
[13] H. Akagi, Y. Kanazawa and A. Nabae, “Instantaneous Reactive Power Compensators comprising 
Switching Devices without Energy Storage Component”, IEEE Transac. On Industry Applications, 1984.  
[14] Chin Lin Chen, Chen E. Lin and C. L. Huang, “An Active Filter for Unbalanced 3 Phase System using 
Synchronous Detection Method”, Power Electronics Specialist Conference, PESE, 94 Record, 2, June 1994. 
[15] H. L. Jou, “Performance Comparison of the three – phase active – power – filter algorithms”, IEE Proc. 
Vol. 142. No. 6, November 1995. 
[16] S. Bhattacharya, D. M, Divan and B. Bhanarjee, “Synchronous Frame harmonic Isolator using Active 
Series Filter”, EPE.91, 1991. 
[17] G. Bhuvaneswari, Manjula G. Nair, “Design, Simulation and Analog Circuit Implementation of a Three – 
Phase Shunt Active Filter Using the IcosΦ Algorithm”, IEEE Transactions on Power Delivery April 2008. 
 
 
