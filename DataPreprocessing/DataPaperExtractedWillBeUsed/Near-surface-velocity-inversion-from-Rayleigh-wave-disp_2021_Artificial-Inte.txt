Near-surface velocity inversion from Rayleigh wave dispersion curves based
on a differential evolution simulated annealing algorithm
Yaojun Wang a, Hua Wang a,*, Xijun Wu a, Keyu Chen a, Sheng Liu b, Xiaodong Deng b
a Center for Information Geoscience, University of Electronic Science and Technology of China, Chengdu, 5162125, China
b South Branch of Sinopec Geophysical Corporation, Chengdu, 610041, China
A R T I C L E I N F O
Keywords:
Simulated annealing
Differential evolution
Block coordinate descent
Surface wave dispersion curve
Nonlinear inversion
A B S T R A C T
The utilization of urban underground space in a smart city requires an accurate understanding of the underground
structure. As an effective technique, Rayleigh wave exploration can accurately obtain information on the sub-
surface. In particular, Rayleigh wave dispersion curves can be used to determine the near-surface shear-wave
velocity structure. This is a typical multiparameter, high-dimensional nonlinear inverse problem because the
velocities and thickness of each layer must be inverted simultaneously. Nonlinear methods such as simulated
annealing (SA) are commonly used to solve this inverse problem. However, SA controls the iterative process
though temperature rather than the error, and the search direction is random; hence, SA always falls into a local
optimum when the temperature setting is inaccurate. Speciﬁcally, for the inversion of Rayleigh wave dispersion
curves, the inversion accuracy will decrease with an increasing number of layers due to the greater number of
inversion parameters and large dimension. To solve the above problems, we convert the multiparameter, high-
dimensional inverse problem into multiple low-dimensional optimizations to improve the algorithm accuracy
by incorporating the principle of block coordinate descent (BCD) into SA. Then, we convert the temperature
control conditions in the original SA method into error control conditions. At the same time, we introduce the
differential evolution (DE) method to ensure that the iterative error steadily decreases by correcting the iterative
error direction in each iteration. Finally, the inversion stability is improved, and the proposed inversion method,
the block coordinate descent differential evolution simulated annealing (BCDESA) algorithm, is implemented. The
performance of BCDESA is validated by using both synthetic data and ﬁeld data from western China. The results
show that the BCDESA algorithm has stronger global optimization capabilities than SA, and the inversion results
have higher stability and accuracy. In addition, synthetic data analysis also shows that BCDESA can avoid the
problems of the conventional SA method, which assumes the S-wave velocity structure in advance. The robustness
and adaptability of the algorithm are improved, and more accurate shear-wave velocity and thickness information
can be extracted from Rayleigh wave dispersion curves.
1. Introduction
With the acceleration of urbanization and with rapid increases in
population and economic activity, the utilization of urban underground
space (UUS) has become a dramatic strategy in smart cities, which are
characterized by massive constructions such as subways, pipeline net-
works, groundwater projects, and underground malls. UUS utilization
requires accurate and efﬁcient measurements of the subsurface. There-
fore, efﬁcient measurement methods for determining the extents of near-
surface underground structures have become a popular issue in the ﬁelds
of geophysics and geotechnical engineering.
Existing near-surface survey methods include the high-density elec-
trical method, ground-penetrating radar, reﬂection seismology, and
multichannel analysis of surface waves (MASW) (Xia et al., 1999; Park
et al., 1999). Among them, the high-density electrical method and
ground-penetrating radar obtain the resistivity distribution of the sub-
surface, whereas reﬂection seismology and multichannel transient sur-
face wave methods use the propagation of elastic waves to obtain
velocity information and describe the underground structure. The former
has a high detection accuracy, but the depth of investigation is limited by
the frequency of electromagnetic waves; in contrast, the latter has a high
resolution and large investigation depth. In particular, the MASW
* Corresponding author.
E-mail addresses: yaojun.wang@uestc.edu.cn (Y. Wang), huawang@uestc.edu.cn (H. Wang), wuserry@163.com (X. Wu), chloe.chen@std.uestc.edu.cn (K. Chen),
shengliu@sinopec.com.cn (S. Liu), dengxd05@hotmail.com (X. Deng).
Contents lists available at ScienceDirect
Artiﬁcial Intelligence in Geosciences
journal homepage: www.keaipublishing.com/en/journals/artiﬁcial-intelligence-in-geosciences
https://doi.org/10.1016/j.aiig.2021.10.001
Received 15 June 2021; Received in revised form 30 September 2021; Accepted 24 October 2021
Available online 27 October 2021
2666-5441/© 2021 The Authors. Publishing Services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the CC BY-NC-ND
license (http://creativecommons.org/licenses/by-nc-nd/4.0/).
Artiﬁcial Intelligence in Geosciences 2 (2021) 35–46
method, a nondestructive method with a rapid detection speed (Qi et al.,
2002) that extracts the dispersion curves of surface waves and then in-
verts the near-surface velocity information (Xia et al., 1999; Park et al.,
1999), is widely used in the detection of UUS (Pugin et al., 2013; Xia
et al., 2015).
Surface waves include Rayleigh waves, Love waves, and Stoneley
waves; Rayleigh waves, which are formed by P- and SV-waves propa-
gating along the free interface, are the most common. Rayleigh waves
become dispersive when the formation depth and velocity vary. Thus, the
dispersion curves of Rayleigh waves can be used to invert for the velocity
(especially the S-wave velocity, Vs) and thickness of underground media.
Although this method is extensively used to image near-surface and
deeper earth structures (Zhang et al., 2014; Foti et al., 2011), there are
still some challenges, such as the extraction of dispersion curves from
surface waves (Zhang et al., 2014) and the acquisition of stable and
reliable dispersion curves from an inversion algorithm (Foti et al., 2011;
Park et al., 1999). This study will focus on the development of a
dispersion curve inversion method.
Numerous inversion methods, both linear and nonlinear, have been
used to extract the velocity structure from Rayleigh wave dispersion
curves. Linear inversion methods are popular in ﬁeld applications
because of their fast convergence speed. The dispersion equations are
linearized, and the inversion results are obtained after the model pa-
rameters are modiﬁed by a Jacobian matrix. The damped least squares
(DLS) and least squares (LM) methods are common linear methods.
However, the depth of investigation in ﬁeld applications typically in-
volves multiple layers (usually more than 3) with the Rayleigh wave
method, and the nonlinear problem of inverting multiple parameters (the
thickness and velocity in each layer) strongly relies on the initial model,
leading to a result with low accuracy and a local optimum solution (Dal
Moro et al., 2007). In contrast, nonlinear inversion methods are inde-
pendent of the initial model and obtain results through a global search;
consequently, local extrema are avoided (Lu et al., 2016). The simulated
annealing (SA) algorithm (Kirkpatrick et al., 1983) and its derivatives are
common nonlinear techniques that are often used for the inversion of
Rayleigh wave dispersion curves (e.g., Beaty et al., 2002; Ryden and
Park, 2006; Pei et al., 2007; Lu et al., 2016), but these algorithms still
have various problems that affect the stability and uniqueness of the
inversion:
(1) Dispersion curve inversion requires the simultaneous inversion of
multiple sets of layer thicknesses (h) and Vs. The inversion
therefore exhibits multiparameter and high-dimensional features,
but the conventional SA algorithm adapts poorly to multiparam-
eter, high-dimensional optimization problems (Pei et al., 2008).
(2) The iteration direction in the SA algorithm is random, and the
convergence is controlled through temperature; thus, the result
may fall into a local optimum due to the limitation on the number
of iterations and an inaccurate temperature control.
Accordingly, we propose an improved SA dispersion curve inversion
algorithm to address these limitations in two ways:
1) We introduce the block coordinate descending (BCD) method (Zhao
et al., 2015; Xu and Yin, 2015) to improve the capability of the SA
algorithm to synchronously optimize multiple parameters. Then, the
multiple parameters, namely, h and Vs for each layer in a multilay-
ered model, can be inverted by the improved SA algorithm.
2) We introduce the differential evolution (DE) algorithm (Storn and
Price, 1997) to control the optimization direction and use the error as
the control condition. Thus, the inversion avoids falling into local
optima.
Finally, the block coordinate descent differential evolution simulated
annealing (BCDESA) algorithm is formed. The new algorithm is veriﬁed
by synthetic geological models and ﬁeld data.
2. Method
As described in the introduction, using the SA algorithm to invert the
velocities from Rayleigh wave dispersion curves results in a highly
nonlinear ill-posed problem. There are two challenges: multiparameter
inversion and avoiding locally optimal results. When solving multipa-
rameter problems, the SA algorithm has poor performance (Pei et al.,
2008). However, in ﬁeld applications, we always need to obtain more
than 3 parameters to account for all necessary formation layers, and
hence, SA is not suitable. The fact that the results obtained by the SA
algorithm are locally optimal is a recognized weakness of this technique
because the overall iterative process is controlled by temperature and the
search direction is random.
2.1. Principle of the velocity inversion from Rayleigh wave dispersion
curves
In the inversion of Rayleigh wave dispersion curves, the objective
function of the inversion procedure is constructed by the mean square
error between the forward model and the observed Rayleigh wave
dispersion curve, as shown in equation (1):
E ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1
N
X
N
i¼1
ðVrobs
i
� Vrcal
i Þ
2
v
u
u
t
(1)
where N is the number of sampling points on the dispersion curve and
Vrobs
i
and Vrcal
i
are the observed and calculated phase velocities, respec-
tively, at the ith sampling point of the frequency. Here, we can use the
generalized reﬂection-transmission coefﬁcient method (Chen, 1993; Pei
et al., 2008) or some other algorithm to calculate the synthetic dispersion
curves by using various Vs, P-wave velocities (Vp), densities (ρ), and h.
Moreover, the observed curves can be extracted from the f-k spectrum of
the ﬁeld Rayleigh wave data.
According to Xia et al. (1999), the inﬂuences of Vp and ρ on the
Rayleigh wave dispersion curve can be ignored. Therefore, we ﬁx Vp and
ρ during the inversion and invert only Vs and h to reduce the uncertainty
of the inversion. Global optimization algorithms such as SA are usually
employed to solve nonlinear objective functions such as equation (1). We
introduce the basic principles of the SA in the following section.
2.2. Simulated annealing (SA)
Using the SA algorithm to invert velocity proﬁles from Rayleigh wave
dispersion curves, the model Vs and h are perturbed by equation (2):
Vsj
iþ1 ¼ Vsj
i þ ajðV2 � V1Þandhj
iþ1 ¼ hj
i þ bjðH2 � H1Þ
(2)
where Vsi
j and Vsi
jþ1 are the Vs values at the ith and (iþ1)th iterationsof the
jth layer, respectively; hi
j and hiþ1
j
are the thicknesses of the ith and (iþ1)th
iterationsof the jth layer, respectively; (V1,V2) represents the Vs range of
the jth layer; (H1,H2) represents the h range of the jth layer. Only the
parameters in their value ranges are effective in the inversion. The
perturbation coefﬁcients a and b are subjected to a probability distribu-
tion, such as a uniform distribution (Beaty et al., 2002) or a Gaussian
distribution (Pei et al., 2007). In this paper, we use the coefﬁcients
derived from the very fast simulated annealing (VFSA) algorithm (see
equation (3)). The advantage of this approach is that the perturbation
range of the model becomes narrow when the temperature is decreasing
(Ingber, 1989):
a; b ¼ sgn
�
u � 1
2
�
T
h
ð1 þ 1=TÞj2u�1j � 1
i
(3)
where sgn is a step function, u is subject to a uniform distribution, and T
is the current temperature.
Y. Wang et al.
Artiﬁcial Intelligence in Geosciences 2 (2021) 35–46
36
At the beginning of the inversion, the synthetic dispersion curve is
obtained from an initial model (Vp, Vs, ρ, h), and the objective function E0
is calculated using equation (1). Then, at a ﬁxed temperature T, we
perturb the initial model using equation (2). An updated objective
function E1 is calculated, and the variation in the objective function
(ΔE ¼ E1 – E0) is obtained. If ΔE is negative, the new model is accepted;
otherwise, the model continues to update. This process is repeated until
the iteration meets certain conditions. Next, the value of T decreases, and
the above process is repeated at the current T until a steady state is
reached. At this time, the updated model is the output result.
In this paper, the temperature-dropping rule is expressed as
Tkþ1 ¼ Tkα
ﬃﬃ
pk
(4)
where k is the temperature-dropping number and α is the temperature
drop coefﬁcient in the range of [0.8, 0.99] (Pei et al., 2008). This formula
is derived from the VFSA method (Ingber, 1989).
After the values of Vs and h are updated, Vp can be updated according
to Poisson's ratio σ and Vs (Xia et al., 1999):
Vp ¼ Vs
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
2ð1 � σÞ
1 � 2σ
r
(5)
ρ is usually a constant, but we can change it depending on the li-
thology roughly identiﬁed from the inverted Vs proﬁle.
2.3. Block coordinate descent simulated annealing (BCDSA)
Although the inverted parameters are reduced after considering ρ and
Vp, in existing Rayleigh wave inversion methods, the parameter dimen-
sion is still 2n (n is the number of layers). If n is large, the SA algorithm
has difﬁculty obtaining the ideal outcome (Pei et al., 2008). To avoid the
problem of multiple parameters, an alternative iteration approach is
proposed. In this scheme, we ﬁrst disturb Vs with a ﬁxed h until Vs is
accepted. Then, h is iterated with the updated Vs (ﬁxed) until h is
accepted. If n is large (e.g., n > 3), the iteration errors in each layer will
accumulate, and eventually, the inversion will deteriorate.
Here, we use the BCD method (Zhao et al., 2015; Xu and Yin, 2015) to
divide
the
high-dimensional
parameter
problem
into
multiple
one-dimensional local iterative optimization problems. In each iteration,
we ﬁrst update the parameters corresponding to the selected coordinate
or coordinate block; in the same iteration, other coordinates or coordi-
nate blocks are ﬁxed, and the overall objective function value and
gradient are calculated for optimization. After the selected coordinates
are optimized, the next coordinate or coordinate block is iterated. In the
BCD method, a global multiparameter optimization problem can be
divided into several single-parameter local optimization problems, and
the optimal solution can be acquired by stepwise approximation (Wang
et al., 2018; Zhao et al., 2015). Here, we introduce the BCD principle into
the SA algorithm and propose the BCDSA algorithm.
The details of the BCDSA algorithm are as follows:
Y. Wang et al.
Artiﬁcial Intelligence in Geosciences 2 (2021) 35–46
37
2.4. Block coordinate descent differential evolution simulated annealing
(BCDESA) algorithm
Although the BCDSA algorithm is suitable for the multiparameter,
high-dimensional inversion of Rayleigh wave dispersion curves, this
method does not directly control the decrease in error because it uses the
temperature as the termination condition. Moreover, invalid distur-
bances under high temperatures may lead to insufﬁcient disturbances,
ultimately destabilizing the inversion results. Hence, we employ the di-
versity of population information in the DE algorithm (Storn and Price,
1997) to improve the stability of the BCDSA algorithm.
Here, the basic operations of the DE algorithm, namely, population
initialization, mutation and recombination, are introduced.
2.4.1.1. Population initialization
An individual mi is assumed to be in an N-dimensional matrix (i.e., a
model with N layers) in population M, where Vs and h in mi are
Vsi ¼ (Vsi
1, Vsi
2, …, Vsi
N),
(6a)
hi ¼ (hi
1, hi
2, …, hi
N).
(6b)
The ﬁrst generation of the population is randomly generated as fol-
lows:
Vsi
j ¼ randðV1; V2Þ; hi
j ¼ randðH1; H2Þ
i ¼ 1; 2; :::; M; j ¼ 1; 2; :::; N
(7)
where rand(A, B) is a function to generate a random number ranging
from A to B. Vp is updated according to equation (5), and ρ is constant.
The ﬁnal initialized population size is M, and the individual dimension is
N.
2.4.1.2. Mutation
A new individual ma can be mutated with two randomly selected
individuals mb and mc:
m
0
iðg þ 1Þ ¼ maðgÞ þ FðmbðgÞ � mcðgÞÞa 6¼ b 6¼ c; i ¼ 1; 2; :::; M
(8)
where m
0
iðg þ1Þ is the individual of the ith variation in the (gþ1)th gen-
eration; maðgÞ, mbðgÞ, and mcðgÞ are three different individuals in the gth-
generation population; and F 2 ½0; 2� is the scaling factor, for which 0.5 is
used in this paper, where a large F results in a high diversity of the
generated population and a small F leads to fast convergence (Rahna-
mayan et al., 2008). Vs and h are treated according to equation (8), and
Vp is updated by equation (4), while the density remains unchanged.
2.4.1.3. Recombination
Taking Vs as an example, after the (gþ1)th population mutation, the ith
individual Vsi(gþ1) may recombine with the ith individual VsiðgÞ of the gth
population:
Vsj
0
i ðg þ 1Þ ¼
(
Vsj
iðg þ 1Þri < CR
Vsj
iðgÞothers
i ¼ 1; 2; :::; M; j ¼ 1; 2; :::; N
(9)
where j represents the jth dimension of Vsj
iðg þ1Þ and Vsj
0
i ðg þ1Þ is the
result of recombination. ri obeys a uniform distribution in (0,1). CR 2
½0; 1� is a recombination factor, which is usually much smaller than 1,
such as 0.3 (Storn, 1996).
2.4.1.4. Selection
We use a greedy algorithm to select individuals in the next genera-
tion:
miðg þ 1Þ ¼
(
m
0
iðg þ 1Þ; E
�
m
0
iðg þ 1Þ
�
< EðmiðgÞÞ
miðgÞ; other
;
(10)
The basic process of the DE algorithm is as follows:
1) Determine the control parameters of the DE algorithm, and determine
the error function. The De algorithm control parameters include the
population size NP, scaling factor F, and recombination factor CR.
2) Initialize the population according to equation (7).
3) If the population reaches the termination conditions, the best indi-
vidual is the optimal solution; otherwise, the evolution needs to
continue.
4) Obtain intermediate populations through mutation and recombina-
tion according to equations (8) and (9), respectively.
5) Select individuals from the original population and the intermediate
population according to equation (10) to obtain a new generation of
the population.
6) Advance the evolution generation number, i.e., g ¼ g þ 1, and go to
step 3.
Generally, the SA algorithm is used for every individual in all pop-
ulations, and the initial temperature is properly reduced to avoid invalid
disturbances caused by high temperatures. The useful information of the
parent can be inherited by the next generation, which can accelerate the
convergence of the algorithm. Furthermore, the algorithm can directly
control the decline in the error by replacing the traditional temperature
termination condition with an error termination condition, which im-
proves the stability of the algorithm and further increases the accuracy.
The idea of using the error as the termination condition and utilizing
population selection ensures the stability of the DE algorithm. Moreover,
the richer the population information is, the more stable the algorithm.
The detailed workﬂow of the proposed algorithm is shown in Fig. 1.
3. Performance analyses
We use two models to test the performance of BCDESA in the inver-
sion of velocity proﬁles from Rayleigh wave dispersion curves. The
models contain two and four layers with increasing velocity, as shown in
Tables 1 and 2, respectively.
3.1. Performance of introducing BCD into SA
Although a higher-order mode was recently used (Wang et al.,
2019), the mode most extensively applied during Rayleigh wave
exploration is the fundamental-order Rayleigh wave because of its high
energy and the ease with which it is observed (Yu et al., 2018). In this
study, the dispersion curve of the fundamental-order Rayleigh wave is
used to invert the near-surface Vs and h of each layer. Here, we use the
improved fast generalized reﬂection-transmission coefﬁcient method
(Chen, 1993; Pei et al., 2008) to calculate the dispersion curves for
different models.
During the inversion, the Vs and h in each layer usually range from 0.5
to 1.5 times the true value (Lu et al., 2016) to improve the accuracy. In
practical applications, we can limit the search ranges of these two pa-
rameters based only on the Rayleigh wave dispersion curve because the
phase
velocity
of
the
fundamental-order
Rayleigh
wave
at
the
low-frequency limit is close to 0.92 times the Vs of the homogeneous
half-space, and the corresponding high-frequency limit is close to 0.92
times the Vs of the ﬁrst layer (Knopoff, 1964).
Moreover, the investigation depth of the Rayleigh wave is half of the
maximum wavelength. We set the model range of Vs from the 0.5 times
the minimum Rayleigh wave phase velocity to 1.5 times the maximum
phase velocity. The layer thickness is greater than 0, and the sum of the
layer thicknesses is smaller than the maximum wavelength.
We perform 10 inversions for the two models by both SA and BCDSA.
The input parameters are the same for each inversion (T0, Tend, α), as
listed in Table 3, and the Num is the iteration number required to meet
the termination condition. The SA algorithm uses the alternating itera-
tive optimization method for Vs and h (Pei et al., 2007). In the BCDSA
Y. Wang et al.
Artiﬁcial Intelligence in Geosciences 2 (2021) 35–46
38
algorithm, the number of coordinate blocks is set to 1; i.e., only one
parameter is iterated at a time.
Fig. 2 shows the error distributions of ten tests. The errors of the re-
sults obtained by the SA method may suddenly change (the errors of the
two results in Fig. 2a are abnormally large), whereas the errors of the
BCDSA method are stable. The average error and variance in the 10 in-
versions for Models A and B, respectively (see Table 4) illustrate that the
introduction of the BCD method into the SA algorithm can signiﬁcantly
improve the accuracy of the latter, especially when the number of model
layers increases.
The smallest Vs errors are obtained for Models A and B among the 10
inversion tests, and the forward modeling dispersion curves are shown in
Figs. 3 and 4. The maximum relative error of Vs in Model A is 1.85% and
0.62% for the SA and BCDSA inversion, respectively, and the relative
error of h is 9.31% and 1.22%, respectively. With increasing depth
(Model B), the BCDSA inversion results are signiﬁcantly better than SA
results. Table 5 lists the inversion results and errors for Model B. The
BCDSA inversion results for each layer are better than the SA results. In
particular, BCDSA greatly improves the inversion accuracy with
increasing depth. Fig. 5 shows the decreasing trend of errors during the
inversion by using SA and BCDSA. The overall error of the BCDSA al-
gorithm exhibits a decreasing trend with decreasing temperature, which
indicates that BCDSA has the capability to jump out of local optima, but
the SA method cannot (iteration>680 in Fig. 5a and iteration>2600 in
Fig. 5b).
3.2. Performance of the introduction of DE into the BCDSA (BCDESA)
Because BCDSA uses the temperature as a termination condition, the
inversion commonly terminates even if the error does not achieve the
requirement when the temperature reaches 0 (Table 4). In addition, SA
and BCDSA are particularly susceptible to accepting a worse solution due
to the limitation of the Metropolis criterion when the number of itera-
tions is relatively small (i.e., at higher temperatures, see Fig. 5). Conse-
quently, it is easy to obtain invalid results in unsatisfactory inversions. In
general, BCDSA cannot control the error direction. One solution is to use
the DE algorithm to control the termination error by replacing the tem-
perature termination condition with an error termination condition. The
workﬂow of the BCDESA method is shown in Fig. 1.
We use Model B as an example to test the performance of BCDESA.
The parameters for the BCDESA inversion are as follows: population size
M ¼ 10, scaling factor F ¼ 0.5, crossover factor CR ¼ 0.3, initial tem-
perature T0 ¼ 25, termination temperature Tend ¼ 0.1, temperature drop
coefﬁcient α ¼ 0.8, and current temperature maximum iteration number
Num ¼ 2. We set the initial temperature as 25 in BCDESA because the
BCDSA algorithm still has a strong ability to jump out of local solutions
when the temperature is between 28 and 18 �C (Iteration>650 in Fig. 5a
and Iteration>3300 in Fig. 5b). In addition, the relatively low initial
temperature also reduces the computational time.
To illustrate the controllability of the BCDESA error, we test two cases
where the termination error E is 4.5 and 2.0. The other parameters are
constant in the inversions. Fig. 6 shows a comparison between the out-
comes of the two inversion tests, and Table 6 lists the inversion results for
each layer. Compared with the BCDSA inversion accuracy (Table 5), the
BCDESA inversion accuracy is higher. However, a lower inversion error
requires more iterations, resulting in an increased number of calculations
(Fig. 7).
4. Synthetic data examples
In this section, we test the performance of the BCDESA inversion
method with 3 typical layered models (Pei et al., 2007): Models C
Fig. 1. The workﬂow of the BCDESA algorithm.
Table 1
Model A: Parameters of the two-layer model with increasing velocity.
Layer
Vs (m/s)
Vp (m/s)
ρ (kg/m3)
h (m)
1
202
349.9
1900
5
2
301
521.3
1900
∞
Table 2
Model B: Parameters of the four-layer model with increasing velocity.
Layer
Vs (m/s)
Vp (m/s)
ρ (kg/m3)
h (m)
1
201
348.1
1900
2
2
301
521.3
1900
4
3
403
698.0
1900
6
4
505
874.7
1900
∞
Table 3
Parameters of the SA and BCDSA algorithms. T0: initial temperature; Tend:
termination temperature; α: temperature drop coefﬁcient; Num: iteration number
at the current temperature.
Parameters
Model A
Model B
SA
BCDSA
SA
BCDSA
T0
2000
2000
2000
2000
Tend
0.1
0.1
0.1
0.1
α
0.9
0.9
0.9
0.9
Num
40
20
200
50
Y. Wang et al.
Artiﬁcial Intelligence in Geosciences 2 (2021) 35–46
39
(Table 7), D (Table 8), and E (Table 9). The Vs of each layer in Model C is
increasing, while Model D contains a high Vs interlayer, and Model E has
a low Vs interlayer.
The computation time is also affected by the population size M, which
is usually a multiple of 10 (Storn, 1996). We use Model B as an example
to test the inﬂuence of the population size M on the BCDESA algorithm. M
is set as 10, 20, and 30, and the termination error is set as 4.5. The other
parameters are the same as those in Fig. 6. Table 10 lists the average
algebra of generations for the convergence (CAA) and average number of
individuals generated(ANI) of the algorithm. A value of 10 is the best
choice for M because this value is the minimum number of generations,
which requires the fewest computations.
4.1. Noiseless case
Here, we use the BCDESA and SA methods to invert the 3 typical
models without any noise. The parameters for the BCDESA inversion are
the same as those in Fig. 6, except the termination error is 4.5. The pa-
rameters for the SA inversion are the same as in Model B in Table 3.
Figs. 8–10 show comparisons between the models and inversion results.
Figs. 8–10(a) show comparisons between the true model dispersion curve
(red solid curve) and the forward modeling inversion curves (blue curve
for BCDESA and black dotted curve for SA). Similarly, Figs. 8–10(b) show
comparisons between the Vs proﬁle of the true model (red curve) and the
inverted proﬁles (blue curve for BCDESA and gray curve for SA). The
dispersion curves obtained by BCDESA are closer to the true dispersion
curve, but SA cannot obtain a good result, especially for Model D
(Fig. 9b), where Vs and h considerably deviate from the model values.
The maximum errors of the inverted Vs for Models C, D, and E from
Fig. 2. Error distribution for 10 inversions using different methods. (a) Model A; (b) Model B. The error is calculated by equation (1). The blue points are the BCDSA
errors, and the black crosses are the SA errors. The BCDSA error is lower than the SA error. In Model B, SA has two large error anomalies.
Table 4
Stability analysis of the inversion errors from ten tests by using SA and BCDSA for
two models (the error is calculated by equation (1)).
Model A
Model B
SA
BCDSA
SA
BCDSA
Mean error
5.69
2.73
17.06
6.98
Variance
8.18
2.54
143.36
7.74
Fig. 3. Inversion results of SA and BCDSA for Model A. (a) shows the dispersion curve. The red line is the true dispersion curve of Model A, and the blue and black
lines are obtained from the inversion results of BCDSA and SA, respectively. (b) shows the Vs proﬁle. The red line is the true value of Model A, and the blue and black
lines are the inversion results of BCDSA and SA, respectively.
Fig. 4. SA and BCDSA inversion results for Model B. The representations of the lines are the same as in Fig. 3.
Y. Wang et al.
Artiﬁcial Intelligence in Geosciences 2 (2021) 35–46
40
BCDESA are 2.55%, 3.64% and 5.14%, respectively, while the errors
from SA are 3.15%, 24.38% and 13.64%, respectively. The maximum
errors of h are 6.45%, 5.60% and 12.40% in the BCDESA inversion, while
the corresponding h errors are 8.80%, 22.47% and 33.67% in the SA
inversion, respectively.
4.2. Noisy case
In ﬁeld applications, recorded seismic data inevitably contain noise,
which may reduce the accuracy and stability of the inversion algorithm.
Table 5
Statistics of the inversion results for Model B (RE stands for relative error).
Parameters
True values
SA
BCDSA
Inverted
RE (%)
MSE
Inverted
RE (%)
MSE
V1 (m/s)
201
137.5
31.57
7.5
187.9
6.50
3.0
V2 (m/s)
301
246.4
18.14
296.7
1.41
V3 (m/s)
403
439.0
8.93
427.3
6.02
V4 (m/s)
505
496.2
1.74
501.7
0.65
H1
2
0.13
93.35
1.76
11.93
H2
4
4.98
24.47
4.19
4.66
H3
6
11.36
89.25
7.39
23.09
Fig. 5. Variations in the errors with increasing iterations. (a) is Model A, and (b) is Model B. The error is calculated by equation (1). Although SA converges faster than
BCDSA when the iteration number is small, BCDSA still has the potential to jump out of local solutions as the iteration number increases, enabling BCDSA to obtain a
better solution.
Fig. 6. BCDESA inversion of Model B under different termination errors. (a) shows the dispersion curves; (b) shows the Vs proﬁles. The black, blue, and red curves are
the inversion results with the termination error set to 4.5, 2.0, and the true value, respectively.
Table 6
Statistics of the inversion results for Model B for different TEs. TE and RE
represent the termination error and relative error, respectively.
Parameters
True
value
Termination error ¼ 4.5
Termination error ¼ 2.0
Inverted
RE
(%)
MSE
Inverted
RE
(%)
MSE
V1 (m/s)
201
182.4
9.27
4.1
198.5
1.27
1.8
V2 (m/s)
301
326.1
8.33
285.5
5.14
V3 (m/s)
403
400.1
0.73
414.6
2.87
V4 (m/s)
505
505.5
0.09
506.1
0.21
H1
2
1.84
8.15
1.79
10.51
H2
4
4.82
20.42
3.88
2.94
H3
6
5.37
10.47
6.88
14.67
Fig. 7. Variation in the error with the number of iterations. The generations
signiﬁcantly increase if the termination error is small.
Y. Wang et al.
Artiﬁcial Intelligence in Geosciences 2 (2021) 35–46
41
We add Gaussian noise of 20 dB to the dispersion curve to test the per-
formance of the BCDESA and SA algorithm under noisy conditions. We
set the termination error of the BCDESA to 12 because the mean square
error (E) of the noisy data and the clean data is between 10 and 11. The
other parameters are not changed.
Figs. 11–13 show comparisons between the model and the inversion
results for Models C, D, and E, respectively. In Figs. 11–13(a), the red
curves are the dispersion curves of the models with added noise. The blue
and black dotted curves are the dispersion curves from the inversion
results. Similarly, Figs. 11–13(b) show comparisons of the Vs proﬁles
between the true model (red curve) and the inverted models (blue curve
for BCDESA and gray curve for SA). The maximum errors of the inverted
Vs from BCDESA for Models C and D, E are 5.43%, 6.01% and 5.14%,
respectively, while the errors from SA are 9.14%, 9.81% and 9.79%,
respectively. The maximum errors of the inverted h are 3.10%, 7.12%
and 12.39% in BCDESA, while the corresponding errors are 55.10%,
9.27% and 24.39% in the SA inversion, respectively. The comparable
results between the noise-free and noisy data illustrate the good perfor-
mance of the BCDESA algorithm.
5. Field data example
To further test the applicability of BCDESA, we employ the BCDESA
method to invert the near-surface structure by using ﬁeld data acquired
in southwestern China. Fig. 14 shows the acquisition system: the GTDS-
10H seismometers are arranged with a minimum source-receiver spacing
of 1 m and a receiver interval of 2 m; the time interval is 1 ms, and the
record length is 2 s. Fig. 15a shows the array waveform recordings. The
energy is concentrated mainly between the 70th and 170th traces. A
dispersion analysis (Fig. 16b) is conducted by applying an F–K transform
to the waveforms in channels 121–168. Within the frequency range of
10–30 Hz, we can see more than one mode in Fig. 16b. Here, we
manually pick only the dispersion curve of the fundamental mode (see
the dotted curve in Fig. 15b) to invert the near-surface velocity proﬁle.
Core samples were collected approximately 40 m from the research
area, and the lithological column is shown in Fig. 16a. Table 11 lists the h
and Vs of each layer. Fig. 16b shows the inverted results from BCDESA
Table 7
Parameters for Model C: an increasing Vs layer model.
Layer
number
S-wave velocity
(m/s)
P-wave velocity
(m/s)
Density (kg/
m3)
Thickness
(m)
1
380
658.2
2000
10
2
540
935.3
2000
25
3
700
1056.6
2000
∞
Table 8
Parameters for Model D: a high-Vs interlayer model.
Layer
number
S-wave velocity
(m/s)
P-wave velocity
(m/s)
Density (kg/
m3)
Thickness
(m)
1
900
1558.8
2000
28
2
1340
2338.3
2000
24
3
1200
2078.5
2000
∞
Table 9
Parameters for Model E: a low-Vs interlayer model.
Layer
number
S-wave velocity
(m/s)
P-wave velocity
(m/s)
Density (kg/
m3)
Thickness
(m)
1
510
883.3
2000
10
2
400
692.8
2000
16
3
700
1212.4
2000
∞
Table 10
Convergence comparison of BCDESA with various values of the population size
M.CAA is the convergent average generation. ANI is the average individual
number, which represents the number of calculations.
M
10
20
30
CAA
2.16
1.92
1.91
ANI
21.
38.4
57.4
Fig. 8. Inversion results and synthetic dispersion curves of Model C from BCDESA and SA. (a) is a comparison between the true model dispersion curve (red solid
curve) and the best matching dispersion curves from the inversion (blue curve for BCDESA and black dotted curve for SA). (b) is a comparison between the Vs proﬁle of
the true model (red curve) and the inverted proﬁles (blue curve for BCDESA and gray curve for SA).
Fig. 9. Inversion results and the synthetic dispersion curves of Model D from BCDESA and SA. The description of the ﬁgure is the same as in Fig. 8.
Y. Wang et al.
Artiﬁcial Intelligence in Geosciences 2 (2021) 35–46
42
Fig. 10. Inversion results and the synthetic dispersion curves of Model E from BCDESA and SA. The description of the ﬁgure is the same as in Fig. 8.
Fig. 11. Inversion results for Model C from the noise-added (20 dB) dispersion curve of Model C. The description of the ﬁgure is the same as in Fig. 8.
Fig. 12. Invert results of Model D from the noise-added (20 dB) dispersion curve of Model C. The description of the ﬁgure is the same as in Fig. 8.
Fig. 13. Invert results of Model E from the noise-added (20 dB) dispersion curve of Model C. The description of the ﬁgure is the same as in Fig. 8.
Fig. 14. Schematic diagram of the acquisition system. A portable vibroseis source is used.
Y. Wang et al.
Artiﬁcial Intelligence in Geosciences 2 (2021) 35–46
43
(gray curve) and SA (blue curve). In this inversion, the number of layers
is set as 6 in the SA inversion, and the search range of the total thickness
is from 10 m to 30 m. The search range of Vs is from 0.5 times the
minimum phase velocity to twice the maximum phase velocity. The other
parameters are the same as the parameter settings in Model B (Table 3).
The parameters in BCDESA, such as the number of layers and the search
ranges of the total thickness and Vs, are the same as those in the SA
inversion. Although the search range of Vs is the same, the initial model
Vs is not known in advance in the BCDESA inversion.
Fig. 17 shows the dispersion curves from the inverted models (blue
curve for BCDESA and black curve for SA) and the dispersion curve
extracted from the measured waveform (red curve). The dispersion curve
from the model inverted by the BCDESA method has relatively small
errors at low frequencies. Quantitative analysis reveals that the errors of
the Vs proﬁles from the BCDESA and SA methods are 6.67 and 7.85,
respectively, which further illustrates the effectiveness of the BCDESA
method. To verify the accuracy of BCDESA, we use the X2 test, which is
deﬁned as:
X2 ¼
X
k
i¼1
ðoi � eiÞ2
ei
(11)
Fig. 15. (a) Array waveform recordings. (b) is the F–K spectrum of the waveforms from channels 121–168 in (a). The dotted curve is the manually picked dispersion
curve of the fundamental Rayleigh mode.
Fig. 16. (a) Lithological proﬁle from core samples; (b) Vs proﬁle obtained by the inversion.
Table 11
Lithology and Vs information from the core samples.
Starting depth
(m)
Final depth
(m)
Lithology
S-wave velocity
range (m/s)
0
2.5
Plain ﬁll
200~300
2.5
8.5
Clay
180~300
8.5
15
Pebble soil
300~600
15
19.4
Pebble soil
300~600
19.4
25
Mudstone (strong
weathering)
600~1300
25
45.5
Sandstone (moderate
weathering)
600~1300
Fig. 17. Forward modeling dispersion curves from the inversions. The blue
curve is the result from BCDESA, and the black curve is the result from SA. The
red curve represents the dispersion curve extracted from the observed
seismic waveform.
Y. Wang et al.
Artiﬁcial Intelligence in Geosciences 2 (2021) 35–46
44
where oi is the observed dispersion curve, ei is the dispersion curve for-
ward modeling of Vs obtained by inversion, and k represents k number
inversion are carried out. The results of X2 obtained by the above
equation is expressed as a sort of normalized distance between observed
and the synthesized data. As can be seen from Fig. 18, BCDESA has a
smaller deviation than SA from the statistics. Table 12 lists the results
from the BCDESA and SA inversions in detail. The inversion results from
the BCDESA method closely follow the borehole lithology, indicating that
the BCDESA method is more accurate than the SA method alone.
6. Conclusion
The inversion of Vs proﬁles from Rayleigh wave dispersion curves
constitutes a typical nonlinear inverse problem, which is characterized
by multiple inversion parameters and high dimensionality. It is not easy
to solve such a problem by using a traditional nonlinear inversion tech-
nique, such as the SA algorithm, because an increase in the number of
layers (a random iterative direction) leads to large errors in high-
dimensional nonlinear problems. Based on the SA algorithm, we pro-
pose the BCDESA algorithm, where the high-dimensional nonlinear SA
parameter inverse problem is solved by the BCD algorithm. By using the
population evolution and optimal control attributes of the DE technique,
the SA algorithm is transformed to control the whole iterative process
with error, thereby avoiding the instability of the inversion algorithm.
This method can also be used to solve other nonlinear inverse problems
in the future.
In this study, we systematically verify the feasibility of the proposed
method through experimental analysis. First, the BCD method is used to
improve the SA algorithm, which divides the high-dimensional param-
eter inverse problem of Rayleigh waves into several single-parameter
low-dimensional inverse problems and makes full use of the strong SA
solution to the single-parameter low-dimensional problem to improve
the SA inversion accuracy. From two model experiments with different
sets of layer thicknesses, compared to that of the SA algorithm, the ac-
curacy of the BCDSA algorithm after introducing the principle of BCD is
effectively improved, especially when the number of layers is increased,
and the improvement effect is more obvious. Furthermore, comparative
experiments reveal that for both BCDSA and SA, local optimization will
occur during the iteration process, and controlling the iteration by a
temperature control alone may cause unstable results. In view of the
above problems, this paper further introduces the DE algorithm and
changes the termination condition of the BCDSA algorithm from a tem-
perature condition to an error condition. This modiﬁcation realizes the
control of the whole iterative process by using the abovementioned error
and ultimately improves the stability of the algorithm. Finally, we use
three typical theoretical models to show that the BCDESA algorithm has a
better inversion accuracy than the SA algorithm, especially in the
inversion of low-speed interlayers, and can identify high-speed in-
terlayers. Moreover, the inversion of actual data in western China show
that the inversion results of the BCDESA algorithm are consistent with
drilling data, while the SA algorithm has a large deviation.
In the experiment, we also ﬁnd that the proposed method can set the
Vs and depth ranges automatically according to the Rayleigh wave ve-
locity and wavelength, which can achieve accurate and reliable inversion
results while avoiding the problem of the traditional method, which
needs to set the ranges of the inversion parameters artiﬁcially. This
provides convenience for practical applications and enables the indus-
trialization of the proposed method.
Declaration of competing interest
The authors declare that they have no known competing ﬁnancial
interests or personal relationships that could have appeared to inﬂuence
the work reported in this paper.
Acknowledgements
This study is supported by National Natural Science Foundation of
China (NOs. 41974150, 42174158, 42174151, 41804126), a supporting
program for outstanding talent of the University of Electronic Science and
Technology of China (No. 2019-QR-01), and Project of Basic Scientiﬁc
Research Operating Expenses of Central Universities (ZYGX2019J071;
ZYGX 2020J013). We thank three anonymous reviewers whose comments
substantially improved the presentation of our work.
References
Beaty, K.S., Schmitt, D.R., Sacchi, M., 2002. Simulated annealing inversion of multimode
Rayleigh wave dispersion curves for geological structure. Geophys. J. Int. 151,
622–631.
Chen, X., 1993. A systematic and efﬁcient method of computing normal modes for
multilayered half-space. Geophys. J. Int. 115, 391–409.
Dal Moro, G., Pipan, M., Gabrielli, P., 2007. Rayleigh wave dispersion curve inversion via
genetic algorithms and marginal posterior probability density estimation. J. Appl.
Geophys. 61, 39–55.
Foti, S., Parolai, S., Albarello, D., Picozzi, M., 2011. Application of surface-wave methods
for seismic site characterization. Surv. Geophys. 32, 777–825.
Ingber, L., 1989. Very fast simulated Re-annealing. Math. Comput. Model. 12, 967–973.
Kirkpatrick, S., Gelatt, C.D., Vecchi, M.P., 1983. Optimization by simulated annealing.
Science 220, 671–680.
Knopoff, L., 1964. A matrix method for elastic wave problems. B SEISMOL SOC AM 54,
431–438.
Lu, Y., Peng, S., Du, W., Zhang, X., Ma, Z., Lin, P., 2016. Rayleigh wave inversion using
heat-bath simulated annealing algorithm. J. Appl. Geophys. 134, 267–280.
Park, C.B., Miller, R.D., Xia, J., 1999. Multichannel analysis of surface waves. Geophysics
64, 800–808.
Pei, D., Louie, J.N., Pullammanappallil, S.K., 2007. Application of simulated annealing
inversion on high-frequency fundamental-mode Rayleigh wave dispersion curves.
Geophysics 72, R77–R85.
Pei, D., Louie, J.N., Pullammanappallil, S.K., 2008. Improvements on computation of
phase velocities of Rayleigh waves based on the generalized R/T coefﬁcient method.
B SEISMOL SOC AM 98, 280–287.
Pugin, A.J.M., Pullan, S.E., Hunter, J.A., 2013. Shear-wave high-resolution seismic
reﬂection in Ottawa and Quebec city, Canada. Lead. Edge 32, 250–255.
Fig. 18. Results of X2 test. The blue points are the results from BCDESA, and the
red points are the results from SA.
Table 12
Inversion results of the BCDESA and SA algorithms.
BCDESA
SA
Layer thickness (m)
Vs (m/s)
Layer thickness (m)
Vs (m/s)
2.56
199.0
2.82
199.3
5.21
249.2
2.49
262.2
6.06
572.5
2.15
264.8
6.83
529.4
2.27
303.6
6.80
581.0
6.39
718.4
∞
635.9
∞
517.2
Y. Wang et al.
Artiﬁcial Intelligence in Geosciences 2 (2021) 35–46
45
Qi, S., Sun, J., He, H., 2002. Review of Rayleigh wave exploration. Prog. Geophys. 17 (4),
630–635.
Rahnamayan, S., Tizhoosh, H.R., Salama, M.M., 2008. Opposition-based differential
evolution. IEEE T EVOLUT COMPUT 12, 64–79.
Ryden, N., Park, C.B., 2006. Fast simulated annealing inversion of surface waves on
pavement using phase-velocity spectra. Geophysics 71, R49–R58 s.
Storn, R., 1996. On the usage of differential evolution for function optimization. In:
Proceedings of North American Fuzzy Information Processing, pp. 519–523IEEE.
Storn, R., Price, K., 1997. Differential evolution–A simple and efﬁcient heuristic for global
optimization over continuous spaces. J. Global Optim. 11, 341–359.
Wang, J., Wu, G., Chen, X., 2019. Frequency-bessel transform method for effective
imaging of higher-mode Rayleigh dispersion curves from ambient seismic noise data.
J. Geophys. Res.: Solid Earth 124 (4), 3708–3723.
Wang, Y., Lin, W., Cheng, S., She, B., Hu, G., Liu, W., 2018. Sharp and laterally
constrained multitrace impedance inversion based on blocky coordinate descent.
Acta Geophys. 66, 623–631.
Xia, J., Miller, R.D., Park, C.B., 1999. Estimation of near-urface shear-wave velocity by
inversion of Rayleigh waves. Geophysics 64, 691–700.
Xu, Y., Yin, W., 2015. A block coordinate descent method for regularized multiconvex
optimization with applications to nonnegative tensor factorization and completion.
SIAM J IMAGING SCI 6, 1758–1789.
Xia, J., Gao, L., Pan, Y., Shen, C., Yin, X., 2015. New ﬁndings in high-frequency surface
wave method. Chin. J. Geophys. 58 (8), 2591–2605.
Yu, D., Song, X., Jiang, D., Zhang, X., Zhao, S., Zhao, P., Cai, W., Yuan, S., 2018.
Improvement of artiﬁcial bee colony and its application in Rayleigh wave inversion.
Chin. J. Geophys. 61 (4), 1482–1495.
Zhang, H., Maceira, M., Roux, P., Thurber, C., 2014. Joint inversion of body-wave arrival
times and surface-wave dispersion for three-dimensional seismic structure around
SAFOD. Pure Appl. Geophys. 171, 3013–3022.
Zhao, Q., Meng, D., Xu, Z., Gao, C., 2015. A block coordinate descent approach for sparse
principal component analysis. Neurocomputing 153, 180–190.
Y. Wang et al.
Artiﬁcial Intelligence in Geosciences 2 (2021) 35–46
46
