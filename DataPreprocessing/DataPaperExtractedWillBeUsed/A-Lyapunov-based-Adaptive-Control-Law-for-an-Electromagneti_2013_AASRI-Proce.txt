 AASRI Procedia  4 ( 2013 )  96 – 103 
2212-6716 © 2013 The Authors. Published by Elsevier B.V.
Selection and/or peer review under responsibility of American Applied Science Research Institute
doi: 10.1016/j.aasri.2013.10.016 
ScienceDirect
2013 AASRI Conference on Intelligent Systems and Control 2013
A Lyapunov-based Adaptive Control Law for an
Electromagnetic Actuator
Paolo Mercorelli
Leuphana University of Lueneburg
Institute of Product and Process Innovation
Volgershall 1, D-21339 Lueneburg, Germany
Tel.: +49-(0)4131-677-5571, Fax: +49-(0)4131-677-5300
mercorelli@uni.leuphana.de
Abstract
Electromagnetic devices in industrial systems are utilised for problems of positioning and tracking control. A direct
adaptive non-linear control framework for a non-linear electromagnetic actuator is presented in this paper. Starting from
a Lyapunov approach a continuous control law is calculated for the actuator. After that, an approximated sampled ﬁnal
control law is proposed. The resulting control strategy is an adaptive one in which the main parameter depends on the
variable inductance of the actuator itself. This aspect seems to be important to prevent saturation during the control
phase.
c⃝ 2011 Published by Elsevier Ltd. Selection and/or peer-review under responsibility of American Applied Research
Institute
Keywords:
Actuators; adaptive control; Lyapunov approach
1. Introduction and motivation
With the recent rapid progress in permanent-magnet technology, very compact and high-performance
electromagnetic linear actuators are already available in a wide range of applications. They open new
possibilities for high-force motion control in mechatronic applications. Recent contributions are given in this
direction in [1] and in [2] where different electromagnetic actuators are presented together with most of their
important control problems. In particular, control and optimal trajectory generation are analyzed. In [3] and
in [4] an electromagnetic actuator and its sensorless control using Kalman Filter are presented. In industrial
systems, mechanical and/or hydraulic-mechanical components have been often replaced by electromagnetic
ones, see [5] and [6]. One of the most utilized kinds of actuator is the linear electromagnetic one. There are,
beside linear electromagnetic actuators, other types of electromagnetic actuators with different advantages,
corporations, such as BMW [7], GM [8], DaimlerChrysler AG [9], Renault [10] and Siemens [5, 11] have
based their prototype developments on the electromagnetic actuator design. A typical set-up for this kind
of electromagnetic valve actuator, see the left side of Fig. 1, is equipped with two electromagnets and two
springs and a moving armature. The upper coil is responsible for the closing phase and the lower coil is
Available online at www.sciencedirect.com
© 2013 The Authors. Published by Elsevier B.V.
Selection and/or peer review under responsibility of American Applied Science Research Institute
Open access under CC BY-NC-ND license.
Open access under CC BY-NC-ND license.
97
 Paolo Mercorelli /  AASRI Procedia  4 ( 2013 )  96 – 103 
Fig. 1. Left: Valve actuator cross-sections. Right: Half valve actuator cross-sections
responsible for the opening phase of the valve. Since the inductance depends on the air gab between the
armature and the pole, the magnetic force is very sensitive to the variation of the air gap. The force increases
in a non-linear relation with respect to the air gap. Because of that, the input voltage should change very
fast to compensate these force variations. In this paper a direct adaptive non-linear control framework for a
non-linear electromagnetic actuator is proposed in which, starting from a Lyapunov approach, a continuous
control law is derived for the actuator. After that, an approximated sampled ﬁnal control law is proposed.
The resulting control strategy is an adaptive one in which the main parameter depends on the variable
inductance of the actuator itself. This aspect seems to be important to prevent saturation during the control
phase. The proposed control law seems to be suitable to avoid rapid changes in the input voltage which can
generate saturation. In fact, the proposed control law compensates this variability effect of the inductance
due to the movement of the armature using basically a cancelation. The paper is organised in the following
way. Section 2 is devoted to the model description of the considered actuator. Section 3 proposes an analysis
to derive the control law. Conclusions and future work close the paper.
2. Model description
In Fig. 2 the scheme of the magnetic circuit is drawn. State vector x(t) = [i(t), s(t), v(t)] and input
uin(t) are taken under consideration for the representation of the system. Current i(t), armature position
s(t), velocity v(t) and input voltage by uin(t) are the state variables. The dynamics of the electrical part of
the actuator is the following:
uin(t) − Rcui(t) − uq(t) = 0.
(1)
Considering that:
ΦCoil(t) = L(t)i(t),
(2)
with ΦCoil(t) the magnetic ﬂux is indicated. The induced voltage is:
uq(t) = ∂L(t)
∂t
i(t) + L(t)∂i(t)
∂t .
(3)
Inserting equation (3) into (1) the following expression is obtained:
∂i(t)
∂t
=
1
L(t)
�
uin(t) − Rcui(t) − ∂L(t)
∂t
i(t)
�
,
(4)
98  
 Paolo Mercorelli /  AASRI Procedia  4 ( 2013 )  96 – 103 
where i(t) is the current, u(t) is the supply voltage, Rcu is the resistance and L indicates the inductance.
Inductance L depends on current i(t) and on distance s(t). The mechanical dynamics are represented by:
∂s(t)
∂t
=
v(t)
(5)
∂v(t)
∂t
=
1
M
�
− kfs(t) + Fin(t) − kvv(t) + d(t)
�
.
(6)
From [12] and considering the hypothesis of a uniformly distributed ﬂux, the following expression for the
magnetic force is obtained:
Fin(t) =
i2(t)N 2
R2(s(t))AF e1μ0
.
(7)
M is the mass of the armature, kf is the constant which characterizes the spring, AF e1 the magnetic pole
cross-sectional area, N is the number of the windings of the coils, kv is the friction coefﬁcient, d(t) repre-
sents the force acting against the cylinder because of the burning phase of the engine. μ0 is the magnetic
air permeability and R is the magnetic reluctance from the air gap point of view. The parameters kf and kv
are considered constant here. In the right part of Fig. 2 a polynomial approximation of the inductance as a
function of the valve position is shown.
RmF e1
2
ΦAir
>
ΦCoil
RmF e1
2
ΘCoil
Φσ
Rmσ
RmAir
2
RmF e2
∨
RmAir
2
∨
0
2
4
6
8
10
12
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
Valve position (mm)
Inductance (mH)
Fig. 2. Left: Magnetic equivalent circuit of the actuator. Right: Polynomial approximation of the inductance as a function of the valve
position.
It holds:
ΘCoil = i(t)N,
(8)
ΦCoil = ΘCoil
Rmsum
.
(9)
Moreover it is possible to write that:
Rmsum = RmHe1 + Rmp,
(10)
where RmF e1 represents the ferromagnetic pole reluctance and
Rmp = Rmσ(RmF e2 + RmAir)
Rmσ + RmF e2 + RmAir
(11)
99
 Paolo Mercorelli /  AASRI Procedia  4 ( 2013 )  96 – 103 
is the parallel reluctance. In (11), Rmσ is the reluctance related to the leakage ﬂux and RmF e2 is the
armature magnetic reluctance.
Moreover,
RmF e1 =
ℓF e1
μ(HFe1)AF e1 ,
RmF e2 =
ℓF e2
μ(H Fe2)AF e2 ,
where μ = BF e1
HF e1 , ℓF e1 is the ferromagnetic pole length, μ = BF e2
HF e2 , ℓF e2 is the armature length and AF e2 is
its cross-section.
In addition,
RAir =
2s(t)
μ0AF e1 ,
Rmσ =
RmF e2RAir
k0s(t)
,
where ko is a constant. Through mathematical calculations, the following expression is obtained:
Φσ = Φcoil
(RmF e2 + RmAir)
Rmσ + RmF e2 + RmAir
(12)
and
ΦAir = Φcoil
Rmσ
Rmσ + RmF e2 + Rmair
.
(13)
The reluctance from the air gap point of view can be calculated as follows:
R = (Rmσ + RmF e2 + RmAir)Rmsum
Rmσ
.
(14)
The uniform magnetic density ﬂuxes are calculated in the following way:
BFe1 = ΦCoil
AF e1 ,
BFe2 = ΦAir
AF e2 ,
BAir = ΦAir
AF e1 .
(15)
Note that the reluctance RmAir and Rmσ are strongly dependent on the armature position.
3. An adaptive Lyapunov Based Controller
It is known that inductance L(t) depends on position s(t), and thus starting from equations (4)–(6) the
following differential equations are obtained:
∂i(t)
∂t
=
1
L(s(t))
�
uin(t) −
�
Rcu + ∂L(t)
∂t
�
i(t)
�
(16)
∂L(t)
∂t
=
∂L(t)
∂s(t)
∂s(t)
∂t
(17)
∂s(t)
∂t
=
v(t)
(18)
∂v(t)
∂t
=
1
M
�
− kfs(t) + Fin(t) − kvv(t) + d(t)
�
.
(19)
The system represented by equations (16)–(19) can be represented as follows:
˙x(t) =
⎡
⎢⎢⎢⎢⎢⎢⎣
∂i(t)
∂t
∂L(t)
∂t
∂s(t)
∂t
∂v(t)
∂t
⎤
⎥⎥⎥⎥⎥⎥⎦
= f(x(t)) + g(x(t))uin(t) + Dd(t)
(20)
100  
 Paolo Mercorelli /  AASRI Procedia  4 ( 2013 )  96 – 103 
with ﬁelds
f(x(t)) =
⎡
⎢⎢⎢⎢⎣
−
1
L(s(t))
�
Rcui(t) + ∂L(t)
∂t i(t)
�
∂L(t)
∂s(t) v(t)
v(t)
1
M
�
− kfs(t) + Fin(t) − kvv(t)
�
⎤
⎥⎥⎥⎥⎦
,
g(x) =
⎡
⎢⎢⎣
1
L(s(t))
0
0
0
⎤
⎥⎥⎦ ,
D =
⎡
⎢⎢⎣
0
0
0
1
M
⎤
⎥⎥⎦ .
(21)
If the following controller is deﬁned:
K(t) = G
�
xd(t) − x(t)
�
,
(22)
where G =
� Pi
0
Ps
Pv
�
, in which Pi, Ps and Pv are constant to be set. xd(t) represents the vector
of the desired state variables of the actuator. Equation (22) becomes as follows:
K(t) =
�
Pi
0
Ps
Pv
�
⎡
⎢⎢⎣
id(t) − i(t)
Ld(t) − L(t)
sd(t) − s(t)
vd(t) − v(t)
⎤
⎥⎥⎦
(23)
with Pi, Ps and Pv are the parameters of the controller. If the following Lyapunov function is deﬁned:
V (K) = K2(t)
2
,
(24)
then it follows that:
˙V (K) = K(t) ˙K(t).
(25)
To ﬁnd the stability condition of solution K(t) = 0, the following Lyapunov function is considered:
˙V (K) = −η(t)K2(t),
(26)
with η > 0. Comparing (25) with (26), the following relation is obtained:
K(t) ˙K(t) = −ηK2(t),
(27)
and to conclude it follows that:
K(t)
� ˙K(t) + ηK(t)
�
= 0.
(28)
The constructive solution is obtained using the following condition:
˙K(t) + ηK(t) = 0.
(29)
From (22) it follows:
˙K(t) = G
� ˙xd(t) − ˙x(t)
�
= G ˙xd(t) − G ˙x(t).
(30)
The basic idea is to calculate a ueq(t), an equivalent input, and after that a uin(t), such that ˙x(t) = ˙xd(t).
For that, from (20), if d(t) = 0, then:
˙x(t) = ˙xd(t) = f(xd(t)) + g(xd(t))uin(t),
(31)
and from (30) it follows:
˙K(t) = G ˙xd(t) − Gf(xd(t)) − Gg(xd(t))uin(t) = Gg(xd(t))
�
ueq(t) − uin(t)
�
,
(32)
where ueq(t) is the equivalent input and it follows that:
ueq(t) =
�
Gg(xd(t))
�−1G
�
˙xd(t) − f(xd(t))
�
.
(33)
101
 Paolo Mercorelli /  AASRI Procedia  4 ( 2013 )  96 – 103 
After inserting (32) into (29) the following relation is obtained:
Gg(xd(t))
�
ueq(t) − uin(t)
�
+ ηK(t) = 0,
(34)
and in particular
uin(t) = ueq(t) +
�
Gg(xd(t))
�−1ηK(t).
(35)
Normally, calculating ueq(t) could be difﬁcult. Using Euler approximation, equation (32) can be rewritten
in a discrete form as:
K((k + 1)Ts) − K(kTs)
Ts
= Gg(xd(t))
�
ueq(kTs) − uin(kTs)
�
.
(36)
Considering Euler approximation for equation (35), the following equation is obtained:
uin(kTs) = ueq(kTs) +
�
Gg(xd(t))
�−1ηK(kTs).
(37)
Equation (36) can be also rewritten as:
ueq(kTs) = uin(kTs) +
�
Gg(xd(t))
�−1 K((k + 1)Ts) − K(kTs)
Ts
.
(38)
Equation (38) is equivalent to:
ueq((k − 1)Ts) = uin((k − 1)Ts) +
�
Gg(xd(t))
�−1 K(kTs) − K((k − 1)Ts)
Ts
.
(39)
Because of ueq(t) is a continuous function, then:
ueq(kTs) ≈ ueq((k − 1)Ts).
(40)
Considering equation (40), then equation (39) becomes:
ueq(kTs) = uin((k − 1)Ts) +
�
Gg(xd(t))
�−1 K(kTs) − K((k − 1)Ts)
Ts
.
(41)
Inserting (41) into (37):
uin(kTs) = uin((k − 1)Ts) +
�
Gg(xd(t))
�−1�
ηK(kTs) + K(kTs) − K((k − 1)Ts)
Ts
�
,
(42)
and ﬁnally:
uin(kTs) = uin((k − 1)Ts) +
�
Gg(xd(t))Ts
�−1�
ηTsK(kTs) + K(kTs) − K((k − 1)Ts)
�
.
(43)
Remark 1. It is to notice that
�
Gg(xd(t))Ts
�−1 = L(s(t))
PiTs . Factor
�
Gg(xd(t))Ts
�−1 represents the main
weight of the control. The resulting control law is an adaptive one in which the main parameter depends
on the variable inductance of the actuator itself. This aspect seems to be important to prevent saturation
during the control phase. Because of the presence of the inductance value in the numerator of this factor,
from equation (16), the control law cancels the effect of this nonlinearity.
□
4. Simulations
Simulated results are visible in Figs. 3 and 4. This trajectory corresponds to 6000 rounds per minute.
The power involved for each exhaust valve does not exceed the mean value of 60 W in the case of 6000 rpm.
A sampling time equal to 20 × 10−6sec. is used.
102  
 Paolo Mercorelli /  AASRI Procedia  4 ( 2013 )  96 – 103 
0.01
0.02
0.03
0.04
0.05
0.06
0.07
−15
−10
−5
0
5
10
15
Time (sec.)
Position (mm)
Desired valve position
Obtained valve position
0.018
0.02
0.022
0.024
0.026
−2
0
2
4
6
8
10
12
Time (sec.)
Position (mm)
Desired valve position
Obtained valve position
Fig. 3. Left: Position (6000 rpm). Right: Detail of the position (6000 rpm)
0.01
0.02
0.03
0.04
0.05
0.06
0.07
−15
−10
−5
0
5
10
15
Time (sec.)
Velocity (m/sec.)
0.018
0.02
0.022
0.024
0.026
−4
−2
0
2
4
6
8
Time (sec.)
Velocity (m/sec.)
Desired valve velocity
Obtained valve velocity
Fig. 4. Left: Velocity (6000 rpm). Right: Detail of the velocity (6000 rpm).
5. Conclusions and future work
A direct adaptive non-linear control framework for a non-linear electromagnetic actuator is presented in
this paper and starting from a Lyapunov approach a continuous control law is calculated for the actuator.
After that, an approximated sampled ﬁnal control law is proposed. The resulting control law is an adaptive
one in which the main parameter depends on the variable inductance of the actuator itself. This aspect seems
to be important to prevent saturation during the control phase.
5.1. Future work
The results which have been presented are based on the assumption that the inductance, as a function of
the position of the armature, is known. To apply this algorithm in practical applications a robust analysis is
requested.
References
[1] P. Mercorelli, An anti-saturating adaptive pre-action and a slide surface to achieve soft landing control for electromagnetic
actuators, IEEE/ASME Transactions on Mechatronics 17 (1) (2012) 76–85.
103
 Paolo Mercorelli /  AASRI Procedia  4 ( 2013 )  96 – 103 
[2] A. Fabbrini, A. Garulli, P. Mercorelli, A trajectory generation algorithm for optimal consumption in electromagnetic actuators,
IEEE Transactions on Control System Technology 20 (4) (2012) 1025–1032.
[3] P. Mercorelli, A two stage augmented extended kalman observer for sensorless valve control in camless internal combustion
engines, IEEE Transactions on Industrial Electronics 59 (11) (2012) 4236–4247.
[4] P. Mercorelli, A hysteresis hybrid extended kalman ﬁlter as an observer for sensorless valve control in camless internal combus-
tion engines, IEEE Transactions on Industry Applications 48 (6) (2012) 1940–1949.
[5] S. Butzmann, J. Melbert, A. Koch, Sensorless control of electromagnetic actuators for variable valve train, in: Proc. SAE Tech-
nical Paper 2000-01-1225 (http://www.sae.org/automag/), Detroit, 2000.
[6] K. Peterson, A. Stefanopoulou, Rendering the elecreomechanical valve actuator globally asymptotically stable, in: Proc. 42nd
IEEE Conference on Decision and Control, Maui, Maui, 2003.
[7] R. Flierl, M. Kl¨uting, The third generation of valvetrains - new fully variable valvetrains for throttle-free load control, in: SAE,
2000-01-1227 (http://www.sae.org/automag/), 2000.
[8] M. A. Theobold, B. Lequesne, R. Henry, Control of engine load via electromagnetic valve actuators, in: SAE, 940816
(http://www.sae.org/automag/), 1994.
[9] M. Gramann, M. Nagel, T. Rockl, R. Wilczek, Electromagnetic actuator, in: US Pat. 6,037,851, 2000.
[10] S. Birch, Renault research, in: Automotive Engineering International Online (http://www.sae.org/automag/), 2000.
[11] M. Schechter, M. Levin, Camless engine, in: SAE, 960581 (http://www.sae.org/automag/), 1996.
[12] F. Moon, Magneto-solid Mechanics, John Wiley and Sons, New York, 1984.
