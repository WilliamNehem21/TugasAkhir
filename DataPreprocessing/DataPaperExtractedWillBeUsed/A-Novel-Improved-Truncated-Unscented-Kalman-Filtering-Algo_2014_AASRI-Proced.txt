 AASRI Procedia  6 ( 2014 )  34 – 40 
Available online at www.sciencedirect.com
2212-6716 © 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license 
(http://creativecommons.org/licenses/by-nc-nd/3.0/).
Peer-review under responsibility of Scientific Committee of American Applied Science Research Institute
doi: 10.1016/j.aasri.2014.05.006 
ScienceDirect
2013 2nd AASRI Conference on Computational Intelligence and Bioinformatics 
A Novel Improved Truncated Unscented Kalman Filtering 
Algorithm
Chao Hou, Liang-qun Li* 
ATR Key Laboratory, Shenzhen University, Shenzhen, GuangDong 518060, P.R.China 
Abstract 
For the conventional truncated unscented Kalman filtering (TUKF) algorithm requires the measurement to be a bijective 
function, a novel improved truncated unscented Kalman filtering is proposed. In the proposed algorithm, we linearize the 
bijective measurements function based on the statistical linear regression (SLR) in order to obtain the only inverse 
function of the measurement function. It is a modified algorithm which extends the range of practical application of the 
filtering problems. Finally, the experiments show that the performance of the proposed algorithm is better than the 
unscented Kalman filter (UKF) and the quadrature Kalman filter (QKF). This approach can efficiently deal with this 
problem that measurement functions are not bijective.  
© 2013 Published by Elsevier B.V. 
Selection and/or peer review under responsibility of American Applied Science Research Institute 
Keyword: Truncated Unscented Kalman Filtering; Statistical Linear Regression; Linearization of the Measurements Function 
1. Introduction 
Estimation refers to estimate the parameters or some state variables from the observed data with random 
error. Filtering is estimating the current signal value of the state of the process by the observed value from real 
time indirect measurement. The optimal approximation to the nonlinear filtering problem demands a complete 
* Corresponding author. Tel.: +0-755-2673-2055; fax: +0-755-2673-2049. 
E-mail address: lqli@szu.edu.cn. 
© 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license 
(http://creativecommons.org/licenses/by-nc-nd/3.0/).
Peer-review under responsibility of Scientific Committee of American Applied Science Research Institute
35
 Chao Hou and Liang-qun Li /  AASRI Procedia  6 ( 2014 )  34 – 40 
representation of the obtained posterior distribution. For most problems the posterior probability density 
function (PDF) of the state is difficult to handle so approximations are required which involves two steps: 
prediction and update [1] .
UKF approximates the nonlinear distribution through deterministic sampling to capture the Gaussian  
variables with covariance and mean. The accuracy and stability is superior to EKF. UKF is increasingly 
concerned and has been widely used. The truncated Kalman filter (TKF) proposes a modified prior PDF in the 
Kalman filtering process, which improves the performance of Kalman filtering effectively. TUKF 
approximates the TKF when the measurements are informative. The main limitation of TUKF is that it 
requires the measurement function of the state be bijective. This paper modifies the limitations of TUKF 
algorithm using SLR for linearization of measurement functions. The simulations show that the computation 
of the presented algorithm is equivalent to other Gaussian approximation, but the filtering performance is 
better than other filtering method.  
The outline of this paper is arranged as follows. In Section 2, the nonlinear model of Kalman filtering is 
presented. In Section 3, a novel improved truncated unscented Kalman filtering is present, including the 
principle and concrete steps of the algorithm. The experiment and analysis are provided in Section 4.  
2. Kalman Filter for Nonlinear Environment 
Consider a discrete nonlinear system, we assume the measurement equation as follows: 
k
k
k
w
h x
z
�
�
)
(
                                                                                                                                             (1) 
where 
nx
k
x � R
denotes the system state, 
nz
k
z � R
 denotes the measurement of the system, 
h(�)
denotes a 
known nonlinear function, the measurement noise 
k
w  is presumed to be Gaussian with covariance 
Ri (k)
 and 
zero mean. We suppose
( )
p0 �
 the prior distribution of 
kx , the MMSE 
xk k
ˆ |
 and covariance 
k k
P | of 
x k
given 
kz
are[2]:
]
[
ˆ |
k
k
k k
E x z
x
�
                                                                                                                                             (2) 
]
)
ˆ
)(
ˆ
([
|
|
|
k
T
k k
k
k k
k
k k
z
x
x
x
E x
P
�
�
�
                                                                                                                (3) 
Calculating 
k k
x |
ˆ
 and 
k
kP |  directly is very difficult due to the integration. Kalman filtering provides the 
linear MMSE estimator of 
kx  given 
kz ,
,0
ˆux
[3] 
ˆ )
(
ˆ
ˆ
0
1
1
, |
1
, |
1
|
,0,
,0, |
z
z
P
P
x
x
k
zz k k
xz k k
k k
p
u k k
�
�
�
�
�
�
�
                                                                                                   (4) 
Where 
� �
�
k
k
k
k
x dx
p
E z x
E z
z
( )
]
[
]
[
ˆ
0
0
                                                                                                                  (5) 
36  
 Chao Hou and Liang-qun Li /  AASRI Procedia  6 ( 2014 )  34 – 40 
�
�
�
�
� �
k
k
T
k
k
k
zz kk
x p x dx
z
z
z
E z
z
P
( )
]
ˆ ) |
ˆ )(
[(
]
cov[
0
0
0
1
, |
                                                                                              (6) 
�
�
�
�
�
�
k
k
T
k
p
k
k
k
xz k k
p x dx
x
z
z
x
E x
z
x
P
( )
]
ˆ ) |
)(
ˆ
[(
]
,
cov[
0
0
,0
1
, |
                                                                         (7) 
where 
1
ˆ ,0, |
xp k k�
denotes the mean of the prior probability of 
kx .Then the updated covariance can be estimated 
as follows 
T
xz k k
zz k k
xz k k
k k
p
u k k
P
P
P
P
P
1
, |
1
1
, |
1
, |
1
|
,0,
|
,0,
�
�
�
�
� �
�
                                                                                                       (8) 
where
1
|
, ,0
Pp k k�
 is the covariance of the prior probability. 
3. Modified Truncated Unscented Kalman Filter 
3.1. Truncated unscented Kalman filter 
Consider a discrete nonlinear system, we assume the measurement equation as follows: 
k
k
k
w
h a
z
�
�
)
(
                                                                                                                                            (9) 
where 
h(�)
 is the nonlinear function of 
ka . Supposing 
h(�)
 is bijective and the PDF of the additive noise is 
bounded, then the joint prior PDF
( )
p2 �
 is defined based on
)
;
1(
p xk zk
and
)
0 (
kx
p
as follows[5]:
)
(
)
1(
)
;
(
)
;
(
0
0
1
0
2
k
k
k
k
k
x
p
p x z
z
x
p
�
�
�
�
�
                                                                                                        (10) 
where
]1,0
�0 �[
. Suppose 
ˆ p 1,
x
 and 
Pp 1,
denote the mean and covariance matrix of 
( )
p1 �
 respectively, the 
updated covariance and mean is 
,0
1,
,2
) ˆ
1(
ˆ
ˆ
u
u
u
x
x
x
�
�
�
�
�
                                                                                                                               (11) 
) ]
ˆ
)(ˆ
ˆ
ˆ(
)[
1(
) ]
ˆ
)(ˆ
ˆ
ˆ(
[
2,
0,
2,
0,
0,
2,
1,
2,
1,
1,
2,
T
u
u
u
u
u
T
u
u
u
u
u
u
x
x
x
x
P
x
x
x
x
P
P
�
�
�
�
�
�
�
�
�
�
�
                                                             (12) 
where 
]
)
1(
[
1
0
0
0
�
�
�
�
�
�
�
�
,
]1,0
� �[
 maintains the degree of freedom of 
0
� . The detailed derivation of the 
TUKF algorithm can be found in [6]. 
3.2. Approximation of 
)
1(
kz
h�
To approximately compute
)
1(
kz
h�
, our purpose is to get a linear estimation of 
kz ,
k
k
k
k
d
H x
z
�
ˆ �
, where 
k
H  is a matrix and
k
d is a vector. They are depend on the minimum of  the mean-squared error [7] using SLR 
)
(
argmin
}
,
{
k
T
k
k
k
a
E a
d
H
�
                                                                                                                      (13) 
1
1
1
1
) ]
)(
(
[
) ]
)(
(
[
�
�
�
�
�
�
�
�
�
�
�
�
�
T
k
k
k
k
m
l
l
T T
k
k
k
k
m
l
l
xx
T
xz
k
x
x
x
w x
z
z
x
w x
P P
H
l
l
l
l
                                                                  (14) 
k
k
k
k
H x
z
d
�
�
                                                                                                                                           (15) 
37
 Chao Hou and Liang-qun Li /  AASRI Procedia  6 ( 2014 )  34 – 40 
3.3. Modified truncated unscented Kalman filtering algorithm 
Assume at time
k �1
that the mean
|1 1
ˆ
kx � k�
and variance
|1 �1
kP � k
of the state is known, and the process noise
k
w and
the measurement noise 
kv are independent, whose means are zero and covariances are 
k
Q and
k
R . Our objective 
is approximately calculate the first two moments
kx |ˆ k
and
k
kP | of the posterior PDF �
p xk z k �
| :1
based on the current 
measurement
kz .
3.3.1. Unscented transformation and time update 
According to the reference [6], we can first obtain 
1
2
�
�
na
N
sigma points
N
0
2
0
1
0
...,
,
�
� �
 and the associated 
weights
wN
w w
,...,
,
2
1
 using UT[8], where
w
v
x
a
n
n
n
n
�
�
�
, The one-step predicted sigma points are acquired 
using the nonlinear state function
f (�)
:
N
i
f
i
i
k k
,
,2,1
),
(
0
1
0, |
�
�
� �
�
�
                                                                                                                 (16) 
Therefore, the first two moments of the predicted PDF 
�
1 �
:1
0
|
p xk z k�
 can be approximated as  
i
k
k
N
i
i
p k k
w
x
1
|
,0
1
1
|
ˆ , ,0
�
�
�
� �
�
                                                                                                                                (17) 
�
�
�
�
�
�
�
�
�
N
i
T
p
i
k k
p
i
k k
i
k
p k k
x
x
w
Q
P
1
0,
1
|
,0
0,
1
|
,0
1
,0, |
)
ˆ
)(
ˆ
(
�
�
                                                                                                  (18) 
3.3.2. Measurement update 
A. Update measurement based on the prior 
� �
x
p0
To approximately compute the predicted measurement
1
0ˆ , |
z k k�
, the one-step predicted sigma 
points�
�
N
i
i
k k
1
1
,0 |
� �
�
are propagated through the measurement model
h(�)
as follows: 
N
i
h
z
i
k k
i
k k
,
,2,1
),
(
1
|
,0
1
,0 |
�
�
�
�
�
�
                                                                                                                 (19) 
the predicted measurement can be estimated as  
�
�
�
� �
N
i
j
k k
i
k k
w z
z
1
1
0, |
1
|
,0ˆ
                                                                                                                                    (20) 
according to (19) and (20), the innovation covariance is estimated as  
�
�
�
�
�
�
�
�
�
�
�
m
i
T
k k
i
k k
k k
i
k k
i
k
zz k k
z
z
z
w z
R
P
1
1
|
,0
1
|
,0
1
|
,0
1
|
,0
1
, |
)
ˆ
)(
ˆ
(
                                                                                     (21) 
the cross covariance is calculated as 
�
�
�
�
�
�
�
�
�
�
m
i
T
k k
i
k k
k k
p
i
k k
i
xz k k
z
z
x
w
P
1
1
0, |
1
0, |
1
,0, |
1
0, |
1
, |
)
ˆ
)(
ˆ
(�
                                                                                       (22) 
the error covariance is computed as 
T
k k
p
i
k k
k k
p
i
k
k
m
i
i
xx k k
x
x
w
P
)
ˆ
)(
ˆ
(
1
|
,0,
1
,0 |
1
|
,0,
1
,0 |
1
1
, |
�
�
�
�
�
�
�
�
��
�
�
                                                                                              (23) 
38  
 Chao Hou and Liang-qun Li /  AASRI Procedia  6 ( 2014 )  34 – 40 
Consequently, according to (21-23), the first two moments of the posterior PDF
�
xk z k �
p
:1
0
|
based on the 
prior
� �
p0 x
can be approximately computed as follows: 
)
ˆ
(
ˆ
ˆ
1
|
,0
1
1
, |
1
, |
1
|
,0,
|
,0,
�
�
�
�
�
�
�
�
k k
k
zz k k
xz k k
k k
p
u k k
z
z
P
P
x
x
                                                                                              (24) 
T
xz k k
zz k k
xz k k
k k
p
k k
u
P
P
P
P
P
1
, |
1
1
, |
1
, |
1
,0, |
,0, |
�
�
�
�
� �
�
                                                                                                (25) 
B. Measurement update based on the modified prior 
According to (14) and (15) in section 3.2, the linear regression coefficients
kHand
k
d can be computed by 
using the (22-23) as 
1
1
, |
1
, |
�
�
�
�
k k
xx
T
xz k k
k
P
P
H
                                                                                                                             (26)
1
,0, |
1
0, |
ˆ
ˆ
�
� �
�
k k
p
k
k k
k
H x
z
d
                                                                                                                          (27) 
Then, the measurement equation (1) can be written as a linear function: 
k
k
k
k
k
k
k
w
d
H x
w
h x
z
�
�
�
�
�
)
(
                                                                                                                     (28) 
The first two moments
1
,1, |
ˆ
xp k k�
and
1
|
,1,
Pp k k�
of 
� �
p1 x
 can be approximately computed as 
�
�
�
�
�
�
�
�
1,
1,
1
,1, |
ˆ
b
a
xp k k
�
�
                                                                                                                                        (29) 
�a 1,
 in (29) can be approximately calculated as 
�
k �
k
k
k
k
k
k
k
a
d
z
H
z
h
da
z
a p a
�
�
�
�
��
�
)
(
)
;
(
1
1
� 1,
                                                                                               (30) 
�
�
�
�
�
�
�
� �
�
�
�
�
�
1,
1,
1,
1,
1
,1, |
)
(
b
T
ab
ab
a
p k k
P
                                                                                                                      (31) 
where 
�b 1,
, � 1,
a
� 1,
b
and �
1,
ab can be computed according to [6]. 
Since the sigma points�
i wi �
�0 ,
 do not reflect the uncertainty due to the modified prior
� �
p1 x
, we draw 
N sigma points 
N
k k
k k
k k
1
,1 |
2
1
,1 |
1
1
,1 |
,
,
,
�
�
�
�
�
�
�
with the associated weights 
wN
w w
,......
,
2
1
 using the UT based on the 
mean
1
,1, |
ˆ
xp k k�
and variance
1
|
,1,
Pp k k�
. The predicted measurement and covariance is similar to the (19-23), then 
the first two moments of the posterior PDF
�
k �
k
z
x
p
:1
1
|
based on the prior
� �
p1 x
can be approximately computed as 
follows: 
)
ˆ
(
ˆ
ˆ
1
,1 |
1
1
|
,1
1
|
,1
1
|
,1,
|
,1,
�
�
�
�
�
�
�
�
k k
k
k k
zz
k k
xz
k k
p
u k k
z
z
P
P
x
x
                                                                                     (32) 
T
k k
xz
k k
zz
k k
xz
k k
p
u k k
P
P
P
P
P
1
|
,1
1
1
|
,1
1
|
,1
|
,1,
|
,1,
�
�
�
�
�
�
                                                                                              (33) 
Finally, the update mean and covariance are 
k k
u
k k
u
k k
x
x
x
,0, |
|
,1,
|
) ˆ
1(
ˆ
ˆ
�
�
�
�
�
                                                                                                                    (34) 
�
T �
k k
k k
u
k k
k k
u
k k
u
T
k k
k k
u
k k
k k
u
k k
u
k k
x
x
x
x
P
x
x
x
x
P
P
)
ˆ
)(ˆ
ˆ
( ˆ
)
1(
) ]
ˆ
)(ˆ
ˆ
( ˆ
[
|
|
,0,
|
|
,0,
|
,0,
|
|
,1,
|
|
,1,
|
,1,
|
�
�
�
�
�
�
�
�
�
�
�
�
�
                         (35) 
Where 
)
) (
1(
)
(
)
(
0,
0,
0,
a
a
a
tr
tr
tr
�
�
�
�
�
�
�
�
�
�
 can be found in [6]. 
39
 Chao Hou and Liang-qun Li /  AASRI Procedia  6 ( 2014 )  34 – 40 
4. Simulation Results 
In this section, we present the result using a nonlinear model. The DSS equations for this model can be 
written as 
wk
t
x
x
x
f x
�
�
� �
�
�
�
�
�
)
8 cos( 2.1
^2)
/(1
25
5.0
( )
�
�
�
�
�
�
�
�
�
�
30
,
2
.5 *
0
30
,
0.2 *
)
(
3
2
k
v
x
k
v
x
x
h
k
k
where
( 5,0 )
~
( 1,0 ),
~
N
v
N
w
k
k
. Data were produced using 
2
,0
,1
�
�
�
�
�
�
.We compare the performance of the 
improved TUKF with UKF and QKF using Monte Carlo simulation with 100 runs. The estimation of the state 
using improved TUKF, UKF, QKF and the real state are present in Fig.1. 
0
10
20
30
40
50
60
-25
-20
-15
-10
-5
0
5
10
15
20
25
The real state
UKF
QKF
improved TUKF
Fig. 1. The Mean and Covariance 
0
10
20
30
40
50
60
0
2
4
6
8
10
12
14
16
18
UKF
QKF
improved TUKF
Fig.2. The Performance of Filters 
The MSE of UKF, QKF and improved TUKF are shown in Fig.2. We should realize that the mean and 
covariance of improved TUKF is lower than UKF and QKF. The performance of improved TUKF is higher 
than other filters.  
Finally, in order to take into account the influence of parameters in the algorithm, we change the value of 
the covariance of measurement noise Q  and process noise R , the performance of algorithm is shown in table 1. 
Table 1. The mean and covariance of filters for different process noise parameters 
parameters 
Improved TUKF 
QKF 
UKF 
Mean 
Covariance 
Mean 
Covariance 
Mean 
Covariance 
40  
 Chao Hou and Liang-qun Li /  AASRI Procedia  6 ( 2014 )  34 – 40 
1
,1
�
�
R
Q
3.6121 
14.7504 
8.0247 
22.7289 
17.6235 
481.5755 
2
,1
�
�
R
Q
3.741 
15.2822 
6.8923 
8.0638 
13.8717 
150.0981 
3
,1
�
�
R
Q
3.7263 
15.1242 
6.8689 
9.9092 
9.6105 
39.892 
4
,1
�
�
R
Q
3.7361 
13.8912 
7.6627 
9.5067 
9.0108 
22.202 
5
,1
�
�
R
Q
3.6858 
13.3754 
7.0458 
7.7285 
7.3666 
11.5767 
According to the simulation results above, it is clear that the function of the algorithm is preferable if the 
measurement noise is larger. However, if the process noise is smaller, the results is not good enough, even the 
performance of improved TUKF is not as good as UKF and QKF. 
5. Conclusions 
The proposed algorithm linearizes the measurement function using SLR based on TUKF for the nonlinear 
filtering. It can deal with the situation when the measurement is not bijective. On this condition the algorithm 
extends the range of application of the filter. Simulations show that in general, the improved TUKF performs 
better than UKF and QKF. 
Acknowledgements 
This work was supported by the National Natural Science Foundation of China (61301074, 61271107), 
Research Fund for the Doctoral Program of Higher Education of China (20104408120001), Natural Science 
Foundation of the Guangdong Province of China (S2012010009417), Key Project of National Science & 
technology of pillar program (2011BAH24B12). 
References 
[1] M. Arulampalam, S. Maskell, N.Gordon, and T. Clapp, “A tutorial on particle Filter for online 
nonlinear/non-Gaussian Bayesian tracking,” IEEE Trans. Signal Process., vol. 50, no. 2, pp.174-188,Feb.2002. 
[2]Y. Bar-Shalom, T. Kirubarajan , and X. R. Li, Estimation with Applications to Tracking and Navigation . 
Hoboken, NJ: Wiley, 2001. 
[3] S. M. Kay, Fundamentals of Statistical Signal Processing: Estimation Theory. Englewood Cliffs, NJ: 
Prentice-Hall, 1993. 
[4] K. Burdett, “Truncated means and variances,” Econ. Lett., vol. 52, pp.263–267, 1996. 
[5] A. F. García-Fernández, M. R. Morelande, and J. Grajal, “Nonlinear filtering update phase via the single 
point truncated unscented Kalman filter,” in Proc. 14th Int. Conf. Inform. Fusion, 2011, pp. 17–24. 
[6] Ángel F.García-Fernández, Mark R.Morelande, Jesús Grajal�“Truncated Unscented Kalman Filtering�”
IEEE Trans. Signal Process., vol. 60, no. 7,July 2012. 
[7]Ienkaran Arasaratnam, Simon Haykin, “Discrete-Time Nonlinear Filtering Algorithms Using Gauss–
Hermite Quadrature,” PROC.IEEE,vol.95,no.5,May 2007. 
[8] S. J. Julier and J. K. Uhlmann, “Unscented filtering and nonlinear estimation, ”Proc. IEEE, vol. 92, no. 3, 
pp. 401–422, Mar. 2004. 
