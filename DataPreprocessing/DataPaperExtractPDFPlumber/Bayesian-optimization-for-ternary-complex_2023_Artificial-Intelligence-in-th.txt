Artificial Intelligence in the Life Sciences 3 (2023) 100072
Contents lists available at ScienceDirect
Artificial Intelligence in the Life Sciences
journal homepage: www.elsevier.com/locate/ailsci
Bayesian optimization for ternary complex prediction (BOTCP)
Arjun Rao 1 ,∗ , Tin M. Tunjic 1, Michael Brunsteiner 1, Michael Müller, Hosein Fooladi,
Chiara Gasbarri, Noah Weber 2
Celeris Therapeutics GmbH, Schmiedlstraße 3, Graz 8042, Austria
a r t i c l e i n f o a b s t r a c t
Keywords: Proximity-inducing compounds (PICs) are an emergent drug technology through which a protein of interest (POI),
Bayesian optimization often a drug target, is brought into the vicinity of a second protein which modifies the POI’s function, abundance
Active learning or localisation, giving rise to a therapeutic effect. One of the best-known examples for such compounds are het-
Machine learning
erobifunctional molecules known as proteolysis targeting chimeras (PROTACs). PROTACs reduce the abundance
Ternary complex prediction
of the target protein by establishing proximity to an E3 ligase which labels the protein for degradation via the
Targeted protein degradation
ubiquitin-proteasomal pathway. Design of PROTACs in silico requires the computational prediction of the ternary
complex consisting of POI, PROTAC molecule, and the E3 ligase.
We present a novel machine learning-based method for predicting PROTAC-mediated ternary complex structures
using Bayesian optimization. We show how a fitness score combining an estimation of protein-protein inter-
actions with PROTAC conformation energy calculations enables the sample-efficient exploration of candidate
structures. Furthermore, our method presents two novel scores for filtering and reranking which take PROTAC
stability (Autodock-Vina based PROTAC stability score) and protein interaction restraints (the TCP-AIR score)
into account. We evaluate our method using DockQ scores on a number of available ternary complex structures
(including previously unevaluated cases) and demonstrate that even with a clustering that requires members to
have a high similarity, i.e., with smaller clusters, we can assign high ranks to those clusters that contain poses close
to the experimentally determined native structure of the ternary complexes. We also demonstrate the resultant
improved yield of near-native poses 3 in these clusters.
1. Introduction proteins more shallow binding pockets (e.g., transcription factors
and scaffolding proteins).
Targeted protein degradation is an emerging therapeutic modality • Working at a substoichiometric concentration: A single PROTAC
which, instead of inhibiting the activity of a drug target, acts by induc- molecule can induce degradation of multiple POI molecules over
ing degradation of the target protein itself [1,2] . It employs so-called time.
monofunctional degraders such as molecular glues or heterobifunctional • Improved efficacy: Recovery of target protein abundance (and there-
degraders such as Proteolysis Targeting Chimeras (PROTACs) which act fore overall activity) is linked to protein synthesis in cells and not
as proximity-inducing compounds. PICs bring together the protein of just to the absence of the PROTAC.
interest (POI) and an E3 ubiquitin ligase to induce subsequent ubiquiti- • Increased number of binding sites: PROTACs are typically larger than
nation and degradation of the target protein (See Fig. 1 ) [3–6] . traditional inhibitors. This means that, albeit with a slight risk of
Targeted protein degradation using PROTACs offers several advan- side-effects due to less selective binding, binding sites that are tra-
tages over traditional occupancy-based inhibitors such as Ciulli and ditionally inaccessable to other small molecules can be utilized. The
Trainor [7] : promiscous binding of PROTAC fragments is typically compensated
for by the fact that PROTAC efficiency is very specific to the linker
• Expanding the druggable space: there is no need for tight binding to designed.
the functional site of the POI, and as a result, PROTACs can target
∗ Corresponding author.
E-mail address: a.rao@celeristx.com (A. Rao) .
1 Equal contribution.
2 Project Supervisor.
3 The near-native pose is defined as a pose that has DockQ score ≥ 0 . 23 .
https://doi.org/10.1016/j.ailsci.2023.100072
Received 21 November 2022; Received in revised form 8 March 2023; Accepted 5 April 2023
Available online 19 April 2023
2667-3185/©2023 Published by Elsevier B.V. This is an open access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/4.0/ )A. Rao, T.M. Tunjic, M. Brunsteiner et al. Artificial Intelligence in the Life Sciences 3 (2023) 100072
Fig. 1. Mode of action for targeted protein degradation: (A) A POI is shown in a proximity with an E3 ligase complex –the receptor part of E3 ligase is highlighted
in magenta –a heterobifunctional degrader such as PROTAC brings together the POI and E3 ligase, which initiate the degradation process. (B) After formation
of a ternary complex, the POI is marked with a polyubiquitin chain (blue), which subsequently leads to protein degradation through UPS. After degradation, the
ubiquitin molecules are detached and recycled by the UPS. Moreover, the PROTAC molecule is detached and can induce degradation of multiple POIs (C) Ternary
complex formed from the interaction of the POI, receptor part of the E3 ligase and heterobifunctional degrader. (For interpretation of the references to color in this
figure legend, the reader is referred to the web version of this article.)
Structurally, a PROTAC consists of a warhead that binds to the POI, Accurate and efficient ternary complex prediction is imperative for
an E3 ligand that binds into the E3 ligase, and a linker that connects improvements at many stages of the PROTAC development process.
these two parts. Current PROTACs utilize a limited number of E3 ligases. For instance, computational modeling of ternary complexes allows the
The most prominent E3 ligases are cereblon (CRBN) and Von-Hippel- screening of multiple different E3 ligases for a candidate target, maxi-
Lindau Tumor Suppressor (VHL) due to the availability of high-affinity mizing the stability of the ternary complex [26] . It can further facilitate
binders and favourable properties for both proteins. For CRBN binders, linker design by investigating the impact of the linker on the ternary
immunomodulatory drugs such as thalidomide [8] , lenalidomide [9] , complex. These steps can incorporate different warheads, finding an
and pomalidomide [10] are widely used. For VHL, binders were ini- ideal combination with available E3 ligase and binders and a linker.
tially derived from a natural degron peptide and evolved to highly po- However ternary complex prediction is in itself a challenging task,
tent small molecules [11,12] . In addition, some other E3 ligases such as as the space of possible interactions between the two proteins and the
cell inhibitors of apoptosis protein (cIAP) [13] , murine double minute PROTAC is astronomically large. The interactions include those between
2 (MDM2) [14] , and KEAP1 [15] have been harnessed for targeted pro- the warhead and the E3-binding fragment, and their respective proteins,
tein degradation. There is an ongoing effort on expanding the library of the protein-protein interaction between the E3-ligase and the target pro-
E3 ligases and finding suitable potent ligands against other E3 ligases. tein, as well as the interactions and physical constraints imposed by the
While the set of E3 ligases used for targeted protein degradation with linker. Even if we know the fragments that bind to the E3 ligase and
PROTACs has so far been limited, they have been used to target a diverse the POI, what constitutes an optimal linker is not yet fully understood
range of POIs from different protein families. There are prominent ex- [27] . The linker length and composition can have a significant impact
amples with good evidence of safety and efficacy in initial clinical trials, on cooperativity and stability of the ternary complex [22,28] , and con-
including degraders targeting the androgen receptor (AR) [16,17] , es- sequently, on the efficiency of the degradation [29] .
trogen receptor (ER) [18] , IRAK4, BCL-XL [19] , Helios (IKZF2) [20] , and A method that addresses this problem in its entirety would need to
GSPT1. Furthermore, in vivo studies for PROTAC targeting BRD4 [21] , predict the structure of the target protein, take into account it’s flexi-
BTK [22,23] , RIPK2 [24] , and SMARCA2 [25] have shown promising bility, all of the various orientations of interacting side-chains, confor-
results. These findings highlight the potential of PROTAC for the degra- mational changes that occur when binding to the PROTAC fragments,
dation of diverse protein families. as well as the interaction of the linker to both proteins. This typically
Judging the efficacy of a candidate PROTAC molecule in-silico is a means computationally expensive and infeasibly long MD simulations.
daunting task owing to a plethora of interactions that are difficult to However, one arrives at a tractable subset of this problem using a few
evaluate. For a PROTAC to be effictive, it must at-least satisfy the fol- simplifying assumptions. Due to the abundance of data on binary in-
lowing requirements. Firstly, it must be able to penetrate the cell mem- teractions of proteins and ligands, it is often the case that we can find
brane and stay stable inside the cell. Secondly, its interactions with the structures of the proteins co-crystallized with either the exact binder in
E3 ligase and the POI must result in the formation of a stable ternary the PROTAC, or a binder that structurally resembles it. An additional
complex where the POI is held near the E3 ligase. Finally, this complex simplifying assumption is that proteins undergo only minor conforma-
must be one that lends itself to being tagged by ubiquitin so that the POI tional changes to their backbone structure as a result of the interac-
may be degraded. tions in the ternary complex. Prior works have, working with these as-
In light of the above steps, it is clear that accurate and efficient pre- sumptions, achieved success in estimating the structure of the ternary
diction of the structure of the ternary complex is imperative for improve- complex formed, and it is with these assumptions that we propose our
ments at many stages of the PROTAC development process. For instance, method in this work.
computational modeling of ternary complexes allows the screening of In one of the first attempts for computationally predicting ternary
multiple different E3 ligases for a candidate target, maximizing the sta- complexes, Drummond et al. [30] proposed four different methods for
bility of the ternary complex [26] . Knowing the structure of the ternary the ensemble of PROTAC-mediated ternary complexes. With the most
complex is the first step to calculating its stability, and experimental ev- promising method of combining docking of the two protein-ligand struc-
idence shows that the formation of a stable ternary complex can lead to tures with separate PROTAC conformer generation, they showed that it
more efficient degradation [26] . is possible to recover near-native (DockQ ≥ 0.23, see Section 2.7 ) ternary
2A. Rao, T.M. Tunjic, M. Brunsteiner et al. Artificial Intelligence in the Life Sciences 3 (2023) 100072
complexes for a few available PDBs. In follow-up work [31] , Drummond ( “PPI fitness ”) and a fitness modeling the possibility of connecting the
et al. added two additional methods which improved the previous per- binding pockets with the PROTAC ( “PROTAC fitness ”). We then perform
formance. This work introduces clustering of the generated structures, a local optimization around the most promising candidates using a score
an essential step in obtaining good results. Zaidman et al. [32] pro- which takes into account the stability of the PROTAC between the two
posed another method, PRosettaC, which adds consecutive steps such proteins ( “PROTAC stability score ”, calculated by our own extension to
as global protein-protein docking and local docking refinement, gener- Autodock-Vina). Afterwards, we cluster the resulting candidates before
ating conformation of PROTACs that can fit in the docking solutions performing filtering using an extension to the ambiguous interaction re-
and final clustering. Although they have been able to reproduce a good straint (AIR) energy [38] , and re-ranking the final selections using the
amount of crystal structures of ternary complexes, they are initiating PROTAC stability score. In a nutshell, BOTCP consists of the following
their prediction from bound structures, which does not reflect real-world steps/stages:
conditions. Bound structures come from the decomposition of already
available ternary complexes, but a priori we do not have access to this
1. Input initialization ( Section 2.1 )
information. In one of the recent works, Weng et al. [33] proposed a
2. Rigid pose sampling via Bayesian optimization ( Section 2.2 )
method again based on global protein-protein docking, local refinement
3. Local optimization with simulated annealing of the PROTAC stability
with RosettaDock [34] , generating PROTACs using RDkit, and applying
score ( Section 2.3 )
filtering and re-ranking criteria for predicting near-native ternary com-
4. Clustering, filtering using TCP-AIR energy, and re-ranking
plexes. They started from unbound structures and showed that good re-
( Section 2.4 )
sults could be achieved with these methods. Furthermore, Li et al. [35] ,
5. Structural refinement ( Section 2.5 )
and Liao et al. [36] offer different approaches to rank ternary complexes
where they use longer MD simulations. Their approaches result in good 2.1. Initialization
outcomes but are unsuitable for a real-world scenario, where we might
try a large number of PROTACs, since they require a lot of computing At the time of writing, the protein database (PDB [39] ) contained
resources and extended simulation time. eighteen experimentally (X-ray) determined ternary complex structures,
The first contribution of our current work is the demonstration of the which include a PROTAC molecule, a protein of interest, and an E3 lig-
successful use of a Bayesian optimization (BO) [37] framework to per- ase. In comparison to the previous papers, we excluded (6BN8, 6BN9,
form a sample-efficient exploration of the space of ternary complex can- and 6BNB) since the coordinates of PROTAC atoms have not been re-
didates. BO is an established method that allows optimizing functions solved and added three additional ternary complex structures (7JTO,
that are costly to evaluate by proposing promising evaluation candidates 7Q2J, and 7JTP). In addition, we excluded (7PI4) since the POI is a ki-
(here: candidate ternary complex structures). This leads to sample effi- nase with a large flexible loop close to the protein-protein interface and
ciency, i.e., fewer candidates need to be evaluated (e.g., by a docking the PROTAC molecule, which has not been resolved in the experimen-
software) compared to (e.g., Monte Carlo-) search methods, and allows tal structure. The remaining 14 structures are listed in Table 1 . Each
the use of potentially complex fitness functions which are needed to structure was downloaded from the PDB in its native format and pre-
characterize the multiple interactions within a ternary complex. Using processed as follows. All (non-PROTAC) hetero atoms were removed,
this approach, we can efficiently sample poses that are viable candidates and the chains corresponding to the POI and the E3 ligase as well as
for the structure of the ternary complex, with the viability scored by a the PROTAC molecule were saved in a single PDB file for comparison
weighted sum of protein-protein interaction (PPI) score and a PROTAC with predictions. In several cases, the asymmetric unit contained two
score. The PPI score quantifies the interactions between the proteins in or more ternary complexes, which were saved individually. The protein
a particular candidate. In contrast, the PROTAC score considers the fea- structures used as input for modeling were taken from other PDB en-
sibility of embedding a conformation of the PROTAC molecule, given tries (unbound structures) so as to emulate the practical use case where
the position of the binding pockets in this configuration of proteins. the experimental structure of the ternary complex is not available. The
The second contribution of our work lies in designing of two novel structures used here include three different E3 ligases and seven POIs.
scores specialized for filtering, and ranking. The first score is used for For each of these ten proteins, a PDB entry was selected according to
filtering favourable complexes by imposing constraints on the distances the following criteria :
of the protein surfaces from one another – a version of the ambigu-
1. The protein has a bound ligand that is similar to the warhead or
ous interaction restraints energy (here abbreviated as “TCP-AIR En-
binder of the corresponding PROTAC molecule.
ergy ”) [38] that has been modified specifically for ternary complexes
2. The structure comes with few and/or short gaps/unresolved loops
(see Fig. 5 ). The second score is the PROTAC stability score, which is
and the resolution ( R -factor) is good.
calculated using a modified version of Autodock-Vina. Given a particu-
lar configuration of proteins, it packs the PROTAC between the proteins
For one structure (7KHH), no PDB entry fulfilling the first criterion was
and indicates its stability and energetic favourability in this position.
available. Here we estimated the structure of the bound warhead by
This score is useful for ranking.
docking the warhead into the binding pocket, using the GNINA docking
We show in our current work (See Table 2 ) that, with efficient sam-
tool [40] with default parameters. The quality of the resulting complex
pling with the BO loop, combined with filtering, clustering, and ranking
structure was ascertained by visual inspection and comparison to the
using the above scores, we are able to effectively find highly ranked
corresponding portion of the ternary complex structure. The resulting
clusters with near-native poses. Specifically, our clustering is more con-
warhead and binder molecules (only non-hydrogen atoms) were saved
fined compared to previous works, and each cluster contains only a small
in SDF format for usage as inputs to the BO method. Each of the ten
number of conformers. Our ability to rank these effectively gives us clus-
individual single structures of E3 ligase or POI were then preprocessed
ters with a high yield of near-native scores.
using the following steps:
2. Methods 1. All heteroatoms (including water and small molecules) were re-
moved while keeping ions (in four cases, the structure contained
In this paper, we propose the Bayesian Optimization for Ternary a Zinc ion complexed by four cysteine or histidine residues).
Complex Prediction (BOTCP) method. At its core lies a Bayesian opti- 2. For those structures that had gaps, we downloaded the correspond-
mization (BO) loop capable of finding appropriate ensembles of ternary ing AlphaFold structures [41,42] , aligned the experimental and the
complexes by optimizing a combined fitness function which includes AlphaFold structures using Chimera [43] , and used the coordinates
a fitness describing the strength of the interaction of the two proteins of the AlphaFold structures to fill the gaps.
3A. Rao, T.M. Tunjic, M. Brunsteiner et al. Artificial Intelligence in the Life Sciences 3 (2023) 100072
Table 1
Details of the protein structures used in this work. Columns show the PDB ID for each ternary complex as well as the chain identifiers (complex), the gene
name, the PDB ID of the structure used as input for prediction (template), the chain IDs of E3 ligase and POI, the first and last residue number included into
the used models (N-term, C-term). For the PROTAC, the colums show the residue ID, the nature of any ionizable group, and the net charge used in molecular
models.
Complex E3 ligase POI PROTAC
PDB ID Name Template Chain N-term C-term Name Template Chain N-term C-term Residue Ionizable Net charge
5T35_1 VHL 4W9H-I D 62 204 BRD4-2 5UEU-A A 349 457 759 no 0
5T35_2 VHL 4W9H-I H 62 204 BRD4-2 5UEU-A E 349 457 759 no 0
6BN7 CRBN 4TZ4-C B 48 426 BRD4-1 3MXF-A C 44 168 RN3 imine 0
6BOY CRBN 4TZ4-C B 48 426 BRD4-1 3MXF-A C 44 168 RN6 imine 0
6HAX_1 VHL 4W9H-I B 62 204 SMARCA2 6HAZ-A A 1378 1490 FWZ piperazine 1
6HAX_2 VHL 4W9H-I F 62 204 SMARCA2 6HAZ-A E 1378 1490 FWZ piperazine 1
6HAY_1 VHL 4W9H-I B 62 204 SMARCA2 6HAZ-A A 1378 1490 FX8 piperazine 1
6HAY_2 VHL 4W9H-I F 62 204 SMARCA2 6HAZ-A E 1378 1490 FX8 piperazine 1
6HR2_1 VHL 4W9H-I B 62 204 SMARCA4 6ZS2-A A 1449 1569 FWZ piperazine 1
6HR2_2 VHL 4W9H-I F 62 204 SMARCA4 6ZS2-A E 1449 1569 FWZ piperazine 1
6SIS_1 VHL 4W9H-I D 62 204 BRD4-2 5UEU-A A 349 457 LFE sec amine 1
6SIS_2 VHL 4W9H-I H 62 204 BRD4-2 5UEU-A E 349 457 LFE sec amine 1
6W7O_1 BIRC2 6W74-A C 266 349 BTK 5P9J-A A 396 656 TL7 sec amine 1
6W7O_2 BIRC2 6W74-A D 266 349 BTK 5P9J-A B 396 656 TL7 sec amine 1
6W8I_1 BIRC2 6W74-A D 266 349 BTK 5P9J-A A 396 656 TKY sec amine 1
6W8I_2 BIRC2 6W74-A E 266 349 BTK 5P9J-A B 396 656 TKY sec amine 1
6W8I_3 BIRC2 6W74-A F 266 349 BTK 5P9J-A C 396 656 TKY sec amine 1
6ZHC VHL 4W9H-I A 62 204 BCL2L1 4QVX-A D 2 197 QL8 carboxylic acid -1
7JTO VHL 4W9H-I L 62 204 WDR5 4QL1-A B 32 333 VKA 2 piperazines 2
7JTP VHL 4W9H-I L 62 204 WDR5 4QL1-A A 32 333 X6M piperazine 1
7KHH VHL 4W9H-I C 62 204 BRD4-1 3MXF-A D 44 168 WEP no 0
7Q2J VHL 4W9H-I C 62 204 WDR5 4QL1-A D 32 333 8KH piperazine 1
Table 2
Results of the BOTCP method for ternary complex prediction on unbound structures before the structural refinement (using greedy clustering 2.4 ). 1 The best rank
containing at least one model with DockQ ≥ 0.23. 2 The total number of clusters. 3 The percentage of the near-native poses in that specific ranked cluster. For each
ternary complex, we selected a cluster which includes an RRT with a high DockQ score. Columns also show the PDB ID and characterization of the best RRT in
terms of 𝑓
nat
, 𝐼
RMSD
, 𝐿
RMSD
and DockQ score (see text).
PDB ID Rank of cluster 1 Number of clusters 2 % Near-native 3 𝑓 nat 𝐼 RMSD 𝐿 RMSD DockQ
6HAY_1 2 914 100 0.61 1.07 3.19 0.72
6HAY_2 5 946 100 0.61 1.77 3.03 0.64
7JTO 15 403 50 0.5 3.05 14.82 0.31
6BN7 15 917 6.7 0.14 3.33 10.28 0.24
7Q2J 7 322 79.1 1.0 2.32 5.86 0.66
6W7O_1 11 269 9.4 0.17 3.77 7.31 0.29
6W7O_2 4 271 29.2 0.35 2.92 7.99 0.36
5T35_1 76 765 94.1 0.73 2.09 4.92 0.61
5T35_2 51 763 88.9 0.67 1.81 8.36 0.53
6W8I_1 13 362 96.6 1.0 2.248 4.41 0.7
6W8I_2 79 364 25 0.52 2.61 11.35 0.38
6W8I_3 6 365 84.6 0.81 1.85 3.7 0.68
6HAX_1 8 816 100 0.57 2.61 5.34 0.51
6HAX_2 14 795 100 0.83 1.39 8.95 0.62
7KHH None None None None None None None
6BOY 19 720 80 0.61 2.27 10.04 0.44
6SIS_1 1 339 100 0.53 1.72 5.62 0.55
6SIS_2 8 365 100 0.65 2.14 4.56 0.59
6ZHC 142 670 75 0.82 3 19.15 0.4
7JTP 8 170 88.1 0.68 2.52 5.54 0.55
6HR2_1 26 727 41.7 0.44 2.27 12.95 0.35
6HR2_2 54 679 25 0.14 3.51 8.93 0.26
3. We cropped flexible N- and C-terminal tails (usually with poor con- had to make a decision here. The most obvious choice was the proto-
fidence levels in AlphaFold predictions) as specified in 1 . nation as expected in solution at physiological pH. As the pKa value of
4. Missing atoms were replaced using the PDBfixer tool [44] . ionizable groups can change with the environment, e.g., when trans-
5. We used Reduce [45] to protonate/add hydrogens, and, where ap- ferring from solution to a binding site, this protonation solution is
propriate, flip asparagine, glutamine, or histidine side chains. not necessarily optimal. However, accounting for this would require
the determination of pKa values on-the-fly, which is not straightfor-
The PROTAC molecules were extracted from the original PDB file ward. In a few cases, the presence of piperazines required a choice
and converted to SDF format using Open Babel [46] . If required, bond to protonate one of the two nitrogens. This choice was made based
orders and protonation were corrected manually. Here we assumed that on chemical intuition and the corresponding expected pKA variations.
all weak bases (secondary and tertiary amines) and acids (carboxylic All SDF files are provided in the SI. The protein PDB and PROTAC
acid) are (de)protonated to form anions or cations. Since all models SDF files resulting from this procedure were used as input for the
and force fields we use work with fixed protonation states only, we BO loop.
4A. Rao, T.M. Tunjic, M. Brunsteiner et al. Artificial Intelligence in the Life Sciences 3 (2023) 100072
Fig. 2. Example of the required inputs for the ternary complex 6HAX (PDB ID). (A) PROTAC molecule. (B) and (D) E3 ligase docked to warhead. (C) and (E) POI
docked to the warhead.
Our method uses three inputs: the POI with the docked warhead, the RRT 𝐱 ∈ℝ 7 , we define a fitness function 𝑦 ( 𝑥 ) that is a weighted combi-
E3 ligase with the docked E3 binder, and the PROTAC SMILES (see Fig. 2 nation of two fitness components:
f Io
t
r
i
sa mn oex rea m sup il te a) b, lw
e
h toic ah
c
a cr ee
s
sp tr ho ev i cd oe -d
c
rt yo
s
tt ah le sB tra uy ce ts ui ra en oo fp Pti Om Ii z +at i won
ar
l ho eo ap d. 𝑦 ( 𝐱) = 𝑦
PPI
( 𝐱) + 𝜆⋅𝑦
PROTAC
( 𝐱) , (1)
and E3 ligase + binder, but if this information is not available, it is where 𝜆determines the relative weighting of the PPI fitness 𝑦 PPI vs. the
required first to dock the corresponding ligands into their proteins and PROTAC fitness 𝑦 PROTAC (we used 𝜆= 1 ). The PPI fitness represents the
use these structures after molecular docking for the next step in out strength of interaction between the two proteins. While strong PPIs are
BOTCP pipeline. important for a stable ternary complex, there are cases in which the
We apply our method to the structures of proteins and docked ligands proteins are oriented such that the respective binding pockets for the
extracted from the co-crystal structure of known PROTAC ternary com- E3-binder and the warhead are too far apart for the length of the linker.
plexes (so-called bound protein data) and the much more challenging On the other hand, the proteins’ relative positions might result in binder
case of unbound data, where the co-crystal structure of known PROTAC and warhead being too close, leading to steric clashes within the linker
ternary complexes is not available. itself. The PROTAC fitness 𝑦 PROTAC ( 𝐱) ensures these cases have a low
overall fitness values.
2.2. Rigid pose sampling via Bayesian optimization PPI fitness A number of protein-protein docking scoring schemes have
been proposed in the literature. In this work, we use the distance-scale
In order to determine the structure of the ternary complex, we first finite ideal-gas reference (DFIRE) energy score [47] as 𝑦 PPI . This score
recognize that the two proteins can interact in a variety of poses. The is a relatively unbiased estimate of the validity of the protein-protein
first step in our pipeline is to sample a set of such poses that are viable interaction while allowing rapid evaluation. The PPI fitness serves to
candidates for the ternary complex. To do so we consider the input POI filter out infeasible protein-protein orientations by assigning a low score
and E3 ligase as rigid structures. In this case, each pose is characterised to RRTs that result in steric clashes or the proteins being too far apart.
by the relative position and orientation of the POI with respect to the However, manual inspection of the native ternary complex structures
E3 Ligase. We then search through the space of poses, and sample poses show that the poses corresponding to the crystal structure do not cor-
that are viable structures for the ternary complex. respond to high surface contact between the proteins. This means that
optimizing the DFIRE score is likely to bias us away from sampling near-
2.2.1. Representation of poses native poses. Hence we choose to cutoffthe value of DFIRE score at 6
In order to encode a pose, we consider a baseline pose where both as below
the POI and E3 Ligase are shifted so that their center of masses line up
at the origin. Keeping the position of the E3-ligase fixed, each pose then
𝑦
PPI
= min (6 . 0 , DFIRE( 𝐱)) (2)
corresponds to a translation and rotation of the POI. This is denoted by PROTAC fitness
a 7-D vector 𝐱 ∈ℝ 7 that represents the relative rotation and translation Our input consists of the POI+docked warhead and the E3 lig-
(RRT) of the POI with respect to its position in the baseline pose, where ase + docked binder. Since each RRT corresponds to a translation and
𝐱
1…3
is the relative translation, and 𝐱
4…7
is a quaternion representing a rotation of the POI, this means that the docked coordinates of the war-
relative rotation. Due to the fact that a protein-protein configuration can head is also transformed accordingly. The PROTAC fitness 𝑦 PROTAC ( 𝐱)
be represented as such, for the remainder of this paper, we will refer to a aims to quantify the feasibility of finding a valid linker conformer given
specific protein-protein configuration using the term RRT. Our objective the docked coordinates of the binder and warhead corresponding to a
above then becomes, to sample a set of RRT’s that are viable candidates particular RRT 𝐱. We generate conformations by minimizing the energy
for the structure of the ternary complex. of the UFF molecular forcefield [48] (using RDKit [49] ). However, we
additionally constrain the atoms of the binder and warhead at their re-
2.2.2. Fitness of a pose (RRT) spective docked coordinates. We then sample linker conformations by
Here we make clear what we mean by a particular RRT being a ‘vi- minimizing the UFF energy [48] starting from a random (unconstrained)
able candidate’ for the structure of the ternary complex. For a particular initial conformer generated using distance geometry. The choice of the
5A. Rao, T.M. Tunjic, M. Brunsteiner et al. Artificial Intelligence in the Life Sciences 3 (2023) 100072
simple UFF forcefield is because it allows us to constrain atoms to atoms Algorithm 1 Evaluation of fitness.
to specific positions by using a quadratic potential that penalizes devia- function EvaluateFitness ( 𝑋)
tion from these target positions. This quadratic potential proves useful for 𝐱 𝑖 in 𝑋 do
when approximating the PROTAC score (see following section) maximize 𝑦 ( 𝐱) from initial point 𝐱 𝑖 using black box optimiza-
After generating 4 candidate conformers, we choose the output to be tion ⊳
the conformer with the lowest UFF energy. The choice of 4 conformers
Equation~1
i rs
e
lb iae bca lyu s re
e
pit
o
ris
t
t th he
e
s mm inal il mes ut
m
n u em neb re gr
y
o cf oc no sn tf ro ar inm ee dr s
c
ow ne
f
ofi rn md
e
i rs
.
n Te he ed Ped
R
Oto
-
𝑦 opt ,𝑖 ← final 𝑦 ( 𝐱) after 𝑘 steps of ascent
end for
T enA eC
r
gfi yt n oe
f
s ts
h
i is
s
d ce ofi nn foe rd
m
a es
r
.t he negative square-root of the minimized UFF return ( 𝑦 opt, 1 , 𝑦 opt, 2 , …𝑦 opt, |𝑋 |) ⊳ concatenate
end function
Note that when calculating the PROTAC score above, we do not con-
sider the interactions of the PROTAC with the proteins, thus, it cannot
be used to filter out cases with steric clashes between the linker and the
proteins. These cases are taken into account by the PROTAC stability
score (see Section 2.3 ).
Approximating PROTAC fitness with a neural-network
The PROTAC fitness for a particular RRT is a function of the energy
obtained after minimization of the UFF force-field energy. This mini-
mization is computationally expensive, and the result of the minimiza-
tion is not an analytic function of the RRT, which means that it is ex-
pensive to optimize the RRT with respect to this score. As a solution, we
have found that we can train a neural network model that can effectively
approximate the PROTAC fitness for a specific RRT.
For a particular POI, E3 ligase, and PROTAC, we train a neural net-
work model which maps the 7D RRT vector 𝐱 to the PROTAC fitness
values generated using RDKit (as described above). The model consists
of two components: a simple model which learns to predict asymptotic
component of the energy, which is asymptotically linear w.r.t the dis-
tance between the binding pockets of the PROTAC fragments for the
particular RRT, and a 3-hidden layer neural network which learns to
predict the residual component, capturing the more complex aspects of
the score such as self-collisions that may arise due to the RRTs bringing
the binding pockets too close.
Prior to the BO loop, we pre-train this model using a dataset of RDKit-
generated conformers for different RRT, and use this model to calculate
an approximation to the PROTAC fitness for the 𝐱values proposed by
the Bayesian optimization loop. The advantage is that, after being pre-
trained, computing the fitness for a new RRT using the model requires
just one forward pass, making the fitness computation very fast. We find
that even though we require additional computation to train the model, Fig. 3. Overview of Bayesian optimization pipeline. We are sampling from the
roto-translational space of POI. Then we assign a score for each sample 𝐷 =
the resultant speed gain makes up for it when optimizing the PROTAC
score in the BO loop. {( 𝐱 𝑖 , 𝑦 𝑖 )} . Then, the dataset 𝐷 is used for updating the GP into posterior GP.
For sampling the next batch of points, the acquisition function is used. In our
Local fitness ascent
proposed method, we used the UCB acquisition function to determine the next
As is often seen in biological systems, small changes in position can
sampling points. This iterative process continues until the end of some Bayesian
drastically affect fitness values for example, as a result of steric clashes. optimization steps. The number of iterations is a hyperparameter that controls
This makes the fitness landscape highly irregular with regions of low when do we get the list of final valid complexes.
fitness directly adjacent to regions of the highest fitnesses. In order to
effectively learn this fitness landscape via the Bayesian optimization, we
modify the fitness function as follows. For a particular RRT 𝐱, we per- very sample efficient, which is useful in the current context owing to
form a local ascent in the space of RRTs using a black box optimization the computational complexity of the fitness function we are optimizing.
algorithm (Nelder-mead simplex ascent [50] for 15 steps), and take the The way we achieve this is through the use of a surrogate model 𝑓( 𝐱) .
final optimized fitness 𝑦 opt ( 𝐱) to be the fitness corresponding to 𝐱. This Assuming that we have a set of 𝑀RRTs 𝐱 𝑖 ∶∶ 𝑖 ∈{ 1 …𝑀 }, for which we
optimization means that even RRTs with steric clashes will be mapped to have calculated the corresponding fitness values 𝑦 𝑖 , the surrogate model
nearby RRTs that have high fitnesses, making the landscape a lot more is trained so that 𝑓( 𝐱 𝑖 ) approximates the true value of the function 𝑦 𝑖 .
regular. Additionally, the maxima of 𝑦 opt ( 𝐱) correspond to the maxima However the speciality of a surrogate model is its ability to extend its
of 𝑦 ( 𝐱) meaning that we can maximize one instead of the other. This knowledge of the known RRTs 𝐱 𝑖 , 𝑦 𝑖 onto unknown RRTs. More specifi-
approach is described in Algorithm 1 . cally, we can evaluate 𝑓( 𝐱) on a previously unseen RRT, for which the
model returns it’s prediction, and more importantly, its uncertainty in
2.2.3. Bayesian optimization its prediction. 𝑓( 𝐱) is typically chosen to be computationally cheap to
When sampling viable RRTs, We wish to select each RRT 𝐱 by op- calculate as well as analytical, so that it can be optimized using gradient
timizing the black box function 𝑦 ( 𝐱) described above. However, while information.
we can evaluate 𝑦 ( 𝐱) at any RRT 𝐱, the evaluations are costly, and the This allows us to use the following loop to sample RRTs with high
function has no analytical form, i.e. we do not have any information fitnesses (see Fig. 3 and Algorithm 2 ). We start with a random set of
about the gradient, thus becoming a problem of gradient-free or black- initial RRTs, evaluate the fitnesses for these RRTs, and train the surro-
box optimization. In this work, we choose to approach this problem via gate model. Using the surrogate model, we use an acquisition strategy
the technique of Bayesian Optimization [51,52] as it is known to be to sample a new set of RRTs with a high predicted fitness (exploitation)
6A. Rao, T.M. Tunjic, M. Brunsteiner et al. Artificial Intelligence in the Life Sciences 3 (2023) 100072
Fig. 4. Illustration of the Matern kernel, used as covariance kernel for the Gaussian process. (A) RMSD between different POI positions relative to the E3 ligase (i.e.,
different RRTs 𝐱). (B) Matern kernel (see Eq. (4) ) as a function of the RMSD.
Algorithm 2 The BO loop. mates a high fitness value. At the same time, we should avoid sampling
𝑋
𝐲
tr
tr aa inin
←← c𝑁
or
in ri et
sr pa on nd do im ngl y
fi
s ta nm esp
s
l ve ad
l
uR eR sT s p
t to
io
o
i npn rt fes
ud
nw
i
cch
tt
ie otr
h
ne
a
t 𝛼th (te
𝐱h
)s
e
,u ar
fi
nr to dng
e
ea
s
vt se
a
w
lm
ui
ao
ll
td ebe tel
h
a
l
el
o
r fiwe ta
.
n
d
F
ey
o
s
sp
r
mo os nas le vlys as
,
l
e uws
e
ee
s
n 𝐱do
e
wu fig hnh
ie
c
i hn
a
f
n
mo r aam
xcq
ia muti
i
io
s
zin
e-
repeat
F
𝑋
𝐲
𝑋
ni
n
tt
e
r
e
w
as
w
iu
n
←
r
←
←r o
E
Ag Cva
c
oat
q
ne
l
u
cum
ai ar
to eted nePe aFol
ti
et( inG
(n
𝑋tP
es
t)
s
r
(
as

i
(
n
𝑋
,
)u
𝑋
n
es nwi en
)
wg
)
𝑋
train
, 𝑦
train
𝛼
p
d
nl(
e
ao
𝐱
n
rr)
ic
.
oa et
.T
i
b
Ioh
ton
e
iu
r sae
n
n
d
da
d
e
r
fi
(ee
U
nx
√Cd
ep
di Blff
o
)
ae
i t
sar
a
e
ct
qn
io
ut
n
ia
s
c
[
it3q iou
7
n]is
.
i fWt uio nen
c
f
t
o
is outr nna dt [e 3tg 7hi ,ae 5ts
5
ta
]h
l
e
il so
p
w
eo
ffi pn eug
cl
tat iro
v e
ub
p
ia npl a
e
on
r
u
c
c
re
o
sne cfix e--
-
𝐲 train ← Concatenate( 𝐲 train , 𝐲 new ) 𝛼( 𝐱; 𝛽) = 𝜇( 𝐱) + 𝛽𝜎( 𝐱) , (5)
until stopping condition is met
where 𝜇( 𝐱) and 𝜎( 𝐱) are the predicted mean and standard deviation of
𝑓( 𝐱) (which can be calculated from the existing data points using the
mean function and covariance kernel). The parameter 𝛽> 0 defines the
and/or high uncertainty (exploration). We then evaluate the fitnesses
balance of exploration versus exploitation (a large 𝛽leads to large 𝛼at
for these points and retrain the surrogate model and repeat the proce-
points where the standard deviation is high, thus increasing the explo-
dure. The details of the surrogate model and acquisition strategy are
ration, while a small 𝛽 leads to large 𝛼at points with a high predicted
described below.
mean, thus increasing exploitation).
Surrogate model
Our full acquisition strategy is described in Algorithms 3 and 4 . In
While in principle Bayesian optimization can utilize different sur-
rogate models, we employed the widely used Gaussian process (GP)
[53,54] . A GP is a model that places a prior on the space of functions Algorithm 3 Acquiring new points for evaluation.
that can be used to describe the data, by specifying a prior on the mean function AcquirePoints (  )
of the function value 𝑚 ( 𝐱) and via a covariance kernel 𝑘 ( 𝐱 , 𝐱 ′) which de- 𝑋 rand ← 𝑁 rand randomly sampled RRTs
scribes the covariance between the function values at any two points 𝐱 𝑋 optimized , 𝛼 optimized ← LocalOptimizeUCBAcq (  , 𝑋 rand , 𝛽∶=
and 𝐱 ′, i.e., 10 . 0 )
𝑓( 𝐱) ∼ 𝑃
(
𝑚 ( 𝐱) , 𝑘 ( 𝐱, 𝐱 ′)
)
. (3) 𝛼
𝑋
exploit
← filter 𝑁
exploit
values from 𝑋
optimized
with the highest
optimized
W kee
rn
u es le
,
wa eco un ss et a tn ht
e
l ae a wrn ee lld
-k
v na ol wue
n
𝑚
M
( 𝐱 a)
t
e≡ rn𝑚
k
0
ea rs
n
p elr i [o 5r
4
m
]
e (sa en e. A Fis
g
c
.
o 4v )a
,
r ii .a en .,c e 𝑋
𝑋
p exe prt lu or rb
e
e ←d ←
L
ora cn ad lo Om
pt
p imer it zu er Uba Ct Bio An cs
q
o (f

𝑋
,
e x 𝑋pl po eit
r turbed
, 𝛽∶= 100 . 0 )
𝑘 ( 𝐱 , 𝐱 ′) = 2
Γ
1 (−
𝜈
𝜈
)
(√ 2 𝜈𝑑 ) 𝜈 𝐾 𝜈(√ 2 𝜈𝑑 ) (4) end𝑋 r e
f
n ute u nw r
c
n←
t
i𝑋
o
C
n
𝑛o 𝑒 𝑤n catenate( 𝑋 exploit , 𝑋 explore )
where 𝑑is the distance between 𝐱and 𝐱 ′, 𝜈is a smoothness parameter
(taking on values 1 , 3 , or 5 , with larger values increasing smoothness),
2 2 2
and
I
n𝐾 𝜈 ouis
r
a
o
m pto imdi ifi zae td
i
oB ne ,s s Wel
e
f u un sec ti 𝜈o =n.
5 , and as distance 𝑑, we use the Algorithm 4 Acquisition optimization algorithms.
2 function LocalOptimizeUCBAcq (  , 𝑋, 𝛽)
RMSD between the atomic coordinates of the atoms of the POI scaled by
a learned parameter Θ. We make use of the fact that the RMSD between for 𝐱 𝑖 in 𝑋 do
two rigid transformations of the POI can be efficiently calculated by pre- maximize 𝛼( 𝐱; 𝛽) from initial point 𝐱 𝑖 using gradient ascent ⊳
Equation~5
calculating the moment-of-inertia tensor for the POI, thus not requiring
us to transform all the coordinates for each RRT. This makes this kernel
𝐱 𝑖∗ ← final 𝐱 after 𝑘 steps of ascent
very computationally efficient to compute. end for( ) ( )
return 𝐱 ∗ , 𝐱 ∗ , …𝐱 ∗ , 𝛼( 𝐱 ∗ ) , 𝛼( 𝐱 ∗ ) , …𝛼( 𝐱 ∗ ) ⊳ concatenate
Acquisition strategy 1 2 |𝑋 | 1 2 |𝑋 |
end function
Bayesian optimization requires a strategy by which we select new
candidate RRTs for which we evaluate the fitness. Intuitively, we want to
perform exploration by sampling points for which the surrogate model each iteration of the BO loop, we sample two batches of new points, one
has no information about their potential value, while also performing for exploitation and for exploration, by optimizing the above acquisition
exploitation by sampling points for which the surrogate model esti- function, with low and high 𝛽 values respectively. This optimization is
7A. Rao, T.M. Tunjic, M. Brunsteiner et al. Artificial Intelligence in the Life Sciences 3 (2023) 100072
performed using gradient ascent (using ADAM [56] ). We use the open- 3. For the conformation that it ends up in, we calculate the energy
source BoTorch package [57] to solve this optimization problem and according to the vina score (called the Vina energy 𝐸 𝑉 ), as well as
implement the BO loop. the restoring energy 𝐸 𝑅 using the original value of 𝑘 𝑅
2.3. Local optimization with simulated annealing of the PROTAC stability To understand the PROTAC stability score, We describe the heuris-
score tic interpretations of the Vina energy and the restoring energy. First,
the Vina energy 𝐸 𝑖𝑉 ( 𝑖 indexes a particular PROTAC conformer from
From the above points, we filter out RRTs with infeasible PROTAC among the 10 sampled), which is the combination of the intermolecular
scores or PPI scores, i.e. we select only complexes that have PPI scores and internal energy of the conformer. Second, the restoring energy, 𝐸 𝑖𝑅
that are at-least 6.0 (the clipped value), and PROTAC scores that corre- which measures the deviation of the E3 binder and warhead from their
spond to a UFF energy lesser than 1.5 times the minimum UFF energy. constrained positions in the particular RRT (as in Eq. (6) ).
We next locally optimized the remaining RRTs using a combination of To generate a score corresponding to the stability of the PROTAC in
the PPI score and a PROTAC stability score. We performed the optimiza- a particular protein-protein RRT, we look at the following cases:
tion
T
w heit sh
e
t th he
r
es si hm ou ldla st e ad
b
oa vn en e wal ei rn eg .
c hosen heuristically to optimize the
1. 𝐸 𝑖𝑉 is low and 𝐸 𝑖𝑅 is low: the conformation is favourable (has low
vina energy) and the warhead and E3 ligase are stable in their re-
number of near-native structures that pass the filter for the compounds
spective binding pockets
6 quH eA nX tl_ y1 ,
b
a6 sH eA
d
X o_ n2 ,
t
h6 eH fiA nY a_ l1 r,
a
6 nH kiA nY
g
_ i2 n. oT rh de es re
t
ow ae vr oe idn o ot
v
o erp fiti tm tiniz ge .d
A
s nu yb ps ae-
-
2. 𝐸 𝑖𝑉 is low and 𝐸 𝑖𝑅 is high: the conformation is favourable (has low
vina energy), but the warhead and E3 ligase need to be displaced to
rameter that is mentioned in the following sections is set based on the
achieve this conformation.
d coa mta
p
g oe un ne dr sa .t ed when running the BOTCP protocol for the above four 3. 𝐸 𝑖𝑉 is high: the conformation has a high vina energy and is un-
favourable.
Simulated annealing We used a sum of the PROTAC stability score,
described underneath, and the PPI score to perform local optimization We thus define the following weighted average of the Vina energy
of the remaining candidates using simulated annealing [58] . For any as the PROTAC stability score:
R
i
e
s
wn
tvR
o
a
a
c
seT
l
tha
u,
e
c
aa
s
h
csti
t
oem
i
s
mctu
t ahe
pl lea
p
l
u
yt
w
te
w
aad
e
tce
ii
c
a
og
ern
nha
pn
tn
otee
d
nada
o
n
l isi
m
ndn
u
f
rg
l
m
ey
e
a
j
p seosr
ica
f
bo
tm
ltc
i
ehe
tp
e
e
Rbl
d
e
RaP
s
sR
T
a
ev
sOn
d
,i a
T
toR
hA
na
R
eC
tT
s
rh
e
s
aan
tq ntaeu
.
db
a
Ne oirn
l
mo
ic
tt
ty
le
h
e
y
,e
a
o
t
g
n
hf
c
e
d
au
n1
tr
e0
P
r
i
r
nPe
as
n
It
to
e
et
s
r
p
dc
dRs
o
e
s,
R
r
r
a
ew
T
mts
o.h
p
a
nWe
ln
er ode
e
st
𝑦
stability
= log
⎛
⎜
⎜
⎜ ⎝
∑
𝑛
𝑖
∑
= 1
𝑛
𝑖𝑒
=
1−
𝜂
𝐸
𝑒𝑉
𝑖𝑉
− 𝜂
𝐸𝑒
𝑅 𝑖𝑅
−
𝜂
𝐸
𝑅
𝑖𝑅 ⎞
⎟
⎟
⎟ ⎠
(7)
above are pre-optimized to have a reasonable PPI and PROTAC score. where 𝜂𝑉 and 𝜂𝑅 are scaling parameters set to 2 and 50 respectively.
As this process allows the PROTAC conformation to change (both These values were again picked heuristically to bring the vina energy
explicitly through simulated annealing and implicitly within Autodock- and constraint energy within the same range. This score takes an average
Vina), it represents a structural refinement / packing of the PROTAC that assigns a higher weightage to conformations that are stable (i.e.
conformer. higher 𝐸 𝑖𝑅 ), while not penalizing the score too heavily in the presence
PROTAC stability score of outliers.
We calculated a PROTAC stability score using an extension of
AutoDock-Vina [59] . This score takes into account the stability of the 2.4. Clustering and filtering using TCP-AIR energy
PROTAC within the context of the protein configuration corresponding
to a particular RRT (which is ignored in the calculation of the PROTAC After generating this refined set of candidate RRTs, we perform a
fitness, see above). clustering step. These clusters are first filtered using the TCP-AIR energy,
In order to do this, we extended Autodock-Vina by implementing an then, we re-rank them to obtain the final output set of RRTs.
additional restoring energy, that allows one to constrain the position Clustering
of a subset of atoms of the ligand (which is being docked) to specific We cluster the set of candidates using the PROTAC stability score.
coordinates. Consider for example, a particular ligand where a subset Clusters are greedily created by selecting the RRT with the highest score,
of atoms 𝑆 𝑐 are constrained to specific coordinates. Now let’s denote choosing that as the center of the new cluster, and assigning all sampled
for a particular conformation of the ligand, the coordinates of atom 𝑗 RRTs with an RMSD (vs. the center of the cluster) of below 5 Åto this
by 𝑟 𝑗 ∈ℝ 3 , and its constrained position by 𝑟 0 ,𝑗 ∈ℝ 3 , then the restoring cluster. This step was repeated (starting again with the RRT with the
energy 𝐸 𝑅 is given by highest fitness which was not yet part of any cluster) until all points
𝐸 𝑅 = 𝑘 𝑅
𝑗∑
∈𝑆 𝑐
‖ ‖ ‖𝑟 𝑗 − 𝑟 0 ,𝑗 ‖ ‖ ‖2 (6) w sine gre le a ess leig mn ee nd t t ao r eso am lse o c cl ou nst se idr. e I rt e i ds . to be noted here that clusters with a
Filtering using TCP-AIR energy
This energy grows quadratically, and imposes a quadratic penalty on
We use a filtering technique based on the ambiguous interaction re-
the deviation of an atoms position from it’s constrained position. The
straints (AIRs) energy [60] that has been used extensively in Dominguez
gradient of this restoring energy is termed the restoring force. We used
et al. [38] for energy calculation. The intuition behind using the TCP-
this force to constrain the E3 binder and the warhead to have the coordi-
AIR as a filtering step is that we restrict the distance between two pro-
nates of the respective binding pockets given the current protein-protein
teins concerning each other’s interaction residues (active and passive).
RRT. To calculate the PROTAC stability score for a particular RRT, we
It allows us to specify a distance measure between the two proteins that
start from 10 randomly generated initial PROTAC conformations, and
considers the distance between the surfaces of the proteins rather than
for each of them perform the following:
just the distance between binding pockets. In order to calculate the TCP-
1. We optimize the PROTAC molecule’s conformation under only the AIR energy terms, active and passive residues need to be defined for both
restoring force and the intra-molecular part of the Vina force field, proteins. Active and passive residues are chosen based on two criteria:
creating a viable conformer with the binding fragments held at their first, they have some atoms on the protein’s surface, and second, they
positions. lie within some distance of the atoms of the fragments binding to this
2. We then turned offthe restoring force (i.e. set 𝑘 𝑅 = 0 ) and perform particular protein. We used distances of 5 Åand 7.5 Åfor active and pas-
an optimization using the full (intra- and inter-molecular) Vina force sive distances, respectively. For instance, the residues in the POI within
field. 5 Åof the warhead were defined as active residues for POI.
8A. Rao, T.M. Tunjic, M. Brunsteiner et al. Artificial Intelligence in the Life Sciences 3 (2023) 100072
Fig. 5. Usefulness of TCP-AIR energy and the PROTAC stability score for filtering. A) Correlation between the TCP-AIR energy and the DockQ score for different
example ternary complexes. As high DockQ scores are only achieved when the TCP-AIR energy is 0 or close to 0, the later can be used as a filtering criterion. B)
Same as A, but for the PROTAC stability score. C) Correlation between the PROTAC stability score and the TCP-AIR energy for 6BN7 (𝑟 = −0 . 01 , 𝜌= 0 . 09 ), 6HAX_2
( 𝑟 = −0 . 07 , 𝜌= −0 . 08 ) and 6HAY_2 ( 𝑟 = −0 . 05 , 𝜌= −0 . 07 ), with 𝑟 being the pearson correlation coefficient and 𝜌the spearman’s rank correlation coefficient. The low
correlation indicates that the two scores capture independent aspects of the near-native pose, thus justifying the use of both scores.
For these residues, we calculate the effective distances (as done in TAC conformers generated by AutoDock-Vina (see Section 2.3 ) as input
previous work [38] ). These are used to calculate the TCP-AIR energy to the structural refinement (i.e., the structural refinement is performed
(using the NOE energy formula, [60] ) using three threshold values 𝐿 , for 1000 structures).
𝑈, and 𝑆. 𝐿 and 𝑈 are the lower and upper bounds on the effective dis-
tance, while 𝑆 is the value from where the computation of the energy
2.5. Structural refinement
changes from quadratic to linear. These parameters need to be specified
for each ternary complex separately since each structure has different
Starting with a given number of ternary complex structures from
distances between two active sites of the proteins (due to the space oc-
re-ranked and clustered TCP output, we performed further structural
cupied by the PROTAC molecule). To set the values, we calculated the
refinement using classical force field-based molecular simulation with
average distances of each active residue of one protein with the active
an implicit solvent model. Force field parameters for each molecule
and passive residues of the other protein, resulting in two distances for
were taken from the Amber ffSB14 force field [61] for proteins, and
each candidate. We considered all of our samples with PROTAC stabil-
ity score > 5 . For each of them, we took an average of the two proteins’ GAFF2 [62] for PROTAC molecules. Partial charges for the PROTAC
distances and defined 𝐿 as the 25th quantile. We then defined 𝑈= 𝐿 + molecules were determined as AM1BCC charges [63] using antecham-
3 Åand 𝑆= 𝑈 + 2 Å. When filtering, we preserved all clusters with at ber/Ambertools version 21 [64] . MD simulations were performed using
OpenMM [65] with a Langevin type integrator and a time step of two
least one candidate with TCP-AIR energy larger than the 90th quantile
femtoseconds. The implicit solvent model used was the second GBneck
of all AIR energies (see Fig. 5 ).
model (GBN2 [66] ). Each structure was first optimized through energy
All of the parameters defined above were defined and optimized us-
minimization for 100 steps to remove close contacts, followed by a sim-
ing four ternary structures 6HAX_1, 6HAX_2, 6HAY_1, and 6HAY_2. The
ulated annealing run, with the temperature varying from 300 to 0 K in
active and passive distances were decided by inspecting the structures of
a linear fashion, for a total simulation time of 200 ps. This procedure
these ternary complex, which showed it to be a reasonable assumption
was repeated four times to approximate the average total free energy of
that the native complex will contain a sizeable fraction of interacting
solvation and standard deviations for each input structure. The result-
residues within 5 Angstroms from the binding site, and almost certainly
ing energies are essentially a simplified version of MM-GB/SA energies,
7.5 A from it. The parameters L, U, S, were manually tuned to maximize
where a calculation of entropic contributions is omitted. Including en-
the number of near-native complexes filtered for these 4 cases.
tropy terms would require much longer simulation times, and, given the
Ranking of clusters
approximate nature of current approaches for entropy estimation [67] ,
After filtering the clusters, we rank the remaining clusters using the
we consider the benefit of including this contribution limited. The el-
PROTAC stability score (see above, Section 2.3 ). Clusters are ranked
evation of temperature above 300 K may lead to the partial unfolding
according to the largest PROTAC stability score of their members. We
of proteins, which can not be compensated for due to the limited dura-
then calculate the rank of the near-native clusters ( Table 2 ). For the
tion of the MD simulation (200 ps). As a consequence, it is important to
structural refinement, we generate a diverse set of complexes by select-
acknowledge that short MD runs serve primarily as a means for relax-
ing the structure with the highest PROTAC stability score out of each
ing the protein structure, removing any clashes, and exploring the local
of the 100 top-ranked clusters. For each of these, we use the 10 PRO-
9A. Rao, T.M. Tunjic, M. Brunsteiner et al. Artificial Intelligence in the Life Sciences 3 (2023) 100072
conformational space to identify a near-local minimum and not for ex- −40 to −15 over the set of PROTACs in the database. The root mean
haustive sampling. We assume that the previous steps, namely Bayesian square deviation for the same set of PROTACS ranges from 1.2 to 2.4,
optimization sampling and local optimization of the PROTAC stability with a mean RMS deviation of 1.18. The small error of prediction com-
score, enable us to attain larger-scale sampling. pared to the magnitude of the score value suggests that the learned
model is a sufficiently accurate approximation of the computationally
2.6. Re-clustering and re-ranking expensive PROTAC score.
The refined structures (1000 of them) were clustered by the fraction 3.2. Evaluation of fitness functions
of common contact (FCC) clustering method [68] . Afterwards, the clus-
ters were ranked based on size (the cluster with the highest number of To check whether our proposed fitness functions are a meaningful
elements being the first-ranked). The clustering threshold was set to 0.5 objective for the BO loop, we analyzed the change of the fitness val-
and minimum number of elements in a cluster was set to 2. The rest of ues around the experimentally determined ternary complexes. Using
non-clustered structures were not taken into consideration. bound structures, we created random near-native RRTs by altering the
position of the POI using small, random translations and rotations (see
2.7. Evaluation metric Section 2.8 for details). We then compared the values of the PPI and
PROTAC fitnesses of these random RRTs to the fitness of the actual na-
For evaluating the quality of the candidates generated by the BO loop tive complex ( Fig. 6 ). The results show that these fitnesses are higher at
( Table 2 ), we used the DockQ score [69] , which is based on the metrics the native RRT compared to other RRTs in its vicinity, thus indicating
underlying the well-known critical assessment of predicted interactions the their usefulness as objective for the BO loop.
(CAPRI) score [70] : 𝑓
nat
, 𝐼
RMSD
, and 𝐿
RMSD
. The DockQ score for a par-
ticular candidate provides a quantitative measure of how closely the 3.3. Evaluation of the BO loop
interaction of proteins in this candidate structure resembles that of pro-
teins in a reference native structure. It is a function of the following We futhermore evaluated the BO method to test whether it performs
metrics adequate exploration and exploitation. Ideally, the distribution of can-
𝑓 nat is the fraction of protein’s native contacts that a candidate re- didates acquired by the BO loop is clustered in regions where the fitness
covers. 𝐼 RMSD is calculated over all backbone atoms for those residues 𝑦 ( 𝐱) is high. We compared the samples generated by the BO loop to a set
found in the interface of the reference structure (residues within a radius of randomly sampled candidates, and found that this is indeed the case
of 5 Å). 𝐿 RMSD is calculated based on the backbone atoms of the target ( Fig. 7 ). We recap here that each orientation is sampled as a 7-D vector
protein. Both RMSD values are calculated between the candidate and containing a 3-D translation (in Angstroms) and a 4-D rotation quater-
native model (after aligning the receptor structures, i.e., the E3 ligase). nion. Fig. 7 A shows us that the samples drawn by the BO Loop are con-
The DockQ score combines these measures into a single scalar value centrated in a specific region where the PPI interactions and PROTAC
between 0 and 1 (which is the score of the reference structure), with score are high. Fig. 7 C shows us that while random sampling occasion-
higher values corresponding to ternary complexes which resemble the ally finds RRTs with high fitness values, most samples are sub-optimal
original structure more closely. The distribution of the DockQ scores has leading to a lower mean fitness of 2.8. In comparison, the concentrated
been defined as follows [69] : sampling by the BO loop results in a more consistently high fitnesses
with mean 17.3 and a higher maximum value. Additionally, the spread
• 0 < DockQ < 0.23 - Incorrect complex
of points observed in both Fig. 7 A and B show that we do not converge
• 0.23 ≤ DockQ < 0.49 - Acceptable quality complex
prematurely to the optimum but also sufficiently explore the space of
• 0.49 ≤ DockQ < 0.80 - Medium quality complex
possible RRTs.
• 0.80 ≤ DockQ < = 1.0 - High quality complex
All candidate poses that achieve a DockQ > 0 . 23 compared to the 3.4. Prediction of near-native poses
native crystal structure are termed as near-native poses
We run our pipeline on 14 ternary complexes, some of which have
2.8. Fitness landscape analysis more than one TC structure in the asymmetric unit of the experimental
crystal structure leading to a total of 22 cases. By running our pipeline
Using 5 exemplary ternary complexes from PDB (bound structures), and comparing our results to these 22 native ternary complex structures,
we extracted the RRT corresponding to the native pose and modified we have found that the BO loop can effectively sample the near-native
them to investigate the resulting change of the fitness 𝑦 ( 𝐱) . For each poses. In addition, the filtering and ranking procedures can assign them
ternary complex, we generated 4000 random near-native samples by a relevant rank. For 21 out of 22 cases, we could sample at least ac-
first randomly shifting the POI before rotating them. The shift directions ceptable quality complexes. For 15 out of 22 ( Table 2 ), we were able to
were drawn from a von Mises–Fisher distribution with the mean set to rank them within the top 20 clusters, and for 12 out of 22 complexes, we
the offset of the POI (i.e., pointing away from the E3 ligase) and the were able to recover a medium quality ternary structure. Additionally,
directional parameter 𝜅= 1 (i.e., shifts moderately concentrated in this 15 out of 22 clusters have at least 50% of the near-native poses in the
direction). The shift distances were drawn from an exponential distribu- reported cluster (see Table 2 ).
tion with 𝜆= 1 Å. The rotations were generated by drawing a random This method proves that even with using a relatively simple PPI in-
rotation direction from a uniform distribution (no directions favored) teraction and unbound structures, taking into account the constraints
and a rotation angle drawn from a von Mises distribution with mean 0 imposed by the linker, with the incorporation of the PROTAC score in
and 𝜅= 10 (i.e., small rotations favored). the BO loop, as well as the TCP-AIR energy for filtering and PROTAC sta-
bility score for ranking, we can recover near-native predictions of the
3. Results ternary complex structures. Some of the apparent issues with certain
cases are discussed below.
3.1. Neural-network based approximation of PROTAC score In the 7KHH structure, the binding mode of the binder to the E3 lig-
ase differs from the binding mode found in the input structure of the
The PROTAC score is the negative square root of the energy achieved receptor, derived by docking from 4W9H (See Supplement Fig. S1). The
after minimizing the UFF force-field. The value of this PROTAC score PROTAC score, which is calculated by constraining the PROTAC frag-
achieves for an un-strained conformation of the PROTAC ranges from ments to the positions in the input, thus returns very poor scores for the
10A. Rao, T.M. Tunjic, M. Brunsteiner et al. Artificial Intelligence in the Life Sciences 3 (2023) 100072
Fig. 6. Native complexes have high fitness values. The columns show (for five sample ternary complexes) histograms of PPI fitness (left) and PROTAC fitness (right)
for random near-native RRTs, created by randomly shifting and rotating the POI (see text for details). Each plot contains the histogram of 4096 such RRTs, with the
percentile of the fitness of the native RRT displayed above the black line. The actual native complex (black line) achieves a comparitively high fitness in most cases.
In a few cases where the constraint-fitness has a lower percentile, we find that this is compensated for by the higher percentile of the PPI score.
Fig. 7. Bayesian optimization results in higher fitness values than random search. Shown here are samples from the acquisition function at iteration 15 of the BO
loop for the 6HAX complex, compared to random samples picked with proteins close to each other. (A) The Translation coordinates of the RRTs (in Å) from random
sampling (pink) and proposed by Bayesian optimization (blue). The latter leads to a candidate concentration in a promising region. The spread of points also suggests
that the BO loop sufficiently explores the space without converging prematurely to any specific minima. Points sampled via both random sampling and BO are subject
to a local optimization (B) The Rotation quaternions from the RRTs, mapped uniformly onto a 3-D unit cube from random sampling and Bayesian optimization. This
mapping is described in the Supplement Section S1. The diversity of rotation quaternions shows the extent of exploration. (C) Resulting fitness histograms. While
random samples find some conformations with high fitness, the best fitness acquired by the Bayesian optimization is higher, and the mean fitness is substantially
better, confirming that our samples efficiently search through the space of higher fitness values. (For interpretation of the references to color in this figure legend,
the reader is referred to the web version of this article.)
near-native RRTs. Thus in Table 2 , we see no near-native poses were the input warhead gets in the way of the PROTAC for all RRTs that are
sampled for 7KHH. This issue however is partially addressed by struc- near-native (See Figure S2 in Supplement).
tural refinement which is free to refine the PROTAC position ( Table 4 ). After the use of structural refinement, we can see clear improve-
For the case of 6W8I, the variance in performance can be attributed ments. In 6 cases, we were able to rank near-native cluster as first. For
to the fact that it consists of two sets of very different poses. 6W8I_1 and 21/22 cases, we obtained complexes with the DockQ ≥ 0.23. For 16 out
6W8I_2 are qualitatively similar (RMSD of 7 Å) compared to 6W8I_3 of 22 ( Table 4 ), we were able to rank them within the top 15 clusters. For
(RMSD of 33 Å w.r.t 6W8I_1). The reason for the lower performance 10 out of 22 cases, we could recover at least a medium-quality ternary
in 6W8I_2 is due to the fact that the orientation of the LYS residue in structure. Additionally, in 17/22 cases, in the reported highly-ranked
11A. Rao, T.M. Tunjic, M. Brunsteiner et al. Artificial Intelligence in the Life Sciences 3 (2023) 100072
Table 3
Results and the comparison between BOTCP and Weng et al. (FRODOCK-Based Protocol) methods for ternary complex prediction on unbound structures before
the structural refinement. The models quality is marked with ∗ ( ∗ ∗ : high, ∗ : medium and no ∗ : acceptable). 1 The best rank containing at least one model with
DockQ ≥ 0.23. 2 The total number of clusters. 3 The percentage of the near-native poses in that specific ranked cluster (available only for BOTCP). 4 The best possible
dockq score with rigid docking (we align an unbound target to a native complex and calculate the DockQ score). For each ternary complex, we selected a cluster
which includes an RRT with a high DockQ score. None indicates there were no near-native complexes found and an empty field that a method was not run for that
complex. The columns also show the PDB ID and characterization of the best RRT in terms of DockQ score (see text).
Weng et al. BOTCP
PDB ID Cluster rank 1 #Clusters 2 DockQ Cluster rank 1 #Clusters 2 DockQ % Near-native 3 Best DockQ 4
6HAY_1 15 24 0.46 3 ∗ 374 0.72 98.94 0.89
6HAY_2 1 ∗ 377 0.55 30.47 0.87
6HAX_1 8 16 0.44 7 ∗ 300 0.63 1.04 0.85
6HAX_2 6 /21 ∗ 283 0.39 0.14 0.85
6W7O_1 2 ∗ 15 0.68 1 /9 ∗ 102 0.48 35.79 0.84
6W7O_2 1 /4 ∗ 106 0.32 17.24 0.83
5T35_1 4 ∗ ∗ 35 0.83 5/15 ∗ 370 0.39 0.84 0.85
5T35_2 2 /27 ∗ 315 0.39 31.45 0.88
6BN7 3 25 0.26 30 606 0.31 3.33 0.8
6BN8 2 31 0.26
6BN9 3 17 0.27
6BNB 1 1 0.47
6BOY 3 30 0.39 12 ∗ 423 0.69 77.78 0.81
6SIS_1 2 ∗ 14 0.75 1 ∗ 161 0.59 17.76 0.86
6SIS_2 1 189 0.36 2.35 0.83
7KHH 5 29 0.43 3 162 0.23 0.44 0.92
7KHH_2 3 ∗ 15 0.65
6HR2_1 21 26 0.48 5 /18 ∗ 302 0.28 1.11 0.81
6HR2_2 4 /21 ∗ 327 0.27 0.60 0.84
6ZHC 2 ∗ 22 0.58 8 194 0.39 5.9 0.91
6W8I_1 None None None 5 ∗ 191 0.57 16.67 0.84
6W8I_2 None None None 93 196 0.38 4 0.79
6W8I_3 None None None 1 /16 ∗ 188 0.27 8.7 0.86
7JTO 4 199 0.31 4.49 0.76
7Q2J 8 ∗ ∗ 69 0.8 1.1 0.88
7JTP 2 /5 ∗ 49 0.39 0.43 0.84
near-native cluster, at least 50% of the poses in it are near-native poses tion of near-native poses in the cluster would be low due to the diver-
(see Table 4 ). sity of poses within the cluster. Moreover, there is a higher likelihood
that the best-scored pose in this cluster is, in fact, not a near-native
3.5. Computational performance pose.
Accordingly, a cluster ranked high in our case has lower entropy, i.e.,
Our results do not require the use of GPUs to compute the scores and, the yield of near-native structures in it is much higher. With this form
using 128 standard x64 CPU cores (16 AWS EC2 c5.4xlarge instances), of constrained clustering, we have near-native clusters ranked within
for each complex, our results including filtering and re-ranking exclud- the top-15 clusters in 15 out of 22 cases before structural refinement
ing structural refinement, typically take less than 2 h. This represents a and 16 out of 22 cases after structural refinement. These results demon-
significant improvement over conventional techniques, that attempt to strate the efficacy of the Vina and TCP-AIR energies. It should be noted
handle many interactions in a ternary complex via GPU intensive molec- that our work contains evaluation on the most of the known ternary
ular dynamics simulations which typically take days or weeks to report complexes when compared with other works. Adjusting the parameters
a near-native pose. Note that this code is a prototype with significant for our method and ensuring it works across all of the 22 and not 8 or
room to optimize the various components further still. 10 ternary structures, underscores the generalization capabilities of our
method.
3.6. Comparison to previous work
4. Conclusion and outlook
Ternary complex prediction models have frequently been evaluated
on bound structures (e.g., PRosettaC [32] ). We have demonstrated in We have demonstrated our BOTCP module for predicting unbound
this work that effective ranking of predicted structures in the more chal- rigid ternary complex structures ( Table 2 ). Our method can sample and
lenging scenario of unbound structures is possible with our method. We appropriately rank the near-native poses for most of them.
are aware of one other approach based on unbound structures has been At the heart of this, is the fact that Bayesian optimization learns to
presented by Weng et al. [33] , who have shown successful ranking of the sample regions of high scores in a few iterations. In all of our simula-
near-native clusters within the top-15 clusters ( Tables 3 and 4 ). How- tions, we sample only around 2500 points, where the BO loop converges
ever, Weng et al. used clustering with FCC using a threshold of 0.5, rougly after sampling around 700 points. This sample efficiency suggests
which is relatively low, leading to a large spread of poses within the modifying the fitness function to use more computationally expensive
resulting clusters. The same threshold was used in our case, but only but informative data (e.g., the PROTAC stability score) for the BO loop.
after refinement, resulting in much bigger near-native percentage of Such a fitness could take into account the interactions of the linker with
the ranked clusters. When we used fcc with threshold 0.5 before re- the proteins, which has the potential to significantly improve the yield
finement, we got much worse results with some near-native percent- of near-native poses.
ages being lower than 1% ( Table 3 ). Even though there may be a near- Currently, there are several avenues of improvement for both the
native pose in such a cluster, a threshold of 0.5 implies that the frac- quality of results and computational efficiency. The subsequent struc-
12A. Rao, T.M. Tunjic, M. Brunsteiner et al. Artificial Intelligence in the Life Sciences 3 (2023) 100072
Table 4
Results and the comparison between BOTCP and Weng et al. (RosettaDock-Based Refinement) methods for ternary complex prediction on unbound structures
after the structural refinement. The models quality is marked with ∗ ( ∗ ∗ : high, ∗ : medium and no ∗ : acceptable). 1 The best rank containing at least one model
with DockQ ≥ 0.23. 2 The total number of clusters. 3 The percentage of the near-native poses in that specific ranked cluster (BOTCP). For each ternary complex, we
selected a cluster which includes an RRT with a high DockQ score. None indicates there were no near-native complexes found and an empty field that a method
was not run for that complex. The columns also show the PDB ID and characterization of the best RRT in terms of DockQ score (see text).
Weng et al. BOTCP
PDB ID Cluster rank 1 #Clusters 2 DockQ Cluster rank 1 #Clusters 2 DockQ % Near-native 3
6HAY_1 7 88 0.48 1 ∗ 117 0.6 100
6HAY_2 1 ∗ 117 0.59 100
6HAX_1 2 51 0.45 1 /10 ∗ 129 0.35 100
6HAX_2 1 /10 ∗ 129 0.36 100
6W7O_1 9 ∗ 37 0.56 42 99 0.44 40
6W7O_2 42 99 0.45 40
5T35_1 3 ∗ 102 0.72 1 ∗ 89 0.54 100
5T35_2 1 ∗ 89 0.51 100
6BN7 1 ∗ 69 0.66 8 130 0.27 30
6BN8 1 ∗ 80 0.7
6BN9 1 ∗ 48 0.67
6BNB 1 ∗ 1 0.5
6BOY 4 ∗ 78 0.68 11 133 0.40 83
6SIS_1 1 ∗ 15 0.72 2 ∗ 70 0.56 94
6SIS_2 2 ∗ 70 0.56 96.5
7KHH 24 ∗ 99 0.5 28 121 0.34 66.7
7KHH_2 8 ∗ 52 0.65
6HR2_1 6 75 0.43 8 ∗ 92 0.56 100
6HR2_2 8 92 0.48 100
6ZHC 15 ∗ 75 0.58 None None None None
6W8I_1 13 35 0.31 10 ∗ 113 0.51 100
6W8I_2 None None None 86 128 0.35 100
6W8I_3 13 35 0.28 21 ∗ 113 0.51 100
7JTO 13 98 0.48 82
7Q2J 6 ∗ /34 ∗ ∗ 82 0.51 100
7JTP 7 /21 ∗ 46 0.40 15.8
tural refinement of the structures provided from the BOTCP module cur- Data availability
rently takes about 25 h but could be further optimized. For instance by
running the structural refinement for less than 1000 poses or by using All the processed input structures as well as the poses with the best
a smaller number of PROTAC conformations per structure. While the DockQ score from each of the 100 best ranked clusters are available
structural refinement is still computationally intensive, we see that the at https://storage.googleapis.com/public_botcp_data/Publication_Data_
results without structural refinement suggest that the current scores and Final.zip
sampling technique can be beneficial in assessing the interactions for a
given ternary complex. Declaration of Competing Interest
As mentioned in the introduction, the current work predicts the
ternary complex structure most effectively under a set of specific as- The authors declare the following financial interests/personal rela-
sumptions, i.e. that the proteins do not undergo significant backbone tionships which may be considered as potential competing interests:
conformational changes, and that we have information regarding the Arjun Rao, Tin Tunjic, Michael Brunsteiner, Chiara Gasbarri, and
E3-ligase binder, the warhead and the respective binding pockets. Cur- Noah Weber are currently employed by Celeris Therapeutics GmbH,
rently, the PROTAC stability score and the PPI score are affected because Graz Austria. The methodologies discussed in this paper are currently ac-
the side-chains are misaligned with the side chains as in the original tively being used by Celeris Therapeutics GmbH in order to design Prox-
crystal structure. These limitations affect us for instance in the case of imity Inducing Compounds for the purpose of Targeted Protein Degra-
7KHH and 6W8I_2, where misaligned binders and side-chains in the in- dation. Michael Müller and Hosein Fooladi were employed by Celeris
put impact performance. Therapeutics during their contribution to this work
Future work can incorporate more informative PPI and constraint
scores in the BO loop which will improve the filteration of non-native CRediT authorship contribution statement
poses. Our simulations show that the native structure consistently has
a PROTAC stability fitness that is among the highest observed for that Arjun Rao: Conceptualization, Investigation, Methodology, Soft-
complex, which promises significant improvements if this score includes ware, Validation, Writing –review & editing. Tin M. Tunjic: Concep-
side-chain flexibility (e.g., using Autodock-Vina). tualization, Investigation, Methodology, Software, Writing –review &
The current approach to validate ternary complex prediction is hin- editing, Validation. Michael Brunsteiner: Data curation, Methodology,
dered by the severe lack of availability of structures of ternary com- Investigation, Software, Writing – review & editing. Michael Müller:
plexes. A promising direction of research is thus to develop a score that Software, Validation, Visualization. Hosein Fooladi: Software. Chiara
is derived from the poses sampled by BOTCP, which can be validated Gasbarri: Data curation, Validation. Noah Weber: Conceptualization,
against more abundantly available data on the dissociation constant of Supervision, Writing –review & editing.
a ternary complex.
To summarize, we demonstrate in this work the successful applica- Supplementary material
tion of Bayesian optimization as well as the design of two specialized
scores that can effectively sample and rank highly clusters of near-native Supplementary material associated with this article can be found, in
poses for Ternary Complexes. the online version, at 10.1016/j.ailsci.2023.100072 .
13A. Rao, T.M. Tunjic, M. Brunsteiner et al. Artificial Intelligence in the Life Sciences 3 (2023) 100072
References [31] Drummond ML, Henry A, Li H, Williams CI. Improved accuracy for modeling PRO-
TAC-mediated ternary complex formation and targeted protein degradation via new
[1] Schapira M, Calabrese MF, Bullock AN, Crews CM. Targeted protein degradation: in silico methodologies. J Chem Inf Model 2020;60(10):5234–54 .
expanding the toolbox. Nat Rev Drug Discov 2019;18(12):949–63 . [32] Zaidman D, Prilusky J, London N. Prosettac: rosetta based modeling of PROTAC
[2] Bai N, Riching KM, Makaju A, Wu H, Acker TM, Ou S-C, et al. Modeling the CRL4A mediated ternary complexes. J Chem Inf Model 2020;60(10):4894–903 .
ligase complex to predict target protein ubiquitination induced by cereblon-recruit- [33] Weng G, Li D, Kang Y, Hou T. Integrative modeling of PROTAC-mediated ternary
ing PROTACs. J Biol Chem 2022;298:101653 . complexes. J Med Chem 2021;64(21):16271–81 .
[3] Schreiber SL. The rise of molecular glues. Cell 2021;184(1):3–9 . [34] Marze NA, Roy Burman SS, Sheffler W, Gray JJ. Efficient flexible backbone pro-
[4] Dong G, Ding Y, He S, Sheng C. Molecular glues for targeted protein degradation: tein–protein docking for challenging targets. Bioinformatics 2018;34(20):3461–9.
from serendipity to rational discovery. J Med Chem 2021;64(15):10606–20 . [35] Li W, Zhang J, Guo L, Wang Q. Importance of three–body problems and protein–pro-
[5] Neklesa TK, Winkler JD, Crews CM. Targeted protein degradation by PROTACs. tein interactions in proteolysis-targeting chimera modeling: insights from molecular
Pharmacol Ther 2017;174:138–44 . dynamics simulations. J Chem Inf Model 2022;25(3):523–32 .
[6] Pettersson M, Crews CM. Proteolysis targeting chimeras (PROTACs) —Past, present [36] Liao J, Nie X, Unarta IC, Ericksen SS, Tang W. In silico modeling and scoring of
and future. Drug Discov Today 2019;31:15–27 . PROTAC-mediated ternary complex poses. J Med Chem 2022;65(8):6116–32.
[7] Ciulli A, Trainor N. A Beginner’s guide to PROTACs and targeted protein degrada- [37] Brochu E., Cora V.M., De Freitas N.. A tutorial on Bayesian optimization of expensive
tion. Biochemist 2021;43(5):74–9 . cost functions, with application to active user modeling and hierarchical reinforce-
[8] Fischer ES, Böhm K, Lydeard JR, Yang H, Stadler MB, Cavadini S, Nagel J, Serluca F, ment learning. arXiv preprint arXiv:10122599 2010.
Acker V, Lingaraju GM, et al. Structure of the DDB1–CRBN E3 ubiquitin ligase in [38] Dominguez C, Boelens R, Bonvin AM. Haddock: a protein- protein docking
complex with thalidomide. Nature 2014;512(7512):49–53 . approach based on biochemical or biophysical information. J Am Chem Soc
[9] Fink EC, Ebert BL. The novel mechanism of lenalidomide activity. Blood, J Am Soc 2003;125(7):1731–7 .
Hematol 2015;126(21):2366–9 . [39] Berman HM. The protein data bank. Nucleic Acids Res 2000;28(1):235–42.
[10] Gao S, Wang S, Song Y. Novel immunomodulatory drugs and neo-substrates. doi: 10.1093/nar/28.1.235 .
Biomark Res 2020;8(1):1–8 . [40] McNutt AT, Francoeur P, Aggarwal R, Masuda T, Meli R, Ragoza M, et al. GN-
[11] Buckley DL, Van Molle I, Gareiss PC, Tae HS, Michel J, Noblin DJ, Jorgensen WL, INA 1.0: molecular docking with deep learning. J Cheminform 2021;13(1):1–20.
Ciulli A, Crews CM. Targeting the von Hippel–Lindau E3 ubiquitin ligase us- doi: 10.1186/s13321-021-00522-2 .
ing small molecules to disrupt the VHL/HIF-1 𝛼 interaction. J Am Chem Soc [41] Jumper J, Evans R, Pritzel A, Green T, Figurnov M, Ronneberger O, Tunyasuvu-
2012;134(10):4465–8 . nakool K, Bates R, Ž ídek A, Potapenko A, Bridgland A, Meyer C, Kohl SAA, Bal-
[12] Galdeano C, Gadd MS, Soares P, Scaffidi S, Van Molle I, Birced I, et al. Struc- lard AJ, Cowie A, Romera-Paredes B, Nikolov S, Jain R, Adler J, Back T, Petersen S,
ture-guided design and optimization of small molecules targeting the protein–pro- Reiman D, Clancy E, Zielinski M, Steinegger M, Pacholska M, Berghammer T, Boden-
tein interaction between the von Hippel–Lindau (VHL) E3 ubiquitin ligase and the stein S, Silver D, Vinyals O, Senior AW, Kavukcuoglu K, Kohli P, Hassabis D. Highly
hypoxia inducible factor (HIF) alpha subunit with in vitro nanomolar affinities. J accurate protein structure prediction with AlphaFold. Nature 2021;596(7873):583–
Med Chem 2014;57(20):8657–63 . 9. doi: 10.1038/s41586-021-03819-2 .
[13] Schiemer J, Horst R, Meng Y, Montgomery JI, Xu Y, Feng X, et al. Snapshots and [42] Varadi M, Anyango S, Deshpande M, Nair S, Natassia C, Yordanova G, et al.
ensembles of BTK and cIAP1 protein degrader ternary complexes. Nat Chem Biol AlphaFold protein structure database: massively expanding the structural cov-
2021;17(2):152–60 . erage of protein-sequence space with high-accuracy models. Nucleic Acids Res
[14] Hines J, Lartigue S, Dong H, Qian Y, Crews CM. MDM2-recruiting PROTAC offers 2022;50(D1):D439–44. doi: 10.1093/nar/gkab1061 .
superior, synergistic antiproliferative activity via simultaneous degradation of BRD4 [43] Pettersen EF, Goddard TD, Huang CC, Couch GS, Greenblatt DM, Meng EC, et al.
and stabilization of P53. Cancer Res 2019;79(1):251–62 . UCSF Chimera —A visualization system for exploratory research and analysis. J Com-
[15] Wei J, Meng F, Park K-S, Yim H, Velez J, Kumar P, et al. Harnessing the E3 ligase put Chem 2004;25(13):1605–12. doi: 10.1002/jcc.20084 .
KEAP1 for targeted protein degradation. J Am Chem Soc 2021;143(37):15073–83 . [44] Eastman P.. PDBFixer. 2019. https://github.com/pandegroup/pdbfixer .
[16] Petrylak D.P., Gao X., Vogelzang N.J., Garfield M.H., Taylor I., Dougan Moore M., [45] Williams CJ, Headd JJ, Moriarty NW, Prisant MG, Videau LL, Deis LN, et al. Mol-
Peck R.A., Burris H.A. III. First-in-human phase I study of ARV-110, an andro- Probity: more and better reference data for improved all-atom structure validation.
gen receptor (AR) PROTAC degrader in patients (PTS) with metastatic castrate- Protein Sci 2018;27(1):293–315. doi: 10.1002/pro.3330 .
resistant prostate cancer (MCRPC) following enzalutamide (ENZ) and/or abiraterone [46] O’Boyle NM, Banck M, James CA, Morley C, Vandermeersch T, Hutchi-
(ABI)2020. son GR. Open babel: an open chemical toolbox. J Cheminform 2011;3(1):33.
[17] Neklesa T, Snyder LB, Willard RR, Vitale N, Pizzano J, Gordon DA, et al. ARV-110: doi: 10.1186/1758-2946-3-33 .
an oral androgen receptor PROTAC degrader for prostate cancer. J Clin Oncol [47] Zhang C, Liu S, Zhu Q, Zhou Y. A knowledge-based energy function for
2019;37(7):14–16 . protein- ligand, protein- protein, and protein- dna complexes. J Med Chem
[18] Flanagan J., Qian Y., Gough S., Andreoli M., Bookbinder M., Cadelina G., Bradley 2005;48(7):2325–35 .
J., Rousseau E., Willard R., Pizzano J., et al. Abstract P5-04-18: ARV-471, an oral [48] RappéAK, Casewit CJ, Colwell K, Goddard WA III, SkiffWM. Uff, a full periodic
estrogen receptor PROTAC degrader for breast cancer. 2019. table force field for molecular mechanics and molecular dynamics simulations. J
[19] He Y, Koch R, Budamagunta V, Zhang P, Zhang X, Khan S, Thummuri D, Ortiz YT, Am Chem Soc 1992;114(25):10024–35 .
Zhang X, Lv D, et al. DT2216–a Bcl-xL-specific degrader is highly active against [49] Landrum G.. Rdkit: open-source cheminformatics software2016; https://github.
Bcl-xL-dependent T cell lymphomas. J Hematol Oncol 2020;13(1):1–13. com/rdkit/rdkit/releases/tag/Release _ 2016 _ 09 _ 4 .
[20] Hansen JD, Correa M, Nagy MA, Alexander M, Plantevin V, Grant V, et al. Discovery [50] Nelder JA, Mead R. A simplex method for function minimization. Comput J
of CRBN E3 ligase modulator CC-92480 for the treatment of relapsed and refractory 1965;7(4):308–13. doi: 10.1093/comjnl/7.4.308 .
multiple myeloma. J Med Chem 2020;63(13):6648–76 . [51] Mockus J, Tiesis V, Zilinskas A. The application of Bayesian methods for seeking the
[21] Zhou B, Hu J, Xu F, Chen Z, Bai L, Fernandez-Salas E, et al. Discovery of a smal- extremum. Towards Glob Optim 1978;2:117–29 .
l-molecule degrader of bromodomain and extra-terminal (BET) proteins with pico- [52] Agnihotri A, Batra N. Exploring Bayesian optimization. Distill 2020;5(5):e26 .
molar cellular potencies and capable of achieving tumor regression. J Med Chem [53] Rasmussen CE. Gaussian processes in machine learning. In: Summer school on ma-
2018;61(2):462–81 . chine learning. Springer; 2003. p. 63–71 .
[22] Zorba A, Nguyen C, Xu Y, Starr J, Borzilleri K, Smith J, Zhu H, Farley KA, Ding W, [54] Kanagawa M., Hennig P., Sejdinovic D., Sriperumbudur B.K.. Gaussian processes
Schiemer J, et al. Delineating the role of cooperativity in the design of potent PRO- and kernel methods: a review on connections and equivalences. arXiv preprint
TACs for BTK. Proc Natl Acad Sci 2018;115(31):E7285–92 . arXiv:180702582 2018.
[23] Dobrovolsky D, Wang ES, Morrow S, Leahy C, Faust T, Nowak RP, Donovan KA, [55] Auer P. Using confidence bounds for exploitation-exploration trade-offs. J Mach
Yang G, Li Z, Fischer ES, et al. Bruton tyrosine kinase degradation as a therapeutic Learn Res 2002;3(Nov):397–422 .
strategy for cancer. Blood, J Am Soc Hematol 2019;133(9):952–61 . [56] Kingma D.P., Ba J.. Adam: a method for stochastic optimization. arXiv preprint
[24] Mares A, Miah AH, Smith IE, Rackham M, Thawani AR, Cryan J, Haile PA, Votta BJ, arXiv:14126980 2014.
Beal AM, Capriotti C, et al. Extended pharmacodynamic responses observed upon [57] Balandat M, Karrer B, Jiang DR, Daulton S, Letham B, Wilson AG, Bakshy E. BoTorch:
PROTAC-mediated degradation of RIPK2. Commun Biol 2020;3(1):1–13. a framework for efficient Monte–Carlo Bayesian optimization. Advances in neural
[25] Kofink C, Trainor N, Mair B, Wöhrle S, Wurm M, Mischerikow N, Bader G, Rumpel K, information processing systems, vol 33; 2020 . http://arxiv.org/abs/1910.06403
Gerstberger T, Cui Y, et al. A selective and orally bioavailable VHL-recruiting PRO- [58] Kirkpatrick S, Gelatt Jr CD, Vecchi MP. Optimization by simulated annealing. Sci-
TAC achieves SMARCA2 degradation in vivo. ChemRxiv 2022. doi: 10.26434/chem- ence 1983;220(4598):671–80 .
rxiv-2022-q63s3 . [59] Eberhardt J, Santos-Martins D, Tillack AF, Forli S. Autodock vina 1.2. 0: new
[26] Hughes SJ, Ciulli A. Molecular recognition of ternary complexes: a new di- docking methods, expanded force field, and python bindings. J Chem Inf Model
mension in the structure-guided design of chemical degraders. Essays Biochem 2021;61(8):3891–8 .
2017;61(5):505–16 . [60] Nilges M. A calculation strategy for the structure determination of symmetric demers
[27] Bemis TA, La Clair JJ, Burkart MD. Unraveling the role of linker design in proteolysis by 1H NMR. Proteins 1993;17(3):297–309 .
targeting chimeras: miniperspective. J Med Chem 2021;64(12):8042–52 . [61] Maier JA, Martinez C, Kasavajhala K, Wickstrom L, Hauser KE, Simmerling C. ff14SB:
[28] Gadd MS, Testa A, Lucas X, Chan K-H, Chen W, Lamont DJ, et al. Structural basis of improving the accuracy of protein side chain and backbone parameters from ff99SB.
PROTAC cooperative recognition for selective protein degradation. Nat Chem Biol J Chem Theory Comput 2015;11(8):3696–713. doi: 10.1021/acs.jctc.5b00255 .
2017;13(5):514–21 . [62] Wang J, Wolf RM, Caldwell JW, Kollman PA, Case DA. Development and
[29] Troup RI, Fallan C, Baud MG. Current strategies for the design of PROTAC linkers: testing of a general amber force field. J Comput Chem 2004;25(9):1157–74.
a critical review. Explor Target Anti-Tumor Ther 2020;1:273–312 . doi: 10.1002/jcc.20035 .
[30] Drummond ML, Williams CI. In silico modeling of PROTAC-mediated ternary com- [63] Jakalian A, Jack DB, Bayly CI. Fast, efficient generation of high-quality atomic
plexes: validation and application. J Chem Inf Model 2019;59(4):1634–44 . charges. AM1-BCC model: II. Parameterization and validation. J Comput Chem
2002;23(16):1623–41. doi: 10.1002/jcc.10128 .
14A. Rao, T.M. Tunjic, M. Brunsteiner et al. Artificial Intelligence in the Life Sciences 3 (2023) 100072
[64] Case D., Aktulga H., Belfon K., Ben-Shalom I., Brozell S., Cerutti D.S., Cheatham T.E. [68] Rodrigues JPGLM, Trellet M, Schmitz C, Kastritis P, Karaca E, Melquiond ASJ,
III, Cisneros G., Cruzeiro V., Darden T., Duke R., Giambasu G., Gilson M., Gohlke et al. Clustering biomolecular complexes by residue contacts similarity. Proteins
H., Goetz A., Harris R., Izadi S., Izmailov S., Jin C., Ka K.. Amber. 2021. 2012;80(7):1810–17 .
[65] Eastman P, Swails J, Chodera JD, McGibbon RT, Zhao Y, Beauchamp KA, [69] Basu S, Wallner B. Dockq: a quality measure for protein-protein docking models.
et al. OpenMM 7: rapid development of high performance algorithms for PLoS One 2016;11(8):e0161879 .
molecular dynamics. PLoS Comput Biol 2017;13(7):e1005659. doi: 10.1371/jour- [70] Lensink MF, Nadzirin N, Velankar S, Wodak SJ. Modeling protein-protein, protein-
nal.pcbi.1005659 . peptide, and protein-oligosaccharide complexes: CAPRI 7th edition. Proteins
[66] Nguyen H, Roe DR, Simmerling C. Improved generalized born solvent model 2020;88(8):916–38. doi: 10.1002/prot.25870 .
parameters for protein simulations. J Chem Theory Comput 2013;9(4):2020–34.
doi: 10.1021/ct3010485 .
[67] Ekberg V, Ryde U. On the use of interaction entropy and related methods
to estimate binding entropies. J Chem Theory Comput 2021;17(8):5379–91.
doi: 10.1021/acs.jctc.1c00374 .
15