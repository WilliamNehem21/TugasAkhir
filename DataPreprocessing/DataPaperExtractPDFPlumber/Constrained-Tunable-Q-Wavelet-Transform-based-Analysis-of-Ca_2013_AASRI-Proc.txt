Available online at www.sciencedirect.com
ScienceDirect
AASRI Procedia 4 ( 2013 ) 57 – 63
2013 AASRI Conference on Intelligent Systems and Control
Constrained Tunable-Q wavelet Transform based Analysis of
Cardiac Sound Signals
Shivnarayan Patidar, Ram Bilas Pachori*
Discipline of Electrical Engineering, Indian Institute of Technology Indore, Indore, 452017, India
Abstract
In this paper, we present a new method for analysis of cardiac sound signals containing murmurs using constrained
tunable-Q wavelet transform (TQWT). The fundamental heart sounds (FHS) and murmurs are separately reconstructed by
suitably constraining TQWT. The segmentation of reconstructed murmurs into heart beat cycles is achieved using cardiac
sound characteristic wave-form (CSCW) of reconstructed FHS. The frequency domain based approximate entropy,
spectral entropy, Lempel-Ziv complexity, and time domain Shannon entropy are computed for each segmented heart beat
cycles for least squares support vector machine (LS-SVM) based classification. The experimental results are included to
show the effectiveness of the proposed method.
©© 22001133 T. hPeu Abluisthhoerds. bPyu bElilssheevdi ebry B E.lVse.v ier B.V. Open access under CC BY-NC-ND license.
SSeelleeccttiioonn a nand/do/ro pr epeer erer vrieevwie uwnd uenr dreesrp roensspiboinlistyib oilfi tAym oefr iAcamn eAripcpalnie dA Spcpileinecde SRceiseenacrceh R Inessteitaurtceh Institute
Keywords: Cardiac sound signals; heart beat cycles; murmurs; tunable-Q wavelet transform; least squares support vector machine;
1. Introduction
The cardiac sound signals contain a lot of information about the functioning of heart valves and
hemodynamics. Detection of heart valve disorders either by visual scanning of cardiac sound signal or
auscultation needs thorough skills and long term experience. The presence of murmurs is often associated with
pathology of the heart valves [1]. Thus, detection of murmurs in the cardiac sound signals is an important part
for the diagnosis of heart valve disorders.
* Corresponding author. Tel.: +91-0732-4240716;
E-mail address: pachori@iiti.ac.in
2212-6716 © 2013 The Authors. Published by Elsevier B.V.Open access under CC BY-NC-ND license.
Selection and/or peer review under responsibility of American Applied Science Research Institute
doi: 10.1016/j.aasri.2013.10.01058 Shivnarayan Patidar and Ram Bilas Pachori / AASRI Procedia 4 ( 2013 ) 57 – 63
The parameters extracted from the segmented cardiac sound signals can be very useful in diagnosis of
heart valve disorders. These parameters can belong to time domain, frequency domain or time-frequency
domain. The time domain parameters such as the time intervals of the systole and diastole and the presence of
murmurs in the systole and diastole have been used for detecting heart valve disorders [2, 3]. The clustering
based diagnosis of heart valve disorders using CSCW have been proposed in [3]. The time domain based
analysis is suitable for distinguishing the normal and abnormal cardiac sound signals but it is not helpful in
identifying the types of murmur [4]. Therefore, in order to classify murmurs, different spectral characteristics
of murmurs in cardiac sound signals have been proposed as described in [4-6]. Moreover, the traditional time-
frequency methods like short-time Fourier transform, wavelet transform and wavelet packet decomposition
have been employed for classifying the type of murmur using cardiac sound signals [7-10]. The classification
of murmurs is a multi-class classification problem. The classifiers which are used most commonly for the
cardiac sound signals are neural network [5], [7-8] and support vector machine (SVM) [4], [10-12].
In this paper, we present a new method for segmentation and classification of cardiac sound signals
containing murmurs using constrained TQWT. The TQWT is powerful technique with three input parameter
for analysis and processing of oscillatory signals [14]. The proposed method is based on constraining TQWT
with adaptive selection of its input variables. The FHS and murmurs are separately reconstructed by suitably
constraining TQWT. The reconstructed FHS is used for envelope based segmentation of reconstructed
murmurs into heart beat cycles using CSCW. The frequency domain approximate entropy, spectral entropy,
Lempel-Ziv complexity and time domain Shannon entropy are computed for each heart beat cycles of
reconstructed murmurs and have been used as an input to least squares support vector machine (LS-SVM) for
classifying the murmurs. The proposed constrained TQWT based segmentation and LS-SVM based
classification of segmented reconstructed murmurs have provided better segmentation rate and classification
rate.
2. Tunable Q-wavelet transform
TQWT is a flexible fully discrete wavelet transform that facilitate tuning of its Q-factor denoted as Q and
specifying its over-sampling rate or redundancy denoted as r along with number of levels of decomposition ( j)
[13]. The implementation of jth level TQWT based decomposition is achieved by iteratively applying two
channel filters banks to the low-pass sub-band signal. At first level, the generation of low-pass sub-band c1[n]
uses low-pass filter H ( ) followed by low-pass scaling which is denoted as LP scaling , and similarly the
o
generation of high-pass sub-band d1[n] uses H ( ) and HP scaling . The details of involved scaling operation
1
can be found in [13]. The equivalent system for jth level TQWT based decomposition of input signal s[n] to
generate the low-pass sub-band signal c j [n] and the high-pass sub-band signal d j [n] is shown in Fig.1. The
equivalent frequency response for low-pass and high-pass sub-band signals generated after jth level is given by
H (j)( ) and H (j)( ) respectively which are defined as [13]:
o 1
j1 j 2 (1)
H ( m), j H ( j1) H ( m),(1 ) j1 j1
H(j)( ) 0 H(j)( ) 1 0
0 m 0 1 m 0
0 , j 0, for other [ , ]
H 0j( )
LP Scaling
j cj[n]
H 1j( ) LP Scaling j 1 HP Scaling d j[n]
Fig. 1. (a) The equivalent system for jth level TQWT based decomposition of input signal s[n] to generate (a) the low-pass sub-band
signal c j [n] and (b) the high-pass sub-band signal d j [n] [13].Shivnarayan Patidar and Ram Bilas Pachori / AASRI Procedia 4 ( 2013 ) 57 – 63 59
The original signal can be reconstructed using the synthesis filter banks as illustrated in [13]. The
redundancy and Q-factor are related to filter bank parameters and as follows [13]:
2 (2)
r , Q
1
The parameter Q controls the oscillatory behavior of wavelet and the parameter r controls the excessive
ringing in order to localize the wavelet in time without affecting its shape.
3. Methodology
3.1. Pre-processing of cardiac sound signals
In order to reduce the time of execution of the algorithm, the input cardiac sound signal is decimated by a
factor of 32 [12]. This process may not affect the FHS containing low frequency components. Even the
diagnostic murmurs may not be affected significantly because most of the murmurs have frequency range
between 100 Hz to 600 Hz [7]. Moreover, pre-processing includes amplitude normalization which takes into
account the variations in the recordings due to changes in pressure applied on the chest surface and the
amplifier setting.
3.2. Constrained TQWT based segmentation of reconstructed murmurs
The murmurs are often spread in time duration with relatively smaller amplitude as compared to FHS. The
murmurs and FHS have nearly Gaussian and super-Gaussian distribution respectively. The distribution of
FHS has sharper peak and skewness is toward left with relatively larger value of the kurtosis as compared to
murmurs [14]. This knowledge about statistical properties of FHS and murmurs can be used to constrain the
TQWT during decomposition such that the reconstructed signal contains only the desired component of
interest. In order to separate and reconstruct the FHS and murmurs from the cardiac sound signals, the input
parameters of TQWT based decomposition can be adaptively selected such that low frequency FHS having
maximum kurtosis are obtained at the low-pass sub-band at last output stage. This low-pass sub-band based
reconstructed FHS can be used for segmentation of reconstructed murmurs into heart beat cycles using CSCW.
The timing information about the heart beat cycles can be obtained from CSCW with peak detection method
that includes the picking up of the required peaks of FHS and rejecting the extra peaks followed by
application of proper threshold either manually or automatically by fuzzy c-means clustering as suggested in
[3, 15]. A segmented heart beat cycle begins and ends with any one of the FHS of the two consecutive heart
beat cycles. Therefore, after the identification of peaks of FHS in CSCW, the approximate boundaries of
either S1 or S2 heart sound can be used to extract the heart beat cycles of reconstructed murmurs as described
in [3, 10, 15]. The murmurs are high frequency component therefore only the high-pass sub-bands of each
output stage of TQWT based decomposition are considered for reconstruction of murmurs. The heart beat
cycles of these reconstructed murmurs are used for feature extraction and classification as described in next
subsections.
During constraining the TQWT, the input parameters can be adapted by using any suitable optimization
method. Many optimization methods have been proposed in the literature but genetic algorithms are found to
be more effective in global optimization [16]. Therefore, in this study genetic algorithm has been used to
optimize the TQWT based decomposition for maximizing information of the desired signal component in the
reconstructed signal.
3.3. Feature extraction and LS-SVM based classification of reconstructed murmurs
The spectral characteristic of murmurs has been found useful for classifying cardiac sound signals
containing murmurs. Therefore, in this study, approximate entropy and Lempel-Ziv complexity are used as60 Shivnarayan Patidar and Ram Bilas Pachori / AASRI Procedia 4 ( 2013 ) 57 – 63
frequency domain parameters as computed from fast Fourier transform (FFT) based frequency spectrum of
the heart beat cycles of reconstructed murmurs. The features employed are briefly described as follows:
3.3.1 Shannon entropy: Shannon entropy is based on the notion of probability and measures the uncertainty
of a signal [17]. The normalized form of Shannon entropy which is denoted by ShEn is defined as:
p nlog(p n) (3)
ShEn n
log(m)
Where n is the range of signal amplitude, p is the probability of the signal having amplitude a . In this
n n
study, the probability de n s i t y f u n c tion of the reconstructed murmurs is estimated over the discrete values of a
n
by using histogram technique. For the signal samples, say N, the amplitude range of signal is linearly divided
into m bins such that the ratio m/N remains constant. In this study, the ratio m/N is kept at 0.01.
3.3.2 Approximate entropy: The approximate entropy (ApEn) is a non-linear statistical property which is
used to measure the complexity of the system [18]. The ApEn is defined as follows:
1 Nm1 1 Nm (4)
ApEn(m,r,N) lnSm(i) lnSm1(i), Sm(i) Nm(i) N m 1
N m 1 r N m r r
i1 i1
Where m is the embedding dimension, N is the number of samples of the sequence, Nm(i) is the number of
matching vectors within the tolerance window r. In this study, ApEn is computed with FFT based spectrum as
input sequence and m and r set as 2 and 0.1 times the standard deviation respectively.
3.3.3 Lempel-Ziv complexity: Lempel-Ziv complexity is a non-parametric measure of complexity of finite
sequences. It reflects the presence of number of distinct sub-sequences (patterns) and the rate of their
occurrence along the sequence. The Lempel-Ziv complexity analysis is based on transforming the time-series
into a finite symbol string. In this study, sequence obtained using the FFT based spectrum is transformed into
a binary sequence by assigning ones and zeros based on median as threshold. The complete algorithm to
evaluate the Lempel-Ziv complexity is described well in [19, 20].
3.3.4 Spectral entropy: Spectral entropy is based on the power spectrum of reconstructed murmurs and
describes the irregularity of the spectrum. The normalized form of Spectral entropy which is denoted by SpEn
is defined as [20]:
fH
P jlog(P j) (5)
SpEn j fL
log(N )
f
Where P is the power density of the signal in the defined frequency band [f , f ] and N is the number of
j L H f
frequencies within this band. In this work the frequency band is specified as [100, 600] Hz.
The classification of heart valve disorders can be considered as a multi-class classification problem.
Moreover, the performance of proposed features in classifying murmurs can be evaluated using a multi-class
LS-SVM [21]. The classifier is trained with data {x yk } (i=1, 2, …n and k=1, 2, …m) , where, x is the input
i i i
and ykis thekth output unit for pattern i, n is the number of training pairs and m is the number of hyperplane.
i
The detail derivation of the LS-SVM is available in [11]. In this work the radial basis function (RBF) with
width controlling parameter is used as the kernel, which is defined as:
k
x-x 2 (6)
K (x,x) exp i
k i 2 2
k
4. Experimental results and discussion
The dataset used in this paper is the heart sounds pod cast series (2011) produced by the Robert J. Hall
Heart Sounds Laboratory of Texas Heart Institute at St. Luke’s Episcopal Hospital. The dataset contains 50
abnormal cardiac sound signals acquired from variety of subjects with relevant chest positions and differentShivnarayan Patidar and Ram Bilas Pachori / AASRI Procedia 4 ( 2013 ) 57 – 63 61
patient maneuver. The sampling frequency of most of the data is 44.100 kHz except for few cases. For more
information regarding the dataset, this series is available at www.texasheartinstitute.org.
The illustration of the effectiveness of proposed method in separating FHS and murmurs for one heart beat
cycle of mitral regurgitation and aortic stenosis has been shown in Fig. 2. For mitral regurgitation, the
reconstructed signals are obtained after adaptively selecting the parameters r and j as 8 and 10 respectively
when Q = 1. The values of these parameters for aortic stenosis are r and j as 8 and 12 respectively when Q = 1.
It can be seen that the constrained TQWT is effective in separating FHS and murmurs. The experimental
results are found satisfactory when Q =1 and usually with high value of r due to better matching of wavelet
with FHS. Moreover, when murmurs are severe the required levels of the TQWT based decomposition (j)
would be more and if they overlap with FHS the required redundancy would be more so that the FHS are well
localized in time. Table 1 shows the statistics of performance of CSCW based segmentation and classification
using constrained TQWT based reconstructed FHS and reconstructed murmurs respectively.
The frequency domain based approximate entropy, spectral entropy, Lempel-Ziv complexity, and time
domain based Shannon entropy are computed for the segmented reconstructed murmurs and are used as an
input feature set to LS-SVM for classifying the murmurs. The RBF kernel in the LS-SVM classifier with =
k
1 has provided satisfactory classification rate. The used features are found to be collectively effective in
classifying the type of murmur. The actual number of heart beat cycles comprised in each clinical case of the
tabulated results is manually labelled by an experienced cardiologist.
Fig. 2.(a) The examples of constrained TQWT based separation of FHS and murmurs for a heart beat cycle: (a)-(c) mitral regurgitation
signal, high pass reconstructed signal (murmur) , and low pass reconstructed signal (FHS) respectively; (d)-(f) aortic stenosis signal, high
pass reconstructed signal (murmur) , and low pass reconstructed signal (FHS) respectively.
Table1. The segmentation and classification statistics of cardiac sound signals containing murmurs using constrained TQWT.
Type of disease Cases Segmented beats/Total beats Training beats/Testing beats Classification rate (%)
Aortic stenosis case1 21/25 13/12 99.4262 Shivnarayan Patidar and Ram Bilas Pachori / AASRI Procedia 4 ( 2013 ) 57 – 63
case2 40/46 23/23 99.31
Aortic regurgitation case1 29/31 16/15 97.35
case2 32/32 16/16 97.50
Mitral stenosis case1 15/16 8/8 100
case2 14/14 7/7 100
Mitral regurgitation case1 16/18 9/9 99.15
case2a 8/9 5/4 98.75
5. Conclusion
The TQWT is useful transform with sufficient number of adaptable input parameters for separating the
murmurs and FHS from cardiac sound signals containing murmurs. The segmentation of the reconstructed
murmurs into heart beat cycles and classification of the same have provided promising results. Finally, in
order to establish the clinical use of the proposed method, it is necessary to test it on out-of-sample dataset.
6. Acknowledgements
The authors would like to thank Dr. Niranjan Garg, Cardiologist, Bombay Hospital, Indore, India for his
valuable clinical suggestions and discussions.
References
[1] Rangayyan RM, Lehner RJ. Phonocardiogram signal analysis: a review. Crit Rev Biomed Eng 1987; 15: 211-236.
[2] Chung YJ. Classification of continuous heart sound signals using the ergodic hidden markov model. In: Pattern Recognition and
Image Analysis, LNCS 2007; Springer 4477: 563-570.
[3] Choi S, Jiang Z. Comparison of envelope extraction algorithms for cardiac sound signal segmentation. Expert Syst Appl 2008; 34 (2):
1056-1069.
[4] Choi S, Jiang Z. Cardiac sound murmurs classification with autoregressive spectral analysis and multi-support vector machine
technique. Comput Biol Med 2010; 40: 8-20.
[5] Chauhan S, Wang P, Lim CS, Anantharaman V. A Computer-aided MFCC-based HMM System for automatic auscultation. Comput
Biol Med 2008; 38: 221-233.
[6] Iwata A, Ishii N, Suzamura N, Ikegaya K. Algorithm for detecting the first and the second heart sounds by spectral tracking. Med Biol
Eng Comput 1980; 18: 19-26.
[7] Turkoglu I, Arslan A, Ilkay E. An intelligent system for diagnosis of the heart valve diseases with wavelet packet neural networks.
Comput Biol Med 2003; 33 (4): 319-331.
[8] Gupta CN, Palaniappan R, Swaminathan S, Krishnan SM. Neural network classification of homomorphic segmented heart sounds.
Appl Soft Comput 2007; 7: 286-297.
[9] Choi S. Detection of Valvular Heart Disorders using wavelet packet decomposition and support vector machine. Expert Syst Appl
2008; 35:1679-1687.
[10] Ari S, Saha G. In search of an optimization technique for artificial neural network to classify abnormal heart sounds. Appl Soft
Comput 2009; 9: 330-340.
[11] Suykens JAK, Vandewalle J. Multiclass least squares support vector machines. International Joint Conference on Neural Networks
IJCNN 1999; 2: 900-903.
[12] Patidar S, Pachori RB. A continuous wavelet transform based method for detecting heart valve disorders using phonocardiograph
signals. ICHIT 2012; 310: 513-520.
[13] Selesnick IW. Wavelet transform with tunable Q-factor, IEEE Trans Sig Process 2011; 59 : 3560-3575
[14] Sanei S, Ghodsi M, Hassani H. An adaptive singular spectrum analysis approach to murmur detection from heart sounds. J Med Eng
Phys 2011; 33(3): 362 -367.
[15] Liang H, Lukkarinen S, Hartimo IO. Heart sound segmentation algorithm based on heart sound envelogram. IEEE Comput Cardiol
1997: 105-108.
[16] Yuan J, He Z, Zi Y. Gear fault detection using customized multiwavelet lifting schemes. Mech Syst Sig Process 2010; 24 (5): 1509-
1528.
[17] Shannon CE, Weaver W. The mathematical theory of communication. University of Illinois Press; 1971Shivnarayan Patidar and Ram Bilas Pachori / AASRI Procedia 4 ( 2013 ) 57 – 63 63
[18] Pincus SM. Approximate entropy as a measure of system complexity. In: Proceedings of the National Academy of Sciences 1991; 88
(6): 2297-2301.
[19] Lempel A, Ziv J. On the complexity of finite sequences. IEEE Trans Inf Theory 1976; 22 (1):75-81.
[20] Sabeti M, Katebi S, Boostani R. Entropy and complexity measures for EEG signal classification of schizophrenic and control
participants. J Art Intell Med 2009; 47: 263-274.
[21] Bajaj V, Pachori RB. Classification of seizure and nonseizure EEG signals using empirical mode decomposition. IEEE Trans Inf
Technol Biomed 2012; 16 (6): 1135-1142.