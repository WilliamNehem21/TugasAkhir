ArtificialIntelligenceinAgriculture10(2023)46–60
ContentslistsavailableatScienceDirect
Artificial Intelligence in Agriculture
journal homepage: http://www.keaipublishing.com/en/journals/artificial-
intelligence-in-agriculture/
Cumulative unsupervised multi-domain adaptation for Holstein
cattle re-identification
FabianDubourvieuxa,b,⁎,1,GuillaumeLapougea,⁎,1,AngéliqueLoescha,BertrandLuvisona,RomaricAudigiera
aUniversitéParis-Saclay,CEAList,Palaiseau91120,France
bLITIS,INSARouen,NormandieUniversité,Saint-Etienne-du-Rouvray76801,France
a r t i c l e i n f o a b s t r a c t
Articlehistory: In dairy farming, ensuring the health of each cow and minimizing economic losses requires individual
Received26May2023 monitoring,achievedthroughcowRe-Identification(Re-ID).Computervision-basedRe-IDreliesonvisuallydis-
Receivedinrevisedform1October2023 tinguishingfeatures,suchasthedistinctivecoatpatternsofbreedslikeHolstein.
Accepted7October2023
However,annotatingeverycowineachfarmiscost-prohibitive.OurobjectiveistodevelopRe-IDmethods
Availableonline17October2023
applicabletobothlabeledandunlabeledfarms,accommodatingnewindividualsanddiverseenvironments.Un-
supervisedDomainAdaptation(UDA)techniquesbridgethisgap,transferringknowledgefromlabeledsource
Keywords:
Re-identification domainstounlabeledtargetdomains,buthaveonlybeenmainlydesignedforpedestrianandvehicleRe-ID
Domainadaptation applications.
Holsteincattle OurworkintroducesCumulativeUnsupervisedMulti-DomainAdaptation(CUMDA)toaddresschallengesoflim-
Unsupervisedlearning itedidentitydiversityanddiversefarmappearances.CUMDAaccumulatesknowledgefromalldomains,enhanc-
Monitoring ingspecializationinknowndomainsandimprovinggeneralizationtounseendomains.Ourcontributionsinclude
aCUMDAmethodadaptingtomultipleunlabeledtargetdomainswhilepreservingsourcedomainperformance,
alongwithextensivecross-datasetexperimentsonthreecattleRe-IDdatasets.Theseexperimentsdemonstrate
significantenhancementsinsourcepreservation,targetdomainspecialization,andgeneralizationtounseen
domains.
©2023TheAuthors.PublishingservicesbyElsevierB.V.onbehalfofKeAiCommunicationsCo.,Ltd.Thisisanopen
accessarticleundertheCCBY-NC-NDlicense(http://creativecommons.org/licenses/by-nc-nd/4.0/).
1.Introduction retrieveindividualsofinterestthroughcameranetworkswithnon-
overlappingfieldsofview.Theintroductionofsupervisedlearning,fa-
Traditionally,farmershaveshoulderedthevitalresponsibilityof cilitatedbydeepConvolutionalNeuralNetworks(CNNs)Krizhevsky
overseeing the health and behavior of their dairy cows. Detecting etal.(2012),hassignificantlyadvancedtheperformanceofsupervised
earlyindicatorsofheatorunusualbehaviorintheseanimalsisofpara- personRe-IDYeetal.(2021).
mountimportance,notonlytoensuretheiroverallwell-beingbutalso TheRe-IDparadigmhasexpandedbeyondpedestriantrackingtoen-
tomitigatepotentialeconomiclosses.Aswetransitionfrommanual compassabroaderarrayofreal-worldapplications,includingvehicle
monitoringtocomputervision-basedindividualtracking,therearises Re-IDfortrafficsurveillanceKhanandUllah(2019)andanimalRe-ID
theneedforpreciseidentificationofeachcowwithinafarm.Thisintri- formonitoringcattleSchneideretal.(2020);Liuetal.(2019a,2019d,
catetaskiscommonlyreferredtoascowRe-Identification(Re-ID).In 2019b).
thispaper,wefocusthecowRe-IDontheHolsteinbreed,notablefor SupervisedRe-IDdemandsthepainstakingannotationofdatasets.In
itsvisuallydistinctivespotpatterns.Besides,wematchobservationsof thespecificcontextofcowRe-ID,theimpracticalityandcostofannotat-
thesameindividualintheshortterm,i.e.overadefinedtimeframedur- ingeverycowineachfarmnecessitatethedevelopmentofaRe-ID
ingwhichitsvisualappearanceispresumedtoremainunchanged. methodcapableofgeneralizingeffectivelyacrossbothlabeledandunla-
Historically,Re-IDhasbeenafocalpointinimageinterpretation, beledfarms.Thisadaptabilityiscrucialtoaccommodatetheintroduc-
particularlyinthecontextofpedestrianvideosurveillanceZhengetal. tionofnewcowsintoestablishedfarmsandthedeploymentofthe
(2016).TheprimaryobjectiveofRe-IDinthiscontextistotrackor technologyinnovelfarmenvironments.However,Re-IDgrappleswith
anotabledeclineinperformancewhenthetestimagedistributiondi-
vergesfromthatofthetrainingdataset.
⁎ Correspondingauthorsat:UniversitéParis-Saclay,CEAList,Palaiseau91120,France.
To address these challenges, Unsupervised Domain Adaptation
E-mailaddress:guillaume.lapouge@cea.fr(G.Lapouge).
1Theseauthorscontributedequallytothiswork. (UDA)methodshavebeendevisedforRe-IDGeetal.(2019,2020);
https://doi.org/10.1016/j.aiia.2023.10.002
2589-7217/©2023TheAuthors.PublishingservicesbyElsevierB.V.onbehalfofKeAiCommunicationsCo.,Ltd.ThisisanopenaccessarticleundertheCCBY-NC-NDlicense(http://
creativecommons.org/licenses/by-nc-nd/4.0/).F.Dubourvieux,G.Lapouge,A.Loeschetal. ArtificialIntelligenceinAgriculture10(2023)46–60
Dubourvieuxetal.(2021a).UDAseekstoadaptamodeltoadomain 2.1.Cattlere-ID
of interest by leveraging an annotated dataset from another
domain(thesourcedomain)andunlabeleddatafromthedomainofin- Re-IDhasbeenmainlyfocusedonpedestrianandvehiclesYeetal.
terest(thetargetdomain).Whileextensivelyexploredforpedestrian (2021).Someworkexistsforanimalre-ID,focusingforinstanceon
andvehicleRe-ID,UDAprovesparticularlyrelevantincowRe-IDappli- Amurtigerre-IDLiuetal.(2019a);Lietal.(2019a);Liuetal.(2019d).
cations,giventheimpracticalityofannotatingeachcowinnumerous Nevertheless,Amurtigershaveacoatofspotsvisuallyverydistinct
farms. fromcows,aswellasthedeformationsofthesespotstheirmovements
However,theuniqueconstraintsandrequirementsinherentinthe specifictotheirmorphology.Thisleadsustobelievethatcowshavea
cow Re-ID application have spurred further developments, which sufficientlydistinctappearancefromAmurtigerstobeconsideredadis-
formthecorefocusofthispaper.IncowRe-ID,eachfarmrepresentsa tinctclassofinterestforre-IDLiuetal.(2019d).That'swhyhespecific-
distinctdomain,characterizedbyitsuniquesetofindividuals,cameras, ityoftheappearanceofcowshasledtospecificworksBergaminietal.
andenvironmentalcontext.Consequently,cross-domainperformance (2018);Andrewetal.(2021,2016,2017);Gaoetal.(2021),studying
degradationbecomesapertinentissue.Additionally,eachdomaintypi- itundertheframeworksofsupervisedlearningorself-supervisedlearn-
callycomprisesalimitedsubsetofanimals,restrictingthegeneraliza- ingGaoetal.(2021)assumingaccesstotracklets.However,supervised
tionpotentialofRe-IDnetworkstrainedonindividualdatasets,asin learningorself-supervisedlearningarenotsuitableforlearningcom-
conventionalUDA. biningdatafrommultiplefarms,duetotheincreasedannotationcost
In pursuit of enhancing the model's discriminatory capabilities forthesupervisedparadigmorthefailuretoaccountforinter-domain
amongcows,weproposeanovelframework:CumulativeUnsupervised heterogeneitieswithmultiplefarmdataintheself-supervisedframe-
Multi-DomainAdaptation(CUMDA).CUMDAaimstoaccumulateRe-ID work.Tothebestofourknowledge,cattlere-IDhasthereforenever
knowledge from data collected across multiple farms (diverse do- focusedonthecross-domainsettingnorthemultiple-domainone.
mains),enablingsuperiorspecializationwithinknowndomainsand
improved performance when confronted with previously unseen 2.2.Cross-domainpersonandvehiclere-IDviaUDAparadigm
domains.
To our knowledge, existing UDA Re-ID methods have primarily Cross-domainre-IDhasbeenextensivelystudiedforpeopleand
focusedonmulti-domainscenarioswithmultipleannotatedsource vehiclere-IDproblems.Itcanbedividedintotwomainfamiliesof
domains.NoUDARe-IDapproachhasbeendesignedspecificallyfor approaches.
multipleunlabeledtargetdomains.Moreover,whiletheDomainGener- Domain-translationapproacheswerethefirstonesconsideredfor
alizationframeworkWangetal.(2021)seekstocreatemodelsthatper- cross-domainpersonre-ID.Amongtheseapproaches,image-to-image
formwellonunseentargetdomains,itdiffersfromCUMDA.CUMDA translationmethodsseektotransferthesourceimagesintothetarget
assumesknowledgeofalltargetdomainsduringtrainingandaccess domainstyleWeietal.(2018a);Baketal.(2018);Dengetal.(2018);
tounlabeleddatafromthesedomains,withtheobjectiveofenhancing Zhongetal.(2018);Liuetal.(2019c);Huangetal.(2019);Chenetal.
specializationandcross-domainRe-IDperformancethroughknowledge (2019);Lietal.(2019b).Theyarebasedongenerativemodelssuchas
accumulation.Whilegeneralizationisnottheprimaryaim,weantici- theCycleGANZhuetal.(2017).Theyareconstrainedduringtraining
patethataCUMDAmodel,throughtheaccumulationofknowledge totranslateimagestonewstylewhilepreservingtheidentityclass.
from diverse target domains, can enhance its generalization to Thisallowstheidentitylabeltobereusedforsupervisedre-IDlearning
previouslyunseendomains. fromlabeledsourceimageswithanewtarget-style.Domain-invariant
Furthermore,traditionalUDAframeworksoftenprioritizemaximiz- featurelearningmethodsWangetal.(2018);Linetal.(2018);Chang
ingperformanceonthetargetdomainattheexpenseofforgettingor etal.(2019b);Lietal.(2018,2019b);Qietal.(2019)directlyconstrain
neglectingsourcedomainknowledgeDubourvieuxetal.(2021a).In thefeaturespaceofthelearnedmodel,e.g.byaligningfeaturedistribu-
practice,whennewcamerasaredeployedonafarm,theadaptationof tionsbetweendomains,withtheobjectivethatthere-IDmodellearned
theRe-IDmodeltothesenewdevicesisdesired,whilemaintaining tobediscriminativeonthesourcedomain,isalsodiscriminativeonthe
highperformanceonexistingones—acharacteristicweterm”source targetdomaininthisdomain-invariantspace.
conservation.” Becauseoflimitedcross-domainperformanceofdomain-translation
Insummary,whileexistingRe-IDmethodsmaybedirectlyapplica- approaches,researchershavebeeninterestedinpseudo-labelingap-
bletocattleRe-ID,noneofthemfullyaddressestheuniqueconstraints proaches Song et al. (2020); Zhang et al. (2019);Jin et al. (2020);
andpracticalrequirementsofcowRe-IDthatunderscorethechoiceof Tang et al. (2019); Zhai et al. (2020a); Zou et al. (2020); Fu et al.
aCUMDAframeworkoveraconventionalUDAapproach.Drivenby (2019).Theyconsistinpredictingidentitylabelsforimagesofthetarget
thesepracticalconsiderationsandtheneedforcross-domaincattle domain,byclusteringfeaturesobtainedwithaninitialfeatureencoder,
Re-ID solutions, this paper endeavors to design a cross-domain generallylearnedtoperformre-IDinasupervisedwayonthesource
modeltailoredtothedistinctivechallengesofcattleRe-IDacrossmul- domain.Pseudo-labelapproacheshaveallowedaclearimprovement
tiplefarms,anareathathasseenlimitedstudy.Ouraimistodevelop of the cross-domain re-ID performance Ge et al. (2019, 2020);
suchamethodwithintheframeworkofCUMDA,emphasizingsource Dubourvieuxetal.(2021b,2022).Toachieveevenbetterperformance,
conservation and the accumulation of knowledge from multiple techniqueshavebeendevelopedtogetbetterpseudo-labelsormake
unsupervised target domains. This paper comprises two primary theframeworkmorerobustagainstnoisylabelsChenetal.(2020);
contributions: Zhaietal.(2020b);Zhaoetal.(2020);Pengetal.(2020);Yuetal.
• A Source-Guided CUMDA method, that can improve cross- (2019); Zhong et al. (2019); Luo et al. (2020); Dubourvieux et al.
domainre-IDperformance,ononeormultipletargetdomains,while (2021a).
beingabletoaccumulateknowledgefrommultipledomainsandpre- Theapproachproposedinthispaperisalsoinlinewithpseudo-
servethesourceperformance. labelingapproaches.Contrarytoexistingwork,thisonefocusesona
• Extensive cross-dataset experiments for CUMDA re-ID on 2 newclassofobjectsforcross-domainre-ID,thecross-domaincowre-
publiccowre-IDdatasetsandaprivateone. ID,forwhichnoUDAapproachhasbeenconsidered.Moreover,unlike
existing work in pseudo-labeling for cross-domain person re-ID,
2.Relatedwork whichconsidersasingletargetdomainscenario,thisworktacklesa
morechallenging,yetpracticalandmorespecifictocattlere-IDreal-
Thisworkisattheintersectionoftworesearchareas:cattlere-ID worldrequirements,cross-domainproblem:CumulativeUnsupervised
andcross-domainre-ID. Multi-DomainAdaptation(CUMDA).Thiscross-domain framework
47F.Dubourvieux,G.Lapouge,A.Loeschetal. ArtificialIntelligenceinAgriculture10(2023)46–60
seekstoleveragetheknowledgefromoneorseveraldomainsofinterest source-guidedlossfunctiondesignedbyDubourvieuxetal.(2021a)
(e.g.:variouscattlefarms),toimprovethecross-domainre-IDperfor- forsingle-targetdomainUDAre-ID,wedefineanewSource-Guided
manceforeachdomain(eachfarm),includingonthesourcedomain lossfunctionextendedforCUMDAre-ID.Therefore,fθisfine-tunedby
re-IDabilityofthemodel. minimizing a Source-Guided CUMDA (SG-CUMDA) loss function
L whichaggregatesalltheindividualre-IDlossfunctionson
SG CUMDA
3.Methodology eachdomain,asfollows:
n
Lower part: proposed pseudo-labeling method for multi-target L SG CUMDA θ, S,T 1, ,T n L ID θ,S ∑L ID θ,T k 2
CUMDAre-ID.Blackarrowsindicatethepseudo-labelingandtraining k 1
cycle, gray arrows indicate the clustering parameters optimization
steps.Itconsidersasetofntargetdomains , , andasourcedo-
1 n 3.3.Alleviatingthedomaingapwithdomain-specificbatchnormalization
main .Foreachtarget,SOURCECALIBRATIONcomputesanassociated
labeledsourcevalidationset x 1 ,…, x n .AfterFEATUREEXTRAC- It is argued that the gap domain can degrade performance
val val
TIONofallsourcevalidationandtargetsets,SOURCE-GUIDEDAUTOHP Dubourvieuxetal.(2021a).Theproposedmethodologyproposesto
TUNINGcomputestarget-specificoptimalhyperparameter(HP)values mitigateitatthelevelofbatchnormalizationlayers.
λ∗, ,λ∗ fromcalibratedsourcevalidationsetsbymaximizingcluster- BatchNormalization(batchnorm)isawidely-usedtechniquetoac-
1 n
ingquality (Sec.3.4).Target-specificPSEUDOLABELINGBYCLUSTER- celerateandimprovethetrainingofdeepneuralnetworks,byreducing
INGisthencarriedout.TRAININGisjointlydoneonallpseudo-labeled theinternalcovariate-shiftIoffeandSzegedy(2015).Itconsistsinnor-
target sets and on the labeled source domain by minimizing malizingthebatchaftereachconvolutionalorlinearlayers,usingthe
L (Sec.3.2).
batch-wisemeanandvarianceofactivations,andlearnableaffinepa-
SG CUMDA
OurgoalistodesignaCUMDAre-IDmethodthatcanimprovere-ID rametersthatrescalethefeaturesintobatch-normalizedfeatures.
performanceonallseendomains.Morespecifically,itisexpectedthat Priorworkshighlightedthenegativeimpactontrainingstagewhen
thismethodcan: computing batchnorm statistics with data from different domains
• specializeforoneormultipletargetdomainstoimproveperfor- Zajkac et al. (2019). Domain-Specific Batch Normalization (DSBN)
manceonthem; layershavebeenproposedtobeeffectiveforvariousdomainadaptation
• ensuregoodperformanceonthesourcedomain. problemssuchasUDAclassificationChangetal.(2019a)andUDAre-ID
Wealsoexpectsuchamodeltogeneralizewellonanunseennew Dubourvieux et al. (2021a). It consists in using domain-specific
targetdomain,asitshouldaccumulateknowledgefrommultipledo-
batchnormaffineparametersandcomputingdomain-specificmean
mains. andvariance.Othernetworkparametersarestillsharedandusedwhat-
AsillustratedintheupperpartofFig.1,existingpseudo-labeling everthedomain.fθbeingimplementedbyaCNN,DSBNlayersareused
methodsaredesignedforUDAre-ID,i.e.toimprovere-IDperformance aftereachconvolutionalandfully-connectedlayers.
onasingletargetdomain,usingonlydatafromthisdomain.Therefore,
theyneedtoberethoughtinordertomeetthepreviouslymentioned 3.4.Improvingpseudo-labelswithmulti-targetautomaticsource-guided
objectivesofCUMDAre-ID,andtoincorporatetheuseofdatafrommul- selectionofPseudo-labelingHyperparameters
tipledomains.ThissectionintroduceskeyelementsofourCUMDAre-ID
method. Pseudo-labelingUDAapproachesaresensitivetothequalityof
ThelowerpartintroducesourCUMDAre-IDmethodwhosecompo- theproposedlabeling,whichdependsonthegoodtuningofcluster-
nentswillbemotivatedinthissection.
inghyperparametersλ.Inthecontextofpedestrianandvehiclere-
Generalnotations.Weconsiderasetofntargetdomainsofinterest
ID,theidealλvaluecalledλ∗hasbeenshowntodependonthetarget
, , ,n∈Nandasourcedomain ,fromwhichasetoflabeled datasetdistributioninthefeaturespace,aswellasthetargetdataset
1 n
dataSfrom ,andunlabeleddataT , ,T from , , (thetarget statistics(e.g.thenumberofshotsperidentity)Dubourvieuxetal.
1 n 1 n
domains)areavailable. (2021b).Mostoftheworksthatfocusonpedestrianandvehicle
UDAre-IDreusethesamevaluesempiricallytunedforaspecific
3.1.Pseudo-labelingbyclustering cross-datasetexperiment,onalldifferentcross-datasetsconsidered
afterward.Ithasbeenshownthatthiscanresultinsignificantlyre-
Afeatureencoderfθ,θ∈Rp,p∈N(usuallyaCNN)istrainedonthe duced performance compared to getting a suitable value
Dubourvieuxetal.(2021b).
labeledsourcedatasetT,byminimizingare-IDlossfunction(e.g.:Clas-
sificationLoss,TripletLossasinHermansetal.(2017),acombinationof Forrealworldcow-re-ID,becausethetargetisunlabeled,itisimpos-
bothasinLuoetal.(2019)…)L θ,T ,w.r.tθ.Then,aclusteringfunc-
sibletobuildalabeledvalidationsettotunethisvalue.Besides,usualλ
ID
tionCλdefinedbyhyperparameters(HP)λ∈Rm,m∈Nisusedtopre- valueusedforpersonre-IDmaynottranslatewelltocowre-IDprob-
lem,giventheparticularitiesofcowdatasets(colordistribution,view-
dict pseudo-labels of data samples in each target set, by using the
points…).Therefore,weproposetoautomatethetuningofλfrom
feature representation of their data. Pseudo-labeled target sets
thelabeleddata.Todoso,weusetheHyperParametersAutomatedby
T , ,T canthenbeobtained:
1 n Source&Similarities(HyPASS)algorithmDubourvieuxetal.(2021b).
∀k∈ 1,n, T
k
Cλ fθ,T
k
1 H any dPA vS eS hiw cla es Ud De Asig rn e-e Id D.a In td opte ts imte id zefo sr cls uin stg ele ri- nta gr hge yt ped ro pm ara ain mp ee ted re ss ft rr oia mn
the labeled data of the source validation dataset. More concretely,
Thisstep,describedbyEq.1,iscalledPseudo-LabelingbyClustering
(PLC).Thesepseudo-labelswillbeusedtodefinethelossthatsuper-
HyPASSestimatesbymodelselectiononCλ,thevalueλ∗suchasλ
visesthelearningonthetargets. arg maxλ Cλ Sval where isaclusteringqualityfunctionandSvala
labeledvalidationsetfromthesourcedata.ItisillustratedinFig.1as
3.2.Source-guidedCUMDAre-IDlearning source-guidedautoHPtuning.
HyPASS-SCforCUMDA:improvingtherobustnesstodomaingap.
TheobjectivesofCUMDAre-IDarebeingabletoimprovethecross- Inthispaper,weadaptHyPASStoourcowre-IDCUMDAproblem,by
domainperformanceforoneormultipletargetdomains,whilebeing selectingaspecificvalueλ kforeachtargetdatasetT k.ThePLCdefined
able to preserve the source re-ID performance. Inspired by the byEq.1,isredefinedasaDomain-specificPLCgivenby:
48F.Dubourvieux,G.Lapouge,A.Loeschetal. ArtificialIntelligenceinAgriculture10(2023)46–60
Fig.1.Upperpart:pseudo-labelingparadigmforsingle-targetUDAre-ID.Blackarrowsindicatethepseudo-labelingandtrainingcycle.FEATUREEXTRACTIONiscarriedoutforimages x 1
ofthetargetdomain 1withafeatureencoderfθ.PSEUDOLABELINGBYCLUSTERINGcomputespseudo-labels y 1 onclusteredfeatures.TRAININGisdoneonthepseudo-labeledtarget
set x 1,y 1 byminimizingLID.
∀k∈ 1,n,T
k
Cλ
k
fθ,T
k
3 • Atthedatasetstatisticslevel,anewSourcevalidationCalibration
(SC)approachisproposed.
HyPASSfunctioningreliesondomain-gapreduction.Inthemulti- Whilecross-datasetstatisticgapmaybeoverlookedforanacademic
targetuse-case,weproposetoachieveitintwoways: personandvehiclere-IDsuchasinDubourvieuxetal.(2021b),itbe-
• Atthefeaturelevel,target-specificDSBNisleveragedtoreduce comescrucialintheconsideredcowre-IDproblematic.Indeed,inthe
thedomain-gapinthefeaturespace(cf.section3.3); well-knownpersonre-IDdatasets,usualstatisticsdiscrepanciesare
49F.Dubourvieux,G.Lapouge,A.Loeschetal. ArtificialIntelligenceinAgriculture10(2023)46–60
minimal,withbetween21and36shotsperID(e.g.Market1501Zheng Table1
etal.(2015),DukeMTMCRistanietal.(2016),personXSunandZheng Datasetstatistics.ForCows2021Gaoetal.(2021)andHolsteinCattleBholeetal.(2019),
∗indicatesthatthedatasetisextractedfromtheRGBannotatedportionofthecomplete
(2019)andMSMT17Weietal.(2018b)).However,thatdoesnothold
dataset,followinga50/50IDsplitforTrain/Test.ThereisnooverlapbetweentrainIDs
trueinallcases.Especiallyinscarceranimal-relatedre-ID,wherethe
andtestIDs(cf.Sec.4.2.6).
datamaybedifficulttoacquire,resultinginhigherdiscrepanciesin
Dataset #train #train #test #query #gallery
shotsperID.Moreover,contrarytopersonorvehiclere-IDapplications
IDs images IDs images images
inopen-world,thenumberofcowsinafarmofinterestisgenerally
known,orcanbeeasilyestimatedforacross-domainre-IDapplications. Cows2021∗ 90 4602 91 855 3213
HolsteinCattle∗ 68 609 68 204 414
ThisallowsustodesignSCforcattlere-ID,whichconsistsinequalizing
CowFisheye 62 6334 16 151 2224
thenumberofshotsperIDofthesourcetomatchthatofthetarget.SC
generatestarget-specificsourcevalidationsetsSvalfromSval,thatreduce
k
thecross-datasetstatisticsgapwiththecorrespondingtargettraining Imageextraction.Theimageswereextractedoverninedaysofac-
setT . SC is represented asSource Calibration on Fig. 1.HyPASSis quisition.Eachofthemcontainsasinglecowinthemilkingmachine.
k
thenrunonSvaltocomputeλ∗,theoptimalhyperparametervaluefor Formoredetailsondataacquisition,pleaserefertoBholeetal.(2019).
k k IDs&samples.Inthisstudy,onlytheRGBdataisused.Atotalof
clusteringonT .ThecombineduseofHyPASSandSCwillbereferred
k 1227imagesdepicting136distinctindividualswereextracted,foran
toasHyPASS-SCintherestofthepaper.Implementationdetailsare
averageof9shotsperidentity.Moredetailsonimagerepartitioncan
giveninSec.4.2.7.
befoundinTable1.
Complexity.Thisdatasetfeaturespartiallyoccludedcattleposi-
4.Experiments
tioneddifferentlyinthemilkingmachine.
4.1.Datasets
4.1.3.CowFisheye
CowFisheyeisaprivatedatasetfeaturingRGBimagesof78individ-
Inthispaper,weemploythreedifferentdatasets:Cows2021Gao uals.Itwasacquiredfromasinglefarmfrom4fisheyecameraspointing
etal.(2021),HolsteinCattleRecognitionBholeetal.(2019)andthepri-
downwards,positioned6mabovetheground.Identitieswereannoted
vatedatasetCowFisheye.Thecontentofeachdatasetisillustratedin manually.Thisdatasetreflectstheusualchallengingdataencountered
Fig.2. intheusecasewherecowsmustbeidentified24/7wherevertheyare
inthefarm.
4.1.1.Cows2021 Imageextraction.Imageswereextractedover6daysofacquisition,
Cows2021Gaoetal.(2021)isadatasetfeaturingRGBimagesand during both day and night. Adetectorgivesimagescontaining the
videosof186individuals.Thedatawasacquiredfrom4mabovethe wholecowbodyandhead,alignedhorizontallyandfacingright.
groundbyapinholecamerapointeddownwards. IDs&samples.Manualselectionandannotationofimageswere
Imageextraction.Theimageswereextractedoveronemonthofac- donetoensureagoodvariabilityofviewpointsandlightingconditions
quisition.Theextractionofcowimagesfromthevideostreamrelieson foreachcow.Atotalof8709imagesdepicting78distinctindividuals
an oriented bounding-box detector and a tracker. The boxes are wereextractedforanaverageof112instancesperidentity.Moredetails
centeredaroundcowtorsos,excludingtheirheads,withallindividuals onimagesrepartitioncanbefoundinTable1andFig.3.
facingright.Formoredetailsondataacquisition,pleaserefertoGao Complexity.TheCowFisheyedatasetcomplexityreflectsthedesired
etal.(2021). application:re-IDfor24/7monitoringofcowsinthewholecameranet-
IDs&samples.Inthisstudy,labeledannotationsforinitialsuper- work.Moreprecisely,thelowangle-shotcameraconfigurationrequired
visedtrainingareneededforrelevantperformancecomparisonswith forcoverageofthewholefarm,mayintroducesignificantcowocclusion
unsupervisedUDA.Therefore,onlyitslabeleddataisused.Atotalof by obstacles or other individuals. Distortions inherent to fisheye
8670imagesdepicting181distinctindividualswereextracted,foran camerasarealsopresent.Besides,theacquisitionisdoneinvariedillu-
averageof48shotsperidentity.Moredetailsonimagerepartitioncan minationconditions,whichcancausesignificantdiscrepanciesinthe
befoundinTable1. appearance of a cow. At night specifically, a near-infrared mode is
Complexity.Despiteanacquisitionthatspreadsoveronemonth,the activatedresultinginblackandwhitepictures.Anillustrationofthe
illuminationandviewpointofthecowsvarylittlebetweenacquisitions. complexityoftheCowFisheyedatasetisproposedinFig.4.
Thereislittletonoocclusionintheimages.
4.2.Experimentalsettings
4.1.2.HolsteinCattleRecognition
HolsteinCattleRecognitionBholeetal.(2019)isadatasetfeaturing 4.2.1.Usecase
RGBandinfraredimagesof1237individuals.Thedatawasacquired Ourusecaseisspecifictore-IDofanimalsinmultiplefarms,with
byapinholecameraplacedatgoundlevel,5mawayfromthemilking labeled images from one farm, and oneor many unlabeled images
machineitfilms.Forconcision,werefertoitasHolsteinCattleinthe frommultiplefarms.TheobjectiveofourCUMDAre-IDmethodpre-
restofthepaper. sentedinSec.3istwofold:
Fig.2.Illustrationofthecontentofeachdataset.Fromlefttoright:Cows2021Gaoetal.(2021),HolsteinCattleRecognitionBholeetal.(2019),CowFisheye(private).
50F.Dubourvieux,G.Lapouge,A.Loeschetal. ArtificialIntelligenceinAgriculture10(2023)46–60
Fig.3.NumberofimagesperIDinCowFisheyedataset.
• conservationonthesource(labeled)domain; foreachtargetdataset,whenapplicable.Thus,theirsizedependson
• specializationonthetarget(unlabeled)domains. n ,thenumberofdomainsusedduringtraining.Here,thebatch
domain
Wealsoexpectbettergeneralizationonanewunseentargetdomain sizeisequalto16 n .Imagesareresizedto128 128pixels.
domain
whichwouldcorrespondtoanewfarminarealworldapplication. Re-IDrelateddataaugmentationssuchascropandflipareapplieddur-
Therefore,foreachtraining,performanceonallthreedatasetsis ingthetrainingstage.Randomerasingwasnotappliedbecauseitex-
reported.Throughouttheexperiments,weevaluatethedifferentcom- perimentallydecreasedthecowre-IDperformance.
ponentsofourCUMDAmethod:sourceguidance(cf.Sec.3.2),DSBN
(cf.Sec.3.3)andHyPASS-SC(cf.Sec.3.4).Pleasenotethatthiswork
4.2.4.Initialsupervisedpre-training
does not aim at optimizing the network architecture or tuning
Thenetworkistrainedduring20epochsoneachonthechosen
hyperparameters, it rather proposes an methodology for efficient
sourcedataset.Thelearningrateissettolr 3510 4.Bothtriplet
CUMDAre-IDbypseudo-labeling.
andcross-entropylossesareusedduringthetrainingonsourceimages
Geetal.(2019).
4.2.2.Framework
Inordertointroducesomerobustnesstothepseudo-labelsnoise,we
usethestate-of-the-artframeworkMutualMeanTeaching(MMT)Ge 4.2.5.Domainadaptation
et al. (2019) paired with a Resnet-18 He et al. (2016) backbone The network is trained during 15 epochsof 200 iterations. This
pretrained on ImageNet Deng et al. (2009). The last stride of the
choiceisdriventoavoidoverfittingonthesmallerdatasets.Thelearn-
Resnet-18 is set to 1 to increase the feature map resolution. The ingrateissettolr 3510 4.Bothtripletandcross-entropylosses
DBSCANclusteringalgorithmisrunonthek-reciprocalencodedfea- areusedduringthetraining.Sourceandtargetsharethesamefullycon-
tureswithk 30.DBSCANparametersn andepsaresetton nectedlayerforclassification.WhenusingMMT,testingissystemati-
min min
04andeps 06,theirusualvaluesDubourvieuxetal.(2021b).Their cally done on model number 1 as in real-world applications since
valuesremainconstant,exceptwhenepsisoptimizedbyHyPASS-SC. determiningwhichmodelperformsbestonthetargetisimpossible.In-
All other unspecified values are set similarly to the original MMT deed,thetargetdatasetisnotannotated.Concerningtheadaptationon
paperGeetal.(2019).Theworkconductedinthispaperishowever multipletargetdatasets,whenapplicable,DSBNisgeneralizedsoasto
notlimitedtoMMTandcouldbeappliedtoanyUDAframework. haveoneBatchNormalization(BN)perdomain.Duringtesting,the
BNofthedomainthatismostsimilarinappearancetothetesteddo-
4.2.3.Datapreprocessing mainisused.Morespecifically,thetestdomainBNisusedifithas
Perdomain,mini-batchesofsize16arebuiltwithP=4identities beencomputedduringtraining.Otherwise,theBNofCowFisheyeis
andK=4shotsperidentity.CUMDAbatchesmayvaryinsizeasthey used when testing on Cows2021 or HolsteinCattle, and the BN of
areconstructedfromonemini-batchforthesourcedatasetandone Cows2021isusedwhentestingonCowFisheye.
Fig.4.IllustrationofthecomplexityoftheCowFisheyedataset.Left:variedlightingconditions,Center:occlusionbyobjects/cows,Right:variedviewpoints.Allpicturesrepresentthesame
individual.
51F.Dubourvieux,G.Lapouge,A.Loeschetal. ArtificialIntelligenceinAgriculture10(2023)46–60
4.2.6.Testing experiments stand out. First, the direct transfer Cows2021
Becausemostdatasetsareextractedfromauniquecamera,theeval- HolsteinCattleshowsthepoorestperformanceonthetargetdomainat
uationisdonewithoutfilteringimagesfromthesamecamera.The 8.0%mAPvsthe81.2%whichcanbeattainedifannotationswereavail-
meanAveragePrecision(mAP)isreportedasevaluationmetric.Itis able.Second,thedirecttransferCowFisheye Cows2021showsthe
an indicator of the network ability to correctly recall the different highestperformanceofallcross-domainexperiments,with71.0%mAP
shotsinagallerycorrespondingtoaqueryindividual,andshouldbe onthetargetdataset.Theseresultsindicatethatthedomaingapbe-
maximized. tweenfarmsgreatlyinfluencesthenetworkabilitytoperformona
Forcompletenesssake,rank-1isalsoreportedinAppendixA.Itindi- new style of images and is higher between HolsteinCattle and the
catestheaccuracyoftherank-1proposalforeachqueryindividualand other datasets than between CowFisheye and Cows2021. Also, the
isrepresentativeoftheretrievalperformance.However,rank-1issensi- abundanceofinformationpresentinCowFisheyewithitsvariedview-
tivetoshortcomingsinthedatasetthatareespeciallypresentinthe pointsandoccultationshelpsbridgethegapwithotherdomainsas
studiedcattlere-idusecase(lowdiversityofimages,noiseetc.).There- shown by higher direct transfer scores when pre-training on
fore,allintextanalysiswillbemadeonmAPasitismorerobustand CowFisheye.
representativeoftheperformanceonthewholedataset. UDAbaseline.Intherestofthepaper,wewillrefertodomainadap-
No re-ranking is applied during testing. The ID splitting for tationwithoutsourceguidanceasUDA.Itsfunctioningisillustratedin
Cows2021andHolsteinCattle,isdonefollowingtheoriginalascending theupperpartofFig.1.WeremindthereaderthattheMMTframework
numbering.Thefirsthalfoftheidentitiesistakenastrainsetandthe hasbeenchosenasbaselinehereGeetal.(2019)andcouldbereplaced
otherhalfastestset. byanyotherbaselineasshownin Dubourvieuxetal.(2021b) and
Dubourvieuxetal.(2022).
4.2.7.HyPASS-SC AsshowninTable3,theperformanceonthetargetdatasetincreases
HyPASS-SCoptimizesthevalueofDBSCANhyperparameterepsin withΔ valuesintherange[+1.7p.p.,+55.5p.p.],meaningalower
mAP
the range 035,065, which is the range of acceptable values for boundforperformancevariationof+1.7percentagepoints(p.p.)and
humandatasetsapplicationsDubourvieuxetal.(2021b).Thereisan anupperboundof+55.5p.p..Thisshowsthatthedomainadaptation
orderofmagnitudedifferenceinnumberofshotsperindividualbe- isefficientonthetargetdatasetforallpresentedcases.However,thede-
tweenHolsteinCattle(9)andotherdatasets(48and112).Therefore, creaseseeninalldiagonalelementsofTable3,indicatesthatthesource
whendealingwithHolsteinCattleastargetorassource,HyPASS-SC datasetispartiallyforgottenbythenetwork.Thiseffectisdrasticwith
resp.computesasubsampledoroversampledsourcevalidationdataset Δ valuesintherange[−61.6p.p.,−11.2p.p.].
mAP
resp.,sothatthenumberofshotsperidentityinthesourcevalidation Thegeneralizationperformanceonanunseendatasetisinconsistent
setroughlymatchestheoneofthetarget,asdescribedinSec.3.4.Im- andseemstoevolvetowardsthatofasupervisednetworkthatissuper-
pactontheperformanceofshotslevelingwillbeshowninsection5.3. visedonthetargetdataset.Forexample,inthecaseCowFisheye
Random subsampling Cows2021 or CowFisheye is straightforward, HolsteinCattle,theperformanceofthenetworkonCows2021decreases
whileoversamplingHolsteinCattleisdonebyapplyingthesamedata from 71.0% mAP (cf. Table 2) before UDA to 30.8% mAP after (cf.
augmentationthanfortraining.Pleasenotethatthesourcedataused Table3).Thisperformanceressemblesthe29.1%mAPperformance
fortrainingisnotimpactedbythisstep.Inareal-worldapplication, seenforanetworksolelysupervisedonHolsteinCattle(cf.Table2).In
thenumberofcowsinafarmisknownandthenumberofinstances conclusion,theUDAapproachadaptsthenetworktoasingledataset,
peridentitycanbeapproximatedbydividingthenumberofacquired withoutensuringperformancegainsonanyotherdataset.
imagesbytheestimatednumberofcowsintheexploitation. CUMDA.Intherestofthepaper,wewillrefertodomainadaptation
withsourceguidance,DSBNandHyPASS-SCasCUMDA.Itsfunctioning
5.Results isillustratedinthelowerpartofFig.1.TheresultswithCUMDAarere-
portedinTable4.TheimprovementsoverUDA(cf.Table3)aremulti-
Allresultspresentedbelowarederivedfromtheexperimentsde- ple.
tailedinAppendixA.BothmAPandrank-1metricsarereportedin First,itoutperformsthesupervisednetworkonsource,targetanda
TablesA.11-A.16,however,onlymAPrelatedresultsarediscussed thirdunseendomaininaconsistentway.Onthesourcedomain,the
belowcf.section4.2.6. performanceisequivalentorbetter,witha 96p.p.increaseinterms
ofmAPforCowFisheye.Onthetargetdomain,theperformanceincrease
5.1.EffectivenessofourCUMDA,singletarget isdrasticwithanaverageΔ of 389p.p., 165p.p.and 78p.p.on
mAP
Cows2021,HolsteinCattleandCowFisheyewhentheyaretakenastar-
Supervisedtraining&directtransfer.Supervisedtrainingresults getdomainsrespectively.Generalizationperformanceontheunseen
canbefoundinTable2.Theseresults,whentrainingandtestingon domainincreasesonaverageof 144p.p., 27p.p.and 30p.p.on
thesamedataset,giveanideaofthecomplexityofeachdataset.From thesamedatasets.
highesttolowest:CowFisheye,HolsteinCattleandCows2021. Second, on the target domain, our proposed CUMDA method
Wealsoshowthecross-domainperformanceofmodelssupervised outperformstheUDA.Tocharacterizethis,wecomputetheincrement
onasourcedatasetanddirectlyevaluatedontheotherdatasets,with- inperformancebetweenTables4and3.Onthesourcedomain,theper-
outadaptation.Thelowperformanceonthesedatasetsdemonstrates formanceincreaseisdrasticwithvaluesashighas811 196 615
the need for domain adaptation. In Table 2, two cross-domain p.p.forthecrossdomainHolsteinCattle CowFisheye.Onthetarget
Table2
Performance(mAPin%andaccuracyin%oftherank-1closestelementinthegallery)ofmodelssupervisedonasinglesourcedatasetanddirecttransferoneachtargetdatasetwithout
adaptation.
Train Test
Method Source Target Cows2021 HolsteinCattle CowFisheye
mAP rank-1 mAP rank-1 mAP rank-1
Supervisedtraining Cows2021 None 95.3 98.2 8.0 13.7 16.8 45.7
Supervisedtraining HolsteinCattle None 29.1 73.1 81.2 91.7 12.7 25.2
Supervisedtraining CowFisheye None 71.0 95.1 13.6 24.5 50.5 75.5
52F.Dubourvieux,G.Lapouge,A.Loeschetal. ArtificialIntelligenceinAgriculture10(2023)46–60
Table3
PerformanceofMMTGeetal.(2019).mAP(in%),Δ mAP(inp.p.)indicatesthedifferencewithinitialsupervisedmodels(cfTable2).
Train Test
Method Source Target Cows2021 HolsteinCattle CowFisheye
mAP Δ mAP mAP Δ mAP mAP Δ mAP
UDA Cows2021 HolsteinCattle 39.2 −56.1 12.6 +4.6 9.1 −7.7
UDA Cows2021 CowFisheye 84.1 −11.2 10.8 +2.8 24.3 +7.5
UDA HolsteinCattle Cows2021 84.6 +55.5 25.5 −55.7 16.0 +3.3
UDA HolsteinCattle CowFisheye 54.9 +25.8 19.6 −61.6 14.4 +1.7
UDA CowFisheye Cows2021 88.9 +17.9 8.5 −5.1 19.9 −30.6
UDA CowFisheye HolsteinCattle 30.8 −40.2 22.7 +9.1 14.3 −36.2
Table4
PerformanceofourCUMDAmethod(sourceguidance,DSBNandHyPASS-SC).mAP(in%),Δ mAP(inp.p.)indicatesthedifferencewithinitialsupervisedmodels(cfTable2).
Train Test
Method Source Target Cows2021 HolsteinCattle CowFisheye
mAP Δ mAP mAP Δ mAP mAP Δ mAP
CUMDA Cows2021 HolsteinCattle 95.4 +0.1 15.9 +7.9 20.1 +3.3
CUMDA Cows2021 CowFisheye 95.0 −0.3 13.7 +5.7 28.2 +11.4
CUMDA HolsteinCattle Cows2021 87.2 +58.1 80.8 −0.4 15.3 +2.6
CUMDA HolsteinCattle CowFisheye 57.9 +28.8 81.1 −0.1 16.8 +4.1
CUMDA CowFisheye Cows2021 90.6 +19.6 13.3 −0.3 60.1 +9.6
CUMDA CowFisheye HolsteinCattle 70.9 −0.1 38.6 +25.0 60.1 +9.6
domain,theperformanceincreasesconsistentlywithvaluesbetween Providingthesourceaslabeleddataduringtrainingincreasesthe
+1.7p.p.and+15.9p.p..Generalizationperformanceontheunseen performancedrasticallyonthesourcedataset.Comparedtoregular
domainincreaseswithvaluesbetween−0.7p.p.and+40.1p.p.. UDA,theaverageperformanceincreaseisequalto337 04 333
Alltheseresultsdemonstratethenetworkabilitytobothremember p.p., 581 p.p. and 426 p.p. when considering Cows2021,
the source dataset and leverage information from all domains to HolsteinCattleandCowFisheyeassourcerespectively.However,the
increaseperformancesteadilyonalldomains.OurCUMDAmethod performanceontargetdatasetisapproximatelyunchangedwithanav-
thereforecanensureconservationonthesourcedomain,betterspecial- eragedeltainperformanceof 01p.p., 09p.p.and 11p.p..The
ization on each seen domain and better generalization on unseen modelbettergeneralizesthankstotheknowledgeofbothsourceand
domains. targetdomainswithanincreaseof 214p.p., 23p.p.and 55p.p.
onCows2021,HolsteinCattleandCowFisheyerespectively.
5.2.Ablationstudy,singletarget In summary, compared to UDA, the source guidance allows the
modeltoperformsimilarlyonthetargetwhileensuringgoodconserva-
In section 5.1, we have demonstrated the performance gains tionofthesource.Benefitingfromtheinformationofbothsourceand
brought by our proposed CUMDA method over direct transfer and target,themodelbettergeneralizestoanunseendataset.
UDAdomainadaptation.Inthissection,therelativeimportanceofall DSBN.Inthispaper,alleviatingthedomaingapisachievedwiththe
componentsofourCUMDAmethodisinvestigatedthroughanablation useofDSBN.Averagedperformancewithsourceguidance+DSBNisre-
study.Averagedperformancevariationswithrespecttoanetworksu- portedinTable7.Wecomparetheseresultstothoseofthesource
pervisedonsourcearereportedinTables5-8.Theperformanceon guidedapproach,reportedinTable6.
source,targetandathirddomainarecomputedfollowingtheprotocol Whencomparedtosource-guidedUDA,thereissignificantperfor-
presentedinAppendixA.2.Allresultsarederivedfromtheexperiments manceincreaseonthetargetof402 366 36p.p., 40p.p.and
detailedinAppendixA,TablesA.11-A.16.Pleaseberemindedthatthe 25p.p.forCows2021,HolsteinCattleandCowFisheyerespectively.
componentsofourCUMDAmethodrefertotheuseofsource-guidance, However,performanceonthesourcedatasetslightlydecreaseswith
DSBNandHyPASS-SC. deltasof 07p.p., 18p.p.and 17p.p..Overall,thegeneralization
Sourceguidance.Averagedperformancewithsourceguidanceisre- toanunseendatasetisunchanged.
portedinTable6.WecomparetheseresultstothoseofUDA,reportedin Insummary,inourexperiments,DSBNdoesnotseemtoguarantee
Table5. bettercowre-identification.However,wewillseethatitisusefulby
allowingtheuseofHyPASS.
Table5 Table6
RelativeperformanceofUDA,comparedtodirecttransfer.Δ mAP(inp.p.)indicatesthedif- Relativeperformanceofsource-guidedUDA,comparedtodirecttransfer.Δ mAP(inp.p.)in-
ferenceofmAP(in%)withdirecttransfer(cf.Table2). dicatesthedifferenceofmAP(in%)withdirecttransfer(cf.Table2).
Test Test
Cows2021 HolsteinCattle CowFisheye Cows2021 HolsteinCattle CowFisheye
Testsetas Δ mAP Δ mAP Δ mAP Testsetas Δ mAP Δ mAP Δ mAP
Source −33.7 −58.7 −33.4 Source −0.4 −0.6 +9.2
Target +36.7 +6.9 +4.6 Target +36.6 +6.0 +5.7
Unseen −7.2 −1.2 −2.2 Unseen +14.2 +1.1 +3.3
53F.Dubourvieux,G.Lapouge,A.Loeschetal. ArtificialIntelligenceinAgriculture10(2023)46–60
Table7 p.p.. This may be explained by the significant differences between
Relativeperformanceofsource-guided+DSBNUDA,comparedtodirecttransfer.Δ mAP HolsteinCattleandotherdomains,whichmayresultinasignificant
(inp.p.)indicatesthedifferenceofmAP(in%)withdirecttransfer(cf.Table2).
shiftoftheoptimalvalueofclusteringparameters.OntheCows2021
Test dataset, HyPASS-SC seems to perform slightly worse than source-
guided+DSBNwithadifferenceof 13p.p..Thisseemstoindicate
Cows2021 HolsteinCattle CowFisheye
thatHyPASS-SCmaynotbeoptimalinallcases,especiallywhenthe
Testsetas Δ mAP Δ mAP Δ mAP sourcetestsethasfewimages.However,HyPASS-SCretainsitsusage
Source +0.3 −2.4 +7.5 byremovingtheneedforuser-setparameters.Onthesourcedomain,
Target +40.2 +10.0 +8.2
theperformanceincreaseswithdeltasof 01 03 04p.p.,
Unseen +13.0 +3.1 +2.5
21p.p.and 21p.p..Itevenexceedstheperformanceofsource-
guidedUDA(cf.Table6).Thegeneralizationperformanceisincreased
of 14p.p., 04p.p.and 05p.p..
Inconclusion,wefindthatHyPASS-SChasapositiveeffectonperfor-
Table8 manceonalldatasets.Indeed,itensuresgoodclusteringonalltargets.
RelativeperformanceofoursingletargetCUMDA,comparedtodirecttransfer.Δ mAP(inp. Thisallowsforbettersourceconservation,targetspecializationand
p.)indicatesthedifferenceofmAP(in%)withdirecttransfer(cf.Table2).
generalizationonanunseendatasetthantheotherapproachespre-
Test sentedhere.
Forthecross-domainHolsteinCattle CowFisheye,at-SNEvisuali-
Cows2021 HolsteinCattle CowFisheye
zationoftheeffectsofdomainadaptation,source-guidanceandother
Testsetas Δ mAP Δ mAP Δ mAP componentsoftheCUMDAmethodontheembeddingspace,ispro-
Source −0.1 −0.3 +9.6 posedinFig.5.Itshows:thedecreasedperformanceonsourcewith
Target +38.9 +16.5 +7.8
UDA,theincreasedperformanceonalldatasetswithsourceguidance
Unseen +14.4 +2.7 +3.0
andthebestperformancesobtainedbycombiningallthecomponents
ofourCUMDAmethod.
CUMDAre-IDwithmultiple-targets(CowFisheyeandCows2021)is
HyPASS-SC. also illustrated with clear gains on all three datasets. Quantitative
The use of DSBN allows for source-guided selection of pseudo- evaluationsarepresentedinSec.5.4.
labelinghyperparameters,achievedherewithHyPASS-SC.Averaged
performanceofUDAwithsourceguidance+DSBN+HyPASS-SC=
5.3.BenefitofthesourcecalibrationinHyPASS-SC
CUMDAisreportedinTable8.Wecomparetheseresultstothoseof
thesource-guided+DSBNapproach,reportedinTable7. Asexplainedinsection3.4,HyPASSissensitivetodatasetstatistics.
Incomparisonwithsource-guided+DSBNUDA,theperformance
Morespecifically,inourcase,tothenumberofshotsperidentityof
onthetargetdomainHolsteinCattleincreasesof165 100 65 Cows2021(48),HolsteinCattle(9)andCowFisheye(112).
Fig.5.Evolutionoftheembeddingspaceonallvalidationdatasetsforthecross-domainHolsteinCattle CowFisheye.Visualizationwitht-SNEwhereeachidentityisassignedarandom
colorandsize.Eachpointrepresentsanimageintheembeddingspace.Eachrowcorrespondstoadataset.Eachcolumncorrespondstoamethod.Acronyms.UDA:UDAbaselinewith
MMT;s.g.:sourceguided;CUMDA:CumulativeUnsupervisedMulti-DomainAdaptation;s.t.:single-target;m.t.:multi-target(withCows2021).Ideally,pointsofthesamecolorsshould
beclusteredandwellseparatedfromallotherclusters.CorrespondingrankingvisualizationisavailableinFig.A.7intheappendix.Bestviewedincolor.
54F.Dubourvieux,G.Lapouge,A.Loeschetal. ArtificialIntelligenceinAgriculture10(2023)46–60
Fig.6.EvolutionoftheAdjustedRandomIndex(ARI)oftargetclustering.InfluenceofthecalibrationofsourcevalidationsetonHyPASSperformances.Inblueanddashedlines
HolsteinCattle Cows2021,inred,CowFisheye HolsteinCattle.Acronyms.h.p.:HyPASSDubourvieuxetal.(2021b);inst.Red.:sourceinstancereduction;inst.Aug.:sourceinstance
augmentation.(Forinterpretationofthereferencestocolorinthisfigurelegend,thereaderisreferredtothewebversionofthisarticle.)
Tovalidatetheimportanceofourproposedsourcevalidationsetcal- performanceonthesourcedatasetisconserved.Thisdemonstrates
ibration,wecomparetheperformanceofHyPASS-SCandHyPASSonthe theimportanceoftheproposedCUMDAmethodwhenitcomestomul-
crossdomainsHolsteinCattle Cows2021(oversamplinguse-case)and tipledatasetsapplication.Thisperformanceincreasecanbeexplained
CowFisheye HolsteinCattle(subsamplinguse-case). bythecomplementarityofDSBNandHyPASS-SC.
ThequalityoftheclusteringisevaluatedwiththeAdjustedRandom DSBNallowssomedomaingapalleviationthroughdomainspecific
Index(ARI)whichisameasureofthesimilaritybetweentwodataclus- normalization.Italsoauthorizesdomainstosharethesamebackbone,
terings.Itiscomputedbetweenthetargettrainingsetlabelsandthe whichhelpsgeneralization.HyPASS-SCprovidesoptimizedclustering
clusterpredictions,usingthescikit-learnimplementation2.Fig.6illus- parametersoneachtargetdataset,dependingonitsstatistics.Thisen-
tratestheevolutionofARIwhenlevelingthesourceandtargetstatistics. suresgoodclusteringqualityonthetargetdomains,whichinturnin-
HighervaluesofARIindicateabetterclustering.Performanceiscom- creasesthenetworkperformanceonalldatasets.
paredatthe3000thiteration.
Inthecross-domainHolsteinCattle Cows2021,anoversamplingof 5.5.Limitations
HolsteinCattlefrom9shots/IDtoaround90shots/IDiscarriedout.Asa
result,theARIdoubles,increasingfrom0.40withoutcalibration,to0.83 Inthispaper,wehaveshownsignificantimprovementsonunsuper-
withit.IntermsofmAP,theperformanceonthetargetCows2021in- viseddomainadaptationperformancewhencomparedwithtraditional
creasesfrom77.4%withoutcalibration,to87.2%withit. pseudo-labelling-basedUDAmethods.However,itcanbeseenthatthe
Inthecross-domainCowFisheye HolsteinCattle,asubsamplingof performanceonadomainwhenitisunlabeled,takenasatarget,re-
CowFisheyefrom112shots/IDtoaround9shots/IDiscarriedout.The mainsfarfromtheperformanceonthesamedomainwhenitislabeled,
resultingARIincreaseissubstantial,evolvingfrom0.03withoutcalibra- takenasasource.
tion,to0.23withit.IntermsofmAP,theperformanceonthetarget This is a peculiarity of the cow re-ID problem. Indeed, color
HolsteinCattleincreasesfrom29.3%withoutcalibration,to38.6%withit. informationusuallyfacilitatesthepseudo-labelinginhumanre-IDand
Theseresultsshowtheimportanceofsourcevalidationsetcalibra- theperformanceofunsupervisedUDAisclosetotheperformanceofsu-
tioninthecaseofdatasetswithhighlydifferentnumberofshotsper pervisedtrainingGeetal.(2019).Forcowre-ID,colordoesnotcontain
ID,whichcanbearecurrentissuewhendealingwithanimaldatasets. relevantinformationforpseudo-labeling.Therefore,subtleinformation
Wekindlyremindthereaderthatthecalibrationofthesourcehas suchasshapehastobeconsideredinstead.Also,inthispaperandcow
beensystematicallyappliedonallaforementionedexperiments. re-IDingeneral,thedomaingapexistingbetweenthechosendatasets
canbegreaterthantheoneusuallyseeninpersonre-ID.
5.4.EffectivenessofourCUMDA,multipletargets Inotherwords,evenifthepseudo-labellinghyperparametersare
automaticallyoptimized,theproposedsolutionisstilllimitedbythe
Oneofourgoalsistogeneralizethedomainadaptationtomultiple pseudo-labellingstrategyitself.Namely,pseudo-labelsqualitydepend
targetdomains.Thisuse-casereflectsreal-worldneedswhere,froma onthethechosenclusteringalgorithm,andthenetworksabilityto
labeleddataset,themodelshouldbeadaptedtomultiplefarmingex- extract discriminative representations. Detailed discussion on the
ploitations.AveragedperformanceofourCUMDAapproach(source influence of pseudo-labelling methods on UDA can be found in
guidance,DSBNandHyPASS-SC)isreportedinTable10.Itiscomputed Dubourvieuxetal.(2021b).
fromthedetailedresultsthatcanbefoundinTablesA.11-A.16of
AppendixA.Wecomparetheseresultstothoseofthesource-guided
approach,reportedinTable9. Table9
Onthetargetdatasets,ourapproachoutperformsthesource-guided Relativeperformanceofsource-guided+multi-targetUDA,comparedtodirecttransfer.
UDA approach with Δ
mAP
of 28 p.p., 60 p.p. and 37 p.p. for Δ mAP(inp.p.)indicatesthedifferenceofmAP(in%)withdirecttransfer(cf.Table2).
Cows2021,HolsteinCattleandCowFisheyerespectively.Besides,the Test
Cows2021 HolsteinCattle CowFisheye
Testsetas Δ mAP Δ mAP Δ mAP
Source −0.3 −1.5 +10.5
Target +36.0 +7.4 +3.8
2 https://scikit-learn.org/.
55F.Dubourvieux,G.Lapouge,A.Loeschetal. ArtificialIntelligenceinAgriculture10(2023)46–60
Table10 targetspecializationandgeneralizationonunseendomainswhencom-
RelativeperformanceofourCUMDAmethod,comparedtodirecttransfer.Δ mAP(inp.p.) paredwithclassicalpseudo-labelling-basedUDAmethods.
indicatesthedifferenceofmAP(in%)withdirecttransfer(cf.Table2).
Test CRediTauthorshipcontributionstatement
Cows2021 HolsteinCattle CowFisheye
FabianDubourvieux:Conceptualization,Methodology,Software,
Testsetas Δ mAP Δ mAP Δ mAP Validation,Formalanalysis,Investigation,Writing–originaldraft,Visu-
Source 0.0 −0.9 +10.4 alization.GuillaumeLapouge:Conceptualization,Methodology,Soft-
Target +38.8 +13.4 +7.5 ware, Validation, Formal analysis, Investigation, Writing – original
draft,Visualization.AngéliqueLoesch:Writing–review&editing.
6.Conclusion Bertrand Luvison:Writing –review & editing. Romaric Audigier:
Writing–review&editing.
Inthispaper,wehaveproposedanewCUMDAre-IDmethodforef-
ficientcumulativemulti-domainadaptationmotivatedbypracticalcat- DeclarationofCompetingInterest
tlere-IDconstraintsandrequirements.Thisworkreflectsreal-world
applicationneedsforamodeltoperformbetteronalldomainsasthe Theauthorsdeclarethattheyhavenoknowncompetingfinancial
numberoffarmsincreasebutannotationonthemisnotnecessarily interestsorpersonalrelationshipsthatcouldhaveappearedtoinflu-
available. Indeed, it extends domain adaptation to multiple target encetheworkreportedinthispaper.
domains,withhighdiscrepanciesinbothtargetdatasetsstatisticsand
domainrepresentations,whicharechallengesoftenencounteredin Acknowledgments
practicalapplications.TheproposedCUMDAmethodconsistsin:source
guidance, domain gap reduction and an automatic source-guided PartialfinancialsupportwasreceivedfromtheAIHerdcompanyb.
hyperparameterselectionforclusteringbasedonHyPASS.Asourcecal- This publication was madepossible by the use of the FactoryIA
ibrationmethodtoincreaseHyPASSperformanceondatasetsofgreat supercomputer,financiallysupportedbytheIle-de-FranceRegional
diversity, usually encountered in farming applications, has indeed Council.
beenproposed.Wehavecomparedoursolutiontodirecttransfer,do- The CowFisheye dataset was kindly provided by the AIHerd
mainadaptationandsource-guideddomainadaptation.Resultsshow companyb.
significantperformanceimprovementswithbettersourceconservation,
Ablationstudydetail
AppendixA.1. Visualizationofpredictions
Avisualizationoftherankingproposedbythere-identificationnetworkisproposedinFig.A.7.ThechosenscenarioistheHolsteinCattle
CowFisheyeunsuperviseddomainadaptation,alsorepresentedintheembeddingspaceinFig.5.
AppendixA.2. Performancecomputationdetailed
Inthispaper,Tables5-8exhibitthevariationinperformanceofthenetwork,foreachablationstep.TheΔ iscomputedfromdetailedresultsin
mAP
TablesA.11–A.16underthefollowingprotocol.Letusconsiderasetofndomains ,…, ,andletustestonthedomain ,i∈ 1, ,n .
1 n i
If istestedasasource,theperformanceforallcross-domainexperiments ,k∈ 1, ,n ∖ i ,iscomparedtothenetworksupervisedon
i i k
.Theresultisthenaveraged.
i
If istestedasatarget,theperformanceforallcross-domainexperiments ,k∈ 1, ,n ∖ i ,iscomparedtothenetworksupervisedon
i k i
.Theresultisthenaveraged.
k
If istestedasanunseendataset,theperformanceforallcross-domainexperiments ,k,m∈ 1, ,n ∖ i withk≠m,iscomparedtothe
i k m
networkedsupervisedon .Theresultisthenaveraged.
k
Forthesakeofclarity,letusdetailthecomputationofthefirstlineandfirstcolumnofTable5:testingUDA(MMT)onCows2021asasourcedataset.
UDAmAPonCows2021asasourceisequalto84.1%and39.2%,forthecrossdomainsCows2021 CowFisheye(cf.TableA.12)andCows2021
HolsteinCattle(cf.TableA.14)respectively.AsupervisednetworkonCows2021hasamAPof95.3%onCows2021(cf.Table2).Therefore,the
Δ isequalto 841 953 392 953 2 337p.p..
mAP
AppendixA.3. Allresults
DetailedexperimentalresultsarereportedinTablesA.11-A.16.Eachlinecorrespondstoadifferentmethod,+/ indicatesthatanelementisadded/
removedfromthelineimmediatelyabove.
TableA.11
Effectsofdifferentdomainadaptationstrategiesonre-IDperformances,forcross-domainCowFisheye HolsteinCattle.Δ mAP(inp.p.)indicatesthedifferenceofmAP(in%)withdirect
transfer.Rank-1(in%)isalsoreported.
Train Test
Method Source Target Cows2021 HolsteinCattle CowFisheye
mAP Δ mAP rank-1 mAP Δ mAP rank-1 mAP Δ mAP rank-1
directtransfer CowFisheye None 71.0 0 95.1 13.6 0 24.5 50.5 0 75.5
UDA CowFisheye HolsteinCattle 30.8 −40.2 72.6 22.7 +9.1 38.2 14.3 −36.2 31.1
+sourceguided CowFisheye HolsteinCattle 71.5 +0.5 93.9 25.6 +12.0 41.7 59.6 +9.1 86.1
+DSBN CowFisheye HolsteinCattle 72.3 +1.3 94.5 26.8 +13.2 42.2 55.4 +4.9 82.1
+HyPASS-SC CowFisheye HolsteinCattle 70.9 −0.1 94.4 38.6 +25.0 61.8 60.1 +9.6 84.1
+multi-target CowFisheye HolsteinCattle 90.8 +19.8 98.2 34.5 +20.9 54.9 60.9 +10.4 85.4
Cows2021
HyPASS-SC DSBN CowFisheye HolsteinCattle 89.2 +18.2 97.8 25.3 +11.7 44.1 61.0 +10.5 84.8
Cows2021
b https://www.aiherd.io.
56F.Dubourvieux,G.Lapouge,A.Loeschetal. ArtificialIntelligenceinAgriculture10(2023)46–60
Fig.A.7.Visualizationoftherankingperformanceonallvalidationdatasetsforthecross-domainHolsteinCattle CowFisheye.Foreachquery,thetop9resultsinthegalleryareplotted
fromlefttoright.Picturesframedingreenarecorrectresults,andinred,incorrectones.Theanimalidentityisplottedontopofeachimage.Eachlinecorrespondstoause-case.Acronyms.
UDA:UDAwithMMT;s.g.:sourceguided;CUMDA:CumulativeUnsupervisedMulti-DomainAdaptation;s.t.:single-target;m.t.:multi-target(withCows2021).Bestviewedincolor.(For
interpretationofthereferencestocolorinthisfigurelegend,thereaderisreferredtothewebversionofthisarticle.)
57F.Dubourvieux,G.Lapouge,A.Loeschetal. ArtificialIntelligenceinAgriculture10(2023)46–60
TableA.12
Effectsofdifferentdomainadaptationstrategiesonre-IDperformances,forcross-domainCows2021 CowFisheye.Δ mAP(inp.p.)indicatesthedifferenceofmAP(in%)withdirecttrans-
fer.Rank-1(in%)isalsoreported.
Train Test
Method Source Target Cows2021 HolsteinCattle CowFisheye
mAP Δ mAP rank-1 mAP Δ mAP rank-1 mAP Δ mAP rank-1
directtransfer Cows2021 None 95.3 0 98.2 8.0 0 13.7 16.8 0 45.7
UDA Cows2021 CowFisheye 84.1 −11.2 97.0 10.8 +2.8 15.7 24.3 +7.5 59.6
+sourceguided Cows2021 CowFisheye 94.9 −0.4 98.6 10.5 +2.5 17.2 26.0 +9.2 60.9
+DSBN Cows2021 CowFisheye 95.1 −0.2 98.5 15.1 +7.1 21.1 30.5 +13.7 67.5
+HyPASS-SC Cows2021 CowFisheye 95.0 −0.3 98.4 13.7 +5.7 23.5 28.2 +11.4 64.9
+multi-target Cows2021 CowFisheye 95.3 0.0 98.5 13.8 +5.8 24.0 27.2 +10.4 66.2
HolsteinCattle
HyPASS-SC DSBN Cows2021 CowFisheye 95.0 −0.3 98.4 11.1 +3.1 17.6 22.3 +5.5 57.0
HolsteinCattle
TableA.13
Effectsofdifferentdomainadaptationstrategiesonre-IDperformances,forcross-domainHolsteinCattle CowFisheye.Δ mAP(inp.p.)indicatesthedifferenceofmAP(in%)withdirect
transfer.Rank-1(in%)isalsoreported.
Train Test
Method Source Target Cows2021 HolsteinCattle CowFisheye
mAP Δ mAP rank-1 mAP Δ mAP rank-1 mAP Δ mAP rank-1
directtransfer HolsteinCattle None 29.1 0 73.1 81.2 0 91.7 12.7 0 25.2
UDA HolsteinCattle CowFisheye 54.9 +25.8 90.6 19.6 −61.6 31.9 14.4 +1.7 37.7
+sourceguided HolsteinCattle CowFisheye 57.0 +27.9 90.5 81.7 +0.5 92.6 14.8 +2.1 39.1
+DSBN HolsteinCattle CowFisheye 53.8 +24.7 87.6 78.9 −2.3 89.2 15.4 +2.7 46.4
+HyPASS-SC HolsteinCattle CowFisheye 57.9 +28.8 90.8 81.1 −0.1 92.2 16.8 +4.1 47.0
+multi-target HolsteinCattle CowFisheye 86.8 +57.7 97.2 80.3 −0.9 90.7 17.2 +4.5 55.6
Cows2021
HyPASS-SC DSBN HolsteinCattle CowFisheye 82.8 +53.7 96.6 79.7 −1.5 90.7 14.7 +2.0 43.0
Cows2021
TableA.14
Effectsofdifferentdomainadaptationstrategiesonre-IDperformances,forcross-domainCows2021 HolsteinCattle.Δ mAP(inp.p.)indicatesthedifferenceofmAP(in%)withdirect
transfer.Rank-1(in%)isalsoreported.
Train Test
Method Source Target Cows2021 HolsteinCattle CowFisheye
mAP Δ mAP rank-1 mAP Δ mAP rank-1 mAP Δ mAP rank-1
directtransfer Cows2021 None 95.3 0 98.2 8.0 0 13.7 16.8 0 45.7
UDA Cows2021 HolsteinCattle 39.2 −56.1 81.5 12.6 +4.6 24.0 9.1 −7.7 12.6
+sourceguided Cows2021 HolsteinCattle 94.8 −0.5 98.1 7.9 −0.1 18.6 18.9 +2.1 53.0
+DSBN Cows2021 HolsteinCattle 96.0 +0.7 98.4 14.7 +6.7 26.0 19.3 +2.5 51.7
+HyPASS-SC Cows2021 HolsteinCattle 95.4 +0.1 98.6 15.9 +7.9 26.5 20.1 +3.3 55.6
+multi-target Cows2021 CowFisheye 95.3 0.0 98.5 13.8 +5.8 24.0 27.2 +10.4 66.2
HolsteinCattle
HyPASS-SC DSBN Cows2021 CowFisheye 95.0 −0.3 98.4 11.1 +3.1 17.6 22.3 +5.5 57.0
HolsteinCattle
TableA.15
Effectsofdifferentdomainadaptationstrategiesonre-IDperformances,forcross-domainCowFisheye Cows2021.Δ mAP(inp.p.)indicatesthedifferenceofmAP(in%)withdirecttrans-
fer.Rank-1(in%)isalsoreported.
Train Test
Method Source Target Cows2021 HolsteinCattle CowFisheye
mAP Δ mAP rank-1 mAP Δ mAP rank-1 mAP Δ mAP rank-1
directtransfer CowFisheye None 71.0 0 95.1 13.6 0 24.5 50.5 0 75.5
UDA CowFisheye Cows2021 88.9 +17.9 97.8 8.5 −5.1 14.2 19.9 −30.6 52.3
+sourceguided CowFisheye Cows2021 89.9 +18.9 97.8 13.2 −0.4 23.5 59.8 +9.3 82.1
+DSBN CowFisheye Cows2021 91.5 +20.5 98.4 12.7 −0.9 22.1 60.6 +10.1 88.1
+HyPASS-SC CowFisheye Cows2021 90.6 +19.6 98.0 13.3 −0.3 21.1 60.1 +9.6 88.1
+multi-target CowFisheye HolsteinCattle 90.8 +19.8 98.2 34.5 +20.9 54.9 60.9 +10.4 85.4
Cows2021
HyPASS-SC DSBN CowFisheye HolsteinCattle 89.2 +18.2 97.8 25.3 +11.7 44.1 61.0 +10.5 84.8
Cows2021
58F.Dubourvieux,G.Lapouge,A.Loeschetal. ArtificialIntelligenceinAgriculture10(2023)46–60
TableA.16
Effectsofdifferentdomainadaptationstrategiesonre-IDperformances,forcross-domainHolsteinCattle Cows2021.Δ mAP(inp.p.)indicatesthedifferenceofmAP(in%)withdirect
transfer.Rank-1(in%)isalsoreported.
Train Test
Method Source Target Cows2021 HolsteinCattle CowFisheye
mAP Δ mAP rank-1 mAP Δ mAP rank-1 mAP Δ mAP rank-1
directtransfer HolsteinCattle None 29.1 0 73.1 81.2 0 91.7 12.7 0 25.2
UDA HolsteinCattle Cows2021 84.6 +55.5 96.1 25.5 −55.7 37.3 16.0 +3.3 52.3
+sourceguided HolsteinCattle Cows2021 83.4 +54.3 97.1 79.4 −1.8 89.2 17.1 +4.4 49.0
+DSBN HolsteinCattle Cows2021 89.0 +59.9 98.4 78.8 −2.4 87.3 15.2 +2.5 47.7
+HyPASS-SC HolsteinCattle Cows2021 87.2 +58.1 97.3 80.8 −0.4 90.7 15.3 +2.6 49.0
+multi-target HolsteinCattle CowFisheye 86.8 +57.7 97.2 80.3 −0.9 90.7 17.2 +4.5 55.6
Cows2021
HyPASS-SC DSBN HolsteinCattle CowFisheye 82.8 +53.7 96.6 79.7 −1.5 90.7 14.7 +2.0 43.0
Cows2021
References Huang,Y.,Wu,Q.,Xu,J.,Zhong,Y.,2019.Sbsgan:suppressionofinter-domainbackground
shiftforpersonre-identification.Proc.IEEEInt.Conf.Comput.Vis.9527–9536.
Andrew,W.,Hannuna,S.,Campbell,N.,Burghardt,T.,2016.AutomaticindividualHolstein Ioffe,S.,Szegedy,C.,2015.Batchnormalization:acceleratingdeepnetworktrainingbyre-
friesiancattleidentificationviaselectivelocalcoatpatternmatchinginrgb-dimag- ducinginternalcovariateshift.Proc.Int.Conf.Mach.Learn.448–456.
ery.IEEEProc.Int.Conf.Image.Proc.484–488. Jin,X.,Lan,C.,Zeng,W.,Chen,Z.,2020.Globaldistance-distributionsseparationforunsu-
Andrew,W.,Greatwood,C.,Burghardt,T.,2017.Visuallocalisationandindividualidenti-
pervisedpersonre-identification.Comput.Vis.ECCV735–751.
ficationofHolsteinfriesiancattleviadeeplearning.Proc.IEEEInt.Conf.Comput.Vis. Khan,S.D.,Ullah,H.,2019.Asurveyofadvancesinvision-basedvehiclere-identification.
Workshop,pp.2850–2859. Comput.Vis.ImageUnderst.182,50–63.
Andrew,W.,Gao,J.,Mullan,S.,Campbell,N.,Dowsey,A.W.,Burghardt,T.,2021.Visual
Krizhevsky,A.,Sutskever,I.,Hinton,G.E.,2012.Imagenetclassificationwithdeep
identificationofindividualHolstein-friesiancattleviadeepmetriclearning.Comput. convolutionalneuralnetworks.Adv.NeuralInf.Proces.Syst.25.
Electron.Agric.185,106133. Li,Y.J.,Yang,F.E.,Liu,Y.C.,Yeh,Y.Y.,Du,X.,FrankWang,Y.C.,2018.Adaptationandre-
Bak,S.,Carr,P.,Lalonde,J.F.,2018.Domainadaptationthroughsynthesisforunsupervised
identificationnetwork:anunsuperviseddeeptransferlearningapproachtoperson
personre-identification.Comput.Vis.ECCV189–205. re-identification.Proc.IEEEComput.Soc.Conf.Comput.Vis.PatternRecognit.Work-
Bergamini,L.,Porrello,A.,Dondona,A.C.,DelNegro,E.,Mattioli,M.,D’alterio,N.,Calderara, shops,pp.172–178.
S.,2018.Multi-viewsembeddingforcattlere-identification.IEEEInternationalCon- Li,S.,Li,J.,Tang,H.,Qian,R.,Lin,W.,2019a.Atrw:abenchmarkforamurtigerre-
ferenceonSignal-ImageTechnology&Internet-BasedSystems,pp.184–191. identificationinthewild.arXivpreprint.arXiv:1906.05586.
Bhole,A.,Falzon,O.,Biehl,M.,Azzopardi,G.,2019.Acomputervisionpipelinethatuses
Li,Y.J.,Lin,C.S.,Lin,Y.B.,Wang,Y.C.F.,2019b.Cross-datasetpersonre-identificationvia
thermalandrgbimagesfortherecognitionofHolsteincattle.ComputerAnalysisof unsupervisedposedisentanglementandadaptation.Proc.IEEEInt.Conf.Comput.
ImagesandPatterns.11679,108–119. Vis.7919–7929.
Chang,W.G.,You,T.,Seo,S.,Kwak,S.,Han,B.,2019a.Domain-specificbatchnormalization Lin,S.,Li,H.,Li,C.T.,Kot,A.C.,2018.Multi-taskmid-levelfeaturealignmentnetworkfor
forunsuperviseddomainadaptation.Proc.IEEEComput.Soc.Conf.Comput.Vis.Pat-
unsupervisedcross-datasetpersonre-identification,in:29thBritishMachineVision
ternRecognit,pp.7354–7362. Conference,BMVC2018.
Chang,X.,Yang,Y.,Xiang,T.,Hospedales,T.M.,2019b.Disjointlabelspacetransferlearn-
Liu,C.,Zhang,R.,Guo,L.,2019a.Part-poseguidedamurtigerre-identification.IEEE/CVF
ingwithcommonfactorisedspace.Proc.AAAIConf.Artif.Intell. InternationalConferenceonComputerVisionWorkshops.
Chen,Y.,Zhu,X.,Gong,S.,2019.Instance-guidedcontextrenderingforcross-domainper- Liu,J.,Zha,Z.J.,Chen,D.,Hong,R.,Wang,M.,2019b.Adaptivetransfernetworkforcross-
sonre-identification.Proc.IEEEInt.Conf.Comput.Vis,pp.232–242. domainpersonre-identification.proc.IEEEComput.Soc.Conf.Comput.Vis.Pattern
Chen,G.,Lu,Y.,Lu,J.,Zhou,J.,2020.Deepcrediblemetriclearningforunsuperviseddo-
Recognit,pp.7202–7211.
mainadaptationpersonre-identification.Comput.Vis.ECCV643–659. Liu,J.,Zha,Z.J.,Chen,D.,Hong,R.,Wang,M.,2019c.Adaptivetransfernetworkforcross-
Deng,J.,Dong,W.,Socher,R.,Li,L.J.,Li,K.,Fei-Fei,L.,2009.Imagenet:alarge-scalehierar-
domainpersonre-identification.Proc.IEEEComput.Soc.Conf.Comput.Vis.Pattern
chicalimagedatabase.Proc.IEEEComput.Soc.Conf.Comput.Vis.PatternRecognit.,
Recognit,pp.7202–7211.
pp.248–255 Liu,N.,Zhao,Q.,Zhang,N.,Cheng,X.,Zhu,J.,2019d.Pose-guidedcomplementaryfeatures
Deng,W.,Zheng,L.,Ye,Q.,Kang,G.,Yang,Y.,Jiao,J.,2018.Image-imagedomainadapta-
learningforamurtigerre-identification.IEEE/CVFinternationalconferenceoncom-
tion with preserved self-similarity and domain-dissimilarity for person re- putervisionworkshops.
identification. Proc. IEEE Comput. Soc. Conf. Comput. Vis. Pattern Recognit, Luo,H.,Gu,Y.,Liao,X.,Lai,S.,Jiang,W.,2019.Bagoftricksandastrongbaselinefordeep
pp.994–1003. personre-identification.Proc.IEEEComput.Soc.Conf.Comput.Vis.PatternRecognit
Dubourvieux,F.,Audigier,R.,Loesch,A.,Ainouz,S.,Canu,S.,2021a.a.Unsuperviseddo- Workshops.
main adaptation for person re-identification through source-guided pseudo- Luo,C.,Song,C.,Zhang,Z.,2020.Generalizingpersonre-identificationbycamera-aware
labeling.IEEEproc.Int.Conf.PatternRecogn,pp.4957–4964. invariancelearningandcross-domainmixup.Comput.Vis.ECCV224–241.
Dubourvieux,F.,Loesch,A.,Audigier,R.,Ainouz,S.,Canu,S.,2021b.b.Improvingunsuper- Peng,J.,Wang,Y.,Wang,H.,Zhang,Z.,Fu,X.,Wang,M.,2020.Unsupervisedvehiclere-
viseddomainadaptivere-identificationviasource-gidedselectionofpseudo-labeling identificationwithprogressiveadaptation.arXivpreprint.arXiv:2006.11486.
hyperparameters.IEEEAccess9,149780–149795. Qi,L.,Wang,L.,Huo,J.,Zhou,L.,Shi,Y.,Gao,Y.,2019.Anovelunsupervisedcamera-aware
Dubourvieux,F.,Audigier,R.,Loesch,A.,Ainouz,S.,Canu,S.,2022.Aformalapproachto
domainadaptationframeworkforpersonre-identification.Proc.IEEEInt.Conf.
good practices in pseudo-labeling for unsupervised domain adaptive re-
Comput.Vis,pp.8080–8089.
identification.Comput.Vis.ImageUnderst.223,103527. Ristani,E.,Solera,F.,Zou,R.,Cucchiara,R.,Tomasi,C.,2016.Performancemeasuresanda
Fu,Y.,Wei,Y.,Wang,G.,Zhou,Y.,Shi,H.,Huang,T.S.,2019.Self-similaritygrouping:asim- datasetformulti-target,multi-cameratracking.Comput.Vis.ECCV.
pleunsupervisedcrossdomainadaptationapproachforpersonre-identification. Schneider,S.,Taylor,G.W.,Kremer,S.C.,2020.Similaritylearningnetworksforanimalin-
Proc.IEEEInt.Conf.Comput.Vis.6112–6121. dividualre-identification-beyondthecapabilitiesofahumanobserver.IEEEWinter
Gao,J.,Burghardt,T.,Andrew,W.,Dowsey,A.W.,Campbell,N.W.,2021.Towardsself-
Conf.Appl.Comput.Vis.Workshops,pp.44–52.
supervision for video identification of individual holstein-friesian cattle: the Song,L.,Wang,C.,Zhang,L.,Du,B.,Zhang,Q.,Huang,C.,Wang,X.,2020.Unsuperviseddo-
Cows2021dataset.arXivpreprintarXiv:2105.01938.
mainadaptivere-identification:theoryandpractice.PatternRecogn.102,107173.
Ge,Y.,Chen,D.,Li,H.,2019.Mutualmean-teaching:pseudolabelrefineryforunsuper- Sun,X.,Zheng,L.,2019.Dissectingpersonre-identificationfromtheviewpointofview-
viseddomainadaptationonpersonre-identification.InternationalConferenceon point.Proc.IEEEComput.Soc.Conf.Comput.Vis.PatternRecognit,pp.608–617.
LearningRepresentations.
Tang,H.,Zhao,Y.,Lu,H.,2019.Unsupervisedpersonre-identificationwithiterativeself-
Ge,Y.,Zhu,F.,Chen,D.,Zhao,R.,Li,H.,2020.Self-pacedcontrastivelearningwithhybrid superviseddomainadaptation.Proc.IEEEComput.Soc.Conf.Comput.Vis.Pattern
memoryfordomainadaptiveobjectre-id,in:Adv.Neural.Inf.Process.Syst,pp. Recognit.Workshops.
11309–11321. Wang,J.,Zhu,X.,Gong,S.,Li,W.,2018.Transferablejointattribute-identitydeeplearning
He,K.,Zhang,X.,Ren,S.,Sun,J.,2016.Deepresiduallearningforimagerecognition.Proc.
forunsupervisedpersonre-identification.Proc.IEEEComput.Soc.Conf.Comput.Vis.
IEEEComput.Soc.Conf.Comput.Vis.PatternRecognit,pp.770–778. PatternRecognit,pp.2275–2284.
Hermans,A.,Beyer,L.,Leibe,B.,2017.Indefenseofthetripletlossforpersonre- Wang,J.,Lan,C.,Liu,C.,Ouyang,Y.,Qin,T.,2021.Generalizingtounseendomains:asur-
identification.arXivpreprint.arXiv:1703.07737. veyondomaingeneralization.InteJointConfonArtifIntell4627–4635.
59F.Dubourvieux,G.Lapouge,A.Loeschetal. ArtificialIntelligenceinAgriculture10(2023)46–60
Wei,L.,Zhang,S.,Gao,W.,Tian,Q.,2018a.PersontransferGantobridgedomaingapfor Zhang,X.,Cao,J.,Shen,C.,You,M.,2019.Self-trainingwithprogressiveaugmentationfor
personre-identification.Proc.IEEEComput.Soc.Conf.Comput.Vis.PatternRecognit, unsupervisedcross-domainpersonre-identification.Proc.IEEEInt.Conf.Comput.Vis.
pp.79–88. 8222–8231.
Wei,L.,Zhang,S.,Gao,W.,Tian,Q.,2018b.PersontransferGantobridgedomaingapfor Zhao,F.,Liao,S.,Xie,G.S.,Zhao,J.,Zhang,K.,Shao,L.,2020.Unsuperviseddomainadapta-
personre-identification.Proc.IEEEComput.Soc.Conf.Comput.Vis.PatternRecognit, tionwithnoiseresistiblemutual-trainingforpersonre-identification.Comput.Vis.
pp.79–88. ECCV526–544.
Ye,M.,Shen,J.,Lin,G.,Xiang,T.,Shao,L.,Hoi,S.C.,2021.Deeplearningforpersonre- Zheng,L.,Shen,L.,Tian,L.,Wang,S.,Wang,J.,Tian,Q.,2015.Scalablepersonre-
identification:asurveyandoutlook.IEEETrans.PatternAnal.Mach.Intell.44, identification:Abenchmark.Proc.IEEEInt.Conf.Comput.Vis.
2872–2893. Zheng,L.,Yang,Y.,Hauptmann,A.G.,2016.Personre-identification:past,presentandfu-
Yu,H.X.,Zheng,W.S.,Wu,A.,Guo,X.,Gong,S.,Lai,J.H.,2019.Unsupervisedpersonre- ture.arXivpreprint.arXiv:1610.02984.
identificationbysoftmultilabellearning.Proc.IEEEComput.Soc.Conf.Comput.Vis. Zhong,Z.,Zheng,L.,Li,S.,Yang,Y.,2018.Generalizingapersonretrievalmodelhetero-and
PatternRecognit,pp.2148–2157. homogeneously.Comput.Vis.ECCV172–188.
Zajkac,M.,Zolna,K.,Jastrzkebski,S.,2019.Splitbatchnormalization:improvingsemi- Zhong,Z.,Zheng,L.,Luo,Z.,Li,S.,Yang,Y.,2019.Invariancematters:exemplarmemoryfor
supervisedlearningunderdomainshift.arXivpreprint.arXiv:1904.03515. domainadaptivepersonre-identification.Proc.IEEEComput.Soc.Conf.Comput.Vis.
Zhai,Y.,Lu,S.,Ye,Q.,Shan,X.,Chen,J.,Ji,R.,Tian,Y.,2020a.Ad-cluster:augmenteddis- PatternRecognit,pp.598–607.
criminativeclusteringfordomainadaptivepersonre-identification.Proc.IEEE Zhu,J.Y.,Park,T.,Isola,P.,Efros,A.A.,2017.Unpairedimage-to-imagetranslationusing
Comput.Soc.Conf.Comput.Vis.PatternRecognit,pp.9021–9030. cycle-consistentadversarialnetworks.Proc.IEEEInt.Conf.Comput.Vis.2223–2232.
Zhai,Y.,Ye,Q.,Lu,S.,Jia,M.,Ji,R.,Tian,Y.,2020b.Multipleexpertbrainstormingfordo- Zou,Y.,Yang,X.,Yu,Z.,Kumar,B.V.,Kautz,J.,2020.Jointdisentanglingandadaptationfor
mainadaptivepersonre-identification.Comput.Vis.ECCV594–611. cross-domainpersonre-identification.Comput.Vis.ECCV87–104.
60