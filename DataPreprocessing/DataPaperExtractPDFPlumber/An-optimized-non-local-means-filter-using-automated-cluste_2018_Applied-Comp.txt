AppliedComputingandInformatics14(2018)48–54
ContentslistsavailableatScienceDirect
Applied Computing and Informatics
journal homepage: www.sciencedirect.com
Original Article
An optimized non-local means filter using automated clustering based
preclassification through gap statistics for speckle reduction in breast
ultrasound images
K.M. Prabusankarlala,⇑ , R. Manavalanb, R. Sivaranjanic
aDepartmentofElectronics&Communication,K.S.RangasamyCollegeofArts&Science,Tiruchengode637215,India
bDepartmentofComputerScience&Applications,ArignarAnnaGovernmentArtsCollege,Villupuram605602,India
cDepartmentofMathematics,K.S.R.CollegeofArts&ScienceforWomen,Tiruchengode637215,India
a r t i c l e i n f o a b s t r a c t
Articlehistory: Specklenoiseisacharacteristicartifactinbreastultrasoundimages,whichhinderssubstantiveinforma-
Received6November2016 tionessentialforclinicaldiagnosis.Inthisarticle,wehaveinvestigatedtheuseofNon-localmeans(NLM)
Revised23December2016 filter,whichisrobustagainstseverenoise,toremovespecklenoiseinbreastultrasoundimages.Medical
Accepted5January2017
diagnosissystemscannotemploytraditionalNLMfilters,whichexhibittheslowestperformancedueto
Availableonline30January2017
theircomputationalburdenduringtheweightedaveragingprocess.Wehaveintegratedanovelauto-
matedclusteringbasedpreclassificationschemeusingspatialregularizedfuzzycmeans(FCM)toallevi-
Keywords:
atetheprocess.Theappropriatenumberofclustersforeachimageiscalculatedautomaticallythrough
Breastultrasound
Gapstatistics. Moreover,therotationallyinvariantmomentdistance measureincreasesthechanceof
Specklenoise
gettingmoresimilarregionsforNLMprocess.Thealgorithmisevaluatedonabreastultrasounddatabase,
Nonlocalmeans
Gapstatistics whichconsistsof54imagesincluding28benignand26malignant.Twostatisticalmeasures,Pratt’sfig-
SpatialregularizedFCM ureofmerit(PFM)andequivalentnumberoflooks(ENL),areusedtoevaluatethenoisesuppressionper-
formanceaswellasthecapabilityofpreservingthefinedetails.Theresultsoftheproposedmethodare
comparedwiththeotherthreestateoftheartmethodsquantitatively.Theproposedmethoddemon-
stratedexcellentdespecklingperformancewithPFMof0.91andENLof7.415.Therobustnessagainst
specklenoiseandtheacceptableprocessingtimemakethemethodmoreappropriateforcomputeraided
diagnosissystems.
(cid:1)2017TheAuthors.ProductionandhostingbyElsevierB.V.onbehalfofKingSaudUniversity.Thisisan
openaccessarticleundertheCCBY-NC-NDlicense(http://creativecommons.org/licenses/by-nc-nd/4.0/).
1.Introduction sound brings down the number of unnecessary biopsies, when
compared to mammography [6]. Since the tumor contour is the
Worldwide,breastcanceristhemostfrequentlydiagnosedcan- mostimportantinformationfordiagnosticdecision,thephysician
cer in women and accounts for 14% in overall cancer deaths [1]. could observe more clearly the difference in shapes and sizes of
Earlydetectionanddiagnosisofbreastcancerincreasethesurviv- malignantandbenignbreastlesionsusingultrasound[7].
abilityofpatientsandreducemortality[2,3].Ultrasoundimaging Many ultrasound computer aided detection and diagnosis
isaneffective,convenient,inexpensiveandradiation-freeimaging (CAD)systemshavebeendevelopedtoprovidecomputerizedesti-
toolforbreasttumordiagnosis[4].Ultrasoundhashighersensitiv- mation of the probability of malignancy [8]. The traditional B-
ityfordetectinglesionsindensebreasts,commonlyfoundamong modegrayscaleultrasoundremainsthestandardintheclinicdue
young women [5]. Reduced rate of false-positive results in ultra- tophysicians’familiaritywithit[9].However,themostimportant
deficiencyofultrasoundisthepoorqualityoftheimage,whenitis
corrupted by speckle noise during the acquisition process. The
PeerreviewunderresponsibilityofKingSaudUniversity. existence of the speckle ruins the image quality and impacts the
diagnosisaccuracy[10,11].Theobjectiveofimagedenoisingtask
istoremovethespecklenoisewhileretainingthesignalfeatures
as much as possible in order to increase the diagnostic accuracy.
Production and hosting by Elsevier
Anaccuratemodelofspecklenoiseformationisnecessaryforthe
⇑ Correspondingauthor. developmentofadespecklingalgorithm.Althoughmanystatistical
E-mailaddress:kmsankar@gmail.com(K.M.Prabusankarlal).
http://dx.doi.org/10.1016/j.aci.2017.01.002
2210-8327/(cid:1)2017TheAuthors.ProductionandhostingbyElsevierB.V.onbehalfofKingSaudUniversity.
ThisisanopenaccessarticleundertheCCBY-NC-NDlicense(http://creativecommons.org/licenses/by-nc-nd/4.0/).K.M.Prabusankarlaletal./AppliedComputingandInformatics14(2018)48–54 49
modelsweredevelopedtodescribespecklenoise,thereisnouni- trast edges and speckle is often retained in the high intensity
versally accepted model available yet. However a general model regions. Moreover, in all these methods, the restored value of a
[12] for speckle noise is given as gðn;mÞ’fðn;mÞuðn;mÞ, where pixelonlydependsonitsspatialneighborhoodpixelsofthesame
gðn;mÞ is the observed image, fðn;mÞ is the original image and imagecontext,knownaslocallyadaptiverecoveryparadigm[20].
uðn;mÞmultiplicativecomponentofspecklenoise. Buades et al. [21] proposed non-local means (NLM) approach,
Typically,speckle reduction is accomplished by applying vari- whichexploitsspecificcharacteristicsofnaturalortextureimages
ous filters. However, these filters also remove finer edge details, suchasrepetitivepatterns.NLMfilterisbasedonthecategoryof
whichareessentialforproducinganaccuratecontourofthetumor directional average filters [14] and it replaces each pixel with a
fordiagnosis[13].Directionalaveragefilter[14],andpartialdiffer- weightedaverageofotherpixelswithsimilarneighborhoods.The
ential equation (PDE) based filters [15–19] are able to preserve NLM filer produced the promising results on severely noise
importantfeaturessuchasedges,cornersandpointtargets,while affected images [21–27] and ultrasound images [28–31]. The
removingspecklenoiseinultrasoundimages.Theanisotropicdif- drawbackoftheNLMalgorithmisthatitconsumesmoreprocess-
fusion (AD) filter [15] utilizes the local estimations of the image ing time during the calculation of weights. Many methods were
structures where the image smoothing is devised as a diffusive proposed to speed up the processing by eliminating dissimilar
processanditisstoppedatlesionboundariestopreservethedis- patches before the weight calculation. Techniques such as prese-
continuities.FilterssuchasspecklereducingAD(SRAD)[16],adap- lectionofcontributingneighborhoodsbasedonmeanandgradient
tive window AD (AWAD) [17], oriented SRAD [18] and speckle values[24],useoflocalmeanandvariancetoeliminatedissimilar
suppressing AD (SSAD) [19] were also utilized for despeckling pixels[23],useoffastFouriertransform(FFT)[25]andutilization
ultrasound images. Although the PDE based methods exhibited ofseveralcriticalpixelsinthecenterinsteadofallneighborhood
improved speckle reduction and edge preservation, they lose pixels[26]wereusedduringthecalculationofweights.Grewenig
meaningfuldetailsduringiterationsbyproducingblurredlowcon- et al. [27] used two similarity measures: moment invariants and
rotationallyinvariantblockmatching(RIBM).Themethodidenti-
fied similar patches present in several rotated or mirrored
instancestoobtainmoresuitableregions.Thismethodimproved
Table1
Detailsoftheparametersusedfortheexperiments. thedespecklingperformanceofNLMconsiderably,butnotthepro-
cessing speed. Zhan et al. [31] introduced a weight refining NLM
Methods Detailsofparameters
method, where weight calculation is performed in lower dimen-
Imagedatabase Breastultrasoundimages(Bmode) sionalsubspaceusingPCAinsteadoftheoriginalnoisyimagespace
Dimensionofimages256(cid:2)256.Format:TIFF
Momentinvariantsused Hu’sseventhmomentinvariantsu to reduce computational cost. Although the preselection process
Numberofclusterscfor Automaticallysetbygapstatistics,7 m=2,a=0.8, improves the preservation of detail rich regions, the flat regions
FCM andNR¼93(cid:2)3window) are slightly degraded [28]. In fact the flat regions contain a large
Block(patch)andsearch 5(cid:2)5and21(cid:2)21;commonforallimages numberofsimilarpixels,whichtendstoimprovedenoisingperfor-
windowsize mance. Yan et al. [32] presented the concept of clustering based
Filteringparameterh Globalparameterh=15
preclassification to increase the computational speed without
Fig. 1. ABenign cysthassmooth andregularcontour edges.Aspecific benignimage(Image_ID:U5)processed bydifferentmethodsforvisualcomparison: (h=15,
clusters=1188)(a)original(b)method[27](c)method[33](d)method[39]and(e)proposedmethod.50 K.M.Prabusankarlaletal./AppliedComputingandInformatics14(2018)48–54
elimination of pixels. The computational intensity is alleviated isperformedfordefiningasetofcandidatesthatcontainsdifferent
considerably by performing the weighted averaging within each patchesfromallovertheimage,whichserveaslookuptable(LUT)
cluster. The filter produced superior quantitative results when forblockmatchingprocess.ThespatialregularizedFCMisusedas
theappropriatenumberofclusterswithsufficientnumberofpixel clusteringalgorithm.Theobjectivefunctionisdefinedasfollows:
!
candidatesischosenmanually.
Inthisarticle,wehaveproposedanovelframeworkforNLMfil- J
¼Xc XN
lmkx (cid:3)v k2þ
a Xc XN
lm
X
kx (cid:3)v k2 ð1Þ
tertoremovespecklenoiseinbreastultrasoundimages.Wehave m i¼1 k¼1 ik k m N R i¼1 k¼1 ik xr2Nk r m
integratedanautomatedclusteringbasedpreclassificationscheme
intotheNLMmodeltoincreasethecomputationalspeedaswellas wherex ristheneighborofx k;N kisasetofneighborswithinawin-
a
thenoisereductionperformance.Duringpreclassificationprocess, dowaroundx kandN RisthecardinalityofN k.Theparameter con-
featurevectorsarecalculatedfortheimageusingmomentinvari- trols the neighborhoods and its relative importance is inversely
antsandareclusteredbyspatialregularizedFCMalgorithm.Mean- proportionaltotheamountofnoisepresentintheimage.
while, the gap statistics automatically calculate the appropriate
numberofclustersforeachimage.Theweightedaveragingprocess 2.4.Calculatingnumberofclustersusinggapstatistics
isperformedusingRIBMwithineachclusteranditidentifiesmore
similar regions in an image. Thus, the NLM has been facilitated Tibshiranietal.[35]discoveredthatthe‘‘withinclusterdisper-
with more suitable regions without eliminating any pixel candi- sion”,anerrormeasuredecreaseswhenthenumberofclusters‘k’
dates to yield superior denoising performance with reduced pro- increases.However,whenaspecificvalueof‘k’isreached,theerror
cessingtime. measurebecomesflat.Thevalueof‘k‘atsuchan‘elbow’,indicates
theappropriatenumberofclustersanditcanbeassignedtoany
clusteringalgorithmautomatically.
2.Methods
At first the input image data x ði¼1;2...;nand j¼1;2;
ij
...;mÞareclusteredbychangingthetotalnumberofclustersfrom
2.1.Theimagedatabase
k¼1;2;3;...;k ,wherethemfeaturesaremeasuredinnindepen-
n
dentobservations.Thedistancebetweentwoobservationsiandi0.
The image database consists of 54 B-mode breast ultrasound
imagesincluding28benignand26malignantcases.Theseimages d ii0 where Pthe same can be calculated through squared Euclidean
wereacquiredthroughhighendultrasoundsystem(ProsoundF75, distance jðx ij(cid:3)x i0jÞ2.TheC r denotestheindicesofnclusterr,if
Hitachi medical systems Europe, Switzerland) from different theclustereddataareC 1;C 2;...;C kandnr¼jC rj.Thewithincluster
patients over different periods with the consent of the patients dispersionW k,anerrormeasure[36]isgivenasfollows:
[33].ItcomplieswiththeHONcode(healthonthenetfoundation) Xk
1
standard fortrustworthyhealthinformation.The studyprotocols W ¼ D ð2Þ
are approved by institution’sethics committee of Gelderse Vallei k r¼12n r r
Hospital,Ede,theNetherlands.
whereD,thesumofpairwisedistancesinclusterriscalculatedby
P r
2.2.TheNLMalgorithm
D r¼ i;i02Crd ii0.Wecomparethegraph[35]oflogðW kÞtoitsexpecta-
tion under an appropriate null reference distribution of data. The
optimum number of clusters is estimated by finding the value of
TheNLMalgorithmmakesuseoftheselfsimilarityofpatchesin
animage[21].Inanimage,therestoredintensityNLðvÞðiÞofapixel k for which logðW kÞ falls below this reference curve. The G nðkÞ is
estimatedasfollows:
iisaweightedaverageofallintensityvalueswithintheneighbor-
h No Lo ðvd ÞðiÞI ¼. PTh xe ði;jÞt vra ðjd Þ,it wio hn ea rl
ev
iN sL tM heint[ e2 n1 s] ity,i vs ðjÞisgi tv he en inteb ny
-
G nðkÞ¼E nðlogðW kÞÞ(cid:3)logðW kÞ ð3Þ
sity at
pixelj2 jI
, and
xði;jÞ
is the assigned weight. The weights
wheretheE ndenotestheexpectationunderasamplesizeofnfrom
the reference distribution. Generate B reference datasets as pre-
xði;jÞ¼ Z1
ðiÞe(cid:3)kvNi(cid:3) h2vNjk2
2 dependonthesimilaritybetweentheintensi- s cc luri sb tee rd din isp[3 e5 rs] i, oa nnd mc el au ss ut re er Weach foo rne b¼k¼ 1;1 2; ;2 .; .. .. ;. B; .K Coa mnd pufi tn ed thw eit gh ain
p
tiesofthelocalneighborhoodpatches(blocks)centeredonpixeli kb
G ðkÞusingEq.(3).
andj.WhereN isapatchoffixedsizeandcenteredatthepixeli. n
i
X
dTh ise tas nim ceila or fit vy Nter (m neik g(cid:4) hk b2 2 oi rs hc oo om dp ou fte j)d ab ne dtw ve Nen (w nee ii gg hh bt oed rhE ou oc dlid oe fa i)n
.
G nðkÞ¼1
B
ðlogðW kbÞ(cid:3)logðW kÞÞ ð4Þ
ZðiÞ is the normj alization constant ensuringi that P x ði;jÞ¼1. b
j2I R (cid:2) P (cid:3)
TT hh ee h imi ps rt oh ve edfil Nte Lr Ming [3p 2a ]ra im se gt ie vr enwh ai sch Nc Lo ðvn Þt ðr io Þls ¼tPhe j2Ls xm Ro ðio ;t jÞh vin ðjg Þ.
,
wCo hm erp eu h(cid:2)te ¼th
1
Be Ps bt ða ln od ga ðWrd kd bÞe Þv aia nt dio Sn ko ¼f SB Da ks pS
ffi
1D
ffiffiffi
þkffiffiffiffi¼
ffi 1ffiffiffi =ffiffi
Bffi1
Bffiffi .Fib
nðl ao llg yðW
chk
obÞ os(cid:3) eh(cid:2) tÞ he1 2
iTw nhh
e
Se er
x
ce
tR
it
ð
oh
i;
ne
jÞ
2m
d
.5eo pd aei nfi
n
de dd
s
thow ene Li dg
i
ih
s
st
ta
tx
hn
ecR eð ni;
m
ujÞ med
a
bse eufi rrn
e
oe fd
d R
ea
ð li
es
;
mjx
Þ
ewR nð
h
ti; sij cÞ
ih
n¼
i
asZR1 dð ciÞ lee ufi(cid:3) sd
n
thR 2 eeði; rj dÞ .
.
s k^m ¼al sl mes at lls ei sz te kof suk ca hs tk^ h.
at G nðkÞ¼G nðkþ1Þ(cid:3)S kþ1 ð5Þ
Thecomputationaltimecanbereducedbyperformingcalculation ThiskvalueisassignedtothespatialregularizedFCMalgorithmas
ofweightswithineachclusterinsteadfortheentireimage. k¼c.
2.3.Pre-classificationusingspatialregularizedFCMclustering 2.5.RIBMbasednonlocalfiltering
TheHu’smomentinvariant[27]isusedasimagedescriptor.For In NLM algorithm, lack of repetitive patterns in an image
anN(cid:2)MimagewithanN(cid:2)Mpatchcenteredatlocationi,where leads to insufficient candidates for weighted averaging. Also,
ði¼1;2;3;...;N(cid:2)MÞ,themomentinvariantsofthepatcharerep- theuseofmomentinvariantsduringpreclassificationmighthave
resented by a vector of ð1(cid:2)7Þ. Totally, ðN(cid:2)NÞ vectors for the possibly left rotationally unaligned candidates at neighborhood.
entireimageareconstructed.Theclusteringbasedpreclassification The RIBM can solve these problems by finding similar regionsK.M.Prabusankarlaletal./AppliedComputingandInformatics14(2018)48–54 51
Fig.2. AMalignanttumorimagecharacterizedbyirregularshapeswithroughcontouredges.Aspecificmalignantimage(Image_ID:U45),processedbydifferentmethods:
(h=15,clusters=1120)(a)original(b)method[27](c)method[33](d)method[33]and(e)proposedmethod.
Table2
ThePFMandENLvaluesofthemethodsundercomparisonwithcommonparametersettings.Thevaluesarethemeanvaluesofentiredatabase(bothbenignandmalignant
images).ThepvaluesarecalculatedthroughANOVAtest.
Parameters TraditionalNLM NLMwithRIBM ImprovedNLM Proposedmethod pvalue Statisticalsignificance
PFM 0.7 0.759 0.819 0.91 <0.05 Yes
ENL 5.566 5.829 6.031 7.415 <0.05 Yes
Fig.3. Pratt’sfigureofmerit(PFM)isusedasametrictoevaluatethepreservationofedges.
X
in an image [36]. The RIBM estimates the angle of rotation d RðN i;N jÞ¼ ðf Niðc iÞ(cid:3)Iðf Nj;c jÞ2dc iÞ ð6Þ
between two blocks by its centroid and using this value, it finds ci2Ni
thepositionofthecorrespondingpixelinanotherblockbyrotat- whereIdenotesbilinearinterpolationfunction.Foreachpointofc
i
ing its vector. The new similarity measure in discrete form is inpatchN,afterrotationandinterpolation,itscorrespondingpoint
i
given as [32]: c inpatchN isobtained.
j j52 K.M.Prabusankarlaletal./AppliedComputingandInformatics14(2018)48–54
2.6.Selectionofparametersforexperiment againstheavynoise[21].ThetraditionalNLMisasimpleandeffec-
tivewaytoreducenoise,whilekeepingdetailsoftheimagesunaf-
TheparametersusedforourexperimentsarelistedinTable1. fected. A limitation of the filter is that it can identify patches as
u
Hu’s seventh moment invariant is used as feature descriptor similar to a given patch with same structure and orientation but
7
inpreclassification.Theappropriatenumberofclustersforpreclas- similar patches with similar structure but different orientations
sificationisdeterminedbygapstatistics.Theblocksizeof5(cid:2)5is do not have influence in the average [39]. To rectify this issue,
chosenforRIBMandthesizeofthesearchwindowissetat21(cid:2)21 the orientation of patches is estimated and corrected before
[21,37,38]. The filter parameter h is an important parameter in weighted averaging process using RIBM [27,36] to obtain more
NLMfilter.Theoptimalvalueofhdependsontheamountofnoise suitableregions.
present in the image. Choosing a low value of h leads to noisy Thelowerprocessingtimeisanimportantcriterionformedical
imageandahighvalueofhblursthefinedetailsofimage.Inmany imagedenoising.Sowehaveconcentratedmethods,whichreduce
methods[31]thevalueofhischosenash¼Cr
whereCisacon- computationaltime.Yanetal.[32]usedclusteringbasedpreclas-
r
stantand isthestandarddeviationofnoise.Asweconfineour sification[32]toachievefasterprocessingwithouttheelimination
experiments with breast ultrasound images, the noise cannot be ofanypixelsinweightcalculation.Thek-meansalgorithmisused
estimatedandsowehavechosenh=15assuggestedin[36,27]. forclustering,wherethevalueofk(numberofclusters)hasbeen
setmanuallythoughvisualperceptionaswellasthroughpeaksig-
3.Results naltonoiseratio(PSNR)values.Ink-meansalgorithm,thepatches
are divided into distinct clusters and each element of a patch
Themethodisevaluatedonbreastultrasoundimagedatabase, belongstoexactlyone cluster.This restrictsthecandidatesto be
using two statistical parameters namely Pratt’s figure of merit presentinmorethanonecluster.Sucharestrictionisnotpresent
(PFM) [16] and equivalent number of looks (ENL) [30]. We have infuzzyclusteringwheretheelementsofapatchcanspreadover
compared the results of the proposed method with other three
state of the art NLM based methods: traditional NLM (TNLM)
[21],NLMwithRIBM[27]andimprovedNLM[32].Inourexperi-
ments,thesamesetofNLMparameters(Table1)areusedforall
thesemethods.IntheFigs.1and2,(a)istheoriginalimagefrom
thedatabase,(b)theprocessedimagebythemethod[21],(c)by
the method [27], (d) by the method [32] and (e) shows the pro-
cessedimagebyourmethod.Table2showsnumericalresultspro-
duced by all the evaluated methods. The values shown are the
mean values of entire images in the database. An ANOVA test is
alsoperformedtoanalyzesignificantimprovementsinthedenois-
ingperformanceoftheproposedalgorithmoverothermethods.As
shown in Table 2, the proposed method produced PFM and ENL
values of 0.91 and 7.415 respectively, which are significantly
higherthantheotherthreemethodswithallpvalues<0.05.The
values of PFM and ENL for each individual image are plotted in
Figs.3and4forcomparison.AllalgorithmshavebeenrunonMat-
lab 2009a (Mathworks Inc., USA), in an Intel Core i5 processor
(IntelCorp.,USA)basedPCwith8GBRAM.
4.Discussion
Fig.5. Thegraphshowsappropriatenumberofclustersautomaticallyselectedfor
eachimagethroughgapstatistics.Thenumberofclustersvariedfrom920to1315
WehavepresentedaNLMbasedmethodforremovingspeckle
forthe54imagesinthedatabase.
noisefrombreastultrasoundimagesbyconsideringitsrobustness
Fig.4. Equivalentnumberoflooks(ENL)isaninherentparameterformeasuringnoiselevelinanimage.ENLiscalculatedfromasmallrectangularhomogeneousregionof
theimages.K.M.Prabusankarlaletal./AppliedComputingandInformatics14(2018)48–54 53
morethanoneclusterwithanassociationdefinedbyamember- Acknowledgments
ship function. This property increases the probability of getting
moresuitablecandidatesfromeachclusterforweightedaveraging. WewouldliketoacknowledgeDr.T.S.A.Geertsma,MD,Head,
However,theFCMdoesnotconsiderthespatialinformationinthe Department of Radiology, Gelderse Vallei Hospital, Ede, the
image context [34], which makes it very sensitive to noise and Netherlands,forprovidingbreastultrasoundimages.
other imaging artifacts. In spatial regularized FCM algorithm,the
local spatial information is incorporated into the FCM [34], in References
whichtheneighborhoodeffectactsasaregularizer.
Moreover, in clustering based preclassification methods, the [1] A.Jemal,F.Bray,M.M.Center,J.Ferlay,E.Ward,D.Forman,Globalcancer
number of clusters impacts the denoising performance [32] and statistics,CACancerJ.Clin.61(2011)69–90.
[2] S.Khan,M.Hussain,H.Aboalsamh,G.Bebis,AcomparisonofdifferentGabor
theestimationof optimumnumberofclusters isthe majorchal- feature extraction approaches for mass classification in mammography,
lenge.Ifthenumberofclustersismore,fewercandidatesarepre- Multim.ToolsAppl.(2015)1–25.
sent in each cluster and degrade the denoising performance. In [3] T.Jia-Wei,N.Chun-Ping,G.Yan-Hui,C.Heng-Da,T.Xiang-Long,Effectofa
novelsegmentationalgorithmonradiologists’diagnosisofbreastmassesusing
contrary,if clustersare less, morenumberofcandidatesare pre-
ultrasoundimaging,UltrasoundMed.Biol.38(1)(2012)119–127.
sent in each cluster and make the method sluggish. In our work, [4] S.Zhou,J.Shi,J.Zhu,Y.Cai,R.Wang,Shearlet-basedtexturefeatureextraction
wehaveusedgapstatistics[35]tochooseappropriatenumberof forclassificationofbreasttumorinultrasoundimage,Biomed.SignalProcess.
Control8(6)(2013)688–696.
clusterswhichleadstooptimumperformance.ThecurveinFig.5
[5] J.L.Jesneck,J.Y.LoY,J.A.Baker,Breastmasslesions:computer-aideddiagnosis
shows the appropriate values of k produced for each image of models with mammographic and sonographic descriptors, Radiology 244
ourdatabase.Itcanbeobservedfromthegraphthatthevalueof (2007)390–398.
[6] G.Pons,J.Martí,R.Martí,S.Ganau,J.C.Vilanova,J.A.Noble,Evaluatinglesion
kisuniqueforeachimage,whichvariesfrom920to1315.
segmentationonbreastsonographyasrelated tolesiontype,J.Ultrasound
The PFM is used as a metric to evaluate the preservation of Med.32(9)(2013)1659–1670.
edges.Itusesthedistancebetweenallpairsofpointstoquantify [7] Y.L. Huang, D.R. Chen, S.C. Chang, Three-dimensional region-based
segmentation for breast tumors on sonography, J. Ultrasound Med. 32 (5)
the quality of edges. It is observed from the curves (Fig. 3) that
(2013)835–846.
our method produced PFM values comparatively higher for the [8] K.Drukker,N.P.Gruszauskas,C.A.Sennett,M.L.Giger,BreastUScomputer-
most of the images in the database, which demonstrates better aided diagnosis workstation: performance with a large clinical diagnostic
edgepreservation.TherangeofPFMisbetween0and1andhigher population,Radiology248(2)(2008)392.
[9] A. Athanasiou, A. Tardivon, L. Ollivier, F. Thibault, C.E. Khoury, S.
valueisforidealedgedetection.Canny’smethod,whichproduces Neuenschwander,Howtooptimizebreastultrasound, Eur.J.Radiol.69(1)
singleresponseforeachselectededgesisusedforedgedetection (2009)6–13.
[16] with standard deviation of the Gaussian kernel r¼0:1. We [10] I.Njeh,O.BSassi,KChtourou,A.BHamida,Specklenoisereductioninbreast
ultrasoundimages:SMU(SRADMedianUnsharp)approach,in:Proceedingsof
achievedahigherPFMof0.91,whencomparedtoothermethods:
the Eighth IEEE International Multi Conference on Systems, Signals and
TNLM (0.7), NLM-RIBM (0.759) and improved NLM (0.819). The Devices,2011,pp.1–6.
inherent parameter, ENL is an effective index for estimating the [11] K.M.Prabusankarlal,P.Thirumoorthy,R.Manavalan,Computeraidedbreast
cancerdiagnosistechniquesinultrasound:asurvey,J.Med.Imag.HealthInf.4
speckle noise level in images [30]. The value of ENL corresponds
(3)(2014)331–349.
to smoother homogeneous region in the despeckled image. The [12] O.V.Michailovich,A.Tannenbaum,Despecklingofmedicalultrasoundimages,
comparisonofENLvaluesisshowninFig.4.TheENLiscalculated IEEETrans.Ultrason.Ferroelectr.Freq.Control53(1)(2006)64–78.
[13] H.D.Cheng,J.Shan,W.Ju,Y.Guo,L.Zhang,Automatedbreastcancerdetection
onasmallrectangularhomogeneousregionintheoriginalimage
andclassificationusingultrasoundimages:asurvey,PatternRecogn.43(1)
and the value obtained is 4.43. The proposed method produced (2010)299–317.
higher value of ENL (7.415), when compared to TNLM (5.566), [14] Y.Guo,H.D.Cheng,J.Tian,Y.Zhang,Anovelapproachtospecklereductionin
ultrasoundimaging,UltrasoundMed.Biol.35(4)(2009)628–640.
NLMwithRIBM(5.829)andimprovedNLM(6.031),manifestsbet-
[15] P.Perona,J.Malik,Scale-spaceandedgedetectionusinganisotropicdiffusion,
ter despeckling ability over other methods. The TNLM [24] con- IEEETrans.PatternAnal.Mach.Intell.12(7)(1990)629–639.
sumed 28s, the method [27] consumed 31s, the method [32] [16] Y.Yu, S.T.Acton,Speckle reducing anisotropic diffusion, IEEE Trans. Image
consumed6.8sandtheproposedmethodconsumed7.2s.Thepro- Process.11(11)(2002)1260–1270.
[17] G.Liu,X.Zeng,F.Tian,Z.Li,K.Chaibou,Specklereductionbyadaptivewindow
cessingtimeoftheproposedmethod(7.2s)isslightlyhigherthan anisotropicdiffusion,SignalProcess.89(11)(2009)2233–2243.
the method [32] (6.8s), because of the implementation of gap [18] K.Krissian,C.F.Westin,R.Kikinis,K.G.Vosburgh,Orientedspecklereducing
statisticinpreclassificationstage.Theacceptableprocessingtime anisotropicdiffusion,IEEETrans.ImageProcess.16(5)(2007)1412–1424.
[19] S.Ovireddy,E.Muthusamy,Specklesuppressinganisotropicdiffusionfilterfor
andtheabilityofpreservingimagedetailswhileremovingspeckle
medicalultrasoundimages,Ultrason.Imag.36(2)(2014)112–132.
noisemakeitsuitableforcomputeraideddiagnosissystems. [20] M.Elad,Ontheoriginofthebilateralfilterandwaystoimproveit,IEEETrans.
ImageProcess.11(10)(2002)1141–1151.
[21] A.Buades,B.Coll,J.M.Morel,Areviewofimagedenoisingalgorithm,witha
5.Conclusion newone,Simulation4(2005)490–530.
[22] A. Buades, B. Coll, J.M. Morel, Image denoising methods. A new nonlocal
principle,SIAMRev.52(1)(2010)113–147.
In this article, we have presented a novel NLM framework for [23] P.Coupé,P.Yger,S.Prima,P.Hellier,C.Kervrann,C.Barillot,Anoptimized
removingspecklenoiseinbreastultrasoundimages.Theproposed blockwisenonlocalmeansdenoisingfilterfor3-Dmagneticresonanceimages,
IEEETrans.Med.Imaging27(4)(2008)425–441.
methodhasimprovedtheNLMperformanceintwoways:anauto-
[24] M.Mahmoudi,G.Sapiro,Fastimageandvideodenoisingvianonlocalmeansof
mated clustering based preclassification scheme through gap similarneighborhoods,IEEESignalProcess.Lett.12(2005)839–842.
statisticsandanewsimilaritymeasureusingrotationallyinvariant [25] J.Wang,Y.Guo,Y.Ying,Y.Liu,Q.Peng,Fastnon-localalgorithmforimage
moment distance measure. The results have shown that the pre- denoising, in: Proceedings of the IEEE International Conference on Image
Processing,2006,pp.1429–1432.
sentedmethodgivesbetterquantitativeresultscomparedtoother [26] P.Chao,O.C.Au,D.Jingjing,Y.Wen,Z.Feng,AfastNL-meansmethodinimage
state-of-the-artNLMbasedmethods.Thus,therobustnessagainst denoisingbasedonthesimilarityofspatiallysampledpixels,in:Proceedings
noise and low processing time make the filter appropriate for oftheIEEEInternationalWorkshoponMultimediaSignalProcessing,2009,pp.
1–4.
ultrasoundcomputeraidedbreastcancerdiagnosissystems.
[27] S.Grewenig,S.Zimmer,J.Weickert,Rotationallyinvariantsimilaritymeasures
fornonlocalimagedenoising,J.Vis.Commun.ImageR.22(2011)117–130.
[28] P.Coupé,P. Hellier,C. Kervrann,C. Barillot,Nonlocal means-based speckle
Financialsupport filtering for ultrasound images, IEEE Trans. Image Process. 18 (10) (2009)
2221–2229.
[29] Y.Guo,Y.Wang,T.Hou,Specklefilteringofultrasonicimagesusingamodified
This research did not receive any specific grant from funding
nonlocal-basedalgorithm,Biomed.SignalProcess.Control6(2)(2011)129–
agenciesinthepublic,commercial,ornot-for-profitsectors. 138.54 K.M.Prabusankarlaletal./AppliedComputingandInformatics14(2018)48–54
[30] Y. Gu, Z. Cui, C. Xiu, L. Wang, Ultrasound echocardiography despeckling [35] R.Tibshirani,G.Walther,T.Hastie,Estimatingthenumberofclustersinadata
withnon-localmeanstimesseriesfilter,Neurocomputing124(2013)120– setviathegapstatistic,J.R.Statist.Soc.:Ser.B(Statist.Methodol.)63(2)
130. (2001)411–423.
[31] Y. Zhan, M. Ding, L. Wu, X. Zhang, Nonlocal means method using weight [36] S. Zimmer, S. Didas, J. Weickert, A rotationally invariant block matching
refiningfordespecklingofultrasoundimages,SignalProcess.103(2014)201– strategyimprovingimagedenoisingwithnon-localmeans,in:Proceedingsof
213. the2008InternationalWorkshoponLocalandNon-LocalApproximationin
[32] R.Yan,L.LingShao,S.D.Cvetkovic,J.Klijn,Improvednonlocalmeansbasedon ImageProcessing,2008,pp.135–142.
pre-classificationandinvariantblockmatching,IEEEJ.DisplayTechnol.8(4) [37] J. Salmon, On two parameters for denoising with non-local means, Signal
(2012)212–218. Process.Lett.IEEE17(3)(2010)269–272.
[33] Ultrasoundcases <http://ultrasoundcases.info/category.aspx?cat=67> [38] K.M.Prabusankarlal,P.Thirumoorthy,R.Manavalan,Assessmentofcombined
(accessedJuly2014). textural and morphological features for diagnosis of breast masses in
[34] K.M.Prabusankarlal,P.Thirumoorthy,R.Manavalan,Segmentationofbreast ultrasound,Human-CentricComput.Inf.Sci.5(1)(2015)1–17.
lesions in ultrasound images through multiresolution analysis using [39] J.V.Manjón,P.Coupé,A.Buades,D.LouisCollins,M.Robles,Newmethodsfor
undecimateddiscretewavelettransform,Ultrason.Imag.38(6)(2016)384– MRIdenoisingbasedonsparsenessandself-similarity,Med.ImageAnal.16(1)
402. (2012)18–27.