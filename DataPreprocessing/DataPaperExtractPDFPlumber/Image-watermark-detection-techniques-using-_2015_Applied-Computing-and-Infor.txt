AppliedComputingandInformatics(2015)11,102–115
Saudi Computer Society, King Saud University
Applied Computing and Informatics
(http://computer.org.sa)
www.ksu.edu.sa
www.sciencedirect.com
ORIGINAL ARTICLE
Image watermark detection techniques
using quadtrees
Nidaa A. Abbas
SoftwareDept.,CollegeofIT–UniversityofBabylon,Iraq
Received11November2013;revised22July2014;accepted31July2014
Availableonline 12August2014
KEYWORDS Abstract The quadtree,a hierarchicaldata structure forthe representation of
spatialinformationbasedontheprincipleofrecursivedecomposition,iswidely
CDMA;
DCT; usedindigitalimageprocessingandcomputergraphics.Thispaperdemonstrates
DWT; thedetectionofinvisiblewatermarkedimagesgeneratedbypopularwatermark-
LSB; ingtechniques,includingCDMA,DCT,DWT,andLeastSignificantBit(LSB)
Quadtreedecomposi- usingquadtree.Results corresponding totypical (512·512)pixel imagesshow
tion; differencesamongthesemethodswhentheyareused.Eachtimeweusethesame
Subjectivemetrics image, the original images and invisible watermarked image to test the four
methodsinconjunctionwithquadtreedecomposition.Inadditiontothesubjec-
tivemethodrepresentedbyquadtree,manyobjective evaluationssuchasPear-
soncorrelation,meansquareerror(MSE),StructuralSIMilarityIndex(SSIM)
and false positive and false negative were used to give the comparison criteria
between original and watermarked images. In results, the quadtree decomposi-
tion considered a promise subjective method to recognize among these water-
marktechniques.
ª2014KingSaudUniversity.ProductionandhostingbyElsevierB.V.Allrights
reserved.
E-mailaddress:drnidaa_muhsin@ieee.org
PeerreviewunderresponsibilityofKingSaudUniversity.
Production and hosting by Elsevier
http://dx.doi.org/10.1016/j.aci.2014.07.003
2210-8327ª2014KingSaudUniversity.ProductionandhostingbyElsevierB.V.Allrightsreserved.Imagewatermark detectiontechniques 103
1. Introduction
Digital image watermarking has attracted the attention of many researchers over
the past decade. The motivation behind this work is the achievement of informa-
tionsecurity,informationconcealment,authentication,andfingerprinting.Several
approachestodigitalimagewatermarkinghavebeenproposed,oneofwhichisthe
discrete wavelet transform (DWT). The DWT has become highly popular in the
field of watermarking due to its ability to decompose available images into sub-
bands in which watermarks can be embedded selectively. There are many pub-
lished studies on this approach and its combination with other approaches, such
as quadtrees, DCT, and CDMA approaches. A semi-blind algorithm proposed
[4] that embeds a binary sequence watermark into significant wavelet coefficients
using quadtree decomposition. A random location table is used to identify the
coefficient in which the watermark bit is embedded. In [12], an algorithm for digi-
tal watermarking based on the discrete cosine transform (DCT) and the discrete
wavelet transform (DWT) was presented. Mistry [13] provides a comparison (in
terms of spatial and frequency domains) of digital watermarking methods includ-
ing the LSB, the DCT, and the DWT. Copyright protection is an important issue
inthefieldofwatermarking.InSatyanarayanaMurtyandRajeshKumar[17],the
authors presented a hybrid watermark scheme using DWT, DCT, and SVD. In
Gunjal[7],acomprehensiveoverviewofdigitalimagewatermarkingwasprovided
through performance evaluation metrics such as PSNR and correlation factors.
Abdallah et al. [1] applied blind image watermarking using wavelets that required
neithertheoriginalimagenoranyadditionalinformationforwatermarkrecovery.
In the medical field [3] combined reversible watermarking with CDMADWT and
CDMA-sp, in a study of three security properties (integrity, authenticity and con-
fidentiality)ofmedicaldataandpatientinformation.Khalili[9]proposedasecure
and robust cryptographic CDMA watermark algorithm with DWT, YIQ color
space, and the Arnold transform against JPEG compression and various noise
attacks.Digitalmediacontentprotectionandcopyrightprotectionwerediscussed
in Sharma and Prashar [18] with regard to DWT.
Many papers deal with the direction of objective metrics, few of them concen-
trated on the subjective metric especially for invisible watermark.
The most accurate tests of accuracy and quality are subjective tests involving
thehumanobservers.Thosetestshavebeendevelopedbypsychophysics,scientific
disciplines, which aim to identify the relationship between the physical world and
people’s subjective experience of this world. An accepted measure for evaluation
of the level of distortion is a Just Noticeable Difference (JND), and it represents
alevelofdistortionthatcanbeperceivedin50%ofexperimentaltrials.OneJND
thus represents a minimum distortion that is generally perceptible [15]. Survey of
watermarking techniques and applications was given in Muharemagic and Furht
[15]. Marini et al. [11] proposed to use a Double Stimulus Impairment Scale
(DSIS) protocol. In this protocol, the original and the watermarked images are104 N.A.Abbas
presented explicitly to the observer. The observer is asked to rate the impairments
on a scale of five categories: imperceptible corresponding to score 5, perceptible
but not annoying/score 4, slightly annoying/score 3, annoying/score 2 and very
annoying/score 1.
These subjective tests can provide very accurate measure of perceptibility of an
embedded watermark. However, they can be very expensive to administer, they
are not easily repeatable, and they cannot be automated.
The quadtrees have many applications such as image segmentation, data
smoothing, edge enhancement and image compression [19,20,10,8,2].
Quadtree decompositionis usedin this paper as ananalytical technique to sub-
divideanimageintoblocksthataremorehomogeneousthantheimageitself.This
technique reveals information about the structure of the image. We use this data
structure to examine differences among watermarking methods such as DWT,
DCT, LSB, and CDMA in relation to watermark insertion.
This paper is organized as follows: Section 2 provides an overview of related
theories. Section 3 presents the subjective and objective performance evaluation.
Section 4 depicts the proposed system. In Section 5, we present experimental
results and a discussion of the proposed system. Finally, Section 6 concludes the
paper.
2. Related theories
2.1. Code division multiple access (CDMA)
CDMA is an application of a direct sequence spread spectrum. Its purpose is to
combine multiple signals that, despite overlapping in both time and frequency,
remain separable. This separability is achieved by projecting individual messages
onto near-orthogonal PN sequences prior to carrier modulation. The number of
simultaneoususersinthesystemdictatesthechoiceofaparticularsequence.Max-
imallength,Kasami,andGoldsequenceshavebeenwidelyusedformanyreasons.
For example, m-sequences provide the longest period but do not offer as many
orthogonal choices as the other two do [14].
Spreadspectrum(SS)watermarkingisaccomplishedbyembeddingeverywater-
markbitovermanysamplesofthecoverimageusingamodulatedpseudo-random
spreading sequence. SS watermark embedding is analyzed mathematically as
follows:
2.1.1. Watermark insertion
Let B denote the string of binary-valued watermark bits as a sequence of N bits.
B ¼ fb ;b ;b ;...;bg; b 2 f1; 0g: ð1Þ
1 2 3 i iImagewatermark detectiontechniques 105
If I denotes the image block of length L (i.e., image transformation coefficients
of length L), a binary-valued code pattern of length M is used to spread each
watermark bit. Therefore, a set P of N code patterns, each of length M, is gener-
ated to form watermark sequence W through the following operation.
N
X
½W (cid:2) ¼ b½P (cid:2) ð2Þ
M i M i
i¼1
The watermarked image I is obtained by embedding watermark information
w
W into image block I. The data embedding operation can be mathematically
expressed as follows:
½ðI Þ (cid:2) ¼ ½I (cid:2)þa(cid:3)½W (cid:2) ð3Þ
W M M M
Here, a is the modulation index, and its properchoice will optimize the maximum
amount of allowed distortion and minimum necessary watermark energy for reli-
abledetection.amayormaynotbeafunctionofimagecoefficients.Accordingly,
SS watermarking schemes can be categorized as signal adaptive or non-adaptive
[5].
2.2. Discrete wavelet transform
The fundamental idea of the discrete wavelet transform (DWT) in image process-
ing is to decompose the image into sub-images of different spatial domains and
independent frequency districts. Next, the coefficient of the sub-image is trans-
formed. After the original image has been DWT-transformed, it is decomposed
into four frequency districts: one low-frequency district (LL) and three high-
frequency districts (LH, HL, and HH). If information from the low-frequency
district is DWT-transformed, information about the sub-level frequency district
can be obtained. A two-dimensional image after three iterations of DWT decom-
positionisshowninFig.1,whereLrepresentsthelow-passfilterandHrepresents
the high-pass filter [18,21].
An original image can be decomposed into frequency districts HL1, LH1, and
HH1. The information from the low-frequency district also can be decomposed
LL3 HL3
HL2
LH3 HH3
HL1
LH2 HH2
LH1 HH1
Figure1 ImageafterDWTdecomposition.106 N.A.Abbas
into sub-level frequency districts LL2, HL2, LH2, and HH2. Thus, the original
image can be decomposed for n level wavelet transformation.
2.2.1. Watermark insertion
The original image and the watermark are first decomposed using the wavelet
pyramid structure. Next, the wavelet coefficients (W ) of the low-resolution rep-
W
resentation of the watermark (W) are embedded in the largest wavelet coefficients
(I )ofthelow-resolutionrepresentationoftheoriginalimage(I),withlasascal-
W
ing parameter, as follows:
I0 ¼ I ð1þlW Þ ð4Þ
W W W
2.3. Discrete cosine transform
Resembling the discrete Fourier transform (DFT) in character, the discrete cosine
transform(DCT)turnsovertheedgeoftheimagetotransformtheimageintothe
form of an even function. The DCT is one of the most commonly used linear
transformationsindigitalsignalprocesstechnology[12].Thetwo-dimensionaldis-
crete cosine transform (2D-DCT) is defined as follows:
XN(cid:4)1 XN(cid:4)1 (cid:2) ð2xþ1Þup(cid:3) (cid:2) ð2yþ1Þvp(cid:3)
Cðu;vÞ ¼ aðuÞaðvÞ fðx;yÞcos cos ð5Þ
2N 2N
x¼0y¼0
The corresponding inverse transformation (2D-IDCT) is defined as follows:
XN(cid:4)1 XN(cid:4)1 (cid:2) ð2xþ1Þup(cid:3) (cid:2) ð2yþ1Þvp(cid:3)
fðx;yÞ ¼ aðuÞaðvÞCðu;vÞcos cos ð6Þ
2N 2N
x¼0y¼0
Here,Cis theDC-transformedblock, fistheinverseDCTblock, andu=0,1, 2,
...,K(cid:4)1,v=0,1,2,...,L(cid:4)1;KandLarethelengthandbreadthoftheimage;
a(u) and a(v) are defined in the following equation.
8 8
<p1 ffi Kffiffi; u ¼ 0 <p1 ffi Lffiffi; v ¼ 0
aðuÞ ¼ qffiffiffiffiffi ; aðvÞ ¼ qffiffiffiffiffi
: 2; 1 6 u 6 K(cid:4)1 : 2; 1 6 v 6 L(cid:4)1
K L
Not only can the 2D-DCT concentrate the information contained in the origi-
nal image into the smallest low-frequency coefficient, it can also minimize the
imageblockingeffectto achievea goodcompromisebetween thedemandsof cen-
tralizing information and computing complications. Thus, the 2D-DCT is widely
applied in compression coding.
2.3.1. Watermark insertion
The embedding process is implemented in the following three steps:Imagewatermark detectiontechniques 107
Step 1: The original image is transformed into the DCT domain to calculate
DCT components using (5):
Step 2: The watermark is embedded in n higher-magnitude coefficients in the
transform matrix, excluding the DC component. This step ensures that the
watermark is embedded in the most significant perceptual components of the
image. A watermark embedded in the less significant components may be
destroyedbycompressionorotherattacks.WhenthewatermarkX(n)isembed-
dedintoDCTcomponentsC(u,v)toobtainnewwatermarkedDCTcoefficients
C*(u,v), we specify a scaling parameter a that determines the extent to which
X(n) alters C(u,v), as shown in the following equation:
Cðu;vÞ(cid:5) ¼ Cðu;vÞ½1þaXðnÞ(cid:2) ð7Þ
Step 3: n modified DCT components C*(u,v) are reinserted, and the inverse
DCT transform is taken to obtain the watermarked image I*(u,v) [6].
2.4. Least Significant Bit (LSB)
LSB coding is one of the earliest used methods in watermarking and steganogra-
phy. It can be applied to any form of watermarking. In this method, the LSB of
the carrier signal is substituted with the watermark. The bits are embedded in a
sequencethatactsasthekey.Toretrievethesignal,thissequencemustbeknown.
The watermark encoder first selects a subset of pixel values in which the water-
mark must be embedded. Then, the watermark information is embedded on the
LSBs of the pixels from this subset. While LSB coding is a very simple technique,
the robustness of the watermark tends to be insufficient. When using LSB coding,
it is usually impossible to retrieve the watermark without noise [13].
2.4.1. Watermark insertion
Procedure for Invisible Watermarking (Least Significant Bit Watermarking). A
raw bitmap image ‘A’ is selected from the set of standard test images. Let this
be the base image onto which the watermark will be added.
(1) A raw bitmap image ‘B’ is selected from the set of standardtest images. This
is the watermark image to be added to the base image.
(2) The most significant bit (MSB) of the watermark image ‘B’ is read and writ-
ten onto the Least Significant Bit (LSB) of the base image ‘A’.
Thus,‘A’iswatermarkedwith‘B’,resultinginacombinedimage‘C’. Thus,‘C’
now contains an image ‘A’ that has its LSBs replaced with the MSBs of ‘B’. The108 N.A.Abbas
LSB is a form of the spatial domain technique. This technique is used to add an
invisible or visible watermark to an image.
3. Performance evaluation
This section demonstrates the subjective and objective performance evaluation.
3.1. Quadtree for the detection of watermarking techniques (QT)
A natural gray-level image usually can be divided into differently sized regions
withvariableamountsofdetailsandinformation.Suchsegmentationoftheimage
is useful for the efficient coding of image data. QT decomposition is a powerful
technique that divides the image into 2-D homogeneous regions, thereby produc-
ing the segmentation.
The decomposition builds a tree. Each tree node has four children and is asso-
ciated with a uniquely defined region of the image. The root of the tree is associ-
ated with the entire image [19].
A quadtree representing a picture is a tree in which successively deeper levels
represent successively finer subdivisions of picture areas. Each node represents
thequadrantofitsparent.Thetreeisfilledthroughtheprocessofrecursivelysub-
dividinganimagematrixintofourquadrantsuntilaquadrantisonesolidcolor.A
quadtreeis atree with nodesthatareeither leavesorhavefourchildren. The chil-
dren are ordered: 1, 2, 3, and 4.
3.1.1. Quadtree types
Quadtrees may be classified based on the type of data they represent, including
areas, points, lines and curves. Quadtrees may also be classified by whether the
shapeofthetreeisindependentoftheorderinwhichthedataareprocessed.Some
common types of quadtrees are:
(1) Theregionquadtree:Theregionquadtreerepresentsapartitionofspaceinto
two dimensions that decomposes a region into four equal quadrants, sub-
quadrants,andsoon.Eachleafnodecontainsdatacorrespondingtoaspeci-
fic subregion. Each node in the tree has either exactly four children or no
children (a leaf node).
The region quadtree is not strictly a ‘tree’ (more precisely, ‘trees’) because the
positions of subdivisions are independent of the data. A region quadtree with a
depthofnmaybeusedtorepresentanimageof2n·2npixels,witheachpixelval-
ued 0 or 1. The root node represents the entire image region. If the pixels in any
region are not entirely 0s or 1s, that region is subdivided.
In thisapplication, eachleaf noderepresents a blockof pixelsthatare all 0s or
all 1s. A region quadtreemay also be used as a variable resolution representation
of a data field. In this paper, the region quadtree is assumed.Imagewatermark detectiontechniques 109
(2) Point quadtree: The point quadtree is an adaptation of a binary tree used to
represent two-dimensional point data. It shares the features of all quadtrees
butisatruetreebecausethecenterofasubdivisionisalwaysonapoint.The
shape of the tree depends on the order in which the data are processed. The
point quadtree is typically very efficient at comparing two-dimensional
ordered data points, usually operating in O(log n) time.
Therefore, a node contains the following information:
(cid:6)Four pointers: quad [‘NW’], quad [‘NE’], quad [‘SW’], and quad [‘SE’].
(cid:6)A point that, in turn, contains:
(cid:4) A key, usually expressed as x and y coordinates.
(cid:4) A value, e.g., a name.
(1) Edgequadtree:Edgequadtreesarespecificallyusedto storelinesrather than
points.Curvesareapproximatedbysubdividingcells untilaveryfine resolu-
tion is reached. This procedure can result in extremely unbalanced trees,
whichmaydefeatthepurposeofindexing.Fig.2demonstratesthedecompo-
sition of an image [20,10].
The sparse matrix is used to save the data of quadtree decomposition. If S is a
sparse matrix, S(m, n) has the value of the block size at the location (m, n) such
that only non-zero elements are given as {(mn), value}.
3.2. Objective performance evaluation
3.2.1. Pearson correlation coefficient
Pearson’s correlation coefficient, r, is widely used in statistical analysis, pattern
recognition, and image processing. Applications include comparing two images
for the purposes of image registration, object recognition, and disparity measure-
ment. For monochrome digital images, the Pearson correlation coefficient is
defined as [16]:
Figure2 Imageanditsquadtree.110 N.A.Abbas
P
ðx (cid:4)x Þðy (cid:4)y Þ
r ¼ i i m i m ð8Þ
rffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi
qffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi
P ðx (cid:4)x Þ2 P ðy (cid:4)y Þ2
i i m i i m
wherex istheintensityoftheithpixelinimage1,y istheintensityoftheithpixel
i i
in image 2, x is the mean intensity of image 1, and y is the mean intensity of
m m
image 2.
The correlation coefficient has the value r=1 if the two images are absolutely
identical, r=0 if they are completely uncorrelated, and r=(cid:4)1 if they are com-
pletely anti-correlated, for example, if one image is the negative of the other.
3.2.2. The Structural SIMilarity Index (SSIM)
SSIM index is a method for measuring the similarity between two images. Struc-
tural information is the idea that the pixels have strong inter-dependencies espe-
cially when they are spatially close. These dependencies carry important
informationaboutthestructureoftheobjectsinthevisualscene.TheSSIMmetric
iscalculatedonvariouswindowsofanimage. Themeasurebetweentwo windows
x and y of common size N·N is [22]:
ð2l l þc Þð2r þc Þ
SSIMðx;yÞ ¼ x y 1 xy 2 ð9Þ
ðl2 þl2þc Þðr2 þr2þc Þ
x y 1 x y 2
wherel andl aretheaverageofxandy,respectively,r2 andr2 arethevariance
x y x y
of x and y respectively, and r is the covariance of x and y. c =(k L)2 and
xy 1 1
c =(k L)2 are two variables to stabilize the division with weak denominator, L
2 2
is the dynamic range of the pixel-values (typically this is 2#bits per pixel(cid:4)1), and
k =0.01 and k =0.03. The resultant SSIM index is a decimal value between
1 2
(cid:4)1 and 1, and value 1 is only reachable in the case of two identical sets of data.
3.2.3. Mean square error (MSE)
The MSE is the expected value of the squared error
1 XM XN
MSE ¼ ½Iðx;yÞ(cid:4)I0ðx;yÞ(cid:2)2 ð10Þ
MN
y¼1x¼1
where I(x,y) is the original image, I0(x,y) is the approximated version and (M,N)
are the dimensions of the images. A lower value for MSE means less error.
3.2.4. Confusion matrix
This matrix provides a quantitative performance representation for each classifier
intermsofclassrecognitionordetection.Valuesalongthemaindiagonalgivethe
total number of correct classifications for each class. Values other than those on
the main diagonal represent classification errors.Imagewatermark detectiontechniques 111
4. Proposed system for detection of watermarking techniques
The proposed system was implemented on a Dell Laptop (Windows 7, Processor
Core 2 Duo and 2.00GB RAM) using MATLAB. In this section, we describe a
detection system using a quadtree. Fig. 3 is a conceptual diagram of the proposed
system.
The system operates on the basis of the steps below:
1. Read a gray BMP-type image S.
2. Read a black and white image for use as the watermark w (the watermark
image, 50·20).
3. Embed the image using CDMA, DWT, DCT, and LSB techniques.
4. Performance Evaluation which is divided into two criteria, subjective and
objective.
4.1. Run a quadtree for each technique individually as subjective criterion.
4.1.1. The quadtree divides a square image into four equal-sized square
blocks.
4.1.2.Eachblockistestedagainstaspecifiedcriterionofhomogeneity(the
quadtree is based on the successive subdivision of a bound image array
into four equal-size quadrants. If the array does not consist entirely of
1s (black) or entirely of 0s (white), then it is subdivided into quadrants,
subquadrants, and so on, until blocks are obtained that consists entirely
of 1s or entirely of 0s; that is, each block is entirely contained in the
region or entirely disjoint from it).
4.1.3. If a block meets the criterion.
(cid:6) It is not further divided.
(cid:6) If it does not meet the criterion, it is further subdivided into four
blocks; go to 4.1.3.
Embedding Techniques
Quadtree Quadtree
Original CDMA Decomposition Decomposition
Image S
DWT P Ee vrf ao lr um ata in oc ne ESu vb aj le uc ati tv ioe
n
P fol ro t
e
ath ce
h
d tee cc ho nm iqp uo es ition
DCT
Watermark
Image w LSB
Confusion Matrix Tables
of
Pearson Correlation Result
MSE
Objective
Evaluation SSIM
Figure3 Theproposedsystem.112 N.A.Abbas
4.2. Plot the quadtree decomposition for each watermarking technique.
4.3. Plot the quadtree decomposition for the original image.
4.4. Compare the results of the two plots.
5. Objective Evaluation.
5.1. Pearson correlation.
5.2. MSE.
5.3. SSIM.
5.4. Confusion matrix.
5. Experimental results
This section presents the results of the implementation of different watermark
techniques. Fig. 4 shows the original images (512·512 in size) used in the experi-
ment and the black and white watermark image (50·20 in size).
In experimental results, we want to show the difference between the common
original image (like Lena) and if this image was watermarked with another image
using four distinct watermark techniques CDMA, DWT, DCT, and LSB. Quad-
treedecompositionisasubjectivemethodtoreveal thedifferencebetweentheori-
ginal and the watermark images using the histogram.
The quadtree decomposition of distinct images was illustrated using original
images like Lena, Alaine, Boat and House (see Supplementary Figs. S1–S4).
We examine the quadtree decomposition as subjective metrics with compare
withoriginalsimageswhichshowthedifferencebetweenthehistogramfordistinct
watermark techniques: CDMA, DWT, DCT, and LSB (see Supplementary
Figs. S1–S4).
In accordance with the histograms of subjective evaluation using quadtree, the
metric should provide a quantitative evaluation of watermark image techniques
that conform to subjective assessment which are given in Tables 1–4.
Table 1 presents the results for SSIM between original and watermarked
images. The result shows that the compare between original images are identical.
It also is observed from the comparison of the original image with watermarked
images that there fluctuate depending on methods that used to image watermark-
Lena Alaine Boat House
a. The original images (512 × 512)
b. The watermark image (50 × 20)
Figure4 Originalandwatermarkimage.Imagewatermark detectiontechniques 113
Table1 StructuralSIMilarityindex(SSIM)betweenoriginalandwatermarkedimages.
Originalimage DCT DWT CDMA LSB
Lena(originalimage) 1 0.86 0.66 0.77 0.99
Alaine(originalimage) 1 0.86 0.66 0.77 0.99
Boat(originalimage) 1 0.86 0.66 0.77 0.99
House(originalimage) 1 0.86 0.66 0.77 0.99
Table2 Correlationbetweenoriginalandwatermarkedimages.
Originalimage DCT DWT CDMA LSB
Lena(originalimage) 1 0.993 0.976 0.987 0.999
Alaine(originalimage) 1 0.993 0.976 0.987 0.999
Boat(originalimage) 1 0.993 0.976 0.987 0.999
House(originalimage) 1 0.993 0.976 0.988 0.999
Table3 Meansquareerror(MSE)betweenoriginalandwatermarkedimages.
Originalimage DCT DWT CDMA LSB
Lena(originalimage) 0 27.4 105.2 52.4 0.4
Alaine(originalimage) 0 27.2 105.1 52.4 0.4
Boat(originalimage) 0 27.8 104.2 52.4 0.4
House(originalimage) 0 27.1 105.1 52.4 0.4
ing with nearly equal to the values resulting from each method, suggesting a way
to differentiate from other. Table 2 gives the resultant of the correlation between
the original images and the watermarked images. The results seen for the same
images show that the output correlation is equal to 1, which means that the two
images are identical. As mentioned earlier in SSIM index, there is variation in
the results of each method of image watermarking. Table 3 shows MSE results,
which indicate no error between the same images. A lower value for MSE means
less error as noted in the LSB method.
Dependingontheresultsoftheseassessments,anothercomparisonbetweenthe
original images and watermarked images achieved in Table 4 through the confu-
sion matrixand the SupplementaryFig. S5 usingthe falsepositive andfalse nega-
tive. The confusion matrix is given in Table 4; numbers shown in bold font are
correct classifications.
Results were evaluated from the confusion matrices to calculate percentage
accuracy measurements for each classification.
All tested images used watermarked images. Note that the results reported in
Supplementary Fig. S5 show that the false negative decreases as false positive
increases. Fortunately, this action reduces the chance of false negative conditions
which occurs when a watermark detector fails to detect a watermark.114 N.A.Abbas
Table4 ConfusionmatrixforLenaoriginalimageandwatermarkembeddingmethods.
6. Conclusion
Inthiswork,wehavepresentedquadtreedecompositionasasubjectivemetricand
objectivemetricsbasedonSSIM,MSE,Pearsoncorrelationandfalsepositiveand
falsenegative.Wetesteditsperformanceinthecontextoffourdistinctwatermark
techniques: CDMA, DWT, DCT, and LSB. Quadtree is usually used in segmen-
tation process; in this paper, we benefit of quadtree decomposition to recognize
the method of image watermark.The results reveal differences between the water-
marked image and the original image across the four techniques; this was con-
firmed by the results of the quantitative evaluation. This research demonstrates
the effectiveness of the quadtree as a detector of watermarked images and shows
the differences in the performance of various techniques.
Appendix A. Supplementary material
Supplementary data associated with this article can be found, in the online ver-
sion, at http://dx.doi.org/10.1016/j.aci.2014.07.003.
References
[1] H.A.Abdallah,M.M.Hadhoud,A.A.Shaalan,F.E.AbdEl-samie,Blindwavelet-basedimagewatermark-
ing,Int.J.SignalProcess.ImageProcess.PatternRecogn.4(1)(2011).
[2] X. Bai, Y. Zhang, F. Zhou, B. Xue, Quadtree-based multi-focus image fusion using a weighted
focusmeasure,InformationFusion22(2015)105–118.Imagewatermark detectiontechniques 115
[3] S. Bekkouche, A. Chouarfia, A new watermarking approach based on combination of reversible
watermarkingandCDMAinspatialandDWTdomain,Int.J.Sec.5(1)(2011).
[4] H.-S. Chu, A. Batgerel, C.-K. An, A semi-blind digital watermarking scheme based on the triplet of
significantwaveletcoefficients,J.Elect.Eng.Technol.4(4)(2009)552–558.
[5] T.S. Das, A.K. Sau, S.K. Sarkar, Spread Spectrum Image Watermarking for Secured Multimedia Data
Communication,WorldAcademyofScience,EngineeringandTechnology,2007.
[6] P.Dhar,M.Khan,S.Chowdhury,Anefficientimagewatermarkingsystembasedonerrorcorrectingcodes
inDCTdomain,MISTJ.3(2011).
[7] L.B.Gunjal, An overviewof transformdomain robustdigital image watermarking algorithms,J. Emerg.
TrendsComput.Inf.Sci.2(1)(2010).
[8] Q.Han,R.Zhang,W.-K.Cham,Y.Liu,Quadtree-basednon-localKuan’sfilteringinvideocompression,J.
VisualCommun.ImageRepresent.25(2014)1044–1055.
[9] M.Khalili,AsecureandrobustCDMAdigitalimagewatermarkingalgorithmbasedonDWT2YIQcolor
spaceandARNOLDtransform,SignalImageProcess.:Int.J.(SIPIJ)2(2)(2011).
[10] A.Kumar,Imagerotationusingquadtree,J.Eng.Comp.Appl.Sci.(JEC&AS)1(1)(2012).
[11] E.Marini, F. Autrusseau,P. Le Callet,P. Campisi,Evaluation ofstandardwatermarkingtechniques, in:
Proc.SPIE6505,Security,Steganography,andWatermarkingofMultimedia,2007.
[12] J.Mei,S.Li,X.Tan,AdigitalwatermarkingalgorithmbasedonDCTandDWT,in:Proceedingsofthe
2009InternationalSymposiumonWebInformationSystemsandApplications(WISA’09),Nanchang,PR
China,May22–24,2009,pp.104–107.
[13] D.Mistry,Comparisonofdigitalwatermarkingmethods,Int.J.Comp.Sci.Eng.2(9)(2010).
[14] B.G. Mobasseri, Exploring CDMA for watermarking of digital video, in: Proc. SPIE, Security and
WatermarkingofMultimediaContents,vol.3657,1999,pp.96–102.
[15] E. Muharemagic, B. Furht, Survey of watermarking techniques and applications, in: Multimedia
WatermarkingTechniquesandApplications,AuerbachPublications,2006(Chapter3).
[16] J.Rodgers,W.AlanNicewander,Thirteenwaystolookatthecorrelationcoefficient,Am.Stat.1(42)(1988)
59–66.
[17] P.SatyanarayanaMurty,P.RajeshKumar,RobustdigitalimagewatermarkingschemeusinghybridDWT-
DCT-SVDtechnique,Int.J.Comp.Sci.Netw.Sec.10(10)(2010).
[18] C.Sharma,D.Prashar,DWTbasedrobusttechniqueofwatermarkingappliedondigitalimages,Int.J.Soft
Comput.Eng.(IJSCE)2(2)(2012).
[19] E. Shusterman, M. Feder, Image compression via improved quadtree decomposition algorithms, IEEE
Trans.ImageProcess.3(2)(1994).
[20] G.J.Sullivan,R.L.Baker,Efficientquadtreecodingofimagesandvideo,IEEETrans.ImageProcess.3(3)
(1994).
[21] D.Taskovski,S.Bogdanova,M.Bogdanov,Digitalwatermarkinginwaveletdomain,in:FirstIEEEBalkan
ConferenceonSignalProcessing,Communication,Circuits,andSystems,2000.
[22] Z. Wang, A.C. Bovik, H.R. Sheikh, E.P. Simoncelli, Image quality assessment: from error visibility to
structuralsimilarity,IEEETrans.ImageProcess.13(4)(2004).