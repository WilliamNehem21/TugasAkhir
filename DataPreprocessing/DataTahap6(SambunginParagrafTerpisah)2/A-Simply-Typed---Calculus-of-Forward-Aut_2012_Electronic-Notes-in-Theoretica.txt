Automatic differentiation (AD) is a powerful technique for computing derivatives of functions given by programs in programming languages [6]. AD is superior to di- vided differences because AD-generated derivative values are free of approximation errors, and superior to symbolic differentiation because it can handle code of very high complexity and because it gives strong computational complexity guarantees. There exist many AD systems 3 (in the form of libraries and code pre-processors). A majority of these AD systems are built on top of imperative programming lan- guages (Fortran, C/C++), whereas the idea of AD is most naturally embodied in a functional programming language. Indeed, the differentiation operator is almost a paradigmatic example of a higher-order function. However, despite a huge body of research 4 and proliferation of AD implementations, a clear semantics of AD in the presence of first-class functions is lacking, which inhibits the incorporation of AD into functional programming. Siskind and Pearlmutter [12] discuss the problems one faces trying to extend a functional programming language with AD operators. In particular, they emphasize the subtleties of AD of higher-order functions. They

Siskind, J. M. and B. A. Pearlmutter, Using polyvariant union-free flow analysis to compile a higher- order functional-programming language with a first-class derivative operator to efficient Fortran- like code, Technical Report TR-ECE-08-01, School of Electrical and Computer Engineering, Purdue University, West Lafayette, IN, USA (2008).

