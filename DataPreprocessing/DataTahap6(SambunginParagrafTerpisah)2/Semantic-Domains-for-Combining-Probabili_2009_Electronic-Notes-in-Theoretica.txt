We present domain-theoretic models that support both probabilistic and nondeterministic choice. In [36], Morgan and McIver developed an ad hoc semantics for a simple imperative language with both probabilistic and nondeterministic choice operators over a discrete state space, using domain-theoretic tools. We present a model also using domain theory in the sense of D.S. Scott (see e.g. [15]), but built over quite general continuous domains instead of discrete state spaces.

uous domain is Lawson-compact. Extending slightly a recent result from [3], we now know that the extended probabilistic powerdomain is Lawson-compact over any stably locally compact space. For continuous domains the converse also holds. This allows us in particular to include infinite discrete spaces. We have included these new results in section 2.2.

There have also been some terminological changes. For the classical powerdo- mains we now speak of the lower, upper, and convex powerdomains instead of the Hoare, Smyth, and Plotkin ones. Accordingly, for the new powerdomains we speak of the convex lower, convex upper, and biconvex powercones, rather than the convex Hoare, convex Smyth, and convex Plotkin powercones.

An important problem in domain theory is the modelling of non-deterministic features of programming languages and of parallel features treated in a non-determini- stic way. If a non-deterministic program runs several times with the same input, it may produce different outputs. To describe this behaviour, powerdomains were introduced by Plotkin [40,41] and Smyth [52]. A powerdomain over a domain X is a subset of the power set of X. Which subsets of X constitute the powerdomain depends on the kind of non-determinism that is be modelled. There are three classi- cal powerdomain constructions, called the convex, upper, and lower powerdomains, often referred to as Plotkin, Smyth, and Hoare powerdomains.

Continuous d-cones are the focus of Chapter 2. These are continuous domains which carry the structure of a cone in such a way that addition and scalar multipli- cation are Scott-continuous. The following examples of continuous d-cones will be investigated: the non-negative extended real numbers, the extended probabilistic powerdomain over a continuous domain, the cone of lower semicontinuous functions on a core compact space with values in the non-negative extended real numbers, and products of continuous d-cones. We will see that continuous d-cones are always locally convex, in the sense that each point has a neighbourhood basis of Scott-open convex sets (the notion of convexity is that of convex sets in real vector spaces and has to be distinguished from order-convexity). Sometimes, the hypothesis of an additive way-below relation is useful. We will show that this property is satisfied in all of the above examples with one restriction: The d-cone of lower semicontinuous functions has an additive way-below relation if and only if the underlying space is coherent. We will also give a brief exposition on the relation between continuous valuations and Borel measures.

In Chapter 3, Hahn-Banach type theorems for continuous d-cones will be proved. We begin by proving a Sandwich Theorem. From this we obtain Separation Theo- rems. Since continuous d-cones are locally convex, the Separation Theorems imply that the Scott-continuous linear functionals separate the points on a continuous d-cone. The Strict Separation Theorems will be needed for the convex upper and biconvex powercones. Another application of the Separation Theorem will be indi- cated in the Conclusion: in connection with semantics it can be used to show that a special map between two models is injective. Extension Theorems are another type of Hahn-Banach Theorems. We will prove a typical extension theorem for continuous d-cones with an additive way-below relation.

Chapter 4 introduces Hoare, Smyth and Plotkin style constructions for con- tinuous d-cones with the intention to apply them to the extended probabilistic powerdomain. However, the constructions are feasable and more transparent in the general setting of continuous d-cones. First, we modify the topological characterisa- tion of the lower powerdomain by taking only those non-empty Scott-closed subsets which are also convex. This allows us to lift addition and scalar multiplication in such a way that we obtain a d-cone again, called the convex lower powercone. In addition, binary suprema exist in the convex lower powercone and the convex lower powercone is shown to be universal in this context.

For any topological space X we denote the collection of open sets by O(X). Ordered by set inclusion, this gives a complete lattice. Especially, directed suprema exist and O(X) itself can be viewed as a topological space with the Scott topology.

It is another property of sober spaces that the specialisation order yields a dcpo, with the original topology being coarser than the Scott topology. However, a dcpo with the Scott topology is not always sober [22]. In the next section we introduce special dcpos, called continuous domains, which are always sober spaces with respect to the Scott topology [31].

Proposition 1.8 ([15, Proposition VI-6.8, Proposition VI-6.11]) Let X be a stably compact space. With respect to the patch topology and the specialisation order, X becomes a compact pospace; the patch-open upper sets are precisely the open sets for the original topology. Conversely, let X be a compact pospace. With respect to the topology U(X) of open upper sets, X becomes a stably compact space the patch topology of which is the original compact topology on X.

By the above, a Lawson-compact continuous domain becomes a compact pospace when endowed with the Lawson topology. Its Lawson-open upper sets are precisely the Scott-open sets and its Lawson-closed upper sets are precisely the Scott-compact saturated sets. In Section 4.3 we will apply Lemma 1.7 to reduce an order-convex Lawson-compact subset to its lower part, which is Scott-closed, and its upper part, which is compact saturated with respect to the Scott topology. Another important fact from [33] is

Most continuous domains that occur in semantics are coherent. Thus, it will not be a great restriction, if we restrict ourselves to Lawson-compact continuous domains in section 4.3. But there are exceptions. The following is an example of locally compact sober space which is not coherent. It is also an example of a continuous domain that is not Lawson-compact.

The concept of a directed complete ordered cone (d-cone, for short) will be intro- duced in this chapter. As these objects are not yet familiar in domain theory, we do so at a leisurely pace. We take some care in developing their properties, and we also study some classes of examples.

It is straightforward to see that direct products of (continuous) d-cones are again (continuous) d-cones. Other examples are the extended probabilistic power domain, the space of lower semicontinuous functions and the dual d-cone. We postpone the definition and a more detailed discussion of these examples first examining some general properties of d-cones.

Clearly, addition of subsets is associative, commutative, and the singleton zero set is a neutral element. Scalar multiplication satisfies all the cone axioms except that (r +s)P /= rP +sP in general. Indeed, let C = R+ and P = {1, 2}, then 2P = {2, 4} but P + P = {2, 3, 4}, whence 2P /= P + P . The situation changes, when we pass to convex subsets:

In this section we present some results on the relation between valuations and classical measures. Indeed, for the spaces we deal with here a continuous valuation can always be extended to a Borel measure. The results collected in this section are not used later; however, a reader who is more familiar with measure theory may find them helpful.

Using this characterisation of the way-below relation we can show that addition preserves the way below relation between the simple valuations of a continuous domain X. In a second step, we prove that this is sufficient for the way-below relation on T(X) to be additive. Let us remark, that the simple valuations are closed under addition. Thus, it makes sense to restrict our problem to this subset of T(X).

Proof. The main reason for this is that the way-below relation on simple valuations can be characterized by the Splitting Lemma as a transport problem. The disjoint union of two of these transport problems corresponds to the sum of the simple valuations. Thus the sums are also way-below each other whenever the summands are pairwise way-below. Formally, we can write the proof like this: Let

Proposition 2.25 Let X be a topological space. Then the set of lower semicon- tinuous functions L(X) with pointwise addition, scalar multiplication and order is a d-cone. If X is core compact, then L(X) is a continuous d-cone and the simple functions form a basis.

take X = [0, 1] with the usual Hausdorff topology. Then the Lebesque measure restricted to the open sets is a continuous valuation which cannot be approximated from below. On the other hand, there exist plenty of continuous d-cones for which the dual cone is also continuous. Thus, an interesting question remains to find a characterisation of those continuous d-cones whose dual cone is continuous.

However, core compactness is not sufficient to obtain an additive way-below relation on the function space. Recall from section 1.5 that a topological space is called stably locally compact if it is sober and locally compact and if the intersection of any two compact saturated subsets is compact.

arises: What does the dual cone of an arbitrary continuous d-cone look like? We do not even yet know if in general any linear continuous functional exists besides the constantly zero function. It seems to be appropriate to restrict this investigation to continuous d-cones, since they are locally convex by Lemma 2.5, and we know from classical functional analysis that Hahn-Banach Theorems yield especially nice results for locally convex topological vector spaces.

Corollary 3.9 Let C be a continuous d-cone. Suppose that K is a Scott-compact convex set and that A is a nonempty Scott-closed convex set disjoint from K. Then they can be separated by a convex Scott-open set; that is, there is a convex Scott-open set V including K and disjoint from A.

Remark 3.10 The strict separation theorem and its proof still go through with the weaker assumption that K is compact in the weak topology, as in the proof one has a covering by sets open in that topology. In this connection, note too that the conclusion of Corollary 3.9 can be strengthened, as the Scott-open set produced is even open in the weak topology.

A topological characterisation of the classical convex powerdomain is known for Lawson-compact continuous domains X. In this case the convex powerdomain (also called Plotkin powerdomain) Pc(X) consists of the nonempty Lawson-compact order-convex subsets with the Egli-Milner order. Union of subsets followed by order- convex closure gives an extra binary semilattice operation. As before, we will modify this characterisation to make it fit within the context of d-cones.

Proof. From 4.29 we know that every finitely generated convex lense k(F ) in P(C) is the supremum of a directed family of finitely generated convex lenses k(G)  EM k(F ). In order to show that the finitely generated convex lenses form a basis ad that P(C) is continuous, it suffices to prove that any convex lens L is the supremum (in the Egli-Milner order) of a directed family of finitely generated convex lenses.

Proof. First, we show that the way-below relation is additive on a basis. Let k(G1)  EM k(F1) and k(G2)  EM k(F2), where G1, F1 and G2, F2 are chosen as in Lemma 4.29 Using additivity of the way-below relation on C, one sees that G1 + G2 and F1 + F2 witness (c) For fixed F , the sets k(G) with G finite and k(G)  EM k(F ) form a directed family in P(L) for the Egli-Milner ordering. By (b), the corresponding elements  G form a directed family in L bounded above by  F . We now restrict our attention to the finite sets G obtained by selecting exactly one element bi   ai for each i.

By Lemma 4.35(b), rL is well-defined and order preserving on the collection of finitely generated lenses k(F ), which form a basis of the biconvex powercone P(L). By Lemma 4.35(c), the map rL is Scott-continuous on this basis. By Proposition 1.5 there is a unique Scott-continuous extension of rL to all of P(L) defined by

Theorem 4.38 Let X be a topological space. Then HT(X) is a d-cone, even a complete lattice, where binary suprema distribute over addition and scalar multipli- cation. If X is a continuous domain, then HT(X) is a continuous d-cone, even a continuous lattice, with an additive way-below relation.

Now, we look at the denotation of non-deterministic choice. If we start with two programs P and P ' whose denotations at x are singletons, then the denotation of P H P ' at x will be the line segment connecting P )(x) and P ')(x). Obviously, this is a convex set. In general, P H P ')(x) has to contain all convex combinations are. Finally, one has to form the Lawson-compact hull of these convex combinations to obtain P H P ')(x); this set is also convex. The procedure we just described is exactly the one used to define formal union at the beginning of section 4.3.1.

Note that one can also give a semantics using either of the other two powercones (by taking the lower or upper closure of the denotations given as sets of valuations as above). Addition and scalar multiplication would be calculated within HT(X) and ST(X), respectively, to define the denotation of probabilistic choice; formal union would be replaced by suprema in the convex lower powercone and by infima in the convex upper powercone to define the denotation of non-deterministic choice; and one would use the universal properties given in Theorem 4.39 and Theorem 4.41 to (This follows by combining the information following 4.37 and 2.11, where we apply the universal properties established in these two theorems to the special case of the reals.) Note that wp(r)(f )(x) and wlp(r)(f ) are the lower and upper boundary points of this interval, respectively, as

