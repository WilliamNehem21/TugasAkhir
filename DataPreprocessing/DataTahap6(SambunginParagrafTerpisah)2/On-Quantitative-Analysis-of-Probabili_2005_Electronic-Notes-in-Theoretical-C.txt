We advocate the use of approximate noninterference for the security analysis of probabilistic proto- cols. Our approach relies on a formalisation of the protocol in the setting of a probabilistic process algebra and a notion of process similarity based on weak probabilistic bisimulation. We illustrate this approach by presenting the analysis of a probabilistic nonrepudiation protocol which allows us to quantitatively estimate its fairness degree.

Probabilities are introduced by adding probabilistic information to the algebraic operators. The probabilistic model we adopt [7] is a mixture of the generative and reactive approaches of [11]. In particular, we assume the internal and output actions behaving as generative actions, i.e. the system autonomously decides, on the basis of a probability distribution, which inter- nal/output action will be executed and how to behave after such an event. On the other hand, we assume the input actions behaving as reactive actions, i.e. the system reacts internally to the action type, say a, chosen by the envi- ronment. Then, the choice of the reactive action of type a to be executed is performed on the basis of a probability distribution associated with the reac-

tive actions of type a the system can perform. In practice, we see the input actions as underspecified, since their execution is guided by the environment behaviour. The mixed generative-reactive model allows for a representation of both probabilistic behaviours guided by probability distributions decided by the system and nondeterministic behaviours due to the possible interactions of the system with the environment (see, e.g., [6] for more details).

In the rest of the paper, we denote by G the set of finite state, guarded, and closed terms [15], called processes, generated by the syntax above. Moreover, we assume p = 1 in the case parameter p of a probabilistic operator is omitted. Now, we briefly introduce the semantics of the calculus [4]. To this pur- pose, we introduce the following notation: RAct and GAct denote the sets of input actions and of output and internal actions, respectively; we use the ab- the system and the environment. Low can perform low-level activities only and is not allowed to directly observe the occurrence of high-level events. In our setting, what Low can see is not only the logical low-level behaviour of the system, but also the probability distribution of each low-level activity. Despite of the absence of a direct communication channel from High to Low, High may succeed in altering the low-level view of the system, thus passing information to Low, by interacting with the high-level interface of the system. In the following we describe a formalisation of noninterference, where High is considered to be an adversary that tries to maximise the information leakage from High to Low.

action prefix operators within P . Then, the application of the security check to P is as follows. The view of P without high-level operations is modeled by P \High. The low-level view of P in the presence of high-level interactions

As far as the security guarantees are concerned, each message conveys a timestamp, which is used to determine the freshness of the message and to protect the parties against replication attacks. The nonrepudiation of origin is guaranteed by the messages Sign O ({M }k, O, R, t) and SignO(k, O, R, t), and the nonrepudiation of receipt is given by the last message Sign R(ackn). If the protocol terminates after the delivery of Sign R(ackn), both parties obtain their expected information and the protocol is fair. If the protocol terminates before the transmission of SignO (k, O, R, t), then neither O nor R obtain any valuable information, so that the fairness is preserved. However, at each step R could try to verify whether M can be obtained by employing the last key received from O and, once the correct key k is received, violate the fairness of the protocol by blocking the transmission of the last ack. Hence, key to success of the protocol is the immediacy in sending back the ack. Under such a condition, if the transmission of an ack is delayed by R, then O can detect this unfair strategy and prematurely stop the protocol. To this aim, the choice of the encryption algorithm must be in such a way that the decryption of the ciphertext takes more time than the transmission of an ack. Hence, O decides a deadline for the reception of each ack, after which, if the ack is not received, the protocol is stopped. Finally, we observe that such a protocol is exposed to the attack of a malicious recipient that tries to randomly guess the number of protocol steps and block the final ack. In fact, as we will see, this is the kind

The protocol described in Section 3.1 guarantees nonrepudiation of origin with probability 1 and nonrepudiation of recipient with a probability less than 1. Hence, our goal is to estimate the probability of violating the nonrepudiation of recipient. In order to determine the effectiveness of the most powerful adversary strategy against the originator, we model and analyse the behaviour of the originator and we consider the recipient as a potential adversary.

