The evolution of reputation is one of the most profound and irreversible changes in peer-to-peer (P2P) systems [5,17]. Peers with different motivations and mali- cious behavior can cause harm in such systems. This implies that mechanisms to manage interactions on the basis of trust are fundamental and are integral part of the success of any online community [3,19]. Reputation systems are widely used in the literature to assess the trustworthiness of a given peer. A reputation system retrieves, filters, and evaluates the received recommendations about the past be- havior of a given peer. The derived reputation score is used to help peers decide whether a future interaction with a given peer is conceivable or not. Recommen- dation retrieval provides the input to the reputation system, while the filtering and evaluation components process the input.

In order to retrieve recommendations, recommenders have to be selected and the recommendations have to be collected from these selected recommenders. In selecting the recommenders and collecting the recommendations, the objective is to obtain as much first hand information as possible with minimum cost. Once the recommendations are received, the objective of the filtering component is to avoid undesirable recommenders. Contacting undesirable recommenders will result in waste of bandwidth and processing power as well as polluting the reputation system. Undesirable recommenders include dishonest recommenders, inactive recommenders that give stale recommendation, or unwilling recommenders that do not even reply. The filtering component feeds back the recommendation retrieval component so that the reputation system will contact only honest, active, and willing recommenders. In the evaluation stage, the recommendations: (a) can be adjusted to improve the accuracy of the recommendations [5], (b) are assigned weights indicating the importance of the recommendation, and (c) are aggregated in order to come up with the derived reputation score. If the score vouches that the interaction with the given peer is conceivable, then the interaction can take place. Afterwards, the

On the other hand, identity-based approaches relate the recommender selection to the identities of the recommenders or to the identity of the source peer or the target peer. A source peer may choose to ask recommendations only from certain recommenders, for example from those who are considered to be honest. This approach does not result in global reputation value by design. The objective is to get recommendations only from desirable recommenders. Aiming for global reputation, peers may also be selected as recommenders if they have interacted with the target peer. Thus, the selected recommenders would vary depending on the identity of the target peer.

Distance-based selection approaches are practically the main choice in systems using completely unstructured networks. In those systems, such as Gnutella, peers do not have the routing information to reach other peers. Hence, there is no guarantee for a peer to be able to contact another peer efficiently. This method is used in [4,11]. An identity-based approach is proposed in [5] using a recommender set. The set only changes if a recommender is found to be dishonest. A similar approach is used in [12] to search for negative feedbacks about another peer. The recommender set consists of peers that are considered trustworthy by the source peer. Another

Flooding is used in completely unstructured networks as in [4]. Communication is conducted by sending messages to directly connected peers. The messages are then forwarded to other peers until a certain limit is reached in order to avoid infinite loops. Similar method is used in [11], but it builds different overlay networks for different contexts.

The effectiveness metrics are adopted from information retrieval [6]. Using only recall or precision can give the wrong picture about the performance of recommen- dation retrieval. Perfect recall can be achieved by simply contacting all peers, but it would lower the precision. For precision, perfect performance can be obtained by contacting a single witness, but recall would be low if there are more other wit- nesses. Therefore, F-measure combines both metrics into a single value giving the same importance to both precision and recall. Perfect F-measure is only achievable with perfect precision and recall. We also evaluate the cost of recommendation re- trieval mechanism. This cost is measured as the number of messages sent to other peers and the number of replies, i.e., the messages needed for the recommendations to reach the source peer.

We introduce the term acquaintance rate (AR), which is the average probability that one peer knows another. Higher acquaintance rate means a peer has had transactions with more peers. In the simulation, we assume that the acquaintance rate is the same for all peers. The value ranges from 0 (every peer has no transactions with others) to 1 (every peer has had transactions with all other peers). The transaction matrix is generated randomly based on the acquaintance rate.

In simulating flooding, we build the unstructured overlay network using two algo- rithms. Algorithm 1 is based on the construction described in [21]. It results in multiple islands instead of forcing all peers to form a single network. For the simulation, we only take the largest island which in average consists of about 75% of the total peers. For example, the largest island in one of the generated networks using 1024 peers has 784 peers with diameter 17 and 57.82% peers are reachable with TTL = 7.

Comparing the overlay network construction using Algorithm 1 to the obser- vation of Gnutella network in [18], the portion of peers reachable with TTL = 7 for the largest island is less than 60% whereas in [18], it was more than 95%. The difference is due to the construction of the overlay network. In Gnutella network observed in [18], new peers would contact some predefined nodes to get the list of connected peers. This mechanism results in peers connecting to more highly con- nected peers and the overlay network would have relatively small diameter. On the other hand, Algorithm 1 pairs peers randomly.

In order to simulate the environment observed in [18], we develop Algorithm 2 to construct the overlay network. The maximum number of connections is based on the average connections observed in [18]. In the pairing (Step 2 and Step 4a), no peer can be connected to itself and a maximum nodal degree is imposed. Step 3 ensures that all peers have at least one connection. This algorithm connects all peers into a single island and keeps the diameter relatively small compared to Algorithm 1. In one of the generated networks using the second algorithm with 1024 peers, there is only one island with diameter 11 and 99.29% peers are reachable with TTL = 7. Compared to Algorithm 1, Algorithm 2 generates an overlay network with a smaller diameter and higher reachability with TTL = 7.

to the acquaintance rate and relatively similar for all the methods with RT1 and RT2 performing slightly better at some points. The precision in RT1 and RT2 is slightly higher that flooding at high acquaintance rates because in some instances, the recommendations are found earlier, resulting in higher precision and affecting the average precision. P-Grid behaves differently from flooding and recommenda- tion tree because it uses the storage peer approach. The precision in P-Grid is approximately the ratio between the number of witnesses and the number of hops plus the number of witnesses because individual recommendations are returned.

Unstructured overlay network, on the other hand, is simple and has been im- plemented widely in peer-to-peer environments. It enables nodes with various ca- pabilities to participate in the network, although not providing the most efficient performance. Recommendation tree using BFS shows interesting results as an al- ternative to flooding. It even surpasses the retrieval performance of flooding at low acquaintance rates with lower communication cost. In a peer-to-peer network, acquaintance rate starts at 0 and increases as peers start to transact. On the other hand, acquaintance rate decreases as more new peers are joining and old peer are leaving. Hence, it is less likely for a peer to know or be known by more than 60% of other peers in a large and active network.

In order to benefit from recommendation tree, however, the overlay network has to be constructed based on the recommender set. Using recommendation tree in a structured overlay network without directly connecting each peer to its recom- menders would increase the number of messages by a factor of log n. The commu- nication cost would be worse to apply recommendation tree in a pure unstructured network without adjusting the overlay network to the recommender set. This elim- inates the benefit of recommendation tree over flooding.

Our simulation also shows the significant impact of overlay network construction. Both FL1 and FL2 use flooding, so their performance has similar pattern, but with significantly different values. A network with a small diameter as in FL2 has better performance. Another important issue is how to traverse the overlay network. This is shown by RT2, which has significantly less number of replies compared to RT1 due to using BFS, instead of DFS.

Recommendation retrieval is an important component of a reputation system as the results of this step would be the main ingredients for recommendation-based reputation systems. This component also contributes significantly to the cost of the reputation system due to the communication cost. Therefore, the measurement of this component is critical in evaluating a reputation system.

We evaluated the effectiveness of recommendation retrieval by measuring the re- call and precision. We found that the recall is 100% for structured overlay networks, whereas this is not true for unstructured overlay network. For flooding, recall is constant and depends on the construction of the overlay network. For recommen- dation tree, recall is inversely proportional to the acquaintance rate. On the other hand, we found that precision is highly correlated with the acquaintance rate except in structured overlay networks using storage peers, where a source peer does not need to contact all other peers in retrieving recommendations.

network using storage peer, where the storage peer aggregates the recommenda- tions and replies with the derived reputation score. On the other hand, the average number of sent messages is constant for structured overlay networks. For unstruc- tured overlay networks using flooding, the number of sent messages is constant and depends on the TTL and the nodal degree. For unstructured overlay networks us- ing recommendation tree, the number of sent messages is highly correlated with the acquaintance rate.

In the future work, recommendation retrieval in different overlay networks needs to be studied in detail. We have not covered unstructured network with hierarchy. Further experiments need to be conducted to incorporate churn rate especially in structured overlay networks. Also, we need to see the relationship between opti- mizing the overlay network for recommendation retrieval and other topology opti- mization approaches such as location aware topology proposed in [13].

