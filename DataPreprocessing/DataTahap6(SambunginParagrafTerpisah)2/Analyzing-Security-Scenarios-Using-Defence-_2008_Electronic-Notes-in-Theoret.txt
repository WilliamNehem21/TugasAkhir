In order to represent preferences among possible countermeasures of a given attack, defence trees are enriched with conditional preferences, obtaining a new structure called CP-defence tree. In this paper we transform a CP-defence tree with preferences among attacks and countermeasures in an Answer Set Optimization (ASO) program. The ASO program, representing the overall scenario, is a special composition of the programs associated to each branch of a CP-defence tree. We describe an implementation that select the best set of countermeasure able to mitigate all the vulnerabilities by computing the optimal answer set of the corresponding ASO program.

The preference among countermeasures and the dependency between attacks and countermeasures are modelled by an answer set optimization (ASO) [5] program. The and and or composition of the branch is then obtained by a syntactic com- position of the ASO programs, whose semantics completely respects the intended meaning given in [3]. The semantics of the obtained ASO program provides a set of ordered answer sets representing the ordered sets of countermeasure to be adopted. In order to deal with ordered attacks (from the more to the less dangerous), the model is extended by introducing a corresponding rank (meta-preferences) among the preference rules of an ASO program. The use of ranked ASO programs avoids the problem of cycle; in fact, the introduction of meta-preferences gives precedence to the adoption of countermeasures covering the more dangerous of the attacks (and removing in this way the possibility to obtain a cycle).

is a new order (DX , >X). The order is defined over the set DX , whose elements C1, ..., Cn are the sets of countermeasures covering all the attacks u1, ...uk, and >X is defined as follows: the set C is preferred to the set C' if there is a permutation

This paper discusses the use of ASO programs to represent CP-defense trees, and to reason about them. The ASO approach uses preference rules in order to express the preference relations among the combinations of atoms and introduces the preference order among these rules. The ASO semantics gives simple and an intuitive way for modelling a CP-defence tree and is expressive enough to formulate preferences over countermeasures w.r.t. attacks. Moreover, it resolves cycles owing to the conflicting partial orderings in complex CP-nets, which the earlier approach using CP-nets could not easily handle [3]. The methodology proposed is tested with a small but real example and implemented using the CPdt-Solver.

An alternative way consists in the use of CR-Prolog [1], a knowledge represen- tation language based on the answer set semantic enriched with the introduction of consistency-restoring rules (cr-rules). CR-Prolog and ASO implementation are si- milar, both can be used for our goal. We prefer the latter one because in CR-Prolog we can specify a preference order among cr-rules but not among atoms.

