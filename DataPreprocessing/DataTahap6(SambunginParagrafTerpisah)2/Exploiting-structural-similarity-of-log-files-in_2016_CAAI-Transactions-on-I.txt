With increasing deployment of Web services, the research on the dependability and availability of Web service composition becomes more and more active. Since unexpected faults of Web service composition may occur in different levels at runtime, log analysis as a typical data- driven approach for fault diagnosis is more applicable and scalable in various architectures. Considering the trend that more and more service logs are represented using XML or JSON format which has good flexibility and interoperability, fault classification problem of semi-structured logs is considered as a challenging issue in this area. However, most existing approaches focus on the log content analysis but ignore the structural information and lead to poor performance. To improve the accuracy of fault classification, we exploit structural similarity of log files and propose a similarity based Bayesian learning approach for semi-structured logs in this paper. Our solution estimates degrees of similarity among structural elements from heterogeneous log data, constructs combined Bayesian network (CBN), uses similarity based learning algorithm to compute probabilities in CBN, and classifies test log data into most probable fault categories based on the generated CBN. Experimental results show that our approach outperforms other learning approaches on structural log datasets.

In recent years, as a promising computing paradigm, service-oriented computing (SOC) [1] has changed the way of design, delivery and consumption of software applications. Web services technology aiming at implementing service ori- ented architecture has been widely applied to different areas for research or business purposes. Accordingly, more and more business functions are published as Web services (WS) by various organizations and companies. There are two main ap- proaches of developing Web services, including SOAP-based research work has focused on extending BPEL engine to enable composition of SOAP-based, RESTful and OSGi ser- vices [7]. Since there are more and more Web services (esp. RESTful Web services) used in practice, the complexity of Web service composition is becoming higher than before. For this reason, how to ensure dependability and availability is essential for Web service composition. To enhance the dependability of service flow execution, fault tolerant Web service orchestration [8] was proposed. As a critical aspect in fault tolerance framework, fault diagnosis aims at identifying or locating the causes with high probability to explain process exceptions and failures based on runtime information. Since most detailed running information in processes execution is recorded in log files, fault diagnosis by learning from log data is becoming an important issue in this area.

Currently, semi-structured data formats, including XML and JSON, are used as the standards of information repre- sentation on the Internet. Due to its good flexibility and interoperability, more and more log files of software running information are represented using the XML/JSON format, especially for Web services. Thus, it becomes a key topic of fault diagnosis research which focuses on analyzing semi- structured and XML/JSON like log. Generally, semi- structured documents have much richer structural informa- tion than flat ones, which has potential influence on classifi- cation accuracy. Taking this into account, the main task of learning from this kind of documents will have more chal- lenges than before. However, for most classification methods of log analysis, IR-based methods are commonly used ignoring a significant amount of structural information, which leads to low classification accuracy. Therefore, how to learn the structural information from the log has great impact on the accuracy of fault classification.

In this paper, we propose a similarity-based Bayesian learning approach for fault classification of semi-structured logs. Our method is to first estimate similarity degrees of structural ele- ments from heterogeneous log data. Then the basic structure of combined Bayesian network (CBN) is constructed, and the similarity-based learning algorithm is used to compute proba- bilities in CBN. Finally, test log data can be classified into most probable fault categories based on the generated CBN.

The rest of this paper is organized as follows. Section 2 in- troduces the related work concerning fault diagnosis of Web service composition and existing classification methods for (semi-)structured documents. Section 3 provides an overview of the similarity based structural classification approach and the CBN model. The details of CBN generation, including how to compute probabilities of CBN using similarity-based learning algorithm, are presented in Section 4. Experimental results of this approach compared to other learning approaches are shown in Section 5. Finally, Section 6 draws the conclusion.

substructures within XML documents. As a Bayesian learning approach of semi-structured data, our approach is similar to that given by Denoyer and Gallinari in methodology aspect. But they are different in nature, because their generative model only concerns the training data in identical logic structure, whereas our approach aims at constructing the CBN model based on log data in different structures from heterogeneous sources (which will be discussed later in detail).

In addition, there are other diagnosis mechanisms and frameworks for Web services. In Ref. [24], a self-healing plug- in for BPEL engine is presented, which can enhance the ability of a standard engine to provide process-based recovery ac- tions. It only provides the self-healing mechanism at infra- structure level without referring to diagnosis methods in detail. Ardissono et al. [8] proposed a framework for Web Service orchestration which employs diagnostic services to support a fine grained identification of exception causes.

As a data-driven approach, the task of fault diagnosis is to construct the generative model based on the training data from semi-structured log files, and then classify test log data into possible fault categories using this model. On account of the heterogeneity of log file sources in practice, it is a new chal- lenge to develop methods of learning from the semi-structured log data, which are similar in content but not identical in structure. For this reason, it is important to exploit the struc- tural information contained in XML/JSON documents for learning task. For sake of simplicity, we take XML log files as example in this paper. According to the classical representa- tion, an XML document can be considered as a tree in which each node represents a structural element. Given two XML log files generated by different service execution engines, the corresponding schema trees can be extracted from them, which often have similar content but slightly different struc- tures. In this paper, we extend our previous work [25] by proposing an efficient online learning algorithm for the dy- namic environment. Our main idea is to find the similarity between the nodes of these two trees, and then construct the generative model by learning from the training log data based on similarity degrees. Herein, we propose combined Bayesian network as a generative model for semi-structured log data, the probabilities of which depend on training data distribution of both corresponding elements and their counterparts with high similarity degrees.

differences, generating Bayesian network model from the training dataset is non-trivial. Herein, how to handle the similarity relation between schema elements of F0 and F1 can be taken as the key point. The objective of our approach is to generate the CBN by learning from all relevant data in training dataset based on quantified similarity.

Generally, each log file consists of a set of log data records, which will be labeled with related fault categories. These labeled log records constitute the training dataset. We asso- ciate a CBN model to each category of the training dataset. Since data records in same category may have different logical structures, a CBN is constructed by combining structural and content information of all data records in corresponding category. Then, the network parameters are learned from all training data records in this category. To realize fault diag- nosis, we classify test log data records into possible fault categories by performing inference in constructed CBNs.

In this section, we propose a similarity-based Bayesian learning approach for fault diagnosis. Firstly, we introduce how to estimate similarity degrees of schema elements for constructing combined Bayesian networks. Then, we present how to learn probabilities o CBNs in detail. Finally, we give the method of classifying log data records using CBNs for fault diagnosis in subsection 4.3. To illustrate this learning approach, we will continue to use the example given in Section 3.

Since the probabilities of CBNs depend on the distribution of both corresponding data and their similar counterparts in training dataset, we need to find the correspondences between the nodes of extracted schema trees. Consider the schema trees T0 and T1 in previous example. There are a number of nodes in T0 and T1 which have similar meaning but different names. In order to discover the correspondences between these nodes, we will exploit both textual and structural information of T0 and T1.

The task of finding consistency between similar elements of two schemas is often regarded as matching. In this subsection, we will estimate element similarity degrees by schema match- ing. As for the matching method, we have made a reference to the similarity flooding algorithm [26]. This algorithm takes two graphs (schemas, catalogs, or other data structures) as input, and produces a mapping between corresponding nodes of the graphs as output. Based on the similarity flooding algorithm, our method tries to find a mapping between corresponding nodes of the schema trees. Moreover, we utilize graded structural infor- mation in different stages, which can improve both of initial mapping accuracy and computation efficiency. In the matching process, we take T0 and T1 as input, and produce similarity de- grees between corresponding nodes of T0 and T1 as output. There are two steps in this process based on pairwise graph, including initial matching and similarity propagation. In initial matching, we additionally exploit the structural information in attribute level. Given two nodes m0 and n1 of T0 and T1 which has attribute sets Am and An respectively, we will match attributes of A and A as well as. names of m0 and n1. The computation formula is

where CSet(n) represents the set of tree nodes corresponding to node n (with the same name), and SimSet(l) denotes the set of nodes similar to a tree node l. As an important step in learning, the times of a specific node and its parent appearing in the record set will be counted. Herein, we use SimNum(r, p, q) to represent the similarity-based number of node q having node p as its parent for record r. We compute the value of SimNum(r, p, q) by the formula shown below

Based on the above computation formula, the dynamic similarity-based learning algorithm is shown below. The focus of the improved algorithm is the dynamical update of the dependency probabilities of the CBN model. In this algorithm, if an edge does not belong to the intersection of Gc andGc , its probability will be calculated based on the value of the simi- larity degree SDD.

Considering the dynamic nature of log data from realworld systems, we need to update the existing classification model to get accurate diagnosis in dynamic environment. Actually, the dependent information of existing CBN model may be inac- curate or incomplete when training data are changing. It re- quires dynamically updating the structure and dependency probabilities of the CBN model. To obtain a more accurate generation model, we dynamically update existing CBN model based on incremental training data, by (1) adding new nodes to current node set, (2) changing dependency between nodes, and (3) calculating the dependency probability for the updated dependency set.

Depending on new training data, we incrementally generate the classification model CBND for different categories. Then, for a specific category c, we dynamically update the probability set P of existing CBN0, based on the structure Gc and probability set Pc of newly constructed CBND. In this subsection, we propose the dynamic similarity-based learning algorithm, which can update the existing model and calculate its corresponding prob- abilities when new training data are arriving.

In this algorithm, according to the obtained similarity, we calculate the similarity degree SDD for different categories between nodes of new model CBND and the existing model CBN0. Herein, SDD(mD; n; c) denotes the similarity degree for category c between the node mD of new model CBND and the node n of current model CBN0. The corresponding formula is shown as follows.

By labeling the training log records from heterogeneous sources with related categories, fault diagnosis can be viewed as a classification problem for log records obtained in runtime. As mentioned above, we can achieve the goal of fault diag- nosis by classifying log data using the proposed generative model. According to this, the main approach of fault diagnosis is to first construct the combination part of CBNs by matching schema trees, then compute the probabilities of CBNs from training data based on estimated similarity degrees, and finally classify the newly obtained log data into possible fault cate- gories using generated CBNs.

In classification task, the CBN model plays a key role which is proposed as a generative model based on Bayesian networks. The log records in training dataset with the same category will share the parameters of a CBN. That is to say, there is a set of such parameters for each fault category. The similarity-based probabilities of the CBNs can improve the accuracy of the classification task. Then, the log records in testing dataset can be classified into possible fault categories, by calculating the probability that each category will generate the log data record. Given a category c and a test log record rtest, we can estimate the conditional probability by the formula

To evaluate our approach for fault classification of Web service flows, we have conducted experiment on both real and synthetic log datasets in this section. We compare the classi- fication results of our approach with those of other classifiers for semi-structured documents. Experimental results show our approach outperforms other two approaches in dynamic and heterogeneous environment.

Those algorithms for fault classification are implemented in Java, and runs on a Windows machine with a dual (2.4 GHz) core Intel processor. To show the advantage of our approach in classification task, we compare it with other classifiers designed for semistructured documents, including Bayesian network model (BN).

For simplicity, we use SBN and DSBN to represent original and improved similarity based learning algorithms respec- tively. Both of SBN and BN methods [22] achieve learning model updates learning from entire training datasets repeat- edly. In contrast, DSBN method is able to update its model incrementally in dynamic environment. Considering the dy- namic feature, we assume new training data appear at some

In this paper, we focus on fault diagnosis by analyzing semi-structured log data. By transforming fault diagnosis problem into classification problem, we can utilize the corre- sponding classification methods to diagnose faults. We pro- pose a similarity-based Bayesian learning approach for constructing combined Bayesian networks, which are used as generative model to classify fault related log data. Different from other approaches, it can learn from training data with different structural information. To realize fault diagnosis, our approach consists of three main steps: (1) estimate similarity degrees of structural elements from different log files, (2) construct the basic structure of CBNs by computing its prob- abilities using similarity-based learning algorithm, and (3) classify test log data into possible fault categories based on the generated CBNs.

As the first step, this paper presents our work in fault diag- nosis of Web service composition by analyzing log data, espe- cially in dynamic and heterogeneous environment. In the future, we will enlarge the size of log datasets from more real-world service flows. Moreover, we are to study on strategies and mechanisms for optimizing the trade-off between accuracy and efficiency of fault diagnosis for Web service composition.

This work is partially supported by National Basic Research Priorities Programme (No. 2013CB329502), Na- tional Natural Science Foundation of China (No. 61472468, 61502115), General Research Fund of Hong Kong (No. 417112), and Fundamental Research Funds for the Central Universities (No. 3262014T75, 3262015T20, 3262015T70, 3262016T31).

