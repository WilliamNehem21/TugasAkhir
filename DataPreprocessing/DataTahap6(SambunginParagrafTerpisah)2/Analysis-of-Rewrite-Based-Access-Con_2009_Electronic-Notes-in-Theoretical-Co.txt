Example 2.2 This example is taken from the NetFilter how-to 2 . Suppose an Internet user wants to set his firewall to block any traffic coming from the exterior to his local network. Since the interface associated to Internet connections is usually ppp0, a simple method is to reject all new packets coming from this source. In order to demonstrate the fact that it might be convenient for a policy to contain rules beyond those which directly compute decisions, we also give some additional rules which allow two different local computers to share the same external IP address: for each outgoing packet whose origin is a local machine, its head is rewritten to a single address.

The first rule says that packets concerning established connections have to be accepted. The second rule matches any packet whose origin is the local network, which are accepted. The third rule rejects any new packet coming from the exter- nal network (ppp0). The last two rules match the IP address of the local machines and rewrites them to a single IP address visible from the external network.

It is common to identify a rewrite system (i.e., a set of rewrite rules) with the abstract reduction system it generates (i.e., the set of all derivations allowed by R). To a rewrite system corresponds directly a unique abstract reduction system that can be seen as a generic way to describe the set of all derivations. The converse is not true since from a set of derivations, the generating rewrite system is not in general uniquely determined.

A strategy can be described by enumerating all its elements or more suitably by a strategy language. Various approaches have been followed, yielding slightly different strategy languages such as ELAN [30,8], Stratego [36], Tom [6,5] 3 or more recently Maude [9]. All these languages share the concern to provide abstract ways to express control of rule applications, by using reflexivity and the meta-level for Maude, or the notion of rewriting strategies for ELAN or Stratego. Strategies such as bottom-up, top-down or leftmost-innermost are higher-order features that describe how rewrite rules should be applied. Tom, ELAN and Stratego provide flexible and expressive strategy languages where high-level strategies are defined by combining low level primitives. We refer to [28] for more details on these strategy languages.

In the context of security policies that we want to consider here, a few strategies are of main interest: the strategy universal(R) represents all derivations generated by a set of rewrite rules R, innermost(R) represents derivations where rules of R are applied only on terms whose all strict subterms are irreducible. ordered(r1, ..., rk) represents derivations where rules r1, ..., rk are tried in this order on terms whose all strict subterms are irreducible. This last strategy corresponds to Innermost Priority rewriting (IP-rewriting for short) that is defined below.

Proof If t is normalized, t is indeed IP-normalized. Let us prove the converse by contraposition. If t is not in normal form, there exist an innermost position and a non empty set of rules that apply at this position. By choosing a rule with the higher-priority between them, we get an IP-rewriting step and t is not IP- normalized.

Considering innermost termination in particular, specific methods have been given for instance in [2,19,23]. Techniques have also been studied for termination of outermost rewriting [23], for termination of lazy rewriting [18] or for termination of priority rewriting [35,21]. Moreover it is often possible to prove termination in general (i.e. for the universal strategy), which implies termination under any strategy.

There is then one more branch in the narrowing tree leading to accept with the substitution (8)(x = 123.123.1.1,y = ppp0,z = new). A complete set of queries leading to the decision accept is given by the set of substitutions {(1), (2), (6), (7), (8)}.

Gnaedig, I., Termination of Priority Rewriting, in: A. Dediu, M. Ionescu and C. Martin-Vide, editors, Proceedings of the 3rd International Conference on Language and Automata Theory and Applications, Lecture Notes in Computer Science (2009), preliminary version published as HAL-INRIA Open Archive Number inria-00243131. Available at http://hal.inria.fr/inria-00243131/en/.

