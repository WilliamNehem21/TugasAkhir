We have used the proof assistant Abella for this task. Our choice is motivated simply by our familiarity with the tool. As of now, the encoding does not use any exclusive feature of Abella and can be reproduced in any other proof assistant supporting induction (we have also an implementation of the multiset library and some of the meta-theorems with proofs in Coq).

z, leaving us with the obligation plus z z z, which is easily proved by the first clause of plus. In the second case, we would obtain X = s X1 where X1 is a new variable for which we know is_nat X1. The goal now is plus (s X1) z (s X1), which we can unfold using the second clause of plus to reduce it to plus X1 z X1. Thus, we are left with the obligation of proving plus X1 z X1 from the assumption is_nat X1.

where the annotation @ indicates that its size is such that every *-annotated instance is strictly smaller. Unfolding the assumption is_nat X @ reduces its size strictly, so that in the case of its second definitional clause we get a new assumption is_nat X1 * (where X = s X1). This can now be fed to the IH to obtain plus X1 z X1, which is what we needed to finish the proof.

In this case, we want to induct using the lexicographic ordering of the sizes of is_nat X and is_nat Y, i.e., the inductive hypothesis may be used if the size of is_nat X is strictly smaller, or it stays the same and that of is_nat Y is strictly smaller. In Abella we write this using the following invocation: where ... in each case is exists K, is_nat K /\ ack X Y K. The hypothesis IH1 is familiar from before: it just means that is_nat X * is strictly smaller than is_nat X @. The hypothesis IH2, on the other hand, has is_nat Y ** which is strictly smaller than is_nat Y @@. This hypothesis also has an assumption is_nat

The proof of plus_is is by straightforward induction on plus X Y Z. Note that we could have sprinkled more is_nat conjuncts in the bodies of the definitional clauses, but the above choice is sufficient. We will opt to alter the natural definitional clauses as minimally as possible to yield the necessary inversion lemmas.

