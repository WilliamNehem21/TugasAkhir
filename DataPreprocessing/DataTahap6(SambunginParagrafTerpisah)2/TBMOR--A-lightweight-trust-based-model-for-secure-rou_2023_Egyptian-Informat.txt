Opportunistic networks are self-organizing dynamic networks that use the communication opportunities presented by node movement to enable data delivery. Due to the indirect nature of inter-node connec- tions and dynamic topology, opportunistic networks are vulnerable to malicious attacks, which poses a great challenge to their security. In this paper, we first propose a trust-based model for the secure routing of opportunistic networks (TBMOR), which incorporates forwarding positive degree (FP) and node activ- ity degree (NA) into the calculation of trust value, evaluates nodes in the network by a dynamic combi- nation of direct trust and indirect trust, and then optimizes the next node list using trust values and pruning strategies. Secondly, this paper extends the network life cycle by dynamically setting up energy thresholds to reduce network redundancy by dynamically partitioning the number of replicas using trust values.Simulation results show that compared to other routers, TBMOR can effectively resist malicious attacks, has a higher message delivery rate and lower transmission latency than other routers.

The rest of this paper is organized as follows. Some background and current research work conducted for OppNets routing and trust model are presented in Section 2. Section 3 presents the pro- posed TBMOR trust model and gives the algorithm flow. Section 4 introduces the routing forwarding strategy in detail and gives the algorithm flow. Section 5 contains three simulation experiments to explore the impact of packet lifetime, node caching, and mali- cious attacks on routing algorithms. Section 6 concludes the paper.

Copy-based routing increases the packet delivery rate by increasing the redundancy of packets in the network, and a typical routing algorithm is Epidemic [11]; Epidemic uses a flooding mechanism in the network, and the node-carrying packets will make a copy of its own packets and pass them out when it meets other nodes; this infinite copy method obviously improves the delivery rate and reduces the transmission delay, and at the same time, it also leads to the existence of a large number of redundant copies in the network, which results in the waste of network resources. Therefore, some scholars have proposed the opportunis- tic network routing Spray and Wait [12], which fixes the number of copies of each packet in the network and divides the packet deliv- ery process into two phases. In the spray phase, the node will make a copy of the packet every time it meets a new node and forward it to the new node; when the number of remaining copies of the packet is 1, the node carrying the packet will enter the wait phase, in which no copy of the packet will be generated and the node will not forward the packet until it encounters the destination node.

Active motion-based routing improves the delivery rate by introducing some nodes that can move actively in the network, and a typical routing algorithm is the Message Ferrying algorithm [13], which deploys a ferry node in the network. Ferry nodes move according to a predetermined schedule to improve packet delivery rates through proactive delivery. Due to the limited caching and energy of a single ferry node, the smaller network life cycle may occur in a more complex network. Ref. [14] proposed the form of multiple ferry nodes to improve network reliability and transmis- sion efficiency.

Utility-based routing introduces a utility function to evaluate the utility value of next-hop nodes, which avoids the blind delivery of packets. Prophet routing [15] improves the packet delivery rate by calculating the forwarding probability to predict the selection of next-hop nodes, so that packets can be delivered from low- probability nodes to high-probability nodes. Bubble Rap [16] divides the community and selects the nodes with the highest cur- rent community activity nodes with the highest community activ- ity for forwarding, thus improving the delivery rate.

In order to deal with the impact of malicious and private nodes on the security and stability of opportunistic network, many schol- ars have proposed different security solutions. Among them, cryp- tography and trust models are the most effective technologies to implement secure routing. However, the encryption mechanism is expensive and difficult to deploy in opportunistic networks. The trust model has become the focus of the research on the secure routing of opportunistic networks.

The earliest application of trust models in networks can be traced back to Beth et al. [17], who proposed calculating the trust of a node by computing the arithmetic mean of the recommended trust values provided by other nodes. In the model, which has been heavily cited by researchers today, they divided trust into direct trust and indirect trust.

Waleed et al. [22] proposed a prediction-based trust model that uses historical behavior to predict the future behavior of nodes, and experiments show that the model performs well even in highly congested networks. A trust model based on node behavior was proposed by Su et al. [23]. The trust model uses pruning and filter- ing mechanisms to remove malicious suggestions, and a dynamic weight calculation method is used to combine direct and indirect trust in calculating the integrated trust value, which can filter low-trust nodes in the network. Then, a trust model-based oppor- tunistic routing algorithm (BTOR) is proposed by combining ETX (expected transmission count) values and node trust values.

Samaneh et al. [24] proposed a secure architecture for oppor- tunistic network routing where nodes can decide to carry messages without knowledge of the sender, destination, and intermediate nodes. In the case when all nodes in the network are not real, the model proposes a trust structure, a collaborative approach, and a method for sharing public keys. In addition, a routing algo- rithm is introduced to select the best available nodes for forward- location privacy for all nodes and guarantees message confidential- ity and data integrity. This trust model can effectively resist selfish behavior and black hole attack attacks and can prevent Sybil attacks. However, the introduction of encryption methods in the trust model also intensifies the resource consumption of nodes.

significantly improve the delivery efficiency and reduce the net- work overhead. Bangotra et al. [26] proposed a trust-based secure intelligent opportunistic routing protocol (TBSIOP) that uses sin- cerity in forwarding data packets (Fs), sincerity in acknowledg- ment (ACKs), and energy depletion (Ed) as metrics for calculating trust values, and then uses the trust values to prevent malicious nodes from being selected as relays through a relay selection algo- rithm. Compared with other algorithms, this algorithm improves the network delivery rate and network lifetime.

This paper uses the ONE (opportunistic network environment) simulator to simulate TBMOR. The ONE simulator is a simulation tool based on Java environment specially developed for oppor- tunistic networks. The simulator provides a variety of movement models and report types, as well as many classical algorithms. In this paper, the Epidemic, Prophet and Spray and Wait algorithms are alternatively selected as control algorithms and compared with the TBMOR algorithm in the ONE simulator environment to verify the superiority of the TBMOR algorithm.

In this section, we will observe the performance of each routing in three scenarios. In the first scenario, we will set different mes- sage lifetime sizes to observe their impact on the routing protocol; the cache size largely determines the ability of a node to carry the number of packets. An algorithm that performs better with the same cache makes better use of the cache and has a greater ability to deliver packets. Therefore, in the second section, we will adjust the node cache size to analyze the impact of cache size on the per- formance of the routing protocol; in the last scenario, we will inject different numbers of point malicious nodes into the network to examine the impact of malicious attacks on the routing protocol and verify the effectiveness of TBMOR against malicious attacks.

is due to the fact that these two algorithms use a limited copy strategy, which results in much less packet redundancy in the net- work, thus allowing valid packets to be forwarded out in a timely manner, which also results in these two algorithms having a smal- ler overhead_ratio and hopcount_avg. The latency_avg of TBMOR is consistently the smallest of all algorithms and starts to level off at a node cache of 15 M, due to the fact that TBMOR more accurately selects the next node most likely to reach its destination. Although higher than Spray and Wait in terms of overhead_ratio and hop- count_avg, TBMOR significantly outperforms the Spray and Wait algorithm in terms of delivery_prob and latency_avg.

grows. Thus, it reduces the delivery_prob, so the routing over- head_ratio of both algorithms increases significantly at the TTL of 175 min. Although Spray and Wait is slightly better than TBMOR in terms of hopcount_avg and overhead_ratio, TBMOR is better than Spray and Wait in terms of delivery_prob and latency_avg.

