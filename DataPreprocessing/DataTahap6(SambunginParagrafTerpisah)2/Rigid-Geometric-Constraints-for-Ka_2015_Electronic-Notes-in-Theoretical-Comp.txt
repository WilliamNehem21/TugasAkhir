Due to their stability, molecules such as nucleic acids and proteins can be repre- sented as elementary molecular entities, or agents with an interface of sites through which they interact. In this context, sites may represent functional groups within molecules that are responsible for the interactions they participate in. Classic ex- amples are binding sites, phosphorilation sites, methylation sites, etc. In particu- lar, agents may form weak inter-molecular bonds between sites. These bonds are also called links and together with agents they define site graphs representing the network-topological structure of molecular complexes.

In rule-based modeling, reactions are replaced by rules. Unlike reactions, rules operate on patterns in the sub-structure of chemical species rather than on the species as a whole. A single rule can thereby capture a set of multiple chemical reactions, potentially even infinitely many. However, the above-mentioned rule- based languages do not offer direct support for describing the geometric structure of agents and their link structure in three-dimensional space. Hence, steric effects that constrain molecular interactions are not easily translated into rule-based languages, and it is not clear if it is always possible to do so.

In this paper we present geometrically enhanced Kappa, a minimalistic extension to the Kappa language. As in Kappa, chemical species are represented by site graphs and modified through site graph rewriting rules. In addition, our extension allows for the annotation of individual agents, sites and links, with radii, positions and orientations, respectively, which introduces implicit rigidity constraints on the corresponding site graphs. Rewrite rules may include updates to the geometric annotations of a site graph in order to capture conformational changes of a molecular complex.

Our extension is only concerned with geometric realizability or soundness of molecular complexes and not with modeling the evolution of their physical em- bedding in three-dimensional euclidean space. In particular, we do not track the absolute positions and orientations of agents and therefore can not handle diffusion or collision processes explicitly. Instead we retain the assumption of a well-stirred mixture from classical, geometry-less Kappa. In fact, our framework for geometri-

In [14] Gruenert et al. introduce an approach to simulating combinatorially complex chemical systems by combining a coarse-grained, particle-based spatial simulation with a rule-based language for triggering association and dissociation events be- tween particles. Unlike in our approach, the simulation not only handles steric constraints, but tracks and updates the positions of individual particles according to a combination of force field and diffusion terms that simulate the interactions between particles and their Brownian motion, respectively.

The rest of this paper is structured as follows: in section 2 we define geometrically enhanced Kappa and its stochastic semantics and outline a basic simulation algo- rithm. In section 3 we introduce the notion of locality, give examples of local and non-local Kappa models, show that locality is undecidable in general, and finally show how to reduce local models to geometry-less models. Section 4 contains some concluding remarks and outlines future work.

We will now introduce our extension to Kappa as a simple categorical language. The definitions given below are, for the most part, direct extensions of those given in [17] and [10]. The reader that is somewhat familiar with the Kappa language will recognize many of the concepts introduced here, such as contact graphs, site graphs and embeddings, as variations of those used in classic, geometry-less Kappa.

Another current limitation is that, while the possible realizations of site graphs may be computed in order to check their soundness, they remain inaccessible to the modeler. Indeed, they are not even kept track of in the current framework. Ex- tending the dynamics of the system to take the realization of its state into account might provide a way of modeling processes such as diffusion and compartmental- ization, which play a key role in certain biochemical processes. Combinations of the above are of course possible, and in general there is a spectrum of possible spa- tial extensions to Kappa, with geometry-less Kappa at one end, and coarse-grained molecular dynamics approaches, such as [14], at the other.

