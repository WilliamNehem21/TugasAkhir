We use a special operational semantics which helps us in predicting quantitative measures on systems describing cryptographic protocols: We also consider a possible attacker. The transitions of the system carry enhanced labels. We assign rates to transitions by only looking at these labels. We then map transition systems to Markov chains and evaluate performance of systems, using standard tools.

Actually, the attacker is a principal that does not play fair. According to the traditional Dolev-Yao [12] model, the attacker is supposed to have control over the communication network. It is therefore able to monitor the traffic and intercept a message, to create a new message, using parts of old ones, to inject new messages and to substitute its messages for legitimate ones. These actions can be easily modeled in a process algebraic framework.

The starting point of our approach is the narration of a specific protocol and of a documented attack to it. We detail the narration in the process algebra LySa [3], that makes it possible to specify the behaviour of both the legitimate participants and of the attacker in terms of processes running in parallel. The quantitative analysis applied on this specification gives us an estimate of the effort made by the attacker in this particular case.

The algorithm relies on a secret key K shared between a mobile station (MS), e.g. a laptop with a wireless card, and an Access Point (AP), i.e. a base station. This key, exchanged apart, is used to protect the body of a transmit- ted message M. On the net it will pass the corresponding ciphertext {M}K, together with the Initialization Vector v, as described below. To encrypt the message M, the sender proceeds as follows: poor packet integrity: the integrity checksum field used by WEP is imple- mented as a CRC-32 checksum. CRC is designed to detect random errors in a message, but it cannot prevent attacks. Therefore message integrity cannot be completely guaranteed: an encrypted message can be modified, without disrupting its checksum.

A couple of attacks follow that exploit the above vulnerabilities. It happens that neither involves disclosing the key. The first is an attack to the WLAN authentication protocol, a challenge-response protocol used by a mobile station to associate with an access point to authenticate itself.

Note that we do not fix the actual cost function: we only propose for it a possible set of parameters that reflect some features of a somewhat ideal- ized architecture and of a particular cryptosystem. Although very abstract, this suffices to make our point. A precise instantiation comes with the refine- ment steps from specification to implementations as soon as actual parameters become available.

Actually, the rate q(Ti, Tj) at which a system changes from behaving like process Ti to behaving like Tj is the sum of the single rates of all the possible transitions from Ti to Tj. Note that q(Ti, Tj) coincides with the off-diagonal element qij of the generator matrix of the CTMC, namely Q. Recall that a CTMC can be seen as a directed graph and that its matrix Q (apart from its diagonal) represents its adjacency matrix. Hence, hereafter we will use indistinguishably CTMC and its corresponding Q to denote a Markov chain. More formally, the entries of the generator matrix Q are defined as able to produce the same bit string that can be obtained by encrypting with the proper key, just by XOR-ing the collected information. Actually, we treat an abstraction of this action, i.e. we neither introduce an explicit construct for the XOR operation and nor we explicitly handle RC4(v, K). To illustrate this level of abstraction, we mimick the usual induction rules used to show the capabilities of the Dolev-Yao attacker, in terms of its knowledge K.

