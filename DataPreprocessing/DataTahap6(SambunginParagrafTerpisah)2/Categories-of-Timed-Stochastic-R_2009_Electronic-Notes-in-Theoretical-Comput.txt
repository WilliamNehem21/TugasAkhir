To model and program systems with soft constraints, we need languages to ex- press probability distributions over the delays experienced during the evolution of the system. PEPA [26] and the stochastic pi calculus [43] are two examples of languages that express this kind of stochastic temporal behavior. The semantics of these languages is operational, given in terms of a labelled probabilistic transi- tion system. The transition systems themselves denote continuous-time stochastic processes, often continuous-time Markov stochastic processes.

loops [32] extended with a deterministic delay operation. We call the resulting se- mantic models categories of M-timed stochastic relations TSRelM, extending the category SRel of stochastic relations commonly used to give semantics to proba- bilistic languages of while loops. In these categories, we draw a relationship between probabilistic choice and stochastic temporal behavior by showing that both are in fact derivable from a primitive that lets us sample probability distributions.

ISLwhile is the standard language of while loops, often called IMP [24,52]. To model while, we need a monad that imposes enough structure on its Kleisli category to support iteration. Following Manes and Arbib [35], we take this to mean that the Kleisli category should be partially additive.

Intuitively, a loop is the limit of the finite unrollings of its body. Partial ad- ditivity models this limiting process through an infinite summation operator on hom-sets. Partial additivity is the combination of a few simple structures (see [35]) but we present it as one large, aggregate definition that suffices for our purposes. The subtleties of this definition are less relevant to our goals than how it enables us to interpret loops, which we give below.

Two familiar examples of partially additive categories are the category Par of sets with partial functions and the category CPO of complete partial orders and con- tinuous functions. In Par, a family of partial functions is summable if and only if the functions are defined on mutually disjoint subsets of the domain, and the sum is the union of their graphs. Partial additivity in CPO is even more familiar: a family is summable if and only if it is a directed subset of the function space, and the sum is the least upper bound.

Deterministic delays are too simple to model systems with complex time behavior. A more expressive language would be able to represent the duration of complex computations stochastically by sampling delays from probability distributions. Here we consider a language with probabilistic delays and deterministic state behavior before moving to a fully probabilistic language in the next section.

and values in the monoid M, which we interpret as time delay. We can then read composition as: f ; g relates x to C if f relates x to y with delay a, g relates y to z with delay b, and z paired with the aggregate delay m(b, a) is in C. The probability that f ; g relates x to C is then the sum of the probabilities of each of these sufficient cases.

Several frameworks exist to describe and model stochastic temporal behavior, including queueing systems [30], stochastic automata [15,16], generalised stochastic petri-nets [36], and generalised semi-Markov processes [22]. Our approach shares much in common with stochastic automata. Roughly speaking, stochastic automata extend standard deterministic automata with clock variables, just like timed au- tomata [3]. Upon entering a state, some of those clocks are set by sampling a prob- ability distribution, and then all clocks decrement at the same rate. Transitions are labeled with an input symbol and a set of clocks, and a transition is enabled once its labeling clocks reach 0. Stochastic automata are usually interpreted us- ing a probabilistic transition system with two classes of states, states from which nondeterministic choices are made, and states from which probabilistic choices are made, the latter essentially corresponding to probabilistic delays. It is possible to view our work as a partial reframing of stochastic automata in a categorical setting, providing them with a direct transition semantics.

As far as languages for stochastic temporal behavior are concerned, much of the original impetus came from finding reasonable languages in which to composi- tionally and finitely represent models for the study of stochastic temporal behavior in systems with soft constraints. Stochastic process calculi, with their support for concurrency and their ready compositionality, have proved popular [23,43,26,8,27]. Stochastic process calculi, especially derived from the stochastic pi calculus [43], are especially popular for biological modeling [46,45,14,10,17]. In the tradition of process calculi, the semantics of those languages is operational, using an annotated reduction semantics that records the rate of reaction (which correspond, roughly, to the time delays introduced in the reduction). Stochastic process calculi generally use exponential distributions to model delays, and the reduction semantics can be shown to yield continuous-time Markov processes. Restricting to Markov processes implies that we can reason more efficiently about the resulting processes expressed in the stochastic pi calculus, or stochastic automata, for that matter; see, for in- stance, Bryans et al. [13]. Priami [44] shows how to extend the stochastic pi calculus to general distributions. Recently, Klin and Sassone [31] developed a general oper- ational reduction semantics for stochastic process calculi that unifies much of the ad hoc presentation in earlier papers. Our work is essentially denotational and can

Finally, we need to examine the relationship between our models and the more operational models used in the stochastic process calculus literature. A starting point is to use our categories or variants thereof to give a semantics to stochastic process calculi. We hope to report on this research in the near future.

