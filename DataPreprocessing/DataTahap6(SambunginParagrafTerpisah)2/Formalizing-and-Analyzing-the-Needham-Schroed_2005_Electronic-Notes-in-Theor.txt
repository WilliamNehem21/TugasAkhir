In [31] the strategy has been applied to the typical first case study of proto- col verification, i.e. the Needham-Schroeder Public-Key protocol [29] (NSPK for short), for reasoning about the authentication and secrecy properties. Our experimentation on both the insecure and the corrected versions of the NSPK has shown that the strategy is able to detect the attacks in the insecure version and derive that the properties hold for the corrected version of the NSPK.

The protocol must guarantee the secrecy and the freshness of KAB as follows: at the end of a protocol session, KAB should be known only to A, B and S, and A (resp. B) should believe that B (resp. A) has the same key KAB created by S in the current session of the protocol. If B accepts the message at step (5), then KAB has been sent by A in step (3) (authentication).

In fact, when defining the rewrite system RP , we have tried to single out some general guidelines to formalizing the protocol steps. They can be summarized as follows. The left hand side of the first rule is of the form goal(agt(a), agt(b), r(j)). The left hand side of a rule, whose root is mesg, satisfied. Moreover, by going up along the critical pairs we get to know which terms have been previously (in the completion process) recognized by the in- truder, thus getting some feedback on the error location. This strategy is similar to a rewriting strategy defined in [20,21] to deal with the problem of divergence of the completion process, where the bottom-up strategy allows one to compute the normal form of a term with respect to the infinite canonical rewrite system.

Inst is a parameter of the strategy and is built as follows. The terms that can instantiate the variables in the trs for the NSSK are constructed based on the function symbols in the given signature, the names of principals (the server and the agents with their labels), the numbers for denoting the intruders and the protocol runs. We are interested in the behaviour of two agents A and B, a server S and an intruder (represented by agt(0)) while running two protocol sessions, typically chosen as r(0) and r(s(0)). Thus, it is sufficient to take

We assume that the properties to be proved or disproved on a protocol are described by well-formed terms in the sense above. Moreover, during the expansion phase of the strategy, only well-formed terms will be considered and the non-well-formed ones will be cut out of the search space. This might be not enough for ensuring the termination of the expansion process (see, for example, the expansion process with the trs for the NSPK in [31]). The predicate of well-formedness is a parameter for the strategy: whenever other protocols and/or different properties are considered, the definition of the well- formedness of terms might have to be changed accordingly. For the insecure NSSK we give the following definition.

