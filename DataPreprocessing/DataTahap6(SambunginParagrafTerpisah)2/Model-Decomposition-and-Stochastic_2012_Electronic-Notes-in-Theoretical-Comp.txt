In this paper, we discuss a method for decomposition, abstraction and reconstruction of the stochastic semantics of rule-based systems with conserved number of agents. Abstraction is induced by counting fragments instead of the species, which are the standard entities of information in molecular signaling. The rule-set can be decomposed to smaller rule-sets, so that the fragment-based dynamics of the whole rule-set is exactly a composition of species-based dynamics of smaller rule-sets. The reconstruction of the transient species-based dynamics is possible for certain initial distributions. We show that, if all the rules in a rule set are reversible, the reconstruction of the species-based dynamics is always possible at the stationary distribution. We use a case study of colloidal aggregation to demonstrate that the method can reduce the state space exponentially with respect to the standard, species-based description.

Internal dependencies of multi-site post-translational modifications [22] and confor- mational changes [4,21] of signaling proteins reflect the rich internal logic of proteins. Since chemical kinetics [11] operates on states which are based on descriptions of full molecular complexes, often times a model becomes too complex to analyze. This calls for decomposition techniques, i.e. determining the effective dimension of the state-space. Authors in [2,5,7,9] proposed approaches where they first constructed a large state-space and then reduced it. In [14], we however took a bottom-up ap- proach and observed the effective degrees of freedom of each agent, denoted as agent

We start by encoding the rule-based models and assigning the stochastic seman- tics to it. In Section 2, we detail how to encode the rule-based models. In Section 3, we define the fragment-based abstraction, and how to decompose the rule set into smaller independent units. In Theorem 3.6, we demonstrate how these two frame- works relate. In Section 4, we use a model of colloidal aggregation, to demonstrate that the method can exponentially reduce the state space. Finally, in Section 5, we review the practical aspects of using the fragment-based abstraction. In particular, the probability distributions over the species-based system can be reconstructed from the fragment-based abstraction for certain initial distributions. We show in Theorem 5.2 that the reconstruction is applicable on a set of reversible rules, re- gardless of the initial distribution, because the underlying process is a non-explosive, irreducible CTMC with a stationary distribution.

The condition imposed for an abstraction to be valid is known in the literature as a form of weak lumpability [13], or uniform backward bisimulation. In Section 2.1, the ILTS assigned to a rule-based model is such that each state is interpreted by exactly one valuation of variables from Var . The lumped state [s] is interpreted by a union over interpretations of containing states.

The dynamics of a rule-based model is given by a set of rules. A classical chemical reaction consists of a left-hand-side (lhs), a right-hand-side (rhs), and a rate. The lhs is a set of reactants, which can transform to a set of products, and the transformation occurs at a velocity depending on the reaction rate. Similarly, the lhs and rhs of a rule are sets of agents with different values of sites in their interfaces.

Rules are defined over the set of variables Var . On the other hand, a reaction mixture is defined over the set of variables Var n. The application of a rule to a reaction mixture is formalized through a concept of agent identification.

The contact map is a site graph (V, E) with agent names A = {A} and site names S = {x, y}; Set of nodes is given by V = {(A, {x, y}, {})}, and edges E = {}. The set of variables associated to the rule set is Var = {xA, yA}. Since no rule involves both variables xA and yA, the stochastic fragments are Var s = {{xA}, {yA}}.

