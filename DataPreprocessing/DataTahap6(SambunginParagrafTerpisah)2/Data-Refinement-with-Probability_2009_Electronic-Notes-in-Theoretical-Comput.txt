In the transformer model the two forms of simulation are again sound, but this time upwards simulation is by itself complete. The reason is that downwards simulation is able to be expressed by a Galois connection. That is the basic technique used here. The proof in the relational setting that the two simulations generate all data refinements reduces in the transformer setting to the stronger statement that a composition of upwards simulations (again an upwards simulation) does so.

r. In that setting, the counterpart of the relational model is the distributional model of He et al. [4] and that of the transformer model is the expectation-transformer model of Morgan et al. [12]. Again there is a Galois connection between them [9].

In Section 3 we consider data refinement for probabilistic programs. We begin by establishing structure on the spaces of simulations then show that in the distri- butional model, neither kind of simulation is alone complete for data refinement. Further progress is beset by the weakened laws of probabilistic programming. We conclude with a discussion.

The pair (I, F ) enjoys further properties. For instance HI and HF bound up- wards simulation. For convenience we write [HI, HF ] for the set of functions satis- fying refinement (2) (with no intention to imply that it is totally ordered).

In proposing a complete technique for data refinement in the probabilistic set- ting, much remains to be done. What might play the role of the power-set construc- tion in the probabilistic case? Theorem 3 shows that, unlike the standard case, it does not suffice to consider deterministic datatypes. Moreover the result is crucially dependent on the semantic model of computations and even on the manner in which the semantics of a module is cast. The former is inherited from the standard case but the latter is new.

