Compartments and membranes play an important role in cell biology. Therefore it is highly desirable to be able to represent them in modelling languages for biology. Bio-PEPA is a language for the modelling and analysis of biochemical networks; in its present version compartments can be defined but they are only used as labels to express the location of molecular species.

Compartments are widely present in biological systems and play a major role in their evolution [1]. Compartment membranes are fundamental, because they provide a means for isolating the content of compartments from the external envi- ronment, while still allowing some exchange of information with the exterior, mainly through membrane proteins. Moreover, the same biochemical reaction in a different spatial context may have different outcomes.

One important event that occurs within cells is the movement of small molecules across compartment membranes, which can either be passive (diffusion caused by concentration gradients) or active (mediated by proteins lying on the membrane, called channels). In addition to allowing molecules to pass across membranes, mem- brane proteins are also important for the transmission of signals between compart- ments. Indeed, signalling pathways involve special membrane-bound proteins, called receptors, which respond to the input of signalling molecules on one side of the mem- brane by triggering a cascade of events on the other side.

Many different molecules reside on membranes. The two main types of mem- brane proteins are integral and peripheral proteins. Integral proteins are always attached to membranes; they can either span the entire membrane (transmembrane proteins) or be attached to one side of the membrane (monotopic proteins ). They can bind and interact with close molecules. Peripheral proteins are temporarily attached to membranes: they can bind and interact with close molecules, and also detach from the membranes. Non-membrane proteins are free to move within the compartment volume: they can bind and interact with close molecules and, in some cases, pass across membranes.

Bio-PEPA is a language defined recently for the modelling and analysis of bio- chemical networks [8,7]. A biochemical network is composed of a set of molecular species, such as proteins, small molecules, and genes, that interact with each other through some reactions. The molecular species are located in compartments, such as the nucleus and the cytosol, or on the membranes which enclose them. Bio-PEPA supports the definition of static compartments as names: compartments are con- tainers for the molecular species and are not involved in any reactions which change their size or structure. A constant volume (or size) can be associated with them, and this information is just used in the derivation of the rates for stochastic simu- lation [10] from the functional rates given in the Bio-PEPA system. Furthermore, for the derivation of the transition rates and the step size for the transition system it is implicitly assumed that either all the species are in the same compartment or all the compartments have the same size. The approach is not appropriate in the general case of multiple compartments with different sizes, as we will discuss in Sections 3.2 and 3.3.

The aim of this work is to investigate the use of Bio-PEPA for representing multi-compartment models and extend the language with notions to express more details about locations of species and reactions. We introduce the generic notion of location, which indicates both membranes and compartments, and we define a compact notation for the representation of species which can be in different com- partments. The structure of the system is described in terms of a hierarchy of locations, that also allows us to define relations which classify reactions based on their location. The possible kinds of analysis of multi-compartment systems are discussed and, in particular, the derivation of the transition rates for the CTMC is shown.

assumption is motivated by the fact that these kinds of compartment are the ones considered in models present in databases and in the literature (see for instance mod- els in the BioModels database [13]). Static locations can be described at different levels of detail. In the models in the literature or in databases some simplifications are often made. For instance, receptors are assumed to be in a specific compart- ment (instead of being on a membrane), volumes and membranes are not considered explicitly. On the other hand, in the models derived from experimental data, more details could be given: membranes can be considered explicitly and compartments have different sizes. We keep the language flexible in order to allow the specification of both levels of detail.

The structure of the paper is as follows. Section 2 reports a brief description of Bio-PEPA, while Section 3 is devoted to the definition of our extension. In Section 4 we present the possible kinds of analysis. As an example, a model for describing intracellular Ca2+ oscillations is presented in Section 5. Section 6 is an overview of the related works, whereas the last section reports some conclusive remarks.

A possible modelling style supported by Bio-PEPA is in terms of concentration levels. The amount of each molecular species can be discretised into a number of levels, from level 0 (i.e. species not present) to a maximum level N . The level N depends on the maximum concentration of the species. Each level represents an interval of concentration and the granularity of the system is expressed in terms of the step size H, i.e. the length of the concentration interval. The information about the step sizes and the number of levels for each species is collected in a set U . The view in terms of levels is considered for some kinds of analysis (see below) and the

A Stochastic Labelled Transition System (SLTS) is defined for a Bio-PEPA sys- tem. From this we can obtain a Continuous Time Markov Chain (CTMC). Both the SLTS and the CTMC derived from Bio-PEPA are defined in terms of levels of concentration. We call this Markov chain CTMC with levels.

to express their position with respect to the other locations of the system and their kind (i.e. compartment or membrane). Locations representing membranes are optional: if their role is not relevant, they can be omitted; otherwise, they should be included and their volumes should be specified. Though we consider membranes to be three-dimensional compartments, it can be useful to distinguish them from membrane-bounded compartments.

In order to make the location of species explicit, the location name is added to each species component with the notation S@L, indicating that the species rep- resented by the process S is in the location L. Given the locations L1, L2, the components S@L1 and S@L2 represent the species S in the two locations. By us- ing this approach, reactions involving species located in different locations can be modelled analogously to standard reactions. A transport of a molecule S from L1 to L2, for instance, is simply a reaction in which S@L1 is a reactant and S@L2 is a product.

Representing the same molecule in different locations as different species com- ponents seems a reasonable choice from a biological point of view, since the same molecule is generally involved in different reactions according to the compart- ment/membrane in which it is located. In order to avoid the possible duplication of actions in the model (e.g. analogous reactions involving the same molecules oc- curring in different locations have to be duplicated for each species), we propose a notation to represent a species in multiple locations in a compact way. The mapping into the syntax we have just introduced is straightforward and is just sketched.

Bio-PEPA models can be seen as intermediate formal representations of biochemical systems from which different kinds of analysis can be performed [8,7]. Mappings from Bio-PEPA to ODEs, CTMC with levels, stochastic simulation, and PRISM have been defined. The same approach is considered in this extension.

Mapping to CTMC with levels. This mapping is as in Bio-PEPA (for details see [7]). In this context we limit our attention to locations with fixed size. Indeed the explicit use of time can be problematic for this approach. The states of the CTMC derived from Bio-PEPA are defined in terms of the species levels and the transition rates are the ones reported in the previous section. Given the CTMC with levels, we can perform different kinds of analysis, for instance model-checking with the PRISM tool [17].

the definition of the state of the system in terms of numbers of molecules and the derivation of the stochastic (basal) rates used in the simulation algorithm. There are some relations between the deterministic kinetic constants (used in RREs) and the stochastic ones. These relations have been defined in [10] and applied in the context of Bio-PEPA in [7]. Broadly speaking, for monomolecular reactions these two rates coincide, whereas in higher-order reactions the stochastic rates must be rescaled according to the volume where the reactants are. This is straightforward when only one location is considered or all the reactants are in the same location. However, it is not obvious how to define the stochastic rates when a reaction has reactants in different locations.

Multiple well-mixed locations, with reactions that can involve reactants in different locations. Here, in addition to the assumption of a well-mixed sys- tem we have the further complication of the derivation of the appropriate stochastic rates. This remains an open question and more investigations are necessary. In the following we assume that the modeller is able to give these rates.

Mapping to ODEs. The mapping into ODEs is straightforward and identical to Bio-PEPA (for details see [7]). The mapping is based on the derivation of the stoichiometric matrix from the Bio-PEPA system, the definition of the species variables (representing concentrations or moles) and on the definition of a kinetic vector containing the kinetic laws. We consider two cases: described in our language. In the model proposed in [3] compartments are assumed to have all the same size, and the parameters and concentrations are defined ac- cordingly. This assumption is generally introduced to simplify the model and the analysis, and is particularly useful when precise data on compartment volumes are not available. Here we consider the same assumption in the definition of the Bio- PEPA system, in order to obtain a comparable model. However, since Bio-PEPA supports multiple locations with different sizes, a more accurate representation of the biochemical system could be obtained if quantitative information about location sizes are available.

Secondly, we consider the PRISM model-checker [17] in order to verify some properties of the system. The information about step sizes must be provided. Here, we use H = 0.01 for all the species, since the volumes of the compartments are the same. For illustrative purposes we show the results obtained by checking two CSL formulae.

logical systems with an explicit notion of compartments. A system is represented as a hierarchy of nested ambients, which represent the boundaries of compartments containing communicating processes whose actions specify the evolution of the sys- tem. Operations involving compartments, complex formation and transport of small molecules across compartments can be easily represented in BioAmbients.

In Brane calculi [4], membranes are not just containers, but active entities that are responsible for coordinating specific activities. A system is represented as a set of nested membranes, and a membrane is represented as a set of actions. Op- erations such as the transport of small molecules across membranes can be easily represented; moreover, membranes can move, merge, split, enter into and exit from other membranes.

biological entities. Although the nesting of boxes is forbidden, the typing for sites provides a virtual form of nesting, which makes the representation of hierarchies of compartments possible. Explicit static compartments and transport of objects across them have been added to Beta-binders in [11]. The possibility to deal with

Concluding, Bio-PEPA is particularly appropriate for describing systems at a high level of abstraction, similarly to models usually present in databases and in the literature. For such abstraction, compartments are essentially containers for molec- ular species: they allow some limited interaction between molecules lying in different compartments, but the main evolution is given by interactions of molecular species within compartments. In these cases Bio-PEPA offers a direct, formal representa- tion of the system, allowing an intuitive representation of both intra-compartment and inter-compartment reactions.

Another main feature of Bio-PEPA is that it supports various kinds of analysis. This is very important as these analyses can help us to understand different related features of biochemical systems. Note that, among the various techniques, there is the possibility to consider model-checking. This is particularly helpful in order to understand the behaviour of the system, as it allows us to answer quantitative temporal queries by performing an exhaustive exploration of all the possible paths through the system. By means of model-checking, we can detect possible errors in the model and verify some relevant properties of the system, not easily observable from simulation results. The possibility of different analyses is also supported by membrane systems, whereas most of the other languages listed above essentially limit the possible analyses to stochastic simulation.

We have enriched the Bio-PEPA process algebra with specific features useful to model biological compartments. A notion of location has been introduced and, in addition to three-dimensional compartments, their enclosing membranes can also be explicitly defined. Transports and other reactions involving molecular species in multiple compartments can be easily modelled in this extension.

