In a threshold public key encryption scheme a message is encrypted and sent to a group of receivers, in such a way that the cooperation of at least t of them (where t is the threshold) is necessary in order to recover the original message. Such schemes have many applications in situations where one wants to avoid that a single party has all the power/responsibility to protect or obtain some critical information. The usual strategy to implement this idea is the following: the set of receivers, which is set from the beginning, runs an interactive setup protocol which takes as input a threshold (chosen by themselves) and outputs a public key for the set and shares of the matching secret key.

This kind of schemes are specially useful in order to guarantee security in mobile ad-hoc networks. A mobile ad-hoc network (also known as MANET) is created on the fly. It consists of a set of self-organized and mobile nodes (e.g. PDAs, laptops or cellular phones) without any fixed infrastructure. The topology of a MANET changes rapidly and unpredictably over time. Such dynamism can be due to new nodes joining the network, whereas at the same time others leave it or just fail because they move to a region that is not in the cover range of the network. Standard threshold public key encryption schemes - where threshold and set of receivers are decided at the setup stage- are not always an ideal solution for this very general scenario. Imagine for example that a sender wants to send a message to a group of receivers in a mobile ad-hoc network, where a considerable number of these receivers are newcomers, that is, they have just entered into the network. To use standard threshold encryption techniques, a public key for the set of receivers and a threshold for decryption must have been set up in a protocol which is either interactive among the receivers, or executed by an external entity; both situations are typically not desirable in ad-hoc networks. Each time someone wants to encrypt used in [11]) or ad-hoc threshold encryption. To the best of our knowledge, only two works have dealt with this extension of the concept of broadcast encryption. In [11] the authors propose a scheme based on RSA; even if the authors claim that the length of the ciphertexts is constant, the ciphertext contains an integer modulo N , where N is the product of all the RSA moduli of the receivers. Therefore, the actual length of the ciphertext is at least n times the length of a standard RSA modulus, where n is the number of receivers. In [7], the authors propose a TBE scheme for identity-based scenarios; again, the ciphertexts contain at least n group elements.

The rest of the work is organized as follows. In Section 2 we recall some tools (secret sharing, public key encryption) that will be necessary for the construction of our scheme. In Section 3 we give the general definitions of the protocols of a threshold broadcast encryption scheme, along with the description of the formal security model for such schemes. We propose our scheme in Section 4, and we prove that the scheme is secure, by reduction to the security of ElGamal encryption scheme. We conclude our work in Section 5.

ElGamal cryptosystem is known to be indistinguishable under CPA attacks, assuming the hardness of the Decisional Diffie-Hellman (DDH) problem. It is also known that this scheme is not indistinguishable under CCA2 attacks, because of its homomorphic properties. Nothing has been proved about indistinguishability of ElGamal encryption scheme under CCA1 attacks.

In this section we prove that our threshold broadcast encryption scheme is essentially as secure as ElGamal public key encryption scheme. As it happens with ElGamal, our scheme is not secure under CCA2 attacks. With respect to CPA and CCA1 attacks, we are going to show that a successful attack against our scheme implies a successful attack against ElGamal.

As we remarked in Section 3.1, we consider for simplicity only the first kind of corruption, and not the corruptions where the attacker asks for the secret key of a previously registered public key. If this second type of corruption is considered, the proof is still possible (with a slightly worse reduction factor) but becomes more cumbersome: the public keys of the users are defined in two different ways, depend- ing on a probability distribution. For one of the ways, the matching secret key is known and so the corruption queries can be correctly answered for these users. For the other way, the secret key is not known, but a hypothetical attack involving this public key can be transformed into an attack against ElGamal cryptosystem.

Proof. We are going to deal with the CCA1 case, obviously the CPA case can be proved in a similar (but simpler) way. Let us assume therefore the existence of a CCA1 attacker B against our TBE scheme, and let us construct a CCA1 attacker A against ElGamal. A receives an ElGamal public key (p, q, G, g, y) as initial input.

