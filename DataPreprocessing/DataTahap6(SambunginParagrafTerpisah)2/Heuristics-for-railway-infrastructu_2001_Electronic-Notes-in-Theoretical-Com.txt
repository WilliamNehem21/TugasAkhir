Basically, the capacity of a component of a rail system is de ned as the maximum number of trains that can be operated on it within a certain unit of time u (e.g. an hour or a day). The theoretical expression of the capacity of a railway line in a given direction, noted C, can be de ned as : where h is the minimum headway time between two successive trains. The mini- mum headway time depends on the signaling system installed on the line consid- ered. Expressions which are more accurate can be used to include more features of the rail system (see [15]).

The aims of the Constraint Programming (CP) models were originally to solve feasibility problems : given a set X1;::: ; Xn of variables, each associated with a domain D1;::: ; Dn respectively, and a set of constraints C1,. . . ,Cn, i.e. a subsets of D1 ::: Dn, nd an assignment of values to the variables while simultaneously satisfying the constraints. The CP models were extended to solve optimization problems : when a feasible solution is obtained, the value of the objective function is a new upper (resp. lower) bound of a variable, representing the objective function to minimize (resp. to maximize). This restriction is made by posting a new constraint on this variable.

In [14], we have presented a CP model of a real-time train scheduling problem. This formulation has been applied to the case study of the Pierre tte-Gonesse junction. First, we will recall the main components of a signalling system, then the formulation of the CP model. Finally, we will present how this CP model has been transformed to tackle the train saturation problem de ned in section 1.

The previous model was designed to solve real time train management problems. We will now present how this model has been transformed for the saturation prob- lem. From the de nition of section 1, the decision variable sta(t) is replaced by variables stt(i = 1). In real time problems, trains can be delayed during the run. Conversaly, in a saturation problem, an extra constraint is added which ensures no delay to the movement of the trains through the junction :

Step 2 : we have to de ne the function fr of the feasible routes. In previous experiments [13] of the CP model, we show that a complete search for solving instances with more than 12 trains, can not be carried out within reasonable time (i.e. less than one hour). We gave up the idea of carrying out a complete search therefore, we have restricted the set of feasible routes to one route, i.e. by setting the route variable to the \usual" route for each train category.

As mentioned in section 3.2, in previous experiments [13] of the CP model, we showed that a complete search with a prospective algorithm for solving instances with more than 12 trains, can not be carried out within reasonable time. We gave up the idea of carrying out a complete search and we assumed that the route variables ra(t) are set to the \usual" route (c.f. section 3.2). We developped the greedy algorithm 1 which uses the constraint propagation algorithms available in Ilog Solver/Scheduler libraries after each decision step on the sta(t) variables. In this algorithm, we used the following notations :

Due to the important size of considered instances, we used an adaptation of the metaheuristic GRASP (Greedy Randomized Adaptative Search Procedure). This is a multistart two-phase metaheuristic for combinatorial optimization proposed by Feo and Resende [4]. First, a construction phase builds an initial solution with a greedy randomized procedure. This random character enables to obtain solutions in di erent areas of admissible solution space. Second, a local search phase improves these solutions. This process is repeated many times in order to compensate the random character of the greedy phase. Several new components extend the original GRASP method. They are presented and discussed in [12].

It is easy to customized this metaheuristic on any problems for which con- struction and local search algorithms are available. GRASP has been applied to a wide range of optimization problems. These include academic and industrial prob- lems in scheduling, routing, logic, partitioning, location and layout, graph theory, assignment, manufacturing, transportation, telecommunications, electrical power systems, and VLSI design. An extensive anotated bibliography is available (see [5]).

The method produces good quality solutions for hard combinatorial optimiza- tion problems, particularly for the set covering and the set packing problems [2,3]. In the following, I denotes the set of variables, J the constraints and ti;j the coupling matrix between the variables (i 2 I) and the constraints (j 2 J). Our construction procedure (Algorithm 2) builds a solution from a trivial admissible solution (xi = 0; 8i 2 I). Some variable values are changed (ie xed to 1), keeping an admissible solution. The changes concern only one variable for one iteration. In order to increase the objective function, the variables which concern a minimum number of constraints and with a maximum value are prioritized, but the choice is random among the most interesting variables. Changes stop when we can not x

The neighbourhood used for our local search procedure is k  p exchanges. A k  p exchange consists in setting to 0 of k variables and to 1 of p others variables. Due to the combinatorial explosion of the number of exchange possibilities when k and p increase, we are obliged to limit them. So we have only tested 1  2 exchanges. We have only accepted exchanges increasing the objective function. When an exchange is accepted, all exchange possibilities are tested again. Local search stops when there is no more exchange possible.

These results raise two preliminary assumptions. Firstly, to save capacity with the combination of Freight and TGV categories, it is necesary to consider alterna- tive routes. Secondly, to combine Inter City trains and the other categories, the main role is given to the start variable in comparison with the route variable.

The rst assumption is also supported by the results of the scenario TGV/FR. The USPP model has the best number of trains with an important e ort on the choice of routes. As the CP model does not provide the choice of routes, all the Freight trains are discarded. The set routes are incompatible, therefore the scheduling of the TGV postpones the earliest start time of the Freight trains to after the next possible scheduling of the TGV.

