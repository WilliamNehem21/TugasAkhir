A binary search tree over actions is used to select one action given a random number in between 0 and the sum of action rates. Each node of the tree keeps the sum of rates relative to the left subtree, that is used to perform left-right switch when searching the action to be executed. In particular, this tree structure guarantees that the performance of one-step simulation is O(logN ) where N is the number of actions, namely, it is logarithmic in the number of compartments.

The egg of Drosophila is already polarised by differently localised mRNA molecules which are called maternal effects. The first nine nuclear divisions generate a set of nuclei, most of which move from the middle of the egg towards the surface, where they form a monolayer called syncytial blastoderm. After other four nuclear divisions, plasma membranes grow to enclose each nucleus, converting the syncytial blastoderm into a cellular blastoderm consisting of about 6000 separate cells.

The protein synthesis is assumed to be an atomic events, so that transcription and translation are modelled with one reaction only. Gene activation is modelled through a reaction that change the state of the gene from 0 to 1 once the activating protein is available. The other way round causes the gene inhibition. The model of hb dynamics is expressed by code (and similarly for the others): reaction r(gHbAct00) : [pBcd, gHb0] --> [pBcd, gHb1] rate 0.1114. reaction r(gHbAct01) : [pTll, gHb0] --> [pTll, gHb1] rate 00144. reaction r(gHbAct02) : [pHb, gHb0] --> [pHb, gHb1] rate 0.0293. reaction r(gHbDeAct00) : [pKni, gHb1] --> [pKni, gHb0] rate 0.3903. reaction r(gHbDeAct01) : [pKr, gHb1] --> [pKr, gHb0] rate 0.0124.

In order to demonstrate the framework applicability, we studied the phenomenon of pattern formation during Drosophila embryo development, modelling the inter- actions between maternal factors and gap genes that originate the early regional- isation of the embryo. The possibility to model both the reactions taking place inside the cells that regulate the gene expressions, and the molecules diffusion that mediates the cell-to-cell communication, allows the reproduction of the interplay between these two levels in order to verify its fundamental role in the spatial self- organisation characteristic of such a kind of phenomenon. The results presented show the formation of a precise spatial pattern which have been successfully com- pared with observations acquired from the real embryo gene expressions.

