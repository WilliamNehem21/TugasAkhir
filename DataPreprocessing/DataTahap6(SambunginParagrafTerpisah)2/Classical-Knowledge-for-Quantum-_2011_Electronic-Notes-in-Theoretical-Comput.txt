Quantum communication is an inseparable part of quantum computing: it offers solutions to the risks caused by exponential speed-up in the power of an adversary as a result of quantum algorithms. While some advances have been made in the area of formal verification of quantum communication protocols [11], no applicable formal framework has yet been suggested for their automatic cryptanalysis. This is contrary to the fact that, similar to the situation in classical security, attacks have been discovered on proven-to-be-safe quantum protocols. In this paper we present a decision procedure that verifies whether a protocol satisfies a security property by deriving knowledge properties of its agents on the dynamic and epistemic traces of the protocol. The dynamic traces are generated from the specification of a protocol using the operational rules of distributed measurement calculus [5] (DCM). These are then expanded to the epistemic traces using appearances of agents about the actions of the protocol. The appearances are derived from the safety assumptions of

Both the DCM model and the algebra have been previously used to analyze the security of quantum key distribution (QKD) and its attacks [8,7,16]. The setting of this paper has advantages over both these attempts. First, we rely on the already existing rules of the semantics of DMC, as opposed to adding axioms for quantum mechanics to the algebra. Second, we use the algebraic axiomatics of adjunction to derive knowledge properties of the protocol, as opposed to model-checking them by traversing the tree of the protocol. Third, we set the actions of the adversary in a compositional way using the appearance maps of the algebra, as opposed to ad- hocly adding them to the specification of the protocol. We prove that our decision procedure is sound and terminating with regard to the pair of a DMC model and the algebraic axiomatics of Epistemic Systems. We apply our decision procedure to a new quantum secret sharing (QSS) protocol, which is based on graph states and has been proposed recently in [12]. For this protocol, we develop epistemic properties and prove them for three kinds of assumptions on the quantum channels: safe, unsafe with non-suspicious agents, and unsafe with suspicious agents. However, we can only work on a one-round basis and indeed, for a full analysis of protocols one needs to run the protocol in many runs and then use probabilities, for instance on the knowledge modalities. This would be a natural and exciting extension of the currently proposed framework.

We proceed by analyzing uncertainty of agents about the states and actions of protocols. These are referred to as appearance maps and are denoted by fA for an agent A. They encode all possible actions or propositions that appear possible to an agent, given the action that is happening or the proposition that is true in reality and are set according to the general rules below.

In this article we proposed a new framework for formal analysis of security issues in quantum cryptographic protocols. The approach combines an algebraic rewrite system with a specification language for quantum distributed computations. The former provides machinery to work with uncertainties of agents in a protocol in a compositional way, while the latter inherently encodes the rules of quantum me- chanics. Our framework was put to the test in the analysis of quantum secret sharing, where we showed some epistemic properties of the protocol in the presence and absence of an active adversary. As a procedure of this type typically becomes hairy, we envision providing a software implementation which automates the anal- ysis of protocols. A software implementation of the algebra [15] is already in place to handle part of the verification. The construction of a tool that automatically derives the traces and semantics of a protocol is currently underway.

