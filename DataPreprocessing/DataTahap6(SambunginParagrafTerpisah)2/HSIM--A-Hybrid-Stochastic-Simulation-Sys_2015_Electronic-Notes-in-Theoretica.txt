The tetrameric repressor of the lac operon in E. coli is a good example of this [8]. There are around ten copies only of this repressor in each bacterium, but due to its high local concentration near its binding site on DNA, its effects are largely noticeable. The cause of this high local concentration is inherent to the mechanism of operation of this repressor, and to the specific distance between the locations of its binding sites on the DNA. This is a co-operative process which tends to perpetuate itself.

If we observe such a particle for a time interval t, we will see it displaced by a position vector r. If we repeat this over and over again, we can compute the average displacement during time interval t, and we should find that < r >= 0. That means that there is no preferred direction for the random forces exerted by the water molecules on the particle.

where D is the diffusion constant. The diffusion constant D depends both on the size and shape of the particle, and on the viscosity and temperature of the fluid that it is moving through. The factor 6 is related to the dimensionality,6 is for 3D motion (4 is for 2D, and 2 is for linear motions). Basically, diffusion is due to the independent Brownian motion of many molecules.

Unimolecular reactions concerns a single molecule which can exist in a number of different states. The spontaneous fluctuation of the structure of a protein from one conformation to another is an example of a unimolecular reaction. Another example is the dissociation of a macromolecular complex. In entity-centered stochastic sim- ulators, these unimolecular reactions will be modelled with a probability of being triggered.

To trigger a bimolecular reaction two events must occur: firstly a copy of each reactant molecules must collide, and secondly this collision has to have a sufficient energy. The collisions arise due to the diffusion of the molecules; it is not very difficult to see that the average number of collisions is proportional to the product of the concentrations of the reactants. This is known as the mass action law, set out by Guldberg and Waage in 1864.

Since the molecules are entities, the simulator can take into account the assem- blies using physical links between these entities, slowing down their diffusion. Fur- thermore, large aggregates can clutter up the space, possibly leading to significant changes of the diffusion of other molecules and thus to abnormal local concentra- tions (either higher or lower). In turn, these singularities can be determinant for the behaviour of the whole system. None of these effects can be taken into account with more global methods which suppose a permanently homogeneous mixture of molecules.

Hsim is mainly designed for the modelling of bacteria, but can also be used for small eukaryotic cells such as yeast or fungus. The main compartment is a cylinder surrounded by an hemisphere at each end. It can be set to be rod shaped, like many bacteria, or to show a spherical conformation, like yeast. Subcompartments can be nested into the main compartment.

The basic length scale used to describe molecules is a nanometer. Many biomolecules are made out of chemical units (e.g. nucleotides, amino acids) which are around 1nm in size. Other small molecules, such as lipids and sugars, are also roughly on this length scale. Most folded up proteins are a few nm in diameter.

In essence, each molecule is represented by a record that includes its type, its position, its size and a list of links to certain other molecules. Hsim keeps track of each molecule in real time from the computer point of view. The basic principle is that time is sliced into consecutive steps (iterations) of same duration, and in each iteration the rules are applied to every molecule. These rules mimic the chemical reactions between molecules in a real system.

This rule means that when MA and MB (two molecules of species A and B) collide, they trigger the reaction that transforms MA into MC and MB into MD (of species C and D respectively) with the probability p(R). The probability reflects the fact that the collision has enough energy to initiate the reaction, and correlate with the macroscopic interpretation of the reaction kinetics. The second molecule on the left side of the rule can be omitted to specify a unimolecular reaction. Similarly, the omission of the second molecule on the right side of the rule, specifies a reaction giving only one product.

To compute the average number of collisions during a time slice between an entity and a non-entity, it is sufficient to compute the volume displaced by the entity molecule, and then, knowing the concentration of the non-entity molecules, to infer their average number of copies inside that volume. Since by definition, the non- entity species are homogeneously distributed inside the compartment, all we need to do is to multiply the total number of copies of this particular molecular species by the ratio of the volume displaced by the entity to the total volume of the compartment. Then, for each of these collisions, the corresponding reaction rules are applied according to their probabilities. We will see more precisely how this is implemented

In this model there are two different species A and B, which can diffuse in a com- partment of one micron-cube volume. The only reaction of this model transforms each pair of molecule of type A and B into a single molecule of type C, with the probability 0.135. The species C has a very short lifetime: as indicated in the metabolite C[1] statement, each copy of this species vanishes after 1 timestep, so basically this reaction degrades pairs of A and B. Initially there are 1000 copies of each of the species A and B inside the compartment.

The cyanobacterium Synechococcus elongatus is a gram-negative bacterium that uses photosynthesis for energy intake. Its metabolism is regulated by an internal circadian clock synchronised with daylight through photosensitive receptors. The clock mechanism is mainly made of three proteins KaiA, KaiB and KaiC. In the cyanobacterium these proteins are genetically regulated, but spontaneous oscilla- tions of the phosphorylation level of KaiC hexamers, showing a period of approx- imately 24h, have been observed in vitro in a mixture of KaiA, KaiB, KaiC and ATP [9].

A very slow allosteric transition can switch the hexamers from one state to the other. The KaiA protein activates the phosphorylation of the KaiC hexamers in the tense state. In the relaxed state, KaiC hexamers tend to dephosphorylate. This dephosphorylation is counteracted by KaiA, which is itself inhibited by Kaib. The relative concentrations of the KaiA, KaiB and KaiC proteins leads to the phospho- rylation in the tense state and to the dephosphorylation in the relaxed state of the KaiC hexamers.

The compartment is initially filled with globular actin, a protein that can self assem- ble to make a polarised dimer, then polymerise from each end of the initial dimer with kinetics depending on which end of the initial dimer the polymerisation process started from. The process is reversible, the polymer can shrink, releasing globular actin monomers, that can, after a certain amount of time, polymerise again. This mechanism needs energy, which is provided by the conversion of ATP to ADP; In this simplified model, we do not take it into account.

Hsim implements an hybrid simulation system integrating both an entity-centered system and an approximate Stochastic Simulation Algorithm (SSA). We have shown the advantages of an entity-centered simulation system in terms of expressiveness and notably, taking into account the spatial localisation. We have also proposed a new and very efficient approximate SSA to compute the evolution of a system of reaction rules.

