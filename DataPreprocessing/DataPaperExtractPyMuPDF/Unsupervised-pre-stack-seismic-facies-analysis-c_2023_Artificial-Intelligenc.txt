Artificial Intelligence in Geosciences 4 (2023) 22–27
Available online 10 February 2023
2666-5441/© 2023 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the CC
BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).
Unsupervised pre-stack seismic facies analysis constrained by 
spatial continuity 
Yifeng Fei *, Hanpeng Cai, Junhui Yang, Jiandong Liang, Guangmin Hu 
School of Resources and Environment, University of Electronic Science and Technology of China, China  
A B S T R A C T   
Seismic facies analysis plays important roles in geological research, especially in sedimentary environment identification. Traditional method is mainly based on 
seismic waveform or attributes of a single seismic gather to classify the seismic facies. Ignoring the correlation between adjacent seismic gathers leads to poor lateral 
continuities in generated facies map, which cannot fit the sedimentary characteristics well. In fact, according to sedimentology theory, the horizontal continuities of 
the stratum can be utilized as priori information to provide more information for waveform classification. Therefore, we develop an unsupervised method for pre- 
stack seismic facies analysis, which is constrained by spatial continuity. The proposed method establishes a probabilistic model to characterize the correlation 
between neighboring reflection elements. Subsequently, this correlation is used as a regularization term to modify the objective function of the clustering algorithm, 
allowing the mode assignment of reflective elements to be influenced by the labels of their neighbors. Test on synthetic data confirms that, compared with traditional 
seismic facies analysis methods, the facies maps generated by the proposed method have more continuous and homogeneous textures, and less uncertainty on the 
boundary. The test on actual seismic data further confirms that the proposed method can describe more details of the distribution of lithological bodies of interest. 
The proposed method is an effective tool for pre-stack seismic facies analysis.   
1. Introduction 
Seismic facies analysis provides an effective way of determining 
lithofacies and sedimentary environments. It mainly divides the seismic 
sequence, and then extracts and analyzes the characteristics of seismic 
signals in the divided sequence. After that, seismic facies units with 
similar characteristics are classified into the same category, representing 
a type of sedimentary properties and sedimentary environment (Alsadi, 
2016). Waveform classification and multi-attribute classification are 
common methods for seismic facies analysis at present (Xu and Haq, 
2022), but these methods mostly use the seismic signal of a single 
reflector as data input, ignoring the correlation of seismic signals of 
adjacent reflectors. According to the relevant theory of sedimentology, 
adjacent reflectors have a high correlation in the characteristics of the 
reflection mode. The lack of consideration of this may make existing 
analysis methods susceptible to noise interference and leading to poor 
results (Li et al., 2022). 
Restricted by the band-limited seismic acquisition and the 
characteristics of seismic data itself, it is difficult to obtain sufficient 
high-quality labeled data sets for supervised learning, so unsupervised 
algorithms have received extensive attention in the field of seismic data 
interpretation (Qian et al., 2018; Mousavi et al., 2019; Gao et al., 2021). 
As an effective clustering algorithm, the fuzzy c-means clustering (FCM) 
algorithm is widely used. It obtains the membership degree of each data 
point or data sample to all class centers by optimizing an objective 
function, so as to determine the categories of the samples to achieve the 
purpose of automatically classifying the sample data. In recent years, it 
has been successfully applied to the field of seismic facies analysis and 
achieved acceptable results (Liu et al., 2022; Mirzakhanian and 
Hashemi, 2022). However, FCM is sensitive to noise, which has a 
negative impact on the application of the algorithm in seismic facies 
analysis. Due to the influence of seismic data acquisition methods and 
other aspects, even preprocessed seismic data often contain a lot of 
noise. This often makes the boundaries of FCM results on seismic data 
unclear and the continuity of clustering is poor, which does not conform 
to the actual stratigraphic deposition and geological laws. 
* Corresponding author. 
E-mail address: yifengfei1995@gmail.com (Y. Fei).  
Contents lists available at ScienceDirect 
Artificial Intelligence in Geosciences 
journal homepage: www.keaipublishing.com/en/journals/artificial-intelligence-in-geosciences 
https://doi.org/10.1016/j.aiig.2023.01.003 
Received 20 December 2022; Received in revised form 16 January 2023; Accepted 19 January 2023   
Artificial Intelligence in Geosciences 4 (2023) 22–27
23
According to the theory of geology and stratigraphic sedimentology, 
there is a strong correlation between the seismic signals of adjacent 
reflection elements. This can be used as prior information to provide 
more knowledge constraints for seismic facies classification, improve 
the lateral continuity of the seismic facies map and enhance the 
robustness of the algorithm. During the sedimentary evolution of the 
formation, it is often accompanied by the formation of anomalous 
bodies, resulting in the formation of karst caves, faults and other 
structures in the formation. Therefore, the correlation between adjacent 
reflection elements cannot be represented by hard division (Su-Mei 
et al., 2022). So we established a probabilistic model to characterize this 
correlation, and then we used cross-entropy as a distance measurement, 
fused it into the loss function of FCM, and proposed a novel seismic 
facies analytical method. 
2. Method 
Using the standard FCM algorithm to cluster N samples into K clus-
ters, the following objective function is used: 
J =
∑
N
i=1
∑
K
k=1
uq
ik‖xi − vk‖2 ∑
K
k=1
uik = 1∀i
(1)  
where xi represents the ith sample, vk represents the kth cluster center. vk 
and xi have the same feature dimension. uik represents the probability 
that the ith sample xi belongs to the kth cluster center vk. q is a weighted 
index, which is generally specified manually. 
Fuzzy c-means clustering is calculated using an iterative convergence 
method, and the values of iterative uik and vk are continuously updated 
through the following equations. When the maximum change value of 
uik and vk calculated twice before and after does not exceed a given 
threshold, the objective function is converged, and it can be considered 
that the clustering result has reached the optimum. 
uik =
∑
K
j=1
(
xi − vj
) 2
q−1
(xi − vk)
2
q−1
(2)  
vk =
∑
N
i=1
(uik)qxi
∑
N
i=1
(uik)q
(3) 
According to the theory of stratigraphic sedimentology, the strata 
have certain lateral continuity. Therefore, in this paper, we try to 
establish a probabilistic model to characterize the correlation between 
such adjacent reflection meta-seismic signals. Briefly, the model should 
have the following characteristics. 1) The seismic signals of adjacent 
reflectors are likely to have the same type. 2) The correlation of seismic 
signals of different reflection elements will weaken with the increase in 
distance. 3) The correlation between the seismic signals of two reflectors 
far away should be negligible. To prevent the division error of seismic 
facies caused by hard division, we choose to use the method of recursive 
probability estimation to characterize this correlation (Liu et al., 2022). 
In order to simplify the analysis of this problem, we use the first-order 
neighborhood system to analyze the different reflectors, as shown in 
Fig. 1. Here, we assume that the correlation of adjacent reflectors in the 
first-order 
neighborhood 
is 
direct, 
while 
the 
correlation 
of 
non-neighboring reflectors is indirect, and the correlation is limited to 
the window of our selected area. As shown in Fig. 1, in the selected 
window, a, b, c, and d in the first-order neighborhood of r are directly 
related to r, while e and f are indirectly. 
Assume that a certain seismic facies map contains K seismic facies. 
We define a parameter α related to the probability to characterize the 
correlation between seismic signals of different reflectors xh and xr in the 
first-order neighborhood. 
P(xh = k|xr = k) = α
k ∈ {1, 2, ...,K}
(4) 
Fig. 1. Illustration of the correlation relationship between different reflectors 
in the formation. In the selected window (inside the orange box), a, b, c, d are 
directly related to r, while e and f are indirectly related to r. 
Fig. 2. (a) 3D view of the physical model. (b)The physical model parameters of the section along the AA’ line, including S-wave propagation velocity, P-wave 
propagation velocity, and medium density. 
Y. Fei et al.                                                                                                                                                                                                                                       
Artificial Intelligence in Geosciences 4 (2023) 22–27
24
P(xh = l|xr = k) = 1 − α
K − 1
l, k ∈ {1, 2, ..., K} and l ∕= k
(5) 
Obviously, α represents the probability that xh and xr belong to the 
same cluster. Considering that there may be K − 1 possibility when xh 
and xr do not belong to the same cluster, we can also calculate the 
probability that xh and xr belong to different clusters. 
For the seismic signals of a pair of non-directly adjacent reflectors xh 
and xr, it is assumed that the Manhattan distance between them is n. We 
define Pn to represent the probability that xh and xr belong to the same 
cluster of seismic facies (similarly, the probability that a pair of re-
flectors with Manhattan distance n − 1 belong to the same cluster of 
seismic facies is Pn−1). According to formulas (4) and (5), we can get the 
following recursive expression: 
Pn = αPn−1 + (K − 1) 1 − α
K − 1
(1 − Pn)
K − 1
(6) 
Similarly, when n = 1, then the two reflectors are adjacent reflectors, 
according to our definition and formula (4), we have: 
P1 = α
(7) 
Simultaneously deriving formulas (7) and (8), we can get: 
Pn =
(Kα − 1
K − 1
)n−1(
α − 1
K
)
+ 1
K
(8) 
Further, using the formula derived above, we can get the following 
equations: 
P(xi= k|xm = k, d = n
)
=
(Kα − 1
K − 1
)n−1(
α − 1
K
)
+ 1
K k ∈ {1, 2, ...,K}
(9)  
Fig. 3. Seismic facies maps with different Gaussian noise. (a), (c), and (e) show the seismic facies maps obtained by FCM method for 6 dB, 4 dB and 2 dB synthetic 
data. (b), (d), and (f) show the seismic facies maps generated by FCM-CEC method for the corresponding data. 
Fig. 4. For 2 dB synthetic prestack seismic data, (a), (c), and (e) show the Distinction, Affiliation, and Confidence corresponding to the facies maps obtained by the 
FCM method. (b), (d), and (f) correspond to the facies maps generated by FCM-CEC method. 
Y. Fei et al.                                                                                                                                                                                                                                       
Artificial Intelligence in Geosciences 4 (2023) 22–27
25
P(xi=l|xm=k,d=n
)
=1−P(xi=k|xm =k,d=n
)
K−1
l,k∈{1,2,...,K} and l∕=k
(10) 
Through formulas (9) and (10), we can obtain the correlation rela-
tionship between adjacent and non-adjacent reflection element seismic 
signals inferred from the perspective of probability. Among them, α is an 
important probability parameter we defined, which needs to be given. It 
directly characterizes the correlation of reflection elements in the first- 
order neighborhood, and its value affects our evaluation of the corre-
lation of seismic signals of adjacent reflection elements. Therefore, a 
reasonable value of α is extremely important to us. In this paper, we use 
a more intuitive way to give the value of α: 
α =
∑
N
i=1
∑
j∈Direct (i)
I(xi = xj
)
∑
N
i=1
∑
j∈Direct (i)
I(xi = xj
)
+ ∑
N
i=1
∑
j∈Direct (i)
I(xi ∕= xj
)
(11)  
I(condition) =
{
1, if condition = 1
0, if condition = 0
(12)  
where Direct(i) is one of the four reflection elements in the first-order 
neighborhood of reflection element xi. Function I(condition) is an indi-
cator function, and its specific value is determined according to the 
actual situation. 
Through formula (11), using the seismic data of the actual work area 
for estimation and calculation, the value of α is about 0.804. This in-
dicates that the seismic signal features between adjacent reflectors in the 
formation have a positive mutual influence, that is, the same seismic 
facies has lateral continuity in the formation. So, in this paper, we set the 
value of the defined spatial information transfer factor α to be 0.8, and 
further apply it to our proposed FCM-CEC algorithm for seismic facies 
analysis. 
In the FCM, the calculation of the probability of the membership uik 
of the sample to the cluster center is based on the feature relationship of 
all samples. The cluster relationship P(xi|xm) between two reflectors we 
defined is based on the characteristic relationship of local reflector 
seismic signals. For two types of probability distributions p(x) and q(x), 
in information theory, cross-entropy is often used to measure the rela-
tionship between the two. The definition of cross-entropy is as follows: 
H(p, q) = −
∑
x∈X
p(x)log(q(x))
(13) 
In recent years, cross-entropy as an objective function has been 
widely used in machine learning and deep learning to describe the gap 
between the predicted value of the model and the real value, and has 
achieved good results (Zhang et al., 2019). In this paper, we choose the 
cross entropy function as the distance measure between the two prob-
ability distributions of uik and P(xi|xm). Thus, the objective function of 
the original FCM can be rewritten as: 
J =
∑
N
i=1
∑
K
k=1
uq
ik‖xi − vk‖2 − β
′ ∑
N
i=1
∑
K
k=1
uik
q∑
m∈Ni
log (P(xi|xm)q) =
∑
N
i=1
×
∑
K
k=1
uq
ik‖xi − vk‖2 − β
∑
N
i=1
∑
K
k=1
uik
q∑
m∈Ni
log(P(xi|xm))
(14)  
Here, β = β
′q is used as a weighting factor as a weight measure between 
feature consistency and stratigraphic lateral continuity for all samples in 
the clustering process. The minimal optimization of this objective 
function can be solved by using the Lagrange multiplier method. Among 
them, the two iterative update formulas of sample membership uik and 
cluster center vk are as follows: 
uik =
∑
K
j=1
[
⃦⃦xi − vj
⃦⃦2 − β ∑
m∈N(i)
log
(
pmj
)
] 1
q−1
[
⃦⃦xi − vj
⃦⃦2 − β ∑
m∈N(i)
log(pmk)
] 1
q−1
(15)  
vk =
∑
N
i=1
(uik)qxi
∑
N
i=1
(uik)q
(16) 
Accordingly, the steps of the fuzzy c-means clustering algorithm with 
cross-entropy constraints we propose in this paper are shown in Algo-
rithm 1. 
Algorithm 1.
Fuzzy c-means clustering with cross-entropy constraints 
(FCM-CEC)  
Algorithm 1:
Input: 
ix
K
q
i
N
Output: 
ik
Main program: 
While max 
 do: 
kv
end 
Y. Fei et al.                                                                                                                                                                                                                                       
Artificial Intelligence in Geosciences 4 (2023) 22–27
26
3. Synthetic data examples 
In order to facilitate the verification of the proposed method, we use 
synthetic seismic data for experimental verification. We design a layered 
stratigraphic model as shown in Fig. 2(a), which contains three layers of 
tectonic media, the first and third layers are mudstone structures, and 
the second layer is sand. Among them, the second layer contains three 
large seismic facies and a micro-fault. The geological model parameters 
of different tectonic media such as S-wave propagation velocity, P-wave 
propagation velocity, and medium density are shown in Fig. 2(b). In this 
paper, five different azimuths are selected, and the seismic reflection 
waveforms are inverted using the 35 Hz Ricker wavelet and the Aki- 
Richards approximation. The data sampling interval is 1 ms. Finally, 
we obtain synthetic pre-stack seismic data with 5 seismic traces per 
gather. We use a 50 ms window to capture the seismic profiles near the 
bottom of the second layer to analyze the seismic facies. 
We add different Gaussian noise filtered in the seismic bandwidth 
(10–15 Hz 50–60 Hz) to the synthetic traces. The FCM and FCM-CEC 
algorithms are applied to the 6 dB, 4 dB, and 2 dB synthetic data, 
respectively. Fig. 3 shows the results of the two algorithms. By 
comparing (a), (c), and (e) in Fig. 3, we can see that when the noise 
increases, the recognition effect of the FCM algorithm decreases. For the 
same data set, the seismic facies maps generated by the FCM-CEC al-
gorithm have enhanced the continuity inside the geological body, and 
the boundaries of the geological body are clearer. In the lower signal-to- 
noise ratio data (Fig. 3(e)), the FCM algorithm can no longer correctly 
identify the micro-fault in the formation, but the FCM-CEC algorithm 
has achieved a better result (Fig. 3(f)). 
In order to quantitatively evaluate the clustering effect of the algo-
rithm, this paper uses a confidence analysis proposed by Cai et al. 
(2019). Fig. 4 shows a visual comparison of Distinction, Affiliation, and 
Confidence for 2 dB data. It can be seen that, compared with the results 
of the FCM method, the FCM-CEC algorithm generally achieves higher 
Distinction, Affiliation, and Confidence. Tests on synthetic data 
demonstrate that our proposed method is more robust to noise. 
4. Field data examples 
The survey is in southwest China, with 551 survey lines, each of 
which has a total of 371 traces. The seismic data are 2 ms sampled, and 
the dominant frequency of the seismic data is 40Hz. We slice seismic 
data with a length of 40 ms along the target horizon. There are river 
channels along the target horizon, and the goal of the study is to 
determine the distribution and edges of the river channels. Similar to the 
synthetic data, we use the original FCM and FCM-CEC to analyze the 
structural slice, and the facies maps are shown in Fig. 5. In Fig. 5, the 
yellow and tan areas represent thin and thick sand bodies, respectively, 
while the light blue and dark blue areas represent the background. It can 
be seen that the yellow area outlines the boundaries of the river channel 
sand body, and there are thicker sand bodies (tan areas) in the center of 
the channels. 
However, compared with the seismic facies map obtained by the 
FCM method (Fig. 5(a)), the seismic facies map obtained by the FCM- 
CEC method (Fig. 5(b)) has many more details of the channel edges, 
and reveals new small river courses. Line AA’ (in Fig. 5) is selected in the 
study area, which crosses a channel identified only by the FCM-CEC 
method (interpreted as background in Fig. 5(a) and as channel in 
Fig. 5(b)). The vertical seismic section along the line AA’ is shown in 
Fig. 6. "Bright spot" features can be observed in the seismic profile, 
indicating the presence and location of channel sand bodies. The blue 
arrows in Fig. 6 indicate the edges of the channel, according to the 
interpretation of experts. This means that the FCM-CEC method detects 
more channels, which can provide more information for the delineation 
of the lithologic body of interest. Moreover, there are five wells in our 
study area, which can provide lithology labels. Wells 1–4 encountered 
sand layers during the development stage, while Well 5 did not 
encounter sand bodies. Compared with Fig. 5(a), the FCM-CEC method 
(Fig. 5(b)) correctly predicts the lithology corresponding to Well 1, 
showing a higher coincidence rate with the wells. 
Both the FCM and FCM-CEC methods are fuzzy clustering methods, 
that is, for each stratum reflection element, it will be assigned to the 
Fig. 5. Seismic facies maps of the original FCM(a) and FCM-CEC(b) applied to real data. The yellow and tan areas represent thin and thick sand bodies, respectively, 
while the light blue and dark blue areas represent the background. The red arrows indicate the areas interpreted as small river courses by the FCM-CEC method and as 
background by the FCM method. 
Fig. 6. The vertical seismic section along the line AA’ in Fig. 5. "Bright spot" 
features along the target horizon can be observed in the red box. The presence 
of channels in this area is interpreted by experts, and the blue arrows indicate 
the edge of the channels. 
Y. Fei et al.                                                                                                                                                                                                                                       
Artificial Intelligence in Geosciences 4 (2023) 22–27
27
category with the highest degree of membership. Computing member-
ship is an iterative process accompanied by updating of cluster centers 
(as shown in Algorithm 1). The FCM method will take into account the 
influence of all the data when updating the cluster center in each iter-
ation, no matter how much the data is affected by the noise. However, 
the FCM-CEC method will take into account the constraints of the lateral 
continuity of the formation. Those data that are less affected by noise 
tend to have higher soft probability values in the early stages of algo-
rithm iterations. They are more likely to be classified in the same cate-
gory as adjacent reflectors and will play a more important role in the 
next iteration. On the other hand, the impact of data that is more 
affected by noise will be weakened with the iterative process. We believe 
that letting more reliable samples play a more important role in the 
clustering process is the reason why the FCM-CEC method can achieve 
better results. 
5. Conclusions 
The conventional seismic facies analysis methods are often purely 
data-driven approaches, ignoring the correlation between adjacent 
seismic gathers, making the seismic facies with poor lateral continuity. 
In this article, we propose the FCM-CEC method. A probabilistic model is 
developed to describe the correlation of adjacent formation reflectors. 
Then the lateral continuity of strata is added as priori information to the 
mode division of seismic reflection elements. Tests on synthetic data and 
real seismic data demonstrate the effectiveness of the proposed method. 
The seismic facies maps obtained by the FCM-CEC method have better 
consistency within the geological body and less uncertainty on the 
boundary. Moreover, the proposed method can obtain more information 
about the lithologic body of interest. 
Declaration of competing interest 
The authors declare that they have no known competing financial 
interests or personal relationships that could have appeared to influence 
the work reported in this paper. 
References 
Alsadi, H.N., 2016. Seismic Hydrocarbon Exploration: 2D and 3D Techniques[M]. 
Springer. 
Cai, H., Wu, Q., Ren, H., et al., 2019. Pre-stack texture based semi-supervised seismic 
facies analysis using global optimization[J]. J. Seismic Explor. 28, 513–532. 
Gao, Y., Zhao, P., Li, G., et al., 2021. Seismic noise attenuation by signal reconstruction: 
an unsupervised machine learning approach[J]. Geophys. Prospect. 69 (5), 
984–1002. 
Li, J., Wu, X., Ye, Y., et al., 2022. Unsupervised contrastive learning for seismic facies 
characterization[J]. Geophysics 88 (1), WA81–WA89. 
Liu, S., Jin, S., Chen, Q., 2022. Three-dimensional gravity inversion based on 
optimization processing from edge detection[J]. Geodesy and Geodynamics. 
Mirzakhanian, M., Hashemi, H., 2022. Semi-supervised fuzzy clustering for facies 
analysis using EEI seismic attributes[J]. Geophysics 87 (4), 1–43, 2022, 13(5): 503- 
524.  
Mousavi, S.M., Zhu, W., Ellsworth, W., et al., 2019. Unsupervised clustering of seismic 
signals using deep convolutional autoencoders[J]. Geosci. Rem. Sens. Lett. IEEE 16 
(11), 1693–1697. 
Qian, F., Yin, M., Liu, X.Y., et al., 2018. Unsupervised seismic facies analysis via deep 
convolutional autoencoders[J]. Geophysics 83 (3), A39–A43. 
Su-Mei, H., Zhao-Hui, S., Meng-Ke, Z., et al., 2022. Incremental semi-supervised learning 
for intelligent seismic facies identification[J]. Appl. Geophys. 19 (1), 41–52. 
Xu, G., Haq, B.U., 2022. Seismic facies analysis: past, present and future[J]. Earth Sci. 
Rev. 224, 103876. 
Zhang, K., Wang, X., Guo, Y., et al., 2019. Competing ratio loss for multi-class image 
classification[C]. 2019 IEEE Visual Communications and Image Processing (VCIP) 
1–4. IEEE.  
Y. Fei et al.                                                                                                                                                                                                                                       
