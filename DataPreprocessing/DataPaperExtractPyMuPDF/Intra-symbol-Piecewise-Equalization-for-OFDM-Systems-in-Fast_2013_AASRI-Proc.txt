 AASRI Procedia  5 ( 2013 )  32 – 39 
2212-6716 © 2013 The Authors. Published by Elsevier B.V.
Selection and/or peer review under responsibility of American Applied Science Research Institute
doi: 10.1016/j.aasri.2013.10.055 
ScienceDirect
 
2013 AASRI Conference on Parallel and Distributed Computing Systems 
Intra-symbol Piecewise Equalization for OFDM Systems in Fast 
Fading Channels 
Zhigang Chena, Lei Wanga*, Pinyi Rena 
a Xi'an Jiaotong Universityy, No.28, Xian Ning West Road, Xi’an, China  
 
Abstract 
Based on intra-symbol piecewise linear channel model, a novel piecewise equalizer is proposed for OFDM systems in 
high mobility environment. In this proposed scheme the complex ICI caused by fast fading channels has been resolved as 
new OFDM subsystems' simple ISI and lower ICI, respectively caused by the average channel and the time-varying 
channel over a piece-period. By further employing the characteristics of the channel matrix, a successive `ISI' and `ICI' 
mitigation based equalization with low complexity has been realized. Simulation results show that the proposed scheme 
has  lower computation complexity than the comparative one, while perserving good performance. 
 
© 2013 Published by Elsevier B.V.  
Selection and/or peer review under responsibility of American Applied Science Research Institute 
 
Keywords: Equalization; OFDM;Time-varying channels; Piecewise linear channel model   
1. Introduction  
By expanding the symbol duration and adding the cyclic prefix, OFDM systems can easily overcome the 
multi-path dispersion by simple 1-tap equalization [1]. On the other hand, OFDM systems become more 
susceptible to time-variations as symbol length increases. Hence, the equalization over fast fading channels 
becomes a challenging and important issue for OFDM systems [2].  
 
 
* Corresponding author. Tel.: +86-29-82668772-549; fax: +86-29-82667951 
E-mail address: lei.wang@mail.xjtu.edu.cn 
Available online at www.sciencedirect.com
© 2013 The Authors. Published by Elsevier B.V.
Selection and/or peer review under responsibility of American Applied Science Research Institute
Open access under CC BY-NC-ND license.
Open access under CC BY-NC-ND license.
33
 Zhigang Chen et al. /  AASRI Procedia  5 ( 2013 )  32 – 39 
 
The existing equalization schemes over fast fading channels can be roughly divided into 2 classes, namely, 
pure-equalization and turbo-equalization. The pure-equalization schemes usually assume the channel 
information completely known by the receiver, and focus on low complexity data symbol estimation by fully 
using the channel characteristics [1],[3]-[4]. While the turbo-equalization schemes estimate the channel 
and/or data symbol and equalize the channel alternatively and iteratively, and generally perform better than 
the former at the cost of higher complexity [5]-[6]. Despite the rigorous requirement of complete time varying 
channel information, pure-equalization schemes with low complexity still preserve their importance. First, 
because the tradeoff between the equalization performance and complexity is still a challenging problem, 
even with complete channel information [3]. Second, because turbo-equalization schemes usually employ 
pure-equalization as data symbol estimation component.  
Inspired by the piecewise linear channel model in [2], a low complexity intra-symbol piecewise pure-
equalization scheme over the fast fading channels is proposed in this paper. Based on the intra-symbol 
piecewise linear channel model, the complex ICI caused by the fast fading channel is resolved as the new 
OFDM subsystems’ simple ISI and lower ICI, respectively caused by the average channel and time-varying 
channel over a piece-period. By fully exploiting the piecewise linearity of time varying channels, a successive 
ISI and ICI mitigation based equalization is realized with low complexity.  
This paper is organized as follows. Section 2 introduces the intra-symbol piecewise OFDM system model 
and section 3 describes the proposed equalization scheme. Further complexity analysis and some simulation 
examples to demonstrate the performance of the proposed scheme are provided in section 4 and 5 
respectively. And conclusions are drawn in section 5. 
Notation: ( )T  and ( )H  represent transpose and complex conjugate transpose (Hermitian), respectively. 
(
A)UT
and (
A)LT
denotes the upper triangular part (excluding the diagonals) and the lower triangular part 
(including the diagonals) of matrix A . 
( )
diag a  is a diagonal matrix with the vector a  on the diagonal and 
blkdiag( )
 denotes block diagonal concatenation of the input arguments. Finally, 
N
I and 
N
F  denote the N
N  
identity matrix and FFT matrix respectively. 
2. System Model and Assumption 
Consider an OFDM system with N  subcarriers in a fast time-varying multipath channel. Let the fast 
fading channel be expressed as time varying tapped delay line model 
( , ),
0,1,
,
1;
0,1,
,
1
h n l n
N
l
L
. 
Assuming the channel’s maximum delay length L  less than cyclic prefix length and perfect synchronization, 
the time domain signal with CP removed at the receiver 
[ (0), (1),
, (
1)]T
r
r
r N
r
 can be written in matrix 
form [6] as  
  
H
N
r
HF X
W  
(1)
where 
[
(0),
(1),...,
(
1)]T
X
X
X N
X
 and 
[
(0),
(1),
,
(
1)]T
W
W
W N
W
 are ‘frequency domain’ data vector and 
additive white Gaussian noise (AWGN) vector respectively, and N
N  time domain channel matrix H  is the 
circular form of N
L  channel impulse response (CIR) matrix 
 with
( , )
(
1,
1)
p q
h p
q
. And define the 
circular shift operation on the CIR matrix as  
 
(
,
N)
H
CSHIFT
 
(2)
 
 
( ,((
))
1)
0
1
( ,
)
(
1
0
)
(
)
N
k
k
m
k
m
L
k m
or
N
k
m
N
L
else
H
 
34  
 Zhigang Chen et al. /  AASRI Procedia  5 ( 2013 )  32 – 39 
 
where (( ))N represents a cyclic shift in the base of N .  
To match the fast varying channel, the channel is further approximated as intra-symbol piecewise linear 
model [7]. In this model the symbol period is divided into 
2 p
M
 pieces and p  is a natural number, and the 
CIR varies linearly in each piece-period. Let the average CIR vector 
m
h  in the m -th piece-period be denoted 
as the middle instant CIR vector 
(
/
/ (2
),:)
m
mN
M
N
M
h
h
 as in [2], and the difference between the average 
CIR vector in the (
m 1)
-th and m -th piece-period be denoted as 
1
m
m
m
h
h
h
. By using the CIR in the m -
th piece-period, define the (
/
)
(
/
)
N
M
N
M  CIR matrix 
m
H  , 
m
H  and 
m
H  as the circular form of (
/
)
N
M
L  
the 
CIR 
matrix 
m
 with 
( , )
(
/
1,
1)
m p q
h mN
M
p
q
 , 
average 
CIR 
matrix 
m
 with 
( , )
(
/
/ (2
),
1)
m p q
h mN
M
N
M
q
 , and linear variation CIR matrix 
m  with 
( , )
(
1)
m
m p q
h q
 respectively, 
which can be expressed as  
(
,
/
)
m
m N
M
H
CSHIFT
                                                                                                                 (3) 
(
,
/
)
m
m N
M
H
CSHIFT
                                                                                                               (4) 
2
*(0: (
/
1))
(
)
(
,
/
)
2
m
m
m
m
M
N
M
N
diag
N
M
N
H
H
H
CSHIFT
                                          (5) 
where the second equation in (5) is derived from the property of the piecewise linear channel model.  
It can be derived that the channel matrices H  and 
m
H ,
m
H ,
m
H  satisfy the following matrix form if 
2
/
L
N
M .  
0
0
0
0
1
1
0
1
1
0
1
1
1
1
2
2
1
1
(
)
(
)
(
)
(
)
(
)
(
)
,
,
,
,
,
,
(
)
(
)
%
(
)
(
)
(
)
(
)
(
(
)
(
)
UT
UT
UT
UT
UT
UT
UT
UT
M
M
UT
LT
M
M
UT
UT
M
M
blkdiag
blkdiag
H
0
0
H
H
0
0
H
H
H
0
0
H
H
H
H
H
H
0
H
H
0
0
0
H
H
0
H
H
0
0
H
H
0
0
H
1
1
)
(
)
UT
UT
M
M
ISI
H
H
H
(6) 
Due to the sparsity of the matrix (
Hm )UT
 and the small channel difference between the neighbouring piece-
periods, the fourth term in the right hand is negligible. And let the first three terms be denoted by H  , H  and 
ISI
H  respectively.  
Let the received signals in the m -th piece-period be denoted by 
[ (
0), (
1),
, (
1
/
)]T
m
r mM
r mM
r mM
N
M
r
, 
then divide the ‘frequency domain’ data symbol X  into M  groups with the m -th data symbol group denoted 
as 
[
( ),
(
1
),
(
2
),
(
(
1)
)]T
m
N
X m X m
M
X m
M
X m
M
M
X
, the received signal r  can be expressed by using the 
M  symbol groups 
1
0
{
m}M
X m
 as  
1,1
/
1,
/
0
/
0
2,1
/
2,
/
1
/
1
1
/
1
,1
/
,
/
0
1
1
[( ) ( )
(
) ]
H
N M
M
N M
N M
H
N M
M
N M
N M
H
M
N M
M
M
N M
M M
N M
ISI
T
T
T
T
M
I
I
E F
X
I
I
E F
X
E
F
X
I
I
Y
r
r
r
r
H
H
Y
H
Y
H
Y
W
(7) 
where  
2(
1)(
1)
,
j
p
q
M
p q
e
, 
2
(
/
1)
2
(1,
,
,
)
m
N M
m
j
j
N
N
m
diag
e
e
E
.  
According to equation (7), the OFDM system can be equivalent as M  subsystems, and the m -th 
subsystem is a new OFDM system with 
N /
M  subcarriers, data symbol 
m
X  and subcarrier spacing 
f
M f , 
and experiences frequency offset of m f . Thus the IFFT modulated signal of the original OFDM system in 
each piece-period can be viewed as the weighted-sum of M  OFDM subsystems’ symbols. Such intra-symbol 
piecewise OFDM system model for 
2
M
 has been shown in Fig. 1. 
35
 Zhigang Chen et al. /  AASRI Procedia  5 ( 2013 )  32 – 39 
 
The first term and the second term in the right hand of equation (7) individually represents the M  
‘symbols’ through the average channel and the linear time-varying channel in different piece-periods. The 
third term in the right hand of equation (7) represents the inter-symbol interference (ISI) of the OFDM 
subsystems owing to missing of cyclic-prefix between neighbouring symbols, which has also been shown in 
Fig. 1. 
Based on such intra-symbol piecewise OFDM system model, the original OFDM system’s complex ICI 
caused by the fast fading channel has been resolved as the subsystems’ simple ISI and lower ICI, respectively 
caused by the time average channel and time-varying channel in multiple piece-periods. In the following 
section, a novel successive intra-symbol piecewise ‘ISI’ and ‘ICI’ mitigation method will be proposed to 
equalize the fast fading channel. 
 
 
 
 
 
 
 
 
 
 
 
Fig. 1. Intra-symbol piecewise OFDM system model for 
2
M
 
3. Intra-symbol Piecewise Equalization Method 
Since we focus on the equalization of time-varying channel, AWGN will not be considered in the 
following description. For brevity, the intra-symbol piecewise equalization method for piece number 
2
M
 
will be described in detail first in this section, then such proposed method is generalized for piece number 
2 p
M
.  
The equalization for each data group 
m
X  is similar and composed of three steps: symbol modification, 
‘ISI’ mitigation and ‘ICI’ mitigation. And the equalization for the m -th data group is introduced as following.  
3.1. symbol modification 
First the received samples are modified as  
·
H
H
N
N
m
m
N
m
r
F BF G r
HG F X
HG
Y                                                                                                  (8) 
where the frequency offset rotation matrix 
m
G  and modifying matrix B  are N
N  diagonal matrix with the 
n -th diagonal element 
2
/
( , )
j
nm N
m n n
e
G
 and 
( , )
[
]( , ) / [
](((
)) ,((
)) )
H
H
N
N
N
N
N
N
n n
n n
n
m
n
m
B
F HF
F HF
. 
From (7) and (8), it can be derived that  
0
0
1
1
0
0
1
/2 0
0
1
0
0
0
1
0
1
0
0
1
0
0
1
0
1
1
/2 1
0
1
0
0
0
1
(
)
(
)
(
)
[
] [
] [
]
m
m
m
m
m
m
N
jm
jm
jm
m
m
m
m
m
m
N
ISI
e
e
e
F
r
D E
X
D E
X
D E
X
D E
X
D E
X
D E
X
D E
X
D E
X
F
r
D E
X
D E
X
D E
X
D E
X
Sig
Sig
Sig
                                          (9) 
where 
/2
/2
H
m
m
N
N
D
F
H F
 , 
/2
/2
H
m
N
m
N
E
F
E F
 , 
/2
/2
H
m
N
m
N
D
F
H F
 , 
/2
/2
(
)UT
H
m
N
N
D
F
H
F
. For simplification, define the three 
 
CP Generation 
OFDM  Symbol 
CP
0
/2
0
1 rst New Symbol 
H
E FN
X
0
/2
0
2nd New Symbol 
H
E FN
X
1
/2
1
2nd New Symbol 
H
E FN
X
0
/2
0
1 rst New Symbol 
H
E FN
X
Channel Delay 
Spread effects
+ 
+ 
+ 
Sub-OFDM-System 2 
Sub-OFDM-System 1 
CP 
CP 
36  
 Zhigang Chen et al. /  AASRI Procedia  5 ( 2013 )  32 – 39 
 
terms in (9) as Sig  , Sig  and 
ISI
Sig  respectively.  
3.2. ‘ISI’ mitigation 
From (9), the m -th ‘ISI’ free data group estimate 
m
X  satisfies the following formula  
0
0
0
1
1
0
0
0
1
1
(
)
[
]
m
m
jm
m
m
e
D E
X
D E
X
D E
X
D E
X
Sig
Sig                                                                                                             (10) 
By subsitituting (10) into (9), we have  
0
0
0
1
1
/2 0
0
0
0
1
1
/2 1
(
)
[
]
m
m
N
jm
m
m
N
ISI
e
D E
X
D E
X
F
r
F
r
D E
X
D E
X
Sig                                                                                                        (11) 
From (11), the ‘ISI’ free data symbol estimate 
m
X  can be further approximated as  
1
1
/
0
1
{(
)
}
M
m
m
N M
m
M m
X
D
F
r
                                                                                                                  (12) 
with estimate error 
1
1
0
0
1
1
1
0
1
[(
)
(
)
][(1
)
(1
)
]
jm
jm
m
m
m
e
e
Err
D
D
D
D
E
X
E
X . Thanks to the sparsity of matrix 
m
D  and 
1
1
0
0
1
1
(
)
(
)
D
D
D
D , the estimate error 
m
Err  of the m -th ‘ISI’ free data group is trivial and negligible.  
3.3.  ICI mitigation 
Based on the obtained ‘ISI’ free data symbol estimate, the ‘ICI’ free data symbol estimate 
m
X  can be 
further derived from (10).  
1
1
1
1
0
0
1
1
0
0
1
1
(
1,2)
0
1
0
1
1
1
[(
)
(
)
]
[(
)
(
)
]
2
2
m
m
mod m
X
D
D
D
D
D
D X
D
D
D
D
D
D X
                 (13) 
Considering that time variation matrix 
m
D  is much ‘smaller’ than 
m
D  with a sufficient large piece number M , 
the approximation 
1
1
1
1
(
)
(
)
(
)
(
)
m
m
m
m
m
m
D
D
D
D
D
D
 can be obtained from matrix theory.  
By substituting the approximation above into (13), the ‘ICI’ free data symbol estimate 
m
X  is finally 
obtained.  
1
1
0
1
{(
)
}
M
m
m
m
m
m
M
X
X
D
D
X                                                                                                        (14) 
Until all the 
2
M
 data groups have been estimated through the steps above, the equalized data symbol 
can be finally obtained by permutating the data groups estimate 
1
0
{
m}M
X m
.  
The abovementioned intra-symbol piecewise equalization method for 
2
M
 can be directly generalized for 
2 p
M
 , and the equalization steps: symbol modification, ‘ISI’ mitigation and ‘ICI’ mitigation for the m -th 
data group are described as (8), (12) and (14) respectively. 
37
 Zhigang Chen et al. /  AASRI Procedia  5 ( 2013 )  32 – 39 
 
4. Complexity Analysis 
The equalization complexity is evaluated in terms of complex additions (CA), complex multiplications 
(CM), and complex divisions (CD). According to (8), (12) and (14), the steps of the proposed method mainly 
includes FFT, IFFT and matrix-vector multiplications. Owing to the property of the cyclic toeplitz matrix, 
/
/
H
m
m
N M
N M
D
F
H F
 is a diagonal matrix with diagonal element vector 
/ (
m (1,:))T
FN M
H
, and the matrix 
m
D  can be 
expressed in matrix form from (5)  
/
/
/
/
2
*(0: (
/
1))
(
)
(
,
/
)
2
m
H
H
m
N M
N M
N M
m
N M
M
N
M
N
diag
N
M
N
D
D
F
F
F
CSHIFT
F
 
where 
m
D  is also a diagonal matrix with diagonal element vector 
/ (
m )T
FN M
h
. Hence the matrix-vector 
multiplication involved in (8), (12) and (14) can be simplified as diagonal matrix-vector multiplication and 
FFT/IFFT, which are both low complexity operations.  
As the N -point IFFT/FFT operation require 
2
N / 2
log N  CM and 
2
Nlog N  CA, the three equalization steps on 
the m -th data symbol group 
m
X  have computation complexity of 
2
2Nlog N  CA
2
(
2)
N log N
 CM
N  CD, 
2
[
(
/
)
1]
N log
N
M
 CA
2
0.5*
(
/
)
Nlog
N
M  CM
N  CD and 
2
[2
(
/
)
1]
N
log
N
M
 CA
2
[
(
/
)
2]
N log
N
M
 CM
N  CD 
respectively.  
Table 1. Complexity comparison 
 
Proposed 
Equalization 
Banded 
Equalization 
M=2 
M=4 
Q=2 
Q=4 
N=1024 
100N 
230N 
140N 
564N 
N=256 
80N 
184N 
140N 
564N 
N=64 
60N 
138N 
140N 
564N 
As a total, the proposed scheme requires
2
2
{13
/ 2
9
/ 2
9
}
Mlog N
Mlog M
M N   complex operations for piece 
number M , while the classical simple equalization scheme in [1] with banded factor Q  requires a total of 
3
2
(8
20
4
3
/ 3
)
/
52
Q
Q
Q
N  complex operation. Banded factor 
2,4
Q
 and piece number 
2,4
M
 is assumed in 
the following simulations that the two equalization schemes not only have comparative complexity, but also 
achieve better trade-off between performance and complexity in fast fading channels. For ease of comparison, 
the computation complexity of the two schemes for typical system parameters has been listed in Table 1. 
Among the listed typical parameter configuration cases the proposed method for 
2
M
 can achieve the lowest 
complexity. 
5. Simulation Results 
In this section the uncoded BER performance is applied to evaluate the performance of different equalizers. 
An OFDM system with 
256,
8,32
N
L
, and QPSK modulation is supposed. Rayleigh fading channels with 
exponential power delay profile and maximum normalized Doppler frequency 
0.15,0.30
df
 is assumed in the 
simulations. For fair comparison, the proposed equalizer and the banded equalizer [1] both have only the CSI 
at mid-time instant in each piece-period, and the complete CSI for the banded scheme is obtained by linear 
interpolation in each piece-period.  
From Fig. 2, the proposed scheme achieved slightly worse performance than the banded scheme for 
0.15
df
 case, while achieved better performance for 
0.30
df
 case, since the ICI energy outside Q  banded 
neighbouring subcarriers can not be negligible in fast fading channels, while the proposed scheme can 
38  
 Zhigang Chen et al. /  AASRI Procedia  5 ( 2013 )  32 – 39 
 
efficiently mitigate the much lower ‘ICI’ caused by time-varying channel in each piece-period. But the 
proposed scheme is more susceptible to the multipath length increase than the banded one, since the ‘ISI’ 
mitigation of the proposed scheme is dependent on the multipath length. The proposed scheme performs 
better for 
4
M
 than for 
2
M
 only in 
8,
0.30
d
L
f
 case, since the ’ISI’ dominates the equalization 
performance for lower Doppler spread cases or big delay spread cases.  
6. Conclusions 
We have proposed an intra-symbol piecewise equalizer for OFDM systems over fast time-varying 
multipath channels. By using the intra-symbol piecewise OFDM system model and the characteristics of 
channel matrix, the equalization against fast fading channels can be realized through the successive `ISI' and 
`ICI' mitigation with complexity of 
2
2
{13
/ 2
9
/ 2
9
}
Mlog N
Mlog M
M N . We have shown the proposed scheme 
has lower computation complexity than the comparative one, while perserving good performance especially 
in fast fading channels with small delay spread.  
0
5
10
15
20
25
30
10
−3
10
−2
10
−1
10
0
SNR
BER
 
 
L=8
L=32
fd=0.15
fd=0.30
Subpieced scheme M=4
Subpieced scheme M=2
Banded scheme Q=4
Banded scheme Q=2
 
Fig. 2. BER comparison between the proposed scheme and banded scheme for 
0.15,0.30
df
 
Acknowledgements 
This work was supported by the National Natural Science Foundation of China by Grant 60902045 and 
Major National Wireless Broadband Mobile Communications Project of China under Grant 2010ZX03003-
004-01. 
Corresponding Author 
Corresponding author: Lei Wang, lei.wang@mail.xjtu.edu.cn, and Mobile Telephone 13991944880 
References 
[1] L. Rugini, P. Banelli and G. Leus. Simple equalization of time-varying channels for OFDM.  IEEE Comm. 
Letters, vol. 9, no. 7, pp. 619-921, Jul. 2005.  
[2] Y. Mostofi and D. Cox. ICI mitigation for pilot-aided OFDM mobile systems.  IEEE Trans. Wireless 
39
 Zhigang Chen et al. /  AASRI Procedia  5 ( 2013 )  32 – 39 
 
Commun., vol. 4, no. 2, pp. 765-774, Mar. 2005.  
[3] P. Schniter. Low-complexity equalization of OFDM in doubly selective channels.  IEEE Trans. Signal 
Processing, vol. 52, pp. 1002-1011, Apr. 2004.  
[4] S. Feng, H. Minn, L. Yan and L. Jinhui. PIC-based iterative SDR detector for OFDM Systems in doubly-
selective fading channels.  IEEE Trans. Wireless Comm., vol. 9, no. 1, Jan. 2010.  
[5] E. Panayrc, H. Senol and H. V. Poor. Joint channel estimation, equalization, and data detection for OFDM 
systems in the presence of very high mobility.  IEEE Trans. Signal Processing, vol. 58, no. 8, pp. 4225-4238, 
Aug. 2010.  
[6] T. Hrycak, S. Das, G. Matz and H. G. Feichtinger. Low complexity equalization for doubly selective 
channels modeled by a basis expansion.  IEEE Trans. Signal Processing, vol.58, no.11, pp. 5706-5719, Nov. 
2010.  
 
