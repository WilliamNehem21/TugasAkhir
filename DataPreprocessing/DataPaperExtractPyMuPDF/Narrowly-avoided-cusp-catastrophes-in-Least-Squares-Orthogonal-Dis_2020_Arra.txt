Narrowly avoided cusp catastrophes in Least Squares Orthogonal
Distance Fitting
Alvin Penner
Fonthill, ON, Canada
A R T I C L E I N F O
MSC:
65D17
58K35
Keywords:
Least squares orthogonal distance ﬁtting
Beta2-spline
Cusp catastrophe
Critical points
Topology
Streamlines
Parametric function
Transcritical bifurcation
A B S T R A C T
Computer animation often requires that complex objects need to be modeled by ﬁtting them with simpler shapes
such as splines. It is necessary that these simpler shapes respond continuously as the object changes shape. This
response can become complex if the topology of the error function is changing. The topological events which can
occur when a spline is ﬁt to a changing object are classiﬁed and analyzed, with a view towards deﬁning conditions
which make them possible. The Least Squares Orthogonal Distance Fitting (ODF) method is used to ﬁt a
continuous parametric function whose shape is changing. The ﬁt is performed using a closed-shape Beta2-spline.
Three types of topological events can occur: self-annihilation of two solutions, simultaneous merge of three so-
lutions into one, and crossover of two solutions in which a local minimum and saddle point interchange roles. The
events can be detected and classiﬁed by inspecting the determinants of two second-order response matrices. The
last two types of event occur only within sub-manifolds deﬁned by additional constraints not normally present in
the ODF solution. The nature of these constraints is deﬁned. The constrained events are interpreted in the context
of catastrophe theory, which describes dynamical systems that can exist in multiple states with the possibility of
discontinuous transitions between them. Within this theory they appear as narrowly avoided cusp catastrophes.
1. Introduction
When developing a computer animation of an object whose shape is
changing, it may be necessary to ﬁrst approximate the shape using a set of
splines which are more easily rendered than the original object. As the
object’s shape changes, two types of unexpected events may occur. First,
in order to produce a ﬁt whose error is minimized, it may be necessary to
undergo discontinuous changes in the ﬁtting parameters. Second, the
topology of the solution set may change due to solutions merging,
crossing each other, or being created. We investigate these events using
the Least Squares Orthogonal Distance Fitting method (ODF). It is typi-
cally used to ﬁt a spline to a set of discrete shape data [1]. Here we will
use it to generate solutions that undergo changes in topology when we ﬁt
a spline to a continuous two dimensional curve whose shape is changing.
Three types of topological events will occur. The most common event is
the annihilation of two solutions where one is a local minimum and the
other is a saddle point [[2], p.63]. This can be described as a fold ca-
tastrophe [3]. Less common is an event in which two equivalent solutions
(for example, saddle points) terminate when they meet a local minimum,
leaving only a single saddle point. In this case the two equivalent solu-
tions will have a symmetry that is twofold less than the solution they are
meeting. Finally, the most unusual event is one in which a saddle point
meets a local minimum, both with the same symmetry, and they inter-
change roles. This will be described below as a narrowly avoided cusp
catastrophe [3,4].
The fold catastrophe event does not require any additional constraints
to be met when it occurs: it happens simply as a result of the shape
change. The last two types, however, cannot occur unless additional
constraints are present. We will present two different views of these
additional constraints. The ﬁrst view is algebraic and takes the form of a
requirement that an “augmented” second-order response matrix must be
singular. The second view is geometric and takes the form of a plot of a
solution path relative to a catastrophe boundary. The algebraic method is
desirable because it is a precisely deﬁned local test. However, the ca-
tastrophe theory interpretation has a qualitative advantage in displaying
the relationship between multiple events: in the third type of event
described above, where a local minimum and saddle point interchange
roles during a narrowly avoided cusp catastrophe, we ﬁnd that the
interchange is always followed closely by a standard fold catastrophe in
which a local minimum and saddle point coalesce and disappear. The
algebraic method is not capable of linking these two events, but the ca-
tastrophe theory plot, Fig. 1, makes it qualitatively clear that these two
E-mail address: penner@vaxxine.com.
Contents lists available at ScienceDirect
Array
journal homepage: www.elsevier.com/journals/array/2590-0056/open-access-journal
https://doi.org/10.1016/j.array.2020.100046
Received 9 June 2020; Received in revised form 26 September 2020; Accepted 21 October 2020
Available online 3 November 2020
2590-0056/© 2020 The Author(s). Published by Elsevier Inc. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-
nc-nd/4.0/).
Array 8 (2020) 100046
events are related, and that it is highly unlikely that a solution crossover
could occur without the associated fold catastrophe. Fig. 1 displays a
system which has two independent degrees of freedom, A and B. The
solution, x, is a value that extremizes a potential energy function in
dynamical systems, or in our case extremizes an error function. It may
consist of either one or three values. If three solutions exist, one of them
(dotted line) will be unstable, while the other two (solid lines) are stable,
with the possibility of discontinuous jumps between them. The boundary
between these regions is shown as a curved line when projected onto the
A-B plane. The blue trajectory is a solution path that contains both a fold
catastrophe and a crossover event between stable and unstable solutions,
which has also been projected onto the A-B plane to show how it touches
the boundary.
Events of this type are well-known in topology, where they are clas-
siﬁed as being either “birth/death” events [5] or “interchange” events in
which the critical points survive. The interchange event is signiﬁcantly
more complex, and has been variously described as a switch [6], swap
[[7], Fig. 6], or F 1
β [[8], Fig. 3.1]. What is missing from these topological
treatments is a speciﬁcation of the constraints that need to be satisﬁed if
the two critical points are to, ﬁrst of all, touch, and secondly, survive and
interchange. These events are also well-known in bifurcation theory [9,
10], where an “interchange” event would be termed a transcritical bifur-
cation. In this case, some examples of the constraints that need to be
satisﬁed are given at the end of Sec. 5. The goal of the present study is to
deﬁne analogous constraints in the context of ODF. We will encounter
two distinct types of constraints (Secs. 6 and 7) which are sufﬁcient to
allow this to happen, in a problem which is otherwise quite simple.
The remainder of this paper is organized as follows. In Sec. 2 we
derive the generic ODF method, suitable for ﬁtting a continuous function.
The family of curves we are ﬁtting is described in Sec. 3, and the spline
curve in the ODF method is specialized to be a closed-shape Beta2-spline
[11]. Details of the optimization procedure are in Sec. 4, along with re-
sults. Sec. 5 deﬁnes the types of topological events that occur. Sec. 6
analyzes a symmetry-breaking event, while Sec. 7 analyzes a crossover
event. These sections contain explicit deﬁnitions of the constraints that
are satisﬁed in each case. Sec. 8 casts the above events into the language
of catastrophe theory.
2. Applying ODF to a parametric function
For the ODF method we follow closely the development of [[12],
Ch.2], which is a modiﬁed version of [1], to deal with the ﬁtting of
continuous curves rather than discrete data. Deﬁne fða;uÞ ¼ ðfx; fyÞ as the
two-dimensional spline we are adjusting to perform the ﬁt, while gðtÞ ¼
ðgx; gyÞ is a known parametric function to be ﬁt. f has adjustable pa-
rameters a, and a parametric variable u 2 ½0; N� where N is the number of
segments, while g will be chosen to be a superellipse [13] with para-
metric variable t 2 ½t1;t2�. g has an adjustable parameter ε, which we will
use to change the shape of the curve in order to see how the ﬁtted spline
responds. At each value of t we deﬁne the residual error as jjfða; uÞ �
gðtÞjj. In the ODF method we must adjust uðtÞ to minimize this distance,
which leads to the constraint:
ðfða; uÞ � gðtÞÞ � f
0ða; uÞ ¼ 0:
(1)
where f
0ða; uÞ ¼ ∂f=∂u. This simply states that the residual error vector
will be perpendicular to the curve fða;uÞ. The error functional is
Fða; uÞ ¼ 1
2
Z t2
t1
ðfða; uÞ � gðtÞÞ �ðfða; uÞ � gðtÞÞ dt:
(2)
We will optimize F with respect to changes in a while ensuring that
Eq. (1) is satisﬁed at all times. The optimization uses the Newton method
[[14], p.348] which relies on the fact that F can be locally approximated
by a quadratic form:
F ¼ F0 þ Lta þ 1
2atMa
(3)
where at ¼ ða1; …; anÞ, Lt ¼ ðL1; …; LnÞ, Li ¼ dF=dai, and M ¼
fd2F=daidajg
n
i;j¼1. The aim of the optimization is to ﬁnd the critical points
where L ¼ 0, while the rate of convergence to the optimum solution will
be governed by the second-order response matrix M. The character of the
solution, whether it is a minimum or saddle point, will be determined by
the eigenvalues of M. These eigenvalues are a measure of the curvature of
F when moving in the direction of the corresponding eigenvector. The
gradient L can be expressed [[12], Ch.2] as
Li ¼
Z t2
t1
ðfða; uÞ � gðtÞÞ � ∂f
�
∂ai dt
(4)
while the second order response is obtained [[12], Ch.2] as Mij ¼ R t2
t1
Gijða;uÞdt, where
Gij ¼ ∂f
� ∂ai � ∂f
� ∂aj þ ðfða; uÞ � gðtÞÞ � ∂2f
� ∂ai∂aj � EðuÞ∂u
� ∂ai
�∂u
� ∂aj
�
:
(5)
This contains the Hessian [[14], p.340] term ∂2f=∂ai∂aj, and a term in
∂u=∂aið∂u =∂ajÞ, which represents the contribution caused by the fact that
Eq. (1) is satisﬁed at all times. To evaluate this term we use the rela-
tionship [[12], Ch.2]:
EðuÞ∂u = ∂ai ¼ � f
0ða; uÞ � ∂fða; uÞ = ∂ai � ðfða; uÞ � gðtÞÞ � ∂f
0ða; uÞ = ∂ai
(6)
where
EðuÞ ¼ f
0ða; uÞ � f
0ða; uÞ þ ðfða; uÞ � gðtÞÞ � f00ða; uÞ:
(7)
The optimization proceeds [[12], Eq.2.9] by successively solving the
equation
Mða � a0Þ ¼ � L
(8)
to calculate the latest increment in the vector a, given the previous es-
timate a0. The system of equations, Eq. (1) and Eq. (8), are solved using
the “variable-separation” method [1] with a tolerance of 10�9 in both the
inner and outer loops. Further computational details are available in
[[12], Ch.2].
Fig. 1. Example of a cusp catastrophe, with a solution trajectory that contains
both a fold catastrophe and a crossover event between stable and unsta-
ble solutions.
A. Penner
Array 8 (2020) 100046
2
3. Deﬁnition of spline f(a, u) and parametric curve g(t)
The function gðtÞ is taken from the family of curves in Fig. 2. These are
superellipses [13]:
gðtÞ ¼ ðaðcostÞε; aðsintÞεÞ
(9)
where we will set a ¼ 180 to facilitate comparison with [15] for the case
of a circle (ε ¼ 1). The curves have a fourfold rotation symmetry and a
reﬂection symmetry about an axis at 45�. This symmetry is denoted C4v in
[[16], p.60]. We will attempt to ﬁt the curves over the range 0 < ε < 2,
which allows the curvature at some endpoints to range from zero to
inﬁnity.
When specifying fða; uÞ we need to use at least an 8-point uniform
closed cubic B-spline, in order to emulate the symmetry of gðtÞ. We also
wish to produce a ﬁt that is accurate to 6th order with respect to arc angle
of each segment [17]. This requires that the curvature at each knot must
be independently variable, which is not possible in a B-spline. We
therefore generalize to a Beta2-spline, which relaxes the continuity re-
quirements at a knot from C 2 to G 2 (geometric continuity) [[11],
p.294]. We will decompose the Beta2-spline into eight cubic B�ezier
segments, and constrain the B�ezier control arms to be consistent with
[[11], Eq.14.3] with β1 ¼ 1. Note that this spline is not clamped to gðtÞ at
any point, and that the slopes at each knot are not constrained. Therefore,
deﬁne the parameter vector a using the eight B�ezier endpoints and the
corresponding β2 values: a ¼ fx0 � x7; y0 � y7; β20 � β27g.
If we deﬁne a B�ezier segment i, Fig. 2, with the four control points
fR0i � R3ig, then the control arm at the start point of this segment is
given by di ¼ R1i � R0i. The control arms are symmetric at each node
since β1 ¼ 1 [[11], Eq.14.2]. Therefore the control arm at the endpoint of
this segment, namely R2i � R3i, is equal to � diþ1, so it is redundant.
From [[11], Eq.14.3] we ﬁnd that the components (dxi, dyi) of these
control arms can be evaluated independently using the equation:
Δw ¼ Cdw for w 2 fx; yg
(10)
where Δwi ¼ wðiþ2Þ mod 8 � wi for i 2 ½0; 7�. The matrix C is given by:
Cij ¼
8
>
>
<
>
>
:
1
for j ¼ i and i 2 ½0; 7�
4 þ β2i=2
for j ¼ ði þ 1Þ mod 8
1
for j ¼ ði þ 2Þ mod 8
0
otherwise:
(11)
The relationship between di and β2i is generally an inverse one: higher
β2i (sometimes referred to as tension [[11], p.307]) leads to shorter B�ezier
arm length di. For the special case where all β2i are the same, we ﬁnd that
C is singular at β2i ¼ � 4. Therefore we anticipate that (roughly) � 4 <
β2i < ∞. These are consistent with the limits highlighted in the work of
de Tisi and Rossini [18]. In practice, the lowest value observed here is
β2 ¼ �3:995 for a solution with radial symmetry, which did not lead to
an abnormal termination, while the upper limit was approached on ﬁve
occasions, all of which led to abnormal terminations of the solution.
4. Optimization of a Beta2-Spline
The optimization requires the ﬁrst-order response, Eq. (4), where ∂
fða; uÞ=∂ai is given by the special cases:
dfw
.
dwi ¼ ∂fw
.
∂wi þ
X
j
�∂fw
� ∂dwj
�∂dwj
.
∂wi for w 2 fx; yg
(12)
dfw
.
dβ2i ¼
X
j
�∂fw
� ∂dwj
�∂dwj
.
∂β2i for w 2 fx; yg
where the summation includes only two B�ezier control arms, dj, per
segment. The terms ∂fw=∂wi and ∂fw=∂dwj are straightforward functions
only of u. From Eq. (10) we obtain:
∂dwj
.
∂wi ¼ C�1
j;ði�2Þ mod 8 � C�1
j;i for w 2 fx; yg
(13)
∂dwj
.
∂β2i ¼ � C�1
j;ði�1Þ mod 8dwi
.
2for w 2 fx; yg
The response ∂f
0ða; uÞ=∂ai in Eq. (6) is obtained directly from this by
differentiation. The Hessian terms ∂2f=∂ai∂aj in Eq. (5) are zero unless
they involve ∂=∂β2:
d2fw
.
dwidβ2j ¼
X
k
ð∂fw = ∂dwkÞ∂2dwk
.
∂wi∂β2jfor w 2 fx; yg
(14)
d2fw
.
dβ2idβ2j ¼
X
k
ð∂fw = ∂dwkÞ∂2dwk
.
∂β2i∂β2jfor w 2 fx; yg
where the summation includes only two B�ezier control arms. Application
of the operator ∂2=∂wi∂β2j or ∂2=∂β2i∂β2j to Eq. (10) leads to:
∂2dwk
.
∂wi∂β2j ¼ � C�1
k;ðj�1Þ mod 8∂dwj
.
∂wi
.
2for w 2 fx; yg
(15)
∂2dwk
.
∂β2i∂β2j ¼ � C�1
k;ði�1Þ mod 8∂dwi
.
∂β2j
.
2for w 2 fx; yg
�C�1
k;ðj�1Þ mod 8∂dwj
.
∂β2i
.
2:
This completes the calculation of the optimization equations.
The results of the optimization are best displayed in radial co-
ordinates. The radius of the B�ezier endpoints is not very informative since
it is always very close to the corresponding radius of gðtÞ. The angle of the
endpoints, however, gives useful information on symmetry. The function
gðtÞ has eightfold symmetry, C4v, but the solution fða; uÞ may have lower
symmetry than this. If so, then the solution set will always contain
multiple branches which are complements of each other with the same
root-mean-square (rms) error, such that the set of all complementary
branches has C4v symmetry. Fig. 3 shows the variable θ0 for the B�ezier
endpoint ðx0; y0Þ over the range 0:6 < ε < 1:4. The B�ezier endpoints are
indexed starting in the fourth quadrant, so typically � 90 < θ0 < 0. The
ﬁgure shows two branches that have C4v symmetry: a “radial” branch
with variable θ0 (θ1 ¼ �90 � θ0 and r0 ¼ r1), and an “angular” branch
with r0 < r1 and θ0 ¼ �45 (θ1 ¼ 0). Typical B�ezier endpoints for these
two branches are shown in Fig. 2 for ε ¼ 0:6. These are the only two
branches that have the full eightfold symmetry. In addition there are two
branches with fourfold rotational symmetry, C4. These come in pairs
which are reﬂections of each other about an axis at 45�. They are termed
“bridge” solutions because they can connect the angular and radial
Fig. 2. A family of superellipse curves at different ε. The points are B�ezier
endpoints for two solution branches at ε ¼ 0:6. Also shown is a typical B�ezier
segment with endpoints (R0; R3) and control points (R1; R2).
A. Penner
Array 8 (2020) 100046
3
branches of higher symmetry. The left bridge solution, which exists only
for ε < 1, is approaching an angular solution at ε ¼ 1. The right bridge
solution, which begins as a bifurcation from the radial branch at ε ¼
1:308, will touch an angular solution at ε ¼ 1 in Fig. 4, and then
approach a different angular branch at ε ¼ 1 after reversing direction at
ε ¼ 0:978. These are never optimal solutions but serve an essential to-
pological function which will be deﬁned below.
Fig. 3 does not contain much information on the eightfold symmetric
branches, other than an afﬁrmation of the symmetry. The details of the
shape are given by the β2i values. Since we have nothing to compare the
β2i with, we choose to re-express them as B�ezier control arm lengths, di ¼
jdij, using Eq. (10). For the special case of a circle, ε ¼ 1, these arm
lengths can be compared directly to [[15], Fig. 6]. There are very slight
differences due to the fact that the current Beta2-spline is not clamped at
the endpoints, but otherwise the two sets of solutions are qualitatively
the same for the case of a circle. In Refs. [15] the “angular” solutions for
the circle were subdivided into two classes: an “S-shaped” branch which
includes both a symmetric (d0 ¼ d1) solution which is a local minimum
and two asymmetric branches which are also local minima, but less
optimal, and an “oval-shaped” branch which contains two saddle points.
This terminology is used in the current ﬁt as well. Fig. 4 shows the arm
lengths for the range of interest. For the S-shaped and Oval branches, d0
and d1 are distinct, for the Radial branch they are equal, and for the
Bridge solutions they interchange places as we switch between the two
complementary branches of the solution.
A primary goal of the current study is to analytically distinguish be-
tween the S-shaped and Oval branches, since they are qualitatively
different, and since they intersect at ε ¼ 0:96323. The S-shaped branch is
qualitatively obtainable by ﬁtting curvature at the B�ezier endpoints,
while the Oval branch is qualitatively the result of extremizing the < y
0 >
moment of the B�ezier curve [15]. A secondary goal is to understand the
constraints that make the bifurcation of the Radial branch at ε ¼ 1:308
possible.
Fig. 5 shows the rms error. For ε > 1 there are ﬁve distinct unexpected
terminations of either the S-shaped or Oval branches caused by β2 → ∞,
with either d0 or d1 approaching zero. There is also one instance of a
narrowly avoided singularity caused by β2 → �4 in the Radial solution at
ε ¼ 1:69. However, the choice of optimum solution is unambiguous for
ε > 1. For ε < 1 the optimum solution path has a discontinuous jump
from the S-shape branch to the Oval branch at ε ¼ 0:953 followed by a
continuous crossover of these two branches at ε ¼ 0:96323, which will
be investigated below. The Oval branch also has a fold catastrophe at
ε � 0:91, which terminates in a manner that is consistent with [[2],
p.67], namely ΔF∝
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðε � ε0Þ3
q
, where ε0 is the point where the merge
occurs.
5. Two types of topological events
For each solution branch, the eigenvalues of M determine whether the
solution is a minimum or saddle point. More generally, the Morse index
[[2], p.55], which counts the number of negative eigenvalues [[19],
Sec.3], will determine the multiplicity of the saddle points, if they exist.
Since the object we are ﬁtting is a closed shape, we anticipate that the
number of local minima at each ε should equal the number of saddle
points. Fig. 6 shows the lowest eigenvalues, eig0, for the four types of
branches. The plot often has cusps because it is quite common for
different eigenvalues of the same solution to cross each other without
interacting. We are interested only in the instances where an eigenvalue
crosses zero or terminates at zero, which signals a topological event. The
rule for these events (if higher order saddle points are involved) is that
Euler’s characteristic number [19] must be preserved [[20], Fig. 3–22,
p.149]. In simplest terms this states that one local minimum must cancel
one saddle point, which is the case for a fold catastrophe, or that a single
saddle point must cancel a “2-saddle point” (Morse index ¼ 2) [19]. In
Fig. 6, we see that at ε ¼ 1.4 the S-shape solution is a local minimum and
Fig. 3. B�ezier end point angle θ0 as a function of ε. Three solution branches
are shown.
Fig. 4. B�ezier control arm lengths d0 and d1 as a function of ε. The Angular
solution branch is subdivided into S-shape and Oval branches.
Fig. 5. Logarithm of rms error as a function of ε.
A. Penner
Array 8 (2020) 100046
4
the Radial solution is a saddle point, so the set of solutions is topologi-
cally balanced. However, at ε ¼ 1:308 the Radial solution becomes a
local minimum, so we now require two saddle points to balance this
change. These are provided by the two fourfold symmetric bridge solu-
tions for ε < 1:308, which serve an essential topological function even
though they are not optimal ﬁts. This event will be called a “3–1 termi-
nation” event, Sec. 6, in which a pair of solutions of lower symmetry
terminates and changes the character of a higher symmetry branch. This
is an example of a pitchfork bifurcation [[3], Fig. 7], which is normally
associated with symmetry-breaking [[9], p.55]. It is made possible by the
symmetry properties of the solutions that contribute to it [[3], Sec.10].
The left hand side of Fig. 6 shows a different type of topological event.
At ε ¼ 0:6 the solution set is topologically balanced, with S-shape and
Radial minima, and a pair of saddle points in the Bridge solution. At ε ¼
0:96323 we encounter a “2-2 crossover” in which a saddle point in the S-
shape branch crosses a local minimum in the Oval branch and in-
terchanges character with it, Sec. 7. In this case both branches are
eightfold symmetric and neither disappears. This is an example of a
transcritical bifurcation [9,10]. Bifurcations of this type always require an
additional constraint to be met. In [[9], Sec.3.2] it is the requirement that
one ﬁxed point must remain constant while another ﬁxed point crosses
over it, where the term “ﬁxed point” refers to an equilibrium solution of a
differential equation. In [[10], Fig.1.3a] it is the constraint α ¼ β, which
leads to a special type of imperfect bifurcation (In [[3], Fig.18], this same
constraint is re-expressed as b ¼ � a3.). The need for an additional
constraint to explain ODF solution crossovers was also discussed in [[12],
Sec.5.2]. In the context of ODF, the constraint is that two second-order
response matrices are simultaneously singular, which leads to a smooth
crossover of solutions rather than an avoided crossing or an abnormal
termination.
6. Response to a change in shape: “3–1 termination”
The rest of this paper discusses methods of detecting such events
analytically and categorizing them graphically. The question is: why are
these solutions well-behaved when they meet? The matrix M has singu-
larities at each event; therefore, according to Eq. (8), we should see a
singularity in da=dε, but Fig. 4 shows no such effect. To explain this we
need to develop an analytical expression for da=dε, evaluated under the
constraints that Li ¼ 0 and Eq. (1) are both satisﬁed at all times.
Following the derivation of [[12], Eq.5.5], we ﬁnd:
Mðda = dεÞ þ Y ¼ 0
(16)
where Yi ¼ d2F=daidε ¼ R t2
t1 I iða;uÞdt, and
I iða;uÞ¼∂ðf �gÞ
�∂ε�∂f
�∂ai þðf �gÞ�∂2f
�∂ε∂ai �EðuÞ∂u
�∂εð∂u=∂aiÞ:
(17)
This requires the calculation of ∂u=∂ε, which is given by
EðuÞ∂u = ∂ε ¼ � f
0ða; uÞ � ∂ðfða; uÞ � gðtÞÞ = ∂ε � ðfða; uÞ � gðtÞÞ � ∂f
0ða; uÞ = ∂ε:
(18)
To interpret Eq. (16) we switch to a representation in which M is
diagonalized. Deﬁne a unitary transform U, such that UtMU ¼ D (diag-
onal). Equation (16) can be rewritten as DUtðda =dεÞ þ UtY ¼ 0. Now we
see that, if a given eigenvalue, D00, is zero, and if the corresponding
response, Ut
0ðda =dεÞ, is to be well-behaved, then it is necessary that
Ut
0Y ¼ 0, where U0 is the eigenvector associated with D00.
We wish to test this assertion on the Radial branch at ε ¼ 1.308. On
both sides of this event the solution vector a shows the pattern:
a∝ðA; B; B; A; �A; �B; �B; �A;
�B; �A; A; B; B; A; �A; �B; C; C; C; C; C; C; C; CÞ8 2
(19)
where, in this case, A ¼ x0 and B ¼ x1. The vector Y shows the same
pattern, with different values for A and B. The eigenvector U0 shows the
pattern:
U0∝ðE; F; �F; �E; �E; �F; F; E;
F; E; E; F; �F; �E; �E; �F; �G; G; �G; G; �G; G; �G; GÞ8 2
(20)
The dot product of these two vectors, Ut
0Y, is zero by symmetry, as
expected. Therefore it is reasonable to expect that da=dε will be well-
behaved on this branch even though the eigenvalue is going through
zero. Note that this orthogonality does not exist on the lower symmetry
Bridge solutions which are terminating at this point, leading to inﬁnite
slope in dθ0=dε in Fig. 3.
An alternate way of viewing the same issue is to deﬁne an
“augmented” Mþ matrix:
Mþ
ij ¼ Mij for fi; jg 2 ½1; n�
Mþ
i;nþ1 ¼ Mþ
nþ1;i ¼ Yi ¼ d2F
.
daidε for i 2 ½1; n�
Mþ
nþ1;nþ1 ¼ d2F
.
dε2
(21)
where d2F=dε2 ¼ R t2
t1 J ða;uÞdt, and
J ða;uÞ¼∂ðf�gÞ
�∂ε�∂ðf�gÞ
�∂εþðf�gÞ�∂2ðf�gÞ
�∂ε2�EðuÞ∂u
�∂εð∂u=∂εÞ:
(22)
The augmented matrix Mþ is essentially the second-order response
matrix obtained if we admit the variable ε as a new independent variable,
comparable to faig, the only difference being that F is not stationary with
respect to changes in ε. It plays a role analogous to the “tangent space”
TG [[10], Eq.2.2] and [[3], p.208].
Comparison of the eigenvalues of M and Mþ can be informative. If
D00 is an eigenvalue of M, and if Ut
0Y ¼ 0, then it will also be an
eigenvalue of Mþ as well, where the augmented eigenvector is just U0
with an additional zero at the end. Fig. 6 shows the eigenvalue of Mþ that
is closest to zero, denoted aug0. For the eightfold symmetric Radial
branch there is always an augmented eigenvalue that agrees with eig0 at
all ε. This is the reason why this branch is able to have zeros in eig0 while
still being well-behaved. For the Bridge solution this is not normally the
case, although the ﬁgure shows that eig0 and aug0 both approach zero at ε
¼ 1.308.
The augmented matrix has been previously deﬁned in a similar
context [[2], p.66]. In that discussion it was stated that M and Mþ cannot
simultaneously be singular because there are not sufﬁcient degrees of
freedom to allow this to happen [[2], p.60, Assumption A]. Normally, of
course, this is true: we have only one degree of freedom, ε, so we cannot
simultaneously satisfy two constraints. Therefore the only way for this to
be possible is if there are additional constraints in operation such that
both matrices can be made to be singular on a sub-manifold of the so-
lution space. (A similar statement is made in Ref [[10], Eq.2.10]. with
reference to a bifurcation point [[10], Fig.2.1a]). In the present example,
Fig. 6. Lowest eigenvalues of M (eig0) and Mþ (aug0) as a function of ε. aug0 is
shown only for the Bridge solution, for simplicity.
A. Penner
Array 8 (2020) 100046
5
“3–1 termination”, the additional constraint is symmetry, which allows
symmetric solutions to intersect with asymmetric solutions without
pathological behavior. In the next section an alternative constraint is
described which also allows two solution branches to cross each other
and interchange roles without singular behavior. This allows [[2], p.60,
Assumption A] to be violated due to the presence of a newly deﬁned
sub-manifold.
7. Response to a change in shape: “2-2 crossover”
This event consists of an intersection between the S-shaped and Oval
branches in Fig. 4 at ε ¼ 0.96323. At a ﬁrst glance, it appears that three
branches (two minima plus a saddle point) have simultaneously coa-
lesced to produce a single minimum. Upon closer inspection we ﬁnd
(Fig. 7a) that there are two distinct events, both of which involve only
two branches. (Note the similarity of Fig. 7a to [[10], Fig.1.3a] and to
[[3], Fig.18] for the intermediate cases where b ¼ � a3). At ε ¼ 0.9631 a
local minimum and a saddle point coalesce and disappear in a fold ca-
tastrophe. At this point eig0 ¼ 0 and the slope in Fig. 7a is inﬁnite. At ε ¼
0.96323 the two branches cross each other at ﬁnite slope in Fig. 7a with
an interchange of character from minimum to saddle point and vice-versa
(This was previously termed a Type 2 crossover in [[12], Chap.5]. It has
also been called an “interchange event” in Ref. [[7], Fig. 6], “height
switch” in Ref. [6], and F 1
β in Ref. [[8], Fig. 3.1].). In this case both M
and Mþ are singular. As before, the simultaneous singularity of these two
matrices is a necessary condition for da=dε to be well-behaved. There are
two questions that need to be addressed: where do we ﬁnd the necessary
degrees of freedom to make M and Mþ simultaneously singular, and are
these two events related (could a “2-2 crossover” occur without a cor-
responding fold catastrophe)? The ﬁrst question can be answered alge-
braically, while the answer to the second question is most easily
demonstrated using catastrophe theory (Sec. 8).
As noted in Sec. 4, the S-shape branch is a “typical” solution in that it
is qualitatively comparable to ﬁtting curvature at the endpoints. The
oval-shaped solution is abnormal since it is related to an extremum of the
< y
0 > moment. Upon closer inspection, we ﬁnd that the oval-shaped
solution yields an unexpected relationship, which is not true on the S-
shape branch: the variables ðfða; uÞ �gðtÞÞ � ∂f=∂ai are linearly dependent
on each other 8t. Combining this with Eq. (1) we obtain the more general
expression
f
0ða; uÞ ¼ hðuÞ
X
n
i¼1
μi∂f
.
∂ai
(23)
in which hðuÞ is to be determined and μi are functions of ε but not u. The
calculation of μi will be described below (Sec. 7.1). For now we note an
interesting consequence of Eq. (23). From Eq. (4) and Eq. (23) we have:
X
n
i¼1
μiLi
¼ Rt2
t1
ðfða; uÞ � gðtÞÞ � P
n
i¼1
μi∂f
�
∂aidt
¼ Rt2
t1
ðfða; uÞ � gðtÞÞ � f
0ða; uÞ
hðuÞ dt
¼ 0
(24)
where we have used Eq. (1). This equation represents a new constraint on
the fLig: this releases one of the original constraints we would normally
impose on L, which gives us a new degree of freedom we may be able to
use to set the determinant of Mþ to zero. In effect, it deﬁnes a sub-
manifold within which a crossing of solutions becomes theoretically
possible. We now need to derive appropriate conditions for this to occur.
The function hðuÞ can be calculated as follows. Taking a derivative of
Eq. (23) we ﬁnd:
f00ða; uÞ
¼ hðuÞ P
n
i¼1
μi∂f
0.
∂ai þ h
0ðuÞ
X
n
i¼1
μi∂f
.
∂ai
¼ hðuÞ P
n
i¼1
μi∂f
0�
∂ai þ h
0ðuÞ
hðuÞf
0ða; uÞ:
(25)
Substitute this into Eq. (7) to obtain:
EðuÞ ¼ f
0ða; uÞ � f
0ða; uÞ þ hðuÞðfða; uÞ � gðtÞÞ �
X
n
i¼1
μi∂f
0 .
∂ai
(26)
where we have used Eq. (1) to eliminate the term h
0ðuÞðfða; uÞ � gðtÞÞ �
f
0ða;uÞ=hðuÞ, which is zero. Now operate on Eq. (6) to obtain:
EðuÞ
X
n
i¼1
μi∂u
.
∂ai
¼ �f
0ða;uÞ�
X
n
i¼1
μi∂f
.
∂ai �ðfða;uÞ�gðtÞÞ�
X
n
i¼1
μi∂f
0.
∂ai
¼ �f
0ða;uÞ�f
0ða;uÞ
.
hðuÞ�ðfða;uÞ�gðtÞÞ�
X
n
i¼1
μi∂f
0.
∂ai:
(27)
Comparing this to Eq. (26) we ﬁnd:
hðuÞ
X
n
i¼1
μi∂u
.
∂ai ¼ � 1
(28)
where hðuÞ can be viewed as a scalar normalization function in Eq. (23). If
we eliminate hðuÞ from these equations we can obtain a further inter-
esting constraint. Substitute Eq. (28) into Eq. (23) to obtain:
f
0ða; uÞ ¼ �
X
n
i¼1
μi∂f
,
∂ai
, X
n
i¼1
μi∂u = ∂ai
(29)
Fig. 7. Solution properties versus ε during a crossover event between the Oval and S-shaped branches. Also shown is the associated fold catastrophe event.
A. Penner
Array 8 (2020) 100046
6
f
0ða; uÞ
X
n
i¼1
μi∂u
.
∂ai þ
X
n
i¼1
μi∂f
.
∂ai ¼ 0
(30)
X
n
i¼1
μi½∂f = ∂ai þ f
0ða; uÞ∂u = ∂ai� ¼ 0
(31)
which represents a new constraint on the total response of fða; uÞ with
respect to a, which is valid only on the oval-shaped branch. We note in
passing that analogous constraints have also been found to be satisﬁed on
oval-shaped branches of the ODF solutions obtained when ﬁtting a
clamped cubic and/or quartic B�ezier to a 45� segment of gðtÞ, where gðtÞ
is a hypoTrochoid shape with C4v symmetry [[12], Chaps.4, 8]. In this
case they are also associated with a “2-2 crossover”.
7.1. Implications for M
In order to deﬁne this class explicitly, we need to calculate fμig. Begin
with Eq. (23) and express it as a parallel relationship:
f
0ða; uÞ
���
X
4
i¼1
μi∂f
.
∂ai
f
0
y
f
0
x
¼
X4
i¼1μi∂fy
�∂ai
X4
i¼1μi∂fx=∂ai
;
(32)
where the sum extends over all the independent variables ai. Here we will
make use of the eightfold symmetry of the Oval solution to simplify the
representation. Deﬁne the B�ezier control arms for one segment as in
Ref. [[15], Fig. 1]:
R1 ¼ ðX1; Y1Þ ¼ ðX0 � d1sinθ1; Y0 þ d1cosθ1Þ
R2 ¼ ðX2; Y2Þ ¼ ðX3 þ d2sinθ2; Y3 � d2cosθ2Þ
(33)
where R0 and R3 are the endpoints. The angles θ1 and θ2, of R0 and R3,
are ﬁxed by symmetry, so the independent variables are a ¼ ðd1;d2;R0;
R3Þ. Express fða; uÞ in terms of Bernstein polynomials [[11], p.224], and
re-express Eq. (32) as
Y0B’
03 þ ðY0 þ d1cosθ1ÞB’
13 þ Y3B’
33 þ ðY3 � d2cosθ2ÞB’
23
X0B’
03 þ ðX0 � d1sinθ1ÞB’
13 þ X3B’
33 þ ðX3 þ d2sinθ2ÞB’
23
¼ μ1B13cosθ1 þ μ3ðB03 þ B13Þsinθ1 � μ2B23cosθ2 þ μ4ðB23 þ B33Þsinθ2
�μ1B13sinθ1 þ μ3ðB03 þ B13Þcosθ1 þ μ2B23sinθ2 þ μ4ðB23 þ B33Þcosθ2
:
(34)
Use the relationship B0i;n ¼ nðBi�1;n�1 �Bi;n�1Þ and rearrange:
where
ΔX ¼ X3 � X0 þ d1sinθ1 þ d2sinθ2
ΔY ¼ Y3 � Y0 � d1cosθ1 � d2cosθ2:
(36)
Now multiply through by both denominators and organize the terms
according to their use of the functions uið1 � uÞj where i þ j ¼ 5. We ﬁnd
that the term in ð1 � uÞ5, obtained by multiplying B02B03, is satisﬁed only
if μ3 ¼ 0. Similarly, the term in u5 requires μ4 ¼ 0. Substituting these two
results in, the remaining terms are equated below:
factor
left hand side
right hand side
uð1 � uÞ4
� μ1d1sinθ1cosθ1
� μ1d1sinθ1cosθ1
u2ð1 � uÞ3
μ2d1sinθ2cosθ1 � 2μ1ΔYsinθ1
μ2d1cosθ2sinθ1 þ 2μ1ΔXcosθ1
u3ð1 � uÞ2
� μ1d2sinθ1cosθ2 þ 2μ2ΔYsinθ2
� μ1d2cosθ1sinθ2 � 2μ2ΔXcosθ2
u4ð1 � uÞ
μ2d2sinθ2cosθ2
μ2d2sinθ2cosθ2
The ﬁrst and last rows are satisﬁed trivially, which leaves only two
constraints on fμig. These can be expressed as:
�
�2Δ1 � 2d2sinðθ2 � θ1Þ
d1sinðθ2 � θ1Þ
d2sinðθ2 � θ1Þ
2Δ2 � 2d1sinðθ2 � θ1Þ
�� μ1
μ2
�
¼ 0
(37)
where Δi ¼ ðX3 � X0Þcosθi þ ðY3 � Y0Þsinθi. We ﬁnd, as expected, that
this matrix is singular at all times on the oval-shaped branch in Fig. 7, so
the fμig can be calculated to within a normalization constant. Since this
constraint does not involve μ3 or μ4, we also ﬁnd that it is equally
applicable to the case of a clamped cubic B�ezier segment [[12], Chap.5].
Given fμig, we wish to work out the consequences for M. Beginning
with Eq. (5), and noting that the Hessian terms are zero within this
particular symmetric representation, we have
X
4
j¼1
μjGij ¼ ∂f
,
∂ai �
X
4
j¼1
μj∂f
,
∂aj � EðuÞ∂u
,
∂ai
X
4
j¼1
μj∂u
,
∂aj
¼
1
hðuÞ∂f
�
∂ai � f
0ða; uÞ þ
1
hðuÞ EðuÞ∂u
�
∂ai
(38)
where we have used Eq. (23) and Eq. (28). Now use Eq. (6) to eliminate
EðuÞ and integrate Gij to obtain:
X
4
j¼1
μjMij ¼ �
Z t2
t1
1
hðuÞ ðfða; uÞ � gðtÞÞ � ∂f
0 �
∂aidt8i
(39)
These equations provide a new mechanism by which M may become
singular, one which is unique to the oval-shaped branch: by setting
P4
j¼1μjMij ¼ 0 8i. We have conﬁrmed computationally that these zeros
in Eq. (39) occur 8i during a “2-2 crossover”, leading to a singular M.
7.2. Implications for Mþ
By itself, a singular M is not a surprising event; what is of interest is
whether the Mþ matrix will simultaneously become singular. From Eq.
(17), and noting that the Hessian term is zero, we ﬁnd:
X
4
i¼1
μiI iða; uÞ ¼ ∂ðf � gÞ
,
∂ε �
X
4
i¼1
μi∂f
,
∂ai � EðuÞ∂u
,
∂ε
X
4
i¼1
μi∂u
,
∂ai
¼
1
hðuÞ∂ðf � gÞ
�
∂ε � f
0ða; uÞ þ
1
hðuÞ EðuÞ∂u
�
∂ε
(40)
where we have used Eq. (23) and Eq. (28). Now use Eq. (18) to eliminate
EðuÞ and integrate I iða; uÞ to obtain:
d1cosθ1B02 þ d2cosθ2B22 þ ΔYB12
�d1sinθ1B02 � d2sinθ2B22 þ ΔXB12
¼ μ3sinθ1B03 þ μ4sinθ2B33 þ ðμ1cosθ1 þ μ3sinθ1ÞB13 þ ð � μ2cosθ2 þ μ4sinθ2ÞB23
μ3cosθ1B03 þ μ4cosθ2B33 þ ð � μ1sinθ1 þ μ3cosθ1ÞB13 þ ðμ2sinθ2 þ μ4cosθ2ÞB23
(35)
A. Penner
Array 8 (2020) 100046
7
X
4
i¼1
μid2F
�
daidε ¼ �
Z t2
t1
1
hðuÞ ðfða; uÞ � gðtÞÞ � ∂f
0 �
∂εdt:
(41)
We wish to determine whether the right hand side of Eq. (41) will go
to zero simultaneously with the right hand sides of Eq. (39) 8i. This
would mean that a singular M, as deﬁned by Eq. (39), would also lead to a
singular Mþ. For the present, unclamped, spline this is trivially true, since
∂f
0=∂ε ¼ 0 by deﬁnition. For a clamped spline [15], a proof is required. In
this case a sufﬁcient condition for this to occur is:
f
0ða; uÞ k ν0∂f
0 .
∂ε þ
X
2
i¼1
νi∂f
0.
∂ai8u
(42)
where fνig are constant with respect to u, and we have used the fact that
Eq. (1) is satisﬁed 8u. The sum extends over fd1; d2g. We now need to
relate fνig to fμig, to conﬁrm that they exist. Compare this equation to
Eq. (32) to obtain:
ν0∂f
0 .
∂ε þ
X
2
i¼1
νi∂f
0.
∂ai k
X
2
i¼1
μi∂f
.
∂ai:
(43)
Express fða; uÞ in terms of Bernstein polynomials and Eq. (33):
ν0
��
B
0
03 þ B
0
13
�
sinθ1 �
�
B
0
23 þ B
0
33
�
sinθ2
�
þν1B13’cosθ1 � ν2B23’cosθ2
ν0
��
B
0
03 þ B
0
13
�
cosθ1 �
�
B
0
23 þ B
0
33
�
cosθ2
�
�ν1B13’sinθ1 þ ν2B23’sinθ2
¼ μ1B13cosθ1 � μ2B23cosθ2
�μ1B13sinθ1 þ μ2B23sinθ2
(44)
where we have used the deﬁnition of the hypoTrochoid gðtÞ in Ref. [15]
to calculate the response ð∂f
0 =∂εÞ of the endpoints to a change in ε, which
is called c in Ref. [15]. Now use the relationship B0i;n ¼ nðBi�1;n�1 �
Bi;n�1Þ:
�ν0B12ðsinθ1 þ sinθ2Þ
þν1ðB02 � B12Þcosθ1 � ν2ðB12 � B22Þcosθ2
�ν0B12ðcosθ1 þ cosθ2Þ
�ν1ðB02 � B12Þsinθ1 þ ν2ðB12 � B22Þsinθ2
¼ ð1 � uÞμ1cosθ1 � uμ2cosθ2
�ð1 � uÞμ1sinθ1 þ uμ2sinθ2
(45)
where we have canceled a common factor of uð1 �uÞ on the right hand
side. Multiply through by both denominators and organize the terms
according to their use of the functions uið1 � uÞj where i þ j ¼ 3:
factor
left hand side
right hand side
ð1 � uÞ3
� μ1ν1sinθ1cosθ1
� μ1ν1sinθ1cosθ1
uð1 � uÞ2
2μ1ν0sinθ1ðsinθ1 þ sinθ2Þ
þ2μ1ν1sinθ1cosθ1
þμ2ν1cosθ1sinθ2
þ2μ1ν2sinθ1cosθ2
�2μ1ν0cosθ1ðcosθ1 þ cosθ2Þ
þ2μ1ν1sinθ1cosθ1
þμ2ν1sinθ1cosθ2
þ2μ1ν2cosθ1sinθ2
u2ð1 � uÞ
�2μ2ν0sinθ2ðsinθ1 þ sinθ2Þ
�2μ2ν1cosθ1sinθ2
�μ1ν2sinθ1cosθ2
�2μ2ν2sinθ2cosθ2
2μ2ν0cosθ2ðcosθ1 þ cosθ2Þ
�2μ2ν1sinθ1cosθ2
�μ1ν2cosθ1sinθ2
�2μ2ν2sinθ2cosθ2
u3
μ2ν2sinθ2cosθ2
μ2ν2sinθ2cosθ2
The ﬁrst and last rows are satisﬁed trivially, which leaves only two
constraints on fνig. These can be expressed in matrix form:
�
ð2μ1�4μ2Þ½1þcosðθ2�θ1Þ� �3μ2sinðθ2�θ1Þ
0
ð4μ1�2μ2Þ½1þcosðθ2�θ1Þ�
0
�3μ1sinðθ2�θ1Þ
�0
@
ν0
ν1
ν2
1
A¼0:
(46)
These constraints can always be satisﬁed to within a normalization
constant: for example, we ﬁnd ν1=ν0 is a linear function of μ1= μ2.
Therefore we conclude that Mþ may become singular simultaneously
with M, and that this is possible only on the sub-manifold represented by
the oval-shaped solution in Fig. 7.
We note, ﬁnally, that the same sub-manifold also exists in the ODF ﬁt
of a quartic B�ezier to a hypoTrochoid curve [[12], Chap.8]. In this case
we have four degrees of freedom instead of two, but otherwise the
speciﬁcation of fμig and fνig proceeds in the same way as above.
8. Modeling an avoided catastrophe
We wish to re-express these events in the language of catastrophe
theory, which is visually more informative. In order to model events
involving three critical points we deﬁne s, a one-dimensional streamline
[21,5] joining the critical points, and assume that FðsÞ is approximated by
a quartic function along this path:
F ¼ s4�
4 þ As2�
2 þ Bs:
(47)
In this equation all the parameters which affect only the scaling and
positioning have been removed, leaving only two parameters which
control the shape. This can be used to describe a cusp catastrophe [3,4].
The function F has three critical points when
B2 �
4 þ A3�
27 < 0:
(48)
Otherwise it has only one critical point. The boundary curve, Eq. (48),
is shown in Fig. 8 and Fig. 1.
We wish to show that both the 3–1 termination and the 2-2 crossover
events are represented by a tangential touching of the boundary curve in
this ﬁgure, while a “normal” merge of two critical points is represented
by a non-tangential crossing of this boundary. Consider a one-
dimensional problem in which we search for critical points of FðsÞ
along the streamline s. Then the condition that M be singular at a critical
point is expressed, Eq. (47), as:
d2F
�
ds2 ¼ 3s2 þ A ¼ 0:
(49)
The condition that da=dε be well-behaved, or the condition that Mþ
be simultaneously singular, is satisﬁed if
d2F
�
dsdε ¼ sdA
�
dε þ dB
�
dε ¼ 0:
(50)
Combining them we obtain the constraint
dA
.
dB ¼ �1
.
s ¼ �
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
�3=A
p
(51)
Fig. 8. Catastrophe theory representation of both a “3–1 termination” (dashed)
and “2-2 crossover” (dotted) event. The curved boundary separates the region of
three solutions from the single solution range.
A. Penner
Array 8 (2020) 100046
8
which is just the expression for the slope of the catastrophe boundary.
As an application of this concept, consider the 3–1 termination event.
In this case, two degenerate saddle points merge with a higher symmetry
local minimum to produce a single saddle point, while da= dε is well-
behaved. Since the two saddle points have the same rms error, we ﬁnd
that B ¼ 0 in Eq. (47). Therefore the tangential touching of the boundary
occurs at the origin. The additional constraint that is required in order to
produce a tangential touching is provided by symmetry. The tangential
touching event also coincides with a normal fold catastrophe at the origin
to produce a single saddle point at A > 0. The path that the system fol-
lows is plotted as a vertical line in Fig. 8, which passes through the origin.
The 2-2 crossover event of Sec. 7 is more challenging. We wish to ﬁt
FðsÞ to a sequence of ODF data obtained along the path joining three
critical points in Fig. 7a, to see how the ﬁt evolves as ε changes. For each ε
we need at least ﬁve data points to do so. Three of these points are
already known from the ODF optimization at the critical points, but two
remain to be calculated. The problem is that these two points are no
longer critical points; instead, they are points deﬁned along an unknown
streamline that joins a set of critical points [21]. The streamline is
deﬁned to be tangent to the gradient of F at all times. The uniqueness of
the streamline was shown in Ref. [5]. However, calculating it exactly
turns out to be difﬁcult: in the vicinity of a critical point the typical
behavior [[22], p.183] is that the streamline is a function of the type
p1=λ1
1
∝p1=λ2
2
, where p is a point in the transformed coordinate system
deﬁned by the eigenvectors of M, λi are the eigenvalues, and the origin of
p is at the critical point. As we approach a critical point these streamlines
will exhibit very high curvature, particularly if the ratio λ2= λ1 is large,
which will be the case if two critical points approach each other. How-
ever, we do not need the entire streamline, just a set of intermediate
points between two critical points. We evaluate these approximately
using the method of steepest descent [[23], p.121]: calculate a pre-
liminary estimate of a by linearly interpolating between a saddle point
and a local minimum. Then perform some iterations of the steepest
descent method. Each iteration will increment a by the amount Δa ¼ �
αL, where α ¼ LtL=LtML. Typically the point a will oscillate back and
forth across the narrow trough that leads to the minimum [[23], Fig8.2].
We terminate the iteration when the gain α stabilizes, since any point
along this streamline will do. Perform this for both pairs of mini-
ma/saddle points at each ε to obtain a total of ﬁve data points. Then ﬁt a
general quartic model of FðsÞ and convert this to the standard form in Eq.
(47). The resulting data are shown in Fig. 8. The ﬁgure shows the results
of this method applied to the current Beta2-spline, where the steepest
descent iteration was terminated after 20 iterations. The path length s
was evaluated using the distance in the ðd1; d2Þ plane. We see that there is
a tangential touching event at ε ¼ 0:96323, followed very closely by a
fold catastrophe. Unfortunately, the particular numerical method we are
using does not allow us to actually cross the boundary at the fold catas-
trophe, but it is clear that this crossing is imminent. A similar avoided
catastrophe was obtained by applying this method to a clamped
single-segment cubic B�ezier ﬁt (see Fig. 5.1 in Ref [[12]]) at c � 3:59,
with the steepest descent iteration terminated after one iteration.
Fig. 8 conﬁrms the supposition that a 2-2 crossing consists of a
tangential touching of the catastrophe boundary. We also note that the
sign of B has changed between the 2-2 crossing and the corresponding
fold catastrophe. Therefore not the same pair of critical points is involved
in these two events. The ﬁgure also clariﬁes the relationship between
these events. Given the highly curved character of the catastrophe
boundary, and given the fact that the relationship between A and B is
nearly linear as ε varies, it is almost inconceivable that a 2-2 crossover
event could occur without a corresponding fold catastrophe. This is an
insight that we would not have obtained if we restricted ourselves to the
use of only the determinants of M and Mþ.
9. Conclusion
When ﬁtting a spline to a closed shape it is normal to see multiple
solutions, which will appear as local minima and saddle points in the
error function. If the shape of the object is changed by varying a single
external paramater, then it may happen that these different types of so-
lutions meet, leading to a topological change in which solutions either
disappear or interchange their character. The outcome of these topo-
logical events can be determined by inspecting two different matrices
which represent the second-order response of the curve-ﬁtting error to
changes in the curve-ﬁtting parameters and the shape of the object.
Events in which two solutions annihilate are quite common and do not
require any special constraints to be met, other than the change in shape.
Events in which two solutions survive and interchange character are rare,
and require both of these response matrices to be simultaneously sin-
gular. In the context of ODF curve-ﬁtting, a new algebraic constraint is
deﬁned, which allows this type of solution crossover to occur. It is also
possible for solution bifurcations to occur as a result of symmetry-
breaking, which is a relatively common occurrence. These three types
of events: annihilation, crossover, and symmetry-breaking, can be
analyzed algebraically using matrix determinants, but that does not lead
to any understanding of the relationship between them. A more visual
representation is obtained using catastrophe theory, which allows us to
represent them as being either a simple crossing of a boundary (annihi-
lation), a simultaneous crossing of two boundaries which have merged
(symmetry-breaking), or a tangential touching of a boundary in which a
catastrophe is avoided (crossovers). In the case of a crossover, the ca-
tastrophe theory representation makes it clear that a crossover is not only
rare, but will almost certainly be closely associated with an annihilation
event, so much so that it may be difﬁcult to distinguish the two events.
Credit author statement
Alvin Penner: Conceptualization, implementation, writing.
Declaration of competing interest
I declare that I have no known competing ﬁnancial interests or per-
sonal relationships that could have appeared to inﬂuence the work re-
ported in this paper.
Acknowledgements
The author is grateful to the reviewers and editors for their valuable
comments, which were used to improve the quality of this paper.
The calculations were performed using the Java code at the re-
pository: https://github.com/alvinpenner/Spiro2SVG/.
References
[1] Ahn SJ. Least squares orthogonal distance ﬁtting of curves and surfaces in space,
LNCS 3151. Berlin: Springer; 2004. https://doi.org/10.1007/b104017.
[2] Aubin J-P, Ekeland I. Applied nonlinear analysis. Mineola, N.Y.: Dover Books on
Mathematics, Dover Publications; 2006.
[3] Stewart I. Catastrophe theory in physics. Rep Prog Phys 1982;45(2):185–221.
https://doi.org/10.1088/0034-4885/45/2/002.
[4] Zeeman EC. Catastrophe theory, Scientiﬁc American 1976;234(4):65–83. https://
doi.org/10.1038/scientiﬁcamerican0476-65.
[5] Antony C. Gradient ﬂow line near birth-death critical points. J Topol Anal 2018;10:
1–45. https://doi.org/10.1142/s1793525319500493.
[6] Gay DT. Functions on surfaces and constructions of manifolds in dimensions three,
four and ﬁve. 2017. p. 1–20. https://arxiv.org/abs/1701.01711.
[7] Edelsbrunner H, Harer J, Mascarenhas A, Pascucci V, Snoeyink J. Time-varying reeb
graphs for continuous space-time data. Comput Geom 2008;41(3):149–66. https://
doi.org/10.1016/j.comgeo.2007.11.001.
[8] Kirby R. A calculus for framed links in s3. Invent Math 1978;45(1):35–56. https://
doi.org/10.1007/bf01406222.
[9] Strogatz SH. Nonlinear dynamics and chaos. CRC Press; 2018. https://doi.org/
10.1201/9780429492563.
A. Penner
Array 8 (2020) 100046
9
[10] Golubitsky M, Schaeffer D. A theory for imperfect bifurcation via singularity theory.
Commun Pure Appl Math 1979;32(1):21–98. https://doi.org/10.1002/
cpa.3160320103.
[11] Bartels RH, Beatty JC, Barsky BA. An introduction to splines for use in computer
graphics & geometric modeling. Los Altos: Morgan Kaufmann; 1987.
[12] Penner A. Fitting splines to a parametric function. Cham, Switzerland: Springer
Briefs in Computer Science, Springer; 2019. https://doi.org/10.1007/978-3-030-
12551-6.
[13] Ahn SJ, Rauh W, Cho HS, Warnecke H-J. Orthogonal distance ﬁtting of implicit
curves and surfaces. IEEE Trans Pattern Anal Mach Intell 2002;24(5):620–38.
https://doi.org/10.1109/34.1000237.
[14] Bjorck A. Numerical methods for least squares problems. Philadelphia: SIAM; 1996.
https://doi.org/10.1137/1.9781611971484.
[15] Penner A. Fitting a cubic bezier to a parametric function. Coll Math J 2019;50:
185–96. https://doi.org/10.1080/07468342.2019.1583038.
[16] McWeeny R. Symmetry: an introduction to group theory and its applications.
Mineola, N.Y.: Dover; 2002.
[17] de Boor C, Hollig K, Sabin M. High accuracy geometric hermite interpolation.
Comput Aided Geomet Des 1987;4(4):269–78. https://doi.org/10.1016/0167-
8396(87)90002-1.
[18] de Tisi F, Rossini M. Behavior of the beta-splines with values of the parameters
beta2 negative. Comput Aided Geomet Des 1992;9(6):419–23. https://doi.org/
10.1016/0167-8396(92)90040-V.
[19] Mascarenhas A, Snoeyink J. Isocontour based visualization of time-varying scalar
ﬁelds. In: Mathematics and visualization. Springer Berlin Heidelberg; 2009.
p. 41–68. https://doi.org/10.1007/b106657_3.
[20] Guillemin V, Pollack A. Differential topology. Englewood Cliffs: Prentice-Hall;
1974. https://doi.org/10.1090/chel/370.
[21] Gordon P. Paths connecting elementary critical points of dynamical systems. SIAM J
Appl Math 1974;26(1):35–102. https://doi.org/10.1137/0126005.
[22] Lefschetz S. Differential equations: geometric theory. New York, N.Y.: Dover; 1977.
[23] Chong EKP, Zak SH. An introduction to optimization. Wiley; 2008. https://doi.org/
10.1002/9781118033340.
A. Penner
Array 8 (2020) 100046
10
