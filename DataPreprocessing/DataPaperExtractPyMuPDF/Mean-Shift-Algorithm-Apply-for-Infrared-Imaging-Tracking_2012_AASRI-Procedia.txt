 AASRI Procedia  1 ( 2012 )  52 – 57 
2212-6716 © 2012 Published by Elsevier Ltd. 
doi: 10.1016/j.aasri.2012.06.010 
 
 
2012 AASRI Conference on Computational Intelligence and Bioinformatics 
Mean-Shift Algorithm Apply for  Infrared Imaging Tracking 
zhang shuang1,2 *, qin yu-ping1 
1.The engineering & technical college of chengdu university of technology, leshan, 614000�china; 
2.Department of Electrical and Electronics Engineering, Faculty of Science and Technology, University of Macau, Macau SAR, CHINA 
 
Abstract 
An improved algorithm based on the modified histogram & mean shift is proposed in order to deal with difficulties in 
tracking small target of infrared imaging under complex background. The new algorithm is based on a lower dimension 
combining characteristic weighted histogram, the analogical degree measurement is determined by the Bhattacharyya 
coefficient, and the target is located through the mean shift. In order to improve the precision and robustness of the 
modified mean shift algorithm, particle filtering is used to obtain the optimal position estimate. Test results show that, the 
tracking point fluctuation could be reduced to no more than 2 pixels with the modified algorithm, for the test case.  
 
© 2012 Published by Elsevier B.V. 
Selection and/or peer review under responsibility of American Applied Science Research Institute 
 
Keywords:Target tracking; Small target of infrared imaging; features joint distribution; Mean shift; particle filtering  
1.Introduction 
Small infrared target tracking under complex background is the key technology of precision-guided and early 
warning system. Compared with visible images, infrared images generally have the problems of low Signal Noise Ratio 
(SNR) and poor imaging contrast. The poor visibility of small target, the negative impact of illumination and Image noise, 
and the lack of homogeneity of the brightness in background area, would make tracking become more difficult. Mean 
Shift algorithm, which utilizes probability density function of pixels within the target region as the feature and transforms 
tracking to an optimization problem of a similarity function [1], is widely used in target tracking because of the 
characteristics of simple, robust, and real-time performance. However, because of the disability of characteristic 
information extraction from small target by using weighted histogram, the algorithm is not so desirable for tracking small 
 
* Corresponding author. Tel.: 13541386694 
E-mail address: zhangshuanghua1@126.com 
AASRI
Procedia
www.elsevier.com/locate/procedia
Available online at www.sciencedirect.com
Open access under CC BY-NC-ND license.
Open access under CC BY-NC-ND license.
53
 Zhang shuang and qin yu-ping /  AASRI Procedia  1 ( 2012 )  52 – 57 
 
infrared target when the target moves too fast or has partially similarity with the backgrounds, which would cause the 
system unstable to miss the tracking target. This paper presents an improved mean shift tracking algorithm. By extracting 
several characteristic from target area, the algorithm structures a lower dimension combining characteristic weighted 
histogram, and combines mean shift with particle filtering [2], in order to precisely locate the small target and steadying in 
sequence infrared images. Test results show that the improvements on classical mean shift tracking algorithm are quite 
effective. 
2 Algorithm descriptions 
The new algorithm mainly includes target pattern definition, similarity measure, mean shift and particle filter. 
2.1.Target Pattern Definition 
Classical mean shift tracking algorithm uses gray histogram to describe the target appearance. Each pixel within the 
target region is given a larger value when calculating the probability histogram. The inner pixels are given a large weight, 
and outer pixels are given a smaller one. Given a set {xi} i=1�m of n points in the 2D space R2, the multivariate kernel 
density estimation with kernel k1 (||) and window radius h, computed in the point y is given by 
� �
�
�
2
1
1 1
ˆ
1
n
i
u
i
i
p
C
k
b
u
u
m
�
�
�
�
�
�
�
�
�
�
�
� �
�
�
�
�
�
�
y
x
y
x
h
�
                                                                      (1) 
Where ( )x
�
 is the Delta function, C1 is normalization constant, it can be calculated from
1 ˆ
1
m
u
u
� p
�
�
. The 
minimization of the average global error between the estimate and the true density yields the multivariate Epanechnikov 
kernel  
� �
�
�
1
2 1
1
0
k
otherwise
�
�
�
�
�
� �
��
x
x
x
                                                                                                             (2) 
It is not reliable to describe characteristics of infrared small target by the original grayscale only. Aiming at the 
problem upon, more characteristics should be extracted for structuring a joint character space, like local contrast mean 
difference, local average gradient strength, and local gray level probability, which are defined as 
(1) Local Contrast Mean Difference (LCMD) 
( , )
( , )
( , )
( , )
1
1
( , )
( , )
( , )
in
in
k l
N
i j
k l
N
i j
in
out
LCMD i j
f k l
f k l
n
n
�
�
�
�
�
�
                                                          (3) 
Local contrast mean difference will be calculated both inside and outside of the local window in formula (3), 
where ( , )
i j  is the center point of the window, ( , )
k l  is the pixel location within the window.  
(2) Local Average Gradient Strength (LAGS) 
( , ) ( , )
( , ) ( , )
1
1
( , )
( , )
( , )
in
out
k l
i j
k l
i j
in
out
LAGS i j
G
k l
G
k l
n
n
�
�
�
�
�
�
                                                                (4) 
Where  
( , )
h
v
in
in
in
G
k l
G
G
�
�
�
( , )
( ,
1)
h
Gin
f k l
f k l
�
�
�
�
( , )
(
1, )
v
Gin
f k l
f k
l
�
�
�
 
(3) Local Gray Level Probability (LGLP) 
54  
 Zhang shuang and qin yu-ping /  AASRI Procedia  1 ( 2012 )  52 – 57 
 
(
,
)
( , )
(
,
)
x
y
ij
r
r
x
y
r
r
f i
m j
n
LGLP m n
f i
j
�
�
�
�
��
��
�
�
�
�
�
� �
                                                                                           (5) 
Where 
,
(
,
1,
,0
,
1, )
m n
r
r
r
r
� � � �
�
�
�
, 
( , )
f i j  is the gray value of any pixel in the local window. 
Calculating 
upLCMD
�
upLCGS
�
upLGLP
�
upGRAY
 by formula (1), and merging them, we can get a new target 
histogram model as follow 
fusion
LCMD
LCGS
LGLP
GRAY
u
u
u
u
u
P
p
p
p
p
�
�
�
�
�
�
�
�
�
�
�
�
                                                                      (6)  
Where 
0.2
LCMD
u
y
C
�
�
�
�
�
�
0.2
LCGS
u
y
C
�
�
�
�
�
�
0.2
LGLP
u
y
C
�
�
�
�
�
�
0.4
GRAY
u
y
C
�
�
�
�
�
,used to balance the proportion of each characteristic in the weighted histogram. 
�y
 is 
similarity coefficient�and 
u
C  is normalization constant�which is calculated from 
1
�
�
�
�
�
�
�
�
. Figure 1(c) 
shows the new histogram which is calculated by formula (6).Compared with the classical histogram in figure 1(b), the 
new histogram can take a more balanced probability distribution and more target information, which will benefit the 
follow-up tracking. 
 
(a) Original image                         (b) The classical histogram                   (c) The modified histogram 
 
Fig.1 Target histogram comparison 
2.2.Similarity Measure 
Without loss of generality, we denote by P0 the density distribution of the original target model and by Py that of the 
candidate at location y in next image frame, so P0 and Py can be defined as 
Original:           
�
�
m
pu u
1�
0
ˆ
ˆ
�
P �
                                                                                                                           (7) 
Candidate:         
� �
�
�
m
u
pu
1�
ˆ
ˆ
�
�
y
Py
                                                                                                                    (8) 
And here we use the Bhattacharyya coefficient as similarity function [4], which is defined as 
�
�
� �
�
�
�
�
m
u
pu pu
P
P
1
0
ˆ ˆ
ˆ , ˆ
y
y
y
�
�
                                                                                                             (9) 
2.3.Mean Shift 
Mean shift is a kind of non-parametric density estimation method, which was expected to be applied to in objects 
Segmentation and tracking. The successful application was done by Dorin Comaniciu .etc [5] [3]. Then based on Taylor 
series expansion of the formula (9), �y can be approximated as 
55
 Zhang shuang and qin yu-ping /  AASRI Procedia  1 ( 2012 )  52 – 57 
 
�
�
2
1
0
0
1
1
1
1
ˆ
ˆ
,
2
2
m
n
i
u
u
i
u
i
C
p
p
w k
�
�
�
�
�
�
�
� �
�
�
�
�
�
�
�
�
�
�
�
y
y
x
P P
y
h
                                                            (10) 
Where,         
�
�
�
�
0
1
0
ˆ
[
]
ˆ
m
i
i
u
u
p
w
b
u
p
�
�
�
�
�
x
y
                                                                                                               (11) 
The candidate center yj+1 re-positioned in each iteration is calculated as follow 
1
1
1
1
1
1,2
n
n
j
i
j
i
j
i
i
i
i
i
wk
wk
j
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
y
x
y
x
y
x
h
h
�                                              (12) 
2.4.Particle Filtering 
Particle filtering is used to improve the tracking performance of mean shift, and the method of MSPF (the 
Combination of Mean Shift and Particle Filtering) is as follows. 
(1) Initializing the searching frame 
We can Sample N particles from the prior probability distribution 
( 0
ppri x )
, and this particles is denoted by �
�
0
0
i ,
x wi
. 
����Importance sampling 
(i) Sampling:  
( )
( )
0:
1
1
(
)
,
( ,
)
i
i
k
k
k
k
x
Mean
Shift x
v
v
N � �
�
�
�
�
�
�
Where, �  is the mean value of system noise, �  is the 
variance of system noise, calculated as follow 
1
1
(
)
m
i
i
i
y
y
�
�
�
�
�
�
   , 
2
2
1
1
(
)
m
i
i
y
y
m
�
�
�
�
�
�
�
                                                                              (13) 
(ii) Calculating the weight:  
2
( )
2
2
1
( ( ),
( ))
1
1
exp(
)
exp(
)
2
2
2
2
y
ki
q i
p i
d
w
�
�
�
��
��
�
�
�
�
�
                                                          
(iii) Normalization: 
( )
( )
( )
1
1
[
]
N
i
i
j
k
k
k
j
w
w
w
�
�
�
�
�
 
(3) Target position estimate 
( )
( )
(
)
i
i
k
k
k
i
E x
��x w
                                                                                                                                    (14) 
(4) Fixed re-sampling 
(i) Calculating the cumulative weights from the sample set: 
( )
(
1)
( )
i
i
n
k
k
k
c
c
w
�
�
�
 
(ii) Searching for the minimum value of n  to suit for 
( )
kc n
� u
 from the sample set, where u  is a random number 
which is distributed in range (0, 1) uniformly, and setting 
( )
( )
i
n
k
k
x
� x
.  
3.Tests 
To verify the effectiveness of the proposed algorithm, the target tracking tests are carried out. The size of infrared 
image for test is 320*240 pixels, the image’s SNR is about 3.8754, the frame rate of the video is 15 frames per second. All 
the implementations of the classical tracking algorithm (algorithm1) and the modified algorithm (algorithm2) have been 
56  
 Zhang shuang and qin yu-ping /  AASRI Procedia  1 ( 2012 )  52 – 57 
 
tested on a 2.8GHz PC. 
 
 
 
52nd frame                                              53rd frame                                       54th frame 
 
 
 
58th frame                                             59th frame                                  60th frame 
Fig.2 The tracking results by the algorithm2 
 
 
                         
 
(a) algorithm 1            (b) algorithm 2                            (a) Horizon               (b) Vertical 
Fig.3 Trace of the tracking points                                                                  Fig.4 Tracking point shift with the algorithm 1 and algorithm 2 
Among the 70 frame images from a image sequence, the modified algorithm could accurately track the target location. 
Target acquisition probability was close to 100%. Figure 2 shows several frames among the tracking results by the 
modified algorithm. It is observed that, the tracking effect can be well maintained even the background luminance of 
images obviously changed. Figure 3 shows the trace of the tracking points by algorithm1 and algorithm2. From figure 3(a), 
it can be seen that algorithm 1 lost its efficacy obviously. Compared with algorithm 1, the whole process of algorithm 2 
was robust as we have seen in Figure 3(b). Figure 4 shows the tracking error of the two algorithms on horizontal and 
vertical direction. The statistical results show that, with algorithm 1, the tracking point seriously deviated from original 
target before long. While using the proposed algorithm 2, the tracking point fluctuation could be reduced to no more than 
2 pixels successfully. 
4.Conclusions 
This paper presents a modified algorithm for small target tracking of infrared imaging. Aiming at the problem that the 
target characteristic distilling method based on weighted grave histogram is complex and unable to detect targets motion 
locus timely, sampling efficiency of which is low, a lower dimension combining characteristic weighted histogram method 
was put forward. In order to precisely locate the target, a small target tracking method based on both mean shift and 
particle filtering was brought forward. The tests show that the algorithm is able to locate the small target precisely in 
sequence images when the target is moving swiftly in complex circumstances. It can adapt to the changes of light and 
similar background, improve the robustness of tracking algorithm. 
57
 Zhang shuang and qin yu-ping /  AASRI Procedia  1 ( 2012 )  52 – 57 
 
References 
[1] K. FUKUNAGA, L. D. HOSTETLER. The Estimation of the Gradient of a Density Function with 
Applications in Pattern Recognition [J].IEEE Trans. Information Theory, 1975 21(5): 32-40. 
[2] M. ARULAMPALAM, S. MASKELL, N. Gordon. A Tutorial on Particle Filters for Online 
Nonlinear/Non-Gaussian Bayesian Tracking [J]. IEEE Trans. On Signal Processing, 2002, 50(2):174-188 
[3] Dorin COMANICIU, Visvanathan RAMESH, Peter MEER. Kernel-based Object Tracking [J]. IEEE 
Trans. Pattern Anal. Mach. Intell., 2003, 24(5): 564-577. 
[4] T. KAILATH. The Divergence, Bhattacharyya Distance Measures in Signal Selection [J]. IEEE Trans. 
Comm. Technology, 1999, 15(2): 253-259. 
[5] Dorin COMANICIU, Peter MEER. Mean Shift: a Robust Approach toward Feature Space Analysis [J]. 
IEEE Trans. Pattern Anal. Mach. Intell., 2002, 24(5): 603-619. 
 
