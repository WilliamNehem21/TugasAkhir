Artificial Intelligence in Geosciences 3 (2022) 203–208
Available online 31 December 2022
2666-5441/© 2022 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the CC
BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).
High resolution pre-stack seismic inversion using few-shot learning 
Ting Chen *, Yaojun Wang, Hanpeng Cai, Gang Yu, Guangmin Hu 
University of Electronic Science and Technology of China, China   
A R T I C L E  I N F O   
Keywords: 
Few-shot learning 
Artificial neural network 
Seismic inversion 
A B S T R A C T   
We propose to use a Few-Shot Learning (FSL) method for the pre-stack seismic inversion problem in obtaining a 
high resolution reservoir model from recorded seismic data. Recently, artificial neural network (ANN) demon-
strates great advantages for seismic inversion because of its powerful feature extraction and parameter learning 
ability. Hence, ANN method could provide a high resolution inversion result that are critical for reservoir 
characterization. However, the ANN approach requires plenty of labeled samples for training in order to obtain a 
satisfactory result. For the common problem of scarce samples in the ANN seismic inversion, we create a novel 
pre-stack seismic inversion method that takes advantage of the FSL. The results of conventional inversion are 
used as the auxiliary dataset for ANN based on FSL, while the well log is regarded the scarce training dataset. 
According to the characteristics of seismic inversion (large amount and high dimensional), we construct an arch 
network (A-Net) architecture to implement this method. An example shows that this method can improve the 
accuracy and resolution of inversion results.   
1. Introduction 
High resolution pre-stack seismic inversion is a major technology for 
reservoir characterization (Zong et al., 2012). Due to the limitation of 
seismic data quality, it is difficult to obtain a high resolution reservoir 
parameter from seismic data (Alemie and Sacchi, 2011). Previous 
studies found that introducing prior information or reasonable rock 
physical model into the inversion framework can improve the resolution 
of inversion results (Hampson et al., 2005; She et al., 2019; de Fig-
ueiredo et al., 2019). However, the current methods need to design 
mathematical models satisfying different assumptions, they are only 
applicable to some specific scenarios, but difficult to complex geological 
areas. 
The current research shows that ANN has powerful feature extraction 
and parameter learning ability, and the inversion methods combined 
with ANN are more efficient than conventional one. It has been used to 
obtain velocity model from the CSP gathers (R¨oth and Tarantola, 1994; 
Araya-Polo et al., 2018). A variant of ANN called recurrent neural 
network (RNN) has been used for full-waveform inversion (Richardson, 
2018). Chen et al. (2019) applied iterative deep neural networks (DNN) 
to inverse seismic wavelet and reflectivity. To make network more 
perfect, the training process requires to have a sufficient amount of valid 
labeled data (Goodfellow et al., 2016; Dai et al., 2019). ANN has a huge 
development in the field of image, partly because it is easy to get valid 
labeled data in this field, but it is very expensive to get in the field of 
geophysics. To alleviate the problem of scarce samples, adding con-
straints to the ANN inversion framework to improve network general-
ization ability has become the choice of many researchers. For example, 
the ANN framework with initial models as constraints (Zhang et al., 
2021); A convolution neural network (CNN) employing a physics-guided 
approach and data drive (Biswas et al., 2019; Sun et al., 2021). Song 
et al. (2022) proposed an inversion framework based on semi-supervised 
learning. In this work, we employ another ANN learning architecture 
named FSL for high resolution pre-stack seismic inversion of reservoir 
parameters. 
The ANN algorithms usually require hundreds or thousands of su-
pervised samples to ensure generalization ability (Lu et al., 2020). The 
FSL is significant and challenging in the field of ANN. Due to the mature 
mathematical principle, conventional inversion method could integrate 
well log and seismic data in reasonable good manner. The results of 
conventional inversion are used to construct the auxiliary dataset, and a 
few of accurate well log is regarded as the scarce training dataset. In 
order to adapt to the characteristics of ANN seismic inversion with large 
amount data but few labeled samples, we create a new A-Net architec-
ture to implement the method. This network firstly increases the number 
of the convolution kernel layer by layer to enlarge the feature quantity, 
and then reduces the number of the convolution kernel to extract 
high-dimensional features. FSL can still achieve a satisfactory result with 
* Corresponding author. 
E-mail address: ting.chen.seven@gmail.com (T. Chen).  
Contents lists available at ScienceDirect 
Artificial Intelligence in Geosciences 
journal homepage: www.keaipublishing.com/en/journals/artificial-intelligence-in-geosciences 
https://doi.org/10.1016/j.aiig.2022.12.004 
Received 23 November 2022; Received in revised form 27 December 2022; Accepted 27 December 2022   
Artificial Intelligence in Geosciences 3 (2022) 203–208
204
few samples. This method is successfully applied to a filed data set from 
northwest of China by effectively improving the resolution of inversion 
results. 
2. Method 
The objective of training an ANN is to find an input-to-output map-
ping and minimize the error between the network output and the labels. 
The complicacy of the structure and the number of valid data largely 
determine the predictive ability of supervised ANN (Das et al., 2019). 
ANN applies successfully in the field of image classification because it is 
easy to obtain valid labeled data (Krizhevsky et al., 2012), whereas in 
the geophysical inversion it is often difficult to obtain numerous valid 
labeled data. To meet this challenge, we combine the conventional 
pre-stack inversion with FSL to construct a new high resolution inver-
sion method. The whole framework of the proposed method is shown in 
Fig. 1, and the two main parts are marked by dotted boxes. 
2.1. Step 1: Pre-training for the original network 
The results of conventional inversion are used for pre-training, and 
Fig. 1. The framework of the proposed method.  
Fig. 2. A-Net architecture for pre-stack seismic inversion. The pre-stack seismic angle gathers is the input of the network and the reservoir parameters curve Vp, Vs 
and ρ is the output, that compare with prepared or true well log. 
Fig. 3. The convolutional unit architecture. Input is the pre-stack seismic angle 
gathers or an output from a previous unit, and output is the input to the 
next unit. 
T. Chen et al.                                                                                                                                                                                                                                    
Artificial Intelligence in Geosciences 3 (2022) 203–208
205
the hidden relationship between pre-stack seismic data and reservoir 
parameters can be learned by neural network. As shown in the top 
dotted box of Fig. 1, the predicted output of the network is compared 
with prepared label. We use the mean square error (MSE) as the loss 
function to measure the distance between the outputs and the labels. 
2.2. Step 2: Re-training for application 
When the pre-training step is completed, the trained network is 
retrained using the well log. The workflow is shown in the bottom box of 
Fig. 1. When the two-step training of the network is completed, the 
network not only has the ability to map from pre-stack seismic data to 
reservoir parameters, but also has high resolution output due to the 
influence of well log data on the network. Finally, the reservoir pa-
rameters of the target data are inverted by the trained neural network. 
Pre-stack seismic inversion is a regression problem that requires to 
make full use of the information in the training data, and the effect of 
learning is directly related to the scale of the network. Although the CNN 
can be applied to regression, and training CNN generally requires a large 
number of label data. The U-net does not have the requirement of 
abundant label, but it is mostly used for image segmentation problems 
(Ronneberger et al., 2015; Ibtehaz and RahmanSohel, 2020), and the 
role is to remove redundant information and extract high-dimensional 
feature. The structure with contracting path first and then expansive 
path is tend to remove weak information in seismic data, ignoring subtle 
differences between traces. Therefore, we design a fully redundant 
A-Net (Fig. 2), which first expanded the data to amplify weak infor-
mation, and then compressed the path to extract key features. The main 
difference between A-net and U-net is that it enables full learning of 
Fig. 4. Post-stack and pre-stack seismic via various angles. (a) post-stack seismic data set; (b) near angle-stack seismic data set; (c) middle angle-stack seismic data 
set; (d) far angle-stack seismic data set. 
Fig. 5. Log analysis of well. The red rectangle in the plot is the location of the 
TII0 gas formation. 
Table 1 
Detailed parameters of our proposed A-Net architecture shown in Fig. 2.  
Operation 
layer 
Channel (Ic/ 
Oc) 
Kernel size (Ic × Oc 
× Ks) 
Output size (Ih × Oc 
× Bs) 
Input data 
– 
– 
150 × 9 × 16 
Conv1 
9/11 
9 × 11 × 3 
150 × 11 × 16 
Conv2 
11/13 
11 × 13 × 3 
150 × 13 × 16 
Conv3 
13/15 
13 × 15 × 3 
150 × 15 × 16 
Conv4 
15/17 
15 × 17 × 3 
150 × 17 × 16 
Conv5 
17/19 
17 × 19 × 3 
150 × 19 × 16 
Conv6 
19/19 
19 × 19 × 3 
150 × 19 × 16 
Conv5* 
19/17 
19 × 17 × 3 
150 × 17 × 16 
Conv4* 
17/15 
17 × 15 × 3 
150 × 15 × 16 
Conv3* 
15/13 
15 × 13 × 3 
150 × 13 × 16 
Conv2* 
13/11 
13 × 11 × 3 
150 × 11 × 16 
Conv1* 
11/9 
11 × 9 × 3 
150 × 9 × 16 
FC 
1350 × 450 
– 
450 × 16 
Output data 
– 
– 
150 × 3 × 16  
T. Chen et al.                                                                                                                                                                                                                                    
Artificial Intelligence in Geosciences 3 (2022) 203–208
206
redundant data, including subtle differences between data. Based on the 
learning capability of the A-net, we can get the desired reservoir pa-
rameters from pre-stack seismic data. 
We used a PyTorch implement of 1D convolutional layer to build 
each convolutional unit (Fig. 3). At the end of each layers, we introduce 
the nonlinearity using normalized function (BatchNorm1d) and activa-
tion function (ReLU) defined as χ(ξ) = max(0, ξ) (Nair and Hinton, 2010; 
Ioffe and Szegedy, 2015). There is also a linear mapping layer at the end 
of the network. It is found that scaling labeled data and the output of the 
network into a small range may accelerate the convergence process, 
especially with the Adam optimizer that provides “normalized” (i.e., the 
ratio of the first and the second momentum) parameter updates because 
all trainable parameters are randomly initialized in a range of [0,1]. 
Therefore, in experiments of this paper, the ground-truth reservoir pa-
rameters models are scaled using the global minimum and maximum of 
parameters values Mmin and Mmax, i.e., (M − Mmin)/(Mmax − Mmin). 
To obtain the estimated reservoir parameters models, a reverse scaling 
procedure is required to assign each pixel of output into a parameters 
values, i.e., Moutput = Moutput × (Mmax − Mmin) + Mmin. 
2.2.1. Example 
We use a field dataset from the northwest of China to test the validity 
of the pre-stack inversion method based on FSL. This area features a 
lacustrine delta sedimentary environment with some large scale of 
interbedded sand-mudstone. The pre-stack data set covers a 100 km2 
area with inline501 × xline631 × angles9. There are 150 ms in each 
Fig. 6. The conventional inversion results of reservoir parameters. (a) Vp; (b) Vs; (c) ρ.  
Fig. 7. The FSL high resolution inversion results of reservoir parameters. (a) Vp; (b) Vs; (c) ρ.  
Fig. 8. The Vp/Vs of reservoir parameters. (a) The conventional inversion results; (b) The FSL-based high resolution inversion results.  
Fig. 9. The Vp/Vs of reservoir parameters. (a) The conventional inversion re-
sults; (b) The FSL-based high resolution inversion results. 
T. Chen et al.                                                                                                                                                                                                                                    
Artificial Intelligence in Geosciences 3 (2022) 203–208
207
trace with a sampling rate of 1 ms. The dominant frequency of seismic 
data is 40 Hz with an effective frequency band of 8–49 Hz. The target 
reservoir is TII0, a thin gas formation of Triassic located between the 
shore-shallow lake mudstone and the TII thick sandstone below. The 
distribution of lithology is inferred from GR and SP curves in well data. 
The shore-shallow lake mudstone formation is stable, and its thickness is 
about 30–48 m. TII0 gas formation has the characteristics of large buried 
depth (more than 4700 m) and uneven transverse distribution with the 
thickness is between 1 and 4.5 m. A mudstone intercalation between the 
TII0 and the lower TII sandstone has an uneven transverse of distribu-
tion thickness (3–8 m), locally thickness exceeding 10 m. Fig. 4 shows 
post-stack and angle-stack seismic data from near to far. The reservoir is 
sandstone with a small thickness and poor signal-noise ratio (SNR) of 
pre-stack 3D seismic data. As shown in Fig. 5, we display the proportion 
of lithology obtained from well log analysis. The yellow and gray 
coatings in the Figure represent the composition of sandstone to 
mudstone, respectively. The green curve is the GR log. The difference of 
P-impedance between sandstone and mudstone in TII0 is not obvious, 
but the sandstone has the characteristics of low Vp/Vs. Therefore, pre- 
stack inversion of Vp/Vs has the potential to identify reservoirs, and 
the reservoir can be distinguished in a small range. 
The seismic data from each angles need to be normalized at the 
beginning, and then 2 wells are used to construct the initial low- 
frequency model for the conventional pre-stack inversion. The initial 
model of the well position is obtained by 12 Hz low-pass filtering of the 
well data, and then extrapolated to the remaining CDPs positions by 
interpolation. The 3D pre-stack inversion results of reservoir parameters 
based on low frequency constrained (Huck et al., 2010). Due to the poor 
quality of seismic data, conventional inversion results show low reso-
lution, which cannot meet the needs of accurate reservoir identification. 
For improving the resolution of reservoir parameters, we take the 
conventional inversion results as the auxiliary dataset for FSL inversion, 
while the scarce training dataset only has 16 valid well log. In addition 
to the well log used to construct the scarce dataset, one well that was not 
involved in the network training process was used as a blind well to test 
the effectiveness of the results. The auxiliary dataset is used to pre-train 
the network, and the scarce training dataset will re-train the network 
and adjust the weight of the network. We performed about 10 epochs to 
re-train the network. Detailed desc-riptions of A-net network parameters 
are presented in Table 1. Such as input channels (Ic), output channels 
(Oc), convolution kernel size (Ks), batch size (Bs), input data height (Ih). 
After re-training, we use the trained network to predict Vp, Vs and ρ 
for the all CDPs positions in working area. It can be seen that retraining 
network with well log yields higher resolution results than conventional 
inversion, especially at the black arrow markers (Figs. 6 and 7). Fig. 8 
shows the Vp/Vs constructed from the inversion results. The black arrow 
in Figs. 8 and 9 indicates the location of the target gas formation TII0. 
The inversion effect at this location in FSL-based inversion shows that 
the boundary between TII0 and surrounding mudstone is clear, and the 
thickness information of this formation can be accurately identified. We 
can see that the FSL-based inversion shows several thinner sandstone 
layers, while the conventional inversion shows a thicker sandstone 
response. A comprehensive comparison of the two methods inversion 
results shows that FSL-based inversion method can improve the reso-
lution and accuracy of inversion results in pre-stack seismic inversion. 
Although the number of valid labeled data is small, the resolution of 
result is still acceptable. If the number of label is enough, we will get a 
better result. 
3. Conclusion 
In this paper, we propose a high resolution pre-stack seismic inver-
sion method for reservoir parameters based on FSL. It contains a 
specially designed A-Net architecture. Through a field data example, we 
demonstrated the application of this network in resolving a high reso-
lution pre-stack seismic inversion problem. The results show clear 
improvement on the resolution of inversion results, which provides a 
reliable basis for the accurate identification of thin formation. The trade- 
off, however, is that this approach does require additional time cost and 
data dependency. Nevertheless, it can provide a solution for the insuf-
ficient sample in ANN inversion. 
Declaration of competing interest 
The authors declare that they have no known competing financial 
interests or personal relationships that could have appeared to influence 
the work reported in this paper. 
Acknowledgment 
We great appreciate the financial support from the National Natural 
Science Foundation of China (Grant No. 42130812, 42174151, and 
41804126). We are grateful to the GeoSoftware for licensing the use of 
the Hampson-Russell software to us. 
References 
Alemie, W., Sacchi, M.D., 2011. High-resolution three-term AVO inversion by means of a 
Trivariate Cauchy probability distribution. Geophysics 76 (3), R43–R55. https://doi. 
org/10.1190/1.3554627. 
Araya-Polo, M., Jennings, J., Adler, A., Dahlke, T., 2018. Deep-learning tomography. 
Lead. Edge 37 (1), 58–66. https://doi.org/10.1190/tle37010058.1. 
Biswas, R., Sen, M.K., Das, V., Mukerji, T., 2019. Pre-stack inversion using a physics- 
guided convolutional neural network. SEG Technical Program Expanded Abstracts 
2019 4967–4971. https://doi.org/10.1190/segam2019-3215071.1. 
Chen, D., Gao, J., Hou, Y., Gao, Z., 2019. High resolution inversion of seismic wavelet 
and reflectivity using iterative deep neural networks. SEG Technical Program 
Expanded Abstracts 2019 2538–2542. https://doi.org/10.1190/segam2019- 
3216178.1. 
Dai, Y., Huang, X., Xu, Y., 2019. Seismic inversion based on deep learning and its impact 
by sample size. In: SEG 2019 Workshop: Fractured Reservoir & Unconventional 
Resources Forum: Prospects and Challenges in the Era of Big Data. Society of 
Exploration Geophysicists, pp. 65–68. https://doi.org/10.1190/frur2019_17.1. 
Lanzhou, China, 1-3 September 2019.  
Das, V., Pollack, A., Wollner, U., Mukerji, T., 2019. Convolutional neural network for 
seismic impedance inversion. Geophysics 84 (6), R869–R880. https://doi.org/ 
10.1190/geo2018-0838.1. 
de Figueiredo, L.P., Grana, D., Roisenberg, M., Rodrigues, B.B., 2019. Gaussian mixture 
Markov chain Monte Carlo method for linear seismic inversion. Geophysics 84 (3), 
R463–R476. https://doi.org/10.1190/geo2018-0529.1. 
Goodfellow, I., Bengio, Y., Courville, A., 2016. Deep Learning. MIT press, Cambridge.  
Hampson, D.P., Russell, B.H., Bankhead, B., 2005. Simultaneous inversion of pre-stack 
seismic data. SEG Technical Program Expanded Abstracts 2005 1633–1637. https:// 
doi.org/10.1190/1.2148008. 
Huck, A., Quiquerez, G., de Groot, P., 2010. Improving seismic inversion through 
detailed low frequency model building. In: 72nd EAGE Conference and Exhibition 
Incorporating SPE EUROPEC 2010. European Association of Geoscientists & 
Engineers, p. 161. https://doi.org/10.3997/2214-4609.201400776. 
Ibtehaz, Nabil, Rahman, M. Sohel, 2020. MultiResUNet: rethinking the U-Net 
architecture for multimodal biomedical image segmentation. Neural Network. 121, 
74–87. https://doi.org/10.1016/j.neunet.2019.08.025. 
Ioffe, S., Szegedy, C., 2015. Batch normalization: accelerating deep network training by 
reducing internal covariate shift. In: International Conference on Machine Learning, 
pp. 448–456. 
Krizhevsky, A., Sutskever, I., Hinton, G.E., 2012. Imagenet classification with deep 
convolutional neural networks. Adv. Neural Inf. Process. Syst. 25, 1097–1105. 
Lu, J., Gong, P., Ye, J., Zhang, C., 2020. Learning from Very Few Samples: A Survey arXiv 
preprint, arXiv: 2009.02653.  
Nair, V., Hinton, G.E., 2010. Rectified Linear Units Improve Restricted Boltzmann 
Machines. ICML. 
Richardson, A., 2018. Seismic Full-Waveform Inversion Using Deep Learning Tools and 
Techniques arXiv preprint, arXiv: 1801.07232.  
Ronneberger, O., Fischer, P., Brox, T., 2015. U-net: convolutional networks for 
biomedical image segmentation. In: International Conference on Medical Image 
Computing and Computer-Assisted Intervention, pp. 234–241. https://doi.org/ 
10.1007/978-3-319-24574-4_28. 
R¨oth, G., Tarantola, A., 1994. Neural networks and inversion of seismic data. J. Geophys. 
Res. 99, 6753–6768. https://doi.org/10.1029/93JB01563. 
She, B., Wang, Y., Liang, J., Hu, G., 2019. Data-driven simultaneous seismic inversion of 
multiparameters via collaborative sparse representation. Geophys. J. Int. 218 (1), 
313–332. https://doi.org/10.1093/gji/ggz116. 
Song, L., Yin, X., Zong, Z., Jiang, M., 2022. Semi-supervised learning seismic inversion 
based on Spatio-temporal sequence residual modeling neural network. J. Petrol. Sci. 
Eng. 208, 109549 https://doi.org/10.1016/j.petrol.2021.109549. 
T. Chen et al.                                                                                                                                                                                                                                    
Artificial Intelligence in Geosciences 3 (2022) 203–208
208
Sun, J., Innanen, K.A., Huang, C., 2021. Physics-guided deep learning for seismic 
inversion with hybrid training and uncertainty analysis. Geophysics 86 (3), 
R303–R317. https://doi.org/10.1190/geo2020-0312.1. 
Zhang, J., Li, J., Chen, X., Li, Y., Huang, G., Chen, Y., 2021. Robust deep learning seismic 
inversion with a priori initial model constraint. Geophys. J. Int. 225 (3), 2001–2019. 
https://doi.org/10.1093/gji/ggab074. 
Zong, Z., Yin, X., Wu, G., 2012. AVO inversion and poroelasticity with P- and S-wave 
moduli. Geophysics 77, N17–N24. https://doi.org/10.1190/geo2011-0214.1. 
T. Chen et al.                                                                                                                                                                                                                                    
