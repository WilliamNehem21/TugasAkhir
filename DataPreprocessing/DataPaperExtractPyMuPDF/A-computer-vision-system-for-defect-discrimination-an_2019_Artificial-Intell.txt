A computer vision system for defect discrimination and grading in
tomatoes using machine learning and image processing
David Ireri a, Eisa Belal a,b, Cedric Okinda a, Nelson Makange a, Changying Ji a,⁎
a College of Engineering, Laboratory of Modern Facility Agriculture Technology and Equipment Engineering of Jiangsu Province, Nanjing Agricultural University, Jiangsu 210031, PR China
b Faculty of Agriculture, Department of Agricultural Engineering, University of Zalingei, Central Darfur State, R., Sudan
a b s t r a c t
a r t i c l e
i n f o
Article history:
Received 21 April 2019
Received in revised form 6 June 2019
Accepted 6 June 2019
Available online 17 June 2019
With large-scale production and the need for high-quality tomatoes to meet consumer and market standards
criteria, have led to the need for an inline, accurate, reliable grading system during the post-harvest process.
This study introduced a tomato grading machine vision system based on RGB images. The proposed system per-
formed calyx and stalk scar detection at an average accuracy of 0.9515 for both defected and healthy tomatoes by
histogram thresholding based on the mean g-r value of these regions of interest. Defected regions were detected
by an RBF-SVM classiﬁer using the LAB color-space pixel values. The model achieved an overall accuracy of 0.989
upon validation. Four grading categories recognition models were developed based on color and texture features.
The RBF-SVM outperformed all the explored models with the highest accuracy of 0.9709 for healthy and defected
category. However, the grading accuracy decreased as the number of grading categories increased. A combination
of color and texture features achieved the highest accuracy in all the grading categories in image features evalu-
ation. This proposed system can be used as an inline tomato sorting tool to ensure that quality standards are ad-
hered to and maintained.
© 2019 The Authors. Production and hosting by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is an
open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).
Keywords:
Grading
Calyx
Defected
Recognition models
Machine vision
1. Introduction
Tomato a nutritious and nourishment fruit is one of the top-grown
agricultural produce in the world. According to (FAOSTAT, 2017), the
global production of tomatoes was 170.8 million tons with China as
the leading producer accounting for over 31% of the total production.
With large-scale production, the post-harvest procedure is crucial
since tomato is a delicate and a perishable fruit. Additionally, quality
and food safety are decisive factors in tomato supply chain management
to meet trade speciﬁcations and buyer's requirements (Esguerra et al.,
2018). According to EU (2011) on the regulations for processed fruits
and vegetables, the minimal requirements is that tomatoes must appear
fresh, intact, free from deterioration, free of cracks, free from damage
and must arrive at the destination in a satisfactory condition. Thus, iden-
tifying these traits assists in conforming to the accepted market
standards.
Several chemical and physical parameters affect fruit quality and
have been used to sort and grade tomatoes during post-harvesting
such as size (large and small), shape (circular or oblong), defects and
maturity or color (Arjenaki et al., 2013). These parameters have helped
in identifying tomatoes with mechanical damage, disease, and insect
damage, cracks, and pre-harvest deformation defects to achieve the
required market standards (FAO, 2008). Furthermore, sorting governs
effectiveness and efﬁciency on how the product will be marketed
through the packing lines and quality standard. Thus, it is essential to
have a sorting method which is robust, consistent, fast, effective, and
non-destructive (Jarimopas and Jaisin, 2008).
The common sorting and grading technique is manual sorting. How-
ever, this technique suffers from several disadvantages, such as low pre-
cision, labor-intensive, and subjectivity (Karlsson, 2016). Gould (1975)
introduced the mechanical tomato sorting machine as a solution to
the shortcomings of manual sorting. However, this grading system
was limited to only size and weight classiﬁcation. Presently, with the
emergence and developments in machine vision technology, it has be-
come possible to overcome these limitations accurately and non-
destructively based on machine vision detection systems (Chen et al.,
2002).
Computer vision-based systems have already been applied in vast
areas of food and agricultural-based industry in the sorting of apple
(Moallem et al., 2017; Unay et al., 2011), strawberry (Liming and
Yanchao, 2010), tomato (Arakeri, 2016; Clement et al., 2012), potatoes
(Moallem et al., 2013), dates (Al Ohali, 2011; Lee et al., 2008), citrus
(Blasco et al., 2007; López-García et al., 2010), mangos (Naik and
Patel, 2014; Naik et al., 2015; Nandi et al., 2014), cucumbers (Clement
et al., 2013) etc. Tomato sorting based on machine vision was reported
as early as 1985 by Sarkar and Wolfe (1985), this study graded the to-
matoes depending on size, color shape, and defected. However, this
Artiﬁcial Intelligence in Agriculture 2 (2019) 28–37
⁎ Corresponding author.
E-mail address: chyji@njau.edu.cn (C. Ji).
https://doi.org/10.1016/j.aiia.2019.06.001
2589-7217/© 2019 The Authors. Production and hosting by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is an open access article under the CC BY-NC-ND license (http://
creativecommons.org/licenses/by-nc-nd/4.0/).
Contents lists available at ScienceDirect
Artiﬁcial Intelligence in Agriculture
journal homepage: http://www.keaipublishing.com/en/journals/artificial-
intelligence-in-agriculture/
system required the fruits to lie on their stem or blossom ends orienta-
tion during imaging for feature extraction. Clement et al. (2012) intro-
duced a tomato classiﬁer based on color, size, and weight. However, as
earlier mentioned, fruit quality is also affected by defects. Defects detec-
tion based on color features was reported by Dhanabal and Samanta
(2013) in the detection of Blossom End Rot (BER) and Rokunuzzaman
and Jayasuriya (2013) in the detection of BER and cracks. Color features
are considered as ﬁrst-order spatial statistics that depend on individual
pixel values. However, a defect has no spatial direction. Thus, relative re-
gions of the defects should be taken into account (Arakeri, 2016;
Moallem et al., 2017). To improve on tomato defect detection, Arakeri
(2016) proposed the use of high-quality images and image texture fea-
tures.
However,
the
use
of
high-resolution
images
such
as
hyperspectral, and multispectral (Moltó et al., 2010; Polder and van
der Heijden, 2010) imaging system have been reported to consume
much computational time and high costs involved (Arakeri, 2016).
This study introduces a low-cost tomato grading system based on
color images processing and machine learning technology. The pro-
posed system extracted both LAB color features and gray level texture
features and used them as feature variables to develop correlations to
tomato redness color intensity and defect. LAB color space is often less
affected by the variations of the camera sensor compared to RGB
(Shaﬁee et al., 2014). Texture features are also referred to as second-
order features (Moallem et al., 2017) because they capture the spatial
dependence of gray values that contribute to the perception of texture
by representing the properties of pixels in pairs. The main objective of
this study was to develop a computer vision system that can be used
to grade tomatoes. The speciﬁc objectives of this study were to develop
an efﬁcient image processing algorithm, to develop an efﬁcient and ac-
curate calyx detection algorithm and to develop different classiﬁers to
grade tomatoes into different grading categories. This proposed system
can be applied in real-time tomato post-harvesting procedures because
its fast, cheap, accurate, and non-detective, thus improved reduced in-
spection time and quality sorting guarantee in tomato production and
supply chain management.
2. Materials and methods
2.1. Experiment setup and data collection
Experiments were conducted between November 2018 and January
2019 at Nanjing Agricultural University, College of Engineering, Nanjing,
Jiangsu Province, China. A total of 200 tomatoes with different degree of
defects and red color intensity were manually selected at a local farm in
Jiangpu, Nanjing, Jiangsu China. Cherry tomatoes and Heirloom toma-
toes were used. The overview of the proposed system is given in Fig. 1.
The image acquisition system was composed of Hikvision Mini Cam-
era (DS-2CD2D14WD/M4MM), mounted 1.0 m perpendicularly above
an imaging stage, as shown in Fig. 2. The camera was connected via an
Ethernet to an intel core i5-4500U CPU, 4 GHz, 16 GB physical memory
(Intel, Santa Clara, CA, USA), Microsoft Windows 10 PC. Images of toma-
toes (1280 × 720) at different orientations were acquired at 10 fps. For
each tomato, ten images were selected for subsequent analysis.
2.2. Image processing and feature extraction algorithms
These algorithms aimed at developing a tomato grading system
based on defects and color intensity, as shown in Fig. 1. Firstly, segmen-
tation algorithms were applied to the captured image to remove the
background. Secondly, performed calyx and stalk scar detection and
Fig. 1. The algorithmic ﬂow of the proposed system.
29
D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28–37
defect segmentation. Thirdly extracted the color, texture, and shape fea-
tures from all the images. Fourthly, developed classiﬁers based on sup-
port vector machines (SVM), artiﬁcial neural network (ANN), and
random forest for comparative analysis of proposed tomato grading
technique.
2.3. Image processing
2.3.1. Background removal
In this study, the image acquisition system was stationary. Thus, a
simple image subtraction technique was used for background removal.
Due to RGB images being sensitive to the ambient light conditions, the
background was incompletely removed in some images. However, in
the set-up condition, the background pixels had lower values than the
foreground pixels. Hence, the background was entirely removed by a
histogram thresholding technique, as shown in Fig. 3. The threshold
was calculated by Eq. (1) (Moallem and Razmjooy, 2012)
δ ¼ 1
2 μmxr þ μm
ð
Þ
ð1Þ
where, δ is the heuristic threshold value, μmxr is the gray level with the
most repetitions in the image, and μm is the median of the gray level dis-
tribution of the image.
2.3.2. Calyx and stalk scar detection
The calyx and stalk scar (CS) are often very similar to a defect in
terms of appearance, as shown in Fig. 4(a) and (d). Thus, it is necessary
to segment them before classifying a tomato. In this study, the CS was
detected based on the gray values of a tomato image along with the lon-
gitudinal directions of the tomato image. Fifty images with clear CS
were selected for the development of the CS detection algorithm.
Based on these experiments, it was established that the g-r values of
Fig. 2. Experiment setup and Image acquisition system.
Fig. 3. Image background removal, (a) original color image, (b) original image without the background.
30
D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28–37
the CS were greater than that of the fruit. Thus, they were segmented by
a histogram threshold (Eq. (1)) based on the average value of the g-r
value of the CS regions of the selected images.
2.3.3. Defect detection
Tomato is a very succulent fruit whose quality is not affected by only
BER and cracks but with also mechanical damages during transportation
and handling. This study exploits the advantages of LAB color space to
perform tomato defect detection. 500 images of tomatoes with different
degree of defect were randomly selected and were converted from RGB
to LAB. The intensity values of L, A, and B space were then extracted
from each pixel points for each image and were labeled as either defect
or healthy pixels. Let the extracted color space features be denoted by
LM which was a huge matrix of Is by 4, for the 500 images, 3 color spaces
and the pixel label as 1 for healthy and −1 for defected, where Is is the
total number of pixels in all the images (1280 ∗ 720 ∗ 500). LM was split
into training and validation datasets of 0.7 and 0.3 of the total observa-
tions respectively. Each observation of the training dataset can be pre-
sented by (LMtr,Xtr). Where, LMt ⊂ LM, Xtr is the label corresponding
to LMtr, and r ∈ [1,(0.7 ∗ Is)] The training dataset was used to train a ra-
dial basis function (RBF-SVM) classiﬁer. The modeled classiﬁer was then
validated by the 0.3 ∗ Is observations denoted by (LMse,Xse). Where, e ∈
[1,(0.3 ∗ Is)], LMs ⊂ LM, Xse is the label corresponding to LMse. The vali-
dation results obtained was denoted by pe for each LMse. The value of
each e in Xse was compared to pe, the performance of the defect detec-
tion model was evaluated according to Eq. (2).
num Xse ¼¼ pe
ð
Þ
num Xse
ð
Þ
k∈ 1; 0:3 � Is
ð
Þ
½
�
ð2Þ
where num(Xse = = pe) is the number of pe that equals Xse.
2.4. Feature extraction
2.4.1. Color features
Color features are also referred to as statistical features (1st order
spatial statistics measure). In this study, LAB color space was used due
to its ability of limited variance due to sensor sensitivity (Shaﬁee et al.,
2014). LAB color space is a 3-axis color system with absolute and pre-
deﬁned range for the L, A, and B dimensions. Where L represents the
brightness (the darkest black at L = 0, and the brightest white at L =
100), A and B represent the color channels. A represents red and
green opponent colors along the A axis at positive and negative values,
respectively. B represents yellow and blue opponent colors along the B
axis at positive and negative values, respectively. However, at A = 0
and B = 0 represents true neutral gray values (Margulis, 2005). In LAB
color space, all colors in the spectrum are considered, as well as colors
outside the human perception (Hashim et al., 2012; Hu et al., 2016).
From each space, three color features were extracted (mean, standard
deviation, and range). Thus, a total of nine color features were extracted
in each image. These color features depend only on the individual pixel
values but do not account for the relative relations of the gray values
(Moallem et al., 2017). Fig. 5 shows the conversion of the original RGB
image into LAB color space.
2.4.2. Texture features
Texture features are also referred to as a 2nd order measure. These
features present the gray values of pixels in pairs. Thus, they capture
the spatial dependence of gray values. In this study, Haralick textural
features were computed from Gray-Level Cooccurrence Matrices
(GLCM) (Haralick and Shanmugam, 1973; Moallem et al., 2013). A 2D
GLCM matrix presented each image, and the textual features are the av-
erage of this matrix using neighborhood of distance d = 1 towards the
directions 00, 450, 900, and 1350 this is because defects have no speciﬁc
direction. The extracted features were the contrast, correlation, energy,
homogeneity and entropy.
2.4.3. Shape features
Shape regularity is often used as a quality measure in marketing. To-
matoes with regular shapes are often considered as of better quality.
The tomato shape asymmetrical value was computed as a measure of
shape regularity. A binary image of the tomato was obtained by image
binarization (Otsu, 1979). Then the edges were extracted by the Sobel
operator. The regularity measure (ξ) was then extracted according to
Eq. (3). Where, dr(t) and dl(t) are the horizontal distances between
the boundary point and the longitudinal line through the image
Fig. 4. Calyx and stalk scar detection and segmentation, (a) original RGB image (b) Detected calyx and stalk scar, and (c) Calyx and stalk scar segmentation.
31
D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28–37
centroid on the right-hand side and left-hand side respectively.
ξ ¼
Pt
1 dr tð Þ−dl tð Þ
j
j
Pt
1 dr tð Þ þ dl tð Þ
j
j
 
!
ð3Þ
2.5. Recognition models
The captured tomato images were manually labeled by a human ex-
pert into four groups depending on defect, healthy, and ripeness (red
color intensity): healthy and defected (cat 1). Secondly, 1st grade, 2nd
grade, and rejected (cat 2). Thirdly, healthy deep red, healthy light
red, and defected (cat 3). Lastly, 1st grade deep red, 1st grade light
red, 2nd grade deep red, 2nd grade light red and rejected (cat 4) as
shown in Table 1. A classiﬁcation model was then developed, and the
obtained results were compared to those of human expert. A total of
ﬁfteen features were extracted from each image. Based on the quality
grading, a total of four models were developed for each recognition
model explored. The recognition models were linear-SVM, quadratic-
SVM, cubic-SVM, and radial basis function (RBF-SVM), ANN, decision
tree, and random forest. These models were trained by a 10-fold
cross-validation-based parameter search on the training dataset after
which they were further evaluated on a testing dataset. A comparison
to the manual labeling of the testing dataset was presented in terms of
recognition accuracy.
2.5.1. The SVM recognition models
SVM is a widely used regression technique and a statistical classiﬁer
based on a supervised learning algorithm (Kim and Choi, 2014). Gener-
ally, supervised learning algorithms vectors are input nonlinearly into a
high-dimensional feature space. The SVM algorithm determines the
maximum margin in the high-dimensional feature space by applying
the principle of construction risk minimization to classify the tomatoes
into required categories. This study explored the linear, quadratic, cubic,
and radial basis kernel functions. The choice of kernel function affects
the overall performance of an SVM classiﬁer in terms of efﬁciency and
accuracy. Eqs. (4) to (6) presents the basic kernel functions, i.e., linear,
polynomial and radial basis kernel functions. For more review on
SVM, please refer to the study by (Chang and Lin, 2011).
K xi; xj
�
�
¼ xT
i xj
ð4Þ
K xi; xj
�
�
¼ γxT
i xj þ 1
�
�d; γN0
ð5Þ
K xi; xj
�
�
¼ e−γ xi−x j
k
k
2
; γN0
ð6Þ
Fig. 5. Conversion of the color image to LAB color space, (a) RGB image, (b) L-space of LAB, (c) A-space of LAB, and (d) B-space of LAB.
Table 1
The dataset for all the grading categories explored.
Grading categories
Healthy
Defected
cat 1
1200
800
cat 2
1st grade
950
600
2nd grade
450
cat 3
Deep red
800
800
Light red
400
cat 4
1st grade
Deep red
600
600
Light red
350
2nd grade
Deep red
250
Light red
200
32
D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28–37
2.5.2. The ANN recognition models
The ANN applied in this study was a one-hidden-layer feed-forward
network trained by back propagation. The general equation of the ANN
model is given in Eq. (7). Where, q is the output, pi is the extracted fea-
tures (in this study =1, 2 … 15), wi is the mass of the ith input, b is the
bias, and f is the transfer function.
q ¼ f
X
15
i¼1
wipi þ b
 
!
ð7Þ
The developed ANN models had three layers; input layer, hidden
layer, and the output layer. The input layer had ﬁfteen inputs corre-
sponding to the extracted features. The number of neurons in the hid-
den layer was set to 10 after an exhaustive search with an increasing
number of neurons to establish a minimum percent error during the
validation phase. A hyperbolic tangent sigmoid transfer function was
used in the hidden layer, while a linear transfer function was used in
the output layer.
The image acquisition system captured a total of 2000 images. As
presented in Table 1. Above, in each grading category, 70% of the dataset
was used as a model training dataset while the remaining was used as
the testing dataset. The performance of each model for each grading cat-
egory was then presented in terms of accuracy in comparison to manual
labeling.
3. Results and discussion
3.1. Calyx and stalk scar detection analysis
The CS extraction algorithm was applied to 500 images with calyx
and stalk scar. The test achieved an average accuracy of 0.9515 and
RMSE of 33.5 tomato images on the dataset, as shown in Table 2. How-
ever, on separate datasets of healthy and defected, the defected
achieved a lower accuracy as shown in Table 2, this was mainly due to
defect and CS having almost similar color intensities at different and
varying ambient light levels.
Different calyx detection techniques already exist from several stud-
ies on fruit and vegetables sorting such as the used of K-means cluster-
ing on Cb component in YCbCr color space by Moallem et al. (2017) in
apple grading. Image object segmentation and thresholding by Arakeri
(2016) in tomato sorting and grading. However, to improve on the
calyx detection accuracy and reduce the computational time for real
time online system this study applied the methodology presented by
Liming and Yanchao (2010) in the strawberry grading system by estab-
lishing the average g-r thresholding value and applied it to all the
images.
3.2. Defect detection analysis
Defect detection was performed after extraction of CS to prevent a
mismatch between CS and a defect. This study selected the RBF kernel
because of its ability to always adapts well by varying its scaling factor
in a large range of problems (Han et al., 2012). The results show that
the developed defect model could identify defected pixels with an accu-
racy of 0.989 on the validation dataset. Fig. 6 shows the identiﬁcation of
defected pixel regions using the introduced methodology.
As already mentioned, defects can often result from several factors
such as mechanical bruising, black BER, freezing injury, sunscald, and
decay. Several studies have already been presented in the detection of
these defects. Dhanabal and Samanta (2013) presented a color image
Table 2
Calyx extraction algorithm performance on a testing dataset.
Dataset
Accuracy
RMSE
Healthy
0.9767
8
Defected
0.9263
59
Average
0.9515
33.5
Fig. 6. Defect detection process on a tomato (a) and (c), original tomato image with defects (b) and (d) detected defect and healthy regions on the tomatoes (green is indicating healthy
pixel while red indicating defected pixels).
33
D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28–37
threshold method to discriminate unripe, ripe and spoiled tomatoes. Lee
et al. (2008) developed near-infrared imaging system in the grading of
date fruits at an overall accuracy of 95.0%, despite the high accuracy of
high-quality images like the hyperspectral, multispectral and near-
infrared imaging the costs involved are always much higher in the
setup of such systems. Never the less this introduced system despite
image quality is sensitive to ambient light conditions still achieved a
high accuracy due to controlled lighting.
3.3. Grading categories analysis
This study introduces an automated technique for tomato sorting. A
machine vision system was designed to extract tomato image features
based on color, texture, and shape parameters. A detailed image pro-
cessing technique for real time inline tomato evaluation was intro-
duced. Fig. 7 presents the image analysis of different gradings of
tomatoes used in this proposed grading system together with their cor-
responding histograms. It was established that a healthy tomato (Fig. 8)
had signiﬁcantly higher pixel values than defected tomatoes.
Based on the developed recognition models, Table 3 presents the
recognition accuracy for all the explored models. It can be observed
that the RBF-SVM outperformed all the models based on the accuracy
in recognition results on the testing dataset. In marketing, tomatoes
are sorted based on different categories.
This study presents four grading categories, and the performance of
each classiﬁcation is evaluated. It was also observed that as the
Fig. 7. Different tomato quality with their respective LAB color space and histogram (a) healthy light red (b) healthy with calyx (c) rejected (d) healthy deep red (e) second grade deep red
(f) rejected.
34
D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28–37
recognition accuracy decreases with the increase in the grading catego-
ries as presented in Table 3. However, the overall accuracy results of the
proposed system are sufﬁciently acceptable in practical applications.
3.4. Two grades category (cat 1) grading
It is observed that the RBF-SVM outperforms all the other models at
an accuracy of 0.9709. A confusion matrix in Table 4 shows the statistical
measures of the performance of the RBF-SVM cat 1 model using the
criteria accuracy = (TP + TN)/ (TP + TN + FP + FN), speciﬁcity =
TN/(TN + FP), precision = TP/(TP + FP) and sensitivity = TP/(TP
+ FN); where TP is True Positive, TN is True Negative, FP is False Positive
and FN is False Negative. The result of the classiﬁcation achieved a spec-
iﬁcity of 0.9613, precision of 0.9742, and sensitivity of 0.9775 on the
testing dataset.
3.5. Three grades category (cat 2) grading
The three quality categories include the 1st grade, 2nd grade and re-
jects based on the degree of defects, 1st grade was defects free, 2nd
grade had a lower degree of defects while reject had a higher degree
of the defect according to the observation by a tomato grading profes-
sional. From Table 3, it can be observed that RBF-SVM again
outperformed all the explored models to have the highest recognition
accuracy of 0.9542. The statistical performance of the RBF-SVM model
in grading in cat 2 is given in Table 5.
3.6. Three grades category (cat 3) grading
This grading category was similar to cat 1 grading but with the addi-
tion of color grading of the healthy tomatoes. Color is an essential factor
in grading in terms of ripeness (market readiness) in supply chain man-
agement (Jahns et al., 2001). The RBF-SVM achieved the highest accu-
racy at 0.9691. The analytical performance of the RBF-SVM model in
grading in cat 3 is given in Table 6.
3.7. Five grades category (cat 4) grading
This grading category was similar to cat 2 with a further color feature
to sort the 1st grade and 2nd grades into deep red and light red grades. It
can be observed from Table 3 and Table 7 that RBF-SVM have the
highest accuracy of 0.9385. The statistical performance of the RBF-
SVM model in grading in cat 3 is given in Table 7.
3.8. Extracted features analysis
This study presented an analysis of all the extracted feature variables
to determine the performance of each feature variable as predictors in
Fig. 8. Pixel intensity differences distinguishing the background, defected, transition and heathy tomato regions.
Table 3
Performance of all the explored models for each category of tomato grading.
Grading
categories
SVM models
ANN
Random
forest
Linear
Quadratic
Cubic
RBF
cat 1
0.9467
0.9624
0.8961
0.9709
0.9583
0.9412
cat 2
0.9301
0.9267
0.9278
0.9542
0.9421
0.9395
cat 3
0.9126
0.9035
0.9126
0.9691
0.9486
0.9255
cat 4
0.9278
0.9108
0.8835
0.9385
0.9299
0.9107
Table 4
Confusion matrix for recognition in cat 1 grading.
Grading system labeling
Manual labeling
Total
Healthy
Defected
Healthy
1173
31
1204
Defected
27
769
796
Table 5
Confusion matrix for recognition in cat 2 grading.
Grading system labeling
Manual labeling
Total
1st grade
2nd grade
Rejects
1st grade
918
19
6
946
2nd grade
25
424
28
465
rejects
7
5
566
589
35
D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28–37
each grading category. RBF-SVM models were developed based on each
feature variables and a combination of all the variables and were tested
on the validation dataset. The results were then presented in terms of
model accuracy. The extracted features were nine color features, ﬁve
texture features, and one shape feature as presented in the Materials
and methods section. It was established that all feature variables combi-
nation improved the overall performance of the recognition model, as
shown in Fig. 8. It can also be observed that shape feature was the
poorest predictor followed by color feature then texture feature. Simi-
larly, it was observed that the accuracy of the different models de-
creased as the number of grading categories increased, as shown in
Fig. 9.
4. Conclusion
This study proposes a tomato defect detection system on image
color, texture, and shape features. A relation of the tomato image LAB
color space to defect was developed. The results obtained suggest that
the proposed machine vision system can be used to detect defects in
Cherry and Heirloom tomatoes. However, this system needs to be vali-
dated on other varieties of tomatoes, despite these shortcomings, the
proposed technique with acceptable results achieved the objectives of
this research study. It is of great importance to detect defects in toma-
toes during post-harvest processing for quality inspection, marketing,
and packaging. Thus, this proposed system can be applied as an inline
grading and sorting system in tomato post harvesting. This introduced
system can also be integrated with other grading criteria such as weight,
volume, and shape estimation systems in post-harvest management of
tomatoes.
Acknowledgements
We thank the editor and the reviewers for assisting in improving the
manuscript and acknowledge Fundamental Research Funds for the Cen-
tral Universities, China (KYGX201701) for funding the research.
References
Al Ohali, Y., 2011. Computer vision based date fruit grading system: design and imple-
mentation. J. King Saud Univ. –Comput. Inf. Sci. 23 (1), 29–36.
Arakeri, M.P., 2016. Computer vision based fruit grading system for quality evaluation of
tomato in agriculture industry. Procedia Comput. Sci. 79, 426–433.
Arjenaki, O.O., Moghaddam, P.A., Motlagh, A.M., 2013. Online tomato sorting based on
shape, maturity, size, and surface defects using machine vision. Turk. J. Agric. For.
37 (1), 62–68.
Blasco, J., Aleixos, N., Molto, E., 2007. Computer vision detection of peel defects in citrus by
means of a region oriented segmentation algorithm. J. Food Eng. 81 (3), 535–543.
Chang, C.-C., Lin, C.-J., 2011. LIBSVM: a library for support vector machines. ACM Trans.
Intell. Syst. Technol. (TIST) 2 (3), 27.
Chen, Y.-R., Chao, K., Kim, M.S., 2002. Machine vision technology for agricultural applica-
tions. Comput. Electron. Agric. 36 (2–3), 173–191.
Clement, Novas, Gázquez, J.A., Manzano-Agugliaro, F., 2012. High speed intelligent classi-
ﬁer of tomatoes by colour, size and weight. Span. J. Agric. Res. 10 (2), 314–325.
Clement, Novas, José-Antonio, G., Francisco, M.-A., 2013. An active contour computer al-
gorithm for the classiﬁcation of cucumbers. Comput. Electron. Agric. 92, 75–81.
https://doi.org/10.1016/j.compag.2013.01.006.
Dhanabal, T., Samanta, D., 2013. Computerized spoiled tomato detection. Int. J. Res. Eng.
Technol. 2, 38–41.
Esguerra, E., Rolle, R., & S, R. (2018). Post-harvest Management of Tomato for Quality and
Safety Assurance (TCP/RAS/3502), 1–20. Retrieved from http://www.fao.org/3/
I8236EN/i8236en.pdf
EU, 2011. Fruit and Vegetables: Marketing Standards. Retrieved from. https://ec.europa.
eu/agriculture/fruit-and-vegetables/marketing-standards_en.
FAO. (2008). Standard for Tomatoes 293, 1–5. Retrieved from http://www.fao.org/fao-
who-codexalimentarius/shproxy/it/?lnk=1&url=https%253A%252F%
252Fworkspace.fao.org%252Fsites%252Fcodex%252FStandards%252FCODEX%
2BSTAN%2B293-2008%252FCXS_293e.pdf
FAOSTAT, 2017. Tomatoes, Production Quantity (Tons) - for All Countries. Retrieved from.
http://www.factﬁsh.com/statistic/tomatoes%2C%20production%20quantity.
Gould, W.A., 1975. Mass Sorting of Mechanically Harvested Tomatoes.
Han, S., Qubo, C., Meng, H., 2012. Parameter Selection in SVM With RBF Kernel Function.
Paper Presented at the World Automation Congress. p. 2012.
Haralick, R.M., Shanmugam, K., 1973. Textural features for image classiﬁcation. IEEE Trans.
Syst. (6), 610–621 man, and cybernetics.
RBF-SVM model Performance based on the training feature variables
Grading categories
Recognition Accuracy
Recognition Accuracy
cat 1
cat 2
cat 3
cat 4
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
color features
texture features
shape features
combined features
Fig. 9. A comparison of the effectiveness of the extracted feature variables in tomato grading.
Table 6
Confusion matrix for recognition in cat 3 grading.
Grading system
labeling
Manual labeling
Total
Healthy (deep
red)
Healthy (light
red)
Defected
Healthy (deep red)
788
39
1
828
Healthy (light red)
12
356
5
373
Defected
0
5
794
799
Table 7
Confusion matrix for recognition in cat 4 grading.
Grading system
labeling
Manual labeling
Total
1st grade
(DR)
1st grade
(LR)
2nd grade
(DR)
2nd grade
(LR)
Rejects
1st grade (DR)
572
8
11
4
2
596
1st grade (LR)
9
323
3
9
5
347
2nd grade (DR)
11
6
229
3
7
259
2nd grade (LR)
3
7
4
178
11
204
Rejects
5
6
3
6
575
594
36
D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28–37
Hashim, N., Janius, R.B., Baranyai, L., Rahman, R.A., Osman, A., Zude, M., 2012. Kinetic
model for colour changes in bananas during the appearance of chilling injury symp-
toms. Food Bioprocess Technol. 5 (8), 2952–2963.
Hu, M.H., Dong, Q.L., Liu, B.L., Pan, L.Q., Walshaw, J., 2016. Image segmentation of bananas
in a crate using a multiple threshold method. J. Food Process Eng. 39 (5), 427–432.
Jahns, G., Nielsen, H.M., Paul, W., 2001. Measuring image analysis attributes and model-
ling fuzzy consumer aspects for tomato quality grading. Comput. Electron. Agric. 31
(1), 17–29. https://doi.org/10.1016/S0168-1699(00)00171-X.
Jarimopas, B., Jaisin, N., 2008. An experimental machine vision system for sorting sweet
tamarind. J. Food Eng. 89 (3), 291–297.
Karlsson, P. (2016). Is Manual Harvest Really Better Than Mechanical Harvest? Retrieved
from https://www.bkwine.com/features/winemaking-viticulture/raw-truth-manual-
mechanical-harvest/
Kim, S., Choi, J., 2014. An SVM-based high-quality article classiﬁer for systematic reviews.
J. Biomed. Inform. 47, 153–159.
Lee, D.-J., Schoenberger, R., Archibald, J., McCollum, S., 2008. Development of a machine
vision system for automatic date grading using digital reﬂective near-infrared imag-
ing. J. Food Eng. 86 (3), 388–398.
Liming, X., Yanchao, Z., 2010. Automated strawberry grading system based on image pro-
cessing. Comput. Electron. Agric. 71, S32–S39.
López-García, F., Andreu-García, G., Blasco, J., Aleixos, N., Valiente, J.-M., 2010. Automatic
detection of skin defects in citrus fruits using a multivariate image analysis approach.
Comput. Electron. Agric. 71 (2), 189–197.
Margulis, D., 2005. Photoshop LAB Color: The Canyon Conundrum and Other Adventures
in the Most Powerful Colorspace. Peachpit Press.
Moallem, Razmjooy, 2012. Optimal threshold computing in automatic image
thresholding using adaptive particle swarm optimization. J. Appl. Res. Technol. 10
(5), 703–712.
Moallem, P., Razmjooy, N., Ashourian, M., 2013. Computer vision-based potato defect de-
tection using neural networks and support vector machine. Int. J. Robot. Autom. 28
(2), 137–145.
Moallem, P., Serajoddin, A., Pourghassem, H., 2017. Computer vision-based apple grading
for golden delicious apples based on surface features. Inf. Process. Agric. 4 (1), 33–40.
Moltó, E., Blasco, J., Gómez-Sanchís, J., 2010. Analysis of hyperspectral images of citrus
fruits. Hyperspectral Imaging for Food Quality Analysis and Control. Elsevier,
pp. 321–348.
Naik, S., & Patel, B. (2014). CIELab based color feature extraction for maturity level grading
of Mango (Mangifera indica L.). National Journal of System and Information Technol-
ogy, 0974–3308.
Naik, S., Patel, B., & Pandey, R. (2015). Shape, size and maturity features extraction with
fuzzy classiﬁer for non-destructive mango (Mangifera indica L., cv. Kesar) grading.
Paper Presented at the 2015 IEEE Technological Innovation in ICT for Agriculture
and Rural Development (TIAR).
Nandi, C., Tudu, B., Koley, C., 2014. Machine vision based techniques for automatic mango
fruit sorting and grading based on maturity level and size. Sensing Technology: Cur-
rent Status and Future Trends II. Springer, pp. 27–46.
Otsu, N., 1979. A threshold selection method from gray-level histograms. IEEE Trans. Syst.
Man Cybern. 9 (1), 62–66.
Polder, G., van der Heijden, G., 2010. Measuring ripening of tomatoes using imaging spec-
trometry. Hyperspectral Imaging for Food Quality Analysis and Control. Elsevier,
pp. 369–402.
Rokunuzzaman, M., Jayasuriya, H., 2013. Development of a low cost machine vision sys-
tem for sorting of tomatoes. Agric. Eng. Int. CIGR J. 15 (1).
Sarkar, N., Wolfe, R., 1985. Computer vision based system for quality separation of fresh
market tomatoes. Trans. ASAE 28 (5), 1714–1718.
Shaﬁee, S., Minaei, S., Moghaddam-Charkari, N., Barzegar, M., 2014. Honey characteriza-
tion using computer vision system and artiﬁcial neural networks. Food Chem. 159,
143–150.
Unay, D., Gosselin, B., Kleynen, O., Leemans, V., Destain, M.-F., Debeir, O., 2011. Automatic
grading of bi-colored apples by multispectral machine vision. Comput. Electron.
Agric. 75 (1), 204–212.
37
D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28–37
