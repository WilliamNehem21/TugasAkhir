 AASRI Procedia  3 ( 2012 )  402 – 408 
2212-6716 © 2012 The Authors. Published by Elsevier B.V. 
Selection and/or peer review under responsibility of American Applied Science Research Institute
doi: 10.1016/j.aasri.2012.11.063 
 
2012 AASRI Conference on Modelling, Identification and Control 
Nonlinear Gaussian Mixture Approximation Smoother 
Wang Xiaoxu,a* Pan Quana, Liang Yana, Cheng Yongmeia 
aInstitute of Control and Information, School of Automation, Northwestern Polytechnical University, Xi’an, Shaanxi 710072 China 
Abstract 
This paper presents a novel Gaussian mixture approximation smoother (GMA) for estimation the nonlinear 
system state. The smoothing implementation is transformed into computing some Gaussian weighted integrals, 
which triggers the development of the new GMA-URTSS algorithm by applying unscented transformation 
(UT). Simulation application demonstrates the superior performance of the proposed method. 
 
© 2012. Published by Elsevier B.V. 
Selection and/or peer review under responsibility of American Applied Science Research Institute 
 
Keywords: Nonlinear state, smoother, Gaussian mixture approximation, unscented transformation 
1. Introduction 
Nonlinear state smoothing estimation has been attracting considerable research interests (see, e,g., [1]-[3] 
and the references therein) because of its widespread applications in signal processing, navigation and 
communication. The smoothing problem involves computing the probability density function (PDF) of a sto-
chastic dynamic state
kx conditioned on a sequence of noisy measurements
1
{ , 2
, ,
,
}
N
k
N
z
z z
z
z
. The gen-
eral optimal fixed-interval smoothing scheme in conjunction with the Bayesian rule [4], is given by the func-
tional recursive relations for computation of the PDFs
(
|
)
k
p x zN
from 
+1
(
|
)
k
N
p x
z
for all
{0 1,
, }
k
N . For 
the nonlinear system, the exact description of such posterior smoothing PDFs by way of the Bayesian recur-
sive equations is unavailable and intractable since the Bayesian solution requires the propagation of full prob-
ability density which results in the computation intensive in numerical implementation [5]. Approximations 
 
 
* Corresponding author. Tel.: +86 029-88431306; fax: +86 029-88431306. 
E-mail address: woyaofly1982@163.com. 
Available online at www.sciencedirect.com
© 2012 The Authors. Published by Elsevier B.V. 
Selection and/or peer review under responsibility of American Applied Science Research Institute
Open access under CC BY-NC-ND license.
Open access under CC BY-NC-ND license.
403
 Wang Xiaoxu et al. /  AASRI Procedia  3 ( 2012 )  402 – 408 
are thus necessary, and the Gaussian approximation (GA) to such PDFs is widely accepted by the fact that the 
correspondingly derived GA smoother is always cost-effective with acceptable accuracy desirable in practical 
applications. So far, a large number of GA smoother have been proposed for smoothing the nonlinear state 
from a reentry tracking problem [1]-[2], including the extended Kalman smoother (EKS) based on the first-
order linearization, the unscented Rauch–Tung–Striebel smoother (URTSS) based on the unscented transfor-
mation (UT) , the quadrature Kalman smoother (QKS) based on the quadrature rule, the central difference 
Kalman smoother (CDKS) based on the polynomial interpolation and the cubature Klaman smoother (CKS) 
based on the cubature rule. 
    In general, the above-mentioned GA smoothers approximate the state PDF using a single Gaussian, such 
that they are only suitable for the case that the state PDF is the gaussianity or unimodality, and that the system 
model is at most weakly nonlinear. However, a state which is initially Gaussian will inevitably become sig-
nificantly non-Gaussian if propagated over a sufficiently long time span. In this situation, although the single 
GA smoother is better than the corresponding GA filter, it still inevitably results in inaccurate state estimate. 
Consequently, a Gaussian mixture approximation (GMA) to the smoothing PDF is more appropriate than the 
GA as a result that: 1) it can effectively approximate any PDF as closely as desired (in the
1L  norm) [6] by 
using a weighted sum of Gaussian densities, and 2) it enables a more accurate representation of the nonlineari-
ties in the dynamics and measurement models. Therefore, there is a great demand to develop the correspond-
ing GMA smoother for nonlinear system in a reentry tracking problem. Up to the present, an explicit and sys-
tematic solution to the derivation of the GMA smoother has been seldom reported. 
Here, motivated by the fact that the GMA is more accurate than the GA, we present the GMA smoother for 
the ballistic reentry tracking problem. The rest of the paper is organized as follows. Section II formulates the 
investigated problem and recalls the standard GA filter and smoother. Section III derives the GMA smoother 
on the basis of the standard GA estimators. Section IV gives the simulation application for the reentry track-
ing problem. Some conclusions are drawn in section V. 
2. Problem Formulation and Standard GA Estimator 
We consider the following discrete-time nonlinear stochastic system for generally describing the problem 
of tracking a ballistic target on reentry  
1
(
)
k
k
k
k
x
f
x
w
(1)
(
)
k
k
k
k
z
h x
v
(2) 
where
n
kx
is the state vector,
m
kz
is the measurement vector,
kf ( )
and
kh ( )
are known nonlinear 
functions,
n
wk
and
m
kv
are uncorrelated zero-mean Gaussian white noises satisfying
T
[
]
k
l
k
kl
w w
Q
 
and
T
[
]
k
l
k
kl
v v
R
 where
kl is the Kronecker delta function, and the initial state is assumed to be Gaussian 
distribution with mean
ˆx0|0
and covariance
P0|0
, which is independent of 
k
w and
kv . 
Our aim is to design the GMA smoother for the system in (1)-(2). In other words, we need to find the Gaus-
sian mixture approximation to the smoothing PDFs
GMA(
|
)
k
N
p
x
Z
for all
{0,
k
 1,2,
,
N}
, where 
1
{ }N
N
i
i
Z
z
. Then, the smoothing estimation and the associated covariance in the GMA form can be ob-
tained by computing the first two moments of
GMA(
|
)
k
N
p
x
Y
.  
In [6], Ito and Xiong presented a general GA filter, whose implementation can be separated into two steps 
including the state prediction and correction. Afterwards, [2] and [3] provided the GA smoother, which is 
implemented as follows. 
404  
 Wang Xiaoxu et al. /  AASRI Procedia  3 ( 2012 )  402 – 408 
1
|
|
1|
1|
,
1|
1|
T
|
|
1|
1|
ˆ
ˆ
ˆ
ˆ
[
],  
,
[
]
,
k N
k k
k
k
N
k
k
k
k k
k
k
k
k N
k k
k
k
N
k
k
k
x
x
A x
x
A
P
P
 
P
P
A P
P
A
                                           (3) 
T
T
,
1|
|
|
|
1|
ˆ
ˆ
ˆ
=
(
)
(
;
,
)
k k
k
k
k
k
k
k k
k k
k
k k
k
k
d
P
x f
x
x
x
P
x
x
x
N
.                                              (4) 
In general, the GA smoother in (3) is a forward-backward smoother [3]. As seen from Fig. 1, in the forward 
pass, the GA smoother uses the GA filter to compute the filtering density up to
(
|
)
N
N
p x
Z
. In the backward 
pass, it implements (3) for rolling backwards from
GA
1
(
|
)
N
N
p
x
Z
to
GA
( 0
|
N )
p
x Z
. Through initialization 
of
GA
|
|
ˆ
(
|
)
(
;
,
)
N
N
N
N N
N N
p
x
Y
x
x
P
N
, the GA smoother recursively operates by joint the analytical compu-
tation in (3) and the Gaussian weighted integrals in (4). 
 
Fig. 1 The forward and backward passes in the GA smoother 
The heart of implementing the GA smoother is how to compute the nonlinear Gaussian weighted integrals 
in (4). However, for the nonlinearity of
kf ( )
and 
kh ( )
, the GA smoother is only formal in the sense that it 
rarely can be directly used in practice since the model nonlinearity causes the intractability and infeasibility of 
analytically computing such integrals. For this reason, some numerical methods are required for approximat-
ing such integrals, e.g., the linearization and the corresponding GA smoother is the existing GA-EKS in [2]. 
At the same time, as a result of the better precision of unscented transformation (UT) than the linearization, 
we can also develop the existing GA-URTSS in [2] by using UT for computing such integrals.  
3. Problem Formulation and Standard GA Estimator 
For the derivation of GMA smoother, a standard result about Gaussian functions in [7] is recalled. 
Lemma 1. Given F ,d ,Q , m and P of appropriate dimensions, and thatQ and P are positive definition, it 
can be obtained that 
T
( ,
+ ,
)
( ,
,
)d
=
( ,
+ ,
)
x F
d Q
m P
x Fm
d Q + FPF
N
N
N
.                               (5) 
Firstly, we have to find the GMA filter.  
Step 1: The GMA filter. According to [6], given the Gaussian sum approximation  
GMA
GA
|
|
1
1
ˆ
(
|
)
(
|
)
(
;
,
)
M
M
i
i
i
i
i
k
k
k
k
k
k
k
k k
k k
i
i
p
p
x
Z
x
Z
x
x
P
N
,
1
1
M
i
k
i
,                       (6) 
the GMA filtering PDF can be obtained as follows 
GMA
1
1
1
GA
1
1
1
(
|
)
(
|
)
M
i
i
k
k
k
k
k
i
p
p
x
Z
x
Z
1
1
1|
1
1|
1
1
ˆ
(
;
,
)
M
i
i
i
k
k
k
k
k
k
i
x
x
P
N
,                    (7) 
where each filter is independent of the others and can be performed in a parallel manner, and the weights
1
i
k
 
405
 Wang Xiaoxu et al. /  AASRI Procedia  3 ( 2012 )  402 – 408 
are updated and normalized by learning from Eqs. (5.1)-(5.2) in [6] 
,
1
1|
1|
1
,
1
1|
1|
1
ˆ
(
;
,
)
ˆ
(
;
,
)
i
i
zz i
k
k
k
k
k
k
i
k
M
i
i
zz i
k
k
k
k
k
k
i
z
z
P
z
z
P
N
N
,                                                              (8) 
Hence, the GMA filtering estimate and the corresponding covariance are obtained by computing the first 
two moments of the PDF in (7) 
    Step 2: The GMA smoother. The PDF
GMA
1
(
,
)
k
k
k
p
x | x
z
can be expressed by the GMA method, i.e. 
GMA
1
GA
1
1
(
,
)
(
,
)
M
i
i
k
k
k
k
k
k
k
i
p
p
x | x
Z
x | x
Z
|
1,
|
1,
1
ˆ
(
;
,
)
M
i
i
i
k
k
k k
k
k k
k
i
x
x
P
N
,                     (9) 
where
|
1,
ˆ i
k k
k
x
and
|
1,
i
k k
k
P
are given in (10), and the weights 
i
k are updated and normalized by learning from 
Eqs. (5.1)-(5.2) in [6] 
|
1,
|
1
1|
T
|
1,
|
1|
ˆ
ˆ
ˆ
(
),
=
,
i
k k
k
k k
k
k
k
k
i
k k
k
k k
k
k
k
k
x
x
A x
x
P
P
A P
A
                                                       (10) 
1
1|
1|
1
1|
1|
1
ˆ
(
;
,
)
ˆ
(
;
,
)
i
i
i
k
k
k
k
k
k
i
k
M
i
i
i
k
k
k
k
k
k
i
x
x
P
x
x
P
N
N
.                                                        (11) 
    Assume that the GMA smoothing PDF at
1
k
 has been given 
GMA
1
1
GA
1
1
(
|
)
(
|
)
L
j
j
k
N
k
k
N
j
p
p
x
Z
x
Z
1
1
1|
1|
1
ˆ
(
;
,
)
L
j
j
j
k
k
k
N
k
N
j
x
x
P
N
,
1
1
1
L
j
k
j
.            (12) 
Then through using Lemma 1, the smoothed PDF
GMA(
|
)
k
N
p
x
Y
at k  can be updated from (9) and (12) 
GMA
GMA
1
1
(
|
)
(
,
|
)d
k
N
k
k
N
k
p
p
x
Z
x
x
Z
x
GMA
1
GMA
1
1
(
|
)
(
|
,
)d
k
N
k
k
k
k
p
p
x
Z
x
x
Z
x
 
T
1
|
1|
1|
|
1|
1|
1
1
ˆ
ˆ
ˆ
{
;
[
],
[
](
) }
M
L
i
j
i
i
j
i
i
i
j
i
i
k
k
k
k k
k
k
N
k
k
k k
k
k
N
k
k
k
i
j
x
x
A x
x
P
A P
P
A
N
   
GA
|
|
1
1
ˆ
(
|
)
(
;
,
)
ML
ML
s
s
s
s
s
k
k
N
k
k
k N
k N
s
s
p
x
Z
x
x
P
N
.                                                  (13) 
Hence, the GMA smoothing estimate and the corresponding covariance are obtained by computing the first 
two moments of the PDF in (13) 
Note that as shown in (3), the GA smoother starts from the initial density
GA(
|
)
N
N
p
x
Y
. Similarly, the GA 
smoother is the foundation of developing the GMA smoother, hence, according to (7), the GMA smoother is 
initialized as follows, i.e. 
GMA
GA
|
|
1
1
ˆ
(
|
)
(
|
)
(
;
,
)
L
L
j
j
j
j
j
N
N
N
N
N
N
N
N N
N N
j
j
p
p
x
Y
x
Y
x
x
P
N
,                               (14) 
406  
 Wang Xiaoxu et al. /  AASRI Procedia  3 ( 2012 )  402 – 408 
where1
i
j
L
M and
j =
i
N
N .  
In addition, the number of the GA terms in (13) grows exponentially, due to the fact that the posterior PDFs 
in (9) and (12) have a Gaussian mixture form. Therefore, in order to decrease the computational complexity, it 
is necessary to reduce the number of the GA terms. One simplest way of mixture reduction is to retain only a 
few Gaussians with highest weights, where, if {
,
1,
, }
kj
j
L are the L highest weights all of {
s ,
k  
1,
,
}
s
ML , the GMA smoother in (13) becomes 
GMA
|
|
1
ˆ
(
|
)
(
;
,
)
L
j
j
j
k
N
k
k
k N
k N
j
p
x
Z
x
x
P
N
,
1
j
j
k
k
L
j
k
j
.                                              (15) 
About the other reduction ways, please see [8].  
4. Simulation 
We describe the problem of tracking a ballistic target on reentry as the following nonlinear dynamic model 
[9] 
1,
1, +1
1,
2,
2
2, +1
2,
2,
3,
3, +1
3,
,
[
(
)
g],
.
k
k
k
k
x
k
k
k
k
k
k
x
x
x
x
x
e
x
x
x
x
                                                             (16) 
where
1x and
2x are altitude and velocity, respectively;
3x is a constant ballistic coefficient that depends on the 
target’s mass, shape, cross-sectional area and air density; g  is gravity (
2
g=9.81m/s ) and the constant 
=5 10 4
. 
For the model problem at hand, a radar is located at (0, H) and equipped to measure the range z at a sam-
pling time interval of T. Hence, the measurement equation is given by 
2
2
1,
=
+(
) +
k
k
k
z
M
x
H
v ,                                                                    (17) 
where the measurement noise
(0,
)
k
k
v
R
N
, and M is the horizontal distance. 
Here, we select the accumulative root mean square error (ARMSE) for comparing the GA and GMA 
smoothing performance. For the GMA in (7) and (15), the number of the GA terms is
50
M
L
.
in UT is 
chosen as 0. Each trajectory was simulated for 100s and a total of
N=1000
.The experimental data is that 
H =1.2km
, 
M =6km
,
R=(20m)2
, =0.5s , the initial true state
4
x0=[50km,2010m/s,7 10 ]
 and in si-
mulation, the initial state estimation 
4
ˆ0|0
=[50km,2010m/s,10 ]
x
and covariance
6
5
4
P0|0=diag[10 ,10 ,10 ]
. 
The ARMSE results of altitude and velocity are shown in Fig. 3 and Fig. 4, respectively.  
407
 Wang Xiaoxu et al. /  AASRI Procedia  3 ( 2012 )  402 – 408 
0
10
20
30
40
50
60
70
80
90
100
0
2
4
6
8
10
12
14
16
18
20
Time / s
ARMSE of Altitude
 
 
GA-EKS
GMA-EKS
GA-URTSS
GMA-URTSS
  
0
10
20
30
40
50
60
70
80
90
100
0
1
2
3
4
5
6
7
Time / s
 
 
ARMSE of Velocity
GA-EKS
GA-URTSS
GMA-EKS
GMA-URTSS
 
Fig. 2 ARMSE of altitude                                            Fig. 3 ARMSE of velocity 
    In estimation accuracy, the proposed GMA-URTSS and GMA-EKS algorithms outperform the existing 
GA-URTSS and GA-EKS in [2], respectively. Moreover, expect for some time steps, the ARMSE of the 
GMA-URTSS is less than that of the GMA-EKS since the UT technique is superior to the first-order lineariza-
tion in approximating the posterior mean and covariance of the nonlinear state. Fig. 2 and Fig. 3 make us be-
lieve that the GMA smoother performs significantly better than the corresponding GA smoother in estimation 
precision. 
5. Conclusion 
Motivated by the fact that the GMA is more accurate than the GA, based on the existing standard GA filter 
and smoother, we propose a general GMA smoother for estimating the nonlinear state from racking a ballistic 
target on reentry. Furthermore, the new GMA-URTSS algorithm is developed by using UT for numerically 
computing the Gaussian weighted integrals in GMA smoother. The simulations show that the proposed GMA-
URTSS outperforms the corresponding GA-URSS by its superior estimation accuracy. 
Acknowledgements 
  The work is supported in part by the National Natural Science Foundation of China (61203234, 61135001, 
61074179, 61075029 and 61074155), the Postdoctoral Science Foundation of China (20110491692). 
References 
[1] I. Arasaratnam  and S. Haykin, “Cubature Kalman smoother,” Automatica, 2011, 47(10): 2245-2250. 
[2] S. Särkkä, “Unscented Rauch-Tung-Striebel smoother,” IEEE Transactions on Automatic Control, 2008, 
53(3), 845-849. 
[3] S. Särkkä and J. Hartikainen, “On Gaussian optimal smoothing of nonlinear state space models,” IEEE 
Transactions on Automatic Control, 2010, 55(8), 1938-1941. 
[4] H. E. Rauch, F. Tung, and C. T. Striebel, “Maximum likelihood estimates of linear dynamic systems,” 
AIAA Journal, 1965, 8(3), 1445–1450. 
[5] X. X. Wang, Y. Liang, Q. Pan, and F. Yang, “A Gaussian approximation recursive filter for nonlinear 
systems with correlated noises,” Automatica, 2012, doi:10.1016/j.automatica.2012.06.035. 
[6] K. Ito and K. Xiong, “Gaussian filters for nonlinear filtering problems,” IEEE Transactions on Automatic 
Control, 2000, 45(5): 910-927. 
408  
 Wang Xiaoxu et al. /  AASRI Procedia  3 ( 2012 )  402 – 408 
[7] B. N. Vo and W. K. Ma, “The Gaussian mixture probability hypothesis density filter,” IEEE Transactions 
on Signal Processing, 2006, 54(11): 1-13. 
[8] I. Arasaratnam and  S. Haykin, “discrete-time nonlinear filtering algorithms using Gauss-Hermite quadra-
ture,” Proceedings of the IEEE, 2007, 95(5): 953-977. 
[9] B. Ristic, S. Arulampalam, and N. Gordon, Beyond the kalman filter. MA: Artech House, 2004. 
