Improving the non-destructive maturity classiﬁcation model for durianfruit using near-infrared spectroscopy
Sirirak Ditcharoena, Panmanas Sirisomboonb, Khwantri Saengprachatanaruga, Arthit Phuphaphuda, Ronnarit Rittiron
c, Anupun Terdwongworakuld, Chayuttapong Malaia, Chirawan Saenphona, Lalita Panduangnate
a, Jetsada Posoma,⁎
aDepartment of Agricultural Engineering, Faculty of Engineering, Khon Kaen University, Khon Kaen 40002, Thailand
bDepartment of Agricultural Engineering, School of Engineering, King Mongkut's Institute of Technology Ladkrabang, Bangkok 10520, Thailand
cDepartment of Food Engineering, Faculty of Engineering at Kamphaengsaen, Kasetsart University, Nakhon Pathom 73140, Thailand
dDepartment of Agricultural Engineering, Faculty of Engineering at Kamphaeng Saen, Kasetsart University, Kamphaeng Saen, Nakhon Pathom 73140, Tha iland
abstract article info
Article history:Received 10 October 2022Received in revised form 13 February 2023Accepted 19 February 2023Available online 22 February 2023The maturity state of durian fruit is a key indicator of quality before trading. This research aims to improve thenear-infrared (NIR) model for classifying the maturity stage of durian fruit using a completely non-destructivemeasurement. Both NIR spectrometers were investigated: the short wavelength NIR (SWNIR) ranging from450 to 1000 nm and long wavelength NIR (LWNIR) ranging from 860 to 1750 nm. The samples collected for ex-perimentation consisted of four stages: immaturity, prematurity, maturity, and ripe. Each fruit was scanned at therind position on the main fertile lobe (header, middle, and tail) and stem. The classi ﬁcation models were devel- oped using three supervised machine learning algorithms: linear discriminant analysis (LDA), support vector ma-chine (SVM), and K-Nearest neighbours (KNN). The analysis results revealed that the use of durian rind spectraonly obtained between 83.15% and 88.04% accuracy for the LWNIR spectrometer, while the SWNIR spectrometerprovided 64.73 to 93.77% accuracy. The performance of model increases when developing with combination be-tween rind and stem spectra. The LDA model developed using a combination of rind and stem spectra providedthe greatest efﬁciency, exhibiting 97.28% and 100% accuracy for LWNIR and SWNIR spectrometers, respectively.The LDA modelis therefore recommended for obtaining spectra from smoothingmovingaverage (MA) + baselineof rind position and when used in combination with the MA + standard normal variance (SNV) of stem spectra.The NIR spectroscopy indicated high potential for non-destructive estimation of the durian maturity stage. Thisprocess could be used for quality control in the durian export industry to solve the problem of unripe durianbeing mixed with ripe fruit.© 2023 The Authors. Publishing servic es by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is an openaccess article under the CC BY license ( http://creativecommons.org/licenses/by/4.0/ ).
Keywords:ClassiﬁcationDurian fruitMaturity stageNear-infrared spectroscopyNon-destructive method
1. IntroductionDurian is known as the king of fruit and considered to be an impor-tant agricultural product. Thailand is the largest producer and exporterof durian in the world (Ministry of Commerce, 2020). In particular, the Mon Thong variety is famous because it has a sweet, delicious taste. Ac-cording to Thailand's export statistics for fresh durian in 2021, Thailandis the world's number one exporter of durian, with an export volume ofaround 900,000 tons, valued at about 3 billion dollars. In 2021, the valueof Thailand's fresh durian exportation increased by approximately66.39% compared to 2020 (Export statistics of fresh durian, 2022 ).Presently, market demand for durian fruit is showing a continuously in-creasing trend, leading to high-value exports.The quality of durian exports is controlled under the sorting criteriaof the Agricultural Commodity Standards of the National Bureau of Ag-ricultural Commodity and Food Standards, Ministry of Agriculture andCooperatives to retain high quality and meet the speci ﬁed product stan- dards (Product Standard of Durian Agriculture, 2013 ). The quality of du- rian fruit for export is based on the analysis of its physical properties andexternal characteristics such as shape, amount of pulp, cleanliness with-out contamination, external defects, etc. ( Somsri, 2013). For example, to be considered a mature fruit, durian must be harvested when its rindand stem colour change from bright green to brown or dark green. How-ever, there is a high possibility that mistakes may be made if the fruitgrows on the outside branches of the tree (under sunlight). Fruit ex-posed to extreme sunlight tends to be browner, rougher, and haveArtiﬁcial Intelligence in Agriculture 7 (2023) 35 –43
⁎Corresponding author.E-mail address:jetspo@kku.ac.th(J. Posom).
https://doi.org/10.1016/j.aiia.2023.02.0022589-7217/© 2023 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is an open access article under the CC BY license (http:// creativecommons.org/licenses/by/4.0/ ).
Contents lists available atScienceDirect
Artiﬁcial Intelligence in Agriculture
journal homepage:http://www.keaipublishing.com/en/journals/artificial-intelligence-in-agriculture/dark brown stems, while the end of the thorn is drier and browner thancanopied fruit of the same age (Regional information warehouse, 2023 ). Therefore, the traditional visual sorting method is subject to potentialmistakes.Most of the durian fruit exported is fresh. To deliver fresh fruit, it isnecessary for the fruit to be transported under the appropriate condi-tions, such as by considering the transportation distance. If the transpor-tation distance is short, mature durians could be chosen which can ripenwithin 1–3 days, while a longer transportation distance requires duriansto be at a less mature stage to allow enough time for the fruit to be ripeand ready to eat when it reaches the consumer. Usually, durians aretransported under refrigeration to retain the appropriate temperature(Paoumnuaywit, 2019).According to a recent report, from 2014 to 2015, the value of durianexports reduced from 69.3 to 6.5% because the quality of the fruit failedto meet the required standards (Jintakanon, 2020). If this situation were to continue, it could affect the international export business sector,causing the loss of its existing customer base. If the durians delivereddo not meet the required standard, they will be beaten and sold at alower price causing high-value losses.To control quality and reduce the problem of young durian beingmixed with mature fruit, random selection is employed to determineits chemical values, such as total soluble solid content (TSS) and drymatter (DM), allowing the inside quality of the durian to be thoroughlyand accurately assessed. This method also has limitations in terms ofcost because such analysis is time-consuming and requires highly-skilled operators. Therefore, it is not popularly used and cannot guaran-tee 100% quality.Currently, near infrared (NIR) isused as an alternative method and has the potential to predict the quality of durian fruit.Talabnark and Terdwongworakul (2017) used FT-NIR spectroscopy (12,500–3,500 cm
−1) to assess the DM content of durian pulp. ThePLSR model developed from pulp spectra and whole fruit spectrawith sliced rind spectra were compared for performance. The pulpspectra model provided an r
pand RMSEP of 0.78% and 3.02%, respec-tively, while the model developed from whole fruit with sliced rindspectra gave an r
pand RMSEP of 0.69% and 3.57%, respectively.Somton et al. (2015)applied near-infrared spectroscopy(1100–2500 nm) to classify three maturity classes (immature du-rian, early-mature durian, and mature durian) based on sliced rindand sliced stem absorbance. They concluded that a combinationmodel using both sliced rind and stem spectra data provided thehighest classiﬁcation accuracy (94.4%). The researchers in the fore-going studies employed minimally destructive evaluation by remov-ing the stems and slicing the peel and rind to provide a ﬂat area before scanning. However, since fruit for export should not bescratched or damaged, this application is impractical. To addressthis research gap, an effective non-destructive test should be devel-oped in the future.Near-infrared spectroscopy was used to predict the sweetness of du-rian pulp both online (scanning with the sample moving) and of ﬂine (scanning with the sample remaining static) ( Leepaitoon, 2018). The online model consisted of an R
2of 0.70 and RMSEP of 4.0%. Meanwhile,the ofﬂine model had an R
2of 0.81 and RMSEP of 3.27%. The near-infrared (NIR) hyperspectral image technique was used to scan the du-rian pulp, predict DM, and classify the ripeness of the durian pulp(Sharma et al., 2022). For DM prediction, the model developed with agenetic algorithm (GA) for variable selection provided the highest per-formance with an R
2pof 0.878 and RMSEP of 1.22%. For ripeness classi ﬁ- cation, the LDA algorithm demonstrated 100% accuracy. Durian ( Durio zibethinus) ripeness detection (unripe, ripe, and overripe) was per-formed using thermal image and multivariate analysis (PCA, KNN,LDA, SVM) (Mohd Ali et al., 2021). The classiﬁcation accuracy was higher than 93% for each model. The SVM model exhibited the best per-formance, providing 97% accuracy. However, this research was con-ducted at room temperature.According to the literature review, the near-infrared spectroscopy(NIRs) techniques demonstrated a high potential to determine the ma-turity stage and ripeness of durian fruit and pulp. The previous researchresulted in destructive and minimally destructive fruit. Therefore, thispresent research attempted to perform evaluation under conditionswhich were as non-destructive as possible. Therefore, the aim of thisstudy was to apply NIR spectroscopy techniques to classify the maturityof whole durian fruit. The scanning was performed under full non-destructive conditions and two main objectives: 1) to develop a classi ﬁ- cation model for measuring the maturity stage of whole durian fruitusing SWNIR and LWNIR spectroscopy, and 2) to search for an optimalscanning method for use as a full non-destructive measurement ofmaturity class.2. Materials and methods2.1. Sample collectionDurian fruit (Mon Thong variety) was obtained from the Duangkhaedurian orchard, Nam Nao District, Phetchabun Province (Latitude16.7866, longitude 101.6478). A total of 160 fruit samples were col-lected fromﬁve different age periods, based on the days after blooming(DAB), including 80 to 90 (40 fruits), 90 to 100 (40 fruits), 100 to 110(40 fruits), 110 to 120 (20 fruits), and 120 to 130 (20 fruits). The durianfruit collected was classiﬁed into three maturity stages based on DAB:unripe (80 to 100 DAB = 80 fruits), prematurity (101 to 120 DAB =60 fruits), and mature (121 to 130 DAB = 20 fruits). The sampleswere taken to the Department of Agricultural Engineering Laboratory,Faculty of Engineering, KhonKaen University. The 30 durian fruitsfrom prematurity stage (60 fruits) were separated randomly and wereleft to ripen for seven days. They were assigned as the ripe stage(Pimten., 2021;Posomboon, 2020). Durian is a climacteric fruit. The rip-ening is regulated by ethylene which fruit can ripe by itself after har-vesting (Tongdee et al., 1990).Therefore, the durian fruits of this experiment included four matu-rity stage (unripe: 80 fruits; prematurity: 30 fruits; mature: 20 fruitsand ripe stage: 30 fruits).Table 1shows the durian fruit categorised ac-cording to maturity and number of samples.2.2. NIR scanningThe fruits sample were placed in room temperature at 25 ± 2 °C forone hour before the samples were taken for scanning to eliminate thetemperature difference factor. The NIR scanning system consisted of ameasurement chamber and two NIR spectrometers. The measurementchamber comprised a black box measuring 60 L × 60 W × 60H cm.Four halogen lamps of 25 W were installed at the top of each corner ofthe box at an angle 45° from the y-axis (see Fig. 1a). The samples were scanned using two spectrometers: long wavelength (LWNIR)spectrometer (AvaSpec-ULS2048-USB2-VA-50, AVANTES, Netherlands,wavelength range between 860 and 1750 nm), and short wavelengthTable 1Classiﬁcation of ripening based on DAB and maturity percentage following to Thongklin(2018).Stages Maturity(%)Day afterbloomingNumber of samplesTotal(fruit)Calibrationset (fruit)Validationset (fruit)Unripe≤74 80–100 80 61 19 Prematurity 75–80 101–120 30 21 9 Maturity 81–100 121–130 20 12 8 Ripe >100 leave durian toripen30 23 7DAB: days after blooming.S. Ditcharoen, P. Sirisomboon, K. Saengprachatanarug et al. Artiﬁcial Intelligence in Agriculture 7 (2023) 35 –43
36(SWNIR) spectrometer (AvaSpec-NIR256-1.7-EVO, AVANTES,Netherlands, wavelength range between 140 and 1100 nm).Spectra acquisition consisted of three steps: 1) the light source wasturned on and left for 10 min to ensure stable light intensity; 2) thedark and white references were collected; and 3) the samples werescanned using two spectrometers with the same integrating time of200 ms. Each durian fruit sample was scanned under light windows.The reﬂectance was calculated asR¼
Is/C0IdIw/C0Id , with Is, Id, and Iw being the reﬂectance intensity of the sample, dark, and white reference, re-spectively. The absorbance (A) was then calculated as A = log(1/R).The samples were scanned at the stem ( Somton et al., 2015)o fo n e side in triplicate to obtain average spectra. The rind (at header, middle,and tail position) of the fertile lobe (which is a completing lobe through-out the length of the fruit and larger than other lobes) was then scannedin triplicate at each position and averaged ( Buasub, 2007) (seeFig. 1b andFig. 2). Therefore, four spectra were obtained for each fruit: header,middle, tail, and stem. The schematic of the developed classi ﬁcation model is shown inFig. 2.2.3. Dry matter content measurementAfter scanning, the peel was removed from the fruit, and the pulptaken at the head, middle, and tail determined for DM using the dryoven method. The samples at each position weighed approximately10 g according to the digital balance system (ATX224, Shimadzu,Japan) and placed in a hot air oven at 60 °C for 72 h (UF75, Memmert,Germany) (Saechua et al., 2021). The dried samples were then weighedand the DM calculated following Eq.(1).DM%ðÞ ¼W2
W1/C2100 ð1ÞWhere W
2is theﬁnal weight of the dried sample (g), W 1is the initial weight (g). Each position was evaluated in triplicate and averaged.2.4. Model developmentFig. 2displays the schematic for developing the model of maturityclassiﬁcation. To search for the best model, the total data were analyzedusing supervised machine learning classi ﬁcation, linear discriminant analysis (LDA), support vector machine (SVM), and k-nearest neigh-bours (KNN). Spectral pre-treatment methods were used for bothnon-pre-processed (raw spectra) and pre-processed spectra from the1st derivative (D1) (gap = 5 points, segment = 5 points), 2nd deriva-tive (D2) (gap = 5 points, segment = 5 points), smoothing moving av-erage (MA) + standard normal variance (Smooth + SNV), andMA + baseline offset. For the gap-segment derivative, the gap size indi-cated the spacing between points over which the derivative is com-puted, while the segment size indicated the range over which thepoints are averaged. Adding a gap and segment to a derivative canhelp to smooth and eliminate any noise created from the derivativeitself.
(a)
(b)45o
60 cm
60 cm50 cmProbe
AvaSoftOO
n
OHalogen lampFibre opticSWNIR spectrometer
Black boxLWNIR spectrometer
AvaSoft
Fig. 1.Experimental setting, a) front view durian scanning, b) overview scanning and component of tools.S. Ditcharoen, P. Sirisomboon, K. Saengprachatanarug et al. Artiﬁcial Intelligence in Agriculture 7 (2023) 35 –43
37The training model was created using cross-validation (CV). K-FoldCV is where a given dataset is split into a K number of sections/foldswith each fold used as a testing set at some point. Taking the scenarioof 5-Fold CV (K = 5). In theﬁrst iteration, theﬁrst fold is used to test the model and the remainder to train the model. In the second iteration,the second fold is used as the testing set, while the remainder serves asthe training set. This process is repeated until each of the ﬁve folds havebeen used as the testing set (Krishni, 2018). Thus, in this research, k-fold CV of k = 5 used where the training set and test dataset are 75% and25%, respectively. Therefore, the total sample was 160, calibration setwas 117 fruits and validation set were 43 fruits.In theﬁrst step, the models were developed using rind spectra (atpositions: a (head), b (middle), and c (tail)), with each positionassigned as an individual spectrum sample to choose the optimal
Fig. 2.Schematic for model development of maturity durian classi ﬁcation.S. Ditcharoen, P. Sirisomboon, K. Saengprachatanarug et al. Artiﬁcial Intelligence in Agriculture 7 (2023) 35 –43
38spectra pre-processing technique. Therefore, calibration set had 351samples (117 × 3 spectra) and validation set had 129 samples (43 × 3spectra). The rind spectra were examined with either raw or pre-processed spectra. The appropriate spectra pre-processing techniqueand its corresponding classiﬁcation algorithm were then obtained.In the second step, when the optimal spectra pre-processing methodfor rind (fromﬁrst step) had been obtained, the pre-processed rindspectra were merged with raw stem spectra or stem spectra pre-treated with several techniques (D1, D2, MA + SNV, and MA + baselineoffset). A rind spectral sample was merged with a stem sample to form asingle sample. These combined spectra were used to generate the clas-siﬁcation model again.The performance of LDA, SVM, and KNN models was evaluated foroverall accuracy (Eq.(2)), precision (Eq.(3)), recall (Eq.(4)), and spec- iﬁcity (Eq.(5)). The variables in each equation are true positives (TP),true negatives (TN), false positives (FP), and false negatives (FN) truepositives (TP), true negatives (TN), false positives (FP), and falsenegatives (FN).Overall accuracy%ðÞ ¼
TPþTNTPþTNþFPþFN/C2100ð2ÞPrecision%ðÞ¼TPTPþFP/C2100ð3ÞRecall%ðÞ ¼
TPTPþFN/C2100 ð4ÞSpecificity%ðÞ¼
TNTNþFP/C2100ð5ÞThis work classiﬁes into four classes i.e. unripe, prematurity, matu-rity, and ripe. For example, if considering for the class of ripe stage; TP,TN, FP, and FN can be described as: TP is the number of samples thatare correctly classiﬁed for ripe; TN is the number of samples unripe, pre-maturity, and maturity; FN is the number of samples to unripe that aremisclassiﬁed as ripe, prematurity, and maturity and; FP is the number ofsamples of unripe, prematurity, and maturity that are misclassi ﬁed as ripe. Furthermore, the area under the receiver operating characteristiccurve (AUC-ROC) estimated the potential of the classi ﬁer to distinguish between classes. The AUC-ROC ranges from 0 to 1, where a score close to1 indicates that the classiﬁer can successfully divide the positive class
Fig. 3.Spectra of LWNIR spectrometer for durian: (a) raw spectra of durian rind, (b) SNV spectra of durian rind, (c) average spectra of each maturity stage of d urian rind, (d) raw spectra of durian stem, (e) SNV spectra of durian stem, and (f) average spectra of each maturity stage of durian stem.S. Ditcharoen, P. Sirisomboon, K. Saengprachatanarug et al. Artiﬁcial Intelligence in Agriculture 7 (2023) 35 –43
39from the negative. While remained three class was analyzed as same asabove mention.Both SWNIR and LWNIR spectra classiﬁcation models were gener- ated using the same methodology, and their performance subsequentlycompared. Finally, using different machine learning classi ﬁcation and pre-processing, the NIR wavelength spectrometer and spectra positionmodel (only rind or combined spectra) provided the highest accuracyand was found to be the best model.3. Results and discussion3.1. Spectral characteristics of durianThe raw spectra of durian rind and stem collected using LWNIR(860–1750 nm) and SWNIR (450 –1000 nm) are shown inFigs. 3 and 4, respectively.Figs. 3a, b, and c; 4a, b, and c show the raw, SNV, and av-erage raw spectra of the rind, respectively. Figs. 3d, e, a, and f; 4d, e, and f show the raw, SNV, and average raw spectra of the stem, respectively.Figs. 3a, b, d, and e; and 4a, b, d, and e show the raw spectra and SNVspectra of the rind and stem, respectively. Baseline offset usually oc-curred when scanning the durian fruit samples. The linear baselineshift affecting the absorption value was tilted up systematically with in-creasing wavelengths (Haruthaithanasan, 2011). The average raw spec- trum of the rind and stem at different maturity stages, i.e., unripe,premature, mature, and ripe, are presented in Figs. 3ca n dfa n d4ca n d f for LWNIR and SWNIR, respectively. The average raw spectra of bothrind and stem were clearly divided into two groups. Group 1: unripeand premature stage and Group 2: mature and ripe stage, showing sim-ilar results. While the average raw spectra between the two groups wasobviously different. For example,Fig. 3c and f show that the absorption of the two groups was clearly different at a wavelength of 1250 nm vi-brational band of sugar (Pu et al., 2016). For SWNIR, the average raw rind spectra, at a wavelength of 680 nm vibrational band of anthocya-nins and chlorophyll (Benelli et al., 2021), approximately, clearly had different absorption values at various stages. Whereas Fig. 4f shows that the SWNIR of raw stem spectra clearly had a different absorptioncurve. As previously mentioned, the different absorption values ap-peared clearly at various maturity stages resulting in the classi ﬁcation model giving good accuracy. The report by Sharma et al. (2022)shows the average spectra SNV pre-treated. At wavelengths of 900 and1200 nm the spectra can be clearly split according to the different ripe-ness stages of durian. Likewise, Saputro and Handayan (2017)
Fig. 4.Spectra of SWNIR spectrometer for durian: (a) raw spectra of durian rind, (b) SNV spectra of durian rind, (c) average spectra of each maturity stage of d urian rind, (d) raw spectra of durian stem, (e) SNV spectra of durian stem, and (f) average spectra of each maturity stage of durian stem.S. Ditcharoen, P. Sirisomboon, K. Saengprachatanarug et al. Artiﬁcial Intelligence in Agriculture 7 (2023) 35 –43
40demonstrated that the reﬂectance proﬁle of a banana was separated in the various maturity stages at wavelengths of around 480, 680, and960 nm.3.2. Dry matter contentFig. 5demonstrates the average DM of durian pulp at different matu-rity stages. The results show that the DM of durian pulp increased with arise in DAB. However, durian at the ripe stage exhibited a lower DMthan at the maturity stage because it was left to ripen naturally fromthe prematurity. These results are consistent with the ﬁndings of Chuenatsadongkot et al. (2018)in that the correlation of the DM per-centage to the DAB shows a clear trend, with the DM percentagetending to increase steadily during the period, rising from 100 to 135DAB. However, at the ripe stage, the mean percentage DM declinedless than at the maturity stage because when the durian is very ripe,the pulp smears, causing the humidity to be higher than usual. Thiscorresponds toTimkhum and Terdwongworakul (2013) ,w h e r et h e percentage DM values are lower because of the high moisture causedby the heavy rainfall. This demonstrates that humidity affects thepercentage DM.3.3. Classiﬁcation modelsTable 2shows the accuracy of validation set of each classi ﬁcation model developed using the full wavelength from LWNIR. The reporton theﬁrst step indicates that the maturity classiﬁcation models were developed using durian rind spectra coupled with different algorithms(i.e., LDA, SVM, and KNN) and either raw spectra or pre-treated spectra(i.e., D1, D2, MA + SNV and MA + baseline offset) to ﬁnd the optimal pre-treatment and its corresponding algorithm. The model ef ﬁciency was determined based on precision, recall, speci ﬁcity, and accuracy. The results show that the optimal pre-treatment of the D2 was suitablefor LDA and SVM algorithms, and the MA + SNV was appropriate forKNN, provided precision, recall, speciﬁcity, and overall accuracy for val- idation set of 71.45%, 71.62%, 91.61%, and 87.50%; 73.91%, 62.45%,90.21%, and 88.04%; and 73.91%, 62.45%, 90.21%, and 88.04%, respec-tively. Finally, the optimal spectra pre-treatment of the D2 was appro-priate for LDA and SVM, while MA + SNV was optimal for KNN.According to the report on the second step, either the raw or pre-treated stem spectra were matched with the rind spectra (pre-treatedusing the D2 for LDA and SVM, and MA + SNV for kNN, obtained fromtheﬁrst step). From the hypothesis, it is clear that the combination ofrind spectra and stem spectra could improve the classi ﬁcation accuracy. Table 2indicates that the combined spectra (rind and stem) can in-crease the model performance of all algorithms. The LDA model devel-oped with the rind (D2) + stem (MA + SNV) provided the bestclassiﬁcation efﬁciency, precision, recall, speciﬁcity, and overall accu- racy of 96.40%, 91.88%, 97.55%, and 97.28%, respectively. The confusionmatrix of validation set was displayed in Table 3.
Fig. 5.Dry matter of durian pulp according to different maturity stage.
Table 2The accuracy of the different classi ﬁcation models for validation set developed using the full wavelength of LWNIR spectrometer.Model Spectra Rind Stem N Precision Recall Speci ﬁcity Accuracy 5-foldCVOverallaccuracyAUC-ROCLDA Durian rind Raw –129 59.83 62.03 88.16 77.04 ± 0.64 83.15 0.82 1
stderivative –129 69.27 70.59 91.12 65.96 ± 2.00 86.96 0.77 2
ndderivative –129 71.45 71.62 91.61 66.40 ± 1.34 87.50 0.75 MA + SNV –129 66.34 65.73 88.68 76.00 ± 1.76 84.78 0.78 MA + Baseline offset –129 61.93 64.06 88.01 73.18 ± 2.86 83.15 0.79 Durian rind combination with stem 2
ndderivative Raw 129 91.85 85.32 90.00 84.80 ± 1.08 97.83 0.881
stderivative 129 94.04 92.60 93.65 84.60 ± 1.99 93.48 0.902
ndderivative 129 95.74 93.79 95.32 83.14 ± 1.22 94.57 0.88MA + SNV 129 96.40 91.88 97.55 82.54 ± 1.19 97.28 0.86MA + Baseline offset 129 83.60 85.27 95.45 79.65 ± 2.97 93.48 0.85 SVM Durian rind Raw –129 67.45 64.28 90.92 66.02 ± 2.39 87.50 0.82 1
stderivative –129 73.17 63.54 90.43 71.82 ± 1.69 88.04 0.85 2
ndderivative –129 73.91 62.45 90.21 75.76 ± 1.23 88.04 0.87 MA + SNV –129 68.06 58.19 87.97 71.82 ± 1.69 85.33 0.85 MA + Baseline –129 60.19 55.45 88.34 75.76 ± 1.23 85.33 0.87 Durian rind combination with stem 2
ndderivative Raw 129 91.57 81.23 96.17 80.50 ± 1.00 95.11 0.951
stderivative 129 90.91 79.57 95.63 84.32 ± 0.98 94.57 0.942
ndderivative 129 87.24 76.15 94.61 86.00 ± 1.33 92.93 0.95MA + SNV 129 75.88 66.00 91.65 81.93 ± 2.72 89.67 0.92MA + Baseline offset 129 85.45 82.44 95.33 83.35 ± 0.96 93.48 0.94 KNN Durian rind Raw –129 61.64 57.67 87.99 53.70 ± 1.25 85.33 0.71 1
stderivative –129 55.38 56.16 89.46 66.14 ± 2.78 84.78 0.76 2
ndderivative –129 73.91 62.45 90.21 69.82 ± 2.81 88.04 0.75 MA + SNV –129 58.67 57.80 88.17 63.42 ± 1.47 84.24 0.78 MA + Baseline –129 54.70 55.42 88.10 63.18 ± 1.06 83.15 0.71 Durian rind combination with stem 2
ndderivative Raw 129 74.77 65.36 90.04 75.18 ± 1.45 87.50 0.821
stderivative 129 83.16 78.87 94.11 81.70 ± 0.82 92.39 0.852
ndderivative 129 47.19 48.99 85.80 68.88 ± 1.95 79.35 0.75MA + SNV 129 75.63 73.16 92.82 79.06 ± 1.64 90.22 0.83MA + Baseline offset 129 75.88 66.00 91.65 78.75 ± 1.04 89.67 0.83
NNumber of sample for validation set;MAS m o o t h i n gm o v i n ga v e r a g e ;SNVStandard normal variate.S. Ditcharoen, P. Sirisomboon, K. Saengprachatanarug et al. Artiﬁcial Intelligence in Agriculture 7 (2023) 35 –43
41Table 4shows the accuracy of validation set of each classi ﬁcation model developed using the full wavelength from SWNIR. The analysismethodology was the same as for LWNIR. The maturity classi ﬁcation models were developed using durian rind spectra. Each algorithmcoupled with either raw or pre-processed spectra was used for modeldevelopment toﬁnd the optimal pre-treatment and its correspondingalgorithm. The model efﬁciency was also determined based on preci-sion, recall, speciﬁcity, and overall accuracy. The results show that theoptimal pre-treatment of the MA + baseline offset was suitable forLDA, the D1 for SVM, and the D2 for KNN, provided precision, recall,speciﬁcity, and overall accuracy of 84.70%, 83.48%, 85.30%, 84.39%;95.99%, 91.99%, 95.56%, 93.77%; and 87.90%, 85.62%, 87.50%, 87.01%,respectively.As seen inTable 4, it can be observed that the combined spectra(rind and stem) can increase the model performance for all algorithms.The LDA model developed with the rind (MA + baseline off-set) + stem (MA + SNV) provided the best classi ﬁcation efﬁciency, obtaining precision, recall, speciﬁcity, and overall accuracy of 100%.Table 5demonstrate the confusion matrix of validation set forSWNIR spectrometer which model ability was higher slightly thanthat of LWNIR spectrometer.The NIR-HSI (NIR hyperspectral image) system (900 –1600 nm) was used to create the ripeness classiﬁcation model (unripe, ripe, andoverripe) following DAB. The model was developed with pulp durianspectra. The results display that the LDA model could be used to classifythe durian maturity level, providing high accuracy of 100% ( Sharma et al., 2022).Talabnark and Terdwongworakul (2017) reported that FT-NIR spectroscopy (800 –2500 nm) can be used to classify the fruitmaturity levels (at 101, 108, 115, and 122 days) using sliced rind spectrawith a high accuracy level of 87.48%, and the model developed by PLS-DA. Whereas the model established from pulp durian spectra providedhigher accuracy than the sliced rind spectra (92.5%). Somton et al. (2015)found that the classiﬁcation model from NIR (1000 –2500 nm) developed using a combination of sliced rind and sliced stem spectracan achieve higher accuracy than models created from only sliced rindspectra (94.4% accuracy).Timkhum and Terdwongworakul (2012) ap- plied visible NIR spectroscopy (350 –750 nm) to classifyﬁve maturity stages (ranging from 106 to 134 DAB) using sliced rind durian spectra.The model achieved the best classiﬁcation accuracy (83.30%), whilethe model developed with sliced stem spectra provided higher accuracythan the sliced rind spectra (94.7%) (Saputro and Handayani, 2017).These results were supported by Praneenararat, who found that the du-rian stem contains liquid sugar compounds that coincide with sweet-ness. The chemical analysis revealed that when the durians began toripen, the sucrose increased signiﬁcantly while the glucose and fructosedecreased (Praneenararat, 2021). Therefore, the higher accuracyTable 3Confusion matrix of the LDA model developed with the rind (2nd derivative) + stem(MA + SNV) for LWNIR spectrometer.PredictionUnripe Prematurity Maturity RipeActual Unripe 57 0 0 0Prematurity 4 23 0 0Maturity 0 0 24 0Ripe 2 0 1 18
Table 4The accuracy of the different classi ﬁcation models for validation set developed using the full wavelength of SWNIR spectrometer.Model Spectra Rind Stem N Precision Recall Speci ﬁcity Accuracy 5-foldCVOverallaccuracyAUC-ROCLDA Durian rind Raw –129 76.37 76.79 78.92 86.86 ± 1.43 77.86 0.88 1
stderivative –129 81.38 80.73 82.55 86.44 ± 1.62 81.64 0.87 2
ndderivative –129 74.62 74.01 77.29 86.32 ± 1.81 75.65 0.87 MA + SNV –129 79.05 80.70 78.45 90.10 ± 1.24 79.57 0.87 MA + Baseline offset –129 84.70 83.48 85.30 90.18 ± 1.62 84.39 0.88 Durian rind combination with stem MA + Baseline offset Raw 129 97.80 93.18 97.70 94.48 ± 1.26 95.44 0.95 1
stderivative 129 100.00 100.00 100.00 95.08 ± 1.06 100.00 0.952
ndderivative 129 99.46 97.73 99.44 94.06 ± 1.65 98.59 0.95MA + SNV 129 100.00 100.00 100.00 96.36 ± 0.99 100.00 0.96MA + Baseline offset 129 99.46 97.73 99.44 93.70 ± 0.73 98.59 0.94 SVM Durian rind Raw –129 80.83 72.66 82.97 69.02 ± 2.07 77.81 0.84 1
stderivative –129 95.99 91.99 95.56 89.90 ± 0.65 93.77 0.93 2
ndderivative –129 93.97 92.63 94.31 89.02 ± 1.52 93.47 0.94 MA + SNV –129 79.73 77.86 80.22 81.78 ± 0.96 79.04 0.94 MA + Baseline offset –129 74.66 72.89 76.04 72.64 ± 1.59 74.47 0.84 Durian rind combination with stem 1
stderivative Raw 129 92.69 89.18 92.62 87.60 ± 1.63 90.90 0.971
stderivative 129 96.52 95.35 96.11 94.16 ± 0.70 95.73 0.992
ndderivative 129 98.44 98.81 98.33 94.76 ± 0.92 98.57 0.99MA + SNV 129 95.63 95.95 95.48 92.80 ± 1.05 95.71 0.99MA + Baseline offset 129 93.06 93.57 92.14 88.67 ± 0.96 92.86 0.97 KNN Durian rind Raw –129 70.51 53.72 75.74 60.46 ± 0.52 64.73 0.72 1
stderivative –129 85.87 84.61 85.40 82.74 ± 2.12 85.01 0.87 2
ndderivative –129 87.90 86.52 87.50 86.52 ± 1.24 87.01 0.88 MA + SNV –129 80.43 69.88 77.94 72.76 ± 1.22 73.91 0.87 MA + Baseline offset –129 66.45 67.66 64.83 65.94 ± 1.18 66.24 0.72 Durian rind combination with stem 2
ndderivative Raw 129 98.44 98.81 98.33 86.96 ± 1.96 98.57 0.891
stderivative 129 97.92 98.33 97.73 91.80 ± 0.91 98.03 0.942
ndderivative 129 97.92 98.33 97.73 95.70 ± 0.88 98.03 0.95MA + SNV 129 98.44 98.81 98.33 92.80 ± 1.05 98.57 0.95MA + Baseline offset 129 97.92 98.33 97.73 88.67 ± 0.96 98.03 0.92
NNumber of sample for validation set;MAS m o o t h i n gm o v i n ga v e r a g e ;SNVStandard normal variate.Table 5Confusion matrixof theLDA modeldeveloped with the rind(MA + Baseline offset) + stem(MA + SNV) for SWNIR spectrometer.PredictionUnripe Prematurity Maturity RipeActual Unripe 57 0 0 0Prematurity 0 27 0 0Maturity 0 0 24 0Ripe 0 0 0 21S. Ditcharoen, P. Sirisomboon, K. Saengprachatanarug et al. Artiﬁcial Intelligence in Agriculture 7 (2023) 35 –43
42provided by the durian stem spectra model accords with the results ofthe present study (seeTables 2 and 4), while the spectra of the stem combined with rind gave high accuracy. Some previous studies have re-sulted in destructive measurement, and others minimally destructive.The aim of the present research was to provide a completely non-destructive measurement. The NIR spectroscopy, combined withmachine learning has the potential to be used as a non-destructivemeasurement.The application of NIR spectroscopy could reduce operating time,and different positions of rind combined with stem spectra producinga similar performance. Any rind position combined with stem spectracan be used for prediction. Theﬁndings reveal that different rind spectracan give similar results. Accurate prediction was achieved by the LDAclassiﬁcation model developed from MA + baseline rind spectra (differ-ent positions, i.e., head, middle, and tail) and MA + SNV stem spectra forSWNIR spectrometer.4. ConclusionThis research demonstrates that the NIR spectroscopy technique hasthe potential to become a full non-destructive measurement. The modelwas generated using several machine learning techniques for classi ﬁca- tion of the maturity (four stages, i.e., immature, premature, mature, andripe) based on durian DAB. The strength of this research is that the sam-ples are not destroyed during the classiﬁcation process. The LWNIR and SWNIR coupled with LDA, SVM, and KNN algorithm gave slightly differ-ent performance results. The developed LWNIR model using rindspectra provided overall accuracy of 87.50%, 88.04%, and 88.04%, respec-tively, while the developed SWNIR model using rind spectra gave over-all accuracy of 84.39%, 93.77%, and 87.01%, respectively. The modelsimproved when combined spectra (rind spectra + stem spectra) wereused. The LDA model was the best classiﬁer, providing 100% classiﬁca- tion accuracy for SWNIR when the rind spectra were pre-treated withthe MA + baseline offset and the stem spectra pre-treated usingMA + SNV. The rind spectra at any position combined with the stemspectra is recommended for practical use. The NIR spectrometer couldbe applied to classify durian maturity. Any spectrometer instrumentsc o u l db eu s e da si to f f e r st h es a m eh i g he f ﬁciency, but SWNIR is recom- mended because it is less expensive than LWNIR.CRediT authorship contribution statementSirirak Ditcharoen:Conceptualization, Methodology, Software,Formal analysis, Investigation, Resources, Data curation, Writing – original draft, Writing–review & editing, Visualization.Panmanas Sirisomboon:Validation, Funding acquisition. Khwantri Saengprachatanarug:Validation, Conceptualization.Arthit Phuphaphud: Validation, Writing–review & editing.Ronnarit Rittiron:Validation. Anupun Terdwongworakul:Validation.Chayuttapong Malai:Validation, Data curation.Chirawan Saenphon:Validation, Data curation, Methodol-ogy.Lalita Panduangnate:Validation, Data curation.Jetsada Posom:Con- ceptualization, Formal analysis, Data curation, Writing –review & editing, Supervision, Project administration, Funding acquisition.Declaration of Competing InterestNone.AcknowledgementsThis work also supported by Research and Graduate Studies, KhonKaen University, Thailand; Research Fund for Supporting Lecturer toAdmit High Potential Student to Study and Research on His ExpertProgram Year 2021 from Graduate School, Khon Kaen University,Thailand; the Agricultural Research Development Agency (Public Orga-nisation) [grant number CRP6405031580]. The authors would like toacknowledge the Department of Agricultural Engineering, Faculty of En-gineering, Khon Kaen University, for providing the equipment and loca-tion for the experiments and King Mongkut's Institute of TechnologyLadkrabang for its
ﬁnancial support.References
Benelli, A., Cevoli, C., Fabbri, A., Ragni, L., 2021. Ripeness evaluation of kiwifruit byhyperspectral imaging. Biosyst. Eng. https://doi.org/10.1016/j.biosystemseng.2021. 08.009.Buasub, W., 2007. Agricultural extension academic manual (Durian). Bureau Agricult.Commodit. Promot. Manag, accessed 1 August 2022. http://www.agriman.doae.go. th/home/t.n/t.n1/3fruit_Requirement/01_Durian.pdf . Chuenatsadongkot, T., Treeamnuk, T., Treeamnuk, K., 2018. Comparison of the ability toevaluation of‘Monthong’durian maturity using color value from spectrometer andimage processing. Int. J. Mech. Prod. Eng. Issue 6. http://iraj.in. Export statistics of fresh durian, 2022. Of ﬁce of Agricultural Economics. http://impexp. oae.go.th/service/export.php?S_YEAR=2563&E_YEAR=2565&PRODUCT_GROUP=5252&PRODUCT_ID=4977&wf_search=&WF_SEARCH=Y . Haruthaithanasan, V., 2011. NIR-Infraede Technology and Applications in Industries.https://ebook.lib.ku.ac.th/ebook27/ebook/2015RG0071/ . Jintakanon, K., 2020. Solving the problem of maturity durian. Technol. Chaoban, accessed 1August 2022,https://www.technologychaoban.com/agricultural-technology/article_183405.Krishni, 2018, December 17. K-Fold Cross Validation. DataDrivenInvestor. https:// medium.datadriveninvestor.com/k-fold-cross-validation-6b8518070833 . Leepaitoon, K., 2018. On-line and off-line nir spectroscopy for measuring total soluble solidsof durian (Durio zibethinus CV monthong). King Mongkut ’s Institute of Technology Ladkrabang.http://ebook.lib.kmitl.ac.th/assets/library/reader/reading/index.php . Ministry of Commerce, 2020. Durian is the king of Thai fruits. Trade Policy and StrategyOfﬁce.http://www.tpso.moc.go.th/sites/default/ ﬁles/thueriiyn_240863.pdf. Mohd Ali, M., Hashim, N., Shahamshah, M.I., 2021. Durian (Durio zibethinus) ripeness de-tection using thermal imaging with multivariate analysis. Postharvest Biol. Technol.176.https://doi.org/10.1016/j.postharvbio.2021.111517 . Paoumnuaywit, P., 2019. How to export durian to be fresh until the destination. Logist.Maneger, accessed 1 August 2022. https://logistics-manager.com/th/how-to-deliver- durian/.Pimten., 2021, February 15. How to rapid ripen durian. Shopper ’s Cafe; Elsevier B.V. https://www.shopat24.com/blog/trending/how-to-make-durian-ripen-quickly-tips-that-durian-necks-should-not-miss . Posomboon, M., 2020, February 15. How to cutting durian for 5 days have not come offthe bouquet. Kasetgo; Elsevier B.V. https://kasetgo.com/t/topic/8839 . Praneenararat, T., 2021. Durian ripeness indicator from the sugar in its stem.Chulalongkorn University.https://www.chula.ac.th/en/highlight/50923/ . Product Standard of Durian Agriculture, 2013. National Bureau of Agricultural Commodityand Food Standards.http://e-book.acfs.go.th/Book_view/256 . Pu, H., Liu, D., Wang, L., Sun, D.W., 2016. Soluble solids content and pH prediction and ma-turity discrimination of lychee fruits using visible and near infrared hyperspectral imag-i n g .F o o dA n a l .M e t h o d s9( 1 ) ,2 3 5 –244.https://doi.org/10.1007/s12161-015-0186-7 . Regional information warehouse, 2023. Botanical characteristics. Agricultural ResearchDevelopment Agency Retrieved 2 August 2022, from https://www.arda.or.th/ kasetinfo/south/durian/controller/index.php . Saputro, A., Handayani, W. (2017). Wavelength Selection in Hyperspectral Imaging forPrediction Banana Fruit Quality. 2017 International Conference on Electrical Engi-neering and Informatics (ICELTICs 2017) October 18-20, 2017 - Banda Aceh,Indonesia.https://doi.org/10.1109/ICELTICS.2017.8253259 . Saechua, W., Sharma, S., Nakawajana, N., Leepaitoon, K., Chunsri, R., Posom, J.,Roeksukrungrueang, C., Siritechavong, T., Phanomsophon, T., Sirisomboon, P.,Lapcharoensuk, R., Pornchaloempong, P., 2021. Integrating Vis-SWNIR spectrometer
in a conveyor system for in-line measurement of dry matter content and solublesolids content of durian pulp. Postharvest Biol. Technol. 181. https://doi.org/10. 1016/j.postharvbio.2021.111640 . Sharma, S., Sumesh, K.C., Sirisomboon, P., 2022. Rapid ripening stage classi ﬁcation and dry matter prediction of durian pulp using a pushbroom near infrared hyperspectral im-aging system. Measurement 189. https://doi.org/10.1016/j.measurement.2021. 110464.Somsri, S., 2013. Durian. National Bureau of Agricultural Commodity and Food Standards.https://www.acfs.go.th/standard/download/DURIAN_new.pdf . Somton, W., Pathaveerat, S., Terdwongworakul, A., 2015. Application of near infraredspectroscopy for indirect evaluation of ‘Monthong’durian maturity. Int. J. Food Prop. 18 (6), 1155–1168.https://doi.org/10.1080/10942912.2014.891609 . Talabnark, A., Terdwongworakul, A., 2017. Minimally destructive evaluation of durianmaturity using near infrared spectroscopy. Thai Soc. Agricult. Eng. J. 23 (2). http:// www.tsae.asia/new/wp-content/uploads/2018/08/v23_2.pdf . Timkhum, P., Terdwongworakul, A., 2012. Non-destructive classi ﬁcation of durian matu- rity of‘Monthong’cultivar by means of visible spectroscopy of the spine. J. Food Eng.112 (4), 263–267.https://doi.org/10.1016/j.jfoodeng.2012.05.018 . Timkhum, P., Terdwongworakul, A., 2013. Non-destructive classi ﬁcation of durian matu- rity of‘Monthong’cultivar by visible spectroscopy of the husk. Thai Society of Agricul-tural. Eng. J. 19, 1–6.www.tsae.asia. Tongdee, S.C., Suwanagul, A., Neamprem, S., 1990. Durian Fruit Ripening and Effect of Va- riety, Maturity Stage at Harvest, and Atmospheric Gases. International Society forHorticultural Science.S. Ditcharoen, P. Sirisomboon, K. Saengprachatanarug et al. Artiﬁcial Intelligence in Agriculture 7 (2023) 35 –43
43