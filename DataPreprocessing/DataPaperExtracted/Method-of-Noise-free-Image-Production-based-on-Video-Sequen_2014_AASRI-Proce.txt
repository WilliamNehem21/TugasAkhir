 AASRI Procedia   6  ( 2014 )  73 ‚Äì 81 
2212-6716 ¬© 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).Peer-review under responsibility of Scientific Committee of American Applied Science Research Institutedoi: 10.1016/j.aasri.2014.05.011 ScienceDirect
 2013 2nd AASRI Conference on Computational Intelligence and Bioinformatics 
Method of Noise-free Image Production Based on Video Sequence Handling 
Korovin I.S.*, Khisamutdinov M.V. 
Scientific research Institute of multiprocessor computing systems of Southern Federal University (SRI MCS SFEDU)   
Abstract 
In the paper we suggested a method for video sequence handling with the aim of producing a single noise- free image. An algorithm for the image alignment based on the approaches of dot matches search and the resolution capacity enhancement has been elaborated. A method for multiple images stacking has been proposed to produce a single noise-free picture. The proposed method has been successfully experimentally tested using developed software tools. 
 ¬© 2013 Korovin I.S., Khisamutdinov M.V. Published by Elsevier B.V. Selection and/or peer 
review under responsibility of American Applied Science Research Institute  
Keywords: image handling; software; White Gaussian Noise; image alignment;Peak Signal to Noise Ratio (PSNR), image stacking, image recognition 
Introduction Image enhancement is widely applied in various do mains, namely cartography, photogrammetry, medicine, astronomy, etc. This task involves processing of a single or a series of images, aiming to produce a single noise-free picture. As the research results [1, 2] have revealed that methods and algorithms, aimed at single picture processing slightly enhance the PSNR (for estimating the quality of the noise reduction methods the noise-free pictures 
 
 
* Corresponding author. Tel.: +7-918-55-65-883; fax: +7-8634-36-03-76. E-mail address: korovin_yakov@mail.ru. 
Available online at www.sciencedirect.com
¬© 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).Peer-review under responsibility of Scientific Committee of American Applied Science Research Institute74   I.S. Korovin and M.V . Khisamutdinov   /  AASRI Procedia   6  ( 2014 )  73 ‚Äì 81 
 are overlapped by White Gaussian Noise, further on th e tested filtering algorithm is applied, and the output picture is compared to the original one with PSNR (peak signal-to-noise ratio[3, 4]) assessment), whereas filters based on video sequences reach high values of the given parameter. So, while elaborating a method of image quality enhanc ement based on the analysis of image series, received from the same foreshortening, it was decided to implement a method of multiple images stacking. However one should take into consideration the particularity of receiving images series ‚Äì certain images of the sequence can be displaced relative to each other. That is why the proposed method of receiving a single noise-free image based on image series handling implies two steps:  xalignment of images series; xmultiple images stacking in order to receive a single noise-free picture    Furt
her on the proposed algorithms of these steps implementation are thoroughly considered. 1. An Algorithm of Image Series Alignment Based on Dot Matches Search and the Resolution Capacity Enhancement Having analyzed the open sources it has been found out that known approaches based on dot matches search possess the high alignment accuracy [5], whereas program implementation of the methods based on resolution power feature the performance are of high rate [6]. This paper suggests a combined algorithm of image alignment based on the dot matches search and the resolution capacity enhancement methods. The proposed algorithm allows to reach a pixel by pixel accuracy of the image alignment due to approach, based on the dot matches search in the pictures, as well to high rate due to the iterative resolution capacity enhancement based method application. Fig 1 presen ts the structure of the image alignment combined algorithm. Let us consider this algorithm functioning in details. Suppose, we have two black and white (monochromic) images, ImageRef and ImageCurrent. Each image is  represented as HxW  elements matrix. It is necessary to find a tra
 nsformation of ImageCurrent matrix into ImageRef matrix which would minimize the luminance difference of the images (with minimal luminance difference of the images).  The essential idea of the algorithm is to process consequently the images of the video sequence in order to align the images to the pivotal image ImageRef. It is the first image that is chosen to be the pivotal one.  Every image ImageCurrent undergoes the iterative handling. Under each iteration the picture resolution grows bigger and the dot math search is performed [7, 8]. Further on, from the dot matches found matrix transformation operators are calculated.  Displacement and rotation operators are considered as matrix transformation operators. Rotation transformation similar to that while considering flat geometrical objects, allows to turn the original image‚Äôs angle. The rotation around the centre of the image is performed, with two rotation options being possible: ximage parts that fall outside its limits, are t
runcated, while the blank  parts are filled with pixels with zero luminance; x…ö new image size is calculated based on the rotation angle so, t
 hat the rotated image fits the new dimensions. The blank parts are also filled with pixels with zero luminance. In any case the rotation transformation [9] is calculated using the following formula: 75  I.S. Korovin and M.V . Khisamutdinov   /  AASRI Procedia   6  ( 2014 )  73 ‚Äì 81 
 
 
Fig. 1. The scheme of the images alignment combined algorithm 
[] [ ][] [] , [ 0 , 1 ] [ 0 , 1 ],[ 0 , 1 ] [ 0 , 1 ]newold old oldold old…ãijCa b a H b WCa H V b W ¬è / ¬è¬≠¬Æ¬ê ¬ê¬Ø
                                                                                              (1) where  76   I.S. Korovin and M.V . Khisamutdinov   /  AASRI Procedia   6  ( 2014 )  73 ‚Äì 81 
 sin( ) ;2newHai ¬ò M   
cos( ) ;2newWbj ¬ò M 
 
0, 1;old iH  
0, 1;old jW     C -  is the luminance of the pixels filling the blank parts of the image; ƒ≥ ‚Äì is the clockwise rotation angle  in radians. The 
presented formula rounds off the transformed coordinates. However, using a bilinear interpolation is also possible, when the pixel luminance is calculated as weighted sum of the luminance of the four neighboring pixels.    Following this, pixel by pixel image alignment is performed to ImageCurr and ImageRef. For pixel by pixel image alignment ImageRef is compared to 9 variants of the ImageCurr (with the original ImageCurr being shifted 1 pixel upwards/downwards and 1 pixel in 
 diagonals), and the correlation coefficient (kor) being analyzed by formula [1]: 
2(( , ) ) ( ( , ) ) ,(( , ) ) mm crm crImageRef c r ImageRef ImageCurr c r ImageCurrkorImageRef c r ImageRef¬ò  ¬¶¬¶¬¶¬¶
                                        (2) where 
m ImageRef  - is a mean of ImageRef; 
m ImageCurr  - is a mean of ImageCurr. One of the 9 variants of the shifted image ImageCurr featuring the highest value of the correlation coefficient ko
 r is chosen as pixel by pixel aligned image to ImageRef. 2. Algorithm of Multiple Images Stacking for a Single Noise- free Image Production  The submitted algorithm is based on defining the coefficient of the contribution that each image makes to the common sum.  The contribution coefficient k is the marker of the image noisiness; the higher the noise, the lower is t
he coefficient, similarly the lower the noise the higher is the contribution coefficient. The possible contribution coefficient value lies within the range of 
[0,1]k¬è . Lets us denote a sequence of original images as I, the total number of images in a sequence as n.  Let us hol
 d that the images in the sequence are all taken from the same exposure and the same illumination of the visible object; then the signal intensity S will be the same in every image 
iI, however images of the
iIsequence have different noise level  iNcaused by various disturbances (for instance by impulse noise of the electronic equipment). To estimate the quality of the single image of the sequence let us take the parameter SNR (signal-to-noise ra
 tio, that is a nondimensional value equal to the ratio of th e useful signal power to the noise power [10]), for the i image of the sequence the SN
R parameter is calculated by the formula: 
iii SSNRN                                                                                                                                                 (3) 77  I.S. Korovin and M.V . Khisamutdinov   /  AASRI Procedia   6  ( 2014 )  73 ‚Äì 81 
 As the iI images have the same signal level S but the different noise level iN, it means that their 
i SNRcorrelation  is in inverse ratio to iN, while the contribution coefficient ik is calculated by the formula: 
21() ,iik NN                                                                                                                                                 (4) where 
1N - is the noise level of the least noisy image of the  I sequence, i.e. the image featuring the highest SNR.     In order to search for the least noisy image 
1I we use the brightness histogram analysis.  With regard to the found coefficients
ikfor every iIthe total resulting imagesumI is calculated by the formula: 
1nsum i iik
  ¬ò¬¶ II                                                                                                                                            (5) As the noise for every image is considered to be  random and independent, the noise composition is performed in second degree. Knowing the value of the
i SNRparameter for every image of theiI sequence, it is possible to calculate the 
sum SNR value of the total resulting image sumIby the formula:  
21 ()nsumii  ¬¶ SNR SNR                                                                                                                             (6)  The submitted algorithm of the im
age quality enhancement comprises 5 basic steps.  1.The search for the least noisy image   in the I series based on the brightness histogram analysis.  To select the least noisy image   in the series I, the averaged luminance histogram  construction based on avera
ging of all images  histograms  is carried out. Further search for histogram Hist  closest to Hist
med is made, and the image is marked as 
1I. 2.Selecting zones in the image 
1I, corresponding to the noisy areas N area. It is carried out as follows: the entire image 
1I area is assigned to N area, then local areas of singular points N
local are excluded, searched according to [11]. From the area N area1 the desired area N area = N area1 ‚Äì N local, corresponding to the noisy areas in the image 
1I, is obtained. 3.Calculation based on the found areas N
area of the value iN for each image iI. For each image 
iI noise level value iN.11 N is calculated, since the given image is the least noisy in the series, other values 
iN are defined as the standard deviation of pixel brightness of areaN  area between the image 
1I and image iI.  4.Calculating the coefficients 
ik. For each image 
iI contribution factor ik is calculated by the formula (4). 5.Median addition of images 
iI in the series I with the calculated contribution factor ik, in order to obtain one perspective non-noisy image 
sumI. At this stage, median addition of images I series taking into account factor 
ik is performed. The essence of the classical median method consists in choosing a new pixel brightness value - the average value of the sorted array of pixel brightness. In this work we propose an approach that takes into account the noisiness of each image 
iI in the series I, in accordance with the contribution factor ik. Scheme of image median addition algorithm, taking into account the contribution factor of each image is shown in Fig. 2. With a probability, equal to the value of this coefficient 
[0,1]ik¬è , addition of image iI pixel brightness 78   I.S. Korovin and M.V . Khisamutdinov   /  AASRI Procedia   6  ( 2014 )  73 ‚Äì 81 
 value to the array of pixel brightness for the median method of image quality improvement is made. Thus, the most noisy images contribution factor of which 
0iko , will not participate in the formation of the final image 
sumI. As the result of the algorithm work the final image sumI is received. 
 
Fig. 2. The scheme of algorithm of image series median composition, taking into account the contribution factor of each image 
2. Experimental Research and Benefits On the basis of the proposed method of image quality enhancement software tools has been  developed [12] It has been tested on images obtained from standard television camera (TC) of water-cooled power reactor (WCPR) in the process of preventative maintenance (this procedure is performed every year on nuclear power plants in Russian Federation). On the single images, obtained from TC, impulse noise caused by work of common radio and electronic test equipment is found. In Fig. 3 a comparison of a single grayscale series image and of the enhanced image, obtained by stacking image series by the proposed method of image quality improvement, is shown. 79  I.S. Korovin and M.V . Khisamutdinov   /  AASRI Procedia   6  ( 2014 )  73 ‚Äì 81 
 
 
Fig. 3. The result of the image quality enhancement method 
Experimental comparison of the proposed image quality enhancement method with well-known image quality improvement methods has been carried out. Experiments have been conducted using grayscale images from the image database USC-SIPI [13].  For the experiment images 5.1.09 - Moon surface …¢ 7.1.03 ‚Äì Tank have been chosen. Next, two test video sequence
 have been generated using the mentioned images. White Gaussian noise has been imposed on every single image of video sequences and image quality of received video sequences has been improved applying various methods, in particular, by median composition of images sequence method, by the method, implemented in RegiStax (This program is designed for equalization, addition and image processing in formats BMP, JPEG, FITS, TIFF , or  series of AVI frames) [14] and the proposed method of image series stacking taking into consideration the contribution factor of each image. Quality enhancement results are presented in Tables 1 and 2: 
Table 1. Comparing the methods of image quality enhancement, video sequence resolution 256x256 pixels (original picture 5.1.09 - Moon surface) Number of images in the sequence PSNR(median composition) (dB) PSNR (RegiStax) (dB) PSNR(the proposed method) (dB) 
2 20.751 20.794 20.796 
4 20.949 21.576 21.649 8 21.342 21.8 21.78 16 21.383 21.818 21.824 32 21.665 22.52 22.569 64 22.336 24.708 24.685 128 25.098 26.177 26.211 256 27.611 28.121 28.156 512 30.446 31.03 30.933 1024 33.493 33.901 33.905 2048 36.32 36.684 36.59 4096 39.452 39.703 39.842 80   I.S. Korovin and M.V . Khisamutdinov   /  AASRI Procedia   6  ( 2014 )  73 ‚Äì 81 
 Table 2. Comparing the methods of image quality enhancement, vi deo sequence resolution 512x 512 pixels (original picture 7.1.03 - Tank) Number of images in the sequence PSNR(median composition) (dB) PSNR (RegiStax) (dB) PSNR(the proposed method) (dB) 
2 26.577 26.595 26.591 
4 27.492 27.79 27.881 8 27.541 29.903 29.75 16 28.007 31.243 31.46 32 31.964 33.994 34.199 64 36.003 36.615 36.822 128 38.989 39.384 39.413 256 41.999 42.296 42.189 512 45.068 45.269 45.18 1024 48.212 48.217 48.21 2048 51.239 51.352 51.298 4096 53.993 54.497 54.523 
 
 
Fig. 4. Image fragment 64x64 pixels obtained after stacking  2,128 and 4,096 noisy images 5.1.09 - Moon surface using the propo sed method 
 
Fig. 5. Image fragment 64x64 pixels obtained after stacking  2,128 and 4,096 noisy images 7.1.03 - Tank using the proposed method 
As there can be seen from the tables, the proposed method outgoes the method of median images series addition, and can be compared with the image series addition method, implemented in the program RegiStax; and in determined conditions (discrete number of images in the series) outgoes RegiStax methods in PSNR values. 81  I.S. Korovin and M.V . Khisamutdinov   /  AASRI Procedia   6  ( 2014 )  73 ‚Äì 81 
 Conclusion While conducting research and development relating to the topic of this paper a method of video sequence processing in order to receive a single non-noisy image has been suggested. The images series alignment algorithm has been developed on the basis of dot ma tches search and of resolution capacity improvement approaches. The multiple images stacking algorithm has been developed to receive a single non-noisy image. The proposed method of image quality enhancement is different from the existing ones by using the analysis of each series image contribution factor that mini mizes the impact of noisy images on the final result. It is proved that in comparison with the method of images series median addition the proposed method provides the best PSNR value. It is shown that th e proposed method is comparable with the image series addition method, implemented in the program RegiStax, and when a certain number of images in the series it outgoes it in terms of PSNR. References [1] Pratt, W.K. Digital image processing / W.K.  Pratt. ‚Äì Wiley Publisher, ‚Äì 2007. ‚Äì 807 p. [2] Gonzalez, R.S. Digital Image Processing [Text] / R.S. Gon-zalez, R.E. Woods / New Jersey Prentice Hall, ‚Äì 2002. ‚Äì 954 p. [3] Shelukhin O.I. Estimation of quality of stream video trans-mission in telecommunication networks with software and hardware tools application [Text] / O. I. Shelukhin, Yu. A. Ivanov // Electric technical and informational complexes and systems, - 2009.-  ã4.- p. 48-56. [4] Tim
bai E.I. Application of correction filter for images  quality improvement, compressed by JPEG method. [Text] / E.I. Timbai // Computer optics, ‚Äì 2011. ‚Äì Volume 35. ‚Äì  ã4. ‚Äì p. 513-518. [5] Sagues, C. 
 From lines to epipoles through planes in two views [Text] / C. Sagues, A.C. Murillo, F. Escudero and J.J. Guerrero // Pattern Recognition, ‚Äì 2006. ‚Äì  ã3. ‚Äì P. 384-393. [6] Dowm
 an, I.J. Automating image registration and absolute orientation: solutions and problems [Text] / I.J.Dowman / Photogrammetric Record, ‚Äì1998.  ‚Äì P. 5-18. [7] Bay, …á. Speeded-up robust features (surf) [Text] / …á. Bay, A. Ess, T. Tuytelaars, and L. V. Gool. // Com
 puter Vision and Image Understanding. ‚Äì 2008. ‚Äì ã3. ‚Äì P. 346-359.  [8] L
 owe, T. Distinctive image features from scale-invariant keypoints [Text] / T. Lowe , G. David // International Journal of Computer Vision. ‚Äì 2002. ‚Äì ã2. ‚ÄìP. 91-110. [9]
  Computer graphics. [web resource]: Polytechnic University of Tomsk, 2005  http://compgraph.ad.cctpu.edu.ru/Rot.htm [10] Nikitin, O.R. Development of quality estimation crite rions of digital television functioning [Text]. /O.R. Nikitin, E.A. Archipov, V.Sh. Shanazarov // Methods and devices of in-formation transmission and handling, - 2007.-  ã8, p. 139 -142.  [11]
 Tretiak, O.J. Surface-based matching using elas tic trans-formation [Text] / O.J.Tretiak, M.Gabrani // Pattern Recognition, ‚Äì 1998. ‚Äì P. 87-97. [12] Korovin, I.S. Method of fuel assemblies height de tection in the task of fuel assemblies television control in the nuclear reactor //Journal of Computer and Information technologies, - 2012. ‚Äì  ã12, - p. 3-7. [13] University of Sout
 hern California. Signal and Image Processing Institute: The USCSIPI Image Database ‚ÄìUniversity of Southern California, Los Angeles, USA, 2011. ‚Äì http://sipi.usc.edu/database/ [14] RegiStax 6: Registax 6 software for alignment/stacking/processing of images ‚Äì 2011 Cor Berrevoets (The Netherlands). ‚Äì http://www.astronomie.be/Registax/   