 AASRI Procedia   9  ( 2014 )  99 â€“ 106 Available online at www.sciencedirect.com
2212-6716 Â© 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).Peer-review under responsibility of Scientific Committee of American Applied Science Research Institutedoi: 10.1016/j.aasri.2014.09.017 ScienceDirect
2014 AASRI Conference on Circuit and Signal Processing  (CSP 2014) 
Application of Nonlinear H âˆž Filtering Algorithm for Initial Alignment of the Missile-borne SINS 
Zhiqiang Wua, Yu Wanga, Xinhua Zhua,* 
aSchool of Mechanical Engineering, Nanjing University of  Science and Technology, Nanjing 210094, China 
 
Abstract 
The Hâˆž filtering and Unscented Transformation(UT) algorithm are introduced to deal with the initial alignment error of m issile-borne Strapdown Inertial Navigation System(SINS), which is caused by the  nonlinear error model and the u
 ncertainty of the disturbance noise. Firstly, on the basis of a dditional quaternion error, the error model of SINS is built up . Secondly, the nonlinear Hâˆž filter based on UT and Hâˆž f
iltering is constructed, which is with nonlinear approximation ability and strong robustness. Finally, simulations are made compared with UKF and the n
onlinear Hâˆž filter under the c onditions of disturbance model of strong wind. The result shows that nonlinear Hâˆž fi
lter is more stable and faster than U KF under the disturbance conditions of strong wind and can effectively improve the accuracy of initial alignment and ro
bustness of the algorithm. 
 Â© 2014. Published by Elsevier B.V. Selection and/or peer review under responsibility o
 f American Applied Science Research Institute   
Keyword: Strapdown Inertial Navigation System; initial alignment; additional quaternion  error; nolinear H âˆž filtering; large initial a ttitude error 
 
 
* Corresponding author. Tel.: +86 13601404770; fax: +86 2584303258 . E-mail address: zhuxinhua@njust.edu.cn. 
Â© 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).Peer-review under responsibility of Scientific Committee of American Applied Science Research Institute100   Zhiqiang Wu et al.  /  AASRI Procedia   9  ( 2014 )  99 â€“ 106 
1. Introduce Initial alignment is one of the most momentous technologies in a  Strapdown Inertial Navigation S
 ystem(SINS). Under the circumstances of low sensor accuracy and external disturbing motion, one crucial problem in initial alignment of missile-borne SINS is how to verify the initial transformational matrix  from th
 e missile bodyâ€™s coordinate system to the navigation coordin ate s
 ystem efficiently and accurately. Initial alignment of missile-borne SINS can be divided into two categories: a
 utonomous alignment after launch and transfer alignment before launch. In both modes, the SI NS is in constant motion with drastic posture changes, thus frequently influenced by uncertain disturbance. Traditional Kalman Filtering requires the accurate priori  knowledge of the mathematical model of the studying obj ec
 t and the noise being white noise. However, when in missile-borne situation, the noise tends to be colored type . In
  combination with the error in system model, there will be filter divergence if traditional Kalman Filtering is applied. Therefore, the properties of being robu
 st and nonlinear are required in the initial alignment of missile-borne SINS. A good number of researchers are involved in developing  
 robust nonlinear filtering algorithm. Literature [1] deals with the rapid alignment of ship-borne weapon INS with large initial azimuth attitude error under co
mplex environment disturbances. Based on the nonlinear error propagation model, velocity plus angular r
ate matching method was applied in the implemen tation of the alignment. Literature [2] suggests a quaternion-based nonlinear error model in rapid transfer alignment. Literatures[3 -5] carry out an intensive stud
 y in Hâˆž filtering. It is suggested that due to its significant effect in uncertainty disturbed moving -base rap
 id alignment, this filtering is appropriate both for linear and nonlinear models. Moreover, when there is colored noise or unmatched models, Hâˆž filtering still keeps its robustness. Based on the research above, it is found that applying Hâˆž filtering to the initial alignment in SINS is an effective estimating method in that it is relatively more rapid, accurate and robust, and is more suited to this application.    To deal with the problems of nonlinearity of error model and the disturbance -induced uncertainty in noise i
 n SINS moving-base initial alignment, a quaternion-based nonlinear error model is introduced, and through enh
 ancing the approximation ability of nonlinear model with Unscented Transformation (UT) algorithm and in
 creasing the robustness to uncertain noise in filtering process with Hâˆž algorithm, a new Hâˆž f
iltering algorithm is put forward. Simulations are made compared  to conventional Kalman algorithm in the condition of
  large misalignment angle and strong wind. It is verified that this algorithm is effective in the initial alignm
ent of missile-borne SINS. 2. System Model The posture error in navigation system refers to the mal-alignment angle (or misalignment angle) between platf
 orm coordinate system and navigation coordinate system. In a SINS, quaternion describes the trans
formational relation between carrier coordinate system (system b) and navigation coordinate system (sy
 stem n). Thus, the calculation error of quaternion can be used to decide the mal -alignment angle of the carrier. Additive quaternion error
 (AQE), which is the difference between calcu lative quaternion and actual quaternion, can be described as: 
>@T nbnbq q q q Q Q Q3 2 1 0Ë† G G G GG                                                                                          (1) In the equation above, 
nbQ is the actual quaternion from the carrier system to navigation  system. Ë†nbQ is 101  Zhiqiang Wu et al.  /  AASRI Procedia   9  ( 2014 )  99 â€“ 106 
the calculative quaternion. Considering the short span of the alig
nment process, the influence of location error is ignored. Meanwhile, the measurement error of the accelerometer and gyro can be regarded as the sum of random constant and white noise. The posture error equation is: 
>@ nennbbibnbninbibQ YQ U QQQGZGZG Z G Z GË†21Ë†212121 
                                                     (2) In this equation, 
>@
Â»Â»Â»Â»Â¼ÂºÂ«Â«Â«Â«Â¬Âª   
01 23103 22 3 0 13210q q q qq q q qq q q qq q q qQnb
ËˆÂ»Â»Â»Â»Â»Â¼ÂºÂ«Â«Â«Â«Â«Â¬Âª   0000
xy zx zyyz xzyxbibZ Z ZZZ ZZ ZZZ Z ZZËˆ>@
Â»Â»Â»Â»Â¼ÂºÂ«Â«Â«Â«Â¬Âª   0000
ENUE UNNU EUNEninZ Z ZZZ ZZ ZZZ Z ZZ 
bibZrepresents the projection of the angular speed of relative inertial frame (system i) on system b. ninZ represents the projection of the angular speed of
  relative inertial frame (system i) on system n. Eq uation (2) is the linear differential equation of
QG, and in the derivation, misalignment angle is not assumed to be a minimum. So, the carrierâ€™s posture error propagation
 characteristic in a large misalignment angle is accurately rep resented in it. The speed error equation
 [8] goes like this: 
Ë†Ë† Ë†Ë†Ë† Ë† Ë†2 [ ] ( ) 2() ()()nn b T n b T T T bbbnb n n n nbi e i n e nVC f Y Q C f Q Q Y Q U Q fCV VGGGGZZGG Z  u Â’  u  u
                                          (3) In the equation (3), 
nbnbnbC C C  'Ë†illustrates the calculative error of posture matrix, and b nbf CË†' is t he nonlinear function of 
QG. The speed error in the northeast day coordinate system and the quaternion errors are set to be State Var
 iables, while the speed error as measured signal, the system -state equation and measuring equation are presented
  as follows: 
() ( ,) ()xt f xt G wt 
      () () ()zt H xt vt                                                                                 (4) 
) , (t x fcan be divided into two parts of linear and nonl inear, so equation (4) can be transformed into  
0 () () () ( ,) ()xt F txt pxt G t Z   
                                                                                                       (5) In this equation, 102   Zhiqiang Wu et al.  /  AASRI Procedia   9  ( 2014 )  99 â€“ 106 
^`Tbzbybxbzbybx u n eq q q q V V V x H H HG G G G G G G Â’ Â’ Â’ 3 2 1 0 , and the coefficient matrix 
) (0t F is the linear part, which is described as: 
Â»Â»Â»Â»Â¼ÂºÂ«Â«Â«Â«Â¬Âª 0 0 0 0)Ë†(2100) ()22( 0 )21( 0)12( 0 )11( 00 nbnb Q UF FC F Ft F
                                                                                                            (6) In this equation, 
Â»Â»Â»Â¼ÂºÂ«Â«Â«Â¬Âª :  :  :  :    02cos) ( 2)/(sin) ( 2 cos) ( 2sin) ( 2 )/()/(ta n
)11( 0
MOMOOOLh R vL LLh R v h R L vFM UN U NN>@T b nbT b nbQ f C Q Y f C FË†Ë†Ë†2Ë†Ë†Ë†2)12( 0  u   
Â»Â»Â»Â¼ÂºÂ«Â«Â«Â¬Âª Â»Â»Â»Â»Â¼ÂºÂ«Â«Â«Â«Â¬Âª    0 0 )/(ta n0 0 )/(10 )/(10Ë† Ë† Ë†Ë† Ë† Ë†Ë† Ë† Ë†Ë† Ë† Ë†21
0 121 0 323 03 2 1
)21( 0h R Lh Rh Rq q qq q qq q qq q qFNNM >@ninbibF Z Z2121)22( 0   The nonlinear part is defined as
(,)pxt ,1Ë†(,)() ()(,)00Tbfx tYQ U Q fpxt GGÂªÂºÂªÂº  Â«Â»Â«Â»Â¬Â¼Â¬Â¼, and the m easurement matrix is
>@330HIu  3. Nonlinear Hâˆž Filtering Algorithm Hâˆž filter are applied in the initial alignment of missile -borne SINS. When the missile body is disturbed by airf
 low, the system noise is colored, and modelling  error exists. Severe divergence will arise in traditional Kal
 man filtering. However, Hâˆž filtering still keeps its stron
g robustness. Therefore, Hâˆž filtering being ap plied in the initial alignment of missile-borne SINS breaks the restriction of Kalman. Hâˆž filtering is a much m
 ore applicable and effective estimating method.  On the basis of Unscented Transformation and Hâˆž algorithm, this chapter employs the algorithm idea in literatu
 re [9] and puts forward a UT and Hâˆž based algorithm, which is referred to as nonlinear Hâˆž filter. This alg
 orithm uses unscented transformation in nonlinear fitting, and adopts average Hâˆž algorithm in m
 odification, which endow it with better nonlinear approa ch capacity than Extended Kalman Filter (EKF) and stronger robustness than Unscented  Kalman Filter (UKF).   3.1. Principle of Unscented Transformation When parameterizing the statistical property of a random  
 variable with a cluster of discrete sampling points, these points are named Sigma Points. Suppose that the input state x is the dimension vector of L, Sigma Points can be selected according to the principle below. 
x x 0  ;L i P L x xi x i ,......,2 , 1 ) ) ( (    Ç‚Ç‚ O;L L L i P L x xL i x i 2,......,2 , 1) ) ( (      Ç‚Ç‚O          (7) 103  Zhiqiang Wu et al.  /  AASRI Procedia   9  ( 2014 )  99 â€“ 106 
In the equation (7), L K L   ) (2D O is the parameter for distribution. Drepresents the distribution of sampling point near
x, whose value range is 1104d dD ; K is normally valued 0 and i xP L) ) ( (O represents th e matrix square root line i. Put the selec ted state vector into the nonlinear function   
f, i.e. 
Li x f Yii 2,...,2 , 1 , 0),(  Ç‚, then weigh the output statistical property of the approximation analysis system. 
Â¦
 |LiimiY W y20           Â¦
  |LiTiiciyy Y y Y W P20))(( In the equation above,  
120 Â¦
 LimiWËˆ120 Â¦
 LiciW. And the typical initialmW0andcW0are:    
0mWLOO          2 01cWLODEO                                                                                                             (8) And,
D, the scale parameter, which decides the distribution range of sigma points, is normally valued a small positive number. 
E is used to describe the distribution of x, which is optimal in normal distribution.  
2E ; L iLW Wcimi2,...2 , 1 ,) ( 21   Ç‚O. 3.2. Hâˆž Filtering Algorithm For the discrete system 
1kk k k kxF x G w         kk k kyH x v                                                                                           (9) In the equation (9), 
x represents the un-estimated state vector. For the easy use of  filter, an estimator is added. 
kk kzL x           kLI                                                                                                                        (10) For the given positive number 
J, if >@KKFG  is in full rank, the necessary and sufficient condition of th e existence of Hâˆž filter is that the positive definite symmetric matrices must meet the f Riccati  equation belo
 w. 
11 1 // 10, 0,...,i ii ii i i i iHPP H L R i kL ÂªÂºcÂªÂºc !  Â«Â»Â¬Â¼Â¬Â¼ ,and 
200
iIRI
JÂªÂº Â«Â»Â¬Â¼  For a given positive number 
J, the estimated state of the system vector is[4] 
//Ë†Ë†kk k kkzL x                                                                                                                                           (11) 104   Zhiqiang Wu et al.  /  AASRI Procedia   9  ( 2014 )  99 â€“ 106 
The recursive formula of /Ë†kkx is [4] 
// 1 / 1Ë†Ë† Ë†()kk kk k k k kkxx K y H x       1//21()
kk kkk k k kKI P L L P HJcc 
                                                     (12) The formula with time updated is:  
1//Ë†Ë†kk k k kxF x        1//kk k k k k k kPF P F G Gcc   3.3. Design of nonlinear Hâˆž Filter   According to the addictive-quaternion-error-based system equation, when there is a n
onlinear section in the state equation of the system, dealing with this nonl inear problem using UT avoids the linear errors caused by EKF. Then standard Hâˆž filtering algorithm is applied to 
get the nonlinear Hâˆž filtering algorithm, which is perf ormed as follows. First, initialization, which involves the initial predicted filtering figure, covariance matrix
0P and the s ystem noise covariance matrix 
0Q. Calculate the sigma points using equation (7), with L=n. 
0Ë†Xx ; Ë†(( ) )ix iXx n P O    1,2,...,in ; Ë†(( ) )ix in Xx n P O    1 ,2 ,...,2in n n    Second, with the constant use of UT, solve the mean value and covariance of the nonlinear function . i. Get the sigma points mapping collection of the nonlinear function .
/1/1 () ( () )kk i kk iXf X 1,2,...,2in  ii. Predict the mean value of the nonlinear function
2/1 /10Ë†()nmkki kk iixW X  Â¦. iii. Predict the covariance of the nonlinear function
2/1 /1 /1 /1 /10Ë†Ë†[( ) ][( ) ]ncTkk i k kk k k kk ki P W Xx Xx   Â¦. Third, calculate the gain matrix of the Hâˆž filtering. i. Get the covariance matrix
kP. 
11 /1 /1 1 1 1 /11k TT kk k k k k k k k k kHPP P H L R PL    ÂªÂºÂªÂº Â«Â»Â¬Â¼Â¬Â¼   ; 1/1 1 12100 kTT kk kkk kHIRPHLLI
JÂªÂºÂªÂºÂªÂº Â«Â»Â«Â»Â¬Â¼Â¬Â¼Â¬Â¼  ii. Get the gain of filtering. 
1()TTkk k k k kKP C I C P C     Finally, modify the measurement of state. 
/1 1/1 Ë†Ë†Ë†()kk k kkk k kxx Ky C x          4. Simulation Result Using the nonlinear Hâˆž 
filtering algorithm, the initial alignment in large misalignment angle u nder wind disturbance is simulated. In the simulation, suppose that the angle of pitch ranges between 45Â°Â±5Â° and the frequency is 2 Hz, and that the roll angleÏˆranges between 0Â°Â±3Â°, and the frequency is 10Hz. The constant drift of gyro signal is 0.01Â°/s; the mean square root of white noise drift is 0.01Â°/s; the time span for first order markov process is 3600s; the square root of white noise is 0.01Â°/s. The accelerate bias is 10 -4g; the mean squ
 are root of random white noise is 10âˆ’4 g; the time span for first order markov process is 1800s; the square root of white noise is 10âˆ’4 g. The posture updating cycle is 1ms; the filtering cycle is 100ms; 
5J . While the wind disturbance is irregular, its scope and freque ncy range are known. Thus a disturbance model is set 105  Zhiqiang Wu et al.  /  AASRI Procedia   9  ( 2014 )  99 â€“ 106 
accordingly. Fig. 1 illustrates the results of simulation. 
2.0 0.15sin(2 ) 0.2sin( 0.5) 0.5sin(0.5 )2.7 0.15sin(2 ) 0.2sin( 0.5) 0.3sin(0.5 ) xytt ttt t TS S STS S S   Â­Â®   Â¯
                                                       (13) In Fig. 1, curve 1 presents the filter results of UKF, and cur
 ve 2 describes the filter results using nonlinear Hâˆž f
ilter algorithm. The alignment errors brought about by high frequency component in the wind -disturbing m odel are effectively restrained through UKF and nonlinear Hâˆž filter. The influence of low frequency component becomes the major interference source. As shown in Fig. 1, due to the influence of low frequency interference, the east misalignment angle errors esti mated by UKF shows a diverging trend, which fails to achieve stable state even at 200s. By contrast, the nonlinear Hâˆž filter algorithm becomes stable within 50s, with the east misalignment angle errors confined to 4.733Â´. The north misalignment angle errors estimated with UKF are confined quickly, but unstably, with some fluctuations. However, the errors estimated by H âˆž filter algorithm, though confined to a below-theoretical-accuracy figure of 7.243Â´, are stable. These results dem
 onstrate that if the linearity of the error model is focused while sensor accuracy and the uncertainty of noise are neglected, there will be relatively large  alignment errors in the initial alignment of missile -borne SINS. T
 he result that the accuracy of Hâˆž filter algorithm is lower than theoretical level demonstrates that the robustness of the filter is achieved in the price of sa crificing filtering accuracy. The results of simulation show that nonlinear Hâˆž filter algorithm possesses certain robustness to the external interference. This algorithm can meet the requirements of accurate and rapid initial alignment in missile -borne SINS.   
 
Fig.1. Curves of UKF and nonlinear Hâˆž filter under disturbance, (a) eastward misalignment angle error, (b) northward misalignment a ngle error 
5. Conclusion Due to the restriction of sensor accuracy
 and external interference in missile-borne SINS, conventional lin ear error equation and Kalman filter algorithm can no  longer deal with the problem of initial alignment. This thesis explores the initial alignment if missile -borne SINS. Firstly, addictive-quaternion-error-based n
 onlinear error equation, unscented transformation algorithm and Hâˆž filter are introduced. To solv
e the problem of linearity of the system equation and external interference, a new nonlinear Hâˆž filter algorithm is th
 en proposed. The digital simulation compares the filter effect of UKF and nonlinear Hâˆž filter under the circu
 mstance of strong wind interference. Results demonstrates that the nonlinear Hâˆž filter algorithm is su
 perior than UKF in terms of accuracy and robustness.  106   Zhiqiang Wu et al.  /  AASRI Procedia   9  ( 2014 )  99 â€“ 106 
References [1] Xin Liu, Bo Wang, Zhihong Deng. Rapid alignment method of INS with large initial azimuth uncertainty u
nder complex dynamic disturbances. Proceeding of the 2012 UKACC International Conference on Control, Cardiff UK, 2012: 1070-1075.  [2] Hao Y, Xiong Z, Wang W, et al. Rapid transfer alignment  based on unscented Kalman filter. Proceedings of
  the 2006 American Control Conference. Minneapolis USA,  2006:2215-2220.  [3] Ryu J H, Kim C S, Lee S H, et a.l. Hâˆž in
finity lateral control of an autonomous vehicle using the  RTK- DGPS. International Journal of Automotive Technology, 2007:8:583- 591. [4] ZHANG Tao, XU X iao-su. Research on SINS Initial Alignment and the Methods for the Parameter Î³ Selectio
n Based on Hâˆž Filtering Technique. Journal of Sichuan University (Engineering Science Edition),  2009:4:240-245. (in chinese) [5] You-chol Lim, Joon Lyou. Transfer alignment error com
pensator design using Hâˆž filter. Proceeding of Am erican Control Conference. 2002:1460-1465. [6] Xiaoying Kong, Eduardo Mario Nebot, Hugh Durrant -Whyte. Development of a non-linear psi-angle m
 odel for large misalignment errors and its application in INS alignment a
nd calibration. Proceedings of the 1999 IEEE International Conference on Robotics & Automation, Detroit USA. 1999 :1430-1435. [7] Yuanxin Wu, etc. Observability of Strapdown INS alignm en
 t: a global perspective. IEEE Transactions on Aerospace and Electronic Systems, 2012:1:78-102. [8] S.P.Dmitriyev, O.A.Stepanov, S.V.Shepel. Nonlinea r f
 iltering methods application in INS alignment. IEEE Transactions on Aerospace and Electronic Systems, 1997:1:260 -271. [9] Zhou Benchuan, Cheng Xianghong. Robust UKF algorithm in SINS initial alignment. Journal of  Southeast University ( English Edition). 2011:1: 56-60. [10] Muhammad Ilyas, Yunchun Yang, Ren Zhang. SINS initial alignment using wavelet de -noising method f
 or aircraft navigation. Proceedings of the 10th World Congress on Intelligent Control and Automation. Beij
ing China, 2012: 3921-3926.  [11] Paul D.Groves. Optimising the transfer alignment of we apon
  INS. The Journal of Navigation 2003:56: 323-335. [12] M.Reinstein. Evaluation of fine alignment algor ithm
  for inertial navigation. Evaluation.2011:7:255 -258,  