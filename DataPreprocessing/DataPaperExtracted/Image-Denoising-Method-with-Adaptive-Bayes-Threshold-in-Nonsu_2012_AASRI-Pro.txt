 AASRI Procedia   1  ( 2012 )  512 – 518 
2212-6716 © 2012 Published by Elsevier Ltd. doi: 10.1016/j.aasri.2012.06.080 
 2012 AASRI Conference on Computational Intelligence and Bioinformatics  
Image Denoising Method with Adaptive Bayes Threshold in Nonsubsampled Contourlet Domain 
Mingwei Chuia, Youqian Fengb, Wei Wanga, *, Zhengchao Lic, Xiaodong Xua
aMissile Institute, Air Force Engineering University, Sanyuan 713800, China 
bScience Institute, Air Force Engineering University, Xi’an 710051, China 
cPLA Foreign Language Institute, Luoyang 471003, China 
Abstract 
In this paper, an improved image denoising method based on a nonlinear thresholding function with adaptive bayes threshold in Nonsubsampled Contourlet Transform (NSCT) domain. In overcoming the shortcomings of the same threshold, the noise deviation of the different sub-band are estimated based on the coefficients of different directional and level sub-bands in NSCT domain, and the thresholds of every sub-band is estimated by Bayesian threshold estimation method. After choosing the thresholds, a nonlinear thresholding function was chosen to overcome the shortcomings of the soft and the hard thresholding function. The simulation results show that the proposed method in this paper can remove Gaussian white noise more effectively, and get  a higher PSNR value and keep image texture and detail information more clearly, which also has a better visual effect. 
2012 Published by Elsevier B.V. Selection and/or peer review under responsibility of American Applied Science Research Institute 
Keywords: Image Denoising; Bayes Threshold;  Nonsubsampled Contourlet Transform; Nonlinear Thresholding Function. 
* Corresponding author. Tel.: +86-1348-8073-753 E-mail address: cmw1985@foxmail.com.
AASRI
Procedia
www.elsevier.com/locate/procediaAvailable online at www.sciencedirect.com
Open access under CC BY-NC-ND license.
Open access under CC BY-NC-ND license.513  Mingwei Chui et al.  /  AASRI Procedia   1  ( 2012 )  512 – 518 
1. Introduction With the rise in the number of image sensors (or pixels) per unit area of a chip, modern image capturing devices are increasingly sensitive to noise. Camera manufact urers, therefore, depend on image denoising algorithms to reduce the effects of such noise artifacts in the resultant image.
[1] Recently proposed denoising methods use different approaches to address the problem. Image denoising is used to remove the additive noise while retaining as much as possible the important signal features. Denoising images corrupted by Gaussian noise using wavelet techniques is very effective because of its ability to capture the energy of a signal in few energy transform values. Wavelet transform is good at energy compaction, the small coefficient are more likely due to noise and large coefficient due to important  signal feature. So, Wavelet denoising is an important technique in the area of image noise reduction. Over the last decade, it has been widely used in images denoising.
 [2-6]
Wavelet transform is an efficient image denoising algorithm, but it lacks shift and orientation invariance, and is poor in directional selectivity. Aiming at  the shortcomings, Martin Vetterli and M. N. Do
[7] put forward a kind of “Real” two-dimension signal sparse represent ation method: Contourlet transform, which has multi- resolution, local time-frequency and the opposite directio ns. Then the contourlet transform is used widely in images denoising, and have a well performance. 
[8-9] However, Contourlet transform lacks the shift invariance which due to the sampling process, the image will produce false Gibbs distortion and invariance which due to the sampling process. In 2006, the nonsubsampled contou rlet transform (NSCT) was proposed, and it is a fully shift-invariant, multiscale, and multidirection expansion
 [10]. The performances of denoising methods in NSCT domain have proven to be very efficient in image denoising.
[11-13] 
In this paper, an improved image denoising method based on a nonlinear thresholding function with adaptive bayes threshold in NSCT domain. In overcoming the shortcomings of the same threshold, the noise deviation of the different sub-band are estimated based on  the coefficients of different directional and level sub-bands in NSCT domain, and the thresholds of every sub-band is estimated by Bayesian threshold estimation method. After choosing the thresholds, a nonlinear thresholding function was chosen to overcome the shortcomings of the soft and the hard thresholding  function. The simulation results show that the proposed method in this paper can remove Gaussian white noise more effectively, and get  a higher PSNR value and keep image texture and detail information more clearly , which also has a better visual effect. Nomenclature 
G the signal standard variance estimation 
V the noise standard variance estimation 
,ijw the coefficient of the original signal 
,mnS  the NSCT sub-band 
,mnT  the threshold of sub-band ,mnS
,ˆijw  the coefficient of the restore signal 
,ijD  the weighing factor of the coefficient (, )wi j
MNu  the size of sub-band 
PSNR   the peak signal-to-noise ratio 514   Mingwei Chui et al.  /  AASRI Procedia   1  ( 2012 )  512 – 518 
2. Nonsubsampled Contourlet Transform In contourlet transform, the Laplacian Pyramid (LP) and the direction filter bank (DFB) are employed for multiscale decomposition and directional decomposition, respectively. To get rid of the frequency aliasing of the contourlet transform and to achieve shift-invariance, the nonsubsampled contourlet transform (NSCT) was proposed based on nonsubsampled pyramid filter bank (NSPFB) and  nonsubsampled direction filter bank (NSDFB). Fig.1 shows the decomposition framework of NSCT . Fig.1 (a) displays an overview of the NSCT. The structure consists in a bank of filters that splits the 2-D frequency plane in the sub-bands illustrated in Fig.1(b). NSCT is a redundant transform which has shift invariance, multi-scale and multi-resolution, it samples on the filter, then analysis and synthesize the filter, the design and reconstruction of this filter is easy to be realized, which could better collect frequency and more regularity. 
              2ZSS,
1Z
SS ,
 (a)                                                                                        (b) Figure 1  Nonsubsampled Contourlet Transform (a) NSFB structure that implements the NSCT; (b) Idealized frequency partitioning obtained with the proposed structure 
3. Proposed Denoising Method The noisy images may contain additive noise and multiplicative noise, and the most common White  Gaussian  noise is chosen  as  the  noise model in this paper. NSCT is linear transformation, so its coefficients are divided into two parts: coefficients of original image and coefficients of noise. The coefficients of original image is large and concentrated, while the coefficients of noise is small and dispersive. Therefore, a proper threshold method can be set to deal with them. The image signal can be recovered after reconstruction with the new NSCT coefficients. The basic principle of the shrinking threshold denoising algorithm in NSCT domain is comparing NSCT sub-band coefficien ts with the thresholds, the coefficient which is less than the threshold is set to zero, while the greater one retained or modified. So threshold denoising algorithm mainly involves two key problems: the estimation of thresholds an d the choice of thresholding function. In this paper, the threshold is estimated by the adaptive Bayesian threshold method, and a nonlinear thresholding function is chosen to deal with NSCT sub-band coefficients. 3.1. Adaptive Bayesian Threshold Estimation The threshold estimation is one core of the shrinking threshold denoising algorithm. There is many threshold selection methods exist, such as VisuShrink, SURE and Bayesian threshold estimation methods. Bayesian threshold estimation is obtained under Baye s standards, set the ideal threshold getting in the condition of Bayes minimal risk is: 515  Mingwei Chui et al.  /  AASRI Procedia   1  ( 2012 )  512 – 518 
arg minBayes Tr                                                                                                                                      (1) Where
Bayesr is the Bayesian risk function. It is very difficult to solve the analytical expressions. So the approximate solution usually is calculated by numerical methods in the simulation. 
2
TVG 
                                                                                                                                                    (2) 
Where 2V is the noise variance estimation, and 2G is the signal variance estimation. The estimate noise variance
2V and the estimated signal variance 2G can be obtained by equation (3), (4):  
2, 2
0.6745ij median w
V§·¨¸ ¨¸©¹
                                                                                                                           (3) 
22 2,111max, 0MNijijwMN GV
  §· ¨¸©¹¦¦
                                                                                                          (4) 
Where ,ijw is the lowest frequency coefficient after the transformation, MNuis the size of sub-band. In Bayesian threshold estimation, the noise variance 
2V is estimated as a same value in each directional and each level sub-bands. However, NSCT is not an orthog onal transform, the noise variance of sub-bands in each directional and each level are different in the NSCT domain. So, the noise variance of every sub-band is estimated independently. In this paper the noise va riances are estimated based on the sub-band coefficients of each directional and each level. For the NSCT sub-band 
,mnS(m is the level and n is the direction), its noise variance 2,mnV  is obtained by equation (3), and  
,ijw is the coefficients of sub-band,mnS.
2, 2,
0.6745ij mnmedian w
V§·¨¸ ¨¸©¹
                                                                                                                           (5) 
Then, the threshold ,mnT of sub-band ,mnS is estimated by equation (2). 
3.2. New Thresholding Function 
The most common thresholding functions are the hard thresholding function and the soft-thresholding function. The hard threshold denoising is as follow: 
,,,,,ˆ0,ij ijijijww TwwT­t° ®°¯
                                                                                                                              ( 6) 
The soft threshold denoising method is as follow: 
,, ,, ,() ( ) ,ˆ0,ij ij ij ij ijsign w w T w TwwT­t° ®°¯
                                                                                                    (7) 516   Mingwei Chui et al.  /  AASRI Procedia   1  ( 2012 )  512 – 518 
Where T is the threshold, ,ijwis the coefficient of the original signal, ,ˆijw is the coefficient of the restore signal. The soft and hard threshold denoising methods are to compares the threshold with the decomposition coefficient of the original signal. In these methods, the nonimportant coefficients are set to zero. In hard thresholding, the important coefficients remain unchanged. In soft thresholding, the important coefficients are reduced by the absolute threshold value. However, there is deviation between the coefficients and the original ones. So, a nonlinear thresholding function is applied in the NSCT domain for denoising in this paper. The thresholding function is as follows: 
,, ,,( (, ) ) ( (, ) ) (, )ˆ(, )0,( , ) i j mn mnmnsi g nwi j wi j T wi j Twi jwi j T D ­ t° ®t°¯
                                                                     (8) 
Where, ,mnTis the threshold of sub-band ,mnS,(, )wi j and ˆ(, )wi j  is the original and denoised coefficients of sub-band 
,mnS, the weighing factor ,ijDin the coefficient (, )wi j  is defined as: 
, , ,
(, ) e x p ( (, ) )mn ij mnTwi j wi j TD 
                                                                                                            (9)  3.3. Process of Proposed Denoising Method  
The specific procedure of proposed denoising method based on adaptive Bayes threshold and nonlinear thresholding function in NSCT domain is as follows: xPerforms multiscale decomposition of the noisy imag e in NSCT domain, obtain the sub-bands coefficients of the noisy image in different directional and levels; xCalculates the noise variance 
2,mnV  and threshold ,mnTin different sub-bands based on the coefficients in different directional and level sub-bands by equation (2)-(5);  xEstimates the denoised coefficients of high-frenquency sub-bands based on the threshold 
,mnTand  sub- bands coefficients by equation (8) and (9); xAfter denoising procedure, does the nonsubsampled contourlet inverse transform and rebuild the image after the process of sub-band coefficients, gets the restore image.  4. Experiments To evaluate the performance of the proposed approach, this section compares the proposed scheme with other popular denoising schemes in Wavelet, Contou rlet and NSCT domain based hard-thresholding. The three benchmark images named Lena, Barbara and Boat (8-bit grayscale, size 
512 512u ) are used for the experiments. The noisy images are obtained by  adding Gaussian white noise (noise standard deviations ranging from 10 to 40) to the noise free image. We adop t the peak signal-to-noise ratio (PSNR) to test the denoising effect.  The PSNR results of various are shown in the Table.1. The denoised results of the standard image Lena with noise standard deviation 
40V  are shown in the Fig.4. The peak signal-to-noise ratio is defined as: 
max max10 2,,11 10 log( )1ˆMNij ijijIIPSNRdBIIMN
  u 
¦¦
                                                                                   (10) 517  Mingwei Chui et al.  /  AASRI Procedia   1  ( 2012 )  512 – 518 
Where maxI is the maximum gray level value of the image,  ,ijI is the gray value of pixel at (, )ijof the noise free image 
I,,ˆ
ijI is the gray value of pixel at (, )ijof the denoised image ˆI, and MandN are the numbers of row and column of the test image, respectively. 
Table.1 PSNR (dB) of different denoised images with different algorithm Image 
V 10 15 20 25 30 35 40 
Lena Noisy 28.14 24.62 22.09 20.16 18.60 17.22 16.09 Wavelet 30.92 28.28 26.20 24.56 23.08 21.82 20.78 
Contourlet 30.00 28.62 27.70 26.95 26.40 25.97 25.56 
NSCT 31.24 27.73 25.08 23.04 21.38 19.95 18.78 
Proposed 34.54 32.77 31.64 30.81 30.14 29.47 28.80 
BarbaraNoisy 28.13 24.62 22.09 20.16 18.60 17.22 16.09 Wavelet 28.79 26.23 24.31 22.86 21.65 20.60 19.69 
Contourlet 26.73 25.25 24.25 23.53 23.06 22.70 22.38 
NSCT 31.48 28.41 25.76 23.59 21.80 20.32 19.01 
Proposed 31.05 28.95 27.74 27.03 26.30 25.63 25.04 
BoatNoisy 28.13 24.60 22.10 20.17 18.60 17.27 16.09 Wavelet 29.71 27.28 25.48 23.91 22.54 21.41 20.44 
Contourlet 27.14 26.11 25.38 24.77 24.33 23.96 23.61 
NSCT 30.39 27.48 25.02 23.04 21.44 20.02 18.83 
Proposed 32.61 30.92 29.72 28.68 27.81 27.15 26.63 
Table.1 shows the PSNR results of the four met hods on the experimented images corrupted by different noise variance of additive Gaussian noise. The results show the proposed method gives highest PSNR for all the experimented images. In addition, it consistently provides better results than other denoising methods for different images and noise levels. 
(a)                               (b)                                  (c)                                (d)                                 (e)                               (f)                 
Fig. 2. (a) Original image; (b) Noisy image (16.09 dB); (c) Denoised with Wavelet (20.78dB); (d) Denoised with Contourlet (25.5 6 dB); (e) Denoised with NSCT(18.78 dB);  (f) De noised with the proposed method (28.80 dB) 
Fig. 2 shows the denoising performance of the above mentioned methods using the standard image Lena. Fig. 2(a) and (b) show the noise free and the noisy images, respectively. The denoised images obtained using different denoising methods and the proposed method in the DWT domain are illustrated in Fig. 2(c)–(f), respectively, and have PSNR values of 20.78, 25.56, 18.78 and 28.80 dB, respectively. From the figures in Fig. 2, it can be observed that the proposed denoising appr oach is better than the other denoising methods. 518   Mingwei Chui et al.  /  AASRI Procedia   1  ( 2012 )  512 – 518 
5. Conclusions In this paper, an improved image denoising met hod based on a nonlinear thresholding function with adaptive bayes threshold in NSCT domain. In overcoming the shortcomings of the same threshold, the noise deviation of the different sub-band are estimated based on the coefficients of different directional and level sub-bands in NSCT domain, and the thresholds of eve ry sub-band is estimated by Bayesian threshold estimation method. After choosing the thresholds, a n onlinear thresholding function was chosen to overcome the shortcomings of the soft and the hard thresholding function. The simulation results show that the proposed method in this paper can remove Gaussian white noise more effectively, and get  a higher PSNR value and keep image texture and detail information more clearly , which also has a better visual effect. Acknowledgements The research work for this paper is sponsored by  the National Natural Science Foundation of China (N0:51075395). References [1] Priyam Chatterjee, and Peyman Milanfar, Is Denoising Dead?, IEEE Transactions on Image Processing, 2010;19(4):895-911. [2] F. Xiao and Y. G. Zhang, A Comparative Study on Thresholding Methods in Wavelet-based Image Denoising, Procedia Engineering,  2011;15:3998-4003. [3] Mehdi Nasri, Hossein Nezamabadi-pour, Image denoisi ng in the wavelet domain using a new adaptive thresholding function, Neurocomputing, 2009;72:1012–1025. [4] R. G. Yang and M. W. Ren, Wavelet denoising using principal component analysis, Expert Systems with Applications, 2011;38:1073–1076. [5] S. F. Yin, L. G. Cao, Y.S. Ling and G. F. Jin, Im age denoising with anisotropic bivariate shrinkage, Signal Processing, 2011;91:2078–2090. [6] G.Y. Chen, T.D. Bui and A. Krzyzak, Image denoising with neighbor dependency and customized wavelet and threshold, Pattern Recognition, 2005;38:115–124. [7] M. N. Do and Martin Vetterli, The Contourlet Tran sform: An Efficient Directional Multiresolution Image Representation, IEEE Transactions on Image Processing, 2002;1-16. [8] Xin Zhang, Xili Jing, Image denoising in contourlet domain based on a normal inverse Gaussian prior, Digital Signal Processing, 2010; 20:1439–1446. [9] M. Lydia, M. Karuna, T. Durga Prasad,  ImageDen oising UsingContour let Transform with Application to Synthetic Aperture Radar, Engineering Research  and Applications, 2011;1(4):2030-2034. [10] Arthur L. da Cunha, J. P. Zhou and M. N. Do , The Nonsubsampled Contourlet Transform: Theory, Design, and Applications, IEEE Transactions on  Image Processing, 2006;15(10):3089-3011. [11] H. B. Ouyang, H. M. Quan, Y. Tang, Y. Z. Zeng, Image Denoising Algorithm using Adaptive Bayes Threshold Subband Based on NSCT, Electronic Design Engineering, 2011;19(23):185-188. [12] L. L. Huang, H. Z Wang, B. Zhu, Adaptive Thresholds Algorithm of Image Denoising Based on Nonsubsampled Contourlet Transform, 2008 International Conference on Computer Science and Software Engineering, 2008;209-212. [13] J. H. Liu, Z. H. Jia, X. Z. Qin, NSCT Remote Sensing Image Denoising Based on Threshold of Free Distributed FDR, Procedia Engineering, 2011;24:616-620. 