A computer vision system for defect discrimination and grading intomatoes using machine learning and image processing
David Ireria,E i s aB e l a la,b,C e d r i cO k i n d aa, Nelson Makangea, Changying Jia,⁎
aCollege of Engineering, Laboratory of Modern Facility Agriculture Technology and Equipment Engineering of Jiangsu Province, Nanjing Agricultura l University, Jiangsu 210031, PR China
bFaculty of Agriculture, Department of Agricultural Engineering, University of Zalingei, Central Darfur State, R., Sudan
abstract article info
Article history:Received 21 April 2019Received in revised form 6 June 2019Accepted 6 June 2019Available online 17 June 2019With large-scale production and the need for high-quality tomatoes to meet consumer and market standardscriteria, have led to the need for an inline, accurate, reliable grading system during the post-harvest process.This study introduced a tomato grading machine vision system based on RGB images. The proposed system per-formed calyx and stalk scar detection at an average accuracy of 0.9515 for both defected and healthy tomatoes byhistogram thresholding based on the mean g-r value of these regions of interest. Defected regions were detectedby an RBF-SVM classiﬁer using the LAB color-space pixel values. The model achieved an overall accuracy of 0.989upon validation. Four grading categories recognition models were developed based on color and texture features.The RBF-SVM outperformed all the explored models with the highest accuracy of 0.9709 for healthy and defectedcategory. However, the grading accuracy decreased as the number of grading categories increased. A combinationof color and texture features achieved the highest accuracy in all the grading categories in image features evalu-ation. This proposed system can be used as an inline tomato sorting tool to ensure that quality standards are ad-hered to and maintained.© 2019 The Authors. Production and hosting by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is anopen access article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/4.0/ ).
Keywords:GradingCalyxDefectedRecognition modelsMachine vision
1. IntroductionTomato a nutritious and nourishment fruit is one of the top-grownagricultural produce in the world. According to ( FAOSTAT, 2017), the global production of tomatoes was 170.8 million tons with China asthe leading producer accounting for over 31% of the total production.With large-scale production, the post-harvest procedure is crucialsince tomato is a delicate and a perishable fruit. Additionally, qualityand food safety are decisive factors in tomato supply chain managementto meet trade speciﬁcations and buyer's requirements (Esguerra et al., 2018). According toEU (2011)on the regulations for processed fruitsand vegetables, the minimal requirements is that tomatoes must appearfresh, intact, free from deterioration, free of cracks, free from damageand must arrive at the destination in a satisfactory condition. Thus, iden-tifying these traits assists in conforming to the accepted marketstandards.Several chemical and physical parameters affect fruit quality andhave been used to sort and grade tomatoes during post-harvestingsuch as size (large and small), shape (circular or oblong), defects andmaturity or color (Arjenaki et al., 2013). These parameters have helped in identifying tomatoes with mechanical damage, disease, and insectdamage, cracks, and pre-harvest deformation defects to achieve therequired market standards (FAO, 2008). Furthermore, sorting governs effectiveness and efﬁciency on how the product will be marketedthrough the packing lines and quality standard. Thus, it is essential tohave a sorting method which is robust, consistent, fast, effective, andnon-destructive (Jarimopas and Jaisin, 2008). The common sorting and grading technique is manual sorting. How-ever, this technique suffers from several disadvantages, such as low pre-cision, labor-intensive, and subjectivity ( Karlsson, 2016).Gould (1975) introduced the mechanical tomato sorting machine as a solution tothe shortcomings of manual sorting. However, this grading systemwas limited to only size and weight classi ﬁcation. Presently, with the emergence and developments in machine vision technology, it has be-come possible to overcome these limitations accurately and non-destructively based on machine vision detection systems ( Chen et al., 2002).Computer vision-based systems have already been applied in vastareas of food and agricultural-based industry in the sorting of apple(Moallem et al., 2017;Unay et al., 2011), strawberry (Liming and Yanchao, 2010), tomato (Arakeri, 2016;Clement et al., 2012), potatoes (Moallem et al., 2013), dates (Al Ohali, 2011;Lee et al., 2008), citrus (Blasco et al., 2007;López-García et al., 2010), mangos (Naik and Patel, 2014;Naik et al., 2015;Nandi et al., 2014), cucumbers (Clement et al., 2013) etc. Tomato sorting based on machine vision was reportedas early as 1985 bySarkar and Wolfe (1985),t h i ss t u d yg r a d e dt h et o - matoes depending on size, color shape, and defected. However, thisArtiﬁcial Intelligence in Agriculture 2 (2019) 28 –37
⁎Corresponding author.E-mail address:chyji@njau.edu.cn(C. Ji).
https://doi.org/10.1016/j.aiia.2019.06.0012589-7217/© 2019 The Authors. Production and hosting by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is an open access article under t he CC BY-NC-ND license (http:// creativecommons.org/licenses/by-nc-nd/4.0/ ).
Contents lists available atScienceDirect
Artiﬁcial Intelligence in Agriculture
journal homepage:http://www.keaipublishing.com/en/journals/artificial-intelligence-in-agriculture/system required the fruits to lie on their stem or blossom ends orienta-tion during imaging for feature extraction. Clement et al. (2012)intro- duced a tomato classiﬁer based on color, size, and weight. However, asearlier mentioned, fruit quality is also affected by defects. Defects detec-tion based on color features was reported by Dhanabal and Samanta (2013)in the detection of Blossom End Rot (BER) and Rokunuzzaman and Jayasuriya (2013)in the detection of BER and cracks. Color featuresare considered asﬁrst-order spatial statistics that depend on individualpixel values. However, a defect has no spatial direction. Thus, relative re-gions of the defects should be taken into account ( Arakeri, 2016; Moallem et al., 2017). To improve on tomato defect detection, Arakeri (2016)proposed the use of high-quality images and image texture fea-tures. However, the use of high-resolution images such ashyperspectral, and multispectral (Moltó et al., 2010;Polder and van der Heijden, 2010) imaging system have been reported to consumemuch computational time and high costs involved ( Arakeri, 2016). This study introduces a low-cost tomato grading system based oncolor images processing and machine learning technology. The pro-posed system extracted both LAB color features and gray level texturefeatures and used them as feature variables to develop correlations totomato redness color intensity and defect. LAB color space is often lessaffected by the variations of the camera sensor compared to RGB(Shaﬁee et al., 2014). Texture features are also referred to as second-order features (Moallem et al., 2017) because they capture the spatialdependence of gray values that contribute to the perception of textureby representing the properties of pixels in pairs. The main objective ofthis study was to develop a computer vision system that can be usedto grade tomatoes. The speciﬁc objectives of this study were to developan efﬁcient image processing algorithm, to develop an ef ﬁcient and ac- curate calyx detection algorithm and to develop different classi ﬁers tograde tomatoes into different grading categories. This proposed systemcan be applied in real-time tomato post-harvesting procedures becauseits fast, cheap, accurate, and non-detective, thus improved reduced in-spection time and quality sorting guarantee in tomato production andsupply chain management.2. Materials and methods2.1. Experiment setup and data collectionExperiments were conducted between November 2018 and January2019 at Nanjing Agricultural University, College of Engineering, Nanjing,Jiangsu Province, China. A total of 200 tomatoes with different degree ofdefects and red color intensity were manually selected at a local farm inJiangpu, Nanjing, Jiangsu China. Cherry tomatoes and Heirloom toma-toes were used. The overview of the proposed system is given in Fig. 1. The image acquisition system was composed of Hikvision Mini Cam-era (DS-2CD2D14WD/M4MM), mounted 1.0 m perpendicularly abovean imaging stage, as shown inFig. 2. The camera was connected via anEthernet to an intel core i5-4500U CPU, 4 GHz, 16 GB physical memory(Intel, Santa Clara, CA, USA), Microsoft Windows 10 PC. Images of toma-toes (1280 × 720) at different orientations were acquired at 10 fps. Foreach tomato, ten images were selected for subsequent analysis.2.2. Image processing and feature extraction algorithmsThese algorithms aimed at developing a tomato grading systembased on defects and color intensity, as shown in Fig. 1. Firstly, segmen- tation algorithms were applied to the captured image to remove thebackground. Secondly, performed calyx and stalk scar detection and
Fig. 1.The algorithmicﬂow of the proposed system.29 D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28 –37defect segmentation. Thirdly extracted the color, texture, and shape fea-tures from all the images. Fourthly, developed classi ﬁers based on sup- port vector machines (SVM), artiﬁcial neural network (ANN), andrandom forest for comparative analysis of proposed tomato gradingtechnique.2.3. Image processing2.3.1. Background removalIn this study, the image acquisition system was stationary. Thus, asimple image subtraction technique was used for background removal.Due to RGB images being sensitive to the ambient light conditions, thebackground was incompletely removed in some images. However, inthe set-up condition, the background pixels had lower values than theforeground pixels. Hence, the background was entirely removed by ahistogram thresholding technique, as shown in Fig. 3. The thresholdwas calculated by Eq.(1)(Moallem and Razmjooy, 2012)δ¼
12μ
mxrþμm ðÞ ð 1Þwhere,δis the heuristic threshold value,μ
mxris the gray level with the most repetitions in the image, andμ
mis the median of the gray level dis-tribution of the image.2.3.2. Calyx and stalk scar detectionThe calyx and stalk scar (CS) are often very similar to a defect interms of appearance, as shown inFig. 4(a) and (d). Thus, it is necessary to segment them before classifying a tomato. In this study, the CS wasdetected based on the gray values of a tomato image along with the lon-gitudinal directions of the tomato image. Fifty images with clear CSwere selected for the development of the CS detection algorithm.Based on these experiments, it was established that the g-r values of
Fig. 2.Experiment setup and Image acquisition system.
Fig. 3.Image background removal, (a) original color image, (b) original image without the background.30 D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28 –37the CS were greater than that of the fruit. Thus, they were segmented bya histogram threshold (Eq.(1)) based on the average value of the g-rvalue of the CS regions of the selected images.2.3.3. Defect detectionTomato is a very succulent fruit whose quality is not affected by onlyBER and cracks but with also mechanical damages during transportationand handling. This study exploits the advantages of LAB color space toperform tomato defect detection. 500 images of tomatoes with differentdegree of defect were randomly selected and were converted from RGBto LAB. The intensity values of L, A, and B space were then extractedfrom each pixel points for each image and were labeled as either defector healthy pixels. Let the extracted color space features be denoted byLMwhich was a huge matrix ofI
sby4, for the 500 images, 3 color spacesand the pixel label as 1 for healthy and−1 for defected, whereI
sis the total number of pixels in all the images (1280∗720∗500).LMwas split into training and validation datasets of 0.7 and 0.3 of the total observa-tions respectively. Each observation of the training dataset can be pre-sented by (LMt
r,Xtr). Where,LMt⊂LM,Xt ris the label corresponding toLMt
r,a n dr∈[1,(0.7∗I s)] The training dataset was used to train a ra-dial basis function (RBF-SVM) classiﬁer. The modeled classiﬁer was then validated by the 0.3∗I
sobservations denoted by (LMs e,Xse). Where,e∈ [1,(0.3∗I
s)],LMs⊂LM,Xs eis the label corresponding toLMs e.T h ev a l i - dation results obtained was denoted by p
efor eachLMs e. The value of eacheinXs
ewas compared top e, the performance of the defect detec-tion model was evaluated according to Eq. (2).
num Xs e¼¼pe ðÞnum Xs
eðÞk∈1;0:3/C3Is ðÞ½/C138 ð 2Þwherenum(Xs
e==p e) is the number ofp ethat equalsXs e.2.4. Feature extraction2.4.1. Color featuresColor features are also referred to as statistical features (1st orderspatial statistics measure). In this study, LAB color space was used dueto its ability of limited variance due to sensor sensitivity ( Shaﬁee et al., 2014). LAB color space is a 3-axis color system with absolute and pre-deﬁned range for the L, A, and B dimensions. Where L represents thebrightness (the darkest black at L = 0, and the brightest white at L =100), A and B represent the color channels. A represents red andgreen opponent colors along the A axis at positive and negative values,respectively. B represents yellow and blue opponent colors along the Baxis at positive and negative values, respectively. However, at A = 0and B = 0 represents true neutral gray values ( Margulis, 2005). In LAB color space, all colors in the spectrum are considered, as well as colorsoutside the human perception (Hashim et al., 2012;Hu et al., 2016). From each space, three color features were extracted (mean, standarddeviation, and range). Thus, a total of nine color features were extractedin each image. These color features depend only on the individual pixelvalues but do not account for the relative relations of the gray values(Moallem et al., 2017).Fig. 5shows the conversion of the original RGBimage into LAB color space.2.4.2. Texture featuresTexture features are also referred to as a 2nd order measure. Thesefeatures present the gray values of pixels in pairs. Thus, they capturethe spatial dependence of gray values. In this study, Haralick texturalfeatures were computed from Gray-Level Cooccurrence Matrices(GLCM) (Haralick and Shanmugam, 1973;Moallem et al., 2013). A 2D GLCM matrix presented each image, and the textual features are the av-erage of this matrix using neighborhood of distance d= 1 towards the directions 00,4 50,9 00, and 1350this is because defects have no speciﬁc direction. The extracted features were the contrast, correlation, energy,homogeneity and entropy.2.4.3. Shape featuresShape regularity is often used as a quality measure in marketing. To-matoes with regular shapes are often considered as of better quality.The tomato shape asymmetrical value was computed as a measure ofshape regularity. A binary image of the tomato was obtained by imagebinarization (Otsu, 1979). Then the edges were extracted by the Sobeloperator. The regularity measure (ξ) was then extracted according toEq.(3).W h e r e ,d
r(t)a n dd l(t) are the horizontal distances betweenthe boundary point and the longitudinal line through the image
Fig. 4.Calyx and stalk scar detection and segmentation, (a) original RGB image (b) Detected calyx and stalk scar, and (c) Calyx and stalk scar segmentation.31 D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28 –37centroid on the right-hand side and left-hand side respectively.ξ¼
Pt1drtðÞ−d ltðÞjjP
t1drtðÞþd ltðÞjj ! ð3Þ2.5. Recognition modelsThe captured tomato images were manually labeled by a human ex-pert into four groups depending on defect, healthy, and ripeness (redcolor intensity): healthy and defected (cat 1). Secondly, 1st grade, 2ndgrade, and rejected (cat 2). Thirdly, healthy deep red, healthy lightred, and defected (cat 3). Lastly, 1st grade deep red, 1st grade lightred, 2nd grade deep red, 2nd grade light red and rejected (cat 4) asshown inTable 1. A classiﬁcation model was then developed, and theobtained results were compared to those of human expert. A total ofﬁfteen features were extracted from each image. Based on the qualitygrading, a total of four models were developed for each recognitionmodel explored. The recognition models were linear-SVM, quadratic-SVM, cubic-SVM, and radial basis function (RBF-SVM), ANN, decisiontree, and random forest. These models were trained by a 10-foldcross-validation-based parameter search on the training dataset afterwhich they were further evaluated on a testing dataset. A comparisonto the manual labeling of the testing dataset was presented in terms ofrecognition accuracy.2.5.1. The SVM recognition modelsSVM is a widely used regression technique and a statistical classi ﬁer based on a supervised learning algorithm ( Kim and Choi, 2014). Gener- ally, supervised learning algorithms vectors are input nonlinearly into ahigh-dimensional feature space. The SVM algorithm determines themaximum margin in the high-dimensional feature space by applyingthe principle of construction risk minimization to classify the tomatoesinto required categories. This study explored the linear, quadratic, cubic,and radial basis kernel functions. The choice of kernel function affectsthe overall performance of an SVM classiﬁer in terms of efﬁciency and accuracy. Eqs.(4) to (6)presents the basic kernel functions, i.e., linear,polynomial and radial basis kernel functions. For more review onSVM, please refer to the study by (Chang and Lin, 2011).Kx
i;xj/C0/C1¼xTixj ð4ÞKx
i;xj/C0/C1¼γxTixjþ1/C0/C1d;γN0 ð5ÞKx
i;xj/C0/C1¼e−γx i−x j kk2
;γN0 ð6Þ
Fig. 5.Conversion of the color image to LAB color space, (a) RGB image, (b) L-space of LAB, (c) A-space of LAB, and (d) B-space of LAB.
Table 1The dataset for all the grading categories explored.Grading categories Healthy Defectedcat 1 1200 800cat 2 1st grade 950 6002nd grade 450cat 3 Deep red 800 800Light red 400cat 4 1st grade Deep red 600 600 Light red 3502nd grade Deep red 250Light red 20032 D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28 –372.5.2. The ANN recognition modelsThe ANN applied in this study was a one-hidden-layer feed-forwardnetwork trained by back propagation. The general equation of the ANNmodel is given in Eq.(7). Where,qis the output,p
iis the extracted fea- tures (in this study =1, 2…15),w
iis the mass of theithinput,bis the bias, andfis the transfer function.q¼fX
15i¼1wipiþb ! ð7ÞThe developed ANN models had three layers; input layer, hiddenlayer, and the output layer. The input layer had ﬁfteen inputs corre- sponding to the extracted features. The number of neurons in the hid-den layer was set to 10 after an exhaustive search with an increasingnumber of neurons to establish a minimum percent error during thevalidation phase. A hyperbolic tangent sigmoid transfer function wasused in the hidden layer, while a linear transfer function was used inthe output layer.The image acquisition system captured a total of 2000 images. Aspresented inTable 1. Above, in each grading category, 70% of the datasetwas used as a model training dataset while the remaining was used asthe testing dataset. The performance of each model for each grading cat-egory was then presented in terms of accuracy in comparison to manuallabeling.3. Results and discussion3.1. Calyx and stalk scar detection analysisThe CS extraction algorithm was applied to 500 images with calyxand stalk scar. The test achieved an average accuracy of 0.9515 andRMSE of 33.5 tomato images on the dataset, as shown in Table 2.H o w - ever, on separate datasets of healthy and defected, the defectedachieved a lower accuracy as shown in Table 2, this was mainly due to defect and CS having almost similar color intensities at different andvarying ambient light levels.Different calyx detection techniques already exist from several stud-ies on fruit and vegetables sorting such as the used of K-means cluster-ing on Cb component in YCbCr color space by Moallem et al. (2017)in apple grading. Image object segmentation and thresholding by Arakeri (2016)in tomato sorting and grading. However, to improve on thecalyx detection accuracy and reduce the computational time for realtime online system this study applied the methodology presented byLiming and Yanchao (2010)in the strawberry grading system by estab-lishing the average g-r thresholding value and applied it to all theimages.3.2. Defect detection analysisDefect detection was performed after extraction of CS to prevent amismatch between CS and a defect. This study selected the RBF kernelbecause of its ability to always adapts well by varying its scaling factorin a large range of problems (Han et al., 2012). The results show that the developed defect model could identify defected pixels with an accu-racy of 0.989 on the validation dataset. Fig. 6shows the identiﬁcation of defected pixel regions using the introduced methodology.As already mentioned, defects can often result from several factorssuch as mechanical bruising, black BER, freezing injury, sunscald, anddecay. Several studies have already been presented in the detection ofthese defects.Dhanabal and Samanta (2013)presented a color imageTable 2Calyx extraction algorithm performance on a testing dataset.Dataset Accuracy RMSEHealthy 0.9767 8Defected 0.9263 59Average 0.9515 33.5
Fig. 6.Defect detection process on a tomato (a) and (c), original tomato image with defects (b) and (d) detected defect and healthy regions on the tomatoes (gr een is indicating healthy pixel while red indicating defected pixels).33 D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28 –37threshold method to discriminate unripe, ripe and spoiled tomatoes. Lee et al. (2008)developed near-infrared imaging system in the grading ofdate fruits at an overall accuracy of 95.0%, despite the high accuracy ofhigh-quality images like the hyperspectral, multispectral and near-infrared imaging the costs involved are always much higher in thesetup of such systems. Never the less this introduced system despiteimage quality is sensitive to ambient light conditions still achieved ahigh accuracy due to controlled lighting.3.3. Grading categories analysisThis study introduces an automated technique for tomato sorting. Amachine vision system was designed to extract tomato image featuresbased on color, texture, and shape parameters. A detailed image pro-cessing technique for real time inline tomato evaluation was intro-duced.Fig. 7presents the image analysis of different gradings oftomatoes used in this proposed grading system together with their cor-responding histograms. It was established that a healthy tomato ( Fig. 8) had signiﬁcantly higher pixel values than defected tomatoes.Based on the developed recognition models, Table 3presents the recognition accuracy for all the explored models. It can be observedthat the RBF-SVM outperformed all the models based on the accuracyin recognition results on the testing dataset. In marketing, tomatoesare sorted based on different categories.This study presents four grading categories, and the performance ofeach classiﬁcation is evaluated. It was also observed that as the
Fig. 7.Different tomato quality with their respective LAB color space and histogram (a) healthy light red (b) healthy with calyx (c) rejected (d) healthy dee p red (e) second grade deep red (f) rejected.34 D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28 –37recognition accuracy decreases with the increase in the grading catego-ries as presented inTable 3. However, the overall accuracy results of theproposed system are sufﬁciently acceptable in practical applications.3.4. Two grades category (cat 1) gradingIt is observed that the RBF-SVM outperforms all the other models atan accuracy of 0.9709. A confusion matrix in Table 4shows the statistical measures of the performance of the RBF-SVM cat 1 model using thecriteria accuracy = (TP + TN)/ (TP + TN + FP + FN), speci ﬁcity = TN/(TN + FP), precision = TP/(TP + FP) and sensitivity = TP/(TP+ FN); where TP is True Positive, TN is True Negative, FP is False Positiveand FN is False Negative. The result of the classi ﬁcation achieved a spec- iﬁcity of 0.9613, precision of 0.9742, and sensitivity of 0.9775 on thetesting dataset.3.5. Three grades category (cat 2) gradingThe three quality categories include the 1st grade, 2nd grade and re-jects based on the degree of defects, 1st grade was defects free, 2ndgrade had a lower degree of defects while reject had a higher degreeof the defect according to the observation by a tomato grading profes-sional. FromTable 3, it can be observed that RBF-SVM againoutperformed all the explored models to have the highest recognitionaccuracy of 0.9542. The statistical performance of the RBF-SVM modelin grading in cat 2 is given inTable 5.3.6. Three grades category (cat 3) gradingThis grading category was similar to cat 1 grading but with the addi-tion of color grading of the healthy tomatoes. Color is an essential factorin grading in terms of ripeness (market readiness) in supply chain man-agement (Jahns et al., 2001). The RBF-SVM achieved the highest accu-racy at 0.9691. The analytical performance of the RBF-SVM model ingrading in cat 3 is given inTable 6.3.7. Five grades category (cat 4) gradingThis grading category was similar to cat 2 with a further color featureto sort the 1st grade and 2nd grades into deep red and light red grades. Itcan be observed fromTable 3andTable 7that RBF-SVM have the highest accuracy of 0.9385. The statistical performance of the RBF-SVM model in grading in cat 3 is given in Table 7.3.8. Extracted features analysisThis study presented an analysis of all the extracted feature variablesto determine the performance of each feature variable as predictors in
Fig. 8.Pixel intensity differences distinguishing the background, defected, transition and heathy tomato regions.
Table 3Performance of all the explored models for each category of tomato grading.GradingcategoriesSVM models ANN Random forest Linear Quadratic Cubic RBFcat 1 0.9467 0.9624 0.8961 0.9709 0.9583 0.9412cat 2 0.9301 0.9267 0.9278 0.9542 0.9421 0.9395cat 3 0.9126 0.9035 0.9126 0.9691 0.9486 0.9255cat 4 0.9278 0.9108 0.8835 0.9385 0.9299 0.9107Table 4Confusion matrix for recognition in cat 1 grading.Grading system labeling Manual labeling TotalHealthy DefectedHealthy 1173 31 1204Defected 27 769 796
Table 5Confusion matrix for recognition in cat 2 grading.Grading system labeling Manual labeling Total1st grade 2nd grade Rejects1st grade 918 19 6 9462nd grade 25 424 28 465rejects 7 5 566 58935 D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28 –37each grading category. RBF-SVM models were developed based on eachfeature variables and a combination of all the variables and were testedon the validation dataset. The results were then presented in terms ofmodel accuracy. The extracted features were nine color features, ﬁve texture features, and one shape feature as presented in the Materials and methods section. It was established that all feature variables combi-nation improved the overall performance of the recognition model, asshown inFig. 8. It can also be observed that shape feature was thepoorest predictor followed by color feature then texture feature. Simi-larly, it was observed that the accuracy of the different models de-creased as the number of grading categories increased, as shown inFig. 9.4. ConclusionThis study proposes a tomato defect detection system on imagecolor, texture, and shape features. A relation of the tomato image LABcolor space to defect was developed. The results obtained suggest thatthe proposed machine vision system can be used to detect defects inCherry and Heirloom tomatoes. However, this system needs to be vali-dated on other varieties of tomatoes, despite these shortcomings, theproposed technique with acceptable results achieved the objectives ofthis research study. It is of great importance to detect defects in toma-toes during post-harvest processing for quality inspection, marketing,and packaging. Thus, this proposed system can be applied as an inlinegrading and sorting system in tomato post harvesting. This introducedsystem can also be integrated with other grading criteria such as weight,volume, and shape estimation systems in post-harvest management oftomatoes.AcknowledgementsWe thank the editor and the reviewers for assisting in improving themanuscript and acknowledge Fundamental Research Funds for the Cen-tral Universities, China (KYGX201701) for funding the research.References
Al Ohali, Y., 2011.Computer vision based date fruit grading system: design and imple-mentation. J. King Saud Univ.–Comput. Inf. Sci. 23 (1), 29–36. Arakeri, M.P., 2016.Computer vision based fruit grading system for quality evaluation oftomato in agriculture industry. Procedia Comput. Sci. 79, 426 –433. Arjenaki, O.O., Moghaddam, P.A., Motlagh, A.M., 2013. Online tomato sorting based on shape, maturity, size, and surface defects using machine vision. Turk. J. Agric. For.37 (1), 62–68.Blasco, J., Aleixos, N., Molto, E., 2007. Computer vision detection of peel defects in citrus by means of a region oriented segmentation algorithm. J. Food Eng. 81 (3), 535 –543. Chang, C.-C., Lin, C.-J., 2011.LIBSVM: a library for support vector machines. ACM Trans.Intell. Syst. Technol. (TIST) 2 (3), 27.Chen, Y.-R., Chao, K., Kim, M.S., 2002. Machine vision technology for agricultural applica- tions. Comput. Electron. Agric. 36 (2 –3), 173–191. Clement, Novas, Gázquez, J.A., Manzano-Agugliaro, F., 2012. High speed intelligent classi- ﬁer of tomatoes by colour, size and weight. Span. J. Agric. Res. 10 (2), 314 –325. Clement, Novas, José-Antonio, G., Francisco, M.-A., 2013. An active contour computer al-gorithm for the classiﬁcation of cucumbers. Comput. Electron. Agric. 92, 75 –81. https://doi.org/10.1016/j.compag.2013.01.006 . Dhanabal, T., Samanta, D., 2013. Computerized spoiled tomato detection. Int. J. Res. Eng.Technol. 2, 38–41.Esguerra, E., Rolle, R., & S, R. (2018). Post-harvest Management of Tomato for Quality andSafety Assurance (TCP/RAS/3502), 1 –20. Retrieved fromhttp://www.fao.org/3/ I8236EN/i8236en.pdfEU, 2011. Fruit and Vegetables: Marketing Standards. Retrieved from. https://ec.europa. eu/agriculture/fruit-and-vegetables/marketing-standards_en . FAO. (2008). Standard for Tomatoes 293, 1 –5. Retrieved fromhttp://www.fao.org/fao- who-codexalimentarius/shproxy/it/?lnk=1&url=https%253A%252F%252Fworkspace.fao.org%252Fsites%252Fcodex%252FStandards%252FCODEX%2BSTAN%2B293-2008%252FCXS_293e.pdfFAOSTAT, 2017. Tomatoes, Production Quantity (Tons) - for All Countries. Retrieved from.http://www.factﬁsh.com/statistic/tomatoes%2C%20production%20quantity . Gould, W.A., 1975.Mass Sorting of Mechanically Harvested Tomatoes.Han, S., Qubo, C., Meng, H., 2012. Parameter Selection in SVM With RBF Kernel Function.Paper Presented at the World Automation Congress. p. 2012.Haralick, R.M., Shanmugam, K., 1973. Textural features for image classiﬁcation. IEEE Trans. Syst. (6), 610–621 man, and cybernetics.
RBF-SVM model Performance based on the training feature variables
Grading categoriesRecognitionAccuracyRecognition Accuracy
c a t1 c a t2 c a t3 c a t40.00.20.40.60.81.0
0.00.20.40.60.81.0color features
texture features
shape features
combined features
Fig. 9.A comparison of the effectiveness of the extracted feature variables in tomato grading.Table 6Confusion matrix for recognition in cat 3 grading.Grading systemlabelingManual labeling TotalHealthy (deepred)Healthy (lightred)DefectedHealthy (deep red) 788 39 1 828Healthy (light red) 12 356 5 373Defected 0 5 794 799
Table 7Confusion matrix for recognition in cat 4 grading.Grading systemlabelingManual labeling Total1st grade(DR)1st grade(LR)2nd grade(DR)2nd grade(LR)Rejects1st grade (DR) 572 8 11 4 2 5961st grade (LR) 9 323 3 9 5 3472nd grade (DR) 11 6 229 3 7 2592nd grade (LR) 3 7 4 178 11 204Rejects 5 6 3 6 575 59436 D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28 –37Hashim, N., Janius, R.B., Baranyai, L., Rahman, R.A., Osman, A., Zude, M., 2012. Kinetic model for colour changes in bananas during the appearance of chilling injury symp-toms. Food Bioprocess Technol. 5 (8), 2952 –2963. Hu, M.H., Dong, Q.L., Liu, B.L., Pan, L.Q., Walshaw, J., 2016. Image segmentation of bananas in a crate using a multiple threshold method. J. Food Process Eng. 39 (5), 427 –432. Jahns, G., Nielsen, H.M., Paul, W., 2001. Measuring image analysis attributes and model-ling fuzzy consumer aspects for tomato quality grading. Comput. Electron. Agric. 31(1), 17–29.https://doi.org/10.1016/S0168-1699(00)00171-X . Jarimopas, B., Jaisin, N., 2008. An experimental machine vision system for sorting sweettamarind. J. Food Eng. 89 (3), 291–297. Karlsson, P. (2016). Is Manual Harvest Really Better Than Mechanical Harvest? Retrievedfromhttps://www.bkwine.com/features/winemaking-viticulture/raw-truth-manual-mechanical-harvest/Kim, S., Choi, J., 2014.An SVM-based high-quality article classi ﬁer for systematic reviews. J. Biomed. Inform. 47, 153–159. Lee, D.-J., Schoenberger, R., Archibald, J., McCollum, S., 2008. Development of a machine vision system for automatic date grading using digital re ﬂective near-infrared imag- ing. J. Food Eng. 86 (3), 388–398. Liming, X., Yanchao, Z., 2010.Automated strawberry grading system based on image pro-cessing. Comput. Electron. Agric. 71, S32 –S39. López-García, F., Andreu-García, G., Blasco, J., Aleixos, N., Valiente, J.-M., 2010. Automatic detection of skin defects in citrus fruits using a multivariate image analysis approach.Comput. Electron. Agric. 71 (2), 189 –197. Margulis, D., 2005.Photoshop LAB Color: The Canyon Conundrum and Other Adventuresin the Most Powerful Colorspace. Peachpit Press.Moallem, Razmjooy, 2012. Optimal threshold computing in automatic imagethresholding using adaptive particle swarm optimization. J. Appl. Res. Technol. 10(5), 703–712.Moallem, P., Razmjooy, N., Ashourian, M., 2013. Computer vision-based potato defect de- tection using neural networks and support vector machine. Int. J. Robot. Autom. 28(2), 137–145.Moallem, P., Serajoddin, A., Pourghassem, H., 2017. Computer vision-based apple grading for golden delicious apples based on surface features. Inf. Process. Agric. 4 (1), 33 –40. Moltó, E., Blasco, J., Gómez-Sanchís, J., 2010. Analysis of hyperspectral images of citrus fruits. Hyperspectral Imaging for Food Quality Analysis and Control. Elsevier,pp. 321–348.Naik, S., & Patel, B. (2014). CIELab based color feature extraction for maturity level gradingof Mango (Mangifera indicaL.). National Journal of System and Information Technol-ogy, 0974–3308.Naik, S., Patel, B., & Pandey, R. (2015). Shape, size and maturity features extraction withfuzzy classiﬁer for non-destructive mango ( Mangifera indicaL., cv. Kesar) grading. Paper Presented at the 2015 IEEE Technological Innovation in ICT for Agricultureand Rural Development (TIAR).Nandi, C., Tudu, B., Koley, C., 2014. Machine vision based techniques for automatic mango fruit sorting and grading based on maturity level and size. Sensing Technology: Cur-rent Status and Future Trends II. Springer, pp. 27 –46. Otsu, N., 1979.A threshold selection method from gray-level histograms. IEEE Trans. Syst.
Man Cybern. 9 (1), 62–66.Polder, G., van der Heijden, G., 2010. Measuring ripening of tomatoes using imaging spec- trometry. Hyperspectral Imaging for Food Quality Analysis and Control. Elsevier,pp. 369–402.Rokunuzzaman, M., Jayasuriya, H., 2013. Development of a low cost machine vision sys- tem for sorting of tomatoes. Agric. Eng. Int. CIGR J. 15 (1).Sarkar, N., Wolfe, R., 1985.Computer vision based system for quality separation of freshmarket tomatoes. Trans. ASAE 28 (5), 1714 –1718. Shaﬁee, S., Minaei, S., Moghaddam-Charkari, N., Barzegar, M., 2014. Honey characteriza- tion using computer vision system and arti ﬁcial neural networks. Food Chem. 159, 143–150.Unay, D., Gosselin, B., Kleynen, O., Leemans, V., Destain, M.-F., Debeir, O., 2011. Automatic grading of bi-colored apples by multispectral machine vision. Comput. Electron.Agric. 75 (1), 204–212.37 D. Ireri et al. / Artiﬁcial Intelligence in Agriculture 2 (2019) 28 –37