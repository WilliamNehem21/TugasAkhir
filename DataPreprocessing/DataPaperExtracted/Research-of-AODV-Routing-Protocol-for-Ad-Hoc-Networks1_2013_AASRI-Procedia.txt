 AASRI Procedia   5  ( 2013 )  21 â€“ 31 
2212-6716 Â© 2013 The Authors. Published by Elsevier B.V.
Selection and/or peer review under responsibility of American Applied Science Research Institute
doi: 10.1016/j.aasri.2013.10.054 ScienceDirect
 2013 A ASRI Conference on Parallel and Distributed Computing and Systems 
Research of AODV Routing Protocol for Ad Hoc Networks1
Sheng Liu, Yang Yang, Weixing Wang 
School of Information Engineering, Changâ€™an University, Xiâ€™an, 710064 
 
Abstract 
Firstly, this paper describes the basic characteristic, key te chniques of Ad Hoc networks, and compared with other mobile 
communication systems. Through analyzing and comparing with DSR, TORA, ABR, AODV, it researched on-demand 
routing protocol for Ad Hoc networks. It introduces AODV routing protocol in details. It presents an optimized protocol: 
B-AODV, based on the shortage of routing finding and routing repair of AODV. In B-AODV, first through reverse 
request by sending BRREQ replace of RREP, it reduces the time of routing finding. Second, two hops IP record in control 
messages and route table can improve the rate of routing repair and reduces the times of routing findings. And it improves 
the function of Ad Hoc network. This simulation experiment  is based on NS2 and compared the performance of AODV 
and B-AODV. And it compared the differences of control packets, ratio of packets, end to end delay for AODV and B-
AODV. It shows that B-AODV is better than AODV. 
 
Â© 2013 The Authors. Published by Elsevier B.V. 
Selection and/or peer review under responsibility of American Applied S cience Research Institute 
 
Keywords Ë–Ad Hoc Network, on-demand Routing, AODV 
In recent years, the research of routing protocol for Ad Hoc Network[1] has caused public concern widely. 
Based on the multi-hop[2] characteristic of Ad Hoc, the classic routing protocol has failed to meet the needs of 
the unpredictable and frequently network topology. The Ad Hoc routing protocol must maintain timely and 
 
 
* Corresponding author. Tel.: +0-139-91256322 
E-mail address Ë–thgpc@163.com. 
Available online at www.sciencedirect.com
Â© 2013 The Authors. Published by Elsevier B.V.
Selection and/or peer review under responsibility of American Applied Science Research InstituteOpen access under CC BY -NC-ND  license.
Open access under CC BY -NC-ND  license.22   Sheng Liu et al.  /  AASRI Procedia   5  ( 2013 )  21 â€“ 31 
 restructure routing, and it must consider the bandwidth  and high error rate. As the other network routing protocol not meet, the new routing protocol suita ble for Ad Hoc Networks is needed designing. 1. AODV protocol 1.1. Introduction of AODV protocol AODV(Ad hoc on-demand distance vector routing) is a Source drive type
[3] routing protocol. When a source node sent message to a target node without the routing, it sent RREQ first. When the adjacent node received RREQ with the addresses of source node and target node, it judged if it was same with the target nodeâ€™s address. If it was, sent RREP to source node, ot herwise, checking the routings in the rout table that could reach the target node, then send RREP to source node, or continue to flooding send RREQ. AODV protocol can maintain routing nodes through broadcasting hello message regularly. If one link break, it sent ERROR message to nodes, meanwhile deleted br oken records or repaired the routing.  1.2. The shortage of AODV
[4]
AODV protocol created the routing between two nodes in the network based on route discovery and route maintenance.. In the route require process, it broadcasted RREQ message to target node in the form of flooding; In the route response process, target node preferentially chose the first-arrived RREP and sent RREP message. As the node strenuous exercise during finding routings, the route was easy to break, which would lead to the loss of RREP packet. In the routin g maintaining process, the broken node would discard error packet and notice the source node to resend requ est message when broadcasting RERR packets, which would lead time delay of subsequent packet; in order to eliminate loopback caused by new touring, local repair may cause that the RREP sent by downstream node could be discarded, which reduced the probability of routing recovery. In addition, despite with routing main tenance mechanism, the node is mobile, the route may not be repaired timely or failed to repair, wh ich reduced the utilization of network control information, and could increase the routing delay, thus affecting the performance of the network.. 2. Design of B-AODV protocol For the shortage of AOFV protocol, a better protocol is needed to avoid route breaking, reduce message lose rate and decrease network delay. An improved approach B-AODV based on AODV was designed, assuming that the network link was bidirectional, that  was the source node and the destination node could reach each other through one route . 2.1. Routing construct For AODV, if a node moved fast, in the reverse routing it may cause the loss of packets when RREP sent reply message through unicast, and RREP unicast back  to the source node, so in the B-AODV, a control message B-RREQ similar to RREQ was devised when the reverse route was built. The source node also undertook the task of routing discovery as the target node, and after receiving RREQ it reversely sent flooding B-RREQ message to find the source node,. When  the source node got first B-RREQ, it started to transmit data, and recorded the information of both fron t and next two-hop nodes in RREQ and B-RREQ for rapidly rebuilding routings. 23  Sheng Liu et al.  /  AASRI Procedia   5  ( 2013 )  21 â€“ 31 
 The route discovery process was detailed as followi ng. When the source node had no routing to the destination node and had to send data to the destina tion node, it broadcast RREQ message to neighbors. The RREQ messageâ€™s format was shown in table 1. This format added front and next two-hop nodes ad dresses, that showed RREQ recorded not only the addresses of the current node's neighbours but also that of two-hop nodes. When one node broadcast RREQ control message, the counter of RREQ added 1 automa tically. The source node IP address and RREQ ID could uniquely identify a RREQ control message. A node checked ID when receiving same RREQ control message, if that were the same, one of that was discard. This process was completely same with AODV. After getting RREQ, the intermediate node compared with its own routing information, and updated the related information in the routing table, thus relevant bytes were added: front and next two-hop nodes' addresses. The format of routing table is shown in table 2. If the intermediate node had no routing to target node, it continued to sending RREQ and constructed reverse routing. When RREQ packet reached the target node, the target node created a packet B-RREQ similar to RREQ. Table 3 showed the B-RREQ message format. 
 
Tab.1 message format of RREQ                        Tab.2 New Routing table                           Tab.3 B-RREP message form at  
                                                                
 
Having created B-RREQ, the target node broadcast it to neighbor nodes immediately, same with the process that the source broadcast RREQ, which is to  build reverse routing. When the intermediate node received the packet, it would check there was the same packet or not, if it was yes, then the same packet would be discarded. Otherwise it would be sent to neighbor nodes. The neighbor node received the packet, recorded the addresses of next and front two-hop nodes, and set the routing lifetime until it got the target node. The source node transmitted data immediately when receiving first B-RREQ. The routing reply process was shown in figure 1. 

Fig.1 Send B-RREQ Target node IP address 
Target node serial number  
Target node serial number tag 
Next one-hop node address 
Next two-hop node address 
Front one-hop node address 
Front two-hop node address 
Hop number Lifetime Front two-hop node address
Type Reserved  Hip hop 
RREQ ID 
Next one-hop node address Next two-hop node address Front one-hop node address Front two-hop node address Source node IP address Source node serial number Target node IP address Target node serial number
 
Source node IP address of RREQ 
Source node serial number of RREQ 
Routing request time Type Reserved Hip hop 
RREQ ID 
Next one-hop node address Next two-hop node address Front one-hop node address Front two-hop node address Source node IP address Source node serial number Target node IP address Target node serial number Source node IP address of RREQ Source node serial number of RREQRouting reply time 24   Sheng Liu et al.  /  AASRI Procedia   5  ( 2013 )  21 â€“ 31 
 Unlike that RREP returned to the source node with one-hop and unicast, as R Äº4Äº3Äº2Äº1Äº S, in B- AODV, B-RREQ was broadcast with many routings to choose, 
RÄº5Äº6Äº7Äº8Äº9Äº S,RÄº14Äº13Äº12Äº11Äº10ÄºS and so on. The source node S could transmit data in a routing with most energy. The problem that RREP often lost as the intermediate nodes moved in AODV can be solved. The routing discovery flow was shown in figure 2(a),(b). 
                  
(a)                                                                                          (b) Fig.2 Send RREQ of B-AODV 
2.2. Control routing message computation In B-AODV, it seems that routing overhead was added for sending B-RREQ, however, it was reduced indeed by proving. A network environment was set here: There were N nodes in the Ad Hoc network; In the AODV protocol, the number of transmitting control message during routing discovery was AONV(N); In the B-AODV protocol, the number of transmitting control message during routing discovery was B-AONV(N); Assuming that there were m nodes transmitting message  during routing discovery, as the AODV protocol N 
If the routing was broken 
If the node was found 
If there was the routing from Its next one-hop node to 
target 
node 
Transmit data The upstream node sent RREQ to find routing to target node The intermediate node replied RREP, and built 
routing Continue to send data RREQ from upstream nodes can reach intermediate node of next two-hop nodes 
Y 
Y N Y N  
If the routing was broken 
If the node was found 
If there was the routing from Its next one-hop node to target 
node 
Transmit data The upstream node sent RREQ to find routing to target node 
The intermediate node replied RREP, and built 
routing Continue tosend data 
RREQ from upstream nodes can reach intermediate node of next two-hop nodes Y 
Y 
 
Y  NN 
N 25  Sheng Liu et al.  /  AASRI Procedia   5  ( 2013 )  21 â€“ 31 
 says, if the first routing discovery was right, the ro uting node number of transmitting control message is: AODV(m)=m-1+t                                                                                                                                      (1) Where, t is the number of nodes transmitting routing reply message. If there was more than 1 time during routing discovery in AODV, then it should be
Ë– 
AODV(m)=c(m-1+t)                                                                                                                                 (2) Where c meant the number of routing discovery process. If data transmitted following B-AODV, there was at least 1 stable routing to be found to transmit data during routing discovery, so only 2m-2 nodes were deeded to transmit data: B-AODV(m)=o(2m-2)                                                                                                                               (3) From this we can draw the conclusion: when c>1, AODV protocol produces much more Routing overhead in the routing building process. 2.3. Routing maintenance Shown in figure 3, in the AODV algorithm, if the link between nodes 2 and 3 had been broken, node 2 need to repair local routing, send RREQ, and find routin g to the target node R. RREQ was forwarded to node 4 through node F, until reaching node R, then R replied RREP back to node 2 along the reverse routing. Thus a new effective routing was built. If routing repair failed within certain repair time, it sent RRER message to source node, and the source node resent RREQ to find routing. In the new algorithm, each routing table maintained the addresses of adjacent two-hop nodes, when the next node 3 in the routing table that it would arrive to target node lost effectiveness, meaning that the routing was invalid and it need local repairing. Different from the AODV, node 2 didnâ€™t wait for the RREQ message of target node R, as next two-hop nodesâ€™ addresses were initially recorded in the routing table, node 2 looked for the next two-hop node 4, then 2 sent RREQ message  to node 4. When RREQ reached node 4 through F, meanwhile node 4 owned active path to target node, so node 4 could send RREP directly to node F, then node 2. Thus a valid routing from node 2 to node R was built, as shown in figure 3. 
 
                      
Fig.3 Routing repair: find 2 and 4,build new routing                             Fig.4 Routing repair Ë–find 2 and 3,build new routing             
If there was no common neighbor node between node 2 and 3, shown in figure 4, node 3 could not escape next-hop range of node 2. So node 3 was likely to be on e of node 2â€™s next two-hop nodes. In this case, after receiving RREQ from node 2, node H found that there was no node 4 but node 3 in its neighbors, then node H sent RREP to node 2, aiming to notice that it was the common neighbor node with node 3, thus node 2 would rebuild a new routing through node H and 3 to the target node. S13 2
R4
HS13 2
R4
F26   Sheng Liu et al.  /  AASRI Procedia   5  ( 2013 )  21 â€“ 31 
 If the node 3 and the node 4 lost efficiency, shown in fi gure 5, node 2 sent RREQ finding the target node R, to find new routing of broken path; if routing disc overy failed, node 2 sent RRER to neighbor nodes until back to source node S, S resent RREQ to start a new round of routing discovery, which was same with AODV protocol. Due to the movement speed of nodes wa s limited, there will be less in reality. This reduced the cost of routing maintenance as well as routing delays. If  the case was special, node 4 was the target node, completely same with original AODV algorithm, it sent RREQ to find the next two-hop nodes, i.e. the ta rget node. When node 3 being the target node, send RREQ do find the target node directly. Above that, the downstream neighbor nodes of the fract
ure was more closer than the target node to the upstream nodes of the fracture, so the finding speed would be faster, that was to say, the finding time was shorter than AODV routing algorithm, so the new protocol is more optimized. 

Fig.5 Routing repair failure: the next two jump node is invalid               
2.4. Time of routing recovery Set the time sending RREQ to the target node 4 and replying RREP to be S
1, the time from sending RREQ to the target node R and returning RREP to be S
2, it can be known from above narrate[5]:  
12SSd  (when node 4 was same with node R , the equation was valid)                                              (4) Set the probability that a node was not valid to be p (p <1), then the probability of both nodes at the same time were not valid as
2p, one node was not valid while another node was valid with a probability of p (1-p) For AODV routing algorithm, when node 3 was inva lid, the time node 2 refound routing was: S(AODV)=S2
up                                                                                                                                       (5) For the improved B-AODV routing algorithm, when nod e 3 was invalid, the time node 2 refound routing was: S(B-AODV)=Sl
upu(1-p)+ S2up2                                                                                                         (6) From (6)-(5), S(B-AODV)
Ë‰S(AODV)=p (1-p) u( Sl â€“ S2)                                                                                            (7) From the above, (7)<0, that is , compared to AODV, the finding time of the improved algorithm was much shorter, and node 3 was much more closer to node 2 th an node R, thus the required time would be shorter. S13 2
R4
MM27  Sheng Liu et al.  /  AASRI Procedia   5  ( 2013 )  21 â€“ 31 
 3. Experimental analysis The performance of the routing protocol depended on
[6]: the Routing overhead, the ability to send packets, the delay from node to node and the packet posted success rate, etc. Moreover different scenes had a big impact to the r outing protocol. Same routing protocols in different simulated scenarios, its routing performance also had a great deal of difference. The main factors of the ad hoc network scenes: the number of network nodes, th e changing speed and the movement speed of the network. Therefore, when comparing and analyzing diffe rent routing protocols, the network scene must be taken into account. The simulink environment here was: windows xp+fedora core4+NS2. 29. 3.1. Set network parameters and configure main parameters of routing protocol Set network parameters as following: The number of nodes: 10,20,30,40,50; the simulink environment: 1000m*1000m; the nodeâ€™s communication range: 250m; the nodeâ€™s movement speed: 0~MAXSPEED. The maximum speed respectively: 2,5,10,25,50,75m/s; radio model: Two-Rav; network service: CVR service flow; MAC layer model: 8.2.11; packet sending rate: 8packets/s. 3.2. Performance indicators of routing protocol Performance indicators of routing protocol were as follows
[7][8[9]: (1)Successful packets posted rate successful packets posted rate =  (number of sent packets â€“ number of discarded packets) / number of sent packets                                  (8) (2)Average delay from node to node Average delay from node to node =  
iNiistrtNÂ¦
 11
                                                                                                                                        (9) Where N represented the number of successfully-transmit packets, rt was the time of packets reaching the target node, st was the time of packets being sent. (3)Routing overhead Routing overhead can compare adaptation capacity and e fficiency of different routing protocols. The formula was: 
Routing over head = total number of routing c ontrol packets                                                                 (10) 3.3. Results analysis Through the simulation of AODV and B-AODV, compar e their performance in the number of nodes and maximum speed of node movement. (1)Packet delivery ratio 28   Sheng Liu et al.  /  AASRI Procedia   5  ( 2013 )  21 â€“ 31 
 a. Packet delivery ratio of different nodes                              

        1XPEHURI1RGHV5DWLR$2'9
%$2'9
 
Fig.6 Packet delivery ratio comparison of different nodes                       
b. Packet delivery ratio of different speeds        
 

         1RGH0D[6SHHG5DWLR$2'9
%$2'9

Fig.7 Packet delivery ratio comparison of different speed 
From figure 6, it can be seen that the packet deliv ery ratio of the improved protocol was almost same with that of the original protocol when there were less nodes, for which the probability of routing repair was low after the routing broke. When there were much more node s, the delivery ratio cut down obviously, for which with more nodes, the nodes moved frequently thus the probability of routing breaking was higher. 29  Sheng Liu et al.  /  AASRI Procedia   5  ( 2013 )  21 â€“ 31 
 From figure 7, the speed faster, the packet delivery ratio lower. Obviously, when the nodes moved with high-speed, packet loss would increase. However the packet delivery ratio of B-AODV was seriously higher than that of AODV. (2)Average delay from node to node a Average delay from node to node of different nodes   b Average delay from node to node of different speeds 
 

        1XPEHURI1RGHV'DOD\V%$2'9
$2'9
 

Fig.8 End-to-end delay of different nodes 

        1XPEHURI1RGHV'DOD\V%$2'9
$2'9

 
Fig.9 End-to-end delay of different speed 30   Sheng Liu et al.  /  AASRI Procedia   5  ( 2013 )  21 â€“ 31 
 The delay of B-AODV was lower. Because for the orig inal protocol the RREP reply must be limited during routing finding, on the other hand, when the routing broke, AODV must send RREQ to the target node then rebuild routing through returning RREP, however for B-AODV, it only sent RREP to the front two-hop nodes then built forward routing, so the delay would be lower. (3)Routing overhead comparison 
 

         1XPEHURI1RGHV&RQWURO3DFNHWV%$2'9
$2'9

Fig.10 Routing overhead 
From figure 10, when there were less nodes, the num bers of two control packets were similar, but when the number of nodes added, B-AODV protocol was clearly optimized than AODV protocol.
. 
4. Conclusion Some of the features in the Ad Hoc network increase the difficulty of routing technology, such as ad-hoc, multi-hop as well as the variability of the network structure, so the key to designing Ad Hoc routing protocol is to solve the problem that fast node movement makes complex changes in network structure. On the basis of the comparing and analyzing AODV routing protocol, th is article introduced an improved B-AODV protocol, which ameliorated the routing finding and local repair for rebuilding new routing. The new protocol improves the routing repair capacity and packet successfully-posted ratio, reduces the delay from node to node, and decreases the routing overload. Nonetheless, the nodes in the network do not only have a two-way link, the single link protocol optimization is the goal of future research. Acknowledgements The National Natural Science Foundation of China (61170147). 31  Sheng Liu et al.  /  AASRI Procedia   5  ( 2013 )  21 â€“ 31 
 References [1] Y.Kim,J.Jung,S.Lee,C.Kim,A Belt-Zone Method  for Decreasing Control Messages in Ad Hoc Netowkrs.ICCSA.2006:42-46. [2] Ankit Sggarwal, Bhumika Garg. Survey on secure AODV for Ad Hoc networks routing mechanism. J International Journal of Advanced Research in Comput er Science and Software Engineering, 2012;2(3):203- 206. [3] L. Abusalah, A. Khokhar, and M. Guizani, A survey  of secure mobile ad hoc routing protocols,. Commun. Surveys Tuts., 2008;10(4):78â€“93. [4] Marchang Ningrinla. Light-weight trust-based routing protocol for mobile ad hoc networks. J IET Information Security, 2012;6(2):77-83. [5] Kum Dong-Won. An efficient on-demand routing appro ach with directional flooding for wireless mesh networks. J Journal of Communications and Networks, 2010;12(1):67-73. [6] Nakayama Hidehisa, Kurosawa, Satoshi, etc. a dynamic anomaly detection scheme for AODV-Based mobile ad hoc networks. J IEEE Transactions on Vehicular Technology, 2009; 58(5):2471-2481. [7] Lee Breslau Deborah Estrin etc. Advances in Network Simulation. IEEE Computer,2000;5:78-85. [8] Wing Chung Hung, K L Eddie Law, A Leon-Garci a. A Dynamic Multi-Channel MAC for Ad Hoc LAN. In 21st Biennial Symposium on Communications. Kingston. Canada. 2002;7:132-138. [9] R. Choudhary, S. Bhandhopadhyay and K. Paul. A Distributed Mechanism for topology discovery in Ad Hoc Wireless Networks Using Mobile Agents.2000;(5):96-101. 