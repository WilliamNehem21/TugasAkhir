Developing a multi-label tinyML machine learning model for an activeand optimized greenhouse microclimate control from multivariatesensed data
Ilham Ihoume ⁎, Rachid Tadili, Nora Arbaoui, Mohamed Benchrifa, Ahmed Idrissi, Mohamed Daoudi
Solar Energy and Environment Laboratory, Mohammed V University in Rabat, Faculty of Sciences, B.P 1014, Rabat, Morocco
abstract article info
Article history:Received 24 May 2022Received in revised form 18 August 2022Accepted 30 August 2022Available online 5 September 2022In the uncertainties within which the worldwide food security lies nowadays, the agricultural industry is raising acrucial need for being equipped with the state-of-the-art technologies for a more ef ﬁcient, climate-resilient and sustainable production. The traditional production methods have to be revisited, and opportunities should begiven for the innovative solutions henceforth brought by big data analytics, cloud computing and internet ofthings (IoT). In this context, we develop an optimized tinyML-oriented model for an active machine learning-based greenhouse microclimate management to be integrated in an on- ﬁeld microcontroller. We design an ex- perimental strawberry greenhouse from which we collect multivariate climate data through installed sensors.The obtained values' combinations are labeled according to a ﬁve-action multi-label control strategy, then used to prepare a machine learning-ready dataset. The dataset is used to train and ﬁve-fold cross-validate 90 Multi- Layer Perceptrons (MLPs) with varied hyperparameters to select the most performant –yet optimized–model in- stance for the addressed task. Our multi-label control approach enables designing highly scalable models with re-duced computational complexity, comprising only ncontrol neurons instead of (1 +∑
nk=1Cnk) neurons (usually generated from a classic single-label approach from ninput variables). Ourﬁnal selected model incorporates 2 hidden layers with 7 and 8 neurons respectively and 151 parameters; it scored a mean accuracy of 97% duringthe cross-validation phase, then 96% on our supplementary test set. The model enables an intelligent and auton-omous greenhouse management with the less required computations. It can be ef ﬁciently deployed in microcontrollers within real world operating conditions.© 2022 The Authors. Publishing servic es by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is an openaccess article under the CC BY license ( http://creativecommons.org/licenses/by/4.0/ ).Keywords:Agricultural greenhouseMicroclimate controlMachine learningOptimizationTinyML
1. IntroductionIn its most recent“Food Security and Nutrition in the World ”annual report, the United Nations Food and Agriculture Organization (FAO)highlighted substantial ongoing deviations with respect to the commit-ments made towards ending world hunger and malnutrition by 2030.These deviations have been ampliﬁed even more by the pandemic ad-vent and its persistent effects, which still impact severely the worldwidefood security (Lopez-Ridaura et al., 2021). The latter–in conjunction with the actual supply chain disturbances and the recent worldwidegeopolitical movements–is threatened by another major risk, which isclimate change and its induced global warming effect ( Lal, 2021). Crops are tightly contingent on climatic factors such as the ambienttemperature, the relative humidity, the received solar radiation, thewind as well as the different forms of precipitations such as rain, snowand hail (Iizumi and Ramankutty, 2015;Liao et al., 2021). As a conse- quence, agriculture is one of the most affected sectors by climatechange, whose impact grows increasingly and compromises variousharvest types (Doshi and Varghese, 2022). In this context, the urgent arising necessity is seeking for new innovative techniques for moreclimate-resilient–yet productive–agricultural models, and one of themost promising solutions towards this issue is the use of agriculturalgreenhouses (Cordovil et al., 2020;Azadi et al., 2021). The prominent advantage of these greenhouses is making it possible for farmers to reg-ulate the environmental growing variables actively and producing – regardless of the outdoor climatic conditions –various crops at any year season. In this way, crops grow in optimal conditions and remainprotected from external factors that may harm them ( Ihoume et al., 2022;Katzin et al., 2022). Nowadays, greenhouse design and develop-ment are witnessing signiﬁcant advances. The state-of-the-art “smart” models are equipped with sensors that collect consistentlyArtiﬁcial Intelligence in Agriculture 6 (2022) 129 –137
⁎Corresponding author.E-mail address:ilham.ihoume@um5r.ac.ma(I. Ihoume).
https://doi.org/10.1016/j.aiia.2022.08.0032589-7217/© 2022 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is an open access article under the CC BY license (http:// creativecommons.org/licenses/by/4.0/ ).
Contents lists available atScienceDirect
Artiﬁcial Intelligence in Agriculture
journal homepage:http://www.keaipublishing.com/en/journals/artificial-intelligence-in-agriculture/environmental data, along with actuators that can perform indoor ac-tions accordingly such as heating, lighting, ventilation, CO
2
enrichment and irrigation (Angelopoulos et al., 2020;Jamil et al., 2022). Smart greenhouses are promising; however, they generateimportant climatic data streams that are not easily manageable(Escamilla-García et al., 2020). Managers face difﬁculties in analyzing, understanding and exploiting these continuous streams correctly. As aconsequence, they may misunderstand how climatic factors correlatewith their crops, and thus to deploy timely and ef ﬁcient corresponding management strategies to maximize the production ( Azaza et al., 2016). Conventionally, climatic data is collected from indoor greenhouse sen-sors then sent to the farmers who have to set the corresponding controlactions continuously such as lighting, ventilation and irrigation. In thisprocess, competent and experienced managers are needed, which isnot always achievable (Mani and Sankaranarayanan, 2017). Moreover, this classic decision-making scheme is not optimized, since it does nottake full advantage of the interdependencies between the collected var-iables and the underlying correlations with the crops' states of growth.2. Related workMany research works have focused on developing intelligent solu-tions for greenhouse microclimate management (See Table 1). Research and development efforts focus on proposing performant algorithms, aswell as reliable and interoperable hardware implementations in real-world operating conditions. The objective is achieving intelligentdecision-making solutions that make it possible for greenhouses to op-erate autonomously, and thus improving the quality and yield of har-vests (Alwis et al., 2022).Revathi and Sivakumaran (2016)developed a fuzzy logic-based temperature controller that regulates the internalgreenhouse temperature based on live temperature monitoring froman internal sensor.Azaza et al. (2016)also developed a fuzzy logic- based greenhouse climate controller operating on humidity, tempera-ture, CO
2and illuminance to perform indoor control-related actions.However, in addition that theﬁrst work tackled only one variablei.e., the ambient temperature, the major drawback of fuzzy logic-basedsystems is being completely dependent on human knowledge and ex-pertise.Angelopoulos et al. (2020)developed a reinforcement learning-based system targeting smart irrigation within a strawberrygreenhouse in Greece. They found that the system outperforms conven-tional irrigation in terms of soil moisture variation and water consump-tion; however, it manages only one task that is irrigation.In the hydroponics subﬁeld,Alipio et al. (2017)proposed a Bayesian Network (BN) algorithm to automate plant growth by controlling thelight intensity, the soil acidity, the water temperature and the humidity.They were able to increase the production by around 66.67% comparedto manual control; however, from a probabilistic perspective BNs gener-ate probability density functions rather than the maximum a posterioriestimated direct parameter values, which adds additional unnecessarycomplexity to the system.Mehra et al. (2018)proposed a Multi-layer Perceptron (MLP) neural network to monitor and manage the growthof tomatoes. An accuracy of 88% was achieved; however, for only 3input variables the proposed model involved (1 +∑
3k=1C3k= 8) control neurons at its output layer, which makes it practicallyunscalable for more complex scenarios.3. Context, contribution and organization of the workThe aforementioned works underline several efforts made in thecontext of moving towards smart greenhouse microclimate controlthrough case studies. However, the reviewed solutions/approachespresent at least one of the following drawbacks:•Being mono-task i.e., handling only one action in function of a singleclimatic variable such as the temperature. While regulating one singlevariable ensures its adequacy with a particular crop requirement, itremains insufﬁcient since crops usually correlate with multiple vari-ables simultaneously (Poudel and Shaw, 2016;Liu et al., 2020). •Being not fully autonomous and intelligent, with involving continuousmanual intervention to set up the corresponding control actions to betaken inside a greenhouse, depending on the collected climatic data.•Achieving a performance below the threshold of being concretely de-ployable to on-ﬁeld application in real world operating scenarios.•Being developed with no optimization for an implementation withinon-ﬁeld micro-controllers, though it is a crucial aspect within the ad-dressed thematic. Machine and deep learning were initially deployedin big data centers that are equipped with highly performant com-puters, which can handle huge amounts of parallel computations. How-ever, there is actually a rising need for implementing machine/deeplearning models within physical and portable devices for more practicaland interactive applications. Such devices have very limited memoryand processing power, thus requiring simpler –yet efﬁcient–models to be designed (Dutta and Brahali, 2021;Frankowiak et al., 2005). The machine learning subﬁeld that addresses this problematic is calledTiny Machine Learning (TinyML) (Ray, 2022;Han and Siebert, 2022).Greenhouses are complex and non-linear systems ( Escamilla-García et al., 2020). An efﬁcient climate-based management for these systemsrequire algorithms that can autonomously learn the underlying patternswithin the collected data then map them to the most optimized controlactions. Additionally, these algorithms have to be light enough for a fur-ther concrete implementation in on-ﬁeld microcontrollers. In this con- text, we develop a model for microclimate control of a strawberryagricultural greenhouse with the following contributions:•In a machine learning-based approach, we use an MLP architecture toachieve full autonomy with no required manual intervention.•In a tinyML-oriented approach, we conduct a thorough and systematichyperparameter tuning with extensive performance evaluation in thechosen architecture in order to:o Achieve the highest performance possible for the addressed task.o Obtain a lightweight model in terms of parameters and internalcomputations for a further implementation in a microcontrollerwithin real world operating conditions.•We propose a multi-label control strategy that shrinks dramaticallythe number of required control neurons from (1 +∑nk=1Cnk) to just nneurons, which enables more computational ef ﬁciency and increased generalizability to more complex control scenarios.The upcoming sections are structured as follows: Section 4presents the used materials and adopted methodology; Section 5exposes and
Table 1Summary of the reviewed works.Approach Input climatic variables Performance metricRevathi and Sivakumaran (2016) Fuzzy-logic Temperature – Azaza et al. (2016) Humidity, temperature, CO2 and illuminance – Angelopoulos et al. (2020) Reinforcement learning Soil moisture, water consumption – Alipio et al. (2017) Bayesian network Light intensity, soil acidity, water temperature and humidity 66.67% (production increase) Mehra et al. (2018) Multi-layer Perceptron Temperature, illuminance, soil moisture 88% (accuracy)I. Ihoume, R. Tadili, N. Arbaoui et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 129 –137
130discusses the obtained results;Section 6concludes the work along with providing recommendations for future research.4. Materials and methodsThe methodology of this work comprises three phases depicted inFig. 1: (1) theﬁrst one consists in the design and deployment of an experimentalstrawberry greenhouse, equipped with active sensors; (2) the second com-prises collecting the sensed data to prepare a machine learning-readydataset; (3) the third tackles the development, cross-validation of multiplemodels, then the selection and further test of the optimal one. The details ofeach phase will be presented in the upcoming subsections.4.1. System design and deploymentThe experimental greenhouse wasﬁrst designed within a 3D model- ing environment (3ds Max), then replicated on the terrace of the SolarEnergy and Environment Laboratory at the Faculty of Sciences inRabat (Morocco) (Altitude: 66 m, Longitude: 6°49 ′57″, Latitude: 34°00′47″)(Fig. 2). The greenhouse has a base of width 2.30 m, of height3.20 m and a footprint area of 7.36 m
2. It is elevated from one side by 2.07 m and from the other with 3.20 m, forming a learning roof ofwidth 2.50 m. The greenhouse was equipped with a solar heating sys-tem that operates through storing the solar energy collected at daytimeand releasing at nighttime to maintain a temperature range around thestrawberry temperature set point. To ventilate the ambient air, thegreenhouse was equipped with an automatic opening window thatuses an electrical motor and a fan with a power of 40 W.The greenhouse was installed beside a weather station comprising apyranometer, a humidity and temperature sensors, a rain gauge, an an-emometer and a barometer (Fig. 3). Inside the greenhouse (Fig. 4), a pyranometer was installed to measure the global solar radiation. Therelative humidity was measured in the center of the greenhouse at aheight of 1 m above the ground using a RH sensor. A T-type thermocou-ple (copper-constantan) at the interior to measure the interior temper-ature. All sensors were connected to an acquisition box, where datawere recorded at a frequency of 6 s and averaged over a one-hour tilescale before being processed and stored under a tabular format. Thetechnical speciﬁcations of each sensor are presented in Table 2.4.2. Dataset preparationFive climatic parameters were measured during the winter season ofthe year 2022 inside the greenhouse: (1) the temperature, (2) the humid-ity, (3) the soil humidity, (4) the solar illuminance and (5) the air CO2
concentration. The recorded data were collected from the installedsensors then cleaned from erroneous records. The combinations of theobtained values were normalized to the unit interval with respect toeach input variable, then labeled using multi-label vectors with one-hotencoding according to control actionst h a th a v et ob ep e r f o r m e da u t o m a t -ically within the greenhouse. Each multi-label is a ﬁve-dimensional vector where each binary numerical value is associated with one control actionas illustrated inFig. 5. As examples, a vector such as [0,0,0,0,0] meansthat no control action has to be taken; a vector such as [1,1,0,0,0]means that the window and the ventilator have to actioned to regulatethe indoor temperature and humidity respectively.The dataset was balanced with respect to each action occurrence. Af-terwards, it was split into two sub-datasets: (1) a training/cross-validation sub-dataset of 80%, and (2) a test sub-dataset of 20% heldout for further evaluation.Fig. 1.Flowchart of the general methodology.
Fig. 2.The experimental greenhouse: (a) A 3D designed prototype using a 3D modelingsoftware (3ds Max); (b) The on-ﬁeld replicated model.
 Fig. 3.Weather station of the laboratory of solar energy and environment at the Faculty ofSciences in Rabat (Morocco).I. Ihoume, R. Tadili, N. Arbaoui et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 129 –137
1314.3. Model development4.3.1. Architecture designIn order to develop our autonomous and intelligent greenhouse con-trol solution, we have chosen a machine learning-based Multi-LayerPerceptron (MLP) architecture. MLPs are a class of feed-forward neuralnetworks capable of approximating complex linear/non-linearfunctions. To achieve that, they rely on linked mathematical predictorscalled artiﬁcial neurons, arranged within three types of stacked layersas depicted inFig. 6(Pedrycz and Chen, 2020;Arias del Campo et al., 2021).•One input layer whose role is transferring to the next layer (calledtheﬁrst hidden layer) a set ofmn−dimensional input features:X= {Xi}iϵ⟦1,m⟧ where for eachi:X i={x ik}kϵ⟦1,n⟧. •One hidden layer, which receives the input features then transfersthem either to an output layer or an additional hidden one thatoperates likewise.•One output layer designed to output the ﬁnal predictionby
icorre- sponding to each of the initially received inputs X
i. An artiﬁcial neuron produces from a set of inputs: X
i={x ik}kϵ⟦1,n⟧ an activated linear combinationa
iexpressed as follows:a i=f(∑ k=1nwikxik
+b i)w h e r e{w ik}k∈⟦1,n⟧ are called the weights of the neuron, b iits bias andfits activation function (Arias del Campo et al., 2021). As shown inFig. 6, every neuron is connected to all the neurons in the previousand next layers, this is why the layers of an MLP are also called fully con-nected layers. Every inter-neuron connection is equivalent to a forwardactivation transfer; the activations of each layer are therefore consid-ered as the next layer's inputs. The weights and biases of all neuronswithin an MLP are its parameters; they are ﬁrst randomly initialized, then optimized (or learned) during a training process (that will be de-tailed afterwards). The number of layers and neurons per layer as wellas the implemented activation functions are called hyperparameters;they are tuned prior to any training session ( Alzubaidi et al., 2021).
Fig. 4.The sensors' location inside the greenhouse.
Table 2Technical speciﬁcations of the sensors installed in the weather station and inside thegreenhouse.Sensor MeasuringrangeAccuracy Unit
Weather stationSolar radiation 0 –5000 ±0,1 W/m
2
Anemometer 0,4 –30 ±0,2 m/sOutdoor humidity 0 –99 ±5 %Precipitations –±0,01 mm Pressure 500 –1100 ±5 hPa Outdoortemperature−40–80 ±0,1 °CInside thegreenhouseHumidity 0 –99 ±5 %Temperature−40–80 ±0,1 °C Soil humidity 0 –1000 ±0,1 – CO
2airconcentration0–5000 ±0,4 ppmSolar illuminance 0 –1000 ±3 lux
Fig. 5.Theﬁve-action multi-label control strategy.
Fig. 6.A multi-layer perceptron with X∈ℝ(m,3), two hidden layers (with six neurons in the ﬁrst layer andﬁve in the second) and a three-output prediction layer.I. Ihoume, R. Tadili, N. Arbaoui et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 129 –137
132Toﬁnd the optimal model architecture for the addressed task, wehave started from an initial MLP, comprising one hidden layer of oneneuron. Next, we increased progressively the number of layers, alongwith the number of neurons per layer, to create multiple MLP instancesthat were trained and cross-validated on the prepared dataset.4.3.2. Model training and cross-validationIn an MLP, hidden layers learn the underlying patterns of a givendataset through an extraction/combination process of multiple sequen-tially constructed abstract representations. For this purpose, an MLP hasﬁrst to be trained on that dataset. The training is an optimization problem,aiming atﬁnding the model's set of parameters that minimize a metricquantifying the difference between the dataset labels Y={y
i}i∈ℝmand the model predictions^Y¼f^y
igi∈ℝm. This metric is called the cost functionJ(Alzubaidi et al., 2021;Sarker, 2021). Each obtained model instance was trained on the prepared dataset,in parallel with aﬁve-fold cross validation procedure. The latter consistsin training the instance onﬁve-split conﬁgurations. In each one, one split (1/5) is reserved to validate the model after being trained on thefour other ones, which provides more realistic performance estimatesfor the evaluation (Refaeilzadeh et al., 2009). A variant of an iterative gradient-based optimization algorithm has been adopted i.e., theAdam optimizer (Kingma and Ba, 2017). For each model instance, the parameters were randomly initialized; afterwards, a series of iterations(or epochs)–whose number is also a hyperparameter –were per- formed. Each series comprises:•A forward propagation phase, where –with the last parameter state – the model predictions are computed, and the model is evaluatedthrough calculating the cost function and the model accuracy on thetraining and validation sub-datasets.•A backpropagation phase, where each of the model parameters isupdated using the formula:w
i=w i−α∂J/∂w i,w h e r eαis a hyperparameter called the learning rate.AR e c t iﬁed Linear Unit (ReLU) activation function expressed as fol-lowsf:z→max (z,0) was implemented in all the hidden layers' neu-rons. ReLU is a widely used activation function in machine/deeplearning models since it involves less computations compared to otherused functions such as sigmoid and tangent hyperbolic ( Apicella et al., 2021). Since the model has to output a vector of binary numbers, eachoutput neuron was implemented with a sigmoid activation functionthat produces activation values comprised between 0 and 1. Trainingwas performed for 250 epochs, using the Adam optimizer and a categor-ical cross-entropy cost function. Data was transferred to the optimizerthrough batches of 2048 samples. To track the model performance,the cost function and the accuracy were computed at the end of eachepoch on the training and validation sets using the following expres-sions respectively:J¼Xmi¼1Xnk¼1yklog^ykðÞwhereJis the cost function value,mis the number of elements in the training (or validation) dataset,nthe dimension of each elementX
i,byk
thek-th scalar value of the model prediction for the dataset element i andy
kthek-th scalar value of its corresponding label.Acc¼
tpþtntpþtnþfpþfnwhereAccis the accuracy value,tpandtnare respectively the numbers of true positives and negatives, and likewise, fpandfnare respectively the numbers of false positives and negatives in the training (or valida-tion) datasets.Model prototyping and training were performed within a Pythondevelopment environment using TensorFlow (version 2.5), an open-source framework for machine/deep learning applications. Computa-tions were carried out using the Google cloud solution Collaboratory,within a machine equipped with the following main components:•A CPU type Intel Xeon, with a frequency of 2.2 GHz;•A GPU type Tesla T4, having a memory of 16GB and 585 MHz clockspeed;•12GB of RAM.5. Results and discussion5.1. Data preparationThe data preparation phase yielded a labeled dataset ( Fig. 7)o f 42,571 records (rows). Theﬁnal machine learning-dataset comprised34,056 samples dedicated to train/cross-validate the models, and 8515samples left for further evaluation of the selected model.
Fig. 7.Snapshot from the prepared dataset.I. Ihoume, R. Tadili, N. Arbaoui et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 129 –137
1335.2. Model development5.2.1. Architecture designThe core deﬁning hyperparameters within the architecture of anMLP are the number of layers and neurons within each layer, especiallythe hidden ones. In this study, two groups of models have been con-structed: (1) Theﬁrst with one hidden layer where the number of neu-rons has been tuned between 1 and 9; (2) The second with two hiddenlayers where the number of neurons within each layer has also beentuned likewise. The total number of trainable parameters of eachgroup are presented respectively inTables 3 and 4. The architecture design phase aimed atﬁnding the model that will score the highest mean accuracy (averaged over the ﬁve-fold cross val- idation procedure) along with being the less complex i.e., with the min-imum number of parameters for a further implementation in amicrocontroller.Tables 3 and 4show how increasing the layers' numberand the contained neurons generate more parameters. For the case oftwo-layer MLPs, the modiﬁcations induced in the hidden layers operatesymmetrically. A tuple of parameters ( a,b), chosen respectively for layers 1 and 2, generates identical parameters as the inversed tuple(b,a).5.2.2. Multi-labelingAs shown inFig. 8, compared to a traditional labeling approach,multi-labeling enables a huge gain in terms of neurons within the out-put layer, which in turn, reduces the number of generated parametersby the layer substantially. For 5 climatic input variables (as it is thecase in our work), adopting a traditional labeling approach wouldhave resulted in MLPs with 31 neurons in the output layer. This numberwould have escalated quickly to 1024 neurons for 10 input variables.Based on this, we content that multi-labeling is a highly ef ﬁcient ap- proach for designing lightweight and scalable models within the ad-dressed thematic.5.2.3. Model training and validationFor theﬁrst and second model groups, the heatmaps in Figs. 9 and 10 illustrate respectively theﬁnal mean values of the cost, the validationcost, the accuracy and the validation accuracy during the training/ ﬁve- fold cross-validation procedure. For Fig. 9, the upper axis represents the number of neurons within the hidden layer. For Fig. 10, it represents the number within hidden layer 2, while the left axis contains the neu-rons' number per hidden layer 1.For both groups, the models' performance improves with the con-struction of more complex MLPs. More neurons yield generally betterperformance and vice versa. This observation is quite logical since hav-ing a more complex architecture enables to ﬁt more complex data pat- terns. On the other hand, trying toﬁt a very simple model to a complexdata distribution yields poor performance, since the trainable parameternumber is insufﬁcient. We will denote the model instances withingroup 1 bymodel(i)w h e r eiis the number of neurons within the hiddenlayer. For group 2, each instance will be denoted by model(i,j
) wherei andjare respectively the number of neurons per hidden layers 1 and 2.•For theﬁrst group of models, the highest validation accuracy value(0.94) was scored by models (8) and (9).•For the second group of models, the highest validation accuracy value(0.97) was scored by models (7,8) and (8,8).5.2.4. Model selection and further evaluationAmong the previously cited models, model (7,8) is the mostperformant model. This model was selected as the ﬁnal candidate. Fig. 11depicts its architecture;Figs. 12 and 13illustrate respectively
Fig. 8.Multi-labeling versus traditional labeling approach.
Fig. 9.Summary of the obtained (a) cost, (b) validation cost, (c) accuracy and(d) validation accuracy for theﬁrst group of models in function of the implemented neu- rons' number (upper horizontal axis within the hidden layer.Table 3Summary of the constructed model instances of the ﬁrst group (of one hidden layer) with the total trainable parameter number of each instance.Number of neurons per hidden layer 112345678916 27 38 49 60 71 82 93 104
Table 4Summary of the constructed model instances of the second group (with two hiddenlayers) with the total trainable parameter number of each instance.Number of neurons per hidden layer 21 2 3456789Number of neurons perhidden layer 1 1 1 8 2 5 3 23 94 65 36 06 77 42 2 5 3 3 4 14 95 76 57 38 18 93 3 2 4 1 5 05 96 87 78 69 5 1 0 44 3 9 4 9 5 96 97 98 99 9 1 0 9 1 1 95 46 57 68 79 90 101 112 123 1346 53 65 77 89 101 113 125 137 1497 60 73 86 99 112 125 138 151 1648 67 81 95 109 123 137 151 165 1799 74 89 104 119 134 149 164 179 194I. Ihoume, R. Tadili, N. Arbaoui et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 129 –137
134the evolution of its mean cost and accuracy along the training/cross-validation process. The mean loss converges to a value of 0.16 whilethe mean accuracy to 0.97. No generalization gap is observed betweenthe training and cross-validation curves which evolve tightly close toeach other. This conﬁrms that the model's learning has been performedwithin an optimal regime without underﬁtting nor overﬁtting the data. A further evaluation of model (7,8) on the test set yielded an accuracy of0.96. By featuring only 5 neurons in the output layer, the model has atotal number of 151 parameters. This number would have been 385 ifa traditional labeling approach has been adopted. The latter wouldhave required 31 output neurons to be implemented to handle theﬁve-action control strategies.6. Conclusion and recommendationsThis work focused on developing a tinyML-oriented solution for amachine learning-based autonomous greenhouse microclimate controlbased on multi-variate sensed data (5 variables). The MLP architecturehas been selected and various hyperparameters have beenexperimented while training 90 model instances. A robust ﬁve-fold training/cross-validation procedure on a balanced dataset was also car-ried out toﬁnd the optimal and best-performing model. From an evalu-ation metric-based perspective, multiple MLPs can ful ﬁll the task; however, from a tinyML perspective, only the model with the less pa-rameter number has to be kept for optimized computations andFig. 10.Summary of the obtained (a) cost, (b) validation cost, (c) accuracy and (d) validation accuracy for the second group of models in function of the implem ented neurons' number within hidden layer 2 (upper horizontal axis) and hidden layer 1 (left vertical axis).I. Ihoume, R. Tadili, N. Arbaoui et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 129 –137
135minimum inference time. The selected model (model (7,8)) scored amean accuracy of 97% on the validation sets, and 96% on our test set,with a number of 151 trainable parameters. Although the fact that theobtained model is a shallow neural network (which we consider as anadvantage thanks to the adopted tinyML approach), it still can be cate-gorized–from a broader deﬁnition perspective–under the deep learn- ingﬁeld. The used multi-labeling approach enabled a parameterreduction of 60%. Thanks to its lightness, the model also eliminates theneed for using any regularization technique to prevent over ﬁtting the data.While this study enabled to address multiple limitations of previousrelated works to the addressed thematic. There are several limitationsalong with future recommendations that we highlight:•Our work has been conducted on one type of plants i.e., strawberry.Hence, we suggest:o Conducting a review study of the various climatic variables thathave to be monitored and taken into consideration for an autono-mous greenhouse-based control of additional crop types.o Unifying model development for the microclimate greenhousecontrol of multiple crop types.•Although the obtained performance metric can be contended as satis-factory. We consider that it may be ameliorated further. Herein wesuggest: (1) A model centric avenue, which focuses on modifyingthe parameters and hyperparameters; or a (2) Data-centric avenuewhich focuses on collecting additional and more re ﬁned data.CRediT authorship contribution statementIlham Ihoume:Data curation, Formal analysis, Writing –original draft.Rachid Tadili:Supervision, Conceptualization, Methodology,Resources, Validation.Nora Arbaoui:Writing–review & editing. Mohamed Benchrifa:Writing–review & editing.Ahmed Idrissi: Writing–review & editing.Mohamed Daoudi:Writing–review & editing.Declaration of Competing InterestThe authors declare that they have no known competing ﬁnancial interests or personal relationships that could have appeared to in ﬂu- ence the work reported in this paper.ReferencesAlipio, M.I., et al., 2017.A smart hydroponics farming system using exact inference inBayesian network. IEEE 6th Global Conference on Consumer Electronics (GCCE).IEEE, Nagoya, pp. 1–5.Alwis, S.D., et al., 2022.A survey on smart farming data, applications and techniques.Comput. Ind. 138, 103624.Alzubaidi, L., et al., 2021.Review of deep learning: concepts, CNN architectures, chal-lenges, applications, future directions. J. Big Data 8 (1), 53.Angelopoulos, C.M., et al., 2020. Keeping data at the edge of smart irrigation networks: acase study in strawberry greenhouses. Comput. Netw. 167, 107039.Apicella, A., et al., 2021. A survey on modern trainable activation functions. Neural Netw.138, 14–32.https://doi.org/10.1016/j.neunet.2021.01.026 . Arias del Campo, F., et al., 2021. Auto-adaptive multilayer perceptron for univariate timeseries classiﬁcation. Expert Syst. Appl. 181, 115147.Azadi, H., et al., 2021.Rethinking resilient agriculture: from climate-smart agriculture tovulnerable-smart agriculture. J. Clean. Prod. 319, 128602.Azaza, M., et al., 2016. Smart greenhouse fuzzy logic based control system enhanced withwireless data monitoring. ISA Trans. 61, 297 –307.https://doi.org/10.1016/j.isatra. 2015.12.006.Cordovil, C.M., d. S., et al., 2020. Chapter 22 - climate-resilient and smart agricultural man-agement tools to cope with climate change-induced soil quality decline. In: Prasad,M.N.V., Pietrzykowski, M. (Eds.), Climate Change and Soil Interactions. Elsevier,pp. 613–662.Doshi, M., Varghese, A., 2022.Chapter 12 - Smart agriculture using renewable energy andAI-powered IoT. In: Abraham, A., et al. (Eds.), AI, Edge and IoT-based Smart Agricul-ture. Academic Press (Intelligent Data-Centric Systems), pp. 205 –225. Dutta, Dr.L., Bharali, S., 2021. TinyML Meets IoT: A Comprehensive Survey. Internet ofThings 16, 100461.https://doi.org/10.1016/j.iot.2021.100461 . Escamilla-García, A., et al., 2020. Applications of artiﬁcial neural networks in greenhouse technology and overview for smart agriculture development. Appl. Sci. 10 (11), 3835.Frankowiak, M., Grosvenor, R., Prickett, P., 2005. A review of the evolution ofmicrocontroller-based machine and process monitoring. International Journal of
Fig. 11.Architecture of theﬁnal selected model (model (7,8)).
Fig. 12.The evolution of the mean cost along training/cross-validation for model (7,8).
Fig. 13.The evolution of the mean accuracy along training/cross-validation for model(7,8).I. Ihoume, R. Tadili, N. Arbaoui et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 129 –137
136Machine Tools and Manufacture 45, 573 –582.https://doi.org/10.1016/j.ijmachtools. 2004.08.018.Han, H., Siebert, J., 2022.TinyML: A systematic review and synthesis of existing research.2022 International Conference on Arti ﬁcial Intelligence in Information and Commu- nication (ICAIIC), pp. 269 –274. Ihoume, I., et al., 2022. Performance study of a sustainable solar heating system based on acopper coil water to air heat exchanger for greenhouse heating. Sol. Energy 232,128–138.https://doi.org/10.1016/j.solener.2021.12.064 . Iizumi, T., Ramankutty, N., 2015. How do weather and climate inﬂuence cropping area and intensity? Glob. Food Secur. 4.Jamil, F., et al., 2022.Optimal smart contract for autonomous greenhouse environmentbased on IoT blockchain network in agriculture. Comput. Electron. Agric. 192,106573.Katzin, D., van Henten, E.J., van Mourik, S., 2022. Process-based greenhouse climate models: genealogy, current status, and future directions. Agric. Syst. 198, 103388.Kingma, D.P., Ba, J., 2017. Adam: a method for stochastic optimization. arXiv, 1412.69801412.6980 [cs] [preprint]. Available at: http://arxiv.org/abs/1412.6980 (Accessed: 31 March 2022).Lal, R., 2021. Climate change and agriculture. Climate Change. Elsevier, pp. 661 –686 https://doi.org/10.1016/B978-0-12-821575-3.00031-1 . Liao, R., et al., 2021.Development of smart irrigation systems based on real-time soilmoisture data in a greenhouse: proof of concept. Agric. Water Manag. 245, 106632.Liu, D., Mishra, A.K., Ray, D.K., 2020. Sensitivity of global major crop yields to climate var- iables: a non-parametric elasticity analysis. Sci. Total Environ. 748, 141431.Lopez-Ridaura, S., et al., 2021. Immediate impact of COVID-19 pandemic on farming sys-tems in Central America and Mexico. Agric. Syst. 192, 103178.Mani, V., Sankaranarayanan, S., 2017. IoT based smart energy management system. 12 (16), 8.Mehra, M., et al., 2018.IoT based hydroponics system using deep neural networks.Comput. Electron. Agric. 155, 473 –486. Pedrycz, W., Chen, S.-M. (Eds.), 2020. Deep Learning: Concepts and Architectures. Springer International Publishing (Studies in Computational Intelligence), Cham.Poudel, S., Shaw, R., 2016.The relationships between climate variability and crop yield ina mountainous environment: a case study in Lamjung District, Nepal. Climate 4 (1),13.Ray, P.P., 2022.A review on TinyML: state-of-the-art and prospects. J. King Saud Univ.Comp. Inform. Sci. 34 (4), 1595 –1623. Refaeilzadeh, P., Tang, L., Liu, H., 2009. Cross-validation. Encyclop. Database Syst. 532 –538, 532–538.Revathi, S., Sivakumaran, N., 2016. Fuzzy based temperature control of greenhouse. IFAC- PapersOnLine 49 (1), 549 –554. Sarker, I.H., 2021.Deep learning: a comprehensive overview on techniques, taxonomy,applications and research directions. SN Comp. Sci. 2 (6), 420.I. Ihoume, R. Tadili, N. Arbaoui et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 129 –137
137