Automatic fault instance segmentation based on mask propagationneural network
Ruoshui Zhou*, Yufei Cai**, Jingjing Zong, Xingmiao Yao, Fucai Yu, Guangmin Hu
University of Electronic Science and Technology of China, China
ARTICLE INFO
Keywords:Deep learningFault interpretationABSTRACT
Fault interpretation plays a critical role in understanding the crustal development and exploring the subsurfacereservoirs such as gas and oil. Recently, signi ﬁcant advances have been made towards fault semantic segmen- tation using deep learning. However, few studies employ deep learning in fault instance segmentation. Weintroduce mask propagation neural network for fault instance segmentation. Our study focuses on the descriptionof the differences and relationships between each fault pro ﬁle and the consistency of fault instance segmentations with adjacent proﬁles. Our method refers to the reference-guided mask propagation network, which is ﬁrstly used in video object segmentation: taking the seismic pro ﬁles as video frames while the seismic data volume as a video sequence along the inline direction we can achieve fault instance segmentation based on the mask propagationmethod. As a multi-level convolutional neural network, the mask propagation network receives a small number ofuser-deﬁned tags as the guidance and outputs the fault instance segmentation on 3D seismic data, which canfacilitate the fault reconstruction work ﬂow. Compared with the traditional deep learning method, the introduced mask propagation neural network can complete the fault instance segmentation work under the premise ofensuring the accuracy of fault detection.
1. IntroductionFault interpretation is a periodic work, which involves long-termiteration and repeated veriﬁcation. Since deep learning has beenproven superior at discovering complex structures in high-dimensionaldata (Krizhevsky et al., 2012), it has attracted widespread attentionfrom variousﬁelds in recent years, and it has achieved good results inimage classiﬁcation, target detection, semantic segmentation, etc. Forinstance, fault detection could be regarded as a semantic segmentationproblem where we classify each point in seismic data as ‘fault’or ‘non-fault’. Therefore, many studies have applied the deep learningmethod to tackle such problem (Guitton, 2018;Guo et al., 2018):Huang et al. (2017)uses a variety of seismic attributes as the input of con-volutional neural network (CNN) and builds a big data platform, whichpromotes the application of deep learning methods in geophysics; Xiong et al. (2018)uses seismic data slices in different directions as the input ofthe neural network which make full use of the continuity of the fault inthree-dimensional space;Wu et al. (2019)uses a large number of labeled synthetic data as the training set and introduce U-net network modelwhich greatly improves the effectiveness of fault detection. TheUnet-based fault detection is directly applied to the entire seismic volumedata and does not need to process each seismic voxel point separately.This way, it makes full use of the spatial characteristics of faults andgreatly reduces the calculation cost.Existing studies regard fault detection as a semantic segmentationwhich lacks the description of the relationship between faults and theestablishment of the spatial topological structure of fault model. In orderto further reduce the labor cost and improve the effectiveness of faultdetection, we introduce instance segmentation to solve problem.Compared with semantic segmentation, instance segmentation not onlyneeds to distinguish fault and non-fault, but also needs to classify andmark different faults speciﬁcally (fault 1, fault 2 and etc). We adopt theidea of video instance segmentation to deal with fault instance segmen-tation because each frame of video data has continuity in time, whileseismic data has continuity in space. Video object segmentation methodscan be divided into two types: propagation-based methods and detection-based methods. Propagation-based methods mainly leverage the tem-poral coherence of object motion. These methods rely on the spatio-temporal connections between pixels. The detection-based methods, onthe other hand, learn the appearance of target object from a given
* Corresponding author.** Corresponding author.E-mail address:13558649050@163.com(R. Zhou).
Contents lists available atScienceDirect
Artiﬁcial Intelligence in Geosciences
journal homepage:www.keaipublishing.com/en/journals/artiﬁcial-intelligence-in-geosciences
https://doi.org/10.1016/j.aiig.2020.12.001Received 7 August 2020; Received in revised form 5 November 2020; Accepted 5 December 2020Available online 3 February 20212666-5441/©2020 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co. Ltd. This is an open access article under the CC BY-NC-NDlicense (http://creativecommons.org/licenses/by-nc-nd/4.0/ ).Artiﬁcial Intelligence in Geosciences 1 (2020) 31 –35annotated frame, and perform a pixel-level detection of the target objectat each frame. The core idea of our method is to combine such two modesof fault segmentation based on both the reference pro ﬁle and the fault tracking from the previous proﬁle. In our work, we make a set of 3D faultinstance segmentation labels, based on the synthetic seismic datafollowing Wu (2019), as training data. We train the mask propagationneural network (Oh et al., 2018) in a step-by-step process iteratively. Wecomplete the fault instance segmentation in a user-de ﬁned range and show theﬁnal result of fault reconstruction. A multi-input, multi-levelencoding and decoding convolutional neural network is used to learn thedistribution and combination rules of fault between the adjacent pro ﬁle and the reference proﬁle to predict the target proﬁle, so as to realize thefault combination modeling of the whole seismic data. The referenceproﬁle is a pre-determined reference proﬁle with fault marks, while the adjacent proﬁle is the previous proﬁle with new fault marks transferreddown proﬁle by proﬁle. Compared with traditional deep learningmethods, such as CNN, we can not only identify faults and non-faults, butalso describe the relationships between faults. Such that we providevaluable information for a more effective fault interpretation.2. MethodThe core of our idea is to build an analogy between seismic volumeand video stream. We take the proﬁles of seismic volumes along the
Fig. 1.Label making of fault instance segmentation task.
Fig. 2.The structure of the mask propagation neural network model.R. Zhou et al. Artiﬁcial Intelligence in Geosciences 1 (2020) 31 –35
32inline direction as video frames and achieve the fault instance segmen-tation by the mask propagation method. The network achieving maskpropagation has two mainstreams: one is to exploit the appearance of thetarget faults in a given reference proﬁle called reference stream, and the other is to propagate the key proﬁles to roughly specify and locate thetarget faults of interest called the target stream. Then the mask propa-gation neural network learns the rules of distribution and the shape-shiftsamong reference proﬁle, previous proﬁle and target proﬁle, and to further complete fault instance segmentation in each pro ﬁle of the seismic volume data. Eventually, using the relationship between thefaults obtained by fault instance segmentation, fault reconstruction canbe completed more easily and quickly.3. Training dataWe need 3D seismic volume data with fault instance segmentationlabels to train deep learning model. A set of 3D fault instance segmen-tation labels are made from 3D 0 –1 fault labels using a semi-automaticpicking method, as shown inFig. 1. We manually pick the fault slicesin a large area and then classify the remaining unlabeled fault points viak-NearstNeighbor (KNN) method (Cover, 1967). In our method, the selected neighbor is the fault point that has been correctly classi ﬁed, and the classiﬁcation of the point to be classiﬁed is determined according to the category of the adjacent 10, fault points (k ¼10). According to the spatial distribution of fault points, the linear distance between twosampling points in space is selected as the measurement distance. Themeasuring distance is deﬁned as follows:After the labeling work, we have 3D fault instance segmentation la-bels, then we select 256 sets as the training dataset and 12 sets as the testdataset. Each set consists of a total of 32 pieces of continuous seismicproﬁles in total.4. Network structureIn this paper, we use a mask propagation neural network with anencoder-decoder structure, as shown in Fig. 2. The network has two input streams, including the reference stream and the target stream. Each inputconsists of one seismic proﬁle and one corresponding fault instancesegmentation mask.The model output one result to show the fault instance segmentationof target proﬁle. The reference stream consists of theﬁrst seismic proﬁleand its fault instance segmentation mask. The target stream consists ofthe current seismic proﬁle and the fault instance segmentation of theprevious proﬁle. Both share a multi-level encoder designed as ResNet50(He et al., 2016), and is contacted together through a global convolutionblock, which is used to match the features of fault instance segmentationbetween the reference stream and the target stream. To overcome thelimitation of convolution operation, two convolution layers of 1 /C2kþk /C21 and k/C21þ1/C2
k (e.g. k¼7) are set in a global convolution block.The two convolution layers are added to be the input of a residualconvolution block.The decoder layer is composed of numbers of decoding blocks and ismatched with the encoder layer. The decoding block operates with skipconnections of the encoding block and up-sampling. Finally, the faultinstance segmentation mask of the target pro ﬁle is obtained as output through a convolution layer and a softmax layer.Our method relies on two kinds of knowledge, as suggested by thestructure of the mask propagation convolutional neural network: one isthe human knowledge that is the fault instance segmentation labelspicked manually, the other is the machine knowledge that is the propa-gation rules learned from mask propagation neural network. The twokinds of knowledge restrain and support each other to achieve the semi-supervised fault instance segmentation in 3D seismic data.5. Training stepIn our work, the mask propagation neural network is trained in a step-by-step process iteratively, as shown in Fig. 3. If theﬁrst seismic proﬁle is considered as the reference proﬁle, training starts with the second pro-ﬁle, which is chosen as the target proﬁle. The training step needs N-1 times in total (N is the number of proﬁles).For example, if we select the pth proﬁle as the reference proﬁle and the tth proﬁle as the target proﬁle, the whole training step indicates asfollows: in the current training step, the reference stream always keepsthe pth proﬁle and the pth fault instance segmentation mask. The targetstream is comprised of the tth seismic proﬁle and the (t-1)
thfault instance segmentation mask. The mask propagation neural network receives thetwo input streams and outputs the fault instance segmentation mask ofthe tth seismic proﬁle. Then we propagate it through the network as theprevious fault instance segmentation mask in the target stream. In thisway, 32 pieces of adjacent proﬁles are iteratively processed as one dataset. We have trained 256 data sets for 100 epochs.
Fig. 3.The step-by-step training process for falt instance segmentation in this study.R. Zhou et al. Artiﬁcial Intelligence in Geosciences 1 (2020) 31 –35
336. Inference stepThe inference step needs a range of proﬁles in a data set that is user- deﬁned rather deﬁnite. We divide a 3D seismic volume into several datasets, as shown inFig. 4.Each set would go through the mask propagation neural network as atest sample and it will be recombined together to achieve fault instancesegmentation in 3D seismic data. For the prediction of multiple faultinstance segmentations, a simple way is to run each fault independentlyand to label the pixel with the largest output probability of fault instancesegmentation. We take softmax aggregation as the loss function thatcombines multi-instance probabilities softly. It assumes that probabilitiesof positive samples and negative samples sum to 1. We calculate faultinstance segmentation mask using the equation below and pass it as theinput of the next proﬁle.p
i;m¼σðlogitðbpi;mÞÞ ¼bpi;m/C30ð1/C0bp
i;mÞP
Mj¼0bpi;j/C30ð1/C0bp
i;jÞwhere
σand logit represent the softmax and logit functions, respectively,P
i;mis the network output probability of the instance m at the pixellocation i.(m¼0 indicates the background), and M is the number ofinstances.The inference step is similar to the traditional fault interpretation inworkﬂow. It starts with labeled fault instances of the interested pro ﬁle and creates subsequent fault instances in a user-de ﬁned range likeFig. 4. If there are some fault misclassiﬁcations in proﬁle M. We can relabel proﬁle M and regard it as theﬁrst reference proﬁle. Then the inference step starts over with proﬁle M. The instance segmentation results canclassify fault points into different instances from a range of pro ﬁles. Then we easily and quickly reconstruct fault surfaces based on fault instancesegmentations, as shown inFig. 5.7. ResultWe evaluate our method on two chosen sets (set A and B) from asynthetic seismic volume, whose size is 128*128*32. Each fault instancesegmentation mask has been labeled in theﬁrst proﬁle. We show the fault instance segmentation result of the 1st, 9th, 17th, 25th pro ﬁles inFig. 6. Set A contains four non-intersecting fault instances, which have thesimilar fault dip and strike. We can see blue fault instance fade away asinline direction goes on. Some fault instances of set B are intersected. Themagenta fault instance and the blue fault instance belong to one instancesegmentation of faults, but two different branches in the shape of “Y”. Our method can sculpture the details of the fault edge between fore-ground (fault) and background (non-fault) in fault detection, also detectvarious fault instance segmentations in one pro ﬁle while keeping the shape of fault instance segmentations both in the crossed and isolated
Fig. 4.Preprocessing of data set to be predicted in the inference step.
Fig. 5.Reconstruction results of fault surface. (a): Reconstruction result of set A. (b): Reconstruction result of set B. (c): Reconstruction result of set C.R. Zhou et al. Artiﬁcial Intelligence in Geosciences 1 (2020) 31 –35
34areas.8. ConclusionMost fault interpretation methods based on deep learning focus onfault detection. We study fault instance segmentation on 3D seismic databased on deep learning on theﬁrst try. Our method takes the 3D seismicdata as a sequence of proﬁles, which is similar to the form of videoframes. The mask propagation neural network is designed to learn thepropagation of fault instance segmentations in pro ﬁles along the inline direction. We demonstrate the results of fault instance segmentation inseismic proﬁles and show fault reconstruction based on work mentionedabove: the fault instance segmentation and the reconstruction of faultsurfaces are carried out on several groups of validation data sets. Thevalidation samples include independent fault examples and cross faultexamples. The experimental results show that the front and back scenesof fault and non-fault are separated clearly. Further, the separation ofmultiple examples of fault is complete and clear, which veri ﬁes the effectiveness of our method. Fault instance segmentation further im-proves the efﬁciency of fault intelligent interpretation, so it has highpractical value and research signiﬁcance. Compared with fault detectionbased on other deep learning method such as CNN, our method can notonly identify faults, but also characterize the relationship between faults.In future research, we hope to add continuity constraint to the fault andto solve the problem of discontinuity of fault line when the fault is faraway from the reference proﬁle.Declaration of competing interestWe declare that we do not have any commercial or associativeinterest that represents a conﬂict of interest in connection with the worksubmitted.AcknowledgmentThis work is supported by Natural Science Foundation of China(U1562218 and 41974147) and the authors would like to thank X. M. Wufor his public seismic synthetic data set.References
Cover, T., et al., 1967. Nearest neighbor pattern classi ﬁcation. IEEE transactions on information theory.Guitton, A., 2018. 3D convolutional neural networks for fault interpretation. 80th EAGEConference and Exhibition 2018 . Guo, B., Lu, L., Liu, Y., 2018. Automatic Seismic Fault Detection with ConvolutionalNeural network[C]. International Geophysical Conference, Beijing, China . He, K.M., Zhang, X., Ren, S., et al., 2016. Deep Residual Learning for Image Recognition[C]. IEEE Conference on Computer Vision &Pattern Recognition. IEEE Computer Society.Huang, L., Dong, X., Clee, T.E., 2017. A scalable deep learning platform for identifyinggeologic features from seismic attributes[J]. Lead. Edge 36 (3), 249 –256. Krizhevsky, A., Sutskever, I., Hinton, G.E., 2012. Imagenet Classi ﬁcation with Deep Convolutional Neural networks[C]//Advances in Neural Information ProcessingSystems, pp. 1097–1105.Oh, S.W., Lee, J.Y., Sunkavalli, K., et al., 2018. Fast Video Object Segmentation byReference-Guided Mask Propagation[C]. IEEE CVF Conference on Computer Vision & Pattern Recognition. IEEE. Wu, X.M., Liang, L.M., Shi, Y.Z., et al., 2019. FaultSeg3D: using synthetic datasets to trainan end-to-end convolutional neural network for 3D seismic fault segmentation[J].Geophysics.Xiong, W., Ji, X., Ma, Y., Wang, Y.X., et al., 2018. Seismic fault detection withconvolutional neural network[J]. Geophysics 83 (5), 97 –103.
Fig. 6.Segmentation results of set A, set B and set C. (a): Seismic images. (b): Fault semantic segmentation results based on CNN. (c) Results of fault instanc e segmentation.R. Zhou et al. Artiﬁcial Intelligence in Geosciences 1 (2020) 31 –35
35