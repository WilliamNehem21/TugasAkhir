Prediction of exchangeable potassium in soil through mid-infraredspectroscopy and deep learning: From prediction to explainability
Franck Albineta,b,⁎,Y iP e n gc, Tetsuya Eguchid,b, Erik Smolderse, Gerd Derconb
aIndependent Researcher & Consultant, Guéthary, France
bSoil and Water Management & Crop Nutrition Laboratory, Joint FAO/IAEA Centre of Nuclear Techniques in Food and Agriculture, Seibersdorf, Austria
cGlobal Soil Partnership, Food and Agriculture Organization of the United Nations, Viale delle Terme di Caracalla, 00153 Rome, Italy
dAgricultural Radiation Research Center, Tohoku Agricultural Research Center, National Agriculture and Food Research Organization, Fukushima, J apan
eSoil and Water Management Unit, KU Leuven, Belgium
abstract article info
Article history:Received 4 July 2022Received in revised form 13 September 2022Accepted 13 October 2022Available online 18 October 2022The ability to characterize rapidly and repeatedly exchangeable potassium (K ex) content in the soil is essential for optimizing remediation of radiocaesium contamination in agriculture. In this paper, we show how this can benow achieved using a Convolutional Neural Network (CNN) model trained on a large Mid-Infrared (MIR) soilspectral library (40,000 samples with K
exdetermined with 1 M NH 4OAc, pH 7), compiled by the National Soil Survey Center of the United States Department of Agriculture. Using Partial Least Squares Regression as a base-line, we found that our implemented CNN leads to a signi ﬁcantly higher prediction performance of K
exwhen a large amount of data is available (10000), increasing the coef ﬁcient of determination from 0.64 to 0.79, and reducing the Mean Absolute Percentage Error from 135% to 31%. Furthermore, in order to provide end-userswith required interpretive keys, we implemented the GradientShap algorithm to identify the spectral regionsconsidered important by the model for predicting K
ex. Used in the context of the implemented CNN on various Soil Taxonomy Orders, it allowed (i) to relate the important spectral features to domain knowledge and (ii) todemonstrate that including all Soil Taxonomy Orders in CNN-based modeling is bene ﬁcial as spectral features learned can be reused across different, sometimes underrepresented orders.© 2021 The Authors. Publishing servic es by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is an openaccess article under the CC BY-NC-ND license ( http://creativecommons.org/licenses/by-nc-nd/4.0/ ).Keywords:High-throughput soil characterizationMachine learningConvolutional neural networkAgricultureNuclear emergency responseRemediationInterpretability
1. IntroductionRemediation of radioactive contamination of farmland requires ac-curate soil data. In case of nuclear emergencies affecting food and agri-culture, exchangeable potassium (K
ex) plays a major role. As potassiumcompetes with radiocaesium in soil-to-plant transfer, it can help reducethe crop uptake of this major fallout radionuclide. Information on potas-sium content in the soil is essential for optimizing remediation of radio-active contamination as happened in 1986 in Chernobyl or in 2011 inFukushima (Komatsu et al., 2017).The ability to characterize K
ex
rapidly and repeatedly will inform and facilitate decision making, andsigniﬁcantly reduce the cost of analyses needed for remediation overthe years.Traditional methods for characterizing soil properties, such as K
ex, through wet chemistry can provide high accuracy and precision, but itis often cost and time prohibitive (Viscarra Rossel et al., 2006). Forseveral decades, soil scientists have been successfully using visible,near and mid-infrared spectroscopy techniques to estimate a widerange of soil physical, chemical, and biological properties ( Viscarra Rossel et al., 2006;Frost et al., 2007;Shepherd and Walsh, 2007; Bellon-Maurel et al., 2010;Grinand et al., 2012;Peng et al., 2014; Torres Astorga et al., 2018;Dangal et al., 2019;Ng et al., 2022). MIRS is often more accurate and produces more robust calibrations thannear-infrared reﬂectance spectroscopy (NIRS) when analyzing ground,dry soils (Viscarra Rossel et al., 2006;Ng et al., 2019b). However, models developed to estimate soil characteristics are often limited in scope, asonly small and region-speciﬁc MIR spectral libraries of soils are available(Viscarra Rossel et al., 2008;de Sousa Mendes et al., 2022). The lack of standardization of wet chemistry methodologies ( Viscarra Rossel and Bouma, 2016) coupled with situations of low data availability, or so-called low data regimes, also have long caused calibration modelsoverﬁtting small and often noisy datasets (Torres Astorga et al., 2018). To avoid such overﬁtting often involves careful data pre-processingand dimensionality reduction (Viscarra Rossel et al., 2022), which are all pervading themes in MIRS soil data processing and statistical learn-ing in general (Hastie et al., 2009).Artiﬁcial Intelligence in Agriculture 6 (2022) 230 –241
⁎Corresponding author at: Independent Researcher & Consultant, Guéthary, France.E-mail address:franckalbinet@gmail.com(F. Albinet).
https://doi.org/10.1016/j.aiia.2022.10.0012589-7217/© 2021 The Authors. Publishing services by Elsevier B.V. on behalf of KeAi Communications Co., Ltd. This is an open access article under the CC BY-NC-ND license (http:// creativecommons.org/licenses/by-nc-nd/4.0/ ).
Contents lists available atScienceDirect
Artiﬁcial Intelligence in Agriculture
journal homepage:http://www.keaipublishing.com/en/journals/artificial-intelligence-in-agriculture/The situation of data scarcity is, however, changing rapidly todaywith the availability of large, and growing, high-quality and lessregion-speciﬁc libraries of MIR-scanned soil samples. A strong exampleis the spectral library maintained by the National Soil Survey Center(NSSC) Kellogg Soil Survey Laboratory (KSSL) from the United StatesDepartment of Agriculture (USDA-NRCS), which is available to theglobal scientiﬁc community.The unprecedented volume and diversity of data now available,often released in accordance with open data policies, allows soil scienceresearchers to increasingly shift their focus from traditional modelingtechniques such as Partial Least Squares Regression (PLSR) to classesof Machine Learning (ML) models of higher complexity, such asConvolutional Neural Networks (CNN).CNN is a class of deep neural networks commonly applied to datathat has a grid-like topology, such as images, audio or time series. A no-table characteristic of deep neural networks is their ability to learn anddetect patterns in a hierarchical way. For instance, in the context ofimage recognition tasks, it has been shown that the ﬁrst convolutional layers learn low-level features such as diagonal, horizontal and verticaledges while further layers learn higher-semantic components such ascorners, circles or even complex images ( Zeiler and Fergus, 2013). Harnessed recently in Mid-infrared soil spectroscopy, CNN has provedto be capable to learn, hence automate, spectra preprocessing stepsand to relate complex absorption peak patterns to the presence of soilproperties to be characterized and predicted ( Ng et al., 2019b). The performance gain of CNN compared to PLSR may not be signi ﬁ- cant for some parameters that are easy to predict such as soil organiccarbon or calcium carbonate. However, recent studies showed that,under a large data regime, Convolutional Neural Networks (CNN) out-perform PLSR on most soil property predictions ( Wijewardane et al., 2018;Ng et al., 2019b;Shen and Viscarra Rossel, 2021;Shen et al., 2022;Ng et al., 2022). Further, performance of property predictionthrough PSLR can be often very low for some certain soil parameters(Ng et al., 2019b;Wijewardane et al., 2018), in particular when the re- lationship between the spectra and these properties is non-linear asfor instance for K
ex. This inferior performance is known to be relatedto the fact that this soil property has no direct or strong spectralfeatures to support the calibration model and is only inferred inrelation to other spectrally active soil components ( Janik and Skjemstad, 1995;Sanderman et al., 2020).However, if such a relationship exists and can be learned, it is neces-sary to have classes of models such as CNN capable of (i) extracting in-depth information from the spectra for better calibration purposes and(ii) exploiting a large and diverse spectral library. To the best of ourknowledge, the estimation of K
exat a level of performance sufﬁcient for nuclear remediation using a large MIR spectral library and a CNNalgorithm has never been tested until KSSL database has been madeavailable to the public recently.Moreover, when intended to be used to derive new scienti ﬁc insights, inform decision-making and policies during large-scale crisisresponses, machine learning algorithms not only need to demonstrateenough predictive power, but must also equip end-users with interpre-tive keys allowing to understand on which basis, on which features(spectral regions) of the input data these predictions are made.In theory, based on vibrational spectroscopy principles, and undercontrolled conditions with deﬁned mixtures of soil constituents, charac-teristic infrared electromagnetic radiation absorption patterns can beattributed to functional groups and chemical bonds ( Socrates, 2004). In practice, this is more challenging based on the measurement condi-tions and when analyzing soil constituents like K
exthat are in lower concentrations and only being observed by correlation with otherspectrally active major soil components ( Sanderman et al., 2020). Yet, the interpretation and the ability to assign spectral features tofundamental vibrations of speciﬁc soil properties is key (i) to developmore parsimonious models through the selection of speci ﬁc wavenumbers, known as important, during the preprocessing, featureextraction and modeling phases (Viscarra Rossel and Lark, 2009; Mehmood et al., 2012;Ng et al., 2019a), (ii) to better understand model output, and provide insight into how these models can befurther improved (Viscarra Rossel and Behrens, 2010 ), (iii) to potentially shed new lights on the current state of knowledge of thesoil processes being modeled (Lundberg and Lee, 2017)a n d( i v )t o foster end-users trust and facilitate adoption of machine learning-based technologies (Molnar et al., 2020).So far, methods used to interpret the contribution of each inputfeature (i.e., the absorption of electromagnetic radiation at a particularwavenumber) to a model output are either model speci ﬁc (Terhoeven-Urselmans et al., 2010;Viscarra Rossel et al., 2016; Clairotte et al., 2016;Wijewardane et al., 2018;Landre et al., 2018; Gomez et al., 2020) or have a high computational cost ( Ng et al., 2019b). In addition, those methods average features' importance overall predictions whereas importance for individual or a group of predic-tions, for instance by Soil Taxonomy Order, is of crucial importance forboth model developers and radiological environmental remediationdomain experts (Molnar et al., 2020).In this publication, ourﬁrst hypothesis is that the ability to character-ize Kexin soil at a sufﬁcient level of performance for remediation isconditioned by the availability of a large amount of data and the use ofhigh capacity model classes such as CNN. Our second hypothesis is thatCNN-based soil property prediction beneﬁts from merging MIRS informa- tion from a wide range of soil types (Soil Taxonomy Orders), even whendata are not equally distributed across all orders. By merging, soil orders with a low amount of data in the KSSL dataset also bene ﬁt from the CNN leaning process, reusing, when possible, spectral features learnedon well represented soil orders. Such a feature would provide a major op-portunity to address the lack of data on the fate of radionuclides in poorlyexplored environments such as arid, tropical and monsoonal climates.Therefore, in this study, ourﬁrst aim is to assess the ability of CNNmodels to predict K
exin soil when trained on a large MIRS spectral li-brary with a sufﬁcient level of accuracy for the remediation of radioac-tive contamination of agricultural land. To articulate the role of thedata regime and model capacity in this analysis, PLSR is used as a base-line. Our second aim is to investigate, through the analysis of model'sperformance across Soil Taxonomy Orders, how domain experts can ex-ploit CNN interpretability algorithms to gain new insights into the soilprocesses being modeled and build conﬁdence in the decision-making process during nuclear remediation.2. Materials and methods2.1. Modeling pipeline overviewTable 1summarizes the entire data pre-processing, analysis andmodeling pipeline developed in this study, and highlights in particularthe differences between PLSR and CNN models. The following sectionsprovide full details of each individual task.To ensure reproducibility, the source code of the modeling pipelineand data to replicate this work are available at the following link:https://fr.anckalbi.net/mirzai.Python version 3.6, NumPy (https://numpy.org), Scikit-Learn (https:// scikit-learn.org)a n dP y T o r c h(https://pytorch.org)h a v eb e e nu s e df o rt h e data pre-processing, analysis and modeling parts as well as Captum(https://captum.ai/) to address the interpretability needs. A Google ColabPro computing environment has been used with the following speci ﬁca- tion: 1 GPU Tesla P100 16GB, 2 Intel(R) Xeon(R) CPU @ 2.30GHz coresand 26GB RAM. This democratized access to the suf ﬁcient computational resources is also a key ingredient of reproducibility research.2.2. Data selection, preprocessingThe ability to predict and characterize K
exis key to optimize the remediation of radioactive contamination in agriculture. For thisF. Albinet, Y. Peng, T. Eguchi et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 230 –241
231study, we focused on a selection of the Mid-Infrared Spectral databasemade available to the Joint FAO/IAEA Centre of Nuclear Techniques inFood and Agriculture by the Kellogg Soil Survey Laboratory (KSSL)from the United States Department of Agriculture (USDA-NRCS). TheMid-Infrared spectra were acquired on air-dried and ground soil sam-ples using a Bruker Vertex 70 FTIR spectrometer with an HTS-XT high-throughput accessory (Dangal et al., 2019). In total 50,494 samples were identiﬁed and selected from the dataset, on which K
exwas measured (as of January 2022). The mid-infrared spectra (fromwavenumbers 4000 to 600 cm
−1at resolution of 2–1764 wavenumbers in total) were systematically centered and normalized, for both thebaseline (PLSR) and CNN models, using the Standard Normal Variatetransform (SNV) (Barnes et al., 1989). When used to train the baselinemodel, a Savitsky-Golay transformation (window length of 11, polyno-mial order of 1 andﬁrst derivative) was further applied and the CO
2
spectral region was removed to avoid in ﬂuence from this artifact independent from the soil analysis (from wavenumbers 2269 to 2389cm
−1). The CNN will safely ignore the CO 2spectral region and learn theﬁrst derivative (ﬁnite difference) operator if it is deemednecessary to K
exprediction, hence, both pre-treatments were notapplied in that case.In the dataset involved in this study, K
excontent in the soil has been measured using the NH
4OAc pH 7 extraction method (in cmol(+).kg
−1).Table 2provides the summary statistics of the empiricaldistribution of these measurements and their log
10-transformation before any data selection (50,494 measurements in total).Figure 1shows both the number of samples and the distribution ofK
exconcentration by Soil Taxonomy Orders ( Baillie, 2001) before any selection. We observe that certain soil orders are largely under-represented although their inclusion in the majority “Undeﬁned”class remains theoretically possible. However, the relative distribution ofthe deﬁned soil orders, from Mollisols to Oxisols, is representative ofsoil types present in the geographical area covered by the KSSL dataset(United States mainly) (Dangal et al., 2019).The method detection limit (MDL) for Kexcontent (target variable), through the NH
4OAc pH 7 extraction method, used for the KSSL data-base, is 0.06 cmol(+).kg
−1while its Practical Detection Limit (PDL) is0.30 cmol(+).kg
−1(5 times of MDL), set higher than the PDL in purechemistry (approximately 3.3 times of MDL) because of more complexmatrices in soil extracts (Klesta and Bartz, 1996). However, the appro- priate K
excontent to ensure radiocaesium concentration of 99% ofbrown rice below the target level was 0.14 cmol(+).kg
−1in Fukushima area. To include this appropriate K
excontent (0.14 cmol (+).kg
−1), the detection limit used in this study is closer to the MDLand a threshold of 0.12 cmol(+).kg
−1was applied, i.e. two times the MDL. About 20% of data had values below that threshold and the re-maining 80% of the data, i.e. 40,132 samples, was log
10-transformed to avoid weighting the loss functions accounting for the heteroscedasticityof the prediction residuals otherwise.2.3. Modeling2.3.1. Evaluation schemeFor all experiments conducted in this study, the data were randomlysplit in the following proportions: 80% for training, 10% for validationand 10% for testing. To optimize model hyperparameters, an “early stop- ping“technique was used. The number of components or epochs for thePLSR and CNN model respectively was increased so long as the loss onvalidation continued to decrease. When the loss either leveled off or in-creased during three consecutives increases of the hyperparameters,the training was stopped. Models were then trained, validated andtested on 20 different versions (random seeds) of this splitting scheme(i) to assess their robustness and (ii) to mitigate the effect of relativelysmall sample sizes for certain Soil Taxonomy Orders such as Oxisols,Vertisols, Gelisols and Histosols. For each of these different 20 randomsplits, both models were exposed to the same train, validation and test(unseen) data. The mean performance as well as their standard devia-tion were reported.Table 1Overview of K
excharacterization pipeline using Mid-infrared spectroscopy, and Partial Least Squares and Convolutional Neural Network models: from data selecti on, pre-processing, analysis, models validation and optimization to interpretability
a.Phase Task ModelsPLSR CNNI. Data Selection K
ex> 0.12 in cmol(+).kg−1and all soil ordersPreprocessingSpectra SNVSavitzky-GolayCO
2region removalK
ex Log 10transformationII. Modeling Evaluation scheme Train (80%), Validation (10%) and Test (10%) random splits repeated 20 timesMetrics R
2, LCCC, RMSE, MAPE, BiasHyperparameters Number of components Number of epochsRegularization Early stoppingDropoutIII. Interpretability GradientShap
aWith PLSR: Partial Least Squares Regression; CNN: Convolutional Neural Network; SNV: Standard Normal Variate; R2:c o e fﬁcient of determination; LCCC: Lin's concordance correlation coefﬁcient; RMSE: Root Mean Square Error; Bias: Mean Error and MAPE: Mean Absolute Percentage Error.
Table 2Summary statistics of measured K
exin cmol(+).kg-1. Q1, Q2 and Q3 are respectively the First, Second (Median) and Third quartiles.Min Max Mean Standard DeviationQuartiles Skewness KurtosisQ1 Q2 Q3K
ex 0 32.33 0.66 1.06 0.15 0.36 0.74 7.1 103log
10(Kex)a−2.34 1.51−0.43 0.49−0.75−0.42−0.11−0.1 0.02
aFor K exvalues >0 only.F. Albinet, Y. Peng, T. Eguchi et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 230 –241
232To assess the ability of the PLSR and CNN models to leverage an in-creasing data regime, PLSR and CNN models were also trained on ran-dom subsamples of increasing sizes of the data and their performanceon the test sets portrayed through the so-called “Learning curve” graph (Viering and Loog, 2021).The assessment of the models was further performed in two differ-ent contexts that we call in this study “global”and“local”.I nt h eg l o b a l setting, the models were trained on all data and performance wasassessed on the entire test set and by Soil Taxonomy Orders. To providefurther insights into the CNN training process, the validation loss by SoilTaxonomy Orders was also monitored as the number of epochs in-creased during training. In the local setting, the models were trainedby Soil Taxonomy Orders separately, and tested on the Soil TaxonomyOrders they were trained on. Only performance on Mollisols, Vertisolsand Gelisols are reported (i) to highlight the role of distinctive data re-gimes (from high to low), and (ii) to assess the ability of the CNN modelto“re-use”or transfer spectral features learned across different Soil Tax-onomy Orders, in particularly between well and non-represented onesin the MIRS KSSL dataset.2.3.2. MetricsTo evaluate both the PSLR and the CNN models on training, valida-tion and test datasets, the following metrics were used: (i) coef ﬁcient of determination (R
2) and (ii) Lin's concordance correlation coef ﬁcient (LCCC). LCCC measures the linear correlation between the predictedand true values but penalized by a bias term allowing to assess theagreement between the observed and predicted values with respect tothe 1:1 line (Lawrence and Lin, 1989). These two metrics were calcu-lated on the log
10-transformed version of the true and predicted valuesof K
ex. In addition, the Root Mean Square Error (RMSE), Mean AbsolutePercentage Error (MAPE) were calculated on the original scale of thetarget variable to facilitate interpretation and provide twocomplementary perspectives on the performance of the models.Indeed, given the skewed empirical distribution of the target variable,RMSE and MAPE tend to overweight errors made respectively forlarge and small K
exvalues. Bias was also calculated on the originalscale and reported.The equations of the above-mentioned metrics are explained below:R
2¼1/C0∑mi¼1yi/C0byi/C0/C12
∑mi¼1yi/C0yðÞ2ð1ÞLCCC¼2rσbyσy
σ2yþσ2
byþy/C0by/C16/C17 ð2ÞRMSE¼ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ
1m∑mi¼1yi/C0byi/C0/C12s ð3ÞMAPE¼
100m∑mi¼1yi/C0byi
yi/C12/C12/C12/C12/C12/C12/C12/C12 ð4ÞBias¼
1m∑mi¼1yi/C0byi/C0/C1 ð5Þwheremis the number of instances;ithe index of an individual instance;ythe observed value;bythe predicted one;
ythe mean of the observed value;
bythe mean of the predicted value;rthe Pearson's cor- relation coefﬁcient between the observed versus predicted values; σ
y
the standard deviation of observed values and σbythe standard deviation of predicted ones.2.3.3. Architecture of convolutional neural network modelsPLSR was used as a baseline in this study, to highlight its behavior inincreasing data regimes.The design of our CNN was inspired by the VGG16 architecture(Simonyan and Zisserman, 2014) stacking uniform convolution-pooling layers with small kernel sizes (i) to promote automatic extrac-tion of hierarchical features, (ii) to control the growth in the number oflearned parameters and (iii) to dispose of suf ﬁcient model capacity to predict K
exin large data regime.Fig. 2provides an overview of the architecture of our ConvolutionalNeural Network consisting of two main components:•A features learner composed of stacked blocks, each consisting of aconvolutional, batch normalization, non-linear activation and averagepooling layers, with each consecutive block seeing its depth (numberofﬁlters) doubled (up to 512 in the last block).•A task learner that (i)ﬂattens the learnt features maps, (ii) performsdimensionality reduction ofﬁnal features into a 20-dimensional latentspace using a fully connected layer andﬁnally (iii) applies a non-linear activation and a single neuron linear layers (with no further activationfunction) predicting the soil property of interest. A Dropout and BatchNormalization layers were also added.
Fig. 1.(a) Number of samples per Soil Taxonomy Orders (note that most of them are “Undeﬁned”)( b )B o x p l o to fK ex. The box extends from theﬁrst to third quartile values of the data, with a line at the median. The whiskers extend from the box to show the range of the data. Flier points (red) are those past the end of the whiskers. No data selec tion is applied. (For interpretation of the references to colour in this ﬁgure legend, the reader is referred to the web version of this article.)F. Albinet, Y. Peng, T. Eguchi et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 230 –241
233The model used in our study has 162,401 trainable parameters intotal and was regularized using early stopping (after 3 epochs withoutvalidation loss decrease) to guarantee its generalization property andprevent overﬁtting.W h i l ew er e l i e do ns e n s i b l ed e f a u l t sw i t hr e g a r d st ot h en e t w o r ka r c h i -tecture and did not perform extensive hyperparameters tuning, we usedcyclic learning rates (Smith, 2017).The motivation behind cyclic learningrates is that, by alternatively decreasing and increasing the learning rate,we give to the optimizer the opportunity to explore, visit multiple localminima of the loss function and hopefully prevent the optimizer from get-t i n gt r a p p e di nal o c a lm i n i m u m .I nthis study, we use an Adam optimizer(Kingma and Ba, 2014) with cyclic learning rates between 3 × 10
−5and 1×1 0
−3. A Mean Squared Error loss was used to optimize the CNN andthe determination of the min and max learning rates was decided basedon the structure of the loss over 8 learning epochs ( Smith, 2017).2.4. InterpretabilityIn this study, we implemented the GradientShap ( Lundberg and Lee, 2017;Sundararajan et al., 2017;Smilkov et al., 2017;Kokhlikyan et al., 2020) model interpretability algorithms to identify the spectral featuresregarded as important by the learning algorithm for the prediction taskbeing performed. The importance of spectral features can be computedmodel-wide or for an individual or group of instances with marginal ad-ditional computational burden. In our effort to relate this information todomain knowledge, feature importance was calculated for the overallCNN models based on (i) the full dataset, used in this study, and (ii)the Soil Taxonomy Orders separately. The correlation of theGradientShap values of the spectral features for predicting K
excontent by Soil Taxonomy Orders was also assessed, allowing understandingtheir similarities. This information on correlation does allow not onlyincreasing interpretability but also helps to understand how thelearned spectral features are reused across soil orders.The GradientShap algorithm takes the gradients of model outputwith respect to the input features as it could be done in a linear regres-sion setting. However, the non-linear behavior of CNN models intro-duces masking effects (Shrikumar et al., 2019)m a k i n gs u c ha n approach less suitable. Instead, to remedy this possible lack of sensitiv-ity, the GradientShap algorithm was integrated in our study with thegradient along the path between several baselines (in our study, 100spectra randomly sampled from the training set), so allowing to betterapproximate the calculation of the SHAP (SHapley Additive exPlana-tions) (Lundberg and Lee, 2017) value.3. Results3.1. Exchangeable potassium prediction models in a growing data regimeThe learning curves and model performance of both PLSR and CNNmodels for the prediction of exchangeable potassium (log10(Kex)), with increasing number of training examples and using all SoilTaxonomy Orders, are shown inFig. 3.Up to a dataset of 5000 samples, both PLSR and CNN models performpoorly with an R
2below 0.65 and a high level of variance across differ-ent random splits. However, a data regime of 10,000 samples appears tobe an inﬂection point. While the PLSR model levels off at approximatelyan R
2of 0.64, the performance of the CNN keeps increasing up to an R2of about 0.79 as the size of the dataset increases.3.2. Exchangeable potassium prediction model training and evaluation3.2.1. Global settingIn this setup, the PLSR and CNN models were trained on all data andperformance was assessed on the entire test set and by Soil Taxonomy
Fig. 2.Convolutional Neural Network architecture used in this study composed of (i) 5 stacked Convolutional-Pooling blocks with constant and small kernel size and increasing depth (feature learner) and (ii) a task learner.
Fig. 3.Learning curves of PLSR and CNN models trained to predict K exin a growing data regime using all Soil Taxonomy Orders. The mean and the standard deviation of thecoefﬁcient of determination R
2calculated on 20 different test splits as the size of the dataset increases are reported.F. Albinet, Y. Peng, T. Eguchi et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 230 –241
234Orders.Table 3. reports their mean and standard deviation perfor-mances on the test set. We recall that the models were trained, vali-dated and tested on 20 different random train, validation and test splits.Results conﬁrm that the CNN model outperforms PLSR in the contextof a large data regime, reaching in average an R
2of 0.79 and a MAPE of 30.9% whereas PLSR levels off at an R
2of 0.64 and a MAPE of 135% on theoverall test set. Furthermore, the predictions calculated by the CNN over20 different random splits show little variance with a standard deviationof 0.08 and 0.9% for R
2and MAPE respectively. With such prediction per-formance, the CNN model is more suitable for the remediation of radio-active contamination.Moreover, when evaluated by Soil Taxonomy Orders, the averageMAPE ranges from 26.9% for Vertisols to 47.3% for Vertisols. OnMollisols, the most represented order in the KSSL dataset, the averageMAPE is 27.4%. The variability of the metrics increases as sample sizeof the test set decreases as it is the case for Gelisols with a standard de-viation of 9.9% for its MAPE.The average bias values for CNN predictions evaluated on all data is0.0047 cmol(+).kg
−1. When evaluated on individual Soil TaxonomyOrders, bias values range from−0.04 to 0.02 cmol(+).kg
−1for less rep- resented soil orders such as Gelisols or Histosols. As for the PLSR, the av-erage bias values predictions evaluated on all data is−0.0002 cmol(+). kg
−1. When evaluated on individual Soil Taxonomy Orders, bias valuesrange from−0.09 to 0.04 cmol(+).kg-
1respectively for Gelisols and Ultisols.The scatterplots of observed vs predicted K
exon a single train/test split shown inFig. 4conﬁrm the higher overall agreement of the CNNmodel between the observed and predicted values with respect to the1:1 line.As conﬁrmed byFig. 4, the reported RMSE and MAPE metrics alsoprovide complementary perspectives on the errors performed, asoverweighting respectively errors made on higher and lower ranges ofpredicted K
ex. Indeed, these scatterplots clearly highlight a higherdispersion when predicting with PLSR, in particular for levels of K
exlower than 1 cmol(+).kg−1(once back-transformed in their originalscale). For higher levels (higher than 1 cmol(+).kg
−1), the PLSR model shows a bias, almost systematically underestimating K
ex. To see the learning process of the CNN in action, the validation lossby Soil Taxonomy Orders is reported in Fig. 5. As indicated by the dynamic of the loss evaluated on the entire val-idation set (All), 200 training epochs were required to meet the “early stopping”criteria (stop after 3 epochs without validation loss decrease).Below this curve, theﬁrst group of validation curves including Andisols,Alﬁsols, Mollisols and Vertisols shows a continuous decrease. As op-posed, above this curve, the second group of validation curves includingInceptisols, Aridisols, Ultisols, Spodosols and Gelisols has leveled offlong before the end of the training, indicating a risk of over ﬁtting. The validation curve for Histosols still shows a steady decrease up toapproximately 180 training epochs but with higher MSE values.3.2.2. Local settingFigure 6shows the comparison of the test performances (R
2and MAPE) for both PLSR and CNN models on Mollisols, Gelisols andVertisols Soil Taxonomy Orders when trained (i) on all orders included(global) and (ii) on Mollisols, Gelisols or Vertisols separately (local).This experiment highlights clearly that, at least when predicting K
ex, stratifying the modeling approach by Soil Taxonomy Orders was of littleor no interest for the PLSR model and substantially detrimental for theCNN model. Additionally, high standard deviations were reportedwhen training and testing on Gelisols due to the small sample size,which consequently conﬁrms the relevance to systematically reportresult on multiple random splits.3.3. Assignment of spectral bandsThe GradientShap values averaged over the whole test set or by SoilTaxonomy Orders is shown inFig. 7along with the mean spectrum foreach class.Table 3Comparison of PLSR and CNN models performance
ain predicting K exwhen trained on all Soil Taxonomy Orders and tested on individual Soil Taxonomy Orders separately. Figures reported are averages and standard deviations of metrics computed on test sets over 20 different train/validation/test splits. N is the number of samples. Per formances on Oxisols are not reported as the size of its test set contains often a single sample.MetricsOrders N Models R
2LCCC RMSE MAPEAll 4032 PLSR 0.64 ± 0.01 0.780 ± 0.005 1.06 ± 0.45 135.0 ± 3.3 CNN 0.79 ± 0.08 0.884 ± 0.005 0.60 ± 0.16 30.9 ± 0.9 Undeﬁned 1553 PLSR 0.65 ± 0.01 0.788 ± 0.007 1.15 ± 0.52 153.0 ± 7.2 CNN 0.81 ± 0.01 0.897 ± 0.006 0.76 ± 0.28 31.6 ± 1.3 Mollisols 977 PLSR 0.60 ± 0.02 0.742 ± 0.012 0.77 ± 0.20 94.3 ± 3.1 CNN 0.78 ± 0.02 0.868 ± 0.014 0.44 ± 0.07 27.4 ± 1.2 Alﬁsols 422 PLSR 0.54 ± 0.05 0.728 ± 0.029 0.41 ± 0.18 82.6 ± 4.4 CNN 0.69 ± 0.03 0.822 ± 0.018 0.38 ± 0.17 27.3 ± 1.3 Inceptisols 289 PLSR 0.54 ± 0.04 0.715 ± 0.021 0.56 ± 0.12 117.6 ± 6.8 CNN 0.72 ± 0.03 0.838 ± 0.023 0.40 ± 0.07 35.0 ± 3.1 Ultisols 192 PLSR 0.30 ± 0.08 0.581 ± 0.056 0.32 ± 0.05 80.9 ± 9.0 CNN 0.62 ± 0.05 0.763 ± 0.038 0.26 ± 0.06 32.5 ± 2.4 Entisols 165 PLSR 0.54 ± 0.10 0.734 ± 0.051 0.44 ± 0.09 124.3 ± 15.2 CNN 0.77 ± 0.05 0.875 ± 0.033 0.32 ± 0.05 30.8 ± 3.4 Aridisols 163 PLSR 0.45 ± 0.16 0.686 ± 0.067 2.13 ± 2.74 145.9 ± 56.2 CNN 0.69 ± 0.04 0.822 ± 0.022 0.66 ± 0.32 35.1 ± 3.1 Andisols 133 PLSR 0.59 ± 0.03 0.729 ± 0.028 0.59 ± 0.29 106.4 ± 11.3 CNN 0.74 ± 0.04 0.856 ± 0.026 0.48 ± 0.15 32.6 ± 3.3 Vertisols 95 PLSR 0.55 ± 0.10 0.732 ± 0.062 0.39 ± 0.10 98.7 ± 12.3 CNN 0.75 ± 0.06 0.857 ± 0.037 0.27 ± 0.06 26.9 ± 3.3 Histosols 80 PLSR 0.64 ± 0.09 0.778 ± 0.055 1.16 ± 0.38 243.1 ± 46.1 CNN 0.76 ± 0.06 0.870 ± 0.029 0.87 ± 0.27 45.4 ± 7.4 Spodosols 64 PLSR 0.70 ± 0.08 0.824 ± 0.043 0.48 ± 0.13 157.1 ± 19.7 CNN 0.78 ± 0.05 0.880 ± 0.025 0.41 ± 0.11 37.2 ± 4.7 Gelisols 61 PLSR 0.63 ± 0.10 0.767 ± 0.060 0.65 ± 0.14 193.8 ± 31.4 CNN 0.75 ± 0.08 0.860 ± 0.047 0.59 ± 0.14 47.3 ± 9.9
aN is the number of samples in the test set. The coef ﬁcient of determination R2and Lin's concordance correlation coef ﬁcient (LCCC) are unitless; the Root Mean Square Error (RMSE) is expressed in cmol(+).kg
−1. The Mean Absolute Percentage Error (MAPE) is expressed in %. Both the mean and standard deviation of the metrics calculated over the 20 different rand om splits are reported.F. Albinet, Y. Peng, T. Eguchi et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 230 –241
235It is important to recall that when the SNV (Standard Normal Vari-ate) preprocessing step is applied upstream of the modeling pipeline,MIR spectra are made translation and scale invariant. Hence, machinelearning algorithms exploit only deformation/distortion patterns toprovide estimates. GradientShap values indicate the effect of local de-formations of the spectra on predicted values.Aﬁrst analysis of the GradientShap values shows that the spectralregion around wavenumbers 3700 –3400 cm
−1is considered by the CNN as important to predict K
exfor most soil orders. Several studies(Viscarra Rossel et al., 2006;Le Guillou et al., 2015) have highlighted the role played by soil mineralogical characteristics in this spectralregion with the presence of absorption peaks of soil constituents suchas calcite, kaolinite, 2:1 type clay minerals, and the features of freewater. Importance of mineralogy was also implied by regions1200–970 cm
−1, assigned to Si–O stretching (Farmer, 1974). Soil or- ganic matter may also contribute potassium retention in soil orderswith high organic matter content such as Histosols, Gelisols andAndisols as implied by the importance of the 3000 –2800 cm−1spectral region (Le Guillou et al., 2015).To further compare GradientShap values computed for each SoilTaxonomy Orders, a correlation matrix is shown in Fig. 8. The assess- ment of GradientShap values similarity allows to postulate the presenceof spectral features reused across Soil Taxonomy Orders and willsupport our analysis of the behavior of the CNN model at differentdata regimes.A detailed analysis of the correlation levels is conducted below. Toonly consider the general trends at this stage, a high level of correlationis observed between the GradientShap values calculated for Spodosols,Entisols and the Undeﬁned category. The GradientShap values calcu-lated on Mollisols, the most represented Soil Taxonomy Orders in theKSSL database, are highly correlated positively with Vertisols and nega-tively with Spodosols and Entisols.
Fig. 5.Validation loss (MSE: Mean Squared Error) of the CNN during the training process (200 epochs) calculated on the entire validation set (All) and by Soil Taxonomy Orders. The dif- ferent curves represent the mean MSE over 20 different random splits.
Fig. 4.Observed vs. Predicted K exwith (a) PLSR and (b) CNN using all Soil Taxonomy Orders.F. Albinet, Y. Peng, T. Eguchi et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 230 –241
236On the other hand, the GradientShap values computed for Andisols,Aridisols and Ultisols show little correlation with other orders and ap-pear to be distinctive. Finally, the GradientShap values of Gelisols andHistosols correlate strongly with each other but show a low correlationwith the other orders, suggesting a distinctive cluster.4. Discussion4.1. Performance analysisSoils with high radiocaesium transfer risk to crops require K
exof around 1 cmol(+).kg
−1to bottom out radiocaesium transfer to crops(Hirayama et al., 2018). Hence, in the context of the remediation ofradioactive contamination, the ability to accurately characterize levelsof K
exlower than 1 cmol(+).kg−1is of critical importance. At suchlower potassium concentrations, the available potassium is notenough to avoid uptake of radioactive elements, such as radiocaesium,typically present in case of a fallout linked to a nuclear emergency.Hence, the much lower MAPE errors of the CNN (31%) over the PLSR(135%) models constitutes a major opportunity for this applicationdomain.For higher K
exconcentration (higher than 1 cmol(+).kg−1), as indicated inFig. 4, a clear bias can be observed for the PLSR model. In ad-dition, the PLSR model appears to be dominated by majority of mea-surements available in the dataset within the 0.3 to 1 cmol(+).kg
−1
range (−0.5 to 0 when log 10-transformed). In contrast, the CNNmodel has clearly superior predictive power in this range, despite thelack of representativeness of this type of data in the training set.As mentioned, the early stopping technique was used to train ourmodels. In the case of the CNN, the training was stopped after 3 epochswithout validation loss decrease to avoid over ﬁtting. However,Fig. 5 showing the validation curves by Soil Taxonomy Orders allows for amore in-depth and differentiated analysis. Two groups of validationcurves were identiﬁed, one group of curves showing a steady decreasethroughout the training period and another group whose curves oftenlevel off or start increasing again by the end of the training period. Ourinterpretation is that the overall validation loss decrease was mainlydriven by Mollisols and Alﬁsols orders, the two most represented ordersin the KSSL dataset. More training epochs would have conducted mostlikely to even better performance on those orders. However, the groupincluding Gelisols, Spodosols and Ultisols validation losses stopped de-creasing after 100 epochs (halfway through the training period). Weare overﬁtting those soil orders. Hence, a more conservative approachwould have been to stop training at 100 epochs.4.2. The capacity to leverage growing data regimesA question that often arises is how many samples are needed to useDeep Learning models. The analysis of the Learning curves shown inFig. 3allows to answer this question for our speci ﬁc application domain. The learning curves of both the PLSR and CNN models for Kexprediction highlight the importance of the data regime with respect to modelcapacity. In this study, the CNN model is found to be superior to thePLSR for the prediction of K
exwhen the data regime exceeds about10,000 samples, where the performance of the PLSR model reaches aplateau at an R
2of about 0.65 while the performance of the CNN con-tinues to increase until it reaches an R
2close to 0.8. The learning curves show also high standard deviation in low data regimes. This is an artifactof the evaluation scheme used. While train, validation, test randomsplits in the respective proportions: 80%, 10% and 10% are relevant inhigh data regimes and commonly used, in lower data regime a k-foldevaluation scheme or at least train, validation, test random splits inthe respective proportions: 60%, 20% and 20% would have been moresuitable. However, this limitation does not affect our rationale as(i) the size of the splits, sometimes insufﬁcient, is reﬂected in the stan- dard deviation of the metrics reported and (ii) our experiment focuseson the trend in the highest and growing data regimes.4.3. CNN interpretability and domain knowledgeFig. 6shows a superior performance of the CNN model inpredicting K
exfor Vertisols when trained on all orders than when
Fig. 6.Comparison of test performances, coef ﬁcient of determination R2and Mean Absolute Percentage Error (MAPE) for both PLSR (a) and CNN models (b) on Mollisols, Gelisols and Vertisols Soil Taxonomy Orders when trained (i) on all orders included (Global) and (ii) on Mollisols, Gelisols or Vertisols separately. Metrics rep orted were computed on 20 different random splits.F. Albinet, Y. Peng, T. Eguchi et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 230 –241
237trained on Vertisols only. A further analysis of computedGradientShap values on different Soil Taxonomy Orders and in par-ticular their levels of correlation as shown in Fig. 8provides us with additional interpretation keys.Table 4is a synthesis of our analysis whose objectives are (i) to iden-tify situations where spectral features are reused/transferred betweendifferent soil orders, (ii) to hypothesize the predominance of certainsoil orders in the“Undeﬁned”class and last (iii) to further analyze
Fig. 7.GradientShap values for CNN based K ex(log10-transformed) prediction by Soil Taxonomy Orders (Oxi.: Oxisols, Geli.: Gelisols, Spodo.: Spodosols, Histo.: Histosols, Verti: Vertisols , Andi.: Andisols, Aridi.: Aridisols, Enti.: Entisols, Ulti.: Ultisols, Incepti.: Inceptisols, Al ﬁ.: Alﬁsols, Molli.: Mollisols). A positive (blue) value indicates that distorting the spectrum upwards would lead to an increase of predicted K
ex; a negative (red) value indicates that distorting the spectrum upwards would lead to a decrease of predicted value, or equivalently distorting the spectrum downwards would lead to an increase of predicted value.F. Albinet, Y. Peng, T. Eguchi et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 230 –241
238spectral features considered as important by the CNN model whenpredicting K
ex.As summarized inTable 4, CNN model performance seems to bedriven by two competing forces, namely the data regime and the dis-tinctive nature of the GradientShap values computed for each Soil Tax-onomy Orders, as characterized by their level of correlation over allwavenumbers or speciﬁc spectral regions. This analysis scheme is em-ployed below to highlight the potential role played by the transfer andreuse of spectral features learned by the CNN for each type of soil. Thedifferent scenarios will then be interpreted in light of domain expertise.In general, the pattern of higher level of performance as the data re-gime increases is consistent with the summary of Table 4. However there are exceptions.For instance, the case of Vertisols is instructive, where, despite thelow data regime, very good level of performance is reported. The analy-sis of the correlation of its GradientShap values shows that it is (nega-tively) highly correlated with Mollisols and Entisols, both soil ordersvery well represented in the KSSL database and with Spodosols. The2:1 type clay minerals (e.g., micas, vermiculites, and smectites) deter-mine soil's ability to retain potassium in most cases ( Sawhney, 1970; Sharpley, 1989;Parﬁtt, 1992;Coulombe et al., 1996). In general, Vertisols have high clay content with relatively simple clay mineralogydominated by smectite (Coulombe et al., 1996). Spodosols has sand to loam texture (McKeague et al., 1983), whereas the texture of Vertisolsis, in deﬁnition, heavier than clay loam (Coulombe et al., 1996;Baillie, 2001; Soil SurveyStaff, 2014). In addition, the major 2:1 type clay min-erals, if any, in surface soil of Spodosols are irregular interstrati ﬁed mica-vermiculite-smectites, not pure smectites ( McKeague et al., 1983). In Entisols, due to the low degree of mineral weathering, soil tex-ture and clay mineralogy are diverse reﬂecting the nature of parent ma- terials (Allen and Fanning, 1983;Grossman, 1983).Fig. 7highlights this contrasted clay mineralogy with symmetric GradientShap values ofVertisols and Entisols and Spodosols in the spectral region 3700 –3400 cm−1. Furthermore, a high level of correlation is observed betweenVertisols and Mollisols (0.93). In the United States, smectites are alsocommon in Mollisols (Fenton, 1983;Nettleton and Peterson, 1983). The similar smectitic nature of Vertisols and Mollisols may have alsodriven the unexpected high level of performance for Vertisols, suggest-ing a reuse of spectral features learned on Mollisols, very well repre-sented in the KSSL database.In contrast, the level of performance for Histosols and Gelisols is thelowest. Their GradientShap values are highly correlated with each other(0.95) but not with the other orders. Indeed, they show unique spectralfeatures importance in the 3000 –2800 cm
−1region, related to high or- ganic matter content that control the cation exchange capacity of thesoil and, hence K
ex(Le Guillou et al., 2015). Both their low data regime and unique GradientShap values might explain the poor performance.The level of performance on Spodosols is medium despite the lowdata regime. Most of the Spodosols samples were discarded during thedata selection step as below the detection level. Again, a high level ofcorrelation of its GradientShap values is observed with the Unde ﬁned class, Mollisols and Entisols. Given these high levels of correlation, how-ever, we would have expected a level of performance comparable tothat achieved for Vertisols. This situation requires further investigation.
Fig. 8.Correlation matrix of GradientShap values computed based on the CNN model pre-diction of K
ex(log 10-transformed) by Soil Taxonomy Orders.
Table 4Synthesis of relationships between level of performance, data regime and correlation of GradientShap values by Soil Taxonomy Orders and from theperspective of a CNN predicting K
ex. Soil Taxonomy Orders are ranked in ascending order of performance.Level of performance
aOrder Data regimebHighly correlated withc
Low (>40%) Histosols Low Gelisols (0.95) Gelisols Low Histosols (0.95) Medium (30%–40%) Spodosols Low Unde ﬁned (0.95)Mollisols (−0.95)Entisols (0.92)Vertisols (−0.93) Ultisols Medium NoneInceptisols High NoneAridisols Medium NoneEntisols Medium Mollisols ( −0.95)Vertisols (−0.96) Andisols Medium None High (<30%) Al ﬁsols High NoneMollisols High Vertisols (0.93) Entisols (−0.95)Spodosols (−0.95) Vertisols Low Mollisols (0.93) Entisols (−0.96)Spodosols (−0.93)
aBased on Mean Absolute Percentage Error (MAPE) on the test set as repored in Table 3.
bBased on the number of samples in the test set as reported in Table 3(column N): Low below 100 samples, 100 < Medium <200 and High for higher number of samples otherwise.
cCorrelation coefﬁcients higher than 0.9 are considered only.F. Albinet, Y. Peng, T. Eguchi et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 230 –241
239The level of performance on Aridisols is also medium despite its me-dium data regime and distinctive GradientShap values. Its GradientShapvalues proﬁle shows high values in the 1400 –1200 cm
−1spectral re- gion. According toJohnston and Aochi, 1996, absorbance peaks in that spectral region relates to organic matter content. The calculatedGradientShap values of orders with high organic matter content suchas Histosols and Gelisols do not highlight such spectral region as impor-tant. The interpretation of this paradox requires further investigations.The predominance of the“Undeﬁned”Soil Taxonomy class requires us to take precautions in the case-by-case analysis of model perfor-mance by Soil Taxonomy Orders. A closer look at the GradientShapvalues shows a high positive correlation with Entisols (0.88), Spodosols(0.95), Gelisols (0.76), Inceptisols (0.76) might suggest the presence ofthese classes in the“Undeﬁned”class. However, the interpretation ofthe GradientShap correlation values remains dif ﬁcult given the poten- tially complex mixture of very different soil types included in this class.Finally, in line with our interpretative framework, the level of perfor-mance on Andisols is medium (33%) and high (27%) for Al ﬁsols with re- spectively medium and high data regimes. Andisols are of volcanicorigin and have a distinct mineralogy with more sesquioxides. TheirGradientShap values are also distinctive with all wavenumbers between3700 and 2900 cm
−1and 1400–900 cm−1considered important by the CNN to predict K
ex.Whether it is preferable to stratify MIRS modeling by Soil TaxonomyOrders rather than including them all together has been a long-standingdebate in the Mid-infrared soil spectroscopy research community(Torres Astorga et al., 2018). Our study proposes a methodology to in-form this decision in the light of the spectral features learned and re-used by the prediction algorithm. As aﬁrst analysis, we have shown that the quality of the prediction of K
exis on the one hand indexed on the availability of a large data volume and on the other hand on modelclasses capable to leverage it. A more detailed analysis of these regimesby Soil Taxonomy Orders, however, revealed that the predictions of K
ex
for some underrepresented classes such as Vertisols is possible. Hence,we have shown that the pooling of all Soil Taxonomy Orders isbeneﬁcial in this circumstance but for instance not, in the case forHistosols and Gelisols. Such an analysis is instructive and would beinteresting to conduct also in the context of prediction of other soilanalytes.5. ConclusionThe approach and methodology developed in this paper and its fu-ture developments constitute a major opportunity for the remediationof radioactive contamination in agriculture. They open the possibilityof high throughput characterization of K
exunder different soil conditions. The level of predictive performance achieved now allowsprecise monitoring of the effects of the remediation action, especiallyin the range of K
exvalues inﬂuencing the dynamics of root uptake.Moreover, the proposed approach allows to equip the experts of thedomain, in our case soil scientists, with tools for introspection andinterpretation of the model to better understand the modeledphenomenon.Beyond the progress made in this work, there are several avenues forfuture research. First, the potential of Transfer Learning as a major op-portunity to cut down on the important cost of spectral data acquisitionand leverage pre-trained state of the art Deep Learning architecturesshould be further considered. Second, in this study we have focusedon Mid-Infrared (MIR) data. However, Near-Infrared (NIR) data mightalso offer the opportunity to characterize K
exat an even higher throughput given the availability of low-cost portable spectrometers.The question of its level of performance remains open and justi ﬁes fur- ther investigations. Third and last, MIR and NIR spectroscopy allowslocal or“point”estimation of K
ex. However in the context of theremediation of farmland affected by nuclear accidents, the possibilityof a swift characterization of K
exin soil at landscape scale represents amajor challenge. The question of determining the way that remotesensing and soil spectroscopy data can be used together in thiscontext remains open and needs further exploration.Author contributionsF.A and G.D designed the study. F.A developed the Machine andDeep Learning pipelines and analyzed the results from the Machine/Deep Learning perspective. T.E, G.D analyzed the result from radioecol-ogy and remediation of radioactive contaminated agricultural land per-spectives, E.S evaluated the signiﬁcance of the text from an environmental perspective while Y·P brought his extensive knowledgeof soil spectroscopy.CRediT authorship contribution statementFranck Albinet:Conceptualization, Investigation, Methodology,Software, Visualization, Writing –original draft.Yi Peng:Methodology, Writing–review & editing.Tetsuya Eguchi:Writing–review & editing. Erik Smolders:Writing–review & editing.Gerd Dercon:Conceptuali- zation, Methodology, Supervision, Writing –review & editing.Declaration of Competing InterestThe authors declare that they have no known competing ﬁnancial interests or personal relationships that could have appeared to in ﬂu- ence the work reported in this paper.AcknowledgementsThis work was carried out in the context of the IAEA funded Coordi-nated Research Project (CRP D1.50.19) titled “Remediation of Radioac- tive Contaminated Agricultural Land ”, under IAEA Technical Contract n°23685. This work is a direct outcome from the collaboration betweenIAEA and The Food and Agriculture Organization (FAO) of the UnitedNations. We thank the support from the Global Soil Partnership of theFAO and its Global Soil Laboratory Network initiative on soil spectros-copy (GLOSOLAN-Spec) which is actively supporting countries to de-velop their capacities on soil spectroscopy. We also thank RichardFerguson from Kellogg Soil Survey Laboratory for providing access tothe USDA MIR soil spectra library and the required training sessionsfor its operation. Finally the authors are thankful for the comments bythe reviewers of this paper and particularly to Raphael Viscarra Rossel.ReferencesAllen, B.L., Fanning, D.S., 1983. Composition and soil genesis. Developments in Soil Sci-ence. Elsevier, pp. 141–192https://doi.org/10.1016/S0166-2481(08)70601-9 . Baillie, I.C., 2001.Soil Survey Staff 1999, Soil Taxonomy: A Basic System of Soil Classi ﬁca- tion for Making and Interpreting Soil Surveys, Agricultural Handbook 436. NaturalResources Conservation Service, USDA, Washington DC, USA, p. 869.Barnes, R.J., Dhanoa, M.S., Lister, S.J., 1989. Standard normal variate transformation and de-trending of near-infrared diffuse re ﬂectance spectra. Appl. Spectrosc. 43, 772 –777. Bellon-Maurel, V., Fernandez-Ahumada, E., Palagos, B., Roger, J.-M., McBratney, A., 2010.Prediction of soil attributes by NIR spectroscopy. A critical review of chemometricindicators commonly used for assessing the quality of the prediction. Trends Anal.Chem. 29, 1073–1081.Clairotte, M., Grinand, C., Kouakoua, E., Thébault, A., Saby, N.P., Bernoux, M., Barthès, B.G.,2016.National calibration of soil organic carbon concentration using diffuse infraredreﬂectance spectroscopy. Geoderma 276, 41 –52. Coulombe, C.E., Wilding, L.P., Dixon, J.B., 1996. Overview of Vertisols: characteristics and impacts on society. Adv. Agron. 57, 289 –375. Dangal, S.R.S., Sanderman, J., Wills, S., Ramirez-Lopez, L., 2019. Accurate and precise pre-diction of soil properties from a large mid-infrared spectral library. Soil Syst. 3, 11.https://doi.org/10.3390/soilsystems3010011 . Farmer, V.C., 1974.Vibrational Spectroscopy in Mineral Chemistry.Fenton, T.E., 1983. Chapter 4 Mollisols. In: (Eds.), Developments in Soil Science. Elsevier,p. 125https://doi.org/10.1016/S0166-2481(08)70615-9 . Frost, R.L., Palmer, S.J., Reddy, B.J., 2007. Near-infrared and mid-IR spectroscopy of se- lected humite minerals. Vib. Spectrosc. 44, 154 –161. Gomez, C., Chevallier, T., Moulin, P., Bouferra, I., Hmaidi, K., Arrouays, D., Jolivet, C.,Barthès, B.G., 2020.Prediction of soil organic and inorganic carbon concentrationsF. Albinet, Y. Peng, T. Eguchi et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 230 –241
240in Tunisian samples by mid-infrared re ﬂectance spectroscopy using a French national library. Geoderma 375, 114469.Grinand, C., Barthes, B.G., Brunet, D., Kouakoua, E., Arrouays, D., Jolivet, C., Caria, G.,Bernoux, M., 2012.Prediction of soil organic and inorganic carbon contents at anational scale (France) using mid-infrared re ﬂectance spectroscopy (MIRS). Eur. J. Soil Sci. 63, 141–151.Grossman, R.B., 1983. Chapter 2 Entisols. Developments in Soil Science. Elsevier,pp. 55–90https://doi.org/10.1016/S0166-2481(08)70613-5 . Hastie, T., Tibshirani, R., Friedman, J., 2009. The Elements of Statistical Learning: Data Min- ing, Inference, and Prediction. Springer Science & Business Media.Hirayama, T., Takeuchi, M., Nakayama, H., Nihei, N., 2018. Effects of decreasing radiocesium transfer from the soil to soybean plants and changing the seed nutrientcomposition by the increased application of potassium fertilizer. Bull. FukushimaAgric. Tech. Cent. 9, 1–10.Janik, L.J., Skjemstad, J.O., 1995. Characterization and analysis of soils using mid-infraredpartial least-squares. 2. Correlations with some laboratory data. Soil Res. 33, 637 –650. Johnston, C.T., Aochi, Y.O., 1996. Fourier transform infrared and Raman spectroscopy.Methods Soil Anal. Part 3 Chem. Methods 5, 269 –321. Kingma, D.P., Ba, J., 2014.Adam: a method for stochastic optimization. ArXiv (Prepr.ArXiv14126980).Klesta, E.J., Bartz, J.K., 1996.Quality assurance and quality control. Methods Soil Anal. Part3 Chem. Methods 5, 19–48.Kokhlikyan, N., Miglani, V., Martin, M., Wang, E., Alsallakh, B., Reynolds, J., Melnikov, A.,Kliushkina, N., Araya, C., Yan, S., Reblitz-Richardson, O., 2020. Captum: A Uniﬁed and Generic Model Interpretability Library for PyTorch.Komatsu, M., Hirai, K., Nagakura, J., Noguchi, K., 2017. Potassium fertilisation reduces radiocesium uptake by Japanese cypress seedlings grown in a stand contaminatedby the Fukushima Daiichi nuclear accident. Sci. Rep. 7, 1 –10. Landre, A., Saby, N.P.A., Barthès, B.G., Ratié, C., Guerin, A., Etayo, A., Minasny, B., Bardy, M.,Meunier, J.-D., Cornu, S., 2018. Prediction of total silicon concentrations in French soils using pedotransfer functions from mid-infrared spectrum and pedological attri-butes. Geoderma 331, 70 –80. Lawrence, I., Lin, K., 1989.A concordance correlation coefﬁcient to evaluate reproducibil- ity. Biometrics 255–268.Le Guillou, F., Wetterlind, W., Viscarra Rossel, R.A., Hicks, W., Grundy, M., Tuomi, S., 2015.How does grinding affect the mid-infrared spectra of soil and their multivariate cali-brations to texture and organic carbon? Soil Res. 53, 913 –921. Lundberg, S.M., Lee, S.-I., 2017. Au n iﬁed approach to interpreting model predictions. In: Guyon, I., Luxburg, U.V., Bengio, S., Wallach, H., Fergus, R., Vishwanathan, S.,Garnett, R. (Eds.), Advances in Neural Information Processing Systems 30. CurranAssociates, Inc., pp. 4765–4774.McKeague, J.A., DeConinck, F., Franzmeier, D.P., 1983. Chapter 6 Spodosols. Developmentsin Soil Science. Elsevier, pp. 217 –252https://doi.org/10.1016/S0166-2481(08)70617- 2.Mehmood, T., Liland, K.H., Snipen, L., Sæbø, S., 2012. A review of variable selection methods in partial least squares regression. Chemom. Intell. Lab. Syst. 118, 62 –69. Molnar, C., Casalicchio, G., Bischl, B., 2020. Interpretable machine learning –
a brief history, state-of-the-art and challenges. ArXiv (Prepr. ArXiv201009337).Nettleton, W.D., Peterson, F.F., 1983. Chapter 5 Aridisols. Developments in Soil Science.Elsevier, pp. 165–215https://doi.org/10.1016/S0166-2481(08)70616-0 . Ng, W., Minasny, B., Malone, B.P., Sarathjith, M.C., Das, B.S., 2019a. Optimizing wavelength selection by using informative vectors for parsimonious infrared spectra modelling.Comput. Electron. Agric. 158, 201 –210. Ng, W., Minasny, B., Montazerolghaem, M., Padarian, J., Ferguson, R., Bailey, S., McBratney,A.B., 2019b.Convolutional neural network for simultaneous prediction of several soilproperties using visible/near-infrared, mid-infrared, and their combined spectra.Geoderma 352, 251–267.Ng, W., Minasny, B., Jeon, S.H., McBratney, A., 2022. Mid-infrared spectroscopy for accu- rate measurement of an extensive set of soil properties for assessing soil functions.Soil Secur. 100043.Parﬁtt, R.L., 1992.Potassium-calcium exchange in some New Zealand soils. Soil Res. 30,145–158.Peng, Y., Knadel, M., Gislum, R., Schelde, K., Thomsen, A., Greve, M.H., 2014. Quantiﬁcation of SOC and clay content using visible near-infrared re ﬂectance–mid-infrared reﬂec- tance spectroscopy with Jack-kni ﬁng partial least squares regression. Soil Sci. 179, 325–332.Sanderman, J., Savage, K., Dangal, S.R., 2020. Mid-infrared spectroscopy for prediction of soil health indicators in the United States. Soil Sci. Soc. Am. J. 84, 251 –261. Sawhney, B.L., 1970.Potassium and cesium ion selectivity in relation to clay mineralstructure. Clay Clay Miner. 18, 47 –52. Sharpley, A.N., 1989.Relationship between soil potassium forms and mineralogy. Soil Sci.Soc. Am. J. 53, 1023–1028.Shen, Z., Viscarra Rossel, R.A., 2021. Automated spectroscopic modelling with optimised convolutional neural networks. Sci. Rep. 11, 1 –12. Shen, Z., Ramirez-Lopez, L., Behrens, T., Cui, L., Zhang, M., Walden, L., Wetterlind, J., Shi, Z.,Sudduth, K.A., Baumann, P., Song, Y., Catambay, K., Viscarra Rossel, R.A., 2022. Deeptransfer learning of global spectra for local soil carbon monitoring. ISPRSJ. Photogramm. Remote Sens. 188, 190 –200.https://doi.org/10.1016/j.isprsjprs. 2022.04.009.Shepherd, K.D., Walsh, M.G., 2007. Infrared spectroscopy—enabling an evidence-based diagnostic surveillance approach to agricultural and environmental management indeveloping countries. J. Infrared Spectrosc. 15, 1 –19. Shrikumar, A., Greenside, P., Kundaje, A., 2019. Learning important features through prop- agating activation differences. ArXiv (170402685 Cs).Simonyan, K., Zisserman, A., 2014. Very deep convolutional networks for large-scale image recognition. ArXiv (Prepr. ArXiv14091556).Smilkov, D., Thorat, N., Kim, B., Viégas, F., Wattenberg, M., 2017. SmoothGrad: RemovingNoise by Adding Noise. Doi:10.48550/arXiv.1706.03825. Smith, L.N., 2017.Cyclical learning rates for training neural networks. 2017 IEEE WinterConference on Applications of Computer Vision (WACV). IEEE, pp. 464 –472. Socrates, G., 2004.Infrared and Raman Characteristic Group Frequencies: Tables andCharts. John Wiley & Sons.Soil Survey Staff, S, 2014.Keys to Soil Taxonomy. 12th edn. Washington. DC Nat. Resour.Conserv. Serv. U. S. Dep. Agric. Sch.de Sousa Mendes, W., Demattê, J.A., Rosin, N.A., da Silva Terra, F., Poppiel, R.R., Urbina-Salazar, D.F., Boechat, C.L., Silva, E.B., Curi, N., Silva, S.H.G., 2022. The Brazilian soil mid-infrared spectral library: the power of the fundamental range. Geoderma 415,115776.Sundararajan, M., Taly, A., Yan, Q., 2017. Axiomatic attribution for deep networks. ArXiv (170301365 Cs).Terhoeven-Urselmans, T., Vagen, T.-G., Spaargaren, O., Shepherd, K.D., 2010. Prediction of soil fertility properties from a globally distributed soil mid-infrared spectral library.Soil Sci. Soc. Am. J. 74, 1792 –1799. Torres Astorga, R., de los Santos Villalobos, S., Velasco, H., Domínguez-Quintero, O., PereiraCardoso, R., Meigikos dos Anjos, R., Diawara, Y., Dercon, G., Mabit, L., 2018. Exploring innovative techniques for identifying geochemical elements as ﬁngerprints of sedi- ment sources in an agricultural catchment of Argentina affected by soil erosion. Envi-ron. Sci. Pollut. Res. 25, 20868 –20879. Viering, T., Loog, M., 2021.The Shape of Learning Curves: A Review.Viscarra Rossel, R.A., Behrens, T., 2010. Using data mining to model and interpret soil dif- fuse reﬂectance spectra. Geoderma 158, 46 –54. Viscarra Rossel, R.A., Bouma, J., 2016. Soil sensing: a new paradigm for agriculture. Agric. Syst. 148, 71–74.Viscarra Rossel, R.A., Lark, R.M., 2009. Improved analysis and modelling of soil diffuse reﬂectance spectra using wavelets. Eur. J. Soil Sci. 60, 453 –464. Viscarra Rossel, R.A., Walvoort, D.J.J., McBratney, A.B., Janik, L.J., Skjemstad, J.O., 2006.Visible, near infrared, mid infrared or combined diffuse re ﬂectance spectroscopy for simultaneous assessment of various soil properties. Geoderma 131, 59 –75. Viscarra Rossel, R.A., Jeon, Y.S., Odeh, I.O.A., McBratney, A.B., 2008. Using a legacy soil sam- ple to develop a mid-IR spectral library. Soil Res. 46, 1 –16. Viscarra Rossel, R.A., Behrens, T., Ben-Dor, E., Brown, D.J., Demattê, J.A.M., Shepherd, K.D.,Shi, Z., Stenberg, B., Stevens, A., Adamchuk, V., 2016. A global spectral library to char- acterize the world’s soil. Earth-Sci. Rev. 155, 198 –230. Viscarra Rossel, R.A., Behrens, T., Ben-Dor, E., Chabrillat, S., Demattê, J.A.M., Ge, Y., Gomez,C., Guerrero, C., Peng, Y., Ramirez-Lopez, L., 2022. Diffuse reﬂectance spectroscopy for estimating soil properties: a technology for the 21st century. European Journal of SoilScience 73 (4).Wijewardane, N.K., Ge, Y., Wills, S., Libohova, Z., 2018. Predicting physical and chemical properties of US soils with a mid-infrared re ﬂectance spectral library. Soil Sci. Soc. Am. J. 82, 722–731.Zeiler, M.D., Fergus, R., 2013.Visualizing and Understanding Convolutional Networks.F. Albinet, Y. Peng, T. Eguchi et al. Artiﬁcial Intelligence in Agriculture 6 (2022) 230 –241
241