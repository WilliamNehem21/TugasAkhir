Drug design is a time-consuming and costly process [1,2] with high attrition rates [3]. It can be supported with in silico methods by guiding the design process, optimizing compounds, and discarding those with undesired properties at an early stage of development. In this context, computer-aided drug design (CADD) has become central in the drug discovery pipeline and is widely adopted in research and development in both academia and pharmaceutical companies.

Encoding molecular compounds in both human- and computer- readable formats is a necessary step in CADD. A convenient encoding is SMILES, or simplified molecular-input line-entry system [15]. As the name suggests, SMILES is a linear notation of a molecule based on atom and bond enumeration, as well as branch, ring closure, and disconnec- tion specification. Several advantages arise from this compact represen- tation.

The implementation of a SMILES given a compound can be described as follows: from any starting atom in the molecule, enumerate the atoms and bonds following a path in the molecular graph. Two aspects of this construction lead to the non-uniqueness of SMILES: 1. the atom to start the enumeration from, and 2. the path to follow along the graph.

Therefore, one molecule can have many different valid SMILES, sim- ply by starting the enumeration from a different atom or by choosing a different path. Nevertheless, in some settings, having a bijection be- tween a molecule and its SMILES notation may be sought. For exam- ple, when determining the overlapping molecules from two data sets. In this context, most cheminformatics tools have their own algorithm implemented allowing them to always retrieve the same SMILES given a molecular graph, such a SMILES is called canonical [17].

0.12 increase with respect to the canonical model. From then on, sev- eral studies have built on the same idea, applying SMILES augmenta- tion in QSAR modeling [21]. Moreover, convolutional neural networks have successfully been applied in the context of SMILES augmentation, outperforming models using traditional molecular descriptors [22,23]. Such augmentation techniques have also emerged in related fields, such as retrosynthesis [25,26] and generative modeling [27,28]. While all these studies show the benefit of augmenting the data, none of them focus, to the best of our knowledge, on a systematic analysis on how to augment the data set best, and most decide a priori on an aug- mentation number. This study aims at filling this gap by offering a systematic augmentation approach, both in the augmentation strate- gies and by how much the data should be augmented. Moreover, a command-line interface is available for users interested in the predic-

In this section, we first describe different augmentation strategies which can be used for data augmentation when dealing with SMILES. Second, we illustrate how SMILES augmentation can be viewed as an ensemble learning technique when it comes to prediction. We then ex- amine the deep learning models that are trained in this study.

ing to the augmentation number, i.e. the number of times a sample is drawn from the valid SMILES space, and the size of the molecules in the data set. A disadvantage of such an augmentation strategy is that small molecules, which presumably possess fewer unique SMILES representa- tives, will be under-represented in the data set and could create a bias in model training.

The final strategy described is augmentation with estimated max- imum, which aims to cover a wide range of the valid SMILES space for a given compound, or in other words, to generate a number of unique SMILES that depends on the compound. In our study, the im- plementation of this augmentation strategy randomly samples SMILES corresponding to a compound, and the sampling process is stopped once the same SMILES string has been generated a pre-defined num- ber of times. The experiments of this study set 10 generations of the same SMILES as a stopping criterion. It is noteworthy that the number of SMILES this method generates is highly dependent on the

In this study, comparing deep learning models and how they perform with respect to data augmentation is one of the key focuses. To this end, three types of models are architectured and trained, namely 1D and 2D convolutional neural networks (CONV1D, CONV2D) as well as a recur- rent neural network (RNN). The architecture of the recurrent network consists of an LSTM layer, followed by two fully connected layers of 128 and 64 units, respectively. It was inspired by Bjerrum [20], in which an LSTM layer is followed by a single 64 unit fully connected layer. Using a similar approach, a single 1D convolutional layer of kernel size 10 and stride 1 is applied in the CONV1D model. Two fully connected layers follow the convolution. The CONV2D adheres to the same pattern but instead of using a 1D convolution, a 2D convolution operation is per- formed using one single channel. Finally, all three architectured models stay consistent in the depth of the network and remain shallow.

In this study, all deep learning models are trained for 250 epochs, using mini-batches of size 16, where the mean squared error is the con- sidered loss. Optimization is done with stochastic gradient descent and a learning rate of 0.001. Note that a fixed number of epochs is used in this study, but for sake of completeness, three sample models with early stopping were also run. The results with and without early stopping did not change significantly (data not shown). Moreover, some models were trained by adapting the number of epochs with respect to the augmenta- tion number, but this only proved to overfit the training set and yielded the same results on the test set as training with 250 epochs (data not shown).

Measured water solubility is referred to as the ESOL data set [39]. The raw data contains 1 128 data points. This data set is further processed to only include molecules with at most 25 heavy atoms for experimental setup and is referred to as ESOL_small.

ment, among others, in cancer and inflammatory diseases [42]. Kin- odata, from the Openkinome organization [43], provides an already curated data set of human kinase bioactivities, retrieved from one of the latest versions to date of ChEMBL (version 28) and is freely avail- able at https://github.com/openkinome/kinodata. Moreover, for this study, Kinodata is further filtered for the epidermal growth factor re- ceptor (EGFR) kinase [44], since it is known to be an important drug

Ensemble learning is applied on each test set and the mean is used as aggregation. However, a user could easily adapt it to another function, such as the median. The standard deviation is stored for each compound in the test set.

Moreover, a Random Forest (RF) model [50] is used as a baseline, with all default parameters from Scikit-learn [51]. The inputs to the model are the Morgan fingerprints of radius 2 and length 1024. Aug- mentation strategies as discussed above are not applicable in the context of fingerprints.

All code is written in Python 3 [53] following PEP8 style guide [54] and is freely available at https://github.com/volkamerlab/ maxsmi. Results of this study can be found at the same link. Examples and documentation, generated via Read the Docs [55], can be found at https://maxsmi.readthedocs.io/en/latest/.

and their ability to extract relevant features in compounds based on one- hot encoded SMILES input. This also implies that although applying 2D convolutions to SMILES is programmatically feasible, 1D convolutions are better suited than 2D convolutions, the latter having shown great success in image classification. Indeed, when considering the one-hot encoded matrix, SMILES are more similar to words, in which the posi- tion of the atoms is important, rather than to images.

Using the Maxsmi models established above, we look into more de- tails at the information gained from ensemble learning for molecular prediction, and more specifically at the average and standard deviation computed from the per SMILES prediction. Feeding different SMILES representations to the model and aggregating the prediction for each SMILES variation to obtain a single prediction per compound is valu- able not only from a practical point of view where molecular prediction is more informative than a SMILES prediction, but it also allows the model to merge information coming from different perspectives of the same compound. Moreover, the standard deviation associated with the SMILES predictions allows to quantify the uncertainty of the prediction of the model toward a given compound. The higher the standard devia- tion for a molecule, the less concurrent are the predictions by the model, and thus, less confident.

As an outlook, we observe that strategies that keep all, or a fraction of duplicates, may help the model to learn inherent symmetry in a com- pound. Indeed the same random SMILES representation will certainly be generated multiple times for a symmetric molecule even though the initial atom and the path along the graph are different. In this sense, SMILES duplication is not an artificial construction, and keeping repli- cas could retain important information about the underlying symmetry of a compound.

(the  lipophilicity  data)  is  still  above  0.3  when  only  keeping  the  10%  of  compounds  with  the  highest  confidence. showing a relationship between high confidence and small mean prediction error. Although also generally decreasing, the mean prediction error in the right plot

