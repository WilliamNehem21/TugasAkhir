Point-cloud registration methods can be categorized into two classes: marker-based and marker-free registrations. Marker-based reg- istration relies on artificial markers that are manually placed at the scene and manual or automatic recognition of these markers in different scans to establish correspondences (Bienert and Maas, 2009; Hilker et al., 2012). The markers are often reflective and can have various shapes (e.g., circular, cylindrical, or spherical). Based on corresponding point pairs extracted by identifying the same markers in adjacent scans, the relative transformation matrix between overlapping areas in multiple scans can be calculated by many commercial software pack- ages to complete the registration procedure.Marker-based registration is accurate and reliable but has many limitations. In complex environ- ments, artificial markers can be difficult to place, and marker-based reg- istration is often time-consuming in the field (Pfeifer et al., 2004).

stepwise manner. In our coarse registration, each 3D point cloud was projected onto a sphere to generate a series of 2D projection images for the extraction of feature-point pairs, whose spatial information can be used to estimate the transformation matrix for the coarse reg- istration of multiple scans. Sliced point-cloud data were then used to estimate the centers of trunks and branches using fitting methods. The estimated centers were used as tie points to perform fine registration.

In coarse registration, our method simplifies the 3d point matching problem into a 2d point matching problem by projecting from the 3D point cloud to 2D images. The matched points are estimated using feature-point-matching algorithms on images generated by projection. These matched points are then used to estimate the rough transformation. In fine registration, point-cloud slicing and fitting methods are used to extract corresponding trunk and branch centers, which function as tie points to calculate the fine transformation parameters. The workflow is

As a result, each scanning point corresponds to a certain set of pixel coordinates, and each pixel may have several corresponding points. The image generated via projection is a binary image. Pixels with and without corresponding scanning points are set to values of 0 and 255, respectively.

According to the projection method, projected images of the same object may differ due to differences among viewpoints. In our model, the projection viewpoint is determined by the position of the scanner. Due to occlusion, some valuable tree structural information will be lost in the process of projection. Thus, two scans with different view- points may be similar in 3D space, but their projected images may differ greatly, which can be an obstacle in identifying corresponding points between scans.

Different slicing heights result in differences in the number, distribu- tion, and relative position of the sliced points in the layer. Points in lower layers are generally all extracted from the stem. However, most points in high layers are extracted from branches. The stem is usually perpendicular to the ground and its horizontal cross section is roughly treated as a circle. Thus, the center of the stem can be estimated via cir- cle fitting. Branches are often at an oblique angle to the stem and their horizontal sections are similar to ellipsoids. Given that the geometric structure of branches in 3D space is similar to that of cylinders, we used a cylinder-fitting method to estimate the center points of the branches.

The axis of the branches could describe the tree to some extent (Eysn et al., 2013). Thus, the starting point and a point one distance unit away from it in the positive direction of the axis were used as tie points. The positive direction of the axis was defined as the direction in which the Z coordinate of the point increases. For stem points, the center of the fitted circle was regarded as a tie point.

(c) Registration results between scan 2 and scan 1 for simulated tree B. (d) Registration re- sults between scan 3 and scan 1 added to results from (c). Green, red, and blue points in- dicate scans 1, 2, and 3, respectively.

Tree point cloud registration is fundamental and important to for- estry research and tree structure analysis. The study proposed an auto- matic registration method that uses a coarse-to-fine strategy to register multiple scans of a single tree without the aid of artificial reflectors. The proposed method is verified as a feasible and effective automatic regis- tration method using two simulated and six real tree point clouds. The automated and marker-free registration method provides a new way to assist the tree structure analysis.

