A novel and automated way to colorize gray images by giving an example color image is being proposed. Both images are partially segmented using unsupervised segmentation JSeg. Proposed methodology controls merging of segments in JSeg by analyzing histogram of gray image. Maximum fitting square patches are extracted from each segment in linear time. Some square patches are discarded to avoid error. Gray image and color image segments are matched using Dual Tree Complex Wavelet Transform. Colors between matched segments are transferred using simple mean and standard deviation. Remaining image is colorized using optimization. Experimental results performed show the advantage of automation.

Colorization is adding colors to gray scale images. It is used for enhancing old grayscale photos, marking regions of interest in medical images, enhancing electron microscopic images and satellite images. It can also be used for re-coloring or modifying color images for getting visually pleasant results.

JSeg is unsupervised segmentation framework for natural images and gives good results on grayscale images [8]. First an image is quantized to 16 levels using Peer Group Filtering (PGF) [9]. Each level represents a class thus forming a class map. Let Z be a set of all points on this maps such that    .The value of z is its coordinates i.e.   . Let N be the total points in class map. Mean m can be calculated as follow, image called J-image. Lowest windows size is 9x9 called scale 1. Highest is 65x65 called scales 4. From lowest J values, a region growing method is used to segment the image. Valley points are determined in a region below a threshold. Threshold is determined as follow.

where  are mean and variance of J values of a region. Finally, this results in over-segmented regions. Regions with similar intensity are merged. Regions with Euclidean distance below a threshold are merged. The optimum threshold used is 0.4. This works well for color images. For gray images it is used adaptively after analyzing peaks in a histogram explained in section 3.1.

The color image is segmented using default scale parameters used in JSeg. Threshold for merging phase used is 0.4. For gray scale image adaptive merging based on histogram analysis is used. Histogram of an image shows distribution of an image. A peak is defined as maxima between two low points [11]. Highest peaks represent major areas of interest in an image. If N is total pixels in an image and  is total number of pixels between two minima. Then percentage of area  of a peak with respect to whole image can be determined as follow:

Peaks which represents below 5% of an image are ignored. If K is greater than 4 then a scale of 0.3 is used for merging otherwise a scale of 0.4 is used. For 0.3 means areas of interest are many and should be left unmerged.

Feature vector for each square patch is calculated by applying Complex Wavelet at two scales and six orientations. 12 real and 12 imaginary sub-bands are got along with 2 real and 2 imaginary approximation sub-bands. By taking the magnitude of both real and imaginary coefficients and approximation and detailed bands 14 sub-bands are received. Mean and standard deviation is calculated as suggested by Kingsbury [7].

This feature vector extraction is applied on gray square patches and at color patches after conversion to gray scale. These feature vectors are store for later matching. Feature vectors for color image square patches are taken above 20. The reason is that for small square patches mismatch rate can increase.

Once the feature vectors are calculated a square patch representing a segment in gray image is picked. Distance of its feature vector with other feature vectors representing color image square patch is calculated. Let q be the feature vector of a query gray patch and be feature vectors of M reference color patches. The distance metric betweenMquery template image q and  used is given below

After the match of gray segment is found from color square patches that color square patches is used for colorizing the whole gray segment of image. Colors are transferred based on mean and standard deviation suggested by Welsh [2]. This process is repeated for all gray segments whose size patch is above 15. This will leave some small gray segments in image. Colors for these gray areas are determined using optimization [3]. All colored pixels are considered known variables (scribbles) and remaining gray pixels are considered unknown variables. Image is converted into YUV color space. Let r be a center pixel and s be its neighbors. A constraint is imposed that neighboring pixels should have similar colors if their intensities(Y) are similar.

If a color at pixel r i.e U(r), is known, the color value U(s) of its neighbours s will be weighted average of . Similarly V channel of YUV color space can be determined. Now the remaining image is fully colorized.

