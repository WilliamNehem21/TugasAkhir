Available online at www.sciencedirect.com



AASRI Procedia 3 (2012) 686 – 693




2012 AASRI Conference on Modeling, Identification and Control
Weight Optimization for LQG Controller Based on the Artificial Bee Colony Algorithm
Weidong Wang*, Yijuan Jing, Li Yang, Boyuan Ma, Zhengguo Fu
School of Electrical and Mechanical Engineering, Xidian University, Xi'an 710071, CHINA



Abstract

In large antenna servo control systems, Linear Quadratic Gaussian (LQG) controller is superior to the proportional integral (PI) controller in terms of stability, rapidity and wind disturbance suppression. However, there is still no deterministic method to design the weight matrixes that affect the performance of LQG controller. To solve this problem, a method based on the artificial bee colony (ABC) algorithm is proposed, which aims at optimizing the close-loop system transient response performance. Global searching and local searching are conducted in each iterative step in the ABC algorithm so that searching efficiency is greatly improved. Applied in a weight matrixes optimization problem for a large antenna servo with LQG controller, the algorithm is satisfactory in simulation result, the control effect is better than that based on the trial and error method.

© 2012 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license.
Selection and/or peer review under responsibility of American Applied Science Research Institute

Keywords: Artificial Bee Colony Algorithm; LQG controller; Weight optimization; Large antenna servo system


Introduction

PI (Proportional Integral) controller is widely used in servo control systems, but for large antenna servo systems, PI controller is incapable of accurate tracking and orientation due to its defects in wind disturbance suppression, which limits its application. LQG (Linear Quadratic Gaussian) method, a kind of linear optimal control method developed in 1960s, is widely used in large servo system [1]. The control algorithm consists

* Corresponding author. Tel.: 86-29-88201974.
E-mail address: wangwd@mail.xidian.edu.cn.







2212-6716 © 2012 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license. Selection and/or peer review under responsibility of American Applied Science Research Institute doi:10.1016/j.aasri.2012.11.109


of an optimal state feedback controller and a state observer based on Kalman filter. It is realized by determining the weight matrixes, and the performance of the controller is highly influenced by the choice of weight matrixes, i.e. a poorly chosen weight matrixes would result in an unsatisfactory performance. Therefore, the selection of weigh matrixes is key to the design. In the past, weight matrixes are obtained by trial and error, which not only is time-consuming but also requires practical experiences, and in some cases it cannot obtain the optimal or suboptimal weight matrixes which meet the desired specifications. Adopting the philosophy of optimization computation, weight matrixes can be obtained under certain optimization constraints. This approach can increase design efficiency and computes optimal or suboptimal weight matrixes under certain optimization constraints.
A bionic intelligence algorithm called artificial bee colony algorithm (ABC) which imitates bee colony searching for food resource was proposed by Karaboga et al. [2] in 2007. Although still in its beginning, ABC algorithm has been more and more studied by scholars, because it has less adjusting parameters and is easy to implement. Compared with genetic algorithm (GA) and particle swarm optimization (PSO), ABC conducts global and local searching in each iteration step so that it is more possible to find the global optimal solution and avoid the local optimal solution. It has been successfully applied to unconstrained numerical optimization [2-3], constrained numerical optimization [4], neural network training etc. These studies conducted typical tests to ABC algorithm and obtained satisfactory simulation and experimental results.
Based on the expected step response performance of close-loop system, we adopt ABC algorithm to compute and optimize the weight matrixes of LQG controller so that asymptotical stability, adequate stability margin, optimality and performance specifications can be guaranteed. The optimized weight matrixes are applied to a large antenna LQG controller, simulation results show that they are superior to those obtained by trial and error.

Description of LQG controller

Traditional servo system with PI controller [5] is shown in Fig. 1, the difference between input instruction r and output y is called pointing error, e= r-y. This error is the input of PI controller which generates the speed instruction of the system. A problem of PI controller is that if the proportional gain Kp or integral gain Ki have subtle changes, large variations on system characteristics will occur.


Fig. 1. Block diagram of a control system with PI controller

Three PI controllers with different parameters are shown in Fig. 2. The figure shows that if Ki is slightly changed, the step response of the system will be greatly changed. If Ki increases, the system will have larger overshoot and will be more vulnerable to disturbances. It is also shown in Fig. 2 that if proportional gain Kp increases, the system vibration will also increase. Therefore, Kp, Ki should be properly adjusted to avoid instability of the servo.
PI controller has many limitations in controlling large antenna systems, and is difficult to achieve the optimal control effect simply by parameter setting, so LQG control algorithm is adopted for its better performance. LQG controller consists of a state estimator based on Kalman filter and an optimal state feedback controller, which can be designed separately.





Fig. 2. Performance of three different PI controllers

State estimation based on Kalman filter

Suppose the state-space model [6] of a servo system is described as:
 Ax  Bu
 Cx	(1)
where x is the state variable of the system, u is input of the system and y the output. A, B and C are coefficient matrixes of the system. In most cases, state variable x is hard to obtain, so state estimation xˆ and
output estimation yˆ are used as the replacement. Define state estimation error as xe  x  xˆ , we have:


xe  x  xˆ
 ( Ax  Bu)  ( Axˆ 
Bu)

A(x  xˆ)
Axe
(2)


The above expression shows that if A is asymptotically stable, the state estimation error will tend to zero
when t, and xˆ will converge to x and yˆ to y. If A is unstable, xˆ diverges from x as t increases. To avoid
this, a correction term is added to Equ.(2):


xˆ  Axˆ 
yˆ  Cxˆ
Bu  ke ( y  yˆ)


(3)


As long as A-KeC is asymptotically stable, xe will finally tend to zero. If A is unstable, optimal Ke can be obtained to make A-KeC asymptotically stable.
The gain of optimal estimator can be expressed as follow,

Ke=SeCT


where Se is the solution of Riccati algebraic equation of the controller.

ATSe+SeA-SeBBTSe+V=0


(4)




Optimal state feedback

In the optimal feedback problem, we need to find a feedback matrix to minimize the total energy of the input and output signals, the total energy of input/output signal J [6] can be expressed as Equ.(5).


J 2  E
(xT Qx  uT Ru )dt

(5)


In the above definition, Q is positive semi-definite weight matrix, R is a positive scalar, and the minimum of J is obtained from feedback.


uo  Kc xˆo
(6)


The feedback gain can be obtained from the following expression:

Kc=BTSc	(7)

where Sc is the solution of Riccati algebraic equation of controller.

ATSe+SeA-SeBBTSe+Q=0	(8)




Fig. 3. Block diagram of a closed-loop system with LQG+PI controller

Based on the above analysis, a servo system with LQG controller [6] could be set up as shown in Fig. 3. PI controller and LQG controller generate control signal u collectively. LQG controller consists of an optional feedback controller Kc and a state estimator Ke.. The measurable output y is used to form the control signal; the state estimation  is used to form the closed-loop through feedback gain Kc.


Fitness function of LQG controller weight matrix

In traditional procedure of designing a LQG controller, designers obtain the control parameters by trial and error. To improve the efficiency of the design and performance of the controller, we study a new optimization algorithm based on the strategy proposed in Ref. [1]. Suppose that a reference model is obtained with the desired performance specification, Ym being its output. Given Q and R, the real output under the same input is Y, define the following ‘1’ norm,

f=||Y-Ym||1	(9)

Define f as the fitness function, the process of choosing weight matrixes Q and R is that of minimizing f. The optimization algorithm adjusts weight matrixes Q, R based on the magnitude of deviation between real output Y and the reference model output Ym and updates Kc by solving the Riccati algebraic equation, so that the system response can approximates the reference model response until f reaches a minimum. The matrixes obtained under this condition are the optimization result.

3. ABC algorithm and its design

Algorithm description

In ABC algorithm, artificial colony consists of three groups of bees: employed bees, onlookers and scouts. In every iteration, employed bees and onlookers are equal in number; the number of scouts is 1. Employed bees and onlookers perform exploitation, while scouts perform exploration. ABC algorithm combines global search with local search so that exploitation and exploration reach a proper balance [2].
Employed bees and onlookers update food source location based on Equ. (10)

vij=xij+rij(xij-xkj)	(10)

where k  {1, 2, … , SN}, j  {1, 2, …, d}, k, j are random values, but k is unequal to i ( k is a solution of i neighbourhood). rij  [-1, 1] is a random value, it controls the scope of xij neighbourhood and will be decreasing while vij is approaching the optimal solution.
Onlookers judge food’s profit by watching the dances of employed bees and choose food sources depending on the profit. Profit is expressed by fitness value, selection probability is expressed by Equ. (11),


pi  Fiti
Fiti

(11)


where Fiti is fitness value of the i-th solution, SN is number of the solutions.
There is a controling parameter limit, which records the number a solution has been updated. If a solution representing a food source is not improved after limit iterations, it is abandoned and the corresponding employed bee changes to a scout. Assume xi is abandoned and j  {1, 2, , d}, then a new solution will be generated by scouts with Equ. (12) to replace xi:

xij=xminj+rand(0,1)(xmaxj-xminj)	(12)


From the above analysis, ABC implements four selection processes,
Global selection by onlookers to find better food source according to Equ. (10);
Local selection by employed bees and onlookers to find optimal solution through neighborhood searching, according to Equ. (12);
Greedy selection by all the artificial bees through comparing old food source with new food source and keeping the better solution;
Random selection by scouts to find a new food source according to Equ. (12).

ABC algorithm design procedures

Step.1 Selecting a reference model based on the performance specifications;
Step.2 Assigning the elements on the diagonal of weight matrixes Q and R as the parameters to be optimized;
Step.3 Initialize bee population and calculate fitness value by Equ. (9) ;
Step.4 Based on the fitness value, dividing bee colony into employed bees and onlookers;
Step.5 For every onlooker, new food resource is searched for by Equ. (10) in the neighborhood of the old source. The fitness value is also calculated; the old source will be replaced if new fitness value is higher;
Step.6 Selection probability is calculated based on which food source is selected. At the same time, new sources are also searched, if new sources have higher fitness value, the current one is replaced.
Step.7 If searching steps exceed a certain limit without finding a new food source with higher fitness value, current source will be abandoned, new source will be randomly generated by Equ. (12);
Step.8 Record the optimal food source and skip to Step.3 until end condition of the algorithm is satisfied.

Simulation example of a large antenna servo system

A large antenna servo system [4] is used as a simulation example. This model is a large antenna used for deep-space exploration, which has huge flexible structure-with 5000 DOF in its finite element model- and nonlinear characteristics such as friction, tooth gap, speed limit ring, etc. The eighteen order modal model of this antenna can be obtained with system identification technique, based on which the simulation is conducted. The simulation block diagram is the same as shown in Fig. 3, LQG weight matrixes optimization and control are programmed in MATLAB.
Since the model is given as modal equations, weight matrixes Q and R are selected as a diagonal matrix and a positive constant r, respectively, in applying the ABC algorithm into our simulation example. The diagonal elements q1i (i=1, 2, ..., 18)of Q and r are defined as the parameters to be optimized, which are structured as x=[ q1i, r], q1i (i=1, 2, …, 18). In the algorithm, the number of swarm is NP=20, maximum iteration step is limit=1000. By optimizing (9), the weight matrixes of LQG are Q=103×diag[0.8876 0.8773 0.9813 0.9991 0.9630 0.9912 0.9921 0.9889 0.6461 0.7963 0.9680 1.0000 0.9142 0.9582 0.5851 0.9892
0.9399 0.9150], R=[0.1].
The dotted line in Fig. 4 is the optimal step response curve obtained with PI controller. The solid line is the step response curve obtained from the system in Fig. 3, in which the LQG weight matrixes are obtained by trial and error. Overshoot of PI controller and LQG+PI controller are very much alike but the peak time and setting time of LQG+PI controller are much shorter.




Fig. 4. PI controller and LQG+PI controller

Applying the optimized parameters into the large antenna servo system with LQG+PI controller as shown in Fig. 3, we obtain the step response curve as shown in Fig. 5. System overshoot fall from 20% to 0.05% after optimization with the algorithm and is more resistive to external disturbances. The improvement of rapidity and stability shows that using ABC algorithm in LQG controller parameter optimization is superior to the trial and error method.

Conclusions

In this paper, an optimization method to obtain the weight matrixes in LQG controller based on artificial bee colony algorithm is proposed. A reference model is obtained with the expected close-loop performance, weight matrixes are optimized so that the designed servo system can have the most identical characteristics with the reference model. ABC algorithm can automatically select and optimize the weight matrixes of LQG controller, eliminating the cumbersome and complex trial and error process and improving the efficiency of LQG controller design. Simulations on a large antenna servo system demonstrate the feasibility and effectiveness of the algorithm. Applying the optimized weight matrixes into a large antenna servo system, rapidity, stability and overshoot of the system are greatly improved than before.

Fig. 5. System response with optimized PI + LQG controller


Acknowledgements

This work was financially supported by the Fundamental Research Funds for the Central Universities under Grant No. K50510040002.


References

Zhang M, Zhang WG, Sun Y. LQG/LTR flight control law optimal design based on Neal-Smith criteria. Flight Dynamics 2011; 29(5): 49-53.
Karaboga D, Basturk B. A powerful and efficient algorithm for numerical function optimization: artificial bee colony (ABC) algorithm. Journal of Global Optimization 2007; 39(3): 459-471.
Karaboga D, Basturk B. On the performance of artificial bee colony (ABC) algorithm.Applied Soft Computing 2008; 8(1): 687-697.
Karaboga D, Basturk B. Artificial bee colony(ABC) optimization algorithm for solving constrained optimization problems. LNCS: Advances in Soft Computing:Foundations of Fuzzy Logic and Soft Computing.Berlin:Springer-Verlag 2007; 4529: 789-798.
He GL, Li GM, Liu M, Huang Y. LQG Controller with Wind Gust Disturbance Rejection Property for Cassegrain Antenna. In Proceedings of 2009 IEEE International Conference on Intelligent Computing and Intelligent Systems. Piscataway, USA: IEEE 2009; 2: 344-348.
Gawronski WK. Advance Structural Dynamics and Active Control of Structures. New York: Springer; 2004.
Gawronski WK. Control and Pointing Challenges of Large Antennas and Telescopes. IEEE Transactions on Control Systems Technology. 2007, 15(2): 276-287.
Gawronski WK. Antenna Linear - Quadratic - Gaussian (LQG) Controllers: Properties Limits of Performance and Tuning Procedure. IPN Progress Report 2004; 42(158): 1-18.

Contact of Corresponding Author:
Weidong Wang, Email address: wangwd@mail.xidian.edu.cn, Mobile Telephone: +86-139-9288-4258.
