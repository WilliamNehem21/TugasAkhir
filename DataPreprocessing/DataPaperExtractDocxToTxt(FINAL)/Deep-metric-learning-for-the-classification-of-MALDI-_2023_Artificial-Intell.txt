Artificial Intelligence in the Life Sciences 3 (2023) 100071

		




Deep metric learning for the classification of MALDI-TOF spectral signatures from multiple species of neotropical disease vectors
Fernando Merchana,f, Kenji Contrerasa, Rolando A. Gittensb,f, Jose R. Loaizab,c,d,f,
Javier E. Sanchez-Galanb,e,f,‚àó
a Facultad de Ingenier√≠a de El√©ctrica, Universidad Tecnol√≥gica de Panam√°, Campus Victor Levi Sasso, Panama, Panama
b Centro de Biodiversidad y Descubrimiento de Drogas, Instituto de Investigaciones Cient√≠ficas y Servicios de Alta Tecnolog√≠a (INDICASAT AIP), City of Knowledge,
Panama, 0843-01103, Panama
c Smithsonian Tropical Research Institute, Panama, Panama
d Programa Centroamericano de Maestr√≠a en Entomolog√≠a, Universidad de Panama, Panama, Panama
e Facultad de Ingenier√≠a de Sistemas Computacionales, Universidad Tecnologica de Panama, Campus Victor Levi Sasso, Panama, Panama
f Sistema Nacional de Investigaci√≥n (SNI), Secretaria Nacional de Ciencia, Tecnologia e Innovacion (SENACYT), Panama, Panama


a r t i c l e	i n f o	a b s t r a c t

	

Keywords:
MALDI-TOF
Machine learning Metric learning Culicidae Ixodidae
Molecular taxonomy
Deep Learning techniques have significant advantages for mass spectral classification, such as parallelized signal correction and feature extraction. Deep Metric Learning models combine Metric Learning to determine the degree of similarity or difference between a set of mass spectra with the generalization power of Deep Learning to improve feature extraction even further. The two most popular of these models combine multiple neural networks with identical architectures and are commonly called Siamese (SNN) and Triplet Neural Networks (TNN). Herein, using both SNNs and TNNs, we intended to taxonomically categorize two sets of previously-validated mass spectra that corresponded to 30 species of Neotropical arthropods in the Culicidae and Ixodidae families, some of which are disease vectors. The effectiveness of SNNs and TNNs to correctly classify 826 spectra from 12 mosquito species and 310 spectra from 18 species of hard ticks was highly effective, with both algorithms performing with minimal average loss during cross-validation. SNNs produced accuracy rates for ticks and mosquitoes of 91.22% and 94.46%, respectively, while accuracy rates of 93% and 99% were obtained with TNNs. Our results indicate that Deep Metric Learning is a practical machine learning tool for quickly and precisely classifying MALDI-TOF- generated mass spectra of Neotropical and public-health-relevant arthropod species.





Introduction

At the forefront of public health concerns is the global threat from emerging vector-borne zoonotic diseases, which is increasing with the continuous geographical expansion of humans and vector species, and the spread of novel pathogens [1]. Despite historical efforts to prevent the spillover of pathogens from wildlife into people, the risk of emerging vector-borne diseases is still high in many regions around the world, particularly in developing countries such as Panama where large socio- economically vulnerable indigenous communities reside [2].
Several vector-borne pathogens present in Panama, including mosquito-transmitted Plasmodium (e.g., malaria) and tick-transmitted pathogenic Rickettsia (e.g., Rocky Mountain spotted fever), are only mitigated by the elimination and monitoring of vector populations [3,4]. However, most studies on arthropod species in Panama have concentrated on a few species, and the vast majority of species re-
main unstudied to this day [5,6]. This is in part due to the diÔ¨Écul- ties encountered when trying to lab-raise rare species, as well as the lack of accurate, reliable, and cost-effective species identification meth- ods other than the traditional morphological identification techniques. Moreover, cryptic species complexes are a group of taxa with similar morphologies that belong to different evolutionary units and are eas- ily confused with one another when recognized using morphological characters [2,7].
Accordingly, developing novel identification approaches for arthro- pods that can accurately and rapidly catalog the large biodiversity of arthropods that exist, is a topic of great interest in Panama [8,9], where several vector-borne diseases are still common [10,11]. With the largest number of described species of mosquitoes and hard ticks in Central America, Panama offers an unique opportunity to assess the usefulness of novel techniques to taxonomically characterize this elevated biodi- versity. Previous work in Panama has established the presence of 265


‚àó Corresponding author.
E-mail addresses: fernando.merchan@utp.ac.pa (F. Merchan), javier.sanchezgalan@utp.ac.pa (J.E. Sanchez-Galan).

https://doi.org/10.1016/j.ailsci.2023.100071
Received 29 December 2022; Received in revised form 2 April 2023; Accepted 3 April 2023
Available online 6 April 2023
2667-3185/¬© 2023 The Authors. Published by Elsevier B.V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/)



mosquito species and 23 Ixodid tick species that can parasitize wildlife and humans [2,7].
Mass Spectrometry (MS) is a high-performance analytical tool that can be employed to characterize and identify complex biological sam- ples. There exist different techniques to acquire spectral signals. One of particular interest in this work is known as Matrix-Assisted Laser Des- orption/Ionization - Time of Flight or MALDI-TOF, which is considered a two-dimensional method geared to understand complex molecular sam- ples via ionization and later time-of-flight discrimination [12,13]. Be- sides ‚Äútrue‚Äù proteomics, an exciting and growing application of MALDI- TOF MS is the use of protein profiles, or ‚Äúmass fingerprints‚Äù, to identify species of microorganisms [14], and more recently of arthropod speci- mens, from eggs all the way to adults [15‚Äì18]
A typical MALDI-TOF mass fingerprint experiment generates a large number of spectral signals that must be pre-processed before machine learning algorithms can automatically classify and identify arthropod species [19,20]. Mass spectral features allow for the identification of distinct biomarkers that characterize different biological species. For in- stance, MALDI-TOF has been previously used in Panama by our team, for species identification in two of the most important taxonomic families of arthropods that contain vectors of disease: Culicidae (i.e., mosquitoes) [2,16,21] and Ixodidae (i.e., hard ticks) [7].
Loaiza et al. [2] and Gittens et al. [7] used Principal Component Analysis (PCA) [22] and Linear Discriminant Analysis (LDA) [23] to categorize Panama‚Äôs mosquitoes and ticks mass spectra, respectively, acquired from samples stored under various conditions (e.g., dry-frozen or in alcohol at room temperature). Both of these algorithms focus on transforming the input data unto an orthogonal sub-space in which new features allow to discard irrelevant information, improving classifica- tion eÔ¨Éciency. This type of machine learning framework is preceded by a pre-processing stage consisting of signal smoothing (Savitzky-Golay filter) and baseline correction to remove noise and improve performance classification. Another approach by L√≥pez-Fern√°ndez et al. [24] featured a software platform named Mass-Up which implemented unsupervised learning algorithms together with PCA to facilitate the pre-processing and analysis of MALDI spectra. However, these types of algorithms may not be eÔ¨Écient or robust enough to continuously learn and reliably clas- sify mass spectra from various arthropod families, collected and stored with different techniques and processed and analyzed with different pa- rameters and equipment.
Another branch of machine learning that shows promise for mass spectra analysis and classification is Deep Learning, which comprises all the techniques and algorithms related to Artificial Neural Networks (ANN). The inception of these algorithms was inspired by the function- ing of neurons in the human brain. These models carry out an adaptive learning process through multiple nonlinear mathematical transforma- tions based on multivariable calculus and tensor algebra [25].
Deep Metric Learning is a technique that combines Deep Learning elements with the concept of Metric Learning (MeL), in which a model attempts to learn features from objects (such as signals and images) por- trayed as numerical vectors in terms of their distance and location in a multidimensional space. This concept implies that two vectors in a neighboring space will have similar features, while distances between them indicate varying degrees of dissimilarity [26]. A classic example of MeL algorithms corresponds to K-Nearest Neighbors (K-NN) [27], which performs the classification process based on a distance metric (e.g., Eu-
clidean, angular [cosine], Manhattan) to a reference sample and the ùëò
neighboring samples that are in the nearby vector space.
To understand the differences between Deep Metric Learning and Deep Learning-based methods, one may consider the analogy of a person (i.e., an intelligent model) learning to discriminate between different ob- jects in a given data set. One approach to this task is for the person to carefully study the defining characteristics of each class of objects (i.e., Deep Learning). Alternatively, the person learns to determine the simi- larities between objects regardless of their predetermined label. Further- more, one can illustrate both methodologies by describing how a ma-
Table 1
Anopheline mosquito species data set obtained from Loaiza et al. [2].



chine learning model learns to classify an object (Fig. 1). For example, classical neural networks learn a feature space or representation (a set of all possible numerical values of a class), while Deep Metric Learning methods seek to generate an embedding, an alternative characterization of the original data projected into a latent space (i.e., a low-dimensional space generated to preserve the most prominent features) where similar objects appear closer [26].
Some mass fingerprinting applications related to Deep Learning in- clude the work of Rakotonirina et al. [28], which employed Convolu- tional Neural Network (CNN) models to detect the presence of the Wol- bachia bacteria in the mosquito Aedes aegypti. The study featured a vot- ing scheme in which the MALDI spectra dataset was partitioned into 15 parts, each of which was modelled by a similar neural network, and the final inference was computed by considering each model predic- tion. Moreover, computer vision has been used to test the effectiveness of Transfer Learning models to improve the identification of triatomine bugs that transmit Chagas disease to humans across the Americas [29]. In recent years with the advent of machine learning oriented frameworks utilizing Deep Learning [30] models, new approaches have been imple- mented in the context of arthropod detection and classification using CNN [31]. However, to our knowledge no previous studies have applied Deep Metric Learning for the rapid identification of arthropods from the biodiverse Neotropical region. In the work presented here, advanced feature extraction techniques based on Deep Learning and CNN, pur- posely designed to work with mass spectra without any pre-processing, were used to improve the classification tasks of Neotropical mosquito and tick species, some of which are important disease vectors.


Materials and methods

MALDI-TOF MS data sets

Two previously published data sets of MALDI-TOF spectra from Neotropical arthropods were used, belonging to the taxonomic fami- lies Culicidae (i.e., mosquitoes) [2] and Ixodidae (i.e., hard ticks) [7]. All the methods for sample collection in the field, sample processing (i.e., protein extraction from arthropod legs), MALDI-TOF analyis and spectra selection were described in detail in the cited studies. In brief, we com- piled samples from 12 distinct biological species of mosquitoes (Table 1) and 18 distinct biological species of ticks (Table 2), each species with a different number of specimens and, thus, a different number of spectra collected. All the samples were pre-identified using morphological keys. Mosquitoes were stored dry-frozen before MS analysis, while ticks had been stored for several years in 70% ethanol. For spectra selection into the database, three technical replicates were collected from each speci- men, and each spectra had to meet a minimum criterion of at least one peak with an intensity of 3500 arbitrary units (a.u.) for mosquitoes, and 1000 a.u. for ticks (Fig. 2).




Fig. 1. Graphical representation comparing traditional feature learning methods with metric learning.

Fig. 2. Example of a raw spectrum of tick species Amblyomma naponense, collected as in- tensity vs. m/z (mass over charge), with a molecule size varying from 0 to 50,000 Da.























Machine learning architecture: Convolutional neural networks (CNN)

CNN have been the most commonly employed architectures in recent years for image recognition, classification, and detection tasks. This class of neural networks has three main types of layers that perform the oper- ations of convolution, pooling (for feature extraction) and classification by means of an ANN. These architectures are made up of modules or blocks that are stacked one after the other depending on the complexity of the model [30].
The network architecture utilized in this study (Fig. 3) draws inspira- tion from the classic convolutional architecture, LeNet [32]. The design includes parameters and an activation function called Leaky ReLu [33], which mitigates the vanishing gradient issue that can make the neural network struggle to learn new data due to very small changes in param- eter optimization during training.
Additionally, the last layer, which produces embeddings, includes
G2 normalization [34], which aims to maximize the distance between
positive (similar) and negative (different) samples [35]. Additionally, to address the challenge of unbalanced classes, we applied the technique of class weights [36]. This technique penalizes the misclassification of minority classes within the data set.
The final architecture comprises three convolutional blocks, each with one-dimensional convolution layers. The first block has 32 filters, the second has 16 filters, and the third has 8 filters. Batch normalization
[37] is applied to each convolutional block. The dense layers consist of 32 and 16 neurons and incorporate dropout. Finally, the optimizer al- gorithm used is Adaptive Moment Estimation (ADAM) [38].



Siamese neural networks (SNN)
The SNN consist of a pair of interconnected neural networks with identical parameters that are trained in parallel, whose unified ar- chitecture and learning is governed by the contrastive loss function




Fig. 3. Diagram of the unified architecture used for the analysis of both data sets.

Fig. 4. Graphical representation of the unified architecture of a Siamese neural network.











Table 2
Ixodid tick species data set obtained from Gittens et al. [7].
tween similar samples is smaller than ùõº, while the distance between dissimilar samples is larger than ùõº.
This structure is similar to that of the binary cross-entropy loss func- tion, which is commonly used in binary classification problems [40]. The main advantage of this loss function is that it allows for a multi- class problem to be translated into a binary classification problem. This enables the model to perform flexible comparisons, such as comparing one class to many by making pairs consisting of one species and many others. This flexibility is particularly useful in problems where there are many classes and comparisons between classes are important for the analysis, such as in the case of arthropod species.

Triplet neural networks (TNN)
The (TNN) are considered an extension of SNN because of the unified architecture with identical parameters and the learning technique that attempts to train a model to minimize intra-class distance and maximize inter-class distance between classes of objects [41] (Fig. 5). However, the Triple Loss function (Eq. (3)) is used to learn how to generate an
embedding space ùëî(ùë•) by computing the distance between triplets of
samples.

[39] (Fig. 4), given by Eq. (1):
ùëá ùêøùëúùë†ùë† =	‚àë
ùëöùëéùë•{ùëë(ùë•ùëé, ùë•ùëù) + ùõº ‚àí ùëë(ùë•ùëé, ùë•ùëõ), 0}+	(3)

1	1	ùëé,ùëù,ùëõùë¶ùëù =ùë¶ùëé ,ùë¶ùëõ ‚â†ùë¶ùëé

ùê∂ùêøùëúùë†ùë† = (1 ‚àí ùë¶) 2 (ùëë) + (ùë¶) 2 max {0, ùõº ‚àí ùëë}	(1)
A triplet is formulated based on an anchor ùë•ùëé, a positive ùë•ùëù
and a neg-

where,
ùëë(ùë•1, ùë•2) = ‚Äñùëî(ùë•1) ‚àí ùëî(ùë•2)‚Äñ

(2)
ative ùë•ùëõ sample, each with their respective labels (ùë¶ùëé, ùë¶ùëù, ùë¶ùëõ), under the
condition that ùë¶ùëù = ùë¶ùëé and ùë¶ùëõ ‚â† ùë¶ùëé, where the Euclidean distance (ùëë) is

‚Äñ	‚Äñ	calculated based on the embeddings generated by the neural networks

The contrastive loss function [39] (Eq. (1)) aims to optimize the per- formance of the classification model by measuring the similarity be-
tween pairs of samples, denoted by a binary label ùë¶,where ùë¶ = 0 denotes
similarity between samples and ùë¶ = 1 denotes dissimilarity. The func- tion takes in two input samples, ùë•1 and ùë•2, and calculates the Euclidean
distance between their respective embeddings (i.e., mapping functions
ùëî(ùë•1) and ùëî(ùë•2)). Then, the difference between embeddings is computed and normalized to form the distance measure, ùëë(ùë•1, ùë•2).
During training, the parameters of ùëî(ùë•ùëõ) are adjusted to minimize
the loss (error rate) by reducing the distance measure between similar
samples while maximizing it between dissimilar samples. This is, the function optimizes an embedding space where similar spectra are in the
is completed by setting a threshold value (ùõº) such that the distance be- same embedding neighborhood while dissimilar ones are distant. This
(Fig. 5).
Unlike SNNs that can be trained directly with random pairs of sam- ples generated during the training, TNNs require a stage of triplet selec-
represents a high and ineÔ¨Écient cubic computational complexity U(ùëõ)3, tion, since training a network with all possible triplets from a data set
and not all triplets contribute to the eÔ¨Écient learning of the network.
A way to understand the necessity of selecting the right triplets to feed to a neural network is to assume that a model, like a human being, learns better to identify diverse objects from studying hard examples where the different classes have similar or near identical features. Ac- cording to this assumption and the work of Schroff et al. [41], one of the most eÔ¨Écient methods is to generate triplets during the training cycle (epoch) and only employ the hard triplets generated from the mini batch of samples at each part of the cycle, also known as Online Triplet Mining




Fig. 5. Graphical representation of the unified architecture of a triple neural network.
Fig. 6. Description of the types of triplets based on the parameter ùõº.
































[26]. The selection criteria also depends on the threshold parameter ùõº
(Fig. 6).
Moreover, it is necessary to remark that TNNs are used as a method of feature extraction, unlike SNNs where both feature extraction and classification are performed by the same architecture. The neural net- works will have their parameters optimized during training to produce a new embedding space where another metric learning model (in this case, K-NN) will perform the multi-class classification stage.

Data analysis: Experimental settings

Data sets used in this study are described in Tables 1 and 2 with a total of 826 mosquito and 310 tick spectra, respectively. The distri-
bution of samples for model training and testing was 80%/20% in the case of mosquitoes, as had been the case with our previously published machine learning algorithms [2,7], but had to be adjusted for ticks to 70%/30% as will be described ahead. As explained in Section 2.2, the usage of CNN allowed to train models with input raw spectra without the
training was to take ùëõ first features of each spectra sample (according need for significant pre-processing steps. Therefore, the only step before
to the smallest spectrum of the data set), yielding numerical arrays of
ùëõ = 52906 and ùëõ = 52570 features for ticks and mosquitoes respectively.
Due to the special training scheme that SNN architectures imply
(Section 2.2.1), pairs of samples were first generated randomly, main- taining a similar distribution of samples between the different classes to avoid biases due to sample imbalance (Table 3). After performing



Table 3
Distribution of spectra for training and validation with SNN.


Table 4
Distribution of spectra for training and validation with
TNN.


Table 5
Generic Confusion Matrix.



manual parameter experimentation, we selected the threshold value of
ùõº = 0.55 for both ticks and mosquitoes.
For the TNN, the ùõº was set to 0.4, and it should be noted that the
best performance for TNN training was achieved using an Online Triplet
Mining scheme with Hard Negative Triplets (Fig. 6). Furthermore, this prompted an adjustment to 70%/30% train/testing data splitting for the tick‚Äôs data set, which had more classes with fewer samples per class compared to mosquitoes (Table 4). Ultimately, this adjustment was nec- essary to avoid computational errors produced during the validation stage after each training epoch, where the mining algorithm failed to find triplets that fulfill the similarity criteria described in Section 2.2.2.
trained with k-fold cross validations, with ùëò = 5, for 30 epochs with a Furthermore, in order to avoid over-fitting, the SNN models were
batch size of 16 samples. The TNN were trained with a batch size of 24 samples, using a K-ShuÔ¨Ñe Split validation scheme (also known as Monte Carlo Cross Validation) for 20 iterations and 32 epochs in each one. This validation scheme produces better results when dealing with data sets containing limited samples per class [42].

Evaluation metrics

Error metrics were calculated for each model and data set combi- nation. A confusion matrix listing True Negatives (TN), True Positives (TP), False Negatives (FN) and False Positives (FP) was also used to rep- resent the total number and proportion of samples that were correctly or incorrectly predicted (Table 5).
Moreover, using the items of the confusion matrix, other error met- rics such as Accuracy, Precision, Recall and F1-score (Eqs. 4‚Äì7, respec- tively) were computed and later compared for each model.
Table 6
Resulting confusion matrix for the SNN model for the mosquito data set.
 	



Table 7
Resulting confusion matrix for the SNN model for the ticks data set.




Software and hardware specifications

The models developed in this work have been implemented using the Python programming language, with open-source software libraries such as: Tensorflow [43], Scipy [44] and Scikit-learn [45]. Deep Learn- ing models were trained on the Google Colab [46] online platform with a Tesla T4 GPU with 16GB VRAM.
Additionally, to illustrate the particular learning process of the mod- els based on Deep Metric Learning, embedding visualizations were cre- ated using the dimension reduction algorithm called pacmap [47].


Results

Classification with siamese neural networks (SNN)

SNN models exhibited good performance to classify mosquitoes (Fig. 7) and ticks (Fig. 8) mass spectra. The training loss and accuracy of SNN with the mosquito data set improved considerably after the first cross-validation (Fig. 7A and C, Fold 1 in blue), which was the only iteration that clearly separated from the rest. Similarly, the loss and ac- curacy average for the validation stage using the remaining 20% of the data set also seemed to converge from Fold 2 to 5 (Fig. 7B and D) for mosquitoes and Fig. 8-B, D for ticks. The jagged and oscillating curves in these validation graphs could be signs of slight over-fitting, with Fold 3 (green line) exhibiting the greatest instability. However, after Fold 4 and Fold 5 the model seems to have reached a stable steady state, mean- ing that it successfully learned to distinguish from existing species with a final loss and accuracy average of 0.0392 and 91.22%, respectively.
The results of the SNN model performance with the tick data set was

ùê¥ùëêùëêùë¢ùëüùëéùëêùë¶ = 	ùëá ùëÉ + ùëá ùëÅ	
ùëá ùëÉ + ùëá ùëÅ + ùêπ ùëÉ + ùêπ ùëÅ
ùëÉ ùëüùëíùëêùëñùë†ùëñùëúùëõ =   ùëá ùëÉ	
ùëá ùëÉ + ùêπ ùëÉ
ùëÖùëíùëêùëéùëôùëô =   ùëá ùëÉ	
ùëá ùëÉ + ùêπ ùëÅ
ùêπ 1 ‚àí ùëÜùëêùëúùëüùëí = 2 ‚àó ùëÉ ùëüùëíùëêùëñùë†ùëñùëúùëõ ‚àó ùëÖùëíùëêùëéùëôùëô = 	2 ‚àó ùëá ùëÉ	
ùëÉ ùëüùëíùëêùëñùë†ùëñùëúùëõ + ùëÖùëíùëêùëéùëôùëô	2 ‚àó ùëá ùëÉ + ùêπ ùëÉ + ùêπ ùëÅ
(4)

(5)

(6)

(7)
very similar to the mosquitoes, except for the fact that the model seemed to require Fold 3 or more to reach peak accuracy in training and vali- dation (Fig. 8B and C). In addition, training and validation curves im- proved ‚Äúslower‚Äù but had less instability than mosquito curves, although Fold 4 and 5 also offered the best performance, with a final loss of 0.0185 and accuracy average of 94.46%.
Confusion matrices were computed for each model, and are shown in Table 6 for mosquitoes and in Table 7 for ticks. In general, the SNN model for mosquitoes had around 95% of True Positives (TP) and 89% for True Negatives (TN), while the numbers were reversed for ticks, with 89% for TP and almost 94% for TN. Error metrics were also calculated

In general, the accuracy corresponds to the number of samples that
were correctly predicted in their particular class (i.e., species) among the total number of samples used in the test.
for the SNN models and are shown in Table 8. Evaluating all the pa-
rameters considered in the error metrics, the model was able to achieve 91% in all of them, varying only on the third decimal.




Fig. 7. Loss and Accuracy curves shown for Training (A, C) and Testing Validation (B, D) using the SNN model for the mosquitos data set).


Table 8
Resulting Metrics for the SNN model using both sets of spec- tra.




Classification with triplet neural networks (TNN)

TNN models were very effective at classifying mass spectra data sets and outperformed SNN models. At the end of the entire training and validation cycle, the minimum validation loss reached by the TNN mod- els was 0.00001 for mosquitoes and 0.0160 for ticks. Furthermore, the error metrics of accuracy and F1-Score obtained for both knn models with their respective test sets reached up to 99.7% for both parameters in the mosquito data set, and 93.2% and 91.4%, respectively, for ticks (Table 9).
The Confusion matrices shown in Fig. 9, explore which species are easier to to predict for both mosquitoes and ticks. In the case of mosquitoes, the matrix showed correct predictions for all except one
Table 9
Error metrics for the TNN model for both data sets.



species at a 100%, failing only in a sample of the Anabm (Anopheles al- bimanus) that was misclassified as Anowd (Anopheles oswaldoi). For ticks the results were similar, but with slightly more misclassifications, such as a sample from Amb Caj (Amblyomma cajennense) species wrongly clas- sified as Amb Obl (Amblyomma oblongoguttatum), a sample from Derm Nit (Dermacentor nitens) misclassified as Rhi Mic (Rhipicephalus microplus) species, another sample of Hae Jux (Haemaphysalis juxtackochi) misclas- sified as Derm Nit (Dermacentor nitens), and finally a sample of Rhi San (Rhipicephalus sanguineus) classified mistakenly within the Amb Gea (Am- blyomma geayi).

Triplet neural networks embedding visualizations

The embedding generated by TNN was graphed in two dimensions for a simple visualization of mosquitoes (Fig. 10) and ticks (Fig. 11) data




Fig. 8. Loss and Accuracy curves shown for Training (A, C) and Testing Validation (B, D) using the SNN model for the ticks data set).


sets. These graphs provide a visual representation of how the model learns to separate and/or join samples depending on their degree of similarity.
For example, the embedding prior to TNN training clearly demon- strates that samples of one species of mosquito (Fig. 10A) or ticks (Fig. 11A) can be found anywhere on the map, whereas after the network is trained, samples of the same species are closely clustered together and species with similar spectral characteristics form neighborhoods or clus- ters where each point represents one spectrum (Figs. 10B and 11 B).


Discussion

In our previous work establishing these self-curated data sets and an- alyzing them with PCA and LDA machine learning algorithms [2,7], we compared the smoothed and baseline-corrected spectra generated from unidentified field-collected arthropod samples with the mean spectra from a subset of the same field-collected samples that had already been identified using conventional morphological methods. The main con- tribution of these studies was to show a way around working without a commercial reference library of protein spectra profiles, using what we called the ‚Äúself-curated reference library‚Äù concept. Because we are not using high-quality, lab-reared specimens to train the algorithm, this methodology required such pre-processing of the spectra to provided an accurate, and unbiased method to identify mosquito and tick species,
with global positive identification rates of 93.3% for mosquitoes and 94.2.0% for ticks.
Here, we broadened the scope of data analysis by applying two Deep Metric Learning techniques to the same two MALDI-TOF data sets. Our idea of using Deep Metric Learning comes from the fact that these net- works have a collective architecture that eliminates the need for spec- tral pre-processing steps as well as classification algorithms to discrimi- nate the taxonomic identity of different arthropod species. The ability to rapidly and effectively classify arthropod species from distantly related species is one of the benefits of using these types of networks, which have proven to be highly eÔ¨Écient to analyze complex mass spectrome- try data sets from two of the most important arthropod groupings in the Neotropics.
Roughly 1150 MALDI-TOF spectra from 30 arthropod species, some of which are vectors of disease (i.e., 826 spectra from 12 mosquito species and 310 spectra from 18 tick species), were successfully clas- sified using both SNN and TNN networks. For the SNN, the validation step at the end of each iteration with a subset of 20% of the spectra yielded an average loss and accuracy of 0.0392 and 91.22% for ticks and an average loss and accuracy of 0.0185 and 94.46% for mosquitoes, respectively. In comparison, the TNN validation step at the end of each iteration with 20% of the spectra yielded an average loss and accuracy of 0.00001 and 99% for mosquitoes, and an average loss and accuracy of 0.0160 and 93% for ticks, respectively. Even if the TNN model only im- proved the identification success rate for mosquitoes (i.e., from 93.3%





to 99%), and it actually reduced the success rate for ticks (i.e., from 94.2% to 93%), the improvements in lack of manual prep, speed and computing availability more than justify its implementation.
Our results show that both SNNs and TNNs were capable of rec- ognizing and classifying MALDI spectra from roughly 50% of all hard tick taxa and 70% of all anopheline taxa (e.g., both ecologically dom- inant and rare species) reported for Panama. These results are equiva- lent and sometimes even superior to those from Loaiza et al. [2] and Gittens et al. [7]. Still, the pacmap visualization of the embedding con- firmed that these algorithms are not perfect. Future research will need to look into what caused some samples in Ana_bm, Amb_Caj, Derm_Nit, Hae_Jux, and Rhi_San species to be misclassified. We can only specu- late that some of these misclassifications may be related to poor quality
Fig. 9. Confusion matrices of the TNN model for the mosquito (A) and ticks
(B) data sets.


































































spectra or degraded samples, and not necessarily to biologically-relevant inferences.
There are some additional limitations to this work that need to be discussed. The data sets used in this work come from biological sam- ples that were gathered from the field as opposed to being reared in the laboratory. Besides foreign contaminants that are hard to control in field-collected specimens (i.e., host blood, sap, pathogens), which al- ready present an important challenge to the classification, the data sets also allowed us to test the reliability of the algorithms regarding sam- ple storage. Fresh mosquito specimens had been stored dry-frozen as opposed to ticks that had been stored in ethanol and frozen for several years prior to protein extraction and sample processing with the MALDI- TOF. Ethanol is a well-known protein denaturing agent and we know




Fig. 10. Visualization with pacmap of the embedding produced by the TNN model before (A) and after (B) training for the mosquitos data set.


now that protein mass spectra quality of arthropod specimens stored in 70% ethanol is considerably reduced [7,48,49].
Sample degradation, lower quality spectra and lower number of spec- imens/spectra per species in the tick data set forced us to adjust the training and testing data split for the TNN model. Although the ini- tial experimental plan was to work with the same ratio of 80%/20% training/testing sets for mosquitoes and ticks, we had to adjust the tick data split to 70%/30% to allow the TNN model to find the appropriate triplets for validation and avoid computational errors. Still, 70%/30% or 80%/20% are both typical data splits considered ‚Äúadequate‚Äù for ma- chine learning algorithms, especially when using cross-validation strate- gies [50‚Äì52].
According to Liu et al. [53], the classification of Deep Learning spec- trometry signals presents significant benefits, because the CNN training process acts as a parallel mechanism for pre-processing (e.g., correction of the signal base, curve smoothing) and feature extraction (e.g., peak detection, non-linear features) from the raw spectra. Therefore, a uni- fied architecture would eliminate the need to apply the pre-processing scheme required with the implementation of classical methods like PCA and LDA [2,7]. Additionally, the effectiveness of one-dimensional CNN with a Deep Metric Learning-based schema was demonstrated to mini- mize the diÔ¨Éculties in training a model with a reduced or unbalanced data set [54]. That is, a model with variable availability of samples for
multiple classes, a case that is common in applications where there are several classes of elements to be analyzed and there is not enough infor- mation available to model each class uniformly. This situation generates in most of the implemented models either overfitting or underfitting, caus- ing erroneous predictions and decreased performance [55]. An example would be the case of the mining of precious minerals [53] or the collec- tion of tick specimens [7] where some species (i.e., ‚Äúclasses‚Äù) are very rare or diÔ¨Écult to obtain and therefore few samples are available for the data analysis.
Artificial neural networks (ANN) coupled to MALDI-TOF mass spec- trometry have been recently used to predict drivers of malaria transmis- sion using lab-reared Anopheles stephensi mosquitoes. ANN accurately recognized spectral patterns associated with mosquito age (0‚Äì10 days, 11‚Äì20 days, and 21‚Äì28 days), blood feeding, and Plamodium berghei in- fection, with the best prediction accuracy of 73%, 89%, and 78%, re- spectively [56]. Moreover, MALDI-TOF, coupled with CNN was used to detect Wolbachia bacteria in laboratory reared and field samples of the dengue vector, Aedes aegypti. Findings showed that CNN recognized Aedes aegypti spectral patterns associated with Wolbachia-infection with extremely high sensitivity (i.e., 93%), specificity (i.e., 99%), and accu- racy (97%), being as eÔ¨Écient as qPCR, but surpassing the eÔ¨Éciency of traditional detection methods such as loop-mediated isothermal amplifi- cation (LAMP) [57]. Together, these studies illustrate the potential that




Fig. 11. Visualization with pacmap of the embedding produced by the TNN model before (A) and after (B) training for the ticks data set.


MALDI-TOF MS coupled with artificial intelligence has to predict ento- mological drivers of disease transmission, providing potential new tools for vector control.
To the best of our knowledge, this is the first attempt to classify MALDI-TOF data from arthropods from the Neotropics using Deep Met- ric Learning techniques that employ Metric Learning techniques with neural networks as a feature extraction method, including models that combine multiple neural networks with identical architectures com- monly known as Siamese and Triplet Neural Networks. Our results indi- cate that Deep Metric Learning is yet another practical machine learning tool for quickly and precisely classifying MALDI-TOF-generated mass spectra of public-health-relevant arthropod species.

Conclusion

Rapid identification of arthropod species using mass spectra finger- printing continues to offer a promising tool for entomologist and public- health specialist, specially in biodiverse regions such as the Neotropics. One of the long term goals of our group is to develop an online, crowd- sourced and open-source database, based on novel machine learning algorithms that can continuously grow and learn across arthropod fam- ilies, and can improve the eÔ¨Éciency and accuracy of species identifica- tion regardless of sample preparation and analysis parameters. Our re-
sults here presented, where we successfully applied Deep Metric Learn- ing techniques to two relevant and distinct data sets from the Culicidae and Ixodidae arthropod families, bring us one step closer to that goal.
We developed an analytical method for the evaluation of MALDI-TOF spectra utilizing SNN and TNN networks to quickly identify mosquito and tick species based on their protein mass spectra without the use of spectral pre-processing techniques or classification algorithms. Our results show that both SNN and TNN networks were capable of accu- rately classifying spectra from up to 30 different field-collected arthro- pod species, some of which are important disease vectors in Panama and more broadly in the Neotropics. Future studies should look into how well this approach can differentiate between other important Neotropical arthropod assemblages, including the triatomine bugs and Phlebotom- inae sand flies that transmit Leishmaniasis and Chagas disease. Simply put, our approach is adaptable and can be applied more broadly in other tropical regions of the world with high species diversity of arthropods and cryptic species complexes.

Declaration of Competing Interest

The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.



Data availability

Data will be made available on request.


Acknowledgments

Financial support for this work was provided by SENACYT through the research grant GRID15-002 to JRL, JSG, and RAG. INDICASAT-AIP, UTP and STRI provided additional economic and logistic support. The SNI supports research activities by JRL, JSG, FM and RAG. RAG is also supported by SENACYT grants FID14-066, ITE15-016. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.

References

Weaver SC, Reisen WK. Present and future arboviral threats. Antiviral Res 2010;85(2):328‚Äì45.
Loaiza JR, Almanza A, Rojas JC, Mej√≠a L, Cervantes ND, Sanchez-Galan JE, et al. Ap- plication of matrix-assisted laser desorption/ionization mass spectrometry to iden- tify species of Neotropical anopheles vectors of malaria. Malar J 2019;18(1):1‚Äì 12.
Lainhart W, Dutari LC, Rovira JR, Sucupira IM, P√≥voa MM, Conn JE, et al. Epidemic and non-epidemic hot spots of malaria transmission occur in indigenous comarcas of Panama. PLoS Negl Trop Dis 2016;10(5):e0004718.
Miller MJ, Esser HJ, Loaiza JR, Herre EA, Aguilar C, Quintero D, et al. Molecular ecological insights into Neotropical bird‚Äìtick interactions. PLoS ONE 2016;11(5):e0155989.
Loaiza JR, Dutari LC, Rovira JR, Sanjur OI, Laporta GZ, Pecor J, et al. Disturbance and mosquito diversity in the lowland tropical rainforest of central Panama. Sci Rep 2017;7(1):1‚Äì13.
Loaiza JR, Rovira JR, Sanjur OI, Zepeda JA, Pecor JE, Foley DH, et al. Forest distur- bance and vector transmitted diseases in the lowland tropical rainforest of central Panama. Trop Med Int Health 2019;24(7):849‚Äì61.
Gittens RA, Almanza A, Bennett KL, Mej√≠a LC, Sanchez-Galan JE, Merchan F, et al. Proteomic fingerprinting of Neotropical hard tick species (Acari: Ixodi- dae) using a self-curated mass spectra reference library. PLoS Negl Trop Dis 2020;14(10):e0008849.
Jim√©nez MG, Babayan SA, Khazaeli P, Doyle M, Walton F, Reedy E, et al. Prediction of mosquito species and population age structure using mid-infrared spectroscopy and supervised machine learning. Wellcome Open Res 2019;4.
Ye S, Lu S, Bai X, Gu J. ResNet-Locust-BN network-based automatic identifica- tion of east asian migratory locust species and instars from RGB images. Insects 2020;11(8):458.
Guglielmone AA, Robbins RG, Apanaskevich DA, Petney TN, Estrada- Pe√±a A, Horak IG. The hard ticks of the world. Dordrecht: Springer; 2014. doi:101007/978-94-007-7497-1.
Murugaiyan J, Roesler U. MALDI-TOF MS profiling-advances in species identifica- tion of pests, parasites, and vectors. Front Cell Infect Microbiol 2017;7:184.
Perez-Lao E, Sanchez-Galan J, Gittens R. Assessing the performance of different sam- ple targets for a MALDI-TOF mass spectrometer. In: 2014 IEEE Central America and Panama Convention (CONCAPAN XXXIV). IEEE; 2014. p. 1‚Äì4.
Mansilla E.C., Moreno R.C., Garc√≠a M.O., S√°nchez B.R., P√©rez J.d. D. C., Bellido J.L.M.. Aplicaciones de la espectrometr√≠a de masas maldi-tof en microbiolog√≠a cl√≠nica.
Levasseur M, Hebra T, Elie N, Gu√©rineau V, Touboul D, Eparvier V. Classifica- tion of environmental strains from order to genus levels using lipid and protein MALDI-ToF fingerprintings and chemotaxonomic network analysis. Microorganisms 2022;10(4):831.
Yssouf A, Almeras L, Raoult D, Parola P. Emerging tools for identification of arthro- pod vectors. Future Microbiol 2016;11(4):549‚Äì66.
Bennett KL, G√≥mez Mart√≠nez C, Almanza A, Rovira JR, McMillan WO, Enriquez V, Barraza E, Diaz M, Sanchez-Galan JE, Whiteman A, et al. High infestation of inva- sive Aedes mosquitoes in used tires along the local transport network of Panama. Parasites Vectors 2019;12(1):1‚Äì10.
Dieme C, Yssouf A, Vega-R√∫a A, Berenger J-M, Failloux A-B, Raoult D, Parola P, Almeras L. Accurate identification of culicidae at aquatic developmental stages by MALDI-TOF MS profiling. Parasites Vectors 2014;7(1):1‚Äì14.
Sevestre J, Lemrabott MAO, B√©renger J-M, Zan Diarra A, Ould Mohamed Salem Boukhary A, Parola P. Detection of arthropod-borne bacteria and assessment of MALDI-TOF MS for the identification of field-collected immature bed bugs from mauritania. Insects 2023;14(1):69.
Bittremieux W. Spectrum_utils: a Python package for mass spectrometry data pro- cessing and visualization. Anal Chem 2019;92(1):659‚Äì61.
R√†fols P, Vilalta D, Brezmes J, Ca√±ellas N, Del Castillo E, Yanes O, et al. Sig- nal preprocessing, multivariate analysis and software tools for MA (LDI)-TOF mass spectrometry imaging for biological applications. Mass Spectrom Rev 2018;37(3):281‚Äì306.
Yssouf A, Parola P, Lindstr√∂m A, Lilja T, LAmbert G, Bondesson U, et al. Identification of european mosquito species by MALDI-TOF MS. Parasitol Res 2014;113(6):2375‚Äì8.
Turk M, Pentland A. Eigenfaces for recognition. J Cogn Neurosci 1991;3(1): 71‚Äì86.
Belhumeur P, Hespanha J, Kriegman D. Eigenfaces vs. Fisherfaces: recognition using class specific linear projection. IEEE Trans Pattern Anal Mach Intell 1997;19(7):711‚Äì
20. doi:10.1109/34.598228.
L√≥pez-Fern√°ndez H, Santos HM, Capelo JL, Fdez-Riverola F, Glez-Pe√±a D, Reboiro‚Äì Jato M. Mass-up: an all-in-one open software application for MALDI-TOF mass spec- trometry knowledge discovery. BMC Bioinformatics 2015;16(1):1‚Äì12.
LeCun Y, Bengio Y, Hinton G. Deep learning. Nature 2015;521(7553):436‚Äì44.
Kaya M, Bilge H≈û. Deep metric learning: a survey. Symmetry (Basel) 2019;11(9):1066.
Cover T, Hart P. Nearest neighbor pattern classification. IEEE Trans Inf Theory 1967;13(1):21‚Äì7.
Rakotonirina A, Caruzzo C, Ballan V, Kainiu M, Marin M, Colot J, et al. Wolbachia detection in Aedes aegypti using MALDI-TOF MS coupled to artificial intelligence. Sci Rep 2021;11(1):1‚Äì11.
Khalighifar A, Komp E, Ramsey JM, Gurgel-Gon√ßalves R, Peterson AT. Deep learn- ing algorithms improve automated identification of chagas disease vectors. J Med Entomol 2019;56(5):1404‚Äì10.
LeCun Y, Bengio Y, Hinton G. Deep learning. Nature 2015;521(7553):436‚Äì44.
Liu K, Li S, Wang L, Ye Y, Tang H. Full-spectrum prediction of peptides tandem mass spectra using deep neural network. Anal Chem 2020;92(6):4275‚Äì83.
LeCun Y, et al. LeNet-5, convolutional neural networks. URL: http://yann lecun com/exdb/lenet 2015;20(5):14.
Dubey S.R., Singh S.K., Chaudhuri B.B.. A comprehensive survey and per- formance analysis of activation functions in deep learning. arXiv preprint arXiv:2109145452021;.
Lewkowycz A, Gur-Ari G. On the training dynamics of deep networks with ùëô_2 regu-
larization. Adv Neural Inf Process Syst 2020;33:4790‚Äì9.
Zhang D, Li Y, Zhang Z. Deep metric learning with spherical embedding. Adv Neural Inf Process Syst 2020;33:18772‚Äì83.
Byrd J, Lipton Z. What is the effect of importance weighting in deep learning?. In: Chaudhuri K, Salakhutdinov R, editors. Proceedings of the 36th international conference on machine learning. Proceedings of Machine Learning Research, vol. 97.
PMLR; 2019. p. 872‚Äì81. https://proceedings.mlr.press/v97/byrd19a.html
Santurkar S, Tsipras D, Ilyas A, Madry A. How does batch normalization help opti- mization? Adv Neural Inf Process Syst 2018;31.
Kingma D.P., Ba J.. Adam: a method for stochastic optimization. arXiv preprint arXiv:141269802014;.
Hadsell R, Chopra S, LeCun Y. Dimensionality reduction by learning an invariant mapping. In: 2006 IEEE Computer society conference on computer vision and pattern recognition (CVPR‚Äô06), Vol. 2. IEEE; 2006. p. 1735‚Äì42.
Buja A, Stuetzle W, Shen Y. Loss functions for binary class probability estimation and classification: structure and applications. In: Working draft, Vol. 3; 2005. p. 13.
November
Schroff F, Kalenichenko D, Philbin J. FaceNet: a unified embedding for face recogni- tion and clustering. In: Proceedings of the IEEE conference on computer vision and pattern recognition; 2015. p. 815‚Äì23.
Shan G. Monte carlo cross-validation for a study with binary outcome and limited sample size. BMC Med Inform Decis Mak 2022;22(1):1‚Äì15.
Abadi M., Agarwal A., Barham P., Brevdo E., Chen Z., Citro C., Corrado G.S., Davis A., Dean J., Devin M., Ghemawat S., Goodfellow I., Harp A., Irving G., Isard M., Jia Y., Jozefowicz R., Kaiser L., Kudlur M., Levenberg J., Man√© D., Monga R., Moore S., Murray D., Olah C., Schuster M., Shlens J., Steiner B., Sutskever I., Talwar K., Tucker P., Vanhoucke V., Vasudevan V., Vi√©gas F., Vinyals O., Warden P., Wattenberg M., Wicke M., Yu Y., Zheng X.. TensorFlow: large-scale machine learning on heteroge- neous systems. 2015. Software available from URL: https://www.tensorflow.org/.
Virtanen P, Gommers R, Oliphant TE, Haberland M, Reddy T, Cournapeau D, et al. SciPy 1.0: fundamental algorithms for scientific computing in Python. Nat Methods 2020;17:261‚Äì72. doi:10.1038/s41592-019-0686-2.
Pedregosa F, Varoquaux G, Gramfort A, Michel V, Thirion B, Grisel O, et al. Scik- it-learn: machine learning in Python. J Mach Learn Res 2011;12:2825‚Äì30.
Bisong E. Building machine learning and deep learning models on Google cloud platform: a comprehensive guide for beginners. Apress; 2019.
Wang Y, Huang H, Rudin C, Shaposhnik Y. Understanding how dimension re- duction tools work: an empirical approach to deciphering t-SNE, UMAP, TriMAP, and PaCMAP for data visualization. J Mach Learn Res 2021;22(201):1‚Äì73. http://jmlr.org/papers/v22/20-1061.html
Rakotonirina A, Pol M, Kainiu M, Barsac E, Tutagata J, Kilama S, Oconnor O, Taran- tola A, Colot J, Dupont-Rouzeyrol M, et al. MALDI-TOF MS: optimization for future uses in entomological surveillance and identification of mosquitoes from new cale- donia. Parasites Vectors 2020;13:1‚Äì12.
Yssouf A, Socolovschi C, Leulmi H, Kernif T, Bitam I, Audoly G, et al. Identifi- cation of flea species using MALDI-TOF/MS. Comp Immunol Microbiol Infect Dis 2014;37(3):153‚Äì7.
Liu L, √ñzsu MT. Encyclopedia of database systems, Vol 6. Springer; 2009.
Chicco D. Ten quick tips for machine learning in computational biology. BioData Min 2017;10(1):35.
An C, Park YW, Ahn SS, Han K, Kim H, Lee S-K. Radiomics machine learning study with a small sample size: single random training-test set split may lead to unreliable results. PLoS ONE 2021;16(8):e0256152.
Liu J, Gibson SJ, Mills J, Osadchy M. Dynamic spectrum matching with one-shot learning. Chemom Intell Lab Syst 2019;184:175‚Äì81.
Liu J, Osadchy M, Ashton L, Foster M, Solomon CJ, Gibson SJ. Deep convolu- tional neural networks for raman spectrum recognition: a unified solution. Analyst 2017;142(21):4067‚Äì74.



Kotsiantis S, Kanellopoulos D, Pintelas P, et al. Handling imbalanced datasets: a review. GESTS Int Trans ComputSci Eng 2006;30(1):25‚Äì36.
Nabet C, Chaline A, Franetich J-F, Brossas J-Y, Shahmirian N, Silvie O, et al. Predic- tion of malaria transmission drivers in anopheles mosquitoes using artificial intelli- gence coupled to MALDI-TOF mass spectrometry. Sci Rep 2020;10(1):1‚Äì13.
Rakotonirina A, Caruzzo C, Ballan V, Kainiu M, Marin M, Colot J, et al. Wolbachia detection in Aedes aegypti using MALDI-TOF MS coupled to artificial intelligence. Sci Rep 2021;11(1):1‚Äì11.
