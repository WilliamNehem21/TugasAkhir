Available online at www.sciencedirect.com



AASRI Procedia 3 (2012) 177 – 183




2012 AASRI Conference on Modeling, Identification and Control
Improved method based on MPF for multi-target tracking
Qing Lin1,a, Yaping Yang*2,b, Ying Yin3, Shitong Wang4 and Dingan Liao5
1,2,4,5School of Computer Science and Telecommunications Engineering, Jiangsu University, Zhenjiang, 212013, China 1School of Computer Science and Technology, Nanjing University of Science and Technology, Nanjing, 210094, China 3School of Information Technology, Southern Yangtze University, Wuxi 214122, China



Abstract.

Particle filter algorithm is poor at consistently maintaining the multi-modality problem and remains particle degeneracy phenomenon. This shortcoming can be addressed through using Mixture Particle Filter (MPF) to model the target distribution as a non-parametric mixture model. According to computational complexity of the particle filter algorithm, Gaussian Particle Filter (GPF) is used. The particle set is obtained by sampling of Gaussian density function instead of re-sampling to improve the computing speed of particle filter algorithm. In this paper, combined with the advantages of GPF and MPF, GM-MPF algorithm is proposed to improve the real-time of MPF. The experimental results show that GM-MPF algorithm can effectively solve the problem of multi-modality, particle degradation and achieve real-time multi-target tracking.

© 2012 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license.
Selection and/or peer review under responsibility of American Applied Science Research Institute

keywords: Particle filter, Mixture Particle filter, Gaussian Particle Filtering, Particle degradation, GM-MPF.


Introduction

Object detection and tracking is an important task in the field of computer vision. Object detection and tracking technology is one of the critical technologies in computer vision. Object detection and tracking has been applied to computer vision applications domain such as video surveillance, traffic control. Object tracking method based on filtering theory is that object tracking transforms to probability density function estimation in image sequences, for example, kalman filter [1] or particle filter [2-4] to track the object. The linear Gaussian system can only be solved by kalman filtering. However, this linear Gaussian assumption does not often establish due to abrupt object motion, camera motion, changing appearance patterns of both object and scene, image noise influence, illumination changes, the complex scene. Particle filtering method is sample-based conditional density propagation by learning the characteristics of dynamic model and visual observation model. It shows good performance to solve non-linear and non-Gaussian problem and deals effectively with object occlusion. Particle filtering has become to a powerful tracking algorithm in the field of object tracking.
Monte Carlo characteristic of particle filter requires a set of particles to accurately express the probability distribution. The calculation can be expensive. The expression of the HSV color information is employed to reduce the computational cost of



*Corresponding author. Tel.:+86-18796083529
E-mail address: xgkx06s003@126.com ,jcs533@qq.com


2212-6716 © 2012 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license. Selection and/or peer review under responsibility of American Applied Science Research Institute doi:10.1016/j.aasri.2012.11.030


each particle [5] in the paper. Monte Carlo-based particle filter algorithm is poor at consistently maintaining the multi-modality problem and remains serious particle degeneracy phenomenon. In recent years contraposing its degeneration phenomenon, the sequence importance sampling (SIS) and the sequence importance resampling (SIR) technique has been proposed. Gaussian particle filter (GPF) [6] algorithm that Gaussian distribution approximates posterior distribution is an improved particle filtering algorithm to reduce the particle computational cost and enhance the real-time. The method is also applies to solve non-Gaussian systems and does not require re-sampling to avoid particle depletion. The jaco vermaak et al proposed Mixture particle filter [7] to solve the multi-modal and non-Gaussian systems. Combined the ability of Mixture particle filter to maintain multi-modality effectively with real-time requirements of GPF, GM-MPF algorithm is proposed in this paper.

Mixture Tracking

Observation model
In this paper HSV color space model is employed to model moving object tracking and observation model to reduce the computational cost. Assume that HSV histogram contains N gray-level ( N  Nh Ns  Ny ).D pixel gray-level index at time t can
be represented by bt d  1,⋯, N corresponding to the color vector yt k  . Color probability nuclear density function
estimation of the candidate region, that is, the probability of d pixel gray-level index at time t is formulated in the paper.


k (n; xt )  

dR ( xt )

 [bt (d )  n] .	(1)



Where  is the Dirac delta,  is normalization constant. With


k(n; xt )  1.Bhattacharyya coefficient is used in this
n1

paper to measure the similarity (2) between the candidate region
K (xt ) and the Object region K * .





[K*, K(xt )]  [1 
n1
1

.	(2)


Where

k (n; xt )

obtained by formula (1) represents the candidate region Color model.
K*k*(n;x0)n1,⋯N represents

reference color model. Finally similarity distribution L  yt xt 
is computed via formula (3).



1	  2
Lyt | x  	e 2  .	(3)
2

State transition model.

In this system, particle filter theory is applied to track object of video. Each object is indicated with rectangle to determine the location and size of the object. Secondly, the system equation is described by a state equation and an observation equation. The speed and direction of object motion associates with that of few frames before, so there are not abrupt changes. In this paper second-order autoregressive process is used to represent the state equation mutation and observation equation is mainly based on the HSV color histogram model.

Observation equation: Xt  X  A1( Xt 1  X )  A2( Xt 2  X )  B0t .	(4)



Where X represents the mean of all particle state estimates, Xt
represents the particle state at the moment t. t
the

random noise A1
A2	B0
the state transition matrix.

Gaussian particle filter (GPF)

PF whose essential idea is Monte Carlo simulation is proposed to solve the nonlinear and non-Gaussian problem. A set of




weighted particles
x i  ,  i 
is used to approximate the posterior probability density px
y t . Ideally, the weight of

every particle should be equal, so the posterior density will be only characterized by the number of the particle in the state space. GPF is to approximate the posterior distribution to avoid particle depletion.
GPF is very similar to the SIS (sequence of importance sampling) via importance sampling distribution to sample particles

set xi
t i 1,, N
. Unlike SIS, however, filter distribution and predict distribution of the GPF is approximated by the Gaussian

density distribution, which reduces the complexity of particle calculation. The sequence updated filtering distribution can be expressed as
D xi xi    x  x (i) ;  ,   .	(5)

GPF algorithm reduces the complexity but remains particle degeneracy phenomenon. In previous experiments, we learned that PF can not solve multi-modality problem. The corresponding experiment result is shown in the experimental section. During multi-target tracking process, particles will transfer to one object, so PF algorithm can not be achieved multi-target tracking and MPF is proposed.

Gaussian model - Mixture particle filter (GM-MPF)

As mentioned above, PF can not handle multi-modality. Jaco vermaak, et al proposed MPF to solve the multi-modality and

non-Gaussian system. In mixture tracking process, we let
Pt N, M,t , t ,t ,ct denote particle representation of the mixture

particle filter distribution. With N the number of particles, M the total number of mixture particle filter,
   M


mixture component weights and M

.   xi N

denotes the particle state, 
 i N
t	m,t m1

represents the particle weight



m 1
 m,t  1
t	t  i 1
t	t  i 1

and
t
 1 . ct  ct 
the component index,
ct 1M , with ct
 m if i belongs to mixture m-component.

N


i 1
i  
i  N
i 1
i 


M
i 

M

Calculate m mixture particle filters distribution: p x yt   
p  x yt 
with 	 1

t
m 1
m,t  m	t
m,t 
m 1

The mixture component distribution can be computed using the two step recursion:


predict:
p x yt1   
p x yt1  .	(6)

t
m1
m,t 1 m	t



update:
p x yt   
p  x yt  .	(7)

t
m 1
m,t  m	t


Filtering distribution of MPF is regarded as m independent particle filter and the posterior distribution is approximately estimated by Gaussian distribution. The choice of Gaussian filter importance function depends on the specific circumstances,
but under normal circumstances, q()  N(x ;  ,  ) .So let p x yt  M gm Nx ;, denote the new filtering distribution for the

t  t  t
m  t	t
m1

m-component. With M a Gaussian component,
g m the Gaussian component weight.
N (x ;  ,  )
denotes variable


Gaussian distribution.
t	t	t

Multi-target tracking is realized via combining the Gaussian distribution with MPF in this paper. MPF algorithm is applied in tracking m objects with N particles, so Each object ,m independent filter, is allocated M = N/m particles, Particles are divided into m intervals in this paper. The posterior distribution of each interval is approximately estimated by Gaussian distribution to realize multi-target tracking. The concrete realization is as follows:

Initialization. Weighted particles for m intervals xi ,i  c
c  1,, m are obtained from sampling the prior

i1:N 



density pxi  .
Measurement updated algorithm
Draw Samples from the importance function



q xi  xi , y  and denote them as the particle setxi 

Compute weights and normalize the weights of m-component particle as
L y xi M  M gm N x ; , 
t   	m1	m1	 .	(8)
q xi xi , y



~ i  
i c   t	 , i  1,, M;c 1,, m .	(9)
t	M ~  j 
t j 1

Estimate mean and covariance at t time for m-component as GPF

 (c )  i c x (i) , c  1,, m .	(10)
t	t	t
i 1


(c )  M  i c  (c ) x (i )  (c) x (i ) H , c 1,, m .	(11)

t	t
i 1
t	t	t	t



Time updated algorithm
Draw Samples from the posterior probability density

 x ;  (c) , (c)  in the measurement updated algorithm at time t


and denote as particle set xi	.
t i 1,, N
t	t	t

Draw Samples from the state transition distribution denote as particle setxi 	.
t 1 i 1,, N
Estimate mean and covariance for m-component as GPF


 (c)  1 M

(i) , c  1,, m .	(12)

t 1	M


(c )  1
i 1

M
t 1


 (c )	(i )	(c )	(i )




t 1

i 1



t 1
xt 1
t 1
xt 1
 , c 1,, m .	(13)

t = t +1, Continue to track and go to (2); otherwise the algorithm ends.

Results and analysis

The experiment is based on the OPENCV computer vision library and is implemented in the visual studio 2008 software platform. The video comes from the PETS 2001 / DATA SET [8] and there are multiple targets in 350 frame, The experiment is to remove the previous 350 frames and starts to process from 351 frame at first. Gaussian mixture modeling background method is used to detect target and the region of interest [9] is marked in experiment. In the process of object tracking, particle filter is applied to solve the nonlinear and non-Gaussian problem. In the paper 100 particles are employed to achieve two objects tracking. Each target can be obtained 50 particles. More and more objects tracking can be achieved by changing the coefficient of the target number and the number of particles during the experiment. This paper compares the improved particle filter with improved mixture particle filter to achieve two objects tracking. The result is shown as Figure 1 and 2.
It is shown that the vast majority of particles after the 27 frame have been transferred to another target in Figure 1 and all have been transferred in the 29. Obviously improved particle filtering algorithm is poor in maintenance of multi-modal distribution of the target. However, mixture particle filter algorithm models the filtering distribution as a mixture model to better cope with the multi-modality. In Figure 2 it is observed that this mixture particle filter is able to maintain the


multi-modality inherent in tracking problem and multi-target tracking is realized stably where the standard particle filter fails.
Now we define a metric measure N	of the degradation: N		N	.Where var(i ) is the variance of i .

eff
eff
1  var  i 	k	k

Generally
N eff can not be calculated exactly, so it is approximated as



Neff 

Nt i1
1
i 2

.	(14)


	

Initial	14 frame	20 frame

27 frame	29 frame	199 frame
Initial	14 frame	20 frame

21 frame	27 frame	29 frame

Fig 1 Multi-target tracking based on improved PF	Fig 2 Multi-target tracking based on improved MPF
The experimental result is shown in Figure 3 and 4. The experimental results show that mixture particle filter method can effectively solve the problem of multi-modality, simplify particle degradation and achieve steady multi-target tracking.
Fig 3  Neff of PF to track	Fig 4  Neff of MPF to track
1 N

Root mean square error (RMSE) is defined as RMSExf     xt xt
n1
number of particles (100, 200, 300) are shown in Figure 5 and Figure 6.


, xt  E(xt
y0:t ) . RMSE curves with the different

It is evident from the graph that root mean square error RMSE of (N = 200 and 300) is smaller than RMSE of (N = 100). The smaller number of particles is, the larger tracking error is, but the higher computational complexity is. With the increase of the number of particles, algorithm tracking accuracy is improved greatly and the time of the algorithm computation also increases. The average processing time of 50 frames with 1000 particles is compared among the four kinds of algorithms in Table 1. Gaussian particle filter (GPF) algorithm that Gaussian distribution approximates posterior distribution is an improved particle filtering algorithm to reduce the particle computational cost. GM-MPF can enhance the real-time of MPF.


	

Fig 5 RMSE of target 1 in different particles	Fig 6 RMSE of target 2 in different particles Table 1 Processing time of 4 algorithms for 1000 particles

Particle filter algorithm is poor at consistently maintaining the multi-modality problem and remains particle degeneracy phenomenon. This shortcoming can be addressed through using the component of Mixture Particle Filter (MPF) to express independent particle filter. Neff of improved particle filter and the mixture particle filter is used to describe the particle degradation. Gaussian Particle Filter (GPF) is used to reduce computational complexity of particle filter algorithm. The particle set is obtained by sampling of gaussian density function instead of re-sampling to improve the computing speed of particle filter algorithm and to obtain more accurate estimation performance. Combined with the advantages of GPF and MPF, GM-MPF algorithm is proposed. Meanwhile, comparing to the processing time of PF, GPF, MPF, GM-MPF, the experimental results are shown that the improved algorithm enhances the real-time and system estimate accuracy of the MPF during multi-targets tracking.


Acknowledgements

This work was financially supported by National Natural Science Foundation (61170126) and Jiangsu Provincial Natural Science Foundation (BE20111156).


Reference

R.E. Kalman, A new approach to linear filtering and prediction problems, Transactions of the ASME—Journal of Basic Engineering, J. 1960, 82: 35–45.
Doucet, A, de Freitas, J. F. G., N. J. Gordon, editors: Sequential Monte Carlo Methods in Practice , M. Springer-Verlag, New York, 2001.
Doucet A, Godsill S, Andrieu C, On sequential monte carlo sampling methods for bayesian filtering, J. Statistics and Computing, 2000, 10(3): 197-208.
Comaniciu D, Ramesh V, Meer P, Kernel-based object tracking, J. IEEE Transactions on Pattern Analysis and Machine Intelligence, 2003, 25(5): 564-575.
Li Peihua, Moving object tracking method in image sequences, M. Science Press.
Kotecha J H, Djuric P M, Gaussian particle filtering, J. IEEE Transactions on Signal Processing, 2003, 51(10):



2592-2601.
Vermaak J, Doucet A, Perez P, Maintaining multi-modality mixture tracking, C. Proceedings of the Ninth IEEE International Conference on Computer Vision, Nice, 2003: 1110-1116.
Information on http://ftp.pets.rdg.ac.uk/PETS2001/.
Lin Qing, Xu Zhu, Wang Shi-Tong, Zhan Yong-Zhao, Moving Object Detection of Adaptive Gaussian Mixture on HSV, J. Computer Science, 2010, 37(10): 254-256.
