Available online at www.sciencedirect.com



AASRI Procedia 3 (2012) 8 – 13




2012 International Conference on Modeling, Identification and Control
Nonlinear Predictive Control Using Fuzzy Hammerstein Model and Its Application to CSTR Process
Chengli SU*, Jinwei Ma
School of Information and Control Engineering, Liaoning Shihua University, Fushun 113001, China




Abstract

A fuzzy-Hammerstein model predictive control method is proposed for a continuous stirred-tank reactor (CSTR). In this paper T-S fuzzy model is used to approximate the static nonlinear characteristics of Hammerstein model, and a linear autoregressive model is used to solve the results of optimal control. The designed nonlinear predictive controller using Hammerstein model make good use of the ability of universal approach nonlinear of T-S model, and divide the question of nonlinear predictive control into the nonlinear model recongnization and the question of linear predictive control. The application results of CSTR process show the proposed control method has good control performance compared to PID controller.

© 2012 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license.
Selection and/or peer review under responsibility of American Applied Science Research Institute

Keywords: Hammerstein mode, T-S Fuzzy model, Nonlinear predictive control, CSTR


Introduction

Nonlinear systems widely exist in the actual production process, and control methods for nonlinear systems are endless, predictive control as a novel control algorithm has been extensive research by scholars from various countries[1]. Many predictive control algorithms based on neural network models[2], fuzzy models[3] with nonlinear approximation ability have been proposed. And there are also experiment mode-

* Corresponding author. Tel.: +86-024-56865010; fax: +86-02456860876.
E-mail address: suchengli@lnpu.edu.cn.







2212-6716 © 2012 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license. Selection and/or peer review under responsibility of American Applied Science Research Institute doi:10.1016/j.aasri.2012.11.003


based predictive control algorithms, such as Hammerstein model[4], Wiener model[5], Volterra model[6]. Hammerstein model as a kind of experimental model, has to describe the characteristics of various types of nonlinear object, literature [7] using a polynomial model to approximate the nonlinear characterristcs of Hammerstein model, the linear part of the external factors input autoregressive model (Autoregressive the model with exogenous input ARX) Description and Binary Distillation the tower simulation results show that the effectiveness of the method, but using polynomial to describe nonlinear makes the precision and complexity of the algorithm is proportional to the increase, has certain limitations. In the literature [8] using nonlinear base as static nonlinear part of the Hammerstein model, while its dynamic linear part Laguerre series, this method may effectively control the output of the interference, and pH neutralization process to prove the algorithm is effictive. Zhu[9] and others Hammerstein model has been improved, and the algorithm is verified by simulation better control effect. In [10] for the CSTR reactor two new identification are introduced based on Hammerstein model identification are given, and good control method given. In literature [11] nonlinear predictive control algorithms based on Hammerstein model to demonstrate the stability and robustness of the algorithm, and pH and reaction process example simulation.
The main work of the paper is based on the Hammerstein model, the nonlinear static part using T-S fuzzy model has strong nonlinear approximation ability, the control object recognition, dynamic linear part of Hammerstein model solution by ARX (Auto regression model with exogenous input) optimal control, in order to achieve continuous stirred tank reactor (CSTR) cascade model of stability control.

Fuzzy Hammerstein model and its description

Hammerstein model can use figure 1 shows the structure to said. Using this model can realize static nonlinear identification problems and dynamic linear optimization solving problem.



u(t)	x(t)



Fig.1 Structure diagram of Hammerstein model
In the paper the static nonlinear Hammerstein model part uses T-S fuzzy model distinguish controlled object model parameters, dynamic linear part adopts external input autoregressive model (ARX) to solve optimal control law.
Static nonlinear part is described as
x(t)  ƒ [x(t), u(t)]   (t)  ƒ [x(t 1),⋯, x(t  nx), u(t 1),⋯, u(t  nu)]   (t)
Dynamic linear part adopts ARX structure 
C(q1) y(t)  qd D(q1)x(t)
where y(t), u(t),  (t) are the system output, input and uncertain disturbance, respectively. nx and nu are the





(1)

(2)

orders of the system intermediate variables and inputs.
ƒ [] is a piecewise continuous nonlinear function. The

model of nonlinear part uses T-S fuzzy model to describe:

if x(t 1) is
i,1,⋯, x(t  nx) is
i, nx ,
u(t  1)
is i,nx1,⋯, u(t  nu) is
i,nx  nu then

xi (t)  Ai,r x(t)  Bi,ru(t)   (t)	(3)
where i,l denotes the lth fuzzy variable of the ith fuzzy rule, i  1 , ⋯ , L   L denotes the fuzzy rules number,
i,l  i,l [x(t  l)]	l  1,⋯, nx , i,l  i,l [u(t  nu  l)]	l  nx  1,⋯, nx  nu
Ai, r (q 1 )  ai,1q 1  ai,2q 2  ⋯  ai, nxq  nx  Bi,r (q 1 )  bi,1q 1  bi,2 q 2  ⋯  bi,nu q nu



If the linear model (3) is seen as a subsystem of the fuzzy model, the output of the system (1) may be described as the weighted average of the output fuzzy subsystems.


x(t)   gi (t)xi (t) 
i 1



(4)

L	L

where gi (t)  i (t)  i (t) ,   gi (t)  1 ,  (t)   nx  nu 
is the membership degree of the ith fuzzy

i 1
i 1
i	l 1
i ,l

rules.  denotes fuzzy operator, usually take a small or product operation.
Substituting Eq.(3) into Eq.(4), the system output can be written as:
x(t)  gi (t)[Ai,r x(t)  Bi,r u(t)] (t)  gi (t)[ai,1x(t 1)  ai,2 x(t  2) ⋯ bi,1u(t 1) ⋯ bi,nuu(t  nu)] (t)

i1
i1
(5)

Eq. (5) can be written in matrix form:


where
X(t)
 FX (t )
 HU (t )
(6)



 ƒ1,1 ⋯ ƒ1, nx 	h1,1 ⋯h1,nu 

F   ⋯ ⋱ ⋯	 , H   ⋯ ⋱ ⋯   , ƒ
 g (t)a
, i 1,⋯, L, j 1,⋯,nx , h
 g (t)b
, i 1,2,⋯, L, j 1,2,⋯,nu

	
 ƒL,1 ⋯ ƒL,nx 
	
hL,1 ⋯hL,nu 
i, j	i	i, j 
i, j	i	i, j 

X˜ (t)  [x(t 1), x(t  2),⋯, x(t  nx)]T
U (t)  [u(t 1), u(t  2),⋯, u(t  nu)]T

The dynamic linear part may be described as the following ARX model:
C ( q 1 ) y (t )  q  d D ( q 1 ) x (t )

(7)

where C(q1)  1  c1q1 ⋯ cnqn
D(q1)  d1q1  d2q2 ⋯ dmqm

Set d=0, and multiply   1 q1 at both sides, Eq.(7) is given

~
C ( q
1 ) y (t )  D ( q
1 )  x (t )
(8)

where ~(q
1)  (1  q
1)C(q
1)  1  c~ q1
⋯ c~ qn
~
n 1
(n 1)
, then Eq. (8) is written to the following

form

y(t)  n1(c~)y(t i)  m d x(t  j)

(9)

	i i1
 j j1

Taking the current time t, the output of the current moment of y(t), model k steps output by the following Formula

n1
k,i
 k, j
 kl1
m	 kl1


where
yˆ(t k) 
c~
i1
y(t 1i)
d
j2
x(t 1 j)
d
l1
x(t l 1)  yˆ (t k)
d
l1
x(t l 1)
(10)

yˆm (t  k) 
n1

i 1
~
k ,i
y(t 1 i) 



j 2

dk , j
x(t 1 j)

(11)

Assumption, the forecast modeling error remains unchanged in the time domain, then
e(t )  y(t )  yˆ(t)
where y(k), yˆ(k) are k moment process output and model output respectively, the k step predictive output is



written to

yc (t  k )  yˆ(t  k)  e(t)

k  1, 2,⋯, p

According to the principle of MPC algorithm, a reference trajectory index form, such as Eq. (12) shows:
yr is supposed to be a first-order

yr(t  k) yr(t) (1)ysp
yr (t)  y(t)
k 1,2,⋯, p

(12)

where yr is a reference trajectory,   e s  r , T is a sampling period, T is a reference trajectory response
T / T


time,
ysp is a set point, y is the process output.

Define
Yˆ(t)   yˆ(t 1)⋯ yˆ(t  p)T , Yˆ (t)   yˆ (t 1)⋯ yˆ (t  p)T

Y (t)   y (t 1)⋯ y (t  p)T ,

Yˆ (t)   yˆ
(t 1)⋯ yˆ
(t  p)T
X (t)  x(t)

x(t 1) ⋯
x(t  M 1)T


d1,1
Gd2,1


0  
d1,1	
⋯	⋱	

dp,1
dp1,1 ⋯ dpM11,

where p denotes the prediction steps, M denotes the control steps, then

Yˆ(t)  Yˆ
(t)  GX (t)
(13)

Take the following quadratic target function:
J  min Y (t)  Y (t)T Q Y (t)  Y (t)  X T (t)RX (t)

(14)

where Q, R denote the positive definite output and control weighted matrix, respectively. Substituting Eq. (12) and Eq. (13) into the target Eq. (14), then the optimal control law is obtained:
X (t)  [GTQG  R]1GTQ[Y (t) Yˆ (t)]
At the next sampling interval, the control steps are shifted forward by one step, and the same process computations are repeated. The optimal control function x(k) in current moment is
x(t)  x(t 1)  x(t)


(15)


(16)

Since the control law obtained of Eq.(16) is an intermediate variable, the need to solve the optimal control amount U(t). Substituting Eq. (6) into Eq. (15), the optimal control law can be obtained

U (t)  (H T H )1 H T[ X (t)  FX˜ (t)]
The optimal control function x(k) in current moment is
u(t )  (H T H )1 H T [ x(t)  Fx˜(t)]
(17)

(18)


Its Application to CSTR Process

In this section, a CSTR (continuous stirred tank reactor) process is used to prove the excellent control performance of the proposed NMPC method based on T-S Fuzzy Hammerstein model. Assuming this CSTR process is an irreversible exothermic reaction, the input and output dynamic equation as follows:

dCA	 vt  
	E  


dt	V
CA0 t   CA t  k0CA t exp RT t ,

	



dT  vt  
 H k0
	E   CCPC	
	 hA	

 
dt	V
T0 t  T t   C
CA t exp		qC t 1  exp
RT t	C V	q t	C
Tc0 t - T t 

P			P
	 C
C  PC 

where CA denotes the concentration of reactants A; T denotes reaction temperature; q denotes feed flow rate,
vC denotes coolant flow rate.
In order to verify the superiority and effectiveness of the proposed algorithm, PID control algorithms and the proposed algorithm were compared. In Simulation, PID control parameters: Kp=10; Ki=50; Kd=0.5, the parameters of the proposed algorithm were taken: the prediction steps H=8, the response time of the reference
trajectory Tr  20 s, the sampling time Ts=1s	Q  100I, R=0.2I, where I is corresponding dimension of the
unit matrix. The simulation results are shown in Fig. 2-3.
Fig. 2 is PID control algorithm simulation results, when the reactant concentration set value is less than
0.13 to achieve a better control of CSTR process, when the setting value is greater than or equal to 0.13, the output of the model appears obvious oscillation, so change when the CSTR process operation range is large, PID control algorithm is difficult to achieve effective control. Fig. 3 for the proposed control algorithm, seen from the figure, the greater change occurred when the concentration of the reactants , the system output may still be able to better track setting, the simulation results significantly better than the first two methods, thus validating the Hammerstein model nonlinear approach to achieve the control of nonlinear systems. Therefore, validation of the algorithm for CSTR reaction such strongly nonlinear process can achieve effective control.




0.2

PID output


0.2

output


0.15	0.15

0.1	0.1

0.05	0.05


0



120
110

100
90
80


0	20	40	60	80	100	120	140	160	180	200
time(s) PID input

0



200

150

100

50


0	20	40	60	80  100  120  140  160  180  200
time(s)
input


70
0	20	40	60	80	100	120	140	160	180	200
timtimee(s)

0
0	20	40	60	80  100  120  140  160  180  200
time(s)

Fig.2 Simulation result of PID control algorithm	Fig.3 Simulation result of predictive control algorithm based on
Hammerstein model

Conclusion

In this paper, for strongly nonlinear processes in the chemical industry a nonlinear predictive control method based on fuzzy model is proposed, and applied to the CSTR process. Simulation results show that the proposed method with the conventional PID control algorithm compared to the strong anti-disturbance ability, robustness, and the algorithm is simple, easy to implement, has a practical application.


Acknowledgements

This work is partially supported by the Scientific and Technological Project of Liaoning Province (2011216011), University Innovation team in the Educational Department of Liaoning Province (2009T062, LT2010058)


References
Camacho E F, Bordons C. Model predictive control in the process industry [M]. London: Springer, 1995.
Huang J Q, Lewis F L. Neural-network predictive control for nonlinear dynamic systems with time-delay [J]. IEEE Transactions on Neural Networks, 2003, 14(2): 377-389.
Sun Jianping, Tan Yue, Li Bing. Single valued fuzzy generalized predictive control and its application in thermal process [J]. Chinese Journal of scientific instrument, 2008: 1494-1498.
Xu Xiangyuan, Mao Zongyuan. Analysis and research-based Hammerstein model predictive control [J]. Control Theory and Application (in Chinese), 2000, 17(4): 529-532.
Norquay S L, Palazoglu A, Romagnoli J A. Nonlinear model predictive control of pH neutralization using Wiener models [A]. Proceedings of 13th IFAC World Congress [C], San Francisco, 1996, pp: 31-36.
Doyle F J, Ogunnaike B A, Pearson R K. Nonlinear model-based control using second-order Volterra models [J]. Automatica, 1995, 31(5): 697-714.
Fruzzetti K P, Palazoglu A, McDonald K A. Nonlinear model predictive control using Hammerstein models [J]. Journal of Process Control, 1997, 7(1): 31-41.
Xiang Wei, Chen Zonghai. New identification method of nonlinear systems based on Hammerstein models [J]. Control Theory & Application(in Chinese), 2007, 24(1): 143-147
Zhu Xuefeng, Seborg D E. Nonlinear predictive control based on Hammerstein models [J]. Control Theory & Applications(in Chinese), 1994, 11(5): 564-575.
Zhu Xuefeng. Nonlinear predictive control of CSTR [J]. Journal of South China University of Technology (natural science), 1995, 23(6):7-16
Zou Zhiyun, Yu Dehong, Hu Zhen. Predictive control of nonlinear Hammerstein systems and application to a pH process [J]. Computers and Applied Chemistry, 2006, 23(2):137-142
