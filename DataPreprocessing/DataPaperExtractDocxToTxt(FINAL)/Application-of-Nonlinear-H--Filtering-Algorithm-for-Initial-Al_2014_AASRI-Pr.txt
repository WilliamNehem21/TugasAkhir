Available online at www.sciencedirect.com
ScienceDirect

AASRI Procedia 9 (2014) 99 – 106


2014 AASRI Conference on Circuit and Signal Processing (CSP 2014)
Application of Nonlinear H∞ Filtering Algorithm for Initial Alignment of the Missile-borne SINS
Zhiqiang Wua, Yu Wanga, Xinhua Zhua,*
aSchool of Mechanical Engineering, Nanjing University of Science and Technology, Nanjing 210094, China




Abstract

The H∞ filtering and Unscented Transformation(UT) algorithm are introduced to deal with the initial alignment error of missile-borne Strapdown Inertial Navigation System(SINS), which is caused by the nonlinear error model and the uncertainty of the disturbance noise. Firstly, on the basis of additional quaternion error, the error model of SINS is built up. Secondly, the nonlinear H∞ filter based on UT and H∞ filtering is constructed, which is with nonlinear approximation ability and strong robustness. Finally, simulations are made compared with UKF and the nonlinear H∞ filter under the conditions of disturbance model of strong wind. The result shows that nonlinear H∞ filter is more stable and faster than UKF under the disturbance conditions of strong wind and can effectively improve the accuracy of initial alignment and robustness of the algorithm.
© 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).
Peer-review under responsibility of Scientific Committee of American Applied Science Research Institute
Keyword: Strapdown Inertial Navigation System; initial alignment; additional quaternion error; nolinear H∞ filtering; large initial attitude error








* Corresponding author. Tel.: +86 13601404770; fax: +86 2584303258.
E-mail address: zhuxinhua@njust.edu.cn.










2212-6716 © 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).
Peer-review under responsibility of Scientific Committee of American Applied Science Research Institute doi:10.1016/j.aasri.2014.09.017


Introduce

Initial alignment is one of the most momentous technologies in a Strapdown Inertial Navigation System(SINS). Under the circumstances of low sensor accuracy and external disturbing motion, one crucial problem in initial alignment of missile-borne SINS is how to verify the initial transformational matrix from the missile body’s coordinate system to the navigation coordinate system efficiently and accurately. Initial alignment of missile-borne SINS can be divided into two categories: autonomous alignment after launch and transfer alignment before launch. In both modes, the SINS is in constant motion with drastic posture changes, thus frequently influenced by uncertain disturbance. Traditional Kalman Filtering requires the accurate priori knowledge of the mathematical model of the studying object and the noise being white noise. However, when in missile-borne situation, the noise tends to be colored type. In combination with the error in system model, there will be filter divergence if traditional Kalman Filtering is applied. Therefore, the properties of being robust and nonlinear are required in the initial alignment of missile-borne SINS.
A good number of researchers are involved in developing robust nonlinear filtering algorithm. Literature [1] deals with the rapid alignment of ship-borne weapon INS with large initial azimuth attitude error under complex environment disturbances. Based on the nonlinear error propagation model, velocity plus angular rate matching method was applied in the implementation of the alignment. Literature [2] suggests a quaternion-based nonlinear error model in rapid transfer alignment. Literatures[3-5] carry out an intensive study in H∞ filtering. It is suggested that due to its significant effect in uncertainty disturbed moving-base rapid alignment, this filtering is appropriate both for linear and nonlinear models. Moreover, when there is colored noise or unmatched models, H∞ filtering still keeps its robustness. Based on the research above, it is found that applying H∞ filtering to the initial alignment in SINS is an effective estimating method in that it is relatively more rapid, accurate and robust, and is more suited to this application.
To deal with the problems of nonlinearity of error model and the disturbance-induced uncertainty in noise in SINS moving-base initial alignment, a quaternion-based nonlinear error model is introduced, and through enhancing the approximation ability of nonlinear model with Unscented Transformation (UT) algorithm and increasing the robustness to uncertain noise in filtering process with H∞ algorithm, a new H∞ filtering algorithm is put forward. Simulations are made compared to conventional Kalman algorithm in the condition of large misalignment angle and strong wind. It is verified that this algorithm is effective in the initial alignment of missile-borne SINS.

System Model

The posture error in navigation system refers to the mal-alignment angle (or misalignment angle) between platform coordinate system and navigation coordinate system. In a SINS, quaternion describes the transformational relation between carrier coordinate system (system b) and navigation coordinate system (system n). Thus, the calculation error of quaternion can be used to decide the mal-alignment angle of the carrier.
Additive quaternion error (AQE), which is the difference between calculative quaternion and actual quaternion, can be described as:

Q  Qˆ n  Qn  q	q	q	q T

b	b	0	1	2	3
(1)

In the equation above, Qn is the actual quaternion from the carrier system to navigation system. Qˆ n is
b	b

the calculative quaternion.
Considering the short span of the alignment process, the influence of location error is ignored. Meanwhile, the measurement error of the accelerometer and gyro can be regarded as the sum of random constant and white noise. The posture error equation is:

Q˙  1  b
Q  1  n Q  1 U Qˆ n  b
 1 Y Qˆ n  n

2	ib
2	in
2	b	ib	2
b	en
(2)

In this equation,
q0
 q1
 q2
 q3 
 0   x
 y
 z 
 0	 E
 N
 U 

Qn   1	q0
 q3
q2 
	0	
b   x	z
y 	 n   E
0	 U	N 

q2	q3

q0	 q1 

ib	 	0
	z
x 

in		
 N	U
0	 E 


q3
q2	q1
q0  ,
z  y
x
0  ,
U
 N	E	0 

 b represents the projection of the angular speed of relative inertial frame (system i) on system b.  n
ib	in
represents the projection of the angular speed of relative inertial frame (system i) on system n. Equation (2) is the linear differential equation of Q , and in the derivation, misalignment angle is not assumed to be a
minimum. So, the carrier’s posture error propagation characteristic in a large misalignment angle is accurately represented in it.
The speed error equation [8] goes like this:

V n  2[Cˆn fˆb ]YT (Qˆ)  2Cˆn fˆbQˆT  Q  YT ( Q)U ( Q)T fˆb 
Cnb  (n  n ) V  n V n

b	ie	in	en
(3)


In the equation (3), Cn  Cˆ n  Cn illustrates the calculative error of posture matrix, and Cn fˆ b is
b	b	b	b
the nonlinear function of Q .
The speed error in the northeast day coordinate system and the quaternion errors are set to be State Variables, while the speed error as measured signal, the system-state equation and measuring equation are presented as follows:



x(t)  f (x,t)  Gw(t) 
z(t)  Hx(t)  v(t) 

(4)


f (x,t) can be divided into two parts of linear and nonlinear, so equation (4) can be transformed into



x(t)  F0 (t)x(t)  p(x,t)  G(t) 

(5)


In this equation,



x  V

Vn

Vu

q0

q1

q2

q3	x	y

b	b	b
z	x	y
 b T

,	and	the

coefficient matrix F0(t) is the linear part, which is described as:

F	F	Cn	0	
 0(11)	0(12)	b	
F (t)  F	F	0	1 U (Qˆ n )

0	 0(21)
 0
0(22)
0
2	b 
0	0	

(6)



In this equation,
	˙


 F0(12)  2Cb f

Y

Q 2Cb f Q

F0(11)  

 2(  )sin L
2(  ˙) cos L
 vU /(RM  h) 2˙
 ˙	
0	

 qˆ1
1  qˆ
 qˆ2
qˆ
 qˆ3 
qˆ 		0
1/(RM
 h) 0
F	 1  b
 1
 n 

F	   0	3
2 	
1/(R
 h)
0	0
0(22)
2	ib
2	in

0(21)
2  qˆ	qˆ
qˆ 		N	

 qˆ
0
qˆ1
1 
qˆ0 
tan L /(RN
 h)
0	0

The nonlinear part is defined as
p(x,t) ,
 f1(x, t)
YT ( Q)U ( Q) fˆb 
, and the

p(x, t)  	0
  	0	

measurement matrix is H  I33	0
			


Nonlinear H∞ Filtering Algorithm

H∞ filter are applied in the initial alignment of missile-borne SINS. When the missile body is disturbed by airflow, the system noise is colored, and modelling error exists. Severe divergence will arise in traditional Kalman filtering. However, H∞ filtering still keeps its strong robustness. Therefore, H∞ filtering being applied in the initial alignment of missile-borne SINS breaks the restriction of Kalman. H∞ filtering is a much more applicable and effective estimating method.
On the basis of Unscented Transformation and H∞ algorithm, this chapter employs the algorithm idea in literature [9] and puts forward a UT and H∞ based algorithm, which is referred to as nonlinear H∞ filter. This algorithm uses unscented transformation in nonlinear fitting, and adopts average H∞ algorithm in modification, which endow it with better nonlinear approach capacity than Extended Kalman Filter (EKF) and stronger robustness than Unscented Kalman Filter (UKF).

Principle of Unscented Transformation

When parameterizing the statistical property of a random variable with a cluster of discrete sampling points, these points are named Sigma Points. Suppose that the input state x is the dimension vector of L, Sigma Points can be selected according to the principle below.



x0  x


; xi  x  (
(L  )Px )i


i 1,2,.	, L; xi  x  (
(L  )Px )i L
i  L 1, L  2,.	,2L

(7)


In the equation (7),    2 (L  K)  L is the parameter for distribution.  represents the distribution of
sampling point near x , whose value range is 104    1; K is normally valued 0 and ( (L  )Px )i represents

the matrix square root line i. Put the selected state vector into the nonlinear function
f   , i.e.

Yi  f (xi ),
i  0,1,2,...,2L , then weigh the output statistical property of the approximation analysis system.

2 L
y 	W mY
2L
P 	W c (Y  y)(Y  y)T

 i  i
i0
	
y		i	i	i i0

In the equation above,
2 L	2 L
W m  1
c  . And the typical initialW m andW c are:

i
i0
Wi	1	0	0
i0



W m    
W c     1 2  

0	L  
0	L  
(8)

And,  , the scale parameter, which decides the distribution range of sigma points, is normally valued a small positive number.  is used to describe the distribution of x, which is optimal in normal distribution.
  2 ; W m  W c 	1	,	i  1,2,...2L .

i	i	2(L  )

H∞ Filtering Algorithm

For the discrete system



xk 1  Fk xk  Gk wk
yk  Hk xk  vk

(9)

In the equation (9), x represents the un-estimated state vector. For the easy use of filter, an estimator is added.


zk  Lk xk
Lk  I

(10)

For the given positive number  , if FK	GK  is in full rank, the necessary and sufficient condition of
the existence of H∞ filter is that the positive definite symmetric matrices must meet the f Riccati equation below.


P1  P1
 H  L   R1 Hi   0,i  0,..., k ,and R  I	0 

i/i	i/i1
  i	i  i
 L 
i	0
 2 I 

 i 		
For a given positive number  , the estimated state of the system vector is[4]



zˆk /k  Lk xˆk /k 

(11)


The recursive formula of xˆ	is [4]

K  (I  1 P L L )1 P H 

xˆk /k  xˆk /k 1  Kk ( yk  Hk xˆk /k 1 )	k


 2  k /k  k  k	k /k  k
(12)



The formula with time updated is:
xˆk 1/k  Fk xˆk /k

Pk 1/k  Fk Pk / k Fk  Gk Gk


Design of nonlinear H∞ Filter

According to the addictive-quaternion-error-based system equation, when there is a nonlinear section in the state equation of the system, dealing with this nonlinear problem using UT avoids the linear errors caused by EKF. Then standard H∞ filtering algorithm is applied to get the nonlinear H∞ filtering algorithm, which is performed as follows.

First, initialization, which involves the initial predicted filtering figure, covariance matrix P0
system noise covariance matrix Q0 . Calculate the sigma points using equation (7), with L=n.
and the

X 0  xˆ ; Xi  xˆ  ( (n  )Px )i i  1, 2,..., n ; Xi  xˆ  ( (n  )Px )in i  1 n, 2  n,..., 2n
Second, with the constant use of UT, solve the mean value and covariance of the nonlinear function .
Get the sigma points mapping collection of the nonlinear function. (Xk /k 1)i  f (( Xk /k 1)i ) i  1, 2,..., 2n
2n

Predict the mean value of the nonlinear function xˆ
 W m ( X	) .

k / k 1
i	k / k 1 i
i0
2n

Predict the covariance of the nonlinear function Pk / k 1
Third, calculate the gain matrix of the H∞ filtering.
Get the covariance matrix Pk .
c
i	k / k 1
i0
)  xˆ

k / k 1
][( X

k / k 1
)  xˆ

k / k 1
]T .

P  P
 P	HT
LT   R1 Hk 1  P
; R  I
0    Hk1  P
HT
LT 

k	k / k 1
k / k 1 
k 1
k 1 
k 1  L	 k / k 1
k	0   2I    L
 k / k 1 
k 1
k 1 

 k 1 
	  
k 1 

Get the gain of filtering. K
 PCT (I  C PCT )1

Finally, modify the measurement of state. xˆk  xˆk /k 1  Kk 1( yk  Ck xˆk /k 1)

Simulation Result

Using the nonlinear H∞ filtering algorithm, the initial alignment in large misalignment angle under wind disturbance is simulated. In the simulation, suppose that the angle of pitch ranges between 45°±5° and the frequency is 2 Hz, and that the roll angleψranges between 0°±3°, and the frequency is 10Hz. The constant drift of gyro signal is 0.01°/s; the mean square root of white noise drift is 0.01°/s; the time span for first order markov process is 3600s; the square root of white noise is 0.01°/s. The accelerate bias is 10-4g; the mean square root of random white noise is 10−4 g; the time span for first order markov process is 1800s; the square
root of white noise is 10−4 g. The posture updating cycle is 1ms; the filtering cycle is 100ms;   5 . While the wind disturbance is irregular, its scope and frequency range are known. Thus a disturbance model is set


accordingly. Fig. 1 illustrates the results of simulation.
x  2.0  0.15sin(2 t)  0.2sin( t  0.5)  0.5sin(0.5 t)

	 2.7  0.15sin(2 t)  0.2sin( t  0.5)  0.3sin(0.5 t)

(13)


In Fig. 1, curve 1 presents the filter results of UKF, and curve 2 describes the filter results using nonlinear H∞ filter algorithm. The alignment errors brought about by high frequency component in the wind-disturbing model are effectively restrained through UKF and nonlinear H∞ filter. The influence of low frequency component becomes the major interference source. As shown in Fig. 1, due to the influence of low frequency interference, the east misalignment angle errors estimated by UKF shows a diverging trend, which fails to achieve stable state even at 200s. By contrast, the nonlinear H∞ filter algorithm becomes stable within 50s, with the east misalignment angle errors confined to 4.733´. The north misalignment angle errors estimated with UKF are confined quickly, but unstably, with some fluctuations. However, the errors estimated by H∞ filter algorithm, though confined to a below-theoretical-accuracy figure of 7.243´, are stable. These results demonstrate that if the linearity of the error model is focused while sensor accuracy and the uncertainty of noise are neglected, there will be relatively large alignment errors in the initial alignment of missile-borne SINS. The result that the accuracy of H∞ filter algorithm is lower than theoretical level demonstrates that the robustness of the filter is achieved in the price of sacrificing filtering accuracy. The results of simulation show that nonlinear H∞ filter algorithm possesses certain robustness to the external interference. This algorithm can meet the requirements of accurate and rapid initial alignment in missile-borne SINS.


Fig.1. Curves of UKF and nonlinear H∞ filter under disturbance, (a) eastward misalignment angle error, (b) northward misalignment angle error

Conclusion

Due to the restriction of sensor accuracy and external interference in missile-borne SINS, conventional linear error equation and Kalman filter algorithm can no longer deal with the problem of initial alignment. This thesis explores the initial alignment if missile-borne SINS. Firstly, addictive-quaternion-error-based nonlinear error equation, unscented transformation algorithm and H∞ filter are introduced. To solve the problem of linearity of the system equation and external interference, a new nonlinear H∞ filter algorithm is then proposed. The digital simulation compares the filter effect of UKF and nonlinear H∞ filter under the circumstance of strong wind interference. Results demonstrates that the nonlinear H∞ filter algorithm is superior than UKF in terms of accuracy and robustness.


References
Xin Liu, Bo Wang, Zhihong Deng. Rapid alignment method of INS with large initial azimuth uncertainty under complex dynamic disturbances. Proceeding of the 2012 UKACC International Conference on Control, Cardiff UK, 2012: 1070-1075.
Hao Y, Xiong Z, Wang W, et al. Rapid transfer alignment based on unscented Kalman filter. Proceedings of the 2006 American Control Conference. Minneapolis USA, 2006:2215-2220.
Ryu J H, Kim C S, Lee S H, et a.l. H∞ infinity lateral control of an autonomous vehicle using the RTK- DGPS. International Journal of Automotive Technology, 2007:8:583- 591.
ZHANG Tao, XU X iao-su. Research on SINS Initial Alignment and the Methods for the Parameter γ Selection Based on H∞ Filtering Technique. Journal of Sichuan University (Engineering Science Edition), 2009:4:240-245. (in chinese)
You-chol Lim, Joon Lyou. Transfer alignment error compensator design using H∞ filter. Proceeding of American Control Conference. 2002:1460-1465.
Xiaoying Kong, Eduardo Mario Nebot, Hugh Durrant-Whyte. Development of a non-linear psi-angle model for large misalignment errors and its application in INS alignment and calibration. Proceedings of the 1999 IEEE International Conference on Robotics & Automation, Detroit USA. 1999:1430-1435.
Yuanxin Wu, etc. Observability of Strapdown INS alignment: a global perspective. IEEE Transactions on Aerospace and Electronic Systems, 2012:1:78-102.
S.P.Dmitriyev, O.A.Stepanov, S.V.Shepel. Nonlinear filtering methods application in INS alignment. IEEE Transactions on Aerospace and Electronic Systems, 1997:1:260-271.
Zhou Benchuan, Cheng Xianghong. Robust UKF algorithm in SINS initial alignment. Journal of Southeast University ( English Edition). 2011:1: 56-60.
Muhammad Ilyas, Yunchun Yang, Ren Zhang. SINS initial alignment using wavelet de-noising method for aircraft navigation. Proceedings of the 10th World Congress on Intelligent Control and Automation. Beijing China, 2012: 3921-3926.
Paul D.Groves. Optimising the transfer alignment of weapon INS. The Journal of Navigation 2003:56: 323-335.
M.Reinstein. Evaluation of fine alignment algorithm for inertial navigation. Evaluation.2011:7:255-258,
