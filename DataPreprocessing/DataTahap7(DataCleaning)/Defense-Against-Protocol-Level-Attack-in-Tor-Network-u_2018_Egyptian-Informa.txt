the most necessity area on the network is an anonymous communication which appears ultimately within accomplish as a common commercial exploitation of onion routing. tor network is defined as the operational network for many decades and consists of nearly two thousand nodes and few hundred thousand users. it is developed from onion router as open software for providing available online anonymity. the onion routing is referred as the levels of encryption where the original information is encrypted by using the destination information at many times and this information are transmitted through the virtual circuits consisting of several tor relays. the relay node is used for decrypting the level of encrypted information and offering the encrypted information to the successive relay nodes in the circuit for decryption process. in tor network, the original information is sent without denoting the destination information. it is used for different applications however various attacks have been detected in tor network due to its growth of deployment[3,4]. the performance and anonymous communication in the tor network was improved by novel traffic dividing and scheduling(ntds) mechanism. by using this mechanism, the traffic was divided according to the different metrics like throughput, delay, bandwidth capacity, and congestion level. the separated traffic was distributed over the each circuit. the basic versions of the sniper attacks were detected and prevented by using ntds method. however, it was impossible to defend the protocol-level attacks in the tor network which are also degrades the anonymity performance.



protocol-level attack is defined as the exploitation of specific feature or implementation bug of some protocol installed at the victim for consuming huge amount of its resources. these attacks are used for verifying that the alice is communicating with bob over tor. the attacker may control the entry and exit routers and execute protocol-level attacks by manipulating the cells related to the given circuit. the malicious entry routers contain the information such as source ip address, port with the circuit id and the time of the cell being manipulated. then the attacker launches the protocol-level attack in different ways such as duplication, modification, insertion or deletion of the information. such modified information cells are transmitted to the exit router which detects the cell recognition errors occurred by the manipulated cells. by using these cell recognition errors, the attacker may confirm the target cell enters tor through the malicious exit router and target cell exits tor through the malicious exit router.



hence in this article, a novel defense mechanism called middrrq is proposed for mitigating the protocol-level attacks against tor network. initially, consider the protocol-level attack which may de-anonymize the users by modifying the cell. then, the solution is provided for this attack by verifying the integrity of cells independently. in the proposed mechanism, indistinguishability obfuscation model is proposed for generating the fake traffic within the middle relays. the generation of fake traffic facilitates the outgoing connections based on the stochastic fair queuing process. however, the complexity of the stochastic fair queuing is high which increases the delay. therefore, the delay is reduced by deficit round robin(drr) queuing process. due to the drr process, the outgoing connections on the middle relays are effectively controlled. thus, the proposed mechanism effectively prevents the protocol-level attacks in the tor network.



in this section, the proposed defense mechanism for mitigating the protocol-level attacks against tor networks is explained. initially, the model of indistinguishability obfuscation is proposed for generating the fake traffic within the middle relays. then, the deficit round robin(drr) queuing algorithm is introduced for handling the outgoing connections on the middle relays.



according to the properties, the probabilistic polynomial time(ppt) adversary cannot differentiate obfuscated programs of two programs p1 and p2, if original programs operate like each other. p1 and p2 may have the negligible difference in their input or output functionality with the low probability. therefore the adversary has no ability to notify which original program was utilized for generating the given obfuscated program even by inspecting the internals of their corresponding obfuscated programs.



packets coming in on different flows are stored in different queues. the deficit counter is used for keep tracking of the credit available to each queue. the variable quantum is referred as the number of bytes which each queue n may send in each round r.



in this section, the performance of the existing mechanisms and proposed mechanism is compared. the performance is evaluated by using network simulator version 2(ns-2.34) for defense against protocol-level attacks and the comparison of mid-drrq is made between ntds method and existing mid-defense mechanism. in this experiment, 100 nodes are used and two malicious or are used as the tor entry or and exit or. in which, the entry or is located nearer to the client(alice) and exit or is located closer to the server(bob). the middle or is selected by using the path selection algorithm. in addition, the considered path length in the proposed mechanism is three. the performance of the proposed mechanism is evaluated in terms of different metrics such as pdr, throughput, end-to-end delay, probability that a circuit selects the malicious routers based on percentage of malicious routers and path length. these metrics are used for analyzing the effectiveness of the path selection algorithm and also the anonymity of the tor network.



in this article, the novel defense mechanism is proposed for mitigating the protocol-level attacks against tor network. in this proposed defense mechanism, the model of indistinguishability obfuscation is used for defending the protocol-level attacks based on the two main approaches such as integrity checking and fake traffic generation within the middle relay nodes. the generated obfuscated fake traffic is forwarded on outgoing connections of middle relays by using the stochastic fair queuing model. however, the complexity and setup delay of queuing model is high. therefore, the deficit round robin algorithm is proposed for reducing both complexity and delay by enhancing the flow fairness and controlling the outgoing connections of middle relays. finally, the experimental results prove that the proposed defense mechanism for protocol-level attacks has better performance than the other mechanisms.



