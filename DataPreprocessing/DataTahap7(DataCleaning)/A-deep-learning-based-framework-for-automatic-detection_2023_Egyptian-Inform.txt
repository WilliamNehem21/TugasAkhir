annually, there are huge numbers of people who contact tuberculosis(tb) and the mortality rate is high among these patients[1,2]. it is estimated that the number of tb infections reaches 8 million each year. moreover, the annual number of mortalities in tb disease ranges from 2 to 3 million people. mycobacterium tuberculosis is the bacteria responsible for causing tb. these bacteria usually attack the lungs, but sometimes other areas of the body such as the spine, brain, and kidneys. there are two main causes of the occurrence of tuberculosis namely: tb disease and latent tb infection(ltbi). if this disease is not treated properly, it leads to death.



there is a clear weakness in diagnosing tb patients. tb patients can be classified into two different cases, namely, multidrug resistance and drug sensitivity(ds). in each case, the patient is treated differently. tb specialists face many challenges in differentiating between the two cases. in addition, the rate of error in differentiating between them is large. moreover, it is difficult for tb specialists to determine the type of tb in an infected person. there are similarities in the symptoms that appear in more than one type of tb. tuberculosis appears in five types, and each type of tb has different patterns and treatment methods. the aim of determining the condition of the tb patient early and determining the type of tb disease in that patient is to reduce the cost of treatment and increase the chances of recovery from this disease.



this section reviews existing works which have targeted tb detection. these reported works mostly operate on 3d ct scans or chest x-ray images. also, most of them agree that image masks, which are forms of image segmentation filters, are important to enhance accuracy of deep learning models. several of these works have utilized pre-trained models such as alexnet, vgg net or resnet for feature extraction. most of the datasets were taken from the image cleff competition. thus our work shares several aspects with the following works.



the work report in utilizes a 7-layer cnn, five of which were conv2d layers, to classify images into bacillus negative and bacillus suspect. a second network, similar to the first one, was designed to classify, again, the images labelled by the first network as bacillus suspect. the second network classifies bacillus suspect images into either bacillus positive or bacillus negative images. this cascade of classifiers increases the confidence in the output of the model.



singh et al. have used an anti-aliased cnn to detect tb lesions in the lungs using image segmentation. they have trained and tested their models using image cleff 2019 dataset. the idea is to employ shift invariant network as it has potential to spot the abnormal regions in the ct images.



the work reported in has experimented with three networks to classify drug resistance in tb patients. the dual attention dilated residual network(dadrn), the bag of visual words and the sparse code book algorithms were used. dadrn was the best performing algorithm. the dataset consists of ct images for 400 patients.



ravi et al used efficientnetb0, efficientnetb1, and efficientnetb2 pre-trained neural networks to detect lung diseases based on chest x-ray images. first, the features extracted using the previous three networks were fused together and then passed into a cascade of dense layers. an ensemble classifier, which consists of random forest and svm, was used in the first stage and logistic regression was used in the second stage. the reported task is a multiclass classification task, where the aim is to classify patients with pneumonia, tb and covid-19. the best reported accuracy in the case of pneumonia was 98%, for tb the accuracy



ying et al. aimed at classifying patients as having nontuberculous mycobacteria pulmonary disease(ntm-pd) or pulmonary tb(ptb) using t-spot test(enzyme-linked test) and deep learning model(based on ct images). the deep learning model uses a u-net network for image segmentation and inception-resnet for image classification. the authors report that the best results achieved when combining the t-spot and deep learning methods.



the data provided by image clef-2018 tuberculosis was used in this paper. it is a well-known dataset and has been used by researchers targeting building computational models for tb analysis. the data consists of 3d ct images stored in nifti file format with.nii.gz file extension. the 3d ct images contain image



several neural networks were experimented with which use only the frames of the images without the masks or gender/age information. vgg16 was used for feature extraction, and several dense/dropout/batch-normalization layers were added to the model to classify the images into mdr or ds in the mdr detection task; and into infiltrative, focal, tuberculoma, miliary and fibrocavernous in the case of the task of tbt classification. it was concluded that ct images alone are not sufficient and additional information, such as image masks and age/gender information, is needed. this leads to the development of multi-modal or multichannel deep neural networks as will be explained next.



this task aims to classify images to either having mdr or ds. four deep learning models have been designed; these rely on cnn, vgg19 or xception networks for feature extraction and rely on a set of convolution and dense layers for classification. these models take the frame, mask and gender/age as input and produce the classification as output.



multi-channel or multi-modal input has proved superiority to single modality. in this paper, multi-channel or multi-modal systems were built for mdr detection and tbt classification. the three modalities which were available in this dataset are: ct images of the lungs of the patients, image masks and age/gender data. the image mask is necessary to have as the traditional scene of tuberculosis(active or latent) is insufficient as tuberculosis transfers between both cases constantly. the conventional tb screening(tuberculin skin test and interferon-gamma release assay) is ineffective. thus, it was necessary to use supplementary information and tb biomarkers to diagnose tuberculosis, which leads to the need for lung image segmentation(referred to as image mask).



this paper has discussed building deep neural networks for mdr-detection and tbt classification. for the mdr detection task, four neural networks were designed which process the image frame, the mask frame and the gender& age data of patients. the baseline model utilized an cnn network for feature extraction from image and mask frames, it also used dense layers to extract features from gender and age. the three sets of features are con-



as a future work, dataset size should be increased to include new datasets which recently emerged. other image modalities such as x-rays provide another option for future investigation. investigating neural networks that can directly handle 3d images is an interesting extension to this work.



