a magnitude warning method, the peak ground motion displacement pd method, which uses the displacement maximum pd at 2s after the p wave and the displacement maximum sd at 1s after the s-wave to predict the magnitude. this method can indicate the general pattern of earthquake magnitude, but it still has the problem of relatively large dispersion. as can be seen from the magnitude warning methods described above, although the current methods can roughly calculate the magnitude of seismic events, they generally suffer from a large dispersion, which leads to low accuracy of the results. even if there are methods with high accuracy, they suffer from a lack of generalizability. with the accumulation of earthquake data, dl techniques are widely adopted in the eew. hu and zhang(2020) designed and trained a dl model for magnitude range prediction in eew, which shows a decrease in the overall error and variance of the prediction results compared to the traditional methods. lin et al.(2021) construct a cnn network magnitude prediction model using 3-s seismic waveform data based on cnn networks, which transformed the magnitude determination problem in eew into a magnitude classification problem. experimental results show that more than 80% of the errors are within



training samples based on the collected datasets, expanding the size and variety of the training samples. the data augmentation technique is proven to prevent model from overfitting and dramatically improve the results by making small adjustments to the data(shorten and khoshgoftaar 2019). in this study, slip and superimposed noise are adopted to generate new data.



dimensionality of the feature map. the role of the bn layer is to normalize the data, thus speeding up the convergence of the model and avoid gradient explosion and overfitting(ioffe and christian, 2015). the relu is a widely adopted nonlinear activation function.



blocks. the transition module can fuse and compress the feature maps output from the denseblock. in this study, the channel fusion compression ratio of the transition module is set as 0.5, i.e., the number of output channels is half of the input.



this section conducts experiments to verify the effectiveness of the eewmagnet model for the magnitude warning classification task. subsections 4.1 and 4.2 we verify the effect of seismic data normalization and epicenter distance features on the classification of magnitude warnings. subsection 4.3 demonstrates the effect of the multi-head attention structure on the classification of magnitude warnings.



this subsection discusses the impact of normalization on the classification task of eew. normalization is a common pre-processing method in dl, which can speed up the convergence of the model and ensure stability during training. however, when normalization is applied to seismic data, the maximum and minimum values of the amplitudes are adjusted.



this experiment is based on the eewmagnet network to verify the effect of the multi-head attention structure on the classification of eew. two networks were constructed for comparison experiments, i.e., the full eewmagnet network and the eewmagnet network without the multi-head attention structure.



to ensure classification accuracy, we evaluated the results using various data lengths and model structures. our findings indicate that eewmagnet achieves over 90% accuracy and recall, even with only 7 s of data. the extraction of spatial and temporal dimensional features is indispensable in the design of dl models. denseblock with bottleneck and multi-head attention to extract features proved to improve the overall performance by about 3%. moreover, we verified the impact of data normalization methods and epicentral distance features on performance. the normalization methods may result in the loss of amplitude information from waveforms, leading to an 8% reduction in model accuracy. in contrast, the fusion of epicentral distance features contributed to calculate waveform propagation loss and improved classification accuracy by 18%.



one of the biggest contributions of this study is the development of a deep learning network that can rapidly classify seismic magnitude. in contrast to traditional seismological computational methods, the proposed network, called eewmagnet, exhibits greater accuracy while utilizing shorter waveform data. furthermore, our study highlights the significance of epicenter distance information and emphasizes the deleterious effects of normalization on magnitude estimation.



