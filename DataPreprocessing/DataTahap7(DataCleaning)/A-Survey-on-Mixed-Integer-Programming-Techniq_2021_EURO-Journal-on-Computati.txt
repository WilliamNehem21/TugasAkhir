finally, let us mention already existing surveys and books in the field of bilevel optimization. other very early survey articles include anandalingam and friesz(1992); ben-ayed(1993); kolstad(1985); vicente and calamai(1994) as well as wen and hsu(1991) regarding the field of linear bilevel optimization. last but not least,



bilevel optimization problems date back to the seminal publications on leader-follower games of von stackelberg(1934, 1952). the introduced formulation was first used in bracken and mcgill(1973) in the context of a military application regarding the cost-minimal mix of weapons. another very early discussion of multilevel, or, in particular, two-level problems can be found in candler and norton(1977). over the years, bilevel optimization has been recognized as an important modeling tool since it allows to formalize hierarchical decision processes that often appear in application areas such as energy, security, or revenue management. we postpone the discussion of selected applied literature to the following sections.



we collect selected applications from various different fields to motivate the study of bilevel problems. afterward, in section 3, we discuss bilevel optimization problems with linear or, at least, convex lower-level problems. for this problem class, we study important general properties, derive classical single-level reformulations, and give a comprehensive overview of the algorithms used to solve these problems. the case of bilinear bilevel problems is discussed in section 4, where we focus on pricing problems and stackelberg games. in section 5, we then turn to bilevel problems with mixed-integer(non)linear lower-level problems. also for these problems, we first focus on general properties before we then turn to generic approaches for solving bilevel milps and bilevel minlps. section 6 is then devoted to interdiction problems. here, we discuss both discrete as well as continuous interdiction problems, different fields of applications, and different classes of algorithms to tackle these problems. the survey closes with a collection of possible directions for future research in section 7.



in this section, we present a selection of the vast literature on applications of bilevel optimization. due to the enormous number of publications, this review will be far from being comprehensive. many other application-oriented papers can, e.g., be found in the survey by dempe(2020) or by sinha et al.(2018b).



bilevel problems are also discussed in the context of statistics and machine learning. in bennett et al.(2006); bennett et al.(2008), bilevel optimization is applied to hyper-parameter selection for statistical learning methods. an evolutionary bilevel algorithm for the same purpose is given in sinha et al.(2014). very recently, franceschi et al.(2018) introduce a framework based on bilevel programming that unifies gradientvices in an electrical network has been modeled as a bilevel milp in poirion et al.(2020). the authors develop a generic branch-and-cut procedure that can be applied to problems with a similar type of bilevel constraints. grimm et al.(2019a); kleinert and schmidt(2019b) develop a benders-like decomposition approach to compute optimal price



leads to a lower bound of 0 for the entire bilevel lp. the bilevel feasible region t is given by the union of the two segments in thick green. interestingly, t is nonconvex although both levels are linear optimization problems. the problem has the two optimal solutions(0,1) and(1,1) with value 1.



and nonempty for what follows. in the following, we will explain that the bilevel feasible region is a union of faces of the high-point relaxation and that a bilevel optimal solution is attained at one of the vertices of this union. this is already illustrated in the previous example.



that the high-point relaxation is bounded, which is typically justified in practical applications. however, the dual feasible set is unbounded for bounded primal feasible sets; see clark(1961) and williams(1970). thus, it is rather problematic to bound the dual variables of the follower.



all the mentioned methods so far solve a certain reformulation of the bilevel problem with general-purpose solvers. in addition, one can also develop bilevel-tailored solution techniques. already in their paper from 1981, fortuny-amat and mccarl briefly discuss the possibility to set up a bilevel-specific branch-and-bound scheme. in this scheme, problem(8) without the kkt complementarity conditions(8d) is solved at the root node. afterward, it is checked whether all kkt complementarity conditions are satisfied. if not, the most violated one is chosen and



in audet et al.(2007a), the complementarity conditions(8d) have been used to obtain so called disjunctive cuts that are applied at the root node of the branch-and-bound tree. for each violated complementarity constraint, solving a linear optimization problem yields such a cut. in a small example, the usefulness of the cut is demonstrated. it is also shown that sometimes this cut couples primal feasibility(8b) and dual feasibility(8c) and sometimes it does not.



let us close this section with some brief pointers to local methods. recently, classical mpcc regularization techniques such as the famous regularization proposed by scholtes(2001) have been used to compute c-stationary solutions of the kkt reformulation in dempe and franke(2019). in dempe(2019), even locally optimal solutions of the linear bilevel problem are obtained based on the kkt reformulation. stationary points of(10) are computed in kleinert and schmidt(2019a) by the feasible region of the lower level is bounded, i.e., a polytope, allows us to conclude that for every upper-level decision the optimal solution of the lower level is attained at a vertex of the feasible polytope of the lower level. in addition, strong duality holds for every parametric lower level problem(11c). second, we look at the single-level reformulation of problem(11) obtained by using the kkt conditions of the lower-level problem(11c):



remark that if the model allows negative prices then it implicitly permits subsidies, which may be appropriate, e.g., in the context of a central agency determining taxes. in order to avoid the situation in which the upper level would maximize its profit by setting prices to infinity and bouhtou et al.(2007) present a preprocessing method to reduce the graph size. didi-biha et al.(2006) and brotcorne et al.(2011) exploit the fact that revenue maximizing prices that are compatible with a given lower-level solution can be easily determined. they propose exact algorithms as well as heuristics based on multi-path generation.



heilporn et al.(2010b) and heilporn et al.(2011) study the particular case in which each follower uses at most one arc priced by the leader. heilporn et al.(2010b) show that the problem is strongly np-hard. further, exploiting the fact that there exists a limited number of feasible solutions for each follower, they provide an milp formulation based on the optimal value function, a polyhedral study of this formulation, and provide a complete description of the convex hull of feasible points



brotcorne et al.(2008) consider the more general problem in which the leader faces a joint design and pricing problem. here, in the upperlevel objective, a fixed cost is incurred for each arc that is installed(and priced) by the leader. the lower level is the same as in the toll setting problems. they show that the coupling constraints linking the design variables and the user arc choice variables appearing in the lower level can be moved to the upper level. these constraints forbid the followers to use arcs that are not installed. moving them to the upper level is allowed because the leader can prevent the followers to use them by setting their price very high. finally, they suggest a single-level milp formulation as well as heuristics.



network pricing problems with different lower-level problems have also been studied. brotcorne et al.(2000) consider a lower level given by an uncapacitated transshipment problem and provide an milp formulation as well as some heuristics. another variant is obtained by assuming that the lower level selects a minimum spanning tree.



mentioned formulations from both theoretical and computational point of views. on the other hand, decomposition methods scale better when the problem involves many resources and/or follower types. in this perspective, paruchuri et al.(2008) propose a solution approach involving benders decomposition and jain et al.(2010) and lagos et al.(2017) use column generation.



other variants of stackelberg security games involve more sophisticated pure strategies of the leader. resources can be heterogeneous meaning that each resource can only cover a subset of targets. resources can cover at once a subset of targets, called schedule. korzhyk et al.(2010) investigate the complexity of such variants with one type of follower. they show that a stackelberg security game with homogeneous resources is polynomial if the schedules have size at most 2 and is np-hard otherwise. when resources are heterogeneous, they show that the problem is polynomial when schedules have size 1 and np-hard otherwise. jain et al.(2010) propose a branch-andprice approach for such variants by iteratively generating columns representing pure strategies of the leader. finally, letchford and conitzer(2013) study the complexity of the case of stackelberg security games in which the targets are vertices of a graph and schedules are subgraphs with a particular structure such as path or tree.



binary vectors. further, as explained in kiekintveld et al.(2009), the mixed strategy corresponding to a given vector of marginal probabilities can be retrieved in polynomial time since it amounts to solve a linear system with a polynomial number of constraints. in the context



a common assumption for algorithms dealing with bilevel milps is that the feasible region of the hpr is compact. sometimes, this condition is relaxed and it is only assumed that discrete variables are bounded. for the latter case, xu and wang(2014) demonstrate that the unboudedness of the optimal hpr value does not reveal the nature of the underlying bilevel problem. it can happen that the underlying bilevel milp is infeasible, unbounded, or admits an optimal solution; see also section 3 for single-level milp problem reformulations, from which the best one represents the global optimum. the approach is picked up and extended to bilevel miqps in avraamidou and pistikopoulos(2019b). the authors also provide a computational study for bilevel milps and bilevel miqps. a more detailed description of the implementation can be found in avraamidou and pistikopoulos(2019a).



region of the hpr. whenever a bilevel infeasible point(together with a polyhedron around it that contains no bilevel feasible points) is discovered, it is discarded by decomposing the search space into a family of smaller polyhedra, which are then solved in a recursive fashion. two different ways to determine the bilevel-free polyhedron around a given infeasible point are proposed along with milp-based procedures for their determination.



to enhance the performance of their basic b&b method, fischetti et al.(2018) introduce intersection cuts to separate integer bilevel infeasible points, thus obtaining a b&c approach for bilevel milps. these cuts, which are traditionally used for mixed-integer programming(see, e.g., balas(1971)) are used here for the first time to solve bilevel milps: lp-optimal solutions(being integer but bilevel infeasible) are cut off by deriving a cut in which the lp-cone of this



in a recent article by bolusani et al.(2020), the authors make a parallel between bilevel milps and two-stage stochastic milps with recourse. by exploiting their common mathematical structure given by the value-function reformulation and using the milp-duality theory, a unified algorithmic framework is provided. in bolusani and ralphs(2020), a benders-like decomposition to approximate the value function and a cutting-plane method are discussed as two possible solution strategies.



crease of costs(or reduction of available capacities) imposed on the interdicted objects. for example, in max-flow interdiction settings, the leader is given a limited budget to reduce the available capacity of arcs/vertices, while the follower tries to maximize the flow in the resulting network; see, e.g., lim and smith(2007); wood(1993) and the further references therein. alternatively, in the shortest-path interdiction(see, e.g., israeli and wood(2002)), the leader can increase the cost of arcs traversed by the follower and in this case, the constraints



facility location with interdiction has been studied as well. scaparra and church(2008) investigate the problem in which the leader is concerned with protecting a limited number of facilities, assuming the follower will attack a fixed number of them in order to maximize the transportation cost between the clients and the remaining operational facilities. in zhang et al.(2016), the leader locates a fixed number of facilities first, followed by the follower, who is prohibited to use the same location as the leader. both players face disruption risks while trying to maximize the market share, assuming that each customer patronizes the nearest open facility.



interdiction problems on networks in which the follower solves an np-hard problem also fall into this category. these problems include interdiction of the clique number, or interdiction of independent sets and vertex covers.



when blocking the maximum number of cliques, e.g., the leader minimizes the(un)weighted sum of vertices/edges to remove from the graph, so that the maximum(weighted) clique in the remaining graph is bounded from above by a given integer. the blocking of vertices or edges has been studied with respect to other graph optimization problems such as the maximum matchings, shortest paths(golden, 1978), spanning trees, or dominating sets.



effective algorithms are available for solving these lower-level problems(rather than formulating them as milps and using general-purpose solvers), some recent results show that tight canonical single-level reformulations can be obtained. fischetti et al.(2019) use dynamic programming for the maximum knapsack interdiction and furini et al.(2019, 2020b) use tailored branch-and-bound solvers for two variants of the maximum clique interdiction problems. moreover, any heuristic solution of the lower-level problem also provides a valid benders-like constraint(23) and standard stabilization techniques for improving the convergence can be applied.



most of the existing literature dealing with detection of most vital arcs/vertices, with respect to some given graph-functionality measures, rely on extended milp formulations; see, e.g., the recent survey by lalou et al.(2018). interesting applications include the maximization of the total number of pair-wise connected vertices while removing a limited number of arcs/vertices from the network, the maximization of the number of connected components or the minimization of the size of the largest connected component. only recently, a connection between critical vertex/edge problems in graphs and stackelberg games has been exploited by furini et al.(2020a) and furini et al.(2021), where the authors derive canonical formulations in



finally, we point out that an up-to-date survey on network interdiction models and algorithms can be found in smith and song(2020). the survey also includes other aspects not covered in our survey such as interdiction under uncertainty, multilevel interdiction also known as defender-attacker-defender games, as well as interesting problem extensions including situations in which both players act simultaneously, or problems with information asymmetry or information incompleteness(for either the leader or the follower).



