substructures representing commonly observed fgs were extracted from compounds using the fg identification algorithm introduced by ertl. the method identifies all heteroatoms in a molecule together with carbon atoms connected by non-aromatic double or triple bonds to other carbons or any heteroatom, acetal carbons, and oxirane, aziridine and thiirane rings, and combines subsets of connected marked atoms into fgs. fgs are then extracted together with atom environment information(i.e., bonded carbon or hydrogen atoms) and assigned to ing, dropout, and dense layer. max-pooling was used as pooling layer to compute the maximum value in each patch of each convolved feature map. a dropout layer was added to avoid overfitting. to train the scnn model on compound images or condensed graph of reaction(cgr) rep-



stride 2. for transfer learning, the iv-3 architecture was slightly modified by replacing the last fully connected layer with three fully connected layers of output dimensions of 500, 1000, and 2000 neurons, respectively. as final layer activation functions, sigmoid and softmax were used for fg multi-label classification and ac prediction, respectively. models were trained using the adam optimizer to minimize binary cross en-



mmps can be represented in a single graph using the condensed graph of reaction(cgr) approach. the cgr formalism was originally conceived to combine reactants and products graphs based upon a superposition of invariant parts. the resulting cgr is a completely connected graph in which each node represents an atom and each edge a bond. in a cgr, the shared core of an mmp and the two exchanged substituent fragments are represented as a single pseudo-molecule. mmp cgrs were generated using an in-house python script and converted into a pseudo-molecule using the rdkit api. the larger fragment was connected with the core via a single bond and the smaller fragment a hypothetical zero-order bond. for each pseudo-molecule,



that were involved in the formation of most fgs. on the other hand, the i-in model detected more general chemical features covering both the core structure and fgs. these observations provided a rationale for successful transfer learning by the i-fg model, given its ability to specifically recognize fgs that distinguished between compound forming acs and non-ac mmps.



abadi m, barham p, chen j, chen z, davis a, dean j, devin m, ghemawat s, irving g, isard m, kudlur m, levenberg j, monga r, moore s, murray dg, steiner b, tucker p, vasudevan v, warden p, wicke m, yu yzx. tensorflow: a system for large-scale machine learning. 12th usenix symposium on operating systems design and implementation(osdi 16), savannah, ga; 2016.



