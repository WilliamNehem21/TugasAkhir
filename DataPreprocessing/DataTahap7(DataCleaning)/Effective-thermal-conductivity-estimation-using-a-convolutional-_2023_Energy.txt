simulation. when employed in topology optimization, the cnn retains a mape between 0.67% and 11.8% for different cases. the cnn model correctly predicts trends in effective thermal conductivity and improves the structure to close proximity of a theoretical maximum in all cases.



heterogeneous materials are an intrinsic aspect of many fields of study in science and engineering for their incredible inherent mechanical and transport properties. in energy research, transport properties related to the geometry, orientation, and topology of the material are often intrinsic to overall system performance. studies have shown several physical properties, such as effective diffusivity[2,3], permeability[2,4,5], or even structural properties, have integral dependence on the distribution of the phases involved.



a multitude of analytical and empirical correlations have been made to predict the effective thermal conductivity of a system[7,8], but such models often assume simplified geometries, thus having very limited ranges of validity covering small subsets of topology and porosity. the alternative is experimenting or simulating to predict the property, both of which have significant physical time and cost associated. an alternative method for obtaining both effective thermal conductivity and effective diffusivity efficiently is based on the random-walk theory[8,9]. these studies highlight the speed advantage of randomwalk-based models over conventional numercial heat transfer(nht) models, while providing higher accuracy than empirical models. this type of model has the added benefit of providing fast computations for either 2d or 3d domains.



in energy research, wu et al. considered cnn architectures based on alexnet and resnet to predict the effective diffusivity of porous media solely from images, with a training dataset of 1960 samples. the proposed model performs more accurately than empirical. however, the accuracy is still limited to a certain extent, possibly because of the relatively few images to train the cnn. the prediction time is not discussed, and there is no validation of the cnn model with data outside the dataset.



wei et al. used a cnn as well as other ml methods to predict the effective thermal conductivity of composite materials and porous media. with an original cnn architecture, using a maximum dataset size of 1400 samples, an accuracy in terms of correlation coefficient(r2) of 0.986 or a relative mean squared error(rmse) of 1.9% is reported, which is often more accurate than popular analytic models such



while the aforementioned studies[14,17,18] use cnns for predicting properties relevant to energy research, the accuracy and efficiency need to be further refined in order to be employed in practical situations, as there are no discussions on prediction time, cnn optimization, and general predictions outside of the dataset. this study uses recent advancements in training cnns and parameter optimization to propose a cnn-based model to predict effective thermal conductivity. we thoroughly discuss how the accuracy of the nht model, cnn architecture, hyperparameter selection, dataset size, and training schedule all collectively impact the accuracy of the cnn in predicting effective thermal conductivity, while also taking in consideration the prediction speed. finally, this cnn model is validated with structures that possess analytical results and data outside the dataset, to make sure the cnn model can retain accuracy in prediction even if the input is significantly different from the training dataset. our model is optimized for speed, accuracy, and generalization across multiple types of 2d structures, by drawing inspiration from the vgg-class networks. the cnn-based models can make predictions from newly entered data in milliseconds. in contrast, a prediction of a 3d model using the random-walk approach takes seconds[8,9], and a 3d nht model takes minutes.



we created a dataset with more than 130,000 images and their thermal conductivities simulated by central-differencing based nht model. the nht model is parallelized and all nht simulations were performed with the resources from the bridges2 supercomputer from the pittsburgh supercomputing center. the size of the dataset can be hard to manage on a conventional computer, so the training and testing of the proposed cnn models and architectures are all done with resources from the gpu partition of the expanse supercomputer at the san diego supercomputer center.



another objective of the study is to assess whether or not the cnn predictive model can be applied to iterative topology optimization problems. topology optimization is a process of changing structures to maximize or minimize a specific property. the main challenge in iterative topology optimization is that the optimized properties of the structure must be reassessed at every structural update. thus the computational cost often limits the size of the domain as well as the complexity of the model[22,23]. the cnn-based predictive model could reduce the computational time by orders of magnitude, enabling much larger domains as well as complex cost functions. the prediction accuracy of material properties at each step is critical to the success of topology optimization. despite some existing studies on ml for material optimization, a cnn model that is accurate enough for iterative topology optimization has yet to be successfully demonstrated, to the best of the authors knowledge.



the following section will outline the dataset generation. section 3 then presents the choice of architecture and hyperparameter optimization, which is an adaptation from the vgg family of cnns. section 4 investigates the accuracy of the model in training and testing, potential sources of error, prediction speed in different environments, and validations of the proposed model using test cases from analytical solutions. section 5 applies the trained cnn models to test four cases in topology optimization to demonstrate a practical application of the model. section 6 concludes the work. the trained network, the training dataset, and a sample code showing how to load and use the models are available to download.1



a key component of this study is the generation of images for the training dataset, as well as simulating their effective thermal conductivity. ideally, these images would encompass as many different types of heterogeneous structures as possible, such that the cnn model applies to a broad range of structures after training. sharing the images in an open-access format encourages other researchers to contribute to this dataset, making it better generalized over time, and exposing the cnn in training to as many features as possible.



a multitude of cnns are available for the problem of image segmentation and detection. for the problem of predicting physical properties based on geometry, the ideal network provides a combination of sufficient accuracy with a reasonable computational cost. the vggclass networks, namely vgg16 and 19, are peculiar in the way the layers are stacked, having some unique advantages that are particularly relevant in terms of efficiency, memory storage, and training speed. the the tasks of predicting effective thermal conductivity. wu et al. conclude from their work that the mean-squared error(mse) trends to be smaller when the cnn has fewer convolutional layers. similarly, zhu et al. arrived at a similar conclusion: the best accuracies in training and testing for effective thermal conductivity prediction were achieved when the cnn had 2 convolutional layers. conversely, others[20,35] suggest that deeper networks are more capable of extracting relevant features. the deepest layers, as well as the fully-connected(fc) layers play a major role in the accuracy of prediction.



the number of nodes does not seem to have a big effect on the prediction accuracy as long as the number exceeds a minimum number. when the numbers of nodes are as small as 2/2/1, the prediction is highly inaccurate. when the numbers of nodes increase to 4/4/1 and to 64/64/1, all testing and training results have reasonable accuracy. we adopt 64/64/1 as it provides more consistency between testing



model a presents the best consistency between training and validation, does not overfit, and oscillates the least in later epochs. model b performs better in training than in testing, which indicates a certain degree of overfitting. model b is the one outlined in prior art for the problem of effective diffusivity. when model b is applied to the current problem, the number of epochs is excessive and does not provide any benefits in testing compared to model a. on the other hand, increasing the batch size for model c only results in more overfitting and higher mape compared to the similar model a. increasing the batch size from model a creates more overfitting, while decreasing batch size did not provide any benefits. finally, lowering the learning rate and training for longer in model d does not improve the overall mape and generates the most overfitting. however, we note that model d considerably decreases mape oscillations in later epochs when compared to the other models. a more general and diverse dataset would neutralize the oscillations observed in models a, b, and c.



while there are several topology optimization approaches, this study simplifies the process to swapping voxels in the solid phase for voxels in the fluid phase. the objectives of this section are twofold: demonstrating that the cnn can present reasonable accuracy in realworld scenarios involving data outside of the training dataset, as well showing a potential application of the cnn in non-gradient iterative topology optimization as an efficient alternative to a conventional simulated physical property prediction. thus, the focus is not on devising a unique optimization scheme, instead, the focus is on assessing the accuracy and efficiency of the cnn in different scenarios. the only restriction when picking the voxels for swapping is to pick voxels at the interfaces between the solid and fluid phases. in other words, the randomly selected voxel must have at least one adjacent voxel belonging to a different phase. during each iteration, if the voxel swap results in higher thermal conductivity or cost function, the swap is accepted. otherwise, the two picked voxels will be returned to their original coordinates.



the aforementioned process of random voxel swapping can lead to local maxima, where the thermal conductivity is not close to the theoretical maximum and yet no successful swaps can be found. for that reason, the simulated annealing algorithm(saa) is employed to determine if mutations occur or not. if the value of the cost function decrease, either the swap is reverted or a mutation occurs. mutations are swaps that, albeit counterproductive to the optimization process from the point of view of the cost function, get accepted to avoid local minima/maxima. we applied the cnn model and saa for one



effective properties of the aluminum-water system predicted by cnn, as seen in section 4, have considerably higher errors than the case with the thermal conductivity ratio of 10. the ratio of thermal conductivities is close to other metals filled with fluids, so this is a case with more real applications. if the topology optimization using cnn correctly predicts the trend in thermal conductivity in the aluminumwater system with changes to the structure, then this modeling tool can be extrapolated to other material combinations.



surface area is an important parameter in energy related heterogeneous systems. this case study is meant to showcase how the output of the cnn can be used alongside another variable which does not have the same units for optimization. the first step in combining thermal conductivity and surface area is normalizing and non-dimensionalizing both quantities.



one critical limitation of the cnn model is that it is completely blind to physics, and does not produce a temperature or heat flux map of the domain as an output. in that sense, cnn cannot be paired with the evolutionary structural optimization(eso) approach, which is a powerful method for taking educated guesses at potential voxel swaps in the structural optimization field. the cnn model can be improved by taking physical properties in addition to images, as input. in that case, the model would be able to generalize to a wider variety of material combinations at the cost of increased computational time.



nonetheless, the efficiency and accuracy displayed by the cnn are attractive for both academic and industrial design of heterogeneous materials and on demand effective thermal conductivity estimation. furthermore, this study shows that the accuracy and generalizability of the training dataset attribute to the majority of errors on cnn predictions. thus, future research directions of the cnn model include increasing the size and improving the quality of the training dataset, adapting the model to three dimensions, and extending the model to other materials with different properties.



to 0 or 1), fewer images are needed since the theoretical maximum and minimum converge to the same value. on the other hand, between svf of 0.3 and 0.7 is where the majority of images need to be to cover the design space.



for comparison, zhu et al. utilizes similar theoretical test cases in 3d to validate a conventional lbm as well as a modified one in 3d for effective thermal conductivity. while numerical comparisons between lbm and theoretical cases are not explicitly expressed, by visual inspection we note significant differences between the models and theoretical results, especially the convectional lbm.



ke et al. proposed another modified lbm method for 2d effective thermal conductivity estimation. for the same theoretical test cases, with thermal conductivity ratios varying between 0.01 and 100, the authors reported deviations of less than 1.0% for both parallel and series test cases. for these thermal conductivity ratios, our error is less than 0.01% with the convergence criteria used in the training dataset. neither study has additional data and results published in open access format, so we refrain from further comparisons. however, we do note that a version of our nht simulation for effective thermal conductivity, both in 2d and 3d, is available on github.2 the entire dataset and all simulation results used to train the cnns are also choices aimed at achieving precise solutions within a practical time frame. hence those were fixed values for all simulations and comparisons to the theoretical model. thus, to increase the accuracy, we recommend simply increasing the maximum number of iterations and making the convergence criteria more strict. through testing, we have observed that this adjustment significantly decrease the error versus the theoretical model at the cost of computational time.



