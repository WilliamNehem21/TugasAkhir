phylogenetic trees have been used in many fields of science to describe how a set of objects(e.g., biological species, proteins, nucleic acids, languages, chain letters, or medieval manuscripts) produced by an evolutionary process are believed to be related[2,15,19]. in a phylogenetic tree, the objects are represented by leaves and common ancestors by internal nodes so that the branching structure of the tree reflects the assumed evolutionary relationships. however, certain evolutionary events such as horizontal gene transfer or hybridization



recently, various algorithms for constructing and comparing phylogenetic networks have been proposed(see, e.g.,[4,11,17,18,21]). here, we consider the following scenario. suppose a number of phylogenetic networks, each one describing the possible evolution of a fixed set of objects, have been obtained by applying different construction methods or different clustering criteria to some available data. furthermore, suppose that these networks do not completely agree because of distortions due to assumptions inherent to the methods used or because of measurement errors. it would then be informative to find a subnetwork contained in every one of the input networks with as many labeled leaves as possible since such a subnetwork more likely represents genuine evolutionary structure in the data. in this way, one would get an indication of which ancestral relationships can be regarded as resolved and which objects need to be subjected to further experiments.



1 in mast, the input is a set of leaf-labeled trees and the goal is to compute a tree contained in all of the input trees with as many labeled leaves as possible; see, e.g., or for a formal definition. mast is also referred to as the maximum homeomorphic subtree problem(mht) by some researchers.



given a set= n1, n2,..., nk of phylogenetic networks for l, an agreement subnetwork of is a phylogenetic network a such that for some l' l it holds that a is a subgraph of each of n1 l', n2 l',..., and nk l'. a maximum agreement subnetwork of is an agreement subnetwork of with the maximum possible number of leaves. the maximum agreement phylogenetic subnetwork problem(masn) is: given a finite set l and a set n of phylogenetic networks for l, find a maximum agreement subnetwork of n.



no results for masn in its general form have appeared in the literature before. on the other hand, the special case of masn known as the maximum agreement subtree problem(mast) has received a lot of attention in the last ten years. below, we summarize some of the most important results known for mast.



we define the concept of a level-f phylogenetic network in section 2. then, in section 3, we present an algorithm for computing a maximum agreement subnetwork between two level-1 phylogenetic networks in o(n2) time. this is the first polynomial-time algorithm ever for this problem. our algorithm can be extended to solve masn for two level-f phylogenetic networks n1 and n2 in o( v(n1) v(n2) 4f) time(where v(ni) denotes the set of nodes of ni), which is polynomial in the input size for any f which is upper-bounded by a constant. next, in section 4, we prove that in the general case(i.e., for levelf phylogenetic networks where f is unbounded), the maximum agreement phylogenetic subnetwork problem is np-hard even if restricted to just three networks. finally, we state some open problems in section 5.



let n be a phylogenetic network for a finite set l. recall that nodes with outdegree 0 are called leaves. we refer to nodes with indegree 0(i.e., the root of n) or 1 as tree nodes and nodes with indegree 2 as hybrid nodes.



n is said to be a level-f phylogenetic network if every biconnected component in the undirected graph obtained from n by replacing each directed edge by an undirected edge contains at most f nodes that are hybrid nodes in n. note that n is a tree if f= 0. if f= 1 then every node in n belongs to at most one pair of merge paths 2. moreover, if f= 1 then every hybrid node in n has only one split node and any node in n can be a split node for at most one hybrid node.



