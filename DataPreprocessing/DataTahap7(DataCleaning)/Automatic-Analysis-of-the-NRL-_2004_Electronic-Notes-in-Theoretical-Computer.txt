component is the nrl pump[13,14,12], which is a trusted device that acts as a router forwarding messages from a low-level system to a high-level system, by monitoring the timing of the acknowledgments in the opposite way. more precisely, the nrl pump lets information be securely sent from a system at a lower security level to one at a higher security level. now, if the high system passed acknowledgments directly to the low system, then, the high system, by altering the acknowledgment timing, could pass information to the low system. to avoid such covert channel, while maintaining acknowledgments to have a reliable communication, the pump decouples the acknowledgment stream. as, however, for performance reasons, the long-term high-systemto-pump behavior should be reflected in the long-term low-system-to-pump behavior, the pump uses statistically modulated acknowledgments.



of the acknowledgment is probabilistically based on a moving average of acknowledgment times from the high agents to the pump. in this way, the high agent cannot alter the acknowledgment timing to send information to the low agent. moreover, the long-term high-agents-to-pump behavior is reflected by the long-term pump-to-low-agents behavior, so that performance is not degraded.



we denote with p(l, x) the probability that the nrl pump sends an acknowledgment to the low system at the time l when the average acknowledgment delay time is x. of course p(l, x) can be defined in many ways each of which may yield different performances as of security. we shall examine possible choices for p(l, x) in section 5. moreover with the time tmax we denote the nrl pump timeout.



automaton pump2 starts its execution when the initialization is finished(symbol grantl). pump2 can forward a message to the high system when at least one message is in the buffer(condition b> 0). after the message has been forwarded(symbol sendh), pump2 receives an acknowledgment from the high system(symbol ackh). the time of this acknowledgment is stored in the variables x1..., xn which are used as an array. the index ls represents the position in which the new time must be stored. if the time is over tmax, then the connection is expired. if the connection is closed by the low system and either the buffer is emptied(transition from s2 to s1) or the time is expired(transition from s3 to s1), then pump2 enters state s1 and waits for a new for a very long time before making a decision(e.g. by making decision thr very small) the low system can be quite sure of making a correct decision. however, the more the observer waits for making a decision, the smaller the bit-rate of this covert channel. our goal is to estimate the probability that the observer takes the correct decision within h time units.



