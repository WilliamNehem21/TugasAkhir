gin, defined as ic50/cmax in plasma, and used in risk assessment in later discovery phases. the pre-clinical safety(pcs) department at novartis monitors the bsep safety margin. low bsep safety margin relates to higher risk of serious dili, and conversely. at early stages when expo-



tant practical limitation is that compounds falling into the intermediate activity range were excluded, which simplifies the modeling task. in a recent study, mcloughlin et al. reported an extensive benchmark of predictive models for bsep inhibition using 1149 compounds. authors evaluated over 15,500 models using different algorithms, hyperparameters, descriptors, and data splitting approaches, e.g., random and scaffold-based. superiority of deep learning methods was not observed, and the preferred approach was rf with molecular operating environment(moe) descriptors, similar to montanari et al.[13,14].



the in-house bsep assay measures[3h]taurocholate uptake by inverted vesicles prepared from hek293 cells over-expressing human recombinant bsep(hrbsep). bsep inhibition is quantified with the half-maximal inhibitory concentration(ic50). in vitro bsep data was assembled and pre-processed. measurements without associated structure or report date were discarded, and salts were removed. the data set con-



compounds were represented using rdkit 2d descriptors and/or morgan fingerprints(mfp). descriptor vectors had a length of 200(rdkit version 2019.03.3) and included molecular weight, calculated logp, topological polar surface area, number of hydrogen donors and acceptors, count of specific substructures, among others. mfp is a hashed fingerprint that encodes circular atom environments up to a given diameter. herein, the count version of mfp was utilized, where the number of occurrences of a given atom environment or substructure is encoded. mfp had a length of 2048 with radius 2.



ml methods were applied for classification and regression models. linear regression methods included partial least squares(pls) and lasso regression. pls reduces feature dimensionality focusing on covariance, prior to a linear regression model. pls is applicable to multicollinear features. lasso regression utilizes shrinkage or l1 regularization and generates sparser models by adding a penalty to rely on less parameters. non-linear support vector regression(svr) with a radial basis function was also applied. svr is an extension of support vector machines(svm). svr maps data into a higher dimensional space and



classification methods comparison. binary classification performance for models based on 2d descriptors and/or mfp, and tree-ensembles(extratrees, rf, xgb) or k-nn. reported are the auc, mcc, and ba for all calibration set compounds and for reliable/conclusive predictions only. the percentage of inconclusive predictions is also shown.



learning rate(0.01, 0.1, 0.2), maximum depth(6, 12), subsample(0.1, 0.3) hyperparameters were optimized. the optimized xgb model with 2d descriptors and mfp used 500 decision trees, a learning rate of 0.01, maximum depth of 12, and a subsample of 0.3.



definition. the number of scaffolds and compounds per scaffold were calculated and statistics showed that there is a high percentage of singletons in the data set and only few large clusters, in particular 14(4) clusters with at least 10(20) compounds. from the external validation set compounds, 88% contained bmss that were not contained in compounds from the training and calibration sets. as an alternative way of



training data or from the same chemical series(scaffolds). moreover, permutation tests were carried out to assess the significance of obtained results. xgb binary classification models were built with shuffled labels and the performance was assessed in independent trials. the model trained on data with random labels had a mean auc of 0.55 and ba of 50%, and did not achieve the performance of the model based on



precision in the prediction of bsep inhibitors. when the model flags a compound as a bsep inhibitor, there is a high probability that this is correct. moreover, the model is generally applicable since it has been prospectively evaluated on a relatively large and representative set of compounds, which includes different chemical series.



assessment analysis nor a medium class. despite being trained on public or external data sources, promising results were obtained for admet predictor and etransafe models. nevertheless, the in-house xgb model reached higher performance than these models, regardless of the applied thresholds for the definition of inhibitors and non-inhibitors. when only conclusive predictions were considered, performance differences substantially increased. higher ppv, npv, mcc, and ba values were obtained for all comparisons. ppv and npv values for the in-house model reflect the high utility of the model in practical applications since predictions are very likely to be true, particularly 89% and 84% for inhibitors and non-inhibitors, respectively.



the trade-off between training and test set splitting is a classical issue in ml. more training data generally implies a better model and, depending on the data composition, might lead to higher accuracy or less variance. similarly, more test or validation compounds improve performance estimation, which is critical to assess the generalization ability of a ml model. herein, svr models were evaluated at different points in time with the data not used for model training.



scale. since a single hold-out set might lead to over/under-optimistic estimation of predictive performance, a representative prospective test set and the consideration of both long and short-term validation(i.e. multiple splits) were essential to assess svr generalization ability in scenarios that resemble future model usage.



despite deviations from measured values, spearman rank correlation values ranged between 0.74 and 0.78. current literature strategies for reducing bsep inhibition focus on modifications of molecular weight and lipophilicity. however, the spearman rank correlation between these properties and bsep inhibition ranged from 0.56 to 0.61, being slightly lower for logp. these results suggest that ml models provide a better ranking and more effective guidance for compound modifications than considering these two properties individually.



herein, ml classification and regression models were generated for the prediction of bsep inhibition, an important dili risk factor. ml models can make predictions for any compound, even prior to synthesis, solely from chemical structure. this provides a valuable opportunity. however, robust model building and evaluation are key for supporting correct decisions in pharmaceutical industry. a predictive safety modeling work has been reported from a practical drug discovery perspective, focusing on the importance of defined classification categories and ml set-up, which greatly influence the quality of ml-based decisions.



taken together, ml-based predictions can be used as an additional factor providing decision support when progressing compounds during early stages of drug discovery and in vitro experiment prioritization. in vitro experiments can be limited to those compounds for which models do not give reliable predictions and the most promising compounds for which a numerical value is preferred. even at discovery phases when safety or liver toxicity are still not being considered, bsep classification predictions are made available, which helps to de-risk compounds or series at early stages.



