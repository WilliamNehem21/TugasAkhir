due to its distributed and open nature, web services give rise to new security challenges. this technology is susceptible to cross-site scripting(xss) attack, which takes advantage of existing vulnerabilities. the proposed approach makes use of two security testing techniques, namely penetration testing and fault injection, in order to emulate xss attack against web services. this technology, combined with wssecurity(wss) and security tokens, can identify the sender and guarantee the legitimate access control to the soap messages exchanged. we use the vulnerability scanner soapui that is one of the most recognized tools of penetration testing. in contrast, wsinject is a new fault injection tool, which introduces faults or errors on web services to analyze the behavior in an environment not robust. the results show that the use of wsinject, in comparison to soapui, improves the detection of vulnerability allows to emulate xss attack and generates new types of them.



web services are modular software applications that can be described, published, located, and invoked across a network, such as the world wide web. because of its distributed and open nature, they are more susceptible to security risks. beyond the traditional insecurities, new ones arise, associated with technologies and services such as soap and xml. one example is the so-called injection attacks, among the most exploited in 2012, according to the open web application security project 3(owasp top ten 2013).



a variation of this attack allows to inject scripts(e.g. javascript, vbscript or flash script) in web services through its parameters and operations described in their wsdls. the objective of the attacker is to inject malware 4, modify the database and infect every user who uses these web services.



every day, new vulnerabilities are found and new attacks are developed. this way, the w3c 5 has developed various specifications to protect web services. the first specification proposed for web services was ws-security(wss) in 2004. wssecurity specifies how integrity and confidentiality can be enforced on messages and allows the communication of various security tokens, such as saml, kerberos and<wsse:security> to use one security specification, in this case uername token. web service can contain more than one tag<wsse:security> to insert more security specifications(xml encryption and xml signature). within the tag<wsse:security> we use the tag<role> that specifies the privileges for a specific user. the tag



the static phase tries to find faults inserted during the development phase introduced in the code by possible human errors in the project stage. this phase is analyzed as a state not reachable, i.e. it can always be found new faults. in this case, the methods used are static analyze(code inspection, static vulnerability analysis) or theorem proof, which do not need to run the system. these methods are early detection and carry many benefits such as reduced cost of testing.



penetration testing emulate attacks, in order to reveal vulnerabilities. the tests are automated by the use of tools called vulnerability scanner(vs). there are a variety of vulnerabilities scanners, both commercial(e.g. hp web inspect, ibm rational appscan) and open source(e.g. wsdigger and webscarab). the vulnerabilities detected differ from one tool to another. an evaluation of several commercial versions of vulnerabilities scanners showed that these tools are primarily limited to low coverage of existing vulnerabilities and the high percentage of false positives.



fault injection is a technique that can be used to assess aspects of dependability of computing systems and can be implemented in hardware or software. this technique emulates errors, failures or anomalies in the target system and observes its behavior under a stressful environment. fault injection dates back to 1970 when it was used to induce hardware faults. this technique can be used to validate fault tolerant system, assisting in the removal and prevention of faults while minimizing its occurrence and severity,.



our aim is using fault injection to insert software faults and analyze the behavior of web services in a non-robust environment. there are several ways to inject faults into a system. the most attractive, from the point of view of implementation cost, is the fault injection in software. in this case, the faults are introduced by an injector, which is a software responsible for inject faults in the system, either before or during the run. in this technique, the tests consist of two input sets: the workload and the faultload. the first represent the usual entry to the system that serves to activate its functionality, while the latter represents the faults to be introduced.



there are numerous works in the literature suggesting the use of fault injection and penetration testing techniques to test the security in applications: in, this technique was applied to test a security protocol used for communication of mobile devices on the internet. in and the authors use perturbations in the soap messages for emulating attacks, similar to our proposal. these studies use injectors that emulate a type of attack, while ours is for general purpose, i.e. our injector emulates different types of attacks and allows to generate combinations of them.



in the following sub-sections, we briefly describe the results of each phase of the implementation of the security testing methodology with xss. this attack is emulated with wsinject and soapui. the reader who wishes to know more about this methodology should look at and.



to identify the objectives of the attacker was necessary to make a research on vulnerabilities in web services, with the aim of gathering information about xss. for this, we decided to search in articles,,, and standards that present vulnerabilities in the context of web services. while some of the vulnerabilities are caused by shortcomings in the implementation, most of them explore basic faults of the protocol, i.e. abusing of the flexibility of soap.



at this stage, the attack scenarios are produced automatically according to the criteria defined in section iv.c of. the output of this step is the attack scenarios described in the same format of the tree leaves, each one representing the description of an attack.



at this stage, we identify the behavior of web services in presence of xss attacks, tested by vulnerability scanner soapui. the tool injects scripts through the add-on security testing and analyzes the response from servers, classifying the responses in web services, vulnerable or not, by the injection of xss attack. for this, we installed the soapui version 4.5 with the add-on security testing on a laptop with operating system(os) windows 7, cpu intel core2 duo 2.00ghz and 3.00gb ram.



the fault injector use scripts in format of text files. these ones describe the faults to be injected in web services, emulating attacks. the scripts are composed by one or more faultinjectionstatements. each one is composed by a conditionset and a faultlist. the faultinjectionstatements work with commands of conditionaction type. when it intercepts a soap message and satisfy a set of condition, the



the results of the penetration testing phase helped to develop the rules for vulnerabilities analysis. however, the results obtained by soapui show a large percentage of false positives and false negatives. we also verified the security provided by ws-security standard with the add-on security token against xss attack. in both phases, the use of ws-security reduces significantly the number of vulnerabilities. however, this can be improved with the use of other specifications.



seo j., hs kim, s. cho, and s. cha. web server attack categorization based on root causes and their locations. in proceedings of the international conference on information technology, coding and computing, itcc 2004, ieee computer society press, las vegas-ne, usa, 5-7, april 2004.



