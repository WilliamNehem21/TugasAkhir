type 2 diabetes. cvd, for example, caused 17.5 million deaths in 2012(mainly due to heart attacks and strokes). by 2030, this number is expected to increase to reach almost 22.2 million. meanwhile, diabetes caused 1.5 million deaths in 2012, according to the global report on diabetes.



the rest of this paper is organized as follows. section 2 presents preliminary definitions concerning iot-healthcare systems, blockchain technology, and ipfs. section 3 describes the proposed approach. section 4 illustrates the use cases and a practical scenario of this approach. section 5 gives details about the implementation of the system. section 6 discusses the security of our system. section 7 presents the related work. then, in section 8, we conclude the paper and introduce some future work.



blockchain is split into three types: public, private, and consortium. the difference is related to data visibility and the consensus process. in public blockchain, everyone can participate in the consensus process, have access to the ledger and append data to it. in private blockchain, both access to the ledger and participation to the consensus process need permission from the owner organization. the consortium blockchain groups both types. the access to the ledger can be public or private. however, the consensus process can be controlled by several organizations instead of a single one.



when a transaction is sent to the ethereum network, it is signed by the user digital signature generated by his private key. on the other hand, anyone on the network can check if the transaction is valid. the validation process is done by verifying that the digital signature matches the ethereum address, so the public key, of the sender.



the use of iot with blockchain to create a medical platform to ensure emr integrity management. in this work, they used hyperledger for testing. mamta et al. proposed a scheme for online storage and retrieval of personal health data in a typical cloud-based cyber-physical systems. their solution is based on the use of blockchain and attribute-based searchable encryption.



all these solutions are using a centralized database to store data and not all of them are encrypting data before storage. various other researches have proposed systems and approaches that combine iot with blockchain technology for security reasons. lu et al.



other iot devices to access to the blockchain. due to its limited capabilities, the smartphone will not store the whole blockchain but will just have access to through a dapp. when the patient creates his profile, the dapp creates a blockchain account for him, and a pair of keys is generated to be the unique identifier for him.



it includes physicians, hospitals, pharmaceutical laboratories and public health organizations. these entities are connected with patients through a blockchain network to have access to their health data. physicians are connected to the blockchain, as a light node, through their computers or smartphones. hospitals play the role of full nodes that can store a copy of the blockchain and participate in the consensus process. the other entities can have a copy of the blockchain, but they cannot participate in the consensus process. the patient data will be used for remote monitoring, analysis, and research purposes.



on this side, we use the ipfs, which is a peer-to-peer distributed file system, as an off-chain database to store encrypted health data. we used ipfs for data storage instead of blockchain for two reasons, in one hand, because the system handles a large amount of data which are generated by a large number of devices. storing such an amount of data in the blockchain can affect its size and will need special full nodes to store data. thus, the blockchain is used only for access control and to protect data integrity. on the other hand, since it is not practical to store sensitive data in the blockchain even if it is encrypted. as we know, data are stored in the blockchain eternally, so if the encrypted system is broken in the future, all nodes can then decrypt and have access to the data of all patients in the system.



as we already motioned in section 2.2, the security of blockchain is generally ensured by several elements, namely: cryptography, immutability, replication, traceability and consensus algorithm. in addition to these features, our system exploits also smart contracts for access control and proxy re-encryption for data encryption. in this work, we integrated smart contracts to register or delete devices, grant or revoke access to data and verify the authentication.



diabetes is a major chronic disease that has reached alarming levels. according to the international diabetes federation, in 2019, the number of people living with diabetes in the world is 463 million. this number is predicted to rise to 578 million in 2030 and 700 million in 2045. in 2019, the number of children and adolescents(up to 19 years old) living with type 1 diabetes is over one million. 136 million people with diabetes are over



alex is a diabetic man who travels all the time due to his work. by using our system, he could manage his diabetes even when he travels by caring his medical and wearable devices. these devices could collect data and send it to his smartphone which will be in charge of sharing it with his medical team for remote monitoring. in case of an emergency, the system would be able to send an alert to the nearest emergency service to instruct an ambulance to assist the patient. the system will check if the emergency physician is enrolled in a known medical entity. if so, the data will be reencrypted for them, and the system will give the physician a temporary access(section 5.1). the physician will be able to get the patient data just during the treatment, but he will not be able to access to it in the future.



encryption is implemented in our approach. first, we generate a pair of keys(public and secret keys) for both the patient and the physician. the patient encrypts the data using his public key(pkpatient). then, generates the re-encryption key(prek) by using his secret key and the physician public key. once the reencryption key is generated, it is sent to the hospital(the full node), which will play the role of a proxy that will re-encrypt the data on behalf of the physician. the hospital checks if the physician has permission to access data. if the physician has access rights, the hospital re-encrypts data for him by using the re-encryption key



algorithm 2 is the function to invoke whenever a patient wants to register a new device in the blockchain. this function takes in parameters the device mac address. it adds a device to the list of the patient who sent the transaction. it links the device mac address with the patient address(which is represented in the algorithm by the sender). before adding the device, it first checks its existence in the patient list. thus, we can prevent the registration of the same device many times, especially in the case of malware infection.



algorithm 3 represents the function responsible for adding a permission role to a physician. the function takes in parameters, the physician address for whom the permission will be accorded, the read and write permissions, and the hash information. the last one is used in the re-encryption process. for each patient, we create a list of entities for which he accorded the access and permission given for each of these entities.



tant features of blockchain is the decentralization and replication of data. that prevents the single point of failure and ensures data availability. the availability in our system also benefits from the use of different medical devices, smartphones, and the dapps that guarantee the interaction with the system.



just by a unique identifier which makes his identification impossible by other nodes and restricted for his physician. the second one is data encryption, data is encrypted and stored in the ipfs and just his hash is stored in the blockchain. the third one is controlling access to this data.



registered due to the immutability feature which protects the data from being tempered. on the other hand, smart contract deployed in the blockchain control access to the hash data. thus, only authorized parties are able to access and append data. blockchain also allows traceability by registering all manipulations and actions made in the data.



mised. in our approach, the transaction is encrypted and signed by a private key which is known only by its owner. to be validated, the transaction should be signed by a valid signature belonging to the emitting address. thus, it is too hard for an attacker to forge a signature without knowing its associated private key.



in a future work, we aim to extend this work by implementing our solution using the hyperledger blockchain and compare it with the current solution based on ethereum. we plan also to integrate artificial intelligence into our system to make it smarter and add more features. with artificial intelligence, we could provide data analysis, predictions, and prevention. the system would help physicians to make better clinical decisions and to provide an effective treatment.



