a variety of machine learning-based intrusion detection methods has been presented to researchers in recent years utilizing a variety of publicly accessible datasets. while some machine learning models might perform well on a particular dataset, they might have difficulty generalizing to new data from different sources. for example, jain et al.



kddcup, cicids, cyber clean center(ccc), etc. the model accuracy is more than 99% for all the datasets. this proposed model addresses the limitations of existing intrusion detection systems and provides a framework tested with multiple datasets, making it more reliable and accurate in detecting intrusions.



this section presents a quick summary of earlier research on machine learning and detection systems for intrusions, emphasizing their advantages and disadvantages. this sets the context for the proposed ensemble-based machine learning approach, which is the focus of the research paper. researchers make numerous machine learning-based model approaches at different times over the years. to better comprehend the significance of our proposed ensemble-based approach to detect intrusion and ensure network security, we discussed fairly current models with their strengths and drawbacks.



papamartzivanos et al. developed a method for the detection of network intrusions in 2018. they introduced dendron, a novel approach for creating decision tree(dt) classifiers using genetic algorithm(ga), in order to give detection criteria in the context of abuse systems for detection. they employed three distinct publicly available datasets to



nb15, whereas the average accuracy was only 52%. as a result, the detection efficiency of various datasets varies significantly. from here, it is obvious that this kind of model can only be used with particular kinds of datasets or cyberattacks. when a new intrusion occurs, it will be unable to identify attacks.



significantly differ. a different dataset indicates a different attack or intrusion pattern. in both situations, detection is not completely effective. for network intrusion detection, another model employed by elmasrya et al. is a dual particle swarm optimization(pso)-based approach to choose feature subsets and hyperparameters simultaneously. it is essential to consider that the proposed approach is only tested on two popular ids datasets, and it could not be adapted well to other datasets. using deep learning models and the double pso-based method in the suggested technique may also necessitate utilizing substantial computer resources. using the cnn technique, turaiki et al.



datasets, the model is evaluated. even though both datasets have accuracy levels above 96%, the error rate is higher and the true positive rate is lower. prasada et al. proposed a novel bayesian-rough set(brs) feature selection-based model for intrusion detection with the cicids2017 dataset and attain an accuracy of 97%. but in respect of this



datasets are essential for machine learning-based models because they provide the data that the model needs to learn and make accurate predictions or decisions. besides that, a high-quality dataset with accurate and relevant examples will lead to a more accurate and reliable model. the suggested model is trained and evaluated using a variety of publicly available datasets. the following is a short summary of these datasets:



in 2021, sarhan et al. analyzed information and created the nf-uq-nids dataset for network intrusion detection. the datset has 43 features. 11,994,893 entries comprise the nf-uq-nids dataset, of which 2,786,845(23.23%) are attacks and 9,208,048(76.77%) are benign flows. in addition to the benign, normal flow attacks are classified into the following categories: dos, ddos, injection, reconnaissance, brute force, infiltration, password, xss, ransomware, exploits, scanning, backdoor, fuzzers, bot, analysis, theft, mitm, shellcode, worms, and generic. in this research, the attacks category is regarded as an intrusion.



as a netflow-based internet of things dataset for iot intrusion detection, sarhan developed nf-ton-iot in 2021. there are 1,379,274 data flows in total, of which 1,108,995(80.4%) are attack samples and 270,279(7.9%) are benign data flows. in addition to the regular flow, intrusions include backdoor, injection dos, mitm, ddos, password, scanning, ransomware, and xss.



in 2021, al-daweri et al. presented a model dataset for an intrusion detection system called ukm-ids20. this dataset has 46 characteristics that cover four different forms of attacks: dos, scans, arp poisoning, and exploits. these four attacks are regarded as intrusions into our analysis.



collaboration between the communications security establishment and the canadian institute for cybersecurity. it uses the notion of profiles to methodically compile cybersecurity datasets. when coupled with abstract distribution models for apps, standards, or entry-level network components, it provides a thorough explanation of attacks. seven different attack scenarios are included in the dataset: botnet, brute force,



the wsn-ds dataset, a particular dataset for detecting intrusions in wireless networks of sensors, was developed in 2016 by almomani et al.. this dataset has 17 characteristics and 374661 records, covering dos attacks including flooding, blackhole, scheduling, and, grayhole. this dataset was used to test our model, which treats all dos attacks as intrusions while treating all other attacks as part of the regular flow.



the nsw-nb 15 dataset was produced in 2015 using the ixia perfectstorm tool at the cyber range lab at unsw canberra to develop a blend of actual modern day routine activities and fabricated modern day assault behaviors. reconnaissance, fuzzers, backdoors, analysis, dos, generic, shellcode, exploits, and worms are among the nine types of attacks in this dataset. in addition to the regular traffic flow, all attacks are considered as intrusions. this dataset is now widely used for testing intrusion detection models. in our experiment, 45 features from this dataset were employed.



we use the c08, c09, c10, and c13 datasets from the publicly available cyber clean center(ccc) dataset[34,43]. irc port 6667 and http port 80 traffic packets are included in this dataset. a c&c server connection is necessary for the bot. in this dataset, there are 56 features records are resolved. it has been widely used in the field of network detection for intrusions. the nsl-kdd data set categorizes each network connection as normal or abnormal. in this research, 43 characteristics were both available and utilized. we employed this dataset for multi-class classification in our research. where back, buffer overflow, imap, ftp write, guess passwd, ipsweep, land, loadmodule, multihop, nmap, perl, phf, pod, portsweep, rootkit, satan, warezclient, smurf, spy, teardrop, and warezmaster are classified into several intrusion classes in addition to the non-attack class.



suited to machine learning, data analysis, and instructional purposes. colab is a hosted jupyter notebook service, to be more specific. standardscaler, labelencoder, and other preprocessing modules from the scikit-learn package are implemented. selectkbest, mutual_info_classif, pca, and other methods are used to choose the features. baggingclassifier, adaboostclassifier, randomforestclassifier, gradientboostingclassifier, xgbclassifier, stackingclassifier, and more



in order for machine learning models to utilize the data effectively, it must first be cleaned up and transformed, which is why data preliminary processing is a crucial stage in the entire procedure. the accuracy and effectiveness of the final model depend greatly on the quality of the input data, and data preprocessing makes it possible to guarantee the consistency, accuracy, and usefulness of the input data. it helps to remove inconsistencies and errors in the data, it can help to normalize the data, which can make it easier to compare and analyze, and it can help to make the data more manageable and useable for machine learning models.



ensemble-based machine learning models are a promising approach for intrusion detection systems, offering improved detection rates and resilience to attacks. these models combine multiple individual models to improve the overall accuracy and robustness of the prediction, especially for the intrusion detection system(ids). the diversity of individual classifiers in the ensemble ensures that the ids can detect a wide range of attack types and patterns. various ensemble techniques are applied in the proposed model. a very short description of those is given below:



ensemble-based bagging is a machine-learning algorithm that combines multiple models to improve the overall performance and robustness of the classifier. the bagging algorithm involves training multiple models on different subsets of the training data and then aggregating their predictions to make a final classification decision. the training process for bagging can be summarized as follows in algorithm 2.



an ensemble-based machine learning approach called gradient boosting combines a number of weak learners to produce a strong learner. unlike adaboost, gradient boosting uses decision trees as weak learners and focuses on improving the performance of the model by minimizing the loss function at each iteration. the training process for gradient boosting can be summarized as follows in algorithm 4.



prevent overfitting. the algorithm computes the negative gradient of the regularized loss function, fits a weak learner to the negative gradient values, computes the weight for the new model, and updates the model by adding the new weak learner. the final prediction is computed by summing up the predictions of all weak learners.



a machine learning procedure called stacking, which uses an ensemble approach, integrates many base models by using their outputs to build a meta-model. the original dataset is used to train the base models, and the predictions from the base models are used to train the meta-model. the training process for stacking is summarized as follows in algorithm 5.



in this part, we evaluate the performance of our proposed intrusion detection model. at first, using a dataset named simargl21 and the model with random forest ensemble technique, we visualize the model. in the simargl21 dataset, there are 50 features available. the features description is given in the appendix section. moreover, in our experiment, we used 1330692 initial samples. it is a multi-classification dataset because the label column contains three types of values, normal flow, xmas scan, null scan. the xmas scan and the null scan entries are considered intrusions. the evaluation metrics are then presented along with the other datasets and ensemble methods, including simple stacking, adaboost, gradient boosting, gradient xgboost, and bagging. the same processes, which are described in detail



fpr(false positive rate). the model with random forest ensemble method has an accuracy of 1.00000, precision of 1.00000, recall of 1.00000, f1-score of 1.00000, and an fpr of 0.00000. according to these performance measures, the random forest ensemble methodbased model is doing incredibly well and is able to accurately identify all the positive and negative samples in the dataset without producing any false positive or false negative mistakes. this suggests that this model is a strong contender for the detection of intrusion.



kappa score, indicating perfect agreement between predicted and actual labels. additionally, it has a perfect observed accuracy of 1.00000 and expected accuracy of 0.99897, suggesting that it can classify the samples with a high degree of accuracy. finally, it has the lowest training and testing times, indicating that it is efficient and scalable.



so, considering all the evaluation metrics, the proposed approach with the random forest ensemble method can be used as a robust and accurate model for the detection of intrusion. the method works by combining multiple decision trees and aggregating their outputs to make the final prediction. this approach can lead to better generalization and improved performance compared to other models. additionally, the short training and testing times make this model an attractive option for large-scale classification tasks.



following the selection of the n_trees bigger than 10, the model looks to perform incredibly well, obtaining a training accuracy score of 1.0 and a test accuracy score of 1.0 for all values of n_trees tested. because the random forest ensemble classifier performs well on both the training and testing data for each example, it may generalize effectively to new, unexplored data without overfitting or underfitting.



overall, the proposed ensemble based machine-learning model achieved very high accuracy and auc scores for most of the datasets, indicating its effectiveness in detecting intrusions. however, the false positive rate is very low for most of the cases. the results of the evaluation metrics are better for most of the cases and most of the existing models. therefore, the model shows promising outcomes and has the potential as an intrusion detection tool.



in the subject of network security, intrusion detection systems are essential considering the increasing number of network threats and advancements in technology. idss have attracted a lot of interest because of their ability to increase network security. the random forest-based ensemble model outperformed other strategies and attained excellent accuracy and detection rates, according to the results of our proposed ids evaluation after that on various public datasets. the results we obtained show that the recommended approach is capable of identifying different attack types with accuracy and has the potential to be a helpful tool for enhancing the security of computer systems and networks against new cyber threats. overall, the proposed approach has shown promising outcomes and has the potential to aid in the creation of intrusion detection systems for network security that are more effective.



the authors declare that there are no conflicts of interest that could potentially influence the objectivity or integrity of the research findings. we have no financial, professional, or personal relationships with any individual, organization, or entity that could bias the interpretation or reporting of the research results. we affirm that the submitted manuscript is original, not previously published, and not under consideration elsewhere.



flow_active_timeout time interval after which the flow is considered active, important for network performance and security. flow_duration_microseconds duration of the flow in microseconds, useful for understanding the context of the flow data at a more granular level. l4_src_port source port number of the flow, which can help identify the type of traffic and potential attacks.



frame_length length of the frame in bytes, which can help identify network performance issues or potential attacks. flow_start_sec timestamp of when the flow started, useful for correlating events and identifying suspicious behavior. direction direction of the flow(inbound or outbound), important for network analysis and security.



