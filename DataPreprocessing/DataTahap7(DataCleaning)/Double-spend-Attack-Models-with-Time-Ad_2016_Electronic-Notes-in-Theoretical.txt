influenced by time and not only by the hashpower used to produce blocks of hashes, and(ii) algorithmic experimentation comparing these models against existing well-known hashrate-based attack models that do not consider time advantage. as a conclusion, this paper presents evidence on the fact that advantages are not negligible for cases in which an attacker has had enough time for secretly mining fraudulent blocks or significant control over the network. also, the models presented in this paper help in supporting previous claims in the literature about how to correctly model and detect double-spend attacks in the bitcoin network.



using hashes through a distributed time-stamping service. since electronic files can be duplicated and bitcoin does not have a trusted third-party that can verify whether a digital coin has been spent, fraudulent transactions with users spending the same money at least twice can happen. these fraudulent schemes are known as double-spend attacks and have taken place already in the bitcoin network.



some mathematical models have been proposed to analyze how feasible really are double-spend attacks in bitcoin. in particular, s. nakamoto and m. rosenfeld have proposed hashrate-based attack models in which, overall, an attack is successful whenever the number of confirmations of a honest transaction is surpassed by the number of confirmations of a fraudulent one. in this setting, hashrate means that the model considers how fast a block header can be hashed, while the number of confirmations refers to the number of blocks of transactions claiming a transaction to be valid. in particular, these two models are used to answer the following question:



one important aspect of the models of s. nakamoto and m. rosenfeld is the fact that blocks of transactions are considered either non-existent or complete, but never partially complete. that is, these models do not consider blocks to be partially built, neither by honest nor attacker nodes. more importantly, these models lack the expressiveness needed to analyze situations in which an attacker has probably already built fraudulent blocks because it had some time advantage. these features seem important in an attack model given the fact that, at some point, a honest block might just start being built from scratch while competing against an attacker that may have been already mining for a certain period of time. in this case, for instance, such a situation could result in an undetected attack in the attack models of s. nakamoto and m. rosenfeld.



for answering question(ii), this paper presents two double-spend attack models for bitcoin in which an attacker can be assigned some advantage in terms of time units. the first model presented in this paper results from generalizing the model of m. rosenfeld by adding an extra parameter denoting some time advantage assigned to the attacker, assumed to be used in producing and mining fraudulent blocks. the second model, following a completely different approach, is a purely time-based model that takes into account the times at which both honest and attacker nodes last mined a block, in addition to their relative progress in terms of the length of chains already mined. in this paper, the former model is called the generalized model and the latter is called the time-based model.



paper outline. the paper is organized as follows. section 2 presents a technical overview of the bitcoin digital currency network. section 3 briefly explains what a double-spend attack is. section 4 presents an overview of the double-spend attack models of s. nakamoto and m. rosenfeld. section 5 presents the main contribution of this paper, namely, the generalized and time-based attack models proposed by the authors. section 6 gathers some information obtained from experimentation on the double-spend attack models and establishes some properties about these models. finally, section 7 gathers some concluding remarks and future work.



anyone can create a bitcoin account, even offline or without the purpose of becoming a miner. because accounts can be created offline, it is not possible to know how many user accounts are there. btcs can be sent to any account, even to those created offline with the network confirming, in this case, that such a joe doe is entitled to spend that money. with an account, an user can create a transaction. a transaction can have more than one input account and more than one output account; it can also include a small tip for the miner that fully mines a block containing it.



the balance of btcs in a bitcoin account is not represented by a single number. instead, any balance is represented by pointing to the previous transactions in the blockchain that justify the ownership of the money. that is, a balance is a trace to the time in which each of its btcs was first created.



miners that include a transaction in a block of transactions to be mined. for example, transaction 987 tips 0.01 btc to those miners who successfully mine a block containing that transaction. however, as show by transaction 1005, fees are optional. in this latter case, the miner who first mines the block will receive exactly the standard 25 btc for mining a block but will not be tipped. the standard reward of 25 btc for mining a block is likely to change in the future, when bitcoins will not to be issued by the system for mining a block.



finally, note that the system somehow needs to identify if the output of a transaction has been already spent. otherwise, an user could create multiple transactions from the same source of income. in the bitcoin network, miners will check from the blockchain that there are enough funds for the transaction, before mining a block with such a transaction.



as mentioned earlier in this section, mined blocks contain a hash-pointer to their previous block. therefore, the blockchain can be seen as a collection of linked lists with hash-pointers acting as back-pointers. note that this helps in preventing any updates from easily happening to the internal tree structure of the blockchain.



additionally, functions exclusively used in the model of s. nakamoto will have n as subscript, while those exclusively used in the model by m. rosenfeld will have r as subscript. functions shared between these two models can be written without any subscripts.



this section presents the generalized model and the time-based model for doublespend attacks proposed by the authors. some of the notation, conventions, and functions used in this section are borrowed from section 4. in addition, functions defined exclusively for the time-model have t as a subscript.



this is the first double-spend attack model proposed by the authors. this model results from generalizing the model of m. rosenfeld by adding an extra parameter denoting some time advantage assigned to the attacker, i.e., time in which the attacker has been secretly trying to mine blocks. henceforth, this extension is called the generalized model.



this section presents the time-based model, the second double-spend attack model proposed by the authors. on the one hand, this model is as flexible as the generalized model in section 5.1, and thus more general than the models of s. nakamoto and m. rosenfeld in section 4. on the other hand, it uses a completely different approach to compute the probability of an attacker successfully performing a double-spend attack.



this section summarizes experimental results obtained on the two attack models proposed by the authors in section 5, namely on the generalized model and the time-based model for double-spend attacks in the bitcoin network. in particular, the experimental results presented in this section are compared against the models of s. nakamoto and m. rosenfeld in section 4. additionally, this section includes snippets with the code, in the python 3 programming language, used to run all the experiments.



the way in which the model of m. rosenfeld was generalized in section 5.1 allows for new properties to be studied. in fact, the generalized model as well as the time-based model are still consistent if n0< 0, which corresponds to the scenario in which the attacker nodes are not mining at the top of the blockchain, but in a branch|n0| blocks behind of the valid branch.



the first model, called the generalized model, extends an attack-model developed by m. rosenfeld by adding a time parameter, enabling the model to assign time advantage to an attacker trying to achieve a double-spend attack. the second model, called the time-based model, follows a completely different approach by taking into account the times at which the honest and attacker nodes last mined a block, in addition to their relative progress in terms of the length of chains already mined. the two models proposed by the authors are more general than existing doublespend attack models.



as usual, some work remains to be done. proving that the generalized model and the time-based model coincide is an important and challenging task. furthermore, it seems promising to specify the attack models in a language with a formal mathematical semantics and exercise them against temporal formulas, perhaps following some of the ideas in. more precisely, it will be interesting to formally specify the models proposed by the authors in the rewrite-based specification language pmaude and then use a statistical model checker such as multivesta to formally verify probabilistic temporal properties related to possible scenarios for double-spend attacks with time advantage in the bitcoin network. finally, the two models proposed by the authors in this paper can be used for comparing the effectiveness of double-spend attacks with time advantage against other types of attacks in the bitcoin network.



