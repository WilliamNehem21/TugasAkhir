in this paper, we discuss a method for decomposition, abstraction and reconstruction of the stochastic semantics of rule-based systems with conserved number of agents. abstraction is induced by counting fragments instead of the species, which are the standard entities of information in molecular signaling. the rule-set can be decomposed to smaller rule-sets, so that the fragment-based dynamics of the whole rule-set is exactly a composition of species-based dynamics of smaller rule-sets. the reconstruction of the transient species-based dynamics is possible for certain initial distributions. we show that, if all the rules in a rule set are reversible, the reconstruction of the species-based dynamics is always possible at the stationary distribution. we use a case study of colloidal aggregation to demonstrate that the method can reduce the state space exponentially with respect to the standard, species-based description.



internal dependencies of multi-site post-translational modifications and conformational changes[4,21] of signaling proteins reflect the rich internal logic of proteins. since chemical kinetics operates on states which are based on descriptions of full molecular complexes, often times a model becomes too complex to analyze. this calls for decomposition techniques, i.e. determining the effective dimension of the state-space. authors in[2,5,7,9] proposed approaches where they first constructed a large state-space and then reduced it. in, we however took a bottom-up approach and observed the effective degrees of freedom of each agent, denoted as agent



we start by encoding the rule-based models and assigning the stochastic semantics to it. in section 2, we detail how to encode the rule-based models. in section 3, we define the fragment-based abstraction, and how to decompose the rule set into smaller independent units. in theorem 3.6, we demonstrate how these two frameworks relate. in section 4, we use a model of colloidal aggregation, to demonstrate that the method can exponentially reduce the state space. finally, in section 5, we review the practical aspects of using the fragment-based abstraction. in particular, the probability distributions over the species-based system can be reconstructed from the fragment-based abstraction for certain initial distributions. we show in theorem 5.2 that the reconstruction is applicable on a set of reversible rules, regardless of the initial distribution, because the underlying process is a non-explosive, irreducible ctmc with a stationary distribution.



the condition imposed for an abstraction to be valid is known in the literature as a form of weak lumpability, or uniform backward bisimulation. in section 2.1, the ilts assigned to a rule-based model is such that each state is interpreted by exactly one valuation of variables from var. the lumped state[s] is interpreted by a union over interpretations of containing states.



the dynamics of a rule-based model is given by a set of rules. a classical chemical reaction consists of a left-hand-side(lhs), a right-hand-side(rhs), and a rate. the lhs is a set of reactants, which can transform to a set of products, and the transformation occurs at a velocity depending on the reaction rate. similarly, the lhs and rhs of a rule are sets of agents with different values of sites in their interfaces.



rules are defined over the set of variables var. on the other hand, a reaction mixture is defined over the set of variables var n. the application of a rule to a reaction mixture is formalized through a concept of agent identification.



the contact map is a site graph(v, e) with agent names a={a} and site names s={x, y}; set of nodes is given by v={(a,{x, y},{})}, and edges e={}. the set of variables associated to the rule set is var={xa, ya}. since no rule involves both variables xa and ya, the stochastic fragments are var s={{xa},{ya}}.



