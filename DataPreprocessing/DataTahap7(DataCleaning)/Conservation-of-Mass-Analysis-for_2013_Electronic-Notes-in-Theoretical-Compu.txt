many researchers working on static analysis of biological models have been generating invariants and inspecting these by eye. thus, although the computation of invariants is automatic the modeller has been until now left with the problem of deciding whether the invariants which have been computed are the expected set of invariants for this model. if these match then the modeller is reassured that the model has been constructed as intended. if these do not match then this suggests that an error has been made in constructing the model.



in a bio-pepa model of a biochemical system, each molecular species(i.e. proteins, genes, mrnas) is represented by a process. the state of the system at a given time is given by the current amount of the molecular species, and the result of the occurrence of a biochemical reaction is a change in the available amount of the involved species.



processes interact by means of shared action names representing reactions and specifying their role in the reaction(reactant, product, catalyser, inhibitor, etc.) and their stoichiometric coefficient for that reaction. the effect of a reaction occurrence is to decrease the amount of reactants and increase the amount of products according to the stoichiometry 6.



invariants and reaction invariants. a state invariant involves a set of components or species in the model. at any time during a simulation one may sum together the populations of the components of a state invariant and the result will always be the same. consider the following simple model presented in reaction syntax on the left and bio-pepa syntax on the right:



reaction taps are defined analogously. that is, a reaction source is a reaction which has no reactants but at least one product and a reaction sink is a reaction which has no products and at least one reactant. simply put, a reaction source produces something but does not consume anything whereas a reaction sink consumes something but does not produce anything. in the bio-pepa syntax, while it is trivial to observe component source and sinks, reaction source and sinks can only be identified by viewing the entire model. the bio-pepa software however provides an outline view of your model showing reactions and in this view reactions which are source or sink reactions are trivial to identify. in any case the outline view lists all component and reaction sources and sinks. the following snippet shows two reactions one of which is a source and the other of which is a sink.



when constructing a model the modeller must choose which features of a physical system to include. components of the real system which are included are called model components. those which are excluded are called external components or collectively referred to as the external environment. by their nature, models are finite in extent and scope. the external components are essentially everything not mentioned in the model.



for a model to be useful we hope that either in the physical system the influence of the external components on the model components is negligible or that this influence can be ignored for the purposes of the current analysis. this leads to boundaries between the model components and the external components and here we wish to argue that taps in the model represent such boundaries.(note that we are not claiming that such boundaries are only represented by taps in the model.) a reaction sink forms a natural boundary between the model components and the external environment. this is because from the point of view of the model a reaction sink is removing mass from the system. in reality, mass does not reduce to nothing, but the species that it does reduce to is an external component and hence not mentioned in the model. the same is of course true for a reaction source. mass is not produced from nothing, but instead from an external component not mentioned in the model.



none of the reactions which modify a component tap can be involved in any reaction invariant. the reason for this is straightforward: if a component p is a source then any reaction r which modifies p must decrease the population of p, since there are no reactions which increase the population of a component source. the original population of component p before a firing of reaction r can never be restored by any combination of other reactions in the model. thus, reaction r cannot be involved in any reaction invariant. the same reasoning applies to component sinks. a component tap may however be involved in a component invariant.



when modelling it is sometimes desirable to remove a component or a reaction from the description of the model. this may be done to see the effect it has on the evaluation of the model. removal may be done by hand, or can be automated in modelling software. in this section we briefly describe the removal of components and reactions from a bio-pepa model and then how this affects invariants.



the removal of a reaction is straightforward: simply delete the kinetic law and update any component description by removing the corresponding reaction behaviour from the component definition. the following shows the removal of a reaction named am. the model before removal is on the left; the model after removal is on the right.



what happens to the computed set of invariants when a component is removed from the model? if the removed component is part of a component invariant then naturally that invariant may be invalidated. however the removal of a component will not disrupt any component invariants in which it is not involved nor will it disrupt any reaction invariants. it may however cause the invariant analysis to report what was previously a single(reaction or component) invariant as two or more invariants. this is because the analysis procedure reports the set of minimal invariants and although an invariant will not be invalidated by the removal of a component it may cease to be a minimal invariant.



having performed invariant analysis over the model we can check if mass is conserved because every component in the model should be covered by at least one invariant. we can then obtain a single invariant which covers the entire model by summing together all of the component invariants in the model. this provides us with a convenient static analysis consistency check on all kinds of biological models. this check is always applicable: invariants can always be summed because the sum of two constants is a constant.



however, due to their finite extent, it is often the case in a biological model that mass is not conserved. this occurs because mass is lost to or gained from the external components which are not within the scope of the model. a simple way in which this occurs is to have a production or degradation reaction which produces or removes the mass of one or more model components. these reactions show up as source and sink reactions and are the reason that mass appears not to be conserved within the model.



as we have observed before, removing reactions from the model does not invalidate any component invariants. we utilise this by removing from the model all tap reactions, that is all source and sink reactions. once we have done this we have removed from the model any obvious means by which mass may be produced or consumed. performing invariant analysis on the model with tap reactions removed should give us total invariant cover. that is, all components in the resulting model should be covered by at least one invariant. if that is not the case then it means that mass is produced or consumed internally within the model.



run the invariant check. the software automatically ignores all tap reactions and calculates the set of invariants. a warning is issued if not all components in the model are covered by some invariant indicating that mass is not conserved by the model. additionally the modeller is shown the set of model components which are not covered by any invariant.



participants and in the set of uncovered components produced by ignoring either of the two reactions. the invariant check can be performed while ignoring all the tap reactions plus both of the reactions in such a pair. closely examine any reaction(or reaction pair) whose removal causes the analysis to determine that mass is conserved.



if a reaction is found to have been defined in error then update the model description to amend the reaction and re-run the conservation of mass analysis. in biopepa amending the reaction(s) consists of modifying the component definitions to either add or remove components as reaction reactants or products. if the model is advanced enough such that rate laws have been written for reactions, it is a good time now to update the rate law(s) associated with the modified reactions. the bio-pepa software can again help with this, as there are warnings produced when a rate law expression does not contain a reference to a reactant, or does contain a reference to a non-reactant. this is more fully discussed in.



in this section we provide a case study to illustrate our techniques. the example model has already been analysed using our previous invariant analysis techniques[9,10]. we update the case study here to include our methods of finding the particular flaws in the model revealed by conservation of mass analysis and in particular how this analysis guides us to the erroneous parts of our model.



in this section we discuss the limitations of our approach. no static analysis can detect all flaws in models, and we are not hoping to do this here. additionally, any static analysis which warns about possible errors in a model becomes almost useless if the analysis produces too many false positives. when this occurs the modeller is likely to begin to ignore the analysis results. in this section we discuss some reasons for which there may be false positives and we argue that these do not detract from the general usefulness of our approach.



our analysis depends on the process of partitioning the set of all reactions into two sets; of tap and non-tap reactions. this allows us to ignore reactions which introduce mass into the model components from outside of the scope of the model, or discard mass from the model out to the external environment. in turn this allows us to focus on the reactions entirely within the scope of the model to determine whether mass is conserved there.



if reactions are written down correctly with respect to the model components, then our partitioning is conservative in the sense that a non-tap reaction is not erroneously ascribed as a tap reaction(although a tap reaction may be identified as a non-tap reaction). this is the correct relationship since the tap reactions are ignored for the analysis so we are better to be conservative in ignoring too few rather than too many reactions. additionally a reaction may be explicitly ignored as is done in the compositional reduction analysis step, see section 7.2.



in this paper we have discussed a methodology for the static analysis of biological models with particular respect to determining whether the model in question conforms to the law of conservation of mass. we are careful to define the boundaries between the portions of the real system which lie within the scope of the model and those which do not. we expect that mass may be lost from the model components to the external environment or gained by the model components from the external environment. we ignore reactions which cause such losses or gains in order to determine whether reactions which describe behaviour entirely captured within the model conserve mass. if we determine that the model fails to conserve mass then we search for the reactions which are the cause. this involves compositional application of the conservation of mass analysis, for each reaction within the model scope. for each reaction we compare the results of conservation of mass analysis, with and without that reaction. this can dramatically narrow the search for erroneous reactions within the model.



combining these two final points we have begun work on the automatic classification of a large database of sbml models. we can mechanically categorise all such models into those which conserve mass and those which appear not to. the latter set can be later analysed more closely by a human who will be presented with a good idea of the reactions which may be erroneous.



an inexpensive, qualitative and useful analysis together with a methodology which greatly reduces the time spent tracking down the source of an error once one has been detected to exist. we are confident that our approach is scalable as we have tested it against the models in the biomodels database. models which ranged in size from 4 reactions to 4139 reactions could all be analysed in under 15 seconds.



