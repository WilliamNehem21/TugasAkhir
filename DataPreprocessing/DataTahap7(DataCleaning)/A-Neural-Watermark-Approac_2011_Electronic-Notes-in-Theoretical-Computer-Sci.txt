in this paper we propose the coupling of a watermarking technique for images, called least significant bit, in the multiple classes random neural network. for that, we design a training process of the watermark pattern, an embedding process of the learned pattern in the original image, and a detecting process of this pattern in the carrier image. the removal of the watermark is not considered in this work, since the aim is to study the capability of detection of our neural approach of any manipulation over the carrier image. we define several attacks to compare the robustness of our approach with previous works(rotation, jpeg and detect digital watermark in images, in order to exploit the highly efficient learning and pattern recognition mechanisms of this model. particularly, we propose the mixing of a watermarking technique in images called least significant bit, or lsb with the multiple classes random neural network model(mcrnn). the lsb technique exploits the weakness that the human visual system hvs has to detect brightness variations in the colors of the visual spectrum. the technique is based on replacing the least significant bit of the carrier signal with the bit pattern of the digital watermark. the detection process can recover the watermark if it has known the values used to embed the digital watermark. the watermark embedding process



we attack this problem encrypting the watermark in the synapses weights of the mcnn(it learns the watermark) and proposing a neural-lsb embedded and detection approach. the watermark is embedded and detected through a mcrnn, which is learned by the mcrnn in the training process. in our approach based on the mcrnn and on the lsb technique, the mcrnn learns a version of the watermark built using the lsb principle(the synapses weights will contain the encrypted watermark), and uses the synapses weights of the mcrnn in the neurallsb embedded and detection phases. particularly, the detection of a violation in the original image is like a classical recognition problem on the domain of artificial neural network(in our case, of the encrypted watermark embedded in the original image).



our proposed method is highly robust; the watermarked image can survive to different image attacks like rotation, jpeg compression, scaling, noise, cropping, horizontal flip, brightness and contrast correction; contrary to the classical lsb technique, due to that we encrypt the watermark(in the synapses weights of the mcnn) and we use it in the watermarking process(embed and detection process). the watermark is difficult to violate and the watermarking process is very sensitive to a modification of the original image(it does not recognize the watermark if this one is modified). additionally, our approach is very good in terms of peak signal to noise ratio(psnr) and noise generated(ng) criteria, which makes invisible our approach(it is not perceived in the image).



the mrnn is based on the random neural network model. the rnn was introduced by erol gelenbe[9. 10], it consists of a network of n neurons in which positive and negative signals circulate. each neuron accumulates signals as soon as they arrive, and can fire if the count of signals in a given moment is positive. the firing occurs randomly according to an exponential distribution of constant rate, and the signals are sent to other neurons or from outside the network. each neuron i of the network is represented at any time t by the potential of its input signal ki(t). the positive and negative signals have different roles in the network. a negative signal reduces by 1 the potential of the neuron to which it arrives(inhibition) or no effect on the potential if it is zero, while a positive signal increases by 1 the potential of the neuron. the signals can arrive at a neuron from outside the network or from other neurons. each time a neuron fires is deleted the potential contained in it. a signal leaves the neuron i due to the neuron j with probability p+(i, j) as a posi-



our training stage can be regarded as a process to encrypt the watermark for the embedding and detection processes. in this section we explain the main aspect of this phase(meaning of the weights, initialization of certain parameters of the mcrnn, learning procedure, etc.).



in our approach, yk(i, c) indicate lsbs intensities of each neuron, for example, y(3)=(0.2, 0.8, 0.2) refers to the desired intensities output of the neuron 3 in the first, second and third class(0.2, 0.8 and 0.2, respectively). this lsb intensity is an approximation of the lsb value of each pixel in the watermark to be used by the mcrnn(see section 3.1.3). the initialization of this set of input and output pairs in the network is:



where p(p, c) represents the pixel p of the original image in the channel c. like there are three channels per pixel(rgb) and each channel is associated with a class c, the channel c of the pixel p(p, c) will be read completely(this is, the full 8 bits), so that, depending on the value threshold function fv(q(i, c)) and the lsb on the original image, we embed the pattern of the watermark by adding or subtracting 1 to p(p, c). in this way we embed the watermark pattern in it.



in our approach, the fundamental goal of the detecting process is to determine if all the watermark patterns previously embedded in the original image have not been changed. for that, we need to compare all embedded patterns with the pattern of the original watermark by using the mcrnn. we start with the computation of the probabilities of excitation of each neuron q(i,c) using the weights trained(key), to obtain the pattern of the original watermark. after calculated the probability of excitation q(i,c), we use the threshold function fv(q(i, c)). these steps at this point are the same as in the embedding process. the next step is to compare the patterns embedded with the trained pattern. this comparison is performed by taking the lsb for each channel of each pixel of the carrier image and the value of the threshold function fv(q(i, c)) related. this process is defined by a detection function fd(fv(q(i, c)), lsb) as follows:



in general, the experiments will be performed by setting a threshold t with a value of 0.5, assuming an intensity of 0.2 and 0.8 for lsbs values of 0 and 1 of the watermark pattern, respectively. in our system the reading of the channels starting with the blue, then green and finally the red, and pixels are counted from left to right, starting from the bottom of the image.



22. if we calculate the psnr with maximum possible noise, the maximum possible psnr is 48.13 db, for this reason is not expected a lower than 48.13 db over any image using our approach. we can conclude that using our technique, it does not influence significantly in the distortion of the images embedded.



all the attacks over the carrier image were detected by our approach. for the rest of works, only some of them are detected(in some case, they do not detect some attacks). in the case of the svd approach, it has difficult to detect a violation when the image is moved or if we introduce some noise because this matrix approach cannot detect some of the modification. the behavior of dct and dwt approaches



the times of the processes involved(training, embedding and detection), were not analyzed in this work, since their values in milliseconds were too small. for example, in several of the experiments the longest training execution time was 1235 milliseconds to 5 iterations, for a watermark of 16x16 pixels. the embedding and detection processes had the same behavior.



as future work we propose the development of new prototypes that can connect the model presented in this work with other digital objects such as text, audio and video. this increases the possibilities of using this model in the area of computer security. we have tests our system for bmp images, we need extend it to images in other formats(such as jpg, gif and png).



