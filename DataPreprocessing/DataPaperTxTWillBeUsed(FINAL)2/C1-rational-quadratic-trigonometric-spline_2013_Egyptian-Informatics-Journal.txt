

C1 rational quadratic trigonometric spline
Maria Hussain *, Sidra Saleem

Department of Mathematics, Lahore College for Women University, Lahore, Pakistan

Received 9 February 2013; revised 28 August 2013; accepted 22 September 2013
Available online 17 October 2013

Abstract A Be´zier like C1 rational quadratic trigonometric polynomial spline is developed. It defines two shape parameters in each subinterval. The approximation and geometric properties are investigated. The curvature continuity is established. The developed rational quadratic trigono- metric polynomial spline is extended to C1 piecewise rational bi-quadratic function with four shape parameters in each rectangular patch. Data dependent constraints are developed on the shape parameters in the description of piecewise rational quadratic and bi-quadratic trigonometric poly- nomial spline for shape preservation of curve and regular surface data. The developed shape pre- serving schemes provide tangent continuity in quadratic form and does not restrict interval length, derivatives or data.
© 2013 Production and hosting by Elsevier B.V. on behalf of Faculty of Computers and Information,
Cairo University.



1. Introduction

Rational trigonometric interpolating splines with ten- sion(shape parameters) are preferred because these can inter- polate the same data in the form of straight line and curve. These tension parameters do not affect the order of continuity of spline. Moreover, the rational structure of these splines al- lows coping with singularities. Data gathered, whether, physi- cally or experimentally has at least one of the shape properties, positivity, monotonicity and convexity. The amount of rain- fall, gas discharge and exponential functions are a few positive data producing sources. The path inscribed by reboots arm

* Corresponding author. Tel.: +92 0331 4930071.
E-mail address: mariahussain_1@yahoo.com (M. Hussain).
Peer review under responsibility of Faculty of Computers and Information, Cairo University.
movement and designing of its circuits are few examples of monotone and convex data.
Bao et al. [2] presented a rational blended interpolant with free parameters. The developed interpolant was used for value control and shape control, and the range of parameters was determined by minimizing the bending energy. Brodlie et al.
[3] extended the cubic Hermite to bi-cubic Hermite for positive and constrained data interpolation. The developed scheme was C1. Delgado and Pen˜a in [6] investigated the rational Be´zier surfaces for shape preservation of data and established that ra- tional Be´zier surfaces are not monotonicity preserving. Duan et al. [7] revisited the rational spline [8] which was C1 only if slope of secant line coincided with slope of tangent line. The boundedness, value control, inflection point control and con- vexity at a point of the interpolant were studied for uniform data. Duan et al. [9] developed a bivariate rational interpolant with four shape parameters in each rectangular patch. The developed interpolant was C1 for equally spaced data with a suitable choice of shape parameters. The sufficient restrictions were  developed  on  shape  parameters  for constrained



1110-8665 © 2013 Production and hosting by Elsevier B.V. on behalf of Faculty of Computers and Information, Cairo University. http://dx.doi.org/10.1016/j.eij.2013.09.002




interpolation of data. Duan et al. [10] discussed the rate of con- vergence of a rational spline with two shape parameters.
Han [14] presented the cubic trigonometric polynomial curves with shape parameters. The partition of knot vector and value of free parameter affected the order of continuity. Han et al. [16] presented a cubic trigonometric Be´zier curve with two shape parameters and compared it to the cubic Be´zier
B0(x)= (1 — sin(di))2,	B1(x)= (1 — sin(di)) sin(di),
B2(x)= (1 — cos(di)) cos(di),

B3(x)= (1 — cos(di))2,
R(x)= B0(x)+ li B1(x)+ gi B2(x)+ B3(x),

curve. The effect of shape parameters on the shape of the curve
d = p(x — xi) ,	h = x
— x ,	i = 0, 1, 2, ... , n — 1.

i
was analyzed found that it was closer to control polygon than
2hi
i	i+1	i

the cubic Be´zier curves. Hussain et al. [17] used rational qua- dratic function with a shape parameter to preserve the shape of curve data. The developed scheme of this paper only assured position continuity. Lamberti and Manni [18] utilized the cubic Hermite in its parametric form to preserve the shape of data. The authors constrained the knot vector to introduce the ten- sion effect and shape preservation. C2-continuity was estab- lished by a set of restrictions on first order derivatives at the knots. Manni and Sablonnie` re [19] developed a C1 parametric Hermite interpolation technique for comonotone (monotone w.r.t. x and/or y) regular data using piecewise quadratic and bi-quadratic components. The shape preserving scheme im- posed a restriction on knot vector and derivatives. Zhang et al. [21] constructed a bivariate rational function with shape parameters. The developed bivariate rational interpolant was C1 if the derivative was equal to slope of tangent line. A posi- tive convex discriminant function was constructed for the suit- able choice of shape parameters to assure convex surface through convex data.
The study in this research paper is motivated by Bao et al. [2], Delgado and Pen˜a [6] and Hussain et al. [17]. The aim is to develop a rational interpolating spline to ensure local control on a single interval and C1 continuity in quadratic structure.
Pk, k = 0, 1, 2, 3 are the control points so the Be´zier like ra- tional quadratic trigonometric function (1) is termed as control point form. The parameters li and gi are the shape design parameters or tension parameters in each subinterval Ii = [xi, xi+1], i = 0, 1, 2,.. . , n — 1.

Theorem 1. The rational quadratic trigonometric function (1)
satisfies the following properties:

Endpoint interpolation property: S(di = 0) = P0 and
p

2
Convex Hull property: The curve always lies in the con-
vex hull of control points Pk, k = 0, 1, 2, 3.
The rational quadratic trigonometric function is invariant under the affine transformations.
The rational quadratic trigonometric function represents conic section under certain restrictions on shape design parameters.


Proof.

It can be easily established by substituting d = 0 and d = p

The remainder of the paper is organized as follows. Sec-
in Eq. (1).
i	i	2

tion 2 presents a new rational quadratic trigonometric function



Since Bk(x) P 0, k = 0, 1, 2, 3 for di ∈ 0, p  and shape

transforms this rational quadratic trigonometric function to
trigonometric spline and discusses its approximation proper- ties and shape properties. Section 4 extends trigonometric spline to C1 bivariate rational quadratic trigonometric func- tion. Section 5 is of numerical examples and Section 6 con- cludes the paper.

Be´zier like rational quadratic trigonometric function
bers, so Rk (x), k = 0, 1, 2, 3 are non-negative. The simple summation establishes that  3 Rk x  1. It asserts con- vex hull property, i.e. the curve will always lie in the convex hull of control points.
Let T be an affine transformation defined as T(X) = AX + T1, X is the vector to be transformed, A is transformation matrix and T1 is the translation vector. Applying the affine transformation T to the rational qua- dratic trigonometric function (1) we have

Let the data under consideration be {(xi, fi), i = 0, 1, 2,.. . , n}. The usual increasing partition of domain is adopted. The Be´- zier like rational quadratic trigonometric function S(x) is de-

T(S(x)) = T
3


k=0
Rk(x)Pk!
3
= A
k=0

Rk(x)Pk + T1.	(2)

fined over the interval Ii = [xi, xi+1], i = 0, 1, 2,.. . , n — 1 as:
Since	3
k=0
Rk(x)= 1, so the expression (2) takes the form:

S(x)= 
3


k=0
Rk(x)Pk,	(1)

T(S(x)) = A
3


k=0

Rk(x)Pk +
3


k=0

Rk(x)T1 =
3


k=0

Rk(x)(APk

+ T1)

Rk(x), k = 0, 1, 2, 3 are the rational quadratic trigonometric basis functions defined as
3
=	Rk(x)T(Pk).

B (x)
l B (x)
k=0

i
R (x)=	,	R (x)=	,

R(x)
g B x
R (x)=	,	R (x
R(x)
B3(x) ,
Ellipse is finite over whole domain, parabola tends to infinity at most at a single point of domain and hyperbola tends to

R(x)
3  )= R(x)
infinity at most two points of the domain. While interpolating a conic segment (hyperbola, parabola and ellipse) by the

rational quadratic trigonometric function S(x) defined in (1) it is necessary to choose those values of shape design parameters (li gi) which fulfill the aforesaid restrictions. The values of

-1 =

3	2	2
i		i	

R(x)	p
4B (1 — h)h — p(g B + B )(1 — h) h



(B + l B )h

shape design parameters (l g ) are computed as follows:	+	+

i  i

(1 — h) (6B
p
— p(g B

+ B )(1 — h)))





form

S(x)= 




i  1	i  2


.	(3)

h3	2(B + l B ) E — D 3

	 
R(x)	3	C

R(x)
		 2


i	i	2!	 

values  of  Bk(x),  k = 0,  1,  2,  3;  li = giin  R(x)= B0
(x) + liB1(x)+ giB2(x)+ B3(x) = 0 and after some simplifi- cation it reduces to
8B2(1 — h)— 2p(giB2 + B3)(1 — h)
p
E — D
C

(B0 + li B1)h	 2B2 — (1 — h)(gi B2 + B3)  2

R(x)= 2(g — 2)2 sin2(di)+ 2(g — 2)(3 — g ) sin(di)
—	3	—	p	h

+ (5 — 2gi )= 0.	(4)
 4B (1 — h)— (g B + B )(1 — h)2 !

Eq. (4) is quadratic in sin(di). The discriminant of R(x) = 0
w.r.t sin(di) is D = 4(gi — 2)2 {(3 — gi)2 — 2(5 — 2gi)}. It can
—

 2B
i 2
p
— (1 — h)(g B
3


+ B ) 
h

64B3

be easily computed from D that roots of R(x) = 0 will be
(a) real and distinct if g ∈ ÿ—∞, 1 — ,ﬃ2ﬃ ∪ ÿ1 + ,ﬃ2ﬃ, ∞ ;
—	p	h + 3p3(g B + B )
2B (1 — h)	(1 — h) (g B + B )

i	,ﬃﬃﬃ	,ﬃﬃﬃ}
	i  2	3   ,


(c) no
ÿ rea,l ﬃﬃﬃ
ro,otﬃﬃ(ﬃ roots	are	imaginary)	if	(

gi ∈ 1 —
2, 1 +  2 .
h3	2(B + l B )  E — D 3

ÿ	,ﬃﬃﬃ 
-3 =
i

R(x)
0	i  1

3	C

ÿ  S(,x)ﬃﬃﬃ
represents	hyperbola
,ifﬃﬃﬃ
gi ,∈ ﬃﬃﬃ}—∞, 1 — 2 ∪

gi ∈ 1 —
2, 1 +  2 .  h
—	p
 8B (1 — h)— 2p(g B


C
+ B )(1 — h)2! E — D 




2(B + g B )  E + D 3
	

C1-continuity conditions at the end points of the interval
 4B — 2p(1 — h)(g B + B )  E + D 2

	



x )= f ,	S(x  )= f  ,	S'(x )= d ,	S'(x  )= d  .
 8B (1 — h)— 2p(g B + B )(1 — h)2! E + D 




The rational quadratic trigonometric spline over the subin- terval Ii = [xi, xi+1] is defined as
(B0 + li B1)h	 4B2(1 — h)— p(g B2 + B3)(1 — h) !
2


S(x

B0(x)A0 + B1(x)A1 + B2(x)A2 + B3(x)A3 ,	(5)
+	3	+
— p(1 — h)(g B
p	h
+ B ) 


A = f ,	A

2hidi
= l f +	,	A


= g f

— 2hidi+1 , A = f  .

+ 2B2 — p(1 — h)(gi B2 + B3) h2 ,



Theorem 2. For g(x) ∈ C3[x , x ], let S(x) be a rational
C = 2(B0 + li B1),

quadratic trigonometric spline (5) interpolating g(x) in [xi,

   
s ﬃﬃﬃﬃ4ﬃﬃBﬃﬃﬃﬃﬃﬃ—ﬃﬃﬃﬃﬃ2ﬃﬃ(ﬃﬃgﬃﬃﬃBﬃﬃﬃﬃﬃﬃ+ﬃﬃﬃﬃBﬃﬃﬃﬃﬃﬃ)ﬃ(ﬃﬃ1ﬃﬃﬃ—ﬃﬃﬃﬃﬃhﬃﬃ)ﬃﬃ      ﬃﬃﬃ2ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
				

interpolating function satisfies |g(x)— S(x)| 6 g(3)(k)hi c i, with c i = max06h61 -(li, gi, h), where

4B — 2(g B + B )(1 — h)



-(li , gi , h)= 
max -1(li , gi , h), 0 6 gi 6 1, 0 6 h 6 1,
max -2(li , gi , h), gi > 1 + 2 , 0 6 h 6 h*,
E =	2

x — xi
i  2	3	,
p
*	2

>: max -3(l , g , h), g > 1 + 2 ,  h* 6 h 6 1.
h =	h
,	h = 1 — p(g — 1) .

Proof. Let {(x , f ), i = 0,1, 2,.. . , n} be the plane data defined	Z x
Z xi+1	Z x

over the interval [a, b]. If we interpolate this data by rational quadratic trigonometric spline (5) then S(xi)= fi, S' (xi) = di,

xi
Z xi+1
x	xi
3	2	2
i	  2	i	

i = 0,1, 2,.. . , n but S(x) approximates the data in between the
knots. To measure the accuracy of this approximation suppose
+	f2(x, k)dk = R(x)	p

that the data are generated from a function g(x) ∈ C3[x0, xn].
4B2(1 — h)h — p(g B2 + B3)(1 — h)2h
p
(B0 + li B1)h
3

The error of approximation over an arbitrary subinterval
Ii = [xi, xi+1] is defined by Peano Kernel Theorem [20] as:
Z xi+1
2
2 	i 2 	3	.
3p

xi

6 1  g(3)
2


i	p
(k)¨h3-2(li , gi , h),

where Fx is known as Peano Kernel and w	x	k + is the
truncated power function. The absolute error of approxima-
tion over the subinterval Ii = [xi, xi+1] is defined as:

-2 =
x
|f1(x, k)|dk +

xi+1


x
k*1
|f2(x, k)|dk =— 

f1(x, k)dk


1	 Z xi+1
x
+	f1(x, k)dk —
Z k*
f2(x, k)dk +
Z xi+1
f2(x, k)dk

|g(x)— S(x)| 6 g(3)(k)	|Fx(w)|dk.	(6)
k*1
h3
x	k*
2(B + l B )  E — D 3

Due to truncated power function, Fx(w) is partitioned into two subintervals as follows:
= R(x)  —
	0	i  1 

C

(4B — 2p(1 — h)(g B
+ B ))  E — D 2




k ∈ (x, xi+1), where
 8B (1 — h)— 2p(g B
+ B )(1 — h)2! E — D 


2	(gi B2 + B3)(xi+1 — k)
— 4hi B2(xi+1 — k)	—
i  2	3
p	C

f1(x, k)= (x — k) —
p	,
(B + l B )h
 2B — (1 — h)(g B + B ) 

R(x)
(g B2 + B3)(xi+1 — k) —	B2(xi+1 — k)



—	3	—
 
i  2	3	h2
p
!


Bk are the Bk(x), k = 0, 1, 2, 3 are already defined in Section 2.
—

2B (1 — h)2
p
(1 — h) (g B

+ B ))
h + 3p3 (g B

+ B3)

The	integral
xi+1 |Fx(x)|dk =
involved	in
x |f1(x, k)|dk +
Eq.	(6)	is	expressed
xi+1 |f2(x, k)|dk.
—	p	+
i  2	3	.
3

It	is	observed	by	simple	computation	that	if
For	h P h*,	h* ∈ [0, 1]	and	gi > 1 + 2	,

g < min ÿ1, 1 + 2 = 1, then the roots of f (x, x)and f (x, x)
3
|g(x)— S(x)| 6  g(3)(k)h -3(li , gi , h),

in [0, 1] are h = 0, h = 1. If gi > max ÿ1, 1 + 2 = 1 + 2, then	Z x
Z xi+1
Z k*1

1	2
*	*	 2 
= 0,
= 1 and	3	1	2	1
xi	x	xi

h = h , where h
= 1 — p(gi —1).
k*2
—
x
f2(x, k)dk +
f1(x, k)dk +
Z xi+1
f2(x, k)dk

To locate the roots of f1(x, k), it is rearranged as:
k*1
h3
(2(B
k*2	x
+ l B )  E — D 3

f (x, k)=  1  n(x — k)2(B
+ l B )
= R(x)
	0	i  1 
3	C

+(x — k)hi
 4 B — 2(g B + B )(1 — h)
4B2 — 2p(1 — h)(gi B2 + B3)
p
E — D C

 4	  8B2(1 — h)— 2p(g B2 + B3)(1 — h)2! E — D 

i  p  2
i  2	3
*
ÿE D	*



ÿE D 



p
2(B + g B )  E + D 3



C
 4B — 2p(1 — h)(g B

+ B ) 

 E + D 2
 8B (1 — h)— 2p(g B
+ B )(1 — h)2!


		

p
E = (4B2 — 2p(gi B2 + B3)(1 — h)).
0	i 1	2
i 2	3
×	C	+
0	i  1
3

p	 4B (1 — h)— p(g B + B )(1 — h)2 !

The roots of f2(x, k) are k* = x
i+1
and k* = xi+1
  4hi B2 
)
  2	i  2	3	 h
p

1. For h ∈ [0, 1] , h*
R [0, 1] and gi < 1, |g(x)— S(x)| 6
g(3)
+ 6B2 — p(1 — h)(gi B2 + B3) (1 — h)2

(k)h -1(li , gi , h),




Remark 1. It is of great interest that for suitably selected



data will be positive if S(x) > 0, for all x ∈ [x0 , xn] . Since each
 


point  if  S(2)  (x —)= S(2)(x +)  or  S(2) (x —) 
= S(2)
Now the problem of positivity of S(x) has been reduced to



i 2


The above condition gives the following system of
0	i	1
i i	p
i i+1	p

equations:
2hidi—1 + {(4gi—1 — 4)hi + (4li — 4)hi—1}di + 2hi—1di+1
+ B3(x)fi+1,
B (x)f + B (x) l f + 2hidi  + B (x) g f
— 2hidi+1 

= p{li—1hiDi—1 + gihi—1Di},	i = 1, 2, 3, ... , n — 1.	(7)
Eq. (7) represents system of (n — 1) equations. If the derivative
0	i
+ B3(x)f
1
i+1
i i	p
2	i i+1	p

parameters d , i = 0,1, 2,..., n are unknowns and shape design
> 0 only if  l > — 2hidi
and  g > 2hidi+1 .

i
parameters (li, gi, i = 0,1, 2,.. . , n) are known then it repre-
i	pfi
i	pf
i+1

sents system of (n — 1) equations in (n + 1) unknowns di,
Combining li > 0, gi > 0, l > — 2hidi and g > 2hidi+1 , we have

i = 0,1, 2,..., n. If the shape design parameters are also un- knowns, then there are (3n + 1) unknowns. The unique solu- tion can be determined by applying the end conditions.
the required result.
i	pfi
i	pfi+1

Theorem 3. For a positive data, the rational quadratic trigono- metric spline defined in Eq. (5) preserves positivity if the shape parameters li and gi in each subinterval [xi, xi+1] satisfy the fol- lowing conditions:
l > max  0, — 2hidi   and  g > max  0, 2hidi+1 .
Bivariate rational quadratic trigonometric function

Let {(xi, yj, Fi, j), i = 0,1, 2,..., n1; j = 0, 1, 2, .. . , n2} be the given set of regular data arranged over the rectangular grid [xi, xi+1] × [yj, yj+1], i = 0, 1, 2, .. . , n1  1; j = 0, 1, 2, ..., n2  1.
We wish to interpolate these data by using rational quadratic trigonometric spline (5). Since each rectangle is bounded by four

i	pfi	i

pfi+1
boundary curves. The final surface patch is obtained by blending
these boundary curves. Interpolation and blending of boundary

Proof. Assume that the given set of positive data be {(x0, f0), (x1, f1), ..., (xn, fn)}, xi < xi+1, i = 0, 1, 2,.. . , n  1 and fi > 0, 6i. The curve produced by the interpolation of positive
curves by rational quadratic trigonometric spline defined in Eq.
(5) give birth to the following bivariate rational quadratic trigonometric function over each rectangular patch.








2	2
U x, y	(1 — sin(uj)) D0 + (1 — sin(uj )) sin(uj)D1 + (1 — cos(uj )) cos(uj )D2 + (1 — cos(uj)) D3 ,	8
Qi,j(uj )
D0 = U(x, yj),	D1 = l^i,jU(x, yj )+ h^j Ux(x, yj),	D2 = ^gi,jU(x, yj+1)— h^j Ux(x, yj+1),

D = U(x, y
),	u = p(y — yj ) ,
h^ = y
— y ,

j+1	j
2h^j
j	j+1	j

Qb (u )= ÿ1 — sin(u  2	l^ ÿ1 — sin(u ) sin(u )+ ^g (1 — cos(u )) cos(u )+ (1 — cos(u )) ,
(9)

U(x, y )= (1 — sin(di)) E0 + (1 — sin(di)) sin(di)E1 + (1 — cos(di)) cos(di)E2 + (1 — cos(di)) E3 ,

Qi,j
(di)

E0 = Fi,j ,	E1 = li,j Fi,j + hiFx ,	E2 = gi,jFi+1,j — hi Fx  ,	E3 = Fi+1,j,
i.j	i+1,j
Q (d )= (1 — sin(d )) + l (1 — sin(d )) sin(d )+ g (1 — cos(d )) cos(d )+ (1 — cos(d )) ,
d = p(x — xi) and h = x	— x .

2hi
i	i+1	i
2
(10)

U (x, y )= (1 — sin(di)) G0 + (1 — sin(di)) sin(di)G1 + (1 — cos(di)) cos(di)G2 + (1 — cos(di)) G3 ,

y	j
i,j
(di)

G0 = Fy , G1 = l
Fy + hiFxy, G2 = g Fy
— hiF
, G3 = Fy  .









U(x, yj+1) and Uy(x, yj+1) are obtained by replacing j by j + 1 in Eqs. (8) and (10).
li, j and gi, j are free parameters along x-axis and l^i,j and ^gi,j
@Ui—1,j(xi, y)
@x	 di—1 =p
@Ui,j(xi, y)	0
@x	d	0
x ÿ	 


(12)

n x	y	xy
if l^i,j = l^i—1,j ,	^gi,j = ^gi—1,j,	Fi,j l^i,j ^gi—1,j — ^gi,jl^i—1,j

are  free  parameters  along  y-axis.	Fk,l , Fk,l, Fk,l : k = i,



+ 2hj Fxyÿl^	— l^  = 0.

function (8)) has the following properties:
@Ui,j(x, yj+1)



@Ui,j+1(x, yj+1)	= 0



U(x , y )= F ,
i
= F ,
y  ÿ	 

2	2h	ÿ	 

	

(13)



F	(l
g — g
2hi xy
l )+	F
(l — l
)= 0.

Theorem 4. The piecewise bivariate rational quadratic trigono- metric function U(x, y) is C1 over the whole domain if the shape
i+1,j+1
i,j+1 i,j

 
i,j+1
i,j
p
ÿ	 
i+1,j+1
i,j
i,j+1

design parameters satisfy the following relation:
@Ui,j—1(x, yj)




@Ui,j x, yj
—



= 0 if

li, j = li and gi, j = gi, i = 0, 1, 2, ... , n1 — 1 and for all
l = l
,	g  = g
,	Fy (l g
— g l	)

values of j.
i,j
i,j—1
i,j
i,j—1
i,j  i,j
i,j—1
i,j i,j—1
(14)

l^i,j	l^j and ^gi,j	^gj, j = 0, 1, 2, ... , n2	1 and for all values of i.
+ p Fi,j (li,j—1 — li,j )= 0,

Fy  ÿl g	— g l	 + 2hi Fxy (l	— l )0.

Proof. The rational quadratic trigonometric function (8) inter- polates the data values Fi, j and partial derivatives Fx , Fy , Fxy
The system of Eqs. (11)–(14) is satisfied only if li, j = li and gi,

defined at four corners of rectangular patch, i.e.
i,j
i,j
i,j
j = gi, i = 0, 1, 2, ..., n1 — 1 and for all values of j. l^i,j = l^j and
^gi,j = ^gj, j = 0, 1, 2, ..., n2 — 1 and for all values of i.


U(x , y )= F
,	@U(xi, yj) = Fx ,	@U(xi, yj) = Fy ,

Theorem 5. The C1 bivariate rational quadratic trigonometric

i  j	i,j	@x
i,j	@y
i,j
function U (x, y) is positive over the whole domain if the follow-

@2U xi, y
@x@y	= Fi,j .
Since each rectangular patch is bounded by four boundary
ing sufficient conditions are satisfied:

U(xi, yj)= Fi,j,	∀i = 0, 1, 2, ... , n1;	j = 0, 1, 2, .. . , n2;

curves so to blend the rectangular patches to generate a C1 continuous surface following sufficient conditions must be satisfied along the four boundaries of each rectangular

li > max  0, —
2hiFx
i,j ,

pFi,j
2hiFx
i,j+1  ,

pFi,j+1

patch:
@Ui,j(xi+1, y) 

— @Ui+1,j (xi+1, y) 


= 0,
gi > max  0,
8
2hiFx
i+1,j ,

pFi+1,j
2hiFx
i+1,j+1

pFi+1,j+1

ÿ	 


@x	p	@x
<	2h^ Fy
2h^jFy
2h^ pl Fy + 2h Fxy

di =2
di+1 =0
j
^ > max  0,
:
i,j
, — pF
i+1,j , —
i,j
i i,j
x

@Ui—1,j(xi, y) 
@Ui,j(xi, y) 
i,j
i+1,j
p liFi,j + 2hiFi,j

@x	—	@x
= 0,
	 9

2hj pgi Fi+1,j — 2hi Fi+1,j =

@Ui,j(x, yj+1)
@Ui,j+1(x, yj+1)
= 0,
— p pg F
2h Fx
 ;,



@y	 uj =p


@y	 uj+1 =0
i i+1,j —	i i+1,j

8<	^ y	^ y


2h^j pl Fy


+ 2hiF

2hj Fi,j+1 2hjFi+1,j+1
i i,j+1
i,j+1

@Ui,j—1(x, yj)


@Ui,j(x, yj )


^gj > max 0, pF	, pF	,
x   ,

2	^	 9

After  some  simple  computation  it  is  observed  that
2hj pgiFi+1,j+1 — 2hiFi+1,j+1 =

@U (x

,y) 
@U  (x

,y) 
p pg
x	 ;.



i 2	i+1

Proof. Let {(xi, yj, Fi, j): i = 0, 1, 2, ..., n1; j = 0, 1, 2, ..., n2} be

if l^i+1,j = l^i,j, ^gi+1,j
^g , Fx
i+1,j

ÿl^i+1,j ^gi,j — ^gi+1,j l^i,j 
the given set of positive regular data defined over the domain
D = [c, d] × [e, f]. The requirement is to develop an interpolat-
1

^	ing C
bivariate positive rational quadratic trigonometric func-

2hj xy
+	F
ÿl^
— l^
tion, i.e. U(x , y ) = F
, i = 0, 1, 2,.. . , n ; j = 0, 1, 2, ..., n ,

p
= 0.	(11)
and U(x, y) > 0, for all (x, y)	D. The C1 bivariate rational quadratic trigonometric function (8) is rearranged as:

C1 rational quadratic trigonometric spline	217
U(x, y)= 
2	2
×(1 — sin(di )) P0 +(1 — sin(di )) sin(di )P1 +(1 — cos(di )) cos(di )P2 +(1 — cos(di )) P3 ,
(1 — sin(di)) + li (1 — sin(di)) sin(di)+ gi (1 — cos(di)) cos(di)+(1 — cos(di))

P0 = (1 — sin(u ))2 T0,0 + (1 — sin(u )) sin(u )T0,1
+ (1 — cos(uj )) cos(uj)T0,2 + (1 — cos(uj )) T0,3,
P = ÿ1 — sin(u ) 2T  + ÿ1 — sin(u ) sin(u )T

+ (1 — cos(uj )) cos(uj)T1,2 + (1 — cos(uj )) T1,3,
P2 = (1 — sin(u ))2 T2,0 + (1 — sin(u )) sin(u )
T  + (1 — cos(u )) cos(u )T  + (1 — cos(u ))2T
P3 = (1 — sin(u ))2 T3,0 + (1 — sin(u )) sin(u )
T  + (1 — cos(u )) cos(u )T  + (1 — cos(u ))2T

2h^
T	= F ,	T	= l^ F +	F ,










Figure 2	Rational quadratic trigonometric spline with li = 0.4 and gi = 0.6.

0,0
i,j
0,1

2h^j
j i,j


y
p  i,j

T0,2 = ^gjFi,j+1 — p Fi,j+1,	T0,3 = Fi,j+1,

T	= l F
2hi x
+	F ,

1,0
i i,j
p  i,j

T	= l^ l F + 2hi Fx  + 2h^j l Fy + 2hi Fxy ,


T	= ^g l F


2hi x
+	F

 — 2h^j  l Fy


2hi xy
+	F	,





Figure 3	Positive rational quadratic trigonometric spline.


T	= l F
2hi x
+	F	, T
= g F
2hi x
F	,

1,3
i i,j+1
p i,j+1
2,0
i i+1,j
p  i+1,j


T	= l^ g F
2hi x
F
 + 2h^j  g Fy
2hi xy
F	,




T = ^g g F

2hi x
F
 — 2h^j g Fy

2hi xy
F	,



T  = g F
2hi x
F	,

2,3	i i+1,j+1	p  i+1,j+1

2h^j y
T3,0 = Fi+1,j ,	T3,1 = l^j Fi+1,j + p Fi+1,j ,
2h^j y



Figure 1	Linear interpolation of data.
T3,2 = ^gj Fi+1,j+1 —
p Fi+1,j+1,	T3,3 = Fi+1,j+1.


Table 2  A 3D positive data set.
y/x	—3	—2	—1	0	1	2	3
—3	0.0123	0.0236	0.0399	0.0493	0.0399	0.0236	0.0123
—2	0.0236	0.0624	0.1599	0.2499	0.1599	0.0624	0.0236
—1	0.0399	0.1599	0.9999	3.9996	0.9999	0.1599	0.0399
0	0.4444	0.2499	3.9996	40,000	3.9996	0.2499	0.4444
1	0.0399	0.1599	0.9999	3.9996	0.9999	0.1599	0.0399
2	0.0236	0.0624	0.1599	0.2499	0.1599	0.0624	0.0236
3	0.0123	0.0236	0.0399	0.0493	0.03999	0.0236	0.0123























Figure 4	Linear interpolation of positive data.
Figure 6	xz-view of Fig. 5.

P0 > 0 is positive if T0,k > 0, k = 0, 1, 2, 3.
2h^j Fy	2h^j Fy
T0,k > 0, k = 0, 1, 2, 3 if l^j > — 	i,j and ^gj > 	i,j+1 .


Similarly, P1 > 0 if

2hiFx	2hiFx
pFi,j
pFi,j+1

l > — 	i,j ,	l > — 	i,j+1 ,

i	pFi,j	i
^ÿ	y
pFi,j+1

xy 

2h^j pl Fy

+ 2hiF

l^j > — p pl
x  ,	^gj >
p pl
x   .

i Fi,j + 2hi Fi,j

Similarly for P2 and P3 are positive if
i Fi,j+1 + 2hi Fi,j+1

2hiFx
2hiFx
2h^j Fy

g > 	i+1,j ,	g > 	i+1,j+1 ,	^g > 	i+1,j+1 ,

i	pF
i+1,j
i	pF
i+1,j+1
j	pF
i+1,j+1

^ y	2h^j pg Fy
2hiF


Figure 5	C1 bivariate rational quadratic trigonometric function
l^j >	,
i+1,j
l^j > — p pg
,
iFi+1,j — 2hi Fx

with (li = 0.6, gi = 2, l^j = 0.8 and ^gj = 2.5).
2h^j pg Fy
2hiF

^gj >
p pg
x	 .



Since the shape design parameters li and gi are assumed as po- sitive real numbers. Moreover, the parameters di and uj are re-
p

2
always positive. Thus, positivity of U(x, y) depends upon the positivity of Pk, k = 0, 1, 2, 3.
i Fi+1,j+1 — 2hi Fi+1,j+1



Numerical examples

Example 1. Here rational quadratic trigonometric spline interpolation of positive data set {(x, y): (1.0, 14.0), (2.0, 8.0),




C1 rational quadratic trigonometric spline	219

computation the domain is restricted to S1 × S2, where S1 = S2 = { 3, 2, 1, 0, 1, 2, 3}. The tabular form of this positive data set is (see Table 2)
The positive shape of the data is produced in Fig. 4 by its linear interpolation. C1 bivariate rational quadratic trigono- metric function for arbitrary values of shape design parame- ters, is unable to preserve the positive shape of the data. It is exposed in Fig. 5 (li = 0.6, gi = 2, l^j 0.8 and ^gj 2.5), Fig. 6(xz-view) and Fig. 7(yz-view). Fig. 8 is the test of Theo- rem 7 on this data. The surface produced in Fig. 8 is positive over the whole domain.

Conclusion






Figure 7	yz-view of Fig. 5.



(3.0, 2.0),	(8.0, 0.8),	(10.0, 0.5),	(11.0, 0.25),	(12.0, 0.4),
(14.0, 0.37)} is discussed. The tabular form of this data set is (see Table 1)
This data is linearly interpolated by MATLAB build in function plot in Fig. 1 which shows that its shape is positive over whole domain. In Fig. 2, the same data are interpolated by rational quadratic trigonometric spline with li = 0.4 and gi = 0.6. This figure clearly indicates that rational quadratic trigonometric spline is unable to preserve the positive shape of data for arbitrary values of shape design parameters. The strength of Theorem 3 is checked by implementing it on these data shown in Fig. 3 which reveals that rational quadratic trig- onometric spline interpolates positive shape of data positively if the shape design parameters obey the restrictions developed in Theorem 4.

Example 2. The regular positive surface data are generated from the square function h x, y		4	. Although this
(x2 +y2 ) +0.0001
function is positive over every domain but for the ease of


















Figure 8	Positive C1 bivariate rational quadratic trigonometric function.
In this study, a Be´zier like rational quadratic trigonometric spline is developed to assure C1-continuity in rational qua- dratic structure. The shape preserving schemes proposed in
[13] was C1 for uniform knot, [17] was C0. In [14,15] order of continuity was dependent on multiplicity of knot and shape parameters, in [19] C1-continuity was dependent on knot vec- tors and choice of derivatives, [20] restricted the derivatives to Di for tangent continuity. The data arising in most of the applications are non-uniform and does not restrict the deriva- tives; hence, these schemes are not applicable to a wide range of functions where derivative preservation is also mandatory. The order of continuity of rational quadratic trigonometric spline of this paper is independent of knot spacing, slope of se- cant line and shape parameters.
The developed curve and regular surface data interpolants are likely to preserve the shape of data, unlike [1,4,5,11,12,18,19,21], without constraining the interval and derivatives.
The order of approximation of the developed scheme is O h3 in quadratic structure, whereas the order of approxima- tion of rational interpolant used in [17] was O hi .

References

Asim MR, Brodlie KW. Curve drawing subject to positivity and more general constraints. Comput Graph 2003;27:469–85.
Bao F, Sun Q, Pan J, Duan Q. A blending interpolator with value control and minimal strain energy. Comput Graph 2010;34:119–24.
Brodlie K, Mashwama P, Butt S. Visualization of surface data to preserve positivity and other simple constraints. Comput Graph 1995;19:585–95.
Butt S, Brodlie KW. Preserving positivity using piecewise cubic interpolation. Comput Graph 1993;17(1):55–64.
Casciola G, Romani L. Rational interpolants with tension parameters. In: Lyche T, Mazure ML, Schumaker LL, editors. Curves and surfaces design, Saint Malo. Brentwood: Nashboro press; 2002, 2003.
Delgado J, Pen˜a JM. Are rational Be´zier surfaces monotonicity preserving? Comput Aided Geomet Des 2007;24(5):303–6.
Duan Q, Bao F, Du S, Twizell EH. Local control of interpolating rational cubic spline curves. Comput Aided Des 2009;41:825–9.
Duan Q, Djidjeli K, Price WG, Twizell EH. A rational cubic spline based on function values. Comput Graph 1998;22(4):479–86.
Duan Q, Zhang Y, Twizell EH. A bivariate rational interpolation and the properties. Appl Math Comput 2006;179:190–9.
Duan Q, Zhang H, Zhang Y, Twizell EH. Error estimation of a kind of rational spline. J Comput Appl Math 2007;20(1):1–11.



Farouki RT, Manni C, Sestini A. Shape-preserving interpolation by G1 and G2 PH quintic splines. IMA J Numer Anal 2003;23:175–95.
Floater MS. A weak condition for the convexity of tensor-product Be´zier and B-spline surfaces. Adv Comput Math 1994;2(1):67–80.
Goodman TNT, Ong BH. Shape-preserving interpolation by splines using vector subdivision. Adv Comput Math 2005;22(1):49–77.
Han X. Cubic trigonometric polynomial curves with a shape parameter. Comput Aided Geomet Des 2004;21:535–48.
Han X. C2 quadratic trigonometric curves with local bias. J Comput Appl Math 2005;180:161–72.
Han Xi-An, Ma Y, Haung X. The cubic trigonometric Be´zier curve with two parameters. Appl Math Lett 2009;22:226–31.
Hussain MZ, Ayub N, Irshad M. Visualization of 2D data by rational quadratic function. J Inform Comput Sci 2007;2(1):17–26.
Lamberti P, Manni C. Shape-preserving C2 functional interpola- tion via parametric cubics. Numer Algorithms 2001;28:229–54.
Manni C, Sablonnie` re P. C1comonotone Hemite interpolation via parametric surfaces. In: Drehlen M, Lyche T, Schumaker LL, editors. Mathematical methods for curves and surfaces. Vender- bilt University Press; 1995.
Schultz MH. Spline analysis. Englewood Cliffs, New Jersey: Prentice-Hall; 1973.
Zhang Y, Duan Q, Twizell EH. Convexity control of bivariate rational interpolating spline surfaces. Comput Graph 2007;31:679–87.
