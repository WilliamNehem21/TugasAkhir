Electronic Notes in Theoretical Computer Science 46 (2001)
URL: http://www.elsevier.nl/locate/entcs/volume46.html 15 pages


Geodesic Paths Approach to Color Image Enhancement

M. Szczepanski 1, B. Smolka, and D. Slusarczyk
Department of Automatic Control Silesian University of Technology
Akademicka 16 Str, 44-101 Gliwice, Poland

K. N. Plataniotis 2 and A. N. Venetsanopoulos
Edward S. Rogers Sr. Department of Electrical and Computer Engineering University of Toronto
10 King’s College Road, Toronto, Canada


Abstract
New filter class for multichannel image processing is introduced and analyzed. The new technique of image enhancement is capable of reducing impulsive and Gaussian noise and it significantly outperforms the standard methods of noise reduction. In the paper a smoothing operator, based on a random walk model and a fuzzy similarity measure between pixels connected by a digital geodesic path is introduced. The efficiency of the proposed method was tested on the standard color images using the objective image quality measures. Obtained results show that the new method not only outperforms standard noise reduction algorithms, but has some interesting features useful for segmentation of noisy color images.


Introduction
Numerous noise filtering techniques have been proposed for multichannel im- age processing [6,7]. The nonlinear filters are required to preserve edges, cor- ners and other image details, and to remove Gaussian and impulsive noise. One of the most important families of nonlinear filters is based on order statis- tics. A number of different vector processing filters using order statistics have been developed in the last decade. The output of these filters is defined as the lowest ranked vector according to a specific vector ordering technique.

1 Email: mszczepa@ia.polsl.gliwice.pl
2 Email: kostas@dsp.toronto.edu
◯c 2001 Published by Elsevier Science B. V. Open access under CC BY-NC-ND license.


Let F(x) represents a multichannel image and let W be a window of finite size n (filter length). The noisy image vectors inside the filtering window W are denoted as Fj, j = 0, 1, ..., n − 1 . If the distance between two vectors Fi, Fj is denoted as ρ(Fi, Fj) then the scalar quantity Ri =  n−1 ρ(Fi, Fj), is the distance associated with the noisy vector Fi . The ordering of the Ri ’s: R(0) ≤ R(1) ≤ ... ≤ R(n−1), implies the same ordering to the corresponding vectors Fi : F(0) ≤ F(1) ≤ ... ≤ F(n−1). Nonlinear ranked type multichannel estimators define the vector F(0) as the filter output.
The best known order statistics filter is the so called Vector Median Filter (VMF). The definition of the multichannel median is a direct extension of the ordinary single-channel median definition [1]. VMF uses the L1 or L2 norm to order vectors according to their relative magnitude differences.
The orientation difference between color vectors can also be used to remove vectors with atypical directions (Vector Directional Filter - VDF, Basic Vector Directional Filter - BVDF) [14]
Another efficient rank-ordered technique called Hybrid Directional Filter was presented in [4]. This filter operates on the directional and the magni- tude of the color vectors independently and then combines them to produce a unique final output. Another more complex hybrid filter, which involves the utilization of an Arithmetic Mean Filter (AMF), has also been proposed [4]. The reduction of image noise without major degradation of the image structure is one of the most important problems of the low-level image pro- cessing. A whole variety of algorithms has been developed, however none of them can be seen as a final solution of the noise problem and therefore a new
filtering technique is proposed in this paper.

Digital Paths Approach
Let us assume, that R2 is the Euclidean space, W is a planar subset of R2 and x, y are points of the set W . A path from x to y is a continuous mapping P: [a, b] → X, such that P(a) = x and P(b) = y. Point x is the starting point and y is the ending point of the path P [2].
An increasing polygonal line P on the path P is any polygonal line P =

{g(λi)}n
,a = λ0 < . . . < λn = b. The length of the polygonal line P is
n

where ρ(x, y) is the distance between the points x and y, when a specific metric is adopted. If P is a path from x to y then it is called rectifiable, if and only if L(P ), where P is an increasing polygonal line, is bounded. Its upper bound is called the length of the path P.
The geodesic distance ρW (x, y) between points x and y is the lower bound of the length of all paths leading from x to y totally included in W . If such paths do not exist, then the value of the geodesic distance is set to ∞. The geodesic distance verifies ρW (x, y) ≥ ρ(x, y) and in the case when W is a convex set then ρW (x, y)= ρ(x, y).

The notion of the path can be extended to a lattice, which is a set of discrete points, in our case image pixels. Let a digital lattice H = (F, N ) be defined by F, which is the set of all points of the plane (pixels of a color image) and the neighborhood relation N between the lattice points [11].

A digital path P = {pi}n
on the lattice H is a sequence of neighboring

points (p
,p ) ∈ N
i=0
L(P ) of digital path P {p }n
is simply

i−1	i
. The length
i i=0

n i=1
ρH(pi−1, pi), where ρH denotes the distance between two neighboring

points on the lattice H (Fig. 1).
Constraining the paths to be totally included in a predefined set W ∈ F yields the digital geodesic distance ρW . In this paper we will assign to the distance of neighboring points the value 1 and will be working with the 8- neighborhood system.
Let the pixels (i, j) and (k, l) be called connected (denoted as (i, j) ↔ (k, l) ), if there exists a geodesic path PW {(i, j), (k, l)} contained in the set W starting from (i, j) and ending at (k, l).
If two pixels (x0, y0) and (xn, yn) are connected by a geodesic path
PW {(x0, y0), (x1, y1),..., (xn, yn)} of length n then let χW,n
m	m
n−1
χW,n{(x0, y0), (xn, yn)} =	||F(xk+1, yk+1) − F(xk, yk)|| ,	(1)
k=0
where m is the path index be a measure of dissimilarity between pixels (x0, y0)

and (xn, yn), along a specific geodesic path PW
joining (x0, y0) and (xn, yn)

[13,3]. If a path joining two distinct points x, y, such that F(x) = F(y) consists of lattice points of the same values, then χW,n(x, y) = 0 otherwise χW,n(x, y) > 0.


Fig. 1. There are four geodesic paths of length 2 connecting two neighboring points contained in the specific window W when the 8-neighborhood system is applied.
Let us now define a fuzzy similarity function between two pixels connected along all geodesic digital paths leading from (i, j) to (k, l)
µW,n {(i, j), (k, l)} = 1 Σ exp −β · χW,n {(i, j), (k, l)}	(2)
ω	m
m=1
where ω is the number of all paths connecting (i, j) and (k, l), β is a design parameter and χW,n {(i, j), (k, l)} is a dissimilarity value along a specific path from a set of all ω possible paths leading from (i, j) to (k, l). In this way µW,n{(i, j), (k, l)} is a value, taken over all routes linking the starting point



.	.	.	.	.
.	.	.	.	.
.	.	.	.	.

.	.	.	.. y .
.	.  ). ).. y .
✻
.	.	.	.. y .
✻

.	.	.	.	.
.	.✻
.	.	.
.	.	.	.✻  .

. x ..	.	.	.
. x ..
.	.	.
. x .. ).  ).	.

.	.	.	.	.
.	.	.	.	.
.	.	.	.	.



.	.	.	.	.
.	.	.	.	.
.	.	.	.	.

.	.	. ).. y .
.	.	.
.. y .
.	.	. ).. y .

✻
.	.	.✻  .	.
.	.	.
✻
).	.
✻
.	. ).	.	.

. x ..
).	.	.
✻
. x .. ).	.	.
✻
. x ..
.	.	.

.	.	.	.	.
.	.	.	.	.
.	.	.	.	.

Fig. 2. There are five paths of length 4 connecting point x and y when the 4-neigh- borhood system is used.

(i, j) and the endpoint (k, l). For n = 1 and W a square mask of the size 3 × 3 (Fig. 1), we have
µW,1{(i, j), (k, l)} = exp {−β||F(i, j) − F(k, l)||} ,	(3)
and when F(i, j) = F(k, l) then χW,n{(i, j), (k, l)} = 0, µ{(i, j), (k, l)} = 1, and for ||F(i, j) − F(k, l)|| → ∞ then µ → 0 [8]. The normalized similarity function takes the form


ψW,n{(i, j), (k, l)} =
µW,n{(i, j), (k, l)}
µW,n{(i, j), (l, m)} .	(4)
(l,m)⇔(i,j)



and has the property that
Σ

(k,l)⇔(i,j)

ψW,n{(i, j), (k, l)} = 1 .	(5)

Now we are in a position to define a smoothing transformation Fˆ

Fˆ(i, j)=	Σ
(k,l)⇔(i,j)
ψW,n{(i, j), (k, l)}· F(k, l) ,	(6)

where (k, l) are points which are connected with (i, j) by geodesic digital paths of length n included in W .

New Filter Design
Models of Digital Paths
The features of the new filter strongly depend on the type of digital paths chosen. Numerous models of paths produce specific filters with the ability to suppress certain kinds of noise. In this paper three types of random paths are introduced: Self avoiding path (SAP) Non-reversing path model (NRP) and Escaping Path Model (EPM)(Fig. 3).



.	.	.	.	.	.
.	.	.	.	.	.
.	.	.	.	.	.

. ).	.	. ).. y .	.	.	.	.	.. y .	.	.	.	. ).. y .
^ ❅	^	/’	^
.( . ❅❘.	.( .	.	.	.	.	./ .	.	.	.	. ).	.	.
^ ❅	/’	❅<	/’

.	.( . ❅❘./ .	.	.	.	.( . ❅	/
.	.	.	.

^	^ ^	^
. x .. ).	.	.	.	. x .. ).7). /’.	.	. x ..	.	.	.	.
.	.	.	.	.	.	.	.	.7)./ .	.	.	.	.	.	.	.
b)	c)
Fig. 3.   Different  types  of  geodesic  paths  a)  Self  avoiding  path  (SAP),
Non-reversing path (NRP), c) Escaping Path (EPM) with L2 metric .

Self avoiding path (SAP) is a special path along the image lattice such that adjacent pairs of edges in the sequence share a common vertex of the lattice, but no vertex is visited more than once and in this way the trajectory never intersects itself. In other words SAP is a path on a lattice that does not pass through the same point twice (Fig. 3a).
On the two-dimensional lattice SAP is a finite sequence of distinct lattice points (x0, y0), (x1, y1),..., (xn, yn), which are in neighborhood relation and (xi, yi) /=xj(, yj) for all i /=j.
Non-reversing path is (NRP) is a special trajectory along the image lattice such that adjacent pairs of edges in the sequence share a common vertex of the lattice, but no vertex can be revisited in one step (Fig. 3b).
Escaping path model(EPM) is a model of random walk in which the distance from the starting point cannot be decreased in subsequent steps (Fig. 3c).
For two steps all described paths are equivalent.

Iterative Nature of the New Class of Filters
The smoothing operator Fˆ in (6) has to be applied in an iterative way. Starting with low value of β enables the smoothing of the image noise components. At each iteration steps the parameter β has to be increased, like in simulated

annealing, so we have used:
β(k)= β(k − 1) · α, k = 1,..., n,	(7)
However, in this case two parameters α and β are needed to define the filter. In order to make the new filter less dependent on the initial parameter values, adaptive version of our filter was introduced. Parameter β in (2) is obtained from the data in the filter window and is defined as a standard deviation of samples in W , multiplied by a normalizing constant factor γ,
γ ,  Σ Σ	 2

β = N · l
i,j∈W k=1
Fk (i, j) − Fk
,	(8)

where N is the number of pixels in the processing window W , l is the number of channels of the image (in the RGB color space l = 3), Fk denotes the average value of the kth component in window W and γ is a normalizing parameter. Using adaptive version of our filter, there is no need to use parameter α from
(7) and in this way there remains only one design parameter, while performing the filtering. As shown in Tabs. 2 and 3 the adaptive version of our filter yields better results especially for heavily distorted images.

Results
The effectiveness of the new filters was tested on the color test image LENA contaminated by a Gaussian noise of σ = 30 and on the same original image contaminated by 4% impulsive noise (salt & pepper in each channel) mixed with Gaussian noise (σ = 30). The performance of the presented method was evaluated by means of the objective image quality measures RMSE, PSNR, NMSE and NCD [7].
Tables 2 and 3 show the results obtained for n = 2 and n = 3 in comparison with the standard noise reduction algorithms shown in Tab. 1. Additionally Fig. 7 shows the comparison of the new filtering technique with the standard vector median.
In our experiments wide range of filter parameters was examined. Figures 4 and 5 show the peak signal to noise ratio (PSNR) and normalized color distance (NCD) dependence on the α and β values for the LENA standard image corrupted by 4% impulse mixed with Gaussian noise (σ = 30). As can be easily observed the extrema of PSNR and NCD are rather flat and in this way the new filter is robust to improper values of chosen parameters. Results obtained for adaptive version of our filter are presented in Fig. 6
For the calculation of the similarity function we used the L1 metric and an exponential function, however we have obtained good results using other convex functions and different vector metrics.


Table 1
Filters taken for comparison with the proposed noise reduction technique.
The efficiency of the new algorithm as compared with the vector median filter is shown in Figs. 7 and 8. After the application of the new filter, the impulse pixels introduced by noise process are removed, the contrast is improved, the image is smoothed and what is important the edges are well preserved.
Figures 9 and 10 show the features of the new filter class for LENA and PEPPERS images. The results show that they are quite similar to those ob- tained using anisotropic diffusion. However, our filter is robust to the impulse noise, which is a main obstacle, when using the anisotropic diffusion approach to smooth noisy images.


Fig. 4. Efficiency of the new filter in terms of PSNR and its dependence on the α and β values for the LENA standard image corrupted by 4% impulse and Gaussian noise (σ = 30) (SAP n = 3, 2 iterations).




Fig. 5.  Efficiency of the new filter in terms of NCD and its dependence on the α and β values for LENA standard image corrupted by 4% impulse and Gaussian noise (σ = 30) (SAP n = 3, 2 iterations).



Fig. 6. Efficiency of the new adaptive filter in terms of PSNR, SNR, NCD and NMSE for LENA standard image corrupted by 4% impulse and Gaussian noise (σ = 30) (n = 2, 2 iterations).

Conclusions
In this paper, a new class of filters for noise reduction in color images has been presented. Experimental results indicate that the new filtering tech- nique outperforms the standard procedures used to reduce mixed impulsive and Gaussian noise in color images. The new methods have some interest- ing features useful for segmentation of noisy color images. Especially, filters based on the escaping path models (EPP), have the ability of segmentation of strongly disturbed images (Fig. 8). The efficiency of the new filtering techniques are shown in Tabs. 2 and 3 and in Figs. 7, 8.




Fig. 7. Comparison of efficiency of the vector median with the new filter proposed in this paper a) test image (part of a scanned map), b) result of the standard vector median filtration (3 × 3 mask), c) result of the filtration with the new filter using SAP (β = 20,α = 1.25,n = 2, 3 iterations)
References
Astola J., Haavisto P., Neuovo Y., Vector median filters, IEEE Proc., 78 (1990), 678-689
Borgefors G., Distances transformations in digital images, Computer Vision, 
Graphics and Image Processing, 34 (1986) 334-371
Cuisenaire O., ”Distance transformations: fast algorithms and applications to medical image processing”, PhD Thesis, Universite Catholique de Louvain, Oct. 1999


Gabbouj M., Cheickh F.A., Vector median - vector directional hybrid filter for colour image restoration, Proceedings of EUSIPCO, 879-881, 1996
Karakos D.,Trahanias P.E., Generalized multichannel image filtering structures,
IEEE Trans. on Image Processing, 6, (7), 1038-1045, 1997
Pitas I., Venetsanopoulos A. N, ”Nonlinear Digital Filters : Principles and Applications”, Kluwer Academic Publishers, Boston, MA, 1990
Plataniotis K.N., Venetsanopoulos A.N., ”Color Image Processing and Applications”, Springer Verlag, (June 2000)
Plataniotis K.N., Androutsos D., Venetsanopoulos A.N.V., Fuzzy adaptive filters for multichannel image processing, Signal Processing Journal, 55, (1), 93-106, 1996
Plataniotis K.N., Androutsos D., Sri V.,Venetsanopoulos A.N.V., A nearest neighboor multichannel filter, Electronic Letters, 1910-1911, 1995
Plataniotis K.N., Androutsos D., Vinayagamoorthy S., Venetsanopoulos A.N.V., Color image processing using adaptive multichannel filters,IEEE Trans. on Image Processing, 6 (7), 933-950, 1997
Schmitt M., Lecture Notes on Geodesy and Morphological Measurements, Proceedings of the Summer School on Morphological Image and Signal Processing, Zakopane, Poland (1995)
Smolka B., Wojciechowski K., Random walk approach to image enhancement,
Signal Processing, Vol. 81, No. 3, 465-482, 2001
Toivanen P.J., New geodesic distance transforms for gray scale images, Pattern Recognition Letters, 17 (1996) 437-450
Trahanias P.E., Venetsanopoulos A.N., Vector directional filters: A new class of multichannel image processing filters, IEEE Trans. on Image Processing, 2, 4 (1993) 528-534
Trahanias P.E., Karakos D., Venetsanopoulos A.N., Directional processing of color images : theory and experimental results, IEEE Trans. on Image Processing, 5, (6),868-880, 1996


Table 2
Comparison of the new algorithms with the standard techniques (Tab. 1) using the LENA standard image corrupted by Gaussian noise σ = 30. SAP-2, 3 denote the self avoiding path with 2 and 3 steps (β = 8,α = 1.2), SAP-Ad denotes adaptive version of SAP (γ = 4, 2 steps) and EPM denotes the filter based on a model of escaping path (3 steps, β = 11,α = 2). The subscripts denote the iteration number.



Table 3
Comparison of new algorithms with standard techniques using LENA image corrupted by 4% impulse and Gaussian noise σ = 30. SAP-2, 3 denote the SAP with 2 and 3 steps (β = 8,α = 1.2), SAP-Ad denotes adaptive version of SAP
(γ = 4, 2 steps) and EPM denotes the filter based on a model of escaping path (3 steps, β = 10,α = 1.4), subscripts denote the iteration number.




a)	b)	c)
Fig. 8. Comparison of the efficiency of the vector median with the proposed noise reduction technique when Escaping Path Model is used: a) test images (parts of an old manuscript and a poster), b) result of the standard vector median filtration (3 × 3 mask), c) result of the EPM filtration (β = 20,α = 1.2,n = 3, 3 iterations).



Fig. 9. Comparison of the efficiency of the vector median with the proposed noise reduction technique for LENA and PEPPERS test images. a) test images, b) result of the standard vector median filtration (3 × 3 mask, five iterations), c) result of the Adaptive SAP filtration (γ = 4,n = 2, 5 iterations).



Fig. 10. Comparison of the efficiency of the vector median with the proposed noise reduction technique for LENA and PEPPERS test images: a) test images corrupted by 4% impulse and Gaussian noise σ = 30, b) result of the standard vector median filtration (3 × 3 mask, five iterations), c) result of the Adaptive SAP filtration (γ = 4,n = 2, 5 iterations).
