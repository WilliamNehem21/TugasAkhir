	Electronic Notes in Theoretical Computer Science 212 (2008) 133–148	
www.elsevier.com/locate/entcs

Locality of Corner Transformation for Multidimensional Spatial Access Methods
H. K. Dai1 ,2
Computer Science Department Oklahoma State University Stillwater, Oklahoma 74078, U. S. A.

K.-Y. Whang1 ,3
Division of Computer Science
Korea Advanced Institute of Science and Technology Daejeon 305-701, Republic of Korea

H. C. Su4
Department of Computer Science Arkansas State University
State University, Arkansas 72467, U. S. A.


Abstract
The geometric structural complexity of spatial objects does not render an intuitive distance metric on the data space that measures spatial proximity. However, such a metric provides a formal basis for analytical work in transformation-based multidimensional spatial access methods, including locality preservation of the underlying transformation and distance-based spatial queries. We study the Hausdorff distance metric on the space of multidimensional polytopes, and prove a tight relationship between the metric on the original space of k-dimensional hyperrectangles and the standard p-normed metric on the transform space of 2k- dimensional points under the corner transformation, which justifies the effectiveness of the transformation- based technique in preserving spatial locality.
Keywords: databases, multidimensional spatial access methods, corner transformation, locality



1 This work was partially supported by the National Research Lab program of the Korea Engineering and Science Foundation (KOSEF)/Ministry of Science and Technology and the Brain Korea 21 project.
2 Email: dai@cs.okstate.edu
3 Email: kywhang@cs.kaist.ac.kr
4 Email: suh@cs.astate.edu

1571-0661 © 2008 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2008.04.058


A critical measure of the efficiency of multidimensional spatial indexing in support- ing spatial operations and query processing is its locality or proximity preservation. Informally, for two metric spaces S1 and S2 with metrics d1 and d2, respectively, a function mapping S1 to S2 is considered locality-preserving if close-by points in S1 (with respect to d1) are mapped to close-by points in S2 (with respect to d2) and/or vice versa. For database data and index structures in which (S1, d1) represents the key/index-space with its key/index dissimilarity metric d1 and (S2, d2) represents the address space with a standard metric d2, such notion of preservation translates into clustering — logically related objects with close-by key/index values are stored in the same or close-by data/index pages.
Two intrinsic difficulties are associated with the management of multidimen- sional spatial objects in general. The geometric structural complexity of spatial objects does not render an intuitive metric on the data space that measures spatial proximity, and the multidimensionality of spatial data space prohibits a (spatial) proximity-preserving total ordering on spatial objects.
For managing spatial objects with simple geometric structure in a spatial data space, such as line segment, hyperrectangle, or hypersphere, a conceptually elegant object-mapping approach, such as the corner transformation [10], transforms the spatial characteristics of objects into points in higher-dimensional space, and cou- ples with an existing point access method. For examples in mapping rectangles in the 2-dimensional Euclidean space to 4-dimensional points, the corner transforma- tion is based on the coordinates of a pair of antipodal corners of the rectangle, while the center transformation is based on the coordinates of the centroid together with the measures of spatial extent of the rectangles in all dimensions. The transfor- mation of a database of spatial objects (original space) into a database of higher- dimensional points (transform space), when coupling with a point access method for the transform space, produces a spatial access method for the original space. The transformation technique focused in our study is the corner transformation. However, the notions developed for its analyses can be translated for other similar transformations.
For a positive integer k, denote by Rk the k-dimensional real space and by R(k) the original space of rectilinear hyperrectangles in Rk. All hyperrectangles addressed in our study are rectilinear; the term “hyperrectangle” will hereafter abbreviate “rectilinear hyperrectangle”. Viewing a line segment [l, u] in R as a point (l, u) in
R2, we define the (injective) corner transformation κ : R(k) → (R2)k, via Cartesian
product, by mapping a hyperrectangle  k  [li, ui] ∈ R(k), where li and ui denote
the lower and upper limits, respectively, of the spatial extent of the hyperrectangle in the i-th dimension, to a point ((l1, u1), (l2, u2),... , (lk, uk)) ∈ (R2)k. Since li ≤ ui for every i ∈ {1, 2,... , k}, the transform space under κ, which is the range of κ, is Hk, where H denotes the half-plane {(l, u) ∈ R2 | l ≤ u}.
We can interpret that the corner transformation κ maps, for each i  ∈
{1, 2,... , k}, the spatial extent [li, ui] in the i-th dimension to a point (li, ui) in

H. The 2-dimensional point (li, ui) induces a partition of H into six regions, each of which consists of all points (l, u) ∈ H whose corresponding (under κ) line seg- ments [l, u] in R are characterized by a simple spatial relationship with the line segment [li, ui]. Based on the partitioning and the characteristics of the induced spatial relationships, spatial search operations within common spatial query pro- cessing in the original space R(k) are decomposed and translated into equivalent range constraints in each dimension, and then recomposed to form range queries in the transform space Hk.
Complications arise, when we attempt to analyze the locality preservation and clustering of a transformation-based spatial access methods, due to the absence of an intuitive metric that captures the spatial proximity on spatial objects in complex geometric structures. In fact, even with its presence, the locality analysis of a spatial access method modified from or coupled with a point access method is inherently limited by the locality knowledge of the point access method and constrained by the modification or transformation undertaken. Thus, the simple transformation techniques may suffer from several potential difficulties and disadvantages due to the presence or absence of: (1) metrics on multidimensional spatial objects, (2) locality preservation of transformations, (3) nonuniform distribution in the transform space, and (4) efficient support of complex spatial operations. The latter two have been overcome in recent studies in the literature, and the former two can be resolved by developing intuitive and flexible metrics for multidimensional spatial objects.
We study the Hausdorff distance metric on multidimensional objects with con- vex spatial extent [3] that supports formal analyses of locality preservation and clustering of spatial access methods, and prove its tight relationship with standard metrics on the higher-dimensional space under the corner transformation.
Our study is motivated by recent advances in transformation techniques in imple- menting spatial access methods. Extensive experiments in [10] compare the spatial access method based on the corner transformation coupled with a variant of the multilevel grid file with the R∗-tree on real and synthetic data in 2-dimensional original spaces, and show that the former delivers almost equal or slightly better performance measured in the number of page accesses. The notable clustering prop- erty of the R∗-tree yields strong experimental evidence for the locality preservation of the corner transformation. The implementations and experimental findings in [8] and [9] demonstrate that corner-transformation-based spatial access methods can support efficient spatial operations, including complex ones such as spatial join. The transform space of multidimensional point objects and its underlying point access data and index structures can be better organized and essentially more orderly, par- tially due to the imposed standard distance metrics, than their counterparts. This in turns facilitates more global optimization opportunities at different levels dur- ing algorithmic development. The effectiveness of the transformation technique in preserving spatial locality can now be rigorously justified via the tight relationship.

Distance Metric for Spatial Objects
For a subset T of a metric space S, the interior and the boundary of T in S are denoted by int(T ) and ∂(T ), respectively. The affine and convex hulls of a subset W of a real vector space V are denoted by aff (W ) and conv(W ), respectively. The dimension of an affine hull A, denoted by dim(A), is the vector-space dimension of the (unique) subspace parallel to A.
A polyhedron in Rk is the intersection of finitely many closed half-spaces in Rk, which is not necessarily bounded in Rk. A (convex) polytope P in Rk is the convex hull of a finite set of points in Rk, that is, P = conv(X) where X is a finite subset of Rk; or equivalently, P is a bounded polyhedron. The dimension of P is that of the affine hull aff (P ) of P ; so an m-dimensional polytope P in Rk (with m ≤ k) is a bounded intersection of finitely many closed half-spaces such that the dimension of aff (P ) is m.

The Hausdorff Distance Metric on Compact Subsets of Rk and Its Computation
Consider the k-dimensional real space Rk equipped with a metric d. Denote by P(k, d) the set of all k-dimensional (convex) polytopes in the metric space (Rk, d), and by C(k, d) the set of all nonempty compact subsets in (Rk, d). Note that P(k, d) ⊆ C(k, d).

For a nonempty subset A of Rk and a point x ∈ Rk, denote by d'
(x, A) the

infimum distance inf{d(x, y) | y ∈ A}. For two nonempty subsets A and B in

C(k, d), denote δ(A, B) = sup{d'
(a, B) | a ∈ A}. The minimum and maximum

value theorem of order topology gives existence results for d'
and δ, and they are

therefore functions on Rk × C(k, d) and C(k, d) × C(k, d), respectively.
The distance function δ : C(k, d) × C(k, d) → R is not a metric on C(k, d) — it satisfies the triangle inequality but fails the other two conditions of metrics; however, it forms the basis for developing into one for C(k, d). The Hausdorff distance metric Δ is the symmetrization of the directed distance function δ via maximization, that is, Δ(A, B)= max{δ(A, B), δ(B, A)} for all A, B ∈ C(k, d). The restriction of Δ to P(k, d) × P(k, d) is a metric on P(k, d). Hence the set P(k, d) of all k-dimensional polytopes in (Rk, d), when equipped with the restriction Δ|P(k,d)×P(k,d) as its metric, is a metric subspace of the metric space (C(k, d), Δ).
In order to represent the geometrical characteristics such as length, size, or extent of the spatial objects, we consider hereafter the normed space (Rk,  p) of the k-dimensional real vector space Rk equipped with a standard p-norm  p (for an arbitrary real number p ≥ 1 or p = ∞) and the induced p-normed metric dp. The metric d on C(k, d) and P(k, d) assumes an induced metric from a p-norm   in the normed space (Rk,  ).
A large volume of research work on Hausdorff distance metric focuses on its algorithmic computation (see [7], [1], and [3]). The minimum and maximum value

theorem gives the existence of point(s) a ∈ A in achieving d(x, a) = d'
(x, A)

for all A ∈ C(k, d) and x ∈ Rk, and point-pair(s) (a, b) ∈ A × B in achieving
d(a, b)= δ(A, B)= sup{d' (a', B) | a' ∈ A}. The following geometrically intuitive

theorem (without proof) shows where to locate such point-pairs in their respective boundary ∂(A) × ∂(B) under a necessary convexity condition on B.
Theorem 2.1 For all A, B ∈ C(k, d),
If B is convex, then:
0	if A ⊆ B
δ(A, B)= 
⎩ δ(∂(A) − int(B), ∂(B)) otherwise,
and
If A and B are convex, then:
⎧⎪ 0	if A = B
Δ(A, B)= ⎪⎨ δ(∂(A) − int(B), ∂(B))	if B Ç A
δ(∂(B) − int(A), ∂(A))	if A Ç B
⎪⎪⎩ max{δ(∂(A) − int(B), ∂(B)), δ(∂(B) − int(A), ∂(A))}  otherwise.

Effective Computation of Hausdorff Distance Metric on P(k, d)
Most spatial objects in spatial databases, when approximated into their spatial ab- stract data type values, are represented in simple multidimensional (convex) poly- topal structures in P(k, d) such as for minimum-bounding or maximum-inscribed rectilinear hyperrectangles. The set P(k, d) consists of all k-dimensional polytopes in the normed space (Rk,  ) with the metric d induced by the underlying p-norm  . Since P(k, d) ⊆ C(k, d), the simplification result in computing δ and Δ of Theorem 2.1 can be applied to P(k, d): the computations of δ(A, B) and Δ(A, B) for A, B ∈ P(k, d) are reduced to the equivalent δ(∂(A), ∂(B)) and Δ(∂(A), ∂(B)) based on the respective boundaries of A and B.
The combinatorial structure of a polytope is characterized by its face lattice, which is the set of all faces of the polytope partially ordered by the inclusion. Intuitively, the face convexity and the face-lattice structure suggest that we may further simplify the computations of δ and Δ to ones partially based on the vertex sets of the polytopes.
The impact of the computational simplification in δ and Δ is twofold: a succinct reduction gives rise to their effective computation in applications and provides im- portant insight into the relationship between the metric Δ on P(k, d) with one on a transform space of P(k, d).
For an m-dimensional polytope P , denote by Fi(P ) the set of all i-dimensional faces of P for i = −1, 0,... , m, with F−1(P ) = {∅} and Fm(P ) = {P }, and by
F(P ) = ∪m	Fi(P ) the set of all faces of P . The face lattice (F(P ), ⊆) is the
lattice structure consisting of F(P ) partially ordered by the inclusion.
Let P be a k-dimensional polytope in P(k, d). Denote by ∂i(P ) the union of all i- dimensional faces of P , that is, ∂i(P )= ∪F ∈Fi(P )F (⊆ P ) for i = k, k − 1,... , 0, −1. Observe that:

The set ∂k−1(P ) is the union of all facets of P , that is, ∂k−1(P )= ∂(P ), and
∂0(P ) is the set of all vertices of P ; also ∂k(P )= P and ∂−1(P )= ∅,
For i = k − 1,k − 2,... , 0, the set ∂i(P ) is the union of the boundaries of all (i+1)-dimensional faces of P (with respect to (Ri+1, d)), that is, (∪F ∈F (P )F =)

∂i(P ) = ∪F ∈Fi+1
(Ri+1, d)), and
(P )∂(i+1)(F ) (where ∂(i+1)(F ) denotes the boundary of F in

The successive boundary sets of F(P ) form a descending chain: ∂k−1(P ) ≥
∂k−2(P ) ≥ ··· ≥ ∂0(P ).
Lemmas 2.2 and 2.3 continue to simplify the computation of δ(∂(A), ∂(B)) for
A, B ∈ P(k, d) to δ(∂0(A), ∂(B)) in successive reductions via the descending chain
∂(A)= ∂k−1(A) ≥ ∂k−2(A) ≥ ··· ≥ ∂0(A).
Lemma 2.2 For all A, B ∈ P(k, d) and every integer i ∈ {k − 1,k − 2,... , 0}, if A ⊆ B, then δ(∂i(A) − int(B), ∂(B)) = 0 for nonempty ∂i(A) − int(B); otherwise δ(∂i(A) − int(B), ∂(B)) ≤ δ(∂i+1(A) − int(B), ∂(B)).
Proof. Let A, B ∈ P(k, d) and i ∈ {k − 1,k − 2,... , 0} be arbitrary. If A ⊆ B, then:
∂i(A) − int(B)= ∂i(A) − (B − ∂(B)) = (∂i(A) − B) ∪ (∂i(A) − (Rk − ∂(B)))
= ∅∪ (∂i(A) − (Rk − ∂(B)))
(∂i(A) ⊆ A ⊆ B gives that ∂i(A) − B = ∅)
= ∂i(A) ∩ ∂(B) ⊆ ∂(B),
which gives that δ(∂i(A) − int(B), ∂(B)) = 0.
Now we assume that A − B /= ∅. Then the sets ∂i(A) − int(B), ∂i+1(A) − int(B), ∂(B) ∈ C(k, d) for each i ∈ {k − 1,k − 2,... , 0}, and both δ(∂i(A) − int(B), ∂(B)) and δ(∂i+1(A) − int(B), ∂(B)) exist. The lemma follows imme- diately from the observation that ∂i(A) − int(B) ⊆ ∂i+1(A) − int(B) for each i ∈ {k − 1,k − 2,... , 0} and the increasing monotonicity of δ in its first argument. 
Lemma 2.3 For all A, B ∈ P(k, d) and every integer i ∈ {k − 1,k − 2,... , 0}, if A ⊆ B, then δ(∂i(A) − int(B), ∂(B)) = 0 for nonempty ∂i(A) − int(B); otherwise δ(∂i+1(A) − int(B), ∂(B)) ≤ δ(∂i(A) − int(B), ∂(B)).
Proof. We proceed as in the proof of Lemma 2.2. Let A, B ∈ P(k, d) and i ∈ {k − 1,k − 2,... , 0} be arbitrary. Assume that A /⊆ B. Then ∂i(A) − int(B), ∂i+1(A) − int(B), ∂(B) ∈ C(k, d) for each i ∈ {k − 1,k − 2,... , 0}, and
both δ(∂i(A) − int(B), ∂(B)) and δ(∂i+1(A) − int(B), ∂(B)) exist. Denote r = δ(∂i(A) − int(B), ∂(B)) for notational simplicity. The desired inequality in the lemma is equivalent to: for every a ∈ ∂i+1(A) − int(B) (/= ∅), there exists b ∈ ∂(B) such that d(a, b) ≤ r. Let a ∈ ∂i+1(A) − int(B) be arbitrary. If a ∈ B, then let b = a and we have d(a, b)= d(a, a)= 0 ≤ r.
Consider that the point a ∈ (∂i+1(A) − int(B)) − B (= ∂i+1(A) − B /= ∅). Since (∂i+1(A) − int(B)) − B = ∂i+1(A) − B = (∪F (i+1)∈Fi+1 (A)F (i+1)) − B =
∪F (i+1)∈Fi+1(A)(F (i+1) − B), the point a ∈ F (i+1) − B for some (i + 1)-dimensional

face F (i+1) of A, which is a subpolytope of A. The boundary of F (i+1) (in (Ri+1, d)),
∂(i+1)(F (i+1)), is formed with the union of some i-dimensional faces of A, that is,
∂(i+1)(F (i+1)) = ∪G(i)∈F (A) and G(i) ⊆F (i+1) G(i). If the point a ∈ ∂(i+1)(F (i+1)) − B, then a ∈ G(i) for some i-dimensional face G(i) of A such that G(i) ⊆ F (i+1). Therefore, a ∈ ∂i(A) − int(B); it follows that there exists b ∈ ∂(B) such that d(a, b) ≤ δ(∂i(A) − int(B), ∂(B)) = r. Otherwise, the point a lies in the interior of F (i+1), that is, a ∈ (F (i+1) − ∂(i+1)(F (i+1))) − B. Then there exists a point a1 ∈ ∂(i+1)(F (i+1)) such that the line segment L(a1, a) with endpoints a1 and a is embedded in F (i+1) (that is, L(a1, a) ⊆ F (i+1)) and avoids B (that is, L(a1, a)∩B =

∅). Therefore, the point a1 ∈ H(i)
for some i-dimensional face H(i)
of A such

that H(i) ⊆ F (i+1). Together with the disjointedness L(a1, a) ∩ B = ∅, we have
a1 ∈ H(i) − B (⊆ ∂i(A) − int(B)).
The (sub)polytope F (i+1) embedding the line segment L(a1, a) is compact (in (Rk, d)), and when L(a1, a) is extended toward the endpoint a, the extended line segment intersects either the boundary of F (i+1) or the boundary of B; that is, there exists a2 ∈ ∂(i+1)(F (i+1)) ∪ ∂(B) such that the line segment L(a1, a2) is embedded in F (i+1) (that is, L(a1, a2) ⊆ F (i+1)), contains L(a1, a) as line subsegment, and avoids B except possibly at the endpoint a2 (that is, L(a1, a2) ∩ int(B)= ∅). We consider the two possible cases for a2 ∈ ∂(i+1)(F (i+1)) ∪ ∂(B).
Case when a2 ∈ ∂(i+1)(F (i+1)) ∩ ∂(B): For a1 ∈ ∂i(A) − int(B), there exists a point b1 ∈ ∂(B) with d(a1, b1) ≤ r. From the points a, a1, a2, and b1, we determine a point b ∈ ∂(B) such that d(a, b) ≤ r as desired. For the case when the two points a2 and b1 coincide, we have d(a1, a2) = d(a1, b1) ≤ r. Also, L(a1, a2) embeds the line subsegment L(a, a2), so d(a, a2) =  a − a2  ≤ a1 − a2  by considering the parametric representation of L(a1, a2). Hence, a2 ∈ ∂(B) is a desired point with d(a, a2) ≤ d(a1, a2) ≤ r.
For the case when a2 and b1 are distinct, note that the convexity of B gives that the line segment L(a2, b1) is contained in B. Locate the (unique) point b2 ∈ L(a2, b1) such that both points a and b2 have the same proportionate distances along L(a2, a1) and L(a2, b1), respectively, from their common endpoint a2, and satisfies that d(a, b2) ≤ d(a1, b1) ≤ r. The following lemma justifies the existence of a point b ∈ L(a, b2) ∩ ∂(B) with d(a, b) ≤ r.
Lemma 2.4 Let (X,  ) be a normed space and S be a nonempty subset of X. Then, for all points x ∈ S and y ∈ X − S, there exists a point z ∈ L(x, y) ∩ ∂(S) (where L(x, y) denotes the line segment with endpoints x and y) with  y − z  ≤  y − x  .
Proof. We first consider the two boundary cases in which the existence of such a point z is obvious: if x ∈ ∂(S) then let z = x, and if y ∈ ∂(X − S) (= ∂(S)) then let z = y. In both cases, the point z satisfies the statement in the lemma.
Consider the general case when x ∈ int(S) and y ∈ int(X − S). Let lxy : [0, 1] → L(x, y) be the parametric representation of the line segment L(x, y), that is, lxy(t)= (1 − t)x + ty for t ∈ [0, 1].
We introduce the notion of connectedness for metric spaces [4], which is applied

to show that L(x, y) ∩ ∂(S) /= ∅. A metric space M is called disconnected if M = M1 ∪ M2 for some disjoint nonempty open subsets M1 and M2 of M ; M is connected if it is not disconnected. A subset M ' of M is called connected if, when regarded as a metric subspace of M , is a connected metric space.
The closed unit interval [0, 1] is connected in R with the standard Euclidean metric. The parametric representation lxy : [0, 1] → L(x, y), when considered as a function from the metric space [0, 1] with the standard Euclidean metric to the metric space (L(x, y), d), is continuous on its domain [0, 1]. Since a continuous function preserves connectedness, the image of [0, 1] under lxy, that is, lxy([0, 1]) = L(x, y), is connected.
Suppose the contrary that L(x, y) ∩ ∂(S)= ∅. Then L(x, y) can be decomposed into the disjoint union of two subsets (of L(x, y)):
L(x, y)= (L(x, y) ∩ int(S)) ∪ (L(x, y) ∩ ∂(S)) ∪ (L(x, y) ∩ int(X − S))
= (L(x, y) ∩ int(S)) ∪ (L(x, y) ∩ int(X − S)).
Notice that both subsets L(x, y) ∩ int(S) and L(x, y) ∩ int(X − S) of L(x, y) are nonempty — containing the points x and y, respectively, and open in the metric space (L(x, y), d). This contradicts that (L(x, y), d) is connected; therefore L(x, y)∩
∂(S) /= ∅. Let z be a point in L(x, y) ∩ ∂(S) and tˆ ∈ [0, 1] be its parametric value, that is, lxy(tˆ)= (1 − tˆ)x + tˆy = z. Then,
y − z  = y − ((1 − tˆ)x + tˆy)  =  (1 − tˆ)y − (1 − tˆ)x  ≤  y − x  ,
which indicates that z is a desired point for the statement in Lemma 2.4.	 
Applying Lemma 2.4 to the points a and b2 yields a desired point b ∈ L(a, b2) ∩
∂(B) with d(a, b) =  a − b  ≤ a − b2  = d(a, b2) ≤ r. See Figure 1(a) for the locations of the points a, a1, a2, b1, b2, and b relative to F (i+1) and ∂(B).
Case when a2 ∈ ∂(i+1)(F (i+1)) − ∂(B): Just as for the point a1 ∈ ∂(i+1)(F (i+1)),
the point a2 ∈ H(i) for some i-dimensional face H(i) of A such that H(i) ⊆ F (i+1).
2	2	2
Together with the disjointedness L(a1, a2) ∩ int(B)= ∅, we have a2 ∈ H(i) − B (⊆
∂i(A) − int(B)). For the two points a1 and a2 in ∂i(A) − int(B), they correspond to two points b1 and b2, respectively, in ∂(B) such that d(a1, b1) ≤ r and d(a2, b2) ≤ r. If the two points b1 and b2 coincide, then we claim that b1 (= b2) is a desired point with d(a, b1) ≤ r. To see this, denote the parametric representation of the line segment L(a1, a2) by la1 a2 : [0, 1] → L(a1, a2) defined by la1 ,a2 (t)= (1 − t)a1 + ta2
for t ∈ [0, 1]. Let tˆ∈ [0, 1] be the parametric value for the point a ∈ L(a1, a2), that
is, la1 ,a2 (tˆ)= (1 − tˆ)a1 + tˆa2 = a. Then, we have:
d(a, b1)=  a − b1  =  ((1 − tˆ)a1 + tˆa2) − b1 
=  (1 − tˆ)(a1 − b1)+ tˆ(a2 − b1)  ≤ (1 − tˆ)  a1 − b1  + tˆ a2 − b1 
= (1 − tˆ)d(a1, b1)+ tˆd(a2, b1) ≤ (1 − tˆ)r + tˆr = r.
We now assume that the two points b1 and b2 are distinct. Since B is convex, the line segment L(b1, b2) ⊆ B. Consider the parametric representations of the two line segments L(a1, a2) and L(b1, b2): la1 a2 : [0, 1] → L(a1, a2) defined by la1 a2 (t)= (1 − t)a1+ta2 and lb1 b2 : [0, 1] → L(b1, b2) defined by lb1,b2 (t)= (1−t)b1+tb2, respectively,




b1





F (i+1)



L(a ,a )

b	b2
B

a2 ∈ ∂(i+1)(F (i+1)) ∩ ∂(B)

1  2
a ∈ H(i) − B a ∈ F (i+1) − B



(a)










F (i+1)



(b)
Fig. 1. (a) The case when a ∈ (∂i+1(A)−int(B))−B (a ∈ F (i+1) −B), a1 ∈ ∂(i+1)(F (i+1)) (a1 ∈ H(i) −B),
and a2 ∈ ∂(i+1)(F (i+1)) ∩ ∂(B): d(a, a2) ≤ d(a1, a2) ≤ r or else d(a, b) ≤ d(a, b2) ≤ d(a1, b1) ≤ r;
(b) The case when a  ∈ (∂i+1(A) − int(B)) − B (a  ∈ F (i+1) − B), a1 ∈ ∂(i+1)(F (i+1))
(a1 ∈ H(i) − B), a2 ∈ ∂(i+1)(F (i+1)) (a1 ∈ H(i) − B), b1, b2 ∈ ∂(B), b3 ∈ B, and b ∈ ∂(B):
1	2
d(a, b) ≤ (1 − tˆ)d(a1, b1)+ tˆd(a2, b2) ≤ r, where tˆ is the parametric value for the point a ∈ L(a1, a2).


for t ∈ [0, 1]. Let tˆ∈ [0, 1] be the parametric value for the point a ∈ L(a1, a2), that is, la1 a2 (tˆ) = (1 − tˆ)a1 + tˆa2 = a. Then, locate the (unique) point b3 ∈ L(b1, b2) corresponding to the parametric value tˆ, that is, lb1 b2 (tˆ)= (1 − tˆ)b1 + tˆb2 = b3, and notice that:
a − b3  =  ((1 − tˆ)a1 + tˆa2) − ((1 − tˆ)b1 + tˆb2) 
=  (1 − tˆ)(a1 − b1)+ tˆ(a2 − b2)  ≤ (1 − tˆ)  a1 − b1  + tˆ a2 − b2 
= (1 − tˆ)d(a1, b1)+ tˆd(a2, b2) ≤ (1 − tˆ)r + tˆr = r.
Therefore, the two points a ∈ F (i+1)−B (⊆ ∂i+1(A)−int(B)) and b3 ∈ L(b1, b2) ⊆ B satisfy that d(a, b3)= a − b3  ≤ r. Applying Lemma 2.4 to these two points a and b3 yields a desired point b ∈ L(a, b3) ∩ ∂(B) with d(a, b) = a − b  ≤ a − b3  = d(a, b3) ≤ r. This completes the proof of the case when a2 ∈ ∂(i+1)(F (i+1)) − ∂(B). See Figure 1(b) for the locations of the points a, a1, a2, b1, b2, b3, and b relative to F (i+1), ∂(B), and B.
Combining the two cases, Lemma 2.3 is proved.	 

Theorem 2.5 For all A, B ∈ P(k, d),
δ(A, B)= ⎧⎨ 0	if A ⊆ B
⎩ δ(∂0(A) − int(B), ∂(B)) otherwise,

and
⎧⎪ 0	if A = B
Δ(A, B)= ⎪⎨ δ(∂0(A) − int(B), ∂(B))	if B Ç A
δ(∂0(B) − int(A), ∂(A))	if A Ç B
⎪⎪⎩ max{δ(∂0(A) − int(B), ∂(B)), δ(∂0(B) − int(A), ∂(A))}  otherwise.

Proof. Let A, B ∈ P(k, d). If A ⊆ B, then δ(A, B) = 0. Otherwise, for A /⊆ B, Lemmas 2.2 and 2.3 give that δ(∂i+1(A) − int(B), ∂(B)) = δ(∂i(A) − int(B), ∂(B)) for every integer i ∈ {k − 1,k − 2,... , 0}. An induction argument on i shows that δ(∂k−1(A) − int(B), ∂(B)) = δ(∂0(A) − int(B), ∂(B)). Hence,
δ(A, B)= δ(∂(A) − int(B), ∂(B))  (by Theorem 2.1)
= δ(∂k−1(A) − int(B), ∂(B))	(∂k−1(A)= ∂(A))
= δ(∂0(A) − int(B), ∂(B)),
and this gives rise to the functional form of Δ(A, B) in the theorem.	 

Relating the Metrics under Corner Transformation
Denote by R(k, dp) the set of all k-dimensional (closed rectilinear) hyperrectangles in the normed space (Rk,  p), where dp is a p-normed metric induced by  p for an arbitrary real number p ≥ 1. The three spaces R(k, dp), P(k, dp), and C(k, dp), when equipped with an appropriately restricted Δ, form an ascending chain of metric spaces: (R(k, dp), Δ|R(k,dp)×R(k,dp)) Ç (P(k, dp), Δ|P(k,dp)×P(k,dp)) Ç (C(k, dp), Δ).
Translating Theorem 2.5 in the context of (R(k, dp), Δ), the computation of δ(A, B), where A, B ∈ R(k, dp) with A /⊆ B, is the maximum dp-distance from a vertex a ∈ ∂0(A)−B to a boundary point b ∈ ∂(B) (= ∪F ∈F(B)F ), that is, δ(A, B)= max{min{dp(a, b) | b ∈ ∂(B)} | a ∈ ∂0(A) − B}. We can further limit the candidate boundary points b for every a ∈ ∂0(A) − B by considering the facial structure of
∂(B) as follows. Each i-dimensional face F (i) of B, where i ∈ {0, 1,... ,k − 1}, is embedded in a (unique) i-dimensional affine hull aff (F (i)). The (unique) point
b ∈ aff (F (i)) that gives dp(a, b) = d'	(a, aff (F (i))) = inf{dp(a, c) | c ∈ aff (F (i))}
is the projection of a onto aff (F (i)). Note that the point b may not necessarily
be in F (i). Hence, the point b ∈ F (i) yielding dp(a, b) = d' (a, F (i)) is either a
boundary point of F (i) (that is, b ∈ ∂(i)(F (i))) or the projection of a onto aff (F (i)). The former case b ∈ ∂(i)(F (i)) (= ∪G(i−1) ∈Fi−1 (B) and G(i−1) ⊆F (i) G(i−1)) implies that b ∈ G(i−1) for some (i − 1)-dimensional face of B embedded in F (i), which can be resolved recursively. The basis when i = 0 corresponds to singleton face/vertex F (0), which must be the candidate point b. In summary,

δ(A, B)=	max
a∈∂0(A)−B
min{dp(a, b) | b ∈ ∂0(B), or b ∈ ∂(B) that is the projection
of a onto aff (F ) for some face F of B with positive dimension}.

We identify the three functional components of the corner transformation in the notations introduced thus far, and present a tight relationship between the under- lying metrics on the domain and codomain under the transformation. The metric space (R(k, d(k)), Δ) constitutes the original space of the corner transformation κ,
where d(k) is the p-normed metric induced by  p on Rk. The transform space under
κ is Hk, where the half-plane H = {(l, u) ∈ R2 | l ≤ u}; so it is effectively a met-

ric subspace of (R2k, d(2k)) with the p-normed metric d(2k) induced by
on R2k.

p	p	p
Formally, the corner transformation κ is defined as follows: for every hyperrectangle

k
i=1
[li, ui], where li and ui denote the lower and upper limits, respectively, of its

spatial extent in the i-th dimension, κ(  k
[li, ui]) = (l1, u1, l2, u2,... , lk, uk).

Theorem 3.1 For all A, A'	∈	R(k, d(k)), if A	=	A', then Δ(A, A')	=
d(2k)(κ(A), κ(A')) = 0, otherwise Δ(A, A') ≤ d(2k)(κ(A), κ(A')) (the inequality rela-
p	p
tionship is independent of the dimensionality).
Proof. First we consider the following equivalences:
for all A, A' ∈ R(k, d(k)), Δ(A, A') ≤ d(2k)(κ(A), κ(A')),
p	p
equivalent to: for all A, A' ∈ R(k, d(k)), δ(A, A') ≤ d(2k)(κ(A), κ(A')), and for all
p	p
A, A' ∈ R(k, d(k)), δ(A', A) ≤ d(2k)(κ(A), κ(A')),
p	p
(due to the maximization of Δ(A, A')= max{δ(A, A'), δ(A', A)}),
equivalent to: for all A, A' ∈ R(k, d(k)), δ(A, A') ≤ d(2k)(κ(A), κ(A'))
p	p
(due to the symmetry of d(2k)),
equivalent to: for all A, A'	∈	R(k, d(k)),	δ(∂ (A) − int(A'), ∂(A'))	≤
p	0
d(2k)(κ(A), κ(A'))
(applying Theorem 2.5 in the context of (R(k, d(k)), Δ)), equivalent to: for all A, A' ∈ R(k, d(k)), and for every a ∈ ∂ (A) − A', there exists
p	0
a' ∈ ∂(A') such that d(k)(a, a') ≤ d(2k)(κ(A), κ(A'))
p	p
(by the definition of δ(∂0(A)−int(A'), ∂(A')) = sup{d'  (a, ∂(A')) |

a ∈ ∂0(A) − int(A')}).
Let A, A' ∈ R(k, d(k)) be arbitrary with A − A' /= ∅, and write A =  k

[l ,u ]

(where li ≤ ui for i ∈ {1, 2,... , k}) and A' =  k  [l', u' ] (where l' ≤ u'
for i ∈

{1, 2,... , k}). Then d(2k)(κ(A), κ(A')) = κ(A) − κ(A')  p
k i=1
(|li
— l'|p + |ui −

u' |p
1
)) p .

Consider an arbitrary a ∈ ∂0(A) − A' (/= ∅), that is, a is a vertex of the hy-
perrectangle A =  k  [li, ui]. Write a = (a1, a2,... , ak), where ai ∈ {li, ui} for

i = 1, 2,... , k. Corresponding to the point a ∈ ∂0(A), there exists a (unique) point
a' = (a' , a' ,... , a' ) ∈ ∂0(A') such that:

1	2	k

a' =
,⎨ l'

if ai = li


for i = 1, 2,... , k. Observe that:
k
, u' if ai = ui

d(k)(a, a')=  a − a' 	= (Σ |a − a' |p) 1
p	p	i	i	p
i=1
k
≤ (Σ(|l − l'|p + |u − u' |p)) 1

i	i
i=1
i	i	p

(for i = 1, 2,... , k, ai = li and a' = l', or ai = ui and a' = u')
i	i	i	i
=  κ(A) − κ(A')  p = d(2k)(κ(A), κ(A')),
and the theorem is proved.	 
The following example shows that the inequality in Theorem 3.1 is tight. Con- sider two k-dimensional hypercubes A and A' in R(k, d(k)) with side-lengths of s
and s', respectively:
A = [0, s]k = {(x1, x2,... , xk) ∈ Rk | 0 ≤ xi ≤ s for i ∈ {1, 2,... , k}}
∂0(A)= {0, s}k,
and
A' = [−s', 0]k = {(x1, x2,... , xk) ∈ Rk | −s' ≤ xi ≤ 0 for i ∈ {1, 2,... , k}}
∂0(A')= {−s', 0}k.
Then we have:
For Δ(A, A'):	δ(A, A') = d(k)((s, s,... , s), (0, 0,... , 0)) =	(s, s,... , s) −

1
(0, 0,... , 0)
'	1 '
These give that

p  = k p s, and similarly, δ(A , A) = k p s .
'	1	'
Δ(A, A )= k p max{s, s }.
For d(2k)(κ(A), κ(A')): The image points of A and A' under κ are: κ(A) = (0, s, 0, s,... , 0, s) and κ(A') = (−s', 0, −s', 0,... , −s', 0), which give that

d(2k)
'	1	'p	p 1

p	(κ(A), κ(A )) = k p (s  + s ) p .

When s' is sufficiently less than s, we have Δ(A, A') ≈
1
k p s
≈ d(2k)(κ(A), κ(A')).

This indicates that the coefficient of 1 in the inequality 1 · Δ(A, A')	≤
d(2k)(κ(A), κ(A')) can not increase and is optimal. Figure 2(a) shows the geom- etry of A and A' in the case of R3.
Theorem 3.2 For all A, A' ∈ R(k, d(k)), if A = A', then d(2k)(κ(A), κ(A')) =
p	p
Δ(A, A')= 0, otherwise d(2k)(κ(A), κ(A')) ≤	'


p
is independent of the dimensionality).
4 p Δ(A, A ) (the inequality relationship

Proof. Consider two arbitrary hyperrectangles A, A' ∈ R(k, d(k)) with A − A' /= ∅:

A =  k
[l ,u ] and A' =  k
[l', u'], and d(2k)(κ(A), κ(A')) = (Σk
(|l
— l'|p +

i=1 i	i
1
|u − u' |p
i=1 i	i	p
i=1	i	i

i	i )) p . Our strategy in proving the desired inequality is to organize the
summation Σk	|li − l'|p into two subsummations, based on the algebraic sign of
li − l' for i = 1, 2,... , k, and show that each subsummation is bounded above by
Δ(A, A')p, and likewise for the summation Σk	|ui − u' |p.
Partition the index set {1, 2,... , k} into three subsets: I< = {i ∈ {1, 2,... , k} | 
li < l'}, I= = {i ∈ {1, 2,... , k} | li = l'}, and I> = {i ∈ {1, 2,... , k} | li > l'}, so

i
k
i=1
|li − l'|p = Σ

i∈I<
i
' p
i	i∈I>
i
|li − l'|p.

Proof of Σ	|li − l'|p ≤ δ(A, A')p (≤ Δ(A, A')p):  Since li < l' for every
i ∈ I<, we have A /⊆ A'. By Theorem 2.5, δ(A, A') = δ(∂0(A) − int(A'), ∂(A')) =
sup{d' (a, ∂(A')) | a ∈ ∂0(A) − int(A')}.	Therefore, it suffices to show that
Σ	|li − l'|p ≤ d' (a, ∂(A')) for some a ∈ ∂0(A) − int(A').	In fact, we
prove a stronger statement:	Σ	|li − l'|p ≤ d' (a, ∂(A')) for every point
a = (a1, a2,... , ak) ∈ ∂0(A) − int(A') with ai = li for every i ∈ I< (note that
such a point a exists due to A =  k  [li, ui] and A' =  k  [l', u' ], and the defini-

i=1
tion of I< = {i ∈ {1, 2,... , k} | li < l'}.
i=1 i	i

Consider arbitrary points a = (a1, a2,... , ak) ∈ ∂0(A) − int(A') with ai = li
for every i ∈ I<, and a' = (a' , a' ,... , a' ) ∈ ∂(A'). For every i ∈ I<, the i-th
1	2	k
coordinate of a', a', must lie within the i-th spatial extent [l', u'], that is, (ai = li <)
i	i	i
l' ≤ a' ≤ u'. Therefore, we have:
i	i	i
k
Σ |li − l'|p = Σ |ai − l'|p ≤ Σ |ai − a' |p ≤ Σ |ai − a' |p = d(k)(a, a')p;

i∈I<
i
i∈I<
i
i∈I<
i	i	p
i=1

that is, for every a ∈ ∂ (A) − int(A'), Σ
|l − l'|p ≤ d(k)(a, a')p for every a' ∈

∂(A'). Hence, Σ
0
|li − l'|p ≤ d'
i∈I<  i	i	p
(a, ∂(A')).

Σ Proof of Σ

i∈I>
|li − l'|p ≤ δ(A', A)p (≤ Δ(A, A')p): Similarly, we prove that

|li − l'|p ≤ d'  (a', ∂(A)) for every point a' = (a' , a' ,... , a' ) ∈ ∂0(A')− int(A)

i∈I>	i
inf
1	2	k

with a' = l' for every i ∈ I>.
i	i
Combining the two cases, we obtain that:
Σ |li − l'|p = Σ |li − l'|p + Σ |li − l'|p ≤ 2Δ(A, A')p.

i=1
i
i∈I<
i	i
i∈I>

Applying an analogous argument to the index set of Σk
|ui − u' |p yields that

k i=1
|ui − u' |p ≤ 2Δ(A, A')p. Therefore,

d(2k)(κ(A), κ(A')) = (Σ(|l − l'|p + |u
— u' |p)) 1

p	i	i
i=1
' p 1
i	i	p

1	'

≤ (4Δ(A, A ) ) p = 4 p Δ(A, A ),
as desired.	 
The inequality in Theorem 3.2 is also tight. Consider two k-dimensional hyper- rectangles A, A' ∈ R(k, d(k)): for a positive real number r,

A = [−2r, 2r] × (  k  [−r, r])
= {(x1, x2,... , xk) ∈ Rk | −2r ≤ x1 ≤ 2r, and
−r ≤ xi ≤ r for i ∈ {2, 3,... , k}}
∂0(A)= {−2r, 2r}× {−r, r}k−1,
and
A' = ( k−1[−r, r]) × [−2r, 2r]
= {(x1, x2,... , xk) ∈ Rk | −r ≤ xi ≤ r for i ∈ {1, 2,... ,k − 1}, and
−2r ≤ xk ≤ 2r}
∂0(A')= {−r, r}k−1 × {−2r, 2r}.
Then we have:
For d(2k)(κ(A), κ(A')): The image points of A and A' under κ are: κ(A) = (−2r, 2r, −r, r, −r, r, . . . , −r, r) and κ(A') = (−r, r, −r, r,... , −r, r, −2r, 2r),
which give that d(2k)	'
p	(κ(A), κ(A )) = 4 p r.
For	Δ(A, A'):	δ(A, A')	=	d(k)((2r, r, r,... , r, r), (r, r, r,... , r, r))	=
(2r, r, r,... , r, r) −  (r, r, r,... , r, r)  p	=	r,	and	δ(A', A)	=
d(k)((r, r, r,... , r, 2r), (r, r, r,... , r, r))	=	(r, r, r,... , r, 2r)	−
(r, r, r,... , r, r)  p = r. These give that Δ(A, A')= r.
'	1	(2k)	'
Then the equality in the theorem holds for A and A : 4 p r = dp	(κ(A), κ(A )) =
1	'	1	'	3
4 p Δ(A, A )= 4 p r. Figure 2(b) shows the geometry of A and A in the case of R .
Corollary 3.3 For every real number p ≥ 1 and positive integer k, and for all
A, A' ∈ R(k, d(k)), if A = A', then Δ(A, A')= d(2k)(κ(A), κ(A')) = 0, otherwise:

p



when p is sufficiently large:
p
d(2k)(κ(A), κ(A')) 1 ≤	Δ(A, A')

1


≤ 4 p ;



Conclusion
d(2k)(κ(A), κ(A')) Δ(A, A')
≈ 1.

A distance metric for spatial objects provides a formal basis for analytical work in transformation-based multidimensional spatial access methods, including locality preservation of the underlying transformation and distance-based spatial queries. A locality-preservation study of the corner transformation can complement recent advances and success in such transformation-based spatial access methods [10] [8]
[9] and the ones for transformation-based multidimensional space-filling indexing methods [2] [5] [6].
For two hyperrectangles A, A' ∈ R(k, d(k)), the distance measure δ(A, A') in the Hausdorff distance Δ(A, A') computes the maximum of all minimum vertex-vertex



(a)

(b)
Fig. 2.	(a) The two cubes A and A' in R(3, d(3)) with A  = [0, s]3 and A'  = [−s', 0]3:
1	1	1
Δ(A, A')= 3 p max{s, s'} and d(6)(κ(A), κ(A')) = 3 p (s'p + sp) p ; (b) The two hyperrectangles A and A' in
1
R(3, d(3)) with A = [−2r, 2r] ×[−r, r] ×[−r, r] and A' = [−r, r] ×[−r, r] ×[−2r, 2r]: d(6)(κ(A), κ(A')) = 4 p r
p	p
and Δ(A, A')= r.
distances and vertex-face projective distances, which yields a close relationship be- tween Δ and d(2k) (the inequality relationship is independent of the dimensionality):

'	(2k)
'	1	'


that is,
Δ(A, A ) ≤ dp	(κ(A), κ(A )) ≤ 4 p Δ(A, A ),

d(2k)(κ(A), κ(A')) 1 ≤	Δ(A, A')
1

≤ 4 p ,

in which each equality holds for an example in R(k, d(k)). The ratio of d(2k) to Δ lies
p	p
1
in the interval [1, 4 p ] that contracts from [1, 4] to the single point 1 as p increases
from 1 to ∞.
The tight relationship between d(2k) and Δ reflects a very high degree of locality preservation exhibited by the corner transformation κ: close-by (with respect to Δ) hyperrectangles are mapped by κ to close-by (with respect to d(2k)) points and vice versa. A practical implication of the tight Δ-d(2k) relationship on the κ-

based transformation is that it provides good bounds on measuring the loss in point locality in the transform space while spatial correlation exists in the original space
1
(worst-case loss factor of 4 p ) and vice versa (worst-case loss factor of 1).

References
Agarwal, P. K., S. Har-Peled, M. Sharir and Y. Wang, Hausdorff distance under translation for points, disks, and balls, in: Proceedings of the Nineteenth Annual ACM Symposium on Computational geometry, 2003, pp. 282–291.
Alber, J. and R. Niedermeier, On multi-dimensional curves with Hilbert property, Theory of Computing Systems 33 (2000), pp. 295–312.
Alt, H., P. Braß, M. Godau, C. Knauer and C. Wenk, Computing the Hausdorff distance of geometric patterns and shapes, in: B. Aronov, S. Basu, J. Pach and M. Sharir, editors, Discrete and Computational Geometry. The Goodman–Pollack Festschrift, Algorithms and Combinatorics 25, Springer, Berlin, 2003
pp. 65–76.
Apostol, T. M., “Mathematical Analysis (Second Edition),” Addison-Wesley, Reading, Massachusetts, 1974.
Dai, H. K. and H. C. Su, Approximation and analytical studies of inter-clustering performances of space- filling curves, in: Proceedings of the International Conference on Discrete Random Walks (Discrete Mathematics and Theoretical Computer Science, Volume AC (2003)), 2003, pp. 53–68.
Dai, H. K. and H. C. Su, On p-norm based locality measures of space-filling curves, in: R. Fleischer and G. Trippen, editors, Lecture Notes in Computer Science (3341): Algorithms and Computation: 15th International Symposium, ISAAC 2004 Proceedings, Springer-Verlag, Berlin Heidelberg, 2004,
pp. 364–376.
Godau, M., On the complexity of measuring the similarity between geometric objects in higher dimensions. Ph.D. Dissertation, Department of Computer Science, Freie Universita¨t Berlin (1998).
Lee, M.-J., K.-Y. Whang, W.-S. Han and I.-Y. Song, Adaptive row major order: a new space filling curve for efficient spatial join processing in the transform space, Journal of Systems and Software 78 (2005), pp. 257–269.
Lee, M.-J., K.-Y. Whang, W.-S. Han and I.-Y. Song, Transform-space view: performing spatial join in the transform space using original-space indexes, IEEE Transactions on Knowledge and Data Engineering 18 (2006), pp. 1–16.
Song, J.-W., K.-Y. Whang, Y.-K. Lee, M.-J. Lee, W.-S. Han and B.-K. Park, The clustering property of corner transformation for spatial database applications, Information & Software Technology 44 (2002),
pp. 419–429.
