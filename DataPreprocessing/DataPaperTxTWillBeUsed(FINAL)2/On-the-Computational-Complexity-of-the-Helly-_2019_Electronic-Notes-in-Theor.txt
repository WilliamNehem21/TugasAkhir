Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 346 (2019) 285–297
www.elsevier.com/locate/entcs


On the Computational Complexity of the Helly Number in the P3 and Related Convexities 1
Moisés. T. Carvalhoa,2 Simone Dantasb,2 Mitre C. Douradoc,2 Daniel F. D. Posnerd,2 Jayme L. Szwarcfiterc,d,e,2


a Instituto Benjamin Constant Rio de Janeiro - RJ, Brazil

c Instituto de Matemática
d Programa de Engenharia de Sistemas e Computação
Universidade Federal do Rio de Janeiro Rio de Janeiro - RJ, Brazil

b Instituto de Matemática e Estatística Universidade Federal Fluminense Niterói - RJ, Brazil

e Instituto de Matemática e Estatística Universidade do Estado do Rio de Janeiro Rio de Janeiro - RJ, Brazil



Abstract
Given a graph G, the P3-convex hull (resp. P∗-convex hull ) of a set C ⊆ V (G) is obtained by iteratively adding to C vertices with at least two neighbors inside C (resp. at least two non-adjacent neighbors inside C). A P3-Helly-independent (resp. P∗-Helly-independent) of a graph G is a set S ⊆ V (G) such that
the intersection of the P -convex hulls3(P∗-convex hulls) of S \ {v} (∀v ∈ S) is empty. We denote by
3	3
P3-Helly number (resp. P∗-Helly number) the size of a maximum P3-Helly-independent (resp. P∗-Helly-
3	3
independent). The edge counterparts of these two P3-Helly-independents follow the same restrictions applied to its edges. The vp3hi (resp. vsp3hi, ep3hi, and esp3hi) problem aims to determine the P3-Helly number (resp. P∗-Helly number, edge P3-Helly number, and edge P∗-Helly number) of a graph. We establish the
3	3
computational complexities of vp3hi, vsp3hi, ep3hi, and esp3hi for a collection of graph classes, including
bipartite graphs, split graphs, and join of graphs.
Keywords: algorithms and computational complexity; cliques, dominating and independent sets;
P3-Helly-independent.


Introduction
A natural application of the study of Helly properties on the P3-convexities is to verify the safety of networks against a set of cascading failure errors. Figure 1 depicts a grid network. Let S = {a, b, c, d} be a set of possible defective stations of

1 This study was financed in part by the Coordenação de Aperfeiçoamento de Pessoal de Nível Superior - Brasil (CAPES) - Finance Code 001, CNPq and FAPERJ (Brazilian research agencies)
2 Email:	moises.ifrj@gmail.com, sdantas@id.uff.br, mitre@nce.ufrj.br, posner@cos.ufrj.br, jayme@nce.ufrj.br.

https://doi.org/10.1016/j.entcs.2019.08.026
1571-0661/© 2019 The Author(s). Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).


Table 1
Complexities of vp3hi, vsp3hi, ep3hi, and esp3hi.

the network and Sj be the four proper subsets of S with size |S|− 1. A cascading failure in this network affects every station that shares information with other two defective stations. Each cascading failure can be seen as a layer of the P3-convex hull applied to a set in Sj. If S is a P3-Helly-independent set, then no station is



S={a, b, c, d}
P3-convex Hulls

 

S \ {a}
S \ {b}
S \ {c}
S \ {d}

Fig. 1. A set of cascading failure errors in a grid network.

affected by all four cascading failure errors given by the sets of Sj. Therefore, we may design the stations so they continue to work in a safe mode considering they are not affected by a total critical failure.
Different convexities on graphs are studied extensively [2,4,5] due to their wide number of applications, including distributed systems [14], social networks, and mar- keting strategies [9]. Moreover, the Helly property on graphs has been studied quite intensively in the past [3]. The problem we address considers the Helly property on the P3-convexity of a graph. This paper is the first systematic study of the computa-
tional complexities of P3-Helly-independent problems. We present graph classes for which the computational complexities of vp3hi, ep3hi, vsp3hi completely diverge
in regard of the P versus NP-hard dichotomy (See Table 1). We also establish rela- tions between the Helly number parameters in the P3 and related convexities with known graph parameters for an arbitrary graph G: size of a maximum independent set α(G), minimum dominating set γ(G), minimum independent dominating set ι(G), maximum induced matching β∗(G), and maximum clique ω(G).
This paper is organized as follows. Section 2 contains notations, restrictions, and properties of P3-Helly-independent problems used in our proofs. Sections 3, 4, and 5 contain 25 results on the computational complexities of all four vp3hi, ep3hi, vsp3hi, and esp3hi problems for subclasses of bipartite graphs, split graphs, and join of graphs, respectively (See Table 1 for a detailed description). We relate the parameter α(G) for an arbitrary graph G with hP3 for a subclass of bipartite graphs (Section 3) and a subclass of split graphs (Section 4); γ(G) for an arbitrary graph
G with hj	for a subclass of bipartite graphs (Section 3); and β∗(G) and ω(G) for
an arbitrary graph G with hj	and hP ∗ for subclasses of join of graphs (Section 5).

P3-Helly-independent problems
Throughout this paper we only consider simple graphs. Given a graph G, the P3- convex hull (resp. P∗-convex hull ) of a set C ⊆ V (G) is obtained by iteratively adding to C vertices with at least two neighbors inside C (resp. at least two non- adjacent neighbors inside C). A set of vertices S ⊆ V (G) of a graph G is a P3- Helly-independent (resp. P∗-Helly-independent) if and only if (restriction (i)) the intersection of the P3-convex hulls (resp. P∗-convex hulls) of S \ {v} (for all v ∈ S)
3
is empty, i.e.,	T (P3-convex hull of S \ {v}) = ∅ [resp.	T (P∗-convex hull of
6v∈S	6v∈S
S \ {v})= ∅]. For the sake of convenience, we also consider a weaker restriction: if
S is a P3-Helly-independent set (P∗-Helly-independent set), then (restriction (ii))
∀v ∈ S, the P3-convex hull (resp. P∗-convex hull) of S \ {v} does not contain v.
Hereinafter, we denote restriction (i) for P3-Helly-independent set (resp. P∗- Helly-independent set) by vertex restriction 1 (resp. star restriction 1) and restriction (ii) for P3-Helly-independent set (resp. P∗-Helly-independent set) by vertex restriction 2 (resp. star restriction 2). We denote by P3-Helly number (P∗-Helly number ) the size of a maximum P3-Helly-independent set (resp.  P∗-
3	3
Helly-independent set ). The edge counterparts of these two P3-Helly-independent
problems follow the same restrictions applied to its edges. The vp3hi (resp. vsp3hi,
ep3hi, and esp3hi) problem aims to determine the P3-Helly number hP3 (resp. P -
∗
Helly number hP ∗ , edge P3-Helly number hj , and edge P∗-Helly number hj ∗ ) of a 

3
graph.
P3	3	P3

Note that the edge restrictions of ep3hi (resp. esp3hi) for a graph G are directly related to the vertex restrictions of vp3hi (resp. esp3hi) for L(G), the line graph of
G. Therefore, hj (G) = hP (L(G)) (resp. hj ∗ (G) = hP ∗ (L(G))). Throughout the

P3	3
P3	3

text we only consider simple connected graphs, since hP
(resp. hP ∗ , hj , and hj ∗ )

3	3	P3	P3
of a disconnected graph G is the sum of the parameters on its connected components.
Remark 2.1 The computational complexity of ep3hi (resp. esp3hi) for a graph class C is the same of vp3hi (resp. vsp3hi) for a graph class Cj consisting of the line graphs of graphs of C.
When we say that a configuration is forbidden, we are considering not only the subgraph, but also the elements of the subgraph used in the P3-Helly-independent problems. There are some trivial forbidden configurations displayed in Figure 2 (the selected elements are represented by the red/bold color). In (a.1) v1 disre- spects vertex restriction 1; (a.2) v2 disrespects vertex restriction 2; (a.3) v3 disrespects vertex restriction 1 and; (a.4) both v4 and v5 disrespect vertex restriction 1. In (b.1) v2 disrespects star restriction 2 and; (b.2) no matter if v4 is picked, it disrespects star restriction 1 in all situations. In (c.1) e1 dis- respects edge restriction 2; (c.2) e2 disrespects edge restriction 1; (c.3) so does e3 and; (c.4) e4 disrespects edge restriction 2. In (d.1) e1 disrespects star edge restriction 2; (d.2) e2 disrespects star edge restriction 1 and; (d.3) e3 disrespects star edge restriction 2. Note that the forbidden configurations for P∗-Helly-independent sets are the only ones that require induced graphs, i.e., the


Fig. 2. Forbidden configurations for a P3 (resp. P∗, edge P3, and edge P∗)-Helly-independent sets.
3	3
addition of edges to the other forbidden configurations results in another forbidden configuration.
The edge P∗-Helly-independent sets have interesting properties: (Property ESP3HI 1) a set without the forbidden configurations (d.1), (d.2) and (d.3) is edge P∗-Helly-independent; (Property ESP3HI 2) An edge P∗-Helly-independent set
3	3
M has G[M ] as the union of star graphs and triangles. (Property ESP3HI 3)
if G /= K3, then there is a maximum edge P∗-Helly-independent set without tri- angles; (Property ESP3HI 4) |V (G)| − γ(G) ≥ hj ∗ (G) ≥ |V (G)| − ι(G) and;
3

(Property ESP3HI 5) hj ∗
3
is closed under induced subgraphs.  We also have

properties on bounds of the Helly number on P3-Helly-independent problems of a
graph G: (Property Bound 1) β∗(G) ≤ hj (G); (Property Bound 2) if G is
has no maximal cliques of size two, hj (G) = max{2, β∗(G)}; (Property Bound

hj (G) ≤ 14β∗(G). (Property Bound 4) if hP (G) (resp.. hj
(G), hP ∗ (G),

P3	3
P3	3

or hj ∗ (G)) is a constant, then vp3hi (resp. ep3hi, vsp3hi, or esp3hi) is in P.
3
(Property Bound 5) hP (G) ≤ 2α(G); (Property Bound 6) hj (G) ≤ 2α(G)
3	P3
and; (Property Bound 7) α(G2) ≤ hP (G) (where G2 is the square graph of G).
Bipartite Graphs
Let Gj be the graph obtained from a graph G by adding a true twin vertex for each of its degree one vertices. Note that Gj has minimum degree at least two, and that α(G)= α(Gj), and γ(G)= γ(Gj). Hereinafter, consider only graphs with the addition of a true twin vertex for each degree one vertex.
Theorem 3.1 vp3hi is NP-hard for bipartite graphs.
Proof. We show a polynomial time transformation from NP-hard mis problem [7] to vp3hi for bipartite graphs. The construction is similar to the hardness proof of mis for square of bipartite graphs [6]. Consider a graph G with α(G) ≥ 5, a modified instance of the mis problem. Let H be the graph with: V (H) = V (G) ∪ E(G) ∪
{u1, u2, u3, u4}; ∀uv ∈ E(G), add edges {u uv, v uv} in E(H); add all edges between u1 and E(G)-vertices of H; add all edges between u2 and E(G)-vertices of H and; add edges {u1u3, u2u4}. There is a P3-Helly-independent set of H with size α(G)+2 using u3, u4 (which have distance three to all V (G)-vertices) and the V (G)-vertices of a maximum independent set of G, which have distance four among them in H.
We have at most four vertices of {u1, u2, u3, u4}∪ E(G) in any maximum P3- Helly-independent S of H or we have a forbidden configuration (a.1) or (a.2). Since

hP3 (H) ≥ α(G)+2 ≥ 7, there are at least three V (G)-vertices in S. There are no three E(G)-vertices in S or one of them implies a vertex restriction 2 contradic- tion. Moreover, u1 or u2 does not belong to S with three other V (G)-vertices in it. Otherwise, two of these V (G)-vertices in S are incident to a same E(G)-vertex and we have a forbidden configuration (a.1) or two of the V (G)-vertices in S include all E(G)-vertices in the P3-convex-hull, which implies a vertex-restriction 2 contra- diction with the third V (G)-vertex in S, since the degrees of V (G)-vertices are at least two.
The remaining cases occurs when we have two or one E(G)-vertices in S. In the first case, these two vertices include all E(G)-vertices in the P3-convex hull, implying a vertex restriction 2 contradiction. In the second case, if u3 and u4 are not in S, since hP3 (H) ≥ α(G)+ 2, we have two V (G)-vertices in S incident to a same E(G)-vertex, these vertices include all E(G)-vertices in the P3-convex hull, implying a vertex restriction 2 contradiction. Otherwise, consider a vertex u3 or u4 in S. In any case, it includes u1 or u2 in the P3-convex hull and, in the next iterations, all E(G)-vertices, implying a vertex restriction 2 contradiction.
Thus, S must be composed by u3, u4, and V (G)-vertices. For the sake of contra- diction assume hP3 (H) ≥ α(G)+ 3. There are: (i) two vertices u3 and u4 and one pair of V (G)-vertices within distance two in S; (ii) one vertex u3 or u4 and two pairs of V (G)-vertices within distance two in S incident to distinct E(G)-vertices (because of forbidden configuration (a.1)) or; (iii) three pairs of V (G)-vertices within distance two in S incident to distinct E(G)-vertices. In all cases, all E(G)-vertices are in- cluded in the P3-convex hull, which implies a vertex restriction 2 contradiction in another V (G)-vertex of S. Therefore, hP3 (H)= α(G)+ 2.	2
Remark 3.2  The subdivision SUB(G) of a graph G is a bipartite graph and it has ι(G) = γ(G) [17]. Moreover, Ko and Shepherd [10] proved that β∗(G)+ γ(SUB(G)) = β∗(SUB(G)) + γ(G)= |V (G)|.
Theorem 3.3 ep3hi is NP-hard for bipartite graphs (so is vp3hi for line graphs of bipartite graphs)
Proof. Consider a modified instance graph G of the NP-hard problem mds [7] with γ(G) ≤ n − 7 and H be the graph with: V (H) = V (G) ∪ E(G) ∪ {u1, u2};
∀uv ∈ E(G), add edges {u uv, v uv} in E(H); add all edges between u1 and E(G)- vertices and; all edges between u2 and V (G)-vertices. Let M be a maximum edge
P3-Helly-independent set of H with hj (H) ≥ 7. There are no two or more edges
incidents to u1 or u2 in M . Otherwise, these edges include all edges incident to u1 (resp. u2) in the edge P3-convex hull, which includes all edges incident to endpoints of edges in M that have endpoints in V (G)-vertices and E(G)-vertices (denoted by middle edges) and we have an edge restriction 2 contradiction. Moreover, there is no edge incident to u1 or u2, or two middle edges incident to a same V (G)-vertex (resp. E(G)-vertex) in M . Otherwise, it includes another edge of u1 (resp. u2) in the edge P3-convex hull, and it includes all edges of H in the next iterations. Therefore, it also implies an edge restriction 2 contradiction in a middle edge of
M .

Thus, there are only middle edges in M , and these edges do not share a common vertex in a V (G)-vertex (resp. E(G)-vertex). Additionally, there is no edge incident to both endpoints of two selected edges. Otherwise, these edges include an edge incident to u1 (resp. u2) in the edge P3-convex hull and we are dealing with the previous case. Therefore, the edges in M are an induced matching of H, and this induced matching is maximum, since if we select an edge incident to u1 (resp. u2) to a maximum induced matching, we have no edges incident to the E(G)-vertex (resp. V (G)-vertex) in its other endpoint and no edges incident to the other endpoints of these edges. Thus, we may exchange, for instance, the edges {u1 de} or the edge {u2 a} for the middle edges {d de} and {a ab} (for any ab in E(G)-vertex). By Remark 3.2, γ(G)+β∗(SUB(G)) = |V (G)|. Therefore, determine γ(G) is equivalent
to determine β∗(SUB(G)) = β∗(H)= hj (H).	2
Since a triangle-free graph G has all its P3’s induced, if vp3hi is NP-hard (resp. in P), so is vsp3hi.
Corollary 3.4 vsp3hi is NP-hard for bipartite graphs.
Remark 3.5  By Property ESP3HI 4, |V (G)|−γ(G) ≥ hj ∗ (G) ≥ |V (G)|−ι(G).
3
Hence, for any graph class C with graphs G where ι(G)= γ(G), the computational
complexity of mds in C is the same as esp3hi.
The next corollary follows from Remarks 3.5, 3.2 and mim (maximum induced matching) is NP-hard [7], which implies mds is NP-hard for bipartite graphs (particularly, the subdivision graphs of the mim’s instances).
Corollary 3.6 esp3hi is NP-hard for bipartite graphs (so is vsp3hi for line graphs of bipartite graphs).
Construction 3.7 A bipartite graph H (denoted by Binary Star I or II graphs) is obtained from a bipartite graph G = (X, Y, E) as follows. V (H)= V (G) ∪ {u1, u2} (we denote u1 and u2 by universal star vertices); (i) Binary Star I graphs: add all edges between u1 and X-vertices, all edges between u2 and Y -vertices and add a desired number of degree one vertices incident to u1 or to u2; (ii) Binary Star II graphs: add all edges between u1 and u2 to X-vertices and add a desired number of degree one vertices incident to u1 or to u2;.
The class of Binary Star I of Construction 3.7 contains the graphs H of The- orem 3.3, and the class of Binary Star II contains the graphs H of Theorem 3.1. Corollary 3.8 follows by Theorems 3.1 and 3.3 and the fact that vp3hi and vsp3hi have the same computational complexity on triangle-free graphs. Moreover, Corol- lary 3.9 follows by Property Bound 2, since if G has no degree two vertex, then L(G) has no maximal clique of size two. Finally, Corollary 3.10 follows from Corol- lary 3.9. and the fact that β∗(L(G)) = P3-part(G) [13].
Corollary 3.8 vp3hi and vsp3hi are NP-hard for Binary Star II graphs and so is ep3hi for Binary Star I.
Corollary 3.9 A line graph L(G) of a graph G with no degree two vertex has
j (L(G)) = β∗(L(G)).

The P3-partition aims to obtain P3-part, the minimum number of vertex dis- joint P3’s to cover its vertices.
Corollary 3.10 If P3-partition for a graph class C with no degree two vertex or mim for Cj, composed by the line graphs of graphs of C is NP-hard (resp. P), then so is ep3hi.
Theorem 3.11 vp3hi and ep3hi are NP-hard for line graphs of Binary Star I graphs.
Proof. The vp3hi proof follows from Remark 2.1 and by Corollary 3.8. The P3- partition is NP-hard for an instance bipartite graph G with δ(G) ≥ 2 [12]. Let Gj be the Binary Star I graph obtained from G by adding the two universal star vertices with two degree one vertices incident in each. Clearly, Gj has no degree two vertex and P3-part(Gj)= P3-part(G)+ 2. Now, the ep3hi result follows from Corollary 3.10.	2
Theorem 3.12 esp3hi is in P for Binary Star I (so is vsp3hi for line graphs of Binary Sar I graphs).
Proof. Let H be a graph obtained from Construction 3.7. Consider any edge P∗- Helly-independent M of H. By Property ESP3HI 1, it is possible to pick all edges incident to the two star vertices to be part of M , since there is no for- bidden configurations (d.1), (d.2), and (d.3). On the other hand, H has no uni- versal vertex, and by Property ESP3HI 4, this is the best possible.  Thus,
hj ∗ (H)= hP ∗ (L(H)) = |V (G)|.	2
P3	3
Split Graphs
Let G = (I ∪K, E) be a split graph for which I is an independent set and K induces a clique. We require two properties: (Property SPLIT 1) α(G2) ≤ hP (G) ≤ α(G2)+1 and; (Property SPLIT 2) a maximum P3-Helly-independent set S with a vertex of K, or two vertices of I within distance two, has at most two vertices of I in S with degree larger than one.
Theorem 4.1 vp3hi is NP-hard for split graphs.
Proof. We show a polynomial time transformation from the NP-hard mis problem for a graph G [7] with α(G) ≥ 4 to vp3hi for a split graph H (with hP3 (H) ≥ 4) described as follows. V (H)= V (G) ∪ V (G) ∪ E(G) (we denote the second V (G) by V2(G)). The (E(G) ∪V2(G))-vertices form a clique in H. There are edges between a V (G)-vertex v and a E(G)-vertex e if v is one of the endpoints of e in G and between a vertex V (G)-vertex v and a V2(G)-vertex v2 if they represent the same vertex in
G. Note that if uv ∈ E(G), then u and v have distance two in H. Otherwise, if
uv /∈ E(G), then they have distance three in H.
By construction, H has minimum degree at least two. Thus, by Property SPLIT 2, since hP3 (H) ≥ 4, we cannot have a vertex of the clique or two vertices within distance two in the independent set in a maximum P3-Helly-independent set

S of H. Therefore, S has only vertices of the independent set of H which have distance at least three among them, i.e., hP (H)= α(H2)= α(G).
Consider a maximum independent S set of G with α(G) vertices. By Property Bound 7, it is possible to pick the same V (G)-vertices related to the vertices of S to belong to a P3-Helly-independent set of H with α(H2)= α(G) vertices. Conversely, consider a maximum P3-Helly-independent set Sj of H with hP (H) vertices. Since all vertices in Sj have distance at least three among them in H, the related V (G)- vertices in G have distance at least two among them in G. Therefore, hP3 (H) = α(G).	2
Let G be a split graph. It is possible to verify that the edge P3-convex hull of
any set with at least two edges of G is E(G). Therefore, we have hj (G) ≤ 2 or we
have an edge restriction 2 contradiction. The next corollary follows by Property
Bound 4, since hj (G) is constant:
Corollary 4.2 ep3hi is in P for split graphs (so is vp3hi for line graphs of split graphs).
Theorem 4.3 vsp3hi is in P for split graphs.
Proof. Let S be a maximum P∗-Helly-independent set of a split graph G = (I ∪ K, E). For the sake of contradiction, assume hP ∗ (G) ≥ ω(G)+ 2. Consider the case we have two pairs of distinct vertices of I with distance two in S. No matter if there are edges between these two pair of vertices and their shared neighborhood in K, these vertices and their shared neighborhood imply a star restriction 1 contradiction. Thus, we have at most one pair of vertices with distance two of I in S, the other vertices of I in S are adjacent to distinct vertices of the clique. Therefore, hP ∗ (G) ≥ ω(G)+2 implies at least one vertex of the clique in S.
Consider now the case in which there is no pair of vertices with distance two of I in S. There are at least two vertices of the clique in S, and there is at most one vertex of I in S adjacent to a vertex of K in S. Otherwise, if there are two vertices of I in S adjacent to a vertex K in S, they must be adjacent to all vertices of K in S to avoid a forbidden configuration (b.1), which also force a forbidden configuration (b.1). Therefore, the others vertices of I in S and K in S must not be adjacent. Now, each vertex vi of I in S is related to a distinct vertex wi of K, where wi must not be in S. This implies |S|≤ ω(G)+ 1, a contradiction.
Finally, consider the case we have one pair of vertices with distance two of I in
S. Note that there is at least one vertex of K in S, there is no vertex I in S adjacent to a vertex K in S, and there are at least ω(G)+1 of such vertices (discounting the
pair of vertices of I in S). Since each vertex of I in S is related to a distinct vertex of K in S, this implies that there is a vertex of I in S adjacent to a vertex of K in
S. However, to avoid a star restriction 1 contradiction, one of the pair of vertices of distance two must be adjacent to this vertex of K, which also implies forbidden configuration (b.1).
Therefore, ω(G) ≤ hP ∗ (G) ≤ ω(G)+ 1, which can be determined in polynomial time for a split graph G.	2

Theorem 4.4 esp3hi is in P for split graphs (so is vsp3hi for line graphs of split graphs).
Proof. Let M be a triangle-free edge P∗-Helly-independent set of a split graph G and v be a maximum degree vertex of G. Clearly, v is part of the clique. It is possible to pick the edges incident in v as a possible set of M . By Properties ESP3HI 2 and ESP3HI 3, G[M ] is a union of star graphs with no edges between centers with more than two leaves. There are no two centers of stars with more than two leaves in vertices of the clique, or we have a forbidden configuration (d.2). Thus, there is only one vertex v of the clique with more than one edge of M incident to it. This implies all edges of M not incident to v are a matching between vertices of the clique and the independent set. However, for each edge of this matching, there is a missing edge between v and one of the endpoints of the edge or else there is a forbidden configuration (d.1).
Therefore, we need |V (G)|−Δ(G) (the degree of v) stars to partition the vertices of G with non-adjacent centers of the stars with at least two leaves. By Property ESP3HI 4, each star increases the difference between hj ∗ (G) and V (G) in one
3
unity. I.e., |M| = |V (G)|− (|V (G)|− Δ(G)) = Δ(G). By Property ESP3HI 3, all
maximum edge P∗-Helly-independent set with triangles Mj of G has |Mj|≤ |M|.2
Remark 4.5 Note that Corollary 3.10 and the fact that mim is in P for line graphs of Hamiltonian graphs [11] imply that ep3hi is in P for line graphs of Hamiltonian graphs with δ ≥ 3.
Theorem 4.6 esp3hi is NP-hard for Hamiltonian graphs (so is vsp3hi for line of Hamiltonian graphs).
Proof. This proof is based in the NP-completeness proof of mids (minimum inde- pendent dominating set) for 2P3-free graphs [16]. Let J = (U, C) be an instance of the well-known NP-complete problem 3-sat [7] with |U| = p and |C| = q. We construct a graph G from an instance J as follows: for each variable u ∈ U we add a P2 with labels u and u to G; for each clause c ∈ C we add a vertex with label c to G; we add all edges between clause vertices and; for each clause c ∈ C (e.g., c = (x, y, z) we add edges between the literals and c (e.g., the edges xc, yc, zc). We assume there is no clause connect to both literals of a variable, since this clause would be always truth and it could be removed from C, and that |U| ≥ 2 (since verify a truth assignment for clauses with only one variable is trivial). Now, duplicate (i.e., add true twins) for each clause vertex 2p times.
We claim that a maximum edge P∗-Helly-independent set M of G has size
|V (G)| − p and it uses the same vertices of a minimum independent dominating set ID of G as the center of its stars if and only if ι(G)= p. For the sake of contra- diction assume there is a triangle in M . Note that any triangle of G has at least two vertices in the clique. By Forbidden configuration (d.3), all vertices adjacent to this triangle are isolated stars in M . Moreover, we need to cover the remaining P2 ver- tices with other p stars centered in these vertices. Therefore, |M|≤ |V (G)|− q − p,
a contradiction with hj ∗ (G) = |V (G)|− p. Now, assume M has a center of star
3

in a clause clique vertex. Their leaves in the P2’s vertices have not their variable counterpart incident to this center of star. Therefore, it requires at least p more center of stars, i.e., |M|≤ |V (G)|− p − 1, also a contradiction.
Now, we show that at least p non-adjacent centers of stars are needed to partition the vertices of G, and these vertices are related to a truth assignment of C. Since there is no star with center in the clique, all the stars have centers in the P2 vertices and we need at least p of them to cover all P2’s vertices. If we use a vertex of the P2 as a center of star with high degree, and the other endpoint of the P2 as a center of star with degree one, we still need at least another p − 1 vertices of the P2’s to partition the vertices of G into non-adjacent stars, a contradiction with hj ∗ (G)= |V (G)|− p. Consider a truth assignment of C. Pick a set of vertices M
related to this truth assignment as centers of stars. Each star covers the variable counterpart of the literal and, since it is a truth assignment, all clause vertices are reached by a center of star. These p centers of stars are non-adjacent. Thus, M is
a maximum edge P∗-Helly-independent of G with size |M| = hj ∗ (G)= |V (G)|− p.
3	∗	P3
Conversely, consider any maximum edge P3 -Helly-independent M of G with size
|M| = hj ∗ (G) = |V (G)|− p. These p centers of stars need to be in P2’s vertices, one in each P2. Moreover, since they reach all clause vertices, the assignment using the related literals of vertices in M with true value, is a truth assignment of J .  2

Join Graphs
The join graph G = G1 ∧ G2 has hP3 (G) ≤ 2.  Thus, Corollary 5.1 follows by
Property Bound 4.
Corollary 5.1 vp3hi is polynomially solvable for G = G1 ∧ G2, the join of two graphs G1 and G2.
Theorem 5.2 ep3hi is NP-hard for join of two graphs (so is vp3hi for line graphs of join of two graphs).
Proof. Consider a graph G with β∗(G) ≥ 6, an instance of the NP-hard prob- lem mim problem [15]. Let H = G ∧ {v} and M be a maximum edge P3-Helly- independent set of H. There is no edge incident to v in M . Otherwise, since β∗(G) ≥ 6, there are at least three other edges in M , and this implies an edge restriction 2 contradiction with one of these three edges. There are also no two edges incident to a same vertex w of G in M or the edge vw is included in the next iteration of the edge P3-convex hull, and we are dealing with the previous case. Moreover, there are no edge outside M sharing both endpoints with two edges of M or we include an edge incident to v in the edge P3-convex hull of M and we are again dealing with the previous cases. Therefore, M is an induced matching, i.e.,
j (H)= β∗(G).	2
Theorem 5.3 vsp3hi is NP-hard for join of graphs.
Proof. Consider a graph G instance of the NP-hard problem maximum clique [7]. Let H be the graph with |V (G)| +1 copies of G with all possible edges between

vertices of different copies and S∗ be a maximum P∗-Helly-independent set of H. Consider a set Sj with the vertices of a maximum clique of G for each copy of G in H. Thus, |Sj| = (|V (G)| + 1)ω(G) is P∗-Helly-independent and |S∗| ≥ |Sj|. For the sake of contradiction, assume we pick two non adjacent vertices of a copy of G in H to be part of S∗. We may not pick any other vertex of other copy of G to be part of S∗ or this vertex implies a star restriction 2 contradiction. Thus,
|S∗| ≤ |V (G)|, a contradiction with the fact that S∗ is maximum. Therefore, we may only pick vertices of a maximum clique in each copy of G to be part of S∗, and only one maximum clique for copy. I.e., hP ∗ (H)= (|V (G)| + 1)ω(G).	2
Theorem 5.4 esp3hi is NP-hard for join of graphs (so is vsp3hi for line graphs of join of graphs).
Proof. Let M be a triangle-free edge P∗-Helly-independent set of G = G1 ∧ G2. We claim that hj ∗ (G) = max = max{|V (G1)| + hj ∗ (G2), |V (G2)| + hj ∗ (G1)}.
P3	P3	P3
There is at least one vertex of G1 or G2 which is a star with at least two leaves in M . Otherwise, M is a matching between vertices of G1 and G2, and hj ∗ (G) ≤
3
|V (G1)|+|V (G2)| , which is smaller than max, because of Property ESP3HI 4 and
the fact that ι(H) ≥ |V (H)| for any H, hj ∗ (G2) ≥ |V (G2)| and hj ∗ (G1) ≥ |V (G1)| , a 

2
contradiction.
P3	2	P3	2

Note that there is an M with |M| = |V (G1)| + hj ∗ (G2) (resp. |M| = |V (G2)| +
3
hj ∗ (G1)), since we may pick a maximum edge P∗-Helly-independent set of G1 (resp.
P3	3
G2) and add to one of the center of the stars of G1 (resp. G2) with more than one leaf all the edges incidents to vertices of G2 (resp. G1). Therefore, hj ∗ (G) ≥ max. Moreover, there are no centers of stars with more than two leaves in both G1 or G2, or we have a forbidden configuration (d.2). For the sake of contradiction assume
hj ∗ (G) > max. W.l.o.g., let |V (G1)| + hj ∗ (G2) ≥ |V (G2)| + hj ∗ (G1). Thus, we use
P3	P3	P3
hj ∗ (G2) edges incident only to vertices of G2 and we need at least |V (G1)| +1 edges incidents to vertices of G1. However, it implies that at least one vertex of G1 is a
star with more than two leaves, a contradiction. By Property ESP3HI 3, all edge
P∗-Helly-independent set with triangles Mj of G has |Mj|≤ |M|. So, hj ∗ = max.
3	P3
Consider any graph class for which esp3hi is NP-hard (e.g., Corollary 3.6).
The hardness result follows directly from the graph class obtained by the join of an instance Gj of the previous NP-hard case with itself, G = Gj ∧ Gj, for which
hj ∗ (G)= max{|V (Gj)| + hj ∗ (Gj), |V (Gj)| + hj ∗ (Gj)}.	2
P3	P3	P3
The join of 4K1-free graphs continues to be 4K1-free. The first result of Corol- lary 5.5 follows from Theorem 5.3 and the fact that maximum clique is NP-hard for 4K1-free graphs [8]. The second result follows because α(G) ≤ 4 for 4K1-free graphs, Property Bounds 4, 5, and 6. Moreover, Corollary 5.6 follows from the proof of Theorem 5.2, which holds to a Hamiltonian graph obtained by the addition of universal vertices.
Corollary 5.5 vsp3hi is NP-hard for 4K1-free graphs whereas vp3hi and ep3hi
are in P.

Corollary 5.6 ep3hi is NP-hard for Hamiltonian graphs (so is vp3hi for line graphs of Hamiltonian graphs).
Construction 5.7 Construct a graph H, denoted by (clique ∧ G) from a graph G as follows. Add a copy of G to H; add a clique of size |V (G)| to H and; add a universal vertex u.
Theorem 5.8 vp3hi, vsp3hi, and esp3hi are in P for a clique ∧ G graph H, whereas ep3hi is NP-hard.
Proof. By Corollary 5.1, vp3hi is in P for join of graphs. Consider a maximum edge P∗-Helly-independent set M of H. If we pick u as a center of a star, we have
|M| = |V (H)|− 1, which is best possible by Property ESP3HI 1. Consider now
a maximum P∗-Helly-independent set S of H. There are no two vertices of the large clique and two vertices of G in S or we have a forbidden configuration (b.2). Besides, u cannot be part of S if there are vertices of the large clique and of G in
S or we have a forbidden configuration (b.1). Thus, there are at most |V (G)| +1 
vertices in S. Such S can be pick as the vertices of the large clique and u. Consider a maximum edge P3-Helly-independent set Mj of H. If we pick more than one edge of the clique to Mj, the edge P3-convex hull is E(H) and we have an edge restriction

2. Therefore, hj
(clique ∧ G) ≤ hj
3
(G ∧ {u})+ 1. There is such Mj with one edge

of the clique and a maximum edge P3-Helly-independent Mj of G ∧ {u} (which is an induced matching). The hardness result follows from Theorem 5.2 on G ∧ {u}.2

Final Remarks
This paper contains results on the Helly number of P3 and related convexities. In order to present a comparative study of the computational complexities of vp3hi, ep3hi, and vsp3hi (See Table 1), we devote our efforts to subclasses of bipartite graphs, split graphs, and join of graphs. The esp3hi problem started as a support to the proofs of vsp3hi for line graphs. Edge P∗-Helly-independent sets have only three types of minimal forbidden configurations, unlike the other P3-Helly-independent sets, which have infinity types. As a consequence, we establish a relation between esp3hi and a variation of star partition problem.
By Property ESP3HI 4, |V (G)|−γ(G) ≥ hj ∗ (G) ≥ |V (G)|−ι(G). Like pieces
3
of a puzzle starting to fit together, there exists a result of [17] that characterizes, by forbidden subgraphs, the class of graphs G for which ι(H)= γ(H) for any induced
subgraph H of G. Surprisingly, they are exactly the same subgraphs in the forbidden configuration (d.2). Thus, for a triangle-free graph G with ι(G) = γ(G), there is

no forbidden configuration (d.2). Moreover, hj ∗
3
is closed by induced subgraph

(Property ESP3HI 5). Therefore, for any induced subgraph H of a triangle-free graph G with ι(G)= γ(G), hj ∗ (H)= |V (H)|− γ(H).
3
As future work, we aim to establish the missing computational complexities of
esp3hi in Table 1. We also have partial results on the computational complexities of all four P3-Helly-independent problems in planar graphs, chordal graphs, interval graphs, and grid graphs.

References
Carvalho, M. T., S. Dantas, M. C. Dourado, J. L. Szwarcfiter and D. F. D. Posner, P3-helly number of graphs with few P4, Proceedings of VIII Latin American Workshop on Cliques in Graphs - LAWCG 2018 .
Coelho, E. M. M., M. C. Dourado, D. Rautenbach and J. L. Szwarcfiter, The caratheodory number of the P3-convexity of chordal graphs, Discrete Applied Mathematics 172 (2014), pp. 104–108.
Dourado, M., F. Proti and J. Szwarcfiter, Complexity aspects of the helly property: Graphs and hypergraphs, The Eletronic Journal of Combonatorics DS17 (2009).
Dourado, M. C., F. Protti and J. L. Szwarcfiter, Complexity results related to monophonic convexity, Discrete Applied Mathematics 158 (1996), pp. 1268–1274.
Dourado, M. C., F. Protti and J. L. Szwarcfiter, On the complexity of the geodetic and convexity numbers of a graph, Journal of the Ramanujan Mathematical Society 7 (2008), pp. 101–108.
Eto, H., E. Fengrui and E. Miyano, Distance- d independent set problems for bipartite and chordal graphs, Journal of Combinatorial Optimization 27 (2014), pp. 88–99.
Garey, M. R. and D. S. Johnson, “Computers and Intractability: A Guide to the Theory of NP- Completeness,” W. H. Freeman Co, 1979.
Golumbic, M., “Algorithmic Graph Theory and Perfect Graphs,” Academic Press, 1980.
Kemp, D., J. Kleinberg and E. Tardos, Maximizing the spread of influence through a social network, Proceedings of ACM SIGKDD (2003), pp. 137–146.
Ko, C. and F. Shepherd, Bipartite domination and simultaneous covers, SIAM J. Discrete Math. 16
(2003), pp. 517–523.
Kobler, D. and U. Rotics, Finding maximum induced matchings in subclasses of claw-free and p5-free graphs, and in graphs with matching and induced matching of equal maximum size., Algorithmica (2003), pp. 327–346.
Monnot, J. and S.Toulouse, The Pk partition problem and related problems in bipartite graphs, Theory and Practice of Computer Science (2007), pp. 422–433.
Orlovich, Y., G. Finke, V. Gordon and I. Zverovich, Approximability results for the maximum and minimum maximal induced matching problems, Discrete Optimization (2008), pp. 584–593.
Peleg, D., Local majorities, coalitions and monopolies in graphs, Theor. Comput. Sci. 282 (2002),
pp. 213–257.
Stockmeyer, L. and V. Vazirani, NP-completeness of some generalizations of the maximum matching problem, Information Processing Letters 15 (1982), pp. 14–19.
Zverovich, I. and O. I. Zverovich, Independent domination in hereditary classes, Theor. Comput. Sci.
352 (2006), pp. 215–225.
Zverovich, I. and V. Zverovich, A characterization of domination perfect graphs, J. of Graph Theory
30 (1995), pp. 375–395.
