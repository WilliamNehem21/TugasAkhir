Electronic Notes in Theoretical Computer Science 122 (2005) 3–22	
www.elsevier.com/locate/entcs


Limit Preservation from Naturality
Mario Caccamo1
The Wellcome Trust Sanger Institute Cambridge, UK
Glynn Winskel2
University of Cambridge Computer Laboratory Cambridge, UK

Abstract
A functor G : C → D is said to preserve limits of a diagram D : I → C if it sends any limiting cone from x to D to a limiting cone from G(x) to G ◦ D. When G preserves limits of a diagram D this
entails directly that there is an isomorphism G(lim D) ∼= lim (G ◦ D) between objects. In general,
←−I	←−I
such an isomorphism alone is not sufficient to ensure that G preserves limits. This paper shows how, with minor side conditions, the existence of an isomorphism natural in the diagram D does ensure that limits are preserved. In particular, naturality in the diagram alone is sufficient to yield the preservation of connected limits. At the other extreme, once terminal objects are preserved, naturality in the diagram is sufficient to give the preservation of products. General limits, which factor into a product of connected limits, are treated by combining these results. In particular, it is shown that a functor G : C → D between complete categories is continuous if there is an
isomorphism G(lim D) ∼= lim (G ◦ D) natural in D ∈ [I, C], for any small category I. It is indicated
←−I	←−I
how a little calculus of ends, in which the judgements are natural isomorphisms between functors, is useful in establishing continuity properties of functors.
Keywords: category, functor, limit, preservation, naturality, end


Introduction
It is often useful to establish that a functor preserves limits or colimits of a certain kind. This can be to show a construction stays within a category, or

1 Email: mc2@sanger.ac.uk
2 Email: gw104@cl.cam.ac.uk


1571-0661 © 2005 Published by Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2004.06.048


because of some useful property such (co)limit preserving functors possess. According to its definition, for a functor G : A → B to preserve limits of diagrams D : I →A it is not enough for there just to be an isomorphism

G(lim D) =∼ lim (G ◦ D)
←−I	←−I

—expressing that the limit object of the diagram D is sent to a limit object of the diagram G ◦ D. Rather G must send a limiting cone of D to a limit- ing cone. Whereas this can be a matter of no great difficulty, it does involve taking care of detail of the kind all too familiar in category theory (detail which it is tempting to ‘handwave’ away). In practice, one commonly has the feeling that once the isomorphism above for limit objects is established the bulk of the work is done. This paper provides the mathematical excuse for that feeling. It is shown that, under minimal side conditions, provided the isomorphism is natural in the diagram D then preservation of limits follows automatically. This is done by first showing such a result for connected dia- grams, then products, and finally combining these results to treat diagrams in general.
With a suitable stock of natural isomorphisms, limit preservation now of- ten becomes a routine consequence of an ‘equational’ style of reasoning but based on judgements of natural isomorphism instead of equations. One mo- tivation for this work has come from recent work in extending domain theory and denotational semantics to a situation where ‘domains’ are now categories and continuous functions are replaced by functors preserving certain colimits. In particular when ‘domains’ are presheaf categories knowing that a functor preserves connected colimits ensures that it preserves surjective open maps, so open map bisimulation [4].
We start by giving the necessary background on limits and limit preserva- tion.


Limiting Cones
Let I be a small category and c an object in a category C. The diagonal functor
∆c : I →C takes all objects i of I to c and all arrows of I to the identity idc.
A cone from c ∈ C to a functor D : I → C, often called the diagram, is a natural transformation from ∆c to D. A limit for D, or a limiting cone, is a universal cone, i.e. a cone ε : ∆c ⇒ D such that for any other cone ε' : ∆c' ⇒ D there exists a unique mediating arrow m : c' → c for which the



diagram


∆c'  ∆m  ∆ c
¸¸¸¸

ε' ¸¸¸ ε


commutes, i.e.



c' ¸
zJ 
D

m	 c 

¸¸¸
ε' ¸¸ εi
i	zJ 
D(i)
commutes for all objects i in I.
When a cone ∆c to D is limiting we call c the limit object. Clearly the limit objects of limiting cones are only determined to within isomorphism:
Proposition 1.1 Let D : I → C be a diagram. Suppose ε : ∆c ⇒ D and
ε' : ∆c' ⇒ D are both limiting cones. Then c ∼= c'. Conversely, given a
f
limiting cone ε : ∆c ⇒ D and an isomorphism c' =∼ c, then ε ◦ ∆f : ∆c' ⇒ D
is a limiting cone.
Limit functors
Suppose that a category C has all I-limits, i.e. limits of all diagrams in the functor category [I, C]. It is often convenient to assume a fixed choice of limit for each diagram in [I, C]. 3 Then for any diagram D : I →C there is a choice
of limit εD : ∆lim (D) ⇒ D, in which we have called the limit object lim (D).

←−I
←'−I

We can turn lim into a functor lim : [I, C] → C. Suppose α : D ⇒ D where

the diagrams D ←−I D'
←−I
are associated with the limiting cones
ε : ∆lim D ⇒ D

and ε' : ∆lim D' ⇒ D'
←−I
. The composition of natural transformations εα
yields

←−I	'	'

a cone from lim (D) to D . By the universality of ε
←−I
there is a unique arrow

lim α : lim D → lim D'


in C for which the diagram
←−I
←−I


∆lim α
←−I


'

∆lim D  ←−I  ∆ lim D

←−I
ε
J 
←−I
ε'
J 

D	α	 D '

3 In general this requires the axiom of choice, though often in practice it turns out that a particular choice is determined once a standard way of contructing limits in sets is settled on.


commutes.
Sometimes we are interested in a subcategory of diagrams K ⊆ [I, C] for

which limits exist in C. Just as above we can define a functor lim
←−I
: K →

C.	(And, as later, talk about a functor preserving K-limits or being K-
continuous.)
We shall make use of an alternative way to present limits via representab- ility. Let D : I → C be a diagram. A choice of limit for D corresponds to a representation, i.e. a natural isomorphism
θ : C( , lim D) ∼ [I, C] ∆ , D  .
←−I
The limiting cone is obtained as the counit of the representation defined to be the image, θlim D(idlim D), of the identity map under the component
←−I	←−I
θlim D : C(lim D, lim D) ∼= [I, C] ∆lim D, D  .

Notice the important fact that the isomorphism θ is also natural in D ranging over the subcategory of diagrams K ⊆ [I, C] for which limits exist. In fact,

lim
←−I
is the unique functor extending the choice of limit objects for which this

naturality holds.

Preservation of Limits
Let G : C → D be a functor. The functor G preserves limits for a diagram D : I →C if whenever κ : ∆c ⇒ D is a limit then the cone Gκ : ∆G(c) ⇒ G◦D, got by composition with G, is also a limit. Clearly, if composition with G sends one limit for a diagram D : I →C to a limit for G ◦ D then it sends any other limit for D to a limit for G ◦ D. Most often we talk of the functor G preserving I-limits, or being I-continuous; this means that G preserves limits of all diagrams in [I, C].
Suppose there is a fixed choice of I-limits in C and D with respect to which
we have limit functors lim : [I, C] →C and lim : [I, D] → D.
←−I	←−I
Let G : C → D be a functor. Given a cone γ : ∆lim D ⇒ D for a diagram
←−I
D : I → C the natural transformation Gγ : ∆G(lim D) ⇒ G ◦ D obtained by
←−I
composition is a cone as well. Thus, given a limiting cone ε : ∆lim G ◦ D ⇒
←−I
G ◦ D there is a unique mediating arrow m : G(lim D) → d such that the
←−I

diagram
∆G(lim D)  ∆m  ∆ lim G ◦ D

←−I
¸¸¸¸¸¸¸
←−I
ε

Gγ	¸¸¸z˛J 
G ◦ D


commutes. Requiring that J preserves limits of D is equivalent to insisting that the mediating arrow defined by Jγ is an isomorphism; in fact some authors use this as the definition of preservation of limits.
In order to prove that a functor J : C → D preserves limits of a diagram
D : I →C it is not enough to exhibit an isomorphism
J(lim D) ∼= lim J ◦ D.
←−I	←−I
Indeed, the action of J over arrows may result in a family that is not universal. As an example consider the category Count of countably infinite sets and functions. Clearly the objects of Count are all isomorphic. There is a functor  + 1 : Count → Count that acts over sets by adding a new element: given X ∈ Count then X + 1 = X ∪ {X} and given a function f : X → Y , the function f + 1 sends a ∈ X to f (a) and {X} to {Y }. There is an isomorphism
(X × Y )+1 ∼= (X + 1) × (Y + 1),

but this functor does not preserve products; the arrow πX +1 : (X × Y )+1 →
X + 1 is not a projection.
If the categories C and D have enough limits the expressions

J(lim D)	and	lim (J ◦ D)
←−I	←−I
are both functorial in D. For every D there is a mediating arrow mD defined by Jε where ε is the universal cone associated to limID. The family ⟨mD⟩D
is natural, this follows directly from the universality of the mediating arrows.
Thus if J is K-continuous there is a canonical isomorphism
J(lim D) =∼ lim (J ◦ D)


natural in D ∈ K.
←−I
←−I

An isomorphism J(lim D) ∼= lim (J◦D) natural in D is not always unique.
←−I	←−I
Consider, for instance, the category 1 with one object, say *, and the identity
arrow. The functor category [1, 1] has only one object: the “constant” functor
∆*. The limit for this functor is the object * itself where the limiting cone is the identity. We can extend 1 with an extra arrow

id  * ,	,˛ι 

id   * ,¸f

where f is also an isomorphism, i.e. f ◦ f = id. The inclusion functor ι clearly preserves the limit of the diagram ∆*. The mediating arrow is given by the identity on * which is an isomorphism and trivially natural. The arrow f ,



however, gives another isomorphism

ι(lim ∆*) ∼ lim
1


ι ◦ ∆ * 


—naturality here is trivial as well.
Often checking the isomorphism between the limiting objects follows from a fairly direct calculation, while proving that a functor preserves a limiting cone can involve a fair amount of bookkeeping. We wish to determine under which conditions having an isomorphism

J(lim D) =∼ lim (J ◦ D)
←−I	←−I
is enough to ensure that J preserves limits of D.
We shall first investigate two extreme cases, one when diagrams are con- nected and the other when they are discrete. We later combine the results for general limits.


Connected Diagrams
We first consider a special case: preservation of connected limits, i.e. limits of connected diagrams. A category E is connected if it is nonempty and for any pair of objects a, b ∈ E there is a chain of arrows

a → e1 ← e2 → ... → en ← b.

Observe that if J is connected then C has limits for all J-indexed constant diagrams.
Lemma 2.1 Let J be a connected small category and C a category.
A cone β : ∆c ⇒ ∆d for a constant diagram ∆d : J → C is limiting iff
β = ∆f for some isomorphism f : c ∼= d.
For a limiting cone γ : ∆c ⇒ D of a diagram D : J →C the arrow lim γ is
←−J
an isomorphism.
Proof By virtue of J being connected it is clear that any isomorphism f :
c ∼= d yields a limiting cone ∆f : ∆c ⇒ ∆d, and moreover that any limiting cone for the constant diagram ∆d must have this form.
For a general diagram D : J → C, by definition lim γ is the unique arrow
←−J



making the square

∆lim γ
∆lim ∆c ←−J  ∆ lim D

←−J
β
J 
←−J
κ
J 

∆c	γ	 D 
commute, where β and κ are the chosen limiting cones for ∆c and D re-
f
spectively. As J is connected there is an isomorphism lim ∆c ∼ c such that
←−I
β = ∆f . As γ and κ are limiting cones by Proposition 1.1 there is an iso-
morphism g : c ∼= lim D such that γ = κ ◦ ∆g. Hence,

κ ◦ ∆(g ◦ f ) = κ ◦ ∆g ◦ ∆f = γ ◦ ∆f = γ ◦ β = κ ◦ ∆lim γ.
←−J
Since κ is limiting,
lim γ = g ◦ f.
←−J
As f and g are isomorphisms, lim γ is an isomorphism as well.	 
←−J
The following main theorem of this section, establishes that a natural isomorphism is enough to ensure preservation of limits of connected diagrams.
Theorem 2.2 Let J be a small connected category. Let J : C → D be a functor between categories C, D with all J-limits. The functor J preserves J-limits if and only if there is an isomorphism
J(lim D) =∼ lim (J ◦ D)


natural in D ∈ [J, C].
←−J
←−J

Proof The “only-if” part from the general fact that limit preservation implies that the mediating arrows are isomorphisms. To show the “if” part, let J be a connected small category and assume there is an isomorphism

θ
J(lim D) =∼ lim (J ◦ D)
←−J	←−J
natural in D. Given a diagram D : J →C and a limiting cone γ : ∆c ⇒ D, we show that the cone Jγ : ∆J(c) ⇒ J ◦ D is limiting.
The limiting cone γ : ∆c ⇒ D induces the naturality square
J lim ∆c θ∼∆c lim  (J ◦ ∆c)


←−J J 
←−J
J 

J(lim D)  θ∼D  lim  (J ◦ D).

←−J
=	←−J


Since J is connected by Lemma 2.1 the arrow lim γ is an isomorphism and
←−J
so J(lim γ) is an isomorphism as well. From the naturality square above we
←−J
can conclude lim Jγ is an isomorphism.
←−J
By definition lim Jγ is the unique arrow making the diagram
←−J

∆lim Gγ
∆lim (J ◦ ∆c)  ←−J	 ∆ lim (J ◦ D)

←−J
∆h
J 
←−J
ε
J 

J ◦ ∆c	Gγ	 J ◦ D

commute. By Lemma 2.1, as J is connected, the chosen limiting cone for the constant diagram J ◦ ∆c = ∆J(c) is necessarily of the form ∆h with h an isomorphism. The chosen limiting cone for J ◦ D is ε. Hence, the unique mediating arrow between the cone Jγ and the limiting cone ε is the
isomorphism
(lim Jγ) ◦ h−1 ,
←−J
which ensures that the cone Jγ is itself limiting. Thus J preserves the limits of D.	 
It is important to stress that the statement of Theorem 2.2 above refers to any natural isomorphism and not necessarily to the canonical natural trans- formation defined from the limit. The theorem establishes that if there exists such a natural isomorphism then the canonical natural transformation is in- deed a natural isomorphism as well.
We can relax the conditions of this theorem to consider the case where not all J-limits exist. Take instead a full subcategory K ⊆ [J, C] of diagrams whose limits exist in C and such that K includes all constant diagrams.
Corollary 2.3 Let J be a connected small category and K be a full subcategory of [J, C] including all constant diagrams and such that C is K-complete. Then J is K-continuous if and only if
for every D ∈ K, the diagram J ◦ D has a limit in D, and
there exists an isomorphism lim (J ◦ D) =∼ J(lim D) natural in D ∈ K.
←−J	←−J
Proof We use the proof of Theorem 2.2 within the subcategory K. Notice that the expression lim D is functorial in D but the domain is K instead of
←−J
[J, C]. As the indexing category J is connected the limits for constant diagrams
exist in C.	 
Connectivity is a significant constraint on diagrams. There are, however,


many applications where connected limits (and colimits) are central and then the result above (and its dual) can be useful [7,3,4].
Theorem 2.2 does not necessarily hold when the indexing category is not connected. For example, consider the functor category [2, 1] were 2 is the two-objects discrete category. This functor category has a unique object: the constant diagram ∆*. Now consider the functor J : 1 → Set selecting a countable infinite set, say the natural numbers N. As * × * = * in 1, where the projections are given by the identity, we have
J(* × *) ∼= J(*) × J(*)
natural in * since N ∼= N × N. The pair (idN, idN), however, is not a product.

Products
Clearly, Theorem 2.2 cannot be applied to products; then the index category is discrete, an extreme example of lack of connectivity.
Given a discrete category K a diagram D : K → C can be regarded as a tuple of objects ⟨xk⟩k∈K in C where xk = D(k). A cone for this functor is any family of arrows (called projections) ⟨fk : x → xk⟩k∈K for some object x. Notice that as the index category is discrete there is no commutativity to check and naturality comes for free. We say that a family ⟨fk : x → xk⟩k∈K is a K-product (or often just product) when it is a limiting cone. Because with a discrete index category naturality is automatic, we can strengthen Proposition 1.1; we retain a product when objects in the diagram vary to within isomorphism.
Proposition 3.1 Let fk : x → xk and f ' : x' → x' , for k ∈ K, where K is a
k	k
discrete category. Suppose there are isomorphisms s : x' ∼= x, and sk : x' ∼= xk

indexed by k ∈ K, such that


x'   ∼s	 x 


'	fk
J	
 x 
x	∼=	k
k  sk
commutes for all k ∈ K. Then ⟨fk : x → xk⟩k∈K is a product in C iff ⟨f ' : x' →
x' ⟩k∈K is a product in C.
We now study the conditions for a functor to preserve products. In the next section we see how these same conditions are enough to ensure preservation of limits in the general case. In a category with terminal object T we use
!: c → T to denote the unique arrow from c to T. We will use the following simple fact about products with a terminal object.


Proposition 3.2 Let C be a category with a terminal object T. A pair
⟨f : x' → x, !: x' → T⟩
is a product iff f is an isomorphism.
As special limits, K-products extend to functors once a choice of K-product
⟨πD :	xk → xk⟩k∈K is made for each diagram D = ⟨xk⟩k∈K. As is tra-
ditional we have written the chosen limit object for a diagram ⟨xk⟩k∈K as
k∈K xk, and write x × y when the diagram is ⟨x, y⟩.
Theorem 3.3 Let C, Ð be categories with ﬁnite products. The functor J :
C → Ð preserves binary products if
J preserves terminal objects and
there is an isomorphism
J(x × y) ~= J(x) × J(y)
natural in x, y ∈ C.
Proof Assume that J preserves terminal objects and that the isomorphism


J(x × y)

sx,y
~= J(x) × J(y)

is natural in x, y. Let T be a terminal object of C. There is a unique arrow
!: y →T in C. This arrow determines the commuting naturality square in the diagram
s
J(x × y)	=   J(x) × J(y)

G(πx,y )....
¸¸¸¸¸πGx,Gy

1 ..
,c.
G(idx×!)
J 


sx,T
G(idx)×G(!)
J 
¸1¸
¸¸z˛

J(x) ¸,  J(x × T)  ~=  J (x) × J(T)	 J (x) .

G(πx,T)
Gx,GT
1

The left triangle commutes since it is obtained by applying J to the commuting triangle
x × y
πx,y 

    
idx×!
J 

x ,¸ , x ×T 
1
—a consequence of products being special limit functors. By Proposition 3.2 the arrow πx,T is an isomorphism and so J(πx,T) is an isomorphism as well.
1	1
The right triangle commutes as products are special limit functors. By as-
sumption J(T) is a terminal object and so from Proposition 3.2 the arrow
πGx,GT is an isomorphism.


Thus the composition
s1 = πGx,GT ◦ sx,T ◦ J(πx,T)—1
1	1
forms an isomorphism such that
sx,y 
J(x × y)   ~=   J(x) × J(y)

G(πx,y )
J	s1

Gx,Gy
1
J 

J(x)	~=
 J (x)

commutes.
We can follow the same argument with y instead of x. Then by Proposi- tion 3.1 the pair
⟨J(πx,y), J(πx,y)⟩
1	2
is a product. (Notice that the mediating arrow defined by ⟨J(πx,y), J(πx,y)⟩
1	2
is an isomorphism but does not necessarily coincide with sx,y.)	 
We generalise the last theorem to K-products where the naturality of the isomorphism is required within a subcategory K ⊆ [K, C] of product diagrams.
Theorem 3.4 Let K be a discrete category and C, Ð be categories with ter- minal object. Let K ⊆ [K, C] be the full subcategory of diagrams for which products exist in C. The functor J : C → Ð preserves K-products of tuples in K if
whenever ⟨xk⟩k ∈ K then a product of ⟨J(xk)⟩k ∈ K exists in Ð,
J preserves terminal objects, and
there is an isomorphism

J( 

x ) s(x~k⟩k 

J(x )

natural in ⟨xk⟩k ∈ K.
Proof This generalises the proof of Theorem 3.3 above to K-products of tuples within K. It follows by fixing one component at a time and mapping all other components to the terminal object T.	 

General Limits
A small category I can be decomposed into its connected components. We write I = k∈K Ik for this decomposition where Ik’s are the connected com- ponents of I—this assumes that K is a discrete category. A connected com-


ponent Ik is a full subcategory of I and there is an inclusion functor ιk : Ik → I. This functor defines by pre-composition the “restriction” functor

ιk : [I, C] → [Ik, C].

If the category I is connected then we have
[I, C](∆c, ∆d) ~= C(c, d) and the diagonal functor is full and faithful.
Proposition 4.1 Let I =  k∈K Ik be a small category with Ik, where k ∈ K, its connected components. There is an isomorphism
[I, C] H, F  ~=  [Ik, C] H ◦ ιk,F ◦ ιk 
natural in H, F ∈ [I, C] where ιk : Ik → I is the inclusion functor.
Proof The isomorphism takes a natural transformation α : H ⇒ F and splits it into the natural transformations α ιk : H ◦ ιk ⇒ F ◦ ιk. Conversely a collection of natural transformations ⟨βk : H ◦ ιk ⇒ F ◦ ιk⟩k∈K gives a natural transformation β : H ⇒ F . This construction is clearly a bijection and it is preserved through pre- and post-composition and thus is natural in both
variables.	 
A limit can be decomposed into a product of connected limits provided these exist:
Proposition 4.2 Let I =  k∈K Ik be a small category with Ik, where k ∈ K, its connected components. Let D : I → C be a functor. Assume a limiting cone γk with limit object limIk (D◦ιk) for each k ∈ K and a product  k∈K limIk (D◦ιk)


lim
(D ◦ ι )  π	 lim 
(D ◦ ι ) γk


form the components of a limiting cone for D.
Proof From Proposition 4.1 there is an isomorphism

[I, C] ∆c, D ~=   [Ik, C] ∆c, D ◦ ιk 


natural in c. Hence,
[I, C] ∆c, D ~=   [Ik, C] ∆c, D ◦ ιk 



~	C c, lim
←−Ik

(D ◦ ιk)	the limit as a representation,

k∈K
~ C c,	lim
←−Ik
(D ◦ ιk)	since hom-functor preserves limits,

k∈K
all isomorphisms being natural in c. This provides the limit of D as a repres- entation. The limiting cone is obtained as its counit:
id 	 ⟨π k⟩k∈K 	 ⟨γ k ◦ ∆πk⟩k∈K .
 
The task now is to combine the results on products (Theorem 3.4) and on connected diagrams (Theorem 2.2) to treat preservation of more general limits. In order to do so we use two embeddings of functor categories. Assuming C has terminal object T, the first embedding is the right adjoint of  ◦ ιk:
  ◦ιk  
[I, C] ¸⊥,  [Ik, C] .	(1)
 

Given H : Ik → C, the functor H + : I → C is such that it acts as H over the component Ik and as the constant functor ∆T otherwise. The unit of the adjunction (1)above is defined for D ∈ [I, C] as


(η )

=  idD(i)	if i ∈ Ik


which is clearly universal.
Proposition 4.3 Let Ik be a connected component of I. Assume categories C and Ð with terminal objects and a functor J : C → Ð that preserves terminal objects.

there is an isomorphism lim H+ ~= lim
H, and

←−I	←−Ik

there is an isomorphism lim J ◦ H+ ~= lim
J ◦ H.

←−I	←−Ik
In both cases we mean that if one side of the isomorphism exists then so does the other. The isomorphisms are natural in H ∈ K for a subcategory K ⊆ [Ik, C] such that C is K-complete.


Proof For (i) consider the chain of isomorphisms
C(c, lim H+) ~ [I, C] ∆c, H+	the limit as a representation,
←−I
=~ [I , C] (∆c) ◦ ι ,H	by the adjunction (1),
= [Ik, C] ∆c, H 
all natural in c and H ∈ K. As the Yoneda embedding is full and faithful it follows that there is an isomorphism
lim H+ ~= lim H


natural in H ∈ K.
←−I
←−Ik

For (ii) observe that since J preserves the terminal objects it is possible to define an adjunction as (1) with Ð as codomain where J ◦ H + =~ (J ◦ H)+. Thus we have
Ð(d, lim J ◦ H+) ~ [I, Ð] ∆d, J ◦ H+	the limit as a representation,
←−I
=~ [I, Ð] ∆d, (J ◦ H)+
=~ [I , Ð] (∆d) ◦ ι ,J ◦ H	by the adjunction (1),
= [Ik, Ð] ∆d, J ◦ H 
all natural in d and H. It follows that there is an isomorphism

lim J ◦ H+ ~= lim
J ◦ H

←−I	←−Ik
natural in H.	 
There is a less obvious embedding ∆:[K, C] → [I, C] where K is the discrete category whose objects are identified with the connected components of I. Given a tuple ⟨xk⟩k∈K, the functor ∆⟨xk⟩k∈K : I →C acts as the constant ∆xk over the objects and arrows in Ik.
Proposition 4.4 Let J : C → Ð be a functor and I =  k∈K Ik be a small category with Ik, where k ∈ K, its connected components:
there is an isomorphism lim ∆⟨x ⟩	~	x , and
←−
there is an isomorphism lim J ◦ ∆⟨x ⟩	~	J(x ).
←−
In both cases it is meant that if one side of the isomorphism exists then so does the other. The isomorphisms are natural in ⟨xk⟩k∈K ∈ K for a subcategory of K-tuples K ⊆ [K, C] such that C is K-complete.


Proof For (i),

C(c, lim ∆⟨xk⟩k∈K) ~= [I, C] ∆c, ∆⟨xk⟩k∈K	the limit as a representation,
~=   [Ik, C] ∆c ◦ ιk, ∆⟨xk⟩k∈K ◦ ιk  by Proposition 4.1,
=   [Ik, C] ∆c, ∆Ik xk	by definition of ∆,

= [K, C] ∆c, ⟨xk⟩k∈K 

all natural in c and ⟨xk⟩k∈K. Thus lim ∆⟨xk⟩k∈K is isomorphic to  k∈K xk =

lim
←−K
⟨xk⟩k∈K with naturality following from Yoneda. In a similar way, using

the identity
J ◦ ∆x = ∆J(x) ,
we can prove (ii).	 
Now we can reduce the preservation of general limits to naturality.
Theorem 4.5 Let C, Ð be complete categories. A functor J : C → Ð is continuous, i.e. preserves all limits, if and only if for any small category I there is an isomorphism
J(lim D) =~ lim (J ◦ D)	(2)


natural in D ∈ [I, C].
←−I
←−I

Proof The “only-if” part follows as usual. For the “if” part first observe that J trivially preserves terminal objects: take I to be the empty category. Let I = k∈K Ik be a non-empty small category with Ik, where k ∈ K, its connected components. By Proposition 4.2, a diagram D : I →C has a limiting
cone with components


lim
(D ◦ ι )  πk  lim 
(D ◦ ι ) γk



with projections π and where γk is the limiting cone associated with lim
←−Ik
(D ◦

ιk). So, it is enough to verify that the cone with components

J(γk) ◦ J(πk)

is limiting. For this it suffices to show that ⟨J(πk)⟩k∈K is a product and that for every k the cone Jγk is limiting.



However,


J(   xk) ~= J(limI∆⟨xk⟩k)	by Proposition 4.4,

k∈K
~ lim (J ◦ ∆⟨x ⟩ )	by assumption (2),
←−I
~=	J(xk)	by Proposition 4.4,
k∈K
all natural in ⟨xk⟩k ∈ [K, C]. So J preserves K-products by Theorem 3.4 and
⟨J(πk)⟩k∈K above is a product.
Similarly,


J(lim
←−Ik
~ J(lim H+)	by Proposition 4.3,
←−I
lim (J ◦ H+)	by assumption (2),
←−I
lim (J ◦ H+)	by Proposition 4.3,
←−I

all natural in H ∈ [Ik, C]. Thus J preserves Ik-limits by Theorem 2.2 and
J(γk) above is a limit for J(D ◦ ιk).	 
The proof of the theorem above can be carried out under more liberal as- sumptions, to cover the preservation of I-limits, for a particular small category I.
Theorem 4.6 Let I be a small category. Suppose categories C and Ð are categories with terminal objects and all I-limits. A functor J : C → Ð preserves I-limits if
J preserves terminal objects, and
there is an isomorphism J(lim D) ~= lim (J ◦ D), natural in D ∈ [I, C].
←−I	←−I
Proof Let I =	k∈K Ik with Ik, for k ∈ K, being its connected components. Having I-limits implies having Ik-limits for k ∈ K (Proposition 4.3), and K-
products (Proposition 4.4). Whereupon the proof can be conducted as for Theorem 4.5.	 

Preservation of colimits
Of course, we have dual results concerning the preservation of colimits. The main theorems are:
Theorem 4.7 Suppose the category I is small and connected. Suppose cat- egories C, Ð have all I-colimits.

A functor J : C → Ð preserves I-colimits iff there is an isomorphism
J(lim D) =~ lim (J ◦ D) ,


natural in D ∈ [I, C].
−→I
−→I

Theorem 4.8 Suppose the category I is small. Suppose categories C, Ð have all I-colimits. Suppose that J preserves initial objects.
A functor J : C → Ð preserves I-colimits iff there is an isomorphism
J(lim D) =~ lim (J ◦ D) ,


natural in D ∈ [I, C].
−→I
−→I

Theorem 4.9 Suppose categories C, Ð are cocomplete.
A functor J : C → Ð preserves all colimits iff for all small categories I
there is an isomorphism
J(lim D) =~ lim (J ◦ D) ,


natural in D ∈ [I, C].

Examples
−→I
−→I

The point of this section is to indicate the practicality of the theorems proved here in establishing limit and colimit preservation. But for this we need a rich repertoire of methods to construct natural isomorphisms, and these in turn demand an expressive language for functors. To this purpose the language of ends and coends is highly suitable. So, ends justify the means. We refer the
reader to the literature (e.g. [6,2]) for an introduction to ends and coends (a
summary may also be found in the appendix of [4]).
Ends subsume limits and we can write  F (i) instead of the limit object
lim D when F : I → Ð is a functor; we can write  i F (i) for the (choice of)
←−I
colimit of F : I → Ð. The set of natural transformations between functors
F, J : I →Ð can be expressed as an end in Set, the category of sets:
[I, Ð](F, J) = ∫i Ð(F (i), J(i)) .

Right adjoints preserve limits
As an indication of how to combine facts about naturality to deduce limit preservation in a fairly mechanical way we show the well-known fact that the


right adjoint preserves limits. Suppose there is an adjunction and diagrams
H:
  F  
C ¸⊥,  Ð	I.
G
We first show a chain of natural isomorphisms:


←−I
←−I
~= [I, Ð](F (c)H)	the limit as a representation,
~=	Ð F (c),H(i)	the end formula for nat. trans.,
~=	C c, J ◦ H(i)	by the adjunction,
~= [I, C] ∆c, J ◦ H	the end formula for nat. trans.,
~= C c, lim (J ◦ H)	the limit as a representation,

all natural in c and H. So we have deduced the existence of an isomorphism
C c, J(lim H) =~ C c, lim (J ◦ H) 
between representables, natural in H. But now because the Yoneda embedding is full and faithful we deduce
J(lim H) ~= lim (J ◦ H) ,
←−I	←−I
natural in H. It follows by Theorem 4.5 that the right adjoint J preserves limits.
This illustrates an equational style of reasoning based on judgements of natural isomorphism to derive results on (co)limit preservation, with the Yoneda lemma providing an extensionality principle.

Fubini and colimit preservation
In the manipulation of ends and coends the interchange of ‘integrals’ is essen- tial and justified by the ‘Fubini theorem’, stated here for coends. (The Fubini theorem is usually stated in greater generality to allow for the category Ð not having all colimits.)

Fubini theorem: Given a functor F : Iop × I × Jop × J → Ð, where Ð is a cocomplete category,
i j F (i, i, j, j) ~=	j  i F (i, i, j, j) .
The isomorphisms are natural in F .


From the Fubini theorem for coends we see a sense in which the operation of formation of coends preserves colimits. More precisely, suppose Ð is cocom- plete. For any functor F : Jop × J → Ð we can form the coend j F (j, j), and this operation is functorial in F . Call this resulting functor J—we might alternatively describe the functor J using lambda notation as λF. j F (j, j).
Now, J preserves colimits. In other words, j F (j, j) preserves colimits in the parameter F . By Theorem 4.9, it is sufficient to observe the following chain of isomorphisms are all natural in D : I → [Jop × J, Ð]:
J( i D(i)) ~=  j ( i D(i))(j, j)
~= ∫ j (∫ i D(i)(j, j))	as coends are computed pointwise,

~= ∫ i J(D(i)) .

Composition of profunctors
Profunctors (or distributors or bimodules) are a categorical generalisation of relations [1,5]. They appear in many contexts and, in particular, in modelling nondeterministic processes [4]. A profunctor F : P + Q  between small cat- egories P and Q is a functor F : P × Qop → Set to the category of sets. The composition of profunctors F : P + Q  and J : Q + R  is given by the coend
JF (p, r) =	q F (p, q) × J(q, r) .

The coend is functorial in p and r. We have the following chain of isomorph- isms, all natural in a diagram F : I → [P × Qop, Set]:
J(  iF (i)) =~ λp, r.	q ( iF (i))(p, q) × J(q, r)
=~ λp, r.	q ( iF (i)(p, q)) × J(q, r) the F –colimit is got pointwise,
=~ λp, r.	q	i(F (i)(p, q) × J(q, r))  Set-product is a left adjoint,
=~ λp, r.	i q (F (i)(p, q) × J(q, r)) by the Fubini theorem,
=~ ∫ iλp, r.∫ q (F (i)(p, q) × J(q, r)) the colimit is got pointwise,

Hence, by Theorem 4.9, the composition of profunctors JF preserves colimits regarded as a functor in F (and similarly as a functor in J). This result is important in work modelling nondeterministic processes as presheaves (which are essentially profunctors from 1 the one object, one arrow category). The result ensures that horizontal composition of 2-cells in the bicategory of pro- functors preserves open maps and open-map bisimulation. A central theorem


here is that connected colimit preserving functors between presheaf categories preserve surjective open maps and open-map bisimulation; so Theorem 4.7 also plays a useful role. Much more can be found in [4].

Acknowledgement
Thanks are due to Martin Hyland. Inspiration for this work came from his Cambridge Part III lectures on category theory in the Michaelmas term 1995, emphasising ends and coends. The results here have the aura of folklore about them, though we have not been able to find them stated in the literature. At the very least, we hope that our paper makes these results and their usefulness more widely known. The authors acknowledge their indebtedness to BRICS, Aarhus where this work was started.

References
B´enabou, J., Distributors at work, 2000.
C´accamo, M. and G. Winskel, Lecture notes in category theory, based on Martin Hyland’s Cambridge Part III lectures, to appear as BRICS lecture notes series, 2004.
Cattani, G. L., “Presheaf Models for Concurrency,” Ph.D. thesis, BRICS - University of Aarhus, 1999.
Cattani, G. L. and G. Winskel, Profunctors, open maps and bisimulation, accepted by MSCS, April 2004.
Lawvere, F. W., Metric spaces, generalized logic, and closed categories, Rendiconti del Seminario Matematico e Fisico di Milano XLIII, 1973, pp. 135–166.
Mac Lane, S. and I. Moerdijk, “Sheaves in Geometry and Logic: A First Introduction to Topos Theory,” Springer-Verlag, 1992.
Par´e, R., Simply connected limits, Canadian Journal of Mathematics XLII (90), pp. 731–746.
