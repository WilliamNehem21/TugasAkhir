Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 350 (2020) 73–90
www.elsevier.com/locate/entcs

A Unified View on Bipartite Species-reaction Graphs and Their Relation to Interaction Graphs and Qualitative Dynamics of Chemical Reaction Networks
Hans-Michael Kaltenbach1,2
Department of Biosystems Science and Engineering ETH Zurich, Basel, Switzerland

Abstract
The Jacobian matrix of a dynamic system and its principal minors play a prominent role in the study of qualitative dynamics and bifurcation analysis. When interpreting the Jacobian as an adjacency matrix of an interaction graph, its principal minors reate to sets of disjoint cycles in this graph and conditions for qualitative dynamic behaviors can be inferred from its cycle structure. The Jacobian of chemical reaction systems decomposes into the product of two matrices, which allows more fine-grained analyses by studying a corresponding bipartite species-reaction graph. Several different bipartite graphs have been proposed and results on injectivity, multistationarity, and bifurcations have been derived. Here, we present a new definition of the species-reaction graph that directly connects the cycle structure with determinant expansion terms, principal minors, and the coefficients of the characteristic polynomial. It encompasses previous graph constructions as special cases. This graph has a direct relation to the interaction graph, and properties of cycles and sub-graphs can be translated in both directions. A simple equivalence relation enables simplified decomposition of determinant expansions and allows simpler and more direct proofs of previous results.
Keywords: chemical reaction network; determinant; bipartite graph; interaction graph; line-graph; qualitative dynamics


Introduction
The analysis of chemical reaction systems is hampered by the fact that parameters such as kinetic rate constants are inherently difficult to obtain from experimental data, and that in-vitro parameters might not translate to in-vivo experiments. In contrast to general dynamic systems, however, the dynamics of a chemical reaction system is constrained by the stoichiometry and topology of the reaction network. Moreover, while the exact algebraic form of chemical rate laws is often difficult

1 Email: michael.kaltenbach@bsse.ethz.ch
2 We would like to thank Irene Otero Muras, Markus Beat Du¨rr and J¨org Stelling for fruitful discussions. Financial support from the EU FP7 project UNICELLSYS is gratefully acknowledged.

https://doi.org/10.1016/j.entcs.2020.06.005
1571-0661/© 2020 The Author(s). Published by Elsevier B.V.
This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).

to determine, they are typically monotone in the reactant’s concentrations. Sev- eral approaches have been proposed that exploit these constraints and allow to determine—without knowledge of parameter values and with minimal conditions on the rate laws—if a reaction network is capable of specific qualitative dynamics such as oscillations and multiple equilibria, and to establish stability of equilibria. While methods such as Chemical Reaction Network Theory [14,10,9], Stoichio- metric Network Analysis [4], and Biochemical Systems Theory [17,18,19] exploit the particular algebraic structure of reaction systems, more recent methods focus on graphical representations of the Jacobian matrix of the dynamical system and its properties. Two main classes of graphs have been proposed: signed interaction graphs interpret the Jacobian as an adjacency matrix and relate chemical species that participate in the same reaction. Then, a positive cycle is necessary for mul- tistationarity, whereas a negative cycle is necessary for oscillations [11,23,22,15]; other criteria have also been investigated [8]. The absence of negative undirected cycles implies monotonicity with respect to an orthant cone, ruling out chaotic and
oscillatory dynamics [21,20,13].
On the other hand, the Jacobian of a reaction system can be written as the product of the stoichiometric matrix and the Jacobian of the reaction rate laws, giving rise to representations by bipartite species-reaction (SR) graphs with different vertices for species and reactions. Several SR graphs have been proposed in the context of qualitative dynamics, such as undirected [6,3] and directed [16] species- reaction graphs, and graphs with multiple edge-types [3]. Oriented versions of undirected SR-graphs also need to be considered in [6]. Criteria for the existence of multiple equilibria and oscillations [3,16,5,6] and for establishing monotonicity [21,1] have been derived. Exploiting the relation of principal minors of a matrix and cycles in its associated graph to coefficients in the characteristic polynomial allows inferring the possibility of saddle-point and Hopf bifurcations in a system [16].
In this work, we elucidate how the various interaction- and bipartite-graph- based methods are related and propose a new definition of the species-reaction graph, named directed species-reaction graph (DSR-graph), that provides additional insight into several established results. We develop and emphasize the direct relation between determinant expansions, principal minors, the Jacobian matrix and its interaction graph, and our DSR-graph, making use of long-known relations [12]. We present refined criteria for sign-definiteness of the determinant of the Jacobian and its principal minors based on a simple equivalence relation of subgraphs of our DSR-graph and show the equivalence of two criteria developed independently in [16] and [6].
Chemical Reaction Networks
A chemical reaction network is given by its chemical species S1,..., Sn and associ- ated reactions R1,..., Rr. A reaction Rj describes how a set of species transforms into another set of species and is formally given by


Rj : y1,jS1 + ··· + yn,jSn −→ yj
S1 + ··· + yj
Sn ,

where yi,j ∈ N is the molecularity of the substrate Si and yj
∈ N that of the product

Si. Reversible reactions are modeled as two irreversible reactions: the forward and
backward reaction. We require that no species is both substrate and product of a reaction, i.e., we exclude reactions such as A + B → 2A; the stoichiometric matrix

N ∈ Zn×r is then the well-defined matrix with entries Ni,j = yj
— yi,j, where

Ni,j > 0 (resp. Ni,j < 0) if species Si is a product (resp. a substrate) of reaction Rj,
and Ni,j = 0 if it does not participate in the reaction.
We denote by xi(t) ∈ R≥0 the concentration of species Si at time t and define the state vector x ≡ x(t) = (x1(t),..., xn(t))T . We adopt the usual convention of dropping the explicit dependence on t. The temporal dynamics of the reaction system is described by the nonlinear ordinary differential equations
d x(t)= f (x(t), k)= N · v(x(t), k) ,	(1)
dt
where v(x(t), k)= (v1(x(t), k),..., vr(x(t), k))T is the vector of reaction rates with positive rate parameters k. The reaction rate vj(x(t), k) describes the velocity of reaction Rj as a function of the current state x of the system. We restrict attention to non-autocatalytic rate laws, for which ∂vj/∂xi > 0 if species Si is a substrate of reaction Rj and all concentrations are positive, and ∂vj/∂xi ≡ 0 if Si is not a substrate of Rj. Thus an increase in a substrate concentration cannot decrease the reaction rate and species that are not substrates do not influence the reaction rate. Very similar conditions for reversible reactions were given in [3].
We model mass transport over the boundaries of the system by inflow reactions of the form Rj : ∅→ Si with constant rate vj(x, k)= kj > 0 and outflow reactions Rj : Si →∅ with rate vj(x, k)= kj · xi.
Jacobian Matrix and Qualitative Dynamics
The Jacobian of a reaction system (1) is the function


J =	∂fi
∂xj


1≤i,j≤n
= N ·	∂vi
∂xj
.
1≤i≤r,1≤j≤n

Evaluated at some state x0, the resulting matrix J (x0) allows to approximate the system’s dynamics in the vicinity of x0.
A multi-index of size |α| := l is a tupel α = (α1,..., αl) ⊆ {1,..., n} with α1 < ··· < αl. We denote by J α the submatrix of J obtained by selecting the rows and columns with index in α; its determinant det(J α) is called a principal minor of order |α|.
The characteristic polynomial of J depends on the system state x and is formally given by


PJ (λ)= det(λI−J )= λn+cn—1λn—1+·· ·+c1λ+c0	with	ci = (−1)n—i
α⊆{1,...,n}
|α|=n−i
det(J α) .

The signs of the principal minors thus play a prominent role in determining the qualitative dynamics of a chemical reaction system: (i) multistationarity is excluded in fully open systems for non-autocatalytic reaction rates if all principal minors of det(—J α) are positive for all x > 0 [2]; this criterion simplifies to det(—J ) > 0 for mass-action kinetics [7]. (ii) A necessary condition for a saddle-node bifurcation is a single zero eigenvalue, which only exists if c0 = 0 and thus det(J ) = 0. (iii) A Hopf-Andronov bifurcation requires a single pair of conjugate eigenvalues with zero real part. Under certain conditions, the vanishing of coefficients ci = 0 for i /= 0 implies that the Hurwitz determinant of order (n — 1) vanishes, which in turn is a necessary condition for a conjugate pair of imaginary eigenvalues [16].

Determinant Expansions and Interaction Graph
Recall that the determinant expansion of det(J ) can be computed by
det(J )= Σ(—1)sign(π)  Ji,π(i) ,	(2)
where π runs over the permutation group on {1,..., n} and sign(π) is its sign. Note that Ji,π(i) depends on system state and parameter values. The expansion can equivalently be formulated in graphical terms by interpreting J as an adjacency matrix for the interaction graph GI , whose vertex set are the species S1,..., Sn, and there is an edge e = (Si, Sj) with (formal) label γ(e) = Jji whenever Jji /≡ 0. A cycle is a sequence of edges that starts and ends in the same vertex; it is simple if no vertex occurs more than once.
Definition 4.1 [line-graph [12]] Let C1,..., Cq be a collection of disjoint simple cycles Ci covering each vertex of a graph G exactly once:
V (G)= V (C1) ∪ ··· ∪ V (Cq)	and	V (Ci) ∩ V (Cj)= ∅ if i /= j . 


Their union

q
L :=	Ci ⊆ G
i=1

is a sub-graph of G called a line-graph. The label of L is γ(L) =	e∈L γ(e). We denote by L(G) the collection of all line-graphs of G.
A line-graph is also called Hamiltonian hooping [22] or nucleus [8], and the special definition of a subgraph in [16] relates to the same concept.

Line-graphs correspond to permutations: for any permutation π, the term  n
Ji,π(i)

of the determinant expansion is nonzero if and only if all corresponding edges
(Sπ(i), Si) exist in GI . Since these edges form a line-graph L, the product is equal to the label of this line-graph: γ(L)= Ji,π(i). The sign of the permutation is also readily extracted from the graph:

Definition 4.2 [signum of a line-graph] Let ϵ(L) be the number of even-length cycles in a line-graph L. Then,
ω(L) := (—1)є(L) .

is called the signum of L and corresponds to the sign of the permutation given by
L [12].
Note that ω(L) is independent of sign(γ(L)). It is directly related to the signum ξ(L) proposed in [22] via ω(L) = —ξ(—L), where —L denotes the line-graph with edge-labels —γ(·). We can now formulate the determinant expansion of J in purely graphical terms:
Lemma 4.3 (Harary [12]) The determinant expansion of J is given by

det(J )=	Σ
ω(L) γ(L)=	Σ

   ω(C) γ(C) .	(3)

	

The problem of determining the sign of the determinant then involves deter- mining the signs of the line-graphs, which in turn depend on the signs of their constituent edges. We call an edge sign-deﬁnite if the sign of its label is indepen- dent of the system state x. The following lemma establishes sign-definiteness from properties of the reaction network.
Lemma 4.4 (sign-definite edges) Let GI be an interaction graph. An edge (S, Sj) ∈
E(GI ) is sign-deﬁnite if and only if there are no two reactions R, Rj such that S and
Sj are both substrates in R, and S is substrate and Sj product in Rj, respectively.
Proof. W.l.o.g., let S = Si and Sj = Sj. The edge label is then


γ((S ,S )) = J
= Σ N

∂vl .

If Si is not a substrate in Rl, then ∂vl/∂xi ≡ 0, so assume Si is a substrate for two reactions Rl and Rp. If Sj is also a substrate of Rl, then Nj,l < 0 and Rl provides a negative contribution to the sum. If Sj is a product of another reaction Rp, then Nj,p > 0 and Rp provides a positive contribution to the sum, making its sign dependent on x. The overall sign of γ((Si, Sj)) is thus indefinite if and only if Sj is a substrate in one and a product in another reaction, which can be established from the stoichiometric matrix alone.	2
We remark that these considerations also hold for any principal minor by re- stricting attention to its induced subgraph of GI . This allows computing each coefficient ci of the characteristic polynomial by investigating the line-graphs of all sub-graphs G(J α) with |α| = n — i.

The Directed Species-Reaction Graph
Analysis of qualitative dynamics via interaction graphs is considerably hampered by the fact that most networks contain sign-indefinite edges. Moreover, edge-labels are often sums of terms containing different rate-derivatives, making them hard to compare independently of a species concentration x. These problems can be ad- dressed by exploiting the particular structure of chemical reaction systems which naturally leads to a bipartite graph with vertices for species and reactions. Our pro- posed directed species-reaction (DSR) graph directly relates to previous definitions of bipartite graphs, but remedies several shortcomings. It also directly relates to the interaction graph, and we exploit this relation by formulating a corresponding determinant expansion in terms of appropriately defined line-graphs. A key obser- vation is that line-graphs of a DSR naturally fall into equivalence classes and that arguments about the sign of principal minors can be resolved by looking at each equivalence class.
Definition 5.1 [directed species-reaction graph] The directed species-reaction graph (DSR-graph) G = (VS, VR, E, λ) of a chemical reaction network is a bipartite, di- rected graph with edge-label function λ given by the sets of
species vertices VS = {S1,..., Sn} ;	reaction vertices VR = {R1,..., Rr}
and the edge set E = ESR ∪ ERS consisting of


rate edges:
E	= {(S ,R ) ∈ V  × V


| ∂v /∂x

/≡ 0} with labels λ((S ,R )) = ∂vj

SR	i	j
S	R	j	i
i	j	∂xi

stoichiometric edges:
ERS = {(Rj, Si) ∈ VR × VS | Ni,j /= 0} with labels λ((Rj, Si)) = Ni,j
The restriction of λ to ESR and ERS is denoted by λSR (a rate label ) and λRS (a
stoichiometric label ), respectively, such that for a sub-graph H of G we have


λRS(H) :=
(Si,Rj )∈ERS (H)
Nij ∈ R	and	λSR(H) :=
e∈ESR(H)
λ(e) ,

and λ(H)= λRS(H) · λSR(H). Importantly, λSR(H)(x) > 0 for all x > 0. Either label remains undefined if the respective edge-set is empty.
Our DSR-graph deviates in small but important aspects from previous defini- tions of bipartite species-reaction graphs: The SR-graph of [7] uses undirected edges and labels them by the complex in which the species occurs. Species on the same side of a reaction form a c-pair. All possible orientations of the graph are consid- ered in proofs. In our DSR-graph, these information are encoded explicitly in the existence and direction of edges and two products do not form a c-pair. Instead of c-pairs, a similar undirected graph in [2] labels edges by +1 or —1 to the same

effect. The graph proposed in [16] uses directed edges, but does not contain edges from a reaction to its substrates. Directed edges from a substrate to its reaction can instead be traversed in opposite direction, while directed edges from a reaction to a product cannot, which also necessitates to allow semi-cycles and paths in a line-graph. In this graph, mass-action kinetics is also exploited by merging the cor- responding factor from ∂vj/∂xi (which is the substrate molecularity of Si in Rj) with the stoichiometric label and using relative concentrations.
Example 5.2 Consider a simple reaction network with two species A, B and reac- tions
R1 : aA → bB ; R2 : cB → dA ; R3 : A → ∅ ; R4 : ∅→ A ; R5 : B → ∅ ; R6 : ∅→ B
The DSR-graph of this network is given in Figure 1 and has an intuitive interpre- tation: a reaction vertex represents the rate of the reaction, which is positively influenced only by its substrates. A change in the rate implies a positive change in the rate of the products, and a negative change in the rate of the substrates; this is reflected by the corresponding edges. The rate-edge labels λSR are positive functions, and the state-independent label λRS of a stoichiometric edge is positive for a product, and negative for a substrate.
In contrast to the interaction graph, any subgraph of a DSR-graph is sign- definite:
Proposition 5.3 (sign-definite sub-graphs) Let H ⊆ G be any sub-graph of a DSR-graph G such that ERS(H) /= ∅. Then,
sign(λ(H)) = sign(λRS(H)) · sign(λSR(H)) ≡ sign (λRS(H))
≥0
is independent of the system state x > 0.
The proposed DSR-graph directly relates to the interaction graph of the same network. Most results on injectivity and bifurcations rely on the fact that simple paths and simple cycles in GI translate to simple paths and simple cycles in G, and we therefore emphasize this relation.
Proposition 5.4 (relation of DSR- and interaction graph) Let G = (VS, VR, E, λ)
be the DSR-graph of a chemical reaction network. The interaction graph GI = (V (GI ), E(GI ), γ) of that network is then found as:
V (GI )= VS
E(GI )= {(S, Sj) ∈ VS × VS | ∃R ∈ VR : (S, R), (R, Sj) ∈ E}

γ((S, Sj)) =
R∈VR
λSR((S, R)) · λRS((R, Sj)) .

An edge in GI may thus correspond to several 2-paths (S, R, Sj) from VS to








Fig. 1. Directed species-reaction graph for network of Example 5.2. Species vertices are given as circles, reaction vertices as rectangles. Production reactions R4, R6 are shown explicitly, but can be neglected for analyses. We use A, B instead of xA, xB for readability.
VS in G via different reactions R ∈ VR. Each summand of the edge-label in GI
corresponds exactly to one of the labels of a 2-path in G.
Example 5.5 In the network of Example 5.2, consider the upper-left entry


J1,1
 ∂v1
= —a
∂xA
—  ∂v3
∂xB

in the Jacobian matrix. The corresponding edge (A, A) in GI corresponds to the
2-paths (A, R1, A) with label —a  ∂v1  and (A, R3, A) with label —  ∂v3  in the DSR-
graph.
With J = N · (∂v/∂x), the stoichiometric matrix is the incidence matrix de- scribing stoichiometric edges and their labels in G, while (∂v/∂x) is the incidence matrix describing the rate edges and their labels. The adjacency matrix of G is
B =	0	N	.
(∂v/∂x) 0
All 2-paths from VS to VS are described by the upper-left n × n sub-matrix of B2, which is just J . By extension, an edge, a simple cycle or a line-graph in GI typically correspond to several 2-paths, cycles or sub-graphs in G, respectively. This one-to-many mapping induces an equivalence relation on G.
Definition 5.6 [equivalence of 2-paths] Consider a reaction network with DSR- graph G = (VS, VR, E, λ) and interaction graph GI = (V (GI ), E(GI ), γ). Let e = (S, Sj) ∈ E(GI ) be an edge and denote by
⟨e⟩ := {((S, R), (R, Sj)) ∈ E × E | R ∈ VR}

the set of all corresponding 2-paths in G. Two 2-paths p, pj of G are equivalent if
p, pj ∈ ⟨e⟩ for an e ∈ E(GI ).
Definition 5.7 [species-cycle; species-line-graph] The equivalence relation is ex- tended to cycles C = (e1,..., eq) and line-graphs L = C1 + ··· + Cq of GI by
⟨C⟩ := {(p1,..., pq) | pi ∈ ⟨ei⟩}	and	⟨L⟩ := {D1 + ··· + Dq | Di ∈ ⟨Ci⟩} .
An element of ⟨C⟩ or ⟨L⟩ is called a species-cycle or species-line-graph in G, respec- tively. Each species-cycle in ⟨C⟩ uses the same set of species-vertices in the same order, but different reaction-vertices. Each species-line-graph is a set of simple dis- joint species-cycles covering each species-vertex exactly once. We again denote the set of all species-line-graphs in G by


L(G) :=
L∈L(GI )
⟨L⟩ .

Example 5.8 Consider a Michaelis-Menten type mechanism, given by the reactions
R1 : E + S → ES ;	R2 : ES → E + S ;	R3 : ES → E + P
The DSR-graph for this mechanism is given in Figure 2. The edge e = (ES, E) ∈ E(GI ) corresponds to the equivalence class ⟨e⟩ = {(ES, R2, E), (ES, R3, E)} in G. The cycle C = (ES, S, ES) of GI thus corresponds to two species-cycles in G, using either 2-path from ⟨e⟩ together with the 2-path (E, R1, ES):
⟨C⟩ = {(ES, R2, E, R1, ES), (ES, R3, E, R1, ES)} .



Fig. 2. DSR-graph of Michaelis-Menten type mechanism of Example 5.8.


Determinant expansionss and DSR-Graph
We now turn our attention to the expansion of det(J ) (and consequently det(J α)) in terms of the DSR-graph. We are particularly interested in conditions that guarantee that the determinant does not vanish for any positive system state x > 0.

Lemma 6.1 (signum of sub-graph) Let L ⊆ G be a line-graph of G and deﬁne the signum of L as
σ(L) := (—1)є(L)
with ϵ(L) the number of cycles in L with even number of species-vertices. Then,
ω(C) = σ(D)
for any cycle C ⊆ GI and D ∈ ⟨C⟩.
Proof. A species-cycle D in G with k species-vertices corresponds to a cycle C in
GI of length k. Thus, ω(C)= (—1)k = σ(D).	2
A determinant expansion purely in terms of a DSR-graph is now easily found.
Lemma 6.2 (determinant expansion by DSR-graph) Consider a chemical re- action network with Jacobian J and DSR-graph G. Then,

det(J )= 
L∈L(G)
σ(L) λ(L) .

Proof. We reduce the expression to the one found for GI in Lemma 4.3:

Σ σ(L) λ(L)=	Σ

Σ ω(Lj) γ(Lj)=	Σ
ω(Lj) γ(Lj) ,

where ω and γ are again the signum and label function in GI .	2
Example 6.3 Consider the DSR-graph of Example 5.2, given in Figure 1. Its species-line-graphs are
L1 : (A, R1, B, R2, A);	L2 : (A, R1, A) ∪ (B, R2, B);	L3 : (A, R1, A) ∪ (B, R5, B)
L4 : (A, R3, A) ∪ (B, R2, B);	L5 : (A, R3, A) ∪ (B, R5, B)
corresponding directly to the five expansion terms

 ∂v1 ∂v2
det(J ) = — bd
∂x  ∂x
`	L˛¸1	x
 ∂v1 ∂v2
+ ac
∂x  ∂x
`	L˛¸2	x
 ∂v1 ∂v5
+ a
∂x  ∂x
`	L˛¸3	x
 ∂v3 ∂v2
+ c
∂x  ∂x
`	L˛¸4	x
 ∂v3 ∂v5
+	.
∂x  ∂x
`	L˛¸5	x

In contrast to the determinant expansion from GI , the sum-of-products rep- resentation of labels of G yields a direct correspondence of species-line-graphs and expansion terms. Terms have the same partial derivatives if their species-line-graphs have identical substrate-reaction edges. This observation motivates to identify com- patible line-graphs in G and determine their overall contribution to the expansion from their stoichiometric labels.
Proposition 6.4 (compatibility) Let H, Hj be two sub-graphs of G. The relation
H, Hj compatible : ⇐⇒ ESR(H)= ESR(Hj)

deﬁnes an equivalence relation which we denote by H ∼ Hj. We further write
[H] := {H ⊆ G | Hj ∼ H}
for the equivalence class of a sub-graph H. In particular, ∼ partitions L(G) into equivalence classes in the quotient set L(G)/ ∼
Proof. Reflexivity, symmetry, and transitivity of ∼ are obvious.	2
As an example, L1 and L2 in Example 6.3 are the only non-trivially compatible species-line-graphs. The notion of compatibility suggests a strategy to determine if det(J ) vanishes by summing over each individual compatibility class of L(G). If all classes are either non-negative or non-positive, the sign of the determinant is independent of the state x.
Definition 6.5 [stoichiometric term of equivalence class] Let G be a DSR-graph and consider a compatibility class [L] ∈ L(G)/ ∼. The term

Λ([L]) :=
L′∈[L]
σ(Lj)λRS(Lj)

is called the stoichiometric term of [L]. It is a constant independent of x and is computed from the stoichiometric matrix alone.
Lemma 6.6 (computing stoichiometric terms) Fix a species-line-graph L ∈
L(G). Let rj be the index of the unique reaction with substrate Sj in L. Deﬁne the
n × n matrix W L by



Wi,j
=	1,	if (Sj, Rrj ) ∈ ESR(L) 0,	else ,

and let N L be the n × n stoichiometric matrix with columns not in {r1,..., rn}
removed. Then,
Λ([L]) = det (N L · W L)= ± det (N L)	(4)
with the sign determined uniquely by W L.
Proof. The matrix N L · W L corresponds to a graph containing only rate edges corresponding to substrate-reaction pairs of [L]; its determinant sums the contribu- tions of all remaining species-line-graphs in that graph. Moreover, W L is simply a permutation matrix whose determinant is thus ±1.	2
Theorem 6.7 (determinant expansion by compatibility classes) Consider a reaction network and let J be its Jacobian matrix and G its DSR-graph. Then,

det(J )= 
[L]∈L(G)/~
Λ([L]) · λSR(L) .	(5)

The determinant is non-negative for all x > 0 if
Λ([L]) ≥ 0 for all [L] ∈ L(G)/ ∼

and positive if in addition Λ([L]) > 0 for at least one compatibility class. Similar conditions hold for non-positivity (negativity) of the determinant.
Proof. Because ∼ is an equivalence relation on L(G), we can partition the sum of Lemma 6.2 by each equivalence class. Note that the rate label is identical and non-negative for all members of a class. If all stoichiometric terms are non-negative, then so is the sum.	2
Note that (5) together with (4) is a graphical version of the Cauchy-Binet formula for det(N ·∂v/∂x). We can now restrict our attention to establishing non-negativity (or non-positivity) of the stoichiometric term for each compatibility class. For convenience we focus on det(J )= (—1)n det(−J ), which is found by inverting signs of stoichiometric edges in G. The determinant expansion is obviously non-zero if and only if the expansion of det(J ) is. We start by giving a sufficient condition to find a positive expansion term in open networks.
Lemma 6.8 (existence of positive term in open networks) Consider a reac- tion network and assume that there is an inflow reaction ∅ → Si and an outflow reaction Ri : Si →∅ for each species Si, 1 ≤ i ≤ n. Consider the DSR-graph G(—J ) and let Lout be the species-line-graph

n
Lout :=	(Si, Ri, Si) ,
i=1
of 2-paths from each species to itself via its outflow reaction. Then,
[Lout]= {Lout}
Λ([Lout]) > 0
Λ([Lout]) · λSR(Lout) > 0 for all x > 0
Proof. First note that Si is a substrate to Ri, so ((Si, Ri), (Ri, Si)) ∈ E × E for each species Si. Thus, Lout is indeed a species-line-graph. Since there is no other edge out of an outflow reaction, no other species-line-graph can use the same substrate-reaction pairs and thus the compatibility class has a single element. Each cycle in Lout has exactly one species-vertex and thus σ(Lout) = +1. Further, its stoichiometric edge is positive in G(—J ) and thus the stoichiometric term of [Lout] is also. For positive concentrations, the outflow rate changes are positive, proving the last claim.	2
Next, we show that species-line-graphs that contain both the forward- and back- ward reaction of a reversible reaction always lead to a zero stoichiometric term for their compatibility class. This result also gives a retrospective justification for split- ting reversible reactions.
Lemma 6.9 (zero-contribution of reversible reaction) Let L ∈ L(G) be a species-line-graph. Let Rf , Rb be the forward and backward reaction of a reversible

reaction and assume Rf , Rb ∈ VR(L). Then,
Λ([L]) ≡ 0 .

Proof. The construction in this proof is illustrated in Fig. 3. Denote by Sf , Sr ∈ VS(L) the species with (Rf , Sf ), (Rb, Sb) ∈ ERS(L). Because Rf , Rb constitute one reversible reaction, the edges (Rf , Sb), (Rb, Sf ) exist in the graph G. Construct a sub-graph Lj by replacing (Rf , Sf ), (Rb, Sb) by (Rf , Sb), (Rb, Sf ). If Rf , Rb are contained in one species-cycle C3 ∈ L, they are now contained in two different cycles C1, C2 ∈ Lj (or vice-versa). Thus, Lj is a species-line-graph and Lj ∼ L. Moreover, λ((Rf , Sf )) = —λ((Rb, Sf )) and λ((Rb, Sb)) = —λ((Rf , Sb)) and thus λ(L)= λ(Lj).
However, let ni := |E(Ci)|, then
σ(C1)σ(C2)= (—1)n1—1 (—1)n2—1 = (—1)n3—2 = —σ(C3)
and thus σ(Lj)λ(Lj) = —σ(L)λ(L). This construction gives a bijection between species-line-graphs L and Lj and thus Λ([L]) ≡ 0.	2


Fig. 3. Illustration of construction for Lemma 6.9. A cycle containing the forward- and backward reaction is split into two cycles, leading to a compatible line-graph with same absolute label, but opposite sign. Dashed line: arbitrary path through the graph; bold line: substrate-reaction edges defining the compatibility class.


Fig. 4. Illustration of compensating cycles. For a cycle Cycle 1 (C), a compatible compensating cycle (center, LC ) always exists, whose stoichiometries might dominate. A second compatible cycle Cycle 2 may however yield the same compensating cycle. Round (rectangular) nodes denote species (reaction) vertices.

Lemma 6.10 (existence of positive compatible species-line-graphs) Let G(—J )
be a DSR-graph and consider a species-line-graph L containing a cycle C. Construct a sub-graph LC ⊆ G by replacing each 2-path ((S, R), (R, Sj)) in C by ((S, R), (R, S)). Then,

σ(LC)λ(LC) > 0 for all x > 0
LC ∼ C
(L\C) ∪ LC ∼ L.
Proof. The construction is illustrated in Fig. 4. With (S, R) ∈ E(C), species S is a substrate of R. Then, also (R, S) ∈ E(G) and thus LC is a proper sub-graph of G with exactly one odd-length cycle Di from each species-vertex Si ∈ VS(C) to itself. Thus, σ(Di) = +1 and λ(Di) > 0 for all x > 0 and i = 1,..., n. These cycles use the same substrate-reaction pairs as C and thus C ∼ LC. They also cover each species-vertex in C exactly once, so L ∼ (L\C) ∪ LC. As a special case, LC = C if
|VS(C)| = 1.	2
The sign of the contribution of a species-line-graph depends on its constituent species-cycles. Since each sub-graph of a DSR-graph is sign-definite, we can give simple conditions for a species-cycle to be positive or negative by determining the number of substrate-to-substrate 2-paths in the cycle.
Lemma 6.11 (condition for sign of species-cycles) Consider a species-cycle C in a DSR-graph G(−J ). Let s be the number of substrate-pairs, that is, of 2-paths (S, R, Sj) in C, such that S, Sj are both a substrate of R. We call C a p-cycle (an n-cycle) if σ(C)λ(C) > 0) (resp. < 0). Then,
C is p-cycle ⇐⇒ s is even
C is n-cycle ⇐⇒ s is odd .
Proof. We consider the four possible combinations of VS(C) even/odd and s even/odd. For VS(C) even and s odd, the number of negative 2-paths is also odd, thus σ(C) = +1 and λ(C) < 0, as E(C) contains an odd number of negative stoi- chiometric edges. Thus, the overall contribution of C is negative. The other three cases follow the same reasoning.	2
In [7,2] p-cycles (n-cycles) were called e-cycles (o-cycles). As a consequence of Lemma 6.10, we can give a simple condition when a negative contribution to the determinant expansion is cancelled (see also [7,2]).
Proposition 6.12 (dominating term) Let G(—J ) be a DSR-graph and consider a species-line-graph L containing an n-cycle C. Let Lj = (L\C) ∪ LC. Then,
σ(L)λ(L)+ σ(Lj)λ(Lj) ≥ 0 ⇐⇒ λRS(LC) ≥ |λRS(C)| .
We then say that LC dominates C.  We call C a stoichiometric or s-cycle, if
λRS(LC)= |λRS(C)|.
The previous Lemma 6.10 and Proposition 6.12 hold the key to determine, for all x > 0, if a determinant vanishes or not. Clearly, for a species-line-graph L to give a negative contribution to the stoichiometric term Λ([L]) of its compatibility class, it contains an odd number of n-cycles. Replacing one of these n-cycles C

by LC leads to a new compatible species-line-graph with positive contribution that compensates the negative. However, there might be a second species-line-graph in the same class, also with negative contribution that contains another negative cycle that leads to the same compensating species-line-graph. Thus, the compensating species-line-graph needs to dominate the sum of all these contributions. Next, we give conditions when such situation arises and provide a simple sufficient condition that excludes it.
Theorem 6.13 (species-reaction intersection of species-cycles) Consider a species-line-graphs L in G(−J ) and assume that in every compatible species-line- graph, each n-cycle C is dominated by LC. Further assume that
Λ([L]) < 0 .
Then, there are L1, L2 ∈ [L] and two non-disjoint n-cycles C1 ⊆ L1, C2 ⊆ L2 such that all paths in C1 ∩ C2 start in VS and end in VR.
Proof. An illustration for this proof is given in Fig. 5. First note that the non- empty intersection of two cycles is always a collection of paths. Let P be one of the paths in the intersection of C1, C2. If P ends in VS, there are two substrate-reaction pairs involving the same substrate species. Hence, L1, L2 cannot be compatible. If P begins in VR, there are two different species-reaction vertices leading into it, one from C1, one from C2. These edges are contained in all compatible sub-graphs leading to non-simple cycles. The sub-graphs are hence not species-line-graphs. The only remaining case is a path from VS to VR which yields both unique substrate- reaction pairs and (potentially) the same number of reactions and species.	2


Fig. 5. Illustration of non-feasible intersection of cycles in compatible line-graphs. Left: Both possible intersections ending in VS require two substrate-reaction pairs with the same species and cannot occur in compatible sub-graphs. Right: An intersection from VR to VS uses a reaction vertex twice and leads to a zero overall contribution. Round (rectangular) nodes denote species (reaction) vertices. Dotted edges denote arbitrary paths through the graph, bold edges denote substrate-reaction pairs.

As a corollary of the theorem, we get a simple condition of the cycle-structure of a DSR-graph that allows to test if the determinant of the network does not vanishes anywhere. An equivalent condition was first formulated in [7].
Corollary 6.14 (necessary condition for positive determinant) Consider a DSR-graph G(−J ). The determinant det(−J ) is positive if
there is at least one positive stoichiometric term

every cycle C in G is either a p-cycle or dominated by LC
no two n-cycles have an intersection from VS to VR
The existence of a positive term is guaranteed for open networks by Lemma 6.8.
Extensions
The idea of decomposing the determinant expansion using equivalence classes can be extended if a partial order on the rate derivatives ∂vi/∂xj is established. Since λSR(L) is a product of rate derivatives, this order induces a partial order on some compatibility classes L, Lj such that λSR(L) ≥ λSR(Lj) for all x > 0. This order of classes consequently implies that
Λ([L]) > Λ([Lj]) =⇒ Λ([L]) · λSR(L) > Λ([Lj]) · λSR(Lj) ,
allowing comparison of two equivalence classes by their stoichiometric term alone such that a negative contribution of [Lj] can be compensated by a larger positive one of [L], independently of x.
For mass-action kinetics, such a partial order is given for all species-line-graphs that use the same set of reaction vertices. The rate derivatives for mass-action rate laws are of the simple form
∂vi (x∗)= —N	· v (x∗) · 1 .

∂xj


j,i	i	∗
j

Consider now two species-line-graphs L, Lj in G(−J ) with VR(L)= VR(Lj). Then,

λ	(L)=	 
—N  ·v (x∗)·  1
and	λ

(Lj)=	 
—N  ·v (x∗)·  1 ,


	


and thus

λSR(L) λSR(Lj)


(Sj ,Ri)∈E(L) —Nj,i
=
(S ,R )∈E(L′) —Nj,i


independently of x > 0 .

j  i
This allows combining the results for all compatibility classes with the same reaction- vertices, a strategy employed in [7,16]: Let V ∗ be the specific set of n reactions, and let G∗ ⊆ G(−J ) be the DSR-graph with VR(G∗) = V ∗. Then, all species- line-graphs in G∗ give a combined non-negative contribution to the determinant if


[L]∈LΣ(G∗ )/~
Λ([L]) · ⎛
(Si,Rj )∈E(L)
—Ni,j⎞⎠ ≥ 0 .	(6)

This term can be computed similar to Lemma 6.6 by replacing W L by a suitable n×n matrix extracted from N . The term (6) was called a critical fragment (of size n) if it is negative [16] and the question of the relation between critical fragments

and conditions on Corollary 6.14 was raised. Since the products (—Ni,j) are all positive, Corollary 6.14 gives a sufficient condition to exclude a critical fragment, as it establishes non-negativity for each summand in (6).
Discussion
The particular structure of dynamic chemical reaction network models allows to derive conditions for establishing or excluding specific qualitative dynamics. These conditions enable a first analysis and model selection independently of numerical values for rate constants and for all members of a large class of rate laws.
Here, we proposed a new definition of a bipartite species-reaction graph, termed DSR-graph. In contrast to previous definitions, all relevant features of cycles, such as feasible directions to traverse edges and substrate/product relations of species and reactions are directly encoded in the graph. Our DSR-graph contains previ- ous definitions as special cases. We elucidated the direct connection of the DSR- graph to the systems’ interaction graph and demonstrated how cycle features can be mapped by simple equivalences of edges and 2-paths. For calculating terms of the determinant expansions of the Jacobian matrix, both graphs yield structurally sim- ilar formulas, but the DSR-graph allows a more fine-grained analysis of the terms. As a new result for bipartite graphs of chemical reaction systems, we proposed a simple equivalence relation on the species-line-graphs of the DSR-graph that allows to collect comparable terms in the expansion and subsequently enabled simpler and more direct proofs of conditions for the non-vanishing of principal minors of the Jacobian matrix. We finally addressed a question raised in [16] on the relation of their conditions to the ones developed by Craciun et al in [7].

References
D. Angeli, De Leenheer. P., and E. Sontag. Graph-theoretic characterizations of monotonicity of chemical networks in reaction coordinates. J. Math. Biol., 61(4):581–616, Oct 2010.
M. Banaji. Cycle structure in SR and DSR graphs: implications for multiple equilibria and stable oscillation in chemical reaction networks. arXiv:1005.5472v2, 2010.
M. Banaji and G. Craciun. Graph-theoretic criteria for injectivity and unique equilibria in general chemical reaction systems. Adv Appl Math., 44:168–184, 2010.
B. L. Clarke. Stabiliy of complex reaction networks. Adv. Chem. Phys., 43:1–215, 1980.
G. Craciun and M. Feinberg. Multiple equilibria in complex chemical reaction networks: I. The injectivity property. SIAM J. Appl. Math., 65(5):1526–1546, May 2005.
G. Craciun and M. Feinberg. Multiple equilibria in complex chemical reaction networks: II. The species- reaction graph. SIAM J. Appl. Math., 66(4):1321–1338, Mar 2006.
G. Craciun, Y. Tang, and M. Feinberg. Understanding bistability in complex enzyme-driven reaction networks. Proc. Natl. Acad. Sci. USA, 103(23):8697–8702, Jun 2006.
M. Domijan and E. P´ecou. The interaction graph structure of mass-action reaction networks. J. Math. Biol., Aug 2011.
M. Feinberg. The existence and uniqueness of steady states for a class of chemical reaction networks.
Arch. Rational Mech. Anal., 132:311–370, Aug 1995.


M. Feinberg. Multiple steady states for chemical reaction networks of deficiency one. Arch. Rational Mech. Anal., 132:371–406, Aug 1995.
J.-L. Gouze. Positive and negative circuits in dynamical systems. J. Biol. Syst,, 6:11–15, 1998.
F. Harary. The determinant of the adjacency matrix of a graph. SIAM Review, 4(3):202–210, July 1962.
M. W. Hirsch and H. Smith. Monotone maps: a review. Journal of Difference Equations and Applications, 11(4–5):379–398, 2005.
F. Horn and R. Jackson. General mass action kinetics. Arch. Rational Mech. Anal., 47(2):81–116, Jan 1972.
M. Kaufman, C. Soul´e, and R. Thomas. A new necessary condition on interaction graphs for multistationarity. J. Theor. Biol., 248:675–685, Jan 2007.
M. Mincheva and M. R. Roussel. Graph-theoretic methods for the analysis of chemical and biochemical networks. I. Multistability and oscillations in ordinary differential equation models. J. Math. Biol., 55(1):61–86, Jul 2007.
M.A. Savageau. Biochemical systems analysis: I. Some mathematical properties of the rate law for the component enzymatic reactions. Journal of theoretical biology, 25(3):365–369, 1969.
M.A. Savageau. Biochemical systems analysis: II. The steady-state solutions for an n-pool system using a power-law approximation. Journal of theoretical biology, 25(3):370–379, 1969.
M.A. Savageau. Biochemical systems analysis: III. Dynamic solutions using a power-law approximation.
Journal of theoretical biology, 26(2):215–226, 1970.
H. L. Smith. Systems of ordinary differential equations which generate an order preserving flow. a survey of results. SIAM Review, 30(1):87–113, 1988.
E. Sontag. Monotone and near-monotone biochemical networks. In Lecture Notes in Control and Information Sciences, volume 357, pages 79–122, Jan 2007.
C. Soule. Graphic requirements for multistationarity. ComplexUs, 1:123–133, 2003.
R. Thomas and M. Kaufman. Multistationarity, the basis of cell differentiation and memory. i. structural conditions of multistationarity and other nontrivial behavior. Chaos, 11(1):170–179, Mar 2001.
