Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 336 (2018) 173–187
www.elsevier.com/locate/entcs
A Note on Distances between Probabilistic and Quantum distributions Bart Jacobs1
Institute for Computing and Information Sciences (iCIS) Radboud University Nijmegen
The Netherlands

Abstract
This paper is about distances between (or, metrics on) probability distributions. It considers the total variation and Kantorovich distance for discrete distributions, and also the trace distance for quantum dis- tributions. Both concrete and abstract results are presented, showing similarities between classical (discrete) probability and quantum probability. The concrete results involve distances between joint distributions and the product of their marginals, as measure of correlation. It is shown that the discrete and quantum case are not that different. The abstract results address metric aspects of ‘state-and-effect’ triangles that capture the essential semantic structures at hand.
Keywords: Probability distributions, total variation and Kantorovic distance, trace distance.

Introduction
Metric structures have a long history in program semantics, see the overview book [1]. Metrics occur naturally, for instance on sequences, of inputs, outputs, or states. In complete metric spaces solutions of recursive (suitably contractive) equations exist via Banach’s fixed point theorem. The Hausdorff distance on sub- sets is used to model non-deterministic (possibilistic) computation.
This paper looks at metrics on probability distributions. It stands out by com- paring standard distance functions on classical discrete probability distributions and on quantum distributions. The standard distance function that we consider for discrete probability is the total variation distance, which is a special case of the Kantorovich distance, see e.g. [6,3,17,2,16]. The distance that we study on quantum distributions is the trace distance. It is, in a sense, also a generalisation of the total variation distance.
We use both these distances in an experiment. Consider a joint distribution ω, which can be discrete or quantum. In both cases we can form its first and second marginal distributions, abbreviated as ω1 = M1(ω) and ω2 = M2(ω), where Mi is the marginalisation operation. We can put these two marginals together in a product distribution, written as ω1 ⊗ ω2.
We ask ourselves the simple question: how much does the joint distribution ω
differ from the product of its marginals ω1 ⊗ ω2? We measure this difference by

1 Email: bart@cs.ru.nl
https://doi.org/10.1016/j.entcs.2018.03.022
1571-0661/© 2018 The Author(s). Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

taking the distance d ω, ω1 ⊗ ω2 . We call this the entwinedness measure. It can be seen as a measure of the correlation (or entanglement) that exists within the joint state ω.
Below in Subsection 2.3 we calculate this distance for a maximally entwined discrete distribution and also for a maximally entwined/entangled quantum distri- bution. In the quantum case we take the Bell state. Without already spoiling the story too much: there are notable differences between classical and quantum distri- butions, but the differences become less and less when we move to n-ary products. These distance calculations quickly become quite complicated, certainly for quantum distributions. The new EfProb 2 library [4] does the work for us, and allows us to easily calculate distances for larger distributions. This was of great
help for discovering the patterns that are described in Lemmas 2.4 and 2.6.
These concrete distance calculations are a bit of a curiosity. This paper also contains more systematic results about discrete and quantum distances, in Section 3 and 4, where the logical reformulation of these distances in terms of validity |= plays a crucial role. There, metric versions are described of the state-and-effect triangles that emerge in the effectus-theoretic [8,5] description of state and predicate transformer semantics for probability.

Distance basics
This section recalls the definitions of total variation distance, for discrete proba- bility distributions, and the more general trace distance for quantum probability distributions. These distances are used here to describe the distance between a joint distribution and the product of its marginals. This distance can be seen as a measure for the level of ‘entwinedness’ (or entanglement). It is shown that the classical and quantum cases are rather similar, certainly in the limit.

Total variation distance
A finite discrete probability distribution on a set X is given by ‘probability mass’ function ω : X → [0, 1] with finite support and  x ω(x) = 1. This support supp(ω) ⊆ X is the set {x ∈ X | ω(x) /= 0}. We often simply say ‘distribution’ instead of ‘finite discrete probability distribution’. Sometimes such a distribution is also called a ‘state’. We write D(X) for the set of distributions on a set X. The mapping X '→ D(X) is a well-known monad see e.g. [7,10,11].
The ‘ket’ notation |−⟩ is useful to describe specific distributions. For instance, on a set X = {a, b, c} we may write a distribution as ω = |a⟩ + |b⟩ + |c⟩. This
corresponds to the probability mass function ω : X → [0, 1] given by ω(a) = 1 ,
ω(b)= 1 and ω(c)= 3 .
8	8
Definition 2.1 Let ω1, ω2 ∈ D(X) be two distributions on the same set X. Their

2 See efprob.cs.ru.nl

total variation distance tvd(ω1, ω2) is the positive real number deﬁned as:
tvd(ω ,ω ) = 1 Σ ω (x) − ω (x) .	(1)

1	2	2
1	2
x∈X

The historical origin of this definition is not precisely clear. It is folklore that the total variation distance is a special case of the ‘Kantorovich distance’ (also known as ‘Wasserstein’ or ‘earth mover’s distance’) on distributions on metric spaces, when applied to discrete metric spaces (sets), see Section 3.
We leave it to the reader to verify that tvd is a metric on sets of distributions
D(X), and that its values are in the unit interval [0, 1].
We shall be especially interested in product states ω1 ⊗ ω2 and in marginals M1(σ), M2(σ) of a joint state σ, defined on a product set like X1 ×· · ·× Xn. We recall the standard definitions.
For states ω1 ∈ D(X1), ω2 ∈ D(X2) there is a (joint) product state ω1 ⊗ ω2 ∈ D(X1 × X2) given by (ω1 ⊗ ω2)(x1, x2)= ω1(x1) · ω2(x2).
In the other direction, for a ‘joint’ state σ ∈ D(X1 × X2) there are first and second marginal states M1(σ) ∈ D(X1) and M2(σ) ∈ D(X2) given by:
M1(σ)(x1) = Σx2 σ(x1, x2)	M2(σ)(x2) = Σx1 σ(x1, x2).
We call a joint state σ non-entwined when it is the product of its marginals, that is, when σ = M1(σ) ⊗ M2(σ). Every product state ω1 ⊗ ω2 is non-entwined, since Mi(ω1 ⊗ ω2)= ωi.
The following results are not needed in the sequel, but are worth making explicit.

tvd ω1 ⊗ ρ, ω2 ⊗ ρ) = tvd ω1, ω2    tvd M1(σ), M1(τ ) ≤ tvd σ, τ .   (2)
Trace distance
We shall only consider quantum distributions (states) in the finite-dimensional case. For a number n ∈ N we write Mn for the set of square n×n matrices with entries in the complex numbers. A quantum distribution of dimension n is a matrix ρ ∈ Mn which is positive and has trace equal to one: tr(ρ) = 1, where the trace is the sum of all elements on the diagonal. Such a quantum distribution is often called a (quantum) state. We refer to for instance [18,19,21] for more information.
Definition 2.2 Let ρ1, ρ2 ∈ Mn be two quantum states of the same dimension n. The trace distance trd(ρ1, ρ2) between them is defined as:
trd(ρ1, ρ2) = 1 tr  ρ1 − ρ2  = 1 tr √(ρ1 − ρ2)†(ρ1 − ρ2) .	(3)
This definition involves the absolute value |A| of a matrix A ∈ Mn which is defined as the (matrix) square root of the product A†A, where (−)† is the conjugate transpose. The square root of a (self-adjoint) matrix B can be computed by first

diagonalising the matrix as√B = V DV †, where D is a diagonal matrix; then one
forms the diagonal matrix	D by taking the√square roots of the elements on the
diagonal in D; finally the square root of B is V	DV †. Calculating the trace distance
by hand is rather unpleasant, but we shall compute it via a tool.
The trace distance is an extension of the total variation distance: given two discrete distributions ω1, ω2 on the same set, then the union of their supports supp(ω1) ∪ supp(ω2) is a finite set, say with n elements. We can represent ω1, ω2
as diagonal matrices ω^1, ω^2 ∈ Mn.	They are states, by construction.	Then
trd(ω1, ω2)= tvd(ω1, ω2).
Given two states ρ1 ∈ Mn1 and ρ2 ∈ Mn2 one can form the product state ρ1 ⊗ρ2 ∈ Mn1·n2 via the Kronecker (tensor) product. In the other direction, given a ‘joint’ state τ ∈ Mn1·n2 one can form the two marginals M1(τ ) ∈ Mn1 and M2(τ ) ∈ Mn2 via partial traces. We call τ non-entwined when it is the tensor product of its marginals.
(The name “entangled” is common in quantum theory, but it has a slightly different meaning than “entwined”: a joint state τ is non-entangled when it can be written as ﬁnite sum of product (sub)states. In the current setting this difference does not matter.)
The facts (2) also hold in the quantum case.
Calculating entwinedness
It is often claimed that entanglement — or entwinedness, as we shall say here — is a typical quantum phenomenon. But classical (discrete) states can be entwined too. The claim is sometimes re-stated as quantum states can be more entangled or more correlated than classical states. Our aim in this subsection is to investigated this matter, in terms of (total variation and trace) distance.
The idea is to look at the difference between a joint state and the product of its marginals. We interpret this as a measure of ‘entwinedness’. We shall sometimes call this the ‘entwinedness’ measure.
In order to do the computations we use the EfProb library 3 which provides convenient uniform operations for both classical and quantum probability. We only need a small part of this EfProb library, namely the part dealing with product states and marginals. The product of two states s1 and s2 is written as s1 @ s2. This same notation works for discrete and quantum probability. The first and second marginal of a joint state t is written via a post-fix operation as t % [1,0] and t % [0,1]. The selector list [..], also called ‘mask’, may be of arbitrary length; it describes the components that should be projected/marginalised/traced out via a 0, and the parts that should remain via a 1. We shall also use multi-dimensional states s1 @...@ sn and n-ary marginals t % [0,..,0,1,0,...,0].
The Bell state is ‘maximally entangled’. Hence it forms an interesting starting point, in order to find out what this difference is between the Bell state and the product of this marginals. You may want to stop here for a moment and think for

3 Publicly available at efprob.cs.ru.nl

yourself what distance (in the unit interval) you expect.
As a vector in C2⊗C2 the Bell state is usually described as |b⟩ = √1 (| 00 ⟩+| 11 ⟩). In EfProb the corresponding density matrix |b⟩⟨ b |∈ M4 is called bell. The EfProb/ Python code fragments below are hopefully self-explanatory. The part after >>> is typed on the command line, after loading the relevant EfProb files.

>>> bell

>>> trdist( bell , ( bell % [1 ,0]) @ ( bell % [0 ,1]) ) 0.75
This 0.75 is a relatively high distance, which is probably expected.
Let’s see what we can do in the discrete case. We take a maximally entwined classical joint state on {0, 1}×{0, 1}, with the name cs2. In the code fragment below this state is printed using ket notation; subsequently its ‘entwinedness’ measure is produced.

>>> cs2
0.5|0,0 > + 0|0,1> + 0|1,0> + 0.5|1,1 >
>>> tvdist( cs2 , ( cs2 % [1 ,0]) @ ( cs2 % [0 ,1]) ) 0.5
Ha! This classical distance 0.5 is less than the earlier quantum distance 0.75, sug- gesting indeed that there is classically less correlation / entwinedness / entanglement than in the quantum case.
But let’s look a bit further, and consider products of dimension 2 × 2 × 2= 8. The main candidate now is the ‘maximally entangled’ GHZ state in M8. Like the Bell state, it is pre-defined in EfProb:

>>> ghz
[[ 0.5	0.	0.	0.	0.	0.	0.	0.5]

>>> trdist( ghz ,
...	( ghz % [1 ,0 ,0]) @ ( ghz % [0 ,1 ,0]) @ ( ghz % [0 ,0 ,1]) ) 0.875

We see several interesting things when we compare these Bell and GHZ examples.

In both cases the density matrices contain zero’s 0 everywhere, except for values
0.5 at each of the four corner positions.
The Bell state of dimension 4 = 22 is compared to a 2-product of its two marginals; the GHZ state of dimension 8 = 23 is compared to the 3-product of its three marginals.
The ‘entwinedness’ measure in the Bell case is 3 , whereas in the GHZ case it
is higher, namely 7 .
We can generalise this to n-products, and conjecture that the entwinedness mea- sure is then 2n−1 . This is confirmed by a few more of these distance calculations in EfProb, for n = 4, 5, 6,.. ., but after n = 10 rounding errors start playing a role, starting with differences in the order of 10−3. Hence it is time to turn to a mathematical description.
Definition 2.3 Write qsn  M2n for the matrix/state consisting of only 0’s, except for its four outer corners, which have entries 1 .
Thus the Bell state is qs2 and the GHZ state is qs3. It is easy to define qsn as a function in Python, and to obtain a list of its n-marginals of dimension 2. The pattern in the next result emerged via experiments.
Lemma 2.4 Consider the ‘quantum state’ qsn from Deﬁnition 2.3, for n ≥ 2.
For ea ch i ≤ n, the i-th marginal Mi(qsn) is equal to the fair ‘quantum coin’
The product state M1(qsn) ⊗· · ·⊗ Mn(qsn) of these n marginals is the diagonal (uniform) state 1/2n · I ∈ M2n .
The entwinedness measure trd qs , M (qs ) ⊗ ··· ⊗ M (qs ) equals 2n−1 .
We thus see that the entwinedness measure goes to the maximum value 1 as n
goes to infinity.
Proof. For the last point the matrix qsn − M1(qsn) ⊗···⊗ Mn(qsn) is described on the left below, and its absolute (matrix) value on the right.
⎛1/2 − 1/2n	0	···	0 1/2 − 1/2n⎞
⎜	0	−1/2n ···	0	0

.	. . .
⎜
.	⎟	⎜	.	.	⎟

⎜	0	0	··· −1/2n	0	⎟
1/2	0	···	0	1/2 − 1/2n
⎜	0	0 ··· 1/2n	0	⎟
1/2 − 1/2n	0  ···	0	1/2

We can now compute the entwinedness measure as half of the trace of the matrix on the right:

1 1 + (2n − 2) ·  1

+ 1 = 1 + 2n−1−1

= 2n−1 + 2n−1−1

= 2n−1 .	 

We return to discrete probability. We have seen that the entwinedness measure for the state cs2 is 1 . What happens to this distance as we go to 3-products,
products, etc.
It is easy to define a ‘classical state’ function cs(n) in Python which returns a discrete state on {0, 1}n of length 2n, with 1 at the outside, as in:

>>> cs(3)
0.5|0,0,0 > + 0|0,0,1> + 0|0,1,0> + 0|0,1,1> + 0|1,0,0> + 0|1,0,1>
+ 0|1,1,0> + 0.5|1,1,1 >
>>> tvdist( cs(3),
...	( cs(3) % [1 ,0 ,0]) @ ( cs(3) % [0 ,1 ,0]) @ ( cs(3) % [0 ,0 ,1]) ) 0.75

For n = 4 the distance is 7 , for n = 5 it’s 15 . Hence we expect the pattern to be

2n−1  1

2n−1
8	16

Definition 2.5 Let n ≥ 1, and (bi)i<2n be the n-length bit words representing the numbers 0, 1, 2,..., 2n − 1. Write csn for the ‘classical state’ on the set {bi | i < 2n} with probability 1 for b0 = 00 ··· 00 and also for b2n−1 = 11 ··· 11, and probability 0 everywhere else.
Lemma 2.6 Consider the classical state csn for n ≥ 2.
Each of the n marginals Mi(csn) is the fair coin 1 | 0 ⟩ + 1 | 1 ⟩.
The product state M1(csn) ⊗· · ·⊗ Mn(csn) of these n marginals is the uniform
distribution on the set {bi | i < 2 } with probability 2n for each bitstring bi.
The entwinedness measure tvd cs , M (cs ) ⊗· · · ⊗ M (cs ) equals 2n−1−1 .
We thus see that the classical entwinedness measure also goes asymptotically to 1 as n goes to infinity, but lags one step behind the quantum distance.
Proof. Again we concentrate on the last point. The distance is the sum:

1 ( 1 −  1 )+ (2n − 2) ·  1 + ( 1 −  1 ) = 1 + 1 · (2n − 4) ·  1
= 2n−2 + 2n−2−1)
	
2n−1	2n−1
2n−1  1
2n−1
Our conclusion is that maximally entwined quantum states qsn do not differ dramatically from the maximally entwined classical (discrete probabilistic) states csn when it comes to entwinedness measure — certainly when n goes to infinity.
Remark 2.7 We have investigated the distance d(ω, ω1 ⊗· · ·⊗ωn) between a state ω and the product of its two marginals ω1,..., ωn. In information theory one usually looks at mutual information, that is, at the Kullback-Leibler divergence of the product of the marginals, from the joint distribution. Concretely, it gives the

expectation of the logarithmic difference:


DKL(ω  ω1
⊗ ω2) = Σ


x,y
ω(x, y) log 	ω(x, y)	 
ω1(x) · ω2(y)

= H(ω1)+ H(ω2) − H(ω).

The latter formulation uses Shannon entropy H, see [18]. It has been implemented in EfProb, also for n-ary states. The mutual information value of the quantum states states qs(i) is i and for classical states cs(i) it is i − 1. Hence again we see that the classical states lag one step behind the quantum ones.
Nevertheless, we are not aware of a formal relationship between the entwinedness measure that we use here and mutual information.

Kantorovich distance
The example calculations in the previous section are very concrete applications of the total variation and trace distances. In the remaining sections of this paper we will look at these distances from a more general perspective. This section concen- trates on the total variation distance, and the next one on the trace distance.
As already mentioned in the previous section, the total variation distance is a special case of the Kantorovich distance on metric spaces. In order to describe the latter, we need some context.
A metric d on a set X is called 1-bounded if it takes values in the unit interval [0, 1], that is, if it has type d : X × X → [0, 1]. We write Met for the category with such 1-bounded metric spaces as objects, and with non-expansive functions f between them, satisfying d(f (x),f (y)) ≤ d(x, y). This category Met is complete and cocomplete, and monoidal closed. The metric on a cartesian product × is given by joins, and on a tensor product ⊗ by truncated sums.
From now on we assume that all metric spaces in this paper are 1-bounded. For example, each set carries a discrete metric, where points x, y have distance 0 if they are equal, and 1 otherwise.
For a metric space X and two functions f, g : A → X from some set A to X
there is the supremum distance given by:

spd(f, g) =   d f (a), g(a) .	(4)
a∈A

A predicate on a metric space X is a non-expansive function p : X → [0, 1]. These predicates carry the above supremum distance spd. For a discrete probability distribution ω on X we write ωΣ|= p for the validity (or expected value) of p in ω.

Definition 3.1 Let ω1, ω2 be two discrete distributions on (the underlying set of)

a metric space X. The Kantorovich distance between them is defined as:

kvd(ω1, ω2) =	 
p∈Met(X,[0,1])
 ω1 |= p − ω2 |= p .	(5)

This makes D(X) a (1-bounded) metric space.
The Kantorovich-Wasserstein duality Theorem gives an equivalent description of this distance in terms of joint states and ‘couplings’, see [15,20] for details. Here we are interested in relating the Kantorovich distance to the monad structure of distributions. For this we really need to move from the total variation distance tvd for distributions on sets to the Kantorovich distance kvd for distributions on metric spaces, namely when we consider distributions of distributions D(D(X)). Even if X is just a set, D(X) is a metric space, so we need to take this metric structure into account when we form D(D(X)).
The following result is standard and is included without proof, but see [6,20] for more information. It shows that the Kantorovich distance kvd and total vari- ation distance tvd coincide on discrete spaces, and can be described in terms of ‘sharp’ predicates X → {0, 1}, taking values in {0, 1} instead of in [0, 1]. The sharp predicates correspond to subsets U ⊆ X, via the indicator function 1U : X → {0, 1}.
Proposition 3.2 Let X be an arbitrary set, considered as discrete metric space. Then for distributions ω1, ω2 ∈ D(X) one has the following series of equalities.

kvd ω ,ω  (5)
 ω |= p − ω

|= p 

1	2	=	1	2
X
p∈[ 0,1]

=
p∈ {0,1 }X
 ω1 |= p − ω2 |= p 
 

=	 ω1 |= 1U − ω2 |= 1U 

U ⊆ΣX
 (1)

1
2
x∈X
 ω1(x) − ω2(x)  = tvd ω1, ω2 .

For a Kleisli map f : X → D(Y ) there are two associated ‘transformation’ functions, namely state transformation f∗ : D(X) → D(Y ) and predicate trans- formation f∗ : [0, 1]Y → [0, 1]X . State transformation (aka. Kleisli extension) is de- fined as f∗(ω)(y)=	x f (x)(y) · ω(x), and predicate transformation as f∗(q)(x)= y f (x)(y) · q(y). They satisfy the fundamental validity transformation equality:
f∗(ω) |= q = ω |= f∗(q).
Lemma 3.3 Let X, Y be metric spaces.
The unit function η : X → D(X) given by η(x)= 1|x⟩ is non-expansive.
For each non-expansive function f : X → D(Y ) the corresponding state trans- former f∗ : D(X) → D(Y ) is non-expansive. As special cases, the multi- plication map μ = (id)∗ : D(D(X)) → D(X) is non-expansive, and validity (−) |= p = p∗ : D(X) → D(2) = [0, 1] in its ﬁrst argument too.

If f : X → D(Y ) and q : Y → [0, 1] are non-expansive, then so is f∗(q): X → [0, 1]. Moreover, the function f∗ : Met(Y, [0, 1]) → Met(X, [0, 1]) is itself non-expansive, wrt. the supremum distance. Hence validity ω |= (−) = ω∗ : Met(X, [0, 1]) → Met(1, [0, 1]) = [0, 1] is non-expansive in its second ar- gument too.
Taking convex combinations of distributions satisﬁes: for r + s = 1,

kvd r · σ1 + s · σ2, r · τ1 + s · τ2  ≤ r · kvd(σ1, τ1)+ s · kvd(σ2, τ2).

We conclude that D lifts from a monad on the category Sets to the category Met
as described in:

Met 	D	zM,et

(6)

, 
Sets
, 
zSe,ts


The lifting (6) can be seen as a finite version of a similar lifting result for the ‘Kantorovich’ functor K in [3]. This K(X) captures the tight Borel probability measures on a metric space X. The above lifting (6) is a special case of the generic lifting of functors on sets to functors on metric spaces described in [2] (see esp. Example 3.3).
Proof. We do the first and the last point and leave the others to the reader. The crucial point that we use to show that the unit map η : X → D(X) is non-expansive is: η(x) |= p = p(x). Hence we are done because the join in (5) is over non-expansive functions p in:

kvd(η(x1), η(x2)) =	η(x1) |= p − η(x2) |= p =	p(x1) − p(x2)
≤  p d(x1, x2)
= d(x1, x2).

For the last point we first notice that for Ω ∈ D2(X) and p : X → [0, 1],

μ(Ω) |= p = Σx μ(Ω)(x) · p(x) = Σx Σω Ω(ω) · ω(x) · p(x)
= Σω Ω(ω) · Σx ω(x) · p(x) 
= Σω Ω(ω) · ω |= p 
= Ω |= (−) |= p ,

where (−) |= p : D(X) → [0, 1] is used as (non-expansive) predicate on D(X). Hence

for r, s ∈ [0, 1] with r + s = 1,
kvd r · σ1 + s · σ2, r · τ1 + s · τ2 
= kvd μ(r|σ1 ⟩ + s|σ2 ⟩), μ(r|τ1 ⟩ + s|τ2 ⟩) 
=  p μ(r|σ1 ⟩ + s|σ2 ⟩) |= p − μ(r|τ1 ⟩ + s|τ2 ⟩) |= p 
=  p r|σ1 ⟩ + s|σ2 ⟩ |= (−) |= p − r|τ1 ⟩ + s|τ2 ⟩ |= (−) |= p 
=  p r · (σ1 |= p)+ s · (σ2 |= p) − r · (τ1 |= p)+ s · (τ2 |= p) 
≤  p r ·  σ1 |= p − τ1 |= p +  p s · σ2 |= p − τ2 |= p 
= r · kvd(σ1, τ1)+ s · kvd(σ2, τ2).	 
In a probabilistic and quantum setting predicates carry the structure of an ef- fect module, see [9,8,5]. Writing EMod for the category of effect modules, and Conv = EM(D) for the category of convex sets — as Eilenberg-Moore algebras of the distribution monad D on Sets — we have the standard ‘state-and-effect’ trian- gle for discrete probability as on the left below, where the adjunction at the top is obtained by ‘homming into [0, 1]’.

op
,.,,
 C¸onv
AEModop
 ¸
T	Con˛v,Met


Hom(−,2)=Pred	Stat=Hom(1,−)
Kl(D)
Pred

Kl(D)
Stat
(7)

These state and effect triangles provide a systematic pattern where computations are maps f in the basis category, which give rise to forward state transformers Stat(f )= f∗ in Conv and backward predicate transformers Pred(f ) = f∗ in EMod. The adjunction at the top gives the standard dual adjoint relationship between algebraic logics and spaces, see [12] for more information.
Our next aim is to prove that the triangle on the left restricts to the triangle on the right. It involves two subcategories AEMod ‹→ EMod and Conv →› ConvMet ‹→ Met.
The category AEMod of Archimedean effect modules is defined in [13,14]. The precise definition of the Archimedean property in effect modules is a bit subtle: x ≤ y follows if 1 x ≤ 1 y ❽ r 1 holds for all r ∈ (0, 1]. But it leads to a
2	2	2
some neat results like:
the full subcategory AEMod of Archimedean effect modules is equivalent to the category of order unit spaces;
Archimedean effect modules carry a (1-bounded) metric, and all maps of effect modules are automatically non-expansive. This gives a functor AEMod  Met.
The metric induced on Archimedean effect modules of fuzzy predicates [0, 1]X is the supremum metric (4).
The category ConvMet contains convex metric spaces, consisting of:

a convex set X, that is, a set X with an Eilenberg-Moore algebra
α : D(X) → X of the distribution monad D on Sets;
a metric dX : X × X → [0, 1] on X;
a connection between the convex and the metric structure, via the requirement that the algebra map α : D(X) → X is non-expansive: dX (α(ω1), α(ω2)) ≤ kvd(ω1, ω2), for all distributions ω1, ω2 ∈ D(X).
The maps in ConvMet are both affine and non-expansive. Thus, ConvMet
is the Eilenberg-Moore category of the lifted monad D : Met → Met in (6).
Example 3.4 The unit interval [0, 1] is a convex metric spaces, via its standard (Euclidean) metric, and its standard convex structure, given by the algebra map α : D([0, 1]) → [0, 1] defined by the ‘expected value’ operation:
α(ω) = Σx∈R ω(x) · x	that is	α Σi ri|xi ⟩  = Σi ri · xi.
The identity map id : [0, 1] → [0, 1] is a predicate on [0, 1] that satisfies:
ω |= id = Σx ω(x) · id(x) = Σx ω(x) · x = α(ω).
This allows us to show that α is non-expansive:
α(ω )	α(ω ) = ω  = id	ω  = id
≤  p ω1 |= p − ω2 |= p = kvd(ω1, ω2).
Theorem 3.5 The state-and-effect triangle on the left in (7) restricts to the ‘met- ric’ one on the right.
Proof. The ‘states’ (comparison) functor Stat: Kl(D) → EM(D) = Conv in (7) restricts to ConvMet by Lemma 3.3, since free algebras μ : D(D(X)) → D(X) are non-expansive (and affine); moreover, state transformers f∗ are both non-expansive and affine. The ‘predicate’ functor Pred = [0, 1](−) :  l( )  EModop restricts to AEModop since sets of predicates [0, 1]X are Archimedean, as remarked above, following [13,14].
We have to show that the adjunction in (7) restricts appropriately. For an effect module E, the homset Hom(E, [0, 1]) carries a convex structure that is given by the map
D Hom(E, [0, 1])  α  zH,om(E, [0, 1])	with	α(ω)(e) = Σ ω(h) · h(e),

where h ranges over Hom(E, [0, 1]). Notice that each element e ∈ E gives rise to a predicate ev e : Hom(E, [0, 1]) → [0, 1] via eve(h) = h(e). It satisfies for ω ∈
D Hom(E, [0, 1]) ,
ω |= eve = Σh ω(h) · eve(h) = Σh ω(h) · h(e) = α(ω)(e).

Now we can show that the algebra map α on Hom(E, [0, 1]) is non-expansive:


d α(ω1), α(ω2) =
e  α(ω1)(e) − α(ω2)(e)
=  e ω1 |= eve − ω2 |= eve

≤	p ω1 |= p − ω2 |= p 
= kvd(ω1, ω2).

Each map f : E → D in EMod gives an affine map (−) ◦ f : Hom(D, [0, 1]) →
Hom(E, [0, 1]) in Conv; it is easy to show that it is also non-expansive.
In the other direction we have to prove that for each convex metric set X the set Hom(X, [0, 1]) of affine non-expansive maps is Archimedean. This follows from the fact that the set of functions [0, 1]X is Archimedean.	 

Trace distance
This section describes, in analogy with the previous one, some basic properties of the trace distance on quantum states. Abstractly, a state of a C∗ or W∗ (von Neumann) algebra A is a completely positive map ρ : A → C. A predicate (also called ‘effect’) of A is an element e ∈ A with 0 ≤ e ≤ 1. We write [0, 1]A ⊆ A for the subset of predicates. The validity ρ |= e is the probability ρ(a) ∈ [0, 1]. A predicate is called sharp if e · e = e, that is, if e is a projection.
We rely heavily on the following standard result, see e.g. [18, §9.2]. It is the quantum analogue of Proposition 3.2.
Proposition 4.1 Let A = B(H ) be a von Neumann algebra of operators on a ﬁnite-dimensional Hilbert space H , with states ρ1, ρ2 : A → C. Then:


trd(ρ1, ρ2) =  e [0,1]
  ∈	A



 ρ1 |= e − ρ2 |= e 
 

(8)

In the light of this result we take as distance on the set Stat(A) = Hom(A, C) of states of a von Neumann algebra A, the join(s) occurring in (8). We will still call this the trace distance trd. It is well-known that states are closed under convex combinations, and thus form a convex set, formally via a function α : D(Stat(A)) → Stat(A). With their trace distance they form a metric space too. We will show that the map α is non-expansive.
Lemma 4.2	(i) Let e ∈ [0, 1]A be a predicate. The ‘evaluate at e’ map eve = (−)(e)= (−) |= e : Hom(A, C) → [0, 1] is both affine and non-expansive.
The convex map α : D(Stat(A)) → Stat(A) is non-expansive.
The ‘states’ functor Stat = Hom(−, C): vNAop  →  Conv restricts to
Stat: vNAop → ConvMet.
Proof.	(i) It is standard that the map eve is affine, so we concentrate on its

non-expansiveness: for states ρ1, ρ2 we have:
 eve(ρ1) − eve(ρ2)  =  ρ1 |= e − ρ2 |= e  ≤  a∈[0,1]  ρ1 |= a − ρ2 |= a 
= trd(ρ1, ρ2)
Suppose we have two formal convex combinations Ω = Σi ri|ωi ⟩ and Ψ =
j sj|ρj ⟩ in D(Stat(A)). The map α : D(Stat(A)) → Stat(A) is non-expansive since:

trd 
 (8) 
 (Σ r
· ω ) |= e − (Σ s
· ρ ) |= e 


=  e Σi ri · ωi(e) − Σj sj · ρj(e) 
=  e  Σi ri · eve(ωi) − Σj sj · eve(ρj) 
=  e Ω |= eve − Ψ |= eve 
 


We have to prove that for a (completely) positive unital map f : A → B be- tween von Neumann algebras the associated state transformer f∗ = (−) ◦ f : Hom(B, C) → Hom(A, C) is affine and non-expansive. The former is stan- dard, so we concentrate on non-expansiveness. Let ρ1, ρ2 : B → C be states of
B. Then:

trd 
 (8) 
 f (ρ )(e) − f (ρ )(e) 

f∗(ρ1), f∗(ρ2)
=	1	2
  e∈[0,1]A

  e∈[0,1]A ρ1(f (e)) − ρ2(f (e)) 
(8)		 
≤	 ρ (d) −		trd ρ ,ρ  .	 
Corollary 4.3 The quantum state-and-effect triangle on the left below restricts to the triangle on the right.

op
,.,,
 C¸onv
AEModop
 ¸
T	Con˛v,Met

(9)

Pred
vNAop
Stat
Pred
Stat
vNAop

Proof. It is standard that the self-adjoint elements of a von Neumann algebra A form an order unit space, and thereby that its predicates (effects) [0, 1]A form an Archimedean effect module, see [13,14]. Hence the predicate functor Pred = [0, 1](−) in (9) restricts to AEMod. The states functor Stat restricts by Lemma 4.2 (iii). The adjunction AEModop « ConvMet was already established in (the proof of) Theorem 3.5.	 
Conclusions
We have used (total variation and trace) distances to get a better view on en- twinedness of classical and quantum distributions, and on how they differ for some

standard maximally entwined distributions. On a more general level, distances be- tween classical and quantum states have been reformulated in logical terms and added to the state-and-effects triangles for classical and quantum probability.

References
J. de Bakker and E. Vink. Control Flow Semantics. MIT Press, Cambridge, MA, 1996.
P. Baldan, F. Bonchi, H. Kerstan, and B. K¨onig. Behavioral metrics via functor lifting. In V. Raman and S. Suresh, editors, FSTTCS 2014: Foundations of Software Technology and Theoretical Computer Science, volume 29 of LIPIcs, pages 403–415. Schloss Dagstuhl, 2014.
F. van Breugel, C. Hermida, M. Makkai, and J. Worrell. Recursively defined metric spaces without contraction. Theor. Comp. Sci., 380:143–163, 2007.
K. Cho and B. Jacobs. The EfProb library for probabilistic calculations. In F. Bonchi and B. Ko¨nig, editors, Conference on Algebra and Coalgebra in Computer Science (CALCO 2017), volume 72 of LIPIcs. Schloss Dagstuhl, 2017.
K. Cho, B. Jacobs, A. Westerbaan, and B. Westerbaan. An introduction to effectus theory. see
arxiv.org/abs/1512.05813, 2015.
A. Gibbs and F. Su. On choosing and bounding probability metrics. Int. Statistical Review, 70(3):419– 435, 2002.
B. Jacobs. Probabilities, distribution monads, and convex categories. Theor. Comp. Sci., 412(28):3323– 3336, 2011.
B. Jacobs. New directions in categorical logic, for classical, probabilistic and quantum logic. Logical Methods in Comp. Sci., 11(3):1–76, 2015.
B. Jacobs. A recipe for state and effect triangles. In L. Moss and P. Sobocinski, editors, Conference on Algebra and Coalgebra in Computer Science (CALCO 2015), volume 35 of LIPIcs, pages 116–129. Schloss Dagstuhl, 2015.
B. Jacobs. Introduction to Coalgebra. Towards Mathematics of States and Observations. Number 59 in Tracts in Theor. Comp. Sci. Cambridge Univ. Press, 2016.
B. Jacobs. From probability monads to commutative effectuses. Journ. of Logical and Algebraic Methods in Programming, 156, 2017. See http://dx.doi.org/10.1016/j.jlamp.2016.11.006.
B. Jacobs. A recipe for state and effect triangles. See https://arxiv.org/pdf/1703.09034, 2017.
B. Jacobs and J. Mandemaker. The expectation monad in quantum foundations. In B. Jacobs,
P. Selinger, and B. Spitters, editors, Quantum Physics and Logic (QPL) 2011, number 95 in Elect. Proc. in Theor. Comp. Sci., pages 143–182, 2012.
B. Jacobs, J. Mandemaker, and R. Furber. The expectation monad in quantum foundations. Inf. & Comp., 2016.
T. Lindvall. Lectures on the Coupling Method. John Wiley & Sons, New York, 1987.
R. Madare, P. Panangaden, and G. Plotkin. Quantitative algebraic reasoning. In Logic in Computer Science. IEEE, Computer Science Press, 2016.
A. McIver, C. Morgan, and T. Rabehaja. Abstract hidden Markov models: A monadic account of quantitative information flow. In Logic in Computer Science, pages 597–608. IEEE, Computer Science Press, 2015.
M. Nielsen and I. Chuang. Quantum Computation and Quantum Information. Cambridge Univ. Press, 2000.
E. Rieffel and W. Polak. Quantum Computing. A Gentle Introduction. MIT Press, Cambridge, MA, 2011.
C. Villani. Optimal Transport — Old and New. Springer, Berlin Heidelberg, 2009.
N.S. Yanovsky and M.A. Manucci. Quantum Computing for Computer Scientists. Cambridge Univ. Press, 2008.
