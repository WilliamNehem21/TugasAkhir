Egyptian Informatics Journal 22 (2021) 155–166








Full length article
Trajectory control and image encryption using affine transformation of lorenz system
Wafaa S. Sayed a,⇑, Ahmed G. Radwan a,b, Hossam A.H. Fahmy c, AbdelLatif Elsedeek a
a Engineering Mathematics and Physics Department, Faculty of Engineering, Cairo University, Giza 12613, Egypt
b Nanoelectronics Integrated Systems Center, Nile University, Cairo 12588, Egypt
c Electronics and Communications Engineering Department, Faculty of Engineering, Cairo University, Giza 12613, Egypt



a r t i c l e  i n f o 

Article history:
Received 30 September 2019
Revised 21 December 2019
Accepted 8 July 2020
Available online 29 July 2020

Keywords:
Affine transformations Chaos
Dynamic translation Image encryption Lorenz system Trajectory control
a b s t r a c t 

This paper presents a generalization of chaotic systems using two-dimensional affine transformations with six introduced parameters to achieve scaling, reflection, rotation, translation and/or shearing. Hence, the location of the strange attractor in space can be controlled without changing its chaotic dynamics. In addition, the embedded parameters enhance the randomness and sensitivity of the system and control its response. This approach overpasses performing the transformations as post-processing stages by applying them on the resulting time series. Trajectory control through dynamic parameters is demonstrated. Simulation results validate the proposed analysis for both the simplest and Lorenz chao- tic systems. An image encryption scheme is implemented using transformed Lorenz system resulting in a more secure encryption scheme in comparison to Lorenz and other recent related works. The scheme exhibits good performance when assessed using the PRNG properties, encrypted image histogram and its uniformity through chi square test, pixel correlation, Mean Squared Error (MSE), entropy, Peak Signal-to-Noise Ratio (PSNR), the National Institute of Standards & Technology (NIST) test, key space, key sensitivity, resistance to differential, ciphertext-only, known plaintext, and chosen plaintext attacks, robustness against noise and computation time.
© 2021 THE AUTHORS. Published by Elsevier BV on behalf of Faculty of Computers and Artificial Intel-
ligence, Cairo University. This is an open access article under the CC BY-NC-ND license (http://creative-
commons.org/licenses/by-nc-nd/4.0/).






Introduction

Chaotic systems are highly sensitive to initial conditions, sys- tem parameters and implementation. The significant properties of chaotic systems are highly required in many applications such as: modeling [1], motion control [2] and cryptography [3–5]. Sev- eral recent Pseudo-Random Number Generation (PRNG) and encryption applications utilized discrete chaotic maps [3] and con- tinuous chaotic systems [6]. Various digital and analog implemen- tations of discrete and continuous chaotic systems have been presented [7,8].
To fulfill the needs of all these multidisciplinary fields, there is a continuous need to come up with controllable modified, gener- alized and novel chaotic systems. Several properties of a chaotic

* Corresponding author.
E-mail addresses: wafaasayed@eng1.cu.edu.eg (W.S. Sayed), agradwan@ieee.org (A.G. Radwan), hfahmy@alumni.stanford.edu (H.A.H. Fahmy), aeah7@yahoo.com (A. Elsedeek).
Peer review under responsibility of Faculty of Computers and Information, Cairo University.
system, its time series, and hence, strange attractor can be con- trolled, e.g., the attractor’s size, location, shape and number of scrolls.
Several researches developed modified versions of the most famous Lorenz chaotic system [9] and their implementations [7,8,10–13]. Other researches focused on constructing, analyzing and implementing novel jerk-based chaotic systems that involve
a differential equation of at least third order xv  f €x; x_ ; x and a
nonlinearity [14–20].
Linear combination ideas were utilized in synchronization schemes [21] as a post-processing stage for the dynamical equa- tions. Geometric transformations have many applications in mechanical design [22], control [23], computer graphics [24], fractal structures generation [25] and fractal-based image coding [26].
Control of locations and number of equilibrium points was fur- ther used in multi-scroll attractors generation [27–33]. Such works provided various combinations of the previously mentioned con- trollable properties of the strange attractors. Although these works barely presented applications for their proposed systems, separate


https://doi.org/10.1016/j.eij.2020.07.002
1110-8665/© 2021 THE AUTHORS. Published by Elsevier BV on behalf of Faculty of Computers and Artificial Intelligence, Cairo University. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).



image encryption research was ongoing meanwhile [34–37] based on discrete-time chaotic maps including some transformations as separate encryption stages. This work links chaotic systems and affine transformations and proposes the utilization of extra param- eters and transformations as simple means of generalization and control of chaotic systems.
This paper uses embedded affine transformations to control chaotic systems and enhance their sensitivity. This method enables simultaneous control of the size of the strange attractor through scaling parameters, its location through rotation and/or transla- tion, its shape through shearing and the number of scrolls through dynamic parameters. Section 2 briefly reviews the basic mathe- matics of affine transformations. Sections 3 and 4 apply the trans- formation to the simplest and Lorenz chaotic systems demonstrating the effects on the time series, attractor diagrams and Maximum Lyapunov Exponent (MLE). Section 5 utilizes scaling and translation parameters to dynamically control the trajectory of the strange attractor. Section 6 highlights the main advantages of transformed Lorenz system in an image encryption application. Section 7 discusses the results in comparison to other recent related works. Section 8 summarizes the main contributions of the paper and suggests future work directions.

Affine transformations

Two-dimensional affine transformations can be applied to any pair of axes constructing a plane in the coordinate systems. They result in relatively simple equations and allow clear visualization in the different planes of the Cartesian coordinate system. Con- sider a point represented in the three-dimensional space with
the coordinates x, y, z , its two-dimensional affine transformation
from the x-y to the u-v plane in the three-dimensional space can be written as:
equilibrium  points  with  eigen  values  k1 = —0.8994  and k2,3 = 0.0497 i 0.9418. Saddle points of index two result in double-scroll attractors.
Using the inverse transformation (2), a transformed system in the u-v-w coordinate system is obtained, which is given by:
u_ = a (—du + av + cd — af ) + bw + c,
v_ = d (—du + av + cd — af ) + ew + f ,	(4)

w_ = —0.8 w + 1 ((e — d)u + (a — b)v) — sgn 1 (eu — bv) .
The response of the system reduces to that of (3) at a = e = 1 and b  c  d  f  0 as shown in Fig. 1, where the response of the transformed (original) system is plotted in blue (red) color.
The six added parameters provide controllability of the attrac- tor diagram, or its projection in the u v plane. In addition, the effect on each coordinate can be inferred from the time series.
Table 1 provides the analyses of simplified versions: scaling (in- crease or decrease the values), reflection, translation with fixed distance, and shearing processes.
Table 2 shows the time series and attactor diagrams of the transformed and original coordinates. The transformations given by (1) on the original time series, i.e., post-processing results are also plotted in black and the new equilibrium points are marked in pink color.
Stability analysis can also be performed for the systems of Table 1. For example, in case of rotation, the Jacobian matrix is given by:
cos h sin h	cos2 h	sin h
J = — sin2 h	— cos h sin h	cos h .
1.6 cos hd(u cos h — v sin h) — 0.8(cos h + sin h) —0.8(cos h — sin h) —0.8
(5)

2 u 3
2 a	b	0 32 x 3
2 c 3
The characteristic polynomial is given by:

64 v 75 = 64 d	e	0 7564 y 75 + 64 f 75,	(1)
			

with the inverse transformation
2 x 3	1 2 e	—b	0 32 u 3	1 2 bf — ce 3
y  = 4 —d	a	0 54 v 5 + 4 cd — af 5,	(2)
			
where a = ae — bd and the third coordinate w = z. The u-v-w coor-
k3 — tr(J)k2 + (M + M  + M )k — |J|= 0,	(6)
where tr(J) is the trace of the jacobian matrix, |J| is its determinant and Mij is the minor determinant of the matrix J by removing the ith
row and jth column. The coefficients of the characteristic polynomial are obtained as follows:

tr(J)=— 5 and |J|= 5 d(u cos h — v sin h) — 5.
M11 = 4 cos2 h + 4 sin 2hd(u cos h — v sin h),

dinates reduce to the x-y-z coordinates at a = e = 1 and
M22 = 4 sin2 h — 4 sin 2hd(u cos h — v sin h),

b = c = d = f = 0.


Validation case 1: generalized simplest system

A very simple jerk-based system with piecewise nonlinearity, which is generated by a signum function, was presented in [14]. In its original form, the system is given by:
x_ = y, y_ = z,
z_ = —0.8(z + y + x — sgn(x)),
M33 = 0 and hence M11 + M22 + M33 = 4.

Consequently, tr(J) and M11 + M22 + M33 are always indepen- dent of h. At the equilibrium points |J|=— 4. Hence, the character- istic polynomial evaluated at the equilibrium points and the resulting eigen values are independent of h and identical to those of the original system.
The effect of the transformation on the eigen vectors of the Jaco- bian matrix can also be studied. The Eigen Vectors Inclination (EVI) is plotted against the rotation angle h. EVI is the angle between the vector at h = 0 and that at a given value of h, i.e., Dh = h. In a real

—1,	x < 0
where sgn(x)=	0,	x = 0
(3)
inner product space, the angle / between two vectors x and y is
defined by cos	 <x,y> . In a complex vector space, taking the real
||x|| ||y||
ffi{<x,y>}

>: 1,	x > 0
part of this cosine defines the Euclidean angle as cos /E =
.
||x|| ||y||


Solving the system results in the chaotic attractor and time series shown in Fig. 1. The equilibrium points of the system are ( 1, 0, 0) and  the  Jacobian  matrix  is  independent  of  the
Fig. 2 shows that EVI (/E ) follows a pattern similar to that of the rotated system itself where EVI is plotted at the equilibrium points. Further utilization of rotation in the generalization of integer and
fractional-order chaotic systems can be found in [38,39,50].




Fig. 1. Attractor diagram and time series of system (3).



Table 1
Example transformations of the simplest chaotic system.

Scaling (+ve), Reflection (-ve)	Rotation

u_ = a v,
v_ = ew,
u_ = cos h(sin h u + cos h v) + sin h w,
v_ =— sin h(sin h u + cos h v) + cos h w,


 	
Equilibria: ( a, 0, 0)	Equilibria: ( cos h, n sin h, 0)
Scaling and translation	Shearing

u_ = a (v — f ) + c,
v_ = ew + f ,
u_	1
—bd
v_ = 1 d

(—du + v) + bw,
(—du + v) + w,

u  v	 u 
—bd

w_ = —0.8 w + a + e — sgn a
    	 

		
w_ = —0.8(w + 1 1
((1 — d)u + (1 — b)v)—sgn u—bv )





Table 2
Transformations of the simplest chaotic system: results and discussion.


Validation case 2: generalized lorenz system

Lorenz system is given by:
10 a
=— a
b

((u — c)(d + e)— (v — f )(a + b))



x_ = 10(y — x),

y_ = (28 — z)x — y,

z_ = xy — 8 z.	(7)
+ a ((u — c)(d + (28 — w)e)— (v — f )(a + (28 — w)b)) + c, (8)
Table 3 shows the scaling (reflection), translation and shearing transformations of Lorenz system. Chaotic time series is identified

Transformed Lorenz system can be obtained similarly, where for example:
using Lyapunov exponents, which quantify the divergence and convergence properties of an attractor [1]. Using Wolf’s algorithm




Fig. 2. Eigen Vectors Inclination (EVI) against the rotation angle h at the (a) first and (b) second equilibrium point.



Table 3
Attractor diagrams and time series of (8).
u_ =— 10 (e(u — c)— a(v — f )) + c,
v_ = 1 ((u — c)((28 — w)e)— a(v — f )) + f ,
w_ =— 1 (u — c)(v — f )— 8 w.

(9)

Fig. 4 shows different trajectories that the system follows dynamically in discrete steps. To be capable of visualizing the dynamic translation of the attractor, scaling parameters are used to control the output range. For Lorenz system, the output ranges are wide, hence, the scaling parameters a and e are set to values less than one. However, the translation parameters c and f have limited ranges that correspond to chaotic behavior as shown in the bifurcation diagrams of Fig. 5. Hence, it is more suitable to have a closed trajectory rather than open ones.
Table 4 shows a continuous motion of the attractor along differ- ent trajectories, where [41] provides more examples of plane curves. This is achieved by keeping c constant for a period of time, such that it is sufficient to plot a clear part of the diagram. Then, the value of c is changed a little bit and so on in gradual steps that take the shape of staircase. The parameter c can be generated using the equation:















as implemented in [40], the system is shown to exhibit chaotic strange attractors since the Maximum Lyapunov Exponent (MLE) is finite positive against the parameters corresponding to the dif- ferent cases as shown in Fig. 3.

Trajectory control by dynamic translation

The translation parameters c and f can be used to move the equilibrium points and, hence, the attractor diagram. The transla- tion along x-axis, c, can be changed in a piece-wise manner giving sufficient time for each value. In addition, the translation along y- axis, f, is given as a function of c, which is the trajectory. The scaling parameters are kept to control the output range and simplify the visualization of results. Scaled and translated system can be obtained by setting b d 0 in the equations of transformed Lor- enz, e.g. (8) yielding:

n
c(t)=  A(i)(H(t — B(i)) — H(t — B(i + 1))),	(10)
i=1

where H . is the unit step or Heaviside function, A and B are vectors that correspond to the gradual amplitudes and stop times of the stairs, respectively, of the resulting stair case plot. The first and last elements of the vector c equal those of A, respectively. The other translation parameter f is changed accordingly using the prescribed trajectory equation. In the examples of Table 4, the amplitudes of c
are in the interval  2, 2 and the step by which they vary equals 50
time units in a total simulation time of 500 time units. The resulting time series of (9) are compared to the scaled time series of the con- ventional Lorenz system. The resulting attractor diagrams follow the prescribed trajectories, which are red colored. The intensity of the strange attractor color varies with time, where the darker points are plotted first and becomes brighter as time advances.


PRNG and image encryption application

This section studies the performance of transformed Lorenz sys- tem, compared to Lorenz system, as a PRNG in an image encryption application. Three standard 1024 1024 color images: Lena, man- dril and peppers [42] are used for testing the encryption scheme. While Lena image is firstly used in comparing the Lorenz and transformed Lorenz systems performance in the scheme with detailed results, performance metrics are averaged for the three color channels of the two other images.




Fig. 3. MLE of transformed Lorenz against the parameters in (a) Scaling, (b) Translation and (c) Shearing cases.




Fig. 4. Trajectory control of transformed Lorenz chaotic system by scaling and translation for (a) line f = c, (b) parabola f = c2, (c) a square and (d) a circle of radius 4 (c2 + f 2 = 16) at a = e = 1.




Fig. 5. Bifurcation diagrams of transformed Lorenz chaotic system against the translation parameter c for the parabolic trajectory f = c2 and different values of the scaling parameters (a) a = e = 0.1 and (b) a = e = 0.7.


Table 4
Trajectory control of (9) for a = e = 0.1 and different dynamic c and f parameters.


Encryption and decryption schemes

Fig. 6 shows a simple image encryption scheme with both per- mutation and substitution phases, which was presented in [3]. Per- mutation of the original image is performed through generalized Arnold’s map [43], where the new pixel location is given by:
where mod returns the remainder, ckey and bkey are the key parts of the permutation parameters and chosen as 73 and 35, respectively and the value Psum  Rsum  Gsum  Bsum, except where stated other-
wise, represents the input dependent term, which enhances the resistance to different cryptanalysis attacks, where Rsum, Gsum and Bsum are the sums of the red, green and blue channels of the input

row
col  new =
1	c
b	1 + cb
row
col  old
mod(N)+ 
 1 




(11)
image, respectively [3].
In the substitution phase, the chaotic generator is either Lorenz or transformed Lorenz with the chaotic time series shown in Fig. 7.

for an N × N image. The generalized Arnold’s map permutation parameters c and b are computed as:
The correlation coefficients between the u, v and w and the corre- sponding x, y and z time series are —0.0054, —0.0051 and 0.0038.

c = mod P

sum +

ckey , N
— 1 + 1

(12)
The systems are solved by Euler numerical technique using a time step of 0.01. The outputs x (u), y (v) and z (w) are then multiplied

b = mod P

sum
+ bkey
, N — 1 + 1
by a scaling factor of 109 to be suitable for conversion to an integer














Fig. 6. (a) Encryption/decryption block diagrams, encryption/decryption key for (b) Lorenz and (c) transformed Lorenz chaotic generators and (d) multiplexing table.




Fig. 7. Time series of Lorenz, in red, and transformed Lorenz, in blue, at a = 2, b = 0.25, c = 3, d = —0.5, e = —2, f = —4, x0 = y0 = z0 = w0 = 0.1 u0 = 3.225 and v0 = —0.425.


value represented in 64 bits. Each component of the permuted image is xored with the 8 Least Significant Bits (LSBs) of the out- puts of the chaotic generator, respectively, xored together with a feedback element from a channel of the previously encrypted image selected by the LSBs of its channels [3] according to the mul- tiplexing procedure given in Fig. 6(d). The encryption key determi- nes the parameters of the chaotic generator where it consists of three sub-keys for Lorenz system compared to nine sub-keys using transformed Lorenz system.
Decryption is straightforward as the reverse process shown in Fig. 6(a). First, an exact duplicate of the same substitution stage is carried out on the encrypted image. Then, the resulting image is permuted by generalized Arnold’s map to return the pixels to their original locations and get the correctly decrypted image.

Performance evaluation

The performance of the scheme is evaluated through the PRNG properties, encrypted image histogram and its uniformity through chi square test, pixel correlation, Mean Squared Error (MSE), entropy, Peak Signal-to-Noise Ratio (PSNR), the National Institute of Standards & Technology (NIST) test, key space, key sensitivity, resistance to differential, ciphertext-only, known plaintext, and chosen plaintext attacks, robustness against noise and computa- tion time comparing Lorenz to transformed Lorenz systems as the chaotic generator. Equations of the performance metrics are given in Table 5.

PRNG properties
Fig. 8 compares the randomness properties of the chaotic sequence generated from Lorenz and transformed Lorenz systems. For a good chaotic sequence, the histogram should be nearly flat or uniform and the adjacent samples should be completely uncorre- lated. From Fig. 8, it can be inferred that both systems satisfy the requirements, where the nearly aperiodic chaotic sequence has nearly flat frequency distribution. Hence, the transformed Lorenz system provides more control of the Lorenz attractor and is still random and suitable for encryption applications.
More advanced statistical tests are provided by NIST statistical test suite [44], which is a statistical test suite for random and pseudo-random number generators for cryptographic applications. The tests are designed to examine the randomness characteristics of a sequence of bits by evaluating the P-value distribution (PV) and the proportion of passing sequences (PP). The test is carried out on the 8 LSBs of each chaotic output in the same manner in which they are used in the substitution of the 8-bit pixels. Table 6 shows that the PRNGs based on both Lorenz and transformed Lor- enz successfully pass the tests, which are: frequency, block fre- quency, cumulative sums, runs, longest run, rank, FFT, non- overlapping template, overlapping template, universal, approxi- mate entropy, random excursions, random excursions variant, serial and linear complexity, respectively.

Perceptual and statistical tests
The encrypted images corresponding to the two chaotic gener- ators are random as shown in Fig. 6 as well as Fig. 9. In addition, the corresponding histograms reveal a uniform intensity distribu- tion compared to the nonuniform histograms of the original image as shown in Fig. 10. To further check the degree of deviation from uniform histogram analysis, chi-square test [45] is used. The less the chi-square value, the better the uniformity. Table 7 gives the results for the encrypted image using both Lorenz and transformed Lorenz, where both have relatively low values compared to that of
the original image of O 106 .
Table 7 shows the ability of the system to destroy the horizon- tal, vertical and diagonal correlation between the pixels where the correlation coefficients of the encrypted image approach zero. High MSE, entropy approaching 8 and low PSNR further indicate the ran- domness and unpredictability of the encrypted image.
Table 6 also examines the randomness of the encrypted images by evaluating the PV and PP of NIST and they successfully pass the tests.

Key space and key sensitivity
Key space is defined as the number of encryption keys that are available in the cryptosystem. The maximum key space is deter-



Table 5
Performance metrics of image encryption systems.

v2  = Pk  (oi —ei ) , k = 256 is the number of levels in a color, o and e are the observed and expected occurrence frequencies of each color level (0–255), respectively.

For 1024 × 1024 image, ei = 1024 × 1024/256 = 4096.
Correlation coefficient (q) = ,ﬃﬃﬃﬃcﬃoﬃﬃvﬃﬃﬃ(,x,yﬃﬃ)ﬃﬃﬃﬃﬃﬃﬃﬃ, where cov(x, y)= 1 PS

 x — 1 PS

x  y — 1 PS

y , D(x)= 1 PS

 x — 1 PS

x 2 , S = M(height)× N(width).

Mean Squared Error (MSE)=  1  PN PM (P(i, j)— D(i, j))2 , where P(i, j), D(i, j) are the original & wrong decrypted image pixels
Entropy= —P28 p(s )log p(s ), where p(s ) is the probability of symbol s
Peak Signal-to-Noise Ratio (PSNR)= 20log10 ,MSE , where Imax is the maximum pixel value in the image. NumberofPixelChangeRate(NPCR)=  1  PN PM D(i, j) × 100,
UnifiedAverageChangingIntensity(UACI)=  1  PN PM C1 (i,j)—C2 (i,j) × 100,
where D(i, j)=  1,	C1 (i, j) – C2 (i, j) , C1 is the ciphered pixel and C2 is the ciphered pixel corresponding to a slightly modified original image.




Fig. 8. Time series, frequency distribution of the outputs and histogram of the PRNG using (a) Lorenz and (b) transformed Lorenz chaotic generators.


mined by sensitivity analysis. Sensitivity of Lorenz system for per- turbations in the initial conditions is as follows Dx0, Dy0 P 10—17 and Dz0 P 10—16. Sensitivity of transformed Lorenz system for per- turbations in the initial conditions and parameters is as follows Dx0, Dy0 P 10—15, Dz0 P 10—17, Da P 10—15, Db P 10—16, Dc P 10—15, Dd P 10—16 and De, Df P 10—15.
The initial conditions and parameters of the chaotic generator
consist of a fixed part and a key part, which is determined from the sub-keys denoted by L for Lorenz system and T for transformed Lorenz system as shown in Figs. 6(b) and (c). For example, x0 = xfix + Dx0, where Dx0 equals L1 multiplied by a scaling factor and similarly for the rest of the parameters. The fixed parts are
set to the values of Fig. 7. To ensure high key sensitivity, a mini- mum perturbation of 10—14 is specified. Hence, each sub-key is lim- ited to 44 bits using a scaling factor of 10—13. Consequently, the key space of transformed Lorenz system equals 2396 compared to 2132 of Lorenz system, which is equivalent to 3 times increase in the number of bits.
Table 7 gives the values of high MSE and entropy approaching 8,
which indicate the randomness and unpredictability of the wrong decrypted image when the Least Significant Bit (LSB) of the sub- key Dx0 (or Du0) is changed. Similar results are obtained for the rest of the sub-keys. An advantage of the encryption system is that per- turbation in any parameter affects the three time series and, hence,


Table 6
NIST results for the PRNG and encrypted images.

PRNG			Encrypted Lena		Enc. mandril	Enc. peppers Lorenz	Transformed	Lorenz		Transformed		Transform.		Transform.

















Fig. 9. Original and encrypted (a) mandril and (b) peppers images.



Fig. 10. Histograms of the red channel of (a) Lena image and the corresponding encrypted images using (b) Lorenz and (c) transformed Lorenz systems.



Table 7
Performance metrics of the scheme for three encrypted images.
Test		Lena (Lorenz)			Lena (Transformed)		Mandril	Peppers R		G	B	R		G	B

2
test
 ×102	2.4808	2.505	2.6253	3.2239	2.5216	2.8009	2.6778	2.4336

CC	Horizontal	—0.0626	—0.0634	0.0227	—6.7144	—20.8894	—19.0264	8.0344	—1.0496
×10—4	Vertical	13.7072	—5.8588	0.8549	—8.8684	2.7001	—3.9709	3.2939	—1.1189
Diagonal	—15.6653	—1.6203	—8.1332	—4.7629	—9.1812	—3.6888	0.3586	0.0903

MSE
 ×103	10.6217	9.0629	7.0821	10.6636	9.0617	7.0824	8.7107	8.7984
Entropy	7.9998	7.9998	7.9998	7.9998	7.9998	7.9998	7.9998	7.9998
PSNR	7.8689	8.5581	9.6292	7.8517	8.5587	9.6291	8.7537	5.7898

Key Sens.	MSE ×103	10.6606	9.0569	7.1293	10.6599	9.0727	7.1136	8.7019	8.0343
(Dx0, Du0)	Entropy	7.9994	7.9993	7.9993	7.9993	7.9993	7.9992	7.9991
7.9992
DA	NPCR	99.6061	99.6091	99.6104	99.6094	99.6126	99.6121	99.6101	99.6096
UACI	33.4859	33.4993	33.4859	33.4726	33.4834	33.4571	33.4582	33.4593




the three channels unlike encryption systems based on indepen- dent discrete maps for each channel [3].

Resistance to differential attacks
Table 7 shows the values of the NPCR and UACI averaged over 20 trials in which one pixel in the original image is changed, which successfully approach 100% and 33.3%, respectively [3].

Resistance to other cryptanalysis attacks
Cryptanalysis is the process of studying encryption systems with the intention of revealing their weaknesses and establishing the appropriate attacking schemes [46]. Other famous cryptanaly- sis techniques, besides brute force and differential attacks, are the ciphertext-only, known plaintext, chosen plaintext and side chan- nel attacks. However, they are less frequently investigated when proposing a new encryption scheme, especially for chaos-based ciphers.
In ciphertext-only attack, the attacker has access only to a ciphertext or a collection of ciphertexts with the objective of find- ing the plaintext image and/or the secret key. This requires the use of brute force [47], and hence, the large key space and the encryp- tion key design such that it depends on the plaintext image are effective means of enhancing the scheme’s resistance to this attack.

Table 8
Chosen plaintext attack/known plaintext attack analysis.
In known plain text attack, the attacker has a ciphertext or a set of ciphertexts for which the corresponding plaintext is also known with the objective of finding the secret key. Chosen plaintext attack gives more flexibility to an attacker by allowing plaintext to be selected observing the corresponding ciphertext. To depict the capability of the proposed scheme in eliminating all traces of cho- sen patterns in a plainimage, a 4  4  3 image was encrypted sim- ilar to [37]. The resulting pixel values after before and after encryption are shown in Table 8, where any specific patterns, white or black images are fully randomized after encryption with no observable patterns. This is owed to the presence of both per- mutation and substitution stages, key sensitivity and plainimage sensitivity properties of the scheme.


Robustness against noise
The encrypted images may suffer from noise effects during transmission from transmitter to receiver such as: Additive White Gaussian Noise (AWGN) and Salt and Pepper (S & P) noise [48]. To enhance the robustness of the scheme against noise, some input dependent terms in the encryption scheme can be modified. For example, Figs. 11(a) and (b) show the decrypted images corre- sponding to Lena for AWGN of mean 0 and different variances and S & P of different densities, respectively, when Psum = 0 and



1	2	3	4	1	1	1	1	255	255	255	255
4 × 4 × 3	1	2	3	4	1	1	1	1	255	255	255	255
plainimage	1	2	3	4	1	1	1	1	255	255	255	255
1	2	3	4	1	1	1	1	255	255	255	255
2	233	184	203	147	137	125	187	73	33	53	97
4 × 4 × 3	141	163	166	245	94	238	193	217	169	119	28	163
cipherimage	34	223	68	190	21	69	189	150	222	106	220	184
239	42	192	231	32	135	236	205	177	36	101	55




Fig. 11. Decrypted images and correlation coefficients corresponding to Lena for (a) AWGN of mean 0 and different variances and (b) S & P of different densities when Psum = 0 and MUX is removed.


Table 9
Comparison of the ideas and evaluation of different image encryption schemes.


test










the MUX is removed. The correlation coefficients between the noiseless decrypted image and the noisy one are also given. The robustness against noise can be identified by the capability of per- ceptually identifying the image content and the correlation coeffi- cient values approaching one.

Time analysis
Our main concern is the time consumed in the solution of the system of differential equations in the substitution phase. Simula- tions are performed using Matlab 8.4.0.150421 (R2014b) and Win- dows 8.1 on an Intel(R) Core(TM) i7-4510U CPU @ 2.00 GHz
machine. Averaged over 10 trials, around 46.81 % increase in the
computation time of transformed Lorenz than Lorenz system is reported. This is associated with the gain of about 3 times increase in the maximum number of bits of the substitution part in the encryption key with nine sub-keys each with high sensitivity.

Discussion and comparison against other works

Novel chaotic systems were presented in [27–33] providing var- ious control capabilities over the strange attractors’ size, location, shape and number of scrolls. Yet, these works barely presented applications for their proposed systems. The image encryption scheme utilizing the proposed transformed Lorenz system is com- pared to other recent image encryption schemes [34–37], which utilized chaotic systems and included separate transformation stages as well. The basic idea and main blocks utilized in each scheme are given in Table 9, where only [36] embedded chaotic maps in a cosine transformation to generate equation of a new chaotic map. All the utilized chaotic generators were simple low- dimensional chaotic maps. On the other hand, the proposed trans- formed Lorenz system is based on differential equations allowing increased complexity, sensitivity and further enhanced chaotic properties. The capability of generating three chaotic outputs simultaneously makes it more suitable for color image encryption applications. Table 9 also compares the schemes from the view- point of the performance metrics evaluated in each paper. While both [36,37] gave a clear description of the key design, space and sensitivity analysis, [34,35] only mentioned the parameters from which the key can be composed and assessed sensitivity by slightly modifying the parameter value. Such preliminary analysis neglects that the effective key space is governed by the basin of attraction and parameter basin of attraction which correspond to chaotic behavior [49] and the remarkable importance of Least Significant Bit (LSB) sensitivity. While none of the compared works performed chi-square or NIST tests, all of them presented differential attack and time analyses except [34]. None of the other cryptanalysis attacks or robustness against noise were analyzed except in [37], which discussed known- and chosen-plaintext attacks.
Conclusions and future work directions

A generalized scaling, reflection, rotation, translation or shear- ing transformation of chaotic systems was proposed and validated for the simplest and Lorenz systems. The effects on the time series, equilibrium points, attractor diagrams, bifurcations and MLE were demonstrated. This approach overpasses post-processing by apply- ing transformations on the resulting time series. The six parame- ters, which are embedded in the differential equations of the chaotic system, control the system response and enhance its ran- domness and sensitivity. Trajectory control of the dynamic motion of the attractor was also presented exploring different trajectories. In an image encryption system that passes the standard perfor- mance tests, transformed Lorenz system increases the key space and, hence, security in comparison to Lorenz system with an acceptable increase in the computation time as well as overpassing other recent related works.
For future work, transformations in different 2D planes, 3D transformations and nonlinear transformations can be applied to obtain more random and sensitive time series. Using dynamic parameters, a gallery of strange attractors with variable and con- trollable number of equilibrium points and strange attractor shapes can be produced. In addition, they can be utilized in robotic applications for random motion planning along a prescribed trajec- tory. Given the acceptable increase in the computation time, hard- ware realization of the generalized transformed systems or their special cases can be performed.


Declaration of Competing Interest

The authors declare that they have no known competing finan- cial interests or personal relationships that could have appeared to influence the work reported in this paper.


References

Strogatz SH. Nonlinear dynamics and chaos: with applications to physics, biology, chemistry, and engineering. Westview Press; 2014.
Gohari PS, Mohammadi H, Taghvaei S. Using chaotic maps for 3D boundary surveillance by quadrotor robot. Appl Soft Comput 2019;76:68–77.
Radwan AG, AbdElHaleem SH, Abd-El-Hafiz SK. Symmetric encryption algorithms using chaotic and non-chaotic generators: a review. J Adv Res 2016;7(2):193–208.
Abbas NA. Image encryption based on independent component analysis and arnold’s cat map. Egypt Inf J 2016;17(1):139–46.
Ge M, Ye R. A novel image encryption scheme based on 3d bit matrix and chaotic map with markov properties. Egypt Inf J 2019;20(1):45–54.
Wang H, Liang H-F, Miao Z-H. A new color image encryption scheme based on chaos synchronization of time-delay Lorenz system. Adv Manuf 2016;4 (4):348–54.
Radwan A, Soliman A, El-Sedeek A. MOS realization of the modified Lorenz chaotic system. Chaos Solitons Fractals 2004;21(3):553–61.



Zidan MA, Radwan AG, Salama KN. Controllable V-shape multiscroll butterfly attractor: system and circuit implementation. Int J Bifurcation Chaos 2012;22 (06):1250143.
Lorenz EN. Deterministic nonperiodic flow. J Atmos Sci 1963;20(2):130–41.
Elwakil AS, Ozoguz S, Kennedy MP. Creation of a complex butterfly attractor using a novel Lorenz-type system. IEEE Trans Circuits Syst I: Fundam Theory Appl 2002;49(4):527–30.
Lü J, Chen G, Cheng D. A new chaotic system and beyond: the generalized Lorenz-like system. Int J Bifurcation Chaos 2004;14(05):1507–37.
Elwakil AS, Özoguz S. A system and circuit for generating ‘‘multi-butterflies”. Int J Bifurcation Chaos 2008;18(03):841–4.
Yu S, Tang WK, Lü J, Chen G. Design and implementation of multi-wing butterfly chaotic attractors via Lorenz-type systems. Int J Bifurcation Chaos 2010;20(01):29–41.
Elwakil A, Salama K, Kennedy M. A system for chaos generation and its implementation in monolithic form. In: Circuits and Systems, 2000. Proceedings. ISCAS 2000 Geneva. The 2000 IEEE International Symposium on, vol. 5, IEEE; 2000. p. 217–20..
Sprott JC. Simple chaotic systems and circuits. Am J Phys 2000;68(8):758–63.
Sprott JC. A new class of chaotic circuit. Phys Lett A 2000;266(1):19–23.
Sprott JC. A new chaotic jerk circuit. IEEE Trans Circuits Syst II Express Briefs 2011;58(4):240–3.
Vaidyanathan S. Analysis, control and synchronization of a 3-D novel jerk chaotic system with two quadratic nonlinearities. Kyungpook Math J 2015;55:563–86.
Sayed WS, Radwan AG, Fahmy HA. Chaotic systems based on jerk equation and discrete maps with scaling parameters. In: 6th International Conference on Modern Circuits and Systems Technologies (MOCAST), IEEE; 2017. p. 1–4..
Sayed WS, Radwan AG, Fahmy HA. Chaos and bifurcation in controllable jerk- based self-excited attractors. In: Nonlinear Dynamical Systems with Self- Excited and Hidden Attractors. Springer; 2018. p. 45–70.
Sayed WS, Henein MM, Abd-El-Hafiz SK, Radwan AG. Generalized dynamic switched synchronization between combinations of fractional-order chaotic systems. Complexity 2017;2017.
Marion JB. Classical dynamics of particles and systems. Academic Press; 2013.
Brinón-Arranz L, Seuret A, Canudas-de Wit C. Cooperative control design for time-varying formations of multi-agent systems. IEEE Trans Autom Control 2014;59(8):2283–8.
Hearn D, Baker MP, Baker MP. Computer graphics with OpenGL, vol.
3. NJ: Pearson Prentice Hall Upper Saddle River; 2004.
Salcedo-Sanz S, Aybar-Ruíz A, Camacho-Gómez C, Pereira E. Efficient fractal- based mutation in evolutionary algorithms from iterated function systems. Commun Nonlinear Sci Numer Simul 2018;56:434–46.
Roy SK, Kumar S, Chanda B, Chaudhuri BB, Banerjee S. Fractal image compression using upper bound on scaling parameter. Chaos Solitons Fractals 2018;106:16–22.
Ai X, Sun K, He S, Wang H. Design of grid multiscroll chaotic attractors via transformations. Int J Bifurcation Chaos 2015;25(10):1530027.
Lassoued A, Boubaker O. On new chaotic and hyperchaotic systems: a literature survey. Nonlinear Anal: Modell Control 2016;21(6):770–89.
Pham V-T, Jafari S, Wang X, Ma J. A chaotic system with different shapes of equilibria. Int J Bifurcation Chaos 2016;26(04):1650069.
Liu Y, Guo S. Generation and dynamics analysis of n-scrolls existence in new translation-type chaotic systems. Chaos: Interdisc J Nonlinear Sci 2016;26 (11):113114.
Li C, Sprott JC, Mei Y. An infinite 2-D lattice of strange attractors. Nonlinear Dyn 2017;89(4):2629–39.
Su Q, Wang C, Chen H, Sun J, Zhang X. A new method for generating chaotic system with arbitrary shaped distributed attractors. Chaos: Interdisc J Nonlinear Sci 2018;28(7):073106.
Wu Q, Hong Q, Liu X, Wang X, Zeng Z. Constructing multi-butterfly attractors based on Sprott C system via non-autonomous approaches. Chaos Interdisc J Nonlinear Sci 2019;29(4):043112.
Mishra D, Sharma R, Ranjan R, Hanmandlu M. Security of rgb image data by affine hill cipher over SLn (Fq) and Mn (Fq) domains with Arnold transform. Optik 2015;126(23):3812–22.
Ahmad J, Hwang SO. A secure image encryption scheme based on chaotic maps and affine transformation. Multimedia Tools Appl 2016;75(21):13951–76.
Hua Z, Zhou Y, Huang H. Cosine-transform-based chaotic system for image encryption. Inf Sci 2019;480:403–19.
Alawida M, Samsudin A, Teh JS, Alkhawaldeh RS. A new hybrid digital chaotic system with applications in image encryption. Signal Process 2019;160:45–58.
Sayed W, Radwan A, Elnawawy M, Orabi H, Sagahyroon A, Aloul F, Elwakil A, Fahmy H, El-Sedeek A. Two-dimensional rotation of chaotic attractors: Demonstrative examples and fpga realization, Circuits Syst Signal Process.
pp. 1–14..
Sayed WS, Radwan AG, Fahmy HA, Elsedeek A. All-dynamic synchronization of rotating fractional-order chaotic systems. In: 2019 Novel Intelligent and Leading Emerging Sciences Conference (NILES), vol. 1, IEEE; 2019. p. 226–29..
Govorukhin VN. Calculation lyapunov exponents for ODE, MATLAB Central File Exchange, file ID 4628; 2004..
Lawrence JD. A catalog of special plane curves. Courier Corporation; 2013.
Weber AG. The USC-SIPI image database version 5. USC-SIPI Report 1997;315:1–24.
Ye G, Wong K-W. An efficient chaotic image encryption algorithm based on a generalized arnold map. Nonlinear Dyn 2012;69(4):2079–87.
Rukhin A, Soto J, Nechvatal J, Smid M, Barker E. A statistical test suite for random and pseudorandom number generators for cryptographic applications, Tech. rep., DTIC Document; 2001..
Kwok H, Tang WK. A fast image encryption system based on chaotic maps with finite precision representation. Chaos Solitons Fractals 2007;32(4):1518–29.
Schneier B. Applied cryptography: protocols, algorithms, and source code in
C. John Wiley & Sons; 2007.
Ahmed F, Anees A, Abbas VU, Siyal MY. A noisy channel tolerant image encryption scheme. Wireless Personal Communications 2014;77(4):2771–91.
Ismail SM, Said LA, Radwan AG, Madian AH, Abu-Elyazeed MF. Generalized double-humped logistic map-based medical image encryption. J Adv Res 2018;10:85–98.
Sayed WS, Tolba MF, Radwan AG, Abd-El-Hafiz SK. FPGA realization of a speech encryption system based on a generalized modified chaotic transition map and bit permutation. Multimedia Tools Appl 2019;78(12):16097–127.
Sayed WS, Radwan AG. Generalized Switched Synchronization and Dependent Image Encryption Using Dynamically Rotating Fractional-Order Chaotic Systems. AEU-International Journal of Electronics and Communications 2020;153268.
