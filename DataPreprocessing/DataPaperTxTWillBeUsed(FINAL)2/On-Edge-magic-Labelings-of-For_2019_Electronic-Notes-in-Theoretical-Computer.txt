Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 346 (2019) 299–307
www.elsevier.com/locate/entcs
On Edge-magic Labelings of Forests
Marcia R. Cerioli1,2
Institute of de Mathematics and PESC-COPPE. Federal University of Rio de Janeiro. Rio de Janeiro, Brazil
Cristina G. Fernandes1,2
Institute of Mathematics and Statistics. University of Sa˜o Paulo. S˜ao Paulo, Brazil
Orlando Lee1,2
Institute of Computing. University of Campinas. Campinas, S˜ao Paulo, Brazil
Carla N. Lintzmayer1,2 Guilherme O. Mota1,2
Center for Mathematics. Computing and Cognition. Federal University of ABC. Santo Andr´e, Sao Paulo, Brazil
Candida N. da Silva1,2
Department of Computing. Federal University of S˜ao Carlos. S˜ao Carlos, Brazil

Abstract
Given an n-vertex graph G = (V, E) with m edges, a labeling f of V ∪ E that uses all the labels in the set {1, 2,...,n + m} is edge-magic if there is an integer k such that f (u)+ f (v)+ f (uv) = k for every edge uv ∈ E. Furthermore, if the labels in {1, 2,..., n} are given to the vertices, then f is called super edge-magic. Kotzig [On magic valuations of trichromatic graphs, Reports of the CRM, 1971] started the investigation of super edge-magic labelings of forests. Following this line of research, we prove that some forests of stars admit a super edge-magic labeling and that some forests of caterpillars admit an edge-magic labeling.
Keywords: Edge-magic labelings, Stars, Caterpillars, Forests.


1 M. R. Cerioli was partially supported by CNPq (Proc. 310806/2016-0). C. G. Fernandes was par- tially supported by CNPq (Proc. 456792/2014-7 and 308116/2016-0). O. Lee was supported by CNPq (Proc. 311373/2015-1 and 425340/2016-3) and FAPESP (Proc. 2015/11937-9). G. O. Mota was supported by FAPESP (Proc. 2018/04876-1) and CNPq (Proc. 304733/2017-2). This study was financed in part by the Coordena¸c˜ao de Aperfei¸coamento de Pessoal de N´ıvel Superior, Brasil (CAPES), Finance Code 001. The research that led to this paper started in WoPOCA 2017, which was financed by FAPESP (2013/03447-6, 2015/11937-9) and CNPq (456792/2014-7).
2 Email:  cerioli@cos.ufrj.br, cris@ime.usp.br , lee@ic.unicamp.br, carla.negri@ufabc.edu.br,

https://doi.org/10.1016/j.entcs.2019.08.027
1571-0661/© 2019 The Author(s). Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

Introduction
Let G = (V, E) be an n-vertex graph with m edges. A function f : V ∪ E →
{1, 2,...,n + m} is an edge-magic labeling of G if f is bijective and, for some integer k, we have f (u)+ f (v)+ f (uv)= k for every edge uv ∈ E. The number k is a magic constant of G. Furthermore, if f (V )= {1, 2,..., n}, then the labeling f is called super edge-magic.
Magic labelings have applications in communication networks. Such networks consist of devices and communication lines connecting these devices [1,2]. To avoid collision, each communication line has a unique identifier. For security reasons, one must be able to deduce the identifier of a line from the devices it connects. This goal is achieved if the sum of the identifier of the line with the identifiers of the two connecting devices is constant in the whole network. Another application of magic labelings is in the use of radar impulses to measure the distance between objects [1,3].
A star with n vertices is a tree isomorphic to the complete bipartite graph K1,n−1. We denote by |S| the size of a star S, which is its number of edges. A caterpillar is a tree composed by a central path and vertices directly connected to this path. Note that a star is also a caterpillar.
Edge-magic labelings were introduced by Kotzig and Rosa [9], who proved that the following graphs are edge-magic: bipartite complete graphs Kp,q for all p, q ≥ 1, cycles Cn for all n ≥ 3, paths Pn for all n ≥ 2, stars, caterpillars, and 1-regular graphs with an odd number of edges. Later [10] they proved that the complete graph Kn is edge-magic if and only if n = 2, 3, 5, 6. They also asked if any tree is edge-magic, a question that is open to this day. The concept of super edge- magic labelings was introduced by Enomoto, Llad´o, Nakamigawa, and Ringel [4], who proved that any n-vertex super edge-magic graph with m edges must satisfy m ≤ 2n − 3. Furthermore, they showed that Cn is super edge-magic if and only if n is odd, Kn is super edge-magic if and only if n = 1, 2, 3, and Kp,q is super edge-magic if and only if p = 1 or q = 1. Note that this last result includes the stars. They also verified that all trees with up to 15 vertices are super edge-magic, and conjectured that any tree is super edge-magic.
In this paper we are interested in particular types of forests. Kotzig [8] showed that if G is a 3-colorable edge-magic graph, then any graph composed by the union of an odd number of copies of G is also edge-magic. This directly implies that if T is a path, a caterpillar, or a star, then a forest composed by a union of an odd number of copies of T is edge-magic. Figueroa-Centeno, Ichishima and Muntaner- Batle [6] showed that a forest with k copies of K1,n−1 is super edge-magic if k is odd. They also proved that, if a forest consisting only of paths is super edge-magic, then a graph composed by k copies of such forest is also super edge-magic for k odd. This implies that forests composed by k copies of the same star (or path) are super edge-magic for k odd. For more results about edge-magic labelings, we refer the reader to the books [12,14] and to the survey [7].

g.mota@ufabc.edu.br, candida@ufscar.br.

Our contribution is twofold: we investigate the problem of describing edge-magic labelings in some forests of stars and some forests of caterpillars. A star forest is a forest whose components are stars. We say that a forest of stars is odd if it consists of an odd number of stars. It is easy to see that a 1-regular graph with k edges, which is a star forest, is not super edge-magic if k is even [6, Lemma 1.2]. The following conjecture was posed in 2002.
Conjecture 1.1 (Lee–Kong [11]) Every odd star forest is super edge-magic.
Lee and Kong [11] proved that some star forests with less than five stars are super edge-magic. In what follows, let (S1, S2,..., Sk) be a star forest with |V (Si)| = ni for 1 ≤ i ≤ k. Zhenbin and Chongjin [15] proved that, if k = 2q + 1, ni = a for 1 ≤ i ≤ q + 1, and ni = b for q +2 ≤ i ≤ 2q + 1, then (S1, S2,..., Sk) is super edge- magic. Recently, Manickam, Marudai, and Kala [13] showed that, for r ≥ 3 odd, if n1, n2,..., nk is an increasing sequence of positive integers with ni = 1 + (i − 1)d for 1 ≤ i ≤ k and any d, then (S1, S2,..., Sk) is super edge-magic. For instance, for n1 = 1,..., nk = k, the star forest (S1, S2,..., Sk) is super edge-magic.
We are interested in symmetric star forests, which are those such that the num- ber of stars of each size is even except for at most one size. In our first main result (Theorem 2.2), we prove that every odd symmetric star forest has a super edge- magic labeling, providing a positive result regarding Conjecture 1.1. Furthermore, the labeling we show in this result is also special super edge-magic, which is a super edge-magic labeling f of a bipartite graph G[X, Y ] where f (X) = {1, 2,..., |X|}. An open problem regarding such labelings is to characterize the star forests which admit special super edge-magic labelings [12, Problem 2.9].
Our second result concerns caterpillar forests, which are forests whose compo- nents are caterpillars. Being a tree, a caterpillar is also a bipartite graph, so we say it is of type (r, s) if r and s are the sizes of the parts of its unique bipartition, where r ≤ s. A caterpillar forest is odd if it has an odd number of caterpillars and it is uniform if all of its caterpillars are of the same type. In Theorem 3.1, we prove that every odd uniform caterpillar forest has an edge-magic labeling.
This paper is organized as follows. In Section 2 we prove Theorem 2.2, which deals with star forests. The result concerning caterpillar forests (Theorem 3.1) is proved in Section 3.

Star forests
When dealing with super edge-magic labelings, the following result given by Figueroa-Centeno, Ichishima, and Muntaner-Batle [5] turns out to be very useful and it will be used in this section.
Lemma 2.1 ([5]) An n-vertex graph G = (V, E) with m edges is super edge-magic if and only if there exists a bijective function f : V → {1,..., n} such that the set L = {f (u)+ f (v): uv ∈ E} consists of m consecutive integers. In such a case, f extends to a super edge-magic labeling of G.

Let C be an odd symmetric star forest on n vertices, and let S be the only star that appears in C an odd number of times. Let p = |C| and r be such that p = 2r − 1. Let S1,..., Sp be the stars in C so that Sr = S, |Si| = |Sp—i+1| for every i = 1,...,r − 1, and |Si|≤ |Si+1| for every i = 1,...,r − 2. Note that such an order exists because C is odd and symmetric. Let ci denote the central vertex of the star Si. From now on, we consider that any odd symmetric star forest is a sequence of stars described as in such order.
A super edge-magic labeling f of C is standard if f (ci)= i for i = 1,...,p and, whenever n > p, the smallest sum in L = {f (u)+ f (v) | uv ∈ E(C)} is r + p + 1.
The next theorem shows that every odd symmetric star forest has a standard super edge-magic labeling. Figure 1 shows an example of such labeling for a star forest with seven stars.
1	2	3	4	5	6	7
						

12  19
13  20
14  21  24  26  28
8	15  22
9	16  23  25  27
10  17
11  18

Fig. 1. Example of a standard super edge-magic labeling with magic constant 61 on an odd symmetric star forest.

Theorem 2.2 Every odd symmetric star forest has a standard super edge-magic labeling.
Proof. Let C be an odd symmetric star forest and p = |C|. The proof is by induction on the number n of vertices of C. If n = p, then C consists of only the centers of the stars. Set f (ci) = i for i = 1,..., p. Trivially this is a standard super edge-magic labeling of C.
Suppose n > p, that is, C contains at least one non-trivial star. Let pj > 0 be the number of non-trivial stars in C. Note that pj is odd if the central star S is nontrivial; otherwise pj is even. Let Cj be the star forest obtained from C by removing a leaf from each non-trivial star in C. Call u1,..., up′ these removed leaves, in the order of their stars in C, and let U = {u1,..., up′ }. Note that Cj is odd and symmetric, and the order of the stars in C has the same properties in Cj. Let nj be the number of vertices in Cj. Then nj = n − pj, and we can apply induction on Cj to obtain a standard super edge-magic labeling fj for Cj.
We define the standard labeling f on C as follows. First, let f (ci)= fj(ci)= i for i = 1,..., p. Second, for every vertex v in Cj which is not a star center, let f (v) = fj(v)+ pj. See Figure 2. Now we describe the labels for vertices in U . Let l = [(pj + 1)/2|. The idea is to label the vertices in U cyclically starting at ul, with labels p + 1,...,p + pj. Set f (uj) = p + j − l +1 for j = l,..., pj and f (uj)= (p + pj − l + 1)+ j = f (up′ )+ j for j = 1,...,l − 1. Let us show that f can be extended to a standard super edge-magic labeling. That is, let us show that the set L = {f (u)+ f (v) | uv ∈ E(C)} consists of consecutive integers starting from r + p + 1.
Because fj is a standard super edge-magic labeling by induction, by Lemma 2.1,

1	2	3	4	5	6	7	1	2	3	4	5	6	7
	 	 				

10 12 14 8  9 11 13
f (u1)f (u2)f (u3)17 19 21 f (u4)15 f (u5)16 18 20 f (u6)f (u7)

Fig. 2. Labeling for a star forest C on the right obtained from the labeling of the star forest C′ on the left.

we know that Lj = {fj(u)+ fj(v) | uv ∈ E(Cj)} consists of consecutive integers starting from r+p+1. By the way we defined f on V (Cj), the set L1 = {f (u)+f (v) | uv ∈ E(Cj)} consists of the consecutive integers starting from r + p +1+ pj (the same consecutive integers plus pj). Let us argue that L2 = {f (u)+ f (v) | uv ∈ E(C) \ E(Cj)} consists of the pj consecutive integers starting from r + p + 1.
If Sr  is non-trivial,  then ul  is in Sr  and thus f (cr) + f (ul)  = r + p + 1.  For j = l + 1,..., pj, vertex uj is in Sr+j—l (which is non- trivial by the order of the stars in C), and therefore f (cr+j—l) + f (uj) = (r + j − l)+ (p + j − l + 1) = r + p +1+ 2(j − l). Now, u1 is in Sq for q = p− (r + pj −l)+1 = r−pj + l and hence f (cq)+f (u1)= q +(p + pj −l+2) = p + r +2. For j = 2,...,l − 1, vertex uj is in Sq+j—1 (which is also non-trivial), and so f (cq+j—1)+ f (uj)= (q + j − 1) + (p + pj − l + j + 1) = p + r + 2j.
If Sr is trivial, then ul is in Sr+1 and thus f (cr+1)+ f (ul)= (r + 1)+ p +1 = p + r + 2. For j = l + 1,..., pj, vertex uj is in Sr+1+j—l (which is non-trivial by the order of the stars in C), hence f (cr+1+j—l)+ f (uj)= (r +1+ j−l)+(p + j−l + 1) = r + p +2+ 2(j − l). Now, let q = p − (r +1+ pj − l)+1 = r − 1 − pj + l. For j = 1,..., l−1, vertex uj is in the non-trivial star Sq+j—1, and so f (cq+j—1)+f (uj)= (q + j − 1) + (p + pj − l + j + 1) = p + r − 1+ 2j.
This concludes the proof that L1 ∪ L2 is a set of n − p consecutive integers and therefore, by Lemma 2.1, f can be extended to a standard super edge-magic labeling for C.	2
Caterpillar forests
Let A be an odd uniform caterpillar forest of type (r, s).  Let p = |A| and let
C1,.  , Cp be the caterpillars in A. We will consider the following notation, which is depicted in Figure 3. Let ui1,.  , uir denote the vertices of one part of the caterpillar
Ci and vi1,..., vis denote the vertices of the other part, so that if uijvik ∈ E(Ci), then uij′ vik′ ∈/ E(Ci) for any jj and kj such that (i) jj > j and kj < k or (ii) jj < j and kj > k. Note that since caterpillars are planar graphs, there is always such an order of its vertices. Furthermore, let ei(r+s—1) = ui1vi1, let ei(r+s—2) be the next edge in the considered order of vertices, and so on, until ei1 = uirvis. Thus, the edges of Ci are, in order, ei(r+s—1), ei(r+s—2),.  , ei1.
The next theorem shows that every odd uniform caterpillar forest has an edge- magic labeling. Figure 4 shows an example of such a labeling for a forest with five caterpillars.
Theorem 3.1 Every odd uniform caterpillar forest has an edge-magic labeling.

u11  u12  u13
u21  u22  u23
u31  u32  u33
u41  u42  u43
u51  u52  u53

v11  v12  v13  v14
v21  v22  v23  v24
v31  v32  v33  v34
v41  v42  v43  v44
v51  v52  v53  v54

Fig. 3. An odd uniform caterpillar forest of type (3, 4).

1	2	3
14	15	16
27	28	29
40	41	42
53	54	55

36	37	38	39
49	50	51	52
62	63	64	65
10	11	12	13
23	24	25	26

Fig. 4. Example of an edge-magic labeling with magic constant 98 on an odd uniform forest with five caterpillars of type (3, 4).
Proof. Let A be an odd uniform caterpillar forest of type (r, s) and let C1,..., Cp be the caterpillars in A. For every 1 ≤ i ≤ p, denote the vertices of Ci by ui1,..., uir, vi1,..., vis and the edges of Ci by ei1,..., ei(r+s—1) as described in the beginning of this section.
For simplicity, we use x for the sum of the number of vertices and the number of edges in a caterpillar Ci, i.e., x = 2(r + s) − 1. We define an edge-magic labeling f of A as follows:
f (uij)= j + (i − 1)x for any 1 ≤ i ≤ p and 1 ≤ j ≤ r;
f (vij) = (2r + s − 1) + j + ( p—1 + i − 1) mod p x for any 1 ≤ i ≤ p and
1 ≤ j ≤ s;
f (eij)= r + j + (2p − 2i + 1) mod p x for any 1 ≤ i ≤ p and 1 ≤ j ≤ r + s− 1. The intuition behind the above labeling can be better seen in the next diagram,
which contains the labeling for the caterpillar forest depicted in Figure 3:
f (u11)=1 f (u12)=2 f (u13)=3 f (e31)=4 ... f (e36)=9 f (v41)= 10 ... f (v44)= 13
f (u21)= 14 f (u22)= 15 f (u23)= 16 f (e51)= 17 ... f (e56)= 22 f (v51)= 23 ... f (v54)= 26
f (u31)= 27 f (u32)= 28 f (u33)= 29 f (e21)= 30 ... f (e26)= 35 f (v11)= 36 ... f (v14)= 39
f (u41)= 40 f (u42)= 41 f (u43)= 42 f (e41)= 43 ... f (e46)= 48 f (v21)= 49 ... f (v24)= 52
f (u51)= 53 f (u52)= 54 f (u53)= 55 f (e11)= 56 ... f (e16)= 61 f (v31)= 62 ... f (v34)= 65

First we prove in Claim 3.2 that,  for every edge uv,  we have f (u)+ f (v)+ f (uv)= k for some constant k = k(r, s, p) that depends only on r, s and p. Then, in order to finish the proof, we show that all labels given by f are different and lie between 1 and xp.
Claim 3.2 For every 1 ≤ i ≤ p and every edge uv in Ci,
f (u)+ f (v)+ f (uv)= 4r + 2s + 3p − 3 x .

Proof of Claim 3.2. We start by analyzing some particular labeling of a caterpillar. We say that a labeling of Ci is well-behaved if all the labels are different and it

uses consecutive integers a + 1 ...,a + r respectively for the vertices ui1,..., uir, consecutive integers b + 1,...,b + s respectively for the vertices vi1,..., vis, and consecutive integers c + 1,...,c + (r + s − 1) for the edges ei1,..., ei(r+s—1). For any well-behaved labeling f of a caterpillar Ci, a moment of thought shows that f (u)+ f (v)+ f (uv) is the same for every edge uv of Ci.
Clearly, function f defined above restricted to Ci, which we denote by f|Ci , is well-behaved. Thus, as f (u)+ f (uv)+ f (v) is the same constant for every edge uv of Ci, it is enough to show that, for any 1 ≤ i ≤ p,
f (ui1)+ f (vi1)+ f (ui1vi1)
= f (ui1)+ f (vi1)+ f (ei(r+s—1))
=1 + (i − 1)x + (2r + s − 1) + 1 +   p − 1 + i − 1  (mod p)  x
+ r + (r + s − 1) + ((2p − 2i + 1)(mod p))x
= 4r + 2s +  3p − 3  x.
Hence the claim is proved.	2
We now proceed with the proof of the theorem. As discussed before, it remains to prove that all labels given by f are different and lie between 1 and xp.
Clearly, all f (uij), f (vij) and f (eij) are positive. It is also clear that f (uij) ≤ xp,
p	1
2
(2r + s − 1) + j ≤ x, in view of (ii) in the definition of f , we have f (vij) ≤ xp,
for 1 ≤ i ≤ p and 1 ≤ j ≤ s. Also, since (2i − 1) mod p x ≤ (p − 1)x and r + j ≤ 2r + s − 1 < x, in view of (iii) in the definition of f , we have f (eij) ≤ xp, for 1 ≤ i ≤ p and 1 ≤ j ≤ r + s − 1.
Since the numbers multiplying x in (i), (ii), and (iii) are always between 0 and p − 1, we have that all f (uij) are different, and the same happens to all f (vij) and to all f (eij), in their respective ranges. Thus, we only need to prove the following claim.
Claim 3.3 The following statements hold for every 1 ≤ i, k, q ≤ p, every 1 ≤ j ≤ r, every 1 ≤ l ≤ s, and every 1 ≤ t ≤ r + s − 1:
f (vkl) /= f (eqt);
f (eqt) /= f (uij);
f (uij) /= f (vkl).
Proof of Claim 3.3. For simplicity, we let α =   p—1 + k − 1 mod p  and β =
 (2p − 2q + 1) mod p	To see that (a) holds, suppose for a contradiction that
f (vkl)= (2r + s − 1) + l + αx = r + t + βx = f (eqt) .
Then, recalling that x = 2r + 2s − 1, we have
(α +1 − β)x = r + t + s − l .

But since 1 ≤ l ≤ s and 1 ≤ t ≤ r + s − 1, we have 0 < r + t + s − l < x, and thus the above equality does not hold.
We proceed similarly to prove that (b) holds. Suppose for a contradiction that
f (eqt)= r + t + βx = j + (i − 1)x = f (uij) .


Then,
 (i − 1) − β x = r + t − j .

Since 1 ≤ j ≤ r and 1 ≤ t ≤ r + s − 1, we have 0 < r + t − j < x, and thus the above equality does not hold.
Finally, to see that (c) holds, suppose for a contradiction that
f (uij)= j + (i − 1)x = (2r + s − 1) + l + αx = f (vkl) .


Then,
 (i − 1) − α x = 2r + s − 1+ l − j .

But since 1 ≤ j ≤ r and 1 ≤ l ≤ s, we have 0 < 2r + s − 1+ l − j < x, and thus the above equality does not hold.	2
Therefore, since we proved Claim 3.2, the proof of Theorem 3.1 is complete. 2

Final remarks
Edge-magic labelings have been studied since they were introduced in 1970, by Kotzig and Rosa. One of the main questions related to this topic, raised by them, is whether any tree is edge-magic. Despite its simplicity, this question is open for almost 50 years. Even the more recent and restrictive question of whether any tree is super edge-magic, posed in 2002 by Enomoto, Llado, Nakamigawa, and Ringel, is still open. When attacking these questions, it is natural to consider their variants for forests. Indeed, also in 2002, Lee and Kong conjectured that any odd star forest is super edge-magic. In this abstract, we presented a proof for this conjecture for odd symmetric star forests. Searching results for classes of forests less restricted than star forests, we managed to prove that odd uniform forests of catterpillars are edge-magic. We hope that our results can be used somehow to answer Kotzig and Rosa’s question for some classes of trees.

References
Arnold, F., “Totally Magic Graphs – A Complete Search On Small Graphs,” Master’s thesis, Clausthal University of Technology, Germany (2013).
Bloom, G. S. and S. W. Golomb, Applications of numbered undirected graphs, in: Proceedings of the IEEE, 4, 1977, pp. 562–570.
Bloom, G. S. and S. W. Golomb, Numbered complete graphs, unusual rulers, and assorted applications, in: Theory and Applications of Graphs, Lecture Notes in Mathematics 642, 1978, pp. 53–65.
Enomoto, H., A. S. Llad´o, T. Nakamigawa and G. Ringel, Super edge-magic graphs, SUT Journal of Mathematics 34 (1998), pp. 105–109.

Figueroa-Centeno, R. M., R. Ichishima and F. A. Muntaner-Batle, The place of super edge-magic labelings among other classes of labelings, Discrete Mathematics 231 (2001), pp. 153–168.
Figueroa-Centeno, R. M., R. Ichishima and F. A. Muntaner-Batle, On super edge-magic graphs, Ars Combinatoria 64 (2002), pp. 81–95.
Gallian, J., A dynamic survey of graph labeling, Electronic Journal of Combinatorics (2018).
Kotzig, A., On magic valuations of trichromatic graphs, Technical report, Reports of the CRM (1971).
Kotzig, A. and A. Rosa, Magic valuations of finite graphs, Canadian Mathematical Bulletin 13 (1970),
pp. 451–461.
Kotzig, A. and A. Rosa, Magic valuations of complete graphs, Centre de Recherches Mathematiques, Universit´e de Montreal (1972).
Lee, S.-M. and M. C. Kong, On super edge-magic n-stars, Journal of Combinatorial Mathematics and Combinatorial Computing 42 (2002), pp. 87–96.
L´opez, S. C. and F. A. Muntaner-Batle, “Graceful, harmonious and magic type labelings,” SpringerBriefs in Mathematics, Springer, Cham, 2017.
Manickam, K., M. Marudai and R. Kala, Some results on super edge magic n-stars, Ars Combinatoria
126 (2016), pp. 281–288.
Marr, A. M. and W. D. Wallis, “Magic graphs,” Birkh¨auser/Springer, New York, 2014, second edition.
Zhenbin, G. and F. Chongjin, Some discussions on super edge-magic labelings of St(a(1), ..., a(n)), Ars Combinatoria 108 (2013), pp. 187–192.
