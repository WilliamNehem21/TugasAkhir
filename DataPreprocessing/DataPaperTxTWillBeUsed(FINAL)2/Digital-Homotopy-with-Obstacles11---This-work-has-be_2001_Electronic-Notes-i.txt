Electronic Notes in Theoretical Computer Science 46 (2001)
URL: http://www.elsevier.nl/locate/entcs/volume46.html 20 pages



Digital Homotopy with Obstacles 1

R. Ayala a, E. Dom´ınguez b, A. R. Franc´es b,3, and A. Quintero a,2
a Departamento de Geometr´ıa y Topolog´ıa Universidad de Sevilla
Apto. 1160. E-41080 – Sevilla, Spain
b Departamento de Inform´atica e Ingenier´ıa de Sistemas Universidad de Zaragoza
E-50009 Zaragoza, Spain

Abstract
As a sequel of [4], this paper is devoted to the computation of the digital fundamental group πd(O/S; σ) defined by loops in the digital object O for which the digital object S acts as an “obstacle”. We prove that for arbitrary digital spaces the group πd(O/S; σ) maps onto the usual fundamental group of the difference of continuous analogues |AO∪S |− |AS |. Moreover, we show that this epimorphism turns to be an isomorphism for a large class of digital spaces including most of the examples in digital topology.


Introduction
This paper deals with a notion of digital fundamental group for complements of objects in binary digital pictures. The interest of such a notion is found in the theory of 3d image thinning algorithms. After applying a 3d thinning algorithm, the “tunnels” in the input and output digital pictures must agree in number and position, and this can be correctly specified by saying that the algorithm preserves the digital fundamental groups of both the object displayed in the picture and its complement (see Criterion 2.3.2 in [7]).
The first notion of a digital fundamental group was given by Khalimsky [6] for a particular type of digital spaces, which are based on a topology on the set Zn for every integer n > 0. This way, Khalimsky deals with sets of pixels regardless of considering them as digital objects themselves or as complements of other objects. However, Khalimsky’s fundamental group is not suitable for

1 This work has been partially supported by the projects DGES PB96-1374 and DGES TIC2000–1368-C03-01.
2 Email: quintero@cica.es
3 Email: afrances@posta.unizar.es
◯c 2001 Published by Elsevier Science B. V. Open access under CC BY-NC-ND license.


other kinds of digital spaces often used in image processing, as the (α, β)– connected spaces defined on the grid Zn, where (α, β) ∈ {(4, 8), (8, 4)} if n = 2 and (α, β) ∈ {(6, 26), (26, 6), (6, 18), (18, 6)} if n = 3. Later on, Kong [7] gave a different notion of a digital fundamental group for a large class of graph–based digital spaces, including the (α, β)–connected spaces. As usual in the graph– theoretical approach to Digital Topology, Kong’s digital fundamental group involves a different definition for objects and their complements in a given digital space. Namely, if O ⊆ Zn is an object in the (α, β)-connected digital space, Kong defines the digital fundamental group of the complement of O in that space as the fundamental group of the object Zn −O in the corresponding (β, α)-connected digital space. Nevertheless, this notion is restricted to 2d and 3d digital spaces and seems not generalize to give higher digital homotopy groups.
Recently, the authors [4] have introduced a fairly general notion of dig- ital fundamental group that includes, as particular cases, the corresponding notions for both objects and their complements in a digital space. More pre- cisely, in [4] we define the digital fundamental group πd(O/S, σ) of a set of pixels O regarding to an object S, which plays the role of an “obstacle” that the loops in O cannot cross; and then, for a digital object O in a digital space
X, the special cases πd(O, σ) = πd(O/∅, σ) and πd(X − O/O, σ) correspond
1	1	1
to the digital fundamental groups of the object O and its complement in X,
respectively. This approach presents, at least from a theoretical point of view, several advantages over the notions of Khalimsky and Kong. On one hand, it can be readily generalized to define higher digital homotopy groups (see [4]), as Khalimsky’s notion; and, on the other, this group is available on a larger class of arbitrarily dimensional digital spaces than both Khalimsky’s and Kong’s digital fundamental groups.
The group πd(O/S, σ) was introduced within the framework of the multi- level architecture for Digital Topology given in [3]. That architecture provides a link between the discrete world of digital pictures and Euclidean spaces, where the “continuous perception” that an observer may take on a picture is represented via a polyhedron called its continuous analogue. In general, this link can be used to obtain new results in Digital Topology, by translating the corresponding continuous results (for instance, we use it in [2] to prove a
general Digital Index Theorem for all (α, β)-connected spaces on Z3 and even for higher dimensional digital spaces). Moreover, this link can be also used to check that a new digital notion is an accurate counterpart of the usual con- tinuous one. So, we give in [4] an isomorphism from the digital fundamental group πd(O, σ) = πd(O/∅, σ) of an object O onto the classical fundamental
1	1
group of its continuous analogue.
As a sequel, we extend in this paper the results in [4] to the more elaborate case of the digital fundamental group πd(X − O/O, σ) of an object’s comple- ment. More precisely, for an arbitrary obstacle S /= ∅, we give in Section 4.1 an epimorphism from the digital fundamental group πd(O/S, σ) onto the fun-


damental group of the complement of the obstacle’s continuous analogue. Although there is strong evidence that this epimorphism is not injective in general, we show in Section 4.2 that it is actually an isomorphism for a large class of digital spaces, including those most used in image processing. This supports also for complements of objects the suitability of our definition of the digital fundamental group πd in [4].
For the convenience of the reader we review the basic notions of the mul- tilevel architecture quoted above and the definition of the group πd(O/S, σ)
in Sections 2 and 3, respectively.

Preliminaries
In this section we briefly summarize the basic notions of the multilevel archi- tecture for digital topology developed in [3] as well as the notation that will be used through all the paper.
In that architecture, the spatial layout of pixels in a digital image is rep- resented by a device model, which is a homogeneously n-dimensional locally finite polyhedral complex K. Each n-cell in K is representing a pixel, and so the digital object displayed in a digital image is a subset of the set celln(K) of
n-cells in K; while the other lower dimensional cells in K are used to describe how the pixels could be linked to each other. A digital space is a pair (K, f ), where K is a device model and f is weak lighting function defined on K. The function f is used to provide a continuous interpretation, called continuous analogue, for each digital object O ⊆ celln(K).
By a homegeneously n-dimensional locally finite polyhedral complex we mean a set K of polytopes, in some Euclidean space Rd, provided with the natural ordering given by the relationship “to be face of”, that in addition satisfies the four following properties:
If σ ∈ K and τ is a face of σ then τ ∈ K.
If σ, τ ∈ K then σ ∩ τ is a face of both σ and τ .
For each point x in the underlying polyhedron |K | = ∪{σ; σ ∈ K} of K, there exists a neigbourhood of x which intersects only a finite number of polytopes in K; in particular, each polytope of K is face of a finite number of other polytopes in K.
Each polytope σ ∈ K is face of some n-dimensional polytope in K.
Given a device model K and two polytopes γ, σ ∈ K, we shall write γ ≤ σ if γ is a face of σ, and γ < σ if in addition γ /= σ. A centroid-map on K is a map c : K → |K | such that c(σ) belongs to the interior of σ; that is, c(σ) ∈σ= σ − ∂σ, where ∂σ = ∪{γ; γ < σ} stands for the boundary of σ.
Remark 2.1 A homegeneously n-dimensional locally finite polyhedral com- plex K can be regarded as an abstract cellular complex whose cells are the polytopes in K. So, for simplicity, K will be called a polyhedral complex, and


			
O ∪ {α}	stn(α; O)	st∗ (α; O)	supp(O)

Fig. 1. The support of an object O and two types of digital neighbourhoods in O for a cell α. The cells in O together with the bold edges and dots are the elements in supp(O).
its polytopes will be simply referred to as cells in this paper. Moreover, the abstract complex K can be endowed with the structure of a locally finite topo- logical T0 space with base B = {Uα; α ∈ K}, where Uα = {β ∈ K; α ≤ β}. Actually, this topological space (K, B) is a quotient of the Euclidean poly- hedron |K | by the map q : |K | → K that assigns the cell σ to each point x ∈ σ.
Example 2.2 In this paper it will be essential the role played by the archetyp- ical device model Rn, termed the standard cubical decomposition of the Eu- clidean n-space Rn. The device model Rn is the complex determined by the collection of unit n-cubes in Rn whose edges are parallel to the coordinate axes and whose centers are in the set Zn. The centroid-map we will consider in Rn associates to each cube σ its barycenter c(σ), which is a point in the set Zn. Here, Z = 1Z stands for the set of points {z ∈ R; z = y/2,y ∈ Z}. In particular, if dim σ = n then c(σ) ∈ Zn, where dim σ denotes the dimension of σ. So that, every digital object O in Rn can be identified with a subset of points in Zn. Henceforth we shall use this identification without further comment.
Before to proceed with the definition of weak lighting function, we need some notions, which are illustrated in Fig. 1 for an object O in the device model R2.
The first two notions formalize two types of “digital neighbourhoods” of a cell α ∈ K in a given digital object O ⊆ celln(K). Indeed, we call the star of α in O to the set stn(α; O) = {σ ∈ O; α ≤ σ} of n-cells (pixels)
in O having α as a face. Similarly, the extended star of α in O is the set
st∗ (α; O) = {σ ∈ O; α ∩ σ /= ∅} of n-cells (pixels) in O intersecting α.
The third notion is the support of a digital object O which is defined as the set supp(O) of cells of K (not necessarily pixels) that are the intersection of n-cells (pixels) in O. Namely, α ∈ supp(O) if and only if α = ∩{σ; σ ∈ stn(α; O)}. In particular, if α is a pixel in O then α ∈ supp(O). Notice also
that, among all the lower dimensional cells of K, only those in supp(O) are joining pixels in O.

To ease the writing, we shall use the following notation: supp(K) = supp(celln(K)), stn(α; K) = stn(α; celln(K)) and st∗ (α; K) = st∗ (α; celln(K)).
n	n
Finally, we shall write P(A) for the family of all subsets of a given set A.
Definition 2.3 Given a device model K, a weak lighting function (w.l.f.) on K is a map f : P(celln(K)) × K → {0, 1} satisfying the following five axioms for all O ∈ P(celln(K)) and α ∈ K:
if α ∈ O then f (O, α) = 1;
if α ∈/ supp(O) then f (O, α) = 0;
f (O, α) ≤ f (celln(K), α);
f (O, α) = f (st∗ (α; O), α); and,
if O' ⊆ O ⊆ celln(K) and α ∈ K are such that stn(α; O) = stn(α; O'), f (O', α) = 0 and f (O, α) = 1, then: (a) the set of cells α(O'; O) = {β < 
◦
α; f (O', β) = 0, f (O, β) = 1} is not empty; (b) the set ∪{β; β ∈ α(O'; O)}
is connected in ∂α; and, (c) if O ⊆ O ⊆ celln(K), then f (O, β) = 1 for every β ∈ α(O'; O).
If f (O, α) = 1 we say that f lights the cell α for the object O.
A w.l.f. f is said to be strongly local if f (O, α) = f (stn(α; O), α) for all α ∈ K and O ⊆ celln(K). Notice that this strong local condition implies both axioms (4) and (5) above.
A weak lighting function f on a device model K can be regarded as a mapping that assigns a subset {α ∈ K; f (O, α) = 1} of cells of K to each digital object O ⊆ celln(K). In this sense, lighting functions are particular examples of “face membership rules” as introduced by Kovalevsky in [10]. Our contribution in this point are the axioms (1)–(5) in Def. 2.3. These axioms are intended for limiting the set of Kovalevsky’s face membership rules to those that do not lead to topological properties which are contradictory with the natural perception of digital objects (see [5]). Indeed, the intuitive ideas underlying axioms (1)–(4) above are the following. Axiom (1) says that to display a digital object O on a computer screen all its pixels must be lighted. By axiom (2) only the lower dimensional cells in supp(O) can be lighted in order to connect immediately adjacent pixels of O. And axiom (3) states that a cell which is lighted for any digital object must be also lighted for the object celln(K) consisting of all the pixels in the digital space; that is, if a cell α connects some pixels in a given object, then α is connecting the same pixels in celln(K) too. Axiom (4) as well as the strong local axiom say that our perception of a digital object O is local, and so the lighting of a cell α depends on a “digital neighbourhood” of α in O. Finally, the rather complex axiom (5) is needed to avoid certain problems related to the connectivity of an object’s complement (see [3,4,5] for details).
The following useful property is immediate from Definition 2.3.
Lemma 2.4 Any digital space (K, f ) is strongly local at each vertex and at

each top dimensional cell α ∈ K; that is, f (O, α) = f (stn(α; O), α) for any digital object O ⊆ celln(K) and dim α = 0 or dim α = dim K.
Given an arbitrary digital space (K, f ), we shall derive from the lighting function f a “continuous interpretation” for any digital object O ⊆ celln(K), called its continuous analogue. For this we use a fixed, but arbitrary, centroid– map c : K → |K | on the device model K to introduce several other interme- diate models for O as follows.
The device level of O is the subcomplex K(O) = {α ∈ K; α ≤ σ ∈ O}
induced by O. Notice that K(O) can be considered as a device model itself.
The logical level of O is an undirected graph, Lf , whose vertices are the centroids of n-cells in O and two of them c(σ), c(τ ) are adjacent if there exists a common face α ≤ σ ∩ τ such that f (O, α) = 1.

The conceptual level of O is the directed graph Cf
whose vertices are the

centroids c(α) of all cells α ∈ K with f (O, α) = 1, and its directed edges are (c(α), c(β)) with α < β.

The simplicial analogue of O is the order complex Af
associated to the

directed graph Cf . That is, ⟨c(α0), c(α1),..., c(αm)⟩ is an m-simplex of Af if
O	O
c(α0), c(α1),..., c(αm) is a directed path in Cf ; or, equivalently, if f (O, αi) = 1,

for 0 ≤ i ≤ m, and α0 < α1 < ··· < αm. That is, Af
is obtained by “filling

in” all the triangles, tetrahedra, etc... in the conceptual level Cf . Finally, the
continuous analogue of O is the underlying polyhedron |Af | of Af .
O	O
The following result is straightforwardly checked from the definitions.
Lemma 2.5 For any digital object O in a digital space (K, f ), the map
fO : P(celln(K(O))) × K(O) = P(O) × K(O) → {0, 1}
given by fO(O', α) = f (O, α)f (O', α), for O' ⊆ O and α ∈ K(O), is a w.l.f on the device model K(O). So, we call the pair (K(O), fO) the digital subspace of (K, f ) induced by O.

Remark 2.6 (1) Notice that the simplicial analogue Af
of any digital object

O ⊆ celln(K) is always a full subcomplex of the first derived subdivision K(1)
of K induced by the chosen centroid–map c. Moreover, axiom (3) in Def. 2.3

yields that Af
f
celln(K)
, and so Af
is also a full subcomplex of Af	.
n

Let (K(O), fO) be the digital subspace induced by a digital object
O in a digital space (K, f ).	If O' ⊆ O, one easily checks the equality

AfO = Af ∩ Af
, since all these are full subcomplexes of K(1). In particu-

O'	O	O'
lar AfO = Af ; that is, the continuous analogue of an object does not change
O	O
when it is considered as the ambient digital space.
Given a locally finite topological T0 space X, Kong and Khalimsky construct in [9] a polyhedral analogue |K(X) | for X. It can be easily checked that, for any digital object O in a digital space (K, f ), our continuous analogue
|AO | coincides with the polyhedral analogue |K(XO) | of the set XO = {α ∈ K; f (O, α) = 1} of cells which are lighted for O endowed with the relative topology of the abstract complex K in Remark 2.1.


			

Lfmax
fmax O
fmax O


			

Lg

Lfmax = Lg
g O


Cfmax = Cg
g O

Afmax = Ag

R2	R2
R2	R2
R2	R2

Fig. 2. Levels of the objects O and cell2(R2) for the w.l.f.’s fmax and g in Exam- ple 2.7(1).
For the sake of simplicity, we will usually drop “f ” from the notation of the levels of an object. Moreover, for the whole object celln(K) we will simply write LK, CK and AK for its levels.
Example 2.7 (1) Every device model K /= ∅ admits the weak lighting func- tions fmax and g given respectively by:
fmax(O, α) = 1 if and only if α ∈ supp(O)
g(O, α) = 1 if and only if α ∈ supp(O) and stn(α; K) ⊆ O
In Fig. 2 are shown two objects, O and cell2(R2), in the device model R2, and their levels for these lighting functions. More precisely, Figs. 2(a) and 2(b) show the 2-cells (grey squares) of the object O and the low-dimensional cells (bold edges and vertices) that the w.l.f.’s fmax and g light, respectively, for O. As these sets, {α ∈ R2; fmax(O, α) = 1} and {α ∈ R2; g(O, α) = 1}, do not agree, all the levels of O in the digital spaces (R2, fmax) and (R2, g) are
distinct, in particular |Afmax | /= |Ag |. On the other hand,
O	O
{α ∈ R2; fmax(cell2(R2), α) = 1} = {α ∈ R2; g(cell2(R2), α) = 1}
(see Figure 2(c)), and so all the levels of the object cell2(R2) are the same in these two digital spaces.


(2) Both the w.l.f.’s fmax and g given above satisfy the strong local axiom in Definition 2.3. Next we give an example of a non strongly local digital space (Rn, h). For any integer n > 0, the w.l.f. h is defined on the device model Rn by h(O, α) = 1 if and only if: (a) dim α = n and α ∈ O; (b) dim α ≤ n − 2 and stn(α; Rn) ⊆ O; and, (c) dim α = n − 1, α ∈ supp(O), and
either st∗ (α; Rn) ⊆ O or there exist σ, τ ∈ st∗ (α; Rn) − O such that σ ∩ τ = ∅.
n	n
Actually, the family of digital spaces (Rn, g) with n ≥ 1, for g the w.l.f. in Example 2.7, and more precisely a particular class of digital subspaces (called windows) of these spaces, are the key that allows us to introduce in next Section a notion of digital fundamental group. At this point, it is worth to
point out that g induces in Rn the (2n, 3n − 1)–connectivity (see [1, Def. 11]); that is, the generalization to arbitrary dimension of the (4, 8)–connectivity on Z2. On the other hand, fmax induces in Rn the (3n − 1, 2n)-connectivity (see Fig. 2).

A digital fundamental group
The fundamental group of a topological space X, π1(X, x0), is usually defined to be the set of homotopy classes of loops based at fixed point x0 (i.e., maps ξ : I = [0, 1] → X with ξ(0) = ξ(1) = x0), where an homotopy between two loops ξ1, ξ2 is a continuous map H : I × I → X such that H(x, 0) = ξ1(x), H(x, 1) = ξ2(x) and H(0, t) = H(1, t) = x0.
In this section we collect the definitions and basic facts involved in the notion of digital fundamental group as introduced in [4]. These definitions provide suitable digital analogues for the notions of continuous loop and con- tinuous homotopy, which are in fact particular examples of digital maps (see Def. 3.2). To define them we need the following technical notion. We refer to
[4] for more details.
Definition 3.1 Let S ⊆ celln(K) be a digital object in a digital space (K, f ). The light body of (K, f ) shaded with S is the set of cells Lb(K/S) not lighted for the object S but lighted for celln(K); that is,
Lb(K/S)= {α ∈ K; f (celln(K), α) = 1,f (S, α) = 0}
= {α ∈ K; c(α) ∈ |AK |− |AS |}.
Actually, the notion of light body plays a key role in defining the digital fundamental group of an object O with respect to an arbitrary obstacle S (see Def. 3.10). Indeed, this group will be defined as the set of homotopy classes of digital loops in Lb(K(O ∪ S)/S); that is, the light body, shaded by the obstacle S, of the subspace (K(O ∪ S), fO∪S) that the set of pixels O ∪ S induces in the digital space (K, f ).
Definition 3.2 Let (K1, f1), (K2, f2) be two digital spaces, with dim Ki = ni (i = 1, 2), and let S1 ⊂ celln1 (K1) and S2 ⊂ celln2 (K2) be two digital objects. A digital (S1, S2)-map (or, simply, a d-map) ΦS1,S2 : (K1, f1) → (K2, f2) from


(K1, f1) into (K2, f2) is a map φ : Lb(K1/S1) → Lb(K2/S2) satisfying the two following properties:
φ(celln1 (K1) − S1) ⊆ celln2 (K2) − S2; and,
for α, β ∈ Lb(K1/S1) with α < β then φ(α) ≤ φ(β).
That is, φ carries top dimensional cells in Lb(K1/S1) to top dimensional cells in Lb(K2/S2) and preserves the face relations (although φ needs not be dimension preserving).
Notice that any d-map is a continuous map if we consider Lb(K1/S1) and Lb(K2/S2) as subspaces of the abstract complex K1 and K2 topologized as in Remark 2.1. The following result also holds.
Proposition 3.3 Any d-map ΦS1,S2 : (K1, f1) → (K2, f2) induces a simplicial map A(ΦS1,S2 ) : AK1 \AS1 → AK2 \AS2 , which is defined on the vertices c1(α) of AK1 \ AS1 by A(ΦS1,S2 )(c1(α)) = c2(ΦS1,S2 (α)). Here ci is a centroid-map on the device model Ki, for i = 1, 2.
In the previous proposition L1 \ L2 = {α ∈ L1; α ∩ |L2 | = ∅} denotes the simplicial complement of the subcomplex L2 ⊆ L1.
In order to define digital loops and digital homotopies as particular types of digital maps, next definition provides us with a particular class of digital spaces, called windows, that will play the same role as the unit interval, I, and the unit square, I × I, in continuous homotopy. For this, we will use the following notation. Given two points x = (x1,..., xm),y = (y1,..., ym) ∈ Rm, we write x ≤ y if xi ≤ yi for all 1 ≤ i ≤ m, while x + y will stand for the usual vector addition x + y = (x1 + y1,..., xm + ym) ∈ Rm.
Definition 3.4 Given two points r, x ∈ Zm, with ri ≥ 0 for 1 ≤ i ≤ m, we call a window of size r (or r-window ) of Rm based at x to the digital subspace V x of (Rm, g) induced by the digital object Ox = {σ ∈ cellm(Rm); x ≤ c(σ) ≤ x+r}, where (Rm, g) is the digital space defined in Example 2.7. For the sake of simplicity, we shall write Vr to denote the r-window of Rm based at the point x = (0,..., 0) ∈ Zm.
Remark 3.5 To ease the writing, given an r-window Vr of Rm, we will identify each cell α ∈ Lb(Vr/∅) with its centroid c(α) ∈ Zm (see Example 2.2). In particular, if Vr is an r-window of R1, then Lb(Vr/∅) = {σ0, σ1,..., σ2r−1, σ2r} consists of 2r + 1 cells (points and segments) which will be identified with the numbers c(σi) = i/2, for 0 ≤ i ≤ 2r. And, similarly, for a window V(r1,r2) of R2, we identify each cell α ∈ Lb(V(r ,r )/∅) with a pair c(α) = (i/2, j/2),
1 2
where 0 ≤ i ≤ 2r1 and 0 ≤ j ≤ 2r2.
We are now ready to define digital loops and digital homotopies as follows.
Definition 3.6 Let S, O ⊆ celln(K) be two disjoint digital objects in a digital space (K, f ), and σ, τ two n-cells in O. A S-walk in O of length r ∈ Z from σ to τ is a digital (∅, S)-map φr : Lb(Vr/∅) → Lb(K(O ∪ S)/S) such that


φr(0) = σ and φr(r) = τ . A S-loop in O based at σ is a S-walk φr such that
φr(0) = φr(r) = σ.
The juxtaposition of two given S-walks φr, φs in O, with φr(r) = φs(0), is the S-walk φr ∗ φs : Lb(Vr+s/∅) → Lb(K(O ∪ S)/S) of length r + s given by
φ ∗ φ (i/2) =  φr(i/2)	if 0 ≤ i ≤ 2r

 φs(i/2 − r) if 2r ≤ i ≤ 2(r + s)

Notice that a S–loop φr in O is actually a sequence (φr(i))r


of adjacent

pixels in O such that each pair φr(i − 1), φr(i) of successive pixels have a common face φr(i − 1) which is not lighted for the object S. In this sense φr does not cross the obstacle S. Similarly, a digital homotopy, as defined below, transforms a S-loop φ1 to φ2 using adjacent pixels but, in the same way, it is not allowed to cross the obstacle S.
Definition 3.7 Let φ1, φ2 two S-walks in O of the same length r ∈ Z from
r	r
σ to τ . We say that φ1, φ2 are digitally homotopic (or, simply, d-homotopic)
r	r
relative {σ, τ}, and we write φ1  d φ2 rel. {σ, τ}, if there exists an (r, s)-
window V(r,s) in R2 and a (∅, S)-map H : Lb(V(r,s)/∅) → Lb(K(O ∪ S)/S),
called a d-homotopy, such that H(i/2, 0) = φ1(i/2) and H(i/2, s) = φ2(i/2),
r	r
for 0 ≤ i ≤ 2r, and moreover H(0, j/2) = σ and H(r, j/2) = τ , for 0 ≤ j ≤ 2s.
Here we use the identification H(a1, a2) = H(α), where c(α) = (a1, a2) ∈ Z2
is the centroid of a cell α ∈ Lb(V(r,s)/∅); see Remark 3.5.
Definition 3.8 Let φr, φs two S-walks in O from σ to τ of lengths r and s respectively. We say that φr is d-homotopic to φs relative {σ, τ}, φr d φs rel. {σ, τ}, ifthere exist constant S-loops φτ' and φτ' such that r+r' = s+s'
r	s
and φr ∗ φτ' d φs ∗ φτ' rel. {σ, τ}.
r	s

Proposition 3.9 Let φr be a S-walk in O from σ to τ, and φσ, φτ
two con-

s
stant S-loops of the same length s ∈ Z. Then, φσ ∗ φr  d φr ∗ φτ
s
rel. {σ, τ}.

s	s
Notice that d-homotopies induce an equivalence relation in the set of S– walks in O from σ to τ . Moreover, from Proposition 3.9 it is not difficult to check that the juxtaposition is compatible with d-homotopies between S– walks. Thus, the juxtaposition of S-loops naturally induces a product opera- tion that endows the set ofclasses of S-loops in O based at an n-cell σ ∈ O with a group structure, for which the trivial element is the class of constant S-loops at σ, and the inverse of the class [φr] is represented by the S-loop φ−1 obtained by traversing φr backwards; that is, φ−1(i/2) = φr(r − i/2) for all 0 ≤ i ≤ 2r. So, we next introduce the notion of digital fundamental group as follows.
Definition 3.10 Let S, O be two disjoint digital objects in a digital space (K, f ), and σ an n-cell in O. The digital fundamental group of O at σ with obstacle at S is the set πd(O/S, σ) of d-homotopy classes of S-loops in O based at σ with the product operation [φr] · [ψs] = [φr ∗ ψs]. In case S = ∅, we will simply call to πd(O/∅, σ) = πd(O, σ) the digital fundamental group of O at σ.
1	1


Remark 3.11 Definition 3.10 provides an entire family of digital fundamental groups for a given digital object O when the object S is allowed to range over the family of all subsets of celln(K) − O. Particularly interesting are the
groups πd(O/∅, σ) = πd(O, σ) and πd(O/(celln(K) − O), σ) that, respectively,
1	1	1
represents the digital fundamental group of the object O itself and the digital
fundamental group of O as the complement of the object celln(K) − O.

The relationship with the continuous fundamental group
In [4] we show that the digital fundamental group πd(O, σ) of a digital ob- ject coincides with the classical fundamental group of its continuous analogue
|AO |. In this Section we tackle the problem of computing the digital funda- mental group πd(O/S, σ) of O with a disjoint object S acting as an “obstacle”
for the loops in O. The Section is divided into two parts, in 4.1 we deal with the general case and we produce a epimorphism
h : πd(O/S, σ) → π1(|AO∪S |− |AS |, c(σ))
onto the classical fundamental group of the complement of the obstacle’s con- tinuous analogue. The second part 4.2 provides us with a large class of digital spaces for which the above homomorphism yields an isomorphism.
We recall that, for a triangulated polyhedron |L|, there is an alternative definition of the fundamental group π1(|L|, x0) that will be more convenient for our purposes. So we next explain it briefly. For this, we call an edge–walk in L from a vertex v0 to a vertex vn to a sequence α of vertices (v0, v1,..., vn), such that for each k = 1, 2,...,n the vertices vk−1, vk span a simplex in L (possibly vk−1 = vk). If v0 = vn, α is called an edge–loop based at v0.

Given another edge–walk β = (vj)m+n
whose first vertex is the same as

the last vertex of α, the juxtaposition α∗β = (vi)m+n is defined in the obvious way. The inverse of α is α−1 = (vn, vn−1,..., v0).
Two edge–walks α and β are said to be equivalent if one can be obtained from the other by a finite sequence of operations of the form:
if vk−1 = vk, replace ..., vk−1, vk,... by ..., vk,.. ., or conversely replace
..., vk,... by ..., vk−1, vk,.. .; or
if vk−1, vk, vk+1 span a simplex of L (not necessarily 2-dimensional), re- place ..., vk−1, vk, vk+1,... by ..., vk−1, vk+1,.. ., or conversely.
This clearly sets up an equivalence relation between edge–walks, and the set π1(L, v0) of equivalence classes [α] of edge–loops α in L, based at a vertex v0, is given the structure of group by the operation [α] · [β] = [α ∗ β]. This group is called the edge–group of L.
Each edge–walk α in L defines in an obvious way a continuous path θ(α) in the underlying polyhedron |L|; and so, we will identify henceforth the edge– walk α with the continuous path θ(α). Actually this correspondence yields an

isomorphism π1(|L|, v0) ∼= π1(L, v0). More precisely,
Theorem 4.1 ([12]; 3.3.9) There exists an isomorphism Θ : π1(L, v0) →
π1(|L|, v0) which carries the class [α] to the class [θ(α)].
Corollary 4.2 Let O, S be two disjoint digital objects in a digital space (K, f ). Then π1(AO∪S \ AS, c(σ)) ∼= π1(|AO∪S |− |AS |, c(σ)) for any σ ∈ O.
Proof. By Remark 2.6(1) we know that both AO∪S and AS are full sub- complexes of AK.	Then Lemma 72.2 in [13] yields that |AO∪S \ AS | =
|AO∪S \ (AO∪S ∩ AS) | is a strong deformation retract of |AO∪S |− |AS | =
|AO∪S |− |AO∪S ∩ AS | and the result follows by Theorem 4.1.	✷
Let (K, f ) be an arbitrary digital space. Given two disjoint digital objects
O, S ⊆ celln(K) and any n-cell σ ∈ O we next define a natural homomorphism,
h : πd(O/S, σ) → π1(AO∪S \ AS, c(σ)) ,
from the digital fundamental group of O at σ with obstacle at the object S into the edge–group of the simplicial complex AO∪S \ AS at the centroid c(σ), as follows. Let φr be any S-loop in O. Then, we just observe that
the sequence c(φr) = (c(φr(i/2)))2r	defines an edge–loop in AO∪S \ AS. So
that, we simply set h([φr]) = [c(φr)]. Notice that h is the generalization to the case S /= ∅ of the homomorphism used in [4] to show the isomorphism
πd(O, σ) = πd(O/∅, σ) ∼= π1(AO, c(σ)).
1	1
Remark 4.3 The following properties are easily checked
If φr and φs are two S-loops at σ, then c(φr) ∗ c(φs) = c(φr ∗ φs).
If φr is a constant S-loop at σ then c(φr) is a constant edge–loop at c(σ).
Lemma 4.4 The correspondence h, given in (1) above, is well defined. More- over h is a group homomorphism.
Proof. Assume φr  d φs rel. σ are two equivalent S-loops in O. Then there
exist two constant S-loops φσ and φσ such that r+r' = s+s' and a d-homotopy

H : φr ∗ φσ
 d φs ∗ φσ
rel. σ. That is, H is an (∅, S)-map H : (V(r+r',t), g) →

(K(O∪S), fO∪S), where V(r+r',t) is a window in Def. 3.4 and (K(O∪S), fO∪S) is the digital subspace of (K, f ) induced by O∪S; see Lemma 2.5. Therefore, by Proposition 3.3 and Remark 2.6(2) we get a simplicial map A(H) : AV(r+r',t) → AO∪S \ AS. Notice that from the definition of the w.l.f. g in Example 2.7(1) it readily follows that AV(r+r',t) is simplicially isomorphic to a triangulation of the unit square I ×I, and hence A(H) yields a homotopy between the edge–loops c(φr ∗ φr' ) and c(φs ∗ φs' ). Finally, the properties in Remark 4.3 and suitable equivalence transformations of type (a) yield that c(φr ∗φr' ) = c(φr) ∗c(φr' ) is equivalent to c(φr), and similarly c(φs ∗ φs' ) is also equivalent to c(φs). Notice
also that h is an homomorphism of groups as an immediate consequence of property (1) in Remark 4.3.	✷

The general case: epimorphism onto the classical fundamental group.
This Section is aimed to show that, for arbitrary disjoint digital objects O, S ⊆
celln(K) in a digital space (K, f ), the homomorphism of groups
h : πd(O/S, σ) → π1(AO∪S \ AS, c(σ))
is always an epimorphism. For S = ∅, we proved in [4] that the homomorphism h above is actually an isomorphism of groups πd(O/∅, σ) ∼= π1(AO, c(σ)). For this we associate to each edge–loop Γ in AO a family of digital representatives
F (Γ) such that for each digital ∅–loop φr ∈ F (Γ) the edge–loop c(φr) is equiv- alent to Γ. In this section we show that this procedure can be generalized to get a non–empty family D(Γ) of S-loops in O of digital representatives for any edge–loop Γ in AO∪S \ AS. This immediately yields that the homomorphism h is onto with full generality. However, the construction of the family D(Γ) suggests that the homomorphism h need not to be injective in general. In any case, Section 4.2 provides a large class of digital spaces, including those often used in image processing, for which h is in fact an isomorphism.
In order to define the family D(Γ) we start generalizing the notion of irreducible edge–loop introduced in [4].
Definition 4.5 A vertex c(γi), of and edge–walk Γ = (c(γi))t	in AO∪S \ AS,
is said to be reducible in Γ if i > 0 and one of the following properties holds
γi−1 = γi
there exits a vertex c(γk) with i < k ≤ t such that γk /= γi and either
γi−1 < γi < γj or γi−1 > γi > γj, where j = min{k; i < k ≤ t, γi /= γk}.
An edge–walk is said to be reducible if it contains a reducible vertex; otherwise we say that Γ is irreducible.
The proof of the next lemma is similar to that of Lemma 4.7 in [4] with the obvious changes.
Lemma 4.6 Any edge–walk Γ in AO∪S \ AS is equivalent to an irreducible

edge–walk, Γ = (c(γi))k
, obtained by deleting all reducible vertices in Γ.

Remark 4.7 (a) If Γ = (c(γi))t	is an irreducible edge–walk in AO∪S \ AS
then either γi−1 < γi > γi+1 or γi−1 > γi < γi+1 for all 0 < i < t. Moreover, in case both γ0 and γt are n-cells in O then the length of Γ is an even number, t = 2r, and so γ2i−2 > γ2i−1 < γ2i, for 1 ≤ i ≤ r. In particular, this property holds for any edge–loop Γ in AO∪S \ AS which is based at a vertex c(σ) with σ ∈ O.
(b) Notice also that for an arbitrary edge–walk Γ = (c(γi))t	in AO∪S \AS

the vertex c(γ0) is never reducible. And, if Γ = (c(γi))k
is the irreducible

edge–walk obtained from Γ by deleting all its reducible vertices, then γt = γk.
For arbitrary digital spaces it may happen, for a cell α ∈ K with c(α) ∈ AO∪S \ AS, that the set stn(α; O) = ∅ is empty. This fact makes the search of digital representatives for an arbitrary edge–loop Γ in AO∪S \ AS much


more intricate than the case S = ∅ in [4]. In order to obtain such digital representatives for the edge–loop Γ we first set the following
Definition 4.8 Let O, S ⊆ celln(K) be two disjoint digital objects in a digital space (K, f ). We say that a cell α ∈ K is a singular cell for the pair (O, S), or simply an (O, S)-singular cell, if c(α) ∈ AO∪S \ AS but stn(α; O) = ∅ (or, equivalently, stn(α; S) = stn(α; O ∪ S)). Otherwise, if α ∈ AO∪S \ AS and stn(α; O) /= ∅, α is called an (O, S)-regular cell.
We will also call (O, S)-regular to any edge–loop Ω = (c(ωi))t	in AO∪S \
AS whose vertices correspond to (O, S)-regular cells; that is, ωi is (O, S)- regular for 0 ≤ i ≤ t.
Remark 4.9 (a) Notice that all cells α ∈ O are (O, S)-regular for any digital object S such that O ∩ S = ∅. And, similarly, if α is a vertex of K such c(α) ∈ AO∪S \ AS, then α is (O, S)-regular by Lemma 2.4.
(b) If α is an (O, S)-singular cell then axiom (5) in the definition of w.l.f. applies. So, the set α(S; O∪S) = {β < α; c(β) ∈ AO∪S \AS} is not empty and connected in ∂α. Moreover, from Lemma 4.5 in [3] it is derived the existence of (O, S)-regular cells in the set α(S; O ∪ S).
Despite the difficulties above, it is still not hard to define the digital repre- sentatives for the family of irreducible (O, S)-regular edge–loops in AO∪S \AS. We proceed as follows.

Definition 4.10 Let Ω = (c(ωi))2r
be an irreducible (O, S)-regular edge–

loop in AO∪S \ AS based at c(σ), with σ ∈ O. The set D(Ω) of digital repre- sentatives of Ω consists of all S-loops φr in O for which φr(0) = φr(r) = σ,
φr(i − 1) = ω2i−1, and φr(i) ∈ stn(ω2i; O), for 1 ≤ i ≤ r.
Remark 4.11 Let φr be an S-loop in O such that φr(i − 1) /= φr(i), for

1 ≤ i ≤ 2r. Then, the edge–loop c(φr) = (c(φr(i/2)))2r
is irreducible and

(O, S)-regular, moreover, D(c(φr)) = {φr} since φr(i) ∈ O for 0 ≤ i ≤ r.
Next we state the crucial property of the digital representatives of an irreducible (O, S)-regular edge–loop in relation with the homomorphism h : πd(O/S, σ) → π1(AO∪S \AS, c(σ)) above; compare with Proposition 4.12 in [4].

Proposition 4.12 Let Ω = (c(ωi))2t
be any irreducible (O, S)-regular edge–

loop in AO∪S \ AS. For any S-loop φt ∈ D(Ω) the equality h([φt]) = [Ω] holds. Moreover, any two S-loops in D(Ω) are d-homotopic.

Proof. First we show that the edge–loop c(φt) = (c(φt(i/2)))2t
defined by φt

is equivalent to Ω. For this, let D(Ω) be the set of edge–loops Λ = (c(λi))2t at c(σ) such that λ0 = λ2t = σ, λ2i−1 = ω2i−1 for 1 ≤ i ≤ t, and λ2i ∈ stn(ω2i; O) ∪ {ω2i} for 1 < i < t. Notice that D(Ω) contains the set of edge– loops {c(φt); φt ∈ D(Ω)}∪ {Ω}. Moreover, any Λ ∈ D(Ω) is equivalent to Ω. This will be proved by induction on the number k(Λ) of vertices c(λ2i ) in Λ for which λ2i /= ω2i. For k(Λ) = 0 we get Λ = Ω. Assume that all Λ ∈ D(Ω) are


equivalent to Ω for k(Λ) ≤ k — 1, and let Λ be any edge–loop with k = k(Λ). Given any vertex c(λ2i) in Λ with λ2i /= ω2i (notice that 0 /= i /= 2t) we get ω2i−1, ω2i+1 < ω2i < λ2i since Ω is irreducible. Therefore we obtain a new edge–loop Λ˜ ∈ Ð(Ω), with k(Λ˜) = k — 1, by setting c(λ˜j ) = c(λj) for j /= 2i,
and c(λ˜2i) = c(ω2i).	Moreover, Λ˜ is equivalent to Λ (by two equivalence
transformations of type (b)) and hence Λ is equivalent to Ω by the induction hypothesis.
For the second property, we simply observe that the S-loops φ1, φ2 ∈ Ð(Ω)
t	t
are d-homotopic rel. σ by the (∅, S)-map H : Lb(V(r,1)/∅) → Lb(K(O ∪ S)/S)
given by H(i/2, 0) = φ1(i/2), H(i/2, 1) = φ2(i/2) and H(i/2, 1/2) = ωi, for
t	t
0 ≤ i ≤ 2t. Here, we are using the identification of a cell α ∈ Lb(V(r,1)/∅) with
its centroid c(α) = (a1, a2) ∈ Z2 (see Remark 3.5).	✷
In order to obtain a family Ð(Γ) of digital representatives for an arbi- trary edge–loop Γ, we construct an auxiliary family pre2Ð(Γ) of irreducible (O, S)-regular edge–loops. For this we shall use of another family of edge– loops preÐ(Γ). This two–step process starts at the irreducible edge–loop

Γ = (c(γi))2r
obtained from Γ by deleting all its reducible vertices; see



Lemma 4.6. Then, the edge–loops in preÐ(Γ) are chosen by diverting Γ off
the vertices c(γ2i−1), with an odd index, corresponding to (O, S)-singular cells.
And pre2Ð(Γ) consists of the edge–loops obtained from each ∆ = (c(δ2i))2t	∈
preÐ(Γ) bypassing each vertex c(δ2i), with δ2i an (O, S)-singular cell, along a new edge–walk whose vertices correspond to (O, S)-regular cells in ∂δ2i.
Indeed, the elements in preÐ(Γ) are the family of edge–loops ∆ = (c(δi))2r in AO∪S \ AS with the same length as Γ and such that δ2i = γ2i, for 0 ≤ i ≤ r. Moreover, δ2i−1 = γ2i−1 whenever γ2i−1 is an (O, S)-regular cell; and, oth- erwise, we choose δ2i−1 ∈ {α < γ2i−1; α is an (O, S)-regular cell}, which is a non–empty set by Remark 4.9(b).
Notice that any ∆ ∈ preÐ(Γ) is irreducible. Moreover, the following lemma is immediate
Lemma 4.13 Any ∆ ∈ preÐ(Γ) is equivalent to Γ, and hence to Γ.
Proof. Just observe that the substitution of any cell γ2i−1 by one of its faces induces two equivalence transformations of type (b) between Γ and ∆.	✷
If we write preÐ(Γ) = {∆k}k∈JΓ , a new family of irreducible edge–loops

pre2Ð(∆k) is defined for each ∆k = (c(δi))2r
as follows. An irreducible edge–

loop Ω ∈ pre2Ð(∆k) is obtained by removing the reducible vertices from the juxtaposition of edge–walks Ω = Ω0 ∗ Ω1 ∗· · · ∗ Ωr, where Ω0 = (c(δ0), c(δ1)), Ωr = (c(δ2r−1), c(δ2r)) and the component Ωj, for 1 ≤ j ≤ r — 1, is the constant edge–loop Ωj = (c(δ2j−1)) if δ2j−1 = δ2j+1. Otherwise, if δ2j is an (O, S)-regular cell, in particular if δ2j ∈ O (see Remark 4.9(a)), then Ωj = (c(δ2j−1), c(δ2j), c(δ2j+1)). Finally, if δ2j−1 is an (O, S)-singular cell we pick Ωj out the edge–walks obtained from the following lemma for the (O, S)-regular cells β1 = δ2j−1 and β2 = δ2j+1.


Lemma 4.14 (cf. Lemma 4.8 in [3]) Let O, S ⊆ celln(K) be two disjoint digital objects in a digital space (K, f ), and let α ∈ K be an (O, S)-singular cell. Then, for any two given (O, S)-regular cells
β1, β2 ∈ α(S; O ∪ S) = {β < α; f (O ∪ S, β) = 1,f (S, β) = 0}
there exist irreducible edge–walks Θ = (c(θi))m	in AO∪S \ AS from c(β1) to
c(β2) such that
for 0 ≤ i ≤ m, θi < α and it is an (O, S)-regular cell; and,
Θ is equivalent to the edge–walk (c(β1), c(α), c(β2)).

Proof. By axiom (5) in Def. 2.3 we know that the set α(S; O ∪ S) is connected
and so we can choose an edge–walk Φ = (c(φi))t	in α(S; O∪S) from c(β1) to
c(β2). By deleting the reducible vertices we can assume that Φ is irreducible (see Lemma 4.6). Notice that Φ need not have even length since β1 and β2 may have arbitrary dimensions. In any case, it is obvious that Φ is equivalent to the edge–walk (c(β1), c(α), c(β2)).
We derive the walk Θ from Φ as follows. First we observe that dim α ≥ 2 by Lemma 2.4 and axiom (5) in Def. 2.3. Then we argue inductively on l = dim α. For l = 2 we have necessarily dim φi ≤ 1. Moreover, if dim φi = 0 then φi is an (O, S)-regular cell by Remark 4.9(a). If dim φi = 1 with 0 < i < t, the cells φi−1 and φi+1 are necessarily vertices of the edge φi ∈ K. If, in addition, φi−1 /= φi+1 it follows that φi is also an (O, S)-regular cell by axiom (5) in Def. 2.3. Otherwise, if φi−1 = φi+1, then we can delete the vertices c(φi) and c(φi+1) from Φ to get a new irreducible edge–walk from c(β1) to c(β2) which is equivalent to Φ by two equivalence transformations of type (b). By deleting all the pairs (c(φi), c(φi+1)), for which φi is an edge in K and φi−1 = φi+1, we obtain the desired edge–walk Θ.
Assume now that Θ can be derived from Φ for any cell α with dim α < l, and let dim α = l.  Following the construction of the family preÐ(Γ) we

define the edge–walk Φ' = (c(φ' ))t	by φ'	= φ2j−1 and also φ'
= φ2j, for

i  i=0	2j−1	2j

0 ≤ 2j ≤ t, if φ2j is an (O, S)-regular cell. Otherwise we choose φ'
∈ {α < 

φ2j; α is (O, S)-regular}. It is easily checked that Φ' is an irreducible edge–

walk equivalent to Φ with its same length. Moreover, dim φ'
< dim α, for

0 ≤ 2j — 1 ≤ t, and φ' = β1 and φ' = β2.
We define Θ by the juxtaposition Θ = Θ1 ∗ ··· ∗ Θk defined as follows. The index k is the largest integer with 2k — 1 ≤ t, and the edge–walks Θj, for 1 ≤ j ≤ k, are given by the next conditions:
Θj = (c(φ'	)) if φ'	'

Θj = (c(φ'
), c(φ'
), c(φ'
)) if φ'
/= φ'
'
2j−1
is (O, S)-regular;

Θj is any of the edge–walks given by the induction hypothesis applied

to φ2j−1 and its faces φ'
'	whenever φ'
/= φ'
'
2j−1
is an

(O, S)-singular cell.


By construction one readily checks that Θ satisfies properties (1) and (2) in the lemma. Moreover, after deleting the reducible vertices (if any) in Θ we can assume that Θ is also an irreducible edge–walk.	✷
Remark 4.15 Observe that, by construction, any edge–loop Ω ∈ pre2Ð(∆) is equivalent to ∆, and hence to Γ by Lemma 4.13. Moreover, it is irreducible and (O, S)-regular.
Finally, we define the family Ð(Γ) of digital representatives of Γ as follows
Definition 4.16 Let Γ be an arbitrary edge–loop in AO∪S \AS based at c(σ), with σ ∈ O. We define the set Ð(Γ) of digital representatives of Γ by
Ð(Γ) =			Ð(Ω)	.
∆∈preD(Γ) Ω∈pre2D(∆)	
Remark 4.17 Let ∇ be and edge–loop in AO∪S \ AS obtained by removing from Γ any of its reducible vertices. Then ∇ = Γ and hence Ð(Γ) = Ð(∇).
We are now ready to prove
Theorem 4.18 Let (K, f ) be an arbitrary digital space. For any two disjoint digital objects O, S ⊆ celln(K) the homomorphism
h : πd(O/S, σ) → π1(AO∪S \ AS, c(σ))
is onto.
Proof. Given any edge–loop Γ in AO∪S \ AS based at c(σ), we consider any edge–loop Ω ∈ pre2Ð(Γ) which is equivalent to Γ by Remark 4.15. Then the result follows from Proposition 4.12.	✷
Remark 4.19 To show that the homomorphism h is injective it is required, as a necessary condition, that φ1 d φ2 rel. σ for any pair φ1, φ2 ∈ Ð(Γ) ofdigital representatives ofan arbitrary edge–loop Γ in AO∪S\AS (see Proposition 4.12). The construction of the family Ð(Γ) suggests that this fact may not be true in general. The main problem is that, from the available data, we cannot derive a d-homotopy between φ1 ∈ Ð(Ω1) and φ2 ∈ Ð(Ω2) whenever Ω1 /= Ω2 in pre2Ð(Γ). However, we conjecture that this d-homotopy will be found if, for
◦
each (O, S)-singular cell α, the set ∪{β; β ∈ α(S; O ∪ S)} is required to be
simply connected instead of just connected as we require in Def. 2.3(5b).

A case of isomorphism.
For important cases, the family of digital representatives Ð(Γ) in Def. 4.16 is dramatically simplified. Recall that, in general, the family Ð(Γ) is obtained by a three–steps procedure that involves the definition of two auxiliary families of edge–loops preÐ(Γ) and pre2Ð(Γ). In this Section we will give a large class of digital spaces (K, f ) for which the families preÐ(Γ) and pre2Ð(Γ) are reduced to singletons; so that, the difficulties pointed out in Remark 4.19


vanish. This will allow us to show that the epimorphism h in Theorem 4.18 is an isomorphism for a large class of digital spaces, which includes those most used in image processing. Namely, we will prove below
Theorem 4.20 Let (K, f ) be any digital space which is strongly local except possibly in 1-cells; that is, for any digital object O ⊆ celln(K) and any cell α ∈ K with dim α /= 1, f (O, α) = f (stn(α; O), α). Then the homomorphism h : πd(O/S, σ) → π1(AO∪S \ AS, c(σ)) is an isomorphism for any pair of disjoint objects O, S ⊆ celln(K).
Corollary 4.21 Let (K, f ) be a strongly local digital space. For disjoint dig- ital objects O, S ⊆ celln(K) the homomorphism h is an isomorphism.
Recall that a digital space (K, f ) is said to be strongly local if f (O, α) = f (stn(α; O), α) for all α ∈ K and O ⊆ celln(K); see Def. 2.3. For each pair (p, q) /= (6, 6), with p, q ∈ {6, 18, 26}, it can be found a strongly local lighting function fp,q on the device model R3 such that the digital space (R3, fp,q) represents the (p, q)-connectivity on the grid Z3; and, moreover, all the (p, q)- surfaces, as defined by Kong and Roscoe in [8], are digital surfaces in (R3, fp,q); see Theorem 13 in [1]. Notice also that, for an arbitrary device model K, the digital spaces (K, fmax) and (K, g) given in Example 2.7(1) are strongly local. Hence, for these relevant examples, Corollary 4.21 holds.
Moreover, as an immediate consequence of Lemma 2.4, we have also
Corollary 4.22 The homomorphism h is an isomorphism for digital spaces
(K, f ) with dim K ≤ 2.
For non strongly local three–dimensional digital spaces we have the follow-
ing
Lemma 4.23 Let (R3,f) be any digital space with R3 the standard cubical decomposition of the Euclidean space R3. Moreover, assume |AR3 | = R3. Then the two following statements are equivalent.
For each O ⊆ cell3(R3) and α ∈ R3 with dim α = 2, f (O, α) = 1 if and only if α ∈ supp(O).
(R3,f) is strongly local except possibly for 1-cells.
Proof. (i) implies (ii).	It is clear that α ∈ supp(O) if and only if α ∈ supp(st3(α; O)). Therefore, for dim α = 2 and α ∈ supp(O) we have f (O, α) = f (st3(α; O), α) = 1 by (i). Otherwise, in case α ∈/ supp(O), then f (O, α) = 0 and f (st3(α; O), α) = 0 by axiom (2) in Def. 2.3. For cells α ∈ R3 with dim α ∈ {0, 3} the result follows from Lemma 2.4.
(ii) implies (i). For any object O ⊆ cell3(R3) and any 2-dimensional cell
α ∈ K one easily checks that α ∈ supp(O) if and only if st3(α; O) = st3(α; R3).
Hence f (O, α) = 0 whenever α ∈/ supp(O) by axiom (2) in Def. 2.3 while
f (O, α) = f (st3(α; R3), α) = f (cell3(R3), α) = 1 if α ∈ supp(O). Here we use that |AR3 | = R3.	✷


Then, we easily derive from Theorem 4.20 and Lemma 4.23 the following
Theorem 4.24 The homomorphism h is an isomorphism for the non strongly local digital space (R3,fBM ) given in [3].
We point out that the digital surfaces in (R3,fBM ) coincide with the strong 26-surfaces defined by Malgouyres and Bertrand [11].
The rest of this section is devoted to the proof of Theorem 4.20. We start with the following result, whose proof is immediate from definitions.
Lemma 4.25 Let (K, f ) be a digital space which is strongly local at the cell α ∈ K. Then this cell is (O, S)-regular for any pair of disjoint digital objects O, S ⊆ celln(K) for which c(α) ∈ AO∪S \ AS.
Lemma 4.26 Let (K, f ) be any digital space which is strongly local except possibly in 1-cells, and let O, S be two disjoint digital objects in (K, f ). For any edge–loop Γ in AO∪S \ AS based at a vertex c(σ), with σ ∈ O, the set pre2Ð(Γ) = {ΩΓ} is a singleton. In particular, all the digital representatives of Γ are d-homotopic by Proposition 4.12.
Proof. Notice that any cell α ∈ K with c(α) ∈ AO∪S \ AS and dim α /= 1 is (O, S)-regular by Lemma 4.25. So, the construction of the family Ð(Γ) is determined by the vertices c(α) with dim α = 1. More explicitly, if Γ = 

(c(γi))2r
is the irreducible edge–loop in Lemma 4.6 then the family preÐ(Γ) =

{∆Γ} consists of a unique (irreducible) edge–loop ∆Γ = (c(δi))2r
obtained by

setting δ2i = γ2i and replacing each vertex c(γ2i−1), with γ2i−1 an (O, S)- singular 1-cell, by c(δ2i−1) where δ2i−1 < γ2i−1 is the unique vertex of γ2i−1 which is a (O, S)-regular cell. Here we use axiom (5) in Def. 2.3. Moreover, pre2Ð(Γ) = pre2Ð(∆Γ) = {ΩΓ} is also a singleton since, for any vertex c(δ2i) in
∆Γ, with 0 < i < r, such that δ2i = γ2i is an (O, S)-singular 1-cell, axiom (5) in Def. 2.3 yields δ2i−1 = δ2i+1. Hence ΩΓ is determined by replacing the edge–walk (c(δ2i−1), c(δ2i), c(δ2i+1)) by the constant edge–walk (c(δ2i−1)).  ✷
In the proof of Theorem 4.20 we also use the following lemma, whose proof is essentially the same as that of Lemma 4.14 in [4].

Lemma 4.27 Under the hypothesis of 4.20 let Γ = (c(γi))t
and Σ be two

edge–loops in AO∪S \AS based at c(σ), with σ ∈ O. Assume Σ is obtained from
Γ by removing a vertex c(γi0 ) via an equivalence transformation of type (a) or
(b). Then for each S-loop φ ∈ Ð(Γ) there exist ψ ∈ Ð(Σ) and a d-homotopy φ d ψ rel. σ.
Proof of Theorem 4.20. We already know that h is onto by 4.18. So, it will suffice to prove that any two S-loops, φ, ψ, in O define the same element in πd(O/S, σ) provided h([φ]) = [c(φ)] = [c(ψ)] = h([ψ]).
Since c(φ) and c(ψ) are equivalent edge–loops, there exists a sequence α0, α1,..., αk of edge–loops in AO∪S \ AS such that α0 = c(φ), αk = c(ψ) and αi−1, αi are related by an equivalence transformation of type (a) or (b).


Then, Lemma 4.27 yields that every S-loop in ∪k Ð(αi) defines the same
element in πd(O/S, σ). Hence φ and ψ are d-homotopic since Ð(c(φ)) = {φ}
and Ð(c(ψ)) = {ψ} by Remarks 4.11 and 4.17.	✷

References
Ayala, R., E. Dom´ınguez, A. R. Franc´es and A. Quintero, Digital Lighting Functions, Lecture Notes in Computer Science 1347 (1997), 139–150.
Ayala, R., E. Dom´ınguez, A. R. Franc´es and A. Quintero, A Digital Index Theorem, Proc. of the 7th Int. Workshop on Combinatorial Image Analysis, IWCIA’00, (2000), 89–101.
Ayala, R., E. Dom´ınguez, A. R. Franc´es and A. Quintero, Weak Lighting Functions and Strong 26-surfaces, Theoretical Comptuer Science, To Appear.
Ayala, R., E. Dom´ınguez, A. R. Franc´es and A. Quintero, Homotopy in Digital Spaces, Discrete and Applied Mathematics, To Appear.
Dom´ınguez, E., and A. R. Franc´es, An Axiomatic Approach to Digital Topology, Lecture Notes in Computer Science, special issue on Digital and Image Geometry, to appear.
Khalimsky, D., Motion, Deformation and Homotopy in Finite Spaces, Proc. of the 1987 IEEE Int. Conf. on Systems, Man, and Cybernetics, 87CH2503-1, (1987), 227–234.
Kong, T. Y., A Digital Fundamental Group, Comput. and Graphics 13(2) (1989), 159–166.
Kong, T. Y., and A. W. Roscoe, Continuous Analogs of Axiomatized Digital Surfaces, Comput. Vision Graph. Image Process. 48 (1989), 357–393.
Kong, T. Y., and E. D. Khalimsky, Polyhedral Analogs of Locally Finite Topological Spaces, in: R. M. Shortt, Ed., General Topology and Applications: Proc. of the 1988 Northeast Conf., Marcel Dekker, New York (1990) 153–164.
Kovalevsky, V. A., Finite Topology as Applied to Image Analysis, Comput. Vision Graph. Image Process. 46 (1989) 141–161.
Malgouyres, R., and G. Bertrand, Complete Local Characterization of Strong 26-Surfaces: Continuous Analog for Strong 26-Surfaces, Int. J. Pattern Recog. Art. Intell. 13(4) (1999) 465–484.
Maunder, C. R. F., “Algebraic Topology,” Cambridge University Press 1980.
Munkres, J. R., “Elements of Algebraic Topology,” Addison–Wesley 1984.
Rourke, C. P., and B. J. Sanderson, “Introduction to Piecewise-Linear Topology,” Ergebnisse der Math. 69, Springer 1972.
Stillwell, J., “Classical Topology and Combinatorial Group Theory,” Springer, 1995.
