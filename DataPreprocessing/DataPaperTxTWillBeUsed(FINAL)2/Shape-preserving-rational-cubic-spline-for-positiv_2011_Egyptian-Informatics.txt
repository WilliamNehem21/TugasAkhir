
ORIGINAL ARTICLE

Shape preserving rational cubic spline for positive and convex data
Malik Zawwar Hussain a,*, Muhammad Sarfraz b, Tahira Sumbal Shaikh a

a Department of Mathematics, University of the Punjab, Lahore, Pakistan
b Department of Information Science, Adailiya Campus, Kuwait University, Kuwait

Received 3 May 2011; revised 3 August 2011; accepted 11 October 2011
Available online 6 November 2011

Abstract In this paper, the problem of shape preserving C2 rational cubic spline has been pro- posed. The shapes of the positive and convex data are under discussion of the proposed spline solu- tions. A C2 rational cubic function with two families of free parameters has been introduced to attain the C2 positive curves from positive data and C2 convex curves from convex data. Simple data dependent constraints are derived on free parameters in the description of rational cubic func- tion to obtain the desired shape of the data. The rational cubic schemes have unique representa- tions.
© 2011 Faculty of Computers and Information, Cairo University. Production and hosting by Elsevier B.V. All rights reserved.



Introduction

Shape preservation of a given data is an important topic in the field of data visualization. In data visualization techniques

* Corresponding author.
E-mail addresses: malikzawwar.math@pu.edu.pk (M.Z. Hussain), prof.m.sarfraz@gmail.com (M. Sarfraz).
1110-8665 © 2011 Faculty of Computers and Information, Cairo University. Production and hosting by Elsevier B.V. All rights reserved.

Peer review under responsibility of Faculty of Computers and Information, Cairo University.
doi:10.1016/j.eij.2011.10.002
researchers convert any information into graphical views. These graphical views have great importance in many fields including engineering, military, transport, advertising, medi- cine, education, art, etc. Data that is used for the visualization has some hidden properties (such as positive or convex). It is observed, in Figs. 1 and 3, that a normal cubic spline interpo- lates the data points but may not preserve the inherent features of the positive data. Similarly, Figs. 5 and 7 reflect that the convexity is not preserved by an ordinary cubic spline while the data is convex. This is not desired in scientific computing. In recent years, some work [1–10] has been published on shape preservation. Asim and Brodlie [1] discussed the prob- lem of drawing a positive curve through positive data set. They used piecewise cubic Hermite interpolation to fit a positive curve. In any interval where the positivity is lost they added extra knots to cubic Hermite interpolant to obtain the desired curve. In [2], Brodlie and Butt discussed the problem of shape preservation of convex data and in [3]; Butt and Brodile dis- cussed the problem of shape preservation of positive data. In


30

25

20


[2,3] they used the cubic Hermite interpolation to preserve the shape of convex and positive data. The algorithms developed in [2,3] work by inserting one or two extra knots, wherever nec- essary, to preserve the shape of the data. Duan et al. [4] dis- cussed rational interpolation based on function values and also discussed constrained control of the interpolanting curves. They obtained conditions on function values for constraining the interpolating curves to lie above, below or between the gi- ven straight lines. In [4] the authors assumed suitable values of parameters to obtain C2 continuous curve and the method works for equally spaced data. Fangxun et al. [5] developed methods for value control, inflection point control and convex- ity control with rational cubic spline. To control the shape of the curve they assumed certain value of function and obtained conditions at that value and to control derivative of the inter- polating curve at some points. They assumed derivative value according to desire and imposed condition at that value. De- gree of smoothness they achieved was C1. Fiorot and Tabka
[6] used C2 cubic polynomial spline to preserve the shape of convex or monotone data. In [6], the values of derivative parameters are obtained by using three systems of linear equa- tions. In [7], Floater proved that total positivity and rational convexity preservation are equivalent. Gal [8] divided the book in four chapters: firstly he talked about the shape-preserving approximation and interpolation of real functions of one real variable by real polynomials, secondly he discussed the shape-preserving approximation of real functions of several real variables by multivariate real polynomials; thirdly he dis- cussed shape-preserving approximation of analytic functions of one complex variable by complex polynomials in the unit disk, and at the last shape-preserving approximation of ana- lytic functions of several complex variables on the unit ball or the unit polydisk by polynomials of several complex vari- ables has also been discussed.
Hussain et al. [9] discussed the problem of visualization of scientific data; a rational cubic function was used to achieve the goal for shaped data. They derived the conditions on free parameters in the description of rational cubic function to obtain desired shapes of the data and the degree of smoothness attained was C1. Sarfraz et al. [10] constructed a C1 interpolant to visualize the shape of 2D positive data. They derived the conditions on free parameters in the description of rational cu- bic function to visualize the shape of 2D positive data. Further they also extended their scheme to visualize the shape of 3D positive data.
This paper is also devoted to the subject of shape preserva- tion of data. In this paper, the authors have developed a rational cubic spline with two free parameters in its description
15

10

5

0
-5 0	0.2	0.4	0.6	0.8	1	1.2	1.4	1.6	1.8	2
x-axis

Figure 1	Cubic Hermite function.


30


25


20


15


10


5


00	0.2	0.4	0.6	0.8	1	1.2	1.4	1.6	1.8	2
x-axis

Figure 2  C2 positive rational cubic function with ti = 2.5 and
ji = 0.05.

to preserve the shape of positive and convex data. The pro- posed spline is C2, i.e. its second ordered derivative exists and is continuous. The proposed schemes have various advan- tages including the followings:
In [1–3], the authors developed the schemes to attain the desired shape of the data by inserting extra knots between
any two knots while in this paper we preserve the shape of positive and convex data by imposing conditions on free parameters in the description of rational cubic function without inserting any extra knot.



45	the presentation of convexity preserving scheme. Section 5 concludes the paper.
40
C2 rational cubic function
35

that  x1 < x2 < ··· < xn.  In  each  interval  [xi, xi+1],  the  C2                                                                                                30	Let {(xi, fi), i = 1, 2, 3, .. . , n} be given set of data points such
25	rational cubic function S(x) is defined as:

20	p (h)
P3 x (1 — h)3—ihi

15
10	with
qi (h)
qi (h)

5	h = x

— x ;	h = (x — xi) ;	i = 1; 2; 3; .. . ; n — 1;


0
0	5	10	15	20	25	30	35	40	45
i

and
i+1	i
i

x-axis

Figure 3	Cubic Hermite function.

45

40

35

30
x0 = lifi,
x1 = lihidi + (2li + ti)fi,
x2 = —tihidi+1 + (li + 2ti)fi+1,
x3 = tifi+1,
qi(h)= li(1 — h)2 + (li + ti)h(1 — h)+ tih2.
where li, ti are the shape parameters that are used to control
the shape of the interpolating curve. Let S(1)(x) and S(2)(x) denote the first and the second ordered derivatives with respect to x and di denote derivative value at the knot xi. Then, the C2 splining constraints:

25	S(xi)= fi;	S(xi+1)= fi+1
20	S(1)(xi)= di ;	S(1)(xi+1)= di+1
9>=
(2)

15

10

5

0  0	5	10	15	20	25	30	35	40	4
x-axis

Figure 4	C2 positive rational cubic function with ti = 2.05 and
ji = 0.5.


In [4] the authors developed schemes that work for equally spaced data while the schemes developed in this paper work
for both equally and unequally spaced data.
In [5], to control the shape of the data, certain function val- ues and derivative values are assumed. In this paper, desired
shape of the data is attained by imposing the data depen- dent constraints on the free parameters in the description of rational cubic function.
In this paper, finding the values of the derivatives parame-
ters, is computationally less expensive as compared to the
method developed in [6].
In [5,9,10], degree of smoothness attained is C1 while in this paper degree of smoothness isC2.

This paper is organized as follows. In Section 2, a C2 rational cubic function is introduced with two free parameters in its description. In Section 3, a scheme is presented for shape preservation of positive data whereas Section 4 is dedicated to
S(2)(xi+) = S(2)(xi—); i = 2; 3; ... ; n — 1
produce, on the first derivative parameters d2, d3, ···, dn—1, the following system of linear equations:
li—1ti—1hidi—1 + [ti—1(li—1 + ti—1)hi + li (li + ti )hi—1]di
+ litihi—1di+1 = hi—1 li(li + 2ti)Di + hiti—1 (ti—1 + 2li—1)Di—1;
(3)
where Di = (fi+1 — fi)/hi, and the derivative parameters d1, dn
are determined by appropriate end conditions.

Remark 1. Since, the linear system of Eq. (3) is a strictly tri-
derivative parameters d's. Moreover, it is efficient to apply LU- diagonal for all li, mi > 0, it has a unique solution for the parameters                 d's. decomposition method to solve the system for the derivative

cubic function S(x) e C2[x1, xn] has shape parameters l's and t's. It is observed that in each interval [xi, xi+1], when Remark 2. In each interval [xi, xi+1], the piecewise rational
li = ti = 1, the rational spline reduces to the standard cubic
spline.






C2 positive rational cubic function

In this section, we discuss the problem of shape preserving C2
positive rational cubic spline. For the positive set of data

{(xi; fi); i = 1; 2; 3; ... ; n}; x1 < x2 < ··· < xn, and f1 > 0, f2 > 0, ··· fn > 0, it is required to construct a positive interpo- lant S(x). The rational cubic function (1) is positive if both
pi(h) and qi(h) are positive. Since qi(h) > 0 for all li, ti > 0. Now pi(h) can be expressed as follows:
p (h)= aih3 + bih2 + cih + ei;	(4)
where
ai = {li (di — Di)+ ti(di+1 — Di)}hi;
bi = {li (Di — 2di)+ ti(2Di — di+1)hi;
c = l (h d — f )+ t f ;
Proof. Since we assume throughout that li, ti > 0, for all i. Therefore, (5a) and (5b) simply follow from (5). h

Demonstration

Consider positive data sets in Tables 1 and 2. Figs. 1 and 3 are produced by cubic Hermite spline which loose the shape of the data. The C2 positive rational cubic spline curve, in Figs. 2 and 4, are generated by using Theorem 1. This guarantees the pre- served shape. Tables 3 and 4 demonstrate the computed values from the proposed scheme of Figs. 2 and 4 respectively.

Convex rational cubic function

This section deals with the problem of shape preserving C2

i	i  i i	i	i i

ei = lifi+1 ;
h = x	— x ;	D = fi+1 — fi ;	i = 1; 2; ... ; n — 1.
i
According to Butt and Brodlie [3], pi(h) > 0 if and only if
(p'(0); p'(1)) ∈ R1 ∪ R2, where
convex cubic function. Consider a set of convex data points
{(xi; fi);i = 1; 2; 3; ... ; n}, such that D1 < D2 < ··· < Dn—1. The necessary condition for a convex curve is that the deriva-
tive parameters must satisfy the following criterion:
d1 < D1 < ··· Di—1 < di < Di ··· < Dn—1 < dn.

i	i	Now S (x) is convex if and only if S(2)(x) P 0. We have

R1 =  (a; b) : a >
—3pi (0)
; b <
3pi (1) ;
i	i
P6 a hi—1(1 — h)6—i

R2 = {(a; b)
: 36f fi+1(a2 + b2 + ab — 3Di(a + b)+ 3D2)+ 4hi(fi+1a3
— f b3)— h2a2b2 + 3(f a — f b)(2h ab — 3f  a + 3f b)
where
a1 = 2l2{(li + ti)(Di — di)— ti(di+1 — Di)}/hi,

i	i
> 0};
i+1	i	i
i+1	i
i
a2 = 2t2{(2li + 5ti)(Di — di)— 2ti(di+1 — Di)}/hi,
a3 = 2li{li(li + 7ti)(Di — di)+ ti(di+1 — Di)( — li + 3ti)}/hi,

p'(0)= {tifi + li(hidi — fi)}
and p'(1)
a4 = 2ti{li(3li — ti)(Di — di)+ ti(di+1 — Di)(7li + ti)}/hi,

i	hi	i
a = 2l2{(5l + 2t )(d
— D )— 2t (D — d )}/h ,

5	i	i
i	i+1	i
i  i	i	i

= {ti(fi+1 + hidi+1)— lifi+1} .
h
a6 = 2t2{(li + ti)(di+1 — Di)— li (Di — di)}/hi,
Now S(2)(x) P 0 if all a's > 0;	i = 1; 2 ... 6.

i
Now	(p'(0); p'(1)) ∈ R1 ∪ R2,	is	true	when
i	i
Now, a's > 0, if

i	i
'	'	'
—3p (0)  '
3p (1)	i

(pi(0); pi(1)∈ R1).where pi (0) >	i  ; pi (1) < i
(di+1 — di)ti
(Di — di+1)ti

This yields to the following constraints:
ti > 0;	li > 0;	li >
(D — d ) ;	li >
(d — D ) .  (7)

l >  —tifi  ;	l > (hidi+1 — 2fi)ti
(5)
All the above discussion can be summarized as:

2fi + hidi
fi+1

All the above discussion can be summarized as:

Theorem 1. The C2 rational cubic function (1) is positive in each interval [xi, xi+1] if the shape parameters li, ti satisfy the following constraints:
ti > 0;	(5a)
l = j + max 0;  —tifi   ; (hidi+1 — 2fi)ti ; j > 0.   (5b)
Theorem 2. The C2 rational cubic function (1) is convex in each interval [xi, xi+1] if the shape parameters li, ti satisfy the following constraints:





7.5

7

6.5

6

5.5

5

4.5

4

3.5

3
-10	-8	-6	-4	-2	0	2	4	6	8	10
x-axis

Figure 5	Cubic Hermite function.

10
9
8
7
6
5
4
3
2
1
0
-1 0	2	4	6	8	10	12
x-axis

Figure 7	Cubic Hermite function.





7.5

7

6.5

6

5.5

5

4.5

4

3.5

3
-10	-8	-6	-4	-2	0	2	4	6	8	10
x-axis
10

9

8

7

6

5

4

3

2

1

0
0	2	4	6	8	10	12
x-axis


Figure 6	C2 convex rational cubic function with ti = 2.01 and
di = 0.05.
ti > 0;	(8)
Figure 8	C2 convex rational cubic function with ti = 2.025 and
di = 0.75.


Demonstration

(di+1 — di)ti (Di — di+1)ti 
Consider convex data set in Tables 5 and 6. Figs. 5 and 7 are



i	i	i	i

Proof. Since we assume throughout that li, ti > 0, for all i. Therefore, (8&9) simply follow from (7).	h
It can be observed that both the figures have undesired oscilla- tions. The C2 convex rational cubic spline curve, in Figs. 6 and 8, are generated by using the proposed scheme as summarized in Theorem 2. This guarantees the preserved shape. Tables 7






and 8 demonstrate the computed values from the proposed scheme of Figs. 6 and 8 respectively.

Conclusion

To deal with smooth visualization of shaped data, C2 rational cubic splines are developed. Two free parameters are intro- duced in its representations to preserve the shapes of positive and convex data. The shape constraints are restricted on free parameters to secure the shape preservation of the data. The developed schemes are applicable to such problems in which only data points are known. There is no need of additional information about derivatives because they are estimated di- rectly from given data. It works for both equally and unequally spaced data. The order of continuity attained is C2. In [1–3] additional knots are inserted between any two knots to attain desired shape of the data while in this paper we obtained de- sired shape without inserting extra knots. In this paper, for finding the values of derivative parameters, we obtained only one tridiagonal system of linear equations. While in [6], the authors obtained three systems of linear equations for finding the values of derivative parameters, which is computationally more expensive as compared to the schemes developed in this paper. The schemes developed in this paper are smoother and visually pleasing as compared to the schemes developed in [9,10].
References

Asim MR, Brodlie KW. Curve drawing subject to positivity and more general constraints. Comput Graph 2003;27:469–85.
Brodlie KW, Butt S. Preserving convexity using piecewise cubic interpolation. Comput Graph 1991;15(1):15–23.
Butt S, Brodlie KW. Preserving positivity using piecewise cubic interpolation. Comput Graph 1993;17(1):55–64.
Duan Q, Wang L, Twizell EH. A new C2 rational interpolation based on function values and constrained control of the interpo- lant curves. Appl Math Comput 2005;161(2005):311–22.
Fangxun B, Qinghua S, Duan Q. Point control of the interpolat- ing curve with a rational cubic spline. J Vis Commut Image Represent 2009;20:275–80.
Fiorot JC, Tabka J. Shape preserving C2 cubic polynomial interpolating splines. Math Comput 1991;57(195):291–8.
Floater MS. Total positivity and convexity preservation. J Approx
Theory 1999;96:46–66.
Gal SG. Shape-preserving approximation by real and complex polynomials, Birkhauser Boston; 2008.
Hussain MZ, Sarfraz M, Hussain M. Scientific data visualization with shape preserving C1 rational cubic interpolation. Eur J Pure Appl Math 2010;3(2):194–212.
Sarfraz M, Hussain MZ, Asfar N. Positive data modeling using spline function. Appl Math Comput 2010;216:2036–49.
