Available online at www.sciencedirect.com



Electronic Notes in Theoretical Computer Science 277 (2011) 41–52
www.elsevier.com/locate/entcs

A Combined Process Algebraic and Stochastic Approach to Bone Remodeling
P. Lio`1
Computer Laboratory University of Cambridge Cambridge, UK
E. Merelli and N. Paoletti2
School of Science and Technology, Computer Science Division University of Camerino
Camerino, Italy
M. Viceconti3
Laboratorio di Tecnologia Medica Istituto Ortopedico Rizzoli Bologna, Italy

Abstract
In adult life the bone is continuously being resorbed and renewed. Here we present a stochastic model of the homeostatic nature of bone remodeling, where osteoclasts perform bone resorption which is equally balanced by bone formation performed by osteoblasts. The stochastic model is embedded in a process-algebraic specification based on the Shape Calculus, which provides an effective multiscale description of the process. Our model considers increasing dimensionality from RANKL molecular signaling to osteoclast/osteoblast
stochastic dynamics within a basic multicellular unit (BMU) to bone mass formation. We show that after a micro-fracture the simulated bone remodeling dynamics is timescale consistent with the biological process. Our combined methodology provides a first effective stochastic model of the bone remodeling framework which could be used to test healthy and pathological conditions.
Keywords: process algebra in biomechanics, Shape Calculus, BMU, bone remodeling, dynamics.

Introduction
Leonardo da Vinci’s famous painting of the Vitruvian man was made on the basis of a study of the proportions of the human male body by the ancient Roman ar-

1 Email: pl219@cam.ac.uk
2 Email: emanuela.merelli, nicola.paoletti@unicam.it
3 Email: viceconti@tecno.ior.it

1571-0661 © 2011 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2011.09.034

chitect Vitruvius in Book III of his treatise De Architecture. Following Vitruvius, in Leonardo’s drawing the length of a man’s outspread arms is equal to his height. The distance from the elbow to the tip of the hand is a quarter of a man’s height. The distance from the elbow to the armpit is one-eighth of a man’s height.
Our three dimensional shape is mainly modeled by our muscle-skeletal setting; given that bone remodeling occurs asynchronously at various sites, how the limb size and shape is controlled is a long-standing question in developmental biology. What it is known is that load-induced strains applied to bone can stimulate its de- velopment and adaptation. However, we have only little insights of the mechanisms involved in bone formation occurring at sub centimeter to micron scales.
Bone remodeling is a multiscale phenomenon, since macroscopic (tissue) and microscopic (cellular) levels are closely interdependent [12]. At the scale of single cells, the process of bone formation has in the past been viewed as a passive process where the specific cells that build new bone, the osteoblasts, become trapped or buried in the osteoid, which then passively mineralize [12]. Recent findings suggest that osteocytogenesis may actually be an active rather than a passive process but the precise mechanisms by which an osteoblast becomes buried in bone matrix and changes into an osteocyte remain elusive [10].
We believe that computational modeling could be very helpful in shedding some light across the intrinsic difficulties of integrating evidence obtained from experi- ments and observations spanning different scales of time and space.
Here we integrate two powerful computational modeling approaches: one de- veloped in Biology, the Systems Biology framework; and the other in Computer Science, the Shape Calculus [2,1] approach which belongs to the formal specifica- tion domain. Systems Biology is the study of the interactions occurring at different scales between the components of biological systems, and how these interactions give rise to the function and the behavior of that system. While the past reductionist approach focuses on studying finer and finer details of single components, Systems Biology is about putting together rather than taking apart, integration rather than reduction. The Shape Calculus provides the actual methodology to bridge the scales through a high to low level procedure.
The value of using a multiscale modeling approach in bone remodeling could go beyond the study of the mechanisms involved in the biological process and may scale up to represent an important predictor for bone strain in response to dynamic loading and dynamics of fragility (osteoporosis). The information obtained from our approach could be useful in clinical applications including testing treatments at different scales to prevent bone fragility or to accelerate fracture healing.
The paper is organized as follow. Section 2 introduces the main actors and the key events in the bone remodeling (BR) process and highlights the stochasticity and discreteness in the behavior of the system. Section 3 recalls and extends the Shape Calculus and provides an algebraic specification of the BR modeling. The implementation of stochastic rules for cells are defined in Section 4. In Section 5, we present the results of the simulation carried out with the Repast Symphony Suite. The paper concludes with a discussion of related and future work in Section 6.

Mechanics of bone remodeling
There are two main types of bone: 1) Compact tissue which forms the outer shell of bones. It consists of a very hard (virtually solid) mass of bony tissue arranged in concentric layers (Haversian systems); 2) Cancellous (also known as “spongy”) tissue which is located beneath the compact bone and consists of a meshwork of bony bars (trabeculae) with many interconnecting spaces containing bone marrow. In the process of bone remodeling (BR), old bone is continuously replaced by new tissue [9]; this ensures that the mechanical integrity of the bone is maintained and, in healthy conditions, there are no global changes in the morphology. How- ever, pathological conditions can alter the equilibrium between bone resorption and bone formation. Osteoporosis is an example of negative remodeling: the resorption process prevails on the formation one and this reduces bone density, so increasing the risk of spontaneous fractures. Hence, the definition of faithful models for BR
has a high social and clinical relevance in the prediction of bone diseases [5].
The bone remodeling process is conducted by osteoclasts and osteoblasts, forming Basic Multi-cellular Units (BMUs). Osteoblasts follow osteoclasts in a highly coor- dinated manner indicates that a coupled regulative mechanism must exist. It was suggested [7] that the BMU activity is controlled by osteocytes in the bone matrix, serving as mechanosensors, and sending signals through the osteocytic canalicu- lar network to the BMU cells. Each BMU has a finite lifetime, so new units are continuously forming as old units are finishing [7].
In normal bone, the number of BMUs, the bone resorption rate, and the bone formation rate are all relatively constant [12]; while the key events during the BR could be summarised as below:
the RANKL/RANK signaling regulates osteoclast formation, activation and sur- vival in normal bone modeling and remodeling and in a variety of pathologic conditions characterized by increased bone turnover. Osteprotegerin (OPG) pro- tects bone from excessive resorption by binding to RANKL and preventing it from binding to RANK. The relative concentration of RANKL in bone is a major determinant of bone mass and strength [6].
osteoclast precursors, the pre-osteoclasts, circulate in the blood vessels. If a new crack appears, the osteocytes near the crack undergo apoptosis. The other osteo- cytes in the canalicular network detect the strain and send biochemical signals toward the fluid part of the BMU.
osteoblast precursors, the pre-osteoblasts, start to express RANKL on their sur- faces. Pre-osteoclasts have RANK receptors on their surfaces.
the lining cells around the bone pull away from the bone matrix and form a canopy which merges with the blood vessels.
the pre-osteoclasts enlarge and fuse into mature osteoclasts.
in cortical BMUs, osteoclasts excavate cylindrical tunnels in the predominant loading direction of the bone. They are followed by osteoblasts, filling the tunnel, and creating secondary osteons of renewed tissue.

the trabecular bone remodeling is mainly a surface event, in which osteoclasts dig a trench rather than a tunnel.
The key observation we have done is that cells do not vary continuously and deter- ministically. They vary stochastically and discretely.
A stochastic modeling approach may also provide a better fit to the experimental data which have also a noise component. The multiscale nature of the process is rendered through the combination of a low level stochastic approach to a high level algebraic approach. We believe that the stochastic modeling results more biologically sound than previously presented continuous models [13,8] due to the discrete nature of the process. The algebraic approach finds its reasoning in the global (i.e. high level) control that affects the shape and size of the bones, which inspired the Vitruvian man.
The modeling of BMUs and the above described events are described in the next sections.
Bone remodeling Specification in Algebraic Shape Calculus
We can imagine the Shape Calculus as a set of high-order levers that pull the implemented low-order procedures. It is important to note the analogy between the high scale bone tissue and low scale molecules and cells with respect to the Shape Calculus and its low level implementation.
The BMU represents the emerging behavior of the collective action of osteoclasts and osteoblasts and it is the primary building block of the tissue. Here we investigate the emerging behavior of connecting the Shape “high levers” (the tissue) with the low lever sort of gear-bevel, spur-lever, helical gear constituents (the cells).
Noteworthy, from a methodological perspective this implementation introduces function and structure in a meaningful multi scale framework. This framework can explain how apparently “normal” behavior of the cells could generate small differences in the collective behavior of the BMU that could scale up to significant disruptions at the tissue level. Similarly, it can be understood how little differences in the levers connecting the Shape Calculus procedures and the low level procedures can lead to bone pathologies.
In the following, we introduce the Shape Calculus [2,1], a bio-inspired spa- tial process calculus for describing 3D processes moving, colliding and interacting in a three-dimensional space.
In the Shape Calculus, a 3D process is characterized by:
a 3D shape S, specified as a tuple ⟨V, m, p, v⟩ (geometry, mass, position, velocity). The set of shapes S is generated by the following grammar:
S ::= σ | S⟨X⟩S
where X is the contact surface over which two shapes can composed.



Table 1
SOS rules for the temporal behavior of a shape.

a behavior B, specified ina Timed CCS-like syntax [14]. The set of shape behav- iors B is generated by the following grammar:
B ::= nil | ⟨α, X⟩.B | ω(α, X).B | ρ(L).B | ϵ(t).B | B + B | K
where ⟨α, X⟩∈C is a channel characterized by a name α and a contact surface X; C is the set of channels; ϵ(t) is the time-delay action; K is a process name; ω and ρ are weak-split (not-urgent) actions and strong-split (urgent) actions, respectively; and L ⊆C is a subset of channels enabled to split. The sets of weak-split actions and strong-split actions are denoted with ω(C) = {ω(α, X)|⟨α, X⟩ ∈ C}, and ρ(C)= {ρ(α, X)|⟨α, X⟩∈ C}, resp.
Definition 3.1 (3D processes) The set 3DP of 3D processes is generated by the following grammar:
P ::= S[B] | P⟨α, X⟩P
where S is the shape of P , B its behavior. Two 3D processes can bind and interact through ⟨α, X⟩ i.e. a non-empty contact surfaces X of type α.
Definition 3.2 (Networks of 3D processes) The set N of networks of 3D processes
is generated by the grammar:
N ::= Nil | P | N  N
where P ∈ 3DP.
Shapes move according to their velocities that are determined by a general mo- tion law - for instance as in a force field or Brownian motion - and by the collisions occurring among shapes. In the case of inelastic collisions, objects can bind and become a compound new object with a new shape and possibly a different behavior. Established bonds can also be broken by performing a split operation. The composi- tion of compatible 3D processes is modeled in a similar way to CCS communication on complementary channels.
Table 1 and Table 2 show the Structural Operational Semantics (SOS) for the behavioral terms of the Shape Calculus. For further details on the syntax of the calculus and on the semantics of 3DP- and N- terms, we address the interested reader to papers [1,2].



Table 2
SOS rule for the functional behavior of a shape




SO[BO']< a, Z >S1[B1']
(b)


(a)
(c)


Fig. 1. An example of binding and subsequent split of two 3D processes. Processes S0[B0] and S1[B1] expose channel ⟨a, X⟩ (blue) and ⟨a, Y ⟩ (red), respectively. After a collision, they bind and start behaving
as B′ and B′ . Eventually the composed processes break up the bond, supposed that they can synchronize
0	1
on a split action.


Figure 1 illustrates the collision and interaction between two 3D processes S0[B0] and S1[B1]. The dark (blue) and bright (red) parts of respectively S0 and S1 represents the channels exhibited to the environment. Channels act as binding sites and are of the form ⟨a, X⟩, where a is the channel name and X is the active surface.
In this example, S0 exposes the channel ⟨a, X⟩, and S1 the channel ⟨a, Y ⟩. If a collision occurs (Figure 1 (a)), the two processes bind together on the complemen- tary channels a and a. The resulting process Figure 1 (b) is S0[Bj ]⟨a, Z⟩S1[Bj ],
0	1
where Z represents the common surface of contact between X and Y . If the chan-
nels were not compatible (complementary), the collision would have been treated as elastic. The right hand side of the Figure 1 (c) depicts the system after a split of the previously composed object.
In addition, we enriched the language of the Shape Calculus with some new features, which are discussed below.
Iteration.
We express iterative behaviors, with a finite or infinite number of repetitions, by

the notation (B)k, where B ∈ B:
⎧ B.(B)k	if k = ∞
(B)k ≡ ⎨ B.(B)k−1	if k > 0, k ∈ N
⎪⎪⎩ nil	if k = 0, k ∈ N
On the one hand the iterative construct provides a compact form to express finitely repeating behaviors ((B)k,k ∈ N); on the other, it captures infinite behaviors ((B)∞) in a recursive fashion. When B is an atomic term, we will alternatively write Bk without parenthesis.
Thanatos Θ.
Phenomena like necrosis and apoptosis are very common in cellular biology, espe- cially in our model of the BMU. For this reason, we have introduced a new behavioral term Θ such that, when performed by a 3D process S[Θ.B] with S = ⟨V, m, p, v⟩, S becomes a different shape Sj = ⟨{p}, 0, p, (0, 0, 0)⟩; in other words, the new shape has null velocity and mass, and the set of points V is only composed by the center
p. Consequently, we model the death of a 3D process by performing a Θ-action and reaching a nil behavior.
Behaviour duration.
It allows to express the fact that a particular behavior must be executed for a particular time-stamp (e.g. an osteoclast continuously mineralizes bone until its life time has passed). In fact, the term δ(t, B) ∈ B has the following meaning: until t > 0, B is performed; once t = 0, δ(t, B) ≡ nil.
The operational semantics of the above-described terms is illustrated in Table 3.

Table 3
SOS rules for temporal and functional behavior of Θ and δ terms.

Table 4 displays the formal specification of the BMU model in this extended version of the Shape Calculus. In particular, we made no assumptions on the binding surfaces, by assuming that each shape exposes its whole surface for each channel. Hence, whenever we refer to a surface X of a shape S, we actually consider the boundaries of S. Table 5 groups the parameters of our model.
Implementation of stochastic rules for cells
Living cells are complex mixtures of a variety of complex molecules that are con- stantly undergoing reactions with one another.


Table 4
Biological description and Shape Calculus specification

Table 5 Model parameters


It has been shown that stochastic fluctuations play a key role in biological processes, both at the molecular level, where low intracellular copy numbers of molecules can fundamentally limit the precision of gene regulation e.g. in gene expression dynamics [3], and at the macroscopic level, e.g. driving the cells’ phe- notypic state. The statistical fluctuations in RANKL concentrations will produce changes in the chemotaxis, i.e. the process by which cells move toward attractant molecules, of osteoclasts and osteoblasts (for example, the cell differentiation, num- ber and arrival time). Other important sources of variability are related to the time and space organization of the BMU; to the availability of molecules required for building the bone; to the regulatory feedback control; and to the mechanical

boundary conditions [4].
Keeping in mind that the stochastic and the algebraic form two distinct layers, the simulation environment proposed in this work considers both qualitative and quantitative aspects. Actions performed by the agents are equipped with a stochas- tic rate. This rate characterizes a random variable with a negative exponential distribution, modeling the duration of the action itself.
In addition, agents executing output bind actions can detect also compatible input actions at distance. In this way, we can model agents with a perception of the neighborhood, differently from the Shape Calculus where binding between two 3D processes can exclusively happen when they share a common surface of contact. In particular, given two agents A1 and A2, we define the minimum translational distance d(A1,A2) between A1 and A2 as the length of the shortest relative translation necessary to have their surfaces in contact. Then, an output bind action is equipped with a so-called sensibility distance dsens ∈ R such that the corresponding agent A1 can detect input actions of another agent A2 if d(A1,A2) is at most dsens.
As expected, longer distances lead to longer action durations. In fact, the dura-
tion of a bind action depends not only on the stochastic rate, but also on the actual distance from the binding agent.

Results
The simulator for our BMU model has been implemented in the Repast Symphony Suite [11], an agent-based modeling and simulation platform written in Java. In particular, we have developed a library which allows the specification of Repast agents in a Shape Calculus-like syntax. In this way, given the formal model, the implementation is quite straightforward and requires only to focus on setting motion laws and stochastic rates.
The movement of an osteoclast is the combination of a random walk and of the RANKL attraction. For our purposes, we can assume that osteocytes near the fracture produce RANKL. In other words, the movement of osteoclast is determined by the concentration gradient of RANKL signals exposed by both osteocytes and osteoblasts.
Similarly, the motion of osteoblasts is regulated by random movements and by attraction factors. Osteoblasts are directed towards the nearest point where a dead osteoclast is present, thus ensuring that each absorbed zone of the bone surface will be mineralized. Furthermore, we assume that osteoblasts are recruited only after that the RANKL concentration that depends on osteocytes’ signaling, goes below a fixed threshold.
Figure 2 illustrates three snapshots of the system, taken at:
t = 10: the first osteoclasts (yellow spheres) attach to osteocytes (pink) along the micro-fracture and begin consuming the bone surface, forming the black cavities in the second row.
t = 190: osteoblasts (purple spheres) start mineralizing cavities; in this phase, the



Fig. 2. Model simulation. The first row shows the spatial organization of the BMU; the second row displays the values of bone density; the third row illustrates the RANKL vector field.

production of RANKL is prominent, because of the high number of osteoblasts in the BMU.
t = 330: the micro-damage has almost been repaired; RANKL signaling becomes less relevant, as the presence of osteoblasts decreases.
Note that the top row could in principle tell us the location and directionality of the cells, i.e. the directions of growth of the bone (forming trabecules) which, ultimately, affect the direction of the strength and the resistance of the newly formed bone. The middle row describes the increase in bone mass and its position; the analysis of the figures could tell the advancement in healing a micro-fracture (or the state of the osteoporosis following a treatment). The bottom row describes the dynamics of the RANKL signal which is the ultimate driving force for the overall process.
Although we have kept the graphics very basic, post-processing and advanced visualization will be implemented in a near future. Numeric data are available from the authors.
Figure 3 shows the cumulative amount of bone resorption and formation during the BMU life cycle. In the first 200 days, the resorption activity decreases from its initial values, since osteocytes are being consumed, so weakening the overall RANKL signaling. Osteoblasts are recruited at about t = 200. Their presence


Cumulative bone activity
2.5




2




1.5


1




0.5




0
0	50	100  150  200  250  300  350  400  450  500
Time [days]
Fig. 3. Cumulative bone activity


affects the behavior of the osteoclasts in two ways: on the one hand, they release RANKL which promotes osteoclastic activity; on the other hand, osteoblasts and osteoclast tend to inhibit each other when acting in near positions. This can explain the natural coordination between osteoclasts and osteoblast. Similarly, osteoblastic activity is fluctuating, but always with high values of bone formed per day.


Conclusions and future directions
In conclusion, we are delighted to report that the modeling and simulation of the bone remodeling process is an important field of research. It has two immediate and remarkable benefits: the improved understanding of the process that shape skeletal homeostasis at different scales and the possibility to test engineering intervention to counteract pathologies that perturb the remodeling.
With respect to the most important current efforts in bone remodeling [13,8], which are based on continuous mathematics, our methodology linking stochastic modeling and algebraic formulation provides both biologically meaningfulness and methodological novelties.
We aim at incorporating details of the intracellular pathway network, and use fracture-risk population statistics. Another avenue for future research we are ac- tively pursuing is the search for proving at run time properties. Assuming that we know the conditions of the systems (cells densities, metabolites etc), the conditions of the system that could be identified through medical investigations, we aim to verify properties such as “How long, from the a current state, will the system take to repair a fracture?”, “Given a local density Φ of bone, does Φ holds in all the system within time t and with probability p?”

References
E. Bartocci, D. Cacciagrano, M. Di Berardini, E. Merelli, and L. Tesei. Timed Operational Semantics and Well-Formedness of Shape Calculus. Scientific Annals of Computer Science, 20, 2010.
E. Bartocci, F. Corradini, M. Di Berardini, E. Merelli, and L. Tesei. Shape Calculus. A Spatial Mobile Calculus for 3D Shapes. Scientific Annals of Computer Science, 20, 2010.
M. Elowitz, A. Levine, E. Siggia, and P. Swain. Stochastic gene expression in a single cell. Science, 297(5584):1183, 2002.
D. Epari, G. Duda, and M. Thompson. Mechanobiology of bone healing and regeneration: in vivo models. Proceedings of the Institution of Mechanical Engineers, Part H: Journal of Engineering in Medicine, 224(12):1543–1553, 2010.
X. Feng and J. McDonald. Disorders of Bone Remodeling. Annual review of pathology, 2010.
R. Hanada, T. Hanada, and J. Penninger. Physiology and pathophysiology of the RANKL/RANK system. Biological Chemistry, 391(12):1365–1370, 2010.
G. Karsenty and F. Oury. The central regulation of bone mass, the first link between bone remodeling and energy metabolism. Journal of Clinical Endocrinology & Metabolism, 95(11):4795, 2010.
S. Komarova, R. Smith, S. Dixon, S. Sims, and L. Wahl. Mathematical model predicts a critical role for osteoclast autocrine regulation in the control of bone remodeling. Bone, 33(2):206–215, 2003.
S. Manolagas and A. Parfitt. What old means to bone. Trends in Endocrinology & Metabolism, 21(6):369–374, 2010.
K. Nakahama. Cellular communications in bone homeostasis and repair. Cellular and molecular life sciences, pages 1–9, 2010.
M. North, T. Howe, N. Collier, and J. Vos. A Declarative Model Assembly Infrastructure for Verification and Validation. In Advancing Social Simulation: The First World Congress, pages 129–140. Springer Japan, 2007.
L. Raggatt and N. Partridge. Cellular and molecular mechanisms of bone remodeling. Journal of Biological Chemistry, 285(33):25103, 2010.
M. Ryser, N. Nigam, and S. Komarova. Mathematical Modeling of Spatio-Temporal Dynamics of a Single Bone Multicellular Unit. Journal of bone and mineral research, 24(5):860–870, 2009.
Y. Wang. Real-time behaviour of asynchronous agents. CONCUR’90 Theories of Concurrency: Unification and Extension, pages 502–520, 1990.
