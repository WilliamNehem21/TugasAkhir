Electronic Notes in Theoretical Computer Science 106 (2004) 243–259 
www.elsevier.com/locate/entcs


Coalgebras and Modal Expansions of Logics
Alexander Kurza	Alessandra Palmigianob
a University of Leicester
b Universitat de Barcelona

Abstract
In this paper we construct a setting in which the question of when a logic supports a classical modal expansion can be made precise. Given a fully selfextensional logic S, we find sufficient conditions under which the Vietoris endofunctor V on S-referential algebras can be defined and we propose to define the modal expansions of S as the logic that arises from the V-coalgebras. As an example, we also show how the Vietoris endofunctor on referential algebras extends the Vietoris endofunctor on Stone spaces.
From another point of view, we examine when a category of ‘spaces’ (X, A), ie sets X equipped with an algebra A of subsets of X, allows for the definition of powerspaces V (and hence transition systems (X, A) → V(X, A)).
Keywords: Modal logic, modal expansion, Vietoris endofunctor, coalgebra, Stone space.

Introduction
The problem studied in this paper can be explained and motivated from rather distinct perspectives.

The Coalgebraic Motivation
We investigate systems whose state space can be described by a set X together with an algebra A of subsets of X. We think of the elements of A as the admissible predicates over X (or the observations that can be made of states in X). The operations of the algebra reflect the ability to built new observations from given ones using logical connectives. This interpretation, as well as the analogy with topological spaces, suggest to call these structures
logical spaces. In algebraic logic they are known as referential algebras.


1571-0661 © 2004 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2004.05.010


A transition relation can be considered as a map assigning to a state in X the set of its successors. The coalgebraic perspective suggests that we should look for a functor V on the category of logical spaces that allows us to represent systems as morphisms
(X, A) → (VX, VA).
VX will be a subset of the full powerset PX. In order to see what the ad- missible predicates VA on VX should be, we focus on the following two basic observations one can make about a subset v ∈ VX using an admissible set
a ∈ A: whether all elements of v are contained in a, and whether there exists
an element of v contained in a. This leads us to the following basic admissible predicates on VX:
  a = {v ∈ VX | v ⊆ a} and   a = {v ∈ VX | v ∩ a /= ∅}.
This choice of basic admissible predicates is well known in topology and do- main theory where (VX, VA) is known as the Vietoris space or the Plotkin powerdomain. To see under which circumstances this construction can be generalized from topological spaces is one of the aims of this work.
The construction of VX is well-known and presented in Section 3. The main contribution of this paper consists in giving a construction of VA. This construction is motivated by the logical interpretation of referential algebras as models for selfextensional logics and uses the duality theory for selfextensional logics.

Selfextensional Logics
One of the major conceptual achievements in philosophical logic is the Fregean distinction between sense and reference, which is captured in the for- mal distinction between the intensional and the denotational approaches in defining the semantics of logical languages. In a denotational approach, the semantics of formulas is given by their truth values (denotation). The deno- tational approach is adequate only for those logics for which the substitutivity principle holds, i.e. those logics such that any two sentences with the same truth value can be substituted for one another without altering the truth value of the result. The substitutivity principle does not hold for intensional logics of which modal logic is perhaps the best known example. In any intensional
approach, semantic structures are always based on sets of states, or ‘possible worlds’, X, so that any formula ϕ takes its denotation (truth value) at every possible world. Then φ is interpreted as a predicate by mapping it to the subset of the possible worlds at which it is true. This set is often called the
intension of ϕ. The substitutivity principles holds not for formulas with the
same denotation in a given world but for formulas with the same intension,


i.e. with the same denotation in every possible world. Kripke structures are perhaps the best known example of intensional semantics.
Compositionality is a basic requirement in both the denotational and the intensional approaches to semantics. As it is well known, the denotational approach accounts for compositionality by endowing the set of truth values with an algebraic structure: The paradigmatic example is the Boolean algebra 2, where the truth value of the compound formula ϕ Λ ψ can be computed from the truth values of ϕ and ψ.
Likewise, accounting for a compositional semantics in any intensional set- ting means to endow (a selected subset of) У(X) with an algebraic structure, so that the intension of the compound formula ϕ Λ ψ can be computed from the intensions of ϕ and ψ (and more often than not there are further require- ments on the definition of the operations: for instance, that the intension of
ϕ Λ ψ coincides with the intersection of the intensions of ϕ and ψ, and so on). General frames for modal logic are a typical example: they are defined as triples (X, R, A), where X is a nonempty set of states, R ⊆ X × X and A is a subalgebra of the Boolean algebra У(X).
In algebraic logic, the intensional approach to semantics is treated in a gen- eral setting that abstracts away from the particular similarity type of logics: for every algebraic similarity type τ , the semantic structures for τ -logics are
referential algebras, i.e. tuples (X, A) such that X /= ∅ and A is a τ -algebra of subsets of X (that is not required to be a subalgebra of У(X)). Selfex- tensional logics where characterized by Wo´jcicki as the logics that are sound
and complete w.r.t. their corresponding class of referential algebras. One of their features is that any two formulas are interderivable if and only if they are mapped to the same subsets in any referential algebra. Thus for selfexten- sional logics, interderivability captures the identity of meaning (intension), in a compositional way. Since referential algebras, that are the canonical seman- tic structures for selfextensional logics, can be regarded as abstract versions of general frames, selfextensional logics can be loosely thought of as generalizing modal logics. On the other hand, many logics that are neither modal nor intensional, like classical and intuitionistic propositional logics, are selfexten- sional as well. This paper is the starting point of a line of investigation that aims at a better understanding of the relation between selfextensional logics and modalities.

The Logical Motivation
The general way in which modal logics are investigated from an algebraic perspective is to regard modal operators as expanding an underlying logical signature.  We take the converse perspective and ask ‘When does a given

selfextensional logic S support modalities?’ Our aim is to set a context in which this question can be made precise, i.e. to define a general theory of modal expansions of selfextensional logics so that the operators of the modal expansions have predetermined semantics and properties. In this paper we are focusing on expanding a logic with modal operators and , that are normal and interrelated like in the modal logic K. So we are going to define the modal expansion of a logic as the logic that canonically arises from the semantic structures that we purposely construct to force the required semantics and properties.
We construct these structures as coalgebras for the Vietoris endofunctor V on the category of referential algebras associated with S, the S-referential algebras. In their turn, the V-coalgebras so obtained can be represented as referential algebras of the modally expanded similarity type: indeed, a V- coalgebra is a set map ρ : X −→ VX such that ρ−1 ∈ Hom(VA, A). Then ρ will correspond to the referential algebra (X, A'), where A' is the modal expansion of A associated with ρ−1 ∈ Hom(VA, A). The modal expansion of S will be defined as the logic that arises from this class of referential algebras.
We propose to say that a selfextensional logic S supports classical modalities if its modal expansion can be constructed as sketched above.


Duality Theory
The main contribution of this paper is the construction of the Vietoris end- ofunctor on S-referential algebras. One natural question is how this construc- tion is related with the Vietoris endofunctors on certain classes of topological spaces that are known from the literature, like the Vietoris endofunctors on Stone and Priestley spaces. There is a natural way in which this construction extends the known ones, and it is based on the fact that those topological spaces can be represented as referential algebras. Indeed, the categories of those topological spaces are isomorphic to full subcategories of referential al- gebras, in such a way that the following diagrams commute:

Stn
⏐ 
RAS
−−K−→  Stn
⏐ 
−−V−→ RA
Pri
⏐ 
RAS
−−V−→	Pri
⏐ 
−−V−→ RA .

These embeddings are part of a more general picture that is brought about by the duality theory for selfextensional logics, briefly presented in 2.2. This theory consists of two parts: the first part defines a duality between categories of models of the same selfextensional logic S, namely between the atlases, that provide the algebraic semantics for S according to the theory of Abstract Al-


gebraic Logic, and the S-referential algebras. This duality is shaped around logic, for atlases and referential algebras correspond to one another in such a way that their logical content is integrally preserved. The key feature of this duality is that its logical import is in-built it its definition. The second part is about how this duality uniformly extends a wide class of known du- alities, which includes the Stone and Priestley ones. The involved categories of algebras and topological spaces are shown to be respectively isomorphic to categories of atlases and referential algebras, in such a way that the duality functors are lifted too, and as the logical import of the duality for atlases and referential algebras is given by definition, this embedding provides a way to make the logical interpretation of the embedded dualities explicit and uniform. This comes as no surprise: the logical import of dualities has been widely recognized in the literature by showing their systematic connections with soundness and completeness theorems, and dualities have been widely used in the literature to give a logical interpretation to set-based structures such
as topological spaces and coalgebras.
The duality theory for selfextensional logics plays a crucial role in the setting that we present here. The novelty is that this duality is not used to give a logical interpretation to independently defined set-based structures:
it is used to deﬁne the set-based structures from the logic that we want to
modally expand, and from the predetermined semantics and properties of the modal expansion.

Related Work
This work is set in the context of abstract algebraic logic (AAL) and du- ality theory. The monograph [2] provides a detailed account of the basics of AAL. The book [4] is the standard reference for the basics of duality theory. The duality theory for selfextensional logics is developed in [7]. The character- ization of selfextensional logics in terms of referential algebras appears in [11] and [12]. Coalgebras of Vietoris endofunctors on Stone and Priestley spaces are shown to be adequate semantic structures for the modal logics K and
PML respectively in [6] and [8]. Analogous but partial results for some modal
intuitionistic logics can be found in [9]. The description of VA in Section 4 owes a lot to the Vietoris locale defined in [5]. The theories of Natural Duali- ties, developed in [1] and of Bounded Lattice Expansions [3] will be relevant
to further developments of this work (see also discussion in Section 6).

Acknowledgements
This paper was written during a visiting period of the second author to the Department of Computer Science of the University of Leicester. The


second author wishes to thank the research group of Computer Science of the University of Leicester for their hospitality, and for partially funding her stay. We would like to thank Ramon Jansana for reading preliminary versions of this work and for many useful comments.

Preliminaries on Selfextensional Logics
Throughout this section, τ is an algebraic similarity type, A is a τ -algebra and A is its carrier, Fm is the free τ -algebra (of formulas) over a given set of variables Var , S = (Fm, ▶S) is a τ -consequence relation, H = (W, A) is a τ -referential algebra, X is the domain of H and Q = (A, B) is a τ -atlas.

Basic Concepts
A τ-consequence relation is a pair S = (Fm, ▶S ), where Fm is the τ -algebra of formulas over a given set of variables and ▶S ⊆ У(F m) × Fm such that for all Γ ∪ {ϕ}⊆ F m,
If ϕ ∈ Γ then Γ ▶S ϕ.
If Γ ▶S ϕ and Γ ⊆ ∆ then ∆ ▶S ϕ.
If Γ ▶S ϕ and for every ψ ∈ Γ ∆ ▶S ψ, then ∆ ▶S ϕ.
If T ⊆ Fm is closed under ▶S , i.e. if T ▶S ϕ then ϕ ∈ T for every ϕ ∈ F m, then T is a theory of S, or an S-theory. T h(S) is the set of the S-theories. S is ﬁnitary iff for all Γ ∪ {ϕ}⊆ F m, if Γ ▶S ϕ then ∆ ▶S ϕ for some finite set
∆ ⊆ Γ. S is structural iff for all Γ ∪ {ϕ} ⊆ F m, for all σ ∈ Hom(Fm, Fm), if Γ ▶S ϕ then σ[Γ] ▶S σ(ϕ). A sentential logic is a finitary and structural consequence relation. The interderivability relation of S is the equivalence relation E▶S = {(ϕ, ψ⟩∈ Fm×Fm | ϕ ▶S ψ and ψ ▶S ϕ}. S is selfextensional iff E▶S is a congruence of Fm.
For every τ -algebra A and every F ⊆ A, F is an S-filter iff for every h ∈ Hom(Fm, A) and every S-sequent Γ ▶S ϕ, if h[Γ] ⊆ F then h(ϕ) ∈ F . F iS(A) is the collection of the S-filters of A. FiS(Fm) = T h(S). S is fully
selfextensional iff for every algebra A, the Frege relation ΛS = {⟨a, b⟩ | a ∈ F
iff b ∈ F for every F ∈ FiS (A)} is a congruence of A. The Frege relation on Fm is E▶S . If S is fully selfextensional, then A is an S-algebra iff ΛS is the identity relation. For example, if S is classical propositional logic, then Boolean algebras are the S-algebras. For every fully selfextensional logic S
and every algebra A, A/ΛS is an S-algebra. Let q : A −→ A/ΛS be the associated canonical projection.
Remark 2.1 For every logic S that is fully selfextensional, and every h ∈
Hom(A1, A2), the assignment q1(a) '→ q2(h(a)) defines a homomorphism qh ∈


Hom(A1/ΛS , A2/ΛS).
Proof. For every h ∈ Hom(A1, A2) and every F ∈ FiS(A2), h−1(F ) ∈ F iS(A1). Therefore, ⟨a, b⟩ ∈ ΛS (A1) implies that ⟨h(a), h(b)⟩ ∈ ΛS (A2), and from this it follows that qh is well defined. The rest is routine.	 
As a consequence of this remark, Fm/ E▶S is the free S-algebra.

Models for Selfextensional Logics and Duality
A τ-referential algebra is a pair H = (X, A) where X is a nonempty set and A is a τ -algebra of subsets of X. H is differentiated iff for every a, b ∈ X, if a ∈ Y iff b ∈ Y for every Y ∈ A, then a = b. The consequence relation induced by H is defined as follows: For every Γ ∪ {ϕ} ⊆ F m, Γ |=H ϕ iff for every h ∈ Hom(Fm, A),  γ∈Γ h(γ) ⊆ h(ϕ). H is an S-referential algebra iff ▶S ⊆ |=H. The consequence relation |=H is structural and selfextensional
by construction. Conversely, if S is selfextensional, then there exists a DRA H such that ▶S = |=H. For every H = (W, A) and H' = (X', A'), h ∈ Hom(H, H') iff h ∈ Set(X, X') and h−1 ∈ Hom(A', A). h ∈ Hom(H, H') is
strict iff h−1 ∈ Hom(A', A) is onto.
A τ -atlas is a pair Q = (A, B) such that A is a τ -algebra and B is a collection of subsets of A. The Frege relation of an atlas Q is the equivalence relation ΛQ = {⟨a, b⟩ ∈ A × A | for every B ∈ B, a ∈ B ⇔ b ∈ B}. Q is Fregean iff ΛQ is a congruence of A. Q is Frege-reduced (FRA) iff ΛQ is the identity relation on A. If Q = (A, B) is Fregean then the quotient atlas Q∗ = (A∗, B∗), where A∗ = A/ΛQ, B∗ = {B∗ | B ∈ B}, B∗ = p[B] and
p : A → A∗ is the canonical projection, is Frege-reduced. The consequence induced by Q is defined by: For every Γ ∪ {ϕ} ⊆ F m, Γ |=Q ϕ iff for every h ∈ Hom(Fm, A) and for every B ∈ B, if h[Γ] ⊆ B then h(ϕ) ∈ B. Q is an
S-atlas iff ▶S ⊆ |=Q iff B ⊆ F iS (A).
For all Q and Q', h ∈ Hom(Q, Q') iff h ∈ Hom(A, A') and {h−1(B') | B' ∈ B'} ⊆ B. h ∈ Hom(Q, Q') is strict iff {h−1(B') | B' ∈ B'} = B. For example, the canonical projection p ∈ Hom(Q, Q∗) is strict and onto.  If
h ∈ Hom(Q, Q') is strict and onto, then |=Q' = |=Q. In particular, if h ∈ Hom(Q, Q') is strict and onto and Q is an S-atlas, then Q' is an S-atlas. Hence, if Q is a Fregean S-atlas, then Q∗ is a Frege-reduced S-atlas.
The dual referential algebra of a Fregean atlas Q = (A, B) is Q+ = (B, A), where A = {a | a ∈ A}, and a = {B ∈B | a ∈ B} for every a ∈ A. Since ΛQ

is a congruence, for every f ∈ τ we can define the operation f A by declaring
f A(a1,... , an) = f A(a1,... , an) for every a1,... , an ∈ A. Q+ is a DRA and
|=Q = |=Q+ . In particular, if Q is an S-atlas, then Q+ is an S-referential algebra. If h ∈ Hom(Q, Q'), then h+ := h−1 ∈ Hom(Q' , Q+). If h is onto,


then h+ is strict, and if h is strict, then h+ is onto.
The dual atlas of H = (X, A) is H+ = (A, X) where X = {x | x ∈ X} and x = {Y ∈A | x ∈ Y } for every x ∈ X. H is an FRA and |=H = |=H+ . In particular, if H is an S-referential algebra, then H+ is an S-atlas. If h ∈ Hom(H, H') then h+ := h−1 ∈ Hom(H'+, H+). If h is onto, then h+ is strict, and if h is strict, then h+ is onto.
These correspondences define a dual equivalence between the categories FRA of Frege-reduced atlases and atlas morphisms and the category DRA of differentiated referential algebras and referential algebra morphisms.
A feature of this duality is that a wide class of dualities for categories of algebras that have a distributive lattice part can be uniformly “embedded” in it. This is the case of the Stone and Priestley dualities, as well as the case of
the duality for BAO’s and descriptive general frames. For example, for every Boolean algebra (BA) A, let QA = (A, Ultr(A)), where Ultr(A) is the set of the ultrafilters of A, and for every Stone space X = (X, Ω), let HX = (X, A) where A is the BA of the clopen subsets of X. These assignments define two covariant, faithful and full functors Q... : BA −→ FRA and H... : Stn −→ DRA, such that Hom(A, A') = Hom(QA, QA' ), Hom(X, X') = Hom(HX, HX' ), and the following diagrams commute:

BA
Q...⏐
−−F−→  Stn
H...⏐
Stn
H...⏐
−−G−→  BA
Q...⏐

()+	()+

FRA
−−−→ DRA
DRA
−−−→ FRA.

Modally Closed Subsets
As mentioned in the introduction, we want to define a functor V on referential algebras such that a V-coalgebra

ξ : (W, A) −→ (VW, VA)

consists of a transition relation ξ : W → VW ⊆ УW and an algebra VA whose elements interpret formulae that can be built from the predicates in A and the classical modal operators and . That is, for all U ∈ A, VA will contain the sets

 U = {X ∈ VW | X ⊆ U } and   U = {X ∈ VW | X ∩ U /= ∅}.

Then, given (W, A), ξ : W → VW and U ∈ A we obtain the classical semantics of   and   via w H  U  ⇔ ξ(w) ∈  U and w H  U  ⇔ ξ(w) ∈  U .


From a logical point of view, we expand the signature of A with two modal operators with the semantics determined as above.
This section focuses on the definition of VW which is independent of the algebraic signature. We also describe VA in case of the empty algebraic sig- nature.
For every H, we introduce the set of abstract symbols L  (H) = {  U | U ∈
A} and L (H) = {  U | U ∈ A}, and the relation |= given by

X |=  U ⇔ X ⊆ U	and	X |=  U ⇔ X ∩ U /= ∅
for X ⊆ W and U ∈ A. Let Th (X) = { U | X |=  U }, and Th (X) = 
{ U | X |=  U }. Th(X) = (Th (X), Th (X)) is the modal theory of X. X, Y ⊆ W are modally equivalent, (X ≡Th Y ) iff Th(X) = Th(Y ). For Φ ⊆ L , Ψ ⊆ L let [[Φ]] = {U | U ∈ Φ} and [[Ψ]] = W \ {U | U /∈ Ψ}.
The following proposition is immediate.
Proposition 3.1 For all X ⊆ W, Φ ⊆ L , Ψ ⊆ L 
X ⊆ [[Φ]]  ⇔ Φ ⊆ Th (X)
X ⊆ [[Ψ]]  ⇔ Th (X) ⊆ Ψ
Both 1 and 2 above constitute a Galois connection (adjunction) and, writing [[⟨Φ, Ψ⟩]] = [[Φ]] ∩ [[Ψ]] , we can combine them into one Galois connection [[−]] E ⟨Th , Th ⟩



(·)	УW
⟨Th ,Th ⟩

[[·]]
(УL )op × УL 

In particular, (·)  = [[·]] ◦ ⟨Th , Th ⟩, explicitly given as

X  =  {U ∈ A | X |=  U }∩ (W \  {U ∈ A | X |=/  U })

is a closure operator which maps X to the largest modally equivalent set. We call the sets X  the modally closed sets.
Definition 3.2 Let (W, A) be a referential algebra for the empty signature. VW = {X ⊆ W | X = X  }. VA = { U | U ∈ A}∪ { U | U ∈ A}. For f : (W, A) → (W ', A'), we put Vf : VW → VW ', X '→ f [X]  .
It is not difficult to check that (Vf )−1(  U ') =  f −1(U '), (Vf )−1(  U ') = 
  f −1(U '). Hence (Vf )−1 is indeed a map VA' → VA.
Remark 3.3


The restriction to modally closed subsets in the definition of the Vietoris functor guarantees that differentiated referential algebras are mapped to differentiated ones.
Since this power construction based on modally closed subsets is standard in topology and domain theory, we would like to mention some relevant topological notions in the context of referential algebras H = (W, A).
The specialization order is given by

w ≤ w' ⇔ ∀a ∈ A . w ∈ a ⇒ w' ∈ a.

≤ is a preorder. H is differentiated if ≤ is a partial order. Every admissi- ble set (ie every element in A) is upper. 1 In fact, ≤ is the largest relation on W such that all admissible sets are upper. Upper sets coincide with the closure of the admissible sets under arbitrary unions and intersec- tions. A set is saturated if it is an intersection of admissible sets; open
if it is a union of admissibles; closed if it is a complement of an open.
The sets [[Φ]] coincide with the saturated sets and the sets [[Ψ]] with the closed sets. That is, a set is modally closed iff it is the intersection of a saturated and a closed set. In domain theory saturated and upper sets coincide and modally closed sets are rather called convex sets or lenses.

The Vietoris Functor for Referential Algebras
In this section, we assume a fully selfextensional logic S. Given an S-referential algebra (W, A), we will construct the Vietoris referential algebra (VW, VA) in the following steps.
Construct the free S-algebra G generated by {  U | U ∈ A}∪ {  U | U ∈
A}.
Define a collection of ‘modal S-filters’ M ∼= VW of G.
Take the quotient (G∗, M∗) of (G, M) w.r.t. the modal S-filters M.

Obtain (VW, VA) as (isomorphic to) the dual (M∗, G∗) of (G∗, M∗).
The first step is possible since S is fully selfextensional. For the second step, we assume that we can find a collection M of S-filters of G, called the modal S-ﬁlters, such that for every F ∈ VW there is a unique MF ∈M satisfying
C1. for every U ∈ A,

  U ∈ MF  ⇔ F ⊆ U	and	 U ∈ MF ⇔ F ∩ U /= ∅,

1 Z ⊆ W is upper if x ∈ Z and x ≤ y implies y ∈ Z.


and the following properties hold for S-atlases Q = ⟨G, M⟩, Q' = ⟨G', M'⟩
(obtained from referential algebras (W, A), (W ', A')) C2. ΛQ is a congruence of G,
C3. every φ : G → G' induced by a referential algebra morphism (W ', A') →
(W, A) is an atlas morphism φ : Q→ Q'.
Roughly speaking C1 guarantees that MF behaves like the modal theory of F , C2 allows us to take the quotient that will be the Vietoris algebra, and C3 takes care that the construction can also be carried out for morphisms.
To complete the second step, we note that, by C1, the map VW → M,
F '→ MF is injective (and hence bijective):
Lemma 4.1 For every F, G ∈ VW, if F /= G, then MF /= MG.
Proof. If F /= G, then we can assume that x ∈ F \ G. Since G is modally closed, there is U ∈ A such that either a) x ∈/ U and G |=  U or b) x ∈ U

and G |=/
  U . If a) then, using that if F /⊆ U then  U
∈/ MF , one shows

that U ∈ MG \ MF . If b) then, using that if G ∩ U = ∅ then  U ∈/ MG, one shows that  U ∈ MF \ MG.	 
For the third step note that, if C2 holds, then we can consider the quotient algebra G∗ = G/ΛQ and the canonical projection p : G −→ G∗. C3 shows that morphisms G → G' induce morphisms G∗ → G'∗:
Lemma 4.2 For every h ∈ Hom(G, G'),
if ⟨a, b⟩∈ ΛQ, then ⟨h(a), h(b)⟩∈ ΛQ' ;
the assignment h∗(a) '−→ p'(h(a)) for every a ∈ G deﬁnes a morphism
h∗ : G∗ → G'∗.
Proof. First, for every M ' ∈ M', if h(a) ∈ M ', then a ∈ h−1(M ') ∈ M, so
⟨a, b⟩ ∈ ΛQ implies that b ∈ h−1(M '), i.e. h(b) ∈ M '. Second, if p(a) = p(b), then ⟨a, b⟩∈ ΛQ, so ⟨h(a), h(b)⟩∈ ΛQ' , i.e. p'(h(a)) = p'(h(b)).	 
Let Q∗ = (G∗, M∗) be the quotient atlas, i.e., M∗ = {M ∗ | F ∈ VW } where
M∗ = p[MF ] for every F ∈ VW . Since p(a) = p(b) only if a ∈ MF ⇔ b ∈ MF , it holds that p−1(p[M ∗ ]) = M ∗ for every F ∈ VW . Therefore p is a strict and
F	F
onto morphism between Q and Q∗, and as Q is a fregean S-atlas, then Q∗ is a Frege-reduced S-atlas. In particular, M∗ is a collection of S-filters of G∗ and
M∗ ∼= M. G∗ can be considered as the Vietoris algebra associated with A.
Finally, consider the dual ⟨M∗, G∗⟩ of (G∗, M∗) which is an S-DRA (since (G∗, M∗) is an S-FRA) and the bijection θ : VW → M∗, F '→ M ∗ . The inverse image map θ−1 : У(M∗V ) −→ У(VW ) restricts to a map Θ : G∗ −→


У(VW ). We define VA to be the image of Θ. The following diagram summa- rizes the construction.

(W, A)	f	(W ', A')


(G, M)
p

(G∗, M∗)
φ	(G', M')
p'
φ	(G'∗, M'∗)


(M∗, G∗)  φ∗−1  (M', G'∗)

θ
(VW, VA)  Vf
θ
(VW ', VA')

Definition 4.3 (Vietoris referential algebra) For every S-referential al- gebra H = (W, A), the Vietoris referential algebra of H is VH = ⟨VW, VA⟩ with VW as in Definition 3.2 and VA given by the inverse image θ−1 as above. For every S-referential algebra morphism f : (W, A) → (W ', A') let φ : G' →G be the algebra morphism induced by f −1 : A' → A and Vf = θ−1 ◦ φ∗−1 ◦ θ.
The interpretation of the modal operators is the intended one:

Proposition 4.4 Θ[p( U )] =  U  and Θ[p(  U )] =  U for all U ∈ A.
Proof. For every F ∈ VW ,


Vf is given by the direct image of f :
Proposition 4.5 Vf (F ) = f [F ]  for all f : (W, A) → (W ', A'), F ∈ VW.
Proof. We elide the isomorphism p[·] : M → M∗.  For all U ' ∈ A' we calculate f [F ]  ⊆ U '  ⇔  f [F ] ⊆ U '  ⇔  F ⊆ f −1(U ')  ⇔   f −1(U ') ∈


MF	⇔  φ( U ') ∈ MF	⇔   U ' ∈ φ−1(MF ) and similarly f [F ]  ∩ U ' /=
∅	⇔	  U ' ∈ φ−1(MF ).  Since φ−1(MF ) in M', it follows from C1 that
φ−1(MF ) = M '	  , that is, θ−1 ◦ φ−1 ◦ θ(F ) = f [F ]  .	 
Example 4.6 Let (W, A) a referential algebra for the empty signature. 2 G is the set { U | U ∈ A}∪ { U | U ∈ A}. For M we choose the subsets satisfying C1.
C2 is trivially satisfied.  For C3, we calculate φ−1(MF ) = {t' ∈ MF ' |
φ(t') ∈ MF } = { U ' |  f −1(U ') ∈ MF }∪ { U ' |  f −1(U ')} = { U ' | F ⊆
f −1(U ')}∪{ U ' | F ∩ f −1(U ') /= ∅} = { U ' | f [F ] ⊆ U '}∪{ U ' | f [F ] ∩ U ' /=

'
f [F ]
  . That VA and Vf agree with the previous Definition 3.2 follows

from the two propositions above.
Another example will be considered in the next section.

Extended Example: Stone spaces
In this section, we are going to show that we can perform the construction of the Vietoris endofunctor on the referential algebras that correspond to Stone spaces under the embedding described in Section 2.2, and that this construc- tion extends the familiar definition of the Vietoris endofunctor K on Stone spaces, i.e. that the following diagram commutes:

Stn
⏐ 
RAS
−−K−→  Stn
⏐ 
−−V−→ RA .

In this case, S is the classical propositional calculus, so the free S-algebra is the free Boolean algebra and S-filters are lattice filters. Let X = (X, Ω) be a Stone space, and let H = (X, A) be its associated referential algebra, i.e. A is the Boolean algebra of the clopen subsets of X. As it is well known, the carrier of the Vietoris space K(X) is the set K(X) of the closed subsets of X and the Boolean algebra of clopen subsets of K(X) is generated by
 U = {X ∈ VW | X ⊆ U } and   U = {X ∈ VW | X ∩ U /= ∅},

for all U ∈ A. Therefore, Propositions 4.4 and 4.5 will take care of the commutativity of the diagram above, provided that:
the family of the modally closed subsets of H coincides with K(X),

2 The corresponding logic S has sequents Γ ▶ φ ⇔ φ ∈ Γ; hence S-filters are just subsets.


there exists a family M of filters of the free Boolean algebra G generated by the set of abstract symbols L(H) = L (H) ∪ L (H), where L (H) = 
{ U | U ∈ A} and L (H) = { U | U ∈ A}, that satisfies conditions C1 – C3 of Section 4.
Proposition 5.1 For every Stone space X = (X, Ω), VX = K(X).
Proof. (⊆) Clearly, every modally closed subset F   =  {U ∈ A | F |=
F ∈ K(X), and let us show that F = F  . ‘⊆’ is clear since (·) is a closure operator. For the converse note that, as X is a Stone space, then the clopen subsets form a base of Ω, hence F =  {U ∈ A | F ⊆ U }.	 
Let G be the free Boolean algebra generated by L(H). It is a well known fact that the ultrafilters of a Boolean algebra are exactly the inverse homo- morphic images of the top element of the two-element Boolean algebra 2. As G is free, then every h ∈ Hom(G, 2) is uniquely determined by its restriction to L(H). For every F ∈ K(X), let us consider hF ∈ Hom(G, 2) defined by the following assignments: For every U ∈ A, hF ( U ) = 1 iff F ⊆ U and hF ( U ) = 1 iff F ∩ U /= ∅. Let MF = h−1(1) be the corresponding ultrafilter of G. By construction it holds that for every F ∈ K(X), MF is the only ultrafilter of G such that for every U ∈ A,
 U ∈ MF iff F ⊆ U and  U ∈ MF iff F ∩ U /= ∅.
So the collection M = {MF | F ∈ K(X)}⊆ Ultr(A) satisfies condition C1 of Section 4. Let us consider the atlas Q = (G, M). It is easy to see that for every collection U of ultrafilters of a Boolean algebra A the relation ΛU on A, defined as aΛU b iff ∀V ∈ U(a ∈ V ⇔ b ∈ V ), is a congruence of A. Hence ΛQ is a congruence of G, so M satisfies condition C2 of Section 4. As for C3, let f : X → X' be a continuous map, hence f ∈ Hom(H, H'). The following proposition shows that the corresponding homomorphism φ ∈ Hom(G', G) between the associated free Boolean algebras is an atlas morphism φ : Q' → Q.

Proposition 5.2 For every F ∈ K(X), φ−1(MF ) = Mf[F ].
Proof. As MF is an ultrafilter of G, then φ−1(MF ) is an ultrafilter of G'. For every U ∈ A', U ∈ φ−1(MF ) iff  f −1(U ) = φ( U ) ∈ MF , iff F ⊆ f −1(U ), iff f [F ] ⊆ U , iff  U ∈ Mf[F ]. Likewise, one shows that  U ∈ φ−1(MF ) iff
 U ∈ Mf[F ].  This is enough to prove the statement, for by construction,
Mf[F ] is the unique ultrafilter of G that contains the modal theory of f [F ]. 
We finish this section by showing that the ultrafilters of the quotient al-

gebra G∗ = G/ΛQ are exactly the modal (ultra)filters M ∗
= p[MF ], where


p : G → G∗ is the canonical projection. Thus, G∗ is the Vietoris Boolean algebra.
Proposition 5.3 Ultr(G∗) = M∗.
The proof of this proposition uses the following standard fact about Boolean algebras:
Lemma 5.4 For every Boolean algebra A and every congruence Λ on A, the canonical projection p : A→ A/Λ induces a bijective correspondence between Ultr(A/Λ) and the set of the ultraﬁlters V of A such that p−1(p[V ]) = V . In particular,
Ultr(A/Λ) = {p[V ] | V ∈ Ultr(A) and p−1(p[V ]) = V }.
Let us show Proposition 5.3:

Proof. By Lemma 5.4, we have to show that M∗ = {p[V ] | V ∈ Ultr(G) and p−1(p[V ]) = V }. Let us show that for every ultrafilter V of G, if p−1(p[V ]) = V , then V = MF for some F ∈ K(X).
Suppose that there exists an ultrafilter V of G such that p−1(p[V ]) = V and V /= MF for every F ∈ K(X). It is enough to show that there exists a ∈ V such that a ∈/ MF for every F ∈ K(X), for if it is so, then p(a) = 0, hence 0 ∈ p−1(p[V ]) = V , contradiction.
Let us consider the Stone space XG which is dual to G. By the Stone duality, the points of XG are the ultrafilters of G, and the clopen subsets of XG are exactly the sets a = {U ∈ Ultr(G) | a ∈ U }.
Let us consider the set M = {MF | F ∈ K(X)} as a subset of XG. We
are supposing that V ∈/ M. If we show that M is a closed subset of XG, then
by a standard compactness argument, V ∈ a and a ∩M = ∅ for some clopen subset a of XG, i.e. there exists a ∈ V such that a ∈/ MF for every F ∈ K(X), which is what we want.
So let us show that M is a closed subset of XG. Let K(X) be the Vietoris
space of X, and let us consider the map ξ : K(X) −→ XG defined by the assignment F '−→ MF for every F ∈ K(X). As K(X) is compact, then it is enough to show that ξ is continuous, i.e. that for every a ∈ G, ξ−1(a) is a clopen subset of K(X). By induction on the structure of a: As for the base,
 U and  U are clopen subsets of K(X) for every clopen subset U of X, and

The inductive step is routine.	 

Conclusion, Future Work, Open Problems
In this paper we presented a Vietoris space or powerdomain for a general notion of a state space equipped with an algebra of predicates. We expect this to have applications in such areas as the theory of systems, universal coalgebra, algebraic logic, modal logic, and lattice theory. In order to understand the import of this construction, more work will have to be carried out, some of which we sketch below.

Constructive definition of modal S-filters
As we mentioned in the introduction, the aim of our research project is to characterize the selfextensional logics that support modalities, and we pro- pose to use the construction of Section 4 for this characterization, namely to say that a selfextensional logic S supports classical modalities if and only if the construction of the Vietoris endofunctor V on the category of the (dif- ferentiated) S-referential algebras can be performed: then the V-coalgebras can be represented as referential algebras of the expanded algebraic signature, and the logic they will give rise to will be the classical modal expansion of S. The crucial step of this construction is that, for every S-referential algebra H, there exists the family of the modal S-filters of the free S-algebra over L (H) ∪L (H). In the case of Stone spaces, this family is constructed thanks to the existence of the schizophrenic object 2 in the category of Boolean al- gebras. A natural question is whether the existence of a schizophrenic object characterizes the situations in which the family of the modal S-filters can be constructively presented, or it is just a sufficient condition. As we mentioned in Section 2.2, a feature of the duality for selfextensional logics is that it uni- formly accounts for a class of dualities that includes the Stone and Priestley dualities (which are induced by a schizophrenic object), as well as the Jo´nsson- Tarski one (which is not induced by a schizophrenic object). The question on whether the existence of a schizophrenic object is a characterizing condition or a sufficient one for the family of the modal S-filters to be constructively presented can also be relevant for comparing the Clark and Davey theory of natural dualities and the duality theory for selfextensional logics.

Other modal expansions
In this paper we focused on expanding the language of S with a modal signature consisting of the normal operators  and a  that were interrelated like in the modal logic K. A further line of investigation is to extend this setting to modal expansions in which and are no more related like in the modal logic K, but are independent, or rather, they are related to one another


like in the intuitionistic modal logic IK [10], and so on. Other interesting modal expansions would include n-ary modal operators, and the list could continue. Each of these cases would correspond to defining an endofunctor on referential algebras. Perhaps extending the definitions of other hyperspace topologies to endofunctors on referential algebras would be a good starting point for a systematic investigation that would hopefully lead to a general methodology for wide classes of modal expansions.

Bounded lattice expansions
An interesting line of investigation is about the connections with the Gehrke-Jo´nsson theory of bounded (distributive) lattice expansions. There is a non trivial interplay between these two settings: on the one hand, non- modal operators, like the strict implication of intuitionistic logic, are also included in the expansions treated there. On the other, in this work, as in the context of Abstract Algebraic Logic to which it belongs, the language of lattices and facts about them are systematically extended to the more general metatheory of logics.

References
David M. Clark and Brian A. Davey. Natural Dualities for the Working Algebraist. Cambridge University Press, 1998.
Josep Maria Font and Ramon Jansana. A General Algebraic Semantics for Sentential Logics. Lecture Notes in Logic. Springer, 1996.
Mai Gehrke and John Harding. Bounded lattice expansions. Journal of Algebra, 238(1):345 – 371, 2001.
Peter Johnstone. Stone Spaces. Cambridge University Press, 1982.
Peter Johnstone. Vietoris locales and localic semilattices. In R.-E. Hoffmann and K.H. Hofmann, editors, Continuous Lattices and their Applications, volume 101 of Lecture Notes in Pure and Applied Mathematics, pages 155–180. Marcel Dekker, 1985.
Clemens Kupke, Alexander Kurz, and Yde Venema. Stone coalgebras. In H.P. Gumm, editor,
Coalgebraic Methods in Computer Science (CMCS’03), ENTCS, 2003.
Alessandra Palmigiano. A walk around selfextensionality. Technical report, University of Barcelona, 2002.
Alessandra Palmigiano. A coalgebraic semantics for positive modal logic. In H.-P. Gumm, editor, Coalgebraic Methods in Computer Science (CMCS’03), ENTCS, 2003.
Alessandra Palmigiano. Coalgebraic semantics for some intuitionistic modal logics. 2003.
Gis`ele Fischer Servi. Axiomatizations for some intuitionistic modal logics. Rendiconti del Seminario Matematico dell’ Universita` Politecnica di Torino, 42(3):179 – 194, 1984.
R. W´ojcicki. Matrix approach in the methodology of sentential calculus. Studia Logica, 32:7 – 37, 1973.
R. W´ojcicki. Theory of Logical Calculi. Basic Theory of Consequence Operations., volume 199. Reidel, Dordrecht, 1988.
