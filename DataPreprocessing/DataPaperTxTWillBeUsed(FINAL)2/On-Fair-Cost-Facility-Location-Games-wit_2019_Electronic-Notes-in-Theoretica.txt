Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 342 (2019) 21–38
www.elsevier.com/locate/entcs

On Fair Cost Facility Location Games with Non-singleton Players
F´elix Carvalho Rodrigues1,2 Eduardo C. Xavier1,3
Institute of Computing University of Campinas (Unicamp)
Campinas, Brazil
Guido Sch¨afer4
Networks and Optimization (N&O) group Centrum Wiskunde & Informatica (CWI) Amsterdam, The Netherlands

Abstract
In the fair cost facility location game, players control terminals and must open and connect each terminal to a facility, while paying connection costs and equally sharing the opening costs associated with the facilities it connects to. In most of the literature, it is assumed that each player control a single terminal. We explore a more general version of the game where each player may control multiple terminals. We prove that this game does not always possess pure Nash equilibria, and deciding whether an instance has equilibria is NP-Hard, even in metric instances. Furthermore, we present results regarding the efficiency of equilibria, showing that the price of stability of this game is equal to the price of anarchy, in both uncapacitated and capacitated settings.
Keywords: price of stability, facility location, algorithmic game theory


Introduction
Facility location problems covers a broad range of optimization problems, with practical applications in many different areas such as public policy, urban planning, telecommunications and computer networking. In the general sense, the facility location problem can be stated as follows. Let F be a set of facilities, T a set of terminals, with opening costs cf for each facility f ∈ F and connection costs dtf

1 This work was partially supported by Capes, CNPq and Fapesp.
2 Email: felix.rodrigues@ic.unicamp.br
3 Email: ecx@ic.unicamp.br
4 Email: g.schaefer@cwi.nl

https://doi.org/10.1016/j.entcs.2019.04.003
1571-0661/© 2019 The Author(s). Published by Elsevier B.V.
This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).

for connecting terminal t ∈ T to facility f ∈ F . The problem is to find a subset of facilities to open and establish connections from terminals to this subset such that the sum of all costs are minimized.
Consider a scenario where multiple supermarket or stores share big warehouses that stockpile supplies for them. Each store is located some distance away from a warehouse and they pay the costs associated with maintaining its products in the warehouse and the transportation costs to its specific location. Such scenario can be seen as a facility location problem, where each store is a terminal and each warehouse location is a possible facility. In the classical optimization version, the view point of the warehouse company is given priority, and each terminal can be seen as being controlled by a central authority in order to minimize opening and connection costs globally. When we consider the fact that each supermarket is competing with each other, this approach of global optimization is not possible to be adopted anymore. In order to analyze such scenarios, we can use game theory.
A non–cooperative game is a decision scenario where an agent or player selfishly and without coordination other players, chooses a strategy in order to maximize its own utility (or minimize its own cost), which in turn depends on the strategies chosen by the other players. We say that a game is in a pure Nash equilibrium (PNE) if no player has any incentive to unilaterally change its own strategy. In order to compare the social cost of pure equilibria and the social optimum, we use the standard measures found in the literature: the price of anarchy (PoA) and the price of stability (PoS). The PoA of a game is defined as the ratio between the PNE with worst social cost and the social optimal cost, while the PoS is the ratio between the PNE with the best social cost and the social optimum.
In our example scenario, each store is traditionally viewed as a player choosing a facility (warehouses) to connect, such that its own cost is minimized. Each store would then share equally the costs associated with storing the goods in the ware- house they are connected to, as well as individually paying for the connection to such warehouse. This scenario exemplifies the singleton fair cost facility location game, where each store is controlled by a single player. This scenario however fails to accommodate the common case when multiple supermarket or stores are part of the same chain.
When stores are part of the same larger group, each store behaviour cannot be said to be independent and uncoordinated, however one whole group does not coordinate with other competitor stores or chains and therefore it makes sense to analyze this scenario by allowing players to control multiple stores or terminals.
In the fair cost facility location games we analyze, each player controls multiple terminals, and can move them simultaneously to minimize their own costs. For singleton games, terminals sharing opening costs evenly means the same as players sharing these costs evenly, since players and terminals are effectively the same in these scenarios. However when players control multiple terminals, the same is not true. In our paper we use the term fair cost to mean that in any strategy profile each facility has its opening cost shared evenly among all terminals that connect to it, i.e. if in a certain strategy profile a player a has two terminals connected to a

facility f and a different player b has a single terminal connected to it, player a will pay for two thirds of the opening cost of f , while player b pays only a third of the opening cost.
In this work we study how hard it is to find pure Nash equilibria in these fair cost facility location games, as well as how efficient these equilibria can be when compared with the social optimal cost. Finally, we extend our results to weighted and capacitated versions of these games.

Related Work and Organization
There have been multiple works examining facility location problems from the out- look of game theory. The class of valid utility games [12, 14, 18] can be viewed as facility games when both facilities and players are controlled by singleton players. There is a whole area in game theory focused in cooperative games, and Goemans and Skutella [8] studied cooperative facility location games.
Facility location has also been extensively studied from the mechanism design perspective, with multiple relevant work in strategy-proof mechanisms for variants of facility location problems [5, 13, 15].
We study in this paper the non-cooperative facility location game where players control terminals, and each terminal t share the opening cost of its chosen facility f equally among all terminals connected to f . These games share great similarities to connection and network design games, and thus multiple results from these games are valid for fair cost facility location games.
For the singleton fair cost facility location game, the results from network de- sign [1] extend to facility location, with a bound of k for the PoA and Hk = Θ(log k) for the PoS [17]. For the metric version, where each connection obeys the triangle inequality, Hansen and Telelis [9] proved constant bounds both for the PoS and the strong PoA. Furthermore, when there are weights associated with terminals deter- mining how much of the opening cost is paid by each terminal, they show that there is always an e-approximate equilibrium and that the PoS can be in Θ(log W ), where W is the sum of all terminal weights. In [3], Chen and Roughgarden prove that there are instances of the weighted network design game where there are no possible PNE, however it is still an open question whether the same applies to weighted fair cost facility location games, even for the non-singleton version.
For facility location games where players do not posses any limitations on how to share opening costs, the price of anarchy and the price of stability have been proven to be in Θ(k) by Cardinal and Hoefer [2, 11], where k is the number of players in the game. Furthermore, for non-singleton games it is NP-hard to decide whether an instance has a PNE [2].
The capacitated version of the game was considered by Rodrigues and Xavier [16]. They show that for the metric singleton fair cost facility location game, the PoA can be unbounded, while the PoS is Hk, where k is the number of players. Furthermore, they show that it is NP-hard to decide whether there is PNE in singleton capacitated facility location games with arbitrary opening cost sharing.

For a sequential version of facility location, they show that the metric version has bounded PoA and PoS.
In this paper we extend the results from Cardinal and Hoefer [2] to fair cost facility location, proving that it is NP-hard to decide whether there is a PNE in this game, even in the metric case, as long as players are allowed to control multiple terminals. For this, we prove that there are fair cost facility location game instances with no PNE. We base this proof in the instances without PNE in weighted network design games used by Chen and Roughgarden in [3]. Finally, we prove that the PoS of this game can be as inefficient as the PoA for both the uncapacitated metric case and the general capacitated case.
In Section 3, we present the formal definitions needed to understand our paper and define our game. In Section 4, we provide instances with no PNE and prove the NP-hardness of PNE existence, as well as link these instances to weighted games. In Section 5, we prove that the price of stability is as poor as the price of anarchy in both the uncapacitated and capacitated versions of fair cost facility location games. Finally, in Section 6 we present our final remarks and discuss future work.
Preliminaries
First we define a few key concepts from non–cooperative game theory.
In game theory, a non–cooperative game is a scenario where players choose strate- gies independently trying to either minimize their costs or maximize their utility. For each player i, there is a set Ai of actions that it can choose to play. A pure strategy Si consists of one action from Ai, while a mixed strategy corresponds to a probability distribution over Ai. In a pure game each player choses one action to play, while in a mixed game each player randomizes its action according to the probability distribution. In this paper we assume pure strategies games unless men- tioned otherwise.
A set of strategies S = (S1, S2,..., Sn) consisting of one strategy for each player, is denominated a strategy proﬁle. Let S = A1 ×A2 ×.. .×An be the set of all possible strategy profiles and let c : S → Rn be a cost function that attributes a cost ci(S) for each player i given a strategy profile S. Define S−i = (S1,..., Si−1, Si+1,..., Sn) a strategy profile S without i’s strategy, so that we can write S = (Si, S−i). If all players other than i decide to play S−i, then player i is faced with the problem of determining a best response to S−i. A strategy S∗ from a player i is a best response to S−i, if there is no other strategy which could yield a better outcome for the player, i.e.
ci(S∗, S−i) ≤ ci(Si, S−i)  , ∀Si ∈ Ai.
A strategy profile is in a pure Nash equilibrium (PNE) if no player can reduce its cost by choosing a different strategy, i.e. for each player, its strategy in the strategy profile is a best response.
The social welfare or social cost is a function mapping a strategy profile to a real number, indicating a measure of the total cost or payoff of a game. Two of the most important concepts for efficiency analysis are the Price of Anarchy (PoA) and

the Price of Stability (PoS). The PoA is the ratio between a Nash equilibrium with worst possible social cost and the strategy profile with optimal social cost, while the PoS is the ratio between the best possible Nash equilibrium to the social optimum. With these ideas formalized, we define the Facility Location Game with Fair
Cost Sharing (FLG-FC).
Definition 3.1 Let G = (T ∪ F, T × F ) be a bipartite graph, with vertex sets F of n facilities and T of m terminals. Each facility f ∈ F has an opening cost cf , and connection costs dtf for each terminal t ∈ T . Let K = {1,..., k} be the set of players.
Each player i controls a subset of terminals Ti ⊆ T (also forming a partition of T ), and each terminal must be connected to exactly one opened facility. When a player controls only a single terminal, it is denominated a singleton player. A player i chooses a strategy Si ⊆ Ti × F .
Let S = (S1,..., Sk) be a strategy profile. We abuse notation and use the expression f ∈ S to represent any facility f connected to a terminal in a strategy profile S and (t, f ) ∈ S to represent any pair of terminal and facility that are connected in S, while f ∈ Si represents any facility f player i uses to connect one of its terminals in strategy Si. Each player tries to minimize its own payment

pi(S)= 
(t,f )∈Si
  cf   +
xf (S)
(t,f )∈Si

dtf ,

where xf (S)= |{(tj,f ) ∈ Si | 1 ≤ i ≤ k ∧ 1 ≤ j ≤ m}| is the number of terminals connected to facility f in strategy profile S.
The social welfare cost for a strategy S is defined as the sum of all player payments, i.e.,
C(S)= Σ pi(S)= Σ cf + Σ dtf .

i∈K
f∈S
(t,f )∈S

In games with general connection costs, some connections (t, f ) should be avoided in any solution, because they do not exist for example. In this case we assume they have a prohibitively large constant cost Ud. For general costs, if a connection is not shown, it is assumed that it has a cost equal to Ud, unless men- tioned otherwise. For metric connection costs, where connection costs must obey the triangle inequality, it is assumed that any connection (t, f ) not shown has a cost equal to the shortest cost path from t to f in the undirected graph formed from the explicitly shown connections.
When dealing with capacitated FLG-FC, we extend this definition to include a capacity for each facility, as well as ways to enforce players to propose valid solutions.
Definition 3.2 Let G = (T ∪ F, T × F ) be a bipartite graph, with vertex sets F of n facilities and T of m terminals. Each facility f ∈ F has an opening cost cf and a capacity uf indicating how many terminals can be connected to f at any given time. Furthermore, there are connection costs dtf for each pair (t, f ) where t ∈ T and f ∈ F .

Given a strategy profile S, for Capacitated Facility Location Games with Fair Cost Sharing (CFLG-FC), the definitions of players i payment, pi(S), and social cost, C(S), are the same as before for the uncapacitated game. However, to ensure that capacity restrictions are respected, if a player i in the solution S has one of its terminals connected to f where xf (S) > uf , then a prohibitively large constant cost Uc is added to the payment of player i, i.e., it pays pi(S)+ Uc.

On the Existence of Pure Equilibria
Pure Nash equilibria is one of the most well known solution concepts in game theory. While it is not guaranteed to exist in all games, in several practical scenarios it reflects to a greater degree the behaviour of players. The singleton version of FLG- FC is a potential game, and therefore there always exists a PNE [17]. We show that this does not extend to every fair cost facility location game, by showing instances with no PNE when players control multiple terminals and the opening cost sharing happens in relation to terminals. We construct these instances loosely based on an example used to prove the non-existence of PNE in weighted network design games [3]. We first prove this result for weighted fair cost facility location games and then extend this result for unweighted metric games.

Equilibria Existence in Weighted Games
In the classic facility location game, each terminal is assumed to demand or require the same amount of goods from a facility, and therefore the “fair” way to share costs is to evenly divide opening costs of an opened facility between terminals that connect to it. However this is not always the case. In several practical scenarios some terminals might require more from a facility, and an egalitarian sharing might not reflect fairness.
In the weighted fair cost facility location game, each terminal t has an associated positive integer weight wt ≥ 1, and each player i pays in a strategy profile S,


pi(S)= 
(t,f )∈Si

dtf
+
(t,f )∈Si
wtcf	, Wf,S

where Wf,S is the sum of the weights of all terminals connected to f in the strategy profile S.
Here we provide a partial answer to an open question regarding whether there are instances with no PNE for weighted FLG-FC. We provide an instance with no PNE when players are allowed to control more than a single terminal. It remains open whether there are singleton weighted instances with no equilibria.
Theorem 4.1 There exists a 3-player metric instance for the weighted FLG-FC game with only six terminals where there is no PNE.
Proof.

Consider the instance in Figure 1, denominated here as I. Let w > 1 be a parameter of this instance, and ε be a constant much smaller than  1 . Let player A control terminals t2 and t5, player B control terminals t1 and t3, and player C control terminals t4 and t6. Allow every terminal controlled by player A to have the same weight wA = w2, every terminal that B controls to have unitary weight wB = 1 and every terminal that player C controls to have weight wC = w.
















cf5 =1 

Fig. 1. Game instance of the weighted FLG-FC without PNE. All edges except dt1 ,f1 have cost equal to zero.




For player Pa, there are only two feasible strategies: either all terminals connect to f3, or t2 connects to f1 and t5 connects to f5. The same happens for player Pc: either all terminals connect to f4, or t4 connects to f2 and t6 connects to f5. For player Pb terminal t1 has to choose between f1 and f2, while terminal t3 will always connect to f5 in any PNE. The proof is based on players Pa and Pc having different facility preferences when presented with mirrored choices from player Pb. To achieve this, we use the fact that player Pa has squared times the weight than Pc does, as well as carefully constructed opening costs.
Note that all direct connection costs are equal for Pa and for Pc, and thus do not interfere in their choices. They only ensure that it is not beneficial for neither Pa nor Pc to connect their terminals to facilities without a direct connection available. For Pb, the only influence that connection costs have is in choosing whether to connect to f1 or f2.
Since the terminals from player Pa have weight w2, player A will always pay for the majority of the cost of any facility it helps open. With this in mind, we can sort the five possible scenarios for player Pa by the cost incurred from each in increasing order: (i) player Pa shares f1 with Pb and f5 with all players, (ii) it connects to f1 alone and shares f5 with all players, (iii) it connects to f3 alone, (iv) it shares f1 with Pb and shares f5 with Pb only and (v) it connects to f1 alone and shares f5 with Pb only. The following inequalities show why this is the case:



w2	w2
2	cf1 +	2
cf5 ≤	(1)

w +1 
w + w +1 
w2

cf1 +
cf5 ≤	(2)
w + w +1 

w3 + w2
w2 + w +1 − ε
2w2 + 1 
2w2 +2 
= cf3 ≤	(3)

w2		w3
	


w2	w2	w2	w2
			

 	 	 

(4)
From this we gather that, for player Pa, the preferred scenario is where player Pc connects to f5, even if player Pb does not connect to f1. For player Pc, we do the same, observing that now the facility which dictates its strategy is f2, as even if player Pa does not connect to f5, if player Pb does connect to f2, the cheapest for Pc is to connect to f2 and f5. Player Pc can, going from least to most expensive,
(i) share f2 with Pb and f5 with all players, (ii) share f2 and f5 with Pb only, (iii) connect to f4 alone, (iv) connect to f2 alone and share f5 with all players and finally
(v) connect alone to f2 and share f5 with Pb only. The inequalities that show this is the case for player Pc are:


w	w
cf2 +	2
cf5 ≤	(5)

w +1 
w
cf2 +
w + w +1 
w
cf5 =
w3 + w	w
2	+ ε

≤	(6)

w +1 
w +1 
w + w +1	w +1 

w3 + w
w2 + w +1 + ε
w3
2w + 1 
2w +2 
w
= cf4 ≤	(7)
w

w2 + w +1 + ε + w2 + w +1 = cf2 +
w
cf5 ≤	(8)
w + w +1 

cf2 +
cf5 .	(9)
w +1 

Now we prove the theorem by contradiction. Suppose that there exists a PNE for this instance. Terminal t1 can be connected to either f1 or f2. First assume t1 is connected to f1. Then, player Pc has no incentive to connect to either f2 or f5, as shown by (7) and (8), and connects all its terminals to f4. Since player Pc does not connect to f5, player Pa also does not have enough incentive to connect to f1 and f5, as shown by (3) and (4), and connects all its terminals to f3. With this, player Pb is paying alone for f1, and since f2 is cheaper to connect, it is not in a PNE, and thus t1 cannot connect to f1 in any PNE.
Now assume t1 is connected to f2. Player Pc now will connect to f2 with t4, with t6 connecting to f5, as the inequalities in (6) and (7) show. Since player Pc connects to f5, now player Pa will also opt to connect to f5 and therefore will also open f1, as shown by (2) and (3). Since f1 has player Pa connected to it, player

Pb now has enough incentive to connect t1 to f1 instead of f2, and therefore our assumption is not true.
Since connecting t1 to neither f1 nor f2 results in a PNE, there is a contradiction with our claim that there exists a PNE for this instance, and thus we have proven that there is no pure equilibrium.	2

Equilibria Existence in FLG-FC
Now we extend the results from Theorem 4.1 for the unweighted case. To accomplish this we first make the key observation that for any weighted fair cost facility location game instance G with m terminals, there is a fair cost facility location game instance Gj with W terminals with equivalent PNE, where W is the total sum of weights w1 + ··· + wm. This is the case since for each terminal t controlled by a player i with weight wt > 1, we can add in Gj terminals tj, for j ∈ [2, wt], all controlled by i with the same connections and costs as t. Since they are equal in every way in regards to cost calculation, player i has no reason to split strategies when choosing which facility to connect t and the added terminals tj.
Theorem 4.2 There exists a metric 3-player instance for the FLG-FC game where there is no PNE.
Proof. Consider the instance I depicted in Figure 2. Let w > 1 bea parameter on this graph, and ε be a constant much smaller than  1 , such that player Pa controls

terminals t1,..., tw2
1	w2	2

2	2  and t5,..., t5 , for a total of 2w  terminals. Player Pb controls
two terminals, t1 and t3, while player Pc controls terminals t1,..., tw and t1,..., tw,
4	4	6	6
for a total of 2w terminals. All connection costs are unitary, with the exception of
dt1,f1 , which has cost 1 + 3ε. All opening costs are as shown in Figure 2.

dt1 ,f1 = 1+ 3ε
dt1 ,f2 =1 


	










Fig. 2. Game instance of the FLG-FC without a PNE. All edges except dt1 ,f1 have cost equal to one. Any edge (t, f ) not drawn has cost equal to the shortest path cost from t to f .

We prove the theorem by showing that the instance seen in Theorem 4.1, here denominated I0, can be transformed to instance I, seen in Figure 2 without changes to the players overall strategies, and thus the proof for Theorem 4.1 applies for in-

stance I. Start by changing I0 to Ij so that we add terminals tj
and tj
connected

to the same facilities (and the corresponding connection costs) as t2 and t5, respec-
2
tively, while changing the weight wA of all terminals of player A to w . In any pure

equilibria for this instance, if we connect any terminal to facility f3, all terminals from A will connect to it, since A will pay the full cost of f3. Thus, if t2 connects to

f3, terminal tj
will also connect to f3, and if t2 connects to f1, tj
will do the same.

The same is true for tj in relation to t5. Since this is the case, if player A connects

to f
or f , it will still pay exactly the same share	w2
of the opening cost of

1	5	W (f,S)
facility f as in I, where W (f, S) is the sum of weights of all terminals connected to
f in the strategy profile S. Instance Ij thus incurs the same decisions from players as instance I0. The same can be done to player C and its terminals t4 and t6.
Therefore, in order to transform I0 into instance I while preserving the same possible equilibria, it suffices to incrementally add terminals with the same connec- tions for players A and C, while dividing the weight of these players by the number of added terminals until the number of terminals A controls is 2w2 (w2 of “t2” terminals and w2 of “t5”) and they all have weight wA = 1, while player C will control 2w terminals (w of “t4” terminals and w of “t6”), all with weight wC = 1. Thus, Theorem 4.1 applies to the unweighted metric instance I, and there exists a 3-player weighted instance I without any equilibria.	2
Using a version of this instance where w = 2 as a gadget, we can prove that deciding whether an instance of FLG-FC has a PNE is NP-Hard.
Theorem 4.3 It is NP-hard to determine if an instance of the Metric FLG-FC has a PNE or not.
Proof. First notice that it is NP-hard to verify whether a given solution S to an instance of the FLG-FC is a PNE or not when players control multiple facilities, since for each player we need to solve an optimization facility location problem on the instance restricted to this player alone. To verify that a strategy of a player is a best response, we have to fix all other players strategies, and check if the solution restricted to this player is minimum, which is an NP-hard problem.
In order to prove NP-hardness for the existence of a PNE, we make a reduction from the 3-SAT problem to the problem of deciding whether an instance of the metric FLG-FC game has a PNE or not.
Let I be an instance from 3-SAT, with clauses C1,.  , Cq, where each clause Cj
consists of a triple of literals from the set of decision variables x1,..., xp in clausal normal form, so that each literal in a clause can assume form xi or xi for a decision variable xi. Then, we form the fair cost facility location instance G as follows: for each decision variable xi, we createa terminal ti, controlled by a single player, and facilities fxi and fxi and link ti to them, as Figure 3a shows. The opening cost of each facility fxi and fxi is equal to the number of terminals that can directly connect to them times 1 + ε. We use the term directly here to discern from the connections not shown, which are assumed to cost the shortest path from a terminal to the facility.
We create for each clause Cj two gadgets: one with no equilibria unless stabilized by the second gadget, which in turn links to the decision gadget, as exemplified in Figure 3b. For the bottom gadget, note that it is exactly the same example as the one used in Theorem 4.2, with parameter w = 2. We have three players in

Decision gadget for x1
Decision gadget for x2
Decision gadget for x3

		












cfx
ti
= 4(1 + ε)
fxi


cf
i
fxi

= 3(1 + ε)



Clause gadgets containing xi
Clause gadgets containing xi

A decision gadget for xi in an in-

stance with three clauses containing
xi and two containing xi.
Clause gadget for Cj = (x1 ∨ x2 ∨ x3).

Fig. 3. A decision (a) and a clause (b) gadget. Drawn edges without explicit costs have connection cost one, any edge (t, f ) not drawn has cost equal to the shortest path cost from t to f .


this gadget for each clause C , where player Pj controls terminals tj
,..., tj
and

j	a	2,1
2,4

tj  ,..., tj  , player Pj controls terminals tj and tj and player Pj control terminals

5,1
5,4	b
3	c

j
4,1
j
4,2
j
6,1
j
6,2
. The opening and connection costs of this gadget follow the same

costs presented in Theorem 4.2, when parameter w equals to two.
For the link gadget, each player controls a single terminal, and for each literal

xi or xi in Cj there is a terminal tj
with possible direct connection to both the

facility in the decision gadget for xi (either fxi or fxi ), with connection cost one, and central facility fj , with connection cost ε and opening cost 2. Furthermore, we create another terminal tbi which can connect directly to either the central facility
fj , with connection cost one, or to facility fj with connection cost 2. Now we add
ai	2
connections from every terminal t to every facility f obeying the triangle inequality
by setting cost dtf to the shortest cost path from t to f in the undirected network formed by the connections between terminals and facilities.
Suppose there is a truth assignment for I. Then we can build the following PNE for instance G: if decision variable xi = 1, assign ti to fxi , and otherwise assign ti
to fx . Now for each clause gadget Cj where literal xi appears connect tj to fx


i
if xi = 1, or to fj
if xi = 0. Furthermore, connect tj
ai	i
to fj if xi = 1, or to fj if

ai	bi	2	ai
xi = 0. Do the same for clauses where literal xi appears.

Finally, connect the rest of the terminals in Cj
as follows: player Pj
connects

its terminals to fj and fj, player Pj connects to fj and fj and player Pj connects

5	b
to fj and fj.
5	c

2	5

First, note that if xi = 1, then fxi is open and connected with all terminals that can directly connect to it, meaning that each terminal pays 1 + ε opening

cost. At the same time, in each clause where xi appears, fj
is not opened, and

thus the cheapest alternative for terminal tj
costs 2 + ε, the same amount it pays

for connecting to fxi . Alternatively, if xi = 0, facility fxi
connected to its cheapest possible facility.
is not open and tj  is

Since I has an satisfying assignment, at least one terminal tj
will be connected

to fj, paying at most 2 + 2 + ε and stabilizing the game induced by players Pj,Pj
7	4	a	b
and Pj. Furthermore, when xi = 1, terminal tj is in equilibrium connected to fj,
since the alternative facility fj would require tj to pay 3 in opening and connection

ai
costs. Alternatively, if xi = 0, terminal tj
bi
is also in equilibrium by connecting to fj ,

since in this case it shares the opening cost with tj , paying a total of 2. Therefore, we have a PNE for G given a satisfying assignment for I.
Now suppose there exists a PNE in G. For any clause Cj, at least one terminal
tj  must be connected to fj, since otherwise players Pj,Pj and Pj would not be in

bi	2
a	b	c

equilibrium. Then, for each terminal tj connected to fj, terminal tj
must connect

bi	2	ai

to fx
(or fx , if representing literal xi). This is the case because if tj
were to

i	i	ai
connect to fj , terminal tj would not be in equilibrium connecting to fj.
ai	bi	2

Note that for terminal tj
in clause Cj connected to facility fxi , even when

all terminals with a direct possible connection apart from ti are connected to it,
terminal tj still is not in equilibrium, since it would be cheaper for it to open fj
paying ε connection cost and 2 opening cost than paying 1 as connection cost and
 l  (1 + ε) opening cost, where l is the number of terminals that can connect directly to fxi . Terminal ti in any PNE therefore must connect to either fxi or fxi .
This shows that in any PNE in G, at least one literal of each clause is set to true in the corresponding assignment in I. Furthermore, it also shows that there can be no decision variable xi with xi = 1 and xi = 1. If a decision variable xi is set as both xi = 0 and xi = 0, then it must be irrelevant to the truth assignment of I, since G is in equilibrium, and therefore we can assign either xi or xi to 1. Thus, any PNE in G is consistent and can be used to build a satisfying assignment for
2
Note that while we use several players in our proof, it is possible to reduce the total number of players to only six.
Corollary 4.4 It is NP-hard to determine if a metric FLG-FC has a PNE, even for games with 6 players.
Proof. First note that in the instance G in Theorem 4.3, there are three players which control multiple terminals for each clause Cj, as well as six singleton players. Furthermore, for each decision gadget there is one additional player. We form a new instance Gj with the same terminals, facilities and costs as G, but only six players. We remark that each clause gadget is “de facto” isolated from each other in G, since the connection cost necessary for a terminal in a clause gadget Cj to connect to a facility in either a different clause gadget Cj+1 or in a decision gadget not directly

connected to Cj is greater than opening any possible facility it can directly connect. Thus, we can form players Pa, Pb and Pc in instance Gj that control terminals controlled by players Pj,Pj and Pj in any clause C . Furthermore, we can make
a	b	c	j

players Pa1, Pa2, Pa3 and Pb1, Pb2, Pb3 in Gj to control every terminal tj
, tj
, tj
and

j	j	j
a1  a2  a3

tb1, tb2, tb3 in any clause gadget Cj.
Similarly, we can join all players from the decision gadgets into a single player Px in Gj, which controls any terminal ti in any decision gadget xi. Now the total number of players in this instance is reduced to ten. To achieve the number of six players, we remark that player Pa1 has no direct connection to facilities that Pb2 can directly connect, and thus can be safely merged into a single player Pa1b2. Similarly, player Pa2 can be safely merged with Pb3 and Pa3 can be merged with Pb1, resulting in players Pa2b3 and Pa3b1 in Gj. Finally, note that player Pa has no direct connection to fj in any clause gadget Cj, and therefore can safely merge with either Pa1b2, Pa2b3 or Pa3b1. Thus, we have one player controlling all decision gadgets and five players controlling the clause gadgets, resulting in a total of six players in instance Gj while maintaining the same features and possible PNE as instance G.	2
Efficiency of Equilibria in Non-singleton Fair Cost Fa- cility Location Games
In this section we turn our analysis towards loss of efficiency due to player behaviour. The most well known measures of efficiency for non-cooperative games are the PoA and the PoS. The price of anarchy in several games can be high and sometimes unrealistic, due to comparing only the worst possible equilibrium in terms of social cost or welfare to the optimal social welfare or cost. For facility location games, we can show that the price of anarchy is at least k, where k is the number of players of the game. To see that this is the case, see Figure 4. In this example, the strategy where all players are connected to the facility to the right is a PNE, and has social cost k, while in the optimal social solution all players are connected to the facility to the left, with total cost equal to 1 (connection costs are zero).



cf1 =1	cf2 = k




Fig. 4. A game instance of the FLG-FC with PoA equal to k.

In [1], Anshelevich et al. argue that the concept of PoS, formalized in the same paper, better captures the efficiency loss in network design games and consequently singleton fair cost facility location games.  They show a bound for the PoS of

Hk = 1 + 1 + ··· + 1
= Θ(log k) for these network design games, where k is the

2	k
number of players in the game, which can be extended for singleton fair cost facility
location games [17].
In this paper we show that the same is not true for fair cost facility location games where players can control multiple terminals, even when connection costs obey the triangle inequality. We prove that there are instances where the PoS is Θ(k), where k is the number of players, the same as the PoA.
Theorem 5.1 There are instances of the metric FLG-FC which admit PNE but have price of stability in Θ(k), where k is the number of players.
Proof.
Consider the instance shown in Figure 5. Let ε be a constant number much

smaller than 1 . Each player Pi, for i ∈ [1, k], controls terminal tj
. Player Pa

8	i
controls terminals t1 to t4 and t1 to t4, player Pb controls terminals t1 and t3, while
2	2	5	5
player Pc controls terminals t1, t2, t1 and t2. The full black lines have connection
4  4  6	6
cost one, while the dashed lines have connection cost ε, with the exception of dt1,f 1
b  b
with cost 3ε2 + ε.

Fig. 5. An instance of metric FLG-FC with PoS in Θ(k). Dashed lines have connection cost ε (except for
dt ,f , which has cost 3ε2 + ε), full black lines have cost 1. Labels next to terminals indicate which player
1 1
controls the terminal.
Notice that the subgame composed only by the players P2 to Pk and their connec- tions, on the left side of Figure 5, has two pure equilibria: either everyone connects to the central facility fs or each player Pi connects its terminal to facility fj. The

subgame composed by players Pa, Pb and Pc and their connections, on the other hand, is equal to the instance used in Theorem 4.2 when w = 2 with the costs scaled by ε, and therefore it has no equilibria unless the game is altered to allow some other player to stabilize it.
Player P1 is the one in this instance that can stabilize these two subgames. Recall from Theorem 4.2 that, as long as some terminal is connected to f2, player Pc will connect to f2 and f5. Since there are multiple terminals in f5, player Pa will want to connect to f1 and f5 as well. This then means that player Pb will want to connect to f2 and f5. Therefore in any PNE, P1 must connect to f2. For this to be the best possible move for P1, no player can open the central facility fs, and therefore the only possible PNE is the one where each Pi connects to fj, while Pa, Pb and Pc play as seen above. Note that players Pa, Pb and Pc can be merged with any players Pi, Pj and Pr, for all i /= j /= r ∈ [2, k], since they have disjoint strategy sets. Therefore, we can assume that there are k players in this instance.
The cost of the optimal strategy is the following. In the left side, players P1 to Pk connect to the central facility fs, for a cost of 1 + kε. In the right side, players Pb and Pc connect to f2 and f5, while player Pa connects to f1 and f5, paying also a connection cost of ε for each terminal, for a total cost of
1+ kε + ε  8 — ε +1+ 8 + ε + 14  =1 + kε + 16 ε + 15ε =1 + ε  k + 15+ 16  .
7	7	7	7
In the unique PNE, players P2 to Pk connect to their single facilities fj to fj
and player P1 connects to f2, while players Pa, Pb and Pc connect to facilities f2, f5 and f1 (with Pb using connection dt ,f which costs 3ε2 + ε). Thus, the total cost for the PNE is

k + (k — 1)ε + ε	8
7
8
— ε +1+ 
7
+ ε + 3ε + 14
= k + kε — ε +
16 ε + 15ε + 3ε2
7

= k + ε  k + 14+ 16 + 3ε  .
The PoS of this instance is therefore
k + ε(k + 14+ 16 + 3ε)
	7	 = Θ(k) .
1+ ε(k + 15+ 16 )
Since the PoA of FLG-FC is Θ(k) (and therefore the PoS is O(k)), this instance makes the bound for PoS for FLG-FC asymptotically tight, and thus the PoS for metric FLG-FC is Θ(k).	2
Price of Stability in Capacitated Facility Location Games
Until now we have only considered scenarios where there are no limits on the number of terminals that a facility can supply. However this is not always the case in practice. In [16], Rodrigues and Xavier show that even metric facility location games have unbounded PoA, unless sequentiality is considered. Furthermore, they

show that metric singleton capacitated fair cost facility location games have a PoS of at least Θ(log k), in comparison to the constant bounds of the uncapacitated metric version [9].
In this section we prove that for capacitated games where players are allowed to control more than a single terminal, there are instances with unbounded PoS. Note that, contrary to most results in this paper, we consider for this result that connection costs do not obey the triangle inequality, and thus any connections not shown in our construction have prohibitively large (and unbounded) cost Ud.
Theorem 5.2 There are 3-player instances of the capacitated FLG-FC that admit a PNE but have PoS that is unbounded.
Proof.
Assume that we are restricted to instances where there is a PNE and players are allowed to control multiple terminals. We combine the instance described in Theorem 4.2 into an instance with unbounded PoA [16] to force that the only possible PNE in the game opens facilities with unbounded opening costs.
Consider the game in Figure 6. Note that the subgraph induced by the terminals that players Pa, Pb, Pc control is the same as in Theorem 4.2 when parameter w = 2. Thus, the only way for them to be in a PNE is if terminal ta connects to f2. For this to happen in an equilibrium, terminal tb must not connect to fa. If this was the case, then it would be cheaper for ta to also connect to fa, as it would pay only 1/4 which is less than the amount it pays to connect to f2. Since f2 must be occupied by ta in a PNE, terminal tc in any equilibrium will connect to fc, paying the connection cost of U which can be arbitrarily large, and thus the only possible equilibrium in this game is unbounded. Consequently, the PoS is also unbounded.

Fig. 6. An instance of capacitated FLG-FC with unbounded PoS. All connections have zero cost (except
dt1 ,f 1 , which has cost 3ε). Any facility f without a capacity restriction indicated is unlimited, i.e., uf ≥ 8.
b  b
Labels next to terminals indicate which player controls the terminal.
2
6	Conclusions and Future work
In this paper we have studied a general version of the fair cost facility location game. In this model, the opened facilities have their opening costs shared evenly among

all terminals that connect to them, and players are allowed to control multiple terminals. We prove that there are instances for these games with no pure Nash equilibrium, and that deciding whether an instance of the game has a PNE or not is NP-hard, even when connection costs are metric. Furthermore, we provide a negative partial answer to an open question whether weighted fair cost facility location games always posses PNE, by showing the connections of these weighted games to scenarios where players control multiple terminals. Finally, we prove negative efficiency bounds related to the price of stability in both uncapacitated and capacitated games, showing that the price of stability is as inefficient as the price of anarchy in this generalized version of fair cost facility location game.
There are several possible directions on future work that relates to our paper. For weighted games, it remains an open problem to find whether there is an instance with no PNE for the singleton case. While our instance with no PNE has only a few terminals, the effect that cooperation between terminals can have on the PNE is crucial for there to be no PNE in this instance. It is not clear whether there is a possible way to adapt this instance for the singleton case. When we consider strong equilibria [6] for the singleton case, where terminals might cooperate to choose a better strategy when it is beneficial to every player in a coalition, a few similarities appear with this general version of fair cost facility location game. It might be possible to extend some results from strong equilibria for singleton fair cost facility location games to our setting, such as the existence of e-approximate strong equilibria in singleton fair cost facility location games [10]. Alternatively, it might as well be possible to adapt some of our results to strong PNE in more restricted settings.
In [2], Cardinal and Hoefer prove a two parameter (α, β) constant approximation to facility location games with arbitrary cost sharing rules, where each player can reduce its cost by unilateral deviation by at most a factor of α, while the social cost of this α-approximated PNE is at most β times from the optimal social cost. An interesting question is whether it is possible to find a similar two parameter approximation for our setting, or if the limited fair cost aspect of our scenario causes one of the parameters to be too large.
Finally, in many practical scenarios there is a central authority with some ca- pacity for interference in the game which has a goal of minimizing the social cost globally. Thus it is important to model in what circumstances this intervention can improve efficiency. The use of stackelberg strategies [7], where a central authority control a few terminals that can play before the other players, might guarantee that a PNE is always possible to find, as well as using tolls [4] in either connections or facilities to ensure only “good” equilibria are chosen by players.

Acknowledgment
The authors thank the ideas and discussions held in the 1st Paulista Workshop on Optimization, Combinatorics and Algorithms (WoPOCA 2017), which contributed for some of the results in this paper. Furthermore, the authors thank the finan-

cial support from CNPq (147141/2016-8, 304856/2017-7, 425340/2016-3), CAPES (PROEX/1406880 and PDSE 99999.006380/2015-08) and Fapesp (2015/11937-9, 2016/23552-7).

References
Anshelevich, E., A. Dasgupta, J. Kleinberg, E. Tardos, T. Wexler and T. Roughgarden, The Price of Stability for Network Design with Fair Cost Allocation, in: 45th Annual IEEE Symposium on Foundations of Computer Science, 2004, pp. 295–304.
Cardinal, J. and M. Hoefer, Non-cooperative facility location and covering games, Theoretical Computer Science 411 (2010), pp. 1855–1876.
Chen, H. and T. Roughgarden, Network design with weighted players, Theory Comput. Syst. 45 (2009),
pp. 302–324.
Cole, R., Y. Dodis and T. Roughgarden, Pricing network edges for heterogeneous selfish users, in:
Proceedings of the Thirty-fifth Annual ACM Symposium on Theory of Computing, STOC ’03 (2003),
pp. 521–530.
Devanur, N. R., M. Mihail and V. V. Vazirani, Strategyproof cost-sharing mechanisms for set cover and facility location games, Proceedings of the 4th ACM conference on Electronic commerce - EC ’03 (2003), pp. 108–114.
Epstein, A., M. Feldman and Y. Mansour, Efficient graph topologies in network routing games, Games and Economic Behavior 66 (2009), pp. 115 – 125.
Fanelli, A., M. Flammini and L. Moscardelli, Stackelberg strategies for network design games, in: Proceedings of the 6th International Conference on Internet and Network Economics, WINE 2010 (2010), pp. 222–233.
Goemans, M. X. and M. Skutella, Cooperative facility location games, Journal of Algorithms 50 (2004),
pp. 194–214.
Hansen, T. D. and O. Telelis, On pure and (approximate) strong equilibria of facility location games, in: Internet and Network Economics, 4th International Workshop, WINE 2008, Shanghai, China, December, 2008. Proceedings, 2008, pp. 490–497.
Hansen, T. D. and O. Telelis, Improved bounds for facility location games with fair cost allocation, in: Combinatorial Optimization and Applications, Third International Conference, COCOA 2009, Huangshan, China, June 10-12, 2009. Proceedings, 2009, pp. 174–185.
Hoefer, M., Non-cooperative tree creation, Algorithmica 53 (2007), pp. 104–131.
Kononov, A. V., Y. A. Kochetov and A. V. Plyasunov, Competitive facility location models, Computational Mathematics and Mathematical Physics 49 (2009), pp. 994–1009.
Leonardi, S. and G. Sch¨afer, Cross-monotonic cost sharing methods for connected facility location games, Theoretical Computer Science 326 (2004), pp. 431–442.
Mallozzi, L., Noncooperative facility location games, Operations Research Letters 35 (2007), pp. 151– 154.
Pal, M. and E. Tardos, Group strategy proof mechanisms via primal-dual algorithms, in: Foundations of Computer Science, 2003. Proceedings. 44th Annual IEEE Symposium on, 2003, pp. 584–593.
Rodrigues, F. C. and E. C. Xavier, Non-cooperative capacitated facility location games, Information Processing Letters 117 (2017), pp. 45 – 53.
Rodrigues, F. C. and E. C. Xavier, Non-cooperative facility location games: a survey, Revista de Inform´atica Te´orica e Aplicada 24 (2017).
Vetta, A., Nash equilibria in competitive societies, with applications to facility location, traffic routing and auctions, The 43rd Annual IEEE Symposium on Foundations of Computer Science 2002 Proceedings 43 (2002), pp. 416–425.
