Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 324 (2016) 79–90
www.elsevier.com/locate/entcs

Statistical Correction of the Result of Weather Forecast by Applying the Model Output Calibration
Carlos Amaral H¨olbig1, Vanessa Lago Machado2, Willingthon Pavan3
Graduate Program in Applied Computing (PPGCA) University of Passo Fundo (UPF)
Passo Fundo, Brazil

Abstract
This work describes the simulation models calibration method called Model Output Calibration. In order to verify its effectiveness, presents the application of the MOC in weather forecast correction generated by the Eta 15Km model at CPTEC/INPE. Eta is a regional model for numerical weather prediction. The results of the statistical correction of Eta forecast were positive, with satisfactory improvements in the variables tested (temperature and relative humidity). The use of this approach shows the possibility of gains in the results of simulation models of crops and diseases that use as predictive variables the variables generated by weather forecast models.
Keywords: Statistic correction, Weather forecast, MOC, Eta Model.


Introduction
Simulation models are important tools that act as forecast tools, enabling deci- sions to be made before the events occur. But even with all the developments in techniques for simulation modeling, the accuracy found in the data, in some cases, it is not yet satisfactory, and ultimately influences wrongly data verification.
Numerical weather prediction (NWP) models are composed of weather forecast techniques performed through computational modeling, allowing to analyze and decide on various situations related to weather and climate. These models are divided into global and regional models (limited area). Furthermore, numerical

1 Email: holbig@upf.br
2 Email: 154401@upf.br
3 Email: pavan@upf.br

http://dx.doi.org/10.1016/j.entcs.2016.09.008
1571-0661/© 2016 The Author(s). Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

weather prediction models divide their modeling space in boxes, which are defined by horizontal grids boxes with vertical levels. Thus, assume that the atmosphere is homogeneous in each of these boxes, it is necessary to know only the data of one point per box.
For purposes of this research, the numerical weather prediction model used in our work was the regional model Eta [6], used by the Center for Weather Forecasting and Climate Research (CPTEC 4 ) of the National Institute for Space Research (INPE) in Brazil.
The forecast of this regional model extends up to 264 hours (11 days) are supplied twice a day (at 00:00 and 12:00, UTC time). Eta has grids with 40 km, 15 km, 5 km and 1 km. This model was developed by Mesinger et al. [15] and made operational at the National Centers for Environmental Prediction (NCEP 5 ) [1]. It is a model based on the use of vertical coordinates, which remains approximately horizontal in mountainous areas, making it suitable for studies of steep topography regions, for example, the Andes Mountains [5].
The Eta model is used operationally at CPTEC/INPE since 1997 for weather forecasts [2] and, since 2002, to seasonal climate forecasts [3] in high resolution over South America for horizons of a few days, months or decades, for climate change studies.
The main sources of observed data of Eta model are: meteorological stations, surface stations, airports, ships, aircraft, satellites and radars. These sources are part of the Global Observing System (GOS) [11], as shown in Figure 1. When the observed data are received, some situations may occur, for example, some of the locations may not have measurement data observed at certain hours: caused by a lack of measurement of typing or even failure at the station; another situation is the analysis of unrealistic measurements: sometimes occurs the erroneous data entry in any station. To correct these errors is necessary the treatment of data by, for example, numerical interpolation of missing or unrealistic data available in the databases.
The prognostic variables Eta model are: air temperature, zonal and meridional wind components, specific humidity, surface pressure and turbulent kinetic energy. Thus, the model is proposed to predict atmospheric phenomena in more detail, when associated with these variables, such as storms or fog. As these variables do not have linearity and can vary more frequently in large spaces of time due to climate changes involved, such a prediction is best defined when it occurs in a short time.
This paper describes and analyzes the application of statistical calibration method for simulation models called Model Output Calibration (MOC) with the aim to verify if there is a significant improvement in correcting the result of the forecast the weather forecast model Eta 15km at CPTEC/INPE.
Section 2 will describe some methods for simulation models correction, present- ing its main features. Section 3 will address the Model Output Correction, high-

4 http://www.cptec.inpe.br/
5 http://www.ncep.noaa.gov/



Fig. 1. An illustration of the instruments that comprise the Global Observing System (GOS) [11]
lighting its features and operation. In Section 4, use of the MOC in the correction of forecast generate by Eta model is described and the results obtained with this correction are presented and discussed. Finally, in section 5, the conclusions of this research are presented and aspects of future works to be developed from the results already obtained are discussed.
Correction methods of simulation models
Although forecast methods are becoming more sophisticated, with very accurate results, many of the variables provided by the models depend on variables that are susceptible to changes, such as those generated by actions of nature. According to Mao et al. [14], the temperature forecast models are known to have errors due to its coarse representation of the topographic model and a deficient physical model.
These differences are due to the fact that grid point model consider a single point by grid. Therefore, the model assumes that the climatic variables behave homogeneously within each grid. Although the simulation models will be improved, the weather models are far from perfect. However, in order to reduce these errors, besides the use of grid point mesoscale models in certain regions, some statistical methods have been developed for correcting (calibration) these errors.
The calibration data is the process of identifying possible problems in the forecast model and make adjustments in the calculations (codes). The process of calibration and validation are differentiated by the choice of parameters. Thus, the selection criteria used for data calibration may not be relevant to validate the model. There- fore, the selection of the parameters used for data calibration is a technical issue, where each statistical method is a own way. Among the major correction methods

of simulation models we can cite:
Perfect Prognosis Method (PPM), also known as Perfect Prog: is a method devel- oped by Klein et al. [10] in 1959 and it is the first statistical method for correction of simulated data, which takes into consideration the numerical weather predic- tion by applying multiple linear regression. An aplication of PPM is describe in [17];
Model Output Statistics (MOS): is a method developed by Glahn and Lowry [8]. The MOS consists of determining a statistical relationship between the observed data as predictand and the variables of the numerical model in some time pre- dictions. However, studies have shown that it takes two years of archived data for implementing this model in order to obtain an efficient MOS equation [9]. This fact leads to a deficiency in the model, because the MOS does not offer the possibility of developing a large database, because the numerical models are continuously modified, and for the implementation of MOS, it is necessary that during the filing period for data, the model configuration keep frozen. Compar- isons between MOL and PPM are presented in [12,13];
Calibration Model Output (MOC): was developed by Mao et al. [14] in 1998. It is a method that performs the statistical correction based on multivariate linear regression, as well as MOS and PPM. The main difference in relation to the MOC and the MOS and PPM is their short training period (2-4 weeks) of forecast and observations necessary for performing the correction of the statistical model.

Model Output Calibration
The MOC has as its principle the existence of error in the forecast, which may have been influenced by other output variables of the simulation model. The cor- rection model MOC propose in finding the error of forecast through the application of multivariate linear regression for correction of the simulation model, requiring a training period of 2-4 weeks. Thus, the algorithm is used to estimate the necessary adjustments for the model used, predicting errors and making the refinement of the predicates. Therefore, it is obtained as a result of the correction applied by the MOC error of forecast in relation to a given variable, according to the equation (1):


ΔT(ij)(k)= T(ij)(k) − T∗
(k)	(1)


where T(ij)(k) is a series of forecasts; (k) represents a number of variable values in different periods (k = 1, 2, 3, ..., N ); (i, j) refers to the grid point where the values

are verified i.e., the location; and T∗
(k) refers to the series of observed data. Soon,

with the requirement within a certain period to a certain place, subtracted from
the observed value in the same period and place, are obtained then the error of the forecast. Thus, it is assumed that ΔT(ij)(k) (forecast error) are intrinsically associated with various parameters and model output variables. The forecast error can be a function Xij,l(k), where this is the l − th amount of variables obtained or

derived from a recent model output at the same point grid (i, j), where the predicted error is correlated with the amount of L model outputs.
As an example, Chou et al. [4] show that the statistical correction of the tem- perature forecast there are several associated variables such as soil humidity and surface temperature. Based on these data it is possible to build a multivariate linear regression model, with which it is possible to obtain the error of forecast of model, according to equation (2):
ΔT(ij)(k)= Λo + Σ ΛlXij,l(k)	(2)
l=1
where k = 1, 2, ..., N and l = 1, 2, ..., L. The Λo and Λl coefficients can be defined by the analysis of multivariate linear regression. The ΔT(ij)(k) is predictand equations, that are the dependent variable, and Xij,l(k) are the variables of the model output representing the predictors. According to Mao et al. [14] the selection predictors of MOC occurs with each new forecast cycle, based on a set of candidate variables, ie, with each new round of correction the predictors are selected (equation (2)), unlike other models of statistical correction where predictors are defined a priori.
Therefore, the number of selected predictors (Lc), direct or derivatives, should be less than the number of candidate variables (L). The calibration is applied after correction N +1 where N is the size of the series to calculate the regression coefficients, obtaining thus refined forecast Tmoc(k) as the equation (3):
Tmoc(k)= T(ij)(k) − ΔT(ij)(k)	(3)

where T(ij)(k), is the prediction of the current model and ΔT(ij)(k) is the error in the same point in the grid. Because the MOC require a short period of data to perform the correction adjustment, you can make adjustments in the models even if environmental changes occurred during the forecast period, making it a excellent tool to regional models.
Mao et al. [14] also showed other advantages of using the MOC: is a simple, flex- ible and efficient method; it is based on the latest weather conditions; the selection of predictors occurs objective and in a ideal way, because after predictors and can- didate variables are chosen, the rest of the process occurs objective and iteratively; the algorithm used for statistical correction of the forecasting model is flexible and easy to implement for any model, because the equation is updated in each forecast cycle and is less sensitive to changes or reconfigurations of the model; information from the predictors selection results can be used in diagnostics and tuning of the physical model, because through this selection you can verify the variables that are influencing the forecast error.
Also according to Mao et al. [14], to evaluate if the calibrations forecasts have a satisfactory result, obtaining a significant gain in the relationship between the predicted and observed value are used three basic statistical measures of error: the mean error (BIAS) - (equation (4)), mean absolute error (MAE) - (equation (5)),

and the mean square error of the square root (RMSE) - (equation (6)). Through these measures it is possible to determine the quality of forecasting and calibration, as well as possible to determine strengths and weaknesses of the system.


  1	
BIAS =
Mtotal
Mtotal
(Ti
i=1
Mtotal

— T∗)	(4)

  1	
MAE =
Mtotal
Σ

i=1
|Ti
— T∗|	(5)

,  1	 Mtotal
RMSE =
Mtotal  i=1

(Ti − T∗)2	(6)

In equations (4), (5) and (6), Mtotal is the total amount of adjusted forecasts, Ti is the i − th value adjusted by MOC and T∗ is the i − th observed value. Ti indicates the uncorrected value, thus being equal to that obtained by the forecast model. To analyze the results obtained from BIAS and MAE, as close to zero is the result, the better it is. The result of the RMSE is a non-negative value, however, is more sensitive to large errors because by raising the difference squared, makes negative and positive results will be treated equally [7].
These basic statistical measures of error, presented above, obtain your result in the same unit of the data used in the tests. However, it is often necessary to know the gain obtained with the calibration performed in percentage. For this there is the calculation of Skill Score (SS), according to equation (7), which precisely reflects the improvement percentage of the calibrated result of the forecast model on the outcome of forecast without statistical correction.


Eforecast − EMOC
SS =( 
Eforecast
) × 100%	(7)

where Eforecast and EMOC refer to the error obtained by the model forecast and the error of the calibrated model with the MOC, respectively. Both errors refer to the error obtained by using one of three error statistical measures: BIAS, MAE and RMSE, ie this index (SS) can be calculated for each of the errors measures mentioned above.
Use of MOC in the correction of Eta model forecasts
This section analyzes the results obtained by applying the MOC in the cor- rection of temperature and relative humidity generated by the regional model Eta 15km from December 2015. The locations covered in the analysis are part of a set of 36 Brazilian locations, members of a project between the PPGCA/UPF and CPTEC/INPE allocated to the Brazilian Electric System National Operator (ONS). This project aims to improve the quality of energy load forecasting process in Brazil through these corrections.


Table 1
Daily average surface air temperature (oC) at 2m observed, predicted by the Eta model, adjusted by the MOC and their corresponding error basic statistical measures (BIAS, MAE and RMSE) for the month of December 2015 to METAR stations located in Brazil


The locations covered in the project include meteorological stations located air- ports from capitals and in some cities in the interior of Sao Paulo State and in the South region from Brazil, regions where the demand for energy because of agricul- ture and irrigation process is more significant. The current computer system was developed for the Linux operating system, using Linux shell scripts and Fortran language. For the statistical analysis is used statistical language R [16].
During the data analysis period it was possible to identify possible problems in the forecast generated by Eta model, where the forecast results, in some cases, proved to be far from the observed data, as can be observed in respect of air tem-


Table 2
Daily average relative humidity (%) observed, predicted by the Eta model, adjusted by the MOC and their corresponding error basic statistical measures (BIAS, MAE and RMSE) for the month of December 2015 to METAR stations located in Brazil


perature in some METAR stations, such as SBBH, SBCG, SBFI, SBMN, SBSL and SBTE. Complete data for all stations are shown in Table 1. This table shows the observed data, provided by the Eta model and corrected by MOC method. In Table 2 presents the complete data for relative humidity and, even in this case, the same potential problems reappear, as shown for example in METAR stations SBBH, SBFZ, SBJP, SBSV, SBSL and SBGR.
Refinement obtained by MOC suggests an improvement in the data, as can be verified, for example, in the stations in Belo Horizonte (SBBH), S˜ao Lu´ıs (SBSL) and Fortaleza (SBFZ) cities (Figures 2, 3 and 4, respectively). These blue curves in


Table 3
Skill score of measures BIAS, MAE and RMSE related to daily average air temperature and relative humidity for the month of December 2015 to METAR stations located in Brazil

the figures refer to the data observed in the meteorological station, the red curves refer to the measures provided by the Eta model and the green curves refer to corrected data by MOC.
The average daily cycle of air temperature and relative humidity may indicate periods of the day that errors often occur in the forecast at model Eta where it was observed that, in general, the temperature forecast correctly follows the amplitude variation, but however, the most of the time, underestimated the measures. In the relative humidity forecast, the largest errors occur between 00:00 and 9:00 am, when the measures forecast by Eta have been overestimated.
Table 3 shows the values of the Skill Score for the corrections performed. In






Fig. 2. Average daily cycle of the air temperature at 2m (oC) and relative humidity (%) from December 2015 in METAR station SBBH located in the city of Belo Horizonte




Fig. 3. Average daily cycle of the air temperature at 2m (oC) and relative humidity (%) from December 2015 in METAR station SBFZ located in the city of Fortaleza

this table can be noted the gain obtained with the application of the MOC in most locations analyzed, which demonstrates the good potential for use of MOC in correction of weather forecast generated by Eta model.

Conclusions and future works
This paper presents the use of the method Model Output Calibration for statis- tical refinement in a numerical weather prediction model, verifying its effectiveness in the use over the Eta model. The application of refinement showed a positive improvement over the forecast uncorrected from Eta model, enabling an improve- ment in the quality of the result of the forecast. The short training period required for carrying out the calibration and therefore its easy adaptation to changes in the model to be corrected is one of its advantages over other calibration methods.






Fig. 4. Average daily cycle of the air temperature at 2m (oC) and relative humidity (%) from December 2015 in METAR station SBSL located in the city of S˜ao Lu´ıs

On average, the errors of the forecast temperature of Eta model did not ex- ceed the magnitude of 2oC, but generally underestimated the observations, mainly during the morning. On the other hand, the relative humidity was generally overes- timated during the night period and underestimated during the day. The tendency to produce more saturated air during the night can be a result of underestimation of temperature forecasts at some stations. While the tendency to produce excessively dry air during the day seems to be derived from error in the estimate of specific humidity (amount of steam per total air volume) by the model. In stations in which prediction errors were considered relatively small, generally the correction scheme eventually produced an error.
The largest temperature errors occurred in stations where the model grid box used for comparison was far from the point of observation. Numerical forecasts of dynamic models always contain errors. The extracted information model grid represents the average inside that grid, and the average value of the time step of the integration model. The comparison of average information to the specific measure provided by observation is already an inconsistency and an error factor.
As future works, this research enables you to check the validity of using the Eta model forecast data corrected by MOC and the gains that can be achieved if when they are used in simulation models of crops and diseases that are used in research developed at PPGCA/UPF in partnership with Embrapa Trigo, the University of Florida and the CPTEC/INPE.

References
Black, T.L., The new NMC mesoscale Eta model: Description and forecast examples, Weather and Forecasting, 9(2) (1994), 265–278, URL:
http://journals.ametsoc.org/doi/abs/10.1175/1520-0434(1994)009%3C0265%3ATNNMEM%3E2.0.CO%3B2.

Chou, S.C., Modelo Regional Eta. Climan´alise, Especial Edition, Instituto Nacional de Pesquisas Espaciais, vol.1, 1996.


Chou, S.C., and Bustamante, J.F. and Gomes, J.L., Evaluation of Eta Model Seasonal Precipitation Forecasts over South America, Nonlinear Processes in Geophysics. 12 (2005), 537–555, DOI: http://dx.doi.org/10.5194/npg-12-537-2005.
Chou, S. C., Souza, C. R., Gomes, J. L., Evangelista, E. F. D., Os´orio, C. and Cataldi, M., Refinamento estat´ıstico das previs˜oes hor´arias de temperatura a 2m do modelo Eta em esta¸c˜oes do nordeste do Brasil, Revista Brasileira de Meteorologia, 22(3) (2007), 287–296.
Chou, S. C., Lyra, A., Mour˜ao, C., Dereczynski, C., Pilotto, I., Gomes, J.L., Bustamante, J., Tavares, P., Silva, A., Rodrigues, D., Campos, D., Chagas, D., Sueiro, G., Siqueira, G., Nobre, P. and Marengo, J.,  Evaluation of the Eta Simulations Nested in Three Global Climate Models, American Journal of Climate Change, 3(05) (2014), 438–454, URL: http://www.scirp.org/journal/PaperInformation.aspx?PaperID=52877.
INPE.	Eta	Model,	Instituto	Nacional	de	Pesquisas	Espaciais,	2016,	URL:
http://etamodel.cptec.inpe.br.
Ferreira, S. P., Varone, F. and Alvez, R. C. M., Uso do TRMM para a correc¸˜ao estat´ıstica da chuva prevista pelo modelo BRAMS, IV Simp´osio Brasileiro de Ciˆencias Geod´esicas e Tecnologias da Geoinforma¸c˜ao (2012), 01–09.
Glahn, H. R. and Lowry, D. A., The use of model output statistics (mos) in objective weather forecasting, J. Appl. Meteor., 11 (1972), 1203–1211.
Jacks, E. J. B., Bower, V. J., Dagostro, J. P., Dallavalle, M. C. and Erickson, J. C. S., New ngm-based mos guidance for maximum/minimum temperature, probability of precipitation, cloud amount, and sea surface wind, Wea. Forecasting, 5 (1990), 128–138.
Klein, B., Lewis, M. and Enger, I., Objective prediction of 5 day mean temperature during winter,
Journal of Meteorology, 16 (1959), 672–682.
Laing, A. and Jenni-Louise Evans, J., “Introduction to Tropical Meteorology,” 2nd Ed., University Corporation for Atmospheric Research, Boulder (2011), URL:
http://www.goes-r.gov/users/comet/tropical/textbook 2nd edition/index.htm.
Maini, P., Kumar, A., Rathore, L.S. and SINGH, S.V., Forecasting Maximum and Minimum Temperatures by Statistical Interpretation of Numerical Weather Prediction Model Output, Weather and Forecasting, 18, (2003), 938–952, URL:
http://journals.ametsoc.org/doi/pdf/10.1175/1520-0434(2003)018%3C0938%3AFMAMTB%3E2.0.CO%3B2.
Marzban, C., Sandgathe, S. and Kalnay, E., MOS, Perfect Prog, and Reanalysis, Monthly Weather Review, 134, (2006), 657–663, URL: http://journals.ametsoc.org/doi/pdf/10.1175/MWR3088.1.
Q. Mao, R. T. McNider, S. F. Muellere, and H. Juang, An optimal model output calibration algorithm suitable for objective temperature forecasting, American Meteorological Society, 14 (1998), 190–202.
Mesinger, F., Janji´c, D. A., Niˇckovi´c, S., Gavrilov, D. and Deaven, D. A., The step-mountain coordinate: Model description and performance for cases of alpine lee cyclogenesis and for a case of an appalachian redevelopment, Monthly Weather Review, 7(116) (1988), 1493–1518.
R Core Team, “R: A language and environment for statistical computing”, R Foundation for Statistical Computing: Vienna, 2016, URL: https://www.r-project.org/.
Rajeevan, M., Madhulatha, A., Rajasekhar, M., Bhate, J., Kesarkar, A. and Appa Rao, B.V.,  Development of a perfect prognosis probabilistic model for prediction of lightning over south-east India, Journal of Earth System Science, 121(2) (2012), 355–371, DOI: http://dx.doi.org/10.1007/s12040-012-0173-y.
