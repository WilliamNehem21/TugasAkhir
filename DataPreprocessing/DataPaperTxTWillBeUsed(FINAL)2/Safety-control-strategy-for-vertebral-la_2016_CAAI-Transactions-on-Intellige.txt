Available online at www.sciencedirect.com
ScienceDirect


CAAI Transactions on Intelligence Technology 1 (2016) 249e258
http://www.journals.elsevier.com/caai-transactions-on-intelligence-technology/
Original Article
Safety control strategy for vertebral lamina milling task
Luping Fan a,b,c, Peng Gao b,c, Baoliang Zhao b,c, Yu Sun a,b,c, Xiaoxiao Xin a,b,c, Ying Hu b,c,*,
Shoubin Liu a, Jianwei Zhang d
a Shenzhen Graduate School, Harbin Institute of Technology, Shenzhen, China
b Shenzhen Institutes of Advanced Technology, Chinese Academy of Sciences, Shenzhen, China
c CAS Key Laboratory of Human-Machine Intelligence-Synergy Systems, Shenzhen Institutes of Advanced Technology, Shenzhen, China
d University of Hamburg, Hamburg, Germany
Available online 5 November 2016

Abstract
Vertebral lamina milling task is one of the high-risk operations in spinal surgeries. The operation is to remove part of vertebral lamina and release the pressure on the spinal nerve. Because many important vessels and nerves are under the vertebral lamina, any incorrect operation may cause irreparable damage to patients. To improve the safety of lamina milling task, a fuzzy force control strategy is proposed in this paper. Primary experiments have been conducted on bone samples from different animals. The results show that, with the fuzzy force control strategy, the bone milling system can recognize all surgery states and halt the tool at the proper location, achieving satisfactory surgery performance. Copyright © 2016, Chongqing University of Technology. Production and hosting by Elsevier B.V. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

Keywords: Safety control; Force feedback; Fuzzy logic control; Vertebral lamina milling; Spinal surgery



Introduction
Advances in science and technology have led to the use of various robots in the field of medical application. In recent years, surgical robots have been widely applied in different types of orthopedic surgery, such as laminectomy, total knee arthroplasty, artificial disc replacement [1e3], etc. Spinal surgery is believed to be high-risk since any damage to the spinal cord may cause paralysis or even death to the patients. Traditionally, the spinal surgery is performed manually, and the long duration time will cause surgeons' fatigue, reducing the surgery quality.
Laminectomy is to restore the function of the compressed spinal nerve by expanding the spinal canal space. The

* Corresponding author. Xueyuan Avenue 1068, Shenzhen 518055, Guangdong, China.
E-mail addresses: lp.fan@siat.ac.cn (L. Fan), peng.gao@siat.ac.cn (P. Gao), bl.zhao@siat.ac.cn (B. Zhao), yu.sun@siat.ac.cn (Y. Sun), xx.xin@ siat.ac.cn (X. Xin), ying.hu@siat.ac.cn (Y. Hu), mesbliu@hitsz.edu.cn (S. Liu), zhang@informatik.uni-hamburg.de (J. Zhang).
Peer review under responsibility of Chongqing University of Technology.
vertebral lamina milling operation is regarded as one of the most critical and risky operations. In the surgery, the surgeon needs to hold the high-speed-rotating bone drill to mill the vertebral lamina from the surface to the inner cortical bone, removing the spike process part and releasing the pressure on the spinal nerve [4,5] (Fig. 1).
Laminectomy has been widely used to treat patients with lumbar spinal stenosis [7,8], to release the oppressed spinal nerve and recover the function of spinal cord. The key to the success of Laminectomy is to ensure the proper amount of lamina remained. Too small amount of residual volume may cause harm to the spinal canal and spinal nerve, and too large amount cannot achieve the effect of spinal nerve decompression [9].
Researchers have tried using robots to assist surgeons to improve the surgery accuracy and efficiency. An Israel com- pany has marketed a parallel robot to help surgeons to guide the tools and implants (Renaissance Guidance System, Mazor Robotics®, Caesarea, Israel) [10]; Ortmaier has designed a robot for accurate placement of pedicle screws with the help of an optical navigation system [11]; Chung has designed a robot to insert pedicle screws in the spinal fusion procedure [12]; Hu


http://dx.doi.org/10.1016/j.trit.2016.10.005
2468-2322/Copyright © 2016, Chongqing University of Technology. Production and hosting by Elsevier B.V. This is an open access article under the CC BY-NC- ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).



Fig. 1. The laminectomy operation [6].


has developed a spinal surgical robot and successfully recog- nized the different states during the pedicle screw insertion process with a real-time force sensing algorithm [13]. For the vertebral lamina milling task, some safety control strategies have been studied. Wang et al. [14,15] milled the vertebral layer by layer from the outer cortical bone to the inner cortical bone at a constant depth. Based on the analysis of typical characteristic parameters of the force profiles, the cross- correlation to the standard profiles are adopted to judge the milling status. Because this method was unable to adapt to the complex surfaces of the vertebrae, the profile pattern is in close relation to the three-layer structure, which is to the disadvantage of milling status distinguishment. Zhang et al.
proposed a fuzzy logic control method for bone drilling operation to treat laminectomy. Based on surgeons' experi- ence，the database of fuzzy rules was established. The pres- sure on the drill and the thickness of the bone are set as input,
the drilling depth and drilling velocity are set as output. The fuzzy logic control system was simulated with MATLAB and SIMULINK, and the result showed its feasibility. Deng et al.
designed a fuzzy force controller for vertebral lamina milling operation. The force control was implemented to adjust the milling parameters to adjust for the complex anatomical structure of the vertebral lamina. For safety pur- poses, a state detection method based on energy consumption was also proposed. The results of contrast experiments showed that the milling operation under fuzzy force control took shorter time and was with more stable longitudinal contact force. The state detection method could detect the three milling states successfully, resulting in an acceptable vertebral lamina residue.
In this paper, we firstly describe the anatomical structure of the vertebral lamina and the milling procedure. Then, the fuzzy force control theory is introduced. The milling force in the horizontal direction is controlled constant, and the milling force in the vertical direction is used to distinguish the struc- ture of the bone layer. The principle of milling state dis- tinguishment is established through six groups of vertebral
lamina milling experiments. Then, twelve groups of experi- ments are conducted to validate the robustness of the safety control strategy based on this principle.
The paper is organized as follows. The fuzzy force control strategy is proposed in Section 2 and 3. The principle of milling state distinguishment is established and validated in Section 4 and 5. The conclusions are presented in Section 6.

Safety control strategy
In laminectomy, vertebral lamina milling is the key and most difficult procedure. Orthopedists must handle the tool to mill vertebral lamina very carefully to ensure that the pressure on the spinal nerve is relieved but the spinal nerve and its surrounding vessels are not damaged. During the vertebral lamina milling operation, the bone drill needs to drill through the outer cortical bone, cancellous bone, and the inner cortical bone (Fig. 2). During the actual operation, if not controlled well, the bone drill may drill through the inner cortical bone and seriously damage the spinal cord and nerves, this will cause paralysis or even death of the patients (Fig. 3). There- fore, it is very important to detect the milling state and ensure the safety in a robot-assisted surgery.

Fig. 2. Physiological structure of lamina.



The interacting force between the bone drill and vertebral lamina is affected by many factors during the milling operation. It mainly includes: bone density, rotating speed, milling speed and milling depth. In our case, the milling speed and the rotating speed of bone drill are both set to a constant value. With the bone drill mills different layers and the milling depth changes, the interacting force between the vertebrae lamina and bone drill will change. During the milling operation, the bone drill needs to work on three bone layers including outer cortical bone, cancellous bone and inner cortical bone. The bone density of the cortical bone is larger than that of the cancellous bone [18,19]. With the same milling depth, the interacting force be- tween bone drill and cortical bone is larger than that of the cancellous bone. The interacting force between the bone drill and vertebral lamina is analyzed to recognize the milling state. During the milling operation, the bone drill mills along the surface of the vertebral lamina, and the milling force can be decomposed into two components: axial force Fy and tangential force Fz (Fig. 4). To ensure the safety of the surgery, a safety control strategy based on fuzzy logic is proposed (Fig. 5). At the beginning of milling operation, an initial milling depth is given, and the tangential force with this milling depth is set to be the reference value. The real-time tangential force signal is intro- duced into the fuzzy logic controller. By adjusting the milling depth of the bone drill, the tangential force is kept in a constant range. At the same time, the axial force signal generated in milling operation is used to estimate the state of the vertebral lamina milling; if the bone drill is milling in the outer cortical bone layer and cancellous bone layer, the milling operation continues; if the bone drill is milling in the inner cortical bone
layer, the milling operation stops.

Fuzzy force control
Fuzzy control system is a closed loop control system based on fuzzy language representation and logic inference. Its core component is fuzzy logic controller (FLC) [20]. It transforms the measured values by various sensors into the fuzzy quan- tities suitable for the fuzzy operation. Then fuzzy rules are constructed to infer the output result. In the end, the fuzzy quantity in the operation result is converted to the exact quantity, in order to carry out the specific operation of the actuator control (Fig. 6). Since the control output of the fuzzy logic control system is calculated from the fuzzy inference, it

Fig. 3. Dangerous operation [4].


Fig. 4. Analysis of the milling force.

Fig. 5. Safety control strategy.


does not need the system mathematical model. The parameters of the membership functions and fuzzy rules need to be planned by the expert or based on experience [21].
In order to test the safety control strategy presented in this paper, the milling experiments have been conducted with the three-axis robot system. The experiment setup is shown in
Fig. 7. The bone mill is with diameter of ∅4 mm and its rotating speed can be regulated from 0 r/min to 80000 r/min.
The interacting force between the bone dill and bone sample is measured by the force/torque sensor with sampling frequency of 1000 Hz. The milling speed is 1.5 mm/s, the initial milling depth is 0.5 mm.
The original force signal is noisy, caused by motor vibra- tion, so the collected force signal needs to be filtered before subsequent processing. In this study, recursion average filtering is used to process the original force signal. Fig. 8 shows the filtering result of the original force signal.
The force controller is based on admittance control, con- structed with milling depth Vd, horizontal milling force FZ and reference milling force Fref, as shown in Eqs. (1) and (2).
Vd = Ge FZ — Fref	(1)



Fig. 6. The structure of fuzzy logic controller.

e = Fref — FZ	(3)

ec = ei — ei—1	(4)


















Fig. 7. Milling experiments.
Vd = y — yref	(2)
Where Ge is the contact admittance between the ends of the bone drill and the lamina, y and yref are the actual space co- ordinate and the reference space coordinate of the bone drill in the direction of milling depth for the bone drill.
We define linguistic variables “E” in the domain of system
u = Vd	(5)
Fuzzification is the first step of fuzzy combiner, which transforms the input and output variables into the fuzzy quantity. In the discrete domain, the input and output variables are denoted as {—6, —5, —4, —3, —2, —1, 0, 1, 2, 3, 4, 5, 6},
respectively. Their corresponding fuzzy quantities are defined for the rule base as {NB (negative big), NM (negative middle), NS (negative small), ZO (zero), PS (positive small), PM (positive middle), PB (positive big)} [19].
The values of the e and u are scaled to the interval of [—0.5, 0.5] and the interval of [—0.09, 0.09] for the ec, as shown in Eqs. (6)e(11).
e = [eL , eH]= [ — 0.5, 0.5]	(6)

ec = [ecL , ecH]=[ — 0.09, 0.09]	(7)

u = [uL , uH]=[ — 0.5, 0.5]	(8)

error e. We define the linguistic variable “Ec” in the domain of the error changing rate ec. We define the linguistic variable “U” in the domain of control u, as shown in Eqs. (3)e(5).
ke =
H
12
— eL
12
= 0.5 + 0.5	(9)




Fig. 8. Original force signal and its short-time recursion average.



kec = ec
12
— ecL
12
= 0.09 + 0.09 = 66.67	(10)
Table 1
The rule base for FLC.

uH — uL	0.5 + 0.5
k =	=	= 0.08	(11)
u	12	12

where ke
and kec
denote the quantization factors of input, and

ku denote the scaling factor of output.
After fuzzification, fuzzy inference is used to establish the fuzzy rules. In this study, the triangular membership function is used for all variables, as shown in Fig. 9.
The fuzzy rules are constructed using if-then statements, and 49 rules are defined to form the fuzzy rule base for the fuzzy combiner, as shown in Table 1.
FLC is developed using the Fuzzy Logic Toolbox for MATLAB and Simulink. Surface viewer is utilized for the determination of the characteristics of the proposed fuzzy controller, as shown in Fig. 10.
In order to show the advantages of fuzzy force control strat- egy, two groups of experiments have been conducted on the same bone sample, which is a vertebra bone of pig with thickness of 57 mm. The rotating speed of the bone drill is set to be 15000 r/ min. In the first experiment, the milling depth remains constant; the bone drill mills down 0.5 mm layer by layer, until the inner cortical bone. In the second experiment, the milling depth is adjusted with the tangential milling force based on fuzzy control strategy, keeping the tangential force a constant value.
The milling force signals of the two experiments are shown in Figs. 11 and 12. There are 10 layers in Figs. 11 and 7 layers in Fig. 12 in the milling process until milling to the inner cortical bone. Comparing the two figures, it is noticed that the experi- ment with fuzzy force control has less milling layers (meaning less time used) and obtains a more regulated drill-bone inter- acting force, which will benefit the milling operation [22].

State recognition of vertebral lamina milling
To ensure the safety of milling operation, the bone drill needs to stop when it gets to the inner cortical bone. To obtain the relationship between the axial force and the state recog- nition, the experiment below has been conducted. Three kinds of bone samples including vertebra of pig, vertebra of sheep and vertebra of cattle are used in the experiment, with bone drill rotating speed of 15000 r/min and 20000 r/min separately. The initial milling depth is set to be 0.5 mm, and the tangential force during the milling operation is controlled to be constant with the fuzzy logic. The mean value of the axial force is

Fig. 9. Membership functions of the input and output variables.








Fig. 10. Surface viewer.




Fig. 11. Result of the first experiment.



Fig. 12. Result of the second experiment.

recorded for each layer, until the bone drill gets to the inner cortical bone. Table 2 shows that the axial milling forces are different on different bone samples and the force value is also affected by drilling speed.
To prove that the surgical system can detect the milling states for all the cases, the data is normalized. By using the normalized mean feature, the characteristic parameter range of the axial force is mapped to the [0, 1], as shown in Fig. 13.
After normalizing the data of these 6 groups, we found that the axial force of the cancellous layer are always in the range of (0.4, 0.5) and the axial force of the cortical layer are always greater than 0.9.
With the above experimental results, we has obtained the relationship between the axial force and milling state, and the
control program is written，as shown in Fig. 14. Firstly pa- rameters are initialized, then the system starts milling opera- tion. In the initial milling stage, S = 1, the bone drill is
located in the outer cortical bone. The average milling force of the first two layers is used to determine the maximum milling force Fo.


Table 2
Axial milling force (unit: Newton).
Sample	Vertebra of pig (depth 6.5e 8.5 mm)



Vertebra of sheep (depth 6.6e
9.0 mm)



Vertebra of cattle (depth 8.7e
10 mm)












Fig. 13. Normalized axial force.








Table 3
Experimental date of axial milling force (unit: Newton).
Sample	Vertebra of pig	Vertebra of sheep	Vertebra of cattle	Vertebra of pig	Vertebra of sheep	Vertebra of cattle


Table 4 Experimental result.

Fig. 15. Normalized force features in different milling situations.

L. Fan et al. / CAAI Transactions on Intelligence Technology 1 (2016) 249e258	257


When the average milling force of the i-th layer is less than Fo/2, S = 2. Bone drill is located in the cancellous bone, the milling operation continues. When the milling force is larger than 0.9*Fo, S = 3. The bone drill is located in the inner cortical bone, the milling operation stops immediately.

Experiment validation
According to the surgeons' experience, the vertebra lamina residue with thickness of 1e2 mm can meet the safety requirement of the operation, and the surgeons can easily open the spinal canal wall.
In order to verify the effectiveness of the safety control strategy in the lamina milling operation, we conducted 6 groups of experiments, 2 times in each group, with parameters shown in Table 4.
The experimental method is based on the three-axis robot system, using the vertebra of pig, vertebra of sheep, and vertebra of cattle for the milling experiment. We check the state of the milling process and measure the residual lamina thickness.
Table 3 shown the data collected with the 6 groups of ex- periments. In Fig. 15, the test data are normalized, and it is clearly shown that the normalized force feature of 0.4e0.5 for the milling in cancellous bone, and the normalized force feature higher than 0.9 for the milling in cortical bone. The data trend in Fig. 15 is similar to that in Fig. 13.
The experimental result is shown in Table 4. By measuring the thickness of the residual lamina, we found that the experimental results of the 6 groups are all located between 1 and 2 mm, which guarantees the safety of the vertebral lamina milling operation.

Conclusions
In this study, a safety control strategy based on fuzzy force control is proposed for vertebral lamina milling task. The anatomical structure of the vertebral lamina is described and the interacting force between the bone drill and the lamina is analyzed. The milling force in the horizontal direction is controlled constant with fuzzy force control logic, and the milling force in the vertical direction is used to distinguish the structure of the bone layer. Through several experiments on different bone samples, the milling state distinguishment principle is recognized, and by data normalization, a safety control strategy is designed and validated. The experiment results shows that, with the control strategy proposed in this paper, the system can obtain a regulated bone-tool interacting force and take less milling time. The state detection method can protect the vertebral lamina from being milled through and ensure an acceptable thickness of vertebral lamina residue.

Acknowledgements
This research is supported by the National Nature Science Foundation of China (No. 61573336, 61473278), National High-tech R&D Program of China (No. 2015AA043201), Key Fundamental Research Program of Shenzhen (No. JCYJ20150529143500954).

References
S. Wang, P. Gao, L. Fan, et al., J. Med. Devices 10 (3) (2016) 030924.
C. Plaskos, P. Cinquin, S. Lavallee, et al., Int. J. Med. Robotics Comput. Assisted Surg. 1 (4) (2005) 67e79.
H. Tian, D. Wu, Z. Du, et al., Design and analysis of a 6-DOF parallel robot used in artificial cervical disc replacement surgery, in: IEEE In- ternational Conference on Information and Automation, 2010.
M.S. Patel, M. Newey, P. Sell, Bone Jt. J. 97-B (3) (2015) 366e371.
E.Y.L. Teo, B.S. Kelley, I.H. Black, J. Clin. Anesth. 26 (8) (2014) 606e610.
T. Osa, C.F. Abawi, N. Sugita, et al., IEEE/ASME Trans. Mechatron. 20
(6) (2015) 3018e3027.
Z. Ghogawala, J. Dziura, W.E. Butler, et al., N. Engl. J. Med. 374 (15) (2016) 1424e1434.
G.M. Overdevest, W. Jacobs, C. Vleggeert-Lankamp, Cochrane Database Syst. Rev. 24 (10) (2015) 2244e2263.
J. Chen, N.J. Shen, M.X. Lin, et al., Orthop. J. China 16 (19) (2008) 1510e1511.
http://www.mazorrobotics.com/surgeons/how-it-works/,visited on 11/6/ 2015.
T. Ortmaier, H. Weiss, U. Hagn, et al., A hands-on-robot for accurate placement of pedicle screws, in: IEEE International Conference on Ro- botics and Automation, 2006.
G.B. Chung, S. Kim, S.G. Lee, et al., Int. J. Control Automation Syst. 4
(1) (2006) 30e41.
Y. Hu, H. Jin, L. Zhang, et al., IEEE-ASME Trans. Mechatron. 19 (1) (2014) 357e365.
T.M. Wang, S. Luan, L. Hu, et al., Med. Robot. Comput. Assist. Surg. 6
(2) (2010) 178e185.
T.M. Wang, J.L. Zhang, Z.J. Liu, et al., Robot 29 (5) (2007) 463e468.
J.L. Zhang, T.M. Wang, S. Luan, et al., Mater. Sci. Technol. 14 (2006) 77e82.
Z. Deng, H.Y. Jin, Y. Hu, et al., Mechatronics 35 (2016) 1e10.
D.T. Reilly, A.H. Burstein, J. Bone Jt. Surg. (1974) 1001e1022.
X. Banse, T.J. Sims, A.J. Bailey, J. Bone Mineral Res. 17 (9) (2002) 1621e1628.
C.C. Lee, IEEE Trans. Syst. Man. Cybern. 20 (Apr. 1990) 404e418.
P.J. King, E.H. Mamdani, Automatica 13 (3) (1977) 235e242.
H.C. Shin, Y.S. Yoon, J. Biomech. 39 (1) (2006) 33e39.

LupingFan was born in Hebei, China. He received the B.S. degree in mechanical engineering from Hunan University of Technology, Zhuzhou, Hunan,
China, in 2013and he is currently pursuing the M.S. degree in mechanical engineering from Harbin Insti- tute of Technology, Shenzhen, China. He is currently a guest student in Shenzhen Institutes of Advanced Technology, Chinese Academy of Sciences (Shenz- hen, Guangdong, China). His research interest is surgical robots.



Peng Gao received the Bachelor's and Master's de- grees from the hebei university of engineering, Han- dan, China, in 2010 and 2013, respectively. He is currently a engineer in the Center for Cognitive
Technology, Shenzhen Institute of Advanced Tech- nology, Chinese Academy of Sciences, Shenzhen. His research interest include surgical robot, parallel robot and optimal design of robot.



Baoliang Zhao was born in Hebei, China. He received the B.S. degree in mechanical engineering from Yanshan University, Qinhuangdao, Hebei, China, in 2008 and M.S. degree in mechanical en-
gineering from Tongji University, Shanghai, China, in 2011. He completed the Ph.D. degree in me- chanical engineering and applied mechanics at the University of NebraskaeLincoln, Lincoln, NE, USA in 2015. He is currently a postdoctor in Shenzhen Institutes of Advanced Technology, Chinese Acad- emy of Sciences (Shenzhen, Guangdong, China).
His research interests include haptics, teleoperation, surgical robots and rehabilitation robots.



Yu Sun received the Bachelor's and Master's degrees from Harbin Institute of Technology, China, in 2012 and 2015, respectively. He is the Ph.D student in Harbin Institute of Technology Shenzhen Graduate
School, China, from 2015. He is currently a guest Ph.D student in Shenzhen Institutes of Advanced Technology, Chinese Academy of Sciences (Guang- dong, China). His research interests include surgical robots, image navigation, control and signal pro- cessing and analysis.




Xiaoxiao Xin was born in Henan, China. She received the B.S. degree in mechanical engineering from North China University of Water Resources and Electric Power, zhengzhou, China. She is currently
studying in Harbin Institute of Technology. Shenzhen, China. She is currently a guest student in the Center for Cognitive Technology, Shenzhen Institute of Advanced Technology, Chinese Academy of Sci- ences, Shenzhen. Her research interests is surgical robots.
Ying Hu (M'11) received the B.S. degree from Shanghai Jiaotong University, Shanghai, China, in 1991, and the M.S. and Ph.D. degrees in mechanical engineering from Harbin Institute of Technology,
Shenzhen, China, in 1998 and 2007, respectively. She is currently a Professor in the Center for Cognitive Technology, Shenzhen Institute of Advanced Tech- nology, Chinese Academy of Sciences, Shenzhen. She is the author or coauthor of more than 60 scientific papers published in refereed journals and conference proceedings. Her research interests include parallel
robots, medical assistant robots, and mobile robots.

Shoubin Liu received the Bachelor's and Master's degrees from Shandong University China, in 1985 and 1990 respectively, and the Ph.D. degree from City
University of Hong Kong. He is currently a associate Professor in Harbin Institute of Technology Shenz- hen, China.







Jianwei Zhang (M'91) received the Bachelor's and Master's degrees from the Department of Computer Science, Tsinghua University, Beijing, China, in 1986 and 1989 respectively, and the Ph.D. degree from the
Department of Computer Science, Institute of Real- Time Computer Systems and Robotics, University of Karlsruhe, Karlsruhe, Germany, in 1994. He is currently a Professor and Head of the TAMS Group, University of Hamburg, Hamburg, Germany. His research interests include multimodal perception, robot learning, and mo- bile service robots. In these areas he has published more
than 200 journal and conference papers, technical reports, four book chapters, and two research monographs. Dr. Zhang has received several awards, including the IEEE ROMAN and IEEE AIM Best Paper Awards.
