Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 346 (2019) 425–436
www.elsevier.com/locate/entcs
On the Unavoidability of Oriented Trees
Franc¸ois Dross1 and Fr´ed´eric Havet2
Projet Coati, I3S,
CNRS, INRIA et Universit´e Cˆote d’Azur Sophia-Antipolis, France

Abstract
A digraph is n-unavoidable if it is contained in every tournament of order n. We first prove that every arborescence of order n with k leaves is (n + k − 1)-unavoidable. We then prove that every oriented tree of
order n with k leaves is ( 3 n + 3 k − 2)-unavoidable and ( 9 n − 5 k − 9 )-unavoidable, and thus ( 21 (n − 1))-
2	2	2	2	2	8
unavoidable. Finally, we prove that every oriented tree of order n with k leaves is (n + 144k2 − 280k + 124)- unavoidable.
Keywords: Tournament, oriented trees, unavoidability, Ramsey theory.


Introduction
A tournament is an orientation of a complete graph. A digraph is n-unavoidable if it is contained (as a subdigraph) in every tournament of order n. The unavoid- ability of a digraph D, denoted by unvd(D), is the minimum integer n such that D is n-unavoidable. It is well-known that the transitive tournament of order n is 2n−1-unavoidable and thus every acyclic digraph of order n is 2n−1-unavoidable. However, for acyclic digraphs with few arcs better bounds are expected. Special attention has been devoted to oriented paths and oriented trees, which are orientations of paths and trees respectively.
It started with R´edei’s Theorem [14] which states that the unavoidabilty of the directed path on n vertices, is n. In 1971, Gru¨nbaum studied the antidirected paths that are oriented paths in which every vertex has either in-degree 0 or out- degree 0 (in other words, two consecutive edges are oriented in opposite ways). He proved [6] that the unavoidability of an antidirected path of order n is n unless n = 3 (in which case it is not contained in the directed 3-cycle) or n = 5 (in

1 Email: francois.dross@inria.fr
2 Email: frederic.havet@inria.fr

https://doi.org/10.1016/j.entcs.2019.08.038 1571-0661/© 2019 Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

which case it is not contained in the regular tournament of order 5) or n = 7 (in which case it is not contained in the Paley tournament of order 7). The same year, Rosenfeld [16] gave an easier proof and conjectured that there is a smallest integer NP > 7 such that unvd(P )= |P | for every oriented path of order at least NP . The condition NP > 7 results from Gru¨nbaum’s counterexamples. Several papers gave partial answers to this conjecture [1,5,17] until Rosenfeld’s conjecture was verified by Thomason, who proved in [18] that NP exists and is less than 2128. Finally, Havet and Thomass´e [11], showed that unvd(P ) = |P | for every oriented path P except the antidirected paths of order 3, 5, and 7.
Regarding oriented trees, Sumner (see [15]) made the following celebrated con- jecture.
Conjecture 1.1 Every oriented tree of order n > 1 is (2n − 2)-unavoidable.
The first linear bound was given by H¨aggkvist and Thomason [7]. Following improvements of Havet [8] and Havet and Thomass´e [10], El Sahili [4] used the notion of median order, first used as a tool for Sumner’s conjecture in [10], and proved that every oriented tree of order n (n ≥ 2) is (3n− 3)-unavoidable. Recently, Ku¨hn, Mycroft and Osthus [13] proved that Sumner’s conjecture is true for all sufficiently large n. Their complicated proof makes use of the directed version of the Regularity Lemma and of results and ideas from a recent paper by the same authors [12], in which an approximate version of the conjecture was proved. In [10], Havet and Thomass´e also proved that Sumner’s conjecture holds for arborescences. An in-arborescence, (resp. out-arborescence) is an oriented tree in which all arcs are oriented towards (resp. away from) a fixed vertex called the root. An arborescence is either an in-arborescence or an out-arborescence.
If true, Sumner’s conjecture would be tight. Indeed, the out-star S+, which is the digraph on n vertices consisting of a vertex dominating the n − 1 others, is not contained in the regular tournaments of order 2n − 3. However, such digraphs have many leaves. Therefore Havet and Thomass´e (see [9]) made the following stronger conjecture than Sumner’s one.
Conjecture 1.2 Every oriented tree of order n with k leaves is (n + k − 1)- unavoidable.
As an evidence to this conjecture, H¨aggkvist and Thomason [7] proved the ex- istence of a minimal function g(k) ≤ 2512k3 such that every tree of order n with k leaves is (n + g(k))-unavoidable. Trees with two leaves are paths, so the above- mentioned results imply that Conjecture 1.2 is true when k = 2 and Ceroi and Havet [3] showed that it holds for k = 3. Havet [9] also showed Conjecture 1.2 for a large class of trees.

Our results
In Section 3, we prove Conjecture 1.2 for arborescences.
Theorem 1.3 Every arborescence of order n with k leaves is (n+k−1)-unavoidable.

Using this result, in Section 4, we derive the following.
Theorem 1.4 Every oriented tree of order n with k leaves is ( 3 n + 3 k − 2)-
2	2
unavoidable.
This result gives us a good bound for trees with few leaves. In particular, it implies Sumner’s conjecture for trees in which at most one third of the vertices are leaves.

Corollary 1.5 Every oriented tree of order n with at most n
leaves is (2n − 2)-

unavoidable.
Then, in Section 5, we give the following upper bound on the unvoidability of trees, which is good for trees with many leaves.
Theorem 1.6 Every oriented tree with n ≥ 3 vertices and k leaves is ( 9 n− 5 k− 9 )-

unavoidable.
2	2

Theorems 1.4 and 1.6 yield the best bound towards Sumner’s conjecture:
Corollary 1.7 Every oriented tree of order n ≥ 2 is  21 (n − 1) -unavoidable.
Proof. The value of min 3 (n + k − 1), 9 n − 5 k − 9  is maximal when 3 (n + k −
1) = 9 n − 5 k − 9 , that is when k = 3n−3 . In this case 3 (n + k − 1) = 21 (n − 1). 2
2	2	2	4	2	8
Finally, in Section 6, we dramatically decrease the upper bound on the function g(k) such that every tree of order n with k leaves is (n + g(k))-unavoidable by showing the following.
Theorem 1.8 Every oriented tree with n nodes and k leaves is (n + 144k2 − 280k + 124)-unavoidable.
Definitions and preliminaries
Notation generally follows [2]. The digraphs have no parallel arcs and no loops.
Let D be a digraph. If (u, v) is an arc, we say that u dominates v and write u → v. For any W ⊆ V (D), we denote by D⟨W⟩ the subdigraph induced by W in D.
Let v be a vertex of D. The out-neighbourhood of v, denoted by N +(v), is the set of vertices w such that v → w. The in-neighbourhood of v, denoted by N−(v), is the set of vertices w such that w → v. The out-degree d+(x) (resp. the
D	D
in-degree d− (x)) is |N +(v)| (resp. |N−(v)|).
D	D	D
Let A be an oriented tree. The leaves of A are the vertices adjacent to (at most) one vertex in D. There are two kinds of leaves: in-leaves which have out-degree1 and in-degree 0 and out-leaves which have out-degree 0 and in-degree 1. The set of leaves (resp. in-leaves, out-leaves) of A is denoted by L(A) (resp. L−(A), L+(A)). Trivially, L(A)= L+(A) ∪ L−(A).
A rooted tree is an oriented tree with a specified vertex called the root. If A
is a tree and r a vertex of A, we denote by (A, r) the tree A rooted at r. Let A be a

rooted tree with root r. The father of a node v in V (A) \ {r} is the node adjacent to v in the unique path from r to v in A. If u is the father of v, then v is a son of
u. If w is on the path from r to v in A, we say that w is an ancestor of v and that
v is a descendant of w.
For sake of clarity, the vertices of a tree are called nodes.
Let σ = (v1, v2,..., vn) be an ordering of the vertices of D. An arc vivj is forward (according to σ) if i < j and backward (according to σ) if j < i. A median order of D is an ordering of the vertices of D with the maximum number of forward arcs, or equivalently the minimum number of backward arcs. In other words, a median order is an ordering of the vertices such that the set of backward arcs is a minimum feedback arc set. Let us note basic properties of median orders of tournaments whose proofs are left to the reader.
Lemma 2.1 Let T be a tournament and (v1, v2,..., vn) a median order of T. Then, for any two indices i, j with 1 ≤ i < j ≤ n:
(M1) (vi, vi+1,..., vj)	is	a	median	order	of	the	induced	subtournament
T⟨{vi, vi+1,..., vj}⟩.

(M2) vertex vi dominates at least half of the vertices vi+1, vi+2,..., vj, and vertex vj is dominated by at least half of the vertices vi, vi+1,..., vj−1. In particular, each vertex vi, 1 ≤ i < n, dominates its successor vi+1.
Unavoidability of arborescences
The aim of this section is to prove Theorem 1.3. We prove the following theorem which implies it directly by directional duality.
Theorem 3.1 Every out-arborescence of order n with k out-leaves is (n + k − 1)- unavoidable.
Proof. Let A be an out-arborescence with n nodes, k out-leaves and root r, and let T be a tournament on m = n + k − 1 vertices.
Let σ = (v1, v2,..., vm) be a median order of T . For each node a of A, we fix an ordering Oa of the sons of A.
We now describe a procedure giving an embedding φ of A into T . We first set φ(r) = v1. We then consider the vertices of T one after another according to σ. At each step, a node of A is embedded if it already has an image by φ, and unembedded otherwise. If a vertex vj of T is the image of a node, we denote this node by aj; in symbols aj = φ−1(vj). An active node is a node of A which is embedded and which has an unembedded son. The active son of an active node a is its minimum unembedded son according to Oa. An active vertex is a vertex of T which is the image of an active node. For 2 ≤ i ≤ m, we do the following. If vi is dominated by an active vertex, then let j be the smallest index of an active vertex dominating vi, and b be the active son of aj. We set φ(b)= vi and say that

vi is hit. Otherwise vi is dominated by no active vertex, and we assign no node to
vi, and say that vi is failed.
To prove that this procedure yields an embedding of A into T , we shall prove that the set B of embedded nodes at the end of the procedure is V (A) or equivalently that the set F of failed vertices has cardinality k − 1.
Consider a vertex vi in F . If at Step i, there was no active vertex, then all nodes of A are embedded and we have the result. So we may assume that there was an active vertex. Let li be the largest index such that vli is active at Step i, and let Ii = {vj | li < j ≤ i}.
Since we only embed a node if we have embedded its father, A⟨B⟩ is an out- arborescence. Let L be the set of out-leaves of A that are in B. Since A⟨B⟩ is a sub-arborescence of A, we have |L| < k − 1.
Claim 3.2 If vi ∈ F, then |Ii ∩ F|≤ |Ii ∩ φ(L)|.
Subproof. Each out-neighbour of vli in Ii is hit for otherwise the procedure would

have assigned a son of ali
to it. Thus Ii ∩ F ⊆ Ii ∩ N−(vl ) and so
|Ii ∩ F|≤ |Ii ∩ N−(vl )|.	(1)


Let vj be a hit vertex in Ii. By definition of li, aj is not active, so its sons (if any) are embedded, necessarily in {vj+1,..., vi−1} ⊆ Ii. Again, by definition of li, all the sons of aj are not active, and so their sons (if any) are embedded in Ii. And so on, all descendants of aj are embedded in Ii and not active. We associate to vj an out-leaf wj of A which is a descendant of aj. We just showed that φ(wj) ∈ Ii.
Consider now the vertices of J = Ii ∩ N +(vl ). As seen above, they are hit, and the descendants of their pre-images are also embedded in Ii. Moreover, for each vj ∈ J , the father of aj is embedded in {v1,..., vli } for otherwise, at Step j, the procedure would have assigned vj to the active son of ali or another active node embedded in {v1,..., vli }. Hence no vertex of J is the image of an ancestor of another node embedded in J . Consequently, the out-leaves embedded inf J are all distinct. Thus
|Ii ∩ N +(vl )|≤ |Ii ∩ φ(L)|.	(2)
Now, by Lemma 2.1, |Ii ∩N−(vl )|≤ |Ii ∩N +(vl )|. Together with Equations (1) and (2), this proves the claim.	♦

Claim 3.3 If vi ∈ F and vj ∈ F, then either Ii ∩ Ij = ∅, or Ii ⊆ Ij, or Ij ⊆ Ii. Subproof.  Let vi, vj ∈ F with i < j. Assume for a contradiction that Ii ∩ Ij /= ∅,
Ii /⊆ Ij, and Ij /⊆ Ii. Then li < lj < i. At Step i of the procedure, vlj was not
active, by definition of li. But then it was still not active at Step j,a contradiction to the definition of lj.	♦
Now let M be the set of indices i such that vi ∈ F and Ii is maximal for inclusion. Since vi ∈ Ii for all vi ∈ F , we have F ⊆	i∈M Ii. Moreover, by Claim 3.3, the Ii,

i ∈ M , are pairwise disjoint. So |F | = Σi∈M |Ii ∩ F|. By Claim 3.2, we obtain
|F | = Σ |Ii ∩ F|≤ Σ |Ii ∩ φ(L)|≤ |φ(L)| = |L|≤ k − 1.
i∈M	i∈M
This completes the proof.	2
Remark 3.4 With the embedding φ constructed in the above proof, there is an injection from the set F of failed vertices into L+(A) such that every failed vertex vi is mapped to an out-leaf whose image precedes vi in σ.
Proof. We map the vertices vi of F to an out-leaf in increasing order according to σ. If at Step i, there was some active vertex, then by Claim 3.2, |Ii ∩F|≤ |Ii ∩φ(L)|. Hence, there is an out-leaf f (vi) of A with image in Ii (and thus preceding vi in σ) that was not assigned earlier to a failed vertex.
If at Step i, there was no active vertex, then all nodes of A are embedded (in vertices preceding vi in σ). Since |F| ≤ k − 1, there exists an out-leaf f (vi) which is not yet assigned to any failed vertex. Necessarily, f (vi) is embedded in a vertex preceding vi in σ.	2
A bi-arborescence is a rooted tree A that is the union of an in-arborescence and an out-arborescence that are disjoint except in their common root, which is also the root of A. Observe that in the proof of Theorem 3.1, the root of the out- arborescence is embedded in the first vertex of the median order. By directional duality, the root of an in-arborescence is embedded in the last vertex of the median order. Hence one can easily derive the following corollary.
Corollary 3.5 Let A be a bi-arborescence of order n with k leaves. If A has at least one in-leaf and at least one out-leaf, then A is (n + k − 2)-unavoidable. Otherwise A is (n + k − 1)-unavoidable.
Unavoidability of trees with few leaves
For any rooted tree A with root r, we partition the arcs into the upward arcs (the ones directed away from the root) and the downward arcs (the ones di- rected towards the root). The subdigraph composed only of the upward arcs and the nodes that are in an upward arc is called the upward forest, and the sub- digraph composed only of the downward arcs and the nodes that are in a down- ward arc is called the downward forest. The set of components of the upward (resp. downward) forest is denoted by C↑(A) (resp. C↓(A)), or simply C↑ (resp. C↓)
r	r	r	r

when A is clear from the context. Set γ↑ = Σ
↑ (|V (C)| + |L+(C)| − 2) and
r

↓ = Σ
↓ (|V (C)| + |L−(C)| − 2). Observe that each component of the up-
r

ward (resp. downward) forest contains an arc and thus at least two vertices and
one out-leaf (resp. in-leaf). Hence |V (C)| + |L+(C)|− 2 > 0 for all C ∈ C↑ and
|V (C)| + |L−(C)|− 2 > 0 for all C ∈ C↓.

Lemma 4.1 Let A be a rooted tree with n nodes and k leaves such that the root r
of A has in-degree 0. Then A is (n + k − 1+ γ↓)-unavoidable.

Proof. Let C1, ..., Cj be the components of the downward forest of A, and for 1 ≤ i ≤ j, let ni be the number of nodes and ki the number of in-leaves of Ci. By
definition, γ↓ = Σj	(n + k − 2).
Let T be a tournament on n + k − 1+ γ↓ vertices.
Note that the embedding procedure presented in the proof of Theorem 3.1 could be replaced by the following one, which yields the same bijection.
Set φ(r)= v1. For i =1 to m, if vi is hit, take the |N +(ai)| first out-neighbours of vi in {vi+1,..., vm} that are not yet hit and assign them to the sons of ai increasingly according to Oai .
The interest of this procedure is that it considers the nodes of the tree in a different order. The main property we are going to use is that the images of all of the sons of a given node a are fixed at the same time, and we do not need to fix the order Oa before the set of those images is known. It means that we can choose the order Oa after we know which vertices are the images of the sons of a. Thus we can effectively choose which son of a is embedded to which vertex with the knowledge of the set of the images of the sons of a.
Now we build an arborescence Aj from the rooted tree A, which we call the equivalent arborescence of A. For all i ∈ {1, ..., j}, do the following. Let fi be the father of the root of Ci. Note that fi exists since the root of A has in-degree 0, and thus is not in the downward forest. Remove all the arcs of Ci, add a set Ni of ki − 1 new nodes, and put an arc from fi to each new node and to each node of Ci (except to the root of Ci, since that arc already exists).
Observe that Aj is a rooted tree with the same root as A and since we removed the downward arcs and added only upward arcs, Aj is even an out-arborescence. By
construction Aj has n + Σj	(ki − 1) nodes. Let i ∈ {1, ..., j}. The nodes of Ci that
are tail of an upward arc in A are tail of the same upward arc in Aj, thus they are
not leaves in Aj. Hence, each in-leaf of Ci either is an in-leaf in A (if it is the tail of no upward arc), or is not an out-leaf in Aj. Therefore, in Ci, there are at most ni − ki out-leaves of Aj that are not in-leaves in A. Recall that the new nodes are
also out-leaves. Therefore Aj has at most k + Σj	(ni − 1) out-leaves.
Therefore by Theorem 3.1, there is an embedding φ of Aj into T . We build
it according to the procedure presented in the beginning of this proof. Let i ∈
{1, ..., j}, and consider Si = V (Ci) ∪ Ni. This is a set of ni + ki − 1 sons of fi in Aj. As argued previously, we can know φ(Si) before we choose which node of Si is embedded to which vertex. By Theorem 3.1, there is an embedding φi from Ci into T⟨φ(Si)⟩. Now for each node a in Ci, we choose φi(a) as its image by φ.
Consider now ψ the restriction of the resulting embedding φ to V (A). For all i ∈ {1, ..., j}, ψ coincides with φi. Hence ψ preserves the upward arcs since all the upward arcs of A are in Aj, and preserves the downward arcs since each downward arc of A is in some Ci. Therefore ψ is an embedding of A into T .	2

We are now able to prove Theorem 1.4 which states that every oriented tree of order n with k leaves is ( 3 (n + k) − 2)-unavoidable.
Proof of Theorem 1.4. Let T be a tournament on 3 (n + k) − 2 vertices. Let A
be an oriented tree with n nodes an k leaves. Pick a root r such that min(γ†, γ↓)
r	r
is minimum. By directional duality, we may assume that this minimum is attained by γ↓.
Since γ↓ ≤ γ†, we have γ↓ ≤ 1 (γ† + γ↓). For a rooted tree A, let Lj(A) be the
r	r	r	2	r	r
set of leaves of A distinct from the root. Note that if A1 and A2 are two rooted
trees that are disjoint except in one vertex which is the root of A2, then A1 ∪A2 is a tree, and if we root it at the root of A1, then |Lj(A1 ∪A2)|≥ |Lj(A1)| + |Lj(A2)|− 1. By applying that successively for all the components of the upward and downward forests of (A, r), we get that γ† + γ↓ ≤ n + k − 2, and thus γ↓ ≤ 1 (n + k) − 1. Hence,
r	r	r	2
T has at least n + k − 1+ γ↓ vertices.
Suppose for a contradiction that r has an in-neighbour s. The downward forest Fs of (A, s) is obtained from the downward forest Fr of (A, r) by removing the arc sr and possibly s or r if they become isolated. All components of Fr not containing sr are also components of Fs and the component C0 of Fr containing sr either disappears (when sr is the sole arc of C0), or loses one vertex (when r or s is a leaf of C0), or is split into two components having in total as many vertices as C0 and at most one more in-leaf than C . In any case, γ↓ < γ↓, a contradiction.
0	s	r
Consequently r has in-degree 0. Lemma 4.1 finishes the proof.	2
Unavoidability of trees with many leaves
The aim of this section is to establish Theorem 1.6, which states that every oriented tree with n ≥ 3 vertices and k leaves is ( 9 n − 5 k − 9 )-unavoidable.
2	2	2
Proof. Let m = [ 9 n − 5 k − 9 |. Let T be a tournament on m vertices. Let A be
2	2	2
an oriented tree with n nodes and k leaves. If A is a bi-arborescence, then we have
the result by Corollary 3.5. Henceforth, we assume that A is not a bi-arborescence. In particular, k < n − 1.
The out-leaf cluster of A, denoted by S+, is the set of nodes of A defined recursively as follows. Each out-leaf A is in S+; if a is a node with exactly one in- neighbour and all its out-neighbours are in S+, then a is also in S+. We similarly define the in-leaf cluster S— of A. Note that A⟨S—⟩ is a forest of in-arborescences, and A⟨S+⟩ is a forest of out-arborescences. Moreover, S— ∩ S+ = ∅ because A is not a bi-arborescence.
The heart of A, denoted by H, is the tree A− (S— ∪S+). Set nH = |V (H)| and kH = |L(H)|. We first note that each out-leaf of H has a neighbour in S—, since otherwise it would be in S+. Similarly, each in-leaf of H has a neighbour in S+. In particular, |S—|≥ |L+(H)| and |S+|≥ |L—(H)|.
We now describe an algorithm yielding an embedding φ of the tree A into T . It proceeds in three phases: in the first phase, we embed the heart of A, in the second phase we embed the out-leaf cluster, and in the third phase we embed the in-leaf

cluster. At each step, a node of A is embedded if it already has an image by φ, and unembedded otherwise. If a vertex vj of T is the image of a node, we denote this node by aj; in symbols aj = φ—1(vj). We say that a vertex is hit if it is the image of a vertex.
Let σ = (v1, v2,..., vm) be a median order of T . We distinguish between two cases: (1) one of S— or S+ is empty, and (2) both S— and S+ are non-empty. We only present here case (2) which is the most complicated one. A similar (and easier) argument works for case (1).
We first have to find an adequate root of A to start. Let C↓ = C↓(H) and
C† = C†(H). For a root r of H, let β↓ = Σ	↓ (3|V (C)| − 3) + 2|L—(H)| and
β† = Σ	↑ (3|V (C)|− 3) + 2|L+(H)|. Let r be a root that minimizes min{β↓, β†}.
By directional duality, we may assume that β↓ = min{β↓, β†}. Therefore, β↓ ≤
r	r	r	r

1 β↓ + 1 β†
= 3 n	+ k
— 3 . We can assume that r has in-degree 0, since each

2 r	2 r	2 H	H	2
in-neighbour s of r satisfies β↓ ≤ β↓.
s	r
Let us now detail our algorithm. Let l = nH − kH − 1+ ΣC∈C↓ (|V (C)|− 1) +

2|L—(H)| + 2|S—|. Note that l ≥ 1 because |S—|≥ 1. Let p = l + nH
+ kH
— 1+ γ↓.

Phase 1: We embed H in T⟨{vl+1,..., vp}⟩ using the procedure of Lemma 4.1 for
H. Note that in this procedure, we embed the equivalent arborescence Hj of H which is bigger than H. Here we keep all vertices of Hj embedded until the end of Phase 2.
Phase 2: While there is an unembedded vertex in S+, let i be the smallest integer such that φ—1(vi) has an unembedded out-neighbour in S+, and take the first (i.e. with lowest index) out-neighbour of vi in {vi+1,..., vm} that is not yet hit and assign it to an unembedded out-neighbour in S+.
Unembed all vertices of Hj − H.
Phase 3: While there is an unembedded vertex in S—, let i be the largest integer such that φ—1(vi) has an unembedded in-neighbour in S—, and take the last (i.e. with highest index) in-neighbour of vi in {v1,..., vi—1} that is not yet hit and assign it to an unembedded in-neighbour in S—.
Let us prove that this algorithm embeds all nodes of A. First, by Lemma 4.1, all vertices of H are embedded in Phase 1.
Let us now prove that all vertices of S+ are embedded in Phase 2. Let B be the subtree of A induced by V (H) ∪ S+ and let Bj be the out-arborescence obtained from B by replacing H by the equivalent arborescence Hj. Observe that Phase 1 and Phase 2 may be seen as embedding Bj and extracting a copy of B from Bj at the same time. Let us show that our algorithm embeds the whole Bj (and thus the whole
B) in Phases 1 and 2. The equivalent arborescence Hj has nH +Σ	↓ (|L—(C)|−1)

nodes. Thus Bj
has nH +
ΣC∈C↓ (|L
(C)|− 1) + |S
+| nodes.
C∈Cr

All the leaves of A are either in S— or in S+, thus k ≤ |S—| + |S+|. Therefore


9	5	9	9
m ≥ n − k −  ≥ n
+ 2|S—| + 2|S+|− 9 .

2	2	2	2 H	2

For all C ∈ C↓, we have |L—(C)|≤ |V (C)|, thus
Σ (|V (C)| + 2|L—(C)|− 3) + 2|L—(H)|≤ Σ (3|V (C)|− 3) + 2|L—(H)|

C∈C↓



The two previous equations yield
C∈C↓
≤ 3nH + k
2	H

— 3 .
2

m ≥ 3nH − kH − 3+ Σ (|V (C)| + 2|L—(C)|− 3) + 2|L—(H)| + 2|S—| + 2|S+| ,
C∈C↓
so m − l ≥ 2nH +2 Σ (|L—(C)|− 1) + 2|S+|− 2 ≥ 2|Bj|− 2.
C∈C↓
At each addition of a vertex of Bj during Phases 1 and 2, our procedure takes the first (i.e. with lowest index) out-neighbour of a vertex vi in {vi+1,..., vm} that is not yet hit and assigns it to an unembedded out-neighbour of φ—1(vi). Therefore, at each step, φ is an embedding of Bjj, the so far constructed sub-out-arborescence of Bj into T⟨{vl+1, ..., vl+2|B′′|—2}⟩, such that in each end-interval {vj, ..., vl+2|B′′|—2} at most l+2|B′′|—2—j+1 vertices are in φ(Bjj). Thus by Lemma 2.1 (M2), every vertex of vi as an out-neighbour in {vi+1, ..., vl+2|B′′|}\φ(Bjj) and the procedure can continue. Hence, Bj can be embedded into T⟨{vl+1, ..., vm}⟩.
Assume for a contradiction that the algorithm fails in Phase 3, which means a node a in S— is not embedded. We can choose such a node a whose out-neighbour b is embedded. Let vi be the image of b. Observe that b is in S— ∪ V (H), so it has been embedded in Phase 1 or 3, and necessarily must be in {v1,..., vp}.
Consider the moment when we try to embed the in-neighbours of b during Phase
3. Let hit be the number of vertices of {v1,..., vi—1} that are hit at this moment. Since a is not embedded, we have hit ≥ |N—(vi) ∩ {v1,..., vi—1}| − |N—(b)| + 1. By
Lemma 2.1, |N—(vi) ∩ {v1,..., vi—1}| ≥ i—1 . So
hit ≥ i − 1 − |N—(b)| + 1.	(3)

2	A
Let us give some upper bounds on hit. Let O<i be the set of out-leaves of H embedded at some vj with l +1 ≤ j < i and let O≥i be the set of out-leaves of H embedded at some vj with i ≤ j ≤ p. We have hit = hit2 + hit3, where hit2 (resp. hit3) is the number of vertices of {v1,..., vi—1} that are hit in Phase 1 and 2 (resp. Phase 3 until the considered moment).
At the considered moment, the algorithm has yet to embed the in-neighbours of b and the in-neighbours in S— of the nodes embedded at each vj for j < i. As noted previously, each out-leaf of H has an in-neighbour in S—. Therefore, each out-leaf of O<i has an in-neighbour in S— that is not yet embedded. Hence
hit3 ≤ |S—|− |O<i|− |N—(b)|.	(4)

Consider now the embedding of H. It is made using the procedure of Lemma 4.1, which applies the procedure of Theorem 3.1 on Hj. Let kH′ be the number of out-leaves of Hj. All the out-leaves of H are also out-leaves in Hj. Moreover, by Remark 3.4, we can map each failed vertex to an out-leaf of Hj whose image precedes the failed vertex in σ. But there are kH′ − 1 failed vertices, therefore each out-leaf of O≥i except at most one corresponds to two vertices vl with l ≥ i. Thus, there are at least 2|O≥i|− 1 vertices in {vi,..., vp}. Moreover,    ↓ (|L(C)|− 1) vertices
r
of Hj − H are unembedded at the end of Phase 2 and were neither out-leaves of H
nor failed vertices. Hence,
hit2 ≤ p−l− Σ (|L(C)|−1)−2|O≥i|+1 = nH +kH + Σ (|V (C)|−1)−2|O≥i|.  (5)
C∈C↓	C∈C↓
Since all vertices hit in Phases 1 and 2 are in {vl+1,..., vm}, we trivially have
hit2 ≤ i − l − 1	(6)
Summing 2 Eq. (3)+2 Eq. (4)+ Eq. (5)+ Eq. (6) yields the following contradiction.
l ≤ nH + kH + Σ (|V (C)|− 1)) − 2|O≥i| + 2|S—|− 2|O<i|− 2
C∈C↓
≤ nH + kH − 2L+(H)+ Σ (|V (C)|− 1)) + 2|S—|− 2
C∈C↓
= nH − kH − 2+ 2(L—(H)) + Σ (|V (C)|− 1)) + 2|S—| = l − 1.
C∈C↓
2
6	Unavoidability of trees with very few leaves
Due to lack of space, we just present here a very rough sketch of the proof of Theorem 1.8 which states that every oriented tree with n nodes and k leaves is (n + 144k2 − 280k + 124)-unavoidable. Since the result holds for paths, we shall only consider trees that are not paths.
Let A be a tree which is not a path. A branch-node of A is a node with with degree at least 3 and a flat node is a node with degree 2. A segment in A is a subpath whose origin is a branch-node, whose terminus is either a branch-node or a leaf, and whose internal nodes are flat nodes. If its terminus is a branch-vertex, then the segment is an inner segment; otherwise it is an outer segment. The opposite of an inner segment S, denoted by S is the inner segment with origin the terminus of S and terminus the origin of S.
A stub is a tree such that :
every inner segment has at most three blocks; moreover, if it has three blocks, then its first and third block have length 1, and if it has two blocks, then one of its blocks has length 1.

every outer segment has length 1.
Our proof of Theorem 1.8 involves two steps. We first prove the following lemma, which shows that it is sufficient to concentrate on stubs.
Lemma 6.1 If there exists a function f such that every stub of order n and k ≥ 6 leaves is (n + f (k))-unavoidable, then every tree of order n with k ≥ 3 leaves is (n + max{f (2k − 2b)+ b | 0 ≤ b ≤ k − 3})-unavoidable.
We then prove the following result on the unavoidability of stubs.
Lemma 6.2 Every stub with n nodes and k ≥ 6 leaves is (n + 36k2 − 140k + 124)- unavoidable.
Theorem 1.8 follows directly from Lemmas 6.1 and 6.2 whose proofs are omitted due to lack of space.

References
Alspach, B. and M. Rosenfeld, Realization of certain generalized paths in tournaments, Discrete Math.
34 (1981), pp. 199–202.
Bondy, J. and U. Murty, “Graph Theory,” Springer Publishing Company, Incorporated, 2008, 1st edition.
Ceroi, S. and F. Havet, Trees with three leaves are (n+1)-unavoidable, Discrete Applied Mathematics
141 (2004), pp. 19–39.
El Sahili, A., Trees in tournaments, J. Combin. Theory Ser. B 92 (2004), pp. 183–187.
Forcade, R., Parity of paths and circuits in tournaments, Discrete Math. 6 (1973), pp. 115–118.
Gru¨nbaum, B., Antidirected Hamiltonian paths in tournaments, J. Combin. Theory Ser. B 11 (1971),
pp. 249–257.
H¨aggkvist, R. and A. Thomason, Trees in tournaments, Combinatorica 11 (1991), pp. 123–130.
Havet, F., Trees in tournaments, Discrete Mathematics 243 (2002), pp. 121 – 134.
Havet, F., On unavoidability of trees with k leaves, Graphs and Combinatorics 19 (2003), pp. 101–110.
Havet, F. and S. Thomass´e, Median orders of tournaments: a tool for the second neighborhood problem and Sumner’s conjecture, J. Graph Theory 35 (2000), pp. 244–256.
Havet, F. and S. Thomass´e, Oriented hamiltonian paths in tournaments: a proof of Rosenfeld’s conjecture, J. Combin. Theory Ser. B 78 (2000), pp. 243–273.
Ku¨hn, D., R. Mycroft and D. Osthus, A proof of Sumner’s universal tournament conjecture for large tournaments, Proceedings London Math. Soc. 102 (2011), pp. 731–766.
Ku¨hn, D., R. Mycroft and D. Osthus, An approximate version of Sumner’s universal tournament conjecture, J. Combin. Theory, Ser. B 101 (2011), pp. 415–447.
R´edei, L., Ein kombinatorischer Satz, Acta. Litt. Sci. Szeged 7 (1934), pp. 39–43.
Reid, K. and N. C. Wormald, Embedding oriented n-trees in tournaments, Studia Scientiarum Mathematicarum Hungarica 18 (1983), pp. 377–387.
Rosenfeld, M., Antidirected Hamiltonian paths in tournaments., J. Combin. Theory Ser. B 12 (1971),
pp. 93–99.
Straight, H., The existence of certain type of semi-walks in tournaments, Congr. Numer. 29 (1980),
pp. 901–908.
Thomason, A., Paths and cycles in tournaments, Trans. Amer. Math. Soc. 296 (1986), pp. 167–180.
