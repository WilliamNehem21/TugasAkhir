Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 325 (2016) 29–45
www.elsevier.com/locate/entcs

The Shuﬄe Quasimonad and Modules with Differentiation and Integration
Marc Bagnol, Richard Blute
Department of Mathematics and Statistics University of Ottawa
Ottawa, Ontario CANADA
J.R.B. Cockett
Department of Computer Science University of Calgary
Calgary, Alberta CANADA
J.S. Lemay
Department of Mathematics and Statistics University of Calgary
Calgary, Alberta CANADA

Abstract
Differential linear logic and the corresponding categorical structure, differential categories, introduced the idea of differential structure associated to a (co)monad. Typically in settings such as algebraic geometry, one expresses differential structure for an algebra by having a module with a derivation, i.e. a map satisfying the Leibniz rule. In the monadic approach, we are able to continue to work with algebras and derivations, but the additional structure allows us to define other rules of the differential calculus for such modules; in particular one can define a monadic version of the chain rule as well as other basic identities.
In attempting to develop a similar theory of integral linear logic, we were led to consider the shuﬄe multiplication. This was shown by Guo and Keigher to be fundamental in the construction of the free Rota-Baxter algebra, the Rota-Baxter equation being the integral analogue of the Leibniz rule. This shuﬄe multiplication induces a quasimonad on the category of vector spaces. The notion of quasimonad, called r-unital monad by Wisbauer, is slightly weaker than that of monad, but is still sufficient to define a sensible notion of module with differentiation and integration.
In this paper, we demonstrate this quasimonad structure, show that its free modules have both differential and integral operators satisfying the Leibniz and Rota-Baxter rules and satisfy the fundamental theorems of calculus.
Keywords: Linear Logic, Differential Categories, Rota-Baxter Algebras

Introduction
The theory of differential linear logic as introduced by Ehrhard and Regnier [9,10] extended Girard’s linear logic to include an inference rule which captured differenti-

http://dx.doi.org/10.1016/j.entcs.2016.09.030 1571-0661/© 2016 Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

ation syntactically. The corresponding categorical structure, differential categories [1], extended the traditional notion of Seely category [26] to include a differential combinator. The monads T that arise in models of linear logic 1 have the addi- tional structure of a commutative, associative algebra associated to every object of the form TV . Such monads are called algebra modalities. Given an algebra modal- ity, we require a map d : TV → V ⊗ TV satisfying naturality and as in the theory of K¨ahler differentials [18,2], we require that the combinator satisfies the Leibniz rule
of differential calculus, viewing V ⊗ TV as a right TV -module. But the monadic structure allows us to express other rules of calculus such as the chain rule. For details see Section 2.
The research in this paper began with an attempt to carry out a similar program for the integral calculus. The analogue of the Leibniz rule for integral calculus is the Rota-Baxter equation. While not as well-known as the Leibniz rule and the theory of derivations on an algebra, the equation has been an object of significant study since the construction of the free Rota-Baxter algebra by Guo and Keigher [16] and especially since this equation has been observed to be significant in renormalization of perturbative quantum field theory. See [8] for an overview. For the history of the subject, we refer the reader to the monograph by Guo [14]. An idea of the far- reaching application of this equation can be found by considering [7,8,12,13,15,16,29] as well as the webpage of Li Guo, which has a detailed bibliography.
The significance of the shuffle multiplication is clear from the Guo-Keigher con- struction of the free commutative Rota-Baxter algebra. This operation is naturally defined on the tensor algebra of a vector space, but surprisingly the algebraic struc- ture so obtained does not yield a monad but only the slightly weaker notion of quasimonad, which we denote by §. Quasimonads retain sufficient structure to de- scribe the integral and differential structure we are interested in. In particular, one
can define the notion of algebra modality with respect to a quasimonad and we show that the shuffle multiplication does give an algebra modality.
The notion for integral calculus corresponding to a module with differentiation does not seem to have been explored as far as we have been able to find. Given a commutative algebra A, we define a module with integration to be a right A-module M with a map P : M → A satisfying a version of the Rota-Baxter equation. See Section 6 for details. We show that for the shuffle quasimonad, there is a canonical natural transformation P : V ⊗§V → §V , making V ⊗§V a module with integration, and a map d : §V → V ⊗§V making V ⊗§V a module with differentiation. These two maps together satisfy both the first and second fundamental theorems of calculus. We call such modules FTC-modules.

Remark 1.1 The authors would like to thank NSERC for its generous support. The first author also received funding from the Fields Institute.


1 Actually we are working in the dual setting to that of model of linear logic, where one has comonads and associated coalgebras.

Codifferential categories and algebra modalities
We now define the basic structures related to the theory of (co)differential categories.
Definition 2.1 An algebra modality on a symmetric monoidal category C consists of a monad (T, μ, η) on C, and for each object C in C, a pair of morphisms (note we are denoting the tensor unit by k)
m : T (C) ⊗ T (C) 	/T ¸(C),	e : k 	/T ¸(C)
making T (C) a commutative algebra such that this family of associative algebra structures satisfies evident naturality conditions [1].

Definition 2.2 An additive symmetric monoidal category with an algebra modal- ity is a codifferential category if it is also equipped with a deriving transform 2 , i.e. a transformation, natural in C
dT (C) : T (C) 	/C¸⊗ T (C)
satisfying the following four equations 3 :
(d1) e; d =0	(Derivative of a constant is 0.)
(d2) m; d = (d⊗1); (1⊗m)+(1⊗d); c; (1⊗m) (where c is the appropriate symmetry)
(Leibniz Rule)
(d3) η; d =1 ⊗ e	(Derivative of a linear function is constant.)
(d4) μ; d = d; d ⊗ μ;1 ⊗ m	(Chain Rule)
Remark 2.3 For us, an additive category is simply one enriched over abelian monoids. For the remainder of the paper, we will assume we are working over an additive category, although some of the definitions do not require it.
The fundamental example of a codifferential category is the category of (discrete) vector spaces and linear maps. The monad is given by the symmetric algebra construction and the deriving transform is the usual differentiation of polynomials. We refer to [1] for further details. A topological example is given by the category of convenient vector spaces and continuous linear maps, which forms a differential category [3].
Quasimonads
We give an exposition of the idea of weakening the definition of monad. We follow the presentation of Wisbauer [28] which is based in part on the work of B¨ohm [5]. This weaker notion will be more relevant in the study of the shuffle multiplication.

2 We use the terminology of a deriving transform in both differential and codifferential categories.
3 For simplicity, we write as if the monoidal structure is strict.

Remark 3.1 We have chosen to use the term quasimonad for what Wisbauer calls an r-unital monad. We note that this is different than what Wisbauer and B¨ohm call a weak monad. It is also different than what Hoofman and Moerdijk call a semimonad [21].
We begin with the following preliminary definitions.
Definition 3.2 • Let C be a category, a pair (F, μ) isa functor with multiplication
if F : C → C and μ : F 2 → F is a natural transformation with F μ; μ = μF ; μ.
A triple (F, μ, η) is a q-unital monad if (F, μ) is a functor with multiplication and η : idC → F is a natural transformation, called the quasi-unit. (No equations required.)
The quasi-unit is regular if η is equal to the composite:

η	Fη	2	μ
idC −−−−→ F −−−−→ F −−−−→ F
The multiplication μ is compatible if μ is equal to the composite

FηF	μF	μ
FF −−−−→ FFF −−−−→ FF −−−−→ F
We can now define the notion of quasimonad as follows:
Definition 3.3 A triple (F, μ, η) is a quasimonad if it is a q-unital monad and:
η is regular.
μ is compatible.
Just as a monad is always induced by an adjunction, quasimonads are always induced by a pairing of functors, defined as follows. Let C and D be categories and suppose we have a pair of functors, as follows
L : C −→ D	R : D −→ C
A pairing between L and R is a pair of maps, natural in both variables, of the form:

α : HomD(LA, B) −→ HomC(A, RB)	β : HomC(A, RB) −→ HomD(LA, B)
Given such a pairing, as in the case of an adjunction, we get natural transformations:
ηA : A −→ LR(A)	ϵB : RL(B) −→ B
We then define F : C → C by F = L; R, and μ =: F 2 → F by μ = ϵL; R.
Definition 3.4 A pairing is regular if
α; β; α = α	and	β; α; β = β

Given a q-unital monad (F, η, μ), one defines a category of F -algebras similarly to the case of monads and we get a pairing (αF , βF ) just as one obtains an adjunction in the case of a monad.
Theorem 3.5 (Wisbauer [28]) The following are equivalent:
(F, μ, η) is a quasimonad.
The pairing (αF , βF ) is regular.

Remark 3.6 In the case of a q-unital monad, the Kleisli construction yields an associative composition, but no identity maps. In the shuffle structure defined below, one in fact obtains a one-sided unit for the Kleisli construction.

Shuﬄing
We describe a quasimonad structure which will be fundamental in our definition and examples. We were led to consider this operation by the fundamental work of Guo and Keigher [15,16]. We work in the category of vector spaces over an arbitrary field k. So let
§(V )= k ⊕ V ⊕ V ⊗ V ⊕ V ⊗ V ⊗ V ··· 
This has a well-known monad structure as it is the free tensor algebra. But it also has a quasimonad structure which we describe now. We will work with homogeneous elements. See [24], Chapter 16.7. Denote the length of a homogeneous element w by |w|.
We have the evident free multiplication on §(V ), but we also have the shuffle multiplication ⬦: §(V ) ⊗ §(V ) → §(V ) described as follows. We first remind the reader of the following preliminaries:
Definition 4.1 • The generalized binomial coefficients are defined by
 n1 + n2 ··· + nm  = (n1 + n2 ··· + nm)!
n1, n2 ··· , nm	n1!n2! ··· nm!
with each ni a non-negative integer. These coefficients satisfy evident equations which will be of use in verifying associativity of multiplication, among other things.
If w1 and w2 are words in some alphabet, a shuﬄe of w1 and w2 is a permutation of the concatenated word w1w2 such that the internal order of the two words is maintained.
If w1, w2 are homogeneous elements of §V , then define


w1⬦w2
1
|w1|+|w2|
|w1|,|w2|
 w∈ShΣ(w1,w2)

Here the sum is over all w which are the shuffle of the two words. (We will find it convenient to denote the shuffle multiplication without the leading coefficient by w1 ∗ w2.)
So for example, the product of w1 = a1 ⊗ b1 and w2 = a2 ⊗ b2 is

1
w1⬦w2 = 6 [a1 ⊗ b1 ⊗ a2 ⊗ b2 + a1 ⊗ a2 ⊗ b1 ⊗ b2 + a1 ⊗ b1 ⊗ b2 ⊗ a2
+b1 ⊗ a1 ⊗ b2 ⊗ a2 + b1 ⊗ a1 ⊗ a2 ⊗ b2 + b1 ⊗ b2 ⊗ a1 ⊗ a2]
1
= 6 w1 ∗ w2
We also note that the multiplication ∗ can be defined recursively as follows [14].

If w1 = awj
and w2 = bwj , then:
w1 ∗ w2 = a(wj ∗ w2)+ b(w1 ∗ wj )

1	2
Due to basic combinatorial identities of the binomial coefficients, the ⬦-operation is a commutative, unital associative multiplication on §(V ) and so induces a series of maps:
§(V )⊗n −→ §(V ) These maps can be defined directly via the formula:
1
w ⬦w ⬦··· ⬦w

The multiplication ⬦ induces a natural transformation μ : §§ → §. There is also an evident natural transformation η : Id → §, which is the usual inclusion of generators function.
Theorem 4.2 This makes § a quasimonad.
Proof. We prove the result in steps.
(§, μ) is a functor with multiplication.
We need to establish some notation for the homogeneous elements of the various iterates §nV :
We write the elements of V as {xi}i∈I .
We write the (homogeneous) elements of §V as (x1x2 ... xn). In particular xi ∈ V and (xi) ∈ §V . So (xi) is the word of length one. We also have the empty word ε in all §nV , and note for example that (ε) /= ε in §2(V ).
We write the elements of §2V as
[(x11x12 ... x1n1 )(x21x22 ... x2n2 ) ... (xm1xm2 ... xmnm )].

We will also write an element of this form as [w1w2 ... wm].
· We write the elements of §3V as [w11w12 ... w1m ] ... [wp1wp2 ... wpm ] Now calculate as follows:

§μ([w11w12 ... w1m1 ] ... [wp1wp2 ... wpmp ]) =
[w11⬦w12⬦ ... ⬦w1m1 ] ... [wp1⬦wp2⬦ ... ⬦wpmp ]= 


1
|w11|+|w12|+...+|w1m1 |
|w11|,|w12|,...,|w1m1 |
... 
1
|wp1|+|wp2|+...+|wpm1 |
|wp1|,|w12|,...,|wpmp |
[w11
∗ w12
∗ ... 

∗w1m1 ] ... [wp1 ∗ wp2 ∗ ... ∗ wpmp ]


Applying μ to this element and using combinatorial identities, we get:


1
|w11|+|w12|+...+|w1m1 |+...+|wp1|+|wp2|+...+|wpm1 |
|w11|,|w12|,...,|w1m1 |,...,|wp1|,|w12|,...,|wpmp |

w11
∗ w12
... ∗ w

1m1
∗ ... 


∗wp1 ∗ wp2 ... ∗ wpmp =
w11⬦w12⬦ ... ⬦w1m1 ⬦ ... ⬦wp1⬦wp2⬦ ... ⬦wpmp

On the other hand, we have

μ§([w11w12 ... w1m1 ] ... [wp1wp2 ... wpmp ]) =
[w11w12 ... w1m1 ]⬦ ... ⬦[wp1wp2 ... wpmp ]= 1
m1+...+mp  [w11w12 ... w1m1 ] ∗ ... ∗ [wp1wp2 ... wpmp ]
m1,m2,...,mp
Note that in this multiplication we are viewing the w’s as letters. Now note
μ([w11w12 ... w1m1 ] ∗ ... ∗ [wp1wp2 ... wpmp ]) is:


m1 + ... + mp	[w m1, m2,..., mp	11
⬦w12
⬦ ... ⬦w
1m1
⬦ ... ⬦wp1
⬦wp2
⬦ ... ⬦w
pmp ]

since we have  m1+...+mp   terms in the product [w11w12 ... w1m ] ∗ ... ∗
[wp1wp2 ... wpmp ] each of which gives w11⬦w12⬦ ... ⬦w1m1 ⬦ ... ⬦wp1⬦wp2⬦ ... ⬦wpmp
when we apply μ.
Thus we have a functor with multiplication.

η is regular.
We note that §η is just id ⊕ η ⊕ (η ⊗ η) ⊕ .. .. So η; §η is just the map v '→ (v), viewing v as a word of length 1. Then μ((v)) = v.
μ is compatible.
We consider a typical element of §2V given by:
[(x11x12 ... x1n1 )(x21x22 ... x2n2 ) ... (xm1xm2 ... xmn2 )]
We also denote this by [w1w2 ... wm]. The action of the map FηF on this element is to send it to [w1][w2] ... [wm], where each (wi) is a word of length one in §2V Applying μ§ to this element gives:
1
[Σm([(w1)(w2) ... (wm)])]
m!
where Σm indicates the sum over the action of the permutation group Sm on the list [(w1)(w2) ... (wm)]. Applying μ to [Σm([(w1)(w2) ... (wm)]), we get m! copies of w1⬦w2⬦ ... ⬦wm, and we are done.
This completes the proof that (§, μ, η) is a quasimonad.
□

Definition 4.3 A q-unital monad or quasimonad § is an algebra modality if for each object V , there is an associative algebra structure:
⬦: §V ⊗ §V → §V	e : I → §V
which is natural in V and the following two additional equations hold:


§§V ⊗ §§V
⬦
  
μ⊗μ  /§V¸⊗ §V
⬦
  

§§V	μ	/§V¸

I ¸ e /§§¸V

¸¸¸¸
e ¸¸¸ μ
z z 
§V
These equations say the μ is an algebra homomorphism.

Lemma 4.4 The shuﬄe multiplication makes § an algebra modality.
Proof. The second equation is straightforward. For the first equation, we proceed very much as in the case of the proof that we have a functor with multiplication. So we consider an expression of the form [w1w2 ... wm] ⊗ [u1u2 ... un]. Applying μ ⊗ μ and then ⬦, we get


[w1w2 ... wm] ⊗ [u1u2 ... un] '→ [w1⬦w2⬦ ... ⬦wm] ⊗ [u1⬦u2⬦ ... ⬦un]

'→ w1⬦w2⬦ ... ⬦wm⬦u1⬦u2⬦ ... ⬦un
Applying ⬦ then μ gives

1
[w1w2 ... wm] ⊗ [u1u2 ... un] '→  m+n (w1w2 ... wm) ∗ (u1u2 ... un) '→
m,n

  1	  m + n 

m+n m,n
and the result follows.
m, n
w1⬦w2⬦ ... ⬦wm⬦u1⬦u2⬦ ... ⬦un


□



The Rota-Baxter equation
We now introduce the Rota-Baxter equation and give examples. All of the material of this section can be found in [14].
Definition 5.1 Let A be a k-algebra, where k is the underlying field. A is a Rota- Baxter algebra if equipped with a k-linear map P : A → A such that for all x, y ∈ A

P (x)P (y)= P (xP (y)) + P (P (x)y)
The map P is called a Rota-Baxter operator or RB-operator 4 .
We just mention a few examples. A much more extensive list can be found for example in [14].
Let C(R) denote the ring of continuous functions from the reals to the reals under pointwise operations. Define P (f )(x) = x f (t)dt. Then P is an RB-operator. The Rota-Baxter equation becomes the usual integration by parts formula.
Consider R[x] with multiplication given by xm · xn =  m xm+n. Then P (xn) = 
xn+1 is an RB-operator.
Let V be an arbitrary k-vector space. Let T (V )= k ⊕V ⊕V ⊗V . . ., but equipped with the shuffle algebra multiplication. Then if v ∈ V , we have an operator Pv : T (V ) → T (V ) defined by Pv(w)= v ⊗ w. Then Pv is an RB-operator.

4 In this paper, we only consider the operators of weight 0.

Modules with differentiation and integration
The notion of derivation has long been fundamental in algebraic geometry and commutative algebra [18,25] and more recently extending the idea to the noncom- mutative setting has also been of importance [23]. We begin with the classical notion:
Definition 6.1 Let A be a commutative k-algebra. Let M be a (left) A-module. A derivation on M is a k-linear map ∂ : A → M such that for all x, y ∈ A
∂(xy)= x∂(y)+ y∂(x)
We will also refer to (M, ∂) as a module with differentiation.
We now introduce the corresponding integral structure. As far as we have been able to see, this precise definition does not exist in the literature despite the intense study of the Rota-Baxter equation. It is certainly implicit in that work though.
Definition 6.2 Let A be a commutative k-algebra. Let M be a right A-module.
An integration on M is a k-linear map π : M → A such that for all x, y ∈ M
π(x)π(y)= π(xπ(y)) + π(yπ(x)) The pair (M, π) is called a module with integration.
Remark 6.3 Note that the multiplication on the lefthand side of the equation is the multiplication of A, while on the right, the multiplication is the action of A on M .
We note that every Rota-Baxter algebra is a module with integration over itself with its evident right-module structure.The shuffle quasimonad will give us a much broader class of examples. Indeed it is expected that when a complete theory of integral linear logic is established, we will have an even greater source of examples.
Definition 6.4 Let A be a commutative algebra. An FTC-module over A is an
A-module M together with maps P : M → A and d : A → M such that
(M, d) is a module with differentiation.
(M, P ) is a module with integration. and
(First Fundamental Theorem of Calculus) P ; d = id
We write the FTC-module as (M, P, d).
Additional structure in the presence of a (quasi)monad
As already indicated, one can express additional differential structure in the presence of a monad with an algebra modality. This is seen in the definition of codifferential category above. We now introduce some additional structure for the integral case.

Definition 6.5 In what follows, let (T, μ, η) be a q-unital monad and a natural transformation of the form s : id ⊗ T → T
The natural transformation s satisfies the U-substitution rule if for all f : X →
X ⊗ TX, the composite

s	Tf	Ts	μ
X ⊗ TX −−−−→ TX −−−−→ T (X ⊗ TX) −−−−→ TTX −−−−→ TX 
is equal to the composite

id⊗Tf	id⊗Ts 
X ⊗ TX −−−−→ X ⊗ T (X ⊗ TX) −−−−→ X ⊗ TTX 

f⊗μ
id⊗⬦	s

−−−−→ X ⊗ TX ⊗ TX −−−−→ X ⊗ TX −−−−→ TX 
A natural transformation of the form s : id ⊗ T → T satisfies the integration of constants rule if η : X → TX is equal to the composite

X ∼ X ⊗ I	id⊗e	s
=	−−−−→ X ⊗ TX −−−−→ TX 
We note that these equations are not necessarily satisfied in the case of the shuffle quasimonad and it will be of interest to characterize those cases in which these additional equations hold.
If we also have differential structure in the presence of a quasimonad, we can also state the Second Fundamental Theorem of Calculus.
Definition 6.6 Suppose we have an algebra modality (T, μ, η, m, e) and an FTC- module (M, P, d) over T (V ). Then we say that M satisfies the Second Fundamental Theorem of Calculus if:



where 0 : V → V .
d; P + T (0) = idT (V )

If the algebra modality is equipped with natural transformations P : id ⊗ T → T and d : T → id ⊗ T making each TV an FTC-module, then we say that the algebra modality satisﬁes the second fundamental theorem if these natural transformations satisfy the same equation.
Remark 6.7 We note that unlike the first fundamental theorem of calculus, this one can only be defined in the presence of additional quasimonadic structure.

Differential and integral structure in the shuﬄe quasimonad
Lemma 7.1 The operator P : V ⊗ §V → §V deﬁned by P (v ⊗ w) =   1  vw (the
concatenated word) satisﬁes:

The Rota-Baxter equation, where V ⊗ §V is the free right §V -module generated by V .
The integration of constants rule.
Proof. We note that the integration of constants rule is trivial.
We suppose v, vj ∈ V and w, wj ∈ X∗, with |w| = n and |wj| = m. We must show

P (v ⊗ w)P (vj ⊗ wj)= P ((v ⊗ w)P (vj ⊗ wj)) + P ((vj ⊗ wj)P (v ⊗ w)) The lefthand side of this equation is given by:
1	1	j j	1	1	1	j j

[vw⬦v w ]= 
n +1 m +1 
n +1 m +1	n+m+2  (vw ∗ v w )= 
n+1,m+1

1	j j



The righthand side is given by:
n+m+2 (vw ∗ v w )
n,1,m,1



1
P (v ⊗ (
)w⬦vjwj)+ P (vj ⊗ (	1
)wj⬦vw)= 

1	1	1
m +1 
j j
n +1 
1	1	1	j	j

m +1 n+m+1 
v(w ∗ v w )+ n +1 n+m+1 
v (w
∗ vw)= 

n,m+1
n + m +2 
1
j j	1
n+1,m
j
n + m +2 
j

 n+m+2 v(w ∗ v w )+  n+m+2 v (w ∗ vw)
The result now follows from the recursive definition of the ∗-operator.
□
Lemma 7.2 In the category of vector spaces equipped with the quasishuﬄe algebra modality, for each algebra §V , the differential operator given by:
d : §V → V ⊗ §V	vw '→ (|w| + 1)v ⊗ w
satisﬁes the Leibniz rule.
Proof. We must show that
d(vw⬦vjwj)= d(vw)⬦vjwj + d(vjwj)⬦vw
Note we are using the ⬦ operation to also signify the action of §V on V ⊗ §V . We let |w| = n and |wj| = m.
For the lefthand side, we calculate:
j j	1	j j	j	j
d(vw⬦v w )= d[  n+m+2  (v(v w ∗ w)+ v (vw ∗ w ))] =
n+1,m+1

1	j j	j	j
n+m+2  [(n + m + 2)(v ⊗ (w ∗ v w )+ v ⊗ (vw ∗ w )] =
n+1,m+1
(n + 1)!(m + 1)! [v ⊗ (w ∗ vjwj)+ vj ⊗ (vw ∗ wj)] (n + m + 1)!

For the righthand side, we calculate:

d(vw)⬦vjwj + d(vjwj)⬦vw = (n + 1)v ⊗ (w⬦vjwj)+ (m + 1)vj ⊗ (wj⬦vw)= 
1	j j	1	j	j
(n + 1) n+m+1 v ⊗ (w ∗ v w )+ (m + 1) n+m+1 v ⊗ (w ∗ vw)= 
(n + 1)!(m + 1)! [v ⊗ (w ∗ vjwj)+ vj ⊗ (vw ∗ wj)] (n + m + 1)!
□
Finally we conclude:
Theorem 7.3 For the algebra modality §, the free §V module on V given by V ⊗§V is an FTC-module which furthermore satisﬁes the second fundamental theorem of calculus.
Proof. It remains to verify the two fundamental theorems. The first is straightfor- ward.
We must consider the two cases of monomials V ⊗n , when n = 0 and n ≥ 1.
When n = 0, k ∈ K, recall that d(1) = 0 and P is linear:
P (d(k)) + §(0)(k)= P (0) + k = k
When n ≥ 1, then for vw ∈ V ⊗n (where v ∈ V and w ∈ §(V ) of length |w| = n − 1):


P (d(vw)) + §(0)(vw)= P ((|w| + 1)v ⊗ w)= 
(|w| + 1)

(|w| + 1)
vw = vw

This establishes the second FTC.
□
We now consider the possibility of other §V modules satisfying the second fun- damental theorem. We will show that requiring the second fundamental theorem is in fact a significant restriction.
Lemma 7.4 Let (M, P, d) be an FTC-module over §V which satisﬁes the Second Fundamental Theorem of calculus. Then the following equality holds:
P ; §(0) = 0

Proof.

P ; §(0) = P + P ; §(0) − P
= P ; d; P + P ; §(0) − P
= P (d; P + §(0)) − P
= P − P
=0 
□
Proposition 7.5 For the algebra §V , we consider the FTC-module (V ⊗§V, P, d) as above. Suppose one has another FTC-module (M, R, d) over §V which also satisﬁes the second fundamental theorem. Then there is a k-linear isomorphism between M and V ⊗ §V given by
P ; D : V ⊗ §V −→ M	R; d : M −→ V ⊗ §V
Furthermore, if P ; D satisﬁes the following for all a ⊗ w ∈ V ⊗ §V :
D(P (a ⊗ w)) = wD(a)
then P ; D is a module map, implying V ⊗§V and M are isomorphic as §V -modules.
Proof.
By the above lemma, R; §(0) = 0 and P ; §(0) = 0, and so we get the following equalities:

R = R(dP +§(0)) = RdP +R§(0) = RdP   P = P (DR+§(0)) = PDR+P §(0) = PDR
So calculate as follows:
P ; D; R; d = P ; d = idV ⊗§V

R; d; P ; D = R; D = idM
So PD and Rd are K-linear isomorphisms.
Now suppose that for all a ⊗ w ∈ V ⊗ §V : D(P (a ⊗ w)) = wD(a). By a simple calculation we have that for all v ∈ §(V ):

D(P (v(a ⊗ w))) = D(P (a ⊗ v ⬦ w))
= (v ⬦ w)D(a)
= v(wD(a))
= v(D(P (a ⊗ w)))

Which proves that P ; D is a module map.
□
Conclusion
This work originated with the goal of developing a theory of integral linear logic and integral categories to parallel the corresponding differential theories. This work is ongoing but we believe the shuffle structure provides a key towards understanding the integral theory. But furthermore it is of interest even in its own right. The idea of weakening the notion of monad to quasimonad is new for linear logic and deserves further exploration. (We do note that a different version of weaker structure was introduced in [20,21].) Also, we find the combinatorics of shuffling and its variants fascinating and wonder what other structure is to be found there and what it would have to say about linear logic.
We also note that one can still consider T -algebras when T is just a quasimonad. See [28]. An extension of the theory of universal derivations established in [2] for general T -algebras was carried out by O’Neill in [27]. This theory was subsequently subsumed in [4] where the general notion of a T -derivation with respect to an algebra modality was introduced. It will be interesting to see the extent to which the work there lifts to the quasimonad setting.
The notion of Rota-Baxter algebra as studied in [14] and the references therein is in fact much more general than the definition presented here. In particular, they have the notion of Rota-Baxter algebra of weight λ. The definition is as follows:
Definition 8.1 Let A be a k-algebra. A is a Rota-Baxter algebra of weight λ if equipped with a k-linear map P : A → A such that for all x, y ∈ A
P (x)P (y)= P (xP (y)) + P (P (x)y)+ λP (xy)
Our notion of module with integration only captures the weight 0 case. But there is an evident notion of module with integration of weight λ. The logical significance of this is likely quite interesting. At the same time, Guo and Keigher have also developed a corresponding notion of differential algebra of weight λ, defined as follows:
Definition 8.2 Let A be a k-algebra. A is a differential algebra of weight λ if equipped with a k-linear map d : A → A such that for all x, y ∈ A
d(xy)= xd(y)+ d(x)y + λd(x)d(y)
They combine the two structures in [16]. The paper [17] studies the corresponding monadic and comonadic structures. Obviously there is a great deal of structure here to be studied.
We also note that there is a corresponding theory of Rota-Baxter coalgebras [22]. So many of the structures defined here could be redefined in the coalge- braic/comonadic setting. Of course, it remains to find as compelling an example as

the shuffle structures considered here.
Two further ideas for future work are as follows. First it is important to develop the above theories in the noncommutative case. This work for the differential setting was begun in the preprint [6]. Free Rota-Baxter algebras in the noncommutative case are constructed by Ebrahimi-Fard and Guo using operations on rooted trees in [7]. It is this construction that arises in renormalization of perturbative quantum field theory [8].
We would also like to construct free FTC-modules in both the weight 0 and weight λ cases. Obviously these will be related to the structures found in [16,17]. This generalized notion of shuffle is also related to the quasishuﬄe of Hoffman [19].

References
R. Blute, J.R.B. Cockett, R.A.G. Seely. Differential categories. Mathematical Structures in Computer Science 16, pp. 1049-1083, (2006).
R. Blute, R. Cockett, T. Porter, R. Seely. K¨ahler categories. Cahiers de Topologie et Geometrie Differentielle 52, pp. 253-268, (2011).
R. Blute, T. Ehrhard and C. Tasson. A Convenient Differential Category. Cahiers de Topologie et Geometrie Differentielle 53. pp. 211-233, (2012).
R. Blute, R.B.B. Lucyshyn-Wright, K. O’Neill. Derivations in codifferential categories. to appear in
Cahiers de Topologie et Geometrie Differentielle, (2016).
G. B¨ohm. The weak theory of monads. Adv. Math. 225 pp. 1-32, (2010).
R. Cockett. Lectures on noncommutative K¨ahler categories. Preprint (2014).
K. Ebrahimi-Fard, L. Guo. Free Rota-Baxter algebras and rooted trees. J. Algebra and Its Applications 7, pp. 167-194 (2008).
K. Ebrahimi-Fard, L. Guo. Rota-Baxter Algebras in Renormalization of Perturbative Quantum Field Theory. in Universality and Renormalization, edited by I. Binder and D. Kreimer, (2007).
T. Ehrhard, L. Regnier The differential λ-calculus. Theoretical Computer Science, 309(1-3) (2003) 1–41.
T. Ehrhard, L. Regnier Differential interaction nets. Workshop on Logic, Language, Information and Computation (WoLLIC), invited paper. Electronic Notes in Theoretical Computer Science, vol. 123, March 2005, Elsevier.
J.-Y. Girard Linear logic. Theoretical Computer Science 50 (1987) 1–102.
L. Guo. Properties of free Baxter algebras, Adv. Math. 151, pp. 346– 374, (2000).
L. Guo. Baxter algebra and differential algebra, in Differential Algebra and Related Topics, World Scientific Publishing Company, 2002.
L. Guo. An Introduction to Rota-Baxter algebra. Surveys of Modern Mathematics 4, (2012).
L. Guo, W. Keigher. Baxter algebras and shuﬄe algebras. Advances in Mathematics 150, pp. 117-149, (2000).
L. Guo, W. Keigher. On differential Rota-Baxter algebras, J. Pure Appl. Algebra 212, pp. 522-540, (2008).
L. Guo, W. Keigher, S. Zhang. Monads and distributive laws for Rota-Baxter and differential algebras, preprint, (2014).
R. Hartshorne, Algebraic Geometry. Springer-Verlag, (1977).
M.E. Hoffman. Quasi-shuﬄe products. J. Algebraic Combinatorics , pp. 49-68, (2000).

R. Hoofman. Non-stable models of linear logic. Logical Foundations of Computer Science, Lecture Notes in Computer Science 605, pp. 209-220, (2005).
R. Hoofman, I. Moerdijk. A remark on the theory of semifunctors. Mathematical Structures in Computer Science 5, pp. 1-8, (1995).
R. Jian, J. Zhang. Rota-Baxter coalgebras, (preprint), (2014).
G. Landi. An introduction to noncommutative spaces and their geometries. Lecture Notes in Physics, Springer-Verlag, (1997).
S. Lang. Algebra, Third Edition, Springer Graduate Texts in Mathematics, Springer-Verlag, (2005).
H. Matsumura. Commutative Ring Theory, Cambridge University Press, (1986).
P.-A. Mellies. Categorical semantics of linear logic. Panoramas et Syntheses 27, Societe Mathematique de France, (2009).
T. O’Neill. Differential Forms for T-Algebras in K¨ahler Categories. M.Sc. Thesis, (2013).
R. Wisbauer. Regular pairings of functors and weak (co)monads. Algebra & Discrete Math 15, pp. 127-154, (2013).
S. Zheng, L. Guo, M. Rosenkranz. Rota-Baxter operators on the polynomial algebra, integration and averaging operators. Pacific Journal of Mathematics 275, pp. 481-506, (2015).
