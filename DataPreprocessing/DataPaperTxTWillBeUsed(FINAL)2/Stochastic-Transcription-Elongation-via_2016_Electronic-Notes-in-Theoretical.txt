Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 326 (2016) 73–88
www.elsevier.com/locate/entcs

Stochastic Transcription Elongation via Rule Based Modelling
Masahiro Hamano1,2
Graduate School of Information Science and Technology University of Tokyo, JAPAN

Abstract
Transcription elongation is the mechanism by which RNA polymerase (RNAP) moves along template un- zipped DNA and synthesizes a complementary single-stranded RNA. During the elongation, RNAP forms a stable transcription elongation complex (TEC) with the template DNA and the nascent RNA. The mecha- nism involves back-tracked and forward-tracked modes of TEC and the polymerisation and depolymerisation of RNA. To capture the stochasticity of the elongation, we describe the mechanism in terms of rule-based modelling through the TEC’s local window frame of adjacent active sites. In this way, we can uniformly derive the variations of known kinetic pathways for various interaction combinations of TEC’s active sites. From the compact interactions at local sites, we find abstracted rules for the elongation. As the semantic counterpart, we derive quasi-steady state approximations to the chemical master equations. The stochastic models are thermodynamically interpreted as the free energy distributions of agents with variant configu- rations.
Keywords: RNA polymerase, Transcription Elongation Complex, Master Equation, Rule-Based Modelling, Brownian Ratchet Model, Equilibrium Kinetics, Chemical Equilibrium, Steady State Dynamics, Quasi-Steady State, Michaelis-Menten Kinetics, Free Energy, Boltzmann Distribution

Introduction
The stochasticity of gene regulation and expression, which is intrinsic to discreteness and small numbers of molecules partaking in and regulating biological events [19], has been successfully modelled by stochastic process calculi such as stochastic π [22] and rule based κ [7,11]. Such models represent each constituent of the biochemical process by stochastic interactions among agents. Agents interact at biochemical sites through channels at rates modelled by exponential time distributions. As a syntactical rule, this description yields a semantic counterpart of a Markov process, such that each single-step interaction has a Poisson waiting time. Similar modelling has been applied in queue theory [10] and more generally in the theory of stochastic petri nets [9].

1 Research supported by Grant-in-Aid for Scientific Research (C) (25400195) of JSPS
2 Email: hamano@is.s.u-tokyo.ac.jp

http://dx.doi.org/10.1016/j.entcs.2016.09.019
1571-0661/© 2016 The Author(s). Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

directi—on→of  transcription



unzipped DNA

,, ,,
/	zactiversite
/	z r
/	/	@

nascent RNA	//
5′
@@ s 
PPi NTP
release entry

RNA exit channel	secondary channel
Fig. 1. Structure of TEC

In this paper, we examine whether stochastic rule-based modelling captures multi-step molecular interactions. As biochemical interactions are non-uniform and occur at different rates, they are characterized by stochastic fluctuations, non- Poisson time dynamics and decay of particular biological events. For this purpose, we model transcription, which is a typical molecular multi-step interaction. As the first phase of gene expression, transcription involves a tiny minority of the molecules reacting in cells. Thus, for modelling transcription, a rule-based stochastic method is preferred over the deterministic method of mass action laws. Rule-based mod- elling directly describes the stochastic and discrete nature of chemical reactions in transcriptional elongation. The primitive agents are the hundreds (or thousands) of base pairs contained in a single gene, and a similar number of nucleoside triphos- phates (NTPs) that join the transcript via RNA polymerase. The present author applied a similar nucleotide-based modelling concept to multiple branching pro- cesses in RNA interference [15].
Transcription (mRNA synthesis) from the corresponding unzipped single- stranded DNA template proceeds in three sequential stages: Initiation, Elongation and Termination. The main stage is elongation. RNAP is a mechano-chemical cou- pling mechanism that converts the chemical energy derived from NTP hydrolysis into mechanical work, together with random Brownian motion involving back-tracked and forward-tracked modes. The RNAP kinetics and mechano-chemical motions are mediated by the Transcription Elongation Complex (TEC) [18], formed by the combination of RNAP, the template DNA and the nascent RNA (cf. Fig 1). The principal kinetic feature is the mechano-chemical cycle of NTP binding: Nucleotide incorporation induces the pre-translocation state of TEC. The TEC advances by 1 bp along the DNA, thereby returning to post-translocation. Initiation is much faster than elongation; moreover, during the elongation phase, the mRNA synthesis is often disrupted by transcriptional pauses, which are linked to the reverse translo- cation of RNA along the DNA. Therefore, stochastic fluctuations and time delays are characteristic of transcriptional regulation.
Based on recent single-molecule experiments (such as magnetic and optical tweezers and single-molecule fluorescence), researchers have proposed theoretical biochemical models to explain the elongation kinetics in terms of the individual

biochemical reactions that dominate the behaviour [1,2,6,14,21,23,27,33]. Theoret- ical transcription models have focused on the RNA-mediated coupling of chemical catalysis energy to translocation and mechanical work. The present paper surmises that rule-based modelling conveniently captures the fundamentals of the dynamism; namely, the thermodynamic stability of TEC as the elongation proceeds [2,33]. Our rule-based framework represents biochemical interactions through the adjacent ac- tive sites of TEC, and captures the stability of multiple variant forms of TEC arising from interactions during mechano-chemical movement. As a semantic counterpart to our rule-based description, we uniformly derive systems of stochastic master equations that describe stochastic models [17,24,28,30,31] of elongation in special cases. Moreover, we naturally derive the probability distribution of the various TEC forms. Consequently, the thermodynamical stability of TEC along DNA and RNA is given by an energy function.
The remainder of this paper is organised as follows. Section 2 explains how syntactical rule-based modelling uniformly describes the biochemical pathways of elongation. The description considers enzyme reactions through certain active sites and the binding/unbinding interactions in polymerisation/depolymerisation. Sec- tion 3 develops the semantic counterpart of Section 2. In this section, the time- evolutions of probabilities among agents with varying configurations are modelled by systems of stochastic master equations. The constructed models elucidate the thermodynamical meaning of the kinetic pathways in the mechano-chemical reac- tions by means of the probability distributions and convergence to equilibrium. Moreover, we characterize the biochemically popular quasi-steady state approxima- tion [16,26], and compare it with the semantics abstracted from the master equation. The approximation suggests that the finer semantics can be retrieved from coarser grained semantics arising in the rule-based abstraction. In Section 4, our stochas- tic rule-based method is shown to incorporate Michaelis-Menten enzyme kinetics under chemical equilibrium conditions. Moreover, our agent model is shown to nat- urally provide a thermodynamical and kinetic modelling in terms of the free energy distribution.
Elongation Pathways as Site Interactions inside TEC
First, we introduce the minimal common mechanism that underlies various elonga- tion pathways mediated by TEC. This mechanism is crucial for describing various biochemical kinetic pathways in terms of the NTP incorporation cycle, which pro- ceeds as follows:

Pre- and post-translocation [2,3,18]
Elongation is the polymerisation step, which adds a nucleotide to the 3j end of the nascent RNA. This reaction is catalysed by the active site of RNAP. After the polymerisation, TEC immediately enters the pre-translocation state, and translates forward along the DNA template until the active site is correctly positioned to catalyse the next nucleotide addition. Pre-translocation is the state immediately

following the forward location of TEC and polymerisation of the next nucleotide. Only when the TEC is post-translocated, the RNAP’s active site is adjacent to the 3j- end of the nascent RNA, enabling binding and incorporation of the next nucleotide.

Back- and forward-tracking [2,3,12]
The forward polymerisation of the RNA transcript is disrupted by pauses of the RNAP (known as transcriptional pausing [18]). The major cause of pausing is back- track, in which the active site of RNAP moves backward along the DNA template and RNA transcript without depolymerising the transcript. The opposite movement is forward-track (also called hyper translocation) towards the 5j end of the template DNA.
Using the above terminologies, we develop a a fundamental scheme for the elon- gation mechanism. Let TEC(n,∗) represent a TEC with transcript size n at stage
∗ (hereafter, we abbreviate the terms pre- and post-translocation to pre and post,
respectively). The pathway converts chemical energy into the mechanical energy required to move RNAP in the backward and forward directions


Brownian Ratchet Model [2,3]
TEC(n,f,wdtrack)

(1)

TEC
¸ k1	 TEC
NTP k2 TEC
PPi
· NTP  TEC

(,n,pre)
 
TEC(n,backtrack)

k−1
(n,post) ¸  
−2
(n,post)
¸ 	(n+1,pre)

The first reaction is translocation and the central reaction is NTP binding and recog- nition, when the active site locates at the growing tip of the mRNA. The right-most reaction combines two reactions; NTP hydrolysis and the release of pyrophosphate PPi:


TEC

NTP ¸k3 TEC

PPi
PPi ¸4	 TEC
(2)

(n,post)
k−3
(n+1,pre)
k−4
(n+1,pre)

This combination assumes that the NTP hydrolysis rates are much larger than the PPi release rate; thus, the separate steps can be treated as one step with a single effective rate.
The pathway (1) is described by a rule-based modelling using n calculus. The agents and rules are specified as follows:

Agents
A nucleotide N (l, r) is a monomeric subunit with phosphate bonds l and r.
Binding of both sites is represented by a common superscript.
The agent W represents a window frame of TEC’s multi-partite active sites (P) and (A), where the (P) and (A) sites hold the RNA 3’-nucleotide and the substrate NTP

[18], respectively. W possesses a site for PPi association. As the window frame, the agent W slides back and forth along the template DNA and RNA transcript, mimicking the movement of the active site. The Null agent is denoted by ∅. The substrate agent NTP is parallel to N but lacks a bonding site. See Fig 2.








m < 0	m =0	m > 0
W
,J¸˜`˜¸ `,\	,J¸˜` ˜¸ `,\   ,J¸˜`˜¸ `,\

3′




Fig. 2. Agents
5′		 	
n
Fig. 3. Position (n, m) of W
.




These agents discriminate among post-translocation, pre-translocation and loading of TEC as follows:
post-translocation: W [N (r), ∅] schematically ,JN˜¸O`  H ˜¸ `,\ pre-translocation: W N (r1),N (l1, r) schematically ,J¸˜N`  N¸˜O  `H\, loading:	W [N (r), NTP]  schematically ,JN˜¸O` H ¸˜NT `P\,
The OH subscript of N designates the 3j OH in the next nucleotide reaction that
extends the RNA chain. In other words, OH indicates that the r site of N is not bounded. In the pre-translocation state, the line joining N and NOH designates a phosphate bond between the r and l sites respectively of N and NOH.
An additional site is augmented for counting the position (n, m) ∈ N × Z, where n indicates the length of the nascent RNA (the position of either the last nucleotide or the loaded NTP) and m indicates the back (m < 0) and forward (m > 1) track positions. Although redundant for m = 0 and 1, the position m = 0 (resp. m = 1) indicates a pre-translocated (resp. post-translocated) position. See Fig 3.
We next introduce three kinds of rules, ElongZ, ElongN and Elong, which dictate the degree of abstraction of agent W. That is, forgetting the counter, we abstract
Wm first to Wn, and then to W. Let us start with the finest grained rules ElongZ.
n	N

Rules of ElongZ


.
,,
  
W3 [∅, ∅]
n ,,
  
W2 [∅, ∅]
n ,,


W  N (r1),N (l1, r) ¸,  W¸

   ∅] ¸, ¸♦	of the bottom

n	,,
  
n [N (r),

W−1  N (r1),N (l1, r1) 

n	,,
  
n	,,
  
.
These rules directly correspond to path-
way (1), so the vertical and horizontal rules respectively correspond to back/forward- tracking and the main reactions of the pathway.

The rules ♦ correspond directly to the pathway (2):

Wn+1 [N (r), NTP] →→ WPPi
 N (r1),N (l1, r) →→ Wn+1 N (r1),N (l1, r) 

Fig. 5. ElongZ


Forgetting the counter m of Wm for Wn, the horizontal pathways of forward- and back-tracking respectively reduce to:


Rules of ElongN


Wn  N (r1),N (l1, r)
,,

  




and


,,

  
W [N (r), ∅)]

Wn  N (r1),N (l1, r1) 
Finally, if agent W is expressed in its simplest form without the counter, the above rules are abstracted as follows. These rules explicitly express the mechano-chemical cycle of NTP during the elongation stage:

Rules of Elong
A complex version of the above simple Brownian ratchet model allows NTP bind- ing to both post-translocated and pre-translocated positions (Complex Brownian Ratchet Model with an Auxiliary Binding Site [3]).

 r
W [∅, ∅]
,,
  
W [N (r), ∅]¸¸_

,,,,,,,,,˛ 
W N (r1),N (l1, r) 
¸¸¸¸¸
¸¸¸¸z_
W _[N¸(r), NTP]

,, ¸¸¸¸_¸¸
	¸¸¸¸¸z_
,,,,,,,,
c

W N (r1),N (l1, r1)
,,
WPPi N (r1),N (l1, r) 
Fig. 6. Elong



TEC
NTP ¸ ki1	 TEC
NTP
followed by (2)
(3)

(n,pr,e)

NTP
k−i1
(n,pos,t)
NTP
 

J 
TEC	¸
ki2	 TEC 

(n,pre)
k−i2
(n,post)

When an (E) site for NTP-entry can be augmented to W, the complex ratchet model is realised by the following rules. Thereby, the complex pathway (3) is realised by adding one auxiliary site to the agent W .
Semantics and Abstraction
This section constructs the semantics of the rule-based description of the elongation presented in Section 2. Using master equations, three semantics are constructed for
ElongZ, ElongN and Elong. We proceed from the finest grained semantics of ElongZ,
N	N
through the coarser grained semantics of ElongN and finally to the coarsest semantics
of Elong, by progressively simplifying (abstracting) the construction. Our stochastic semantics of the chemical master equations describes the time evolution of the agent Ws with various configurations, governed by the rules of Section 2. By deriving the master equations in tight accordance with the rule description, we obtain a uniform
comprehension of existing mathematical elongation models [17,24,28,30,31].
We emphasize here that all rules of Section 2 are local; the chemical interac- tions are independent of the global conditions of agents lying outside the TEC’s active sites. In other words, we need not specify the contextual details of agents outside the window frame represented by W. (Such details include the polymerisa- tion/depolymerisation of contiguous nucleotides downstream from W to the 5j-end of RNA, and their hybridisation to the template DNA.) Local interactions via adja- cent sites inside the window W effectively capture the biochemical pathways. This



 W • ¸β,3
α3 W¸•

,n ,
α  n,+1,

. . . W−1	β2 .
1
. . W−1

n¸,¸ ¸ α
n+¸,1¸¸¸

¸¸z 2 
········· W ¸,
¸z 
	 W¸0

n ¸,¸¸¸
α4  n+1 ¸,¸ ¸
 β s	zר  z

(z	b	¸z 1
1
n+1

Fig. 7. Local state transitions of ElongZ−
locality allows us to construct a compact system of master equations, avoiding combinatorial blow-up of the number of transition-states, and ensuring a tractable master equation for extracting the means and approximations [24]. General master equations are difficult to solve directly, but our equations have finite dimensions because the TEC dynamics involve small populations of molecules. Biologically, the locality reflects the thermodynamic stability of TEC with respect to the DNA template and the RNA transcript [32].

Master Equation Semantics
We start this subsection with a convention imposed by the locality of the rules: The agents Ws at the back (m > 2) and forward (m < 0) tracked positions are sufficiently determined by their counting states at site (n, m) of Wm. Similarly, in the main reaction pathway, we stipulate that m = 1 (resp. m = 0) designates pre-translocation (resp. post-translocation) as follows:
W 0 = Wn  N (r1),N (l1, r)	W 1 = Wn [N (r), ∅]	W• = Wn [N (r), NTP]
These Wj’s with varying (n, j) constitute the state transitions representing TEC’s local interactions during elongation.
The state transitions are locally described by the stereographic diagram of Fig
7 3 . The transition probabilities are identified by the rate constants of their cor- responding reactions in pathways (1) and (2); that is, a = k1  b = k−1, α1 = k2, β1 = k−2, α2 = k4k3, and β2 = k−3k−4.
In the stereographic diagram, the vertical and horizontal arrows represent load- ing and unloading of NTP and polymerisation/depolymerisation, respectively. The arrows projecting out of and into the plane of the paper represent back-track and forward-track, respectively. Because TEC is biologically stable, we assume that depolymerisation occurs only in the post-translocation state.
Fig 8 is the global projection of Fig 7 onto a plane. The boundary states are indicated.
The finest grained semantics for the finest rule ElongZ− of Section 2 is now derived
as master equations:

3 To simplify the model construction, we hereafter omit the forward-tracking pathway, and consider
ElongZ− (rather than ElongZ ) where Z− is the set of negative integers.
N	N











W−1
,,




W−n+1
n ,,
  
.
,,

−1
b ,,
Wn+1
−,n ,
  
Wn+1
−,n+,1
  
.
,,
  
W −1
n,+1,

  
0 ¸, 0	, ¸
¸,  a 0 β4 ,α4  0 
, ¸

W
¸,,,
  
,, ¸
W¸¸
¸,,,
  
W 1
2,,, ¸
············ 
 ¸¸
¸,,,
α2
  
W 1
n¸,¸ ¸
W¸	¸
¸,,,
  
W 1
n+1,¸ ¸
··· 

,,,
,
,,,
β1
¸¸¸ β
¸¸¸
¸¸
¸¸¸¸

t•\
,,ztz\
¸ 2
ztz•\
α1 ¸¸ztz\

W1 ¸, W¸2 ¸, · ·¸·········· ¸,  W¸n ¸,α3 W¸n+1 ¸, · ·¸· 

Fig. 8. Global diagram of Fig 7 for ElongZ−


Semantics for ElongZ−
For j ∈ {0, 1, •}, let w[j] be the probability π(Wj , t) of finding Wj

at time t.

n	n	n
The master equation [29] is the gain-loss equation describing the probabilities w[j] among separate states Wj . In the following equations, the first term on the right- hand side is the gain probability that the system arrives at the state from the left. The second right-hand term is the loss probability that the system leaves the state for the left.

Evolution along the main pathway

 d w[0] = aw[−1] + α w[0]
+ β w[0]
+ α w[•] + bw[1] 

—(α4 + β2 + a + b + β4)w[0]
(4)

 d w[•] =	 α w[•]
+ β w[•]
+ β w[0] + α w[1]


 d w[1] =	 β w[•]
—(α3 + β3 + α2 + β1)w[•]
+ aw[0] — (b + α )w[1]
(5)
(6)



Evolution along the back-track pathway
d w[−(n−1)] =	bw[−(n−2)] — aw[−(n−1)]


(7)

dt n	n	n

 d w[−j] = aw[−(j+1)] + bw[−(j−1)]  — (a + b)w[−j]
for 1 ≤ j < n — 1 (8)

Normalization constraint
Σ w[0] + w[1] + w[•] + w[−j] =1	(9)

n
(n,j)
n	n	n

where	(n, —j) ∈ N × Z−	s.t.1 ≤ j ≤ n — 1	(10)


Semantics for ElongN
In the rules of abstracted ElongN

, we drop the superscripts —j’s of the W−js for

j ≥ 1. Then, by a similar convention to that specified at the beginning of Section
, we have W− = W  N (r1),N (l1, r1) , where the abstracted W−j’s are expressed
as W−. The probability w[−] of finding W− at time t and the corresponding master
n	n	n
equation are then given as

w[−] =	Σ
w[−j]
and	 d w[−] =	Σ
 d w[−j] = bw[0] — aw[−1]
(11)


	
The time evolution of w[−] of (11) is obtained by summing equations (7) and (8) describing the back-track pathways. By replacing (7) and (8) with (11), we extract

the semantics of ElongN
from those of ElongZ− .

Because the abstracted w[−] together with w[−1] constitute a random walk of
n	n
the forward/backward rates a/b, we can define w[−1] in terms of w[−] as w[−1] =
n	n	n
(aj/a) w[−], where aj := (a — b)/(1 — (b/a)n−1).

Semantics for Elong
In obtaining the coarsest rules of Elong, we forget the subscript n of the Wns, so the agents can be any of W 0, W 1, W• and W−. Then, for j ∈ {0, 1, •, —}, the
probability w[j] of finding Wj at time t is obtained by summing w[j] over the ns; i.e.,

w[j] = Σn
w[j]. The master equations for the probabilities w[•], w[0], w[1] and w[−],

under the normalization constraint 1 = w[•] + w[0] + w[1] + w[−], are correspondingly
obtained by summing equations (4), (5) and (6) over the ns, respectively.

d w[0] = aw[−1] + α w[•] + bw[1] — (β
+ a + b)w[0]	(12)

dt	2	2
d w[•] =	β w[0] + α w[1] — (α + β )w[•]	(13)
dt	2	1	2	1
d w[1] =	β w[•] + aw[0] — (b + α )w[1]	(14)
dt	1	1
The master equations (12), (13), and (14) together with (11) can be characterised by the state-transitions shown in Fig 9.
We now examine the equilibrium convergence of these equations, as depicted in Fig 9. Biologically, the equilibrium assumption corresponds to rapid equilibrium kinetics of translocations [14] and NTP binding for polymerisation [2].
One characteristic of thermal equilibrium is the principle of detailed balance [8,10,16,20], which asserts that forward and reverse reactions must proceed with equal frequency. The word ”detailed” conveys that balance must be satisfied for

•
β2 c ,,,,α¸1

ccc
α2 cc
  jc
,,,
,,β1
vz

W− ¸,
b
 W¸0 ¸,
a	b
 W¸1

Fig. 9. State transitions for Elong
each individual reaction; hence, detailed balance strengthens the globally balanced condition of the stationary distribution (i.e., invariance). Detailed balance char- acterises the time reversibility of the probability flow, and imposes the following conditions on the probability distributions w[j].

Detailed balance
w[0]a = w[1]b	w[1]α1 = w[•]β1	w[•]α2 = w[0]β2
∗	∗	∗	∗	∗	∗
Moreover, in detailed balance, the reaction rates are constrained by the Wegscheider condition [8,16]. The Wegscheider condition, used by chemists as an algorithm to check for detailed balance, stipulates that the free energy change along the triangular path of Fig 9 is zero when the rates are thermodynamically described as in Section 4:

Wegscheider condition
(a/b) (α1/β1) (α2/β2)=1 
Under this condition, the master equations of Elong converge to the equilibrium probabilities w[j] with a relaxation time of τ :

Equilibrium
w[0] = bβ1τ	w[1] = aβ1τ	w[•] = aα1τ	τ = 1/(bβ1 + aβ1 + aα1) (15)
∗	∗	∗

We end this subsection with a short remark on the average behaviour, similarly to [30,31].

Average chemical master equation of Elong
The mean position of the RNAP tip is given by
⟨x(t)⟩ = Σ n w[0] + w[1] + w[•] + w[−j] .

By summing (11), (12), (13) and (14) n-times, the time evolution of the average is simply given by


d ⟨x(t)⟩ = (α — β )w[0] + (α dt	4	4
3 — (β1 + β3))w[•] + α1w[1]

Quasi-Steady State Approximation: From Elong Back to ElongZ
In this short subsection, we accommodate the quasi-steady state approximation (QSSA) into our rule-based modelling. The QSSA, firstly employed in enzymatic kinetic modelling, is widely used in biochemical network modelling and considerably simplifies the modelling [16,26]. QSSA stems from the empirical observation that the reaction intermediates are short-lived relative to the other reactants. In our QSSA, by requiring separation of time scales between the fast and slow reacting interactions, we can approximately retrieve the finest grained rules from the coarsest

grained ones, conversely of the abstract rules from ElongZ
to Elong. Hence the

QSSA is adjoint to the rule abstraction of Section 3.1 between the coarsest and
finest grained rules.
The quasi-steady state approximation relaxes the probabilistic constraint among w[j]’s with respect to the time scale of elongation. Assuming that polymerisa- tion/depolymerisation is much slower than translocation; that is, αi, βi  a, b, the two constants a and b may be omitted over the time scale of our interest [2,14,30], and the observable agents can be expressed as Wn. This yields a quasi-steady state approximation of the semantics, where wn is the probability of finding Wn at time t.


Quasi-steady state approximation
For n ∈ N and j ∈ {0, 1, •, —}, we have
w[j](t) ≈ w[j] ×wn(t)	where	wn =	Σ




w[j]

n	∗	n
j∈{1,0,−,•}
Then, summing equations (4), (5), (6) and (11), we obtain a simple birthdeath master equation with effective polymerisation/depolymerisation rates θ+/θ− :
d
dtwn(t)= θ+wn−1 — (θ+ + θ−)wn + θ−wn+1
in which θ+ = α4bβ1 + α3aα1 + α1aβ1  and  θ− = β4bβ1 + β3aα1 + β1aα1.
Together with the equilibrium solution (15) of Elong, this simple biased random walk derived from the quasi-steady state approximation provides the semantics of the finest rules ElongZ− .
Energy and Chemical Equilibrium
This section discusses the thermodynamical meaning of elongation. We discuss the free energy profile associated with an agent W of variant configurations binding to the active sites of TEC. At equilibrium, the probability function π from a set of configurations wm’s is given by an energy function E [8,9]:
(Boltzmann distribution)

w[j] = π(Wj)=  1
—E (Wj)
exp (	)	with	Z
= Σ exp ( —E (Wn ))	(16)


where kB is the Boltzmann constant, T is the temperature and Zn is the partition function of the transcription length n.

Back-track and forward-track pathways in chemical equilibrium
Let us consider the translocation reaction in ElongZ. The free energy E of a reaction is given by E = E 0 + kBT log Q, where E 0 is the free energy change in the reaction and Q is the reaction quotient, derived from the law of mass action. At equilibrium, E = 0, Q equals the equilibrium constant Keq; hence we have E 0 = —kBT log Keq. That is,
a	E (W 0) — E (W 1)	E (Wi−1) — E (Wi )

Keq =
= exp( 	n	n  )= exp ( 	n	n  )	(17)

b	kBT	kBT
According to this equation, the equilibrium constant Keq is solely determined by the free energy difference of the reaction. Note that (17) is equivalent to the detailed balance condition between the transition rates a and b at equilibrium, but involves the Boltzmann distribution.

The main reaction pathway follows Michaelis-Menten kinetics
In the presence of a competitive inhibitor, the whole horizontal pathway of (1) follows Michaelis-Menten enzyme kinetics [2,14]. In our agent based framework, the enzyme kinetics is directly derivable only under the probabilistic assumption of the rapid convergence of the stationary distribution. We do not require the two traditional assumptions of rapid equilibrium; namely, the Henri-MechaelisMenten assumption (or its more general quasi-steady state version, the Briggs-Haldane as- sumption [5]) and the mass balance of the total concentration [25].

Let p , p  and p
be the probabilities w[1], w[•]	and w[0], respectively. The

1	•	0
n	n+1	n

transition matrix Q in the Kolmogorov backward equation pj(t) = Q p(t) for

p = (pi)i=1,•,0 is then given by Q =
−(q•1+q01) q1•  q10 q•1	−q1•	0
q01	0  −q10
 . Setting Q p(t) = 0,

we obtain the stationary distribution, in which p•, p1 and p0 are given by

p• = q 	1
p1 = q1• p•	p0 = q1• q01 p•

1• (1+ q01 )+1
q•1
q•1 q10

q•1	q10
The probability q1• is associated with the unbinding rate k−2 of NTP from
TEC(n,post), and the reverse binding NTP probability is proportional to the sub- strate concentration [NTP]. Therefore, the first equation becomes
[NTP]
p• = k−2 (1 + q01 )+ [NTP]	by q1• = k−2 and q•1 = k2[NTP]
k2	q10
Let v denote the velocity of the formation rate of TEC(n+1,pre). v is maximized at
vmax = k3′ [TEC(n,pre)] and the ratio v/vmax = p•; thus v becomes
	vmax[NTP]	
v = k−2 (1 + q01 )+ [NTP]
k2	q10
This equation describes Michaelis-Menten kinetics. For the simple translocation

reaction given by the ratio a/b in (17), q01
10
becomes the equilibrium constant Keq.

Similarly, the maximum reaction velocity of the complex pathway (3) becomes
vmax[NTP]
v = k−2  1+(k−i /ki )	,
 
	
which describes the Michaelis-Menten kinetics of the complex pathway.
On the other hand, when the translocations in the back/forward track pathways are in equilibrium, the steady state elongation rate follows global Michaelis-Menten kinetics, given by:

 vmax[NTP]
v =
with	K
[j]
= k−2 log	n 

 
where the range of j ensures that state Wj is accessible from state W 0. Note that
n	n
by the energy/probability correspondence of (16), the log term equals the sum of
the exponential energy differences Σ exp ((E (W 0) — E (Wj))/k T ).
Conclusion and Future Work
This paper presents rule-based modelling of transcription elongation, considering the stochastic interactions among the active sites of TEC. Our modelling provides a uniform insight into the syntactical (i) and semantic (ii) nature of elongation:
Variations in chemical pathways arise by combinations of interacting sites on the agents. The mechano-chemical pathways are described by rules abstracted by ignoring certain sites on the agents.
Our descriptive rules yield a stochastic model of the chemical master equations, so abstractions are naturally derivable from the model. The quasi-steady state approximation is understood as the retrieval of the finest grained rules from the coarser grained ones, which supplements the model abstraction.
Finally, our rule-based modelling provides the thermodynamics of the elongation via the Boltzmann distribution, in which Michaelis-Menten kinetics is well incorporated.
In future work, we will focus on two themes:

Elaborated details of the Brownian ratchet mechanism
The rule-based modelling may be applicable to Brownian movement; in particu- lar, it may describe the conformational details of various pawls in TEC, such as the stationary and reciprocating pawls explained in [4]. These conformations include the G-loop configuration that controls bending/straightening of the F-helix. As the thermodynamical counterpart, the generalized Michaelis-Menten kinetics [13] needs to be examined in terms of our rule-based modelling.

Generalized diffusion with drift
Given that RNAP is a molecular motor, we will augment our rule-based de- scription of Brownian motion with thermal drift (thermal force). In this case, the probability flux is determined by the drift plus Fickian diffusion. Therefore, in

terms of n, we need to express the probability flux as a Fokker-Planck equation. This theme is important because the Boltzmann distribution is an equilibrium so- lution of the FP equation. Our future work will provide a more energy-efficient description of elongation (accommodating the energy landscape and other terms used by chemists).
Acknowledgement
The author would like thank the anonymous referees and the participants of SASB 2015 for their insightful comments and constructive suggestions.

References
I.Artsimovitch, and R. Landick, Pausing by bacterial RNA polymerase is mediated by mechanistically distinct classes of signals, Proc Natl Acad Sci USA, 20, 97(13), 7090-5 (2000)
L. Bai, A. Shundrovsky, MD. Wang, Sequence-dependent kinetic model for transcription elongation by RNA polymerase, J Mol Biol. 19;344(2), 335-49 (2004)
L. Bai, A. Shundrovsky, and MD. Wang, Kinetic modeling of transcription elongation, In RNA polymerases as molecular motors by the Royal Society of Chemistry (2009)
G.Bar-Nahum, V.Epshtein, AE.Ruckenstein, R.Rafikov, A.Mustaev and E.Nudler, A Ratchet Mechanism of Transcription Elongation and its Control, Cell 120(28) 183-93 (2005)
G.E. Briggs and J.B.S. Haldane, A note on the kinematics of enzyme action, Biochem J 19 (2): 338339. (1925)
P. R. Costa, M. L. Acencio, and N. Lemke, Cooperative RNA Polymerase Molecules Behavior on a Stochastic Sequence-Dependent Model for Transcription Elongation, PLoS One. 8(2), e57328. (2013)
Vincent Danos, J´erˆome Feret, Walter Fontana, Russell Harmer and Jean Krivine, Rule-based modelling of cellular signalling, (CONCUR 2007), LNCS 4730, Springer (2007)
Vincent Danos, Nicolas Oury, Equilibrium and Termination, DCM’10, EPTCS 26, 75-84 (2010)
Vincent Danos, Nicolas Oury, Energy and Termination II: the case of Petri nets, Mathematical Structures in Computer Science 23(2): 290-307 (2013)
Rick Durrett, Essentials of Stochastic Processes, Springer Texts in Statistics (1999)
J´erˆome Feret, Vincent Danos, Jean Krivine, Russ Harmer and Walter Fontana, Internal coarse-graining of molecular systems, Proc. Natl. Acad. Sci. USA, 106(16) 6453-6458 (2009)
J. Gelles, R. Landick, RNA polymerase as a molecular motor, Cell 93.1 13-6 (1998)
A.N. Gorban and M. Shahzad, The Michaelis-Menten-Stueckelberg Theorem, Entropy, 13 966-1019 (2011)
R. Guajardo, R. Sousa, A model for the mechanism of polymerase translocation, J Mol Biol. 10;265(1), 8-19 (1997)
Masahiro Hamano, Sustainability of RNA-interference in Rule-Based Modelling, In Proc. of the Third International Workshop on Static Analysis and Systems Biology (SASB 2012) Electronic Notes in Theoretical Computer Science 313, 6577 (2015)
R. Heinrich, S. Schuster, The Regulation of Cellular Systems, Chapman Hall, (1996)
Frank Julicher and Robijn Bruinsma, Motion of RNA Polymerase along DNA: A Stochastic Model, Biophysical Journal 74 11691185 (1998)

R. Landick, The regulatory roles and mechanism of transcriptional pausing, Biochemical Society Transactions 34, part 6, (2006)
HH. McAdams, A. Arkin, Stochastic mechanisms in gene expression, Proc Natl Acad Sci USA. 4;94(3)
814-9 (1997)
J. R. Norris, Markov Chains, Cambridge University Press, Cambridge Series in Statistical and Probabilistic Mathematics (1998)
E. Nudler, Transcription elongation: structural basis and mechanisms, Journal of Molecular Biology,
288(1) 1-12. (1999)
C. Priami, A. Regev, E. Shapiro, W. Silverman, Application of a stochastic name-passing calculus to representation and simulation of molecular processes, Information Processing Letters 80 25-31 (2001)
AS. Ribeiro, OP. Smolander, T. Rajala, A. Hkkinen, O. Yli-Harja, Delayed stochastic model of transcription at the single nucleotide level, J Comput Biol. 16(4), 539-53 (2009)
Marc R. Roussel and Rui Zhu, Stochastic kinetics description of a simple transcription model, Bull. Math. Biol. 68, 1681-1713 (2006)
IH. Segel, Enzyme Kinetics: Behavior and Analysis of Rapid Equilibrium and Steady-State Enzyme Systems, Wiley, (1993)
L. A. Segel, Modelling dynamic phenomena in molecular and cellular biology, Cambridge Univ. Press, Cambridge (1984)
V. Tadigotla, D. Maoileigidh, A. Sengupta, V. Epshtein, R. Ebright, et al, Thermodynamic and kinetic modeling of transcriptional pausing, Proc. Natl. Acad. Sci. USA. 103, 819 (2006)
T. Tripathi, D. Chowdhury, Interacting RNA polymerase motors on DNA track: effects of traffic congestion and intrinsic noise on RNA synthesis, Physical Review E77 (1), 011921 (2008)
N.G. Van Kampen, Stochastic Processes in Physics and Chemistry (3rd edn) North Holland (2007)
M. Voliotis, N. Cohen, C. Molina-Par´ıs, and T. B. Liverpool, Fluctuations, pauses, and backtracking in DNA transcription Biophys. J. 94, 334348 (2008)
Hong-Yun Wang, Tim Elston, Alexander Mogilner, George Oster, Force Generation in RNA Polymerase, Biophysical Journal 74, 11861202 (1998)
K. Wilson, C. Conant and P. von Hippel, Determinants of the Stability of Transcription Elongation Complexes: Interactions of the Nascent RNA with the DNA Template and the RNA Polymerase, J. Mol. Biol. 289, 1179-1194 (1999)
Thomas D. Yager , Peter H. Von Hippel, A thermodynamic analysis of RNA transcript elongation and termination in Escherichia coli, Biochemistry 30 (4), 10971118 (1991)
