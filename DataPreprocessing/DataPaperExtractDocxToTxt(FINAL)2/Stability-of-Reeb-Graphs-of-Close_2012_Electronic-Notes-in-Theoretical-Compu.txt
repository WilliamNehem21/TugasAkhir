Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 283 (2012) 71–76
www.elsevier.com/locate/entcs
Stability of Reeb Graphs of Closed Curves
Barbara Di Fabio1
ARCES
Universit`a di Bologna Bologna, Italy
Claudia Landi2
Dipartimento di Scienze e Metodi dell’Ingegneria Universit`a di Modena and Reggio Emilia
Reggio Emilia, Italy

Abstract
Reeb graphs are very popular shape descriptors in computational frameworks as they capture both ge- ometrical properties of the shape, and its topological features. Some different methodologies have been proposed in the literature to estimate the similarity of shapes through the comparison of the associated Reeb graphs. In this context, one of the most important open questions is whether Reeb graphs are robust against function perturbations. In fact, it is clear that any data acquisition is subject to perturbations, noise and approximation errors and, if Reeb graphs were not stable, then distinct computational investigations of the same object could produce completely different results. In this paper we present an initial contribution to establishing stability properties for Reeb graphs. More precisely, focusing our attention on 1-dimensional manifolds, we define an editing distance between Reeb graphs, in terms of the cost necessary to transform one graph into another. Our main result is that changes in Morse functions imply smaller changes in the editing distance between Reeb graphs.
Keywords: Shape comparison, editing distance, Morse function.


Introduction
Let M be a closed compact smooth manifold endowed with a simple Morse function f : M→ R. The quotient space obtained from M identifying points that belong to the same connected component of each level set of f is the body of a finite simplicial complex of dimension 1, called a Reeb graph.
Originally defined in 1946 by the mathematician George Reeb [5], Reeb graphs have been introduced in Computer Graphics in 1991 [6,7], becoming, in a few years,

1 Email: barbara.difabio@unibo.it
2 Email: clandi@unimore.it

1571-0661 © 2012 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2012.05.006

very popular shape descriptors in computational frameworks, especially in appli- cations such as 3D shape matching, shape coding and comparison. Indeed, they capture both geometrical properties of the shape, according to the behavior of the function over the space, and its topological features, described by the connectivity of the graph.
Some different comparison methodologies have been proposed in the literature to compare Reeb graphs for estimating the similarity of the shapes they are describing [4,1]. In this context, one of the most important open questions is whether Reeb graphs are robust against function perturbations. In fact, it is clear that any data acquisition is subject to perturbations, noise and approximation errors and, if Reeb graphs were not stable, then distinct computational investigations of the same object could produce completely different results.
In this paper we illustrate the recent results proved in [3] on the stability problem of Reeb graphs under function perturbations, when the considered manifolds are 1- dimensional. To be more precise, we define an editing distance for comparing Reeb graphs, in terms of the cost necessary to transform one graph into another through a finite sequence of allowed editing operations on their vertices. Then we illustrate the main result of [3], stating that perturbations in the functions imply smaller changes in the editing distance between Reeb graphs, and therefore their stability. This is only an initial contribution to establishing stability properties for Reeb graphs. Indeed, our purpose is to extend such results to the more interesting case of surfaces. In this sense, we think that, even if the editing operations would need to be appropriately modified, the general technique we have used to prove our main
result can be easily generalized.
Preliminaries on Reeb graphs
This section provides basic notions on Reeb graphs and the notations we will use in the rest of the paper.
Let M be a smooth (i.e. differentiable of class C∞) compact n-manifold without boundary, and let f : M → R be a simple Morse function on M, i.e., a smooth function with finitely many non-degenerate critical points, each of them belonging to a different critical level.
In [5], Reeb stated the following result.
Theorem 2.1 (Reeb, 1946) The quotient space of M under the equivalence re- lation “p and q belong to the same connected component of the same level set of f” is a ﬁnite and connected simplicial complex of dimension 1.
This simplicial complex, denoted by Γf , is called the Reeb graph associated with the pair (M,f ). Its vertex set will be denoted by V (Γf ), and its edge set by E(Γf ). Since the vertices of the Reeb graph correspond in a one to one manner to the critical points of f , we will often identify each v ∈ V (Γf ) with the corresponding critical point p of f . Moreover, if v1, v2 ∈ V (Γf ) are adjacent vertices, i.e., connected by an edge, we will write e(v1, v2) ∈ E(Γf ).

Labelled Reeb graphs of closed curves
Let us focus on M = S1. The Reeb graph Γf associated with (S1,f ) is a cycle graph on an even number of vertices, corresponding, alternatively, to the minima and maxima of f on S1. Furthermore, let us label the vertices of Γf , by equipping each of them with the value of f at the corresponding critical point. We denote such a labelled Reeb graph by (Γf , f| ), where f| : V (Γf ) → R is the restriction of f : S1 → R to its set of critical points. To facilitate the reader, in all the figures of this paper, we consider f as the height function, so that f| (vi) < f| (vj) if and only if vi is lower than vj in the picture.
f	S	v4	G	v4	L
v6
v3	v5	v2
v5
v3
v2	v6


v1	v7		v8 v1
v8
v7
Moreover, we will also identify two labelled Reeb graphs (Γf , f| ) and (Γg, g| ), and write (Γf , f| ) = (Γg, g| ), if there exists an edge-preserving bijection Φ : V (Γf ) → V (Γg) such that f| (v)= g| (Φ(v)) for every v ∈ V (Γf ).
Editing distance between labelled Reeb graphs
Now, we recall the editing operations admissible to transform a labelled Reeb graph into another, their costs, and the editing distance in terms of these costs.
Edit operations on labelled Reeb graphs
The table below schematically illustrates the types of elementary deformations we describe now: (B) stands for birth, (D) for death, (R) for relabelling.

Let (Γf , f| ) be a labelled Reeb graph with 2n vertices, n ≥ 1.
T is an elementary deformation of (Γf , f| ) of type (B) if, for a fixed edge e(v1, v2) ∈ E(Γf ) with f| (v1) < f| (v2), T (Γf , f| ) is a labelled Reeb graph (Γg, g| ) such that
V (Γg)= V (Γf ) ∪ {u1, u2};
E(Γg)= (E(Γf ) − {e(v1, v2)}) ∪ {e(v1, u1), e(u1, u2), e(u2, v2)};

g|V (Γ ) = f| , and g| (v1) < g| (u2) < g| (u1) < g| (v2).
T is an elementary deformation of (Γf , f| ) of type (D) if, for three fixed edges e(v1, u1), e(u1, u2), e(u2, v2) ∈ E(Γf ) with f| (v1) < f| (u2) < f| (u1) < f| (v2), T (Γf , f| ) is a labelled Reeb graph (Γg, g| ) such that
V (Γg)= V (Γf ) − {u1, u2};
E(Γg)= (E(Γf ) − {e(v1, u1), e(u1, u2), e(u2, v2)}) ∪ {e(v1, v2)};
g| = f|V (Γ )−{u ,u } .
T is an elementary deformation of (Γf , f| ) of type (R) if T (Γf , f| ) is a labelled Reeb graph (Γg, g| ) such that
Γg = Γf ;
if e(v1, v2), e(v2, v3) ∈ E(Γf ), then f| (v2) < f| (v1), f| (v3) if and only if g| (v2) < g| (v1), g| (v3).
Since each type of elementary deformation transforms a labelled Reeb graph into another one, simply by changing the labels attached to its vertices, or by adding, or deleting a pair of adjacent vertices, we can apply elementary deformations iteratively to transform any labelled Reeb graph into any other.
Definition 3.1 We shall call a deformation of (Γf , f| ) any finite ordered sequence T = (T1, T2,..., Tr) of elementary deformations such that T1 is an elementary de- formation of (Γf , f| ), T2 is an elementary deformation of T1(Γf , f| ), ..., Tr is an elementary deformation of Tr−1Tr−2 ··· T1(Γf , f| ). We shall denote by T (Γf , f| ) the result of the deformation T applied to (Γf , f| ).
Now, we associate a cost with each type of deformation.
Definition 3.2 Let T be an elementary deformation transforming (Γf , f| ) into (Γg, g| ).
If T is of type (B) inserting the vertices u1, u2 ∈ V (Γg), then we define the associated cost as

c(T )= 
|g| (u1) − g| (u2)|
;
2

If T is of type (D) deleting the vertices u1, u2 ∈ V (Γf ), then we define the
associated cost as

c(T )= 
|f| (u1) − f| (u2)|
;
2

If T is of type (R) relabelling the vertices v ∈ V (Γf )= V (Γg), then we define the
associated cost as

c(T )= max
v∈V (Γf )
|f| (v) − g| (v)|.

Moreover, if T = (T1,..., Tr) is a deformation such that Tr ··· T1(Γf , f| )= (Γg, g| ),
Σr
we define the associated cost as c(T )=	c(Ti).
i=1
Let us introduce the concept of inverse deformation.

Definition 3.3 Let T be a deformation such that T (Γf , f| ) = (Γg, g| ). Then we denote by T−1, and call it the inverse of T , the deformation such that T−1(Γg,g )= 
(Γf , f| ) defined as follows:
If T is elementary of type (B) inserting two vertices, then T−1 is of type (D) deleting the same vertices;
If T is elementary of type (D) deleting two vertices, then T−1 is of type (B) inserting the same vertices, with the same labels;
If T is elementary of type (R) relabelling vertices of V (Γf ), then T−1 is again of type (R) relabelling these vertices in the inverse way;
If T = (T1,..., Tr), then T−1 = (T−1,...,T−1).
r	1
Obviously, from Definition 3.3, it follows that, if T (Γf , f| ) = (Γg, g| ), then
c(T−1)= c(T ).
Editing distance
Let (Γf , f| ) and (Γg, g| ) be two labelled Reeb graphs. Then the set of all the deformations T such that T (Γf , f| )= (Γg, g| ) is non-empty [3, Prop. 2.8]. Actually, this set, that from now on will be denoted by T ((Γf , f| ), (Γg, g| )), contains infinitely many possible deformations transforming (Γf , f| ) into (Γg, g| ), each of them with a different cost. We define the distance between such two graphs as the infimum cost we have to pay to transform the first graph into the second.
Theorem 3.4 For every two labelled Reeb graphs (Γf , f| ) and (Γg, g| ), we set


d((Γf , f| ), (Γg, g| )) =	inf
T ∈T ((Γf ,f| ),(Γg,g| ))
c(T ).

Then d is a distance.
The proof that d is a distance can be found in [3, Sect. 3].
Stability result
Let F(S1, R) be the set of smooth real valued functions on S1, endowed with the C∞ topology, and let us stratify such a space, as done by Cerf in [2]. Let us denote by F0 the submanifold of F(S1, R) of co-dimension 0 that contains all the simple Morse functions f : S1 → R. Then, let F1 = F1∪F 1 be the submanifold of F(S1, R)
α	β
of co-dimension 1, where: F1 represents the set of functions whose critical levels contain exactly one critical point, and the critical points are all non-degenerate, except exactly one; F1 the set of Morse functions whose critical levels contain at most one critical point, except for one level containing exactly two critical points.
The main result of [3] is the following.
Theorem 4.1 Let f, g ∈ F0. Then
d((Γf , f| ), (Γg, g| )) ≤ f − g  C0 .

The proof relies on three intermediate results.
The first one concerns the stability of labelled Reeb graphs under small function perturbations.
(Local stability) Let f ∈ F0. Then there exists a positive real number δ(f ) such that, for every g ∈ F0 with f − g  C2 ≤ δ(f ), it holds that d((Γf ,f ), (Γg,g )) ≤
|	|
 f − g  C0 .
The second one states that, considering a linear path connecting two functions f, g ∈ F0 and not traversing strata of co-dimension greater than 0, the editing distance between the Reeb graphs associated with its end-points is upper bounded by the distance of f and g computed in the C0-norm. In this case the graph (Γg,g ) can be obtained transforming (Γf , f| ) with a sequence of elementary deformations of type (R).
Let f, g ∈ F0 and let us consider the path h : [0, 1] → F(S1, R) defined by
h(λ)= (1 − λ)f + λg. If h(λ) ∈ F0 for every λ ∈ [0, 1], then d((Γf ,f ), (Γg,g )) ≤
|	|
 f − g  C0 .
The last result states that, if two functions f, g ∈ F0 can be connected by a linear path having one point which belong to a stratum F1 and do not traverse strata of co-dimension greater than 1, the cost to transform (Γf , f| ) into (Γg, g| ) is again

upper bounded by	f − g
 C0 . In particular, crossing a stratum F1
(F1, resp.),

means that the Reeb graph is undergoing an elementary deformation of type (R)
((B) or (D), resp.).
Let f, g ∈ F0 and let us consider the path h : [0, 1] → F(S1, R) defined by h(λ)= (1 − λ)f + λg. If h(λ) ∈ F0 for every λ ∈ [0, 1] \ {λ}, with 0 < λ < 1, and h transversely intersects F1 at λ, then d((Γf ,f ), (Γg,g )) ≤ f − g  C0 .

References
Biasotti, S. and Marini, S. and Spagnuolo, M. and Falcidieno, B., Sub-part correspondence by structural descriptors of 3D shapes, Computer-Aided Design 38 (2006), no. 9, 1002–1019.
Cerf, J., La stratification naturelle des espaces de fonctions diff´erentiables r´eelles et le th´eor`eme de la pseudo-isotopie, Inst. Hautes E´tudes Sci. Publ. Math. (1970), no. 39, 5–173 (French).
Di Fabio, B., and Landi, C., Reeb graphs of curves are stable under function perturbations, Tech. Rep.,
U. of Bologna, Dept. of Math., (2011), URL: http://amsacta.cib.unibo.it/2998/.
Hilaga, M., and Shinagawa Y., and Kohmura, T., and Kunii, T. L., Topology Matching for Fully Automatic Similarity Estimation of 3D Shapes, ACM Computer Graphics, (Proc. SIGGRAPH 2001) (Los Angeles, CA), ACM Press, August 2001, pp. 203–212.
Reeb, G., Sur les Points Singuliers d’une Forme de Pfaff Compl´etement Int´egrable ou d’une Fonction Num´erique, Comptes Rendus de L’Acad´emie ses Sciences 222 (1946), 847–849.
Shinagawa, Y., and Kunii, T. L., and Kergosien, Y.L., Surface coding based on Morse theory, IIEEE Computer Graphics and Applications 11 (1991), no. 5, 66–78.
Shinagawa, Y., and Kunii, T. L., Constructing a Reeb Graph automatically from cross sections, IIEEE Computer Graphics and Applications 11 (1991), no. 6, 44–51.
