Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 346 (2019) 393–400
www.elsevier.com/locate/entcs

A General Method for Forbidden Induced Subgraph Sandwich Problem
NP-completeness 1
Simone Dantas2
IME, Universidade Federal Fluminense, Brazil.
Celina M. H. de Figueiredo2
COPPE, Universidade Federal do Rio de Janeiro, Brazil.
Priscila Petito2
FFP, Universidade do Estado do Rio de Janeiro, Brazil.
Rafael B. Teixeira2
ICE, Universidade Federal Rural do Rio de Janeiro, Brazil.

Abstract
We consider the sandwich problem, a generalization of the recognition problem introduced by Golumbic and Shamir (1993), with respect to classes of graphs defined by excluding induced subgraphs. The Π graph sandwich problem asks, for a pair of graphs G1 = (V, E1) and G2 = (V, E2) with E1 ⊆ E2, whether there exists a graph G = (V, E) with E1 ⊆ E ⊆ E2 that satisfies property Π. We consider the property of being H-free, where H is a fixed graph. Using a new variant of the SAT problem, we present a general
framework to establish the NP -completeness of the sandwich problem for several H-free graph classes which
generalizes the previous strategy for the class of Hereditary clique-Helly graphs. We also provide infinite families of 3-connected special forbidden induced subgraphs for which each forbidden induced subgraph sandwich problem is NP-complete.
Keywords: algorithms and computational complexity, graph sandwich problems, satisfiability, Linear CNF-formula, 3-sat, forbidden induced subgraph


1 This study was financed in part by the Coordena¸c˜ao de Aperfei¸coamento de Pessoal de N´ıvel Superior - Brasil (CAPES) - Finance Code 001, CNPq and FAPERJ (Brazilian research agencies)
2 Email: sdantas@id.uff.br, celina@cos.ufrj.br, ppetito@uerj.br, rafaelbt@ufrrj.br

https://doi.org/10.1016/j.entcs.2019.08.035
1571-0661/© 2019 The Author(s). Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

Introduction


All graphs considered here are finite and undirected. Given a graph property Π, the Π graph sandwich problem is defined as follows:
Input: A pair (G1, G2) of graphs with G1 = (V, E1), G2 = (V, E2) and E1 ⊆ E2; Question: Is there a graph G = (V, E) with E1 ⊆ E ⊆ E2 that satisfies property Π?
The graph sandwich problem was introduced by Golumbic and Shamir [6]. Remark that when G1 = G2 the problem is to decide whether G1 satisfies property Π. So the graph sandwich problem generalizes the problem of deciding whether a graph satis- fies a given property. In particular, if the decision problem is NP-complete, then the sandwich problem is also NP-complete. When the property Π is to belong to a class C of graphs, we call this problem the C graph sandwich problem. Golumbic, Kaplan and Shamir [7,8] proved that the interval graph, unit interval graph, permutation graph and comparability graph sandwich problems are all NP-complete; whereas the split graph, threshold graph and cograph sandwich problems are in P.
For an instance (G1, G2) of the graph sandwich problem with G1 = (V, E1), G2 = (V, E2) and E1 ⊆ E2, we say that any element of E1 is a forced edge, any element of E2 \ E1 is an optional edge, and any other pair of V × V is a forbidden edge. Every graph G = (V, E) with E1 ⊆ E ⊆ E2 is called a sandwich graph for the pair (G1, G2). In this case, E consists of all forced edges plus some (possibly zero) optional edges and no forbidden edge.
We say that a graph G contains a graph H if some induced subgraph of G is iso- morphic to H. A graph G is H-free if it does not contain H. Dantas, de Figueiredo, da Silva and Teixeira [2], and Dantas, de Figueiredo, Maffray and Teixeira [3] have studied the H-free graph sandwich problems, determining the complexity status of the problem for several graphs H (paw and (Kp \ e), for every fixed p ≥ 4, are in P; whereas Cp, for every fixed p ≥ 4, claw and bull are NP-complete). More recently, Couto, Faria, Gravier and Klein [1], and de Figueiredo and Spirkl [5] further inves- tigated H-free graph sandwich problems and compared the complexities to probe problems, a variation of sandwich problems where the optional edges occur between vertices of a special subset of V .
Dourado, Petito, Teixeira and de Figueiredo [4] proved the NP-completeness of the Hereditary clique-Helly graph sandwich problem, where the class of Hereditary clique-Helly graphs is defined by a set of four forbidden induced subgraphs, the so-called ocular graphs. Here, we develop this study by providing a general method to prove NP-completeness, which generalizes their strategy, for infinite families of forbidden subgraphs.
In order to complete this task, we have introduced a suitable variant of the NP- complete Linear conjunctive normal form 3-SAT problem (lcnf 3-sat) [9], which we call k-girth lcnf 2-3-sat.

k-GIRTH LCNF 2-3-SAT
We begin this section by proposing a suitable variant of the NP-complete lcnf 3- sat [9], which we call k-girth linear conjunctive normal form 2-3-SAT problem (k- girth lcnf 2-3-sat). According to [9], in the linear conjunctive normal form 3-SAT problem (lcnf 3-sat) the clauses have size 3 and each pair of distinct clauses have 0 or 1 variable in common.
Let I = (X, C) be an instance of 3-sat, where X denotes the set of variables, and C denotes the set of clauses. The bipartite graph of clauses and variables B(I) = (V I, EI ) is a graph constructed from a general instance I = (X, C) of 3- sat as follows. For each clause c of C, there exists a vertex c that belongs to V I . For each variable x of X, there exists a vertex x that belongs to V I . If a clause c contains the literal x or x, then the edge cx belongs to EI . We remark that the linear property of two distinct clauses having 0 or 1 variable in common implies that the girth of B(I) is greater than 4. The proposed variant is stated as follows:
k-girth linear cnf 2-3-sat (k-girth lcnf 2-3-sat)
Instance: set X = {v1,..., vn} of variables, collection C = {c1,..., cm} of clauses over X such that each clause c ∈ C has size 2 ≤ |c|≤ 3 and, for all c, cj ∈ C, c /= cj,
|c ∩ cj| ≤ 1, and the bipartite graph of clauses and variables has girth greater than
k.
Question: Is there a truth assignment for X such that each clause in C has at least one true literal?
Theorem 2.1 k-girth lcnf 2-3-sat problem is NP-Complete.
Proof: Given an instance (X, C) of lcnf 3-sat, we construct an instance (Xj, Cj) of k-girth lcnf 2-3-sat as follows.
Let X = {v1,..., vn} be the set of variables, C = {c1,... cm} be a collection of clauses over X such that each clause c ∈ C has size |c| = 3 and, for all c, cj ∈ C, c /= cj, |c ∩ cj| ≤ 1. This last constraint ensures that the girth g of the bipartite graph of clauses and variables B(I) = (V I, EI ) is greater than 4. In order to increase the value of g we proceed as follows. Set Xj := X and Cj := C. For each clause cj = {l1, l2, l3} ∈ C, 1 ≤ j ≤ m, we introduce two new auxiliary variables, Xj := Xj ∪ {xc , yc }, and we replace cj by three new clauses cj , cjj and cjjj, that is,
j	j	j	j	j
Cj := (Cj \ cj) ∪ {{l1, xc }, {l2, xc , yc }, {l3, yc }}.
j	j	j	j
It is easy to see that this transformation is done in polynomial time. The linear
property implies that the set of clauses C has a size linear in n, which implies that the resulting set of clauses Cj has a size linear in n, since the preceding set of clauses is linear in n, and each clause cj ∈ C is replaced by three clauses with pairwise intersection of at most one variable with all clauses of the new Cj (because these new clauses do not duplicate variables of cj, and distinct additional auxiliary variables are added for each clause cj ∈ C, 1 ≤ j ≤ m).
We claim that instance (X, C) is satisfiable if, and only if, (Xj, Cj) is satisfi- able because clause {l1, l2, l3} is logically equivalent to the set of clauses {l1, xcj },
{l2, xcj , ycj }, {l3, ycj }.

Hc






Hx

Fig. 1. Clause subgraph Hc, variable subgraph Hx, and their connection.
This procedure is reflected in the updated bipartite graph B(I) as follows. Let C be a cycle in B(I) that contains the clause vertex cj. After applying the procedure above, the clause vertex cj is replaced by three new clause vertices, say cj , cjj and
j	j

cjjj; and we also add to V I the two new auxiliary variable vertices xc
and ycj . Let

l1 = x or l1 = x be a literal of the clause cj = {l1, l2, l3}. Hence, the edge xcj is
replaced by the path x, cj , xc , cjj. So, the size of any cycle in B(I) that contains cj
j	j	j
is increased by at least 2 vertices. Now, it is clear that by repeating the procedure
at most k/2 times, we are guaranteed to build in polynomial time an instance I
such that the girth g of B(I) is greater than k, since k is a fixed number.	2
H-free graph sandwich problem
We are interested in a special structure of the forbidden graph. The forbidden graph H is required to have a matching of size 2, say A = {a1aj , a2aj }, and to
 1	2
have an anti-matching (i.e. a matching in the complement graph H) of size 3, say
B = {b1bj , b2bj , b3bj }.
1	2	3
Given an instance (X, C) of k-girth lcnf 2-3-sat, we construct an instance
(G1, G2) of H-free graph sandwich problem as follows (see Figure 1). In what follows, each induced variable subgraph Hx and each induced clause subgraph Hc is a copy of H.
For each variable x of X, there exists an induced variable subgraph Hx in G2, such that the edges axajx and axajx are the unique optional edges of Hx in the set

E2 \ E1.
1 1	2 2

For each three-sized clause c = {l1, l2, l3} of C, there exists an induced clause subgraph Hc in G1, such that for each literal li, i ∈ {1, 2, 3}, we include the addi-
c ′c
tional optional edge bibi  in the set E2 \ E1.
For each two-sized clause c = {l1, l2} of C, there exists an induced clause sub- graph Hc in G1, such that for each literal li, i ∈ {1, 2}, we include the additional
optional edge bcb′c in the set E \ E . Note that, in this case, the edge bcb′c is
i i	2	1	3 3
c ′c
forbidden, i.e., b3b3 /∈ E2.
Whenever a variable x occurs as positive (resp. negative) literal li in clause
c, then the edge axajx (resp. axajx) is equivalent to the edge bcbjc, by identifying
1 1	2 2	i i
ax = bc and ajx = bjc (resp. ax = bc and ajx = bjc), i ∈ {1, 2, 3} (resp. i ∈ {1, 2} in
1	i	1	i	2	i	2	i
case of a two-sized clause).

This concludes the construction of the particular instance (G1, G2) of H-free graph sandwich problem.
We claim that this construction gives sufficient conditions to analyze the NP- completeness of H-free graph sandwich problems by studying some properties of graph H and of the structure of problem k-girth lcnf 2-3-sat.
Theorem 3.1 Let H be a graph, containing a matching of size 2 and an anti- matching of size 3. If the particular instance (G1, G2) constructed above admits an H-free sandwich graph G, then there exists a truth assignment that satisﬁes instance (X, C) for the k-girth lcnf 2-3-sat.
Proof: Suppose G is an H-free sandwich graph. So, every Hc clause subgraph of G1 is destroyed by using at least one optional edge of set B. However, no Hx variable subgraph is created by adding both edges of A.
We now define the truth assignment for (X, C): if an edge of B belongs to G\G1 then set the truth value of the corresponding literal to true. Suppose that two edges are corresponding to the positive and negative literals of the same variable x. This generates an H induced subgraph in G, corresponding to the Hx variable subgraph for x, a contradiction.	2
The converse theorem is not so straightforward and it requires a deeper study of the structure of the graph H and of the bipartite graph of clauses and variables B(I).
Every rule we use in order to construct a sandwich graph from a truth assign- ment of k-girth lcnf 2-3-sat needs to ensure that no side-effect H subgraph is generated.
It is quite easy to give a rule that destroys all Hc clause subgraphs of G1 without creating an Hx variable subgraph of G2.
Our attempt consists in giving a simple rule (every optional edge corresponding to a true literal is added to G1 to form a sandwich graph G), and then search for a side-effect H sandwich subgraph. We remark that every vertex of the constructed instance (G1, G2) belongs to an Hc clause subgraph or to an Hx variable subgraph, and possibly to both an Hc clause subgraph and an Hx variable subgraph. Although a vertex may belong to at most one Hx variable subgraph, possibly a vertex may belong to several Hc clause subgraphs. A side-effect H is an induced subgraph isomorphic to H of some sandwich graph G, such that H is neither associated to an Hc clause subgraph nor to an Hx variable subgraph.
In the special structure of the forbidden graph H, in order to have the converse theorem, we require further the forbidden graph H to be 3-connected.
Theorem 3.2 Let H be a 3-connected graph, containing a matching of size 2 and an anti-matching of size 3. If there exists a truth assignment that satisﬁes instance
(X, C) of the k-girth lcnf 2-3-sat, then the particular instance (G1, G2) con-
structed above admits an H-free sandwich graph G.
Proof: Let H be a 3-connected graph, containing a matching of size 2 and an anti-matching of size 3, and let l be the size of the largest chordless cycle of H. Let



Fig. 2. The removal of vertices ax and a′x disconnects H, a contradiction.
i	i
parameter k = 2l.
Suppose there exists a truth assignment that satisfies instance I = (X, C) of
the k-girth lcnf 2-3-sat, and consider the simple rule that adds to G1 every
optional edge corresponding to a true literal in order to define a sandwich graph G. Since the simple rule destroys all Hc clause subgraphs of G1 without creating an Hx variable subgraph of G2, it remains to prove that the sandwich graph G contains no side-effect induced subgraph H, associated to neither an Hc clause subgraph nor to an Hx variable subgraph. Assume to get a contradiction that G contains such a side-effect induced subgraph H. By construction, there exists a variable x such that the side-effect subgraph H must contain at least one among the two vertices
ax and ajx, endvertices of the optional edge axajx. The two vertices ax and ajx are
i	i	i  i	i	i
the only connection between an Hc clause subgraph and an Hx variable subgraph,
or between two clause subgraphs Hcj and Hcj′ , by the linear property. Note that the optional edge axajx belongs to a unique variable subgraph Hx. Note further
i  i

that the optional edge axajx
must be associated to at least one clause subgraph

i  i
Hc. Suppose first that the removal of the two vertices ax and ajx disconnects the
i	i
side-effect induced subgraph H, this gives a contradiction since H is a 3-connected
graph (see Figure 2).
Hence, the side-effect subgraph H must contain a chordless cycle S that contains at least one of ax or ajx (see Figure 3). Note that the size of S is less than or equal
i	i
to the size of the largest chordless cycle of H, that is, |S|≤ l. Since the removal of
the two vertices ax and ajx does not disconnect the side-effect induced subgraph H,
i	i
cycle S has vertices of at least two different variable subgraphs. We claim that the
induced subgraph in B(I) constructed from S by taking the corresponding vertices of variable and clause subgraphs of S, has a cycle RI . Otherwise, this subgraph is a tree in B(I) and there exists a variable vertex xi with two adjacent clause vertices cj and cj′ , such that vertices of the corresponding Hcj and Hcj′ in S would be disconnected by the removal of the two vertices ax and ajx, again a contradiction.
i	i
We observe that the cycle RI has size at most 2l because, in the worst case, every
edge of S is incident to two different variable subgraphs.
In this case, RI has l vertices corresponding to Hx variable subgraphs and l vertices corresponding to Hc clause subgraphs. This contradicts the fact that, by definition, the girth of B(I) is greater than 2l, which concludes the proof.	2



Fig. 3. An example of a cycle S of H. Note the possible shared vertex by two clause subgraphs.

We present next two applications by considering two particular graphs H. De- note by Kp the complete graph on p vertices, denote by 3K2 the graph consisting of an induced matching with three edges, and call p-wheel a graph consisting of a chordless cycle on p vertices and an additional vertex u adjacent to all p vertices on the cycle. Denote by E[3K2] the edge-set of the 3K2 graph.
Corollary 3.3 If H is Kp \ E[3K2], for p ≥ 6, then the H-free graph sandwich problem is NP-complete.
Proof: Any two non incident edges of Kp \ E[3K2] is a matching of size 2. The missing 3K2 is an anti-matching of size 3. Finally, Kp \ E[3K2] is 3-connected. Thus, Theorems 3.1 and 3.2 can be applied.	2
Corollary 3.4 If H is p-wheel, for p ≥ 6, then H-free graph sandwich problem is NP-complete.
Proof: Any two non incident edges of the p-cycle of a p-wheel is a matching of size 2. Any induced p-cycle, p ≥ 6, contains an anti-matching of size 3. Finally, a p-wheel, p ≥ 6, is 3-connected. Thus, Theorems 3.1 and 3.2 can be applied.   2

4	Concluding remarks
In the present work, we provide a new variant of SAT called k-girth lcnf 2-3- sat, which yields the classification of the graph sandwich problem for H-free graph classes such that the forbidden graph H is 3-connected, H contains an anti-matching (i.e. H contains a matching) of size 3 and H contains a matching of size 2.
In particular, we prove that, when H is Kp \ E[3K2] ora p-wheel, for p ≥ 6, the
H-free graph sandwich problem is NP-complete.
Furthermore, our results establish an interesting dichotomy: for every fixed p ≥ 6, the (Kp \ e)-free graph sandwich problem is in P [2], whereas both the (Kp \ E[3K2])-free graph sandwich problem (from Corollary 3.3) and the (Kp \ E[2K2])-free graph sandwich problem are NP-complete. The NP-completeness of the (Kp \ E[2K2])-free graph sandwich problem is implied by the NP-completeness of the C4-free graph sandwich problem [2].

The strategy used to prove these results provides a tool to classify as NP- complete the graph sandwich problem for several families of graphs defined by forbidden induced subgraphs. For instance, we remark that K6 \ E[3K2] is iso- morphic to the power of cycle C2, and that the H-free graph sandwich problem is NP-complete when H is the power of cycle Cp, for n ≥ 6 and p < [n/2♩.

References
F. Couto, L. Faria, S. Gravier, S. Klein. On the forbidden induced subgraph probe and sandwich problems. Discrete Appl. Math., 234 (2018) 56–66.
S. Dantas, C.M.H. de Figueiredo, M.V.G. da Silva, R.B. Teixeira. On the forbidden induced subgraph sandwich problem. Discrete Appl. Math., 159 (2011) 1717–1725.
S. Dantas, C.M.H. de Figueiredo, F. Maffray, R.B. Teixeira. The complexity of forbidden subgraph sandwich problems and the skew partition sandwich problem. Discrete Appl. Math., 182 (2015) 15–24.
M.C. Dourado, P. Petito, R.B. Teixeira, C.M.H. de Figueiredo. Helly property, clique graphs, complementary graph classes, and sandwich problems. J. Braz. Comput. Soc., 14 (2008) 45–52.
C.M.H. de Figueiredo, S. Spirkl. Sandwich and probe problems for excluding paths. Discrete Appl. Math., 251 (2018) 146–154.
M.C. Golumbic, R. Shamir. Complexity and algorithms for reasoning about time: a graph-theoretic approach. J. Assoc. Comp. Mach., 40 (1993) 1108–1133.
M.C. Golumbic, H. Kaplan, R. Shamir. On the complexity of DNA physical mapping. Adv. Appl. Math., 15 (1994) 251–261.
M.C. Golumbic, H. Kaplan, R. Shamir. Graph sandwich problems. J. Algorithms, 19 (1995) 449–473.
S. Porschen, E. Speckenmeyer, X. Zhao. Linear CNF formulas and satisfiability. Discrete Appl. Math., 157 (2009) 1046–1068.
