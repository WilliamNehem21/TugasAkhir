

Electronic Notes in Theoretical Computer Science 225 (2009) 245–253
www.elsevier.com/locate/entcs

A Simple Criterion for Nodal 3-connectivity in Planar Graphs


Colm O´
Du´nlaing1 ,2

Mathematics, Trinity College, Dublin 2, Ireland

Abstract
This paper gives a simple characterisation of nodally 3-connected planar graphs, which have the property that barycentric mappings, and more generally convex combination mappings, are embeddings. This has applications in numerical analysis (grid generation), and in computer graphics (image morphing, surface triangulations, texture mapping): see [2,11].
Keywords: Nodally 3-connected, planar graph.


1	The Main Result
This paper presents a slightly condensed version of material given in the preprint [7], which contains full definitions and proofs.
We follow the usual definitions of graphs, including paths, simple paths, cycles, simple cycles, and connectivity: [4] is a useful source on the subject. The accepted definition of graph does not allow self-loops nor multiple edges nor infinite sets of vertices, so it is a finite simple graph in Tutte’s language [10], and a graph G can be specified as a pair (V, E) giving its vertices and edges.
§1.1 Convention: cyclic successor and predecessor. Wherever a cyclically ordered list x1,... , xn is given, xi+1 means the successor of xi in cyclic order, i.e., x1+(i mod n); similarly for xi−1.
A Jordan curve is a curve in R2 which is homeomorphic to the circle S1.
Proposition 1.2 (Jordan Curve Theorem) [5]. If C is a Jordan curve, then
R2\C has two path-connected components X, Y , X bounded, Y unbounded, with
∂X = ∂Y = C (∂X is the boundary of X).	 

1 These results were presented at the fourth Irish MFCSIT conference, Cork, Ireland, August 2006.
2 Email:odunlain@maths.tcd.ie

1571-0661/© 2008 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2008.12.078

4	3	4	3
1	2	1	2
Fig. 1. A graph with different plane embeddings. Also, the barycentric map is not an embedding.
We follow the usual definition [4] of a plane embedding of a graph and a planar graph, meaning one which admits a plane embedding, but usually we shall speak of a planar graph with a specific plane embedding in mind. A very significant difference is that a plane embedded graph has a definite external face, whereas there is no notion of external face, nor perhaps even of face, in a planar graph without a prescribed embedding. Figure 1 shows a planar graph with two quite different embeddings.
Lemma 1.3 A plane embedded graph G is connected as a graph if and only if for every face F, the boundary ∂F, which is a subgraph of G, is (path-)connected.	 
A straight-edge embedding is a plane embedding in which the edges are mapped to straight line-segments.
Proposition 1.4 Every planar graph admits a straight-edge embedding [1,6,8]. 
Proposition 1.5 (Euler’s Formula) [5]. If G is a plane (straight-edge) embedded graph then
v − e + f = c + 1,
where v, e, f, and c are the numbers of vertices, edges, faces, and components of
G.	 
Definition 1.6 Given G = (V, E) and S ⊆ V ,
G\S = (V \S, {{u, v} ∈ E : u, v ∈/ S})
Lemma 1.7 Let G be a straight-edge embedded plane graph in which all face bound- aries are simple cycles, and let u be any vertex of G.
Let x1,... , xk be a list of neighbours of u consecutive in anticlockwise order. For 1 ≤ j ≤ k − 1 let Fj be the face occurring between the edges (line-segments) uxj and uxj+1 in the anticlockwise sense. (The faces Fj are not necessarily distinct.)
Let B be the subgraph formed by the edges and vertices in   ∂Fj.
Then any two vertices in the list xj are joined by a path in B\{u}. See Figure
2.

Proof. B\{u} is also the subgraph consisting of all vertices and edges in j (∂Fj\{u}). Since each face is a simple cycle, ∂Fj\{u} is a path joining xj to xj+1. Thus B\{u} contains paths joining all these vertices xj.	 







B


x1
Fig. 2. Neighbours of u connected by paths avoiding u.
Lemma 1.8 A plane straight-edge embedded graph G is biconnected if and only if the graph consists of a single vertex or a single edge, or the boundary of every face is a simple cycle.
Proof. (Sketch) (i): If. A single vertex or edge is biconnected, so we assume that the boundary of every face is a simple cycle. G is connected (Lemma 1.3).
For any vertex x and all neighbours xj of x there exist paths connecting these neighbours which avoid x (Lemma 1.7). Therefore all these neighbours are in the same component of G\x, and it follows that G\x is connected. Hence G is bicon- nected.
(ii): Only if. Suppose that G is connected, not a single vertex or edge, and there exists a face F whose boundary is not a simple cycle (graph): ∂F is connected but contains a node x whose degree (in ∂F , not in G) differs from 2. If ∂F contained a vertex of degree 0 then (since G is nontrivial) G would be disconnected. If it contained a vertex of degree 1, then G would be disconnected or not biconnected. Hence we can assume that all vertices on ∂F have degree ≥ 2 in ∂F .
Let u ∈ ∂F be a vertex of degree ≥ 3 in ∂F . Let x1,... , xk be the vertices adjacent to u in anticlockwise order. For 1 ≤ j ≤ k, xjuxj+1 (xk+1 = x1) forms a clockwise part of the boundary of a face incident to u. Since u has degree ≥ 3 in
∂F , at least two of these paths are incident to F and there are fewer than k distinct faces incident to u.
Let G' = G\{u}. All faces incident to u in G merge into a single face of G', and the other faces of G are preserved. The Euler formula gives
v − e + f =2 for G, since G is connected. Correspondingly for G',
v' − e' + f ' =1 + c'.
Now v' = v − 1, and e' = e − k. Since in G' fewer than k faces are merged into a single face, f ' > f +1 − k. Therefore
v' − e' + f ' > v − 1 − e + k + f +1 − k = 2,
so c' > 1, G' is disconnected, and G is not biconnected.	 


	


Fig. 3. Delaunay triangulation of 20 points and barycentric embedding of the same graph with the same bounding polygon.
A triangulated planar graph is a plane embedded graph in which every bounded face is incident to three edges.
Given a plane embedded graph G, whose external boundary is a simple cycle, a barycentric map of G is one which takes the bounding vertices to the corners of a convex polygon, such that every internal vertex is mapped to the average of its neighbours. More generally, if one replaces ‘average’ by ‘proper weighted average,’ one has a convex combination map. Figure 3 shows a Delaunay triangulation with 20 vertices, and a barycentric embedding of the same graph.
Nodally 3-connected planar graphs (Definition 1.9 below), are interesting be- cause every barycentric map (Tutte, [10]) and more generally every convex combi- nation map (Floater, [3]), is an embedding.
It is easy to give a counterexample when G is not nodally 3-connected. For example, in Figure 1, any barycentric map must map the inner square face to a line-segment. The figure illustrates different plane embeddings of the same graph, which is not nodally 3-connected.
Definition 1.9 A graph G is nodally 3-connected if it is biconnected and for every two proper subgraphs H and K of G, if G = H ∪ K and H ∩ K consists of just two vertices (and no edges), then H or K is a simple path.
Proposition 1.10 Every triconnected graph is nodally 3-connected; every nodally 3-connected graph with no vertices of degree 2 is triconnected. (Proof omitted.) 
§1.11 Witnesses for a non-nodally 3-connected graph. Suppose G is not nodally 3-connected. We say that H, K, u, v are witnesses if G = H ∪ K, H ∩ K contains just two vertices u, v and no edge, neither H nor K are path graphs, and neither H nor K equals G.
Lemma 1.12 (i) Given witnesses H, K, u, v, if L is a path in G connecting H\K
to K\H, then L contains three consecutive vertices r, s, t where {r, s} ∈ H, and
{s, t}∈ K, r ∈ H\K, t ∈ K\H, and s ∈ H ∩ K, so s = u or s = v.
(ii) Any path (respectively, cycle) which avoids u and v except perhaps at its endpoints (respectively, perhaps once), is entirely in H or in K.
Proof. (i) The first vertex in L is in H\K, so the first edge is in H. Similarly the

last edge is in K. Therefore there exist three consecutive vertices r, s, t on the path where {r, s} ∈ H and {s, t} ∈ K. Then s ∈ H ∩ K, so s = u or s = v and s is incident to edges from H and from K.
(ii) Now let P be a path which avoids u and v except perhaps at its endpoints. This includes the possibility of a cycle, viewed as a path which begins and ends at the same vertex w: we allow w, but no other vertex on the cycle, to equal u or v.
If the path is not entirely in H nor in K, then it contains a triple r, s, t where
s = u or s = v, a contradiction.	 
The main result of this section is Theorem 1.14, whose proof is long. To shorten it, we prove
Lemma 1.13 Let G be a plane embedded graph in which all face boundaries are simple cycles. Then (i) either G is a simple cycle with two faces, or
for no two faces F, F ' is ∂F ∩ ∂F ' a simple cycle, and if there are 3 faces
F1, F2, F3 such that
Q1 = ∂F1 ∩ ∂F2, Q2 = ∂F2 ∩ ∂F3,	and	Q3 = ∂F3 ∩ ∂F1
are all nonempty and connected, therefore simple paths, and they all join the same two vertices u and v, then there are exactly three faces, and G consists of two nodes connected by three paths.
Proof. Since all face boundaries are simple cycles, G is biconnected, hence con- nected.
Suppose ∂F ∩∂F ' = ∂F, that is, ∂F ∩∂F ' is a Jordan curve J . By Proposition 1.2, F is the inside of J and F ' the outside or vice-versa, so G is a simple cycle with two faces.
W.l.o.g. F1 and F2 are bounded. Their intersection Q1 is a simple path, which means that X = F1 ∪ F2 is simply connected, and ∂X = ∂F1 ∪ ∂F2\interior(Q1).
The only faces meeting the relative interior of Q1 (respectively, Q3) are F1 and F2 (respectively, F3 and F1), so Q1 /= Q3. These are different paths joining u to v on ∂F1, so ∂F1 = Q1 ∪ Q3. Again, ∂F2 = Q1 ∪ Q2, Thus ∂X = Q2 ∪ Q3 = ∂F3.
F3 is either the inside or outside of ∂F3 (Proposition 1.2), but F1 ∪ F2 is inside, so F3 is the outside, the unbounded face. Thus there are three faces and G is the union of three paths Q1 ∪ Q2 ∪ Q3 with two nodes in common.	 
Theorem 1.14 A plane (straight-edge) embedded graph is nodally 3-connected iff it is biconnected and the intersection of any two face boundaries is connected.
Proof. We can assume G is biconnected, since that is required for nodal 3-connectivity. Since G is biconnected either it is empty or trivial, or a single edge, or every face is bounded by a simple cycle. In the first three cases the graph is obviously nodally
3-connected and biconnected with one face, so we need only consider the fourth case and can assume that every face is bounded by a simple cycle.
We can assume that G is straight-edge embedded. Therefore the boundary of every face is a simple polygon.

Only if: Suppose F1 and F2 are different faces and ∂F1 ∩ ∂F2 is disconnected.
R.T.P. G is not nodally 3-connected.
Let u and v be vertices in different components of ∂F1 ∩ ∂F2. For i = 1, 2 there are two paths Pi and Qi joining u to v in ∂Fi. These paths are polygonal.
One can also construct a path P ' within F1, loosely speaking by displacing P1 slightly into F1, and connecting its endpoints to u and v. The resulting path is in F1 except at its endpoints. Similarly one can construct a path P ' in F2 except at its endpoints. These paths together form a (polygonal) Jordan curve J which meets G only at u and v. By construction, P1 ∪ P2 is inside J and Q1 ∪ Q2 is outside J .
Let H (respectively, K) be the subgraph consisting of all vertices and edges of G which lie inside or on J (respectively, outside or on J ). The only vertices in H ∩ K are u and v, and H ∩ K contains no edge. H contains P1 ∪ P2 and therefore is not a path graph, since otherwise P1 = P2 and u and v would be in the same component of
∂F1 ∩∂F2. Similarly K is not a path graph. Therefore G is not nodally 3-connected.
If: Suppose G is biconnected but not nodally 3-connected, and H, K, u, v are witnesses. G has more than one face, so all face boundaries are simple cycles.
Claim 1. The subgraphs H\K and K\H are nonempty. If every vertex in K were also in H, then the vertices in K are in H ∩ K, that is, u and v. Either K has no edges, in which case H = G, or it has the edge {u, v} and is a path graph. Neither is possible. Therefore H\K and similarly K\H are nonempty.
Claim 2. Neither u nor v are isolated vertices in H nor in K.
Otherwise suppose u is isolated in K. Let L be any path joining H\K to K\H. By Lemma 1.12, every path connecting H\K to K\H contains a vertex, u or v, incident to edges from H and from K. By hypothesis, u is not; so every such path contains v. By Claim 1, at least one such path exists, so G\v is not connected, and G is not biconnected.
Claim 3. Both u and v have neighbours both in H\K and in K\H. Suppose all neighbours of u are in H. Since u is not isolated in K, there is an edge {u, t} in K incident to u. But t is a neighbour of u, therefore t ∈ H ∩ K, so t = v. The only edge in K incident to u is {u, v}.
Consider a path in G joining H\K to K\H. Let t be the first vertex where the path meets K\H, and let s be the vertex before t on the path. Since {s, t} ∈ K and s ∈/ K\H, s ∈ H ∩ K: s = u or s = v. However, if s = u, then, since t ∈ K, t = v and t ∈/ K\H. Therefore s = v. This implies that every path from H\K to K\H contains v. Again by Claim 1, such paths exist, so G is not biconnected.
This contradiction shows that not all neighbours of u are in H; neither are they in K, and the same goes for v.
Claim 4. The vertices u and v share a face in common. Otherwise let x1,... , xk be the neighbours of u. We know (Lemma 1.7) that they are all connected by paths in B\u, where B is the union of boundaries of bounded faces incident to u. Assuming v is incident to none of these faces, these paths would also avoid v. This implies that all neighbours of u are in H or in K, contradicting Claim 3.
Claim 5. The vertices u and v have at least two faces in common. Let F1,... 

be the faces incident to u in anticlockwise order around u. At least one of these faces, w.l.o.g. F1, is incident to u and to v. Suppose no other face is.
There are two cases. If u or v, w.l.o.g. u, is an internal vertex, then all faces

incident to u are bounded, and by Lemma 1.7, the subgraph 

i≥2
(∂Fi\u) would

be connected and contain neither u nor v. Then all vertices in this subgraph would
belong to H or to K. Since it includes all neighbours of u in G, it would contradict Claim 3.
If both u and v are external vertices, then F is the external face, and all bounded faces incident to u avoid v. Again we consider the subgraph  i≥2(∂Fi\u). Again this is a connected subgraph containing all neighbours of u in G, and again it omits
both u and v, so again all vertices in it are in H or in K, and again Claim 3 is contradicted.
Therefore u and v have at least two faces F and F ' in common.
Claim 6. If u and v are incident to three faces F1, F2, and F3, then the boundaries of at least two of these faces have disconnected intersection. Otherwise, by Lemma 1.13, G consists of two nodes u, v connected by three paths. If G = H ∪K where H ∩ K = {u, v} then H or K is a path graph: G is nodally 3-connected.
This contradiction shows that the one of the pairs ∂Fi ∩ ∂Fj is disconnected, as claimed.
Claim 7. If there are exactly two faces F and F ' incident to u and to v, then
∂F ∩ ∂F ' is disconnected.
Otherwise ∂F ∩ ∂F ' is a path Q' joining a vertex u' to another vertex v' and containing a subpath Q joining u to v. Not all of u', u, v, v' need be distinct, but it is assumed that they occur in that order in Q'.
By Lemma 1.12, all vertices in Q belong to H or to K: w.l.o.g. to H. The boundary cycles ∂F and ∂F ' include two other paths, Q1 and Q2, respectively, joining u' to v'. Let J = Q1 ∪ Q2, a Jordan curve.
If u' /= u then J meets H ∩ K at v alone, or not at all, and by Lemma 1.12, all vertices on J , plus those in Q'\Q, belong to H or to K.
If all vertices on J belong to H, then all vertices outside J also belong to H, because for any vertex y outside J , one can choose a shortest path joining y to a vertex in J . Neither u nor v occur as internal vertices on this path, so all vertices on the path are in H or K (Lemma 1.12), i.e., H, since the last vertex is in H.
We have counted all vertices in G: those outside J , those on J , and those on
Q', and all are in H, so H = G, which is false.
On the other hand, if all vertices on J , and in Q'\Q, belong to K, then all vertices outside J belong to K, and H = Q is a path graph, which is false. This proves Claim 7 in the case u /= u', and by symmetry in the case v /= v'.
If u = u' and v = v' then Q = Q': let Q1 and Q2 be the other subpaths joining u to v in ∂F and ∂F ' respectively. By Lemma 1.12, each subpath Qi is contained in H or in K. Again we have a Jordan curve J = Q1 ∪ Q2.
If u and v are not both external vertices, w.l.o.g. u is an internal vertex, then
F and F ' are bounded faces incident to u, and since ∂F ∩ ∂F ' = Q, they are



Fig. 4. A nodally 3-connected but not triconnected triangulated planar graph
consecutive in cyclic order. Let u1 (respectively, u2) be the second vertex (following u) in Q1 (respectively, Q2). The only faces incident to u and to v are F and F ', so u1 and u2 differ from v and u1 and u2 are connected by a path which avoids u and v (Lemma 1.7). Therefore, by Lemma 1.12, u1 and u2 are both in H or in K, and so are all vertices on J . The same goes for all vertices outside J , so either H = G or H = Q is a path graph, a contradiction.
This leaves the case where u and v are external vertices with exactly two faces in common, F and F ', whose boundaries have connected intersection. Since u and v are external vertices, one of these faces, F ', say, is the external face. Since G is not nodally 3-connected, it is not a simple cycle, and Q = ∂F ∩ ∂F ' is a simple path joining u to v (Lemma 1.13). Let Q1 and Q2 be the other paths joining u to v on
∂F (respectively, ∂F '). ∂F ' = Q ∪ Q2 is the external cycle, a Jordan curve, and Q1 separates its interior into two regions of which F is one. Let J = Q1 ∪ Q2. It is a Jordan curve surrounding the other region.
Let ui, i = 1, 2, be the second vertices on Qi. Again there is a path joining u1 to u2 which avoids u and v, and all vertices on J are in H or K, and the same holds for all vertices inside J . If they are all in H then H = G, and if they are all in K then H = Q, a simple path. This contradiction finishes the proof of Claim 7.
Claims 6 and 7 taken together amount to the desired result.	 
§1.15  Chord-free triangulated graphs. A triangulated plane embedded graph is one in which every bounded face is bounded by three edges. In a triangulated biconnected graph the external boundary is a simple cycle. It can only fail to be nodally 3-connected if a bounded face meets the external boundary in a disconnected set. Equivalently, one of its edges is a chord joining two vertices on the external boundary, and the other two edges are not both on the external boundary [11]. A fully triangulated graph is one in which the external boundary also has three edges, so it is chord-free, therefore nodally 3-connected. By Proposition 1.10, every fully triangulated graph is triconnected; not so every triangulated graph (Figure 4).

References
H. De Fraysseix, J. Pach, and R. Pollack (1990). How to draw a planar graph on a grid. Combinatorica
10:1, 41–51.
Michael S. Floater (2002). Convex combination maps. In Algorithms for Approximation IV, 18–23, J. Levesley, I.J. Anderson, and J.C. Mason (eds), University of Huddersfield.
Michael S. Floater (2003). One-to-one piecewise linear mappings over triangulations. Math. Comp. 72, 685-696.


Goos Kant (1993). Algorithms for drawing planar graphs. Ph.D. Dissertation, Computer Science Department, University of Utrecht.
E.E. Moise (1977). Geometric topology in dimensions 2 and 3. Springer Graduate Texts in Mathematics 47.
Colm O´ Du´nlaing (1994). A simple linear-time planar layout algorithm with a LEDA implementation. Report ALCOM-II-429, also published as report TCDMATH 98–06.

Colm O´
Du´nlaing (2006). Nodally 3-connected planar graphs and convex combination maps.

TCDMATH 06–16, arXiv:0708.0964.
Ronald C. Read (1987). A new method for drawing a planar graph given the cyclic order of the edges at each vertex. Congressus Numerantii 56, 31–44.
W.T. Tutte (1960). Convex representations of graphs. Proc. London Math. Soc. (3) 10, 304–320.
W.T. Tutte (1963). How to draw a graph. Proc. London Math. Soc. (3) 13, 743–768.
Geoffrey White (2004). Mesh parametrization for texture mapping. Undergraduate computer science project, Oxford University.
