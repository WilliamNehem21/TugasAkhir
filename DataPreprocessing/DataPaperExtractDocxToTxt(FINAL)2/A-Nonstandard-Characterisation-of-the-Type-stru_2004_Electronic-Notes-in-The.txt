Electronic Notes in Theoretical Computer Science 73 (2004) 141–147 
www.elsevier.com/locate/entcs


A Nonstandard Characterisation of the Type-structure of Continuous Functionals Over the Reals
Dag Normann1
Department of Mathematics The University of Oslo Oslo, Norway

Abstract
We extend a hyperfinite discretisation of the real line to a typed structure of hyperfinite func- tionals, and we show that the hereditarily near-standard functionals correspond to the continuous functionals over the reals obtained from domain theory.
Keywords: continuous functional, nonstandard, hyperfinite, total


Introduction
If we view domain theory as the mathematical analysis of ordered sets of finitary information via completions and topology, an alternative tool sug- ests itself, the use of nonstandard analysis. One way of viewing nonstandard analysis is that we go beyond completion, each element of the completion is represented by several hyperﬁnitary objects sharing the algebraic properties of the finitary objects.
In nonstandard analysis one works with the interplay between two typed structures, the full type-structure {Tp(n, R)}n∈N and the extension
{Tp(n, R)∗}n∈N. The non-standard extension is elementary in the sense of

1 Email: dnormann@math.uio.no



1571-0661 © 2004 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2004.08.007


first order logic. This fact is called the transfer principle. The objects in the extended type-structure are called internal.
One way of constructing the non-standard extension goes via ultraproducts: Let Sn be the set of infinite sequences α¯ = {αn}n∈N of elements in Tp(n, R). Let F be a non-principal ultrafilter on N.
If α¯ and β¯ are elements of Sn, we let α¯ ≈ β¯ if {n | αn = βn} ∈ F .
This is an equivalence relation, and Tp(n, R)∗ is (up to isomorphism) the set of equivalence classes in Sn.
If α¯ ∈ Sn+1 and β¯ ∈ Sn, we let α¯(β¯) denote λn.αn(βn). This induces an
application operator from Tp(n + 1, R)∗ × Tp(n, R)∗ to R∗.
The ∗-map is an embedding of Tp(n, R) into Tp(n, R)∗ where x∗ is the equiv- alence class of λn.x, i.e. the constant sequence. This is an elementary em- bedding with respect to the many-sorted language for {Tp(n, R)}n∈N with application.
We will identify a set with its characteristic function. Thus we have nonstan- dard versions N∗ and Q∗ of e.g. N and Q resp. If x consists of finite objects, the elements of x∗ will be called hyperﬁnite. In domain theory, we often call an element ﬁnitary if the information about it can be given in a finite way. Nonstandard versions will be called hyperﬁnitary.
Let c0 be the equivalence class of λn.n. Then c0 ∈ N∗
Let c be the equivalence class of λn.n! Then we also have that c ∈ N∗. This is the number we will use in the construction.
Let

k
Xn = {
n!
| − (n!)2 < k < (n!)2}.

Then the equivalence class of {Xn}n∈N is an internal object that can be de- scribed as
{ k | − c2 < k < c2}. c
This set will be used in the construction.
Normally definitions and proofs are not based on a particular construction of the non-standard extension, but only from the assumption that {Tp(n, R)∗}n∈N is a proper elementary extension of {Tp(n, R)}n∈N.
One fact that we will use is that N is not internal, and thus not definable in the non-standard extension from internal objects. We see this by observing that N is a bounded subset of N∗, and by the transfer principle, each internal bounded subset of N∗ will have a maximal element. This is used in the proofs of Claims 2 and 3.
Example 1.1 Let (D, ±) be an algebraic, separable domain where {dn}n∈N
is the enumerated set of finitary (compact) elements.


Let (D∗, ±∗) be the non-standard version (we only need the hyperfinitary objects here).
Then each x ∈ D can be obtained as
H{dn | n ∈ N ∧ dn ±∗ d}
for some hyperfinitary d.
Proof. If d is hyperfinitary, we see that {dn | n ∈ N ∧ dn ±∗ d} is an ideal of finitary objects, so x ∈ D is well defined as its least upper bound.
If x ∈ D, and x is not itself finitary , let {mn}n∈N be such that {dmn }n∈N is a strictly increasing sequence of finitary objects with x as its least upper bound.
∗
Then ({dmn }n∈N) is of the form {dmn }n∈N∗ .
If we let c ∈ N∗ \ N, and let d = dm , x will satisfy the equation above. 

The Continuous Functionals Over the Reals
The main result of this note is a characterisation of one of the typestructures of total, continuous functionals over the reals. In [2], Bauer, Escardo´ and Simp- son discuss alternative constructions of such type-structures. One of them is based on the continuous domain of closed real intervals and the Cartesian closed category of continuous domains. It will be this type-structure that we will give an alternative characterisation of. The language RealPCF use this typestructure for its semantics, see Escard´o [4].
An alternative approach to this hierarchy is via algebraic domains with total- ity. The base domain will then be generated from the set of closed rational intervals. Normann [5,6] proved a density theorem for this hierarchy, and showed that it may be characterised in the Cartesian closed category of Ku- ratowski limit spaces.
Our starting point will be one of the standard hyperfinite representations of the real line, used e.g. in nonstandard analysis to replace differential equations by difference equations. Thus there is nothing ad hoc in the construction itself. From now on c will be a fixed element of N∗ \ N, e.g. the one constructed in Section 1. We will let the types be formal objects generated from 0 by →.
Definition 2.1 Let H0 = { k | − c2 < k < c2}. H0 is an internal set.
For a type σ → τ we let Hσ→τ consist of all internal maps from Hσ to Hτ .
Hσ→τ will be a hyperfinite, internal set.
We now define the hereditarily near-standard objects.
Definition 2.2 For each type σ we isolate a set Hns of near-standard objects together with an equivalence relation ≈σ on Hns as follows:

• Hns = { k | ∃n ∈ N(−nc < k < nc)}.
0	c
k1 ≈0 k2 ⇔ | k1 − k2 | is infinitesimal.
c	c	c	c
If f ∈ Hσ→τ , we let f ∈ Hns	if
f (x) ∈ Hns whenever x ∈ Hns
τ	σ
x ≈σ y ⇒ f (x) ≈τ f (y).
We let f ≈σ→τ g if x ≈σ y ⇒ f (x) ≈τ g(y) for all x, y ∈ Hns.
We observe that ≈σ will be an equivalence relation on Hns for all types σ.

Definition 2.3 For each x ∈ Hns we define the standard part st(x), and the set Tσ of standard parts, by induction:
For x ∈ Hns we use the usual standard part, st( k ) is the unique real infinites-
0	c
imally close to k . (The existence of st( k ) is a consequence of the completenes
c
of the real line.)
For f ∈ Hns	we define st(f ): Tσ → Tτ by st(f )(st(x)) = st(f (x)).
We observe that T0 = R. Thus this defines a type structure over the reals.

Definition 2.4 Let Dσ be the interpretation of the type σ as an algebraic domain, where D0 is the algebraic domain based on closed rational intervals.
Definition 2.5 For each type σ, let Cσ be the quotient space of the heredi- tarily total objects of type σ organised as a function-space in the natural way (with C0 = R).
The main result of this note is
Theorem 2.6 For each type σ, Cσ = Tσ.

Proof. Let Fσ be the set of finitary elements of Dσ, F ∗
the non-standard

extension and Fc the elements in F ∗ using only intervals [ k1 , k2 ] as base ele-
σ	σ	c	c
ments.
If p ∈ Fc and x ∈ Hσ we define the relation p ≺σ x by recursion on σ as
follows:
[ k1 , k2 ] ≺0 k if k1 ≤ k ≤ k2.
c	c	c
Here we use the standard notation for describing finitary (and hyperfini- tary) elements in Dσ→τ
{(p1, q1),... , (pk, qk)} ≺σ→τ f if qi ≺τ f (x) whenever pi ≺σ x.
Note that in 2., k may be hyperfinite, but {(p1, q1),... , (pk, qk)} will be an internal object.
Claim 1

If p ∈ Fc there is an f ∈ Hσ such that p ≺σ f .
Proof
We will use induction on the type.
For type 0, choose e.g. the left hand endpoint of the interval. Now consider

and x ∈ Hσ.
p = {(q1, r1),... , (qk, rk)}∈ Fc

Then {ri | qi ≺σ x} is a consistent set, and .{ri | qi ≺σ x} ∈ Fc. By the
.	τ

induction hypothesis there is a yx ∈ Hτ such that
f (x)= yx.
It is easy to verify that this f does the trick.
{ri | qi ≺σ x} ≺ yx. Let

In the proof of this claim, we are relying on the transfer principle. The argu- ment would have been unproblematic if c had been a genuine natural number. The transfer principle tells us that the argument then is unproblematic for hyperfinite c.
Each element of Hσ will determine an object in Dσ, the weak standard part, by
wst(f )= .{p ∈ Fσ | p ≺σ f }.
We will show that f ∈ Hns if and only if wst(f ) is total, and that two objects are equivalent if and only if their weak standard parts are consistent. Moreover we will show that each total object is consistent with the weak standard part of some f ∈ Hns.
From now on we will assume that the nonstandard number c has all standard numbers n as factors. This is not essential for the result, but simplifies the argument. We use this assumption to show:
Claim 2
If x ∈ Dσ, there is a y ∈ Fc such that x0 ±∗ y for all finitary x0 ± x.
σ	σ
We write x ±σ y when this is the case.
Proof
Let {xn}n∈N be an increasing sequence of finitary objects with x as the limit. Since all end-points in all rational intervals used to describe any element of xn have denominators that are factors in c, the same must be the case for a hyperfinitary xc' , and then xc' ∈ Fc, with the required property.
Claim 3 Let σ be any type.
Let f ∈ Hσ. Then f ∈ Hns if and only if wst(f ) is hereditarily total. Moreover, f ≈σ g if and only if wst(f ) and wst(g) are consistent.
If x ∈ Dσ is total, then there is an f ∈ Hns such that wst(f ) is consistent

with x.
Proof
We will only prove this claim for pure types. Using the Curry-isomorphism the proof will work for mixed types as well, but will require more unpleasant notation. We will use induction on the type.
For σ = 0, a) and b) are trivial. So assume that the claim holds for τ and consider the case σ = τ → 0.
: Let f ∈ Hns. Let x ∈ Dτ be total, {xn}n∈N an increasing sequence of finitary objects with x as the limit.
If d ∈ N∗ \ N and xd ≺∗ a ∈ Hτ , then, by the induction hypothesis, a ∈ Hns.
τ	τ
Moreover, if xd ≺∗ a1 and xd ≺∗ a2 then a1 ≈τ a2. It follows that f (a1) and
τ	τ
f (a2) are infinitesimally close to each other.
Now, let ϵ > 0 be standard. Then

{d ∈ N∗ | x
∈ Fc ∧ ∀a, b ∈ H (x
≺ d ∧ x
ϵ
≺ b ⇒ |f (a) − f (b)| <  )}

τ	τ	d	d	2
is internal, since it is definable from internal objects only. Since this set con- tains an initial segment of the nonstandard natural numbers, it must contain a standard number n.
But this means that {(xn, [p, q])} ≺σ f for some rational numbers p and q
with p − q < ϵ.
The consequence is that wst(f ) is total.
Using Claim 1 and the induction hypothesis, it is easy to prove the other part of a).
: Let x ∈ Dσ be total. By Claim 2 there is a y ∈ F c such that x ±σ y. By Claim 1 there is an f ∈ Hσ such that y ≺σ f . Let a ≈τ b. Then wst(a) and wst(b) are consistent, total objects, so x(wst(a)) = x(wst(b)). It follows that f (a) and f (b) are equivalent, so f ∈ Hns.
Claim 3 establishes the 1-1-correspondance between equivalence classes in Hns and equivalence classes of hereditarily total objects. Clearly this correspon- dance commutes with application, and the theorem is proved.	 

Discussion
The motivation for considering this example was to look at a natural con- struction of a type structure over the reals, based on methods from outside domain theory, and to see if the result would correspond to one of the standard constuctions. The question now is if this use of nonstandard analysis gives insight to effectivity in a way expressible in domain theory. The strength of nonstandard analysis is mainly that it opens for the use of constructions that


are alternatives to constructions in analysis, not representatives of them. Ex- amples are nonstandard approaches to distributions and stochastic processes, see Albeverio, Fenstad, Høegh-Krohn and Lindstrøm [1]. The analysis of these constructions often leads to internal algorithms of a simple kind, but effectiv- ity is lost when we go to the standard parts.
One example is the solving of differential equations.
Let F : R × R → [−1, 1] be continuous. Then we may solve the differential equation with initial value
y' = F (x, y) ,  y(0) = 0
by replacing F by a representative G and solving the difference equations
k +1	k	1	k	k


Then
YG(0) = 0 ,  YG(
c	)= YG( c )+ c G( c , YG( c )).

k	k
y(st( c )) = st(YG( c ))
is well defined and solves the equation. However, the map Φ(G) = YG is not near standard, and there is no way to select a solution to the equation in a continuous way. In fact, Birkeland and Normann [3] essentially showed that by choosing an appropriate representative G for F , all solutions of the equation can be obtained as the standard part of some YG. It is not clear how this relates to domain theory, but one may for instance now ask the question: Will the set of solutions be represented as an effective element of some power domain over R → R, and can this be extracted from the nonstandard approach?

References
Albeverio,S., J. E. Fenstad, R. Høegh-Krohn, and T. Lindstrøm, “Nonstandard methods in stochastic analysis and mathematical physics”, Academic Press, 1986
Bauer,A., M. H. Escard´o and A. Simpson, Comparing functional paradigms for exact real- number computation, Lecture Notes in Computer Science 2380 (ICALP), pp. 488–500, 2002.
Birkeland, B. and D. Normann, A non-standard treatment of the equation y' = f (y, t), Preprint Series in Mathematics, Oslo 1980 - 17.
Escard´o, M.H., PCF extended with real numbers, Theoretical Computer Science, 210:121-157, 1999
Normann, D., The continuous functionals of ﬁnite types over the reals, Electronic Notes in Theoretical	Computer	Science	35	(2000),	URL: http://www.elsevier.nl/locate/entcs/volume35.html .
Normann, D.,The continuous functionals of ﬁnite types over the reals, in K. Keimel, G.Q. Zhang, Y. Liu and Y. Chen (eds.) “Domains and Processes”, 103 - 124, Kluwer Academic Publishers, 2001
