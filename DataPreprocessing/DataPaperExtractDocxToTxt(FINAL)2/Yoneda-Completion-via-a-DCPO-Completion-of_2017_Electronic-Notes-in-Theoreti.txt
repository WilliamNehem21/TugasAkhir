Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 333 (2017) 103–121
www.elsevier.com/locate/entcs

Yoneda Completion via a DCPO Completion of its Poset of Formal Balls
Kok Min Ng1,2 Weng Kin Ho3
National Institute of Education Nanyang Technological University Singapore

Abstract
In this paper, we demonstrate how an idempotent Yoneda completion of quasi-metric spaces can be obtained using the Kostanek-Waszkiewicz Theorem and the dcpo completion of their posets of formal balls. This fills a gap in the current literature concerning the lack of an idempotent Yoneda completion.
Keywords: Yoneda completion, Yoneda completion quasi-metric space, quasi-metric space, dcpo completion, poset of formal balls, Scott topology, d-topology, g-topology, Yoneda topology

1	Introduction
Quasi-metric space (respectively, Yoneda complete quasi-metric space) unifies the concepts of metric space (respectively, complete metric space) and partially ordered set (respectively, directed complete poset). Analogous to the classical completion of metric spaces and dcpo completion of posets, several approaches to obtain such a completion have been proposed; for instance, [3,13,20]. In the study of quasi- metric spaces, both the notions of Smyth completeness and Yoneda completeness are fundamental. Thus, it is far from satisfying that while there exists an idempotent Smyth completion to every quasi-metric space ([19]),
“the fact remains that the Yoneda completion [for quasi-metric spaces proposed so far] is not idempotent in general.” ([13, p. 193])
This paper answers the above open problem in the positive in that we show the explicit construction of an idempotent Yoneda completion of quasi-metric spaces in

1 This author is supported by the Nanyang President Graduate Scholarship awarded by Nanyang Techno- logical University, Singapore.
2 Email: ngkokmin@gmail.com
3 Email: wengkin.ho@nie.edu.sg

https://doi.org/10.1016/j.entcs.2017.08.009
1571-0661/© 2017 The Author(s). Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

104	K.M. Ng, W.K. Ho / Electronic Notes in Theoretical Computer Science 333 (2017) 103–121
general. Furthermore, we prove that the category of Yoneda complete quasi-metric spaces is a reflective full subcategory of that of quasi-metric spaces.
Actually the situation here is similar to a familiar domain-theoretic setting. Usu- ally, the dcpo-completion of a poset P is taken to be the ideal completion Id(P ) consisting of all the ideals of P , but it is well-known that the ideal completion is not idempotent ([5,15]). This is not a mere analogy – there is an explicit passage be- tween Yoneda completeness and directed completeness: the Kostanek-Waszkiewicz Theorem states that a quasi-metric space is Yoneda complete if and only if its poset of formal balls is directed complete. Part of the reasons why earlier versions of Yoneda completions ([3,13,20]) fail to be idempotent can be attributed, directly or indirectly, to the lack of idempotence of ideal completions in the general setting.
Though ideal completion is not idempotent in general, there is a notion of dcpo completion which is. Recently [23] gives an explicit construction for an idempotent dcpo completion of posets, and this gives us hope in that, via the passage created by the Kostanek-Waszkiewicz Theorem, we might well be able to perform an idem- potent Yoneda completion of a quasi-metric space by appealing to the idempotent dcpo completion of its corresponding poset of formal balls. However, this approach is not as straightforward as we discovered because there is a fundamental problem that plagues the poset of formal balls: there is a inherent mismatch between the convergence behaviour of directed sets and that of Cauchy nets. More precisely, given a quasi-metric space (X, d), a directed family (xi, ri)i∈I in the poset of for- mal balls may have supremum (x, r) but (xi)i∈I may not have d-limit as x. In this paper, we show how, by restricting our attention to a certain subcollection of directed families (called translational complete directed families), this problem can be circumvented to yield the desired idempotent Yoneda completion.
This paper is organised as follows. We introduce the preliminaries in Section 2. In Section 3, we describe the aforementioned problem we need to overcome and bring in the necessary machinery which will help us attain the desired construction. Throughout this paper, we assume that the reader has basic knowledge in quasi- metric spaces, domain theory and category theory. We refer the reader for detailed treatment of quasi-metric spaces and domain theory [8,1,6] and category theory [14]. In this paper, we use the following notations:
R denote the set of reals.

R+ = [0, ∞] is the set of non-negative reals extended with positive infinity, ∞.
(xi)i∈I,± denotes a net, i.e., a function that assigns to each index i from a directed pre-order I an element xi in a given set X. When there is no confusion, the preorder ± is omitted.
supremum (respectively, infimum) taken in a poset is denoted by  (respectively,
V), while that taken in the (extended) real line by sup (respectively, inf).

Quasi-metric spaces are almost metric spaces except for the lack of symmetry for the distance measuring function, i.e.,
Definition 2.1 (Quasi-metric) A quasi-metric d on a non-empty set X is a map
d : X × X −→ R+ such that for each x, y, z ∈ X:
QM1. d(x, x)= 0;
QM2. d(x, y)= d(y, x)=0 =⇒ x = y;
QM3. d(x, y) ≤ d(x, z)+ d(z, y).
The pair (X, d) is called a quasi-metric space.
Example 2.2	(i) Clearly, every metric space is a quasi-metric space.
Any poset (P, ≤) can be endowed with the following quasi-metric:
d (x, y) :=	0	if x ≤ y;
∞	otherwise.
(R, dR), where for any x, y ∈ R, dR(x, y) = max(x − y, 0), is a quasi-metric space.
As illustrated by Example 2.2(i) and (ii), the quasi-metric spaces subsume metric spaces and posets.
Definition 2.3 (Cauchy net, d-limit, Yoneda complete quasi-metric space) Let (X, d) be a quasi-metric space. A net (xi)i∈I,± is Cauchy if for any ϵ > 0, there exists iє ∈ I such that whenever i, ij ∈ I are such that iє ± i ± ij, one has d(xi, xi′ ) < ϵ. A point x ∈ X is a d-limit of (xi)i∈I,± if for all y ∈ X, it holds that d(x, y) = lim supi∈I,± d(xi, y) (:= infi∈I supj∈I,i±j d(xj, y)). The quasi-metric space (X, d) is Yoneda complete if every Cauchy net has a d-limit.
Example 2.4 (i) Every Cauchy sequence of a metric space (X, d) is a Cauchy net and the notions of limit and d-limit coincide. Thus, every complete metric space is a Yoneda complete quasi-metric space.
Let (P, ≤) be a poset and D ⊆ P a directed set. We can identify D as a net defined by xd = d for each d ∈ D. Clearly, the directed set D viewed as this net is always Cauchy by the definition of directedness. Thus x ∈ P is the d≤-limit of a directed set D if and only if  D = x. So, every dcpo is Yoneda complete with respect to the quasi-metric d≤.
(R, dR) is not Yoneda complete, but (R ∪ {∞}, dR) (with dR extended canoni- cally to R ∪ {∞}) is.
Definition 2.5 (Cauchy-weightable nets, Cauchy-weighted nets) Let (X, d) be a quasi-metric space. A net (xi, ri)i∈I in X × R+ is Cauchy-weighted in (X, d) if
infi∈I ri = 0;
for each i, ij ∈ I, whenever i ± ij, d(xi, xi′ ) ≤ ri − ri′ .

Given a Cauchy net (xi)i∈I,± in (X, d), if there exists (ri)i∈I,± such that (xi, ri)i∈I,±
is Cauchy-weighted, then we call (xi)i∈I,± a Cauchy-weightable net.
Lemma 2.6 Let (X, d) be a quasi-metric space.
([8], Lemma 7.4.9) For any Cauchy-weighted net (xi, ri)i∈I in (X, d), (xi)i∈I is a Cauchy net. Furthermore, x ∈ X is a d-limit of the Cauchy net (xi)i∈I,± iff for each y ∈ X, it holds that d(x, y) = supi∈I (d(xi, y) − ri).
([8], Lemma 7.2.8) Although not every Cauchy net is Cauchy-weightable, every Cauchy net has a Cauchy-weightable subnet.
([8], Lemma 7.4.6 and Exercise 7.4.7) Let (xi)i∈I be a Cauchy net and (xj)j∈J be its subnet. Then (xj)j∈J is a Cauchy net. Furthermore, (xi)i∈I has d-limit x if and only if (xj)j∈J has d-limit x.
Definition 2.7 (Formal balls) Let (X, d) be a quasi-metric space. Define B(X, d) := X × R+. We call the elements of B(X, d) formal balls. On B(X, d), we can define a quasi-metric d+ as follows:
d+((x, r), (y, s)) := dR(d(x, y),r − s),	(x, r), (y, s) ∈ B(X, d),
and as a result the induced order ≤d+ defined by
(x, r) ≤d+ (y, s) ⇐⇒ d(x, y) ≤ r − s,	(x, r), (y, s) ∈ B(X, d),
makes (B(X, d), ≤d+ ) a poset called the poset of formal balls of (X, d).
Remark 2.8 Note that by Definition 2.5(ii), every Cauchy-weighted net (xi, ri)i∈I
in (X, d) is a directed family in (B(X, d), ≤d+ ).
The concept of formal balls was first introduced by Weihrauch and Schreiber in 1981 ([22]) in the context of metric spaces and later refined by Edalat and Heckmann ([4]) who proved that all complete metric spaces have domain model because
Theorem 2.9 ([4, Theorem 6]) A metric space (X, d) is complete if and only if
(B(X, d), ≤d+ ) is a domain.
A similar concept is later on considered for quasi-metric spaces. Indeed, there are several beautiful characterizations for the case of quasi-metric spaces as well and we refer the reader to [2,12,10] and [17] for some of these results. In particular, we close this section with the celebrated Kostanek-Waszkiewicz Theorem which is of utmost importance in obtaining our main result; it opens up for us an option of performing a dcpo completion `a la Zhao and Fan [23] on the poset of formal balls instead of performing a Yoneda completion directly in the environment of quasi-metric spaces.
Theorem 2.10 (Kostanek-Waszkiewicz Theorem [12, Theorem 7.1]) A quasi- metric space (X, d) is Yoneda complete if and only if (B(X, d), ≤d+ ) is directed complete.

Main Result
In this section, we embark on our journey of constructing the desired idempotent Yoneda completion of quasi-metric spaces. We proceed to do so step-by-step in the ensuing subsections:
We describe the intrinsic problem that plagues the space of formal balls, i.e., the mismatch between the convergence behaviour of directed sets and that of Cauchy nets. To circumvent this problem, we introduce the notion of transla- tional complete directed families in the space of formal balls.
We identify the salient morphisms for the category of quasi-metric space so as to arrive at a suitable categorical definition of Yoneda completion of quasi- metric spaces.
Using the translational complete directed families defined in (1), we proceed to model the construction of the Yoneda completion after Zhao and Fan’s dcpo- completion via the poset of formal balls. Here we make crucial use of the Konstanek-Warskiewicz’s Theorem. In particular, we verify that our proposed Yoneda completion satisfies the requirements of the definition given in (2).
From this juncture onwards, (X, d) always denotes a quasi-metric space unless oth- erwise stated.


Introducing translational complete directed families
It is not true in general that if a directed family (x ,r )

in (B(X, d), ≤d+ ) has

i  i i∈I
a supremum, then (xi, ri + a)i∈I has a supremum for all a ∈ [− infi∈I ri, ∞). This
issue was highlighted in [10] and for this reason a special class of quasi-metric spaces called the standard quasi-metric spaces was considered. We say that (X, d)

is standard if every directed family (x ,r )
in (B(X, d), ≤d+ ) has a supremum

i  i i∈I
if and only if for all a ∈ [0, ∞), (xi, ri + a)i∈I has a supremum. For a standard
quasi-metric space, it can be shown that for every Cauchy-weighted net (xi, ri)i∈I , a point x ∈ X is a d-limit of (xi)i∈I , if and only if (x, 0) is the supremum of the directed family (xi, ri)i∈I in B(X, d) ([10, Lemma 5.15]).
A closer inspection of this aforementioned proof gives us very clear direction how to characterize the d-limit of a Cauchy-weighted net as the supremum of this net when viewed as a special type of directed family in (B(X, d), ≤d+ ). Proposition 3.2 gives this characterization but it requires a new concept:
Definition 3.1 (Translational complete directed family) A directed family (xi, ri)i∈I in B(X, d) is translational complete if for all a ∈ [− infi∈I ri, ∞), supi∈I (xi, ri + a) exists.
Proposition 3.2 Let (xi, ri)i∈I be a Cauchy-weighted net in (X, d). Then (xi)i∈I has d-limit x if and only if (xi, ri)i∈I is a translational complete directed family with supremum (x, infi∈I ri).
Proof. Since the proof for the converse uses exactly the same argument

as in [8, Lemma 7.4.26], we need only to show the implication.  By virtue of [8, Lemma 7.4.25], it suffices to prove that (xi, ri)i∈I is translational complete. For this purpose, let (xi, ri)i∈I be a Cauchy-weighted net where (xi)i∈I has d-limit x.  We show that for any a ∈ [0, ∞), (xi, ri + a)i∈I has supremum (x, r + a), where r = infi∈I ri. For any i, j ∈ I with i ± j, d(xi, x) ≤ d(xi, xj)+ d(xj, x) ≤ ri − rj + d(xj, x) ≤ (ri + a) − (r + a)+ d(xj, x).
Taking lim sup over j, one has d(xi, x) ≤ (ri + a) − (r + a) + lim supj∈I d(xj, x)= 
(r + a) − (r + a)+ d(x, x)= (r + a) − (r + a). Thus (x ,r + a) ≤d+ (x, r + a). Now
i	i	i  i

suppose for each i ∈ I, (x ,r + a) ≤d+ (y, s). Then d(x , y) ≤ r
+ a − s. Taking

i  i	i	i
lim sup over i gives lim supi∈I d(xi, y)= d(x, y) ≤ lim supi∈I ri + a − s = r + a − s
and (x, r + a) ≤d+ (y, s). Thus sup	(x ,r + a)= (x, r + a) as required.	2
i∈I	i  i
Remark 3.3 A quasi-metric space (X, d) is standard if and only if every directed family in (B(X, d), ≤d+ ) which has a supremum is translational complete.

Identifying morphisms in the category of quasi-metric spaces and deﬁning Yoneda completion
Recall that a map f : (X, d) −→ (Xj, dj) between quasi-metric spaces (X, d) and (Xj, dj) is continuous if for all x ∈ X, the usual ϵ-η condition holds:
∀ϵ > 0. ∃η > 0. ∀xj ∈ X. (d(x, xj) < η =⇒ dj(f (x),f (xj)) < ϵ).

We say that the map f is uniformly continuous if
∀ϵ > 0. ∃η > 0. ∀x, xj ∈ X. (d(x, xj) < η =⇒ dj(f (x),f (xj)) < ϵ).
Note that for the case of uniform continuity, the choice of η is independent of x.
Continuous maps between quasi-metric spaces behave slightly differently from their namesake in metric spaces in that they generally fail to preserve limits of Cauchy nets. This motivates the following definitions.
Definition 3.4 (Limit-continuous maps, Yoneda-continuous maps, Y -continuous maps, isometry) Let (X, d) and (Xj, dj) be quasi-metric spaces, and f : (X, d) −→ (Xj, dj) be a map. We say that f is
limit-continuous if it preserves Cauchy nets and their existing d-limits;
Yoneda-continuous if it is limit-continuous and uniformly continuous;
Y -continuous if it is limit-continuous and non-expansive, i.e., for all x, y ∈ X, dj(f (x),f (y)) ≤ d(x, y); and
an isometry if for all x, y ∈ X, dj(f (x),f (y)) = d(x, y).
A map g : (B(X, d), ≤d+ ) −→ (B(Xj, dj), ≤d′+ ) is Y -Scott-continuous if it preserves the supremum of translational complete directed family.
Proposition 3.5 Let (X, d) and (Xj, dj) be quasi-metric spaces. For any given map

f : (X, d) −→ (Xj, dj), deﬁne
B(f ): (B(X, d), ≤d+ ) −→ (B(Xj, dj), ≤d′+ ), (x, r) '→ (f (x), r).
Then f is Y -continuous if and only if B(f ) is Y -Scott-continuous.
Proof. ( =⇒ ) Let f : (X, d) −→ (Xj, dj) bea Y -continuous map and (xi, ri)i∈I be a
translational complete directed family in (B(X, d), ≤d+ ). Then (x ,r − inf	r )
i  i	i∈I i i∈I
is a Cauchy-weighted net and it follows that (xi)i∈I is a Cauchy net with d-limit
x in (X, d) by Proposition 3.2. By the definition of Y -continuous maps, (f (xi))i∈I is a Cauchy net with dj-limit f (x) in (Xj, dj). Furthermore, as f is Y -continuous and hence non-expansive, (f (xi), ri − infi∈I ri)i∈I is a Cauchy-weighted net: for any i, j ∈ I with i ± j, dj(f (xi),f (xj)) ≤ d(xi, xj) ≤ (ri−infi∈I )−(rj −infi∈I ). Applying Proposition 3.2 again, it is then immediate that (B(f )(xi, ri))i∈I = (f (xi), ri)i∈I is a translational directed family with supremum B(f )(x, r) = (f (x), r) and B(f ) is Y -Scott-continuous as claimed.
( ⇐= ) Let (xi)i∈I be a Cauchy net with d-limit x in (X, d) and B(f ) : (B(X, d), ≤d+ ) −→ (B(Xj, dj), ≤d′+ ) be a Y -Scott-continuous map. By Lemma 2.6(ii), (xi)i∈I has a Cauchy-weightable subnet (xj)j∈J , i.e., there ex- ists a net (rj)j∈J in [0, ∞) such that (xj, rj)j∈J is Cauchy-weighted. We show that f is non-expansive. It can be verified directly that if B(f ) is Y -Scott- continuous, it is monotone. Let x, y ∈ X. If d(x, y) = ∞, it is immediate that dj(f (x),f (y)) ≤ d(x, y). Now suppose that d(x, y) < ∞. Then d(x, y) ≤ d(x, y) implies that (x, d(x, y)) ≤d+ (y, 0) and (f (x), d(x, y)) ≤d′+ (f (y), 0). Thus dj(f (x),f (y)) ≤ d(x, y) and f is non-expansive.
We now proceed to show that f is limit-continuous. By Lemma 2.6(iii), (xj)j∈J has d-limit x. We use Proposition 3.2 to obtain that (xj, rj)j∈J is a translational complete directed family in (B(X, d), ≤d+ ) with supremum (x, 0). By the defini- tion of Y -Scott-continuous maps, (B(f )(xj, rj))j∈J = (f (xj), rj)j∈J is a transla- tional complete directed family with supremum B(f )(x, 0) = (f (x), 0). By Propo- sition 3.2, (f (xj))j∈J is a Cauchy net with dj-limit f (x). Since f is non-expansive, (f (xi))i∈I is a Cauchy net. Using the fact that (f (xj))j∈J is a subnet of Cauchy net (f (xi))i∈I Lemma 2.6(iii) again, (f (xi))i∈I has dj-limit f (x) in (Xj, dj) and f is Y -continuous.	2
Bearing in mind all these aforementioned kinds of mappings, we now turn to formulate a suitable categorical definition of Yoneda completion of a quasi-metric space. To do this, let us tease out something common among the approaches adopted by [3,13,20]. Therein, their Yoneda completions of a quasi-metric space
(X, d) considered typically comprise a Yoneda complete space (X˘ , d˘) and an isom-
etry τ : (X, d) −→ (X˘ , d˘) such that for any Yoneda complete quasi-metric space
(Y, e) and uniformly continuous map f : (X, d) −→ (Y, e), there exists a unique Yoneda-continuous map f˘ : (X˘ , d˘) −→ (Y, e) such that f = f˘ ◦ τ .
Because an isometry is not obliged to be limit-continuous, an resultant defect of the aforementioned approaches will be that the Yoneda completion of an already

Yoneda complete quasi-metric space X may result in a (Yoneda complete) quasi-

metric space X˘
that is strictly ‘larger’ than the initial space X. Because of this

phenomenon, Ku¨nzi and Schellekens then went on further to show that the largest class of quasi-metric spaces for which their version of the Yoneda completion is idempotent is exactly that of quasi-metric spaces where every Cauchy net is bi- Cauchy ([13, p. 181]). A net (xi)i∈I in (X, d) is bi-Cauchy if for each ϵ > 0, there exists iє > I such for all i, j ∈ I, iє ± i, j, d(xi, xj) < ϵ.
Clearly, the first step to fixing this defect begins with identifying the salient morphisms for the category of quasi-metric spaces so that we can give a categorical definition of what constitutes a Yoneda completion of a quasi-metric space. To do this, we recall that as far as preservation of directed suprema is concerned, the salient morphisms in the category of posets to consider are the Scott-continuous maps. Proposition 3.2 suggests that in order to capture the essence of the d-limit of a Cauchy net of a quasi-metric space (X, d) via its corresponding poset of formal balls, one should focus on the suprema formed by translational complete directed families. Consequently, the Y -Scott continuous maps are the morphisms we identify for the category of posets of formal balls. Backed by Proposition 3.5, we take the morphisms in the category of quasi-metric spaces to be the Y -continuous maps.
Such considerations lead to our definition of Yoneda completion of a quasi-metric space.
Definition 3.6 (Yoneda completion of a quasi-metric space) A Yoneda completion of a quasi-metric space (X, d) is a Yoneda complete quasi-metric space (X˘ , d˘), to- gether with a Y -continuous map τ : (X, d) −→ (X˘ , d˘), such that for any Yoneda complete quasi-metric space (Y, e) and Y -continuous map f : (X, d) −→ (Y, e),
there exists a unique Y -continuous map f˘ : (X˘ , d˘) −→ (Y, e) such that f = f˘ ◦ τ .
Not long ago, we have considered those mappings between quasi-metric spaces which preserve d-limits of Cauchy nets and are non-expansive, i.e., the Y -continuous maps. One can readily verify that the quasi-metrics spaces (respectively, Yoneda complete quasi-metric spaces) and Y -continuous mappings between them form a category, which we denote by QMet (respectively, YQMet). Obviously, YQMet is a full subcategory of QMet. It is now clear that every quasi-metric space has a Yoneda completion if and only if YQMet is a reflective subcategory of QMet with
reflector (−˘ ). By a standard categorical argument, it can be shown that a Yoneda
completion of a quasi-metric space, if it exists, is unique up to isomorphism and idempotent.
Underlying principles and proof sketch
Admittedly, the construction of the idempotent Yoneda completion is technical. Thus, it helps to motivate our approach and present a proof sketch in order that the reader can have a quick overview of the underlying principles and processes involved. Hopefully, this will make our journey through the thick technical forest in the next subsection a lot easier.
Since our Yoneda completion is modelled after the dcpo-completion invented by

Zhao and Fan in [23], it is only natural for us to recount their construction below:
ZF1. Given a poset P , form the complete lattice of Scott-closed sets of P ordered by inclusion, i.e., (Γ(P )).
ZF2. Embed the original poset P into the enveloping space Γ(P ) through the prin- cipal ideal embedding η, forming the image η(P ) := {↓x | x ∈ P} as a subset of Γ(P ). It is crucial to note that η is Scott continuous.
ZF3. Endow Γ(P ) with the d-topology: a subset S of a poset Q is d-closed if for every directed set D ⊆ S, whenever  D exists then  D ∈ S.
ZF4. Obtain the dcpo-completion, E(P ), of P by taking the d-closure of η(P ) in the enveloping space Γ(P ).
We now turn our attention to examine the Yoneda completions in the literature. Thanks to the equivalence of all the Yoneda completions proposed independently in
[3] [13] and [20], it does not matter, in principle, which one we pick. Notably, Vick- ers’ original point-free approach of localic completion of quasi-metric spaces (also known by the name of generalized metric spaces) makes crucial use of Cauchy filters of formal balls. So in line with our original plan of creating an idempotent Yoneda completion that models after Zhao and Fan’s dcpo completion of its correspond- ing poset of formal balls, we find Vickers’ approach the most suitable. However, to make use of Kostanek-Waszkiewicz Theorem, we use instead Goubault-Larrecq’s point-set version of Vickers’ approach. ([8, Section 7.5]) which we summarize below:
GL1. Given a quasi-metric space (X, d), form the rounded ideal completion of (B(X, d), ≤d+ ) to obtain a continuous dcpo (RI(X, d), ⊆).
GL2. Consider the subset S(X, d) of (RI(X, d), ⊆) consisting of those rounded ideals with aperture zero.
GL3. Equip S(X, d) with the Hausdorff-Hoare quasi-metric d+.
GL4. The formal ball (B(S(X, d), d+), ≤d+ ) is order-isomorphic to (RI(X, d), ⊆);
H	H
noting that (RI(X, d), ⊆) is a dcpo in particular.
GL5. By Kostanek-Waszkiewicz Theorem, (S(X, d), d+) is a Yoneda complete quasi- metric space as its corresponding poset of formal ball is a dcpo, and is defined to be the Yoneda completion of (X, d).
Since rounded ideal completion in (GL1) need not be idempotent, it follows that the Yoneda completion so obtained in (GL5) is not idempotent in general. The root of the problem lies with the choice of the space of rounded ideals as the enveloping space – the associated embedding of the original space into this enveloping space is not even Y -Scott continuous, let alone Scott-continuous.
Now, (ZF2) in Zhao and Fan’s dcpo-completion informs us that the appropriate enveloping space should be the Scott-closed set lattice Γ(P ) instead of the ideal completion Id(P ). Since our intention is to perform a dcpo-completion on the poset of formal balls, P := (B(X, d), ≤d+ ), a naive approach will be form E(P )= E(B(X, d), ≤d+ ). But such a move fails miserably for two reasons: (1) E(P ) may
not arise as the space of formal balls of some quasi-metric space (X˘ , d˘), and (2)

The enveloping space Γ(P ) involves the concept of Scott-closed sets and hence the Scott topology. The Scott topology is the just right one to consider with regards to the ‘convergence’ of directed sets to their suprema. But we already learnt from our analysis in Section 3.1 that among the directed families in the space of formal balls it should be the transitional complete ones we are focusing on. This motivates us to define, in Section 3.4.1, a new topology called the g-topology (see Definition 3.7), that involves transitional complete directed families in the space of formal balls in the same way as Scott topology involves directed subsets in the space of posets.
With the g-topology at hand, we proceed in Section 3.4.2 to copycat Goubault- Larrecq’s steps (GL1)–(GL5) in creating the enveloping quasi-metric space (X˜, d˜) into which we embed (X, d):
Embed (B(X, d), ≤d+ ) into the complete lattice of g-closed subsets (Γg(B(X, d)), ⊆).
Consider the subset X˜ of Γg(B(X, d)), consisting of those g-closed subsets with aperture zero.
Equip Γg(B(X, d)) with the Hausdorff-Hoare quasi-metric d+. Note that (X˜, d˜)
is a quasi-metric subspace of (Γg(B(X, d)), d+), where d˜:= d+ T ˜ ˜.
H	H  X×X
The formal ball (B(X˜, d˜), ≤d˜+ ) is order-isomorphic to (Γ (B(X, d)), ⊆). Note that (Γg(B(X, d)), ⊆) is more than a dcpo – it is a complete lattice.
By Kostanek-Waszkiewicz Theorem, (X˜, d˜) is a Yoneda complete quasi-metric space as its corresponding poset of formal balls is in particular a dcpo.
Guided by (ZF2), we embed the quasi-metric space (X, d) isometrically into the enveloping space (X˜, d˜); this embedding mirrors the Y -Scott continuous embedding from (B(X, d)) to (B(X˜, d˜), ≤d˜+ ) via Proposition 3.5.
In Section 3.4.3, we model after (ZF3) to define the Yoneda closed sets. Lastly, we model after (ZF4) to obtain the desired Yoneda completion (in the sense of Definition 3.6) by forming the Yoneda closure of the embedded image of (X, d)
within the enveloping space of (X˜, d˜).

Construction of idempotent Yoneda completion
We are now ready to demonstrate that every quasi-metric space has a Yoneda completion in the sense of Definition 3.6.

g-topology
We introduce the g-topology on the poset, B(X, d), of formal balls corresponding to a given quasi-metric space X.
Definition 3.7 (g-closed subset) A subset C of B(X, d) is called g-closed if it is
downward closed with respect to ≤d+ ; and
closed under the existing suprema of translational complete directed families, i.e., whenever (xi, ri)i∈I ⊆ C is a translational complete directed family that

has supremum, then its supremum (x, r) belongs to C.
A subset U is called g-open if its complement B(X, d) − U is g-closed. It can be verified directly that the collection of g-open subsets forms a topology. We denote the collection of all g-closed subsets of B(X, d) by Γg(B(X, d)).
Lemma 3.8 Every g-closed subset C of B(X, d) is closed in the open ball topology of quasi-metric space (B(X, d), d+). Consequently, for any (x, r) ∈/ C, there exists ϵ > 0 such that for all (c, s) ∈ C, it holds that d+((x, r), (c, s)) > ϵ.
Proof. We first show that C is closed in the open ball topology of quasi-metric space (B(X, d), d+).  Let (x, r) ∈  B(X, d) − C.  One can show that (x, r + ϵ)є>0 is a translational directed family which has supre- mum  (x, r).   It  follows  that  there  exists  (x, r + ϵ)  such  that  (x, r +

ϵ)	∈	B(X, d) − C.	We now show that Bd+
⊆ B(X, d) − C,  where

d+
(x,r),<є
:= {(y, s) ∈ B(X, d)|d+((x, r), (y, s)) < ϵ}.  For each (y, s)	∈	Bd+	,

d+((x, r), (y, s)) < ϵ implies that max(d(x, y) − r + s, 0) < ϵ and d(x, y) < r + ϵ − s. Thus (x, r + ϵ) ≤d+ (y, s) and (y, s) ∈ B(X, d) − C, as C is downward closed. C is closed in the open ball topology of (B(X, d), d+), as claimed.
We  show  the  second  part  of  the  lemma  using  contraposi- tive argument.   Suppose for all ϵ  >  0, there exists (c, s)  ∈  C, d+((x, r), (c, s))  ≤  ϵ.   Then  inf(c,s)∈C d+((x, r), (c, s))  =  0.   Hence
d+((x, r), C) := inf(c,r)∈C d+((x, r), (c, r)) = 0.  It follows that (x, r)  ∈  cl(C)
by [8], Lemma 6.1.11, where cl(C) is the closure of C with respect to the open ball topology of (B(X, d), d+). Thus cl(C) = C and (x, r) ∈ C and this completes the proof.	2
For any subset U of B(X, d), we denote the g-closure of U by clg(U ) :=  {C ∈ Γg(B(X, d)) | C ⊇ U}.
Enveloping quasi-metric space (X˜, d˜)
Let (x, r) ∈ B(X, d). Denote ↓(x, r) := {(y, s) ∈ B(X, d) | (y, s) ≤d+ (x, r)}.
Proposition 3.9 For each (x, r) ∈ B(X, d), ↓(x, r) is g-closed.
Proof. It is clear that every Scott closed subset is g-closed, and that ↓ (x, r) is Scott closed.	2
Let C ⊆ B(X, d). Let α : Γg(B(X, d)) −→ R+, C '→ inf(x,r)∈C r. Call α(C) the aperture of C. Let C + r := {(c, s + r) | (c, s) ∈ C} and whenever r ≤ α(C), C − r := {(c, s − r) | (c, s) ∈ C}.
Lemma 3.10 Let C  ∈  Γg(B(X, d)).  Then for r  ∈  R+, it holds that
C + r ∈ Γg(B(X, d)), and for r ≤ α(C), it holds that C − r ∈ Γg(B(X, d)).
Proof. Let r ∈ [−α(C), ∞), (yi, si)i∈I be a translational complete directed family with supremum (y, s) in C + r. We observe that infi∈I si ≥ max(r, 0). Thus (yi, si −

i∈I is a directed family in C, since −r : (w, t) '→ (w, t−r) is an order-isomorphism for r ≤ t. It follows that (y, s − r) ∈ C and thus (y, s) ∈ C + r.
To show that C +r is downward closed, let (w, t) ∈ C +r and suppose (wj, tj) ≤d+
(w, t). It follows that (w, t − r) ∈ C and (wj, tj − r) ≤d+ (w, t − r), as once again
— r : (w, t) '→ (w, t− r) is an order-isomorphism for r ≤ t. Thus (wj, tj − r) ∈ C as C is g-closed and hence downward closed. Finally (wj, tj) ∈ C + r. This completes the proof.	2

Lemma 3.11 Deﬁne the mapping η	: (B(X, d), ≤d+ ) −→ (Γ (B(X, d)), ⊆) by
(x, r) '→ ↓(x, r).
η0 is an order-embedding;
η0 is Y -Scott-continuous.

Lemma 3.12 Deﬁne the Hausdorff-Hoare quasi-metric d+ on Γg(X) by


d+(C, Cj) :=  sup	inf
d+((c, r), (cj, rj)).

H	(c,r)∈C (c′,r′)∈C′

Then d+(C, Cj)=0 if and only if C ⊆ Cj.

Proof. ( ⇐=) For each (c, r) ∈ C, inf(c′,r′)∈C′ d+((c, r), (cj, rj)) = 0, since (c, r) ∈ C
j	+	j	+	j	j
implies (c, r) ∈ C . Thus dH(C, C )= sup(c,r)∈C inf(c′,r′)∈C′ d  ((c, r), (c ,r )) = 0.
( =⇒ ) d+(C, Cj) = 0 implies that for all (c, r) ∈ C, it holds that inf(c′,r′)∈C′ d+((c, r), (cj, rj)) = 0, and thus d+((c, r), Cj) = 0. It follows that (c, r) ∈ clg(C)= C and hence C ⊆ Cj.	2
Thus the following can be verified straightforwardly.
Proposition 3.13 (Γg(B(X, d)), d+) is a quasi-metric space.
Lemma 3.14 For every quasi-metric space (X, d), denote the subcollection X˜ of

Γg(B(X, d)), where X˜
:= {C ∈ Γg(B(X, d)) | α(C) = 0} and
d˜ := d+ T ˜ ˜.

H	X×X
Deﬁne ψ : (B(X˜, d˜), ≤d˜+ ) −→ (Γ (B(X, d)), ⊆) by (C, s) '→ C + s. Then ψ is an
order-isomorphism.

Proof. By Lemma 3.10, ψ is well-defined. We first show that ψ is monotone by showing (C, r) ≤d˜+ (Cj, rj) implies that C + r ⊆ Cj + rj by contrapositivity. Suppose that C + r /⊆ Cj + rj. Then there exists (c, s + r) ∈ C + r and (c, s + r) ∈/ Cj + rj. Since Cj + rj is g-closed, it is closed with respect to the open ball topology of
(B(X, d), d+) and hence there exists ϵ > 0 such that for all (cj, sj + rj) ∈ Cj + rj,

d+((c, s + r), (cj, sj + rj)) > ϵ. Thus
d+((c, s + r), (cj, sj + rj)) > ϵ 
⇐⇒ max(d(c, cj) − s − r + sj + rj, 0) > ϵ 
⇐⇒ d(c, cj) − s + sj − r + rj > ϵ 
⇐⇒ d(c, cj) − s + sj > ϵ + r − rj
⇐⇒ max(d(c, cj) − s + sj, 0) > ϵ + r − rj
⇐⇒ d+((c, s), (cj, sj)) > ϵ + r − rj
=⇒	sup	inf	d+((c, s), (cj, sj)) ≥ ϵ + r − rj > r − rj
(c,s)∈C (c′,r′)∈C′
⇐⇒ d˜(C, Cj) > r − rj
⇐⇒ d˜+((C, r), (Cj, rj)) > 0
Thus (C, r) /≤d˜+ (Cj, rj).
The inverse mapping ψ—1 is defined by C '→ (C − α(C), α(C)). Clearly, α(C − α(C)) = 0. Also, if C is a g-closed subset, C − α(C) is also g-closed subset by Lemma 3.10. Hence C − α(C) ∈ X˜ and ψ—1 is well-defined. It can thus be verified directly that ψ is a bijection.
We now proceed to show that the inverse mapping ψ—1 is monotone. Suppose
C ⊆ Cj. It follows that α(C) ≥ α(Cj). Then
d˜(C − α(C), Cj − α(Cj))

=	sup
inf
d+((c, s), (cj, sj))

(c,s)∈C—α(C)  (c′,s′)∈C′—α(C′)

=	sup
inf
max(d(c, cj) − s + sj, 0)

(c,s)∈C—α(C)  (c′,s′)∈C′—α(C′)

= max(	sup
inf
d(c, cj) − s + sj, 0)

(c,s)∈C—α(C)  (c′,s′)∈C′—α(C′)

If sup(c,s)∈C—α(C) inf(c′,s′)∈C′—α(C′) d(c, c ) − s + s ≤ 0, then clearly we have d˜(C − α(C), Cj − α(Cj)) = 0 ≤ α(C) − α(Cj) and the proof is complete. Suppose instead that sup(c,s)∈C—α(C) inf(c′,s′)∈C′—α(C′) d(c, c ) − s + s > 0, then

d˜(C − α(C), Cj − α(Cj))

=	sup
inf
d(c, cj) − s + sj

(c,s)∈C—α(C)  (c′,s′)∈C′—α(C′)

=	sup
inf
d(c, cj) − s + sj

(c,s+α(C))∈C (c′,s′+α(C′))∈C′

=	sup
inf
d(c, cj) − (s + α(C)) + (sj + α(Cj)) + α(C) − α(Cj)

(c,s+α(C))∈C (c′,s′+α(C′))∈C′

Since C ⊆ Cj, every (c, s+α(C)) in C is in Cj and is equals to some (cj, sj+α(Cj)), it follows that sup(c,s+α(C))∈C inf(c′,s′+α(C′))∈C′ d(c, cj) − (s + α(C)) + (sj + α(Cj)) + α(C) − α(Cj)= 0 + α(C) − α(Cj) ≤ α(C) − α(Cj). Thus d˜(C − α(C), Cj − α(Cj)) ≤

α(C) − α(Cj) and (C − α(C), α(C)) ≤d˜+ (Cj − α(Cj), α(Cj). We then conclude that ψ—1 is monotone by applying Lemma 3.12. We have thus shown that ψ is an order-isomorphism.	2
At this point, we reiterate the importance for us to embed (B(X, d), ≤d+ ) into the collection of g-closed subsets as opposed to that of Scott-closed subsets, as have been done for the dcpo completion of a general poset proposed by Zhao and Fan [23]. This is because of the following:
Proposition 3.15 For some quasi-metric space (X, d), there exists a Scott-closed subset C of (B(X, d), ≤d+ ) where C − α(C) is not Scott-closed.
Proof. We consider X := [0, 1], and d on X × X which is defined as follows:
0	if x = y
∞	if x = 0, 0 < y ≤ 1

0	if y = 0, 0 < x ≤ 1
x − y	if 0 < y < x ≤ 1.
We use Figure 1 to represent how d is defined on X.




Fig. 1. Counterexample illustrated
An arrow is given together with a magnitude from one point to another to represent the distance of the former to the latter. For instance, an arrow with magnitude ∞ is given from 0 to 1 to represent d(0, 1) = ∞; an arrow with magnitude x − y is given from a point x, where 0 < x ≤ 1 to another point y, where 0 < y < x to represent that d(x, y)= x − y for such x, y ∈ X.
It can be verified with the aid of the diagram that the triangular inequality holds and (X, d) is a quasi-metric space. (It is even a T1 quasi-metric, in the sense that whenever d(x, y)=0 then x = y).
Let C ⊆ B(X, d) where C = {(0, r) | r ≥ 3}∪ {(x, r) | x ∈ (0, 1],r ≥ 2)}. We first show that C is a Scott-closed subset of (B(X, d), ≤d+ ).

We first show that C is downward-closed. Suppose (y, s) ≤d+ (0, r). Then d(y, 0) ≤ s − r. Thus s ≥ 3 and y can be any element from [0, 1]. Thus (y, s) ∈ C. Now suppose x ∈ (0, 1] and (y, s) ≤d+ (x, r). Then d(y, x) ≤ s − r and s ≥ 2. In particular, y ∈ (0, 1], since d(0, x)= ∞ /≤ s − r. Once again, (y, s) ∈ C. The proof that C is downward-closed is thus complete.
Finally we show that C is closed under existing directed suprema. Let (xi, ri)i∈I be a directed family in C. Then (xi, ri − infi∈I ri)i∈I is a Cauchy-weighted net in (X, d), and (xi)i∈I is eventually decreasing with respect to the usual order ≤ on reals. We consider cases.
Case 1: xi =0 for i ∈ I large enough. Then clearly 0 is a d-limit of (xi)i∈I . By Lemma 2.6, (0, infi∈I ri) is the supremum of (xi, ri)i∈I . Since for each i ∈ I, ri ≥ 3, infi∈I ri ≥ 3. Thus (0, infi∈I ri) ∈ C.
Case 2: lim infi∈I ri = a > 0. Clearly, a is the d-limit of (xi)i∈I and again by Lemma 2.6, (a, infi∈I ) is the supremum of (xi, ri)i∈I . For each i ∈ I, ri ≥ 2, infi∈I ri ≥ 2 and (a, infi∈I ri) ∈ C.
Case 3: For each i ∈ I, xi > 0 and lim infi∈I xi = 0. We first consider (xi, ri − infi∈I ri)i∈I and let (y, s) be its upper bound. Then for each i ∈ I, d(xi, y) ≤ ri − infi∈I ri − s. Since ri tends to infi∈I ri as (ri)i∈I is decreasing, ri − infi∈I ri tends to 0. Thus s = 0. Also, since lim infi∈I xi = 0, y = 0. We conclude that sup(xi, ri − infi∈I ri)i∈I = (0, 0), since (0, 0) is the only upper bound of the directed family. If (xi, ri)i∈I has a supremum, then it must equal (0, r) by [10], Proposition
2.4 (2). We observe that (1, 0) is an upper bound of (xi, ri)i∈I , since d(xi, 1) = 1,
and thus d(x , 1) ≤ r −0 (recall r ≥ 2). But (0, r) /≤d+ (1, 0), since d(0, 1) = ∞ /≤ r.
i	i	i
Thus such (xi, ri)i∈I does not have a supremum.
To sum up, we have shown that C is closed under existing directed suprema. Observe that α(C) = 2. We now show that C − α(C) is not Scott-closed.
C − 2 = {(0, r)|r ≥ 1}∪ {(x, r) | x ∈ (0, 1],r ≥ 0}, and hence (1/2n, 1/2n)n∈N is a directed family in C − α(C). Then by the proof is the aforementioned Case 3, the supremum of (1/2n, 1/2n)n∈N is (0, 0), but (0, 0) ∈/ C. Thus C − α(C) is not Scott-closed.	2

Proposition 3.15 illustrates the problem we had previously, as this property ob- structed us in showing that the map ψ in Lemma 3.14 is surjective and hence conclude that it is an order-isomorphism.  The fact that (B(X˜, d˜), ≤d+ ) and
(Γg(B(X, d)), ⊆) are order-isomorphic is crucial, as it allows us to deduce that (B(X˜, d˜), ≤d+ ) is a complete lattice and hence a dcpo, which then gives that (X˜, d˜) is a Yoneda-complete quasi-metric space by Theorem 2.10.

Corollary 3.16 Deﬁne η : (B(X, d), ≤d+ ) −→ (B(X˜, d˜), ≤d˜+ ), (x, r) '→ (↓(x, 0), r). Then the mapping η is a Y -Scott-continuous order-embedding.

Proof. We observe that η = ψ—1 ◦ η0. Since it is the composition of two Y -Scott- continuous order-embeddings, it is itself a Y -Scott-continuous order-embedding. 2

Proposition 3.17 Deﬁne τ : (X, d) −→ (X˜, d˜) by
x '→ ↓(x, 0).
Then τ is a Y -continuous isometric embedding.
Proof. We observe that for τ : (X, d) −→ (X˜, d˜), x '→ ↓(x, 0), B(τ )= η and is a
Y -Scott-continuous map. Thus τ is Y -continuous by Proposition 3.5.
Also, for any x, y ∈ X,
d˜(↓ (x, 0), ↓ (y, 0))

=	sup
inf
d+((xj, rj), (yj, sj))

(x′,r′)∈↓(x,0) (y′,s′)∈↓(y,0)

=	sup
(x′,r′)∈↓(x,0)
d+((xj, rj), (y, 0))

= d+((x, 0), (y, 0))
= max(d(x, y) − 0+ 0, 0)
= d(x, y).
Thus τ is an isometric embedding and the proof is complete.	2

3.4.3  Existence of idempotent Yoneda completion
We say that a subset A of X is Yoneda closed if every Cauchy net in A has its d-limit (whenever it exists) in A. This is analogous to the d-closed subset on a poset, where a subset D is d-closed if it is closed under directed supremum ([23,11]). Unsurprisingly, the collection of Yoneda closed subsets of a quasi-metric space forms the closed subsets of a topology, which we call the Yoneda topology.
We define the Yoneda closure of a subset B, denoted by clY (B), where clY (B) :=  {A ⊇ B|A is a Yoneda closed subset of X}. For any subset B of X, clY (B) is Yoneda closed.
It is straightforward to verify the following:
Lemma 3.18 Let f : (X, d) −→ (Xj, dj) be a Y -continuous map and where (X, d) and (Xj, dj) are quasi-metric spaces. For any subset A ⊆ X, we have f (clY (A)) ⊆ clY (f (A)).
Lemma 3.19 Let (X, d) be a quasi-metric space and C ∈ Γg(B(X, d)). For any s ∈ [0, ∞), deﬁne C T(x,r)∈C, r≥s −s := {(x, r − s) | (x, r) ∈ C, r ≥ s}. Then C T(x,r)∈C, r≥s −s ∈ Γg(B(X, d)).
Proof. Let  (xi, ri)i∈I  be  a  translational  complete  directed  family  in C T(x,r)∈C,r≥s −s with supremum (x, r).  Then (xi, ri + s)i∈I is a transla- tional complete directed family in C and has supremum (x, r + s). By definition of g-closed subsets, (x, r + s) ∈ C. Clearly, r + s ≥ s and (x, r) ∈ C T(x,r)∈C,r≥s −s.
Let (w, t) ∈ C T(x,r)∈C,r≥s  −s and suppose (wj, tj) ≤d+  (w, t).  Then (w, t + s) ∈ C. Also, (wj, tj + s) ≤d+ (w, t + s) and thus (wj, tj + s) ∈ C. Again, tj + s ≥ s and (wj, tj) ∈ C|(x,r)∈C,r≥s − s. This completes the proof.	2

This gives us more information of the relationship between clg(E) and clg(E − α(E)) + α(E). In particular, it turns out that clg(E − α(E)) + α(E) is also the smallest g-closed subset containing E. More precisely, we have:
Lemma 3.20 Let (X, d) be a quasi-metric space and E ⊆ B(X, d). Then
clg(E)= clg(E − α(E)) + α(E).

Proof. For each C ∈ Γg(B(X, d)) such that C ⊇ E, define C∗ ⊆ C such that C∗ − α(E) ⊇ E − α(E).  More precisely, we obtain such C∗ by considering C∗ := C T(x,r)∈C,r≥α(E)= {(x, r) ∈ C | r ≥ α(E)}.
We have that E = (E − α(E)) + α(E) ⊆ clg(E − α(E)) + α(E). By Lemma 3.10, clg(E − α(E)) + α(E) is g-closed and hence clg(E) ⊆ clg(E − α(E)) + α(E). We now show that clg(E) ⊇ clg(E − α(E)) + α(E). Let C be a g-closed subset con- taining E. Then C∗ contains E and C∗−α(E) contains E−α(E), which then follows that C∗ − α(E) contains clg(E − α(E)). Thus C ⊇ C∗ ⊇ clg(E − α(E)) + α(E) and clg(E) ⊇ clg(E − α(E)) + α(E) as claimed. The proof is complete.	2
Finally, with all the machinery amassed so far, we reach the climax of this paper:
Theorem 3.21 Given any quasi-metric space (X, d), there exists a Yoneda- completion (X˘ , d˘).
Proof. Define  (X˜, d˜)  and  (X˜j, d˜j)  as  is  the  case  in  Lemma  3.14.
Also define  g∗  :  (X˜, d˜)  −→  (X˜j, d˜j),C  '→  clg(B(g)(C))  and  thus
B(g∗): (B(X˜, d˜), ≤d˜+ ) −→ (B(X˜j, d˜j), ≤d˜′ ), (C, r) '→ (cl (B(g)(C), r).	We establish that B(g∗) is a a Y -Scott-continuous map.  We first show that ψ ◦ B(g∗) ◦ ψ—1 : Γg(B(X, d)) −→ Γg(B(Xj, dj)), C '→ clg(B(g)(C − α(C))) + α(C) is  a  lower  adjoint  of  (B(g))—1.	By  Lemma  3.20, ψ ◦ B(g∗) ◦ ψ—1(C)= clg(B(g)(C − α(C))) + α(C)= clg(B(g)(C)).    Clearly,
ψ◦B(g∗)◦ψ—1 and (B(g))—1 are monotone. Let C ∈ Γg(B(X, d)), Cj ∈ Γg(B(Xj, dj)) and suppose ψ ◦ B(g∗) ◦ ψ—1(C) ⊆ Cj. Then clg(B(g)(C)) ⊆ Cj and B(g)(C) ⊆ Cj, hence C ⊆ (B(g))—1(Cj). Let D ∈ Γg(B(X, d)), Dj ∈ Γg(B(Xj, dj)) and suppose
D ⊆ (B(g))—1(Dj). Then B(g)(D) ⊆ Dj, and clearly clg(B(g)(D)) ⊆ Dj as Dj is g-closed. We have thus proved that ψ◦ B(g∗) ◦ψ—1 is a lower adjoint of (B(g))—1. It follows that ψ ◦ B(g∗) ◦ ψ—1 preserves arbitrary supremum and finite infimum, and
hence is Y -Scott-continuous. Since B(g∗) is a composition of Y -Scott-continuous maps, B(g∗) is Y -Scott-continuous and by Proposition 3.5, g∗ : (X˜, d˜) −→ (X˜j, d˜j) is Y -continuous.
Since (Γg(B(X, d)), ⊆) is a complete lattice and hence a dcpo and that (Γg(B(X, d)), ⊆) ∼= (X˜, d˜), by Theorem 2.10, we have that (X˜, d˜) is a Yoneda- complete quasi-metric space. Define X˘ := clY (τ (X)) and d˘ := d˜|X˘ ×X˘ .
For every x ∈ X,
g∗(↓ (x, 0)) = clg(B(g)(↓(x, 0)) = clg({(g(y), s) | (y, s) ≤d+ (x, 0)})= ↓(g(x), 0)

As (Xj, dj) is a Yoneda-complete quasi-metric space, clY (η(Xj)) = η(Xj) and τ—1 : (X˜j, d˜j) −→ (Xj, dj) is a bijective isometry.  We observe that τ—1 ◦ g∗ : (X˜, d˜) −→ (Xj, dj) is a composition of Y -continuous map, and hence is Y -continuous. Finally, τ—1 ◦ g∗ restricts to a Y -continuous map from (Xˆ, dˆ) to
(Xj, dj) satisfying g = τ—1 ◦ g∗ ◦ τ .	2

Conclusion
In a series of talks given by Goubault-Larrecq on quasi-metric spaces (for in- stance, [9,7]), it was advocated that the essence of quasi-metric spaces manifests in the order structure of their formal balls. By this remark, it was meant that many interesting properties of quasi-metric spaces can be viewed through the domain- theoretic lens (see, for instance, [2,12,17]). In this paper, we make active use of the Kostanek-Waszkiewicz Theorem as a passage between the Yoneda completeness of quasi-metric space and the directed completeness of its corresponding poset of formal balls in obtaining an idempotent Yoneda completion of quasi-metric space. The main technique employed in our construction of the Yoneda completion relies on a familiar technique of embedding a space into another to extract and express information on the original one. This technique has been to be fruitful in the literature of domain theory. For instance, O’Neil, Schellekens and Waszkiewicz independently proved the fundamental theorem of quantitative domain theory that domains (respectively, omega-continuous dcpos) are quantifiable through a gener- alized metric (respectively, partial metric) inducing the Scott topology ([16,18,21]). The O’Neil-Schellekens-Waszkiewicz theorem proof-techniques boil down to an em- bedding of the original space into another to extract information from the envelop- ing space, setting the foundation for the general approach that forms the core of later work in Quantitative Domain Theory as well as the present work. Of course, other instances of this technique appeared in Zhao and Fan’s dcpo-completion of a
poset [23] as well as Keimel and Lawson’s d-completion of T0 space [11].
Along our theoretical development, we also taken a closer look at quasi-metric space (X, d) in terms of a specific type of directed families, i.e., the translational complete ones, which gives essential information about the (existing) d-limit of its corresponding Cauchy net. We are curious to find out if more properties of the quasi- metric space (X, d) with regards to the d-limits of Cauchy nets that can possibly be obtained via use of the g-topology and Yoneda topology we introduced in this paper.

References
Abramsky, S., and Jung, A., Domain Theory, In Handbook of Logic in Computer Science, 1-168, Clarendon Press, 1994.
Ali-Akbari, M., Honari, B., Pourmahdian, M., and Rezaii, M., The space of formal balls and models of quasi-metric spaces. Mathematical Structures in Computer Science, 19(02), 2009.
Bonsangue, M. et. al., Generalized metric spaces: Completion, topology, and powerdomains via the yoneda embedding. Theoretical Computer Science, 193(1-2):1-51, 1998.

Edalat, A. and Heckmann, R., A computational model for metric spaces. Theoretical Computer Science, 193(1-2):53-73, 1998.
Flagg, R. C. and Sunderhauf, P., The essence of ideal completion in quantitative form. Theoretical Computer Science, 278(1-2): 14-158, 2002.
Gierz, G., Hofmann, K. H., Keimel, K., Lawson, J. D., Mislove, M. W., and Scott, D.S., Continuous Lattices and Domains. Number 93 in Encyclopedia of Mathematics and its Applications, Cambridge University Press, 2003.
Goubault-Larrecq, J., Formal Balls. Domains Workshop XII, Cork, Ireland, 2015.
Goubault-Larrecq, J., “Non-Hausdorff Topology and Domain Theory”. Number 22 in New Mathematical Monographs. Cambridge University Press, 2013.
Goubault-Larrecq, J. A Few Pearls in the Theory of Quasi-metric Spaces. Summer Topology Conference, July 23-26, 2013.
Goubault-Larrecq, J. and Ng, K. M., A few notes on formal balls. arXiv 1606.05445, version 3, 03 Sep. 2016, submitted to Logical Methods in Computer Science.
Keimel, K. and Lawson, J. D., D-completions and d-topology. Annals of Pure and Applied Logic, 159(3):292-306, 2009.
Kostanek, M. and Waszkiewicz, P., The formal ball model for Q-categories. Mathematical Structures in Computer Science, 21(01):46-64, 2010.
Ku¨nzi, H. and Schellekens, M., On the Yoneda completion of a quasi-metric space. Theoretical Computer Science, 278(1-2):159-194, 2002.
Mac Lane, S., Categories for the Working Mathematician. Graduate Texts in Mathematics, 5 (2nd ed.), Springer, 1998.
M. W. Mislove, Local DCPOs, Local CPOs and Local completions, Electronic Notes in Theoretical Computer Science, 20(1999).
O’Neil, S. A fundamental study into the theory and application of the partial metric spaces. PhD thesis, University of Warwick, 1998.
Romaguera, S. and Valero, O., Domain theoretic characterisations of quasi-metric completeness in terms of formal balls. Mathematical Structures in Computer Science, 20(03):453-472, 2010.
Schellekens, M., A characterization of partial metrizability:domains are quantifiable, Theoretical Computer Science, 305: 409432, 2003
Smyth, M. B., Quasi-Uniformities: Reconciling Domains with Metric Spaces, Lecture Notes in Computer Science, vol. 298, Springer, Berlin, pp. 236253, 1987.
Vickers, S., Localic completion of generalized metric spaces I. Theory and Applications of Categories, 14:328-356, 2005.
Waszkiewicz, P., Quantitative continuous domains, Applied Categorical Structures, 11:4167, 2003.
Weihrauch, K. and Schreiber, U., Embedding metric spaces into CPOs. Theoretical computer science, 16:5-24, 1981.
Zhao, D. and Fan, T., Dcpo-completion of posets. Theoretical Computer Science, 411(22-24):2167-2173, 2010.
