Egyptian Informatics Journal 24 (2023) 100420








Full Length Article
A hybridization of granular adaptive tabu search with path relinking for the multi-depot open vehicle routing problem
Wenhan Shao, Tuanyue Xiao, Zhouxing Su, Junwen Ding âˆ—, Zhipeng LÃ¼
School of Computer Science and Technology, Huazhong University of Science and Technology, 1037 Luoyu Road, Wuhan, 430074, China


A R T I C L E	I N F O	A B S T R A C T

	

Keywords:
Multi-depot open vehicle routing problem Granular neighborhoods
Solution-based tabu search Adaptive neighborhood selection Path relinking
The multi-depot open vehicle routing problem (MDOVRP) differs from the classical VRP in that there is more than one depot and the vehicle does not need to return to a depot after serving the last customer. For solving this challenging problem, we propose a hybrid metaheuristic algorithm (GATS-PR) which integrates the granular adaptive tabu search with path relinking. The main contributions of this work consist of introducing a solution- based tabu search technique in granular tabu search, designing an adaptive neighborhood selection method for the large neighborhoods with 22 kinds of move types, and adopting path relinking with a new similarity definition to the MDOVRP for the first time. Computational results on 24 public instances demonstrate that GATS-PR outperforms the previous state-of-the-art algorithms in the literature. Specifically, GATS-PR improved and matched the previous best known results on 4 and 19 instances, respectively.





Introduction

Since the vehicle routing problem (VRP) was proposed in [1], its variants have been introduced to model various practical applications, including but not limited to city logistics [2], online food ordering de- livery [3], multi-robot exploration [4], hazardous waste collection [5] and telecommunications [6]. As a VRP variant, the multi-depot open vehicle routing problem (MDOVRP) was first formulated and solved to distribute fresh meat in an area of the city of Athens [7]. However, it received little attention until the public MDOVRP instances originat- ing from the multi-depot VRP benchmarks were proposed [8]. Because the VRP and its variants are NP-hard [9], it is diï¬ƒcult for an exact al- gorithm to obtain optimal solutions in a reasonable time on large-scale instances of the MDOVRP [10â€“12]. In order to solve the MDOVRP effec- tively and eï¬ƒciently, we propose the hybridization of granular adaptive tabu search with path relinking (GATS-PR). The main contributions of this study include:

The solution-based tabu search instead of attribute-based tabu search is devised in our granular tabu search.
The adaptive neighborhood selection method is developed for the large composite neighborhoods with 22 kinds of move types.
Path relinking is introduced to solve the MDOVRP for the first time and a new similarity definition is designed for the MDOVRP to guide the path generation.
We validate the performance of GATS-PR on 24 public instances. Computational results indicate that GATS-PR outperforms the pre- vious state-of-the-art algorithms.

The remaining of the paper is organized as follows. In Section 2, related work about the MDOVRP is presented. The definition of the MDOVRP is given in Section 3. Section 4 describes the proposed GATS- PR in detail. In Section 5, parameter tuning, computational results and importance analysis of the proposed algorithmic components are re- ported. Conclusion is given in Section 6.

Related work

In this section, we first review the state-of-the-art algorithms for the MDOVRP. Then, we introduce the application of granular tabu search and path relinking in the VRP related field, which are important com- ponents of our proposed algorithm.
It is common to solve a problem by proposing its mixed-integer programming model and solving the model with commercial solvers [13â€“15]. This method is also widely used to solve the MDOVRP. In [8],



* Corresponding author.
E-mail addresses: shaowenhan95@hust.edu.cn (W. Shao), ty_xiaohust@hust.edu.cn (T. Xiao), suzhouxing@hust.edu.cn (Z. Su), junwending@hust.edu.cn (J. Ding), zhipeng.lv@hust.edu.cn (Z. LÃ¼).
https://doi.org/10.1016/j.eij.2023.100420
Received 31 August 2023; Received in revised form 8 November 2023; Accepted 14 November 2023
Available online 24 November 2023
1110-8665/Â© 2023 THE AUTHORS. Published by Elsevier BV on behalf of Faculty of Computers and Artificial Intelligence, Cairo University. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).



a mixed integer programming (MIP) formulation of the MDOVRP was proposed and solved with CPLEX. In [11] and [16], subtour elimina- tion constraints of [8] were improved and constraints related to the minimum vehicle number and the first customer to visit were added. In [10], a two-index vehicle flow formulation was proposed to solve the open location routing problem and the MDOVRP. In [12], the MIP model designed for the multi-depot open location routing problem with a heterogeneous fixed-charge fleet was adapted for the MDOVRP and solved with CPLEX.
In order to eï¬ƒciently obtain high-quality solutions for combinato- rial optimization problems, numerous metaheuristic algorithms have been proposed, such as tabu search [17], evolutionary algorithms [18â€“20], hybrid genetic algorithms [21â€“24]. They are also applied for the MDOVRP. A hybrid genetic algorithm was proposed in [8], where a solution is encoded as a giant tour of all routes without trip delim- iters, the classic order crossover [25] is used to generate a new child solution from the chosen parent solutions, and three move types includ- ing 1-0 Exchange, 1-1 Exchange and 2-Opt are applied to improve the child solution. Tabu search with multiple neighborhood search were hy- bridized to solve the MDOVRP in [26], where multiple neighborhoods are generated by path moves and ejection chains. A memory-based it-
erated local search algorithm was presented for the MDOVRP in [27],



Fig. 1. An example of the solution of an MDOVRP instance.

Problem definition

The MDOVRP is defined on an undirected complete graph ğº = (ğ‘‰ , ğ¸), where ğ‘‰ is the set of nodes and ğ¸ denotes the set of edges. ğ‘‰ consists of two exclusive subsets ğ‘‰ ğ· and ğ‘‰ ğ¶ which include |ğ‘‰ ğ·| depots and |ğ‘‰ ğ¶ | customers, respectively. A fleet with an unlimited number of homogeneous vehicles with capacity ğ‘„ is based on each depot. Each customer ğ‘£ğ‘– âˆˆ ğ‘‰ ğ¶ is characterized by a positive demand ğ‘ğ‘– (ğ‘ğ‘– â‰¤ ğ‘„). Each edge ğ‘’ğ‘–ğ‘— âˆˆ ğ¸, ğ‘– â‰  ğ‘— is associated with a positive cost ğ‘ğ‘–ğ‘— represent- ing the traveling time from node ğ‘£ğ‘– to node ğ‘£ğ‘— . The costs are symmetric
and satisfy the triangular inequality.
A route ğ‘… = {ğ‘£0 , ğ‘£1 , â€¦ , ğ‘£ğ‘šğ‘… } consists of ğ‘š  different customers and

ğ‘…  ğ‘…	ğ‘…	ğ‘…

which records moves performed during the local search phase and uses
depot ğ‘£0 , where ğ‘šğ‘… is the number of customers in ğ‘…. The traveling time

historical search information to guide the perturbation procedure. A variable tabu neighborhood search algorithm was proposed in [28],
ğ‘…
ğ‘‡ğ‘… of ğ‘… is equal to
âˆ‘ğ‘šğ‘… âˆ’1
ğ‘–=0
ğ‘ğ‘£ğ‘– ,ğ‘£ğ‘–+1 . The load ğ¿ğ‘… is the total demand of
ğ‘…âˆ‘ğ‘…

all customers of ğ‘…, i.e., ğ¿ =  ğ‘šğ‘… ğ‘ ğ‘– . If ğ¿ â‰¤ ğ‘„, ğ‘… is a feasible route.

which applies granular local search in the intensification phase and the tabu shaking mechanism in the diversification phase. A multi-start metaheuristic algorithm was designed in [12], which consists of a con- structive heuristic and an iterated local search algorithm to solve the MDOVRP. In [29], a tabu search algorithm was designed for the simul- taneous scheduling of multi-project construction and vehicle routing, and it was adapted to the MDOVRP.
Granular neighborhoods [30] and tabu search [31] are common in the field of the VRP, which are often adopted together to eï¬ƒciently obtain high-quality solutions [32â€“34]. By excluding unsuitable moves in the current search phase, granular neighborhoods can improve the search eï¬ƒciency without sacrificing the solution quality. To leverage the characteristic of granular neighborhoods, we design different granu- lar neighborhoods for each move type. Although the review shows that many studies have used tabu search to solve the MDOVRP and other VRP-related problems, all these studies choose the attribute-based tabu search strategy. Because it is diï¬ƒcult to rapidly calculate hash values of solutions and quickly identify whether two solutions are identical, the solution-based tabu search strategy is rarely applied to the VRP and its variants. These challenges are addressed for the MDOVRP by designing the suitable hash function, adopting open addressing hashing with dou- ble hashing to handle hash collisions, and recording the characteristics of the visited solution rather than the solution itself.
Due to the diï¬ƒculty in defining the similarity between solutions, there are few studies applying path relinking in the field of the VRP. In [35], the number of the same customers that appear in matched routes is defined as the similarity of two solutions for the VRP. Because the sequence of nodes on a route is ignored, the solution at the end of the path may not be the same as the guiding solution. Hence, the child solution may not be able to inherit good attributes of the guiding so- lution. In [36], the minimum number of relocating moves needed to transform one solution to another is defined as their similarity for the VRP. Therefore, the final solution is the same as the guiding solution af- ter path relinking. However, the diversity of the child solution is limited because only one move type is used. To overcome these disadvantages and take advantage of the characteristic that there is more than one de- pot in the MDOVRP, we design a new similarity definition and consider all the proposed move types at each step of the path generation.
ğ‘…	ğ‘–=1 ğ‘£	ğ‘…
The goal of the MDOVRP is to determine a set of feasible routes to serve
each customer exactly once with the minimum total traveling time of all routes.
Fig. 1 depicts an example of the solution of an MDOVRP instance, where seven customers are served by three routes beginning from de-
pots ğ·1 and ğ·2 , while depot ğ·3 is not used.
The hybridization of granular adaptive tabu search with path relinking for the MDOVRP

To explore promising solution space systematically, we propose the GATS-PR algorithm which hybridizes granular adaptive tabu search
(GATS) with path relinking. GATS-PR manages population ğ‘ƒ with ğœ‡
lution ğ‘â„ğ‘–ğ‘™ğ‘‘ is generated by path relinking from two parent solutions feasible solutions as shown in Algorithm 1. At each iteration, a new so- randomly chosen from ğ‘ƒ (lines 4-5) and is improved by the local search procedure GATS (line 6). If ğ‘â„ğ‘–ğ‘™ğ‘‘ is feasible and does not belong to ğ‘ƒ , its objective function value ğ‘“ (ğ‘â„ğ‘–ğ‘™ğ‘‘) is compared with that of the worst parent solution ğ‘ğ‘¤ğ‘œğ‘Ÿğ‘ ğ‘¡ (lines 7-8). If ğ‘â„ğ‘–ğ‘™ğ‘‘ is better than ğ‘ğ‘¤ğ‘œğ‘Ÿğ‘ ğ‘¡ , it re- places ğ‘ğ‘¤ğ‘œğ‘Ÿğ‘ ğ‘¡ (lines 9-10). If ğ‘â„ğ‘–ğ‘™ğ‘‘ is better than the best solution ğ‘ âˆ— found so far, it replaces ğ‘ âˆ— (lines 11-12).

Algorithm 1 General framework of GATS-PR.


Input: Instance
Output: Best solution ğ‘ âˆ— found so far
1: Initialize population ğ‘ƒ with ğœ‡ feasible solutions (Section 4.2) 2: ğ‘ âˆ— â† argminğ‘ âˆˆğ‘ƒ ğ‘“ (ğ‘ )
3: while the time limit is not reached do
4:  ğ‘1 , ğ‘2 â† Randomly choose two solutions from ğ‘ƒ
5:	ğ‘â„ğ‘–ğ‘™ğ‘‘ â† Apply path relinking to ğ‘1, ğ‘2 (Section 4.3) 6:	ğ‘â„ğ‘–ğ‘™ğ‘‘ â† Apply GATS to ğ‘â„ğ‘–ğ‘™ğ‘‘ (Section 4.1)
7:	if ğ‘â„ğ‘–ğ‘™ğ‘‘ is feasible and ğ‘â„ğ‘–ğ‘™ğ‘‘ âˆ‰ ğ‘ƒ then
8:	ğ‘ğ‘¤ğ‘œğ‘Ÿğ‘ ğ‘¡ â† argmaxğ‘ âˆˆ{ğ‘1 ,ğ‘2 } ğ‘“ (ğ‘ )
9:	if ğ‘“ (ğ‘â„ğ‘–ğ‘™ğ‘‘) < ğ‘“(ğ‘ğ‘¤ğ‘œğ‘Ÿğ‘ ğ‘¡ ) then
10:	ğ‘ğ‘¤ğ‘œğ‘Ÿğ‘ ğ‘¡ â† ğ‘â„ğ‘–ğ‘™ğ‘‘
11:	if ğ‘“ (ğ‘â„ğ‘–ğ‘™ğ‘‘) < ğ‘“(ğ‘ âˆ—) then
12:	ğ‘ âˆ— â† ğ‘â„ğ‘–ğ‘™ğ‘‘
13:	end if
14:	end if
15:	end if
16: end while






Fig. 2. Move types used in GATS-PR.


Granular adaptive tabu search

Algorithm 2 presents the main framework of granular adaptive tabu search (GATS). GATS iteratively improves the initial feasible solution
ğ‘  until the termination condition is satisfied (line 2), where ğ‘–ğ‘¡ğ‘’ğ‘šğ‘ğ‘¥ is
nate GATS. At each iteration, ğ›¿ customers are randomly chosen from the maximum consecutive iterations without improvement to termi- all customers (line 3) and a set ğ‘€ of move types is determined by the
neighborhood solutions of ğ‘  generated according to ğ‘€ , ğ¶ğ‘¢ğ‘  and granu- adaptive neighborhood selection method (line 4). After evaluating all
ğ‘ , ğœŒ(ğ‘ ) defined in Eq. (2) is a normalization factor for relating the order
penalty, ğ‘ğ‘ğ‘ğ‘ is the factor for penalizing the violation of vehicle capacity of magnitude of the objective function value and the vehicle capacity constraints, and ğ‘£ğ‘ğ‘ğ‘(ğ‘ ) is the cumulative violation of vehicle capacity
of constraint violations timely, ğ‘ğ‘ğ‘ğ‘ is updated at each iteration in the constraints of all the tours as shown in Eq. (3). To control the degree
same way as in [37].
ğ‘“ â€²(ğ‘ )= ğ‘“ (ğ‘ )+ ğœŒ(ğ‘ )Ã— ğ‘ğ‘ğ‘ğ‘ Ã— ğ‘£ğ‘ğ‘ğ‘(ğ‘ )	(1)
|ğ‘‰ ğ¶ | Ã— ğ‘“ (ğ‘ )

lar neighborhoods of ğ¶ğ‘¢ğ‘ , we set ğ‘  to the best unvisited neighborhood
solution in terms of the generalized objective function value (line 5),
ğœŒ(ğ‘ )= 
âˆ‘
ğ‘–âˆˆğ‘‰ ğ¶ ğ‘ğ‘–
(2)

record ğ‘  as a tabu solution (line 6), and update the best solution ğ‘ âˆ—
found so far (lines 7-11).
ğ‘£ğ‘ğ‘ğ‘
âˆ‘
(ğ‘ )=	ğ‘šğ‘ğ‘¥(ğ¿ğ‘…
ğ‘…âˆˆğ‘ 
â€“ ğ‘„, 0)	(3)



Algorithm 2 General framework of GATS.

Input: Initial feasible solution ğ‘  Output: Best solution ğ‘ âˆ— found so far 1: ğ‘–ğ‘¡ğ‘’ğ‘¢ğ‘›ğ¼ ğ‘šğ‘ â† 0, ğ‘ âˆ— â† ğ‘ 
2: while ğ‘–ğ‘¡ğ‘’ğ‘¢ğ‘›ğ¼ ğ‘šğ‘ â‰¤ ğ‘–ğ‘¡ğ‘’ğ‘šğ‘ğ‘¥ do
3:	ğ¶ğ‘¢ğ‘  â† Randomly choose ğ›¿ customers
4:	ğ‘€ â† Choose move types with the adaptive neighborhood selection mechanism 5:	ğ‘  â† Choose the best unvisited neighborhood solution of ğ‘ 
6:	 Record ğ‘  as a tabu solution in hash tables 7:	if ğ‘  is feasible and ğ‘“ (ğ‘ ) < ğ‘“(ğ‘ âˆ—) then
8:	ğ‘–ğ‘¡ğ‘’ğ‘¢ğ‘›ğ¼ ğ‘šğ‘ â† 0, ğ‘ âˆ— â† ğ‘ 
9:	else
10:	ğ‘–ğ‘¡ğ‘’ğ‘¢ğ‘›ğ¼ ğ‘šğ‘ â† ğ‘–ğ‘¡ğ‘’ğ‘¢ğ‘›ğ¼ ğ‘šğ‘ +1 
11:	end if
12: end while





Generalized objective function
In GATS, it is allowed to visit infeasible solutions which violate ve- hicle capacity constraints to explore wider search space. In order to
design a generalized objective function ğ‘“ â€² for the MDOVRP as shown compare the quality of feasible solutions with that of infeasible ones, we in Eq. (1), where ğ‘“ (ğ‘ ) denotes the objective function value of solution

Move types
Let ğ‘£ and ğ‘¤ represent two nodes, ğ‘£ğ‘˜âˆ’ and ğ‘£ğ‘˜+ stand for the ğ‘˜th predecessor and successor nodes of ğ‘£ (ğ‘˜ is omitted when ğ‘˜ = 1). When
ğ‘£ is a customer, ğ‘£ğ‘“ and ğ‘£ğ‘™ denote the first and the last customers of the tour including ğ‘£, and ğ‘£ğ‘‘ represents the depot serving ğ‘£. A total of
22 move types in 6 categories are depicted in Fig. 2 and described as follows:
ğ¸ğ‘¥ğ‘â„ğ‘ğ‘›ğ‘”ğ‘’ interchanges distinct customers. Exchanged customers
are served by the same depot but belong to different tours in 2-
Opt* and by different depots in Exchange-b and Exchange-f. For Exchange-1, Exchange-2 and Exchange-2With1, there is no limita- tion for exchanged customers.
ğ‘…ğ‘’ğ‘™ğ‘œğ‘ğ‘ğ‘¡ğ‘’ moves one or several consecutive customers into a new
reversed and it is unchanged for other ğ‘…ğ‘’ğ‘™ğ‘œğ‘ğ‘ğ‘¡ğ‘’ move types. After position. For Relocate-Reverse2, the order of relocated customers is
ğ‘…ğ‘’ğ‘™ğ‘œğ‘ğ‘ğ‘¡ğ‘’, there must be at least one customer left on the affected
tours.
ğ‘…ğ‘’ğ‘£ğ‘’ğ‘Ÿğ‘ ğ‘’ reverses a route segment and it includes 2-Opt.
ğ‘†ğ‘ğ‘™ğ‘–ğ‘¡ extracts a route segment of a tour to construct a new tour
served by the same or a different depot. After the operation, there



is at least one customer left on the affected tours. Hence, the tour number is increased by one.
ğ‘€ğ‘’ğ‘Ÿğ‘”ğ‘’ combines two tours into one, which reduces the tour num-
ber by one.
ğ‘‡ğ‘Ÿğ‘ğ‘›ğ‘ ğ‘“ ğ‘’ğ‘Ÿ changes the depot of a tour to another.
Although a vehicle does not return to a depot in the MDOVRP, we add an auxiliary edge linking the last customer with the departing depot to simplify the design of move types. The edge cost from a customer to a depot is set to zero.
lution. ğ¸ğ‘¥ğ‘â„ğ‘ğ‘›ğ‘”ğ‘’ swaps customers, ğ‘…ğ‘’ğ‘™ğ‘œğ‘ğ‘ğ‘¡ğ‘’ changes the position of These six categories of move types differ in how they modify a so- customers, ğ‘…ğ‘’ğ‘£ğ‘’ğ‘Ÿğ‘ ğ‘’ changes the direction of a route segment, ğ‘†ğ‘ğ‘™ğ‘–ğ‘¡ ex-
tracts a route segment from the original tour and serves it with a depot,
ğ‘€ğ‘’ğ‘Ÿğ‘”ğ‘’ combines two tours into one, and ğ‘‡ğ‘Ÿğ‘ğ‘›ğ‘ ğ‘“ ğ‘’ğ‘Ÿ severs the tour with
another depot. Additionally, the impact degree on the solution varies
for distinct move types within each category. For example, relocating one customer has a smaller impact on the solution than relocating a lot of customers. By designing large composite neighborhoods with differ- ent functions and impact degrees, the algorithm can select appropriate move types in different search phases and achieve the balance between intensification and diversification of the search.

Adaptive neighborhood selection
If evaluating neighborhood solutions generated by all the move types at each iteration, it will be too time-consuming. Hence, we de- velop an adaptive neighborhood selection (ANS) strategy to choose suitable move types and group all the move types into four neighbor-
hoods ğ‘ = {ğ‘1, ğ‘2, ğ‘3, ğ‘4} in ascending order of the degree of change
to a solution as follows:

ğ‘1 = {Exchange-1, Relocate-1, Relocate-2, RelocateWithReverse- 2, 2-Opt}
ğ‘2 = {2-Opt*, Exchange-2, Exchange2With1}
ğ‘3 = {Exchange-b,	Exchange-f,	Relocate-b,	Relocate-f, TransferBySplit-b, TransferBySplit-f}
ğ‘4 = {MergeBy2-Opt*, MergeByRelocate-b, MergeByRelocate-f, Split-0, Split-1, Split-2, Split-b, Split-f}
At each iteration, ANS selects neighborhood ğ‘›ğ‘’ğ‘– âˆˆ ğ‘ with probabil- ity ğ‘ğ‘›ğ‘’ğ‘– as shown in Eq. (4), where ğ‘¤ğ‘›ğ‘’ğ‘– is the weight of selecting ğ‘›ğ‘’ğ‘–.
To avoid too large weig[ht differenc]e among neighborhoods, weights are
intensification of the search because the neighborhoods whose general- ized objective function value improvements are sub-optimal are likely to be frequently selected. 2) If a move type is chosen at an unsuitable time, its weight will be set to a small value and it is hard to select it again when there are too many neighborhoods. This reduces diversifi- cation brought by various move types.
high for move types in ğ‘1 and ğ‘2 in the early stages of the search, these Due to the fact that the probabilities of improving the solution are
two neighborhoods have high weights and are frequently selected. Be- cause a lot of move types among these neighborhoods are compared to obtain the best improvement move, it guarantees intensification of the search. When the search falls into a local optimum, weights of selecting
ğ‘1 and ğ‘2 are decreased because move types in ğ‘1 and ğ‘2 are un-
of choosing ğ‘3 and ğ‘4, and diversifies the search at suitable time. likely to improve the solution quality. This increases the probabilities

Granular neighborhoods
choosing a move type, a customer ğ‘ğ‘¢ğ‘ , and a neighboring node of ğ‘ğ‘¢ğ‘  As shown in Fig. 2, a neighborhood solution is determined when
orating solution quality, we define granular neighborhoods of ğ‘ğ‘¢ğ‘  after after the move. In order to further speed up the search without deteri- the move by considering only proximate nodes of ğ‘ğ‘¢ğ‘  to limit the num-
ber of neighborhood solutions as follows:

All depots.
The first âŒŠğ‘”ğ‘¡ Ã— |ğ‘‰ ğ¶ |âŒ‹ closest customers of ğ‘ğ‘¢ğ‘ , where ğ‘”ğ‘¡ is the gran- ularity threshold and its value is between ğ‘”ğ‘¡ğ‘šğ‘–ğ‘› and ğ‘”ğ‘¡ğ‘šğ‘ğ‘¥ .
Neighboring nodes of ğ‘ğ‘¢ğ‘  in the best solution found so far.
We update ğ‘”ğ‘¡ in the same way as mentioned in [37].

Solution-based tabu search
For a population-based hybrid evolutionary algorithm, when the attribute-based tabu search strategy is used, a solution may be visited many times in the local search even if initial solutions are different. Thus, we design a solution-based tabu search strategy which records all visited solutions and avoids revisiting them to further enhance diversi- fication of the search.
Let ğ‘™ represent the list with |ğ‘‰ ğ¶ |+|ğ‘‰ ğ·| random numbers and ğ‘™ğ‘– the
value of the ğ‘–th element of ğ‘™. The hash value â„ of solution ğ‘  is calculated by the hash function ğ» as shown in Algorithm 3. For each edge of ğ‘ , corresponding values of its two ends in ğ‘™ are multiplied to XOR with

limited to the interval
ğ‘¤ğ‘šğ‘–ğ‘›, ğ‘¤ğ‘šğ‘ğ‘¥
and their initial values are ğ‘¤ğ‘šğ‘–ğ‘› . Let
â„ (line 5), where â„ is initially set to zero (line 1). The hash value of ğ‘ 

ğ‘  denote the current solution, ğ‘ â€² stand for the solution after the move, and ğ‘ ğ‘’ğ‘™ represent the selected neighborhood. After the move, ANS up- dates weight ğ‘¤ğ‘ ğ‘’ğ‘™ as follows:

The accumulative generalized objective function value improve-
and inserted edge of the move, the corresponding values in ğ‘™ of its two after a move is calculated as shown in Algorithm 4. For each deleted ends are multiplied to XOR with â„ to obtain the hash value of ğ‘  after the
time complexity of Algorithm 4 is ğ‘‚(1), which ensures the eï¬ƒciency of move (lines 3 and 7). Due to the characteristics of the XOR operator, the

âˆ—
ğ‘ ğ‘’ğ‘™
of ğ‘ ğ‘’ğ‘™ is updated as shown in Eq. (5), where discount
the neighborhood evaluation.

factor ğ›¼ is introduced to balance historical and current contribu-
tions of neighborhoods.
ANS adjusts ğ‘¤ğ‘ ğ‘’ğ‘™ by comparing Î”âˆ—	with the median value


Algorithm 3 Hash value of a solution.
Input: Solution ğ‘ 

ğ‘šğ‘’ğ‘‘(Î”âˆ—) of Î”âˆ—
ğ‘ ğ‘’ğ‘™
as shown in Eq. (6), where factor
ğœ† is used to con-
Output: Hash value â„ of ğ‘ 

trol the convergence speed of weights. If the former is less than the
latter, it indicates that ğ‘ ğ‘’ğ‘™ is more likely to improve the solution.
1: â„ â† 0
2: for ğ‘¡ğ‘œğ‘¢ğ‘Ÿ âˆˆ ğ‘  do


ğ‘ğ‘›ğ‘’ğ‘–
Therefore, ğ‘¤
= âˆ‘ğ‘¤ğ‘›ğ‘’ğ‘–
ğ‘¤
ğ‘ ğ‘’ğ‘™
is increased. Otherwise, ğ‘¤ğ‘ ğ‘’ğ‘™
is reduced.


(4)
3:	for ğ‘’ğ‘‘ğ‘”ğ‘’ âˆˆ ğ‘¡ğ‘œğ‘¢ğ‘Ÿ do
4:	ğ‘›ğ‘œğ‘‘ğ‘’1 , ğ‘›ğ‘œğ‘‘ğ‘’2 â† Two nodes of ğ‘’ğ‘‘ğ‘”ğ‘’
5:	â„ â† (ğ‘™ğ‘›ğ‘œğ‘‘ğ‘’1 Ã— ğ‘™ğ‘›ğ‘œğ‘‘ğ‘’2 ) âŠ•â„ 
6:	end for

ğ‘–âˆˆğ‘
Î”âˆ—  = ğ›¼ Ã— Î”âˆ—
ğ‘–
+ (1âˆ’ ğ›¼)Ã— (ğ‘“ â€²(ğ‘ â€²)âˆ’ ğ‘“ â€²(ğ‘ ))	(5)
7: end for




ğ‘ ğ‘’ğ‘™	{
ğ‘¤ğ‘ ğ‘’ğ‘™ =
ğ‘ ğ‘’ğ‘™
ğ‘¤ğ‘ ğ‘’ğ‘™ + ğœ† Ã— (ğ‘¤ğ‘šğ‘ğ‘¥ âˆ’ ğ‘¤ğ‘ ğ‘’ğ‘™ ) Î”âˆ—
ğ‘¤ğ‘ ğ‘’ğ‘™ + ğœ† Ã— (ğ‘¤ğ‘šğ‘–ğ‘› âˆ’ ğ‘¤ğ‘ ğ‘’ğ‘™ ) Î”âˆ—
< ğ‘šğ‘’ğ‘‘(Î”âˆ—)
â‰¥ ğ‘šğ‘’ğ‘‘(Î”âˆ—)
(6)
To handle hash collisions, we adopt classic open addressing hash- ing with double hashing. In open addressing hashing, probing refers to obtaining offsets of the hash value calculated by the hash function

If we define a neighborhood for each move type, there will be two disadvantages: 1) Weights of many move types are comparable and the neighborhood selection is random for these move types. This reduces
ğ» when a collision occurs. Due to probing, open addressing hash-
ing is able to place items with the same hash value in different po-
sitions. Double hashing is one of the probing methods, which uses



Algorithm 4 Hash value of a solution after a move.
Input: Hash value â„ of the current solution, all deleted and inserted edges ğ¸ğ‘‘ and ğ¸ğ‘– of
1: for ğ‘’ğ‘‘ğ‘”ğ‘’ âˆˆ ğ¸ğ‘‘ do the move, respectively
2:	ğ‘›ğ‘œğ‘‘ğ‘’1 , ğ‘›ğ‘œğ‘‘ğ‘’2 â† Two nodes of ğ‘’ğ‘‘ğ‘”ğ‘’
3:	â„ â† â„ âŠ• (ğ‘™ğ‘›ğ‘œğ‘‘ğ‘’1 Ã— ğ‘™ğ‘›ğ‘œğ‘‘ğ‘’2 )
4: end for
5: for ğ‘’ğ‘‘ğ‘”ğ‘’ âˆˆ ğ¸ğ‘– do
6:	ğ‘›ğ‘œğ‘‘ğ‘’1 , ğ‘›ğ‘œğ‘‘ğ‘’2 â† Two nodes of ğ‘’ğ‘‘ğ‘”ğ‘’
7:	â„ â† â„ âŠ• (ğ‘™ğ‘›ğ‘œğ‘‘ğ‘’1 Ã— ğ‘™ğ‘›ğ‘œğ‘‘ğ‘’2 )
8: end for


the second hash function ğ‘†ğ» to calculate offsets. In our experiment,
ğ‘†ğ»(ğ‘ ) = ğ» (ğ‘ ) mod 97 + 1.
Let ğ‘™ğ‘’ğ‘› = 999983 represent the size of hash table ğ»ğ‘‡ , ğ‘š stand for
Solution construction: For each depot ğ‘‘, customers assigned to ğ‘‘
are randomly selected and inserted into a tour served by ğ‘‘ one at
a time according to the following rules:
The customer is inserted into a tour with the minimum cost if it does not violate vehicle capacity constraints;
Otherwise, the customer is served by a new tour.

4.3. Path relinking for the MDOVRP

Let ğ‘†ğ·ğ‘–,ğ‘— (ğ‘†ğ‘ğ‘–,ğ‘— ) represent the number of customers served by the same depot (with the same neighbors) in solutions ğ‘ ğ‘– and ğ‘ ğ‘— . The simi- larity ğ‘ ğ‘–ğ‘šğ‘–,ğ‘— between ğ‘ ğ‘– and ğ‘ ğ‘— is defined as the weighted sum of ğ‘†ğ·ğ‘–,ğ‘— and ğ‘†ğ‘ğ‘–,ğ‘— as shown in Eq. (9), where ğ‘¤ğ‘†ğ· is the weight factor of ğ‘†ğ·ğ‘–,ğ‘— .

the number of solutions in ğ»ğ‘‡ , and ğ‘™ğ‘“ = ğ‘šâˆ•ğ‘™ğ‘’ğ‘› denote the load fac- tor of ğ»ğ‘‡ . If solution ğ‘  is recorded in the ğ‘–th row of ğ»ğ‘‡ , ğ»ğ‘‡ğ‘– =
ğ‘ ğ‘–ğ‘šğ‘–,ğ‘—
= ğ‘¤
ğ‘†ğ·
Ã— ğ‘†ğ·ğ‘–,ğ‘—
+ (1âˆ’ ğ‘¤
ğ‘†ğ·
)Ã— ğ‘†ğ‘ğ‘–,ğ‘—
(9)

(ğ‘“ (ğ‘ ), ğ‘£ğ‘ğ‘ğ‘(ğ‘ )), where ğ‘“ (ğ‘ ) is the objective function value of solution
ğ‘  and ğ‘£ğ‘ğ‘ğ‘(ğ‘ ) is the cumulative violation of vehicle capacity constraints of ğ‘ . The initial mapped position ğ¼ğ‘ƒ (ğ‘ ) of solution ğ‘  and the ğ‘–th mapped position ğ‘ƒğ‘–(ğ‘ ) after double hashing are shown in Eq. (7) and Eq. (8), re- spectively. When searching for an empty position to record solution ğ‘  or determining whether ğ‘  has existed in ğ»ğ‘‡ , we check values recorded in rows ğ‘… = {ğ¼ğ‘ƒ (ğ‘ ), ğ‘ƒ1(ğ‘ ), ğ‘ƒ2(ğ‘ ), â€¦} of ğ»ğ‘‡ in turn until finding a row
ğ‘Ÿ âˆˆ ğ‘…, where ğ»ğ‘‡ğ‘Ÿ is empty or equal to ((ğ‘“ (ğ‘ ), ğ‘£ğ‘ğ‘ğ‘ (ğ‘ )).
ğ¼ğ‘ƒ (ğ‘ )= ğ» (ğ‘ ) mod ğ‘™ğ‘’ğ‘›	(7)
ğ‘ƒğ‘–(ğ‘ )= (ğ» (ğ‘ )âˆ’ ğ‘– Ã— ğ‘†ğ»(ğ‘ )) mod ğ‘™ğ‘’ğ‘›, ğ‘– âˆˆ â„•+	(8) For the current row ğ‘Ÿ âˆˆ ğ‘…:
If ğ»ğ‘‡ğ‘Ÿ is equal to (ğ‘“ (ğ‘ ), ğ‘£ğ‘ğ‘ğ‘(ğ‘ )), we consider that solution ğ‘  has been visited;
If ğ»ğ‘‡ğ‘Ÿ is empty, it indicates that ğ‘  is an unvisited solution;
Otherwise, the value in the next row of ğ»ğ‘‡ is checked.

When load factor ğ‘™ğ‘“ is large, the search eï¬ƒciency of the hash table will significantly decrease. Hence, when ğ‘™ğ‘“ > 0.75: An unvisited solu- tion ğ‘  will be recorded in ğ»ğ‘‡ğ¼ğ‘ƒ (ğ‘ ) if its objective function value ğ‘“ (ğ‘ ) is better than that recorded in ğ»ğ‘‡ğ¼ğ‘ƒ (ğ‘ ) ; Otherwise, ğ‘  is discarded.
acceptable computational cost, we use three hash tables ğ‘‡ğµ1, ğ‘‡ğµ2 and To avoid identifying an unvisited solution as a visited one under
ğ‘‡ğµ3 with different values in ğ‘™ to record solutions. Only when the pair of ğ‘“ (ğ‘ ) and ğ‘£ğ‘ğ‘ğ‘(ğ‘ ) exists in the mapped positions of all the tables, ğ‘  is
regarded as a tabu solution. Fig. 3 illustrates an example of determining
three customers 2, 3 and 4. Solution ğ‘  includes one tour departing from whether a solution is in tabu state. There are two depots 0 and 1 and depot 0, visiting customers 2, 3 and 4 in turn. The pair ğ‘ of ğ‘“ (ğ‘ ) and
ğ‘£ğ‘ğ‘ğ‘(ğ‘ ) is (9, 2) for solution ğ‘ . For ğ»ğ‘‡ 1, ğ¼ğ‘ƒ (ğ‘ ) = 22 and ğ»ğ‘‡ 1 is equal
tial solution ğ‘1 and guiding solution ğ‘2 , the similarity ğ‘ ğ‘–ğ‘šğ‘ğ‘¢ğ‘Ÿ between Algorithm 5 presents the pseudo-code of our path relinking. For ini-
them is calculated (line 1). A high-quality solution is more likely to be obtained from solutions in the middle part of the path after applying the GATS procedure because it inherits good attributes of parent solutions.
Consequently, parameters ğ‘Ÿğ‘ğ‘¡ğ‘–ğ‘œğ‘ğ‘’ğ‘” and ğ‘Ÿğ‘ğ‘¡ğ‘–ğ‘œğ‘’ğ‘›ğ‘‘ are used to limit the
interval of the path where the final result is selected (line 2). In the
ing vehicle capacity constraints too much and push ğ‘1 toward ğ‘2, only path construction (lines 3-12), to avoid the final solution from violat- feasible neighborhood solutions whose similarities to ğ‘2 are larger than
ğ‘ ğ‘–ğ‘šğ‘ğ‘¢ğ‘Ÿ are considered (lines 4-5). We sort solutions of ğ‘ğ‘’ğ‘– in an as-
cending order of the sum of their rankings in terms of similarity and
dom solution from the first ğ›¾ ones of ğ‘ğ‘’ğ‘– as new ğ‘1 (line 7), ğ‘ ğ‘–ğ‘šğ‘ğ‘¢ğ‘Ÿ and objective function value improvements (line 6). After choosing a ran-
the reference solution are updated (lines 8-11).

Algorithm 5 Path relinking for the MDOVRP.
Input: Initial solution ğ‘1, guiding solution ğ‘2
Output: Reference solution ğ‘ ğ‘Ÿğ‘’ğ‘“
1: ğ‘ ğ‘–ğ‘šğ‘ğ‘¢ğ‘Ÿ â† Calculate similarity between ğ‘1 and ğ‘2
2: ğ‘ ğ‘–ğ‘šğ‘ğ‘’ğ‘” â† ğ‘ ğ‘–ğ‘šğ‘ğ‘¢ğ‘Ÿ Ã— ğ‘Ÿğ‘ğ‘¡ğ‘–ğ‘œğ‘ğ‘’ğ‘” , ğ‘ ğ‘–ğ‘šğ‘’ğ‘›ğ‘‘ â† ğ‘ ğ‘–ğ‘šğ‘ğ‘¢ğ‘Ÿ Ã— ğ‘Ÿğ‘ğ‘¡ğ‘–ğ‘œğ‘’ğ‘›ğ‘‘ , ğ‘“ (ğ‘ ğ‘Ÿğ‘’ğ‘“ ) â† +âˆ
3: while ğ‘ ğ‘–ğ‘šğ‘ğ‘¢ğ‘Ÿ â‰¤ ğ‘ ğ‘–ğ‘šğ‘’ğ‘›ğ‘‘ do
4:  ğ‘ğ‘’ğ‘– â† Generate all the feasible neighborhood solutions of ğ‘1 with all the move
types defined in Fig. 2
5:	ğ‘ğ‘’ğ‘– â† Retain ğ‘  âˆˆ ğ‘ğ‘’ğ‘– whose similarity to ğ‘2 is greater than ğ‘ ğ‘–ğ‘šğ‘¡ğ‘šğ‘
6:	ğ‘ğ‘’ğ‘– â† Sort ğ‘ğ‘’ğ‘– according to the sum of rankings of ğ‘  in ğ‘ğ‘’ğ‘– in terms of similarity
and objective function value improvements
7:	ğ‘1 â† Randomly pick a solution from the first ğ›¾ ones of ğ‘ğ‘’ğ‘–
8:	ğ‘ ğ‘–ğ‘šğ‘ğ‘¢ğ‘Ÿ â† Calculate similarity between ğ‘1 and ğ‘2
9:	if ğ‘ ğ‘–ğ‘šğ‘ğ‘¢ğ‘Ÿ â‰¥ ğ‘ ğ‘–ğ‘šğ‘ğ‘’ğ‘” and ğ‘“ (ğ‘ ğ‘Ÿğ‘’ğ‘“ ) > ğ‘“(ğ‘1 ) then
10:	ğ‘ ğ‘Ÿğ‘’ğ‘“ â† ğ‘1
11:	end if
12: end while




to ğ‘. Therefore, solution ğ‘ 
22
is considered as a visited solution in
ğ»ğ‘‡ 1.

The pairs of ğ»ğ‘‡ 2 and ğ»ğ‘‡ 3 are different from ğ‘, so we check the first
5	40	5. Experimental results
mapped positions after double hashing in these tables, which are both
999982. Because ğ»ğ‘‡ 2	and ğ»ğ‘‡ 3	are both empty, solution ğ‘  is

999982
999982 2	3
We tested GATS-PR on the public MDOVRP instances introduced

regarded as an unvisited solution in ğ»ğ‘‡
unvisited solution.

Population initialization
and ğ»ğ‘‡ . Hence, ğ‘  is an
in [8].1 Table 1 presents the notations used in this section. In the fol- lowing subsections, we first present the parameter tuning process of GATS-PR. Then, the results obtained by GATS-PR are compared with those obtained by the state-of-the-art reference algorithms in the liter-

Population ğ‘ƒ is initialized with ğœ‡ feasible solutions, each of which
is generated after the following two steps and is improved by the local
search procedure GATS.

1. Customer assignment: Each customer ğ‘ğ‘¢ğ‘  is assigned to its nearest depot for 0.7 Ã— ğœ‡ solutions and randomly assigned to one of its two
nearest depots according to the probability 1 âˆ’   ğ‘ğ‘‘,ğ‘ğ‘¢ğ‘ 	 for the
ature. Finally, the importance of the proposed algorithmic components is analyzed.

Parameter tuning

For instances which are easy to solve, it is not sensitive to parame- ter settings. Hence, instances p09, p10 and pr05 which are hard to solve

âˆ‘
ğ‘ ğ‘–

remaining 0.3 Ã— ğœ‡ solutions, where ğ‘‘ğ‘–
ğ‘ğ‘¢ğ‘ .
ğ‘–=1 ğ‘‘ğ‘ğ‘¢ğ‘  ,ğ‘ğ‘¢ğ‘ 
is the ğ‘–th nearest depot of		
1 http://neo.lcc.uma.es/vrp/vrp-instances/multiple-depot-vrp-instances/.




Fig. 3. An example of determining whether a solution is in tabu state.


Table 1
Notations.


Notation	Meaning


Ins	Instance name
BKS	Objective function value of the best known solution
Ref	Reference to the algorithm which obtained BKS for the first time
ğ‘“ğ‘ğ‘’ğ‘ ğ‘¡	Objective function value of the best solution
ğ‘“ğ‘ğ‘£ğ‘”	Average ğ‘“ğ‘ğ‘’ğ‘ ğ‘¡ among multiple experiments
The number ğ›¾ of elite solutions from which the neighborhood move
is picked at each step of path generation. Its default value is 3.
The weight factor ğ‘¤ğ‘†ğ· of ğ‘†ğ·ğ‘–,ğ‘— . Its default value is 0.7.
The combination of the population size ğœ‡ and ğ‘–ğ‘¡ğ‘’ğ‘šğ‘ğ‘¥ . Its default
value is (10, 2).
The combination of ğ‘Ÿğ‘ğ‘¡ğ‘–ğ‘œğ‘ğ‘’ğ‘” and ğ‘Ÿğ‘ğ‘¡ğ‘–ğ‘œğ‘’ğ‘›ğ‘‘ determining the path seg-
ment of interest. Its default value is (0.6, 0.4).

The maximal run time was 600 seconds for tuning path relinking-related

ğºğ‘ğ‘
ğ‘ğ‘’ğ‘ ğ‘¡
(ğ‘“ğ‘ğ‘’ğ‘ ğ‘¡
-BKS)/BKS reported as â€° values
parameters. Based on ğ‘†ğºğ‘ğ‘’ğ‘ ğ‘¡ presented in Table 3, ğ›¾ was set to 5, ğ‘¤ğ‘†ğ·

ğºğ‘ğ‘
ğ‘ğ‘£ğ‘”
(ğ‘“ğ‘ğ‘£ğ‘”
-BKS)/BKS reported as â€° values
to 0.7, ğœ‡ to 10, ğ‘–ğ‘¡ğ‘’ğ‘šğ‘ğ‘¥ to 1, ğ‘Ÿğ‘ğ‘¡ğ‘–ğ‘œğ‘ğ‘’ğ‘” to 0.5 and ğ‘Ÿğ‘ğ‘¡ğ‘–ğ‘œğ‘’ğ‘›ğ‘‘ to 0.2.

ğ‘¡ğ‘ğ‘£ğ‘”	Average run time of obtaining the best solutions in seconds
ğ´ğ‘£ğ‘’	Average ğºğ‘ğ‘ğ‘ğ‘’ğ‘ ğ‘¡ , ğºğ‘ğ‘ğ‘ğ‘£ğ‘” or ğ‘¡ğ‘ğ‘£ğ‘”
-	Corresponding value is not given in the literature






were selected to tune parameters. Note that similar statistics can be ob- served on the remaining instances. Because the local search procedure GATS and the path relinking operator are relatively independent, their parameters were tuned by applying GATS and GATS-PR to these in- stances, respectively. For each parameter, a default value and possible values were given. When tuning a parameter, other parameters were fixed to default values to avoid explosions in the number of parame- ter combinations. We first tuned GATS-related parameters and set their default values to the selected values when tuning path relinking-related parameters. Three independent runs were performed for the selected in- stances. In order to normalize the results of different instances, the sum
ğ‘†ğºğ‘ğ‘’ğ‘ ğ‘¡ of ğºğ‘ğ‘ğ‘ğ‘’ğ‘ ğ‘¡ of each selected instance is introduced. The parame-
ter value whose corresponding ğ‘†ğºğ‘ğ‘’ğ‘ ğ‘¡ is the minimum was selected as
Comparison of GATS-PR with the state-of-the-art algorithms

In Tables 4 and 5, the detailed experimental environment of the reference exact and metaheuristic algorithms are given, where column Name represents the name of the reference algorithms, column Num lists the number of independent runs, column CPU gives the compu- tational configuration, and column Score is the single-thread rating2 of each computational configuration. GATS-PR was implemented in
processor whose single-thread rating ğ‘ ğ‘ğ‘ğ‘ ğ‘–ğ‘ is 2635 MOps/Sec. All CPU C++11, built and executed on an Intel Core i3-10100 @ 3.60 GHz times reported in this section are multiplied by ğ‘ ğ‘ğ‘™ğ‘” âˆ•ğ‘ ğ‘ğ‘ğ‘ ğ‘–ğ‘ , where ğ‘ ğ‘ğ‘™ğ‘” is the single-thread rating of the CPU used by the algorithm ğ‘ğ‘™ğ‘”. For
GVTS-PR, each instance was independently tested three times with the time limit of one hour.
In terms of ğ‘¡ğ‘ğ‘£ğ‘” , the result of an algorithm is better than/worse
than/equal to that of GATS-PR when:
Its quality is not worse than/not better than/equal to that of GATS- PR. Because HGA, VTNS and MILS were run multiple times, we use

the final value of the parameter and it is indicated in bold in Tables 2
and 3.
ğ‘“ğ‘ğ‘£ğ‘”
as the evaluation criterion of the solution quality. For other

Five parameters are critical to the performance of GATS:

The number ğ›¿ of customers considered at each iteration. Its default value is 0.3 Ã— |ğ‘‰ ğ¶ |.
The combination of the lower and upper bounds ğ‘¤ğ‘šğ‘–ğ‘› and ğ‘¤ğ‘šğ‘ğ‘¥ of
neighborhood weights. Its default value is (1, 100).
The discount factor Î˜ of accumulative generalized objective func-
tion value improvement. Its default value is 0.7.
The convergence speed factor ğœ† of weights. Its default value is 0.05.
thresholds  ğ‘”ğ‘¡ğ‘šğ‘–ğ‘›  and  ğ‘”ğ‘¡ğ‘šğ‘ğ‘¥ .  Its  default  value  is  (0.05,  0.2). â€¢ The combination of the minimum and maximum granularity

ber ğ‘–ğ‘¡ğ‘’ğ‘¢ğ‘›ğ¼ ğ‘šğ‘ of the consecutive iterations without improvement reached The termination condition of the GATS procedure is that the num-
100 Ã— |ğ‘‰ ğ¶ |. The results of tuning GATS-related parameters are shown
reference algorithms except for TS, we use ğ‘“ğ‘ğ‘’ğ‘ ğ‘¡ because they were
in the literature, so we do not compare its ğ‘¡ğ‘ğ‘£ğ‘”  with ours. run only once. The computational configuration of TS is not given
Its ğ‘¡ğ‘ğ‘£ğ‘” is smaller than/larger than/equal to that of GATS-PR.
In Tables 6 and 7, results in column BKS with an asterisk indicate that they are the optimal solutions proved by [11] and [12]. Results
tained by GATS-PR. If ğ‘“ğ‘ğ‘’ğ‘ ğ‘¡ or ğ‘“ğ‘ğ‘£ğ‘” obtained by an algorithm is equal to with an underline indicate that they are new best known results ob- BKS, it is indicated in bold. If ğ‘“ğ‘ğ‘’ğ‘ ğ‘¡ , ğ‘“ğ‘ğ‘£ğ‘” or ğ‘¡ğ‘ğ‘£ğ‘” obtained by an algorithm
is better than that of GATS-PR, it is shown in italics. Rows Better, Equal
and Worse represent the number of results whose ğ‘“ğ‘ğ‘’ğ‘ ğ‘¡ , ğ‘“ğ‘ğ‘£ğ‘” or ğ‘¡ğ‘ğ‘£ğ‘” is
better than, equal to or worse than that of GATS-PR, respectively.
Table 6 presents ğ‘“ğ‘ğ‘’ğ‘ ğ‘¡ and ğ‘¡ğ‘ğ‘£ğ‘” of GATS-PR and the state-of-the-art
exact algorithms. Except for controversial results produced by IMIP on
instance p15 and Model on instance pr02, ğ‘“  obtained by GATS-PR

in Table 2. According to ğ‘†ğºğ‘ğ‘’ğ‘ ğ‘¡
, we set ğ›¿ to 0.5 Ã— |ğ‘‰ ğ¶ |, ğ‘¤
ğ‘šğ‘–ğ‘›
to 1, ğ‘¤
ğ‘šğ‘ğ‘¥
ğ‘ğ‘’ğ‘ ğ‘¡

to 50, Î˜ to 0.9, ğœ† to 0.1, ğ‘”ğ‘¡ğ‘šğ‘–ğ‘› to 0.05 and ğ‘”ğ‘¡ğ‘šğ‘ğ‘¥ to 0.2.		
There are four key parameters for the path relinking operator:	2 https://www.passmark.com/.


Table 2
The results of the selected instances to tune GATS-related parameters.



Table 3
The results of the selected instances to tune path relinking-related parameters.



is not worse than that of the state-of-the-art exact algorithms on all the instances. Specifically, GATS-PR improved BKS on four instances
p09, p10, p11 and pr05. In terms of average ğºğ‘ğ‘ğ‘ğ‘’ğ‘ ğ‘¡ and ğ‘¡ğ‘ğ‘£ğ‘” , GATS-PR
obtains significantly better results than the reference algorithms in less
than 30% run time of Model, which is the most eï¬ƒcient exact algorithm among the reference algorithms. Hence, GATS-PR outperforms these state-of-the-art exact algorithms.
Tables 7 and 8 report ğ‘“ğ‘ğ‘’ğ‘ ğ‘¡ , ğ‘“ğ‘ğ‘£ğ‘” and ğ‘¡ğ‘ğ‘£ğ‘” of GATS-PR and the state-
of-the-art metaheuristic algorithms.

In terms of ğ‘“ğ‘ğ‘’ğ‘ ğ‘¡ , MNS-TS obtains 6 worse solutions than GATS-PR and its average ğºğ‘ğ‘ğ‘ğ‘’ğ‘ ğ‘¡ (i.e. 0.43) is worse than that of GATS-PR
on instances p12, p15 and p18, GATS-PR obtains better ğ‘“ğ‘ğ‘’ğ‘ ğ‘¡ than (i.e. -0.60). Except for controversial results produced by MNS-TS


Table 4
Experimental environment of the state-of-the-art exact algo- rithms.


Table 5
Experimental environment of the state-of-the-art heuristic algorithms.



Table 6
The comparison of the solution quality of GATS-PR and the state-of-the-art exact algorithms.

1 The same author reported that the objective function value of the optimal solution on p15 is 1885.81 in the subsequent paper [11].
2 The objective function value of the optimal solution on pr02 is proved to be 979.82 in [11] and [16].


HGA, MNS-TS, MBILSA, MILS and TS on all the instances and the values of Worse exceed 15 for these algorithms. It indicates that GATS-PR obtains more high-quality solutions than the state-of-the- art metaheuristic algorithms.
In terms of ğ‘“ğ‘ğ‘£ğ‘” , GATS-PR obtains significantly better results than
HGA and VTNS in terms of average ğºğ‘ğ‘ğ‘ğ‘£ğ‘” . Specifically, not only
our ğ‘“ğ‘ğ‘£ğ‘” on these instances was better than BKS. Although VTNS we improved BKS on instances p09, p10, p11 and pr05, but also
terms of ğ‘“ğ‘ğ‘’ğ‘ ğ‘¡ , its ğ‘“ğ‘ğ‘£ğ‘” (i.e. 3036.02) is significantly worse than that obtains a slightly better solution than GATS-PR on instance p08 in
of GATS-PR (i.e. 2778.26). It indicates that GATS-PR can obtain high-quality solutions frequently and GATS-PR is quite robust.
In terms of ğ‘¡ğ‘ğ‘£ğ‘” , no reference algorithms can obtain better results in
less time than GATS-PR. The values of Worse are 16, 8, 15, 16 and 13 for HGA, MNS-TS, MBILSA, VTNS and MILS. It shows that GATS- PR is more eï¬ƒcient than them. Although GATS-PR spends a lot of time on large-scale instances, such as p08 and p10, it indicates that GATS-PR has better search capability than the reference algorithms because GATS-PR can obtain better results than them.


Table 7
The comparison of the results of GATS-PR and the state-of-the-art metaheuristic algorithms.

1 These two values are probably recorded in reverse in [8].
2 The results are better than the optimal ones proved by [10] and [11].
3 We round the results in [12] because results in other literature are only retained to two decimal places.
4 The value is missing because TS cannot obtain feasible solutions on a lot of instances.





Table 8
The comparison of ğ‘¡ğ‘ğ‘£ğ‘” of GATS-PR and the state-of-the-art metaheuristic
algorithms.



	

Fig. 4. Evolution process of ğ‘“ğ‘ğ‘’ğ‘ ğ‘¡ for GATS-PR, No-PR, No-Gra and No-Tabu over time on a logarithmic scale.


These comparisons demonstrate that GATS-PR outperforms these state- of-the-art metaheuristic algorithms for solving the MDOVRP.

Importance analysis of algorithmic components

In order to analyze the importance of the proposed algorithmic com- ponents, we disable one of them from GATS-PR at a time and compare the results obtained by the variant algorithm with those of GATS-PR. The No-PR version only uses the granular adaptive tabu search pre- sented in Algorithm 2 to verify the effectiveness of path relinking. The
number of neighboring nodes of a given customer by setting both ğ‘”ğ‘¡ğ‘šğ‘–ğ‘› No-Gra version disables granular neighborhoods, which considers fixed and ğ‘”ğ‘¡ğ‘šğ‘ğ‘¥ to 0.2. The No-Tabu version chooses the move with the best
improvement of the generalized function value at each iteration to val- idate the role of the solution-based tabu search. The No-ANS version does not use the adaptive neighborhood selection (ANS) but considers all the move types described in Fig. 2 at each iteration. The No-Group version regards each move type as a neighborhood to verify the effec- tiveness of grouping move types into four neighborhoods in ANS.
For GATS-PR and its variants, each instance was independently run three times and the time limit was one hour. The results of these algo- rithms are shown in Table 9. Although No-Tabu converges quickly, its results are significantly worse than those of GATS-PR. It indicates that the solution-based tabu search enables the search to escape from the local optima. GATS-PR obtains better results with less run time than No-PR and No-Gra. It demonstrates that path relinking and granular neighborhoods can improve the search eï¬ƒciency without sacrificing the solution quality. No-Group obtains better solutions than No-ANS with less run time and GATS-PR obtains better solutions than No-Group with less time. It demonstrates that ANS can improve eï¬ƒciency and ef- fectiveness of the search and grouping multiple move types into one neighborhood contributes to ANS when the number of move types is large. Therefore, all these algorithmic components are important for GATS-PR.
variants, Figs. 4 and 5 plot the evolution process of ğ‘“ğ‘ğ‘’ğ‘ ğ‘¡ obtained by In order to intuitively show the convergence of GATS-PR and its
each algorithm on four representative instances p08, p09, pr05 and pr10 over time on a logarithmic scale. As shown in Figs. 4 and 5, we observe that:

Although GATS-PR obtains slightly worse solutions than No-PR and No-Tabu at the early stage of the search, GATS-PR outperforms them on instances p08 and p09, and match them on instances pr05 and pr10 at the end of the search. It indicates that GATS-PR con- verges slightly slower than No-PR and No-Tabu but it has a better search capability.
After excluding solutions obtained at the earliest stage of the search which are heavily influenced by initial solutions and with cer- tain randomness, GATS-PR outperforms No-Gra on the selected instances. It shows that the granular neighborhoods can improve the eï¬ƒciency of the search without sacrificing the solution quality.
After excluding solutions obtained at the earliest stage of the search, GATS-PR always outperforms No-ANS on these four in- stances. Although No-Group obtains better solutions than GATS- PR at the middle stage of the search on instance pr05, it obtains worse solutions at the end of the search. On other three instances, No-Group is outperformed by GATS-PR. These observations demon- strate the importance of ANS again.

To further explore the effectiveness of ANS on the neighborhood se- lection mechanism, we record the frequency of performing each move type when the best solution is obtained by No-ANS, No-Group and
GATS-PR, respectively. Let ğ‘Ÿğ‘–, ğ‘– âˆˆ ğ‘ represent the ratio of the number
of chosen move types that belong to neighborhood ğ‘– to the total num- ber of iterations. Fig. 6 presents ğ‘Ÿğ‘– of these three algorithms on all the
instances.








Table 9
Results of the GATS-PR and its variants.



	

Fig. 5. Evolution process of ğ‘“ğ‘ğ‘’ğ‘ ğ‘¡ for GATS-PR, No-ANS and No-Group over time on a logarithmic scale.


For No-ANS, ğ‘Ÿğ‘1 exceeds 50% on 19 out of 24 instances and it ex- ceeds 70% on 10 ones. For GATS-PR, although ğ‘1 is also the most frequently performed neighborhood except for instance p02, ğ‘Ÿğ‘1
is only about 45%. Because GATS-PR obtains better solutions than No-ANS, it indicates that ANS diversifies the search at the suitable
time by selecting neighborhoods ğ‘3 and ğ‘4 more frequently than
No-ANS to help the search to escape from the local optima.
For No-Group, the sum of ğ‘Ÿğ‘1 and ğ‘Ÿğ‘2 exceeds 45% on 12 out of
24 instances and it is below 50% on all the instances. However, it
exceeds 50% on 19 out of 24 instances for GATS-PR. Because GATS- PR obtains better solutions than No-Group, it indicates that when the number of move types is large, grouping multiple move types into one neighborhood intensifies the search and thus enhances the search capability.


6. Conclusion and future research

In this paper, we propose the GATS-PR algorithm which hybridizes granular neighborhoods, adaptive neighborhood selection and solution- based tabu search with path relinking to solve the MDOVRP. This is the first time that path relinking is used for the MDOVRP to the best of our knowledge and a new similarity definition is designed for this prob- lem. We develop the adaptive neighborhood selection strategy to select suitable move types from a total of 22 ones and exclude unpromising neighborhood solutions by the granular neighborhoods. By forbidding accessing visited solutions, the solution-based tabu search can further enhance diversification of the search.
GATS-PR improved and matched the previous best known results on 4 and 19 out of 24 instances, respectively. By comparing the results obtained by GATS-PR with those of the state-of-the-art algorithms, we can observe that GATS-PR outperforms them for solving the MDOVRP. Importance analysis of the proposed algorithmic components demon- strates that granular neighborhoods, adaptive neighborhood selection,
solution-based tabu search and path relinking all play essential roles in obtaining high-quality solutions eï¬ƒciently.
In future research, we intend to apply GATS-PR to other VRP-related problems, such as the multi-depot VRP and the multi-depot green VRP. The advanced population management mechanism is another topic that deserves to be investigated. We are also going to design other similarity definitions between solutions and integrate them to improve the search capability of path relinking to solve the MDOVRP.

CRediT authorship contribution statement

Wenhan Shao: Investigation, Conceptualization, Methodology, Data collection, Software, Validation, Visualization, Writing â€“ origi- nal draft, Writing â€“ review and editing. Tuanyue Xiao: Investigation, Methodology, Data collection, Software, Validation, Writing â€“ original draft, Writing â€“ review and editing. Zhouxing Su: Conceptualization, Methodology, Writing â€“ review and editing, Funding acquisition. Jun- wen Ding: Conceptualization, Methodology, Writing â€“ review and edit- ing, Supervision, Project administration, Funding acquisition. Zhipeng LÃ¼: Conceptualization, Methodology, Writing â€“ review and editing, Funding acquisition.

Declaration of competing interest

The authors declare that there is no competing interest.

Acknowledgements

This work was supported in part by the National Natural Science Foundation of China (NSFC) under Grants 72101094 and 62202192, and the Special Project for Knowledge Innovation of Hubei Province under Grant 2022013301015175.

























































Fig. 6. Statistics on the ratios of the neighborhood selection of No-ANS, No-Group and GATS-PR.

References

Dantzig GB, Ramser JH. The truck dispatching problem. Manag Sci 1959;6(1):80â€“91.
Xidias E, Zacharia P, Nearchou A. Intelligent fleet management of autonomous ve- hicles for city logistics. Appl Intell 2022;52(15):18030â€“48.
Zou G, Tang J, Yilmaz L, Kong X. Online food ordering delivery strategies based on deep reinforcement learning. Appl Intell 2022;52(6):6853â€“65.
Alitappeh RJ, Jeddisaravi K. Multi-robot exploration in task allocation problem. Appl Intell 2022;52(2):2189â€“211.
Kaabi J, Harrath Y, Mahjoub A, Hewahi N, Abdulsattar K. A 2-phase approach for planning of hazardous waste collection using an unmanned aerial vehicle. 4OR Nov. 2022.
Vidal T, Crainic TG, Gendreau M, Lahrichi N, Rei W. A hybrid genetic algorithm for multidepot and periodic vehicle routing problems. Oper Res 2012;60(3):611â€“24.
Tarantilis CD, Kiranoudis CT. Distribution of fresh meat. J Food Eng 2002;51(1):85â€“91.
Liu R, Jiang Z, Geng N. A hybrid genetic algorithm for the multi-depot open vehicle routing problem. OR Spektrum 2014;36(2):401â€“21.
Garey MR, Johnson DS. Computers and intractability: a guide to the theory of NP- completeness. USA: W. H. Freeman & Co.; 1990.
Granada M, Toro EM, Gallego R. An MIP formulation for the open location-routing problem considering the topological characteristic of the solution-paths. Networks 2019;74(4):374â€“88.
Lalla-Ruiz E, Mes M. Mathematical formulations and improvements for the multi- depot open vehicle routing problem. Optim Lett 2021;15(1):271â€“86.
Nucamendi-GuillÃ©n S, Padilla AG, Olivares-Benitez E, Moreno-Vega JM. The multi- depot open location routing problem with a heterogeneous fixed fleet. Expert Syst Appl 2021;165:113846.
Lambert M, Hassani R. Diesel genset optimization in remote microgrids. Appl Energy 2023;340:121036.
Xiong Z, Zhao M, Tan L, Cai L. Real-time power optimization for application server clusters based on mixed-integer programming. Future Gener Comput Syst 2022;137:260â€“73.
Vardhan BVS, Khedkar M, Srivastava I. Effective energy management and cost effec- tive day ahead scheduling for distribution system with dynamic market participants. Sustain Energy Grids Netw 2022;31:100706.
Lalla-Ruiz E, ExpÃ³sito-Izquierdo C, Taheripour S, VoÃŸ S. An improved formulation for the multi-depot open vehicle routing problem. OR Spektrum 2016;38(1):175â€“87.
Wang H, Li R, Gong W. Minimizing tardiness and makespan for distributed het- erogeneous unrelated parallel machine scheduling by knowledge and Pareto-based memetic algorithm. Egypt Inform J 2023;24(3):100383.
Cui Z, Li B, Lan Z, Xu Y. Many-objective evolutionary algorithm based on three-way decision. Egypt Inform J 2023;24(3):100388.
Zakaryia SA, Ahmed SA, Hussein MK. Evolutionary oï¬„oading in an edge environ- ment. Egypt Inform J 2021;22(3):257â€“67.
Utamima A. A comparative study of hybrid estimation distribution algorithms in solving the facility layout problem. Egypt Inform J 2021;22(4):505â€“13.
Lin A, Li S, Liu R. Mutual learning differential particle swarm optimization. Egypt Inform J 2022;23(3):469â€“81.
Chen W-N, Tan D-Z. Set-based discrete particle swarm optimization and its applica- tions: a survey. Front Comput Sci 2018;12(2):203â€“16.
Yang W, Ke L. An improved fireworks algorithm for the capacitated vehicle routing problem. Front Comput Sci 2019;13(3):552â€“64.
Liu G, Guo W, Li R, Niu Y, Chen G. XGRouter: high-quality global router in X- architecture with particle swarm optimization. Front Comput Sci 2015;9(4):576â€“94.
Liu S, Huang W, Ma H. An effective genetic algorithm for the fleet size and mix vehicle routing problems. Transp Res, Part E, Logist Transp Rev 2009;45(3):434â€“45.
Soto M, Sevaux M, Rossi A, Reinholz A. Multiple neighborhood search, tabu search and ejection chains for the multi-depot open vehicle routing problem. Comput Ind Eng 2017;107:211â€“22.
BrandÃ£o J. A memory-based iterated local search algorithm for the multi-depot open vehicle routing problem. Eur J Oper Res 2020;284(2):559â€“71.
Sadati MEH, Ã‡atay B, Aksen D. An eï¬ƒcient variable neighborhood search with tabu shaking for a class of multi-depot vehicle routing problems. Comput Oper Res 2021;133:105269.
Abdzadeh B, Noori S, Ghannadpour SF. Simultaneous scheduling of multiple con- struction projects considering supplier selection and material transportation routing. Autom Constr 2022;140:104336.
Toth P, Vigo D. The granular tabu search and its application to the vehicle-routing problem. INFORMS J Comput 2003;15(4):333â€“46.
Glover F. Future paths for integer programming and links to artificial intelligence. Comput Oper Res 1986;13(5):533â€“49.
Escobar JW, Linfati R, Baldoquin MG, Toth P. A granular variable tabu neigh- borhood search for the capacitated location-routing problem. Transp Res, Part B, Methodol 2014;67:344â€“56.
Schneider M, Schwahn F, Vigo D. Designing granular solution methods for routing problems with time windows. Eur J Oper Res 2017;263(2):493â€“509.
Shahmanzari M, Aksen D. A multi-start granular skewed variable neighborhood tabu search for the roaming salesman problem. Appl Soft Comput 2021;102:107024.
MÃ¡ximo VR, Nascimento MCV. A hybrid adaptive iterated local search with di- versification control to the capacitated vehicle routing problem. Eur J Oper Res 2021;294(3):1108â€“19.
SÃ¶rensen K, Schittekat P. Statistical analysis of distance-based path relinking for the capacitated vehicle routing problem. Comput Oper Res 2013;40(12):3197â€“205.
Schneider M, LÃ¶ï¬„er M. Large composite neighborhoods for the capacitated location- routing problem. Transp Sci 2019;53(1):301â€“18.
