Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 346 (2019) 275–283
www.elsevier.com/locate/entcs
Algebras, Graphs and Thetas
Marcel K. de Carli Silva1
Dept. of Computer Science University of Sa˜o Paulo S˜ao Paulo, Brazil

Gabriel Coutinho
Dept. of Computer Science Federal University of Minas Gerais
Belo Horizonte, Brazil

Chris Godsil2
Dept. of Combinatorics and Optimization University of Waterloo
Waterloo, Canada

David E. Roberson
Dept. of Applied Mathematics and Computer Science Technical University of Denmark
Kongens Lyngby, Denmark


Abstract
We extend the clique-coclique inequality, previously known to hold for graphs in association schemes and vertex-transitive graphs, to graphs in homogeneous coherent configurations and 1-walk regular graphs. We further generalize it to a stronger inequality involving the Lova´sz theta number of such graph, and some theta variants, including characterizations of the equality.
Keywords: clique-coclique inequality, matrix ∗-algebra, Lov´asz theta function, coherent configuration



1 Email: mksilva@ime.usp.br. This work was partially supported by Conselho Nacional de Desenvolvi- mento Cient´ıfico e Tecnol´ogico – CNPq (Proc. 423833/2018-9, 456792/2014-7, and 477203/2012-4).
2 C. Godsil gratefully acknowledges the support of the Natural Sciences and Engineering Council of Canada (NSERC), Grant No. RGPIN-9439.

https://doi.org/10.1016/j.entcs.2019.08.025
1571-0661/© 2019 The Author(s). Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

Introduction
Denote the maximum size of a clique in a graph G by ω(G) and the maximum size of a coclique by α(G); a coclique is an independent set of vertices, also called a stable set.
Think of a graph with a large clique and a large coclique. In general, there seems to be no (non-obvious) restriction on how large these two substructures can be compared to the size of the graph. However, if the graph displays high regularity or symmetry, then one soon finds out that large cliques cannot appear together with large cocliques, and vice-versa. More specifically, for a graph G on n vertices that is either distance-regular or vertex-transitive, we have α(G)ω(G) ≤ n. This is known as the clique-coclique bound; see for instance [8, Chapter 3]. In this paper, we observe that a more general framework in which these graphs and their cliques and cocliques can be cast is sufficient to prove the clique-coclique bound. This appears in Theorems 3.1 and 3.2, and Corollary 4.1.
Our setting also allows for an extension of this inequality to a stronger inequality (which turns out to be an equality) involving the Lov´asz theta number of a graph and its complement, and another equality for some theta variants. This is found in Corollary 4.2. These results were known for vertex-transitive graphs only, therefore our contribution significantly increases the number of known graphs satisfying the properties displayed.
Some work has been done in the past in topics strongly related to the topic of this paper. Godsil and Meagher [8] present a full account of known bounds for the size of cliques and cocliques in graphs belonging to association schemes. Dukanovic and Rendl [7] proved some equalities involving generalizations of thetas for a vertex- transitive graph and its complement. Roberson [14] pointed that we could somehow relax the requirement of the graph being vertex-transitive. Some of the results in our paper work in the direction of finding exactly which graphs satisfy this relaxed condition. The use of positive semidefiniteness to find bounds in combinatorial structures dates back to Delsarte’s thesis [6]. It was revived more recently by Schrijver [16] in the context of coding theory and later applied to some coherent configurations by Hobart [11] and Hobart and Williford [12]. Some surveys can be found in [1]. In all cases, the main tool is the fact that the projection of a positive semidefinite matrix in certain algebras of matrices remains positive semidefinite. We explore this fact in Lemmas 2.5 and 2.6 to build our theoretical framework.

Algebras
Equip the complex vector space Mn(C) of complex n × n matrices with the trace inner-product ⟨M, N⟩ = tr MN∗. We will work on matrix ∗-algebras, which means a linear subspace of Cn×n that is closed under the conventional matrix product and under taking the conjugate transpose. A matrix ∗-algebra is simple if it has no non-trivial proper (two-sided) ideal. We start with the following consequence of Wedderburn’s Theorem on semisimple algebras ([5, Chapter 5]); see for instance [3,

Theorem 2.7] for a more self-contained version, or [2, Chapter 1].
Theorem 2.1 If A is a matrix ∗-algebra, then A is the direct sum of simple matrix
∗-algebras
s
A =	EiA,	(1)
i=0
where {E0,..., Es} is an orthogonal basis of minimal idempotents of the center of
A.
Here we rely on the fact [1, Theorem 9.3] that every commutative matrix ∗- algebra B has an orthogonal basis of matrices E0,..., Es such that E∗ = Ei and E2 = Ei for each i and EiEj = 0 whenever i /= j; such matrices are called minimal idempotents of B.
Given a matrix M , we will use M∗ to denote the orthogonal projection of M onto A. Because of the decomposition from above, it follows that M∗ is the sum of the projections of M onto each EiA. The following fact is also well-known, see for instance [1, Corollary 9.1].
Corollary 2.2 The projection of a positive semideﬁnite matrix onto a matrix ∗- algebra is positive semideﬁnite.
From here on, we assume all matrices in A have constant diagonal. This property shall be referred as A being homogeneous.
Lemma 2.3 If A is a homogeneous matrix ∗-algebra, then all 01 matrices in A
have constant row sums and constant column sums.
Moreover, if A contains an irreducible 01 matrix, then the all 1s matrix J belongs to A.
Finally, if A contains the all 1s matrix J, then the row sums and the column sums of all matrices in A are equal, that is, J lies in the center of A.
Proof. Let A ∈ A be a 01 matrix. Then A∗ ∈ A, and so AA∗ ∈ A and A∗A ∈ A. The diagonal entries of AA∗ are the row sums of A, and the diagonal entries of A∗A are the column sums of A. Because A is homogeneous, all row sums are equal, and the same holds for column sums. Now if A is irreducible, and because its row sums are constant, then by Perron-Frobenius theory the all 1s vector is an eigenvector in a 1-dimensional subspace, and therefore J is a polynomial in A, hence it belongs to A. The result now follows from noting that, for all M ∈ A, the diagonal entries of MJ and JM are, respectively, the row sums and column sums of M . These are constant diagonals, and because tr MJ = tr JM , it follows that these diagonal are, in fact, equal.	2
As M '→ M∗ is a self-adjoint operator, it follows that
⟨M, N∗⟩ = ⟨M∗,N⟩,
a fact that we exploit below for two special cases.

Lemma 2.4 Let M be a matrix, and let A be a homogeneous matrix ∗-algebra that contains I and J. Then


and
tr M∗ = tr M,

tr JM∗ = tr JM.

Proof. Since I and J belong to A, we have I∗ = I and J∗ = J. Thus, tr M∗ =
⟨M∗,I⟩ = ⟨M, I∗⟩ = tr M and tr JM∗ = tr M∗J = ⟨M∗,J⟩ = ⟨M, J∗⟩ = tr MJ = tr JM .	2
We show below how to obtain a trace inequality in a special but useful case.
Lemma 2.5 Let A be a homogeneous matrix ∗-algebra that contains I. Let M and N be positive semideﬁnite n × n matrices. Let I = P0, P1,..., Pd be an orthogonal basis for the algebra A. Assume that, for all i /= 0, ⟨M, Pi⟩⟨Pi,N⟩≤ 0. Then
⟨M∗,N∗⟩≤ (tr M )(tr N ) .
n
Moreover, equality holds if and only if, for all i /= 0, ⟨M, Pi⟩⟨Pi,N⟩ = 0.
Proof. It is a straightforward computation:


⟨M∗,N∗⟩ = ⟨M∗,N⟩ = tr
 Σd

⟨M, Pi⟩
i	N

i=0 ⟨Pi, Pi⟩
d
= Σ ⟨M, Pi⟩⟨Pi,N⟩

⟨M, I⟩⟨I, N⟩
≤
⟨I, I⟩
(tr M )(tr N )
=	.
n
The equality characterization follows immediately.	2
Lemma 2.6 Let A be a homogeneous matrix ∗-algebra that contains I and J. Let
M and N be positive semideﬁnite n × n matrices. Then
⟨M∗,N∗⟩≥ (tr JM )(tr JN ) .
n2
Moreover, equality holds if and only if M∗N∗ is a scalar multiple of J.
Proof. By Lemma 2.3 the all 1s vector is an eigenvector of all matrices in A, and
J lies in the center of A. Write A =  s	EiA as in Theorem 2.1. Then EiJ /=0 
for precisely one index i: if EiJ = λiJ and EjJ = λjJ with λi /= 0 /= λj, then EiEjJ = λiλjJ which implies i = j since E0,..., Es are minimal idempotents. We may assume that E0J /= 0. Since CJ is an ideal of the simple matrix ∗-algebra E0A, we find that E0A = CJ and so we may assume that E0 = J.

Let Mi denote the projection of M onto each EiA from Theorem 2.1, and simi- larly for N and Ni. Then
s	s
M∗ = Σ Mi	and	N∗ = Σ Ni,

and the matrices Mi and Ni are positive semidefinite by Corollary 2.2. Moreover, the orthogonality of the decomposition implies that
s
M∗N∗ =	MiNi.
i=0
Recall that the trace of the product of positive semidefinite matrices is non-negative. Therefore

tr M∗N∗ = Σ tr MiNi
≥ tr M0N0
(tr JM)(tr JN)
=	n2	.

i=0
Equality holds if and only if MiNi = 0 for all i /= 0, which is equivalent to M∗N∗
being a scalar multiple of J.	2
Denote the Schur (componentwise) product of matrices B and C by B ◦ C. In what follows, we will typically consider positive semidefinite matrices M and N , that with respect to the adjacency matrix A of a graph G and the adjacency matrix A = J − I − A of the complement G, satisfy either of the following two conditions:
M ◦ A = 0 and N ◦ A = 0,	(A)
M ◦ A ≤ 0, N ◦ A = 0 and N ◦ A ≥ 0.	(B)
Graphs
We now show two classes of examples of matrix ∗-algebras satisfying the properties of the lemmas above.

Homogeneous coherent conﬁgurations
A coherent conﬁguration is a finite set of non-zero 01 matrices {A0,	, Ad}, which
satisfies the following properties:
Σd	Ai = J.
For all i ∈ {0, ..., d}, if one diagonal entry of Ai is non-zero, then Ai is diagonal.
The configuration is transpose-closed.
AiAj is a linear combination of the matrices in the configuration, for all i and
j.
Coherent configurations appear naturally in connection to design theory, finite ge- ometry, coding theory and representation of finite groups. They were originally

defined by Higman in [10]. When the identity matrix is one of the matrices form- ing the configuration, we call such configuration homogeneous. When the matrices forming the configuration commute, they result in what is known as an association scheme. The theory of association schemes is vast and rich, and the connections to combinatorics are overwhelming; see for instance [4].
From here on, we assume {I = A0,..., Ad} is a homogeneous coherent config- uration. These matrices generate a complex algebra, called the coherent algebra, which we denote by A. Note that this algebra is a homogeneous matrix ∗-algebra that contains I and J.
A graph belongs to a coherent configuration if its adjacency matrix is a sum of the matrices forming the configuration. The so-called distance-regular graphs are standard examples of graphs found in (and generating) association schemes. Another class of examples comes from vertex-transitive graphs — the permuta- tion matrices corresponding to the automorphisms of the graph form a group, and its commutant in Mn(C), which contains the adjacency matrix of the graph, is a homogeneous coherent algebra.
If A is the adjacency matrix of a graph and belongs to a homogeneous coherent algebra generated by the configuration {I = A0,..., Ad}, it follows that, for some R ⊆ {1,..., d}, we have


As a consequence,
A =	Ar.
r∈R

A =	Ar,

r∈R



where R = {1,..., d}\ R. Moreover, if A∗ = Ar∗ , then r ∈ R implies r∗ ∈ R.
Therefore if M and N are positive semidefinite matrices satisfying either of the conditions (A) and (B), then it follows that ⟨M, Ar⟩⟨Ar,N⟩ ≤ 0 for all r ∈
{1,..., d}, and thus M , N , A and its basis {A0,..., Ad} satisfy the conditions of Lemma 2.5.
Applying Lemmas 2.3, 2.5 and 2.6, we have the result below.
Theorem 3.1 Let A be the adjacency matrix of a connected graph that belongs to a homogeneous coherent conﬁguration {I = A0,..., Ad}. Let M and N be non-zero positive semideﬁnite matrices satisfying conditions (A) or (B). Then
(tr JM )(tr JN )
n ≥	.
(tr M )(tr N )
Moreover, equality holds if and only if M∗N∗ is a scalar multiple of J, and either
(A) holds or (B) holds in such way that ⟨M, Ar⟩⟨Ar,N⟩ =0 for all r /= 0.

1-walk regular graphs (and their complements)
A graph G with adjacency matrix A is called 1-walk regular if, for any positive integer k, Ak is constant in the diagonal and in the entries corresponding to the

support of A. That is, for any positive integer k, there are constants ak and bk such that
Ak ◦ I = akI	and	Ak ◦ A = bkA.
Assume G is 1-walk regular, and A is its adjacency matrix. Note for instance that G must be regular, as the diagonal of A2 is constant. Let A be the algebra generated by A and I — that is, the adjacency algebra of the graph G. This is obviously a matrix ∗-algebra. In fact, it is an algebra of symmetric and commuting matrices, therefore the decomposition of Rn into A-modules is simply its simulta- neous diagonalization.
Consider an orthogonal basis I = A0,A = A1, A2,..., Ad. For instance, this could have been obtained by applying Gram-Schmidt to I, A, A2,..., Ad. The rel- evant consequence of 1-walk regularity is that Ak ◦ I = 0 and Ak ◦ A = 0 for all k ≥ 2, as the basis is orthogonal and all matrices of A are constant over the support of I and A.
Now let M and N be positive semidefinite matrices, and assume that (A) or
(B) holds. Then ⟨M, Ak⟩⟨Ak,N⟩ ≤ 0 for all k ≥ 1. Thus M , N , A and its basis
{A0,..., Ad} satisfy the conditions of Lemmas 2.5 and 2.6, therefore we have the following theorem.
Theorem 3.2 Let A be the adjacency matrix of a 1-walk regular graph. Let M and N be non-zero positive semideﬁnite matrices satisfying conditions (A) or (B) above. Then
(tr JM )(tr JN )
n ≥	.
(tr M )(tr N )
Moreover, equality holds if and only if M∗N∗ is a scalar multiple of J, and either
(A) holds or (B) holds in such way that ⟨M, Ar⟩⟨Ar,N⟩ = 0 for all r /= 0, where
I = A0,A = A1, A2,..., Ad is an orthogonal basis of the adjacency algebra of G.
Thetas
The immediate corollaries to Theorems 3.1 and 3.2 are the so-called clique-coclique bounds. Assume S is a clique and T is a coclique in a graph which is either in a homogeneous coherent configuration or is 1-walk regular. Let χS and χT be their respective characteristic vectors, and define


N = χS  ∗
and	M = χT
χ∗ .



It follows that M ◦ A = 0 and N ◦ A = 0. Thus Theorem 3.1 or Theorem 3.2 applies, and we obtain the following result, which has been stated before for graphs in association schemes or vertex-transitive graphs (see for instance [8, Theorem 3.8.4]).
Corollary 4.1 Assume S is a clique and T is a coclique in a graph on n vertices which is either in a homogeneous coherent conﬁguration or is 1-walk regular. Then
|S||T|≤ n.

Proof. The inequality is immediate from Theorem 3.1 or Theorem 3.2.	2
The conditions on M and N being positive semidefinite and satisfying either (A) or (B) allow for a nice extension of this result. We write X < 0 if X is a positive semidefinite matrix. The Lova´sz theta graph parameter ϑ(G) is defined (see [13]) as the optimum value of the following semidefinite program:
ϑ(G)= max {⟨J, X⟩ : X ◦ A = 0, tr X = 1, X < 0}.

Upon making small variations in the formulations, one obtains, respectively, the Schrijver theta [15] and the Szegedy theta [17] functions:
ϑ−(G)= max {⟨J, X⟩ : X ◦ A = 0, tr X = 1, X ≥ 0, X < 0}.
ϑ+(G)= max {⟨J, X⟩ : X ◦ A ≤ 0, tr X = 1, X < 0}.
It is known since the first respective appearances of these thetas that, for all graphs
G on n vertices, we have

α(G) ≤ ϑ−(G) ≤ ϑ(G) ≤ ϑ+(G) ≤ χ(G),	(2) where χ(G) is the chromatic number of G; and that
ϑ(G)ϑ(G) ≥ n	and	ϑ−(G)ϑ+(G) ≥ n,	(3)
with equality in both cases of (3) for vertex-transitive graphs.
The results in this paper extend the equality case in (3) for graphs in homoge- neous coherent configurations and 1-walk regular graphs.
Corollary 4.2 Let G be graph on n vertices that belongs to a homogeneous coherent conﬁguration or that is 1-walk regular. Then

ϑ(G)ϑ(G)= n	and	ϑ−(G)ϑ+(G)= n.
Proof. Let M and N be positive semidefinite matrices that are optimal solutions for ϑ(G) and ϑ(G), respectively. They satisfy condition (A), and therefore Theorem
3.1 or 3.2 applies. Thus n ≥ ϑ(G)ϑ(G), and then (3) shows that equality holds. The same conclusion can be reached for matrices N and M which are respective optimal solutions for ϑ−(G) and ϑ+(G), by noting that they satisfy condition (B).2

Corollary 4.2 implies that, if M and N are optima for ϑ(G) and ϑ(G), or for ϑ−(G) and ϑ+(G), with G 1-walk regular or in a homogeneous coherent configura- tion, then the equality characterizations from Lemmas 2.5 and 2.6 hold.
It is interesting to consider if the tools and the framework we developed may be used to strengthen similar inequalities involving other variants of theta, such as the ones in [7] and in [14], and also for other hierarchies of semidefinite programs (see, e.g., [9]).

References
Anjos, M. F. and J. B. Lasserre, editors, “Handbook on Semidefinite, Conic and Polynomial Optimization,” International Series in Operations Research & Management Science 166, Springer US, Boston, MA, 2012.
URL  http://link.springer.com/10.1007/978-1-4614-0769-0
Arveson, W., 39, Springer Science & Business Media, 2012.
Bachoc, C., D. C. Gijswijt, A. Schrijver and F. Vallentin, Invariant semidefinite programs, in: Handbook on semidefinite, conic and polynomial optimization, Internat. Ser. Oper. Res. Management Sci. 166, Springer, New York, 2012 pp. 219–269.
URL  https://doi.org/10.1007/978-1-4614-0769-0_9

Brouwer, A. E., A. M. Cohen and A. Neumaier, “Distance-Regular Graphs,” Springer-Verlag, Berlin, 1989, xviii+495 pp.
Cohn, P. M., “Basic algebra: groups, rings and fields,” Springer Science & Business Media, 2012.
Delsarte, P., “An algebraic approach to the association schemes of coding theory,” Ph.D. thesis, Universit´e Catholique de Louvain (1973).
Dukanovic, I. and F. Rendl, Copositive programming motivated bounds on the stability and the chromatic numbers, Math. Program. 121 (2010), pp. 249–268.
URL  https://doi.org/10.1007/s10107-008-0233-x

Godsil, C. and K. Meagher, “Erd˝os-Ko-Rado theorems: algebraic approaches,” Cambridge Studies in Advanced Mathematics 149, Cambridge University Press, Cambridge, 2016, xvi+335 pp.
URL https://doi.org/10.1017/CBO9781316414958
Gvozdenovi´c, N. and M. Laurent, The operator Ψ for the chromatic number of a graph, SIAM J. Optim.
19 (2008), pp. 572–591.
URL https://doi.org/10.1137/050648237
Higman, D. G., Coherent configurations. I. Ordinary representation theory, Geometriae Dedicata 4
(1975), pp. 1–32.
URL https://doi.org/10.1007/BF00147398
Hobart, S. A., Bounds on subsets of coherent configurations, Michigan Math. J. 58 (2009), pp. 231–239.
URL https://doi.org/10.1307/mmj/1242071690

Hobart, S. A. and J. Williford, Tightness in subset bounds for coherent configurations, J. Algebraic Combin. 39 (2014), pp. 647–658.
URL  https://doi.org/10.1007/s10801-013-0459-4
Lovasz, L., On the Shannon capacity of a graph, IEEE Trans. Inform. Theory 25 (1979), pp. 1–7.
URL https://doi.org/10.1109/TIT.1979.1055985
Roberson, D. E., Conic formulations of graph homomorphisms, J. Algebraic Combin. 43 (2016),
pp. 877–913.
URL  https://doi.org/10.1007/s10801-016-0665-y
Schrijver, A., A comparison of the Delsarte and Lov´asz bounds, IEEE Trans. Inform. Theory 25 (1979),
pp. 425–429.
URL https://doi.org/10.1109/TIT.1979.1056072

Schrijver, A., New Code Upper Bounds From the Terwilliger Algebra and Semidefinite Programming, IEEE Transactions on Information Theory 51 (2005), pp. 2859–2866.
URL http://ieeexplore.ieee.org/document/1468304/

Szegedy, M., A note on the theta number of Lov´asz and the generalized Delsarte bound, in: Proceedings of the 35th Annual IEEE Symposium on Foundations of Computer Science, 1994.
