	Electronic Notes in Theoretical Computer Science 92 (2004) 34–51	
www.elsevier.com/locate/entcs





Symmetry for Periodic Railway Timetables*

Christian Liebchen1
Institut fu¨r Mathematik Technische Universit¨at Berlin Straße des 17. Juni 136
D-10623 Berlin Germany

Abstract
Periodic timetabling for railway networks is usually modeled by the Periodic Event Scheduling Problem (PESP). This model permits to express many requirements that practitioners impose on periodic railway timetables. We discuss a requirement practitioners are asking for, but which, so far, has not been the topic of mathematical studies: the concept of symmetry.
Several motivations why symmetric timetables might seem promising will be given. However, we provide examples showing that symmetry leads to suboptimality.
To integrate symmetry into the graph model of the PESP, there are many obstacles to overcome. Nevertheless, adding symmetry requirements to mixed-integer programming formulations explicitly, enables MIP solvers such as CPLEX◯c to terminate earlier with good solutions.
Keywords: Railway Timetabling, Mixed-Integer Programming


Motivations for Symmetry
In periodic timetabling, we are given a line-plan for a railway network. This includes the running times of the lines, the passenger demand for every possible connection, infras- tructure information, and the period time F of the lines, e.g. sixty minutes. For possible extensions, we refer to Nachtigall[7].
Given this input, we have to decide for every event, at which time within the abstract period time it should take place. We consider as an event a triplet consisting of a directed traffic line, a railway station, and the property of modeling either a departure or an arrival.

 Supported by the  DFG Research Center “Mathematics for key technologies” (FZT 86) in Berlin
1 Email: liebchen@math.tu-berlin.de








1571-0661 © 2004 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2003.12.021





Throughout our discussion of symmetry, we assume that for every directed line there exists another directed line serving the same stations just in opposite order. Moreover, the concept of symmetry makes only sense, if the running and stopping times are the same for both directions of the same traffic line, and if the passenger flow is symmetric, as well.
A periodic railway timetable is called symmetric, if trains of the two opposite di-
rections of the same traffic line always meet each other at time 0. Large parts of the timetables of central European countries, such as Germany and Switzerland, are sym- metric within only small tolerances, see Figure 1 for an example. For example in Cologne

Berlin Zoologischer Garten	05.06.03	dep 09:54	4	ICE 952	InterCityExpress

Wolfsburg	dep 10:54
Hannover Hbf	dep 11:31
Bielefeld Hbf	dep 12:24
Hamm(Westf)	dep 12:54
Hagen Hbf	dep 13:25
Wuppertal Hbf	dep 13:42
Köln-Deutz	dep 14:11
Köln Hbf	05.06.03	arr 14:14	6
BordRestaurant

Köln Hbf	05.06.03	dep 15:13	8	ICE 14	InterCityExpress

Aachen Hbf	dep 15:52
Aachen Süd(Gr) Liege-Guillemins
Bruxelles-Midi	05.06.03	arr 17:46
Onboard meeting place




All information is issued without liability. Software/Data: HAFAS 5.00.DB.4.5 - 20.05.03 [5.00.DB.4.5/v4.05.p0.13_data:59e79704]


Bruxelles-Midi	05.06.03	dep 12:16	ICE 15	InterCityExpress

Liege-Guillemins	dep 13:28
Aachen Süd(Gr)
Aachen Hbf	dep 14:10
Köln Hbf	05.06.03	arr 14:46	3
Onboard meeting place

Köln Hbf	05.06.03	dep 15:47	2	ICE 953	InterCityExpress

Köln-Deutz	dep 15:51
Wuppertal Hbf	dep 16:17
Hagen Hbf	dep 16:35
Hamm(Westf)	dep 17:10
Bielefeld Hbf	dep 17:37
Hannover Hbf	dep 18:31
Wolfsburg	dep 19:05
Berlin Zoologischer Garten	05.06.03	arr 20:02	1

Duration: 7:46; runs Mo - Fr, not 29. May, 9. Jun, 21. Jul, 15. Aug, 11. Nov Hint: Prolonged stop
BordRestaurant



All information is issued without liability. Software/Data: HAFAS 5.00.DB.4.5 - 20.05.03 [5.00.DB.4.5/v4.05.p0.13_data:59e79704]

Fig. 1. Symmetric timetables in practice
Central Station (Ko¨ln Hbf), the train from Berlin arrives at minute 14. The opposite direction leaves Cologne at minute 47. Hence, they sum up to one, modulo the period time of sixty minutes.
Trivially, under the assumptions made, symmetry is equivalent to the fact that the





times π ∈ [0,F ) assigned to two opposite events sum up to either 0 or the period time F . Notice that the opposite event of an arrival event πa will always be a departure event πd, of course. Here, one can think of time 0 as a symmetry axis. But of course, other symmetry axis are possible. Since trains of the two opposite directions of the same traffic
line meet each other twice within their period time F , for the symmetry axis s we have
w.l.o.g s ∈ [0, T ). In this more general case, symmetry is fulfilled, if
(πa + πd) mod F = s.
2
But for ease of notation we assume s = 0 throughout this article.
When defining the timetable for the two directions of a traffic line manually, the two characterizations suggest different approaches: either define the locations where the two directions shall meet, or set for some important station the temporal distance from time 0 to a certain value.
A major advantage of symmetry is the following. One can imagine that a potential customer will not travel by train, if for his itinerary only one of the two directions involves a changeover waiting time that he considers to be too long. Consider, for example, the relation Saarbru¨cken-Stuttgart where no direct trains exist. Imagine changeover times in Mannheim of 10 minutes in one direction and 50 minutes in the opposite direction. With
an effective running time of less than two hours, would you accept a ratio 	offtime	
ontime+offtime
of almost 30% for your return trip?
Moreover, for some fixed origin/destination (O&D) pair, consider timetables that induce c time units for the sum of the two changeover times involved. Railway companies naturally favor stable timetables, in which connections can be attained even with a certain amount of random delay. Let P (t) denote the probability that a train has a delay of at
most time t, with t ≥ 0. For this distribution function P : R+ '→ [0, 1], we compare the expected number of connections that hold in the symmetric timetable, i.e. 2P ( c ), to
the expected number of connections that hold in an asymmetric timetable which deviates
from exact symmetry by ∆ ∈ [0, c ], i.e. P ( c −∆)+P ( c +∆). If the distribution function P
2	2	2
is concave, as for example the exponential distribution, we conclude that the expected
number of connections that hold in the symmetric timetable will be at least as high as the expected number of connections that hold in any asymmetric timetable with a waiting time of c time units for the sum of the two changeover times. For that reason, symmetric timetables tend to be robust.
Further, symmetric timetables have the essential advantage that they, by definition, ensure identical changeover waiting times for any two opposite connections. The impact of this fact gets even more obvious when considering a transportation network with ten pairs of symmetric connections. Assume the network implies that at least four directed connections must have an unacceptable amount of waiting time. An optimal timetable might assign those four bad connections to four distinct origin/destination (O&D) pairs.





Then, practitioners might prefer a symmetric timetable that even neglects six directed connections, since in this case, only three O&D pairs are involved. A further advantage of symmetric timetables is that they simplify the planning process immensely[10].
Sometimes, symmetric timetables are mistaken in that they essentially depend on so-called zero hubs. In fact, the latter are only an additional requirement for symmetric timetables: When locating the meeting points of several lines at important stations, we
call these stations zero hubs. Obviously, at zero hubs, departure times can easily be kept
in mind by customers 2 . And when planning the German ICE/IC network, the interfaces to both international and regional networks, become better controllable when assuring symmetry by the definition of zero hubs. However, such an approach has the bizarre effect that planning the German ICE/IC network is started in Zurich[10], being a zero hub in the Swiss railway network.
The possible benefit of symmetric timetables with zero hubs becomes particularly obvious by visualizing train movements within a line-plan, see a nice animation of the Swiss Federal Railways http://www.sbb.ch/bahn2000/e/illustration/konzept1.htm and Figure 2. We assume right hand traffic and a period time of sixty minutes. The running time between two stations is annotated in minutes next to the line that models the corresponding track. The different traffic lines are represented by the colors black,

Fig. 2. Symmetric timetable immediately before resp. after minute 00

gray, and light-gray. Of course, vehicles are given the same color as the bars of the traffic lines they serve.
If we are lucky, infrastructure permits trains always to meet within important stations. In our example, only one pair of black trains and one pair of dark gray trains misses to meet at minute 00 within one of our four major stations. But since we assume the lines to be operated hourly, these two lines will meet at minute 30 within the remaining station. Hence, when choosing stopping times of 10 minutes, every possible connection in our

2 In fact, in hourly operated railway networks, the symmetry axis, is often shifted to about minute 57. Hence, respecting a changeover time of five or six minutes, trains will leave the station precisely at minute 00. . .




example will have only 10 minutes of changeover time, including the time necessary to change platforms.
To generalize the above phenomenon, consider the graph formed by the network’s stations and tracks. If the running time between any pair of stations is slightly less then some integral multiple of the period time F , then a symmetric timetable can be constructed such that trains will always meet each other within stations, and no waiting times will arise.

But since trains meet in a symmetric timetable at time T
as well, the sufficient

criterion for zero waiting time can be extended: Assume all running times to be slightly less than some integer multiple of half the period time T . For a track of running time k · T − ϵ, k ∈  , introduce k − 1 artificial nodes on the edge modeling that track. A total
waiting time of zero for the entire network can still be achieved, if the resulting graph is bipartite. The nodes in one part of the bipartition usually are called zero hubs, and the other nodes are called half hubs, because trains meet on the hour and on the half-hour,
respectively, assuming F = 60 minutes. As the project Rail 2000 of the Swiss Federal Railways is currently establishing a half-hour frequency on most routes, half hubs are served at minutes 15 and 45:
In the first phase of Rail 2000, the stations of Basel, Bern, Olten, Zurich and Chur serve as hubs each hour or half-hour. In the stations of Lausanne, Biel, Lucerne and St.Gallen, the trains will meet each time at a quarter to and a quarter past the hour. (http://www.sbb.ch/bahn2000/e/fahrplan.htm)
But what if we are not lucky, if infrastructure does not permit running times of slightly less than T between major stations, or if the underlying graph is not bipartite?
On December 6th, 1987, the Swiss people agreed in a referendum to adapt the infras- tructure of Swiss Federal Railways to the requests of future timetables:
The new line construction Mattstetten - Rothrist is the core part of Rail 2000. As from 12 December 2004, the Inter-City trains connect Bern with Zurich at a speed of 200 km/h. On this line, no station and no turnout will hinder their swift run. The journey from Bern to Zurich will take 56 minutes only (currently 72 minutes). (http://www.sbb.ch/bahn2000/e/projekte.htm)
On December 12th, 2004, the first phase of Rail 2000 will be ready for operation. Then, most running times will satisfy the k · T − ϵ property, as is illustrated in Figure 3.
For example, Deutsche Bahn proceeds the same way in Saxony. The running time
between Leipzig and Chemnitz will be reduced from 85 minutes down to approximately 50 minutes. For the refurbishment of the tracks between Leipzig, Do¨beln, and Meißen, press release 042/2003 of Deutsche Bahn AG gives the following motivation:






Fig. 3. Running times in the Rail 2000 system (Swiss Federal Railways[11])

After completion of the refurbishment measurements, the running times Leipzig-D¨obeln and Do¨beln-Meißen will be reduced to significantly less than one hour, in order to guarantee their integration into the Sachsen-Takt (integrated fixed interval timetable for Saxony).
And the regional government of Schleswig-Holstein, being financially responsible for the public transport in its region, replies to the written request of a member of parliament:
Our planning envisages to reduce the running time on the track Kiel-Lu¨beck from 73 minutes down to less than one hour to integrate it into the integrated fixed interval timetable.
(http://www.sh-landtag.de/infothek/wahl15/drucks/0300/drucksache-15-0342.pdf)

In summary, in several European national railway companies, there is a current trend to define nodes of a railway network which shall become zero hubs in the periodic timetable the railway company is willing to operate. Then, long-term investments in infrastructure are initiated in order to reduce running times such that they permit the desired timetable to be implemented.
Of course, such systems risk to become very inflexible. For example, there will be no substantial incentive to reduce the current running time of 54 minutes between the two zero hubs Basel and Zurich by, say, only five minutes. Improvements that would fit into such a system must be of much bigger dimension. Hence, in some way, gradual improvements are obstructed. Moreover, it would cause major disruptions to the complete system if maintenance of some central track causes an increase of running time by ten minutes for some weeks.
Instead of defining a railway timetable for the life-time of the infrastructure as it has





been set up, one could supply a flexible planning tool that constructs optimal periodic timetables for the specific needs of the year to plan. Up to now, mathematical models for periodic railway timetable optimization aim at satisfying operational constraints and minimizing waiting times for both directed passenger flows and trains ([7] and [3]). But those approaches could favor asymmetric timetables, cf. section 4. However, one could enforce symmetry within this model by defining zero hubs, cf. section 2. But this risks to result only in a poor degree of flexibility, similar to manual planning. For that reason, we investigate in section 3 how the symmetry requirement can explicitly be integrated into the standard mathematical models for periodic timetabling.
Finally, we want to point out that an optimization algorithm may define several stations to become zero hubs, even without being forced by explicit constraints. If there is a sufficient reduction in passenger waiting time, a station may always become a zero hub, of course.

Modeling Periodic Railway Timetables
The key ingredient for modeling periodic timetables are so-called events. By an event i, we consider the arrival or departure of a directed traffic line in some station. A timetable π assigns a value πi ∈ [0,F ) to every event i, where F denotes the period time of the traffic network.
Of course, a huge number of restrictions has to be respected by a timetable. Serafini and Ukovich[12] introduced the Periodic Event Scheduling Problem (PESP), which con- sists of constraints of the following form, where l and u are some constants, and i and j are two events within the traffic network that we assume to be operated every F time units:
(1)	(πj − πi − lij) mod F ≤ uij − lij,
or πj − πi ∈ [lij, uij]T for short. Due to the periodicity, we may assume 0 ≤ lij < F . Besides elementary constraints such as running and stopping times, even more tech-
nical restrictions such as safety distances and attention of single tracks can be modeled easily. Notice that a timetable is not tied to a specific point in time: π is a feasible timetable, if and only if (π + ∆ ) mod F is a feasible timetable for any shift ∆ ∈  .
With an appropriate objective function, we are able to minimize passenger waiting
times. And by simultaneously penalizing vehicle waiting times, we are even able to accept additional vehicles only if a significant improvement for the changing passengers can be achieved[5].
Of course, restrictions of the form given in equation (1) induce an immediate inter- pretation in terms of digraphs. Since there are exactly two distinct events i and j related by restriction (1), it can be modeled by an arc (i, j).
We are able to ensure zero hubs using only PESP constraints. The main idea is an artificial node which represents time zero. Then, we have to ensure that, for a zero hub,





arrivals take place only a few time units before time zero, and departures must take place immediately after time zero. Figure 4 shows a graph establishing Basel as zero hub. The

Fig. 4. Defining Basel to become a zero hub in the PESP

gray arcs model the running and stopping activities of the traffic lines passing Basel, the black arcs ensure Basel to become a zero hub, and changeover arcs have been omitted in this figure. As zero hubs are sufficient for symmetry, the PESP covers special symmetric timetables. But these risk to be very inflexible.
Of course, defining too many stations as zero hubs might restrict the system too much. In this situation, it would be an unsatisfying behavior of a PESP solver just to declare infeasibility. Planners prefer to get a timetable with as many stations as zero hubs as possible.
Fortunately, even this can be modeled within the PESP. Instead of strictly requiring πj − πi ∈ [lij, uij]T for a constraint of minor importance, Nachtigall[7] proposed to model this by soft constraints: Replace the original arc (i, j) by two artificial arcs having a large
weight M,
πj − πi ∈ [lij, lij + F )T  and
πi − πj ∈ [−uij,F − uij)T .
These two arcs serve as an indicator function. For a feasible timetable, they contribute to the objective value with M (uij − lij). However, infeasible timetables are penalized by another M · F units.
Solution methods for periodic scheduling include Constraint Programming[2], Genetic Algorithms[8], and of course Mixed Integer Programming[7].
In particular for the MIP approach, the graph-theoretic interpretation of the PESP is essential. Several classes of valid inequalities are known which could be added to the original problem formulation. They have in common that their coefficients must satisfy a certain flow property[6]. A simple, but very important, special class is the class of so-called cycle inequalities[9]. They are obtained when resolving the mod-operator in





constraint (1) by integer variables pij, which leads to
(2)	lij ≤ πj − πi + pijF ≤ uij.
Then, for every oriented cycle C in the directed graph associated with the PESP instance, with forward arcs C+ and backward arcs C−, the following cycle inequalities are valid:

 Σ	lij −	Σ
uij 	Σ
Σ	 Σ
uij −	Σ
lij

(3)
(i,j)∈C+

(i,j)∈C−
F
≤
	(i,j)∈C+
pij
—
(i,j)∈C−
pij
≤ (i,j)∈C+
(i,j)∈C−
F
 .

In fact, adding some of these valid inequalities to the original formulation of the MIP improves the performance significantly. Reductions in running time by a factor of ten are
usual. And, of course, instances for which CPLEX◯c reaches its limits, when faced with
the initial problem formulation, become solvable after adding only a few hundred valid inequalities [3].
Of course, feasibility problems tend to benefit more from Constraint Programming than optimization problems. Therefore, one may replace arcs with big weight and span

ratio uij −lij
> 0.9 by stricter constraints with u'
= lij + T . To prevent the system

from being overdetermined, cycle inequalities may indicate whether the flexibility on the cycles passing through this arc remains sufficiently large, after strengthening the arc of big weight.
To recapitulate, the PESP gives rise to an immediate graph-theoretic interpretation. And some of the solution methods, that have been proposed for the PESP, benefit enor- mously from this interpretation, in particular from finding short cycles which are defined in the digraph associated with a PESP instance. Hence, a graph-theoretic interpretation seems to be very important for periodic timetabling.

Obstacles when Introducing Symmetry
We are going to examine changes to the event-activity model of the PESP that become necessary when introducing symmetry. Our original definition of symmetry suggests to define the locations where the trains of the two directions of the same traffic line shall meet – at time zero, of course. But this is not compatible at all with our notion of events and constraints: A constraint is defined for a pair of events, and every event is assigned to a specific location. But as we want the algorithm to select an appropriate location for the two trains to meet, a priori we are not able to define pairs of events, or locations resp., by which we may express our quest for symmetry.
Similar effects appear when trying to express symmetry by requiring that distances from time zero shall be the same for a pair of two opposite events. As in Figure 4, time zero can be modeled by introducing an artificial event. Consider the departure event i at the starting point of a directed traffic line, and the arrival event j of the opposite line in





the same station. The timetable of this line would be symmetric, if and only if
(4)	(πi − π0) mod F = (π0 − πj) mod F.
By exploiting π0 mod F = 0, equation (4) can easily be simplified to
(5)	(πj + πi) mod F ≤ 0.
But the sign of πi prevents inequalities (5) from being translated to PESP constraints (1).
Another way to cope with the symmetry request could be to consider a much simpler digraph, in that we omit the events of exactly one direction of every traffic line, because they are redundant for reasons of symmetry. Are we then able to ensure that the con- straints that are necessary to model a railway network always relate two distinct events, with distinct signs as well?
Unfortunately, the answer is no again. Consider for example a single track for that we want to ensure that the trains of the two opposite directions of some traffic line do not meet each other, cf. Figure 5. Let r denote the (fixed) running time between the two

Fig. 5. Modeling Single-tracks in the PESP

points where the two directions of that line are allowed to meet, and let s denote the safety distance that has to pass from the arrival of the train leaving the single track to the departure of the train entering the single track.
The middle part of Figure 5 shows the usual event-activity graph of the PESP. In the right part, the arcs modeling fixed running times are contracted. The remaining restriction in the asymmetric model is
(πj − πi − (r + s)) mod F ≤ F − 2(r + s).
If we introduced symmetry by expressing event j by its distance to event i, we would obtain
(−2πi − (r + s)) mod F ≤ F − 2(r + s),
which is again not compatible with the PESP constraints (1). Table 1 summarizes es- sential properties of general periodic timetables, symmetric timetables, and symmetric timetables with zero hubs.





Table 1
Properties of different classes of periodic timetables

Although symmetry is a very nice mathematical property for a periodic timetable, it is unlikely that we are able to introduce it properly into the PESP, although it is known to incorporate many requirements that arise in practice.

Suboptimality of Symmetry
At this point, we want to discuss if one can always find a symmetric timetable among the periodic timetables of minimal cost. Recall that we assume symmetric passenger flows and identical running times for the two opposite directions of the same traffic line.
But even under these assumptions, we will provide railway networks in which an optimal symmetric timetable has an objective value strictly greater than any optimal unrestricted periodic timetable.
The first example makes use of single tracks forcing the two directions of a traffic line to meet at specific locations. Figure 6 shows a railway network with three traffic lines, which are marked black, gray, and light-gray. Each line has two single tracks. The single

Fig. 6. Optimal symmetric periodic timetable
tracks predefine the locations where the trains meet. Symmetry implies those trains to meet either at time 00 or at time T = 30. Hence, there are only two kinds of timetables:





Either the two directions of all lines meet at the same time, or the trains of one line meet
at time t0 ∈ {0, T }, and the trains of the other two lines meet at time (t0 + T ) mod F .
2	2
An optimal symmetric timetable is shown in Figure 6. The two lines, whose directions
meet at the same time in the middle of their single tracks, arrive at their transfer station at time 35, but departure has already been at time 25, hence, in both directions, we have a changeover time of 50 minutes 3 , the other four connections cause changeover times of 20 minutes each.
But there are other timetables with less waiting time. Consider the timetable shown in Figure 7. For any of the three clockwise connections, the changeover time is only

Fig. 7. Optimal periodic timetable
10 minutes. The remaining connections cause 30 minutes of waiting time each, i.e. in total only 120 minutes compared to 180 minutes for an optimal symmetric timetable.
Even worse, by using single tracks we are able to define railway networks in which every symmetric timetable will be infeasible. Consider the railway network in Figure 8 with again three hourly lines. Due to the single tracks, for every line, its two directions must meet within the center node. Hence, only two lines can be operated symmetrically such that they meet either at time zero or at time T . But choosing the symmetry axis of the three lines as marked in the endpoints of the lines, the single tracks as well as safety constraints of five time units can be respected by an asymmetric timetable.
But we do not even have to introduce conditions for single tracks, or any other restric- tion on infrastructure, in order to show suboptimality of symmetric timetables. Consider the line-plan shown in Figure 9. We assume that all passenger weights are equal to one, and that the minimal changeover time lij is equal to two for each of the 32 connections in any of the four stations.
For symmetric timetables, the stopping times of two time units in the gray stations make only two classes of timetables sufficiently attractive, as they cause zero effective

3 We neglect minimal changeover times for changing platforms in this example.





Fig. 8. Railway network infeasible for symmetric timetables


Fig. 9. Line-plan preventing symmetric timetables from optimality



waiting time (πj − πi − lij) mod F for the 16 connections within the two gray stations: arrivals at time 9 and departures at time 1, or arrivals at time 4 and departures at time 6.
But in any combination of these, the effective waiting time sums up to 64 time units in exactly one of the white stations. In the remaining station, still 24 time units accrue.
Now, assume that the two gray lines meet between time 9 and 1, and that the black lines to meet between time 1 and time 3. The gray stations, again, show zero waiting time. At the central station, we have an effective waiting time of five time units when changing from the dark gray line to the black line but only one time unit in the opposite direction. At the lower right station, we have an effective waiting time of 6 time units for passengers changing from the black line to the light gray line, but zero time units for the opposite connections.
Hence, an optimal symmetric timetable causes a total effective waiting time of 84 time units, but there are asymmetric timetables with only 48 time units.




Speed-up by Exploiting Symmetry
Although it is unlikely that symmetry can be introduced adequately into the Periodic Event Scheduling Problem, we can model symmetry in an MIP-formulation by adding extra constraints. We want to find out, whether symmetry helps or hinders CPLEX◯c .
We will formulate the MIP with tension variables. In inequality (2), we substi- tute πj − πi + pijF by a new periodic tension variable xij. These are restricted by the cycle-arc incidence matrix Γ of some integral cycle basis, i.e. a set of |A|− |V | + 1 oriented cycles that permit to express every cycle of the directed graph as an integer
linear combination[4]. With this, the tension variables x enable us to reconstruct a node potential, or timetable, π.
Our MIP formulation is then:



(6)
min cx
s.t. Γx = pF
p ∈  |A|−|V |+1
l ≤ x ≤ u.
In order to introduce symmetry, we add arcs to and from the artificial event represent-

ing time zero. For a pair of opposite events i and j, we introduce artificial variables xi0
and x0j with “constraints” 0 ≤ xi0 < F and 0 ≤ x0j < F , and finally require xi0 = x0j.
Alternatively, we could have identified pairs of opposite change activities or sequencing
constraints and require the corresponding tension variables to be equal. But we have to admit that in the data set, that Deutsche Bahn kindly made available to us, the running times of the two opposite directions of the same traffic line have been slightly asymmetric in many cases, so that the latter approach would not be feasible for our data.
The following computations have been executed on a railway network with eleven pairs of directed lines. For 44 stopping activities there is the possibility to introduce additional stopping time. The 55 most important connections have been taken into account, and of course, vehicle waiting time is penalized, as well. Moreover, there are three single tracks in the network. After elimination of redundancies, the resulting digraph contains 56 nodes and 231 arcs. Since the passenger demand is not always symmetric, some connections do only appear for one direction. For example, for one pair of connections, the weights differ by a factor of more than eight. Hence, only one direction remains visible when focusing on the TOP 55 connections. This is a further reason for introducing symmetry only by additional arcs linking the endpoints of the lines to the artificial event modeling time zero.

On an AMD Athlon◯c
XP 1500+ with 512 MB main memory, CPLEX◯c
8.0 has not

been able to find an optimal solution for the instance without symmetry requirement within one day – neither with standard settings, nor with the settings Bixby applied





when solving this instance to optimality (25 hours CPU time), using
the so-called relinking heuristic, a new feature in the upcoming version[1].
With strong branching as variable selection strategy and aggressive cut generation, a solution of 102.3% of the optimal value, which has been reported by Bixby, has been achieved after 24 hours CPU time. At that time, the lower bound has only been 90.7%, cf. Figure 10.

Fig. 10. CPLEX◯c running times with/without symmetry requirement, additional stop times

Even though we introduced additional variables to express symmetry, this bigger formulation has been solved optimally after 15.5 hours. Interesting enough: compared to an optimal periodic timetable, the objective value of a symmetric timetable is worse by more than 7.6%.
With the same CPLEX◯c parameters, we attacked a variant of the above instance: the possibility to introduce additional stopping time has been removed, and approximately half of the connections’ weights have been symmetrized by hand.
The solution behavior is very similar: The symmetric formulation has been solved to optimality within only 41 minutes, whereas the more general formulation caused a solution time of almost 3.5 hours. But again, the objective value of an optimal symmetric timetable exceeds the global minimum by almost ten percent, see Figure 11.
Let us analyze this scenario in more detail. The penalized vehicle waiting time is the same in both optimal timetables. Since in this scenario, passenger and vehicle cost are more or less the same for the general optimal timetable, symmetry is paid by an increase






Fig. 11. CPLEX◯c running times with/without symmetry requirement, fixed stopping times
in passenger waiting time of about twenty percent.
The value of twenty percent is even more severe, when observing that there is a certain unavoidable base weight included in our objective values. For example, there are two hourly lines serving Frankfurt-Hanover, one coming from Stuttgart, the other from Basel. On their common track, they are synchronized to a 30 minutes frequency. It is clear that not both lines can have zero waiting time on a connection to Leipzig. Since there are passenger weights of 481 and 650, any timetable will imply a waiting time of at
least T ·min{481, 650} = 14430. We obtain such an unavoidable base weight for about ten pairs of connections. Removing this from the passengers’ contribution to the objective value, the price of symmetry is a deterioration of at least 28.8% for the passengers who
change.
Although passenger flow has been symmetrized for the second pair of computations, and thus it is not immediately comparable to the first pair, let us mention that fixing the stopping time in every station in advance causes an increase of the objective value of less than 0.1% for general timetables. Yet, for symmetric timetables, the increase has already been approximately 2.5% in total, or 5% when only considering passenger changeover times.

Conclusions
On the one hand, restricting the search for periodic railway timetables to symmetric timetables implies a significant increase of the total passengers’ waiting time. Planners





should analyze whether important connections are indeed served very asymmetrically in a globally optimal timetable. Then, the increase in the total waiting time could always affect only one direction, and potential customers will take the train for neither of the two directions because their return trip involves unacceptable changeover time.
On the other hand, it is good news that symmetry speeds up the optimization process. However, the bad news for practitioners is that, in our examples, at almost any time, the current feasible solution for the symmetric instance is worse than the feasible solution for the more general problem. Hence, the speed-up of the complete optimization process might not serve as a heuristic for quick generation of good (symmetric) solutions for the general problem.
Finally, we want to emphasize that symmetric timetables must not be confounded with timetables defining zero hubs. The latter are only a special case of symmetric timetables, and seem to be very restrictive and inflexible. However, contrary to symmetric timetables, they are easily covered by the PESP.

Acknowledgments
My thanks go to the staff of Deutsche Bahn AG for convincing me, in many discussions, that it can be worth to seek for symmetry. The Swiss Federal Railways gave me the kind permission to reproduce the figure on Page 6. Nicole Megow and Rolf H. M¨ohring helped improving the readability of this paper.

References
R. Bixby. Personal Communication, 2003.
J.H.A. Van den Berg and M.A. Odijk. DONS: Computer aided design of regular service timetables. In B.T.K.S. Murty et al, editor, COMPRAIL 94 Computers in Railways IV. Computational Mechanics Publications, 1994.
C. Liebchen and R.H. M¨ohring. A case study in periodic timetabling. In D. Wagner, editor, ATMOS 2002 Algorithmic Methods and Models for Optimization of Railways, volume 66.6 of Electronic Notes in Theoretical Computer Science. Elsevier, 2002.
http://www.elsevier.com/gej-ng/31/29/23/120/25/show/Products/notes/index.htt.
C. Liebchen and L. Peeters. On cyclic timetabling and cycles in graphs. Technical Report 761-2002, TU Berlin, 2002.
http://www.math.tu-berlin.de/coga/publications/techreports/2002/Report-761-2002.html .
C. Liebchen and L. Peeters. Some practical aspects of periodic timetabling. In P. Chamoni et al, editor,
Operations Research 2001. Springer, 2002.
http://www.uni-duisburg.de/or2001.
T. Lindner. Train Schedule Optimization in Public Transport. PhD Thesis, TU Braunschweig, 2000.
http://www.biblio.tu-bs.de/ediss/data/20000724b/20000724b.pdf  .
K. Nachtigall. Periodic Network Optimization and Fixed Interval Timetables. Habilitation Thesis, University Hildesheim, 1998.





K. Nachtigall and S. Voget. A genetic algorithm approach to periodic railway synchronization. Computers and Operations Research, 23(5):453–463, 1996.
M.A. Odijk. Construction of periodic timetables, Part 1: A cutting plane algorithm. Technical Report 94-61, TU Delft, 1994.
Staff of Deutsche Bahn AG. Personal Communication, 2003.
Swiss Federal Railways. Bahn 2000, 2003.
http://www.sbb.ch/bahn2000/e.
P. Serafini and W. Ukovich. A mathematical model for periodic scheduling problems. SIAM Journal on Discrete Mathematics, 2(4):550–581, 1989.
