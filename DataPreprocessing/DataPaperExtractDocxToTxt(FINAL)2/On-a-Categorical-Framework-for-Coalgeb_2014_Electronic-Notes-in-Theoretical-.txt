Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 308 (2014) 109–128
www.elsevier.com/locate/entcs

On a Categorical Framework for Coalgebraic Modal Logic
Liang-Ting Chen1,2
Institute of Information Science Academia Sinica
Taipei, Taiwan
Achim Jung3
School of Computer Science University of Birmingham Birmingham, U.K.

Abstract
A category of one-step semantics is introduced to unify different approaches to coalgebraic logic parametric in a contravariant functor that assigns to the state space its collection of predicates with propositional connectives. Modular constructions of coalgebraic logic are identified as colimits, limits, and tensor products, extending known results for predicate liftings. Generalised predicate liftings as modalities are introduced. Under common assumptions, the logic of all predicate liftings together with a complete axiomatisation exists for any type of coalgebras, and it is one-step expressive for finitary functors. Colimits and compositions of one-step expressive coalgebraic logics are shown to remain one-step expressive.
Keywords: Predicate liftings, coalgebras, coalgebraic logic, modal logic, Stone duality, compositionality, expressivity


Introduction
Two syntax-oriented approaches to coalgebraic modal logic — Moss’ cover modality
[23] and Pattinson’s predicate liftings [24,25,26] — are successful in producing a wide range of modal logics parametric in a Set functor. Subsequently, the algebraic semantics of the logics of predicate liftings was formulated elegantly as a particular form of natural transformations using Stone duality [15]. To explain it, let BA denote the category of Boolean algebras and Q : Set → BA the contravariant powerset

1 The first author was supported by EPSRC Doctoral Training Grant EP/G041296/1 and the School of Computer Science, University of Birmingham, during his studies.
2 Email: lxc@iis.sinica.edu.tw
3 Email: A.Jung@cs.bham.ac.uk

http://dx.doi.org/10.1016/j.entcs.2014.10.007
1571-0661/Crown Copyright © 2014 Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).

functor. For an endofunctor T , a family of sets Λn of n-ary predicate liftings indexed by N amounts to a natural transformation δ to UQT from the coproduct indexed
by all n-ary predicate liftings λ of n-fold product of UQ, i.e. `n∈N `λ∈Λn UQ
n
where U is the forgetful functor, so by adjunction this family (Λn) gives rise to an interpretation of modalities δ : LQ⇒ QT for some functor L; it introduced what we call one-step semantics (Definition 3.1), an expression first coined by Cˆırstea and Pattinson [7] in a different but equivalent form. Later Moss’ cover modality was also formulated in this way [21].
This abstract functorial framework was further developed in [17,4,14,19,18] with the aim of finding suitable modal logics for various coalgebras, e.g. [5,11,13,20], replacing Q with other contravariant functors. For example, Markov processes are coalgebras of the Giry monad, and propositional connectives for measurable spaces can be specified by the contravariant functor S: Meas → MSL mapping a space to its σ-algebra, considered as a meet semilattice.
Adequacy and soundness of the functorial framework follow from its very for- mulation as shown by Kurz [17], and a sufficient condition of expressiveness was first established by Klin [14] for finitary type functors on locally finitely presentable categories (to be presented in Subsection 5.2 below). For example, Boolean logic extended with the possibility modality is expressive for all image-finite Kripke frames,
i.e. coalgebras for the finite powerset functor Pω. The restriction to finitary functors is not necessary, however. Multi-modal logic is expressive for image-finite A-labelled Kripke frames, but Klin’s condition does not cover this case, since its corresponding type functor, the A-fold product PA, is not necessarily finitary.
Another important line of research investigated modularity of predicate lift- ings [7,27]: not only expressiveness but also completeness are stable under certain constructions. With regards to the example above, expressiveness of multi-modal logic for PA-coalgebras is inherited from modal logic for Pω-coalgebras. The idea has since been incorporated into the functorial framework over Stone duality in [19], where a subset of constructions is considered, focusing on completeness. In [18], Kurz and Leal show how to translate Moss’ cover modality into predicate liftings and vice versa; thus making it amenable to their completeness analysis.
In the present paper, we put forward a fully categorical treatment in a syntax- independent fashion beyond Stone duality, so that existing results and concepts can be further applied without further effort to richer structures such as ordered, topological, or measurable spaces. Our running examples will be mostly over Set, however, in the hope that the reader will be able to make a direct comparison with known results and concepts.
In Section 3, we introducea category CoLog of one-step semantics, which includes Pattinson’s predicate liftings and Moss’ cover modalities as objects, and exhibit its rich structure. Modularity of coalgebraic modal logics are recognised as standard categorical constructions in this category, avoiding any syntactic bookkeeping. A “full logic” for each type of coalgebras, using the basic properties of adjunction, is identified: every other logic for the same type can be (uniquely) translated to it. In Section 4, we then focus on equational one-step semantics, which are found

to be isomorphic to those determined by predicate liftings. Notions of modalities and equations are derived naturally from the analysis of categorical structures, as is the characterisation of the full equational logic. Logical properties of one-step semantics are discussed in Section 5. Klin’s condition of expressiveness is adapted. The categorical viewpoint allows us to formulate general preservation principles for coalgebraic expressiveness that apply to all logics in CoLog.
The framework is parametric in a contravariant functor mapping state spaces to “algebras” for the base logic about which very little needs to be assumed to cover a large variety of examples. Indeed, we would like to suggest that our work provides the right level of abstraction for understanding coalgebraic modal logic.
This paper summaries the first author’s PhD thesis [6], to which we point for most of the proofs.
Preliminaries
We follow Mac Lane’s terminology of category theory [22] except that for us a (co)reflective subcategory is defined to be full. For an endofunctor T , a coalgebra for T is a morphism ξ : X → TX; a coalgebra homomorphism from (X, ξ) to (Y, γ) is a morphism f : X → Y satisfying Tf◦ξ = γ◦f . The category of T -coalgebras is denoted by XT .
Dual adjunctions
Definition 2.1 A contravariant functor P : X → A is said to be dual to a con- travariant functor S if together they form an adjunction S E P : X op → A with unit η and counit ϵ.
We use dual adjunctions to set up a link between “state spaces”, the objects of X , and (algebras of) “logics”, the objects of A . This is a particular instance of “Stone duality”; for a general introduction see [12].
Example 2.2 (i) Consider the powerset 2− as a contravariant functor from Set to Set; it is dual to itself. Alternatively, consider the powerset as a Boolean algebra; we obtain Q, a contravariant functor from Set to BA. The natural dual to Q is the ultrafilter functor 7 , equivalently described as BA(—, {⊥ Ç T}). The pair (Q, 7 ) is our leading example.
When X is the category of posets, the upset functor C : Pos → DLat mapping a poset to the distributive lattice of upsets is dual to the prime filter functor, naturally isomorphic to DLat(—, {⊥ Ç T}).
The contravariant functor S: Meas → MSL mentioned above is dual to the filter functor 7 which maps a semi-lattice A to its collection of filters with the σ-algebra generated by the units (η(a))a∈A.
A wide range of state-based systems can be formulated as Set coalgebras, and beyond Set we have further examples, including a) descriptive Kripke frames as Stone coalgebras of the Vietoris topology [16]; b) positive Kripke frames as Pos

coalgebras of the convex powerset functor [13]; and c) Markov processes as Meas
coalgebras of the Giry monad [9].
Factorisation systems
Definition 2.3 (see [3]) Given two classes E , M of morphisms of a category X , we say that (E, M) is a factorisation system if
every morphism f has an (E, M)-factorisation;
E and M contain all isomorphisms and are closed under composition.
it has the diagonal fill-in property; i.e., for each equation g ◦ e = m ◦ f with e ∈E and m ∈M there is a unique morphism d such that the equations d◦e = f and m ◦ d = g hold.
We say that a factorisation system (E, M) is proper if E is contained in the class of epimorphisms and M in the class of monomorphisms.
Proposition 2.4 For any factorisation system (E, M) on X , the following state- ments are true:
E-morphisms are preserved by pushouts;
M is closed under limits in the arrow category X →;
if f ◦ g and f are M-morphisms, then so is g.
Equationally presentable functors
Let A be a finitary variety with a left adjoint F to the forgetful functor U : A → Set, and J the full inclusion of the subcategory A f of A on free algebras Fn for n ∈ N.
Definition 2.5 (see [4,29,6]) An endofunctor L of A is finitely based if it satisfies one of the following equivalent statements:
L is finitary and preserves canonical presentations;
L is of the form LanJ LJ, a left Kan extension of LJ along J.
Let FinB[A , A ] denote the full subcategory of the functor category [A , A ] on finitely based functors.
The notion of finitely based functors plays an important role in our theory of one-step semantics, since they are precisely the equationally presentable ones. Some elementary facts are given first.
Proposition 2.6 FinB[A , A ] is equivalent to [A f , A ].
Every variety A is locally presentable and (effectively) regular so the same holds for FinB[A , A ] by this equivalence and A f being small. Another useful fact about FinB[A , A ] is that every functor has a finitely based coreflection:
Lemma 2.7 FinB[A , A ] is a coreflective subcategory of [A , A ] with the right ad- joint LanJ (—◦ J).

It follows that FinB[A , A ] is closed under colimits of [A , A ] since the inclusion is a left adjoint. Moreover, it can be shown further that the coreflector sends finite products to FinB[A , A ] unchanged:
Proposition 2.8 FinB[A , A ] is closed under ﬁnite products of [A , A ].
The finitely based coreflection of L is written as ρL : Lω ⇒ L with Lω = LanJ LJ. The slogan ‘every finitely based functor is equationally presentable’ is justified as follows. A signature is a functor Σ from the discrete category N of natural numbers
to Set. Every signature defines a finitely based endofunctor on A by
HΣ .= F HΣU	where	HΣX .=	Σn × Xn.	(1)
n∈N

Theorem 2.9 The functor FinB[A , A ] → [N, Set] deﬁned by mapping L to
(n '→ ULF ), is ﬁnitary and monadic with a left adjoint deﬁned by (1).
By monadicity, every finitely based functor L has a canonical presentation, i.e. a coequaliser HΓ ⇒ HΣ → L where Σ = ULF and Γ = U HΣF are signatures. By adjunction, the two parallel morphisms correspond to
Γ ⇒ U HΣF = UFHΣUF,	(2)
so HΣ and the parallel morphisms are the generator and the equation of the presentation, respectively.
Remark 2.10 For n ∈ N, an element t of U HΣFn is to be understood as a term in A consisting of at most one layer of operations in Σ at terms of n variables, called a rank-1 Σ-term:
Σ-operations

U H^ΣFn = U	F
H¸ Σ


U	F n
 
n-ary terms

The two parallel morphisms (2) can be presented by a family of sets En ⊆ (U HΣFn)2
of rank-1 equations, indexed by n ∈ N.
Example 2.11 Modal algebras can be characterised as algebras for a finitely based functor M, defined by the following BA-presentation 4
MA .= BA⟨ {◆a}a∈A | ◆⊥ = ⊥, ◆(a ∨ b)= ◆a ∨ ◆b ⟩	(3)
and Mf (◆a) .= ◆fa for each homomorphism f . This functor has an equational presentation consisting of a signature Σ1 .= {◆} and Σn .= ∅ otherwise; and equations En by


En .=

{ ◆⊥∼ ⊥ }	if n =0 
{ ◆(a ∨ b) ∼ ◆a ∨ ◆b }	if n =2 
⎪⎩∅	otherwise

4 A BA-presentation BA⟨G | E ⟩ indicates an algebra generated by G subject to equations in E .

where 2 is presented as {a, b}.
Remark 2.12 In categories such as Set and the category VecK of vector spaces over a field K, every finitely generated algebra is free, so finitary functors are finitely based. Moreover, every finitary endofunctor of BA is naturally isomorphic to a finitely based functor on non-trivial Boolean algebras [20]. However, this coincidence does not hold in general, and a counterexample can be found in [29, Example 3.12].

Categories of One-Step Semantics
We study properties of the category of all one-step semantics, including colimits, limits, a monoidal structure, coreflections, and its opposite category. For each type T of coalgebras, we explore the category of one-step semantics of T and show that there is always a ‘full’ one-step semantics to which every one-step semantics can be translated in a unique way.
 In the following context, P : X → A always denotes a contravariant functor.
It is suppressed if an ambiguity is unlikely.

The category of all one-step semantics
Definition 3.1 A one-step semantics over P consists of an endofunctor T of X , called the type of one-step semantics; an endofunctor L of A , called the syntax of modalities; a natural transformation δ : LP ⇒ PT , called the interpretation of modalities, denoted by (L, T, δ).
Proposition 3.2 Every one-step semantics (L, T, δ) deﬁnes a functor Pδ from the category of T-coalgebras to the category of L-algebras, called the lifting of P.
Example 3.3 (Classical modal logic) Kripke semantics for modal logic with its algebraic semantics defines a one-step semantics (M, P, δ) over Q as follows where M is given in (3) and P is the covariant powerset functor.

Define a natural transformation 3 : 2− ⇒ 2P by S '→ { U ∈ PX | U ∩ S =/
∅} for

each subset S ⊆ X. Then, 3 defines a natural transformation δ from MQ to QP by mapping ◆S to 3XS, since 3X satisfies the above two equations in (3) for every X. The lifting given by the one-step semantics (M, P, δ) is the functor mapping every
P-coalgebra ξ : X → PX to the M-algebra Qξ◦δX : MQX → QX which is equivalent to the complex algebra of (X, ξ). The unique algebra homomorphism [—]] : Φ → QX from the initial M-algebra (Φ, α) to the complex algebra interprets every element in Φ toa predicate on X. The semantics of possibility, [◆ϕ]] = { x ∈ X | ξ(x) ∩ [[ϕ]] /= ∅ }, follows from the commutativity of homomorphisms.
Polyadic predicate liftings for a Set functor T , i.e. natural transformations λ : (2−)n ⇒ 2T for the contravariant powerset functor 2−, also provide a class of examples:

Example 3.4 (Predicate liftings) Every set Λ of polyadic predicate liftings for T gives rise to a one-step semantics (LΛ,T, δΛ) over Q as follows. Let Λn denote the set of n-ary predicate liftings in Λ so that Λ is a signature Λ: N → Set and F the left adjoint to the forgetful functor U : BA → Set. Define the syntax functor LΛ by the signature Λ without equations, and the interpretation δΛ : LΛQ ⇒ QT on generators by (λ, S) '→ λX (S) for λ ∈ Λn and each n-tuple S = (Si ⊆ X)i∈n.

Example 3.5 (Cover modality [18]) The cover modality for a finitary and weak- pullback preserving Set functor T with Boolean logic also defines a one-step semantics. Let ∈X denote the membership relation on a set X. Define a function ∇T : T 2X →
2TX by

α '→ { t ∈ TX | (t, α) ∈ T (∈X ) }

where (t, α) ∈ T (∈X ) if there is w ∈ T (∈X ) with T π1(w)= t and T π2(w)= α. ∇T is natural in X because T preserves weak pullbacks. By adjunction and 2— = UQ, the transpose of ∇T is a natural transformation ∇T from FTUQ to QT . That is, the cover modality defines a one-step semantics (FT U, T, ∇T ).
Definition 3.6 The category CoLogP of one-step semantics over P is defined to be the comma category (P∗↓P∗) from the precomposition P∗ : L '→ LP to the postcomposition P∗ : T '→ PT . (Following our convention, we will usually suppress the superscript P .)

That is, the objects of CoLog are one-step semantics (L, T, δ) and a morphism from (L, T, δ) to (Lj,Tj, δj) is a pair of natural transformations (τ : L ⇒ Lj,ν : T j ⇒ T ) satisfying Pν ◦δ = δj ◦τP . The natural transformation τ is intuitively understood as a translation from syntax L to syntax Lj. We will justify this intuition in Section 4. We denote the projection (L, T, δ) '→ L with UL and the contravariant (L, T, δ) '→ T with UR.

Proposition 3.7 (Coreflection) Given a coreflective subcategory B of the functor category [A , A ], the pullback of the full inclusion functor J : B ‹→ [A , A ] along the forgetful functor UL : CoLog → [A , A ] is also coreflective.

Note that the pullback category is the full subcategory of CoLog of those one-step semantics whose syntax functor lies in B.

Proof sketch Let ρL : L† ⇒ L denote the coreflection of the functor L. Then, the coreflection of a one-step semantics (L, T, δ) is (L†,T,δ ◦ ρL).	 

Colimits and limits
A colimit of a J-indexed diagram D in CoLog can be constructed by a pointwise colimit (τi : Li ⇒ L)i∈J of ULD and a pointwise limit (ν : T ⇒ Ti)i∈J of (URD)op

using the universal property:
  (ULDf)P 
L P	,L,P



ιiP
i


, r
j

ιj P	δi

δj

s   	s, ,

LP	PTi P (U
Df )
PTj



PT 
since by assumption LPX is a colimit for each component X.
Theorem 3.8 (Colimit) The pair (UL, UR) of projections of CoLog creates point- wise colimits.
A pointwise colimit means that it is constructed by a pointwise colimit in [A , A ]
and a pointwise limit in [X , X ].
Example 3.9 (Multi-modal logic) For a set A of labels, the A-fold coproduct of classical modal logic (M, P, δ) is a multi-modal logic for A-labelled Kripke frames.
Limits in CoLog can be constructed similarly as
LimLiP 	δ=Limδi	,L,imP Ti ∼= P (ColimTi)
and Limδi is a pointwise limit in the arrow category, provided that P maps a colimit to a limit:
Theorem 3.10 (Limit) Suppose that P has a dual adjoint S. Then, the pair
(UL, UR) of projections creates pointwise limits.
Example 3.11 An alternating system over a set A of actions [10] is a coalgebra for the functor D + PA (where D is the probability distribution functor). For such systems, a one-step semantics can be obtained as a product of a one-step semantics of type PA and one of type D. For the former we may take multi-modal logic, and the latter can be probabilistic modal logic induced by predicate liftings ⟨p⟩ for D, indexed by p ∈ Q ∩ [0, 1]:



for each subset S ⊆ X.
S '→ { μ ∈ DX | Σ μ(S) ≥ p }


Composition
The composition ⊗ of one-step semantics is defined by pasting :


 L1 
 ,¸,
 L2 
 ¸ ,¸,
	L1L2	
 ¸ ,¸,	 ¸

uj ⊗
1
uj .=
2
,δz1⊗δ2

,, 	,, 
T1	T2
,,	
T1T2

i.e. δ1 ⊗ δ2 .= δ1T2 ◦ L1δ2.
Lemma 3.12 The composition ⊗ of one-step semantics is a bifunctor, mapping each pair of morphisms (τo, νo) : δ1 → δ3 and (τe, νe) : δ2 → δ4 to a morphism from δ1 ⊗ δ2 to δ3 ⊗ δ4 and deﬁned by the horizontal composites


	L2	L1
op	op
2	1

 τez˛r,  τoz˛r, ,  νez˛r,  νoz˛r, 

L4	L3
op	op
4	3

Theorem 3.13 (Monoidal structure) The composition ⊗ of one-step semantics with the identity semantics (I, I, id P ) is a strict monoidal structure on CoLog.
Example 3.14 A simple Segala system over a set A of actions [28] is a coalgebra for the composite PA ◦ D. Thus, a one-step semantics for simple Segala systems can be obtained as the composite of the A-fold coproduct of (M, P, δ) and the one-step semantics of probabilistic modal logic.
Mate correspondence
To finish our study on CoLog, we study the mate correspondence of one-step semantics, a tool used first by Klin [14] to analyse one-step expressiveness of coalgebraic logic in a categorical approach:
Definition 3.15 Suppose that P has a dual adjoint S. The mate δ∗ of a natural transformation δ : LP ⇒ PT is a natural transformation from TS to SL defined by the pasting diagram
,˛,,



in the opposite of X , that is, δ∗ = SLη ◦ SδS ◦ ϵTS.
The mate operation maps a one-step semantics to an object of the comma category CoLog∗ .= (S∗↓S∗). Furthermore:
Proposition 3.16 CoLog is dually isomorphic to CoLog∗ where a one-step se- mantics (L, T, δ) is mapped to its mate (T, L, δ∗).
Remark 3.17 By this isomorphism, colimits and limits in CoLog are transposed to their duals in CoLog∗, but more specifically, it can be shown that every (pointwise) colimit in CoLog can be constructed as a pointwise limit in the arrow category, to be used in Theorem 5.10. A bifunctor ⊕ defined by θ1 ⊕ θ2 .= θ1L2 ◦ T1θ2 with the identity id : S ⇒ S defines a strict monoidal structure on CoLog∗, which is the image of (⊗, id ) under the mate correspondence.
Fibre categories of CoLog
Definition 3.18 For every endofunctor T of X , the category CoLogT is defined to be the fibre category over T . More precisely, the objects of CoLogT are one-step

semantics of type T , denoted (L, δ). A morphism τ from (L, δ) to (Lj, δj) isa natural transformation satisfying δ = δj ◦ τP (i.e. a syntax translation).
The type functor being fixed, we focus on the syntax projection functor which maps UL : (L, δ) '→ L and τ '→ τ .
Proposition 3.19 The following statements hold:
UL reflects isomorphisms.
	For every coreflective subcategory C of the functor category [A , A ], the pullback of the full inclusion i : C ‹→ [A , A ] along UL : CoLogT → [A , A ] is coreflective.
UL creates pointwise colimits.
We are ready to establish a fundamental theorem for coalgebraic modal logics representable as one-step semantics:
Theorem 3.20 Suppose that P has a dual adjoint S. Then every ﬁbre CoLogT has a terminal object
(PTS, PTϵ : PTS P ⇒ PT )
where ϵ : I → SP is the counit of the dual adjunction.
In every fibre category CoLogT , this terminal object is called the full one-step semantics for T . It may be too elusive for practical purposes, but conceptually it explains that every collection of modalities may be viewed as a (uniquely determined) fragment of this canonical one-step semantics.
Equational One-Step Semantics
We now focus on one-step semantics whose syntax functor is defined by operations and equations, called equational. To work with equational one-step semantics, we use finitely based functors (as introduced in Section 2) as syntax functors. Equational one-step semantics are characterised as (generalised) predicate liftings subject to equations. In particular, a full equational one-step semantics exists and is the logic of all predicate liftings subject to a complete axiomatisation up to isomorphism.
The category of equational one-step semantics
Definition 4.1 A one-step semantics (L : A → A ,T, δ) is (finitary) equational if A is a variety and L is finitely based. ECoLog is the corresponding full subcategory of CoLog.
The examples given in Section 3 are equational, since BA is a variety and M, LΛ for a set Λ of predicate liftings, and L∇T for a finitary and weak-pullback preserving functor T , are all finitely based.
It is not hard to show that the composite L1 ◦ L2 of finitely based functors remains finitely based, so every composite of equational one-step semantics remains equational.

Proposition 4.2 The composition ⊗ on ECoLog with the identity semantics
(I, I, id P ) is a strict monoidal structure on ECoLog.
By applying Proposition 3.7 to the finitely based coreflection ρL : Lω ⇒ L, every one-step semantics has an equational coreflection:
Proposition 4.3 ECoLog is a coreflexive subcategory of CoLog. Therefore, ECoLog
is closed under colimits of CoLog.
As we are actually interested in equational one-step semantics rather than all one-step semantics, the coreflection ensures that colimits are still constructed as in CoLog. By Proposition 2.8, this is also true for finite products:
Proposition 4.4 Suppose that P has a dual adjoint. Pointwise ﬁnite products in
ECoLog coincide with products in CoLog.
Corollary 4.5 The category of equational one-step semantics over the contravariant 2—, Q, C, and S in Example 2.2, respectively, has colimits and ﬁnite products constructed pointwise.
For example, the one-step semantics for alternating systems in Example 3.11 is indeed a product in ECoLog.
The universal property of (co)limits hints at certain optimal conditions. For instance, the fusion of predicate liftings [8], known as the smallest conservative extension of two given logics of predicate liftings, is in fact the coproduct in ECoLog of the corresponding equational one-step semantics:
Example 4.6 (Binary coproduct as fusion) Given two sets Λ1 and Λ2 of polyadic predicate liftings for Set functors T1 and T2, respectively, the coproduct of the one-step semantics induced by (Λi)i=1,2 consists of T1 × T2, as its type, and L .=
Λ1	Λ2 ∼	.
L	+ L	= H^Λ with Λ .= Λ1 + Λ2, as its syntax, and as its interpretation the
natural transformation δ : LQ⇒ QT defined for each set X on the generators of L
by
—1
i
for each λ ∈ Λi,n and n-tuple S = (Sj)j∈n.
Fibre categories of ECoLog
Definition 4.7 For any endofunctor T of X , ECoLogT is defined to be the fibre category of ECoLog over T .
By Proposition 3.19, each ECoLogT is a coreflective subcategory of CoLogT . Now the equational version of Theorem 3.20 follows, as the coreflector preserves limits, including the terminal object:
Corollary 4.8 Suppose that P has a dual adjoint S. Every ﬁbre ECoLogT has a terminal object
 P^TSω, PTϵ ◦ ρP : P^TSωP → PT 

where ρ is the ﬁnitely based coreflection P^TSω ⇒ PTS and ϵ is the counit of the dual adjunction.
Again, this terminal object is called the full equational one-step semantics
for T , and every equational one-step semantics for T is a fragment of it.
The remaining part of this section is used to describe equational one-step se- mantics as logics of predicate liftings subject to rank-1 equations.
Predicate liftings
Definition 4.9 Let U : A → Set be a functor and T an endofunctor of X . A (finitary) predicate lifting for T is a natural transformation from (UP )n to UPT where n ∈ N.
When P = Q, this definition boils down to the usual definition of polyadic predicate liftings, since the underlying set UQX is the powerset 2X .
Example 4.10 When P = S: Meas → MSL, a predicate lifting for T maps a measurable set of a measurable space X = (X, SX ) to a measurable set on TX natural in X. Take the Giry monad G, for example; G maps a space (X, SX ) to the collection of subprobability distributions μ : SX → [0, 1] satisfying
μ(∅)=0	and	μ(  Mi)= Σ μ(Mi)

for countable unions of pairwise disjoint measurable sets Mi (the σ-algebra on GX
is ignored). Then a predicate lifting for G can be defined for each p ∈ [0, 1] by
M '→ { μ ∈ GX | μ(M ) ≥ p }
for M ∈ SX , which is exactly the modality in [11, Section 4.3].
Assume that A is a variety and F denotes the left adjoint to the forgetful functor U . Every n-ary predicate lifting λ for T determines a one-step semantics (FUn, λ∗), called the unimodal logic of λ, where λ∗ : F (UP )n ⇒ PT is the trans- pose of λ by adjunction. A set Λ of predicate liftings for T determines a one-step semantics, called the logic of predicate liftings, consisting of

H^Λ = F    Λn × (U—)n	and	δΛ : H^ΛPX ⇒ PTX,
n∈N
mapping generators (λ, S) to λX (S) for λ ∈ Λn and S = (Si ∈ UPX)i∈n.
Moreover, every finitely based functor L is a coequaliser of parallel morphisms
HE ⇒ HΣ → L, so characterisations follow readily:
Corollary 4.11 For every endofunctor T of X ,
every logic of predicate liftings for T is a coproduct of unimodal logics;
every object in ECoLogT is a coequaliser of a logic of predicate liftings.

Translations between equational one-step semantics
By Corollary 4.11, a morphism from (Lj, δj) to (L, δ) in ECoLogT boils down to a family of translations from a unimodal logic to (L, δ), indexed by some set Λ of predicate liftings λ:
F (UPX)n 	τP X	,LP,X

r 
PTX.
Commutativity implies that a translation is not only a syntactic translation but also preserves the interpretation.
Example 4.12 (Continuing Example 3.5) Possibility 3 and necessity  can be translated to the cover modality ∇ by setting
  ϕ .= ∇{ϕ}∨ ∇∅	and	3ϕ .= ∇{ϕ, T}.
The syntactic translation defines a morphism τ from the one-step semantics (M, δ)

to the one-step semantics (F Pω
U, ∇Pω ) of the cover modality, i.e. ∇◦ τ Q = δ. 5

Equations valid under an interpretation
Let Λ be a set of predicate liftings. A rank-1 Λ-term in n variables can be interpreted by a function that maps any n-tuple of predicates on X to a predicate on TX as follows. By adjunction, every n-tuple S = (Si ∈ PX) is presented as a morphism
(Fn —→a PX). Define the interpretation [—]]S	for terms with n variables as the

composite

U Hˆa

UδΛ

where δΛ
U HΛFn ————Λ→ U HΛPX ———X→ UPTX
is the logic of predicate liftings in Λ.

Definition 4.13 Given a set Λ of predicate liftings for T , a rank-1 equation t ∼ tj

of Λ is valid under the interpretation of Λ if [t]]S
= [[tj]]S
for any X and

n-tuple (Si ∈ UPX).
The universal quantifiers can be simplified to a pair of parallel morphisms:
Theorem 4.14 Given a set Λ of predicate liftings for T and families of rank-1 Λ-equations En with n variables indexed by n ∈ N, the following statements are equivalent:
For each n, every equation t ∼ tj ∈ En is valid under the interpretation of Λ.
The following diagram commutes


 π1P ,,
£		,,Λ
π2P
δΛ ,P,T 



5 For consistency, we restrict to the finitary powerset functor Pω , otherwise F PU is not finitely based.

where π1, π2 : H£ ⇒ HΛ are the parallel morphisms induced by E = (En)n∈N.
Therefore, a regular quotient of a one-step semantics in ECoLogT retains the set of modalities but they are subject to more equations. Moreover, every translation factors through a regular quotient:
Theorem 4.15 For every T, the category ECoLogT has (RegEpi,U—1Mono) as a factorisation system where U is the forgetful functor U : ECoLogT → FinB[A , A ].
This factorisation system also leads us to an important notion:
Definition 4.16 An equational one-step semantics for T is said to have a complete axiomatisation if it has no proper regular quotient in ECoLogT .
Informally, a one-step semantics (L, δ) has a complete axiomatisation if every rank-1 equation valid under the interpretation δ is derivable from the presentation of L. Note that this is not model-theoretic completeness.
Example 4.17 The one-step semantics (M, δ) of classical modal logic has a complete axiomatisation. Any proper regular quotient of M would identify a rank-1 equation which is not derivable from ◆⊥ = ⊥ and ◆(a ∨ b) = ◆a ∨ ◆b. However, classical modal logic is complete with respect to the class of all Kripke frames, so there exists an instance refuting the equation, a contradiction. Thus (M, δ) has a complete axiomatisation.

Objects of predicate liftings
Using the Yoneda Lemma, Sch¨oder observes [26] that n-ary predicate liftings in the case where P = Q are in bijection with the subsets of T 2n, because UQ = 2— is naturally isomorphic to hom(—, 2). We generalise and combine this with Klin’s objects of T-modalities [14], again employing the Yoneda Lemma and the dual adjunction:
Lemma 4.18 Suppose that P has a dual adjoint S and A is a variety with a left adjoint F to the forgetful functor U. For any endofunctor T of X , the following statements hold:
For any n ∈ N, the set U (PTS)Fn is in bijection with the collection of n-ary predicate liftings.
The bijection is natural in objects n in the Kleisli category of the induced monad
UF.
That is, PTSFn is precisely the object of n-ary predicate liftings. This ensures that the collection of all finitary predicate liftings is small, so a coproduct of all unimodal logics exists. Naturality means that for any function f : n → UFm between

free algebras, the diagram

	[—]	
UPTSFn	,Na,t(UP ,UPT )

UP T Sƒ¯
, 	
ƒˆ∗
,	m

UPTSFm
[—]
,Na,t(UP 
,UPT )

commutes, where [—] indicates the bijection from UPTSFn to the collection of
n-ary predicate liftings, f¯ is the transpose of f , and fˆ∗ is pre-composition with


fˆ: (m —→a
ƒ
UP ) '→ (n —→
UFm —U—→a 
UFUP —U—є—→P
UP ).




Remark 4.19 Note that the forgetful functor U : A → Set is naturally isomorphic to hom(F 1, —) by adjunction, so the composite UP is naturally isomorphic to hom(—, SF 1) by dual adjunction. Let Ω be SF 1. Then, an n-ary predicate lifting is a natural transformation from hom(—, Ω)n to hom(T—, Ω), which is in a more familiar form. Specifically, the underlying set of SF 1 is a two-element set of truth values for the dual adjoints in Example 2.2.

Characterising the full equational one-step semantics
The finitely based part P^TSu of PTS has a canonical presentation, so the full equa- tional one-step semantics is a regular quotient of the one-step semantics consisting of
F	UPTSFn × Un	and	(PTϵ ◦ ρP ) ◦ e	(4)
n∈N
where ρ : P^TSu ⇒ PTS is the coreflection and e the regular quotient. We call (4) the logic of all predicate liftings for T .
Lemma 4.20 The following statements hold:
The logic of all predicate liftings is a coproduct of all unimodal logics.
The full equational one-step semantics has a complete axiomatisation.
Theorem 4.21 An equational one-step semantics (L, δ) of type T is isomorphic to the full equational one-step semantics iff (L, δ) has a complete axiomatisation and every unimodal logic has a translation to (L, δ).
Proof sketch By the previous lemmas, the ‘only if’ part follows. For the converse, let (L, δ) be a one-step semantics with a complete axiomatisation such that every unimodal logic has a translation to it. By assumption, there exists a mediating morphism τ from the logic (LΛ, δΛ) of all predicate liftings to it, since (LΛ, δΛ) is a coproduct of all unimodal logics. Consider the pushout of τ and the regular quotient

e from (LΛ, δΛ) to the full equational one-step semantics:
(LΛ, δΛ) 	e	,(P^,TSu,PTϵ ◦ ρP )
τ
,	j ,j 
(L, δ)	,(L,,δ ).
Using the factorisation system on ECoLogT and the fact that the full semantics is terminal, the statement follows.	 

Logic of a One-Step Semantics
We remind the reader how a one-step semantics provides a coalgebraic modal logic, and refine Klin’s expressiveness condition [14] for finitary functors. We also address the modularity problem of expressiveness.
 For the sake of brevity, we restrict our discussion to the case of a one-step semantics which has a language (see below). Also, we assume that P has a
dual adjoint S.

Logical setup
Definition 5.1 The language of (L, T, δ) is the initial L-algebra, denoted (ΦL, αL).
The initial L-algebra can be constructed by the initial sequence [1]. For a finitary functor L, the following ω-sequence starting from the initial object 0:
0   !	,L0,  L! ,· ·,·	,Li,0 Li! ,· ·,· 
has a colimit (fi : Li0 → Lu0)i∈u. Then, by L being finitary, it is not hard to conclude that there exists an isomorphism β : Lu0 → LLu0, so we can set ΦL .= Lu0 and αL .= β—1 for the initial L-algebra.
Definition 5.2 The semantic interpretation [[—]](X,ξ) of a language (ΦL, αL) in a T -coalgebra (X, ξ) is the unique L-algebra homomorphism from (ΦL, αL) to the L-algebra (PX, Pξ ◦ δ).
The logic of (L, T, δ) refers to the language of L and its semantic interpretation. The interpretation [—]] maps a formula ϕ, as an element of Φ, to the subset of X consisting of those states that satisfy ϕ. For example, if the syntax functor is induced by a set λ ∈ Λ of (unary) predicate liftings, then α(λ, ϕ) represents the modal formula λϕ. The semantics [λϕ ] on a T -coalgebra (X, ξ) is given by the diagram
LΦ 	α	,Φ,

L[[—]]
, 
[[—]]
, 

LPX	δX	,P,TX	Pξ	,P,X 

so that [λϕ]] = (Pξ ◦ δX ◦ L[[—]])(λ, ϕ) = Pξ(λX [[ϕ]]). By definition, soundness is easy to see, since any rank-1 equation encoded in the syntax functor L is valid in the language (ΦL, αL).
Definition 5.3 The theory map for a T -coalgebra (X, ξ) is the transpose
th : X → SΦ of the semantic interpretation [— ] under the dual adjunction S E P .
Intuitively, the theory map simply maps every state x to the collection of formulae satisfied by x, which is indeed the case for, say, the dual adjoints in Example 2.2.
Assuming that X has kernel pairs, define logical equivalence of a theory map thξ to be the kernel of thξ; a logic of (L, T, δ) may then be said to be expressive if the logical equivalence is contained in some kernel of a coalgebra homomorphism regarded as an X -morphism. For concrete categories, such as Set and Meas, two elements x and y of a coalgebra (X, ξ) are logically equivalent if thξ(x) = thξ(y); two elements are behaviourally equivalent if there exists a coalgebra homomorphism f with fx = fy, and thus a logic is expressive if logically equivalent elements are also behaviourally equivalent. 6
It is known that behavioural equivalence implies logical equivalence, i.e., adequacy
holds. The converse, expressiveness, is more interesting, and we turn to it next.
Expressiveness
We have shown that every equational one-step semantics has a unique translation to the full equational one-step semantics (Corollary 4.8), which is in fact the most expressive logic, so its expressiveness is equivalent to the existence of an expressive logic of some one-step semantics:
Theorem 5.4 Every morphism in CoLogT preserves expressiveness.
Recall Klin’s general condition for expressiveness in the functorial framework (in the formulation by Jacobs and Sokolova [11]):
Theorem 5.5 (see [14,11]) Suppose that X has a proper factorisation system (S, M). Then, if a) T preserves M-morphisms and b) the mate δ∗ is a pointwise M-morphism, then th(x)= th(y) implies that x and y are behaviourally equivalent.
Note that this result only gives sufficient conditions for expressiveness, but on the positive side, these conditions are particularly suitable for further generalisation. Hence, in the presence of a proper factorisation system, we define an equational one-step semantics of T to be one-step expressive ifa) T preserves M-morphisms, and b) the mate δ∗ is a pointwise M-morphism.
Expressiveness for ﬁnitary functors
We restrict attention to strongly locally finitely presentable categories:

6 The justification of this point-free formulation may be found in [6, Section 4.1.5] (it assumes the existence of a proper factorisation system). In the following we will simply assume that X is concrete though this does not necessarily imply the existence of kernel pairs.

Definition 5.6 (see [2]) A locally finitely presentable category is strongly loc- ally finitely presentable if for every cofiltered limit (σi : Y → Yi)i∈I and every monomorphism f : X ‹→ Y with X finitely generated, there is i ∈ I such that the composite σi ◦ f is monic.
For example, Set, Pos, and VecK are strongly locally finitely presentable. Klin showed [14] that when A is a locally finitely presentable category the full ﬁnitary one-step semantics 7 of a finitary functor on a strongly locally presentable category is one-step expressive if the counit ϵ : I → SP is pointwise monic. We adapt Klin’s argument and apply it to the full equational one-step semantics in the case that A is a variety. By Theorem 5.4, the equational version also recovers the finitary one.
Theorem 5.7 (cf. [14, Theorem 4.4]) Let X be a strongly locally presentable category, A a variety, and T : X → X a ﬁnitary and monomorphism-preserving functor. If the counit ϵ : I → SP is pointwise monic, then the full equational one-step semantics of T is one-step expressive.
Proof sketch Klin’s theorem for full finitary one-step semantics is established in two steps. Let Au be the full (small) subcategory on finitely presentable objects. First it is shown that if for every A the source
 TSf : TSA → TSAi}ƒ∈(Aω↓A)	(5)
is jointly monic, then the mate δ∗ is pointwise monic where (Au↓A) is the comma category from Au to A. Second, the family (5) is shown to be jointly monic by the strong local presentability.
For the same reason, to show that δ∗ is pointwise monic, it suffices to show that the source
 TSg : TSA → TSFn}g∈(A f ↓A)	(6)
g
is jointly monic. However, every morphism (Fn —→ A) factors through a regular
epimorphism e : Fn → B with B finitely presentable, and TSe is a monomorphism by the dual adjunction and assumption. It is easy to see that (6) is jointly monic if and only if (5) is jointly monic. Then Klin’s second step completes this proof. 

Modularity of one-step expressiveness
As we discussed colimits, finite products, and compositions on CoLog, it is of interest to know if one-step expressiveness is stable under these constructions at this level of generality. Surprisingly, compositions and colimits preserve one-step expressiveness in a straightforward way:
Theorem 5.8 The composite δ1 ⊗ δ2 of one-step expressive semantics (L1, T1, δ1)
and (L2, T2, δ2) is one-step expressive for T1T2.

7 This terminology is defined analogously: A one-step semantics is finitary if its syntax functor is finitary on a locally finitely presentable category. The full finitary one-step semantics for T is the terminal object in the category of finitary one-step semantics for T by Proposition 3.19.

Proof By Remark 3.17, the mate of δ1 ⊗ δ2 is equal to δ∗L2 ◦ T1δ∗. By assumption,
1	2
Ti preserves M-morphisms and δ∗ is a pointwise M-morphism for i = 1, 2. Hence the
composite δ∗L2 ◦ T1δ∗ is a pointwise M-morphism. By assumption, T1T2 preserves
1	2
M-morphisms.	 
Example 5.9 The double finite powerset functor Pu ◦ Pu does not have a separating set of unary predicate liftings [26]. However, we may simply self-compose the usual one-step semantics for Pu to obtain a one-step expressive logic.
Theorem 5.10 The pointwise colimit of one-step expressive semantics is one-step expressive.
Proof Let D be a diagram in CoLog. The colimit of D is a one-step semantics of type LimiTi. By assumption, each Ti preserves M-morphisms and by Proposition 3.19, M-morphisms are closed under limits in X →, so LimTi preserves M-morphisms.
The mate of (ColimD) is a pointwise M-morphism: Every D∗ is a pointwise M-morphism by assumption, so the limit of D∗ in the arrow category X → is also a pointwise M-morphism. By Remark 3.17, Lim(D∗) is isomorphic to (ColimDi)∗ and the latter is a pointwise M-morphism since M contains isomorphisms. 
Example 5.11 (Labelling TA) Suppose that X and A have products and cop- roducts, respectively. Let A be a set of labels. Every coalgebra ξ : X → TAX for the A-fold product of T corresponds to a family (ξa)a∈A of T -coalgebras, i.e. an A-labelled T -coalgebra, and the A-fold coproduct of a one-step semantics (L, T, δ) defines a one-step semantics for TA. Moreover, the coproduct is one-step expressive if and only if (L, T, δ) is one-step expressive. The result applies immediately to P,
D, the convex powerset functor Pˆ, and the Giry monad G, to name but a few.
As for finite products, we are encouraged by the result of Cˆırstea’s and Pattin- son [7] that one-step expressiveness is preserved by finite products for one-step semantics over 2—, but we do not have a general proof at this point.
Acknowledgement
We would like to thank Paul Levy, Clemens Kupke and Alexander Kurz for insightful discussions and feedback on the current work.

References
	J. Ad´amek. Free algebras and automata realizations in the language of categories. Comment. Math. Univ. Carolinae, 15(4):589–602, 1974.
J. Ad´amek. On final coalgebras of continuous functors. Theor. Comput. Sci., 294(1-2):3–29, 2003.
J. Ad´amek, Horst Herrlich, and George E. Strecker. Abstract and Concrete Categories. Wiley- Interscience, New York, 1990.
	M. Bonsangue and A. Kurz. Presenting functors by operations and equations. In Proc. FoSSaCS’06, volume 3921 of LNCS, pages 172–186, 2006.
M. Bonsangue and A. Kurz. Pi-calculus in logical form. In Proc. LICS’07, pages 303–312. IEEE, 2007.


L.-T. Chen. On a Purely Categorical Framework for Coalgebraic Modal Logic. PhD thesis, University of Birmingham, 2013. Available from http://etheses.bham.ac.uk/4882/

	C. Cˆırstea and D. Pattinson. Modular construction of complete coalgebraic logics. Theor. Comput. Sci., 388(1-3):83–108, 2007.
F. Dahlqvist and D. Pattinson. On the fusion of coalgebraic logics. In Proc. CALCO’11, volume 6859 of LNCS, pages 161–175, 2011.
	J. Desharnais, A. Edalat, and P. Panangaden. Bisimulation for Labelled Markov Processes. Inf. Comput., 179(2):163–193, 2002.
H. Hansson and B. Jonsson. A calculus for communicating systems with time and probabilities. In
Real-Time Syst. RTSS 90, pages 278–287. IEEE, 1990.
	B. Jacobs and A. Sokolova. Exemplaric expressivity of modal logics. J. Log. Comput., 20(5):1041–1068, 2010.
P. T. Johnstone. Stone spaces. Cambridge University Press, 1982.
K. Kapulkin, A. Kurz, and J. Velebil. Expressiveness of positive coalgebraic logic. In Adv. Modal Log., pages 368–385, 2012.
	B. Klin. Coalgebraic modal logic beyond sets. In Proc. MFPS XXIII, volume 173 of ENTCS, pages 177–201, 2007.
	C. Kupke, A. Kurz, and D. Pattinson. Algebraic semantics for coalgebraic logics. In Proc. CMCS’04, volume 106 of ENTCS, pages 219–241, 2004.
C. Kupke, A. Kurz, and Y. Venema. Stone coalgebras. Theor. Comput. Sci., 327(1–2):109–134, 2004.
A. Kurz. Coalgebras and their logics. SIGACT News, 37(2):57–77, 2006.
	A. Kurz and R. A. Leal. Modalities in the stone age: A comparison of coalgebraic logics. Theor. Comput. Sci., 430:88–116, 2012.
	A. Kurz and D. Petri¸san. Presenting functors on many-sorted varieties and applications. Inf. Comput., 208(12):1421–1446, 2010.
	A. Kurz and J. Rosicky´. Strongly complete logics for coalgebras. Log. Methods Comput. Sci., 8:1–32, 2012.
	R. A. Leal. Predicate liftings versus Nabla modalities. In Proc. CMCS’08, volume 203 of ENTCS, pages 195–220, 2008.
S. Mac Lane. Categories for the Working Mathematician. Springer, 2 edition, 1998.
L. S. Moss. Coalgebraic Logic. Ann. Pure Appl. Log., 99(1-3):241–259, 1999.
D. Pattinson. Coalgebraic modal logic: soundness, completeness and decidability of local consequence.
Theor. Comput. Sci., 309(1-3):177–193, 2003.
	D. Pattinson. Expressive logics for coalgebras via terminal sequence induction. Notre Dame J. Form. Log., 45(1):19–33, 2004.
	L. Schr¨oder. Expressivity of coalgebraic modal logic: The limits and beyond. Theor. Comput. Sci., 390(2-3):230–247, 2008.
L. Schr¨oder and D. Pattinson. Modular algorithms for heterogeneous modal logics via multi-sorted coalgebra. Math. Struct. Comput. Sci., 21(02):235–266, 2011.
R. Segala. Modeling and Verification of Randomized Distributed Real-Time Systems. PhD thesis, Massachusetts Institute of Technology, 1995.
	J. Velebil and A. Kurz. Equational presentations of functors and monads. Math. Struct. Comput. Sci., 21(02):363–381, 2011.
