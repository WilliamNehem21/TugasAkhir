Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 346 (2019) 685–697
www.elsevier.com/locate/entcs
Equitable Total Chromatic Number of Kr×p
for p Even1
Anderson G. da Silva2
DMAT, Pontif´ıcia Universidade Cat´olica do Rio de Janeiro, Brazil.
Simone Dantas2
IME, Universidade Federal Fluminense, Brazil.
Diana Sasaki2
IME, Universidade do Estado do Rio de Janeiro, Brazil.

Abstract
A total coloring is equitable if the number of elements colored by any two distinct colors differs by at most one. The equitable total chromatic number of a graph (χ′′) is the smallest integer for which the graph has an equitable total coloring. Wang (2002) conjectured that Δ + 1 ≤ χ′′ ≤ Δ + 2. In 1994, Fu proved that there exist equitable (Δ + 2)-total colorings for all complete r-partite p-balanced graphs of odd order. For the even case, he determined that χ′′ ≤ Δ+ 3. Silva, Dantas and Sasaki (2018) verified Wang’s conjecture when
G is a complete r-partite p-balanced graph, showing that χ′′ =Δ + 1 if G has odd order, and χ′′ ≤ Δ+2 
e	e
if G has even order. In this work we improve this bound by showing that χ′′ =Δ + 1 when G is a complete
r-partite p-balanced graph with r ≥ 4 even and p even, and for r odd and p even.
Keywords: Equitable total coloring, complete r-partite p-balanced graphs, graph coloring.


Introduction
Throughout this paper all graphs analyzed are finite, undirected and simple. Let G = (V, E) be a graph. A k-total coloring of G is an assignment of k colors to the vertices and edges of G so that adjacent or incident elements have different colors. The total chromatic number of G, denoted by χjj, is the smallest k for which G has a

1 This study was financed in part by the Coordena¸c˜ao de Aperfei¸coamento de Pessoal de N´ıvel Superior - Brasil (CAPES) - Finance Code 001, CNPq, FAPERJ (Brazilian research agencies) and L’oreal-UNESCO- ABC Para mulheres na Ciˆencia 2017
2 Email: andersongs@mat.puc-rio.br, sdantas@id.uff.br, diana.sasaki@ime.uerj.br.

https://doi.org/10.1016/j.entcs.2019.08.060
1571-0661/© 2019 The Author(s). Published by Elsevier B.V.
This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).

k-total coloring. From the definition of total coloring, we have that χjj ≥ Δ+1 and the Total Coloring Conjecture (TCC) (Behzad [2], Vizing[13]) states that the total chromatic number of any graph is at most Δ+ 2, where Δ is the maximum degree of the graph. In 1989, S´anchez-Arroyo [10] proved that the problem of determining the total chromatic number of an arbitrary graph is NP-hard, and it remains NP-hard even for cubic bipartite graphs.
An equitable total coloring is a total coloring that satisfies the additional property that the difference between the cardinalities of any two color classes is at most 1. The equitable total chromatic number of a graph G, denoted by χjj, is the least integer for which G has an equitable total coloring. In 2002, Wang [14] conjectured that the equitable total chromatic number of any graph is at most Δ + 2 (Equitable Total Coloring Conjecture (ETCC)). Ever since, many papers have been published in this subject [5,7,8]. In 2016, Dantas, de Figueiredo, Mazzuoccolo, Preissmann, dos Santos and Sasaki [5] proved that the problem of determining the equitable total chromatic number of a cubic bipartite graph is NP-complete.
In 1974, the total chromatic number of all complete r-partite p-balanced graphs was determined by Bermond [3]. A complete r-partite p-balanced graph, denoted by Kr×p, is a graph where the vertex set can be partitioned into r independent sets X1, ··· , Xr, such that |Xi| = p, i = 1,..., r, and there is an edge between any two vertices of different parts. In 1994, Fu [6] determined that the equitable total coloring of complete bipartite graphs is Δ + 2 and proved that there exist equitable (Δ + 2)-total colorings for all complete r-partite graphs of odd order. Silva, Dantas and Sasaki [11] determined the equitable total chromatic number for two classes of complete r-partite p-balanced graphs: r ≥ 4 even and p odd (χjj = Δ + 2); and r
and p odd (χjj =Δ + 1).
In this paper, we improve the existing previous bounds by proving that χjj = Δ + 1 when the graph is a complete r-partite p-balanced with r ≥ 4 even and p even, or r odd and p even, concluding all cases of this class.

Preliminaries
We adopt the following convention regarding the complete r-partite p-balanced graphs. The display of the vertices of Kr×p is similar to a matrix with r columns and p rows, where each column represents a part Xi of the partition of the vertex set. The vertex xij is the j-th vertex of the part Xi and it is assigned to the j-th row and i-th column. We define a horizontal edge as an edge xijxi′j (see Figure 1c). Also, a matching of distance l between rows j and jj (1 ≤ j < jj ≤ p) is defined as the matching {xijxi+l,j′ |1 ≤ i ≤ r}, where the index i + l is taken modulo r. It is easy to see that there are r − 1 matchings of distance linking the vertices of any two rows, say j and jj, because there are r − 1 edges linking a given vertex in the j-th row and the vertices of the jj-th row and each one of these edges belong to a different matching of distance.
In a graph total coloring, we say that a color is represented in a vertex if it is either the color of the vertex itself or if it is the color of an incident edge to the

vertex in question.
Throughout the paper, we use matchings of the complete graph. The graph Kr is the complete graph having r vertices, in which r represents the number of parts of Kr×p. In this case, we denote its matchings by Rt. Similarly, the graph Kp is the complete graph having p vertices, in which p represents the number of vertices in each part of Kr×p. In this case, we denote its matchings by Pt. The following two results about matchings of complete graphs are due to Soifer [12]. Let Kn be the complete graph on n vertices. If n ≥ 4 is even, then this graph has n − 1 disjoint perfect matchings; and if n ≥ 3 is odd, then this graph has n disjoint matchings.
A Latin square of order r is an r × r matrix whose entries are the elements of the set {1, 2, ··· , r} such that each symbol occurs precisely once per row and per column. Given a Latin square of order r, a transversal is a set of r different entries of different rows and columns. McKay, McLeod and Wanless [9] proved the following theorem:
Theorem 2.1 (McKay, McLeod and Wanless, 2006) Let T (r) be the maximum number of transversals over all Latin squares of order r, then bk ≤ T (k) for k ≥ 5, where b ≈ 1, 719.
It is possible to use this result to prove that there exists a Latin square of even order r ≥ 4 whose elements in the main diagonal are pairwise different. In fact, for our purposes, we will need Latin squares which are more restricted, as follows.
Lemma 2.2 There exists a Latin square of even order r ≥ 4 whose main diagonal is 1, 2, 3,..., r.
Proof. Let A be the Latin square we are building and let aii′ be the entry of the i-th row and ij-th column of A. We observe that indices must be taken modulo r and if the index is congruent 0 modulo r, then such index is r, instead of 0. Let c be one of the elements of the set {1, ··· , r}, which will be the entries of the Latin square A.
The entries which receive color c =1 are: a1,1; ai,i+1 for 2 ≤ i ≤ r − 1; and ar,2.
The entries which receive color c, for 2 ≤ c ≤ r− 2 are: ai,(i+c+1) for 1 ≤ i ≤ c− 1; acc; ai,(i+c) for c +1 ≤ i ≤ r − 1; and an,(c+1).
The entries which receive color c = r − 1 are: ai,2i for 1 ≤ i ≤ r/2; and ai,(2i−r+1)
for (r/2) + 1 ≤ i ≤ r.
The entries which receive color c = r are: ai,(2i+1) for 1 ≤ i ≤ r/2; and ai,(2i−r)
for (r/2) + 1 ≤ i ≤ r.
By construction, it is easy to see that the diagonal entries are 1, 2, ··· , r, as claimed. Supposing that two entries in the same row or column receive the same element, it is easy to reach a contradiction.	2
For classical results in Latin squares, we also refer to [4]. An example of the output of the algorithm of Lemma 2.2 for the case r = 4 can be seen in the following matrix.

⎡1 3 4 2⎤ 4 2 1 3
2 4 3 1
3 1 2 4
Kr×p, with r ≥ 4 even and p even
Next, we prove that Kr×p has χjj = Δ + 1 for r ≥ 4 even and p even by showing three different algorithms according to the value of p. The general idea of these algorithms is to color the vertices first and to represent such colors on the other vertices. Then, the uncolored remaining elements are edges that can be grouped into matchings of distance. For the case p = 4, it was necessary to introduce an algorithm different than the one for p = 2 because the pattern for the coloring of the vertices of the part X4 needed to be different, as we will explain later. The case p = 4 could not be extended for p ≥ 6 because of the coloring of the horizontal edges and so we develop a third algorithm for that case.
Algorithm for the case p =2 
We show that χjj(Kr×2)=Δ + 1= 2r − 1,r ≥ 4 even. The idea of the coloring is: we first obtain a Latin square of order r to determine the colors of vertices and non horizontal edges. Then, we use the matchings of Kr to determine the colors of horizontal edges.
We construct a coloring matrix A12 that will give the colors of edges of distance between rows 1 and 2 and the colors of the vertices of Kr×2 of order r, in which the entry aii′ represents the color of the edge xi1xi′2, 1 ≤ i < ij ≤ r; and the entry aii represents the color of each vertex in part Xi.
Since Δ + 1 = 2r − 1 in this case, r − 1 colors still need to be used. They are attributed to the horizontal edges as follows. We obtain the r − 1 matchings Rt of Kr. For each t = 1, 2, ··· ,r − 1, if Rt = {vivi′ , ··· , vi′′ vi′′′ }, then the edges xi1xi′1, ··· , xi′′1xi′′′1 and xi2xi′2, ··· , xi′′2xi′′′2 of Kr×2 receive the same color. For example, for the case K4×2, we consider the following matchings of K4: R1 = {v1v2, v3v4}, R2 = {v2v3, v1v4}, R3 = {v1v3, v2v4} (see the example of K4×2 in Figures 1c and 1d).
The matrix A12 is a Latin square whose elements of the main diagonal are all distinct. Lemma 2.2 gives a construction of such a matrix (see an example in Figures 1a and 1b). Since the vertices of different parts are adjacent, the fact that the elements of the main diagonal are all distinct implies that vertices of different parts do not receive the same color. The fact that elements do not occur more than once per rows or columns implies that non horizontal edges and vertices that are adjacent or incident do not receive the same color. Since the other colors are attributed to horizontal edges determined by the matchings Rt, then adjacent edges

do not receive the same color. The first set of colors appears r times in the coloring matrix A12, being r − 1 times in edges and twice in vertices, totalizing r + 1 times. Each one of the r − 1 remaining colors is used in a perfect matching of Kr×2, that is, in r edges. Therefore, the difference between the cardinalities of any two color classes is at most 1, as desired.





A12
⎡1 3 4 2⎤
= ⎢⎢4 2 1 3⎥⎥ 3 1 2 4 

Coloring matrix
Coloring of non hori- zontal edges


(d) Matchings of K4
Coloring of horizontal edges

Fig. 1. Example of coloring K4×2

Algorithm for the case p =4 
We show that χjj(Kr×4)= Δ + 1= 4r − 3, r ≥ 4 even. The idea of this coloring is the following. First we color the vertices using colors 1, 2,..., 2r. Then, we use such colors on the horizontal edges of Kr×4. Next, we apply the r − 1 colors 2r +1 to 3r − 1 on matchings of distance linking vertices of rows 1 and 3; 2 and 4. The next step is to take the 2r colors of the vertices and color the edges that do not have these colors represented in their extreme vertices or adjacent edges. After this step, the edges that were not colored form a 2-regular graph, which can be colored with 2 colors.
Let c(x) be the color of vertex x. We color the vertices of Kr×4 in the following way: for i = 1,...,r−1, we have c(xi1)= c(xi2)= i and c(xi3)= c(xi4)= i+(r−1); c(xr1)= c(xr4)= 2r−1, c(xr2)= c(xr3)= 2r. We depict an example of this coloring for K4×4 in Figure 2a.
The r − 1 colors used in vertices of rows 1 and 2 of parts X1, X2, ··· , Xr—1 are applied in horizontal edges of rows 3 and 4 according to the r − 1 matchings of Kr, whereas the r − 1 colors used in vertices of rows 3 and 4 of parts X1, X2, ··· , Xr—1 are applied in horizontal edges of rows 1 and 2 according to the r − 1 matchings of Kr. That is, for each t = 1, 2, ··· ,r − 1, if Rt = {vivi′ , ··· , vi′′ vi′′′ }, then use the color of vertices xt1 and xt2 on edges xijxi′j, ··· , xi′′jxi′′′j , j = 3, 4 of Kr×4; and use the color of the vertices xt3 and xt4 on edges xijxi′j, ··· , xi′′jxi′′′j , j = 1, 2 of Kr×4. See an example in Figure 2b.
Like in the previous case, we define p matrices of order r, namely A13, A24, A12, A34, A14 and A23, which store the colors of their respective matchings of

distance. The entry aii′ of the matrix Ajj′ , 1 ≤ j < jj ≤ p represents the color of the edge xijxi′j′ , 1 ≤ i < ij ≤ r; and the entry aii stays empty. We refer to Figure 2c for an example where r = 4. In this figure, the entries of matrices A12, A14, A34 and A23 with asterisk (∗) receive colors later (we reinforce that they are distinct from the empty entries of the main diagonal).
Matrices A13 and A24: we use r − 1 colors (different than the ones used in vertices) in matchings of distance linking vertices of rows 1 and 3, or of rows 2 and 4. This means that matrices A13 and A24 are filled as follows: the entries of the main diagonal stay empty; the first row receive the numbers in ascending order from 2r +1 to 3r − 1 and each row below is filled with the elements of the row above shifted one unity to the right.
Matrices A12 and A34: these matrices are Latin squares of order r with a transversal in the main diagonal constructed from Lemma 2.2 with some changes. The entries of the matrix A12 are the r − 1 colors used in the vertices of rows 1 and 2 of parts X1, X2, ··· , Xr—1, whereas the entries of the matrix A34 are the colors used in the vertices of rows 3 and 4 of parts X1, X2, ··· , Xr—1. We place an asterisk in the entries with color equal to the color of arr and remove the main diagonal entries. The entries marked with an asterisk will receive colors later. Since these matrices come from Latin squares of order r, after this process they are filled with r−1 colors.
Since we are presenting an equitable (Δ + 1)-total coloring of a regular graph, all colors must be represented in every vertex. After coloring horizontal edges and filling matrices A12 and A34, we finish representing colors used in the vertices of parts X1, X2, ··· , Xr—1 in every vertex.
We recall that Δ + 1 = 4r − 3 and, up to this point, we used 2r + (r − 1) colors, i.e., 2r colors in vertices or horizontal edges or A12 or A34, and r − 1 colors in the matrices A13 and A24, and hence there are r − 2 available un- used colors. Also, the colors of the vertices of Xr need to be represented in every vertex. Among these r − 2 available colors, 2 will be used in special matchings and the other r − 4 in matchings of distance linking vertices of rows 1 and 4; and of the rows 2 and 3; that is, they are applied in the matrices A14 and A23.
Matrices A14 and A23: colors 2r − 1 and 2r have been used respectively in the vertices xr1 and xr4; and in the vertices xr2 and xr3. Thus, color 2r − 1 is used in entries a1,r—1, a21, a32, ··· , ar—1,r—2 of the matrix A14, whereas color 2r occupies entries a12, a23, ··· , ar—1,r, ar1 of the matrix A14. Color 2r − 1, by occupying the entries of the matrix A14 cited above, is applied to the edges x11xr—1,4, x21x14, x31x24, ··· , xr—1,1xr—2,4. The first one of these edges belongs to the matching of distance r − 2, whereas the others belong to the matching of distance r − 1 (e.g. by the definition of matching of distance r − 1 above, the edge x21x14 can be written as x21x(2+(4—1)mod4),4). Color 2r, by occupying the entries of matrix A14 cited above, is used in a matching of distance 1 linking vertices of rows 1 and 4. So, colors 2r − 1

and 2r are used in edges that belong to matchings of distance r − 2,r − 1 and 1 linking vertices of rows 1 and 4. Since there are r − 1 matchings of distance, this means that r − 4 matchings of distance remain. Therefore, we can fit r − 4 colors in matchings of distance linking vertices of rows 1 and 4.
Note that color 2r, by being applied in entries of the matrix A14, is not applied in some edges that are part of the matchings of distance r − 1 and r − 2, that are represented by the following entries of the matrix A14: a2r, a31, a42, ··· , ar,r—2, a1r and ar,r—1. Matrix A23 is constructed from matrix A14 by replacing the entries with 2r − 1 by 2r and vice versa.
So far there are entries in the matrices A12, A34, A14 and A23 with (∗). When we look to the i-th row of matrix Ajj′ , all entries of this row represent edges that have xij as one of its ends. Analogously, if we look to the i-th column of the same matrix, the entries of that column represent edges that have xij as one of its ends. By the process of filling the matrices A12, A34, A23 and A14 that we explained above, it can be verified that the asterisk entries form a 2-regular subgraph H of Kr×4. It is known that a graph is 2-regular if and only if its connected components are cycles. We claim that none of the connected components of H is a cycle of odd size. Indeed, the edges that were not assigned to any color yet are the asterisk entries of the matrices A12, A34, A23 and A14, that is, they link vertices of rows 1 and 2, 3 and 4, 2 and 3, 1 and 4. Suppose, by contradiction, that the subgraph H contains a cycle Ck of odd size. Assume, without loss of generality, that the first vertex of Ck, here denoted by v1 is a vertex of the first row. Consequently, the vertex v2 is a vertex of row 2 or 4. Regardless of the possible options for the row where the vertex v2 is, we have that vertex v3 is a vertex of row 1 or 3. Proceeding with this reasoning, we have that the k-th vertex of Ck is either in row 1 or 3, since we are assuming that Ck has odd size. However, since the edge v1vk is of Ck, it follows that vk cannot be in row 1 nor 3. Thus, we get a contradiction. It follows that none of the connected components of H is a cycle of odd size. Thus, the components of H are cycles of even size, whose edges can be colored with 2 colors, as desired. One of these colors is color 4r − 4 = Δ and the other one is color 4r − 3=Δ + 1.

Colors 1, 2, ··· , r
were used in two vertices and in 2r − 1 edges, so they were

used in a total of 2r + 1 elements each. Colors r + 1, ··· , 4r − 3 were used in perfect matchings of Kr×4, totalizing 2r edges each. Therefore, the coloring is equitable, as desired.

⎡	9 10 11⎤
⎡ 3 ∗ 2⎤
⎡ 8 7 ∗⎤


A13
= ⎢11	9 10⎥⎥ A
9 10 11
= ⎢⎢∗	1 3⎥⎥ A
3 1 2 
= ⎢⎢7	8 ∗⎥⎥
8 ∗ ∗ 

⎡	9 10 11⎤
⎡ 6 ∗ 5⎤
⎡ 7 8 ∗⎤




Coloring of ver- (b) Coloring of horizontal
A24
= ⎢11	9 10⎥⎥ A
9 10 11
= ⎢⎢∗	4 6⎥⎥ A
6 4 5 
= ⎢⎢8	7 ∗⎥⎥
7 ∗ ∗ 

tices
edges
(c) Coloring matrices
Fig. 2. Example of coloring K4×4

Algorithm for the case p ≥ 6
We show that χjj(Kr×p) = Δ + 1 = rp − p + 1, r ≥ 4 and p ≥ 6 even. The general idea of the algorithm is the following. We use a perfect matching P1 of Kp to determine the vertices’s colors. By this step, each color is represented in two vertices of the same independent set, and thus they are obviously represented in two different rows in this set. Suppose that a color c is assigned to vertices of rows j and jj. With the next step we represent color c in every vertex of rows j and jj, and we do so using Latin squares, similar to the ones defined for the case p = 2. Since we are constructing an equitable (Δ + 1)-total coloring of a regular graph, all the colors must be represented in every vertex. The colors used so far were represented in some vertices, but not all. So, we use a result of Alspach and Gavlas [1] to finish representing these colors in all vertices of the graph. The remaining colors are used in perfect matchings of Kr×p determined by the matchings of distance of Kp (for non horizontal edges) and by the matchings of Kr (for horizontal edges).
We color the vertices of Kr×p, p ≥ 6 in the following way. Let c(x) be the color of vertex x and let P1 be a perfect matching of the graph Kp (with p edges). Thus,
p	2
for each edge ek = vjvj′ ∈ P1, k = 1, ··· , ( 2 ), we have c(xij)= c(xij′ )= i +(k− 1)r,
for i = 1, ··· , r. We depict an example of this coloring for K4×6 in Figure 3a.
Consider the k = |P1| matrices Ajj′ , ··· , Aj′′j′′′ as described in the beginning of this section for the case p = 2. We apply Theorem 2.1 and Lemma 2.2 to obtain Latin squares with a transversal in the main diagonal , i.e., each edge ek = vjvj′ ∈ P1, k = 1, ··· , ( 2 ) defines a Latin square Ajj′ with colors from (k − 1)r +1 to kr. By the end of this step, colors 1, 2, ··· , rp were used in every vertex of two rows.
However, those colors still need to be represented in the vertices of the other rows. To do so, we use the following result of Alspach and Gavlas [1]:
Claim 3.1 (Alspach and Gavlas, 2001) For positive even integers m and n with 4 ≤ m ≤ n, the graph Kn − I can be decomposed in cycles of size m if and only if the number of edges in Kn − I is a multiple of m, where I is a 1-factor.
For the next step of the algorithm we need to obtain p cycles of size p − 2 of

the graph Kp minus a 1-factor. We observe that Kp − I has  p − p
= p(p—2)

edges. Making m = p − 2 and n = p in Claim 3.1, we conclude that Kp − I can be decomposed into p cycles of size p − 2, as desired.
Suppose, without loss of generality, that Kp − I = Kp − P1, with P1 being a perfect matching of Kp. It is known that edges of every cycle of even size can be partitioned into two perfect matchings. So we divide each cycle in two perfect matchings and we associate them with the edges of P1, so that each edge vjvj′ of P1 is associated to the matchings of the cycle of Kp − P1 that does not contain the vertices vj and vj′ .
With the process of decomposition of Kp − P1, we obtain p cycles. Let Mk and Mj be the matchings obtained from the k-th cycle of the decomposition of Kp −P1, that does not contain the edge vjvj′ . Then, the colors used in the vertices of rows

j and jj of the parts X1, X2, ··· ,Xr
2
must be used in matchings of distance linking

vertices of rows determined by Mk, whereas the colors used in the vertices of rows

j and jj of parts Xr +1, ··· , Xr are used in matchings of distance linking vertices

2	j
of rows determined by Mk. Since there are r − 1 matchings of distance linking
vertices of any two rows and since we used only r (< r − 1) matchings of this kind,
we conclude that this is a valid action.
The objective of decomposing Kp − P1 into cycles to apply the colors that were used in vertices in matchings of distance is to ensure that, at the end of this process, in the matchings P2, P3, ··· , Pp—1, each pair of rows of the graph Kr×p was used the same amount of times. With the step described above, we make sure that each

pair of rows and, consequently, each matching from P2 to Pp—1 was used r
times

in matchings of distance, from a total of r − 1 matchings of this type. This means
that there are still r − 1 − r = r − 1 matchings Pt (2 ≤ t ≤ r). In other words,
 r	2	2
that each one of these colors is applied in a perfect matching of Kr×p, that is, the colors are represented in all the vertices, as desired, since this is an equitable total coloring with Δ + 1 colors of a regular graph (see an example in Figure 3c).
Finally, we apply r − 1 new colors in horizontal edges determined by the match- ings of Kr as follows. If Rt = {vivi′ , ··· , vi′′ vi′′′ }, then we apply one of the new colors in the edges xijxi′j, ··· , xi′′jxi′′′j for all j = 1, 2, ··· , p. Using a different color to each matching Rt of Kr, we conclude that r − 1 colors are used in this step, as claimed.
We use rp +  r − 1 (p − 2) + (r − 1) = rp − p +1 = Δ +1 colors and, by
construction, they were not applied in incident or adjacent elements of the graph.
Consider the graph K4×6.	We show its coloring by the algorithm pro- vided above.	The decomposition of K6 − P1 into cycles that we used was
{v3v4v5v6, v2v4v1v6, v1v3v2v5}.





A12 =
⎡1 3 4 2⎤ 4 2 1 3
⎢2 4 3 1⎥
3 1 2 4 
⎡5 7 8 6⎤



A46 =
⎡ 9 11 12 10⎤
12 10 9 11
⎢10  12  11  9 ⎥
11 9 10 12









Coloring of ver- tices of K4×6 de- termined by using P1 = {v1v2, v3v5, v4v6}

A35
8 6 5 7
= ⎢6 8 7 5⎥
8 5 6 8 








Matrices A12, A35 and A46 determined by using P1

Fig. 3. Coloring of K4×6








Colors 1 to 12 in matchings of distance us- ing P1

There is still a matching of distance 3 for P2, P3, P4 and P5. Thus, we use colors 13, 14, 15 e 16 to each one of the matchings of distance 3 linking vertices of rows determined by P2, P3, P4 e P5.

Since r = 4, we need to obtain the matchings of K4, which are:  R1 =
{v1v2, v3v4}, R2 = {v2v3, v1v4} and R3 = {v1v3, v2v4}. Thus, we use color 17 on edges x1jx2j and x3jx4j for all j = 1, 2, ··· , 6. Analogously, we use color 18 on edges x2jx3j and x1jx4j and color 19 on edges x1jx3j and x2jx4j for all j = 1, 2, ··· , 6.
Kr×p, with r odd and p even
Algorithm for the case p =2 
Briefly, the algorithm assign one color to the two vertices of each independent set and use such colors in horizontal edges oriented by the matchings of Kr. Then, we use the remaining colors on matchings of distance linking vertices of rows 1 and 2.
The vertices of part Xi, i = 1, 2, ··· , r, receive color i. These colors are also used in horizontal edges as follows.
Let Rt = {vivi′ , ··· , vi′′ vi′′′ } be one of the r matchings of Kr, and let vt be remaining vertex, i.e., the vertex that is not extreme of any edge of Rt. We use color t to color edges xi1xi′1, ··· , xi′′1xi′′′1 and also to color edges xi2xi′2, ··· , xi′′2xi′′′2.
Since vt is the remaining vertex of matching Rt and the edges that receive color t are associated with the referred matching, the vertices and edges that received color t are not incident nor adjacent, by construction. Since each matching of Kr has
cardinality r—1 , we conclude that each one of the r colors is used 2 + r—1 2= r +1 
2	2
times.
Since this is a coloring with Δ + 1 = 2r − 1 colors and r colors were used in the first step, r − 1 colors remained to be used in non horizontal edges. We use each one of the r − 1 remaining colors in a matching of distance, which finishes the coloring.
Algorithm for the case p ≥ 4
We show that χjj(Kr×p)=Δ + 1= rp − p + 1, r odd and p ≥ 4 even. The first step to obtain an equitable (Δ + 1)-total coloring of this class of graphs consists in obtaining p − 1 matchings of Kp. Thus, we make a table where each matching is written r−1 times. Each copy is associated to matching of distance l (l = 1, ··· r−1) which receive color c (c = 1, ··· , (p− 1)(r − 1)). In other words, suppose that in the c-th row of the table, color c is associated with the matching of distance l determined by the matching Pt = {vjvj′ , ··· , vj′′ vj′′′ }. This means that color c is applied in a matching of distance l between the rows determined by Pt, that is, between rows j and jj, ·· ·, jjj and jjjj. In this process we used (r − 1)(p − 1) = rp − r − p +1 colors and Δ + 1 = rp − p + 1, so it remains r colors to be used. For this, in the second step we change the colors of some edges in order to use this r remaining colors.
The second step of the coloring consists in changing part of what was done in the first step and p − 1 r rows of the table will be changed. Considering the table, we remove the first edge from each one of the copies of the matchings Pt, t = 1, 3, 5, ··· ,p − 3, and the first edge from the first row associated with each matching Pt, t = 2, 4, 6, ··· ,p − 2. These removed edges will receive new colors in the following way. We assign r − 1 colors of the r remaining colors to the matchings

of distance l determined by the new matching obtained from the edges removed from Pt, t = 1, 3, 5, ··· ,p − 3; and we assign the last color r to the matching of distance 1 determined by the new matching obtained from the edges removed from P , t = 2, 4, 6, ··· ,p − 2.
The p − 1 r colors of each row of the table we have changed must be repre- sented in vertices of rows j and jj associated to the first edge vjvj′ of the matching Pt that was removed in the previous step. To represent those colors in these vertices, we will use them in the coloring of vertices and horizontal edges.
If a given color c had been applied in a matching of distance l, but transferred the element vjvj′ of the matching Pt (t odd), then color c has to be used in the coloring of vertices xlj and xlj′ . In addition, if a given color c had been applied in a matching of distance l, but transferred the element vjvj′ of the matching Pt (t even), then color c has to be used in vertices xrj and xrj′ . The r− 1 colors that were inserted in the second step must color vertices xl,p—1 and xlp if the corresponding distance in the table is l. The last color r is used in vertices xr1 and xrp. Horizontal edges are colored as in the graph Kr×p with r and p even presented before, using the matchings of Kr.
Some colors were used only in edges. Such colors were used in matchings of distance between rows that were determined by the matchings of Kp. Since the matchings are pairwise disjoint, the pairs of rows determined by the matchings of Kp are distinct and, therefore, there are no colors being applied to adjacent edges. By construction it is clear that incident and adjacent elements were not assigned to the same color. The colors used only in edges were used in perfect matchings of the graph, totalizing rp times. The colors used in vertices and edges were used in 2
vertices, in horizontal edges of two rows, totalizing 2 r—1 times and also in p—2 r non
2	2
horizontal edges. Therefore, each one of these colors was used 2+2 r—1 + p—2 r = rp+2
2	2	2
times. We conclude that the difference between the cardinalities of any two color
classes is at most 1, as desired.



Table 1
Initial distribution of colors on edges of K3×8
Table 2
Final distribution of colors on edges of K3×8


For an example, consider the graph K3×8. The tables of the first and the second steps are Tables 1 and 2. The coloring of the vertices of K3×8 is done as follows: x11 and x12 receive color 1, x13 and x14 receive color 5, x15 and x16 receive color 9, x17 and x18 receive color 15, x21 and x22 receive color 2, x23 and x24 receive color 6, x25 and x26 receive color 10, x27 and x28 receive color 16, x32 and x33 receive color 3, x34 and x35 receive color 7, x36 and x37 receive color 11 and x31 and x38 receive color 17.
Conclusion and perspectives
In this paper we prove that the equitable total chromatic number of Kr×p is Δ+1 for r and p even (r ≥ 4); and for r odd and p even. This paper, alongside with [6,11] concludes the work of determining the equitable total chromatic number for all complete r-partite p-balanced graphs, verifying the ETCC for this class of graphs. We summarize these results in Table 3. Future work includes, but is not limited to, determining the equitable total chromatic number of complete r-partite non- balanced graphs.
Table 3
The equitable total chromatic number of the complete r-partite p-balanced graphs


References
Brian Alspach and Heather Gavlas. Cycle Decompositions of Kn and Kn — I. J. Combin. Theory Ser. B, 81(1):77–99, 2001.
M. Behzad. Graphs and their chromatic numbers. PhD thesis, Michigan State University, 1965.
J. C. Bermond. Nombre chromatique total du graphe r-parti complet. J. London Math. Soc., 9:279–285, 1974.
Charles J. Colbourn and Jeffrey H. Dinitz. Handbook of Combinatorial Designs, Second Edition (Discrete Mathematics and its Applications). Chapman & Hall/CRC, 2006.
S. Dantas, C. M. H. de Figueiredo, G. Mazzuoccolo, M. Preissmann, V. F. dos Santos, and D. Sasaki. On the equitable total chromatic number of cubic graphs. Discrete Appl. Math., 209:84–91, 2016.
H. L. Fu. Some results on equalized total coloring. Congr. Numer., 102:111–119, 1994.
M. A. Gang and M. A. Ming. The equitable total chromatic number of some join graphs. Open J. Appl. Sci., 2 (4B):96–99, 2012.
H. Gui, W. Wang, Y. Wang, and Z. Zhang. Equitable total-coloring of subcubic graphs. Discrete Appl. Math., 184:167–170, 2015.
Brendan D. McKay, Jeanette C. McLeod and Ian M. Wanless. The number of transversals in a Latin square. Des. Codes Cryptogr., 40(3):269–284, 2006.
A. S´anchez-Arroyo. Determining the total colouring number is NP-hard. Discrete Math., 78:315–319, 1989.

A. G. da Silva, S. Dantas and D. Sasaki. Equitable total coloring of complete r-partite p-balanced graphs. Discrete Appl. Math., 2018 (https://doi.org/10.1016/j.dam.2018.03.009).
A. Soifer. The Mathematical Coloring Book, Springer, 2008.
V. G. Vizing. Some unsolved problems in graph theory. Russian Math. Surveys, 23(6):125–141, 1968.
W. F. Wang. Equitable total coloring of graphs with maximum degree 3. Graphs Combin., 18:677–685, 2002.
