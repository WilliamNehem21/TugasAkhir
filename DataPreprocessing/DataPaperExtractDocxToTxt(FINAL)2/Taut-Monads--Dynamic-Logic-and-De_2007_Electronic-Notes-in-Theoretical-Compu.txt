

Electronic Notes in Theoretical Computer Science 173 (2007) 241â€“262
www.elsevier.com/locate/entcs

Taut Monads, Dynamic Logic and Determinism
Ernie Manes 1
Department of Mathematics and Statistics University of Massachusetts Amherst, MA 01003, USA

Abstract
Studied are Kleisli categories of monads of sets which satisfy two properties motivated by functional prop- erties of collections. Such categories have box and diamond operators which follow the laws of (loop-free) dynamic logic. A theorem of Kozen states that the category of sets and relations is complete for loop-free dynamic logic. It is shown that the Kleisli category of the filter monad is likewise complete. A morphism Î± is deterministic if <Î±> Q âŠ‚ [Î±]Q for all Q. Each â€œoutput valueâ€ Î±x is associated with a filter which is forced to be an ultrafilter when Î± is deterministic and Î±x is defined. Early work in the theory of domains abstracted from the partially ordered set of partial functions between two sets, ordered by extension. A different abstraction, suited to conditional constructs rather than recursive fixed point equations, is the no- tion of a locally Boolean poset, and this is used to compare restriction categories with deterministic Kleisli categories. The laws of dynamic logic in terms of [Î±]Q and <Î±> Q for a single Î± hold in any topological
space with [Î±]Q the interior operator and <Î±> Q the closure operator.
Keywords: dynamic logic, collection type, taut monad, Boolean category, deterministic map, locally Boolean poset, filter, restriction category


Introduction
In this paper, a monad T in the category Set of sets and (total) functions induces three constructs of interest. The first is the Kleisli category SetT which may be thought of as the category in which expressions are evaluated when the monad class T has been activated. The second is the category SetT of algebras over the monad, which is used to determine if the monad is of collection type. The third is a class of topological spaces determined by certain endomorphisms of the Kleisli category whose box and diamond operators are the interior and closure operators.
A function f : X â†’ Y maps a â€œpointâ€ x to another point f x. When the outputs are more general â€œdistributionsâ€ on Y , write the set of such distributions as TY and consider functions of form f : X â†’ TY . Carrying this line of thought to

1 Email: manes@math.umass.edu



1571-0661 Â© 2007 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2007.02.037

its logical conclusion leads to the Kleisli category of a monad in Set. [10] is the first paper to classify monads from this point of view. More recently, programming interpretations have been given to such monads, â€œnotions of computationâ€ in [16] and monad classes (as in Haskell) in [21] where one â€œkeeps the code and changes the monad on the flyâ€.
In three papers [12,13,15], the author has explored monads suitable to describe collection data types. A collection is a structure which holds values. A deterministic collection is such a structure which holds at most one value, and this paper studies such deterministic monads. In the finitary case, there are few surprises. In the infinitary case, however, the most generalized â€œdeterministic valueâ€ (as is forced by the theory, not by definition) is an ultrafilter. The interpretation of an ultrafilter as a â€œgeneralized pointâ€ dates to the first paper about them [19].
But let us begin at the beginning.

Monads as Collection Types
Î·
We assume familiarity with the definition of a monad T = (T, Î·, Î¼) with id âˆ’âˆ’â†’
Î¼
T â†âˆ’âˆ’ TT natural transformations subject to three equations and with the equiv-
alent formulation T = (T, Î·, (Â·)#) where Î± : X â†’ TY 'â†’ Î±# : TX â†’ TY subject to three equations. (Monad basics can be found in [14], and uncited defi- nitions and facts throughout the paper can be found there). The Kleisli category SetT has sets as objects, functions X â†’ TY as morphisms X â†’ Y with com-

position Î² â—¦ Î± = X
âˆ’âˆ’Î±â†’ TY 
Î²#
âˆ’âˆ’â†’ TZ and Î·X as the identity morphism of X.

That this forms a category is the essence of the axioms on a monad. Recall that

Î±# = TX 
âˆ’Tâˆ’â†’Î± 
TTY	Î¼Y
TY and that Î¼X
= (idTX 
)# and for f : X â†’ Y ,

Tf = (f o)# where f o = X	f
Î·
âˆ’âˆ’â†’
TY . For Lemma 2.24 and Proposition 5.7,

we recall that a monad map Î» : (S, Î·, (Â·)#) â†’ (T, Î·, (Â·)#) is characterized by the equations Î·Î» = Î· and the following commutative squares induced by Î± : X â†’ SY :
SX	Î»X) TX

Î±# v
v(Î»Y Î±)#

SY 	) TY
Î»Y
Example 2.1 The list monad is L = (L, Î·, Î¼) with LX the set of all lists [x1,... , xn], (n â‰¥ 0), with xi âˆˆ X; (Lf )[x, ... , xn] = [f x1,... ,fxn]; Î·X (x) = [x]; Î¼X[w1,... , wn] is the concatenation w1 + Â·Â·Â· +wn. For Î± : X â†’ LY , Î±#[x1,... , xn] is obtained by substituting Î±(xi) for xi and then flattening.
Aspects of the monad structure are subject to well-known functional program- ming interpretations and we discuss two such aspects using the list monad as a specific example. Lf is M ap f and we generally give this interpretation to Tf . Similarly, Î¼X is thought of as a â€œflattenâ€ operator. Not every monad would be- have correctly with respect to such interpretations about collections. One imagines that there is a large wish list of potential axioms for a useful theory. Surprisingly,

we shall require only two such axioms. In what follows, we write 2 = {0, 1} with 0 = F alse, 1 = True. Thus the characteristic function Ï‡A : X â†’ 2 of A âŠ‚ X satisfies Ï‡âˆ’1(1) = A. The two properties can loosely be expressed as follows.
Given A âŠ‚ X, there exists a 2-valued functional expression to determine if
Ï„ âˆˆ TX holds only elements of A.
Given that Ï„ âˆˆ T 22 holds elements in A âŠ‚ T 2 and that each element of A holds only the value True, then Î¼2(Ï„ ) holds only the value True.
That these properties hold for the list monad is easily seen. Consider Boolean
L(Ï‡A)

â€œandâ€ âˆ§ : L2 â†’ 2 with âˆ§[x1,... , xn] = 1 â‡” xi = 1 for all i. Then LX
âˆ§
âˆ’âˆ’âˆ’âˆ’â†’

L2 âˆ’âˆ’â†’ 2 is true of [x1,... , xn] if and only if each xi âˆˆ A.	Thus the desired
functional expression to establish (1) is that which maps Ï‡A on the input list and then folds the result with â€œandâ€. (2) asserts that each symbol in w1 + Â·Â·Â· +wn is True if and only if this holds for each wi.
It is not hard to formalize (1,2) as requirements for an arbitrary monad of Set. T preserves monics (even empty ones) [13, Page 84]. Hence for A âŠ‚ X, â€œTA âŠ‚ TXâ€ so that TA formalizes {Ï„ âˆˆ TX : Ï„ holds only elements of A}. In particular, Ïˆ = Ï‡T 1 : T 2 â†’ 2 formalizes the elements of T 2 which hold only 1 (where, recall, 1 = True). Thus the functional expression to determine if Ï„ âˆˆ TX 
T (Ï‡A)	Ïˆ
holds only elements in A âŠ‚ X is TX âˆ’âˆ’âˆ’âˆ’â†’ T 2 âˆ’âˆ’â†’ 2 and the formal statement
that this expression works is that the squares
TA 	) 
Ti	1	(3)
v	v
	)
TX	ÏˆT (Ï‡A)	2
(which always commute) are pullbacks. (Here, A âŠ‚ X has inclusion i : A â†’ X. We use as a one-element set rather than 1 to avoid confusion with True). For A = {1} âŠ‚ 2, Ï‡A = id so if (3) is always a pullback, the square
T 	) 1


T (True)
v
	)
True
v

T 2	Ïˆ	2
in particular is, that is in general,
(4)	Ïˆ = Ï‡T 1
(2) may be expressed by saying that for Ï„ âˆˆ TT 2, Î¼2(Ï„ ) âˆˆ T 1 â‡” (T Ï‡T 1 )Ï„ âˆˆ T 1, that is, the square



TT 2
Î¼2
TÏˆ	) T 2
Ïˆ	(5)

v	v
	)


commutes.
T 2	Ïˆ	2

We are now ready to talk about the category SetT of algebras of the monad T. See [9,14] for basic facts. The objects are all (X, Î¾) with Î¾ : TX â†’ X the structure map satisfying the two equations at the left, with maps called T-homomorphisms satisfying the square on the right:

X	Î·X ) TX
TTX 
T Î¾) TX 
TX	T f) TY 

id	Î¾
   v
Î¼X	Î¾
v	v
	)

Î¾	Î¸	(6)
v	) v

X	TX	Î¾	X	X	f	Y
By the monad laws for T, (T X, Î¼X ) isa T-algebra. It is freely generated by X (in the same sense as one talks about free monoids, groups and modules), since for each
function f : X â†’ Y with (Y, Î¸)a T-algebra, f # = TX Tf TY âˆ’âˆ’Î¸â†’ Y is the unique
T-homomorphism with f #Î·X = f . The earlier Î±# : TX â†’ TY is a special case of this construction. Thus to prove that two T-homomorphisms f, g : (T X, Î¼X ) â†’ (Y, Î¸) are equal it suffices to show equality restricted to the â€œgeneratorsâ€ Î·X , that is, that f Î·X = gÎ·X . By the naturality of Î¼, Tf : (T X, Î¼X ) â†’ (TY, Î¼Y ) is a T- homomorphism for any f : X â†’ Y . By the middle square in (6), every structure map is a T-homorphism. This proves directly that f # : (T X, Î¼X ) â†’ (Y, Î¸) is a T-homomorphism.
The categories of form SetT are precisely the equationally definable classes of universal algebras (with not necessarily finitary operations) with the only exceptions being situations such as complete lattices whose free algebras are â€œtoo large to have a cardinal numberâ€.
Say that a monad T is trivial if it has no algebra with two or more elements. In particular, |TX| â‰¤ 1. There are only two trivial monads, easily discovered by the reader, and we will henceforth work only with non-trivial monads. In that case, by taking cartesian products in the category of algebras, there exist algebras of arbitrarily large cardinality.
Lemma 2.2 For a non-trivial monad T = (T, Î·, Î¼), if a /= b âˆˆ X then Î·X(a) âˆˆ/ Tb 
in TX. (We abuse notation and write Ta for T {a}, here and elsewhere).
Proof  Let (Y, Î¸) bea T-algebra with at least three elements and let f, g : X â†’ Y be functions with f a, f b, ga distinct and fb = gb. Then f #, g# : (T X, Î¼X ) â†’ (Y, Î¸) agree on Tb but disagree on Î·X (a) so Î·X(a) âˆˆ/ Tb.	 
Corollary 2.3 For a non-trivial monad, Î·X is componentwise monic.	 

In [13, Definition 3.1] a support classifier for a monad T was defined to be a T-algebra (2, Ïˆ) satisfying that (3) is always a pullback. In that case, (4,5) hold since (4) follows from (3) being a pullback and (5) is one of the T-algebra equations in (6). Conversely, to show that (3)-pullback and (5) implies support classifier (with

Ïˆ defined by (4)) we need only show the remaining algebra law that 2 Î·2
Ïˆ
T 2 âˆ’âˆ’â†’

2 = id. By Lemma 2.2, 0 âˆˆ/ T 1 so ÏˆÎ·2(0) = 0. As 1 âˆˆ T 1, ÏˆÎ·2(1) = 1. Thus the axioms (3)-pullback and (5), motivated by functional programming concerns about collections, are equivalent to the existence of a support classifier.
Example 2.4 Let TX be the set of all formal real linear combinations Î»1x1 + Â·Â·Â· + Î»nxn with Î»i real and xi âˆˆ X, Î·X (x)= 1x, Î±#(Î»1x1 + Â·Â·Â· + Î»nxn)= Î»1Î±(x1)+ Â·Â·Â· + Î»nÎ±(xn), simplified in the usual way. The algebras are real vector spaces. Since there is no two-element real vector space, this monad has no support classifier.
We have motivated that T should have a support classifier and we now reap the benefits of known theorems. For that, a few definitions are needed. An inverse

f
image square is a pullback of X âˆ’âˆ’â†’ Y
j
â†âˆ’âˆ’ Q with j monic. A functor F is taut

if it maps inverse image squares to pullbacks (which are then necessarily inverse image squares). A natural transformation is taut if the naturality squares induced by monics are pullbacks. A monad (T, Î·, Î¼) is taut if T, Î·, Î¼ all are.
Theorem 2.5 [13, Theorem3.3] A monad has a support classiï¬er if and only if it is non-trivial and taut.	 
In the interests of brief terminology, we will hence favor the term â€œtaut monadâ€ for a monad with a support classifier.
Example 2.6 The filter monad F = (F, Î·, Î¼) is a taut monad. Though well known, we review the definition here. FX is the set of all filters on X (i.e. the set of all filters on the Boolean algebra 2X ) including the improper filter 2X , (Ff )F = {B âŠ‚ Y : f âˆ’1B âˆˆ F}, Î·X (x) is the principal ultrafilter prin(x) = {A âŠ‚ X : x âˆˆ A}, Î¼X(H)= {A âŠ‚ X :  A âˆˆ H} (where  A = {F âˆˆ FX : A âˆˆ F}), Î±#F = {B âŠ‚ Y :
{x âˆˆ X : B âˆˆ Î±x} âˆˆ F}. By the theorems of [6,22], the category of F-algebras is
continuous lattices with morphisms that preserve directed suprema and arbitrary infima, the structure map Î¾ : FL â†’ L of the continuous lattice L being the lim-inf operation Î¾(F)=  F âˆˆF  F . F is taut with support classifier 2 with 0 < 1.
The filter monad is intimately connected with general taut monads as the next result shows.
Theorem 2.7 [13, theorem 3.3] A monad T is taut if and only if there exists a taut monad map T â†’ F. In that case, the support map
supp
âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’â†’ FX,	Ï„ 'â†’ {A âŠ‚ X : Ï„ âˆˆ T A}
deï¬nes a canonical taut monad map T â†’ F.
Any monad map Î» : S â†’ T for monads in a category K induces a forgetful func-

tor KT â†’ KS defined by (X, TX	Î¾
X) 'â†’ (X, SX Î»X
Î¾
TX âˆ’âˆ’â†’
X). Applying

this in the context of the previous theorem, we see that if L is any continuous lattice and T is any taut monad, then Î¾ : TL â†’ L, Î¾(Ï‰)=  Ï‰âˆˆTA  A is a T-algebra. It is routine to check that if L = 2 with 0 < 1, then the resulting T-algebra is the support classifier of T.
We now veer off in what seems at first to be a totally unrelated direction, but which will provide us with yet another characterization of taut monads. We consider how to interpret loop-free dynamic logic [7,8,18] in a Kleisli category.
Definition 2.8 A category B is a Boolean category [11] if the following four axioms hold.
(B.1) B has finite coproducts. The initial object is denoted 0.

f
(B.2) For X âˆ’âˆ’â†’ Y
j
â†âˆ’âˆ’ Q, with j a coproduct injection, there exists a pullback

[f ]Q
i v
g) Q
vj

X 	) Y
f
with i a coproduct injection.
(B.3) A coproduct injection pulls back a coproduct to a coproduct.
(B.4) If X âˆ’âˆ’1â†’ X â†âˆ’1âˆ’ X is a coproduct, then X is an initial object.
Proposition 2.9 [11, Proposition 5.15, Theorem 5.11] The following hold in any Boolean category.
Every coproduct injection is an equalizer. The subobjects of X represented by a coproduct injection are called summands of X and the class of such is denoted Summ(X).
Summ(X) is a Boolean algebra with least element 0 â†’ X, greatest element 1: X â†’ X, intersection via pullback and Boolean complement via (unique) coprod- uct complement. For Q, R âˆˆ Summ(X), Q â†’ Q âˆª R â† R is a coproduct if and only if Q âˆ© R = 0.	 
As explained in [11], a Boolean category is a semantic model of dynamic logic with box operator [f ]Q and diamond operator <f > Q = ([f ]Q')'. A number of examples will be given shortly.
For any monad T in a category K, there is a canonical functor K â†’ KT which is the identity on objects and which maps f : X â†’ Y to f o : X â†’ TY (as defined at the beginning of this section). For a non-trivial monad in Set, Î· is pointwise monic, so this functor may be regarded as the inclusion of a subcategory. In general, this functor has a right adjoint, the functor which maps Î± : X â†’ Y

in KT to Î± : X â†’ TY in K. In particular, if P
âˆ’âˆ’iâ†’ X	j
Q is a coproduct in

io	jo
K, P âˆ’âˆ’â†’ X â†âˆ’âˆ’ Q is a coproduct in KT. We now come to a subtle point. Even
though coproducts in a category are unique up to isomorphism, the sub-poset of summands in K and KT can be quite different. First observe, that for every non- trivial monad, the Kleisli category is equivalent to the category of free algebras via

Î± : X â†’ TY  'â†’ Î±# : (T X, Î¼X ) â†’ (TY, Î¼Y ). Consider the real vector space monad of Example 2.4. The Kleisli category of this monad is equivalent to the category of algebras, all real vector spaces, because every vector space has a basis. The only

nondegenerate coproduct decomposition of 2 is 
âˆ’âˆ’Tâˆ’râˆ’uâ†’e
2 â†Fâˆ’aâˆ’lsâˆ’âˆ’e
 . Now, T 2 is

the plane and the induced coproduct decomposition of the plane is as the direct sum of the x-axis and the y-axis. But any pair of distinct lines through the origin gives a coproduct decomposition in the Kleisli category. The four-element Boolean algebra 22 has been enlarged to a non-Boolean infinite poset of summands. From our current point of view, the summands are the tests of the assertion logic. In adding a monad â€œon the flyâ€ we want the new assertion logic to apply to the same tests. But here we get ahead of ourselves, so let us turn to the requisite definition and theorem.
Definition 2.10 For a monad T in K, say that summands are standard if for

every coproduct P
âˆ’âˆ’Î±â†’ X	Î²
Q in KT there exists a coproduct A âˆ’âˆ’iâ†’ X	j	B

in K and an isomorphism Ï• in KT such that the triangle
A	i	) X
Ï•	/â€™
	/
P
commutes in KT.
In the vector space example, summands are not standard. If in the triangle above, A is the x-axis and P is the line y = x, then A and P are isomorphic vector spaces but no isomorphism between them makes the triangle commute.
We are now ready to give our final characterization theorem of general taut monads.
Theorem 2.11 [15, Theorem 9.2] A non-trivial monad T is taut if and only if SetT is a Boolean category for which the functor Set â†’ SetT is taut and for which summands are standard.	 
Any endomorphism Î± : X â†’ TX in SetT is a â€œone-object modelâ€ of dynamic logic. This generalizes the Kripke models first introduced (see e.g. [8]).
The introduction of the box operator in SetT creates the need to better under- stand these pullbacks. This problem has a straightforward solution as follows.
Proposition 2.12 Let T be a taut monad, and let Î± : X â†’ TY , P âŠ‚ X with inclusion i : P â†’ X, Q âŠ‚ Y with inclusion j : Q â†’ Y . Consider the squares

i	) X
TP   T i) TX 
P 	i ) X

Î² v  (A)
vÎ±	Î²# v
(B)
vÎ±#
Î² v  (C)	vÎ±

jo	Y
TQ 	) TY 
Tj 
TQ 	) TY 
Tj 

where (A) is in SetT and (B, C) are in Set. Then if any square commutes, they all do. If any square is a pullback, they all are.

Proof	The result for (A,B) holds even more generally and for any monad in any category [11, Lemma 6.10 (2)]. Now consider the diagram
P	Î·P ) TP	Î²	TQ 

i v (D)
vTi 
(B)
vTj 

X	Î·X
) TX	) TY 
Î±#

whose perimeter is (C). As the naturality square (D) commutes, (C) commutes if
(B) does. Conversely, both paths in (B) are homomorphisms from the free algebra (TP, Î¼P ) so (B) commutes if it commutes restricted to the â€œgeneratorsâ€ Î·P , that is,
(B) commutes if (C) does. Since (D) is a pullback as Î· is taut, (C) is a pullback if
(B) is. Conversely, as Î±# = Î¼Y (T Î±), Î²# = Î¼Q(TÎ²), the diagram

TP	T Î²) TTQ 
Ti v	vTTj 
Î¼Q ) TQ 
vTj 

TX 	) TTY 
TÎ± 
) TY 
Y

and the tautness of T and Î¼ give that (B) is a pullback if (C) is.	 
We now use the tools from Theorems 2.7, 2.11 to obtain a useful result:
Proposition 2.13 For T a taut monad, Î± : X â†’ TY , Q âŠ‚ Y ,
[Î±]Q = {x âˆˆ X : Q âˆˆ suppY (Î±x)}
<Î±> Q = {x âˆˆ X : Q' âˆˆ/ supp (Î±x)}
(where Q' = Y \ Q is the complement of Q in Y ).
Proof Because summands are standard in SetT, if (A) in Proposition 2.12 is a pullback, it constructs P = [Î±]Q in SetT. By that proposition, the pullback (C) in Set has P = [Î±]Q so that x âˆˆ [Î±]Q â‡” Î±x âˆˆ TQ â‡” Q âˆˆ suppY (Î±x). Thus
x âˆˆ<Î±> Q â‡” x âˆˆ ([Î±]Q')' â‡” x âˆˆ/ [Î±]Q' â‡” Q' âˆˆ/ supp (Î±x).	 
We round out the section by giving a number of examples and discussing their properties.
Example 2.14 Let E be a set of â€œexceptionsâ€. Then (T, Î·, Î¼) is a taut monad if

TX = X + E, Î·
= X	inX
<inX ,inE,inE>

X	âˆ’âˆ’âˆ’âˆ’â†’ X + E, Î¼X = X + E + E âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’â†’ X + E.
In the Kleisli category, a program behavior Î± : X â†’ Y + E either maps x to an output y âˆˆ Y or raises an exception e âˆˆ E. (If divergence is considered as an exception in E, it is not â€œraisedâ€ of course). For Î² : Y â†’ Z + E, Î²# =< Î±, inE > so (Î² â—¦ Î±)x = e âˆˆ E if Î±x = e; that is, an exceptionâ€œsticksâ€. For Q âŠ‚ Y we have
[Î±]Q = {x âˆˆ X : Î±x âˆˆ Q + E}
<Î±> Q = {x âˆˆ X : Î±x âˆˆ Q}
An algebra is a pair (X, p) where X is a set and p : E â†’ X is any function. Homomorphisms f : (X, p) â†’ (Y, q) satisfy ft = q. The support classifier is (2, p) with p(e) = True for all e. When E is empty, the Kleisli category is Set. When E has one element, the Kleisli category is the category Pfn of sets and partial

functions, and the category of algebras is the category of sets with base point. Here the box and diamond operators are
[Î±]Q = {x âˆˆ X : if Î±x is defined then Î±x âˆˆ Q}
<Î±> Q = {x âˆˆ X : Î±x is defined and Î±x âˆˆ Q}
We call the case when E has one element the exception monad and write it
Ex = (Ex, Î·, Î¼).
Example 2.15 The power set monad is the taut monad given by P = (P, Î·, Î¼) has PX = 2X , (Pf )A = fA = {fa : a âˆˆ A}, Î·X (x) = {x}, Î¼X (A) =   A, Î±#A = aâˆˆA Î±(a). The Kleisli category is isomorphic to the category Rel of sets and relations where Î± : X â†’ 2Y corresponds to the relation R âŠ‚ X Ã— Y via
xR y â‡” y âˆˆ Î±(x). For R âŠ‚ X Ã— Y , S âŠ‚ Y Ã— Z, the composition that corresponds to Kleisli composition is the usual one, x SR z â‡” âˆƒ y, x R y, y S z. The algebras of this monad are complete sup-semilattices where the structure map Î¾ : PX â†’ X is the supremum. Thus x â‰¤ y â‡” Î¾{x, y} = y. The support classifier is 2 with 0 < 1.
The box and diamond operators here are
[Î±]Q = {x âˆˆ X : Î±x âŠ‚ Q}
<Î±> Q = {x âˆˆ X : Î±x âˆ© Q /= âˆ…}
Rel is the standard model of multi-valued semantics. One can choose submonads to enforce further properties, e.g. non-empty subsets or finite subsets; these are submonads because a singleton is non-empty and finite and because a non-empty union of non-empty sets is non-empty and a finite union of finite sets is finite.
Example 2.16 We continue the discussion of the list monad of Example 2.1. The algebras are monoids, where the structure map Î¾ : LX â†’ X of a monoid (X, Â·, 1) is Î¾[x1,... , xn]= x1	xn. Conversely, given an algebra (X, Î¾), define x Â· y = Î¾[x, y]
with unit Î¾[ ]. This is a taut monad; the support classifier is 2 with unit True and multiplication âˆ§, as was central to our earlier motivations. The box and diamond operators are defined by
[Î±]Q = {x âˆˆ X : Î±x âˆˆ LQ}  (possibly Î±x empty)
<Î±> Q = {x âˆˆ X : Î±x has a symbol in Q}
Example 2.17 Define the probability monad Pr = (P r, Î·, Î¼) as follows. Pr X is the set of all countable-support probability distributions Î£x Î»xx with Î»x âˆˆ [0, 1] the real unit interval, and Î£ Î»x = 1. â€œCountable supportâ€ means that Î»x /= 0
for at most countably many x. This is a submonad of the real-vectorspace monad
of Example 2.4. To see this, consider Î±#(Î£x Î»xx) = Î£x Î»xÎ±(x) and use stan-
dard properties of absolutely convergent series: if Î±(x) = Î£y Î²xy, Î£y Î£x Î»xÎ²x =

Î£x Î»x Î£y
x = Î£x
Î»x = 1. In the Kleisli category, outputs are probability dis-

tributions. Flipping a coin is a map Î± : 1 â†’ {H, T }. Let Î²(H) cause two dice
to be summed whereas Î²(T ) causes one die to be rolled. The Kleisli composition Î² â—¦ Î± :1 â†’ {1,... , 12} performs a correct probability calculation. Noting that Pr 2 can be identified with [0, 1], the subobject classifier is the characteristic function of
{1}, [0, 1] â†’ 2. The box and diamond operators are

[Î±]Q = {x âˆˆ X : if Î±(x)= Î£ Î»yy, then Î»y /=0 â‡’ y âˆˆ Q}
y
<Î±> Q = {x âˆˆ X : if Î±(x)= Î£ Î»yy then there exists y âˆˆ Q with Î»y /= 0}
y
We now paraphrase the Kozen completeness theorem [8] generalized to the set- ting of Boolean categories [11, Theorem 11.15].
Theorem 2.18 Let B be a Boolean category. For X an object of B, let Î²X be the set of ultraï¬lters on the Boolean algebra Summ(X). Deï¬ne the Kozen functor K : B â†’ Rel by KX = Î²X and, for Î± : X â†’ Y , U (KÎ±) V â‡” âˆ€ V âˆˆ V <Î±> V âˆˆ U . Then K is a taut functor which preserves ï¬nite coproducts. By the properties of this functor one shows that any valid sentence of loop-free dynamic logic which is true in Rel is true in B.	 
Remark 2.19 By Proposition 2.13, The Kozen functor for SetT is
U (KÎ±) V	â‡”  âˆ€ V âˆˆ V {x âˆˆ X : V ' âˆˆ/ suppY (Î±x)} âˆˆ U
Example 2.20 It follows from Theorem 2.7 that any non-trivial submonad of the filter monad F is taut. Here, the box and diamond operators are given by
[Î±]Q = {x âˆˆ X : Q âˆˆ Î±x}
<Î±> Q = {x âˆˆ X : Q' âˆˆ/ Î±x}
We now offer a few heuristic remarks concerning proper filters as distributions. A proper filter F â€œhomes inâ€ in stages where each A âˆˆ F is a stage. When stages A1,... , An have been selected, A1 âˆ© Â·Â·Â· âˆ© An is a finer stage. Fixing Î± : X â†’ FY , Q âŠ‚ Y , [Î±]Q = {x âˆˆ X : Q âˆˆ Î±x} is the set of all inputs whose outputs allow Q as a stage. The principal ultrafilter prin(x) is a true point because {x} is a stage. In general, the more stages the more a filter can home in so it is natural to consider maximal filters as generalized points. We assume the Boolean prime ideal theorem without further comment, so each (proper) filter is the (nonempty) intersection of the ultrafilters that contain it. The set of such ultrafilters is the set of generalized
points the filter homes in on.
A compact Hausdorff space may be regarded as a structure that realizes an actual point for each ultrafilter. Now Î² is a submonad of F and it is well known that its algebras are precisely the compact Hausdorff space whose structure map Î²X â†’ X is ultrafilter convergence. The forgetful functor from continuous lattices to compact Hausdorff spaces induced by the monad map Î² â†’ F assigns the Lawson topology.
The following proposition supports the single-valuedness of ultrafilters as op- posed to filters.
Proposition 2.21 If G is a submonad of Î², the Kozen functor K : SetG â†’ Rel
factors through Pfn.
Proof  Let Î± : X â†’ GY and let U (KÎ±) V, U (KÎ±) W. If V /= W then, as V, W
are ultrafilters, âˆƒ V âˆˆ V with V ' âˆˆ W. Then <Î±> V = {x âˆˆ X : V ' âˆˆ/ Î±x} âˆˆ U

and <Î±> V ' = {x âˆˆ X : V
âˆˆ/ Î±x} âˆˆ U. As any two elements of U have non-empty

intersection, there exists x with V, V ' âˆˆ/
Î±x, and this is impossible as Î±x is an

ultrafilter. Thus V = W.	 
While Rel is the prototypical Boolean category, the theory of this section sug- gests that SetF is the prototypical taut-monad Kleisli category. This point of view can be pushed further by independently proving a â€œKozen completeness the- oremâ€ for SetF. To begin, first observe that for any monad map Î» : S â†’ T over any category K, there is an induced functor HÎ» : KS â†’ KT defined by

HÎ»(X
âˆ’âˆ’Î±â†’ SY ) = X
âˆ’âˆ’Î±â†’ SY	Î»Y
TY . For a taut monad with support map

supp : T â†’ F, H
supp(X
âˆ’âˆ’Î±â†’ TY )	= X
âˆ’âˆ’Î±â†’ TY	suppY
FY . Comparing the

formulas of Proposition 2.13 and Example 2.20, [Î±]Q = {x âˆˆ X : Q âˆˆ supp(Î±x)} =
{x âˆˆ X : Q âˆˆ (Hsupp Î±) x} = [Hsupp Î±]Q, so that any dynamic-logic assertions which are universally valid in SetF must be universally valid in SetT. In particular, if an assertion holds in SetF it holds in Rel = SetP. Applying Theorem 2.18, we have
Theorem 2.22 Any loop-free assertion of dynamic logic that is valid in SetF is valid in all Boolean categories.	 
For the most standard collections such as lists, probability distributions, bags, and so forth, a distribution Ï„ has a definite set of members mem(Ï„ ), e.g.
mem[a, b, a, c, b] = {a, b, c}, for Ï„ = Î£ Î»x x âˆˆ Pr X, mem(Ï„ ) is {x : Î»x /= 0}. In
such cases, supp(Ï„ )= prin(mem(Ï„ )) is a principal filter (prin(A)= {B : A âŠ‚ B}). The submonad of principal filters is the subsets monad prin : P â†’ F. In the prin- cipal case, the completeness theorem for Rel results via a monad map to P. We formalize this definition as follows.
Definition 2.23 A taut monad is principal if its support map factors through prin : P â†’ F. In that case, for Ï„ âˆˆ TX, suppX (Ï„ )= prinX (memX (Ï„ )) = {A âŠ‚ X : memX (Ï„ ) âŠ‚ A} which defines the subset memX (Ï„ ) of members of Ï„ .
The next lemma will be used in Proposition 5.7. This property was used as an axiom on collections in [12].
Lemma 2.24 Let T be a principal monad, Î± : X â†’ TY , Ï„ âˆˆ TX. Then

mem  (Î±#Ï„ )  =	 
memY (Î±x)

xâˆˆmemX (Ï„)
Proof	Because mem : T â†’ P is a monad map, the following square commutes (as reviewed at the beginning of Section 2).

TX 
Î±# v
TY 
memX) PX 
(mem
)	v
mem	PY 


Î±)#

Applying the definition of (Â·)# for the power set monad, we have

mem (Î±#Ï„ ) = (mem  Î±)# mem  (Ï„ ) =	 
memY (Î±x)	 

xâˆˆmemX (Ï„)
Deterministic Monads
Partial functions are deterministic in that it is not possible to witness two-valued behavior. This may be defined in any category as follows.
Definition 3.1 A morphism f : X â†’ Y in any category is deterministic if for every coproduct decomposition Q âˆ’â†’ Y â†âˆ’ Q' of Y there exists a commutative diagram
P  ) X (	 P '
v	vf	v
Q  ) Y (	 Q'
in which the top row is a coproduct decomposition of X. If, addition, this can always be done with both squares pullbacks, we say f is crisp.
This definition does not require any coproducts or pullbacks to exist. For the Kleisli category of any monad in Set, coproducts are disjoint unions which meshes well with the philosophy behind the definition.
Definition 3.2 A monad is deterministic if all morphisms in its Kleisli category are deterministic. Similarly, a monad is crisp if all morphisms in its Kleisli category are crisp.
Example 3.3 Let Î²Ù¨X = {U âˆˆ FX : U is an ultrafilter or U = 2X }. We check that Î²Ù¨ is a submonad of F . We have prin(x) âˆˆ Î²X âŠ‚ Î²Ù¨X. Now let Î± : X â†’ Î²Ù¨Y , U âˆˆ Î²Ù¨X. We must show that Î±#U = {B âŠ‚ Y : {x âˆˆ X : B âˆˆ Î±x} âˆˆ U} âˆˆ Î²Ù¨Y . Clearly U = 2X â‡’ Î±#U = 2Y . Otherwise, U âˆˆ Î²X. Let B âŠ‚ Y . To show: B âˆˆ Î±#U or B' âˆˆ Î±#U (possibly both). Suppose B âˆˆ/ Î±#U. As U is an ultrafilter, U = {x : B âˆˆ/ Î±x} âˆˆ U. For x âˆˆ U , Î±x /= 2Y so Î±x âˆˆ Î²Y and {x : B' âˆˆ Î±x} = U âˆˆ U, so B' âˆˆ Î±#U as desired.
It is easy to check that the Î²âˆ—-algebras are compact Hausdorff spaces with base point and that the discrete space 2 with base point True is the support classifier.

Definition 3.4 In a Boolean category, f : X â†’ Y is total if [f ]0 = 0.
Lemma 3.5 [11, Proposition 12.2, Corollary 12.3] For f : X â†’ Y in a Boolean category, the following hold.
f is total â‡” âˆ€ Q  <Î±>Q âŠƒ [Î±]Q.
f is deterministic â‡” âˆ€ Q <Î±>Q âŠ‚ [Î±]Q.
f is crisp â‡” âˆ€ Q  <Î±>Q = [Î±]Q.

f is crisp â‡” Q 'â†’ [f ]Q is a Boolean algebra homomorphism Summ(Y ) â†’
Summ(X).	 

Thus a map in a Boolean category is crisp if and only if it is total and deter- ministic.
By [13, Proposition 3.12] any submonad G of the filter monad F is taut and the inclusion Î¹ : G â†’ F is a taut monad map.

For f : X â†’ Y a function and T a taut monad, f o = X	f
Î·
âˆ’âˆ’â†’
TY is

crisp in SetT. the converse is far from true, as we see in the next proposition, which provides further evidence that ultrafilters are like points.
Proposition 3.6 Every submonad of Î² is crisp.
Proof Let G be a submonad of Î² . For Î± : X â†’ GY , [Î±]Q = {x âˆˆ X : Q âˆˆ Î±x} and <Î±> Q = {x âˆˆ X : Q' âˆˆ/ Î±x} = {x âˆˆ X : Q âˆˆ Î±x} as Î±x is an ultrafilter. Thus [Î±]Q = <Î±> Q so Î± is crisp.	 
We can now relate deterministic maps to Î²âˆ—.
Proposition 3.7 For a taut monad T, T is crisp if and only if supp : T â†’ F
factors through Î². T is deterministic if and only if supp factors through Î²âˆ—.
Proof For Î± : X â†’ TY is crisp â‡” âˆ€ Q [Î±]Q =<Î±> Q. By Proposition 2.13 this happens if and only if (âˆ€ x âˆ€ Q Q âˆˆ supp(Î±x) â‡” Q' âˆˆ/ supp(Î±x)) â‡” âˆ€ x Î±x âˆˆ Î²X. As any Ï„ âˆˆ TX has form Î±x for some Î±, this proves the first statement. Similarly, Î± is deterministic â‡” (âˆ€ x âˆ€ Q Q' âˆˆ/ supp(Î±x) â‡’ Q âˆˆ supp(Î±x)) â‡” âˆ€ x Î±x âˆˆ Î²Ù¨X. 

Corollary 3.8 Any taut monad T contains a largest crisp submonad Tcrisp whose Kleisli category consists of the crisp morphisms of SetT. Similarly, T has a largest deterministic submonad Tdet whose Kleisli category consists of the deterministic morphisms of SetT.
Proof Form the pointwise pullbacks (which are pullbacks in the category of mon- ads and monad maps)
Tcrisp 	) Tdet 	) T

v	v
	)		)
supp
v

Î²	Î²âˆ—	F
and then use the Proposition. (All monad maps in the diagram are taut).	 
Lemma 3.9 Let S, T be taut monads, Î» : S â†’ T a taut monad map. Then if T
is deterministic so, too, is S; if T is crisp then S is also.
Proof	For Î± : X â†’ SY , Q âŠ‚ Y with inclusions j : Q â†’ Y , j' : Q' â†’ Y , consider the diagram whose explanation follows:

P 	i	) X
Î²
'
P '
Î±	Î²'

v	Sj
v	Sj'	v

SQ 	)
SY (	 SQ'

Î»Q v
TQ 	)
Tj 
Î»
v
TY (


Tj'
Î» '
vQ
TQ'

The bottom squares are the naturality squares for Î» induced by the monics j, j' and so these are pullbacks. As Î»Y Î± is deterministic in SetT by hypothesis, there exists P âŠ‚ X with inclusions i : P â†’ X, i' : P ' â†’ X and maps P â†’ TQ, P ' â†’ TQ' completing the perimeter of the diagram. By the pullback property, these maps factor via Î², Î²' through SQ and SQ', completing the diagram. Thus Î± is deterministic. If Î»Y Î± is crisp as well then, from the same diagram, using elementary pullback-pasting and the fact that S preserves monics, Î± is crisp. 
Theorem 3.10 Let T be a taut monad in Set. Then T is deterministic if and only if there exists a taut monad map T â†’Î²âˆ—. T is crisp if and only if there exists a taut monad map T â†’ Î².
Proof We give the proof for â€œdeterministicâ€, the crisp case being entirely similar. If T is deterministic, by Proposition 3.7, supp = T âˆ’âˆ’Î»â†’ Î²âˆ— âˆ’âˆ’Î¹â†’ F with Î¹ the submonad inclusion. As Î¹ and Î¹Î» are taut monad maps, so is Î». Conversely, suppose
Î» : T â†’ Î²âˆ— is a taut monad map. The taut inclusion Î¹ : Î²âˆ— â†’ F is its own support map by [13, Proposition 3.6] so that Î²âˆ— is deterministic by Proposition 3.7. Thus T is deterministic by Lemma 3.9.	 
We emphasize that T is necessarily a taut monad if it admits a taut monad map to a taut monad, so the a priori assumption that T be taut in the previous theorem is necessary only in one direction.
Example 3.11 The exception monad Ex of Example 2.14 is taut and deterministic since
prin  +id
âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’â†’ Î²Ù¨X
is a taut monad map. (This holds, as well, for any set E of exceptions in that example).
Theorem 3.12 Let T be a principal taut monad. Then T is deterministic if and only if T admits a taut monad map to the exception monad.
Proof	If prin(A) is an ultrafilter, A is a singleton so Î²âˆ—X âˆ© PX = Ex X.	 
At this point one might wonder if every deterministic taut monad admits a taut monad map to the exception monad. The next example shows that this is not the case.
Example 3.13 There is no monad map Î²âˆ—â†’ Ex. To see this, note that the variety of Ex-algebras is the category Setâˆ— of sets with base point whereas, as has already been discussed above, the variety of Î²âˆ—-algebras is the category CT2âˆ— of

compact Hausdorff spaces with base point. It must be shown, then, that there is no forgetful functor H(X, âˆ—) = (X, âˆ—, 7 ) with 7 a compact Hausdorff topology on X in such a way that every function f : (X, âˆ—) â†’ (Y, ) with f (âˆ—) =  is such that f : H(X, âˆ—) â†’ H(Y, ) is continuous. To find a contradiction, suppose that such H exists and choose X = {x1, x2,.. .} with base point x1 and write

H(X, x1) = (X, x1, 7 ). By Hausdorff, there exists âˆ… /= U âˆˆ 7 with x1 âˆˆ/
U . For

any âˆ… /= A âŠ‚ X with x1 âˆˆ/ A, let f : X â†’ X be any function with f (x) = x1 if
x âˆˆ/ A whereas f (A) âŠ‚ U . Then A = f âˆ’1(U ) is open. This shows that X \ {x1} is an open discrete subspace. Now let x1 âˆˆ V âˆˆ 7 . As {V }âˆª {{x} : x âˆˆ/ V } has a finite subcover, X \ V is finite. Thus if Â£ is the one-point-compactification topology induced by adding x1 to the locally compact discrete space X \ {x1}, 7 âŠ‚ Â£. As both topologies are compact Hausdorff, 7 = Â£. Now let g : X â†’ X be defined by g(x1) = x1, g(x) = x2 if x /= x1. As lim(xn : n = 0, 1,... , ) = x1, g is not continuous. This is the desired contradiction.
Example 3.14 Reldet = Pfn. For the submonad P0 of the subsets monad P, P0X = {A âŠ‚ X : A is finite}, The Kleisli category is the category of sets and finite-valued relations. The deterministic maps also produce the category Pfn.
Example 3.15 Let L = (L, Î·, Î¼) be the list monad. The deterministic maps f : X â†’ LY in SetL satisfy fx = yn for some y âˆˆ Y , n â‰¥ 0 because Ld arises as the pullback
Ld 	) Ex
v	v
L	mem ) P0
where EX = X +  â€”â†’ P0X maps x to {x} and the unique element of  to âˆ…. Noting that y0 = z0 even if y /= z, let N+ = {1, 2, 3,.. .}, and define LdX = (X Ã—N+)+{âŠ¥}. In the Kleisli category, maps are partial functions whose values include an integer
â‰¥ 1 and these integers multiply when maps are composed.
Example 3.16 Let M be a monoid with unit e and multiplication mn. Let






Î¼
â€”â€”â€”â€”â†’
TX	=  (X + {âŠ¥}) Ã— M
Î·
â€”â€”â€”â€”â†’ TX,	x 'â†’ (x, e)
TX,	(âŠ¥, m) 'â†’ (âŠ¥, m),  ((x, m), n) 'â†’ (x, mn)

Such T is a deterministic taut monad. When M is (N, +, 0), the morphisms may be interpreted as partial functions whose values return a computation time.
Example 3.17 It is obvious that Fdet = Î²âˆ—. It is easily checked that NX = {J âˆˆ FX :  J /= âˆ…} is a submonad of F. We called this the neighborhood monad in [10] since the most well known example of elements of NX are neighborhood filters in a topological space. As NX âˆ© Î²âˆ—X is the set of principal ultrafilters on X, Ndet = N âˆ© Î²âˆ— is the identity monad. Thus the only deterministic maps in the Kleisli category of N are the ordinary total functions between sets.

The N-algebras are â€œcontinuous lattices without topâ€. A more precise descrip- tion is as follows. An N -semilattice is a partially ordered set with all non-empty infima (and hence all bounded suprema) such that for every non-empty family (Di : i âˆˆ I) with each Di a bounded directed subset of X, the following equation
holds:
  (  Di) =	   (  di)
i	dâˆˆQ Di i
We leave it to the reader to verify that SetN is the category of all N -semilattices with morphisms that preserve non-empty infima and bounded directed suprema. (Hint: show that (NX, âŠ‚) is the free N -semilattice generated by X with f # : NX â†’ Y defined by f #(J)=  AâˆˆF  (f A) ).

Comparison with Restriction Categories

Definition 4.1 A restriction category [4] is a category equipped with a unary operation f : X â†’ Y 'â†’ f : X â†’ X subject to the following four axioms:
(R.1) For f : X â†’ Y , f f = f .
(R.2) For f : X â†’ Y , g : X â†’ Z, f g = g f .
(R.3) For f : X â†’ Y , g : X â†’ Z, g f = g f .

f
(R.4) For X â€”â€”â†’ Y
g



â€”â€”â†’ Z, gf = f gf .



In any restriction category, each endomorphism of form f : X â†’ X is an idempo- tent. We call it a restriction idempotent and the set R(X) of all such restriction idempotents is a commutative idempotent semigroup and so forms a semilattice. The interpretation of f is â€œthe domain of definition of f â€, e.g. fx = x if fx is defined and is otherwise undefined. It is discussed in precise detail in [5] that the axioms are not compatible with â€œmore than one exceptionâ€, so our discussion here is only intuitive. In any restriction category, a morphism f is total if f = id. Any category is a restriction category if all maps are declared total, so that there need not be any exceptions. The interpretation of Axiom (R.4) is that all maps are de- terministic. To see the idea, suppose fx includes two distinct outputs a, b. Let ga be defined, gb not. Then b is an output of f gf x = fx whereas gf x = a so (R.4) fails.
Let us be more precise for SetT with T taut. View T âˆ… (the distributions on the empty set) as the set of exceptions of T. The condition that there is exactly one exception is then that T âˆ… = and we call T a zero monad if it satisfies this condition since then âˆ… is the zero object of the Kleisli category. This Kleisli category then has a natural definition of restriction as follows:
Definition 4.2 For Î± : X â†’ TY with T a zero monad, define Î± : X â†’ TX by the following diagram in which the top row is a coproduct:

[Î±]âˆ…
'
X	([Î±]âˆ…)

v	vÎ±	vi
T âˆ… 	) T X(	 X
Tj'	Î·X
where i', i,j are inclusions.
Theorem 4.3 [15, Theorem 6.4] For a taut zero monad T with the restriction operator of Deï¬nition 4.2, SetT is a restriction category if and only if T is a deterministic monad.	 
Example 4.4 The monad Î²âˆ— is a deterministic zero monad. F is a zero monad which is not deterministic. Î² and N are not zero monads.
The intense study of domains in computation theory begins by observing that the set Pfn(X, Y ) of partial functions from X to Y is ordered by extension. This is available in any restriction category as follows.
Every restriction category is an ordered category. For f, g : X â†’ Y say that f â‰¤ g if g f = f , literally â€œg restricted to the domain of f is f â€. This is always a partial order and composition on either side is monotone.
The study of domains has for the most part not focused on the more mundane programming constructs such as if-then-else. But this construct is readily available in the ordered category Pfn: if P âŠ‚ X with inclusions i : P â†’ X, i' : P ' â†’ X, and f, g : X â†’ Y , if P then f else g : X â†’ Y is f i âˆ¨ gi'. What happens here, is that the semilattice R(X) of restriction idempotents is 2X and this is the Boolean algebra of tests. A general class of ordered sets that have the necessary structure was introduced in [5], and are defined next.
Definition 4.5 A partially ordered set P with a least element 0 is a locally Boolean poset if for all x âˆˆ P the principal downset â†“x = [0, x] is a Boolean algebra whose finite suprema are suprema in P . If P, Q are locally Boolean posets, a function f : P â†’ Q is a locally Boolean map if f is monotone, f (0) = 0 and, for all x, the induced function [0, x] â†’ [0,f x] is a Boolean algebra homomorphism. Denote the category of locally Boolean posets as LBP.
A natural associated class of restriction categories is then as follows.
Definition 4.6 A classical restriction category is a restriction category C which satisfies the following two axioms:
(CR.1) C is enriched over LBP, that is, the homset C(X, Y ) under the restriction ordering f â‰¤ g if g f = f is a locally Boolean poset and composition on either side is a locally Boolean map.
(CR.2) Denoting the least element of C(X, Y ) as 0 : X â†’ Y , if f, g : X â†’ Y are
disjoint, written f âŠ¥ g, in that f g =0 then f âˆ¨ g exists in C(X, Y ).
We regard Boolean algebras as forming a variety of universal algebras. As such, 0 is the terminal object so [0, x] â†’ [0, 0] is a Boolean algebra homomorphism.



Example 4.7 Pfn is a classical restriction category. Here, f (x)= x if fx is defined and is otherwise undefined. [0,f ] âˆ¼= 2D with D = {x : fx is defined} is how homsets are locally Boolean posets. A somewhat more gradual explanation can be given as follows. In LBP, coproducts exist as the disjoint union poset with all least elements identified. Products exist in LBP using the pointwise-ordered product poset. Every Boolean algebra is a locally Boolean poset. Start with the Boolean algebra 2. The flat poset AâŠ¥ obtained by adding a bottom element to discrete A a simply a typical copower of 2 in LBP. The locally Boolean poset power (YâŠ¥)X is precisely the poset Pfn(X, Y ). The local Booleanness of composing on either side now follows from standard properties of product and coproduct.
Ex is a deterministic zero monad and its Kleisli category (namely Pfn) is a classical restriction category. A surprise of this paper is that this happens for every deterministic zero monad.
Theorem 4.8 The Kleisli category of a deterministic zero monad T = (T, Î·, Î¼) is a classical restriction category.
Proof SetT is a Boolean category with zero maps and all maps deterministic, and is a restriction category as in Definition 4.2 by Theorem 4.3. That such a category is a classical restriction category is one of the main theorems of [5]. We briefly indicate how the locally Boolean structure arises in this specific context. The lattice structure of [0, Î³] is as follows. If Î±, Î², Î³ : X â†’ Y with Î±, Î² â‰¤ Î³. The infimum Î± âˆ§ Î² is Î±Î². The supremum Î± âˆ¨ Î² is defined by

[Î±]âˆ… 	i ) X io
( j

Î± âˆ¨ Î²
([Î±]âˆ…)'
jo

v 	)	v (		v
TX	Î±	TY	Î²	TX 
where i, j are inclusions. Now, the restriction idempotents of X constitute the interval [0, 1] which is order-isomorphic to Summ(X) by [11, Theorem 8.15] and so forms a Boolean algebra. Thus [0, Î³] is an interval in a Boolean algebra so is itself a Boolean algebra. It is shown that [0, Î³] â†’ [0, Î³], Î± 'â†’ Î± is an order isomorphism. 

Dynamic Logic of Spaces
In this section, we observe that for any topological space X there is an appropriate endomorphism Î± in a taut-monad Kleisli category for which [Î±]Q, <Î±> Q are, respectively, the interior and closure operators of the space. Thus any valid formula of dynamic logic involving one Î± is a law of topological spaces. We also study classes of topological spaces induced by taut monads. We begin with a general definition and proposition for taut monads.
Definition 5.1 Let T be a taut monad. A T-topological space is a pair (X, t) with t : X â†’ TX an idempotent in SetT such that [t]Q âŠ‚ Q for all Q âŠ‚ X. A subset Q is t-open if [t]Q = Q.

Proposition 5.2 For a T-topological space (X, t), the t-open sets form a topology with interior operator [t]Q and closure operator <t> Q.
Proof âˆ… is open since [t]âˆ… âŠ‚ âˆ…. By elementary facts about pullbacks, [t]X = X and [t](Q âˆ© R) = [t]Q âˆ© [t]R so X is t-open and a finite intersection of t-opens is t-open. If V =  Vi with each Vi t-open, x âˆˆ V â‡’ âˆƒ i x âˆˆ Vi = [t]Vi âŠ‚ [t]V so V is t-open. So far, the t-opens form a topology. For any Q âŠ‚ X, [t]Q is t-open since (in any Boolean category) [Î±]([Î²]Q)= [Î²Î±]Q and t is idempotent with [t]Q âŠ‚ Q. If x âˆˆ Qâ—‹ there exists U = [t]U with x âˆˆ U âŠ‚ Q. Thus x âˆˆ [t]U âŠ‚ [t]Q. This shows [t]Q = Qâ—‹. But then Q = Q'â—‹ ' = ([t]Q')' =<t> Q.	 
Theorem 5.3 Every topological space is an F-topological space for the ï¬lter monad
F.
Proof	Let X be a topological space with neighborhood filter ğ’©x at x. Define
t : X â†’ FX by tx = ğ’©x. Then t# : FX â†’ FX maps J to {A âŠ‚ X : {x âˆˆ X : A âˆˆ
ğ’©x} âˆˆ J} = {A âŠ‚ X : Aâ—‹ âˆˆ J} so that t#(tx)= t#(ğ’©x)= {A âŠ‚ X : Aâ—‹ âˆˆ ğ’©x} =
ğ’©x, which shows t is idempotent. By Example 2.20, [t]Q = {x âˆˆ X : Q âˆˆ tx} =
{x âˆˆ X : Q âˆˆ ğ’©x} = Qâ—‹ so [t]Q âŠ‚ Q.	 
Example 5.4 Segerburgâ€™s axiom [20] is
[Î±]Q âˆ© <Î±> R  âŠ‚ <Î±> (Q âˆ© R)
This example is obviously true in Rel, so by the Kozen completeness theorem it must hold in all Boolean categories. Hence any topological space must satisfy

Qâ—‹ âˆ© R  âŠ‚  Q âˆ© R
Example 5.5 In Rel, Î± : X â†’ PY is a partial function if and only if for all subsets Q, R of Y , <Î±> (Q âˆª R) = <Î±> Q âˆª <Î±> R. Equivalently, Î± is a partial function if and only if <Î±> Q âŠ‚ [Î±]Q for all Q. It follows that a topological space is discrete if and only if (Q âˆª R)â—‹ = Qâ—‹ âˆª Râ—‹ since Q âŠ‚ Qâ—‹ obviously forces discreteness.
It is clear that Theorem 5.3 can be proved using any submonad of F which contains all neighborhood filters, such as N. However, no submonads of Î²âˆ— will yield interesting spaces, as the following example attests.
Example 5.6 If T is a deterministic monad then every T-topological space is dis- crete. This follows from Lemma 3.5 (2) since any T-topological space satisfies Q âŠ‚ Qâ—‹.
A topological space is an Alexandroff space [1] if every intersection of open sets is open. It is well known that the category of Alexandroff spaces and continu- ous maps is isomorphic to the category of preordered sets (sets with reflexive and transitive relation) and monotone maps. The open sets are the lower sets, so â†“x is the minimum neighborhood of x, and the closed sets are the upper sets. Here, x â‰¤ y â‡” y âˆˆ {x}.

Proposition 5.7 If T is a principal monad then every T-topological space is Alexandroff.
Proof	Let (X, t) be a T-topological space, so that t â—¦ t = t, [t]Q âŠ‚ Q. We have [t]Q  =  {x âˆˆ X : Q âˆˆ supp(tx)}  =  {x âˆˆ X : mem(tx) âŠ‚ Q}
so Q is open if and only if mem(tx) âŠ‚ Q â‡’ x âˆˆ Q. Write x â‰¤ y if y âˆˆ mem(tx). As mem(tx) âŠ‚ mem(tx), x âˆˆ [t](mem(tx) âŠ‚ mem(tx), so x â‰¤ x. By Lemma 2.24,

mem(tx)  =  mem(t#(tx))  =	 
mem(ty)

yâˆˆmem(tx)
so y âˆˆ mem(tx) â‡’ mem(ty) âŠ‚ mem(tx). Thus if x â‰¤ y, y â‰¤ z then y âˆˆ mem(tx), z âˆˆ mem(ty) âŠ‚ mem(tx) and x â‰¤ z. This shows that â‰¤ is a preorder. If x âˆˆ Qâ—‹ = [t]Q and x â‰¤ y then y âˆˆ mem(tx) âŠ‚ Q â‡’ mem(ty) âŠ‚ mem(tx) âŠ‚ Q, so y âˆˆ Qâ—‹. Thus Qâ—‹ is an upper set. Conversely, if Q is an upper set and x âˆˆ Q, y âˆˆ mem(tx) then x â‰¤ y â‡’ y âˆˆ Q so mem(tx) âŠ‚ Q. This shows that Q âŠ‚ [t]Q. We have shown that the open sets are the upper sets of a preorder, so the space is Alexandroff. 
Example 5.8 For P the power set monad, the P-topological spaces are precisely the Alexandroff spaces.
To see this, since P is a principal monad, the previous proposition gives that all its topological spaces are Alexandroff. Conversely, if t : X â†’ PX is any reflexive and transitive relation then t â—¦ t (being the composition in Rel) âŠ‚ t whereas t = t idX âŠ‚ t â—¦ t, so t is idempotent. If tx âŠ‚ Q then x âˆˆ tx âŠ‚ Q so [t]Q âŠ‚ Q. Thus a reflexive and transitive relation is a P-topology. As tx =â†‘x, Qâ—‹ = [t]Q = {x :
â†‘x âŠ‚ Q}, the open sets are the upper sets. Hence an arbitrary Alexandroff space is a P-topological space.	 
The nicest results for G-topological spaces arise when G is a submonad of the filter monad and we conclude with some results of that type, beginning with
Proposition 5.9 Let G be a submonad of the ï¬lter monad F. Then the following hold.
If (X, t) is a G-topological space, âˆ€ x âˆˆ X, tx is the neighborhood ï¬lter ğ’©x of
x.
A space X arises as a G-topological space if and only if âˆ€ x âˆˆ X, ğ’©x âˆˆ GX.
Proof  Let (X, t) be a G-topological space. By Example 2.20, Qâ—‹ = [t]Q = {x âˆˆ
X : Q âˆˆ tx} so that ğ’©x = {Q âŠ‚ X : x âˆˆ Qâ—‹} = {Q âŠ‚ X : Q âˆˆ tx} = tx. This proves the first statement from which the second is clear, given the proof of Theorem 5.3.	 
Despite the uselessness of submonads of Î² for producing spaces, as demonstrated by Example 5.6, the next proposition provides a construction which transforms arbitrary submonads of F (including of Î²) into useful submonads.

Proposition 5.10 Let G be a submonad of F. Then
G^X	= {J âˆˆ FX : J =  (Gi : i âˆˆ I) with I /= âˆ…, Gi âˆˆ GX}
is again a submonad of F.
Proof	For x âˆˆ X, prin(x) âˆˆ GX âŠ‚ GX. Now let Î± : X â†’ GY , J âˆˆ GX and write J =  Gi with Gi âˆˆ GX. then B âˆˆ Î±#J â‡” {x : B âˆˆ Î±x} âˆˆ J â‡” âˆ€ i {x : B âˆˆ Î±x} âˆˆ Gi â‡” âˆ€ i B âˆˆ Î±#Gi. As Î±#Gi âˆˆ GY , Î±#J =  i Î±#Gi âˆˆ GY .		 Recall [17] that a space has countable tightness if whenever x âˆˆ A there
exists a countable subset C âŠ‚ A with x âˆˆ C.
Proposition 5.11 Let Î²Ï‰X = {U âˆˆ Î²X : some member of U is countable}. Then
Î²Ï‰ is a submonad of Î² and every Î²^Ï‰ -topological space has countable tightness.
Proof  For x âˆˆ X, prin(x) âˆˆ Î²Ï‰ X since {x} is countable. Now let Î± : X â†’ Î²Ï‰Y , U âˆˆ Î²Ï‰X. Let A be a countable member of U and let Bx be a countable member of Î±x. Then C =  xâˆˆA Bx is countable. For x âˆˆ A, Bx âˆˆ Î±x â‡’ C âˆˆ Î±x. Thus
{x âˆˆ X : C âˆˆ Î±x} âŠƒ A so A is a countable member of Î±#U. This proves Î²Ï‰ is
a submonad. Now let (X, t) be a Î²Ï‰ -topological space. Applying Proposition 5.9,
'
every neighborhood filter is in Î²^Ï‰ X. Let x âˆˆ A. Then A âˆˆ/ ğ’©x so there exists
V âˆˆ Î²Ï‰X with ğ’©x âˆª {A} âŠ‚ V. Let C be a countable member of V. Then A âˆ© C is
a countable subset of A. As A âˆ© C âˆˆ V, every neighborhood of x intersects it, so
x âˆˆ A âˆ© C.	 

References
P. S. Alexandroff, UÂ¨ber die Metrisation der im kleinen kompakten topologische RaÂ¨ume, Mathematische Annalen 92, 1924, 294â€“301.
Barr, M., Coequalizers and free triples, Mathematische Zeitschrift 116, 1970, 307â€“322.
Bird, R. and de Moor, O., Algebra of Programming, Prentice-Hall, Europe, 1998.
Cockett, J. R. B. and Lack, S., Restriction Categories I: Categories of partial maps, Theoretical Computer Science 270 (2002), 223â€“259.
Cockett, J. R. B. and Manes, E. G., From Boolean categories to classical restriction categories, to appear.
Day, A., Filter monads, continuous lattices and closure systems, Canadian Journal of Mathematics XXVII, 1975, 50â€“59.
Fischer, M. J., and Ladner, R. E., Propositional dynamic logic of regular programs, Journal of Computer and System Sciences 18, 1979, 282â€“294.
Kozen, D., A representation theorem for models of *-free PDL, in J. W. de Bakker and J. Van Leeuwen (eds.), Automata, Languages and Programming, ICALP â€™80, Lecture Notes in Computer Science 85, Springer, 1980, 351â€“362.
Mac Lane, S., Categories for the Working Mathematician, Springer, Berline, 1971.
Manes, E. G., A class of fuzzy theories, Journal of Mathematical Analysis and Applications 85, 1982, 409â€“451.
Manes, E. G., Predicate Transformer Semantics, Cambridge University Press, 1992.
Manes, E. G., Implementing collection classes with monads, Mathematical Structures in Computer Science 8 (1998), 231â€“276.

Manes, E. G., Taut monads and T 0 spaces, Theoretical Computer Science 275 (2002), 79â€“109.
Manes, E. G., Monads of Sets, in M. Hazewinkel (ed.), Handbook of Algebra, Vol. 3, Elsevier, Amsterdam, 2003, 67â€“153.
Manes, E. G., Boolean restriction categories and taut monads, Theoretical Computer Science, 360 (2006), 77â€“95.
Moggi, E., Notions of computation and monads, Information and Computation 93 (1991), 55â€“92.
Moore, R. C. and MrÂ´owka, S., Topologies determined by countable objects, Notices of the American Mathematical Society 11, 1964, 554.
Pratt, V. R., Semantical considerations on Floyd-Hoare logic, Proceedings of the 17th IEEE Symposium on the Foundations of Computer Science, 1976, 109â€“121.
Riesz, F., Stetigskeitbegriff und abstrakte mengenlehre, Proceedings of the International Congress of Mathematicians, Series I, Fourth Congress, Rome, 2 (1908), 18â€“24; Kraus Reprint Limited, Nendeln/Liechtenstein, 1967.
Segerburg, K., A completeness theorem in the modal logic of programs, Notices of the American Mathematical Society 24, 1977, A-522.
Wadler, P., Comprehending monads, Mathematical Structures in Computer Science 2 (1992), 461â€“493.
Wyler, O., Algebraic theories of continuous lattices, Lecture Notes in Mathematics 871, Springer, Berlin, 1981, 390â€“413.
