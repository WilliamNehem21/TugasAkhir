

Electronic Notes in Theoretical Computer Science 270 (1) (2011) 155–163
www.elsevier.com/locate/entcs
Classical Knowledge for Quantum Security
Ellie D’Hondt2
Vrije Universiteit Brussel & FWO, Belgium
Mehrnoosh Sadrzadeh 1
Laboratoire Preuves Programmes et Syst`emes, Universit´e Paris 7, France

Abstract
We propose a decision procedure for analysing security of quantum cryptographic protocols, combining an algebraic logic rewrite system with an operational semantics for quantum distributed computations. We apply our approach to reasoning about security properties of a recently developed quantum secret sharing protocol.
Keywords: Quantum cryptography, distributed measurement calculus, algebraic information update.


Introduction
Quantum communication is an inseparable part of quantum computing: it offers solutions to the risks caused by exponential speed-up in the power of an adversary as a result of quantum algorithms. While some advances have been made in the area of formal verification of quantum communication protocols [11], no applicable formal framework has yet been suggested for their automatic cryptanalysis. This is contrary to the fact that, similar to the situation in classical security, attacks have been discovered on proven-to-be-safe quantum protocols. In this paper we present a decision procedure that verifies whether a protocol satisfies a security property by deriving knowledge properties of its agents on the dynamic and epistemic traces of the protocol. The dynamic traces are generated from the specification of a protocol using the operational rules of distributed measurement calculus [5] (DCM). These are then expanded to the epistemic traces using appearances of agents about the actions of the protocol. The appearances are derived from the safety assumptions of

1 Email: mehrs@comlab.ox.ac.uk
2 Email: Ellie.DHondt@vub.ac.be

1571-0661 © 2011 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2011.01.014

the communication channels according to a set of rules. Our notions of knowledge and time are classical and have been used in formal analysis of classical protocols, for example in Halpern style models of [14,7] and in dynamic epistemic algebra of [2,17].
Both the DCM model and the algebra have been previously used to analyze the security of quantum key distribution (QKD) and its attacks [8,7,16]. The setting of this paper has advantages over both these attempts. First, we rely on the already existing rules of the semantics of DMC, as opposed to adding axioms for quantum mechanics to the algebra. Second, we use the algebraic axiomatics of adjunction to derive knowledge properties of the protocol, as opposed to model-checking them by traversing the tree of the protocol. Third, we set the actions of the adversary in a compositional way using the appearance maps of the algebra, as opposed to ad- hocly adding them to the specification of the protocol. We prove that our decision procedure is sound and terminating with regard to the pair of a DMC model and the algebraic axiomatics of Epistemic Systems. We apply our decision procedure to a new quantum secret sharing (QSS) protocol, which is based on graph states and has been proposed recently in [12]. For this protocol, we develop epistemic properties and prove them for three kinds of assumptions on the quantum channels: safe, unsafe with non-suspicious agents, and unsafe with suspicious agents. However, we can only work on a one-round basis and indeed, for a full analysis of protocols one needs to run the protocol in many runs and then use probabilities, for instance on the knowledge modalities. This would be a natural and exciting extension of the currently proposed framework.
In a nut shell, our framework is obtained by merging the model checking ap- proach of [8,7] and the algebraic axiomatics of [16]. The former is based on a distributed extension [5] for an assembly language [6] that universally models com- putations of the one way model. Its knowledge operator is defined over Kripke structures in the style of Fagin et al [10] by using equivalence relations on the states. Reasoning about properties of a protocol is done on the state space of this structure using a logic with temporal and epistemic operators. The latter is based on the Stone-like duals of these relational systems and moreover, following [4], a quantale structure is assumed on the actions. This setting consists of a pair of a quantale of classical and quantum actions and its right module of bits and qubits in- volved in a protocol. The pair is endowed with a family of join-preserving maps, one for each agent involved in the protocol. The right adjoints to these endomorphisms give rise to a very useful notion of knowledge, both on propositions of module and actions of quantale.

Decision Procedure
First, given the specification of a quantum protocol as a program in the language of the distributed measurement calculus (DMC), we generate its dynamic traces by executing the rules of the operational semantics. Second, we write the epistemic property we wish to prove about security of the protocol in the language of Epistemic

Systems. Finally, we apply our algebraic rewrite system to decide whether the protocol satisfies the property or not, The last step unfolds the appearances to agents of dynamic traces and adds new traces to the existing dynamic, to which we refer as epistemic traces.
Specify and trace in DMC. A network of agents N is defined by a set of agents acting in parallel (denoted by |) acting on a given entanglement resource |ψ⟩,
N = |ψ⟩ A(Q).£ | B(Q′).£′ ...  .
An agent A(Q).E is specified by a name A, a set Q of qubits it owns, and an event sequence E consisting of computations in the measurement calculus, classical message reception c?x and sending c!y, and qubit reception qc?q and sending qc!qj. Note that, contrary to the original definitions in [5] we now write specifications from left to right; also agents may have extra classical parameters a, written as A(a, Q). As an example, here is one round of Ekert’s implementation of QKD:
QKD = E12  A(a, 1).[Ha; M1; c!a; c?b] | B(b, 2).[Hb; M2; c?a; c!b] . 
1	2
The set of traces of a program are generated by following the rules of the small- step semantics as specified in [5], but moreover, we work with projections, annotate actions with agents that performed them, and name the preparation actions of

the initial entanglement resource |ψ⟩. For example, PA,α
stands for the spin α

projection of qubit i done by agent A. The preparation actions are made explicit by juxtaposing them to the left most of the traces; for QKD the entanglement resource E12 is created by applying N1; N2; E12 to a 2-qubit system q1 ⊗ q2, where N is preparation in the |+⟩ state, and then distributing these qubits over agents A and B. Two of the four possible traces for a successful run of QKD are
π = N1; N2; EA,B; PA,X ; PB,X ; c!a; c?a; c!b; c?b,	π′ = N1; N2; EA,B; PA,Z ; PB,Z ; c!a; c?a; c!b; c?b ,
1,2	1	2	1,2	1	2
Reduce in Epistemic Systems. The input to the rewrite system is an expression of the form l ▶ r where l is the initial state and r is an epistemic property that contains the disjunction of dynamic traces produced above. The expression qi ▶ [π]□A□Asj, reads as ‘after running the trace π of the protocol on qbit qi, agent A knows that B knows that the value of bit i is j’. The l and r expressions are generated as follows:

One such expression for Ekert’s QKD is
q1 ⊗ q2 ▶ hN1; N2; EA,B; PA,X ; PB,X ; c!a; c?a; c!b; c?bi □A□B(s0 Λ s0)
Proving this property together with a permutation of it for the knowledge of B will imply that A and B share a piece of data. That the data is secret is proved by showing that an adversary E does not know it, that is the following expression

q1 ⊗ q2 ▶ hN1; N2; EA,B; PA,X ; PB,X ; c!a; c?a; c!b; c?bi ч□E (s0 Λ s0)
We proceed by analyzing uncertainty of agents about the states and actions of protocols. These are referred to as appearance maps and are denoted by fA for an agent A. They encode all possible actions or propositions that appear possible to an agent, given the action that is happening or the proposition that is true in reality and are set according to the general rules below.



For example the appearance of the projection action PA,X
in our above trace are

fA(PA,X )= PA,X,	fB (PA,X )= PA,X V PA,−X V PA,Z V PA,−Z   .
1	1	1	1	1	1	1
Due to space limits we refrain from presenting the rewrite rules; they are similar
to the system presented in [15]. By applying them, one first eliminates the logical connectives ∧, ∨, □A, [ ] and then the classical and quantum communication actions. The output is a set of atomic expressions:
Definition 2.1 An expression l ▶ r is atomic iff l is a quantum state followed by a sequence of atomic quantum actions and r is an atomic classical or quantum state.
For instance, for a safe quantum channel, the atomic form of the our sharing property is (q1 ⊗q2)(N1; N2; EA,B; PA,X ; PB,X ) ▶ s0 ∧s0. These atomic expressions
1,2	1	2	1	2
contain new epistemic uncertainties and need to be verified against our operational
semantics. Only then can we check if a protocol has a desired epistemic property.
Definition 2.2 An atomic expression l ▶ r is well-deﬁned iff l is derivable within the operational semantics of DMC. It is true iff r holds in all configurations resulting from l. An epistemic property holds for a protocol whenever all its well-defined atomic expressions are true.
Proposition 2.3 For a protocol speciﬁcation N and a given expression l ▶ r which is built from the dynamic traces of N, the process of deciding if the epistemic prop- erty in r holds for N is terminating and sound with regard to the pair of an Epis- temic System and a DMC model.

Proof. These follow from image finiteness of appearances of actions and proposi- tions, together with soundness and termination of the rewrite system of Epistemic Systems and the DMC model [5,15].

Case study: quantum secret sharing
We apply our procedure to the quantum secret sharing (QSS) protocol recently established in [12]. In secret sharing a dealer holds a secret bit which he wants to send to n players, such that at least k players are needed to reconstruct the secret. The problem is well-known in classical settings and solvable for all (n, k). In the quantum case, only the (n, n) case has been solved for the GHZ-type entanglement [18]. The work in [12] uses instead graph states and thus is more suitable for modelling in our measurement-based setting. Moreover, it generalizes the quantum key distribution protocols and simplifies their proofs. We analyze and prove some of the epistemic properties of the QKS component of the (3, 5) case where a particular graph state is used to establish a secret key between three players and the dealer in one go (as opposed to via several 2-party QKD protocols). This key will then be used to distribute a secret using the other components of the protocol.

The resource required for the protocol is the graph state shown above, henceforward called G(3, 5). It is prepared following the usual procedure for graph states, that is
G(3, 5) = (N1; ... ; N5; N6;  Eij ) ⊗6	qi;, 
eij
with eij the set of edges. The protocol proceeds as follows:

We refrain from giving the full specification of the QSS network and move straight on to its traces where we introduce the notation a!σ to stands for the broadcasting of the value a throughout the network by agent σ. The communica-

tion between the dealer and players can be listened to, while communication among players is secure and occurs through a handshake between operations c? and c! (c!? in short). We differentiate between both types of communication in our security analysis below. A typical trace for a successful run of QSS is as follows

π = N1; ... ; N6; eij Eij	(preparation) (qc!?Dq1) ... (qc!?Dq5)	(distribution of qubits)

PD,±aPAi,±bPAj,±cPAk,±f
(measurement projections)

6	i	j	k
a!D; b!Ai ; c!Aj ; f !Ak	(public broadcast of measurement bases)

(c!?Ai
s )(c!?Aj
s )(c!?Ak
s ) (private exchange of player measurement outcomes).

Aj,Ak i
Ai,Ak j
Ai,Aj  k

Here a ∈ {X, Y }, b, c,f ∈ {X, Y, Z} are measurement basis, qc!?D
is the quantum

message passing from D to Ai ∈ {A1, ··· , A5} denoting the 5 players, and c!?Ai is the private announcement from player Ai to the group β ⊆ {A1, ··· , A5}. We omit the calculation of the secret key s = si ⊕ sj ⊕ sk. Successful traces depend only on the chosen values for a, b, c and e; one example for adjoining agents A1, A2 and A3, owning qubits 1,2 and 3 respectively, is


π = ...PD,+Z PA1,−Z PA2,−X PA3,+Z Z!D; Z!A1 ; X!A2 ; Z!A3 ; (c!?A1
1)(c!?A2
1)(c!?A3	0)

6	1	2	3
A2 ,A3
A1 ,A3
A1 .A2

Epistemic Properties
We consider three cases: agents’ heaven, adversary’s heaven, and adversary’s hell. In the first case the quantum channel is safe, in the second case it is not and the honest agents do not suspect it, in the third case it is not and the honest agents do suspect it. The other channels are assumed to be safe in both cases.
Agents’ heaven
The appearance of the projections are set according to rule (iii) of appear- ances. Since the channels are safe, the communication actions on the quantum channel are also treated as public broadcasts, i.e. for σ an agent we have fσ(qc!?Dqi) = qc!?Dqi. The communication actions on the classical channels are private announcements, i.e. for a subset of players β we have

fσ (c!?
Ai sj )= 
σ j
β i
c!?σsj V c!?Ai j
σ ∈ β σ ∈/ β

Some of the epistemic properties of interest for our trace π, allied players
Ai ∈ {A1, A2, A3}, joined with dealer σ ∈ {D, A1, A2, A3} are as follows

Adversary’s heaven
The quantum channel is not safe and by rule (iv) we break its broadcasts to separate send and receive actions, whose appearances are not identities any

more. The appearances for a new qbit qj with j ≥ 7 are
D	,qc!Dqi; qc?Eqi; PE,e; NE,e; qc!Eqj  σ′ = E
For the corresponding receive action, it appears to the dealer that players receive the qbit he sent to them, fD(qc?Ai qi) = qc?Ai qi, whereas in reality they receive the qubit sent to them by adversary, fA (qc?Ai qi) = qc?Ai qj. In case the eavesdropper is lucky and chooses the right projection for all three qubits he intercepts, he is able to derive the value of the key. In this case some of the epistemic properties of interest are

Adversary’s hell
This is the same as above, but the players suspect adversary’s actions, that is
fA (qc!Dqi)= qc!Dqj V (qc!Dqi; qc?Eqi; PE,e; NE,e; qc!Eqj )
i	i	j
Similarly, the dealer suspect adversary’s actions on the receipt of his sent qbit
fD(qc?Ai qi)= qc?Ai qi V (qc?Eqi; PE,e; NE,e; qc!Eqj ; qc?Ai qj )
i	j
An interesting epistemic property is

We verify the property ⊗6 qi ▶ [π]□D□i s0 in the agents’ heaven and a similar
one with ¬□σ¬□Es0 . in the adversary’s hell. The atomic expressions are generated via the following rewritings, where αi’s denote the juxtaposed actions of π,

⊗6  qi ▶ [π]□D□A s0
~	⊗6
qi; π ▶ □D□A s0
~	fA fD(⊗6
qi; π) ▶ s0 ~

i=1
i  6	i=1
i  6	i
i=1	6

fA fD(⊗6  qi); fA fD(π) ▶ s0	~	fA fD(⊗6  qi); fA fD(α1); ··· ; fA fD(αn) ▶ s0  .
i	i=1	i	6	i	i=1	i	i	6

By rule (ii) of appearances we have fA fD(⊗6 qi)= ⊗6
qi. By rule (iv) and our

i	i=1	i=1
assumptions on channels, we have fD(αi) = αi for αAi a quantum or broadcast
communication action. By rule (iii) for communication between players we have
fD(c!?Ai sj)= c!?Ai sj ∨ c!?Ai sj, similarly for the projection actions
β	i	β	i	β	i

fD (PD,+Z )= PD,+Z,	fD (PA1 ,−Z )= PA1 ,−ZVPA1 ,+ZVPA1 ,−XVPA1 ,+XVPA1 ,−Y VPA1 ,+Y	.

6	6	1
1	1	1
1	1	1

The values for the fAi ’s are similarly set. Substituting these values in the above expression, we first eliminate the traces in which the bases of projections do not match the announced bases. Next we eliminate the communication actions from these traces whose content do not match the projections. As a result, we obtain a set of atomic expressions, of which only those satisfying s0 = sb1 ⊕ sb2 ⊕ sb3 are

well-defined in DMC. An example (out of four) is
6	1	2	3

⊗6  qi; N1; ... ; N6;   Eij ; PD,+Z ; PA1,+Z ; PA2,−X ; PA3,−Z ▶ s0  .

This atomic expression is true, since in all its final configurations s6 is 0, and thus our epistemic property holds for the secret sharing protocol. On the contrary, in the adversary’s hell, one can similarly show that the epistemic property □D¬□Es0 does not hold and thus s0 is not treated a secret anymore. Moreover, we also discover paths of an intercept-change attack for each agent, for example the one for the player A1 contains the following sequence of actions
··· ; qc!Dq1; qc?Eq1; PE,+Z ; NE,+Z ; qc!Eq7; qc?A1 q7; PA1,+Z ; ··· 
1	7	7
Conclusion
In this article we proposed a new framework for formal analysis of security issues in quantum cryptographic protocols. The approach combines an algebraic rewrite system with a specification language for quantum distributed computations. The former provides machinery to work with uncertainties of agents in a protocol in a compositional way, while the latter inherently encodes the rules of quantum me- chanics. Our framework was put to the test in the analysis of quantum secret sharing, where we showed some epistemic properties of the protocol in the presence and absence of an active adversary. As a procedure of this type typically becomes hairy, we envision providing a software implementation which automates the anal- ysis of protocols. A software implementation of the algebra [15] is already in place to handle part of the verification. The construction of a tool that automatically derives the traces and semantics of a protocol is currently underway.
Acknowledgement
We had fruitful discussions with V. Danos, P. Panangaden, D. Markham. The second author has given talks on a version of the algebra with some quantum axioms encoded in it, which was partly based on joint work with E. Kashefi.

References
A. Baltag and L.S. Moss. ’Logics for epistemic programs’. Synthese 139, 2004.
A. Baltag, B. Coecke, and M. Sadrzadeh, ’Epistemic actions as resources’, Journal of Logic and Computation 17 (3), May 2007.
C.H. Bennett and G. Brassard, ’Quantum cryptography: public key distribution and coin tossing’, in Proceedings of IEEE international Conference on Computers, Systems and Signal Processing, Bangalore, India, page 175. IEEE Press, 1984.
B. Coecke and D. J. Moore and I. Stubbe, ‘Quantaloids describing causation and propagation of physical properties’, Foundations of Physics Letters, 14, 2001.
V. Danos, E. D’Hondt, E. Kashefi, and P. Panangaden, ’Distributed measurement-based quantum computation’, in Proceedings of the 3rd Workshop on Quantum Programming Languages (QPL05), ed.
P. Selinger, 2005.
V. Danos, E. Kashefi and P.Panangaden, ’The measurement calculus’, Journal of the ACM, 54(2), 2007.
V. Danos and E. D’Hondt, ’Quantum knowledge for cryptographic reasoning’, in Proc. 3rd International Workshop on Development of Computational Models (DCM07), ENTCS (to appear), 2008.


E. D’Hondt and P. Panangaden, ’Reasoning about quantum knowledge’, in Proceedings of the 25th Conference on Foundations of Software Technology and Theoretical Computer Science, LNCS vol. 382, page 0544c , 2006.
A. K. Ekert, ’Quantum cryptography based on Bell’s theorem’, Phys. Rev. Lett., 67(6):661–663, 1991.
R. Fagin, J. Y. Halpern, Y. Moses and M. Y. Vardi. Reasoning about Knowledge. MIT Press, 1995.
Simon J. Gay, Rajagopal Nagarajan and Nikolaos Papanikolaou, ’Probabilistic model-checking of quantum protocols’, quant-ph/0504007, 2005.
D. Markham, A. Roy and B. Sanders, ’Graph States for Quantum Secret Sharing’, private communication, 2008.
M.A. Nielsen and I. Chuang,Quantum computation and quantum information, Cambridge university press, 2000.
P. Panangaden and K. Taylor, ’Concurrent Common Knowledge: Defining Agreement for Asynchronous Systems’, Journal of Distributed Computing 6, 1992.
S. Richards and M. Sadrzadeh, ‘Aximo: Automated Axiomatic Reasoning for Information Update’, Proceedings of the 5th workshop on Methods for Modal Logic, E´cole normal sup´erieure de Cachan, Nov 2007, to appear in Electronic Notes in Theoretical Computer Science.
M. Sadrzadeh, ‘High-Level Quantum Structures in Linguistics and Multi-Agent Systems’, AAAI Press, Proceedings of AAAI Spring Symposium on Quantum Interaction, 2007.
M. Sadrzadeh, ’Actions and Resources in Epistemic Logic’, Ph.D. Thesis, University of Quebec at Montreal, 2005, http://eprints.ecs.soton.ac.uk/12823/01/all.pdf.
L. Xiao, G. Gong, F-G. Deng, and J-W. Pan. ’Efficient multiparty quantum-secret-sharing schemes’, Phys. Rev. A, 69.
