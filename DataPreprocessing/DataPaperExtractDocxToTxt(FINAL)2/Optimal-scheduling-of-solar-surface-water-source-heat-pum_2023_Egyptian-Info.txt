Egyptian Informatics Journal 24 (2023) 100415








Full Length Article
Optimal scheduling of solar-surface water source heat pump system based on an improved arithmetic optimization algorithm
Yirong Qiu, Lianghong Wu ∗, Cili Zuo, Rui Jia, Hongqiang Zhang
School of Information and Electrical Engineering, Hunan University of Science and Technology, Xiangtan, Hunan 411100, China


A R T I C L E	I N F O	A B S T R A C T

	

Keywords:
Surface water source heat pump Solar energy
Improved arithmetic optimization algorithm Optimal scheduling
Integrating solar energy into the combined energy supply of surface water source heat pump systems is expected to reduce the electricity consumption and carbon emissions. In this paper, a solar-surface water source heat pump system model is established to maximize system performance and save economic cost. In order to find the optimal operation scheme, an improved arithmetic optimization algorithm (iAOA) is proposed. This algorithm integrates elite opposition-based and nonlinear acceleration functions to solve the model. The effectiveness of the proposed model and algorithm is verified by applying it to a SWSHP district energy system in the central area of Xiangtan city. Experimental results demonstrate that incorporating solar energy into the SWSHP district energy system can improve system performance and reduce operational costs. In comparison with several other optimization algorithms, this algorithm has a faster convergence speed and a higher convergence accuracy. Therefore, it is considered an effective method for solving solar-surface water source heat pump district energy systems.





Introduction

The increasingly severe energy challenges have made carbon peak and carbon neutrality an increasingly important goal for Chinese energy development. Of all energy consumption, building energy consumption represents 45.5% of total Chinese energy consumption and contributes to 50.9% of Chinese carbon emissions [1]. As a percentage of total building operation energy consumption, air conditioning accounts for 40% to 50%. Energy-eﬃcient ground source heat pump (GSHP) is en- vironmentally friendly air conditioning technology that provide both heating and cooling. GSHP saves more than 40% of the energy that traditional air conditioners require. It has widely recognized and used due to their energy-saving, environmentally friendly, and stable oper- ating benefits. However, because GSHP systems are subject to a range of factors such as temperature variations and unit eﬃciency [2–5], it is essential to optimize their scheduling and determine the best op- erating strategy to enhance system performance and reduce operating costs.
Water source heat pump (WSHP) technology, a type of GSHP, sur- face water or groundwater is used as the source of heat and cold for energy transfer from low grade to high grade. However, due to the dif- ferences between ground source heat pump systems, not all existing research on GSHP systems is applicable to WSHP systems. Therefore,
WSHP systems have been studied by many researchers. For example, Schibuola et al. [6] tracked the annual performance of a WSHP system at the Venice Center and compared its energy consumption to an air source heat pump system and a hybrid energy system, demonstrating that water source and ground source are subject to smaller temperature fluctuations, and surface water source heat pumps have higher stabil- ity. Cardemil et al. [7] proposed a new WSHP system for heating in Mediterranean climates, demonstrating the feasibility of outdoor swim- ming pools as heat sources in warm climates. Chen et al. [8] developed an intelligent control strategy integrates WSHP and ice storage district cooling systems aiming at the lowest operating cost per unit cooling capacity, saving 8.7%-9.3% of operating cost compared with the tra- ditional control strategy. Ma et al. [9] investigated an oﬃce building in Suzhou and found that WSHP systems have more stable longterm performance than soil source heat pump systems. The research of the above scholars has verified the superiority of water source heat pump, but it does not take into account the long-term operation of the water source system. If the cooling and heating loads of the system differ sig- nificantly and Water is used as a long-term heat source, the chemical environment of the water source may become imbalanced, changing the temperature, concentration, pH value, and hardness of the water source, ultimately decreasing the coeﬃcient of performance (COP) of the system. In these studies, the COP of the heat pump unit is a fixed



* Corresponding author.
E-mail address: lhwu@hnust.edu.cn (L. Wu).

https://doi.org/10.1016/j.eij.2023.100415
Received 12 August 2023; Received in revised form 21 October 2023; Accepted 31 October 2023
Available online 16 November 2023
1110-8665/© 2023 THE AUTHORS. Published by Elsevier BV on behalf of Faculty of Computers and Artificial Intelligence, Cairo University. This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).



value, and the variable operating condition of the heat pump system is not taken into account.
Solar energy is a consistent clean energy, but a single solar heating system is not a reliable source for heating due to its vulnerability to weather conditions. However, by combining solar energy and WSPHs, energy eﬃciency of WSPHs can be enhanced while solar energy’s in- stability in heating can be mitigated. Several academic studies have demonstrated the significance of solar energy in balancing environ- mental imbalances. For example, Bordignon et al. [10] showed that incorporating photovoltaic power can help balance the thermal load on the ground, improve electrical eﬃciency, and system performance. Similarly, Wang et al. [11] proposed a GSHP-PVT(photovoltaic and
thermal) system and demonstrated that the system can prevent ground
refrigeration conditions, absorption chillers can decrease the cooling de- mand of the heat pump system, thereby improving energy eﬃciency.

The PVT collector

PVT technology is a combination of photovoltaic and solar thermal energy. It involves combining PV panels and collectors to extract heat from the PV panels. As a result, the utilization eﬃciency of solar en- ergy is improved, and the temperature of the panels is reduced. The electricity generated by the PVT is dependent on various factors such as light intensity, external temperature, and other factors [19], as shown in Eq. (1).
𝐼𝑎𝑐

source temperature drop and improve operation eﬃciency. Huang et al.
[12] developed a TRNSYS model of a solar-assisted ground source heat
𝑃𝑝𝑣 = 𝑃𝑠𝑡𝑐 𝐼
𝑠𝑡𝑐
(1 + 𝑘(𝑇𝑐 − 𝑇𝑠𝑡𝑐 ))	(1)

pump (SAGSHP) system that reduced energy consumption and operat- ing costs while ensuring ground heat balance. In addition, Yang et al.
[13] created a household GSHP system that utilized waste heat from photovoltaic power to improve net power generation and maintain soil heat balance. Scholars have also focused on the performance of solar- GSHP systems. For instance, Mi et al. [14] developed a new hot water
Where 𝑃𝑠𝑡𝑐 is the maximum output power of the PV panel under stan-
dard test conditions ambient temperature; 𝐼𝑎𝑐 is the light intensity; 𝑘 is the temperature coeﬃcient; 𝐼𝑠𝑡𝑐 and 𝑇𝑠𝑡𝑐 are the light intensity and ambient temperature under standard test conditions; 𝑇𝑐 is the actual
temperature of the solar panel, which can be expressed by the ambient temperature, light intensity, as shown in Eq. (2) [20].

supply system by integrating PVT and WSHP that improved system en- ergy eﬃciency and economic benefits compared to other multi-source
𝑇𝑐 = 𝑇𝑎
+ 30  𝐼 
𝐼𝑠𝑡𝑐
(2)

hot water systems. Liu et al. [15] built a mathematical model of a direct- expansion PVT heat pump system, which demonstrated that the coupled system can enhance the operation performance of heat pump systems. Zhang et al. [16] investigated an actual hybrid solar ground source heat pump (HSGSHP) system. It was found to improve performance by nearly 25.8% when the solar space heating was added. Wang et al.
[17] proposed matching principles for key parameters of hybrid heating systems using particle swarm optimization and the coordinate search al- gorithm to optimize system performance parameters and reduce costs.
In addition to providing electrical energy, the PVT collector also provides a certain amount of thermal energy as shown in Eq. (3) [21].
𝑄𝑠 = 𝐴𝑠𝐼𝜂𝑠	(3)
Where 𝐴𝑆 is the area of the collector; 𝐼 is the light intensity; 𝜂𝑠 is the
collector eﬃciency, which can be expressed by the light intensity and
ambient temperature, as shown in Eq. (4) [22].
𝜂𝑠 = 0.7408 − 0.0432(𝑇𝑚𝑒𝑎𝑛 − 𝑇𝑎)∕𝐼

Cao et al. [18] designed a thermodynamic model of direct-expansion
solar-assisted heat pump water heaters and determined optimal param-
−0.000503((𝑇
𝑚𝑒𝑎𝑛
– 𝑇 )∕𝐼 )2	(4)

eters for enhancing system performance. The above studies have proved the superiority of the combination of solar energy and ground source heat pump system, but they are based on the empirical operating con- ditions to optimize the system parameters and structure, among which the solar-surface water source heat pump (SSWSHP) system unit opti- mization scheme is less.
In this study, the economic dispatching model of SSWSHP regional energy system is established. In addition, according to the character- istics of high dimension, nonlinear and multi-constraint of SSWSHP system, an improved arithmetic optimization algorithm is proposed to obtain a better operation scheme. It integrates an elite inverse strat- egy and a nonlinear acceleration function. Experimental results indicate that the SSWSHP system has a higher coeﬃcient of performance. What’s more, comparing with other intelligent optimization algorithms the pro- posed algorithm performs well in solving the optimal scheduling of the SWSHP system.
The paper is organized as follows: Section 2 introduces the model
Where 𝑇𝑚𝑒𝑎𝑛 is the mean temperature of the collector; 𝑇𝑎 is the ambient
temperature.

The WSHP unit

The mathematical model of WSHP unit cooling/heating is shown in Eq. (5).
𝑄𝑖 = 𝐶𝑂𝑃 × 𝑃𝑖	(5)
Where, 𝑄𝑖 is the cooling/heating capacity of the 𝑖th heat pump unit.
𝑃𝑖 is the electrical power required by the 𝑖th heat pump unit; 𝐶𝑂𝑃 is
influenced by the load factor, and the relationship with the load rate is
depicted in Fig. 2 [23].
As a result of the heat pump unit cooling or heating, the discharge water temperature has changed, and its calculation formula is shown in Eq. (6).

of the SSWSHP system, followed by iAOA algorithm in Section 3. A comprehensive experimental demonstration is provided in Section 4.
𝑇𝑜𝑢𝑡
= 𝑇
𝑖𝑛
+ 𝑄ℎ𝑝
𝜌𝑉 𝑐
(6)

Lastly, presents the conclusions of this work are presented in Section 5.

System and model

Fig. 1 illustrates the various components of the SSWSHP district en- ergy system under investigation. The system is primarily comprised of WSHP units, PVT collectors, heat exchangers, absorption chillers, and other associated components. The primary energy source is the WSHP units, while solar energy acts as the auxiliary energy source. On one
Where 𝑇𝑖𝑛 and 𝑇𝑜𝑢𝑡 are inlet and outlet water temperature, respectively;
𝜌 and 𝑐 are the density and specific heat capacity of water respectively;
𝑉 is circulating water flow.

The absorption chiller

Absorption chillers are cooling device that uses thermal energy as power. The heat produced by solar energy is used to heat the chillers. The cooling capacity of the absorption chiller is shown in Eq. (7) [21].

hand, photovoltaic power generation provides electricity to the HP units, while the PVT collectors supply heat and electric energy to the
𝑄𝑎𝑐
= 𝜂
𝑎𝑐
𝑄𝑠
(7)

system, reducing the heat load pressure of the heat pump system. Under
Where 𝜂𝑎𝑐 is the cooling coeﬃcients of absorption chiller.




Fig. 1. Structure diagram of the SSWSHP system.
∑𝑁

𝑖
𝑖=1
𝑝𝑣	𝑒

𝑡
𝑙𝑜𝑎𝑑
is the load of the system at moment 𝑡; 𝑄𝑡 is the cool-

ing/heating capacity of unit 𝑖 at moment 𝑡; 𝑄𝑡  is the cooling/heating
capacity of solar energy at moment 𝑡; 𝑃 𝑡 is the electrical power required
by unit 𝑖 at moment 𝑡; 𝑃 𝑡  is the solar power generated in moment 𝑡;
𝑃 𝑡 is the electricity purchased by the system from the grid in moment 𝑡.
The outlet water temperature restriction is shown in Eq. (13).











Fig. 2. The curve of heat pump unit.


Objective function

Since the HP units consume the majority of the system power [24], the optimization objective of the system is based on the heat pump op- eration cost including power purchase cost and operation maintenance cost. The optimization objective function is represented by Eq. (8).
𝑚𝑖𝑛 𝐶 = 𝑚𝑖𝑛(𝐶𝑒𝑥 + 𝐶𝑜𝑚)	(8)
∑𝑇
𝑇min < 𝑇𝑜𝑢𝑡 < 𝑇max	(13)
As seen in Eq. (14), the upper and lower boundaries of the unit are restricted.
𝑄min < 𝑄𝑡 < 𝑄max	(14)
Where 𝑇min and 𝑇max are the minimum and maximum temperatures of outlet water, respectively; 𝑄min and 𝑄max are minimum cooling/heating
and maximum cooling/heating respectively.

Improved arithmetic optimization algorithm

Arithmetic optimization algorithm

The arithmetic optimization algorithm (AOA) [25] is a relatively novel meta-heuristic algorithm that was proposed in 2021. AOA lever- ages the distributional properties of arithmetic operators to identify the optimal elements from a pool of candidate solutions, and it com-

𝐶𝑒𝑥 =
𝑡  𝑡
𝑒 𝑒
𝑡=1
∑𝑁𝑤
(9)
population of 𝑁 solutions with a 𝑑-dimensional search variable de- prises two key stages: exploration and exploitation. First, an initial
noted as 𝑋𝑖 = {𝑥𝑖1, 𝑥𝑖2, ⋯ 𝑥𝑖𝑑 }(𝑖 = 1, 2, ⋯ , 𝑁 ) is generated. The phase of

𝐶𝑜𝑚 =
(𝑜𝑚ℎ𝑝𝑃 𝑡 + 𝑜𝑚𝑠𝑃 𝑡 )	(10)
the method is then determined using the Math Optimizer Accelerated

𝑖
𝑖=1
𝑝𝑣
(MOA) function. The MOA is calculated using the Eq. (15). Allow 𝑟1 to

Where 𝐶𝑒𝑥 is the power purchase cost; 𝐶𝑜𝑚 is operation maintenance
cost; 𝑐𝑡 is the unit price of electricity in moment 𝑡; 𝑜𝑚ℎ𝑝 is the unit maintenance cost of HP unit; 𝑜𝑚ℎ𝑝 is the unit maintenance cost of PVT collector; 𝑃 𝑡 is the electric energy purchased from grid in moment t; 𝑁𝑤 is the number of HP unit; 𝑇 is the scheduling period of the system.

Constraints restrictions

The power balance constraint is shown in Eq. (11) -(12).
∑𝑁
be a number between 0 and 1. When 𝑟1 > 𝑀 𝑂𝐴, AOA performs explo- ration; when 𝑟1 < 𝑀𝑂𝐴, AOA performs exploitation.
𝑀𝑂𝐴(𝑖𝑡𝑒𝑟)= 𝑀𝑖𝑛 + 𝑖𝑡𝑒𝑟( 𝑀𝑎𝑥 − 𝑀𝑖𝑛 )	(15)
𝑖𝑡𝑒𝑟max
Where 𝑖𝑡𝑒𝑟 represents the current number of iterations; MOA (𝑖𝑡𝑒) is the calculated value of MOA at the 𝑖𝑡𝑒𝑛th iteration; 𝑖𝑡𝑒𝑟max is the maximum number of iterations; 𝑀𝑎𝑥 and 𝑀𝑖𝑛 are the maximum and minimum
values of the MOA function, expressed as 1 and 0.2, respectively.
Division (D) and multiplication (M) calculations can produce highly distributed values or strategies, facilitating exploration. In the explo-

𝑙𝑜𝑎𝑑
𝑖
𝑖=1
𝑠𝑢𝑛
ration phase, the update formula is shown in Eq. (16).

⎧⎪𝑋𝑏𝑒𝑠𝑡,𝑗 (𝑖𝑡𝑒𝑟)÷ (𝑀𝑂𝑃 + 𝜀)×
𝑋 (𝑖𝑡𝑒𝑟)= ⎪((𝑈𝐵𝑗 − 𝐿𝐵𝑗 )× 𝜇 + 𝐿𝐵𝑗 )  𝑟2 < 0.5

(16)

𝑖,𝑗
⎨⎪ 𝑋
𝑏𝑒𝑠𝑡,𝑗
(𝑖𝑡𝑒𝑟)× 𝑀𝑂𝑃 ×

⎪((𝑈𝐵𝑗 − 𝐿𝐿𝐵𝑗 )× 𝜇 + 𝐿𝐵𝑗 )  𝑜𝑡ℎ𝑒𝑟𝑤𝑖𝑠𝑒
Where 𝑋𝑖,𝑗 is the position of the 𝑖th individual 𝑗th dimension of the optimal solution at the 𝑖𝑡𝑒th iteration; 𝑋𝑏𝑒𝑠𝑡,𝑗 is the position of the 𝑗th dimension of the optimal individual at the 𝑖𝑡𝑒th iteration; 𝑟2 is a random number between 0 and 1; 𝜀 represents a little positive number that pre- vents the divisor from becoming zero; 𝜇 is to adjust the search control
at each iteration; 𝑈𝐵𝑗 and 𝐿𝐵𝑗 are the upper and lower boundaries of parameter, which is generally set to 0.5, to generate a value randomly the individuals of 𝑗th dimension; MOP stands for Math Optimizer Prob-
ability, and it is determined by Eq. (17).
𝑖𝑡𝑒𝑟1∕𝛼
𝑀𝑂𝑃 (𝑖𝑡𝑒𝑟)=1 −





Fig. 3. Comparison curve before and after MOA modification.

𝑖𝑡𝑒𝑟1∕𝛼
(17)

Where 𝛼 is a sensitive parameter that determines the precision of ex-
ploitation during the iterative phase and is commonly set at 5.
Due to the low dispersion of these operations and easier approach to the target, addition (A) and subtraction (S) operations are used in the exploitation phase, with the iterative formula shown in Eq. (18), where
𝑟3 is a number chosen between 0 and 1 randomly.
⎧⎪𝑋𝑏𝑒𝑠𝑡,𝑗 (𝑖𝑡𝑒𝑟)− 𝑀𝑂𝑃 ×
complex and nonlinear search process of the algorithm. To address this issue, an new nonlinear acceleration function, iMOA, based on the ex- ponential function is proposed. The update formula for iMOA is shown in the Eq. (21).
iMOA(iter)= (Max − Min)×(  iter  𝛽	(21)
itermax
Where 𝑀𝑎𝑥 and 𝑀𝑖𝑛 are consistent with the AOA algorithm; 𝛽 is the

𝑋 (𝑖𝑡𝑒𝑟)= ⎪((𝑈𝐵𝑗 − 𝐿𝐵𝑗 )× 𝜇 + 𝐿𝐵𝑗 ), 𝑟3 < 0.5
(18)
nonlinear adjustment index.

𝑖,𝑗
⎨𝑋
⎪
𝑏𝑒𝑠𝑡,𝑗
(𝑖𝑡𝑒𝑟)+ 𝑀𝑂𝑃 ×
Fig. 3 depicts the nonlinear MOA curve. In comparison to the linear increasing MOA, the nonlinear MOA grows rapidly at the start of the

⎪((𝑈𝐵𝑗 − 𝐿𝐵𝑗 )× 𝜇 + 𝐿𝐵𝑗 ), 𝑜𝑡ℎ𝑒𝑟𝑤𝑖𝑠𝑒
The elite opposition-based strategy

In meta-heuristic algorithms, the quality of the initialized popula- tion plays an importance role in the algorithm performance in finding the best solution. The initial population generated at random by AOA often lacks the population diversity necessary to facilitate the search for optimal solutions. An elite opposition-based strategy [26] is employed in this research to initialize population and enhance population diver- sity. The elite opposition-based learning strategy selects elite solutions from the population, creates an opposite-based population in opposition to the elite solutions, compares the elite opposition-based population to the elite population, and chooses the best solutions as the initial-
algorithm iteration, which is conducive to fast algorithm convergence, and flat at the end, which is conducive to exploitation. The iMOA func- tion helps prevent the algorithm from getting stuck in local optima and improves its ability to explore the search space.

3.4. Pseudo-code of iAOA algorithm

The Pseudo-code of the improved arithmetic optimization algo- rithm (iAOA) proposed by combining the aforementioned improvement strategies was described in Algorithm 1. The flowchart of iAOA algo- rithm is depicted in Fig. 4.

Algorithm 1 Pseudo-code of iAOA algorithm.

and the opposition-based solution 𝑋̄𝑖 = {𝑥̄𝑖,1, 𝑥̄𝑖,2, ⋯ 𝑥̄𝑖,𝑑 } is shown in Eq.
(19).
𝑥̄𝑖,𝑗 = 𝑟4 × (𝑈𝐵𝑗 + 𝐿𝐵𝑗 )− 𝑥𝑖,𝑗	(19)
Where 𝑟4 is a number chosen between 0 and 1 randomly.
When the solution crosses the boundary, it is reset by Eq. (20).
𝑥̄𝑖,𝑗 = 𝑟𝑎𝑛𝑑(𝐿𝐵𝑗 , 𝑈𝐵𝑗 ), 𝑖𝑓 𝑥̄𝑖,𝑗 < 𝐿𝐵𝑗 or 𝑥̄𝑖,𝑗 > 𝑈𝐵𝑗	(20)



Nonlinear Math Optimizer Accelerated function

In the AOA algorithm, maintaining harmonious relationship be- tween the exploitation and exploration phases is crucial for achieving optimal results. The exploration phase seeks to explore a wide range of the search space, while the exploitation phase focuses on exploiting the most promising areas of the search space. The MOA is an essential com- ponent of the AOA algorithm, which controls the balance between these two phases. However, MOA is a linear control approach that increases linearly with the number of iterations and may not fully capture the


2: Initialize a population 𝑋 with random solutions and calculate their fitness values;
3: Sort all individuals based on their fitness values, and then select the top 𝑁 ∕2 individ-
uals as elite population;
4: generate elite opposition-based population 𝐸𝑂;
5: Merge the populations 𝑋 and 𝐸𝑂, then select N solutions with higher fitness values to form the initial population, and note the current optimal solution 𝑋𝑏𝑒𝑠𝑡 .
6: while 𝑖𝑡𝑒𝑟 < 𝑖𝑡𝑒𝑟𝑚𝑎𝑥 do
7:	calculate the iMOA value according to Eq. (21).
9:	for   𝑖   =   1   to   𝑁   do 8:	 calculate the MOP value according to Eq. (17).
10:	for 𝑗 = 1 to 𝑑 do
11:	Randomly generate 𝑟1, 𝑟2 and 𝑟3 values between [0,1]. 12:	if 𝑟1 < MOA then
13:	Update the 𝑖th individuals position according to Eq. (16).
14:	else
15:	Update the 𝑖th individuals position according to Eq. (18).
16:	end if
17:	end for
18:	end for
19:	𝑡 = 𝑡 +1 
20: end while
21: return the best individual 𝑋𝑏𝑒𝑠𝑡












Fig. 4. Flowchart of iAOA algorithm.

Constraint handling
Fig. 5. Hourly cooling heating load demand.



The updated solution is diﬃcult to be within the feasible domain, which will be more diﬃcult especially when multiple constraints are considered. Therefore, to ensure the feasibility of the solution, the con- straints must be handled. To overcome this challenge, the infeasible solution is adjusted through a combination of boundary absorption mechanism, dynamic heuristic constraint handling, and variable reduc-







Table 1



Fig. 6. Light intensity.

tion strategy to ensure compliance with the relevant constraints. The specific implementation steps are as follows:
Step 1: According to Eq. (6), the constraints of water temperature in Eq. (14) can be transformed. Therefore, the heat pump unit output has two upper and lower boundary values, which can be expressed as Eq. (22)-(23)
Purchasing electricity price.

Time pried	Price (¥/kWh)


6:00-7:00	0.36
12:00-16:00	0.78
8:00-11:00, 17:00-19:00	1.30




′ min
′ max
= max{𝑄min, (𝑇min − 𝑇𝑖𝑛)𝜌𝑉 𝑐}	(22)
= min{𝑄max, (𝑇max − 𝑇𝑖𝑛)𝜌𝑉 𝑐}	(23)



Table 2

The updated solutions, if they do not satisfy the inequality constraint, are subject to boundary absorption. This means that them must equal to the boundary value.
Step 2: A modified heuristic constraint treatment is used for the hot and cold load balance constraints.
Step 2.1: Calculate 𝛿 according to Eq. (24), and determine whether
the equation constraint is satisfied.
∑𝑁
Nameplate data of heat pump unit.



𝛿 =	𝑄𝑡 + 𝑄𝑠 − 𝑄𝑙𝑜𝑎𝑑	(24)
𝑖=1
Step 3: The variable reduction strategy is used for the electric load

Step 2.2: Each value is corrected according to Eq. (25) and again to determine whether the constraint is satisfied. If it is satisfied, the
executions of Step 2 reaches the threshold 𝐿 and the condition is still next step is executed; otherwise, Step 2.2 is continued, if the number of
not satisfied, the set of solutions is discarded.
 𝛿
balance constrain [27]. This strategy refers to reducing the dimensional- ity of the decision variables by using some of them to represent another part of the variables during the iterative process according to the rele-
optimality condition, and the variable 𝑃𝑒 is reduced variable, which can vant equation constraints. According to it, Eq. (12) is necessary equality be expressed by core variable 𝑃𝑖 , 𝑃𝑠 . Thus, the purpose of the eliminated

𝑄𝑡 = 𝑄𝑡 +
(25)
equation is achieved, and the processed objective function is as Eq. (26).

𝑖	𝑖	𝑁



Fig. 7. Cooling load supply under cooling conditions.




𝑚𝑖𝑛 𝐶 =𝑚𝑖𝑛
∑𝑇
𝑁𝑤
(𝑐𝑡 (
𝑁𝑤
𝑃 𝑡 − 𝑃 𝑡 )+ 
Fig. 8. Electricity load supply under cooling conditions.
𝑜𝑚 𝑃 𝑡 + 𝑜𝑚 𝑃 𝑡 )	absorption chillers. The solar and heat pump units work together to pro-

𝑡=1
∑𝑇
𝑒	𝑖
𝑖=1
∑𝑁𝑤
𝑝𝑣
𝑖
𝑖=1
𝑝𝑣
(26)
vide cooling and heating, while the electrical load of the system is met by a combination of photovoltaic power generation and grid power. An

𝑒
𝑡=1 𝑖=1
𝑖	𝑒
𝑝𝑣
the scheduling process with the goal of minimizing operating costs in the last two scenarios.

Experiments and results

Simulation details

The surface water source heat pump district energy system located in Xiangtan City is the focus of this study. The system operates from 6:00 to 19:00, with a duration of 14 hours, as it provides centralized heating and cooling for government oﬃce buildings, and there is no demand during the nighttime. The system cooling loads in summer and heating loads in winter are illustrated in Fig. 5, and the light intensity data is shown in Fig. 6 [24]. A time-of-day tariff is adopted by the system, as presented in Table 1 [28], while Table 2 displays the relevant information about the heat pump units. Due to the low heating load, only 9 units operate under heating conditions, while the remaining 12 units are set to cooling mode to minimize unit losses and prolong their service life. In the iAOA algorithm, the following parameters are set: the
size of population 𝑁 = 100, the maximum iteration number 𝑇𝑚𝑎𝑥 = 500,
the Nonlinear adjustment parameter 𝛽 = 0.2.
This optimization model was tested against three scenarios in or-
der to validate its effectiveness. Scenario 1 is the current operation scheme, and the units only have two states of full load or half load. In Scenario 2, the system includes only water source heat pump units, providing cool and heat energy while purchasing electricity from the grid to meet cooling or heating demands. In Scenario 3, the system in- corporates heat pump units, photovoltaic solar thermal collectors, and

Result analysis

Analysis of cooling conditions
The results of the cooling conditions scheduling are presented in Fig. 7. In Scenario 1 and Scenario 2, the entire cooling load is pro- vided by the 12 heat pump units. However, in Scenario 3, the PVT with absorption chillers is introduced to assist the heat pump system for cool- ing, and its contribution is primarily during high solar radiation hours, from 9:00 am to 4:00 pm. In Scenario 3 the utilization of solar energy leads to a reduction in electricity costs. The electricity purchased in each time period is shown in Fig. 8, with Scenario 1 and Scenario 2 ranging between 2000 kW and 2800 kW, while Scenario 3 ranges be- tween 15000 kW and 2300 kW. In Scenario 1 and Scenario 2, the peak electricity consumption coincides with the peak of the electricity price, whereas the incorporation of photovoltaic power generation lowers the electricity purchase cost from the grid during the peak price period in Scenario 3.
The COP of each heat pump unit is determined by its load rate, which in turn affects the system overall eﬃciency. Fig. 9 displays the average COP of the three scenarios during cooling conditions, which reflects the system conversion eﬃciency during each time period. The average COP during each time period ranges from 3.5 to 4.0 in Scenario 1 and Scenario 2, with daily averages of 3.65 and 3.84, respectively. In Scenario 3, the COP varies with the level of insolation, reaching a peak






Fig. 9. COP curve under cooling conditions.


Table 3
Economic cost and COP under cooling condition.



Table 4
Economic cost and COP under heating condition.



at 12:00 am and gradually decreasing in the afternoon due to a decrease in insolation. At 18:00 p.m. and 19:00 p.m., when insolation is insuﬃ- cient, the COP is similar to that of Scenario 2. According to Table 3, the average daily COP of the system increases 36.9% in Scenario 3, and the economic cost is reduced to ¥26730.4/day, resulting in a cost saving of approximately 27.1% compared to the current operating scenario.

Analysis of heating conditions
In heating condition, adjust the heat pump unit and collector mode to be in heating condition. The optimized scheduling results for both scenarios are analyzed similarly to the cooling condition, as shown in Fig. 10. Unlike the cooling condition, the heating condition necessitates more heat load in the morning and evening, while as the temperature rises in the afternoon, the system necessitates less heat load. Fig. 11 depicts the electrical power output of system under heat production conditions. As shown in Fig. 11, as the thermal load required for tem- perature increase decreases, light intensity increases, the electrical and heating energy provided by solar energy increases in the meantime, so the electricity supplied from the grid is reduced accordingly in all scenarios, with the reduction being especially noticeable in scenario 3,
22.9%     of     the     operating     cost. which effectively reduces peak electricity consumption and saves about
The COP for each time period in different scenarios varies with the amount of electricity purchased, as illustrated in Fig. 12. The COP ranges from 3.3 to 3.8 at various times in Scenario 1 and Scenario 2, with average COPs of 3.65 and 3.86 for the day, respectively. Scenario 3 maintains the same system COP as Scenario 2 during the hours of 6 to 7 and 17 to 19 when there is no light. When suﬃcient light is available, the system COP can reach up to 6.16. According to Table 4, Scenario 1 incurs the highest operating costs. However, with the addition of PVT
collectors and the use of the iAOA algorithm, the COP correspondingly increase 29.5%.
Furthermore, the empirical operation strategy often results in a waste of energy since the system cooling or heating capacity is fre- quently greater than the load demand. A comparison of the three scenarios under cooling and heating conditions shows that the WSHP district energy system with PVT can effectively reduce economic oper- ating costs and enhance system conversion eﬃciency, providing it with an edge over the single WSHP district energy system.

Comparison of various algorithms

The superior performance of the proposed iAOA algorithm is demon- strated by comparing it with other optimization algorithms, such as Arithmetic Optimization Algorithm (AOA), Arithmetic Optimization Algorithm with Aquila Optimizer (AOAAO) [29], crisscross AOA Al- gorithm (CSOAOA) [30], PSO [31], Neighborhood Adaptive Particle Swarm Optimization Algorithm (NAPSO) [23], and Sine Cosine Algo- rithm (SCA) [32] in Scenario 3. It can be seen from Fig. 13 and 14 that under the same environmental parameters and number of iterations, iAOA not only has shorter running time, but also achieves a cost reduc- tion of approximately 27.1% in cooling and 23.3% in heating. In order to further test the superiority of the algorithm, Friedman test was con- ducted after each algorithm was run 30 times, and the test results were shown in Table 5 and 6. According to the Friedman test, iAOA algo- rithm has the smallest mean rank, average value and standard deviation in both cooling and heating conditions, indicating that iAOA algorithm has obvious advantages compared with other algorithms. In summary, the iAOA algorithm exhibits faster convergence speed and improved convergence accuracy, making it an effective solution for solving the optimization operation problem of a solar-ground source heat pump system.

Conclusions

In this paper, an economic dispatch model is proposed for a solar- surface water source heat pump district energy system that integrates photovoltaic solar thermal with a SWSHP. An improved arithmetic op- timization algorithm is developed to eﬃciently solve the optimization model, combining an elite opposition-based strategy with a nonlinear Math Optimizer Accelerated function. The experimental results demon- strate that the combination of photovoltaic thermal and surface water source heat pump system with solar power generation leads to a signifi- cant improvement in the system eﬃciency coeﬃcient COP and reduces the economic operation cost by 27.1% and 23.3% under cooling and heating conditions, respectively. According to the Friedman test, com- pared with other algorithms, iAOA algorithm has stronger searching ability in convergence speed and accuracy, which indicates that iAOA algorithm is effective in solving the district energy system of solar- surface water source heat pump.
However, the operation of solar–surface water source heat pump system is complicated, and there may be uncertain factors such as sys- tem load fluctuation in actual operation. iAOA algorithm has obtained a better solution in solving certainty optimization, but its effect in solving load variation and working condition uncertainty has not been verified. Therefore, further consideration of load and working condition uncer- tainty to optimize the ground source heat pump system is our future research direction.

Declaration of competing interest

The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.




Fig. 10. Heating load supply under heating conditions.




Fig. 11. Electricity load supply under heating conditions.





Table 5
Friedman test results under cooling condition.






Table 6
Friedman test results under heating condition.







Fig. 12. COP curve under heating conditions.


Fig. 13. Convergence curves under heating conditions.


Fig. 14. Convergence curves under heating conditions.



Acknowledgements

This research was supported by National Natural Science Foundation of China (grant no. 62373146), Natural Science Foundation of Hunan Province (grant nos. 2021JJ30280, and 2022JJ30265), and Outstand- ing Youth Project of Education Department of Hunan Province (grant no. 22B0476).
References

China Association of Building Energy Eﬃciency. Research report of China building energy consumption and carbon emissions, Chongqing; 2022.
Farzanehkhameneh P, Soltani M, Kashkooli FM, Ziabasharhagh M. Optimization and energy-economic assessment of a geothermal heat pump system. Renew Sustain Energy Rev 2020;133:110282.
Ikeda S, Choi W, Ooka R. Optimization method for multiple heat source operation including ground source heat pump considering dynamic variation in ground tem- perature. Appl Energy 2017;193:466–78.
Nguyen A, Tamasauskas J, Kegel M. A method for fast economic optimization of large hybrid ground source heat pump systems. Geothermics 2022;104:102473.
Zhou K, Mao J, Li Y, Zhang H. Performance assessment and techno-economic op- timization of ground source heat pump for residential heating and cooling: a case study of Nanjing, China. Sustain. Energy Technol. Assess. 2020;40:100782.
Schibuola L, Scarpa M. Experimental analysis of the performances of a surface water source heat pump. Energy Build 2016;113:182–8.
Cardemil JM, Schneider W, Behzad M, Starke AR. Thermal analysis of a water source heat pump for space heating using an outdoor pool as a heat source. J Build Eng 2021;33:101581.
Chen Q, Wei W, Li N. Techno-economic control strategy optimization for water- source heat pump coupled with ice storage district cooling system. Int J Refrig 2022;138:148–58.
Ma W, Kim MK, Hao J. Numerical simulation modeling of a GSHP and WSHP system for an oﬃce building in the hot summer and cold winter region of China: a case study in Suzhou. Sustainability 2019;11(12):3282.
Bordignon S, Quaggiotto D, Vivian J, Emmi G, De Carli M, Zarrella A. A solar- assisted low-temperature district heating and cooling network coupled with a ground-source heat pump. Energy Convers Manag 2022;267:115838.
Wang Y, Zhang Y, Hao J, Pan H, Ni Y, Di J, et al. Modeling and operation optimiza- tion of an integrated ground source heat pump and solar PVT system based on heat current method. Sol Energy 2021;218:492–502.
Huang J, Fan J, Furbo S. Demonstration and optimization of a solar district heating system with ground source heat pumps. Sol Energy 2020;202:171–89.
Yang X, Niu S, Mao H, Shi G. Dynamic simulation analysis of ground source heat pump system based on photovoltaic power waste heat (in Chinese), Acta Energ So- laris Sin 2021;42(10):341–8.
Mi P, Ma L, Zhang J. Integrated optimization study of hot water supply system with multi-heat-source for the public bath based on PVT heat pump and water source heat pump. Appl Therm Eng 2020;176:115146.
Liu W, Yao J, Dai Y. Simulation and annual performance analysis on a direct-expansion solar-assisted PVT heat pump system (in Chinese), J Refrig 2022;43(3):161–6.
Zhang X, Wang E, Liu L, Qi C, Zhen J, Meng Y. Analysis of the operation performance of a hybrid solar ground-source heat pump system. Energy Build 2022;268:112218.
Wang Z, Chen H, Sun X, Lu H, Wang T. Optimizing the solar-air hybrid source heat pump heating system based on the particle swarm algorithm. Energy Rep 2022;8:379–93.
Cao B, Mihardjo LWW, Parikhani T. Thermal performance, parametric analysis, and multi-objective optimization of a direct-expansion solar-assisted heat pump water heater using NSGA-II and decision makings. Appl Therm Eng 2020;181:115892.
Udeh GT, Michailos S, Ingham D, Hughes KJ, Ma L, Pourkashanian M. A mod- ified rule-based energy management scheme for optimal operation of a hy- brid PV-wind-Stirling engine integrated multi-carrier energy system. Appl Energy 2022;312:118763.
Wu X, Liao B, Su Y, Li S. Multi-objective and multi-algorithm operation optimization of integrated energy system considering ground source energy and solar energy. Int J Electr Power Energy Syst 2023;144:108529.
Li LL, Ren XY, Tseng ML, Wu DS, Lim MK. Performance evaluation of solar hybrid combined cooling, heating and power systems: a multi-objective arithmetic opti- mization algorithm. Energy Convers Manag 2022;258:115541.
Li H, Tao Y, Zhang Y, Fu H. Two-objective optimization of a hybrid solar-geothermal system with thermal energy storage for power, hydrogen and freshwater production based on transcritical CO2 cycle. Renew Energy 2022;183:51–66.
Wang W, Wu L, Liu Z, Li J, Jia R, Zhang H. Optimal dispatch of surface water source heat pump based on neighborhood adaptive particle swarm optimization algorithm (in Chinese), J Syst Sci Math Sci 2021;41(6):1520–32.
Jin J. Research on optimal scheduling of solar - air source heat pump hot water system. M.E. dissertation. China: Hangzhou Dianzi University; 2020.
Abualigah L, Diabat A, Mirjalili S, Abd Elaziz M, Gandomi AH. The arithmetic opti- mization algorithm. Comput Methods Appl Mech Eng 2021;376:113609.
Zhou Y, Wang R, Luo Q. Elite opposition-based flower pollination algorithm. Neu- rocomputing 2016;188:294–310.
Song A, Wu G, Suganthan PN. Automatic variable reduction. IEEE Trans Evol Com- put 2022. https://doi.org/10.1109/TEVC.2022.3199413.
Zhong J, Cao Y, Li Y, Tan Y, Peng Y, Cao L, et al. Distributed modeling con- sidering uncertainties for robust operation of integrated energy system. Energy 2021;224:120179.



Zhang YJ, Yan YX, Zhao J, Gao ZM. AOAAO: the hybrid algorithm of arithmetic optimization algorithm with Aquila optimizer. IEEE Access 2022;10:10907–33.
Hu G, Zhong J, Du B, Wei G. An enhanced hybrid arithmetic optimization algo- rithm for engineering applications. Computer Methods in Applied Mechanics and Engineering 2022;394:114901.
Kennedy J, Eberhart R. Particle swarm optimization. In: Proceedings of the IEEE international conference on neural networks, vol. 4; 1995. p. 1942–8.
Mirjalili S. SCA: a Sine Cosine Algorithm for solving optimization problems. Knowl- Based Syst 2016;96:120–33.
