Electronic Notes in Theoretical Computer Science 171 (2007) 77–84	
www.elsevier.com/locate/entcs

The Better Bubbling Lemma

Robert K Meyer
Logic and Computation
College of Engineering and Computer Science Bldg. 115, Australian National University Canberra, ACT 0200, Australia
Email: bob.meyer@anu.edu.au


Abstract
BCD [1] relies for its modeling of λ calculus in intersection type filters on a key theorem which I call BL (for the Bubbling Lemma, following someone). This lemma has been extended in [2,4] to encompass Boolean structure, including specifically union types; this extended lemma I call BBL (the Better Bubbling Lemma). There are resonances, explored in [5] and [4], between intersection and union type theories and the already existing minimal positive relevant logic B+ of [10]. (Indeed [9] applies BL and BBL to get further results linking combinators to relevant theories and propositions.) On these resonances the ﬁlters of algebra become
the theories of logic. The semantics of [8] yields here a new and short proof of BBL, which takes account of full Boolean structure by encompassing not only B+ but also its conservative Boolean extension CB [10,7,8].
Keywords: semantics, subtyping, classical relevant logic, minimal relevant logic, CB, B+, type theory, bubbling.

Introduction
This paper is about the “complementarity” of the relevant logics of the philosophers and the type theories of computer scientists. 1 Differently motivated investigations have produced more or less the same formal systems. Relevant logics arose in the search for a better account of implication, the → connective which is at the heart of logic. Type theories seek to carve up an intuitive universe of discourse into manageable chunks, producing (it is hoped) more secure programming environments. The paper is more specifically about a particular lemma, which I call the Better Bubbling Lemma (henceforth, BBL). I use here the semantics of relevant logics, as presented in [10] and [7], to prove BBL. BBL is itself an improvement of the

1 Thanks to my colleagues in Logic and Computation, at the College of Engineering and Computer Science at ANU. I am particularly indebted to Professor John W Lloyd, whose travel grant made it possible for me to attend the Venice DCM workshop at which I presented this note in July 2006. Thanks also to my daughter Dorothy K Meyer, whose graduate study in Computer Science at the University of New England produced the LaTeX expertise that made possible the submission of this article for publication in the millennium in which it was written. I’m deeply grateful, Dorothy. Other debts will be noted as they arise.

1571-0661 © 2007 Elsevier B.V. Open access under CC BY-NC-ND license.
doi:10.1016/j.entcs.2006.12.038

Bubbling Lemma (henceforth BL). I learned the Bubbling Lemma from Mariangiola Dezani, who thought it up. 2 At any rate, as Proposition 2.4, the Bubbling Lemma plays a crucial role in her paper [1] with Barendregt and Coppo, where it is used to nail down a “filter model” of λ calculus in intersection type theory. 3 This filter model is at the same time a logical model of λ in BΛT theories, as we showed in [5]. Bubbling is what happens in the severely restricted [→, Λ, T] vocabulary to Better Bubbling. Relevant logicians and type theorists have a common goal in seeking to lift those restrictions. Logicians seek to add at least a disjunction V, and perhaps also a negation ч; the type crowd sees the former as type union and the latter (also perhaps) as some sort of complement. On the logical side, a number of relevant logics were developed and given a semantical interpretation, including the natural minimal positive relevant logic B+ of [10] and its conservative Boolean extension CB of [7]. 4 Type theorists also sought semantical underpinning of their work; the line that led to BBL was worked out in Paris by Frisch, Castagna and
Benzaken [6,2,4].

Preliminaries
Our vocabulary here will be dual purpose (as in [5]). We begin with atoms p, etc., taken indifferently as propositional or type variables. There will be a constant T (a formula entailed by everything, or the whole space ω of [1]). Formulae (or types) A, B, etc., shall be built up from atoms and T under the binary operations Λ (conjunction, or intersection) and → (implication, or function space constructor). Statements are of the form A ≤ B, where ≤ (logical entailment, or sub-type) is a binary relation symbol and A and B are formulae (or types). Thus our formal systems are, in the style of Curry [3], relational ones, more natural (as in [8,6,4]) for contact with sub-typing ideas.
We have just described the basic language LΛT. 5 We extend it to the language L+T by adding the additional operation V (disjunction, or union). Binary oper- ations shall be ranked Λ, V (when present), → in order of increasing scope, with association otherwise to the right. We concentrate here on an additional language Lч, which results when another unary connective ч (Boolean negation, or comple- ment) is added. In this language Lч, preferred henceforth, we get V and T by the the following familiar Definitions:
DV. A V B d=ef ч(чA Λ чB)

2 According to me, Dezani also named it. (She has denied this, preferring Lemma 3.14159, or whatever it was called in [1].)
3 [1] built on work by Coppo, Dezani and their Italian colleagues.
4 CB was called CB+ in [7].
5 The care and feeding of T is interesting here. As a truth that is logically entailed by every formula, T seems a detour into irrelevance. Accordingly it is missing from B+ and the kindred relevant logics of [10] and related work in the Anderson-Belnap tradition. T is equally dicey from a type-theoretic viewpoint; as the universal type ω , T violates Aristotle’s dictum that “Being is not a genus.” Among type theorists, Venneri has declared herself particularly suspicious of T. On the other hand, T is useful, both type-theoretically and logically. And since it is trivial to add T conservatively on the semantics of [10] (just make T true at every state s), we treat it here as harmless. More than that, since T has exactly the properties imposed on ω in [1], it is in this paper a logical gift from a benevolent Creator.

DT. T d=ef p V чp, where p is first.
We shall characterize the theorems of corresponding systems semantically. (For syntactic characterizations see the cited papers.) A Boolean 3-frame K shall here be a pair < K, R >, where K is a set (of states) and R is a 3-place relation on K. 6 Let K be a Boolean 3-frame, and let L be one of our languages above. Let
2 = {0, 1} be the set {false, true} of truth-values. A possible interpretation I of L in K shall be any function I : L × K → 2. That is, a possible interpretation is any function which assigns exactly one truth-value to each formula A in L at each state s in K.
Not all possible interpretations count as interpretations. This is semantics, and some attention to the meanings of the particles is in order. That attention is supplied by truth-conditions on the primitive particles. 7 Writing [A]c for I(A, c) = 1 and ч[A]c for I(A, c)= 0 and using intuitive connectives and quantifiers in obvious ways, we have the following:
Truth-conditions: Tω. [T]c always
TΛ. [A Λ B]c = [A]c Λ [B]c
TV. [A V B]c = [A]c V [B]c
Tч. [чA]c = ч[A]c
T→. [A → B]c = 6a, b ∈ K (Rcab ⇒ [A]a ⇒ [B]b)
A possible interpretation I is an interpretation provided that all applicable truth conditions hold for I. We have now
Verification condition on an interpretation I in a 3-frame K:
VI. A ≤ B is verified on I in K iff 6c ∈ K([A]c ⇒ [B]c)
Validity condition in a 3-frame K:
VK. A ≤ B is valid in K iff A ≤ B is verified on all I in K
Basic validity condition:
VB. A ≤ B is basically valid iff A ≤ B is valid in all 3-frames K


Better Bubbling
This brings us to our main topic, the Bubbling and Better Bubbling Lemmas. I shall henceforth simply write ‘A ≤ B’ when that statement is basically valid.


6 It is a pleasant consequence of various conservative extension results that we may restrict ourselves here to Boolean 3-frames, which were called b+ms on p. 70 of [8].
7 The semantics of [10] also imposed a heredity condition H sensitive to a partial order ≤ on states, reminiscent of a similar condition in Kripke’s semantics for intuitionist logic. It is still further evidence of divine benevolence that, since we can get by with Boolean 3-frames, the condition H is otiose in the
situation here. The reason for this is that, without loss of generality, we may take actual equality as the partial order ≤. This also dispenses with the semantic postulates for B+ in [10].

Bubbling
Let I be a finite index set. Then the Bubbling Lemma says
BL. Suppose Λi∈I (Ai → Bi) ≤ A → B. Then there is a subset J ⊆ I such that A ≤ Λj∈JAj and Λj∈JBj ≤ B.
I put BL thus on the usual lattice-theoretic convention that, where Λ is the null

set,
Λj∈ΛAj = T.
BL is stated in [1] for the Intersection Type Discipline (henceforth, ITD); it

comes to the same thing to say that it holds for the → ΛT modification BΛT of the minimal logic B+ of [10]; see [5]. The utility of BL in [1] and associated work is that it assures that the values on interpretation of terms of the form λx.M are indeed ITD-filters (= BΛT-theories).
Better Bubbling
On, now, to Better Bubbling! The Better Bubbling Lemma BBL (e.g., of [4,9]) has two parts.
BBL1. Suppose that Λi∈I(Ai → Bi) ≤ Vj∈J (Cj → Dj). Then there is a particular j in J such that Λi∈I (Ai → Bi) ≤ Cj → Dj.
BBL2. Suppose that Λi∈I (Ai → Bi) ≤ A → B. Then for each subset J ⊆ I we
have
A ≤ Vj∈JAj, OR
Λk∈I\JBk ≤ B
It is the case that Better Bubbling for CB entails Bubbling for BΛT. But I shall not go into all that now. Instead I will prove Better Bubbling SEMANTICALLY. 8 And I shall prove BBL for the full Boolean (conservative) extension CB of B+. Proof of BBL2 for CB. The proof is by reductio. The lemma claims that, if a conjunction over an index set I of → formulae Ai → Bi entails an → formula A → B, then for every subset J of I we have either
A ≤ Vj∈JAj, OR
Λk∈I\JBk ≤ B
So suppose, for some subset J of I, both i and ii are semantically invalid. We use this hypothesis to show that, in this case, the statement
Λi∈I (Ai → Bi) ≤ A → B
is also semantically invalid. BBL2 then follows by contraposition.
Let then J be the subset of I for which both i and ii fail. By VI, TV, there is then by the failure of i, some interpretation Ia in a 3-frame Ka =< Ka, Ra > such that, on Ia, we have at a state a ∈ Ka and for all j ∈ J ,

8 BBL is a beautiful theorem. I learned of it from Dezani, who found the idea in Frisch’s Ph. D. thesis, done under the supervision of Giuseppe Castagna at ENS, Paris, investigating the semantic approach to sub-typing presented with Benzaken in [6] and [2]. It may have roots, according to Castagna and Frisch, in work by Hosoya.

[A]a
ч[Aj]a
Meanwhile, by the failure of ii, there is some interpretation Ib in a 3-frame Kb =< Kb, Rb > such that, on Ib, we have by VI, TΛ a state b ∈ Kb such that, for all k ∈ I\J ,
[Bk]b
ч[B]b
Let x be a new element foreign to both Ka and Kb. We construct a new 3-frame K =< K, R >, where K = {x}∪ Ka ∪ Kb. By defining R appropriately on K, we shall make the antecedent of iii true at x but its consequent false at x. This will suffice for the invalidity of iii, ending the argument.
We specify R as follows:
Rxab.
For c, d, e ∈ Ka, Rcde iff Racde.
For c, d, e ∈ Kb, Rcde iff Rbcde.
Otherwise Rcde fails, for all c, d, e ∈ K.
The idea of this specification is that we are simply pasting together the two 3- frames that we already have, joining them at x via Rxab. We continue the pasting by defining an interpretation I in K that copies Ia on the Ka side and Ib on the Kb side. Specifically, for all c ∈ Ka and d ∈ Kb, we lay down for each atom p that I(p, c) = Ia(p, c) and I(p, d) = Ib(p, d). As for the new element x, we simply set I(p, x)=0 for all p. The imposition of the truth-conditions T→, TΛ, Tч (and, by definition, TV and Tω as well) then assures that I is well-defined on all formulae E at each state e in K.
It is now an elementary structural induction, safely left to the reader, to show that I agrees with Ia on all formulae E at every state e in Ka, and with Ib on all E at every e in Kb. As for what it does at x, we must check that I makes the antecedent of iii true there but its consequent false. There is no problem with the latter. I(A, a) = Ia(A, a) = 1 and I(B, b) = Ib(B, b) = 0; whence, since Rxab, we have I(A → B, x) = 0 by T→. But we need also to check that each Ai → Bi is true on I at x (whence by TΛ, so is the whole antecedent of iii). It all depends on whether i is in the special subset J from which we started.
Subcase α. i ∈ J . Then I(Ai, a)= Ia(Ai, a)= 0, by (2) above. But then, since Rxab is the only triple involving x, we have I(Ai → Bi, x) = 1 (by, so to speak, falsity of antecedent in T→).
Subcase β. i ∈ I\J . We then have I(Bi, b)= Ib(Bi, b)= 1, by (4) above. This also enforces I(Ai → Bi, x)=1 (by, so to speak, truth of consequent in T→).
Thus all the → formulae in the antecedent of iii are true at x on I. But the consequent of iii was false at x on I. Thus iii is not basically valid, if any subset J ⊆ I fails to satisfy one of (i), (ii). Contraposing, this ends the semantical proof of BBL2 for CB.

Proof of BBL1 for CB. By contraposition. Suppose that, for each j ∈ J , the statement
Λi∈I (Ai → Bi) ≤ Cj → Dj
is not basically valid. We shall show that
Λi∈I(Ai → Bi) ≤ Vj∈J (Cj → Dj)
is also invalid. Accordingly, since BBL assumes the validity of (6), there is a j ∈ J
for which (5) holds.
We proceed to construct, very carefully, for each j ∈ J an interpretation Ij in a 3-frame Kj =< Kj, Rj >. We might as well take the index j itself as the “state” at which the antecedent of (1) turns out true on Ij and its consequent false. That is, we have on Ij (using our abbreviated notation again), new states cj, dj such that, applying TΛ, T→, we get
Rjjcjdj
[Cj]cj
ч[Dj]dj
for each i ∈ I, [Ai → Bi]j
There is a very important point in this observation—namely, that we can always choose a fresh and new cj and dj when we are falsifying → statements at j. 9 In many logics, we do not have this luxury; for example one of the postulates of the logic R states that Rxxx always, whence we must attend to repetitions of the arguments of the ternary relation. We note moreover that there is no reason to make any atom p true at any of the special states j ∈ J . So w.l.o.g., Ij(p, j)= 0 for all atoms p and j ∈ J .
Having carefully falsified each of the instances of (5), we now construct a coun- termodel to (6). We may assume, for j /= k(j, k ∈ J , that Kj ∩ Kk is the empty set.
Let K0= ∪j∈JKj. Let x be an element not in K0, and let K = {x}∪ K0. We define the ternary relation R on K as follows, for each j ∈ J :
If a, b, c ∈ Kj then Rabc iff Rjabc.
If a, b ∈ Kj then Rxab iff Rjjab.
Otherwise Rabc fails.
This will make K =< K, R > a 3-frame. We go on to define an interpretation I in
K, thus:
For all atoms p and aj ∈ Kj, I(p, aj)= Ij(p, aj).
For all atoms p and j ∈ J , I(p, x)= Ij(p, j)= 0.
For compound formulae C and all states c ∈ K, let I(C, c) be determined in K

9 My former student and later ANU boss John Slaney e-mailed an elegant proof that this is the case. He and my ANU colleague Raje’ev Goré have my thanks, as do the graduate students Chunlai Zhou (Indiana University) and Koushik Pal (UC, Berkeley) for incisive insights.

by imposing the truth-conditions T→, TΛ, Tч.
Lemma 3.1 For all formulae A and all aj ∈ Kj, I(A, aj )= Ij(A, aj).
Proof Obvious by structural induction, since truth-conditions are the same.	 
Lemma 3.2 For all j ∈ J and consequents Cj → Dj of (6), I(Cj → Dj, x)= 0. Proof By lemma 3.1, condition (12) above, and T→.	 Lemma 3.3 For all conjoined antecedents Ai → Bi of (6), I(Ai → Bi, x)= 1.
Proof All of the Ij agree in making the Ai → Bi true. Suppose, for reductio, that I(Ai → Bi, x) were nonetheless false. Then there would be a, b such that Rxab and I(Ai, a) = 1 and I(Bi, b) = 0. But then, by (12), there is a j such that both a, b ∈ Kj and Rjjab. Whence, by lemma 1 and T→, Ij(Ai → Bi, j) = 0, which is impossible.	 
Theorem 3.4 BBL1 holds.
Proof As indicated. Suppose that (6) holds, but that (5) fails for all j ∈ J . Construct the interpretation I in the 3-frame K =< K, R >. On I we have, on abbreviated notation,
[Λi∈I (Ai → Bi)]x
ч[Vj∈J (Cj → Dj)]x
We have (17) by TΛ, because each Ai → Bi is true at x by lemma 3. And we have
(18) by TV, since each Cj → Dj is false at x by lemma 2. This shows that (6) is invalid after all, a contradiction, ending the semantic proof of BBL1. 10	 

Bibliographical references
References for The Better Bubbling Lemma The following abbreviations are used:
AJL Australasian Journal of Logic
JPL Journal of Philosophical Logic
JSL The Journal of Symbolic Logic
NDJFL Notre Dame Journal of Formal Logic

References
Barendregt, Henk, Mario Coppo and Mariangiola Dezani-Ciancaglini, A ﬁlter lambda model and the completeness of type assignment, JSL 48 (1983), 931–940.
Castagna, Giuseppe, and Alain Frisch. A gentle introduction to semantic subtyping. In PPDP05, ACM Press (full version) and ICALP05, LNCS volume 3580, Springer- Verlag (summary), 2005. Joint ICALP- PPDP keynote talk.

10 I have been chided by a referee, who correctly insists that the contributions of Castagna, Frisch and Benzaken in [6,2] and related research are at the heart of the topic of semantic subtyping. I am furthermore indebted to these authors, for entertaining me in Paris in July 2006 for conversations about their work and for sharing further projected papers of theirs.

Curry, Haskell B., 1963. “Foundations of Mathematical Logic,” McGraw-Hill, N. Y.
Dezani-Ciancaglini, M., A. Frisch, E. Giovannetti and Y. Motohama, 2002. The Relevance of Semantic Subtyping, Electronic Notes in Theoretical Computer Science 70 No. 1, 15pp.
Dezani-Ciancaglini, M., R. K. Meyer and Y. Motohama, The semantics of entailment omega, NDJFL
43 (2002), 129–145.
Frisch, Alain, Giuseppe Castagna, and Véronique Benzaken. Semantic subtyping. In LICS02, pages 137–146. IEEE Computer Society Press, 2002.
Meyer, Robert K., 1995. Types and the Boolean system CB+,
cslab.anu.edu.au/ftp/techreports/SRS/1995/TR-SRS-5-95/meyer.ps.gz  .
Meyer, Robert K., Yoko Motohama and Viviana Bono, Truth translations of relevant logics, in B. Brown and F. Lepage, eds., “Truth and Probability: Essays in Honour of Hugues Leblanc,” pages 59–84, College Publications, King’s College, London, 2005.
Pal, Koushik, and Robert K. Meyer. 2005. Basic relevant theories for combinators at levels I and II,
AJL 3, http://www.philosophy.unimelb.edu.au/2005/2003_2.pdf , 19 pages.
Routley, Richard, and Robert K. Meyer, The semantics of entailment III, JPL 1 (1972), 192–208.
