Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 346 (2019) 369–377
www.elsevier.com/locate/entcs
On Coloring a Class of Claw-free Graphs
To the memory of Fr´ed´eric Maffray

Yingjun Dai Ang`ele M. Foley Ch´ınh T. Ho`ang
Department of Physics and Computer Science Wilfrid Laurier University
Waterloo, Canada

Abstract
Given a set L of graphs, a graph G is L-free if G does not contain any graph in L as an induced subgraph. Recently, Fr´ed´eric Maffray and co-authors showed that the problem of coloring {claw, 4K1, K5 \ e}-free graphs can be solved in polynomial time. In this paper, we investigate a related class of graphs. A hole is an induced cycle of length at least 4. Two vertices x, y of a graph G are twins if for any vertex z different from x and y, xz is an edge if and only if yz is an edge. A hole-twin is the graph obtained from a hole by adding a vertex that forms a twin with some vertex of the hole. Hole-twins, and K5 \ e, are interesting in their connection with line-graphs. They are among the forbidden subgraphs in the characterization of line-graphs. In this paper, we show there is a polynomial time algorithm to color (claw, 4K1, hole-twin)-free graphs.
Keywords: Graph coloring, Line-Graph, Claw, Hole-twin, C6-twin, C5-twin, C4-twin, P5-twin

The result
Motivated by results in a recent paper of Fr´ed´eric Maffray and co-authors [9], we in- vestigate a graph coloring problem on (claw, 4K1, hole-twin)-free graphs (definitions not given here will be given later). Graph coloring is one of the most fundamental problems in graph theory, with many theoretical and practical results. We can define k-coloring, for some integer k, of a graph G, as a mapping f : V (G) → {1,..., k} such that f (u) /= f (v) for any two adjacent vertices u, v ∈ V (G). The key question in graph coloring is: what is the smallest integer k for which such a coloring exists? This number k is called the chromatic number, χ(G), of the graph. Determining the chromatic number of a graph is called the vertex coloring problem and is known to be NP-hard in general [14,10]. However, for some specific graph classes, the problem can be solved in polynomial time.
We say a graph G is H-free for some set H of graphs if G does not contain any member of H as an induced subgraph. The papers [9] and [17] study H4-free graphs, where H4 is any set of four vertex graphs. For any H4, VERTEX COLORING for

https://doi.org/10.1016/j.entcs.2019.08.033 1571-0661/© 2019 Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).


•	•	•
•
•	•	•
•




•	•	•	•	•
•	•
•	•	•	•	•

claw
4K1
C4 − Twin
C5 − Twin
C6 − Twin
P5 − Twin


Fig. 1. The graphs discussed in this paper

H4-free is known to be NP-complete or solvable in polynomial time, with three exceptions. One of the exceptions is the class of {claw, 4K1}-free graphs. The result of [9] shows that VERTEX COLORING is solvable in polynomial time for (claw, 4K1, K5 \ e)-free graphs. This class was further significant as it contains the 4K1-free line-graphs.
Given a graph G, the line-graph L(G) of G is defined to be the graph whose vertices are the edges of G, and two vertices of L(G) are adjacent if their correspond- ing edges in G are incident. Beineke [1] derived a characterization of line-graphs in terms of a set of nine forbidden induced subgraphs, two of which are the claw and K5 \ e. Thus given the connection of (claw, 4K1, K5 \ e)-free graphs to 4K1-free line-graphs, it is natural to ask about polynomial time solvability of vertex col- oring of graphs where K5 \ e is replaced by one of the other nine forbidden induced subgraphs. In fact we go further and pose the question for a more general class, which we introduce and call hole-twin. A hole is an induced cycle of length at least
4. Two vertices x, y of a graph G are twins if xy is an edge, and for any vertex z different from x and y, xz is an edge if and only if yz is an edge. A hole-twin is the graph obtained from a hole by adding a vertex that form a twin with some vertex of the hole. Figure 1 shows the three smallest hole-twins: C4-twins, C5-twins, and C6-twins.
The motivation behind defining the hole-twin class is the observation that three of Beineke’s nine forbidden graphs (C4-twin, C5-twin and P5-twin (see Figure 1)) are hole-twins or an induced subgraph of a hole-twin. Thus the hole-twin generalizes this idea by allowing holes of arbitrary length. It is now natural to wonder about the complexity of coloring (claw, 4K1, hole-twin)-free graphs.
The purpose of this paper is to prove the following theorem.
Theorem 1.1 There is a polynomial time algorithm to color (claw, 4K1, hole- twin)-free graphs.
In Section 2, we discuss the background results needed to prove our main theo- rem. In Section 3, we prove Theorem 1.1 along with necessary lemmas and ancillary results. And finally, in Section 4, we discuss the significance of our work, along with some open problems.

Definitions and Background
In this section, we discuss the background results needed to prove our main theorem. The section has two subsections. In the first subsection, we discuss claw-free graphs.

In the second section, we discuss clique widths.
Claw-free graphs
Let α(G) denote the number of vertices in the largest stable set of G. Let χ(G) denotes the chromatic number of G, and ω(G) denote the number of vertices in a largest clique of G. A k-hole is a hole with k vertices.
Our results rely on known theorems on perfect claw-free graphs, and we discuss these results now. A graph is Berge if it does not contain as induced subgraph an odd hole, or an odd antihole (complement of a hole). A graph G is perfect if for each induced subgraph H of G, we have χ(H)= ω(H). Parthasarathy and Ravindra [18] proved that claw-free Berge graphs are perfect. Chv´atal and Sbihi [7] showed that claw-free perfect graphs can be recognized in polynomial time. Hsu [13] showed that these graphs can be colored in polynomial time. We note that Chudnovsky, Robertson, Seymour and Thomas [6] proved that a graph is perfect if and only if it is Berge, solving a long standing conjecture of Berge [2]. Perfect graphs can be recognized in polynomial time (Chudnovsky, Cornuejols, Liu, Seymour and Vuˇskovi´c [5]), and they can be optimally colored in polynomial time (Gro¨tschel, Lov´asz and Schrijver [11]). For more information on perfect graphs, see Berge and Chv´atal [3]. In the paper of Chv´atal and Sbihi [7], the following result (“Ben Rebea’s Lemma”), crucial to our algorithm, is established (in this paper, “contains” means “contains as induced subgraph”).
Lemma 2.1 [7] Let G be a connected claw-free graph with α(G) ≥ 3. If G contains an odd antihole then G contains a C5.
It is well known that VERTEX COLORING is polynomial time solvable for graphs G with α(G) = 2. In the next section, we discuss the notion of the clique widths of graphs.
Clique widths of graphs
Consider the following operations to build a graph.
Create a vertex u labeled by integer l.
Make the disjoint union of several graphs.
For some pair of distinct labels i and j, add all edges between vertices with label
i and vertices with label j.
For some pair of distinct labels i and j, relabel all vertices of label i by label j.
In regards to the four operations above, when a new vertex is created, it must be assigned a label. The clique-width [8] of a graph is the minimum number of labels needed to build the graph with the above four operations. Given sets of vertices X, Y , we write X  0 Y to mean there are no edges between any vertex in X and
any vertex in Y ; this structure is called the co-join. We write X 1 Y to mean there are all edges between X and Y , this structure is referred to as the join of X and Y .

The following three observations are folklore (see [4]).
Observation 2.1 [Folklore] Let G be a graph and let X be a set of vertices of G of bounded size. Then G has bounded clique width if and only if G — X have bounded clique width.
Observation 2.2 [Folklore] Let G be a graph such that G is the join of two graphs G1 and G2. Then G has bounded clique width if and only if both Gi have bounded clique widths.
Observation 2.3 [Folklore] Let G be a graph such that G is the co-join of two graphs G1 and G2. Then G has bounded clique width if and only if both Gi have bounded clique widths.
Rao [19], improving a result of Koblera and Rotics [15], proved the following theorem.
Theorem 2.2 ([19]) For any constant c, vertex coloring is polynomial-time solvable for the class of graphs with clique-width at most c.
Our main result will rely on the fact that a special class of graphs (in the Lemma below) has bounded clique width.
Lemma 2.3 Let G be a graph such that V (G) can be covered by k (disjoint) cliques X1,..., Xk. For a vertex x, let Xix be the clique containing x, and let NF (x) be the set of neigbours y of x such that y ∈ Xj for j /= ix. Suppose G satisﬁes the following conditions: (i) for every vertex x and any set Xj with j /= ix, x has at most one neighbor in Xj, and (ii) for any vertex x, NF (x) is a clique. Then G has clique width at most 2k.
Proof. By (i) and (ii), if some two vertices x, y are adjacent with x ∈ Xi,y ∈ Xj,i /= j, then we have NF (x) — {y} = NF (y) — {x}; that is, x and y have the same neighbourhood in V (G) — (Xi ∪ Xj). It follows that we can partition the vertices of G into pairwise disjoint sets Y1, Y2,..., Yt, Z = V (G) — (Y1 ∪ Y2 ∪ ... ∪ Yt), such that the following holds: (1) each Ys is a clique with at least two vertices, (2) if two vertices x, y are adjacent with x ∈ Xi,y ∈ Xj,i /= j, then x and y belong to some clique Ys, and (3) every edge of G belongs to a clique Xi, or a clique Ys.
The vertices of a set Xi will be associated with two labels li,new, li,old. We will label the vertices of G one by one. Suppose we are about to label a vertex x.
If there is a vertex with a label li,new, re-label it with label li,old for all i.
Label x with label lix,new (Xix is the set containing x)
For each neighbour y of x in a set Xiy , label y with label liy,new
Add edges between vertices with new labels (building the clique Ys)
Add edges between vertices of label li,new and label li,old for all i (building the cliques Xi).
Re-label all vertices of label li,new with label li,old for all i.
We repeat the above steps until all vertices are labeled. We will use 2k labels.

This proves the lemma.
In the next section, we will establish a number of intermediate results before proving Theorem 1.1.
The proofs
In this section, we will assume that G is a connected (claw, 4K1, hole-twin)-free graph, and we will focus on what happens when G contains an odd hole. We know G contains no hole Ck with k ≥ 8 since G is 4K1-free. So we assume G contains a C7 or a C5.
Lemma 3.1 Let G be a connected (claw, 4K1, hole-twin)-free graph. If G contains a C7, then G has at most 21 vertices.
Proof. Suppose that G contains a 7-hole H, with vertices h1, ..., h7 and edges hihi+1, with the subscripts taken modulo 7. A vertex in G — H is a k-vertex if it is adjacent to k vertices in H.
Let Yi denote the set of 4-vertices adjacent to hi, hi+1, hi+2, hi+3. Let Zi denote the sets of 4-vertices adjacent to hi, hi+1, hi+3, hi+4. It is easy to see that a 4-vertex must be of type Yi, or Zi.
Observation 3.1 G has no k-vertex ∀ k ∈ {0, 1, 2, 3, 5, 6, 7}.
Proof. If G has a k-vertex, for k ∈ {0, 1, 2}, then G contains a 4K1. If G has a k-vertex, for k ∈ {5, 6, 7}, then G contains a claw. If there exists a 3-vertex, then G contains a C7-twin, or a claw.
From the above observations, it follows that a vertex in G — H must be of type
Yi, or Zi.
Observation 3.2 Yi is a clique.
Proof. If Yi contains non-adjacent vertices u,v, then {hi+3, hi+4, u, v} induces a claw.
Observation 3.3 |Yi|≤ 1 for any i.
Proof. Suppose some Yi has at least two vertices u, v. Then uv is an edge by Observation 3.2, and so {hi+3, hi+4, hi+5, hi+6, hi, u, v} induces a C6-twin.
Observation 3.4 Zi is a clique.
Proof. If Zi contains non-adjacent vertices u,v, then {hi, hi+6, u, v} induces a claw.
Observation 3.5 |Zi|≤ 1 for any i.
Proof. Suppose some Zi has at least two vertices u, v. Then uv is an edge by Observation 3.4, and so {hi+4, hi+5, hi+6, hi, u, v} induces a C5-twin.
From the above observations, we have |V (G)| = |V (H)|+Σ7	|Zi|+Σ7	|Yi|≤ 
21. We have established Lemma 3.1.
Lemma 3.2 Let G be a connected (claw, 4K1, hole-twin)-free graph. If G contains a C5, then either α(G)= 2, or G has bounded clique width, or both.

Proof. Suppose G contains a 5-hole H, with vertices h1, ..., h5, and edges hihi+1
with the subscripts taken modulo 5. We begin with an observation.
Observation 3.6 G has no k-vertex ∀ k ∈ {1, 3}.
Proof. Suppose G has 1-vertex, then G contains a claw. If there exists some 3-vertex, then G contains a C5-twin or a claw.
Next, we define the following sets, for each i ∈ {1, ..., 5}.
Let Xi be the set of 2-vertices adjacent to hi−2 and hi+2.
Let Yi be the set of 4-vertices not adjacent to hi.
Let R be the set of 0-vertices.
Let T be the set of 5-vertices.
Let Y = Y1 ∪ ... ∪ Y5, and X = X1 ∪ ... ∪ X5. From Observation 3.6, we have
V (G)= Y ∪ X ∪ R ∪ T .
We will need a number of observations below.
Observation 3.7 We have T	R.
Proof. If there is an edge between a vertex t ∈ T and a vertex r ∈ R, then G has a claw with t, r, and some two vertices in H.
Observation 3.8 We have T	X.
Proof. If there is an edge between a vertex t ∈ T and a vertex x ∈ X, then G has a claw with t, x, and some two vertices (that are non-neighbors of x) in H.
Observation 3.9 We have T	Y .
Proof. Suppose a vertex t ∈ T is not adjacent to some vertex y ∈ Yi for some i. Then the set {y, hi−1, t, hi+1, hi} induces a C4-twin.
Observation 3.10 We have R	Y .
Proof. If there is an edge between a vertex r ∈ R and a vertex y ∈ Y , then G has a claw with r, y, and some two vertices in H.
Observation 3.11 Xi is a clique.
Proof. Let u, v ∈ Xi and uv /∈ E. Then {u, v, hi+1, hi+2} induces a claw.
Observation 3.12 Yi is a clique.
Proof. Let u, v ∈ Yi and uv /∈ E. Then {u, v, hi, hi+1} induces a claw.
Observation 3.13 |Yi|≤ 1 for i = 1, 2,..., 5.
Proof. Suppose some Yi contains two vertices u, v. By Observation 3.12, uv is an edge of G. Now, {hi−1, hi, hi+1, u, v} induces a C4-twin.
Observation 3.14 R is a clique.
Proof. If R is not a clique, then some two non-adjacent vertices of R and some two non-adjacent vertices of H induce a 4K1.
Observation 3.15 A vertex u of Xi cannot be adjacent to two vertices in Xi+1,

and by symmetry, u cannot be adjacent to two vertices of Xi−1.
Proof.  Let u  ∈  Xi, v, k  ∈  Xi+1 and uv  ∈  E,  uk  ∈  E.  Then
{u, v, hi−1, hi, hi+1, hi+2, k} induces a C6-twin.
Observation 3.16 A vertex u of Xi cannot be adjacent to two vertices in Xi+2; and by symmetry, u cannot be adjacent to two vertices of Xi−2.
Proof. Let u ∈ Xi, v, k ∈ Xi+2 and uv ∈ E, uk ∈ E. Then {u, v, hi, hi+1, hi+2, k}
induces a C5-twin.
For a vertex x ∈ Xi for some i, define NF (x) to be the set of vertices y such that xy is an edge, and y ∈ Xj for some j /= i. By Observations 3.15 and 3.16, for each x ∈ Xi, we have |NF (x)|≤ 4.
Observation 3.17 For any i and any vertex x ∈ Xi, the set NF (x) is a clique.
Proof. We will prove the Observation by contradiction. Let x be a vertex in Xi for some i. Suppose NF (x) is not a clique, and so there are non-adjacent vertices y, z ∈ NF (x). First, let us suppose y ∈ Xi+1. If z ∈ Xi+2∪Xi−2, then the set {x, y, z, hi+2} induces a claw. Thus, z belongs to Xi−1, but now {hi+1, hi, hi−1, y, x, z, hi−2} in- duces a C6-twin. So we know {y, z}∩ (Xi+1 ∪ Xi−1) = ∅. Thus, we may assume y ∈ Xi+2 and z ∈ Xi−2. Now, the set {x, y, z, hi+2} induces a claw. We have established the observation.
We now continue the proof of Lemma 3.2. We know α(T ) ≤ 2 for otherwise G hasa claw with one vertex in H and some three vertices in T . Suppose T contains two non-adjacent vertices t1, t2. Then X has to be empty, for otherwise the set
{h, x, t1, t2} induces a claw, where x is a vertex in X, and h is a neighbour of x in H (by Observation 3.8, X has no neighbours in T ). Now, R has to be empty, for otherwise there is an edge rz with r ∈ R and z ∈ Y ∪ T (since G is connected); and this is a contradiction to Observations 3.10 and 3.7. Now, G is the join of T and H ∪ Y by Observation 3.9. The set Y ∪ H cannot contain a stable set S on three vertices, for otherwise S and a vertex in T induce a claw. It follows that α(G)= 2, and we are done.
So we may assume T is a clique. Note that cliques have clique width 2.
Let G1 be the subgraph of G obtained by removing all vertices in H ∪ Y . Since the set Y is finite (by Observations 3.13), by Observation 2.1, we only need to prove G1 has bounded clique width. In G1, there are no edges between T (if it is not empty) and X ∪ R by Observations 3.7 and 3.8. So, by Observation 2.3, we only need to prove the graph G2 induced by X ∪ R has bounded clique width.
There is an edge between any vertex r ∈ R and any vertex x ∈ X, for otherwise there is a 4K1 containing r, x, and some two vertices of H. So, G2 is the join of R and X. By Observation 2.2, we only need to prove G3 = G2 — R = X has bounded clique width. Recall Observation 3.17 that for each x ∈ Xi, NF (x) is a clique. Thus, G3 satisfies the hypothesis of Lemma 2.3, and so it has bounded clique width. The proof of Lemma 3.2 is completed.
Now, we can prove the main theorem.
Proof of Theorem 1.1. Let G be a (claw, 4K1, hole-twin)-free graph. We may

assume that G is connected and has α(G) ≥ 3. We may assume that G is not perfect, for otherwise we may use the algorithm of Hsu [13] to color a claw-free perfect graph in polynomial time. Thus G contains an odd hole or odd antihole. By Lemma 2.1, we know G must contain an odd hole H. Since α(G) < 4, H is a 7-hole or a 5-hole. If H is a 7-hole, then by Lemma 3.1, G has a bounded number of vertices and we are done. So H is a 5-hole. By Lemma 3.2, G has bounded clique width and we are done.
Conclusions and open problems
In this paper, we prove that VERTEX COLORING can be solved in polynomial time for the class of (claw, 4K1, hole-twin)-free graphs. The problem is NP-hard for claw-free graphs [12], and for 4K1-free graphs [16]. The complexity of VERTEX COLORING is unknown for the class of {claw, 4K1}-free graphs. See [9] and [17] for the background of this problem. We pose this as an open problem to conclude our paper.
Acknowledgement
This work was supported by the Canadian Tri-Council Research Support Fund. The 2nd and 3rd authors (A.M. Foley and C.T. Ho`ang) were each supported by individual NSERC Discovery Grants.

References
L.W. Beineke. Characterizations of derived graphs. Journal of Combinatorial Theory 9 (1970) 129–135.
C. Berge. F¨arbung von Graphen, deren s¨amtliche bzw. deren ungerade Kreise starr sind. Wiss. Z. Martin-Luther-Univ. Halle-Wittenberg Math.-Natur. Reihe 10:114 (1961) 88.
C. Berge and V. Chva´tal (eds.). Topics on Perfect Graphs. North-Holland, Amsterdam, 1984.
A. Brandst¨adt, J. Engelfriet, H.-O. Le, V.V. Lozin. Clique-width for four-vertex forbidden subgraphs.
Theory Comput. Syst. 34 (2006) 561–590.
M. Chudnovsky, G. Cornu´ejols, X. Liu, P. Seymour, K. Vuˇskovi´c. Recognizing Berge graphs.
Combinatorica 25 (2005), 143–186.
M. Chudnovsky, N. Robertson, P. Seymour, R. Thomas. The strong perfect graph theorem. Annals of Mathematics 164 (2006), 51–229.
V. Chva´tal, N. Sbihi. Recognizing claw-free perfect graphs. Journal of Combinatorial Theory Ser. B
44 (1988), 154–176.
B. Courcelle, J. Engelfriet, G. Rozenberg. Handle-rewriting hypergraph grammars. J. Comp. Sys. Sci.
46 (1993) 218–270.
D.J.Fraser, A.M. Hamel, C.T. Ho`ang, F. Maffray, A coloring algorithm for 4K1-free line graphs, Disc. Appl. Math. 234 (2018), 76–85.
M.R. Garey, D.S. Johnson, L.J. Stockmeyer. Some simplified NP-complete graph problems. Proceedings of STOC 1974, 47–63.
M. Gr¨otschel, L. Lov´asz, A. Schrijver. Polynomial algorithms for perfect graphs. In [3], 325–356.

I. Holyer. The NP-completeness of edge-coloring. SIAM J. Computing 10 (1981), 718–720.
W.-L. Hsu. How to color claw-free perfect graphs. Annals of Discrete Mathematics 11 (1981), 189–197.
R.M. Karp. Reducibility among combinatorial problems. In: Complexity of Computer Computations
(R.E. Miller and J.W. Thatcher editors), Plenum, New York (1972), 85–103.
D. Koblera, U. Rotics. Edge dominating set and colorings on graphs with fixed clique-width. Discrete Applied Mathematics 126 (2003), 197–221.
J. Kratochv´ıl, D. Kr´al’, Zs. Tuza, G.J. Woeginger. Complexity of coloring graphs without forbidden induced subgraphs. WG 2001, Lecture Notes in Computer Science, 2204 (2001), 254–262.
V.V. Lozin, D.S. Malyshev. Vertex coloring of graphs with few obstructions. Discrete Applied Mathematics (2015), http://dx.doi.org/10.1016/j.dam.2015.02.015.
K.R. Parthasarathy, G. Ravindra. The strong perfect graph conjecture is true for K1,3-free graphs.
Journal of Combinatorial Theory Ser. B 21 (1976), 212–223.
M. Rao. MSOL partitioning problems on graphs of bounded treewidth and clique-width. Theoret. Comput. Sci. 377 (2007), 260–267.
