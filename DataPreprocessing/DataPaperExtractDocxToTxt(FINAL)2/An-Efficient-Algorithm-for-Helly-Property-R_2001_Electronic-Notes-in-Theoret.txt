Electronic Notes in Theoretical Computer Science 46 (2001)
URL: http://www.elsevier.nl/locate/entcs/volume46.html 11 pages


An Efficient Algorithm for Helly Property Recognition in a Linear Hypergraph

A. Bretto 1
Groupe de Combinatoire et Traitement d’Image, Universit´e Jean Monnet, LIGIV Site G.I.A.T Industries, 3, rue Javelin Pagnon BP 505, 42007 Saint-Etienne cedex 1, France

H. Cherifi 2
Universit´e de Bourgogne. LIRSIA. BP 47870 21078 Dijon Cedex, France.

S. Ub´eda 3
INSA-Lyon. CITI, 20, ave A. Einstein F-69 Villeurbanne Cedex, France.


Abstract
In this article we characterize bipartite graphs whose associated neighborhood hy- pergraphs have the Helly property. We examine incidence graphs of both hyper- graphs and linear hypergraphs and we give a polynomial algorithm to recognize if a linear hypergraph has the Helly property.


Introduction
Computer vision is an attractive field of applications for two main reasons. First, it is directly applicable to many interesting problems, including face recognition, scene understanding, autonomous vehicle navigation, and content- based image and video retrieval. Second, it employs techniques from many mathematical disciplines such as linear algebra, graph theory, combinatorial and continuous optimization, ordinary and partial differential equations, prob- ability and statistics, and pattern recognition, to name a few. This makes it an ideal testing ground for new and adapted concepts and algorithms, whose impact can be immediately felt in such diverse applications as the analysis of medical images, video surveillance, target identification, etc. Furthermore,

1 Email: bretto@vision.univ-st-etienne.fr
2 Email: cherifi@crid.u-bourgogne.fr
3 Email: Stephane.Ubeda@insa-lyon.fr
◯c 2001 Published by Elsevier Science B. V. Open access under CC BY-NC-ND license.


the often imposed real-time performance requirements necessitate the devel- opment of efficient and practical algorithms. While computer vision has a long history, its main success stories come from solutions to problems that can be adequately formulated in terms of the mathematical tools it employs. For example, depth estimation from stereo can be cast as a matching problem (combinatorial optimization) followed by depth reconstruction (robust statis- tics and linear algebra). Image segmentation is a classic problem in computer vision and pattern recognition, instances of which arise in areas as diverse as object recognition, motion and stereo analysis. We have recently introduced a solution to this problem by providing a novel way of deriving an image neigh- borhood hypergraph based on the hypergraph-theoretic notions of visibility [6,7,8,9]. We have proved that in this new formulation allows to develop effi- cient algorithms. The framework has also been extended to handle low level vision problems such as noise cancellation, edge extraction. This framework is attractive because it casts computer vision problems as a pure hypergraph theoretic problem, for which a solid theory and powerful algorithms have been developed.
A hypergraph is a generalization of a graph in which binary relations be- tween pairs of vertices are generalized to n-ary relations. Hyperedges are formed by structural or relational patterns between the attributed vertices. The hypergraph knowledge representation is local and stable. That is, its subgraphs can be manipulated locally and small changes induce local varia- tions in attributes and topology. This knowledge representation has been used for the synthesis and recognition of 3D object models [23,5] and for robot path planning and navigation [18,22,19,15].
The Helly property has developed into a very broad field since its introduc- tion by C. Berge [4]. It is one of the most important concepts in hypergraph theory. It has been the focus of intense study for several years [14,17,20]. It provides a common property in several classes of these set systems, such as: balanced hypergraphs, unimodular hypergraphs, normal hypergraphs, arbo- real hypergraphs [3] . . .
Some properties can be derived from the Helly property. It is the case for
the very interesting theorem of Santalo published in 1940. The usefulness
of this theorem can be found in [12]
More recently this property has proved its importance in image analysis [7,8]. Helly property is a term that has arisen for the study of geometric prop- erties of digital image. It generalizes the geometric notion of visibility. Hence, in image processing this property can be interpreted as a local uniformity no- tion. In this article we are going to give some results about this property. We will deduce a polynomial algorithm to recognize if a linear hypergraph has (or not) the Helly property.


x1


x6	x2





x5	x3


x4

Fig. 1. This figure shows a cycle C6 with a well chord {x1, x4}.

Graph and Hypergraph Definitions
The general terminology concerning graphs and hypergraphs in this article is similar to the one used in [2,3]. All graphs in this paper are both finite and undirected. One will consider that these graphs are simple; graphs with no loops or multiple edges. All graphs will be considered as connected with no isolated vertex. We denote them G = (V ; E). Given a graph G, we denote the neighborhood of a vertex x by Γ(x), i.e. The set formed by all the vertices adjacent to x is defined by:
Γ(x) = {y ∈ V, {x, y}∈ E}.
The number of neighbors of x is the degree of x (denoted by dx).
A chain in a graph is a sequence of distinct edges—one following another— and the number of edges is the length of this chain.
A cycle is a chain such that the first vertex and the last vertex are the same.
Let Cn be a cycle, a chord of a cycle is an edge linking two non-consecutive vertices of this cycle.
Let G = (V, E) be a graph, a cycle C2n, n > 2 has a well chord if there exist an edge e belonging to G such that e shares C2n in two cycles Cn+1. An example is given in figure 1.
G' = (V '; E') is a subgraph of G when it is a graph satisfying V ' ⊆ V and
E' ⊆ E. If V ' = V then G' is a spanning subgraph.
An induced subgraph (generated by A) G(A) = (A; U ), with A ⊆ V and
U ⊆ E is a subgraph such that: for x, y ∈ A, when {x; y} ∈ E implies
{x; y}∈ U .
A subgraph which is a cycle without chord and with a length equal to n
will be denoted by Cn.


A cycle Cn is centered if there exists a vertex of G adjacent to every vertex of Cn. (If this vertex is on the cycle, one will consider that it is adjacent to it.)
A graph G = (V, E) is bipartite if V = V1 ∪ V2 with V1 ∩ V2 = ∅ and every edge joins a vertex of V1 to a vertex V2. We will denote a bipartite graph by G(V1, V2).
A graph G = (V, E) is bipartite if and only if it does not contain any cycle with an odd length.
A hypergraph H on a finite set S is a family (Ei)i∈I, I = {1, 2,..., n}	n ∈
N of non-empty subsets of S called hyperedges with:
  Ei = S.
i∈I
Let us denote: H = (S; (Ei)i∈I)
The rank of H is the maximum cardinality of a hyperedge.
An hypergraph is simple if Ei ⊆ Ej then i = j. In this article any hyper- graph will be considered as simple.
A hypergraph is linear if |Ei ∩ Ej|≤ 1 for i /= j.
For x ∈ S, a star of H—with x as a center—is the set of hyperedges which contains x, and is called H(x). The degree of x is the cardinality of the star H(x).
A partial hypergraph on S is a subfamily (Ej)j∈J of (Ei)i∈I.
A subhypergraph of the hypergraph H is the hypergraph H(Y ) = (Y, (Ei ∩
Y /= ∅)i∈I), (with Y ⊆ S).
The dual of a hypergraph H = (E1, E2,..., Em) on S is a hypergraph H∗ = (X1, X2,..., Xn) whose vertices e1, e2,..., em correspond to the hyperedges of H, and with hyperedges Xi = {ej, xj ∈ Ej}.
A family of hyperedges is an intersecting family if every pair of hyperedges has a non-empty intersection.
A hypergraph has the Helly property if each intersecting family has a non- empty intersection—belonging to a star. An example of this property is given in figure 2.
A hypergraph has the the strong Helly property if each subhypergraph has the Helly property.
The incidence graph of a hypergraph H = (S; E) is a bipartite graph with a vertex set V = S ∪ E, where two vertices x ∈ X and e ∈ E are adjacent if and only if x ∈ e. We denote it IG(H).
Let G = (S; E) be a graph; we can associate a hypergraph called neigh- borhood hypergraph to this graph:
HG = (S, (Ex = {x}∪ Γ(x))).

One will say that the hyperedge Ex is generated by x.





E1


(a) star	(b) triangle

Fig. 2. Assuming that the hypergraphs have only three hyperedges, the hypergraph
(b) does not have the Helly property.
Hypergraph and Image
Helly type theorem can be written in the followingform: “Let F be a collection of sets and let k be a fixed integer. If every sub-family of k sets in F has the property P then the collection F has the property Q.”
One of the most widely known theorem of this type is due to Edward Helly. It is easy to verify that a particular case of the Helly type theorem is the Helly property. Actually this property occurs in numerous mathematical fields. In arithmetics, the Chinese remainder theorem amounts to say that arithmetical progressions have the helly property. Another example of Helly family are families of intervals in a lattice. A computational aspect of this property has been highlighted in discrete geometry and computational geometry [24]. The Helly property is a basic concept in hypergraph theory, because a lot of classes of hypergraph have this property [3].
A distance d' on X defines a grid (a graph connected, regular, without both loop and multi-edge).
A digital image (on a grid) is a two-dimensional discrete function that has been digitized both in spatial coordinates and in magnitude feature value. So a digital image will be represented by the application:
I : X ⊆ Z2 →C ⊆ Zn  with n ≥ 1
where C identifies the feature intensity level and X identifies a set of points called image points. The couple (x, I(x)) is called a pixel. Any image can be represented by a hypergraph in the following way:
Let d be a distance on C. We have a neighborhood relation on the image defined by:
(1)  ∀x ∈ X, Γα,β(x) = {x' ∈ X, x' /= x | d(I(x), I(x')) < α and d'(x, x') ≤ β}
The neighborhood of x on the grid will be denoted by Γβ(x).


So, we can associate, to each image a hypergraph called Image Adaptive Neighborhood Hypergraph (IANH):
Hα,β = (X, ({x}∪ Γα,β(x))x∈X).
The attribute α can be calculated in an adaptive way depending on the nature of the neighbour image treated.
As a digital image has geometrical and combinatorial aspects, the Helly property is particular suited to image processing. Let an image be represented by its neighborhood hypergraph, if some connected sub-hypergraphs have the Helly property, the centers of the stars characterize the common neighborhood relations of the stars. Therefore a star center is representative of the whole neighborhood. These centers may be a sufficient representation to extract global information. Consequently it is worth studying the Helly property from a theoretical point of view.

Preliminary Results
We now characterize bipartite graphs such that the associated neighborhood hypergraph has the Helly property.
Theorem 4.1 Let G = (V ; E) be a bipartite graph, and HG its associated neighborhood hypergraph. HG has the Helly property if and only if G does not contain C4 and C6.
Proof. The condition is necessary. Suppose that G contains a C4. HG has the Helly property. Consequently C4 is centered, so G contains a cycle C3. Contradiction. If G contains C6, either C6 is centered and G contains C3 or there exists a vertex adjacent to three non-consecutive vertices of C6, so G contains a cycle C4 and thus it is a cycle C3. Contradiction.
The condition is sufficient. We prove this assertion by induction on the hyperedge number from an intersecting family.
Let (Exi )i∈{1,2,3,} be an intersecting family of three hyperedges, by hy- pothesis x1, x2, x3 cannot be on a cycle Cn with n = 4, 5, or 6. We denote V = V1 ∪ V2. Two cases arise:
x1, x2, x3 ∈ V1. We have yi adjacent to xi, xi+1 (mod3). So y1 = y2 = y3 = y, otherwise one would have C4 or C6.
x1, x2 ∈ V1 and x3 ∈ V2 necessarily x3 is adjacent to x1 and x2.
Consequently, there exists a vertex y adjacent to x1, x2, x3 in the first case, and y = x3 is adjacent to x1 and x2 in the second case.
Suppose that any intersecting family with n − 1 hyperedges belongs to a star, and let (Exi )1≤i≤n be an intersecting family. (Exi )2≤i≤n belongs to a star, so there exists y such that y is adjacent to (xi)2≤i≤n. Suppose that y ∈ V1 and (xi)2≤i≤n ⊆ V2.
x1 ∈ V1. Then x1 is adjacent to xi i ∈ {2, 3,..., n}. So x1 = y otherwise


this would lead to a C4.
x1 ∈ V2. Let ui, i ∈ {2, 3,..., n} be the common neighbor of x1, xi. Suppose that for all i ∈ {2, 3,..., n}, ui /= y.
There exists i /= j such that ui /= uj, consequently this leads to a C6.
For all i, j ∈ {2, 3,..., n}, ui = uj, consequently this leads to a C4.
So there exists i ∈ {2, 3,..., n} such that ui = y and y is adjacent to x1.
We can conclude that HG has the Helly property.	✷
From this theorem we have the following:
Corollary 4.2 Let G = (V, E) be a bipartite graph and HG its associated neighborhood hypergraph. HG has the Helly property if and only if it has the strong Helly property.
Proof. If HG has the strong Helly property then obviously it has the Helly property.
Assume now that HG has the Helly property. Let H' = (V ', E') be a subhypergraph of HG. The induced subgraph G(V ') contains neither C4 nor C6. Hence H' has the Helly property, so HG has the strong Helly property. ✷
On the strong Helly property we have:
Theorem 4.3 Let H = (S, E) be a hypergraph. H has the strong Helly prop- erty if and only if every C6 of IG(H) is well chorded.
Proof. If H has the strong Helly property it is easy to see that any C6 of
IG(H) is well chorded.
Assume now that any C6 of IG(H) is well chorded. Let H' be a subhy- pergraph, we are going to prove this assertion by induction on the hyperedge number of H'.
Let (Ei)i∈{1,2,3} be an intersecting family. This family generates a cycle (x1, e1, x2, e2, x3, e3, x1) in the incidence graph of H'. This cycle is well chorded, so there exists a vertex xi, i ∈ {1, 2, 3} which belongs to  i∈{1,2,3} Ei.
Assume this is true for any intersecting family of H with p— 1 hyperedges. Let (Ei)i∈{1,2,3,4,...,p} be an intersectingfamily with p hyperedges. The following families (Ei)i∈{2,3,4,...,p}, (Ei)i∈{1,3,4,...,p}, (Ei)i∈{1,2,4,...,p} are stars, by induction hypothesis. So one can stand for respectively by H(u), H(v), H(w) these
three stars. These three vertices are on a cycle (u, Eu,v, v, Ev,w, w, Ew,u, u) (Ea,b being a hyperedge containing the vertices a, b). These cycles being well chorded, u, v, or w belong to any hyperedge of (Ei)i∈{1,2,3,4,...,p}. Hence this family is a star. So H' has the Helly property.	✷
We say that the hypergraph H = (V ; E) has the separation property (briefly, SP) if for every pair of distinct vertices x, y ∈ V there exists a hyper- edge Ei ∈ E such that either x ∈ Ei and y /∈ Ei or x /∈ Ei and y ∈ Ei.
Corollary 4.4 A hypergraph H with the SP property has the strong Helly property if and only if its dual H∗ has the strong Helly property.

Proof. It is easy to see that the incidence graph of a hypergraph with the SP property is isomorphic to the incidence graph of its dual H∗. Moreover, from theorem above, H has the strong Helly property if and only if every C6 of IG(H) is well chorded. The corollary is proved.	✷

Linear Hypergraph and Helly Property
The existence of an efficient polynomial algorithm for checking if a hypergraph has the Helly property follows from classical theory. For example, from the following corollary at page 23 of [2]:
Corollary 5.1 A hypergraph H has the Helly property if and only if for any three vertices a1, a2, a3, the family of hyperedges which contains at least two of these vertices has a non-empty intersection.
This corollary comes directly from the following:
Theorem 5.2 [3] A hypergraph H is k-Helly if and only if for every set A of vertices with |A| = k+1, the intersection of the hyperedges Ej with |Ei∩A|≥ k is non-empty.
Remark 5.3 We say that a hypergraph H = (E1, E2,..., Em) is k-Helly if, for every J ⊂ {1, 2,..., m}, the following two conditions are equivalent:
I ⊂ J and |I| < k implies  i∈I Ei /= ∅
j∈J Ej /= ∅
It is easy to see that a hypergraph is 2-Helly if and only if it satisfies the Helly property. From corollary 4.1 we get easily the following algorithm:
Algorithm Helly:
Data: Hypergraph H
for all pairs of vertices x and y of H do begin Xxy := all hyperedges containing both x and y; for all vertices v of H do begin
if x and y are both neighbors of v then begin
Xxv := all hyperedges containing both x and v; Xyv := all hyperedges containing both y and v; X := Xxy ∪ Xxv ∪ Xyv;
if the intersection of all elements of X is empty then begin
output(THE HELLY PROPERTY DOES NOT HOLD);
end if end if
end for end for
end

This algorithm is relatively simple. However, the time complexity of this algorithm is O(n3∆2r2m) which is rather large. We are going to give an algorithm with lower complexity for particular class of hypergraphs.
The following result gives a characterization of linear hypergraphs which have the Helly property.

Lemma 5.4 Let H = (S; E) be a hypergraph. We have the three following properties:
If H is linear then H has the Helly property if and only if HIG(H) has the Helly property.
H is linear if and only if IG(H) does not contain C4.
If IG(H) does not contain C6 then H has the Helly property.

Proof. (i) Suppose that H is linear and that HIG(H) has the Helly property. Let I = (Ei)i∈{1,...,p} be an intersecting family of hyperedges of H. In HIG(H) I is a set of vertices such that ({ei}∪ Γ(ei))i∈{1,...,p} is an intersecting family. HIG(H) having the Helly property (Ei)i∈{1,...,p} has a non-empty intersection.
Suppose that H has the Helly property and suppose that HIG(H) does not satisfy the Helly property. From theorm1 IG(H) contains C4 or C6.
If IG(H) contains C4, there exist two vertices of C4—e1, e2 representing two hyperedges of H—and two vertices x1, x2 of S belonging to C4. So x1, x2 belong to E1 and E2. Consequently |E1 ∩E2| > 1—|E1 ∩E2| is the cardinality of E1 ∩ E2—and H is not linear. Contradiction, IG(H) does not contain C4.
If IG(H) contains C6: x1, e1, x2, e3, x3, e2, x1 There exists three vertices of C6—e1, e2 and e3 representing three hyperedges of H—and three vertices x1, x2 x3 of S belonging to C6. But H has the Helly property, so there exists y ∈ S such that y ∈ E1 ∩ E2 ∩ E3. Either y = xi, i = 1, 2 or 3. For example y = x1, so x1, e1, x2, e3, x1 is a C4 contradiction, or y /= xi, i = 1, 2 or 3, but for example |E1 ∩ E2| > 1 and H is not linear, contradiction. Consequently HIG(H) does not contain C6. We can conclude that IG(H) has the Helly property.
is obvious from the proof of (i).
Suppose that IG(H) does not contain C6 and that H does not has the Helly property. There exists an intersecting family of hyperedges with no common vertex. Let F = (Ei)i∈{1,...,p} be a minimal intersecting family of hyperedges not satisfying the Helly property—F does not satisfy the Helly property but any subfamily satisfy this property. One has |F | > 2. So x1 ∈
i∈{1,2,4,...,p} Ei, x2 ∈	i∈{2,3,4,...,p} Ei and x3 ∈	i∈{1,3,4,...,p} Ei. Hence IG(H) contains a cycle C6; for instance we have the cycle {x1, e1, x3, e3, x2, e2, x1}.
Contradiction, so H has the Helly property.	✷

We now give an important result.

Algorithm
The theorem below shows that there exists a polynomial algorithm to recognize if a linear hypergraph has (or not) the Helly property.
5
Theorem 6.1 There exists an algorithm with a complexity in O((pm) 3 ) to
recognize if a linear hypergraph has (or not) the Helly property.
Proof. The recognition algorithm for a Helly-hypergraph—hypergraph hav- ing the Helly property—is directly given from theorem1, lemma1 and [1].
In [1], it has been shown that deciding if a graph G = (V ; E) contains (or

not) a simple cycle C2k
or C2k−1
can be done in O(m2− 1 ) time (m is the edge

number of G).
The edge number of IG(H) is Σm

|Ei|)—|Ei| is the cardinality of the

Σm	Σi=1

So the computational time to decide if G contains (or not) C4 or C6 is in
3	5
O((pm) 2 ) and O((pm) 3 ) respectively.	✷

References
Alon N., R. Yuster, and U. Zwick, Finding and counting given length cycles.
Algorithmica 17, 1997, 209–223.
Berge C., Graphs. North-Holland, 1985.
Berge C., Hypergraphs. North-Holland, 1989.
Berge C., The Helly property. Southeast Asian Bulletin of Mathematics 1, 1977, 16–19.
Bhandarkar S.M., A surface feature attributed hypergraph representation for 3-D object recognition. Int. Journal of Pattern Recognition and Artificial Intelligence 9, 1995, 869–909.
Bretto A. and S. Ub´eda, Hypergraph model of digital topology for grey level images. In: S. Miguet, A. Montanvert and S. Ub´eda, editors, Discrete Geometry for Computer Imagery: 6th International Workshop (DGCI ’96, Lyon), Springer-Verlag (Lecture Notes in Computer Science 1176), 1996, 217– 226.
Bretto A., H. Cherifi, and D. Aboutajdine, Hypergraph imaging: an overview.
To appear in Pattern Recognition.
Bretto A., J. Azema, H. Cherifi, and B. Laget, Combinatorics and image processing. Graphical Models and Image Processing 59, 1997, 265–277.
Bretto A. and H. Cherifi, Noise detection and cleaning by hypergraph model. Proc. International Symposium on Information Technology: Coding and Computing (ITCC 2000, Las Vegas), IEEE Computer Society, 2000, 416–419.


Bretto A. and B. Laget, Helly type theorem for graphs. Rendiconti di Circulo di Matematica di Palermo, Ser II 65, 2000, 59–65.
Bretto A., S. Ub´eda, and J. Zˇerovnik, A polynomial algorithm for the strong Helly property. To appear in Information Processing Letters.
Chassery J. M. and A. Montanvert, G´eom´etrie Discr`ete en Analyse d’Images. Hermes, 1991.
Dragan F. F., Domination in quadrangle-free Helly graphs. Cybernetics and Systems Analysis 29, 1993, 822–829.
Duchet P., Propri´et´e de Helly et probl`emes de repr´esentations. In: Probl`emes Combinatoires et Th´eorie des Graphes (Colloq. Internat., Orsay, 1976), Editions du CNRS 260, Paris, 1978, 117–120.
Fayek R.E. and A.K.C. Wong, Using hypergraph knowledge representation for natural terrain robot navigation and path planning. Proc. IEEE International Conference on Robotics and Automation (ICRA ’96, Minneapolis), 1996, 3625– 3630.
Lehel J. and Zs. Tuza, Neighborhood perfect graphs. Discrete Math. 61, 1986, 93–101.
Quilliot A., On the Helly property working as a compactness criterion on graphs.
J. Combin. Theory Ser. A 40, 1985, 186–193.
Rueb K.D. and A.K.C. Wong, Structuring free space as a hypergraph for roving robot path planning and navigation. IEEE Trans. PAMI 9, 1987, 263–273.
Stasse O. and Y. Kuniyoshi, Achieving efficiency and code re-usability in a programming system for complex robotic applications. Proc. IEEE International Conference on Robotics and Automation (ICRA 2000, San Francisco), 2000, 81–87.
Tuza Zs., Applications of the set-pair method in extremal hypergraph theory. In: P. Frankl et al., editors, Extremal Problems for Finite Sets (Conference, Visegr´ad, 1991), Bolyai Society Mathematical Studies 3, 1994, 479–514.
Tuza Zs., Helly property in ﬁnite set systems. J. Combin. Theory Ser. A 62, 1993, 1–14.
Wong A.K.C., Knowledge representation for robot vision and path planning using attributed graphs and hypergraphs. In: A.K.C. Wong and A. Pugh, editors, Machine Intelligence and Knowledge Engineering for Robotic Applications (NATO Advanced Research Workshop, Maratea, 1986), NATO ASI Series, Springer-Verlag, 1987, 113–143.
Wong A.K.C., M. Rioux, and S.W. Lu, Recognition and shape synthesis of 3D objects based on attributed hypergraphs. IEEE Trans. PAMI 11, 1989, 279–290.
Wenger R., Helly-type theorems and geometric transversals. In: J. E. Goodman and J. O’Rourke, editors, Handbook of Discrete and Computational Geometry, CRC Press, 1997, 63–82.
