Available online at www.sciencedirect.com


Electronic Notes in Theoretical Computer Science 318 (2015) 19–29
www.elsevier.com/locate/entcs

Development of a Smart Grid Simulation Environment 1
J. Delamare , B. Bitachon, Z. Peng, Y. Wang
B. R. Haverkort, M.R. Jongerden 2
Design and Analysis of Communication Systems University of Twente
Enschede, The Netherlands

Abstract
With the increased integration of renewable energy sources the interaction between energy producers and consumers has become a bi-directional exchange. Therefore, the electrical grid must be adapted into a smart grid which effectively regulates this two-way interaction. With the aid of simulation, stakeholders can obtain information on how to properly develop and control the smart grid. In this paper, we present the development of an integrated smart grid simulation model, using the Anylogic simulation environment. Among the elements which are included in the simulation model are houses connected to a renewable energy source, and batteries as storage devices. With the use of the these elements a neighbourhood model can be constructed and simulated under multiple scenarios and configurations. The developed simulation environment provides users better insight into the effects of running different configurations in their houses as well as allow developers to study the inter-exchange of energy between elements in a smart city on multiple levels.
Keywords: smart grid, simulation, renewable energy


Introduction
Over the last decades, there has been an increase in the availability and affordability of renewable energy sources in households, such as wind mills and, primarily, solar panels. In addition, the capacity of electricity storage devices has risen considerably. As a consequence, renewable energy production will potentially make up a large portion of the energy in the electrical grid system. The traditional electrical grid

1 This work was realized as part of the e-balance project that has received funding from the European Union Seventh Framework Programme (FP7/2007-2013) under grant agreement n◦ [609132].
2 Email: j.s.r.delamare@student.utwente.nl, b.bitachon@student.utwente.nl,
z.peng-1@student.utwente.nl, y.wang-6@student.utwente.nl, b.r.h.m.haverkort@utwente.nl,
m.r.jongerden@utwente.nl


http://dx.doi.org/10.1016/j.entcs.2015.10.017
1571-0661/© 2015 The Authors. Published by Elsevier B.V.
This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).

needs to be upgraded into a smart grid system, which is able to effectively and efficiently regulate the bi-directional energy flow and the interaction between the various devices on the grid. The electrical energy can flow to, or from the main grid, depending on the time of the day, weather condition and electricity prices. The algorithms which control different functions in a smart grid are complex and need to be studied through simulation before actual implementation to ensure proper operation in all scenarios.
In this paper we present a simulation model which describes the various elements within a smart grid such as user-demand, centralized and decentralized energy pro- duction, storage elements, etc. The final overall model simulates a smart grid at neighbourhood level involving several houses with a set of typical smart grid sce- narios. Each house can be fitted with solar panels, a battery and its individual demand profile. The model gives insight in how the energy flows within a house, and between the houses in the neighbourhood, and thus can help in smart grid design. Furthermore, due to the modular set-up of the model, the simulation model can be easily extended to incorporate other devices and scenarios.
The Anylogic software [8] is used for the design of the simulation model. The simulation methods supported are system dynamics, agent-based and discrete event. The programming and setup is done using graphical components along with code based on the JAVA language. The software used is flexible and allows for the implementation of the multiple simulation methods within the model. For the inner operation of the model system dynamics is used as it effectively describe the flow of energy through the various components. Each component is then represented as an agent which then allows them to interact and exchange data with each other, this is done using the agent-based approach within the program.
The rest of this paper is structured as follows. Section 2 describes the function- ality of the different model components. In Section 3 some simulation results of a number of example scenarios are given. In Section 4 a short overview of related work is given. Finally, we conclude in Section 5.
Model components
A smart neighbourhood consists of a number of connected smart houses. Each such house will be built up out of several components which will have configurable parameters to make each house have its own characteristic behaviour. In Figure 1 the overall model of an individual residential unit can is displayed with all the designed components connected which are able to communicate together through the ports found on each. In the following, the functionality of each component will be presented.
House
The House model is the main element which allows interaction between the other component models. All other components are connected to the house via ports which enable communication between them. The way which the produced and



Fig. 1. Residential Unit


imported power is used and stored is determined by the settings of the house. For example, one can set that the battery is only charged by locally generated energy.

Demand
In the Demand module, the electricity demand profile of the house is defined. The profile gives the average power drawn over a given period of time, which may be dependent on the time of day and the day of year. Standardized demand profiles can be found on the internet, for example, EDSN [9] provides standard profiles for the Netherlands. With smart meters one could measure personalized demand profiles, in order to create fully customized simulations.

Weather
The Weather module provides the necessary weather data for computing the gen- erated renewable energy. Since the model, for now, is limited to solar panels only irradiation data is used. However, this can easily be extended to include wind speed data for wind generation. For locations in the Netherlands, the weather data is readily available via the Royal Netherlands Meteorological Institute (KNMI) [12]. It provides Global Horizontal Irradiance (GHI) data, which can be used for the computation of the generated solar energy. The GHI consists of the Direct Normal Irradiance and Diffuse Normal Irradiance [10], and is measured over a horizontal plane, 0 degree tilting.

Solar Panel
The Solar Panel module converts part of the solar irradiance into electrical power [2]. The output power is highly dependent on the position of the panel with respect to the sun. However, to incorporate this fully it would require many input parame- ters from the user. So, in order to keep the model easily configurable and limit the involvement of the user, the relation between the GHI and the output power (P ) is given by the following approximate relation:
P = ϵ × A × GHI,

where ϵ is the efficiency of the solar panels and A is the area of the panels.

Battery
The Battery is a component to be modelled as it is likely to be used as a storage element in a smart grid system. The battery model should be user-friendly, which means the battery specification can be adjusted by the users. Many different types of battery models have been developed for various applications over the years [3]. There are two crucial requirements for the battery model. The first is a small num- ber of parameters which makes the model simple and easy to configure. The second is a high accuracy. In most cases, a trade-off between the number of parameters and accuracy are exist [4]. The battery is chosen to be modelled using the Kinetic Battery Model (KiBaM) [5]. Within this simulation the usage algorithm depends on the availability of power from the solar panel. The battery is used as a buffer when the panels are not able to deliver sufficient power.

Pricing Module
The Pricing module allows the user to keep track of the amount of money paid for the energy used as well as the amount credited when selling energy back to the grid. Different suppliers can be compared to show which packages are most convenient for the user’s smart grid setup. Also, the financial data can be used to estimate the return of investment of a future setup.

Neighbourhood
By configuring multiple houses, a neighborhood can be created within the model, as visualized in Figure 2. For each house the different modules can be uniquely defined, to fit to the individual demand profiles and available battery capacity and solar panels. It is also possible to create multiple instances of identical houses to create a larger population of houses. In this way, one can easily study the effect of an increase of the penetration of solar panels on the interaction of a neighborhood with the grid.



Fig. 2. Example of Neighbourhood model
Simulation studies
Set-up
The simulation is run on two levels, the Neighbourhood and residential level, to observe the operation of the designed model. These simulation results will show how the requirements listed are met in the designed smart grid environment. At the neighbourhood level 14 residential units are simulated with the setup as shown in Table 1. The 14 residential units are build-up from 8 differently configured units, with different solar panel size and battery capacity. For five of these configura- tions multiple instances are used in the neighbourhood. The size of the household determines the demand profile of each house. The weather profile is the same for all houses. All of the following results are obtained by simulating one month in Summer.

Table 1
Smart Grid Residence Setup Scenario



Neigbourhood level
At the neighbourhood level, cumulative data of all the residential units can be gathered which allows for the study of the interaction between the neighbourhood and the portion of the grid it is connected to. In Figure 3, we display the energy trade figures for the given scenario. It shows how much energy is imported from the grid by the whole neighbourhood, and how much of the generated energy is exported to the grid. In the simulated period, approximately 4000 kWh has been generated




Fig. 3. Distribution of Neighbourhood Energy
by the solar panels. Nearly 2500 kWh has been used in the neighbourhood, either directly or by storing it in the batteries. The rest, approximately 1600 kWh, is delivered to the grid.
In Figure 4 the ratio of the energy supplied by the sources and storage to the demand can be seen. With the implementation of the above configuration nearly 50% of the energy required for the neighbourhood can be supported directly by the solar panels. Another 18% of the demand is supplied in directly by solar energy, through the batteries.
The user can study relations such as the effect of an increase of the number of solar panels on the amount of energy imported from and exported to the grid by the neighbourhood. Thus, one can investigate to what extend the neighbourhood could operate autonomously from the central grid.

Residential level
Within the same simulation run the effects for the individual houses can be studied as well. The shown results are from a household of a family with 3 children, with house type A. All the shown results can easily be obtained for the other household types as well.
At the residential, level data similar to that on the top level can be viewed, such as the distribution of the sources that are used to meet the demand. In addition to

that data can be gathered and displayed for the power usage profile as can be seen in Figure 5. The usage profiles shown is for a period of 24 hours (hours 695 to 720 in our simulation) from the different sources. From such graphs the switching between energy sources can be carefully studied, especially when implementing complex control algorithms. Furthermore, in Figure 6 one can see the distribution on the total generated power from the solar panels to the various elements in the system.
Within the Pricing Module the user can keep track of the debit and credit, due to reselling excess back to the utility companies. Figure 7 shows the hourly sales for the chosen configuration, while in Figure 8 the total exchange over a period is shown, in this case one month. With these results users can get estimates about the net cost effects when using particular energy companies. Other algorithms could be implemented which could regulate energy use based on pricing models from the utility companies.

Related Work
The importance of smart energy distribution is stressed by organisations such as the Joint Research Centre at the Institute for Energy and Transport [11], which advices the European Commission on energy policy. The organisation promotes and encourages research in various areas of smart grid systems.
In [1] the authors develop a model of a gas station micro grid which is connected to PV panels as well as storage devices. The model is implemented in Anylogic and follows a similar methodology as that used in this paper. The energy flow within the system is determined using system dynamics and the elements of the gas station are built as components which communicate with each other. The gas


Fig. 4. Energy Source Distribution




Fig. 5. Power Supplied by Sources and Power Usage


Fig. 6. Power distribution from panel production

station includes models for the car traffic which would visit a comparable station. Different configurations could be modelled to find the optimal energy balance for the system.
The Smart Grid Simulator [7] focuses on lowering the energy bill for the cus- tomers. It uses data regarding hourly energy consumption, energy prices, as well self-produced energy circumstances, in order to predict the amount of energy bought for the next day, lower the cost of electricity, optimize the utilization of the elec-





Fig. 7. Hourly Credit and Debit

Fig. 8. Total money exchanged in a one month period
tricity, compare assortment of prices, run a brokering algorithm that dictates when energy is being bought, stored, or sold and predicting the renewable energy produc- tion.
In [6], an overview is given of the features and the capability of a smart energy city, one of which is lower energy consumption. The advantages of a smart city are demonstrated using Anylogic. The model is based on Demand Response (DR). The author argues that the DR based system will reduce the overall energy consumption of a city because the peak demand level can be lowered. In addition to DR the model also employs load control to decrease the energy consumption even further. There

are two levels in the model. The first level is a smart building, modelled as an agent, the second level is the environment for the smart building agent. The first level of the model uses a price signal as the input, the price signal will then affect the decision making process inside the building, for instance to determine whether to use the energy from the battery, or whether some appliances need to be turned off. The main level of the model acts as the utilities company. The model assumes that the occupants of the building signed a contract that allows the utilities company to control a predefined load. This is done by using an algorithm that allows the utilities company to reduce and restore energy consumption level at any given time. The model, which has four buildings, was tested using a sequence of scenarios. The results show that the model does indeed lower the overall energy consumption level of the houses. The results also show that demand response with an addition of load control results in a further reduction of the energy consumption.
Conclusion
A smart grid simulation tool has been developed which can model residential units which have solar panels and batteries which are able to store excess energy. Differ- ent living situations are available for the residential unit to allow for a more diverse data set when scaling the model to neighbourhood level. The model is able to use statistical data from local meteorological sources to represent the weather patterns and influence the solar panel output power. With the combination of the various elements a vast amount of data can be gathered which shows the interactions be- tween the elements. Data can be gathered on both the financial level and the energy level which can be useful for both consumers and researchers.
The program was developed using the Anylogic simulation software which al- lowed for a flexible environment to implement the desired models. System dynamics and agent-based modelling were the methods primarily used in making the models. The agent-based approach allowed the residential units to be scalable and allow for multiple instances which adds diversity to the neighbourhood simulation.
The current model can be further expanded upon by incorporating other el- ements such as stationary electric vehicles as additional storage units, as well as other renewable sources. Algorithms can be implemented to study the behaviour in different scenarios, such as purchase/sell of power according to market price. Other algorithms could control the usage of the connected battery.

References
Bazan, P. and R. German, Hybrid simulation of renewable energy generation and storage grids, in:
Simulation Conference (WSC), Proceedings of the 2012 Winter, 2012, pp. 1–12.
Duffie, J. A. and W. A. Beckman, “Solar engineering of thermal processes,” John Wiley & Sons, 2006
p. 747.
Jongerden, M. and B. Haverkort, Which battery model to use?, Software, IET 3 (2009), pp. 445–457.
Jongerden, M. R., “Model-based energy analysis of battery powered systems,” Ph.D. thesis, University of Twente (2010).

Manwell, J. F. and J. G. McGowan, Lead acid battery storage model for hybrid energy systems, Solar Energy 50 (1993), pp. 399 – 405.
Morvaj, B., L. Lugaric and S. Krajcar, Demonstrating smart buildings and smart grid features in a smart energy city, in: Energetics (IYCE), Proceedings of the 2011 3rd International Youth Conference on, IEEE, 2011, pp. 1–8.
Ursachi, A. and D. Bordeasu, Smart grid simulator, International Journal of Civil, Architectural, Structural and Construction Engineering 8 (2014), pp. 519–522.
Anylogic, 23 July 2015.
URL http://www.anylogic.com/
EDSN demand profiles, 23 July 2015.
URL http://www.edsn.nl/verbruiksprofielen/
Global horizontal irradiance, 23 July 2015.
URL   http://pvpmc.org/modeling-steps/irradiance-and-weather-2/irradiance-and-insolation/
global-horizontal-irradiance/
Joint research centre at the institute for energy and transport, 23 July 2015.
URL http://iet.jrc.ec.europa.eu/

Uurgegevens van het weer in nederland, 23 July 2015. URL http://www.knmi.nl/klimatologie/uurgegevens/
