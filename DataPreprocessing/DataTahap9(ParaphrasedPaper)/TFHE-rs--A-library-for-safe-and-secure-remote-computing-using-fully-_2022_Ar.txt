Outsourcing data and computation services to public cloud providers requires robust security measures to enforce strict data confidentiality and integrity regulations, especially when dealing with sensitive data. Currently, two separate approaches—homomorphic encryption (HE) and hardware-based trusted execution environments (TEEs)—are being promoted as potential game changers in securing data processing activities.

Homomorphic encryption allows computation on encrypted values without revealing their content, and research in this area increased significantly after 2009 when Craig Gentry presented the first technique for achieving fully homomorphic encryption (FHE) nearly 30 years after the idea was conceived. FHE enables the outsourcing of various types of computations that previously had to be kept in-house due to confidentiality constraints, including health-data processing, financial processing, and genome research.

On the other hand, hardware-based TEEs, such as Intel SGX, are technologies that ensure the confidentiality and integrity of computations performed internally. However, these hardware-based solutions may not provide highly assured confidentiality in public cloud settings due to potential attacks such as power-monitoring attacks and software-based side-channel attacks. To counter this, certain techniques can be employed, such as using oblivious primitives like oblivious RAM (ORAM) to obscure access patterns and prevent information leakage through side-channels, albeit with a considerable performance overhead.

Within this security context, it is proposed to adopt a hybrid approach that combines the confidentiality strengths of FHE with the integrity strengths of TEEs, utilizing the memory-safe programming language Rust. This approach mitigates a wide range of security-related bugs and vulnerabilities, providing a more robust security mechanism compared to using either FHE or TEEs separately. To demonstrate the feasibility of the hybrid approach, a comparison of the relative performance difference was conducted, highlighting that the hybrid approach retains more robust security and safety guarantees while maintaining acceptable performance levels.

While several encryption schemes are secure under standard scenarios, certain encryption schemes, notably malleable encryption schemes, may present security vulnerabilities when subjected to adaptive chosen ciphertext attacks. Additionally, there are various methods for an adversary to physically attack hardware components to extract information, necessitating additional security measures.

The proposed hybrid approach combines a TEE with FHE to address the integrity weaknesses of FHE, ensuring both confidentiality and integrity. It utilizes the TFHE-RS library, which combines HE with code executing inside a TEE to provide strong security guarantees. The TFHE-RS library operates by processing ciphertexts within a TEE, thereby preventing unauthorized access or modifications to the ciphertext and eliminating the issue of malleability.

Moreover, the research presented here evaluates the performance of TFHE-RS with and without the use of SGX and demonstrates that TFHE-RS with SGX is faster, contrary to initial conjectures, and provides a more secure and efficient solution. This study is significant as it highlights the potential for combining a TEE and HE to achieve a more secure and performant cloud security model.
