For one structure (PDB ID: 7KHH), no PDB entry meeting the first criterion was available. In this study, we estimated the structure of the bound warhead by employing the gnina docking tool with default parameters to dock the warhead into the binding pocket. The resulting complex structure was inspected visually and compared to the corresponding portion of the ternary complex structure. The resulting warhead and binder molecules (only non-hydrogen atoms) were saved in SDF format for input to the BO method. Each of the ten individual single structures of E3 ligase or POI were then preprocessed using specific steps.

The protein structures used in this work are detailed. The PDB ID for each ternary complex, chain identifiers, gene names, PDB ID of the input structure for prediction, chain IDs of E3 ligase and POI, and the first and last residue numbers included in the used models are shown. Additionally, for the PROTAC, the residue ID, ionizable group nature, and net charge used in molecular models are provided.

To determine the structure of the ternary complex, we first acknowledged that the two proteins can interact in various poses. The first step in our pipeline was to sample a set of such poses that are potential candidates for the ternary complex, considering the input POI and E3 ligase as rigid structures. Each pose is characterized by the relative position and orientation of the POI with respect to the E3 ligase. Then, we searched through the space of poses and sampled viable structures for the ternary complex, providing a relatively unbiased estimate of the validity of the protein-protein interaction while allowing rapid evaluation.

The PPI fitness serves to filter out infeasible protein-protein orientations by assigning a low score to RRts that result in steric clashes or where the proteins are too far apart. However, for this approach, manual inspection of the native ternary complex structures indicated that the poses corresponding to the crystal structure did not exhibit high surface contact between the proteins. Therefore, we chose to cut off the DFIRE score at 6, as optimizing the DFIRE score is likely to bias us away from sampling near-native poses.

After preprocessing, the molecular forcefield of the UFF (using RDKit) was employed, with additional constraints on the atoms of the binder and warhead at their docked coordinates. Linker conformations were sampled by minimizing the UFF energy, and the lowest energy constrained conformer was chosen as the output.

The PROTAC fitness is defined as the negative square root of the minimized UFF energy of this conformer, with the PROTAC score calculated without considering the interactions of the PROTAC with the proteins. A neural network model was trained to approximate the PROTAC fitness for a specific RRt due to the computational expense of UFF force-field energy minimization.

The acquisition function of UCB was used in a Bayesian optimization technique to determine the next sampling points, with the iterative process continuing until a list of final valid complexes was obtained. RRts with infeasible PROTAC scores or PPI scores were filtered out, and optimization of the remaining RRts was performed using a combination of the PPI score and PROTAC stability score with simulated annealing.

The refined structures (1000 of them) were clustered using the FCC method, and the clusters were ranked based on size. The clustering threshold was set to 0.5, and the minimum number of elements in a cluster was set to 2.

DockQ scores were calculated for the clustered structures, taking into account both the similarity between the candidate and native model and rigid docking, with higher values corresponding to ternary complexes that resemble the original structure more closely.

The structural refinement of the structures provided by the BOTCP module currently takes about 25 hours but could be further optimized. The current scores and sampling technique can be beneficial in assessing the interactions for a given ternary complex even without structural refinement, suggesting potential for improvement with further optimization.

As mentioned in the introduction, the current work predicts the ternary complex structure effectively under specific assumptions, and future work can focus on incorporating more informative PPI and constraint scores in the BO loop, which could result in significant improvements. Limitations related to input misalignments affecting the PROTAC stability score and the PPI score in some cases were also noted.

In conclusion, the study provides valuable insights into predicting ternary complex structures and identifies potential directions for future research to improve the modeling and assessment of protein-protein interactions.