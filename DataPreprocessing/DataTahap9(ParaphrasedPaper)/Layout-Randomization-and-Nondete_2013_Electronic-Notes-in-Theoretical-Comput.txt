In the field of security, layout randomization is a widely used and effective technique for defending against attacks. Recent research has focused on providing a rigorous understanding of layout randomization within deterministic systems. This paper investigates the use of layout randomization in the presence of non-deterministic choices and proposes a semantic approach based on denotational models and simulation relations. This approach abstracts from language-specific details and addresses the complex interaction between probabilities and non-determinism.

The significance of randomization in security extends to various applications, from probabilistic cryptographic schemes to introducing artificial diversity in low-level software protection. However, developing comprehensive models and analyses for systems employing randomization is challenging due to the inherent difficulty of reasoning about probabilities as well as other complex system features. Some of these features, such as assumed bounds on attacker capabilities and computational complexity, directly relate to security considerations, while others, like non-determinism, arise from the general nature of computational models.

The study is framed using a high-level language with abstract symbolic locations and a low-level language where these locations are mapped to random natural-number addresses in memory, both incorporating a construct for non-deterministic choice. Models are presented for both languages, and contextual implementation relations are defined for each. These implementation relations are characterized using semantic simulation relations, providing a semantic correspondence between the high-level and low-level worlds.

The emphasis of this approach is on semantic constructions, which, compared to prior syntactic work, can lead to more robust security arguments independent of specific language details. This approach helps reconcile the interaction between probabilities and non-determinism.

The paper also discusses the limitations of previous work and introduces a more sophisticated model that includes random variables and focuses on the interaction between non-deterministic and dependent probabilistic choices. The potential applications of this approach in security analysis beyond layout randomization are also highlighted.

In addition, the paper presents a lower-level language that uses concrete natural-number addresses for memory operations, along with the corresponding denotational semantics, operational semantics, contextual implementation relations, and simulation relations.

The paper concludes by pointing out the potential for future work in extending this approach to other areas of security analysis, such as concurrency with non-deterministic scheduling and higher-order computation.