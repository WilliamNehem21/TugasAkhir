In this paper, we consider a facility location problem where customer demand consti- tutes considerable uncertainty, and where complete information on the distribution of the uncertainty is unavailable. We formulate the optimal decision problem as a two- stage stochastic mixed integer programming problem: an optimal selection of facility locations in the first stage and an optimal decision on the operation of each facility in the second stage. A distributionally robust optimization framework is proposed to hedge risks arising from incomplete information on the distribution of the uncertainty. Specifically, by exploiting the moment information, we construct a set of distribu- tions which contains the true distribution and where the optimal decision is based on the worst distribution from the set. We then develop two numerical schemes for solving the distributionally robust facility location problem: a semi-infinite program- ming approach which exploits moments of certain reference random variables and a semi-definite programming approach which utilizes the mean and correlation of the underlying random variables describing the demand uncertainty. In the semi-infinite programming approach, we apply the well-known linear decision rule approach to the robust dual problem and then approximate the semi-infinite constraints through the conditional value at risk measure. We provide numerical tests to demonstrate the computation and properties of the robust solutions.

The aforementioned models share certain characteristics such as single-period plan- ning horizon, single product and facility type, and deterministic parameters (i.e., demands, supplies, and costs). However, the deterministic assumption is one of the major drawbacks in coping with many real-world problems. The strategic decisions on facility setup are often capital-intensive, non-repetitive, and span a long time hori- zon. The decision has to be made at present and hence is subject to risks arising from uncertainties in demands and operations of the established facilities. Hedging the risk, therefore, becomes a vital component of the decision-making process. The facility location problem under uncertainty has attracted considerable attention recently; see, for examples, reviews in Owen and Daskin (1998), Snyder (2006) and Lim et al. (2010). Two major frameworks used to model uncertainty in the facility location problems are stochastic optimization and robust optimization.

In the first framework, stochastic optimization has long been a well-known mathe- matical method for finding optimal decisions under uncertainty. A key assumption in this approach is that the decision maker has complete information on the distribution of the uncertainty, through either empirical data or subjective judgment. However, in some circumstances, this might turn out to be difficult if not impossible when a strategic decision has to be made well in advance of the realization of the uncertainty. In the second approach, the robust optimization framework, no assumption is made on the probability distribution of the uncertainty. The traditional proposed measure of

We then proceed with discussions on numerical schemes in the following two consecutive sections for solving the robust model depending on the availability of information on the distribution of demands: a semi-definite programming (SDP) scheme in Sect. 3 and a semi-infinite programming (SIP) scheme in Sect. 4.

There is a vast body of literature on the deterministic facility location problem. A good review of the related literature is carried out by Owen and Daskin (1998) and Daskin (2011). Suppose there are up to n facilities to be opened in a set of possible locations I = {1,..., n}, indexed by i . Let J = {1,..., m} be the set of customers, indexed by

In this section, we first formulate the (R-FLP) problem as an integer semi-definite program in Sect. 3.1. The resulting model, however, has a large number of SDP con- straints in addition to the inherent binary variables for the facility location decisions. We propose to resolve the integrality issue by using a generic genetic algorithm in Sect. 3.2 and the large number of SDP constraints by using a row generation algo- rithm in Sect. 3.3.

The issue of having binary variables z is unavoidable as this is an intrinsic part of the facility location problems, even in the deterministic case. For practical purposes, we utilize a genetic algorithm (GA) to search for the optimal facility location variables. To this end, we rewrite Problem (3.16) in a compact form on decision variable z as follows,

Having defined the LDR formulation of the original robust semi-infinite problem, we approximate the first semi-infinite constraint with Conditional Value at Risk (CVaR) and then approximate the latter through Monte Carlo sampling to reduce the number of constraints. One of the main advantages of using CVaR is that it converts the semi- infinite number of constraints into a single constraint. A recent study by Anderson et al. (2014) has shown promising performance of CVaR approximation in dealing with semi-infinite problems. The CVaR approximation method has been extensively used in stochastic programming for approximating the chance constraints, and we refer the readers to Sun et al. (2014) and Hong et al. (2011) for more details.

This kind of discretization scheme was recently applied to a distributionally robust formulation of a two-stage stochastic unit commitment problem. From a mathemat- ical perspective, it is justified in that under some mild conditions, one can show the convergence of the optimal value of the discretized problem to its true coun- terpart almost surely as the sample size increases, see details in (Xu et al. 2018, Sect. 3.1).

The deterministic solution is to install just enough capacity to meet the predicted (assumed to be known) demand values by locating facilities 1 and 2. In other words, the D-FLP solution provides no flexibility for possible variation in future demand. The robust solutions, on the other hand, offers to install the facilities with a higher total capacity at a higher total cost (i.e., constructing facilities 2 and 3 in the R-SDP

It can be observed that, for each sample size, the mean deviation of R-CVaR and R- LDR solutions from the true robust solution is very similar. They range from -0.4% to 0.9% of the true solution. (Here 0.9% deviation means that the approximate solution is 0.9% higher than the true value of the robust solution.) We can also see that the sample approximation of R-CVaR and R-LDR converges to the full R-LDR solution as the sample size increases. Furthermore, the sampling method applied to R-SIP provides a very good approximation of the true solution even for small sample sizes.

when a maximum of 100 SDP constraints are added or when the additional constraints do not lead to more than 0.1% changes on the objective value in the 5 consecutive iterations. Second, the number of iterations in the alternating procedure for finding violating constraints is set at most 100 iterations. We implement the constraint genera- tion and utilize the built-in Matlab GA algorithms with mostly default settings except that the GA population size is set to 30 with stopping criteria of a maximum of 10 generations. The population size is the number of solutions under consideration at any point by the GA algorithm to perform various operations in order to produce further solutions. The parameters are set to balance between the run time and the quality of the solutions. All the numerical tests are run in MATLAB R2015b utilizing SeDuMi and Cplex LP solvers version 12.6.

In order to verify the performance of GA, we compare its solutions with the exhaustive search technique where the objective values for every combination of z are evaluated in order to find the optimal solutions. This exhaustive search is only doable when n is small enough, i.e., n = 10 in the first 6 instances. We found that the solution obtained from GA matched the optimal solution in the first 5 instances while the optimality gap for instance p6 is quite small at 1.5%.5

It can be observed that R-SIP offers a more flexible solution by installing a higher level of supply capacity. This, of course, comes at the expense of a higher total expected cost. Also, as we include progressively less information on the uncertainty in our models, the solution becomes more and more robust (higher levels of supply capacity installed), which is intuitively sensible.

It can be observed that, in all models, the sampling scheme results in approximation of the true robust solution (R-SIP) with a very low error (with < 3% mean deviation). Moreover, in the case of smaller sample sizes, the CVaR model performs much better than the other two models and has a mean deviation of < 0.5%.

In this paper, we consider a capacitated facility location problem with customer demand uncertainty and propose a two-stage distributionally robust model for the problem to tackle the issue of incomplete information on the true distribution of the uncertainty. We construct the uncertainty set using the moments information associated with the distribution of the random demands. Two numerical methods are proposed based on the available moment information. Specifically, we first formulate the robust problem as a semi-definite program on the basis of the first and the second moments which is then solved by using a constraint generation algorithm. Moreover, we for- mulate the robust problem as a semi-infinite program for the case that only the first moment information is given. The semi-infinite program is then solved by approxima- tion using a linear decision rule, CVaR and Monte Carlo sampling. Finally, we carry out numerical tests for a small instance and also for some medium-sized instances taken from the literature. In each case, the distributionally robust solutions offer the flexi- bility in hedging against uncertainty compared to the deterministic and the stochastic solutions.

In the future, it would be interesting to study the possibility of extending the results and methodologies presented in this paper to include uncertainty in supply, multistage problems, and the competition in the market. Also, we would like to explore the problem structure to enhance the solution algorithms for a better performance in large- scale instances. Another open direction is to apply the proposed methodologies and numerical schemes to the practical problems with similar structure and characteristics such as uncertain supply and demand. Some examples related to the energy industry could include the wind farm site location problem and liquefied natural gas storage facility location problems.

