Cloud computing solutions have received much attention in recent years [1] as it offers cost-effective on-demand computing resources based on the pay-as-you-go model. The explosive growth of cloud usage results in high energy usage by the CDCs, it is estimated that data centers use around 1% of worldwide elec- tricity [2]. This high energy consumption creats serious challenges for energy management in CDCs.

Many studies in recent years have focused on DVMC as a good way to overcome energy consumption challenges in CDCs without violating service level agreement [3], whereas, little attention has been given to consider the negative impact of DVMC on security. As demonstrated in [4] DVMC saves energy through migrating run- ning VMs from underloaded hosts to other active hosts without overloading them and switching the underloaded hosts to low power state mode. Hosts in low power state mode consume a neg- ligible amount of power while it can be activated in negligible time, the transition delay is 300 ms. While, DVMC saves QoS through keeping running hosts not overloaded by monitoring resource utilization migrating out some VMs from overloaded hosts to other hosts. However, consolidating multiple VMs belong- ing to different users on the same PM sharing its resources leads to new kinds of security risks. Luigi et al. [5] have shown that risky VMs can be stepping stones for attacking the host hypervisor and the other co-resident VMs. So, how the running VMs are dis- tributed among PMs in the CDC has a significant impact on cloud

security as well as the energy consumption and the QoS produced to cloud consumers. Hence, there is a need for more research that considers security as well as energy and QoS. Furthermore, security concern demands a security assessment model to distinguish between VMs with different risk degrees.

To this end, this paper uses a three-dimensional security assess- ment model and proposes the SDVMC approach. For any VM the security assessment model considers the security risks experi- enced by the VM itself, risks experienced by its direct communi- cated VMs, and risks experienced by its collocated VMs to provide an overall metric that represents the overall security score of that VM. While SDVMC consists of two main modules SMM and SDVMC module. The SMM utilizes the three-dimensional security assessment model to continuously monitor and update the secu- rity scores for all VMs in the CDC. While the SDVMC module divides the problem of DVMC into four subproblems host under- load detection, host overload detection, VM selection, and VM placement. For VM placement, based on the VMs security scores and according to the security assessment model, we proposed a novel MRI with a RITH VM placement algorithm that aims to select the host that leads to the minimum risk increase and avoid break- ing the RITH constraint for any of its VMs.

We used CloudSim [6] to evaluate the proposed approach. Although CloudSim is a well-known and dependable cloud simula- tor, we have found a need to make little effective modifications to its default Power-Aware Best Fit Decreasing order (PABFD) VM placement and the power model for the used PMs. These modifica- tions have enabled us to get more accurate insights when compar- ing our approach with other approaches that utilize the PABFD VM placement. Simulation results showed that the proposed approach gives high-level security improvements through trading off between energy consumption and the overall security. Moreover, we can get low-level security improvement without any negative impact on energy consumption and QoS.

Jin Han et. al. [14] extended previous work [10] and proposed a security assessment model that considers the vulnerabilities of the hypervisor, network connections between VMs, and the effect of co-resident VMs. And proposed a multi-objective VM Placement approach using Genetic Algorithms (GA) to provide better intrusion resilience, resource utilization, and network performance. However, their work only considers static VM placement. Moreover, DVMC is an online-time sensitive problem, and using multi-objective GA for large solution-space problems is highly time-consumed.

This paper uses a security assessment model based on [14] and proposes an SDVMC approach that consolidates the running VMs into the minimum number of hosts that keep the absolute value of the risk increase for each VM over its ideal overall risk score without colocation with other VMs does not exceed a maximum value defined by a RITH. Also, our SDVMC aims to result in a min- imum overall mean risk with the same RITH constraint. The used security assessment model and the proposed SDVMC are presented in Sections 3.1 and 3.2.

SDVMC module. The SMM periodically measures and calculates the security risk scores for all VMs according to the proposed security assessment model. Additionally, after each VM migration, new VM placement, or after any changes to the direct communication net- work of any VM, SMM updates the security risk scores for all VMs that can be affected by these changes. Also, SMM calculates and saves the ideal overall risk score (idealR) for each VM. For VM

hosts. For each host, if it is possible to migrate out all of its allo- cated VMs to other active hosts, it will be switched to inactive. For VM placement we proposed a novel MRI with RITH VM place- ment algorithm.

Our proposed MRI with RITH VM placement algorithm seeks to select a host to allocate the coming vm with four main objectives. First, the selected host should have enough resources to allocate the coming VM. Second, at each VM placement, the absolute risk increase for the coming VM and for each vm in the host that will allocate it should not exceed the value of the RITH. Where the

5.1. Second, we evaluated the impact of the RITH, simulation results are in 5.2. However, to get more accurate results CloudSim was examined before we evaluate our approach and there was a need to perform little modifications to its power estimation pro- cess and to its default PABFD VM placement which is utilized for comparison in our evaluation. These modifications are discussed in Section 4.3.

CloudSim uses a power model for each host type to estimate the energy consumed by its hosts for a specific period, also this power model is used at each VM placement to calculate the power increase if a host is selected to allocate the underlying VM. How- ever, when calculating the power increase at VM placement, hosts with zero utilization are assumed to be active and consumes power as if it is in the idle state. This way in estimating power increase for hosts with zero utilization in some cases leads to selecting hosts with zero utilization while there are other active hosts with non- zero utilization that can allocate the candidate VM. In contrast, when measuring the energy consumed by all hosts for a specific period, CloudSim assumes that hosts with zero utilization are in an inactive state with zero power consumption, however, these

Using the workload data as explained in Section 4.5, and given the experimental design mentioned in Section 4, we conducted extensive experiments to evaluate the performance of the pro- posed solution. Our results are presented and discussed in the fol- lowing subsections.

Results also showed that by increasing the number of isolated security groups, energy consumption was getting larger where MeanR and SLA were getting smaller. Moreover, SDVMC using MRI VM placement without RITH with three isolated security groups resulted in better MeanR results from DVMC using the modified PABFD VM placement with any number of isolated security groups, up to ten security groups. Additionally, the results showed that the least values for the MeanR were 96.5%, 94.9%, and 87.5% for the workloads with maximum allowable communications of 8, 4, and 0 respectively, which were achieved by our SDVMC approach.

This paper presents an SDVMC approach that considers energy consumption, QoS, and security. The proposed SDVMC consists of two main modules, SMM that utilizes a three-dimensional assess- ment model, and SDVMC module which utilizes the proposed MRI with RITH VM placement algorithm. From simulation results, we conclude the following findings. First, SDVMC using MRI with RITH VM placement algorithm with a value 0.8 for RITH gives limited security improvements without affecting the energy consumption or QoS, for our defined workload cases the risk reduction ranged from 2% to 5%. Second, SDVMC using MRI with RITH VM placement algorithm with a value less than 0.8 for RITH enables tradeoff between energy consumption and the overall security risk, for our defined workload cases the maximum risk reduction ranged from 10% to 40% with energy consumption less than half of a

