In this paper we investigate an extension of XQuery for querying (and inferring) from RDF documents. Following a graph based approach for specifying queries against RDF, XQuery is extended with construction of answers and boolean predicates for RDF entailment relationship inference. We will also study how to implement it in logic programming by using logic rules for executing RDF/XQuery queries.

XQuery [27,8] is a typed functional language devoted to express queries against XML documents. It contains XPath 2.0 [26] as a sub-language. XPath 2.0 supports navigation, selection and extraction of fragments from XML documents. XQuery also includes expressions to construct new XML values and to join multiple docu- ments.

In recent papers [2,3,1], we have proposed a logic programming based imple- mentation of the XPath and XQuery languages. Such implementation allows to express XPath and XQuery queries in logic programming. With this aim XML documents are translated into a logic program by means of facts and rules, and an XPath/XQuery query is executed by specializing the logic program representing the input XML document and generating one or more specific goals for the query. From the computed answers for the goals we are able to rebuild the output XML document.

It allows the querying of RDF/XML documents but also the construction of the answer by means of an XML document. In particular the answer could represent the serialized version of a RDF document. Therefore we are able to work with XML/RDF documents as input and as output.

In addition, we will present how to implement such extension of XQuery in logic programming. With this aim we have to represent RDF documents in logic pro- grams, and we have to define logic rules for inferring information from RDF statements. Finally, we have to describe how to translate XQuery expressions involving RDF queries into logic programming.

XQuery can be adapted to the handling of RDF documents by means of some kind of serialization of RDF documents in XML. Such serialization allows queries on RDF documents to be expressed by means of (extensions of) XPath. This serializa- tion has been followed in previous proposals [18,28,9,21,13] on extensions of XPath, XQuery and XSLT for RDF. However, in our opinion, we can define an extension of XQuery by using triple based syntax for representing RDF queries, similarly to SQL-style proposals for RDF [15,16,12]. The advantage of such triple based syntax is that queries do not depend on the selected serialization. Moreover, in most of proposals serialization makes queries are too sophisticated.

On the other hand, one of the advantages of our proposal is that XML/RDF documents can work as input and as output. Some proposals about RDF query languages lack on the construction of the output as new RDF triples. However, our approach generates XML documents as output of RDF queries and therefore it allows the composition of queries. XQuery allows to specify the XML format of the output document and therefore the output can be expressed as an XML document and also as a serialization of RDF.

Finally, we will describe how to implement such extension of XQuery in logic programming. We have described in our previous works [2,3] how to implement XPath and XQuery in logic programming. Therefore we have now to describe how the extension to RDF is achieved.

Firstly, RDF documents can be represented by means of facts. We follow a different approach to [7], because our formalism represents triples with a predicate called triple and a fact for each triple (Subject,Property,Object) of RDF. However, the representation contains only the basic triples and therefore specific rules has to be defined for those entailed by the RDFS semantics.

Each fact for triple represents each triple of RDF. In addition, we have to number each triple (according to the RDF semantics there is no order between RDF triples and therefore any numbering identifying each triple is enough). The use of the numbering will be explained later. With this representation we can write logic predicates for computing RDF(S) relationships. For instance, the transitivity of the rdfs:subClassOf relationship can be computed as follows:

In [3,2] we have shown how to translate XML documents into logic program- ming by means of logic rules representing the inner nodes of the XML document (called schema rules) and facts representing the leaves of the XML document. The translation of XPath and (Non-RDF) XQuery into logic programming consists of the specialization of the schema rules w.r.t. the given query, and the generation of (one or more) specific goals from the given query.

Let us remark that previous queries have been expressed by using the previous syntax. Now, let us proceed with a key point of our translation: the translation of XML documents into a logic program, and analogously, the reconstruction from a logic program of an XML document. With this aim, the following section will show the proposed translation of XML documents in logic programing in the quoted papers [3,2].

Now, the translation of the XML document into a logic program is as follows.  For each inner node in the type and node numbered XML docu- ment < tag att1 = v1,..., attn = vn, nodenumber = i, typenumber = k > elem1,..., elems < /tag > we consider the following rule, called schema rule:

NTagi1 ,...,NTagit are variables (used for representing the last number of the node number of the children); NTag is a variable (used for representing the node number of tag); k is the type number of tag; and finally, r is the type number of the tagged elements elem1,..., elems 6 .

The previous translation has the following peculiarities. In order to specify the order in an XML document each fact is numbered from left to right and by levels in the XML tree. In addition, the hierarchical structure of the XML records is expressed by means of the identifier of each record (the number of the parent) and the length of the number (the children has a larger number). The type number

Let us remark that the output XML document is built using the node and type numbering in which the parent is numbered with a larger number than children. In the example, the essays label is numbered as [1] and the children as [3,1], [8,1], [9,1], [10,1]. With this aim we have numbered RDF triples in Prolog facts.

In the case of Query 4 two attributes have been added to the output document: the namespaces for rdf and books. They are represented as attributes of the schema rules and facts of the output document, following the criteria of the translation presented in Section 4.1.

S. Schaffert and F. Bry. A Gentle Introduction to Xcerpt, a Rule-based Query and Transformation Language for XML. In Proc. of International Workshop on Rule Markup Languages for Business Rules on the Semantic Web, page 22 pages, Aachen, Germany, 2002. CEUR Workshop Proceedings 60.

