Biochemical Space (BCS) has been introduced as a semi-formal notation for reaction networks of biological processes. It provides a concise mapping of mathematical models to their biological description established at a desired level of abstraction. In this paper, we first turn BCS into a completely formal language with rigorously defined semantics by means of a simplified Kappa calculus. On the practical end, we support BCS with translation to BNGL, a well-known practically used rule-based language. Finally, we show the current status of BCS defined for cyanobacteria processes.

In [1] we have shown that rule-based methods can be directly used for rewriting existing kinetic models of oxygenic photosynthesis into a compact non-redundant form obtained by applying a set of automatised syntactic reductions defined in Kappa [4]. That achievement lead us further to employ rule-based definition of biological processes as the framework for qualitative description of the consortium- agreed understanding of chemical reactions behind the processes. Existing quanti- tative models can be then mapped onto the qualitative rule-based BCS.

In [10] we have presented general ideas behind BCS. The language has been de- fined as a semi-formal notation. In this paper, we turn BCS into a completely formal language with clearly defined syntax and semantics (by embedding to Kappa). We

On the bioinformatics side, the closest format to BCS is KEGG [9]. In contrast to BCS, KEGG does not support rule-based description allowing compact represen- tation of combinatorial states. Moreover, it does not support logical organization of entities and reactions into an organism-specific hierarchy that may significantly simplify understanding of the complex processes driving the organisms physiology and its interaction with the environment. Since the notation relies on a simple textual base and focuses on a simple but still reasonably precise and compact de- scription maintainable by biologists, the format of BCS specification is compliant with KEGG.

In comparison with process algebraic languages treating chemical reactions mech- anistically as communicating concurrent processes [2,5], BCS keeps a purely qual- itative level of description closed to chemical reactions and remains as simple as possible to cover the consortium-agreed level of abstraction. The language defined in [16] targets a similar level of abstraction as BCS. However, it is intended more as a programming language for biological systems than an annotation format.

BCS provides well described biological background for mathematical models of pro- cesses taking place in specific organism. Complete BCS model provides a connection between existing ontologies and partial mathematical models. A BCS model is rep- resented in a form of a textual file. This file offers a human readable format of BCS which can be easily edited in a dedicated editor and visualised on the web- site. First part of a BCS model is represented by a set of entities (to be compliant with process-algebraic frameworks we call entities agents), while the second part contains rules (abstractly represented chemical reactions defined over the set of en- tities). In our case study, a consortium of scientists is involved in modelling several cyanobacterial processes and in establishing of the respective BCS model.

The fact that most fields in entity and rule definitions are tightly coupled with information from linked ontologies is the reason why we have started with describ- ing annotation attributes. In the first place, one of these attributes is ENTITY NAME, which is taken from ontologies or follows the standard naming conventions. ENTITY ID of every entity is fixed by the consortium. KEGG ID, ChEBI ID or internal ID is used if no reasonable ID is available. IDs of rules are internal and assigned automatically.

In some cases, emphasis on a detailed description leads to very complex BCS models. Abstraction of some processes is therefore needed to keep BCS models as simple as possible. To this end, rules expressing enzymatic reactions are considered in a simplified form. In fact, there should be at least two different rules describing an enzymatic reaction (one for a substrate binding and another for a catalytic step). Instead, since an enzyme is not affected during the reaction, it is affiliated to the rule as a MODIFIER. However, it is difficult to define precise meaning of a modifier in this case. We rather treat the modifier field informally as an entity which has to be present for the rule to be enabled. The exact reaction mechanism of an enzyme is not always clear and therefore it is abstracted out (see Example 3.4).

Model in BCS is defined in similar way as a kappas model. First, we define syntax of expressions describing agents formally in BCS. Next, the notion of agent signature is defined that allows to specify restrictions on the general expressions. Finally, agents are used as elementary constructs in definition of BCS rules.

Agents are defined hierarchically starting from atomic agents that are of two kinds: class atoms representing (abstract) class agents and object atoms represent- ing (concrete) object agents. Class atomic agents allow us to represent compactly objects that can reside in several selected (or even all possible) states whereas object atomic agents represent concrete objects specified with the particular state. Every atomic agent must be accompanied with a physical compartment within which it is considered.

From now on, we restrict ourselves to atomic agents where the state signature can be treated as a set (a state cannot occur more than once in a state signature). This restriction is motivated by the aim to keep the language as simple as possible. Treating the state signatures as multisets would lead to confusions and is actually not needed to clearly represent biological objects.

Next we proceed with defining structure agents. A structure agent represents a biochemical object that is composed from several known atomic agents provided that we know that such a composition is abstract and not necessarily complete. To incorporate such an abstraction of biological structures into our language, a structure agent is defined to be labelled with a unique name and it is constructed only from atomic agents considered in the same physical compartment.

Note that a compartment of a structure agent is uniquely given by the com- partment specified in its parts. We restrict ourselves to structure agents where all atomic agents in the partial composition have the same compartment. Assum- ing this restriction, we can shorten the notation by omitting compartments in the atomic agents of a partial composition.

In contrast to partial compositions, we allow replication at the level of full com- positions (an agent of a certain name can appear more than once in a full compo- sition). Moreover, names of complex agents are not associated with particular full compositions at the level of agent expressions. This is done at the level of agent signatures (see Section 4.2).

The language of agents defined in the previous section gives us a formal way how to encode biochemical objects at several levels of hierarchy and abstraction. The notion of structure agents allows to generate arbitrary partial compositions. Practically, we need to restrict the construction of composite biochemical objects by giving a set of constraints reflecting our understanding of biological objects and the desired level of abstraction. This can be achieved by assigning every structure agent name

Similarly, the set of complex agents also needs to be restricted by specifying the catalogue of complex biochemical objects that can appear in the considered biochemical space. This can be achieved by assigning every complex agent name with a full composition that provides its definition. This allows us to name biolog- ical compounds, e.g., H2O, and specify their clear definition under the coexistence abstraction, e.g., H.H.O.

Algorithm 1 takes a BCS model M and returns a kappas model M. It uses three subroutines that modify respective types of BCS agents. Algorithm 2 translates an atomic agent directly by extending an agent name with a compartment name and adding a site p. Algorithm 3 translates a structure agent where each atomic agent in its partial composition is encoded as a unique site. Finally, algorithm 4 translates a complex agent where each structure agent in the respective full composition is treated as a kappas agent. Since BCS does not provide binding sites, we fix linear binding (see Section 6 for further discussion).

The last fact that is worth noting is construction of complex structures. In BNGL, each complex is identified with an exact structural notation which does not allow hierarchical construction. BCS provides the notion of structure and complex agents, this allows to form a hierarchy of the agents. Additionally, when defining a rule with quantities of interacting entities, in BNGL it is necessary to enumerate all of them whereas in BCS the stoichiometry is allowed in standard way.

BCS makes a part of CMP and is implemented at e-cyanobacterium.org and cur- rently covers several functional modules of cyanobacteria. To support translation between BCS and BNGL, we have implemented a set of scripts 1 allowing to trans- late a BCS model to BNGL and vice versa.

it means the mapping of reactions to rules is almost one-to-one (reaction-like rules). The stringency of rules is high which is what allows them to be applied only to a narrow group of molecules. It causes that compaction of metabolism in rules brings almost no benefits.

Circadian clock is one of the most complex processes in cyanobacteria BCS. Its core is formed by three proteins KaiA, KaiB and KaiC. Moreover, KaiC contains two phosphorylation sites serine S431 and threonine T 432. These sites can be phosphorylated independently, but only if KaiC is in a complex. All these proteins can interact with each other in predetermined ways and form specific complexes. All processes inside the cell are then controlled by periodical formation/dissociation and (de)phosphorylation of these complexes.

Each protein KaiC can occur in four different states because of the two phosphory- lation sites. Considering all six complexes and also other rules in circadian clock, we obtain combinatorial explosion of different species in the system. To achieve repre- sentation of the whole system it is inefficient to enumerate each single conformation. To this end, we employ the capability of BCS rules.

In BCS we have achieved complete, human readable representation of circadian clock using only 17 rules (examples are rules in Example 7.2 and Example 7.3). Regarding the defined agents, it gives us over 500 different distinguishable entities, while in BNGL similar number of rules describing the same system gives us almost 25000 entities.

Photosynthesis represents part of BCS of cyanobacteria. The process occurs in a specific folds of the cell membrane called thylakoid membrane. Photosynthesis serves as the source of energy taken from light and transferred into production of ATP and NADPH molecules with oxygen resulting as a by-product.

Entities of photosynthesis BCS are represented by several complex proteins (enzymes) residing on the thylakoid membrane (tlm) in the cell. Since the thy- lakoid membrane encloses the inner-membrane space called lumen (lum) where H2O molecules are processed, there are basically three locations defined for this set of entities. Rules occurring in the lumen, cytosol and in-between the thylakoid mem- brane and these locations have classical form. However, electron transfer reactions occurring in the structure of complex processes lead to combinatorial explosion of all possible conformations.

Photosynthesis is constructed from approximately 30 agent definitions which are interacting in over 60 rules. From the rule-based point of view, this representation is somewhere between circadian clock (Section 7.2) and metabolism (Section 7.1). It means the number of generated distinguishable entities arises compared to defined agents, but not as dramatically as in circadian clock. However, photosynthesis is a good example of rule-based process.

