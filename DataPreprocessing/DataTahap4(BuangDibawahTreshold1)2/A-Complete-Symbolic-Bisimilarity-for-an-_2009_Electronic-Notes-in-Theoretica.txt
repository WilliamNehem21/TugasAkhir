In [11], we proposed a symbolic structural operational semantics and a symbolic bisimulation for the spi calculus. In this paper, we define decompositions [8,15] of symbolic environments and update symbolic bisimulation to account for this, yielding both soundness and completeness with respect to concrete bisimilarities. Compared to work on symbolic (bisimulation) semantics [14,17] for the applied pi calculus [2], we give a complete proof method in a setting where the operational semantics are finitely branching.

The only purpose of the set SA is to ensure that A(h) is well-founded. If we replaced SA(h) by S (A(h)) in ana the definition would no longer be inductive, since we would a priori need to argue about the presence of certain expression pairs in A(h) before applying the rule. Indeed, for all hedges h, SA(h) = S (A(h)).

A symbolic environment is a concise description of a set of hedges, differing only in the instantiations of variables. Here, a variable instantiation is a pair of substitu- tions, that must respect the symbolic environment. The hedges that we get from instantiating variables in an environment-respecting way are called concretizations. The symbolic environments used in this paper are very similar to the ones in [11], with the only difference that we keep explicit track of fresh names. A symbolic environment consists of the following three elements.

From here on we only consider well-formed symbolic environments, the set of which is denoted SE. By instantiating the input variables of the symbolic envi- ronment, we can get a concrete (non-timed) hedge. However, such an instantiation must be subject to several constraints, e.g., timing, guard satisfaction and freshness of invented names. For instance, an input performed at time t must be synthesizable from the knowledge of the environment at that time. Similarly to the symbolic early input semantics, we define environment respectfulness for substitutions. Naturally, with the bisimulation environments we need two (possibly different) substitutions, one for each process. We also create some fresh names B.

