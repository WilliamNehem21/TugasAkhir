The time-dependent model can solve efficiently the earliest arrival problem by reducing it to a shortest path computation on G, under the assumption that a transfer from one train to another can be performed in zero time [1]. However, this is clearly not a realistic assumption. Moreover, this model cannot solve the minimum number of transfers problem, since even if we keep track of when there is a transfer and use for each edge the event that avoids having a transfer instead of the earliest one in time, it will not provide us with the optimal solution. When we have no other option but to make a transfer, there is no way to choose the best event among all possible ones.

The rest of the paper is organized as follows. In Section 2, we present the original time-dependent model and discuss the solution of the EAP with zero transfer times. In Section 3, we present our modelings through platform and train route information for the realistic version of EAP with constant or variable non-zero transfer times. The modeling and solution to the MNTP is provided in Section 4, while Section 5 discusses the solution to the combination of EAP and MNTP. Section 6 presents several heuristics that speed up com- putations of edge costs. In Section 7 we present our preliminary experimental results, and we conclude in Section 8.

The correctness of the above modeling can be seen as follows. No two trains can be at the same platform at the same time. Furthermore, the time interval, from the moment that a train arrives at a platform until the moment that the immediately next train that stopped at the same platform departs, is sufficient for a passenger that arrived with the first train to step down and get on the second one. This means that if the information concerning the platforms is available, then the above model can solve the EAP with respect

briefly mentioned in [1]. Again, let G = (V, E) be the new graph model whose node and edge sets will be defined in the following. We assume that we are given a set of train routes and their respective time schedules.

Assumption 3.3 serves the purpose of ensuring that waiting at stations to take the next train of the same train route cannot be beneficial. In other words, given that Assumption 3.2 holds, taking the first possible train from a station A to some station B will not result in missing some connection from B that could be used if we had followed some train (of the same train route) that departed later than the one we followed. It will be seen later that Assumption

The correctness of the above model is similar to that of its corresponding model based on platform information (cf. Section 3.1.1). Moreover, the algo- rithm given in Section 3.1.2 can also be used to solve the EAP under the new modeling. Its correctness follows again by the non-negative delay assump- tions of f and g, and by the fact that both functions are non-decreasing (f by Assumption 3.2, and g by construction).

We now turn to the correctness of the model. We give a proof for the case where we use the modeling of EAP based on train routes with variable transfer costs (cf. Section 3.2.2). The other case (constant transfer costs; cf. Section 3.2.1) can be proved similarly.

Consider the case of variable transfer costs within the same station. Note that the different time needed for each transfer at some station between the same train routes is caused by the fact that the trains that perform the same route do not stop every time at the same platform of the station. The input regarding the time for the transfers takes into consideration the platforms at which the trains stop. This means that for every event e there must be some information about the first train of every other train route that can be followed. As a result, for the case of variable transfer costs, each edge

that pu was reached by use of e. Having one such pointer very nexte,i' for all pu, we can relax at once the outgoing edges of all nodes of station s belong- ing to R, and thus avoid the relaxation of all other edges (not in R) among those nodes. This means that we no longer need to store any other informa- tion regarding these latter edges. Note also that the same traine pointer is very nexte,i so same train pointers need not be stored explicitly either.

The implementation for the original time-dependent model uses binary search and it was written using the LEDA parameterized graph type. The implementation for the extension with train routes contains the index values at the route nodes, as described in Section 6. We have also used a heap-based priority queue that bears a great resemblance to the lazy variant of pairing heaps (see [2]). Special care has also been taken to avoid the initialization steps to both models at the beginning of each query.

