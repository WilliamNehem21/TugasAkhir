Abstract The concept of matched filter is widely used in the area of retina vessel segmentation. Multiscale matched filters have superior performance over single scale filters. The proposed approach makes use of the improved noise suppression features of multiscale filters. A major per- formance issue here is the determination of the right parameter values of the filter. The approach employs particle swarm optimization for finding the optimal filter parameters of the multiscale Gaussian matched filter for achieving improved accuracy of retina vessel segmentation. The pro- posed approach is tested on DRIVE and STARE retina database and obtained better results when compared to other available retina vessel segmentation algorithms.

Early methods of vessel segmentation were based on matched filtering [16]. It is based on the assumption that inten- sity profile along a cross section of a vessel has the shape of Gaussian. A set of 12 Gaussian shaped filters are used to match the vessels at different directions. For each pixel, the

Later, many extensions of matched filter are used, such as matched filter (MF) combined with pulse coupled neural net- works as discussed in [17]. Otsu algorithm [18] is used to obtain segmentation results. Improvement of the matched filter response by Ant colony algorithm is proposed in [19]. Zero mean Gaussian matched filter with first order derivative of Gaussian filter is proposed in [20]. MF has high response for true vessels and non-vessel but the local mean of its response to the First-order Derivative of Gaussian (FDOG) will also be high. Scale selection of matched filter is very important. Empirical estimation of scale selection is done by Chaudhuri et al. [16], simple optimization is done by Al-Rawi et al. [21], and genetic algorithm based optimization is performed in [22]. In [23], a new kernel function, Cauchy PDF is used as a substitute for Gaussian kernel for segmentation and authors

Usually vessel width is varying across the retina fundus images from 15 pixels (very large vessels) to 3 pixels (small ves- sels) [24]. Thus, simultaneous detection of vessels of different width is very difficult. Li et al. [24] claim that the performance of multiscale matched filter is better than single scale approach. The response of multiscale filters depends upon the selection of scales of the filters. However, the selection of the right values of parameters of multiscale matched filter is a difficult task for achieving good results.

The main problems in vessel segmentation are poor quality images, local intensity contrast of vessels and variations in the width of the vessels. Small vessels are overwhelmed by differ- ent noises like Gaussian. This makes the accurate segmenta- tion a challenging problem. This paper proposes to employ multiscale filter for vessel segmentation, and to address the parameter value selection problem in multiscale matched filters.

Organization of rest of this paper is as follows: Section 3 presents a brief introduction about the retina database used, matched filter, multiscale matched filter and basic particle swarm optimization. The implementation details of PSO based multiscale Gaussian matched filter are described in Section 4. Experimental results of the proposed method on image data- sets and discussions are given in Section 5, and finally the paper is concluded in Section 6.

Matched filter (MF) is the most widely used template matching algorithm for retina vessel segmentation. It was first proposed by Chaudhuri et al. [16]. Here, we used the prior assumption that the cross section of the vessels can be approximated by a Gaussian function.

The filter has only a few filter parameters to adjust to achieve good performance for every application. Though the technique is very simple, it responds not only to vessels but to non-vessels too. As it is a commonly used useful approach, improving its performance is highly desirable.

In this work, we proposed a new optimization method to find the matched filter parameters to increase the performance of the matched filter, i.e., to find better filter parameter values for L, r and T. Direct estimation of parameters will not result in good detection. Empirical estimation is done by Chaudhari et al. [16], simple optimization is done by Al-Rawi et al. [21] and genetic algorithm based optimization is performed in [22]. Here, we used PSO optimization technique and better per- formance is achieved. Matched filter with two scales is used. Large values of scale are used to detect big vessels and small values are used to detect small vessels.

Swarm intelligence based optimization algorithm was intro- duced by Kennedy and Eberhart [25] in 1995. The algorithm mimics the social behaviour of fish schooling or flock of birds known as swarm. Particles mean individual swarm members which is a solution. Every particle has fitness depends upon the problem to be solved. At first, optimal fitness value is not known by any particle. The algorithm operates iteration

by iteration and output in each iteration is compared with local best and global best. Global best solution of a particle, gbest is computed with swarm and local best of a particle, pbest is computed by self. In every iteration position and velocities are updated by (7) and (8) and are repeated until some convergence criterion is met. Convergence criterion also depends on the problem.

The proposed approach makes use of multiscale filter described in the previous section for segmentation of retina vasculature to detect vessels. PSO is employed for computing the parameters of multiscale filter. The images in the database are used for determining the optimal values of parameters.

Filtered output image is obtained by applying matched fil- ter with parameters {L1, r1 and T1} and {L2, r2 and T2} to input fundus image f. This, filtered image is binarized with dif- ferent threshold values range from 0 to 1 incrementing by 0.05. Several binary images are thus obtained as results of threshold- ing. The ground truth image provided by the database is used for computing performance of vessel detection.

The plot of the false ratio versus the true ratio provides the ROC, and the area under the ROC is used as the fitness func- tion of this PSO optimization. The individual will be selected based on the highest area under the ROC. In the case of perfect detection, area under ROC will be one.

Background subtracted image is generated by median filter of large size. The pixels present in both background subtracted image and matched filter output image are taken as the actual output pixels. Small pixels are removed to avoid the false detection of vessels.

We implemented the proposed method in MATLAB 7. 12. 0 and evaluated the performance of the improved Gaussian multiscale matched filter on DRIVE and STARE database. Best filter parameters are found by using the first image of the database as the input of the optimized matched filter. As PSO optimiza- tion involves different random operations, same output filter parameters may not be obtained even if we reinitialize and run the program again with the same parameters and inputs.

