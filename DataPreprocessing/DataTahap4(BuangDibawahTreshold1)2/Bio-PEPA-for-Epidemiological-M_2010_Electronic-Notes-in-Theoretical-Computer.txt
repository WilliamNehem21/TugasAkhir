The outbreak and spread of epidemics have been studied for many years and many models have been defined in order to describe the evolution of a population infected by one or more diseases [1,2,25,6,23,8,18]. The modelling of diseases is helpful to understand the mechanisms for their spread, to predict the future course of an outbreak and to evaluate strategies to control it. The possibility to predict the evolution of the disease can help scientists to evaluate plans to handle it and may have a significant impact on the extinction (i.e. eradication) of a particular epidemic.

Process algebras were originally defined in the context of concurrent systems in computer science. They offer a formal model of a system in terms of interacting components, and support a compositional approach to model construction. From the perspective of epidemiological modelling they offer the possibility of describing the individuals in the population as distinct components with precise specifications of the interactions between them. Recently, there have been several explorations of process algebra modelling in the epidemiological context [33,28,27,4,7]. Most of these have focussed on the derivation of ODE-based models from the process algebra description, and stochastic simulation is considered only in [4]. Furthermore, simple epidemiological models are presented in these papers.

We apply our variant of Bio-PEPA to modelling and analysis of epidemiological models for avian influenza [19], based on different assumptions about the spatial structure and the kind of treatment given (i.e. prophylaxis or introduction of a drug). Specifically, we start by considering a simple model describing the disease

The rest of the paper is structured as follows. An introduction to epidemiological models and a description of Bio-PEPA for biochemical networks are reported in Sect. 2 and Sect. 3, respectively. The variant of Bio-PEPA for epidemiological models is introduced in Sect. 4. In Sect. 5 the Bio-PEPA systems describing three models concerning the avian influenza are presented and some analyses are reported. Finally, in Sect. 6 we report some concluding remarks.

There is a vast literature of models describing populations infected by one or more diseases [1,2,25,6,23,8,18]. These models differ from each other in terms of the dynamics in the absence of disease (i.e. the total population can be constant or birth and death rates can be prescribed by some laws) and in terms of assumptions about the infection. For instance, the disease can be transmitted directly by contact with an infective individual or through a vector, and it can be assumed that offsprings of infected parents can be born infected or not. Furthermore, there is a distinction in terms of the number of diseases active in a population and the relationship between them.

With respect to a disease, the population can be divided into classes: susceptibles (S), those who are infective (I) 3 and those who have recovered and are immune (R). In addition to these, we can have other classes, describing, for instance, symptomatic or asymptomatic infectives, treated, untreated or immune individuals. According to the kind of disease and the classes in which the population is divided, the following classification of models has been proposed: SI, in which susceptibles can be infected but do not recover, SIS, in which infectives can recover and become susceptible again, SIR, in which infectives can recover and remain immune to the disease and SIRS, where infectives can recover and recovereds can become susceptible again. More complex models are obtained by considering other classes and assumptions.

the epidemic. The term metapopulation is used to indicate a population distributed over a number of patches or subpopulations, i.e. groups of hosts in the model. Individuals can migrate from one patch to another and this can be described by a migration matrix, that determines the topology and the strength of the connections between the patches. The dynamics of a metapopulation are a function of both within-population dynamics and among-population dynamics.

In this section we give a short description of Bio-PEPA [15,16], a language that has recently been developed for the modelling and analysis of biochemical systems. The main components of a Bio-PEPA system are the species components, describing the behaviour of each species, and the model component, describing the interactions between the various species. The species initial amounts are given in the model component.

Events are constructs that represent changes in the system due to some triggering conditions. This allows biochemical perturbations to the system to be represented, such as the timed introduction of reagents or the modulation of system components by external stimuli. A Bio-PEPA event has the form (id, trigger, event assignment, delay), where id is the event name, trigger is a mathematical expression involving the components of the Bio-PEPA model and/or time, event assignment is a list of assignments causing some changes to elements in the system, and delay is either 0 (immediate events) or a positive real value (delayed events). Events are added to the language as a set of elements and the rest of the syntax is unchanged in order to keep the specification of the model as simple as possible. Furthermore, this approach is useful when the same biochemical system is studied under different experimental regimes as the list of events can be modified without any changes to the rest of the system.

Locations represent both biological compartments and membranes. They form a static hierarchy (i.e. they have a fixed structure) but they can change size with time. The notation C@L indicates that the species represented by the component C is in the location L. If we have just one location, it is treated implicitly and we simply write C. The locations are defined as follows.

A Bio-PEPA system is defined as previously (i.e. Def. 3.2). The operational semantics for this variant of Bio-PEPA differs from the one reported in the previous section only in the axiom describing modifiers; specifically, the axiom prefixMod is replaced by the following:

Below we report just some observations, the interested reader is refered to [16] for details. The mapping from a Bio-PEPA model to the corresponding systems of ODEs is the same as for the standard Bio-PEPA [16], except for a small change to take account of the new generic modifier with two multiplicity coefficients. The mapping to stochastic simulation is identical to the one proposed in [16], but the conversion from concentrations to number of individuals is not necessary since the model is already expressed as numbers of individuals. Finally, the mapping to CTMC with levels and to a PRISM model [31,26] are identical to those for standard Bio-PEPA [12] with the addition of the case of species present on both side of a interaction due to the new generic modifier. Species are represented in terms of levels, but here, differently from [12], each level abstracts an interval of integer values instead of an interval of concentrations, since the models are expressed in terms of number of individuals. Given a species amount, the corresponding level is derived by dividing the amount value by the step size H. The step size expresses the granularity of the system. The information about the step size is contained in the set N . A maximum amount (MMax) is assumed for all the species. This allows us to have a finite CTMC and therefore guarantees that the CTMC-based analysis is feasible.

The basic model is an SIIsR model: we have susceptibles (S) who can be in- fected by direct contact with infectives and infectives who can recover (R). The infectives can be of two types: I, asymptomatic, and Is, symptomatic. Both are infectious, but their infectiousness varies, and only those who develop clinical symptoms will be treated, when treatment is provided.

The Bio-PEPA model for the SIIsR model with single location in Sect. 5.2 is extended in order to consider a location for each patch, the species for all the locations and the action types for migration between locations. The Bio-PEPA specification of this second model is reported briefly below.

As before, contact between a susceptibles and an infective results in a new infec- tive but now we distinguish different types. Globally, there are 16 possible kinds of contact interactions. If the susceptible S contacts an infective without resis- tance the result is a simple infective I, if S contacts an infective with resistance the result is Ir. For a susceptible with prophylaxis, the contact with an infective without resistance is Itr, whereas if the contact is with an infective with drug resistance the result is Irtr. Similar interactions are defined for all the other cases of infectives. These interactions are described by appropriate transmission rates. The transmission rates for the treated infectives are lower than the usual ones (we assume that they are 30 per cent of the usual ones).

In addition to these interactions, prophylaxis is added at time 1 day after the beginning of the study 7 and involves just the patches with disease. We consider that only a part of the population is subjected to prophylaxis (one third of the susceptibles and asymptomatic infectives). Furthermore, the transmission rates for individuals with prophylaxis is just 30 per cent of the usual one.

In this paper we proposed a variant of the process algebra Bio-PEPA for the mod- elling and analysis of epidemiological models. Bio-PEPA has been shown to be useful in this context: it offers a high level of abstraction and allows us to represent easily features of epidemiological systems, such as complex dynamic laws, abstract spatial structures and changes to the system due to some trigger conditions. These features are represented in Bio-PEPA using functional rates, locations and events, respectively.

Note that there is a vast literature of models for epidemiology and most of them are defined directly in terms of systems of ODEs. However, in recent years there has been some interest in the use of process algebras for the modelling and anal- ysis of epidemiological models [33,28,27,4,7]. In [33,28,27] the WSCCS (Weighted Synchronous Calculus of Communicating Systems) process algebra has been used. In [28,27] McCaig et al. define a systematic mapping from WSCCS to the ODEs generally associated with epidemiological models. In [4] Benkirane et al. devel- oped some PEPA models of disease spread (SIR models with direct and indirect

transmission) and proposed a new mapping from PEPA to ODEs, able to capture some properties of epidemiogical systems. In [7] Bradley et al. applied PEPA to the modelling of Internet worm attacks using the SIR abstraction; analysis was based on the mapping from PEPA to ODEs. In all these cases the models proposed were simple, without spatial structure, and stochastic simulation was used only in [4].

different kinds of analysis can foster a better understanding of the behaviour of the system, and help to discover errors due to the use of a particular solver/simulator [9]. Furthermore the modeller can select the approach that is most appropriate for specific model under study. The first model considered assumed a constant population without spatial structure and treatment. The numerical integration of the associated system of ODEs and the stochastic simulation (average of 100 runs) showed the same behaviour. The system was characterized by a small variability and therefore the ODE solution is a good approximation of the behaviour of the system. For this model, a map to PRISM was also considered in order to formally verify some properties. The results of all the analyses were in full agreement. The other models were characterized by some spatial structure and for them the use of stochastic simulation was essential in order to represent the behaviour of the system. Indeed the subpopulations were characterized by a small number of individuals and the variability in the system was significantly increased. In this case it is not clear that the deterministic fluid approximation offered by an ODE model is appropriate. Future work will concern the study of other epidemiological models in Bio-PEPA, the application of PRISM to the models with spatial structure and the application of further analysis techniques supported by the Bio-PEPA tools, such as sensitivity

