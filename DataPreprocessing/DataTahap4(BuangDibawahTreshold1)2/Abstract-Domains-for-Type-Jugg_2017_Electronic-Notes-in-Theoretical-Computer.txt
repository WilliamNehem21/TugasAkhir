Web scripting languages, such as PHP and JavaScript, provide a wide range of dynamic features that make them both flexible and error-prone. In order to prevent bugs in web applications, there is a sore need for powerful static analysis tools. In this paper, we investigate how Abstract Interpretation may be leveraged to provide a precise value analysis providing rich typing information that can be a useful component for such tools.

The success of web scripting languages such as PHP and JavaScript is also due to their wide range of dynamic features, which make them very flexible but un- fortunately also error-prone. A key such feature is that language operations allow operands of any type, applying implicit type conversions when a specific type is needed. PHP, our example language, calls this feature type juggling.

Type juggling. Thanks to the definitions above, most of our domains already include enough information to handle type juggling. For example, the definition of toBool depends on the set Num0={0,0.0}. In order to define a precise abstract toBool, we should avoid loss of precision when deciding if an abstract value, once

8 Some points in our lattice, such as p`, 0, Kq are redundant (zero has no sign). It is possible to optimise the domains to remove such points, slightly increasing the efficiency of the analysis (although the precision remains the same). We leave investigating that direction to future work.

Semantic operations. We now discuss how abstract operations can leverage the expressiveness of our domain. We give the example of division, which is repre- sentative of the other cases. Since toNum has already been applied by the ab- stract semantics of expressions, we now have to divide two 5-tuples of Val, hence

