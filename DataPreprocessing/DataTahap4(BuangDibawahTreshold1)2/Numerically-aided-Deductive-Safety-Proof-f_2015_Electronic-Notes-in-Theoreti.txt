We demonstrate this rule in a case study on safety verification for a powertrain control system. This system is a simplified model of a control system responsible for maintaining the air-to-fuel (A/F) ratio in a gasoline engine near an optimal setpoint. We describe the overall proof, but primarily describe the role of the forward invariant cut rule to prove that the A/F ratio remains within 10% of the optimal setpoint in KeYmaera.

Numerical methods to obtain forward invariants. We briefly mention some existing techniques to generate safe forward invariant sets. In the hybrid systems community, barrier certificates have been proposed as a Lyapunov-like analysis tech- nique to prove that starting from an initial set of states X0, no system trajectory ever enters an unsafe set U [11]. To discover barrier certificates, we employ a modi- fication of a technique from [12], which uses concrete system executions to generate a series of candidate barrier functions. Our technique, which is based on [8], uses concrete executions to generate a set of linear constraints. The linear constraints are used to construct the series of candidates. The final candidate is verified using a satisfiability modulo theories (SMT) solver that is capable of handling nonlinear theories over the reals, dReal [5].

The system dynamics and parameters were derived from a published model [7] and then simplified, as in [8]. The model consists of a simplified version of the physics of engine subsystems responsible for air intake and A/F ratio measurement, along with a computer control system tasked with regulating the A/F ratio. The objective of the controller is to maintain the A/F ratio within 10% of the nominal operating conditions. The experiment that we model involves an engine running at a fixed speed. The controller has two modes of operation: (1) a recovery mode, which controls fuel in an open-loop manner, i.e., with only feedforward control action, where the system runs for at most 8ms, and (2) a normal run mode, which uses feedback control to regulate the A/F ratio.

The controller measures both the air flow through the air-intake manifold, which it uses to estimate the air pressure in the manifold, and the oxygen content of the exhaust gas, which it uses to compute the A/F ratio. The recovery mode represents the behavior of the controller when recovering from a sensor fault (e.g., aberrant sensor readings or environmental conditions that cause suspicion of the sensor readings). During the recovery mode, the controller has no access to oxygen sensor measurements and must operate in a feedforward manner (i.e., using only the manifold air flow rate). The normal mode is the typical mode of operation,

Conclusion. We demonstrated how to leverage local knowledge of the powertrain control system to propose a set that is invariant and safe. We used the set to apply the forward invariant cut rule to prove a safety property for the system.

