A wireless sensor network (WSN) is an ad-hoc wireless network made of sensor nodes which are able to monitor events (e.g. seismic activity, animals moving in a forest, enemies or intruders entering a monitored area, chemical agents), to process the sensed data and to communicate these data to a central node, the sink. The sink is a powerful base station which gathers data sensed in the network and either processes them or acts as gateway to other networks.

Sensor nodes are typically battery powered, making sensor networks highly en- ergy constrained. Replacing batteries on hundreds or thousands of nodes, often deployed in inaccessible environments, is infeasible or too costly. Therefore, a key challenge in a wireless sensor networks is the reduction of energy consumption. For this reason most of the research in this field is focused on the development of energy efficient media access control (MAC) and routing algorithms.

Nowadays security architectures for sensor networks (see for example [6,9]) im- plement ciphers such as RC5 or Skipjack. These algorithms can be considered secure and efficient in some environments. Nevertheless the current de facto Advanced En- cryption Standard (AES) is Rjindael which is not usually adopted on sensor nodes. Indeed the limited processing and memory resources on sensor nodes, make the Rijndael implementations not efficient and thus slow in running time.

We observe that the performance provided in [7] are in contrast with those pro- vided in [3]. Indeed in [3], RC5 is reported to have a speed higher than Rijndael. All the above experiments have been performed in standalone mode, namely with- out interaction with the OS. Most of the ciphers code used in [7], has been taken from OpenSSL as it is, without any particular optimization for the Eyes platform. This justify a further effort in implementing a Rijndael algorithm for Eyes hardware which is smaller in size and provides reasonable speed performance.

In [5] the authors use an AES implementation, but they do not provide any per- formance evaluation. In [13] the authors quantify the energy cost of authentication and key exchange based on a public-key cryptography on the 8-bit ATMEL AT- MEGA128L microcontroller platform. They also used an AES assembly implemen- tation for symmetric encryption/decryption.

The paper evaluates TinySec performance by experiments. TinySec energy con- sumption, even when used in the most resource-intensive and most secure mode, is a modest 10%, and the low impacts on bandwidth and latency prove that software based link-layer security is a feasible solution for sensor networks. The same authors recognize, however, that end-to-end security mechanisms are still useful in sensor networks and may effectively complement TinySec.

Single shared key. In this case all the nodes in the network are provided with a single shared key. Key distribution is simple, indeed a common assumption is that the shared key is loaded into nodes before deployment. However this mechanism cannot protect against tampering. In other words if an adversary can break a node and access the shared secret, she can eavesdrop on traffic and inject messages in the network.

Per-link key. In this case two nodes share a key if and only if they can commu- nicate, namely if they are neighbors. Thus, each couple of nodes share a distinct per-link key. This implies a quite challenging key distribution mechanism, but en- force an higher security level. Indeed, even breaking a node, an adversary can only eavesdrop traffic directed to the broken node and possibly inject traffic to its neighbors. An evolution of this scheme is group keying which also allows passive participation and local broadcast.

In this paper we present an end-to-end security system based on Rijndael. Our sys- tem can run on top of TinySec; at the moment, we demand message authentication and integrity, to the underlay link-layer protocol. We stress that while TinySec is fully implemented, our work is focused on ciphering messages at application level with Rijndael and generating and exchanging keys.

In the previous sections, we have motivated the choice of Rijndael as our reference encryption algorithm. Rijndael guarantees high security, but in order to build a secure system, we must prevent adversaries from learning even partial information from an enciphered message. The initialization vector (IV) and the mode of oper- ation, have a great impact on the quality of a secure system. In the following, we briefly discuss the use of these two elements in our system.

On the contrary, in our solution we do not modify the message size. We use a standard TinyOS packet, just using two bytes of the payload to store the IV (16 bits). This solution has the benefit of minimizing the impact on the communication layer. Indeed all the operation on the IV are performed at application layer. Fur- thermore observe that since we only work on the payload, we are fully compliant with TinySec.

In our opinion, en-decryption speed is not the main constraint for a secure wireless sensor network scenario. Indeed as long as latency of the WSN communication protocols will be so high (few seconds), we will be allowed to spend few millisecond to encipher a message with the AES algorithm. In this work we have presented an implementation of Rijndael smaller in size than previous implementations (from about 1/3 to about 1/5). However our AES implementation shows reasonable speed performance (slower than RC5 by a factor 2). We plan to extend our work in order to define a fully implemented end-to-end solution and to investigate the energy efficiency of Rijndael.

