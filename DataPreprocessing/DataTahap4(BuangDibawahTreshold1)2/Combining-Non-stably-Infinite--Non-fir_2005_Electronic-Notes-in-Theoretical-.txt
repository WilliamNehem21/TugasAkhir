In a verification context, it is natural to express verification conditions in a many-sorted framework [3]. Very recently, the Nelson-Oppen method has been reformulated and proved correct in an order-sorted framework [10]. To simplify the presentation, we will rather work in a basic many-sorted framework, with disjoint sorts (i.e., without subsorts).

A first-order theory is a set of axioms, which defines a set of interpretations, i.e., the models of the first-order theory. A natural extension is to consider I-theories: an I-theory is an arbitrary set of interpretations in a given many- sorted language. The I-theory corresponding to a first-order theory is the set of the models of the first-order theory. An I-theory may leave some predicates

An I-theory T in the union L of disjoint languages L1 and L2 can be seen as the union of two disjoint I-theories: the restrictions Ti of T to each language Li, i.e., the set of all restrictions to Li of interpretations in T . However, it is more convenient to define the union of I-theories as:

Theorem 2.1 Let I-theory 7 in language L be the union of I-theories 71 and 72 in disjoint languages L1 and L2. For each sort, either 71 or 72 is flexible. Let L be a set of literals on L, and let (L1, L2) be a separation of L according to L1 and L2. Let V be the set of common variables in L1 and L2.

The empty first-order theory in a language L defines the I-theory in which every constant, predicate, and function is uninterpreted, and no constraints are put on the domains. This I-theory will be referred to as the uninterpreted I-theory. It is certainly the simplest one, but it is nonetheless important as it allows uninterpreted predicates and functions to be added to the language of a decidable I-theory.

There are obviously three possible sorts: indices (i, j), arrays (a, b), and elements (e). But some sorts may be merged. It is natural and conservative to consider that the sort of arrays is disjoint from the sorts of elements and indices. 10 However, in numerous practical cases, it may be interesting to

Notice that previous theorem does not mean the I-theory of arrays is not compatible if the array sort is a common sort. It only states that if the array sort is a common sort, then the other I-theory must have a nice property to guarantee they are compatible. For instance, the array sort can be the sort of elements for another array I-theory. Also, the I-theory of arrays is compatible with the uninterpreted I-theory, even if both languages contain the sort of arrays.

This new presentation of the Nelson-Oppen combination scheme enhances the classical scheme in two aspects. First, it handles I-theories, i.e., arbitrary sets of interpretations, not necessarily corresponding to first-order theories. This improvement allows to deal directly, for instance, with the linear arithmetic I- theories for , , with the arithmetic I-theory on , or with I-theories having only finite domains of unbounded size, used, for example in proof obligations issued in the context of verification of parameterized systems. Any quantifier- free decidable first-order language with interpreted functions and predicates corresponds to an I-theory which perfectly describes it.

stably infinite. The second improvement in this presentation is the combina- tion of non-stably infinite I-theories, following [9]. The many-sorted framework allows to combine in practice non-stably infinite I-theories with the I-theory corresponding to the empty theory, and with the (I-)theory of arrays.

A limitation of this combination scheme is connected to the strict many- sorted framework. For instance, it does not allow to consider lists of elements which are either naturals or lists of naturals. Also, it remains to identify all cases where V ' can be safely ignored in Theorem 6. Identifying more theories

