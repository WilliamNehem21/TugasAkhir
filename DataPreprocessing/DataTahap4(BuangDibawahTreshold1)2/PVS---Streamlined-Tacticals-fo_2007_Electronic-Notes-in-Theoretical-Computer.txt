The semantics of a proof language relies on the representation of the state of a proof after a logical rule has been applied. This information, which is usually meaningless from a logical point of view, is fundamental to describe the control mechanism of the proof search provided by the language. In this paper, we present a monadic datatype to represent the state information of a proof and we illustrate its use in the PVS theorem prover. We show how this representation can be used to design a new set of powerful tacticals for PVS, called PVS#, that have a simpler and clearer semantics compared to the semantics of standard PVS tacticals.

In a previous attempt to formalize the semantics of the PVS proof language [5], the state of a proof was recorded by flags that were plainly added to the representa- tion of the proof tree. In this paper, we show how the proof state information can be elegantly modeled by a simple monadic datatype. The datatype and its properties are defined in Section 2. In Section 3, we illustrate the application of this framework to the design of a new set of tacticals for PVS, which we call PVS#. Finally, the implementation of the monadic datatype in PVS# is described in Section 4.

Monads are a popular way to describe imperative features, such as side effects and exceptions, in functional programming languages [11]. The main idea is to view a program P , not as a pure function, e.g., from A to B, but as a morphism from values A to a datatype MB, where MB represents the conjunction of side-effects in P and its return value, which is of type B. Monadic operators, that obey monad laws, are associated to the datatype and provide a way to build and compose programs.

We call proof object the concrete representation of a possibly incomplete proof tree. The formalism presented here makes use of a coarse abstraction of this represen- tation: we only assume that proof objects provide means to distinguish the set of current goals among all open goals. We take X as the type of the proof objects, and x, y, z as inhabitants of X, i.e., proof object variables. We define the monadic datatype MX as follows:

(#catch t1 &optional tag t2) This tactical behaves as t1 if t1 does not raise an exception. Otherwise, if the result is an exception named tag then it evaluates t2. If tag does not correspond to the name of the exception, then the exception is propagated.

The topic of this paper is the subject of ongoing work, including, in particular, the development of new tacticals for PVS#, the meta-theoretical study of monads in proof languages, and its application to other theorem provers. In particular, another implementation of the monadic datatype was already carried out in the Fellowship proof assistant [6]. In the long term, we believe that the concept of monads will play a central role in the design and semantics of proof languages for procedural theorem provers.

