The rest of the paper is structured as follows. Section 2 contains a brief de- scription of CLS and Stochastic CLS. Section 3 gives an overview of Maude and Real-Time Maude and describe the translation of Stochastic CLS into the latter. Section 4 shows the analysis of some examples and of a model of the lactose operon regulation in E.coli. Section 5 concludes the paper with an overview of related work.

Stochastic CLS is the extension of CLS with stochastic rates associated with the application of rewrite rules. More precisely, rewrite rules in Stochastic CLS are enriched with a rate constant that is multiplied, in the semantics, by the number of different occurrences of instantiations of the left hand side of the rule in the term to which the rule is applied. This corresponds to what usually done in chemical kinetics, where the rate of occurrence of a chemical reaction is computed by multi- plying the kinetic constant of the reaction by the number of possible combinations of reactants. Rather than giving the (quite complex) definition of the semantics of Stochastic CLS, we will directly show, in the following, how we compute the rate of application of a Stochastic CLS rule in a Maude specification.

Proof. The implication from left to right follows from Lemma 3.1 and from de- duction rules (r1) and (r4) of rewriting logic that are reflexivity and transitivity rules. The implication from right to left can be proved by induction on the deriva- tion of the transition relation of rewriting logic. The only non-trivial aspect of this

The most followed approach to the stochastic simulation of chemical reactions is the one proposed by Gillespie [12]. Gillespie stated the problem as follows: A volume V contains a mixture of N chemical species S1,... , SN which can interreact through M chemical reaction channels (R1,... , RM ). Given the initial numbers of molecules of each species, what will these molecular population levels be at any later time?

To use the function in our simulation algorithm, we need to define it carefully in order not to make the computation take too much time. Therefore we try to minimise the recursive definition of the function. We start with an idea of grouping parallel composition of similar terms. Let Grouped Terms GT and Base Terms BT be given by the following grammar:

In module SCLS we define data structures needed by the simulation algorithm. The term that models the state of the system is incorporated within class CLSTerm. We also define another class, Admin, that records all variables in the algorithm. We define the SCLS module as follows:

The operators lotka and Adm represent objects instantiated from classes CLSTerm and Admin. The operator ReactionNum represents the number of reaction channels M . The occ function is used to define the propensity of each reaction. The rules initialise1 to initialise100 perform two things: calculating the cu- mulative propensity acum using function sum (which is defined in module SCLS), and initialising the random number generator with 100 distinct numbers. It models nondeterminism in the system by allowing the simulation to run in 100 different behaviours.

The first way to analyse reactions using our approach is to run a simulation of their Maude model. Maude has no features to visualise the result of a simulation. Therefore we try to plot charts representing simulation results, and compare our chart to similar charts from previous works (see [12]).

The above simulation shows that within 1/10 time units (e.g. after 0.0999 time units) the Lotka reactions will stop because the next tick rule execution will increase time so that it is greater than the time limit (1/10 time units). Using attribute a, we can calculate the number of molecules of each reactant that are present at the end of the simulation.

By using the search command, we can check all possible behaviours of the system. We have defined 100 rules to initialise the random number generator with 100 distinct random numbers. This allows Maude engine to explore a state space with 100 different behaviours. Although this approach cannot cover all possible behaviours of the system, it yields a significant sample of behaviours. The following example shows the use of a search command initialised with 4 molecules of S1 and 4 molecules of S2, and limited to the first 10 states where no more occurrences of S2 are available in the system.

Another interesting search command is the find earliest command, which searches for the earliest time when a given state is reached. The following example shows that the earliest time S2 vanishes from a system initialised with 4 molecules of S1 and 4 molecules of S2 occurs within 3/50 time units (e.g. after 0.0563 time units).

We give two examples of model-checking for Lotka reactions with 4 molecules of S1 and 4 molecules of S2 as initial states. The first example shows that S2 will eventually vanish from the system in 1 time unit. The second example shows that the amount of S2 will become eventually less than the amount of S1 in the system in 1 time unit.

We translate the Stochastic CLS model into Maude and analyse it. The simu- lation runs quite fast and produces similar behaviour as the result in the work by Barbuti, Carvagna, Maggiolo-Schettini, Milazzo and Pardini [6]. Our intention in this paper is to show that we can also perform not only chart-based analysis, but can also perform analysis on some logical properties of the system. We show that by analysing two properties of this case study.

The first property is related with the amount of enzymes (beta galactosidase and lactose permease) in the absence of lactose in the environment. The amount of such enzymes (in number of molecules) should always below some limit. Here we show that our model satisfies this property, with 20 as the limit. We use the Maude search command to check whether there is a state where the number of beta galactosidase or lactose permease is greater than 20. The Maude engine shows No solution as the answer, which means that there is no such state.

The second property is related with the amount of of enzymes beta galactosidase and lactose permease in the presence of lactose. We want to show that with the presence of lactose, the number of such enzymes will eventually be greater than 20. Now we use the Maude model check command to verify this property. The result shows that this property holds in our system.

We have proposed an approach to study Stochastic CLS specifications of biological systems by making use of Real-Time Maude. Our approach can be used to analyse a biological system not only by observing the chart representing the simulation result, but also by means of logical formulae. We show the applicability of our approach by verifying two properties of the lac operon model.

For our future work, we are interested to explore more about probabilistic model checking. In this paper we analyse properties that can only have boolean values. It will be interesting to extend the language to support answering queries with numeric values, such as probability of an event occur in a period of time. Currently only queries related with time can be answered, for instance finding the earliest time an event occurs.

Muffy Calder, Stephen Gilmore, and Jane Hillston. Modelling the influence of RKIP on the ERK signalling pathway using the stochastic process algebra PEPA. In Anna Ingolfsdottir and Hanne Riis Nielson, editors, Proceedings of the BioConcur Workshop on Concurrent Models in Molecular Biology, August 2004.

