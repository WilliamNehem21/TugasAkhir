Here the confusion is introduced by the informal use of English: of course h is not actually visible at that earlier point; but the attacker is not obliged to reason in real time. He can just take a whole slew of observations and puzzle them out at his leisure. The point is that he can deduce the value h had at the point indicated, even if that deduction is later.

