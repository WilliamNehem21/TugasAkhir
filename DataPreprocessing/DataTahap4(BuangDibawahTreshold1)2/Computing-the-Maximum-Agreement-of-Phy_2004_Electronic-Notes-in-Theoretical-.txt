Phylogenetic trees have been used in many fields of science to describe how a set of objects (e.g., biological species, proteins, nucleic acids, languages, chain letters, or medieval manuscripts) produced by an evolutionary process are believed to be related [2,15,19]. In a phylogenetic tree, the objects are repre- sented by leaves and common ancestors by internal nodes so that the branching structure of the tree reflects the assumed evolutionary relationships. However, certain evolutionary events such as horizontal gene transfer or hybridization

Recently, various algorithms for constructing and comparing phylogenetic networks have been proposed (see, e.g., [4,11,17,18,21]). Here, we consider the following scenario. Suppose a number of phylogenetic networks, each one de- scribing the possible evolution of a fixed set of objects, have been obtained by applying different construction methods or different clustering criteria to some available data. Furthermore, suppose that these networks do not completely agree because of distortions due to assumptions inherent to the methods used or because of measurement errors. It would then be informative to find a sub- network contained in every one of the input networks with as many labeled leaves as possible since such a subnetwork more likely represents genuine evo- lutionary structure in the data. In this way, one would get an indication of which ancestral relationships can be regarded as resolved and which objects need to be subjected to further experiments.

1 In MAST, the input is a set of leaf-labeled trees and the goal is to compute a tree contained in all of the input trees with as many labeled leaves as possible; see, e.g., [1] or [20] for a formal definition. MAST is also referred to as the maximum homeomorphic subtree problem (MHT) by some researchers.

Given a set = N1, N2, ..., Nk of phylogenetic networks for L, an agree- ment subnetwork of  is a phylogenetic network A such that for some L'  L it holds that A is a subgraph of each of N1 L', N2 L', ..., and Nk L'. A maximum agreement subnetwork of is an agreement subnetwork of  with the maximum possible number of leaves. The maximum agreement phyloge- netic subnetwork problem (MASN) is: Given a finite set L and a set N of phylogenetic networks for L, find a maximum agreement subnetwork of N .

No results for MASN in its general form have appeared in the literature be- fore. On the other hand, the special case of MASN known as the maximum agreement subtree problem (MAST) has received a lot of attention in the last ten years. Below, we summarize some of the most important results known for MAST.

We define the concept of a level-f phylogenetic network in Section 2. Then, in Section 3, we present an algorithm for computing a maximum agreement subnetwork between two level-1 phylogenetic networks in O(n2) time. This is the first polynomial-time algorithm ever for this problem. Our algorithm can be extended to solve MASN for two level-f phylogenetic networks N1 and N2 in O( V (N1) V (N2) 4f ) time (where V (Ni) denotes the set of nodes of Ni), which is polynomial in the input size for any f which is upper-bounded by a

constant. Next, in Section 4, we prove that in the general case (i.e., for level- f phylogenetic networks where f is unbounded), the maximum agreement phylogenetic subnetwork problem is NP-hard even if restricted to just three networks. Finally, we state some open problems in Section 5.

Let N be a phylogenetic network for a finite set L. Recall that nodes with outdegree 0 are called leaves. We refer to nodes with indegree 0 (i.e., the root of N ) or 1 as tree nodes and nodes with indegree 2 as hybrid nodes.

N is said to be a level-f phylogenetic network if every biconnected com- ponent in the undirected graph obtained from N by replacing each directed edge by an undirected edge contains at most f nodes that are hybrid nodes in N . Note that N is a tree if f = 0. If f = 1 then every node in N belongs to at most one pair of merge paths 2 . Moreover, if f = 1 then every hybrid node in N has only one split node and any node in N can be a split node for at most one hybrid node.

Given two level-0 phylogenetic networks (i.e., trees), MASN can be solved in O(n log n) time by using the algorithm in [5] or [14]. In this section, we consider how to compute a maximum agreement subnetwork of two level-f phylogenetic networks for f > 0. We present an O(n2)-time algorithm for the

Algorithm ComputeM asn can be modified to compute the set of leaves in a maximum agreement subnetwork without increasing the asymptotic running time by also recording information about how each M asn-value is obtained as it is computed, e.g., by saving pointers. To obtain an actual maximum agreement subnetwork from such a set L', we can compute N1 | L' and N2 | L'

