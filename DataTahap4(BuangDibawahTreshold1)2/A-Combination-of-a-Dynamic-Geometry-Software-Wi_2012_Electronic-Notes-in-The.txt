This paper presents an interface for geometry proving. It is a combination of a dynamic geometry software, Geogebra[11] with a proof assistant, Coq[8]. Thanks to the features of Geogebra, users can create and manipulate geometric constructions, they discover conjectures and interactively build formal proofs with the support of Coq. Our system allows users to construct fully traditional proofs in the same style as the ones in high school. For each step of proving, we provide a set of applicable rules verified in Coq for users, we also provide tactics in Coq by which minor steps of reasoning are solved automatically.

We aim at constructing a tool for students to prove geometric theorems inter- actively. Students can reason step-by-step in the style taught in high school. This style may involve backward and forward proof reasoning, it may also involve the construction of auxiliary lines. We present GeoCoq, an interface for interactive ge- ometry proving which is a combination of Geogebra with Coq. Reasoning steps are built by mouse clicks and are sent to Coq. For its part, Coq executes the reasoning steps, the response is sent back to the user to continue their proof. The logical steps and the knowledge are given by a library that was developed with the help of a high-school teacher.

We also developed automatic tactics that help users solve minor steps of rea- soning. Users do not have to delve into details that lead to technical proofs and are not adapted to their level of abstraction. In addition, with the formalization of automatic proof methods as tactics in Coq (such as the area method which is formalized by J.Narboux[14]), users can use these methods to check the fact before proving it, or alternatively use them in steps of constructing proofs.

This paper is organized as follows. In section 2, we give a short description about Geogebra. The Coq system, the communication using Pcoq, and a brief description about the library for geometry are described in section 3. Section 4 presents the interface and provided features for proofs. The next section deals with our implementations. We mention some related work in section 6 and the last section is for our conclusions and perspectives.

Coq is a proof development system, which allows users to define functions or predi- cates, state mathematical theorems and interactively develop formal proofs. Coq is not an automated theorem prover, however it provides a tactic language letting users define their own proof method and it also includes tactics for automatic theorem proving and decision procedures. So Coq is adapted to our needs in interactively constructing proofs.

Some integrated development environments (IDE) can be used to communicate with Coq. Here, we are interested in Pcoq which is a graphical user-interface for Coq[1]. Using Pcoq to communicate with Coq offers some benefits. Pcoq is im- plemented in Java, the same programming language as Geogebra, so this makes it easy to be integrated in Geogebra. Pcoq manipulates all formulas and commands as tree-like structures (also known as abstract syntax trees) rather than plain text. This makes it easy to attach special mathematical notations to some functions, and to attach sentences in natural language to geometrical statements. Furthermore, this provides an easy access to the structure of information (hypotheses, goals) that we receive from Coq.

Two main sub windows of Pcoq are the command window and proof window. The command window is used to display all Coq commands which state and prove theorems. The proof window allows users to construct proofs, they can see hypothe- ses, and goals need to be proved for each step of geometry reasoning in this window.

In addition, other sub windows are used to display applicable rules for a goal, to ap- ply rules by giving values for their parameters, and to announce errors. . . We detail the interface and its features by showing how users can state and prove theorems. The following theorem will be used as an example for the rest of this section:

Geogebra provides common geometry construction tools for users to construct dia- grams. Geometry objects are created one by one by using appropriate construction tools and selecting existing objects. Users can move free points, and dependent constructions will be updated, this can help users discover conjectures.

Searching applicable rules in our interface is implemented using Search com- mands. It is strong enough to find out all rules in a database which lead to a goal given by a pattern. From the proof window of the interface, users can search all applicable rules for the current goal. A list of applicable rules will be displayed, allowing users to select an appropriate rule. After giving values for parameters of this rule which usually are points, lines. . . , users can update statement of the rule

Sometime, users need to add lines, ray, segment. . . to a diagram during their proofs. It is quite important to ensure the existence of these objects. In the theorem proving phase, each created object exists only under some conditions. So when users create a new object, they need to verify its conditions before using this object. The following commands are sent to Coq when users create the intersection point M of 2 lines l1 and l2.

While proof-by-pointing in Pcoq relies on analyzing formulas and understanding the meaning of logical symbols, this notion in our system is realized by the geometric signification of formulas. For each reasoning step, by finding out the signification of subgoal, hypotheses that users selected, the system can provide appropriate tactics in a popup menu to guide users to solve the problem. For example, we determine if the selected goal has the format of ( = line  ), ( = perpendicularline  ) or ( = parallelLine ), in this case the system provides replace auto Lines tactics to solve it.

DGSs are more and more used in education. Many works have been performed to provide combinations of DGS and GTP. Some of them use automatic methods, allow users to prove geometry theorems. We will cite here several systems that can generate readable proofs.

Geoproof[15] is very close to our system. Reasoning in Geoproof is performed by Coq and based on formalization of the area method in this proof assistant[14]. Since Geoproof also uses Coq, so we will have some similar points in stating phase. The main differences lie on theorem proving phase and the way the system connects to Coq. Geoproof only allows users to construct theorem statements, send them to a CoqIDE and check this fact by apply the area method. It does not allow users to construct their own proofs step-by-step and does not provide interactions between DGS and Coq.

In this paper, we present our interface which allows users to interactively construct traditional proofs in Geometry. Reasoning methods at high school level such as forward method, backward method, and drawing auxiliary lines as well are pro- vided. Steps of reasoning are verified by a proof assistant hence the correctness is guaranteed.

Integrating a proof assistant in a dynamic geometry software offers a novel way in learning geometry. It allows users to additionally have a logic view in solving geometric problems. Users know what they have in hypotheses, what they have to prove, which rules they can apply. . . By which, they can take good decisions and thoroughly understand reasoning steps.

