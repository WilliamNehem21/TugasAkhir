In this paper, we propose a unifying handling of symmetries in Kappa. We follow an algebraic approach, that is based on the single pushout semantics of Kappa. We model classes of symmetries as finite groups of transformations between site graphs, which are compatible with the notion of embedding (that is to say that it is always possible to restrict a symmetry that is applied with the image of an embedding to the domain of this embedding) and we provide some assumptions that ensure that symmetries are compatible with pushouts. Then, we characterise when a set of rules is symmetric with respect to a group of symmetries and, in such a case, we give sufficient conditions so that this group of symmetries induces a forward bisimulation and/or a backward bisimulation over the population semantics.

Symmetries play an important role in rule-based modelling. One simple example is the case of symmetric sites, that is to say when two sites in a protein have exactly the same capabilities of interaction. Symmetric sites can be handled with in various ways according to the choice of modelling language. Some languages propose syntactic solutions to describe them explicitly. In BNGL [1] a site can occur several times in the interface of an agent. In the Formal Cell Machinery Language [7] and in React(C) [20], one can use hyper-edges to connect several sites of the same kind

In this paper, we propose an algebraic framework for describing symmetries among site-graphs. This framework is abstract enough so that all the kinds of symmetries that we have mentioned so far can be dealt with in a uniform setting. Indeed, circular permutations and homogeneous symmetries (in which the same per- mutation is applied with the sites of all the agents of a given connected component) can easily be defined as subgroups of another (simpler) group of symmetries. Then, we show that our notion of symmetry is compatible with the single pushout con- struction, which we use as a foundation of the operational semantics of Kappa [8]. We give sufficient conditions for a model to be symmetric with respect to a given group of symmetries, and give extra-assumptions so that these symmetries induce forward bisimulations or even back and forth bisimulations over the Markov chain that is induced by this model.

Whenever f is an embedding between two site graphs E and F , the site graph E (resp. F ) is called the domain of (resp. the image of) f and is denoted as dom(f ) (resp. as im(f )). The number of embeddings between two site graphs G and H is denoted as [G, H]. Whenever G = H, f is called an automorphism. We notice that the identity function always induces an automorphism. The identity automorphism of a site graph E is denoted as iE . Two embeddings f and g such that im(f ) = dom(g) compose in the usual way (and form an embedding between the domain of f and the image of g). Moreover, whenever two embeddings f and g satisfy

The constraint i ensures that D is a local greatest upper bound. The constraint ii ensures that when a site gets bound, we know which site it is bound to. The constraint iii ensures that the sites which occur both in the left hand side and in the right hand side of a rule, have a binding state in the left hand side of this rule if and only if they have a binding state in the right hand side of this rule. The constraint iv ensures that when an agent is created, the state of all its sites is documented.

There are several ways to restrict a symmetry to the domain of a weak embed- ding, because a symmetry can be described as the product of two others or because the weak embedding can be described as the composition of two others. In such a case, it is important to get the same result. Thus, we need to strengthen Def. 3.3, which is the purpose of the two following definitions.

We notice that any embedding is forward compatible with the set of symme- tries that is defined in Exa. 3.12. But in general, if an embedding h is G-forward compatible for a given set of symmetries G over site graphs, h is not necessarily

A valid set of symmetries induces group actions over the basic elements of the semantics of Kappa. We are going to give the list of them in this subsection. We introduce a valid set of symmetries G that we will use all along the subsection.

Def. 3.6 ensures that the image of a fully specified site graph E by a symmetry in GE is a fully specified site graph. Thus, the group action of symmetries over site graphs induces another group action over fully specified site graphs, as written in the following proposition.

We notice that transition labels are quotiented according to two criteria. On the first hand, labels are seen modulo symmetries. On the second hand, since we cannot detect whether a model is symmetric without gathering the rules in isomorphic classes (see Def. 4.3), we consider rules modulo isomorphism.

Our framework captures not only symmetries among sites, but also homogeneous symmetries when the same transformation has to be applied to all the agents of a given type in a same connected component, or in the whole site graph. In these cases, symmetries do not always induce bisimulations. A forward bisimulation is induced whenever any symmetry that can be applied to the domain of a refinement of a rule (in the model) can be extended to the right hand side of this refinement. If additionally, one can extend the symmetries that can be applied to the domain of a refinement of a rule to the left hand side of this refinement as well, then the induced bisimulation is indeed a back and forth bisimulation.

We have not investigated yet which syntactic criteria over the rules would ensure that symmetries over the domain of their refined rules can always be extended to their left hand side and/or their right hand side. It depends on the set of symmetries that is considered. We have not investigated either whether our notion of symmetry is also compatible with the double pushout semantics [12] of Kappa.

