Today, the concept of service oriented architectures provides a way of building integrated solutions out of existing services. To this end, services from different providers are composed using advanced orchestration and choreography techniques. However, while this principle allows for greater flexibility at a smaller cost, the use of third party services also includes a risk: Deployed services might not work as claimed by their providers. In this paper, we propose a technique for analyzing the expected reliability of service composi- tions based on ratings given by (previous) service users. Every service thereby comes with a reputation, and the analysis computes an overall reliability of a service composition from the reputations of its constituent services. The proposed model-driven approach proceeds by translating statechart models of service compo- sitions into input for a probabilistic model checker (PRISM) using state-of-the-art model transformations techniques. The approach has been implemented as an Eclipse plug-in and is fully compliant with UML.

The rest of the paper is organized as follows: In section 2 we describe the modeling and analysis formalisms used throughout the paper. Section 3 describes the transformation between the design and analysis models described in these for- malisms. The tool support of the proposed approach is discussed in section 4. Section 5 gives an overview of related work and section 6 concludes the paper and gives some directions for future work.

A model consists of one or more UML state machines that contain an arbi- trary number of parallel composed statecharts representing services (separated by regions). Each statechart is described by its states and transitions, that can be triggered by an internal, receiving, or sending event which is indicated through la- bels a, a?, and a! respectively. For modeling these events we use the specific kinds of events provided by the UML for inter-process communication: ExecutionEvent, ReceiveSignalEvent, and SendSignalEvent.

The modeling notation chosen in this work and described above is fairly straight- forward and familiar to most software architects. However, it is mostly not sup- ported by existing formal analysis techniques including model checking. Therefore, in order to analyze a choreography using model checking, its model has to be first transformed into the corresponding analysis model in accepted format. The model checker used in this work is the Probabilistic Symbolic Model Checker (PRISM) [3], therefore, its modeling language has to be introduced first.

The PRISM modeling language is based on the Reactive Modules formalism [7]. It allows description of a system as a Discrete Time Markov Chain (DTMC), Con- tinuous Time Markov Chain (CTMC), or Markov Decision Process (MDP) model. Main elements of an analysis model are modules and variables. Modules contain finite range local variables and commands. A PRISM command has the following

Modules that represent different interacting processes within the model, can be composed together in a process-algebraic expression. This expression should fea- ture each module exactly once, and contain CSP-based operators including: parallel composition with full or partial synchronization over shared actions, asynchronous parallel composition, and operators for hiding and renaming of actions within the module. An analysis model described in PRISM modeling language is later trans- lated by the model checker into a Markov model.

The described language allows definition of analysis models which can be used to model check various system properties including its reliability. The question to be discussed next, is the transformation of a design model of a choreography (section 2.1) into a model in the PRISM language.

Message receipts by a service are observed by other parties. Services are assumed to always accept messages, possibly discarding them later. Following this as- sumption, such transitions always occur, and also do not directly influence the observed reliability, i.e., have probabilities of 1.

The idea behind the proposed transformation rules is to create an analysis model, where each service is represented by its own PRISM module with the same name. These modules contain local variables needed to describe different states of their corresponding services, and commands to describe transitions between these states. A set of local variables of such a module always contains exactly one start variable and variables for unique final states of the service. The start variable initialized with 1 represents the start state of the service.

The commands within both modules can be derived by application of the dis- cussed transformation rules to transitions, and usage of appropriate variables and synchronization actions. The resulting model can now be analyzed in PRISM to check various properties of the composition. These properties have to be formalized in the PRISM properties specification language. In this work, in order to obtain the expected reliability, we expressed it as a probability of not reaching a failure state during the lifetime of the system or formally, for an MDP system model containing k failure states:

The Eclipse platform with its flexible plug-in based architecture and numer- ous useful third-party plug-ins has been chosen as a development and application platform for our approach. This choice allows the reuse of already existing UML2 conform modeling tools (e.g. UML2 Tools [5], TOPCASED [4]) realized as Eclipse plug-ins, to support the design model definition. The following steps of our ap- proach are not directly supported in Eclipse, however, various plug-ins significantly simplified the development process of our transformation tool.

First of all, we rely on the Eclipse Modeling Framework (EMF) for storing and retrieving our models. Moreover, the ATL transformation language [1](supported by a third-party plug-in) was used to define and apply the model transformation rules. Finally, we used the JET-template model-to-text engine [2] which allowed us to generate a textual representation of the transformed model. The PRISM model checker is, unfortunately, not integrated within the Eclipse platform, therefore, the analysis model produced by our tool has to be imported manually. The last two steps of the model-to-model transformation and the model-to-text transformation have been integrated in our tool.

Depending on the technique provided system models are either directly analyzed using reduction rules to compute QoS [13,20,30], or transformed into some kind of stochastic model [29,31,8,14,26,27,12] for further analysis, like in our case. The most widely used stochastic models for this purpose include Markov models and stochastic Petri nets with corresponding analysis algorithms. For instance, Zhong and Qi [31] consider BPEL specifications and transform them into stochastic Petri nets for analysis. Gallotti et al. [14] consider UML activity diagrams of an orches- tration extended with QoS properties, and transform them into Markov models. Our approach is similar to [14] as it also uses Markov model and PRISM model checker for reliability analysis, however, it is focused on service choreographies, and, therefore, considers different UML diagrams used for communicating services.

Xia et al. [27] propose the only other approach, that we are aware of except of our, that considers choreographies. It is based on WSCI specifications of compositions, which are translated into a General Stochastic Petri net for reliability prediction. Compared to our approach, the authors focus on models at a different abstraction

Later, in [25] the authors extend [24] to estimate system reliability. This ap- proach is based on a system model very similar to ours. It describes communicating components as a set of concurrent state machine containing interaction protocols of components. This model is transformed into a Dynamic Bayesian Network that includes reliabilities of individual components. Compared to [25], our approach does not associate service reliability with its probability of start, instead sending transitions are assumed to carry reliability-relevant probabilities. Unlike [25], where component-based systems are considered, we assume that services have no failure dependencies.

In this paper we have proposed a technique for computing the expected reliability of service choreographies based on reputations of single services. The technique involved transforming metamodel instances of UML state machines into Markov decision processes in the form of an input to PRISM. The probabilistic model checker PRISM could then be used to determine the expected reliability. The approach has been implemented on the basis of state-of-the-art model transformation techniques and is UML compliant.

