This article describes an architecture for creating responsive web interfaces for proof assistants. The ar- chitecture combines current web development technologies with the functionality of local prover interfaces, to create an interface that is available completely within a web browser, but resembles and behaves like a local one. Security, availability and efficiency issues of the proposed solution are described. A prototype implementation of a web interface for the Coq proof assistant [8] created according to our architecture is presented. Access to the prototype is available on http://hair-dryer.cs.ru.nl:1024/.

To use a proof assistant, one needs to install some software. Often the instal- lation process is complicated. For example to install Isabelle [17], which is one of the most popular proof assistants, on a Linux system, one needs a particular ver- sion of PolyML, a HOL heap and Isabelle itself. To use an interface to access the prover, one needs ProofGeneral [4] and one of the supported Emacs versions. With

This is a problem. It happens that computer scientists prefer to stick with installed old versions of provers, not to go through the same process to upgrade. Mathematicians may even stay away from computer assisted proving, just because of the complexity of installation.

We want a fast interface, that is available with just a web browser. We want to access various proof assistants and their versions, in a uniform manner, without installing anything, not even plugins. The interface should look and behave like local interfaces to proof assistants.

The solution is a client-server architecture with a minimal lightweight client inter- preted by the browser, a specialized HTTP server and background HTTP based communication between them. The key element of our architecture is the asyn- chronous DOM modification technique (sometimes referred to as AJAX - Asyn- chronous JavaScript and XML or Web application). The client part is on the server, and when the user accesses the interface page, it is downloaded by the browser, which is able to interpret it without any installation.

The user of the interface, accessing it with the browser, does not need to do anything when a modification is done on the server. Every time the user accesses a prover, the version of the prover that is currently installed on the server is used. The user can access any of the provers installed on the server, even a prover which does not work on the platform from which the connection is made.

Our approach is presented as an architecture to create web interfaces to proof assistants, but it is not limited to them. The problems solved are relevant to creating web interfaces programs that have a state, include an undo mechanism, and their interfaces can be buffer oriented. Our architecture may be applied for example to buffer oriented programming languages, like Epigram [15].

There are Java applets having built-in proof assistant functionality. Examples may include G4IP [19] or Logic Gateway [12]. The installation of a browser plug-in to support Java is not simple in a Unix environment and limiting provers to Java applets is undesired.

The novelty of our architecture in comparison with existing web interfaces for theorem provers is that it allows the creation of an interface to a prover, that can look and behave very much like the ones offered by state-of-the-art local interfaces, but is available just by accessing a page with a web browser without installing any additional software, not even plugins. Because of the architecture, the network used to transfer information does not slow down the interaction. The idea to use asynchronous DOM modification to create an interface to a proof assistants has never been applied before.

In the rest of the paper we present the techniques for creation of web interfaces, that we will use (Section 2) and the internals of a local prover interfaces which we try to imitate (Section 3), followed by the presentation of the new architecture (Section 4) and a description of its security and efficiency (Section 5). We present our implementation prototype (Section 6). Finally we conclude and present a vision of future work (Section 7).

JavaScript is a scripting programming language, created by Netscape in 1995, for adding certain dynamic functionality to pages written in HTML. It has been quickly adopted by most browsers and nowadays it is supported even by some text mode browsers like w3m and Links, and mobile phone browsers. It is very often used on Internet websites.

DOM (Document Object Model) [14] is an API (Application programming in- terface) for managing HTML and XML documents that allows modifications of their structure and content. Recent browsers support W3C DOM accessibility by JavaScript. It is often used on web pages to add dynamic elements, for example drop-down menus or images that change when the mouse moves over them.

The current version of ProofGeneral is implemented mostly in Emacs Lisp, and is strongly tied with the editor itself. It is easy to adapt ProofGeneral to new proof assistants, by setting a number of variables. If this is not sufficient ELisp code can be used.

interaction, but they are normal elements of web pages). Buffers are implemented as HTML IFrames 2 . All keys that modify the IFrame are assigned to a special function. Locking of parts of the buffer is implemented by disallowing changes to locked parts of the buffer in this function.

The interface includes functionality for file interaction. Files can be loaded and saved on the server. For interoperability downloading files and uploading files from the local computer may be provided. For proof development efficiency, insertion of templates and queries may be provided.

The special messages, mentioned above, include: passing a given complete ex- pression to verify to the prover, issuing an undo command in the prover, saving a file, loading a file, and break (stopping the prover computation). The commands from the client for the prover are passed first to the server, which transmits them to the prover. Prover replies are analysed by the server and only state changes are sent to the client. The state changes consist of two parts: changing of the markings of the edit buffer and the new contents of the prover state buffer.

In any centralized environment security, availability and efficiency of the server are important. Standard security measures include a backup server prepared to take over network traffic in case of a primary server failure and regular backing up of user files. In this subsection we will describe only the issues and solutions particular to a server that runs a web interface to a prover.

When many users want to access the interface, the resources of a single server may be insufficient. It is simple to run the server on a set of machines, by calling provers as subprocesses through ssh on separate computers. A load balancing mechanism can be implemented.

To secure our prototype the server is run as nobody in a minimal chrooted environment. The prover sub-processes are reniced not to interfere with the main server process. Dropping from Coq to OCaml toplevel is disabled. The access to the interface is password protected, to avoid creating prover sessions for web-spiders. Web spiders are able only to see the saved proof scripts.

Our interface can be used to create interactive tutorials presenting proof assistants. We have created a special proof script, that includes a slightly modified version of the official Coq tutorial. The descriptive parts have been put inside comments (including the HTML formatting), and commands to the proof assistant have been left outside comments. A user that enters such a page may just read the tutorial and execute the commands in Coq environment, but may also do own experiments with it.

proof states. Thus proofs presented on the web are usually accompanied with some of the proof states usually automatically generated by Coqdoc or TeXmacs [6]. A web interface can be used (even in a read-only mode) to present such proofs interactively. In this way, the user reading the proof chooses which proof states to see.

External proof assistant libraries can be included on the server. With our server we included C-CoRN (Constructive Coq Repository at Nijmegen) [10]. Such li- braries can be developed on the server. In such an approach visitors can always see and test the current version, without downloading and compiling the library.

We presented an architecture to create simple, lightweight and fast web interfaces to proof assistants. Such interfaces are a novelty in the domain. Our solution works with modern web browsers without installing any additional software. The installation and updating process is done only on the server, the users do not need to do anything. It is therefore completely platform independent.

We would like to see how well our solution fits with the general prover interaction protocol PGIP [5]. The protocol is XML-based, so parts of it may even be passed by the server directly to browsers, since they are already able to parse XML. On the other hand the protocol may include too much information, since it was designed as a local one.

