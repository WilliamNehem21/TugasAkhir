Abstract An explosive growth in the field of wireless sensor networks (WSNs) has been achieved in the past few years. Due to its important wide range of applications especially military applications, environments monitoring, health care application, home automation, etc., they are exposed to secu- rity threats. Intrusion detection system (IDS) is one of the major and efficient defensive methods against attacks in WSN. Therefore, developing IDS for WSN have attracted much attention recently and thus, there are many publications proposing new IDS techniques or enhancement to the existing ones. This paper evaluates and compares the most prominent anomaly-based IDS sys- tems for hierarchical WSNs and identifying their strengths and weaknesses. For each IDS, the architecture and the related functionality are briefly introduced, discussed, and compared, focusing on both the operational strengths and weakness. In addition, a comparison of the studied IDSs is carried out using a set of critical evaluation metrics that are divided into two groups; the first one related to performance and the second related to security. Finally based on the carried evaluation and comparison, a set of design principles are concluded, which have to be addressed and satisfied in future research of designing and implementing IDS for WSNs.

and traffic control [1]. While benefiting from the convenience and useful applications of these networks, they are exposed to various types of attacks, since the usage of WSN has a special nature; usually deployed in remote places, left unattended, and use publically accessible communication channels. These attacks are commonly classified according to the affected com- munication layer protocol [2]. So securing the WSN is a neces- sity and a challenging work.

This paper introduces a comparative evaluation study for the newly and recently applied anomaly based IDS. Different techniques are investigated. For each technique, the main idea and the related functionality is briefly presented and evaluated. The different techniques are compared based on critical evalu- ation metrics. Moreover, the strengths and weakness of each technique are compared and discussed. The rest of this paper is organized as follows. Section 2 introduces a complete back- ground of the IDS functionality and classification. Section 3 briefly analyzes and evaluates the recently and common anom- aly-based IDS for hierarchy WSN architecture, focusing on both the operational strengths and weakness. Section 4 pre- sents a comparison and evaluation results based on a set of critical performance and security metrics. Finally, Section 5 introduces a conclusion based on the carried out comparison and suggests ideas to enhance the performance of IDS in fu- ture researches.

In [19], an anomaly-based IDS using Fuzzy C-Means cluster- ing (FCM) with hierarchical network architecture was intro- duced, that detect routing attacks caused by abnormal flows of data. The basic idea of FCM clustering analysis is to gather similar data in a cluster where the same types of data should be near, and the different types should be very far. The cluster heads are responsible for collection of all regions detection information to be conveyed to the base station at last for detection. The proposed method works as follows:

This model employs the agent strategy; it adopts multiple agents to achieve different modules of intrusion detection. Four kinds of agents are installed on each node to cooperate. Each node will execute different operations of detection according to its place (cluster header or member node). Finally, they col- laborate with each other to detect attacks. The agents installed on each are divided into four categories depending on their role.

In [23], an anomaly-based IDS using a combination of Discrete Wavelet Transform (DWT) and a competitive learning SOM neural network was proposed, in order to detect anomalies accurately. The reason of this combina- tion comes from ability of the SOM neural network to ex- tract statistical regularities from the input data vectors and encode them in weights without supervision. But SOM re- quires processing time ascending with the input data size, therefore, the DWT is applied first to gather sufficient fea- tures of input data then fed these features to SOM network.

Un supervised Clustering using SOM: In the base station, SOM is built for unsupervised clustering. The basic SOM consists of a regular grid of map units or neurons, each neuron denoted by i has a set of layered neighbor- ing neurons and maintain a weight vector mi. The SOM network is trained iteratively using the coefficients obtained from previous stage representing SOM data set.

involves training the SVM locally at each IDS n- ode, then computes support vectors that will be s- ent to adjacent IDS node situated in the same cluster. When a node receives these vectors it co- mbines them with its own and so on, until all IDS nodes in the same cluster reaches the same trained SVM. Afterwards, all cluster heads exchange their own vectors, and then communicate these vectors to their IDS. As a result of this cycle, a global s- upport vectors resides in each IDS node. These g- lobal vectors are then used in the SVM testing stage.

The main objective is to compute the accuracy of anomaly detection process for each technique based on a set of different evaluation metrics. The standard IDS evaluation metrics are classified into two categories [27]; the first one, measures the detection performance and the second is assigned to measure the capability of the IDS to provide security to network. The performance metrics include: (i) Technique processing over- head; measured as computational complexity and resources usage [27]. (ii) Communication overhead, and (iii) fair distribu- tion of the processing workload among the network nodes. On

This paper has evaluated and compared the latest anomaly based IDS applied for a hierarchal WSN. From the obtained results it can be concluded that: due to the WSN nature, it is difficult to distinguish the abnormal behavior from the normal one especially for uneven network traffic patterns. Therefore, it is highly recommended to depend on the data mining and arti- ficial intelligence techniques. Since it has a dynamic ability to gather similar traffic patterns in a cluster and isolate the un- even ones. In addition, feature selection is one of the important factors which affect the performance of IDS. Also, the proper selection of clustering parameters can refine the isolation and enforce the decision making process. The decision of choosing an optimum IDS is a trade-off process between security and performance metrics.

For future work, it can be remarked that designing a new anomaly based IDS is a true challenge. Since, it must satisfy the performance aspects as well as the security aspects. Also, a newly feature selection methods can be adopted. In addition, relying on a newly data mining technique rather than tradi- tional classifiers based on neural networks to properly select the clustering parameters can enhance the refining process.

