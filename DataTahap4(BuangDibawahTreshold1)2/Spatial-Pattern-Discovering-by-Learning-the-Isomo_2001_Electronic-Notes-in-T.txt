Inexact graph matching has been widely investigated to relate a set of object/scene primitives extracted from an image to a set of counterparts representing a model or reference. However, little has been done to address how to build such a model or reference. This paper develops the theory for automatic contextual pattern mod- elling to automatically learn a parametric pattern ARG model from multiple sample ARGs. The learned pattern ARG characterizes the sample ARGs, which represent a pattern observed under different conditions. The maximum-likelihood parame- ters of the pattern ARG model are estimated via the Expectation-Maximization algorithm. Particularly, for Gaussian attributed and relational density distribution assumptions, analytical expressions are derived to estimate the density parameters of the pattern ARG model. The pattern ARG model with Gaussian distribution as- sumptions is therefore called the Contextual Gaussian Mixture model. The theory and methodology is applied to the problems of unsupervised spatial pattern ex- traction from multiple images. The extracted spatial pattern can be used for data summarization, graph matching, and pattern detection. One immediate application of this newly developed theory will be information summarization and retrieval in digital image and video libraries.

Recently, ARG and graph matching techniques have begun to attract great attentions in content-based image/video retrieval community [12,15,16]. Basi- cally, the user submits a set of sample images (usually more than two) to the system. The system first summarizes the sample images in some ways. Then, the system uses the summarized information to search through its database and return a set of images, which are similar to the sample images based on its similarity measurement method.

Some merely use ARG to represent samples and apply two-graph matching techniques to measuring the similarity between the samples in the database and the query for retrieval purpose. Huet and Hancock [12] used ARG to represent the geometric attributes and structural information of line-patterns. Ozer [15] used relational graph to annotate the images where the object of interest is present. However, both [12] and [15] only use ARG for informa-

Frey and Jojic [9] defined transformation function as a discrete latent vari- able in the probabilistic graphical model and use the Expectation-Maximization (EM) algorithm [7] to learn patterns from images with clutter backgrounds. In their approach, transformation function is defined on the image pixel level. The values of the transformation functions are selected from a predefined dis- crete transformation set. The image pixels are just like the nodes of an ARG. The transformation set is similar to the value range of the matching function in graph matching algorithm. However, their approach does not consider the contextual information of image pixels. Therefore, the matching ambiguity of image pixels is left as an open problem. In addition, operating at pixel level limits the possible transformation set (many transformations are defined on pixel group and are continuous), increases pixel matching ambiguity, and brings about high computational complexity.

Multiple sample ARGs should provide more information about the pattern than two sample ARGs do. It is not appropriate to use one of the sample ARGs as the model or reference. The relations and the attributes of a sample ARG may not best represent those of other sample ARGs. This is due to the variance of the relations and attributes caused by noise, lighting conditions, transformations, and so on. We propose to learn a parametric pattern ARG from a set of sample ARGs. The learned pattern ARG model can be further used for object detection.

The rest of the paper is organized as below. Section 2 formulates the auto- matic contextual pattern modelling problem. Section 3 derives expressions for estimating the parameters of the pattern ARG via the EM algorithm. Ana- lytic expressions can be obtained for some parameters regardless the attributed and relational density distribution functions. Section 4 derives analytical ex- pressions for estimating the density parameters of a special case of the pattern ARG, called the Contextual Gaussian Mixture model. Section 5discusses how to used the learned pattern ARG model for pattern detection. Implementa- tion issues are presented in Section 6. Experimental results are provided in Section 7. Finally, the paper closes with summary and discussions in Section 8.

intensive to manually specify the node and relation correspondences for a large set of sample ARGs. Moreover, the observed images always contain the pat- tern and its backgrounds. It is also tedious and labor intensive to manually label the pattern out of its backgrounds.

3 We allow Ui /= Uj if i /= j because the observed images may have different numbers of image primitives. This is due to noise or the fact that the pattern being placed in different backgrounds. For example, if a node represents a line, the lines tend to get broken during the process of line detection, which results in extraneous nodes.

In most applications, the attributed distribution and the relational distribu- tion are likely to be assumed to be Gaussian. This kind of pattern ARG model is called the Contextual Gaussian Mixture (CGM) model. Analyti- cal expressions for estimating the distribution parameters of the CGM in the Maximization step of the EM algorithm can be derived.

Initializing the pattern ARG model is the first step of the learning procedure and is very important. The number of the model components is decided by the user or the applications. The average number of the nodes of the sample ARGs is calculated. A sample ARG whose number of nodes is the closest to the average number is selected. Let G1 denote the selected sample ARG. The structure of G1 is used to initialize that of one component of the pattern ARG model. In the case of a CGM model, the attributes and relations of the selected sample ARG are used to initialize the corresponding attributed means and relational means of the model component. The attributed covariances and relational covariances of the component are initialized as identical matrixes. The rest components of the pattern ARG model are set as NULL graphs and will be initialized by the following algorithm.

It is likely to initialize the components of the pattern ARG model with spuri- ous nodes and relations because the sample ARGs include backgrounds . To achieve better modelling results, those spurious nodes and relations should be detected and trimmed. Otherwise, they may cause serious mismatch prob- lem if we keep updating their parameters. During the iterations of the EM

