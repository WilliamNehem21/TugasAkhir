The introduction of probabilistic behaviour into the B-Method has recently been proposed [2], called probabilistic B. This approach builds on previous work which introduces probabilistic choice into program statements, and ex- tends the notion of weakest precondition semantics to deal with expectations [5]. An expectation can be considered as the expected value of a formula or expression. Thus programs can be viewed as expectation transformers rather than predicate transformers, and their semantics gives the expectation of an expression after the program has been executed in terms of expectations prior to execution.

In this paper we will use expectations of the form V . This is an abbre- viation for 0 $ V . Observe that this still gives rise to a non-trivial proof obligation P 1, that V is non-negative on initialisation.

Thus the closer to 1 the ratio between minflow and maxflow , the closer A can be to 1 and the more accurate the upper bound on the expected value for volume for any given expectation on rvolume. However, note that A can always be at least 0.99.

rvolume, the minimum expectation over all possible assignments to rvolume must be taken. In E 1, rvolume is positive, so the smallest possible value of rvolume is used in the calculation of the pre-expectation of E 1. In E 2 rvolume is negative so the largest possible value of rvolume is used in the calculation of the pre-expectation of E 2. This means that however the nondeterminism is later resolved, the expectation will be at least the value calculated. Expec- tations should always be non-decreasing, so demonic nondeterminism always considers the worst case with respect to increases.

worst case occurs when the flow is minflow and minflow + lowerror is added to rvolume: the resulting rvolume could be 10% out. On the other hand, in the second case the error in the flow can be at most 0.1%, so the error that can be introduced by V 2b (1% of the time) dominates, and the worst case occurs when the flow is maxflow and rvolume is only incremented by lowerror + minflow .

If flow = maxflow , then volume is increased by maxflow , and the least that rvolume can be incremented by is minflow + lowerror if at least two sensors go wrong (which can happen with probability 0.028), otherwise maxflow + lowerror . Thus the most pessimistic expectation gives a possible value of A = 0.9765. Here the ratio between maxflow and minflow is more significant than the ratio between minflow and lowerror in contributing to the amount by which rvolume can be down, and we obtain a value of 0.9765 for A.

exceed rvolume, and the worst case always occurs when flow = minflow . In this case, the reading might at worst be maxflow + higherror (with probability 0.028) and minflow + higherror otherwise. This yields a value for B of at least

