The strand space model is one of the most successful and widely used formalisms for analysing security protocols. This might seem surprising given that the model is not able to reflect choice points in a protocol execution: the key concept in the strand space model is that of a bundle, which models exactly one possible execution of a security protocol. Inspired by the branching processes of Petri nets, we show that branching can be introduced into the strand space model in a very natural way: bundles can be generalized to branching bundles, which are able to capture several conflicting protocol executions. Our investigations of the theory of branching bundles will motivate the concept of symbolic branching bundles, and culminate in the result that every protocol has a strand space semantics in terms of a largest symbolic branching bundle. We hope our results provide a strong theoretical basis for comparing models and providing process calculi semantics in security protocol analysis. Altogether our work is related but different to a series of works by Crazzolara and Winskel. Throughout we will profit from a close relationship of the strand space model to event structures, which has already been pointed out by these authors.

The strand space model [6] is one of the most successful and widely used formalisms for analysing security protocols. For example, it has been employed to verify security properties by hand, to give formal semantics to protocol logics, and as the underlying model of model-checking tools (c.f. [8]). In spite of this success two points of criticism have been brought against it: one is that, in contrast to models based on multiset rewriting, it is an ad hoc model rather than rooted in a rich theory. The second is that it is not able to reflect aspects of branching such as choice points in a protocol execution. To explain the latter we recall that the central concept of the strand space model is that of the bundle. A bundle models exactly one snapshot of a protocol execution: a set of strands represents the sessions that have occurred so far while a relation between the send and receive events of the strands describes how messages have flowed between them.

In this paper our thesis is that branching can be introduced into the strand space model very directly at the conceptual level of bundles. The idea is to general- ize bundles to branching bundles in the same way as in Petri net theory branching processes generalize Petri net processes. Petri net branching processes [5] are in- troduced as a formalization of an initial part of a run of a Petri net, which can include conflicting choices. They come with a very satisfying theory: the branching processes of a Petri net form a complete lattice (modulo isomorphism) with respect to a natural notion of approximation. The largest element of this lattice captures all possible behaviour of the Petri net, and is called its unfolding.

In this paper we wish to investigate whether protocols have as satisfying a theory of branching bundles. If every protocol P had indeed a largest branching bundle, this branching bundle would capture all possible behaviour of P , and would thus provide a natural strand space semantics. This could provide a strong theoretical basis for comparing models and providing semantics for protocol languages. Our contributions are as follows:

We investigate the theory of branching bundles. We find that every branching bundle can be viewed as a labelled prime event structure. This will motivate a notion of computation state for branching bundles in terms of sub-bundles, and a transition relation between them. Following the approach of [5] we will investigate whether the branching bundles of a protocol form a complete lattice with respect to a natural notion of approximation. We will however obtain a negative result: the branching bundles of a protocol do not even form a complete partial order.

In the following section we will introduce the strand space model using variations on the original definition of [2] and [7]. The remainder of the paper is structured according to the above contributions. Proofs that are straightforward have been moved to Appendix A.

We now define our concept of branching bundles. As motivated in the introduction branching bundles should be capable of representing several conflicting protocol executions. To obtain them as a natural generalization of bundles, we will define them as bi-graphs of events labelled by actions of GAct . In contrast to bundles we will allow them to contain events that represent conflicting points in a protocol execution. We can distinguish between three situations when two events e1 and e2 of a protocol execution should naturally be considered to be in conflict with each other:

There is yet another source of branching if we take a purely observational view. Say Eavesdropper Eve observes the first two actions of a session, but she cannot tell to which role these actions belong to: according to their format the actions could form an initial part of an instance of role A or of role B. Then in one future of Eve the observed session may evolve into an instance of role A, whereas in another future of Eve it will evolve into an instance of role B.

To include (iii) as a source of branching is a design decision and may seem counter-intuitive at first. To include it seems, however, in the spirit of the strand space model: it is consistent with the fact that if there is ambiguity in the protocol specification then a strand may be interpreted as an instance of several roles. To resolve this type of ambiguity one would need to keep a role identifier at each strand, which would make the model less abstract and technically cumbersome. As we will now see our decision to include (iii) leads to a very simple formalization of branching strand. In the following, let P be a protocol.

We now investigate whether b-bundles have as satisfying a theory as Petri net branching processes. In Section 4.2 we examine the relationship of b-bundles to event structures. In Section 4.3 we explore whether the b-bundles of a protocol approximate (modulo isomorphism) a largest b-bundle. In preparation, we intro- duce a notion of sub-b-bundle in Section 4.1, which is analogous to that of Petri net sub-b-processes [5].

It is easy to show that the composition of two homomorphisms is a homomor- phism. If a homomorphism is bijective then the converse of (iii) is also true (using the fact that B1 and B2 are b-bundles). Thus, an isomorphism is a bijective homo- morphism.

Every b-bundle of a protocol P captures an initial part of the behaviour of P . We now wish to investigate whether the b-bundles of P consistently approximate, modulo isomorphism, a largest b-bundle. If every protocol P had indeed a largest b-bundle, this b-bundle would capture all possible behaviour of P , and would thus provide a natural strand space semantics for protocols. Furthermore, in view of the results of the previous section this strand space semantics would come with a notion of computation state in terms of bundles, and a transition relation between them. The induced labelled transition system would give the corresponding interleaving semantics of the protocol, while the protocol would also have an abstract partial order semantics in terms of the induced labelled event structure.

On the other hand, every symbolic b-bundle can be transformed into a b-bundle by disentangling non-conflicting strands that are glued together. In particular, every symbolic bundle can be transformed into a bundle. (These connections will be formalized in an extended version of this paper.)

It remains to show that canonical sb-bundles are unique representatives of their isomorphism class, i.e., that two isomorphic canonical sb-bundles are identical. This will follow from Lemma 6.5 below. First we show that homomorphisms between sb-bundles respect the canonical coding of events: every event is mapped to an event with the same coding.

Together with Lemma 6.2 this implies that there is at most one way of how to fold an sb-bundle onto another sb-bundle, and if the homomorphism exists then it will be injective and thus an approximation. For canonical sb-bundles it further means that the homomorphism will be the identity map.

In the last section we have shown that for every protocol P , ISBB (P ), the set of isomorphism classes of symbolic b-bundles of P , forms a complete lattice with respect to approximation. In particular, this implies that ISBB (P ) has a largest element, which captures all possible behaviour of P in a symbolic fashion. We call it the symbolic unfolding of P . Thus, every protocol has a strand space semantics in terms of its symbolic unfolding. Further, by the results of Section 4.2 this semantics comes with a notion of computation state in terms of symbolic sub-bundles, a transition relation, and close relations to event structures.

Proof. [Prop. 4.9] Reflexivity is immediate from the definition. Transitivity follows by compositionality of homomorphism. For antisymmetry consider that if there is an injective but non-surjective homomorphism from one b-bundle to another then there clearly cannot be an injective homomorphism in the other direction. 

