The proofs of the two parts of Lemma 5.6 are similar: both use the graph functor to map commuting diagrams in B to morphisms in Rel(E ), and then use the Graph Lemma to see that these morphisms are Fr-algebras. Lemma 5.5 and Lemma 5.6 together now immediately imply the main result.

We thank the reviewers of this and previous versions of the paper for their comments and suggestions. We especially thank Uday Reddy for extremely valuable advice and encouragement. Research supported by EPSRC grants EP/K023837/1 (NG, FNF), EP/M016951/1 (NG), NSF award 1420175 (PJ), and SICSA (FO).

