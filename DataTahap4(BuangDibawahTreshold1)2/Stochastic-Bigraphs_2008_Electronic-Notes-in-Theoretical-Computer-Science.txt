In this paper we present a stochastic semantics for Bigraphical Reactive Systems. A reduction and a labelled stochastic semantics for bigraphs are defined. As a sanity check, we prove that the two semantics are consistent with each other. We illustrate the expressiveness of the framework with an example of membrane budding in a biological system.

Bigraphs are the arrows in a category in which the objects are (inter)faces. We shall explain them by examples. First, each node of a bigraph is assigned a control, which determines how many ports it has. These controls are given by a signature, such as K = {A : 2, B : 1, C : 0}.

Every site or node in a bigraph has a parent which is either a node or a root. A root is idle if it has no children; an outer name is idle if its link has no ports or inner names. A site is guarding if its parent is a node. The siblings of a site or node are those with the same parent; the siblings of an inner name or port are those in the same link. A bigraph is discrete if every link is open and contains exactly one port or one inner name.

We shall call a BRS abstract if it is defined as in Definition 2.3. Thus an abstract BRS is based upon an ssm category. In contrast, a concrete BRS is based upon a refinement of such a category, which we now define.

G0F0 = G1F1. In this case, if (B0, B1) also bounds (F0, F1) and BBi = Gi (i = 0, 1) then the triple (B0, B1, B) is a bound for (F0, F1) relative to (G0, G1). See the left- hand diagram below.

Definition 2.9 [relative pushout] Let (G0, G1) be a bound for (F0, F1). A relative pushout (RPO) for (F0, F1) relative to (G0, G1) is a relative bound (B0, B1, B) such that for any relative bound (C0, C1,C) there is a unique arrow M for which MBi = Ci (i = 0, 1) and CM = B. (See the right-hand diagram.)

Before presenting the reactive system itself, we proceed with the description of the different node controls that we will use in our example. Controls coat, gate and particle denote the atomic nodes of the system, meaning that no node may be nested inside them. The coat and gate nodes have arity 1 and particles have no ports. The non atomic controls (the compartments) are bud, with arity 1, and (mem)brane, with arity 0.

A bud is formed whenever a coat protein binds to the membrane. Note the creation of a channel between the bud and the membrane whose entries are denoted by gate nodes. The closure /x on the left hand side ensures that the coat protein is not already bound to another bud in the system.

A channel consists of two gate nodes on different regions connected to each other. A particle may pass from one region to the other whenever it collides with a gate. Note that rule (3) is symmetrical, therefore it may be applied either to pump particles into the bud or to push them back into the cell 7 .

When a sufficient amount of coat proteins have assembled, the channel attaching a bud to its membrane may break entailing the formation of a separated vesicle. The probability of fission increases with further coat binding after the n initial ones (see Example 1 of Section 4). In the appendix A we briefly show how one can study further this mechanism using the PRISM modele checker [17]. Note that the second region will always find its place inside a brane node.

In this paper we have proposed a theoretical framework to deal with stochastic bigraphs. Here, rates are associated with rewrite rules from which it is possible to derive the rule activities on a given bigraph. We have pointed at biology to give an application that, on the one hand, shows the expressiveness of bigraphs, which are able to model dynamic compartmentalisation, on the other hand, convincingly underlines the necessity to extend the model with rates. We have the feeling that

In Section 3 we introduced a process of membrane budding as a motivating example for developing a stochastic semantics for bigraphs. In this appendix we would like to study the budding example when rates are associated to the rules. Since we still lack a simulator for stochastic bigraphs, it is hard to show more than the expressive power of bigraphs to advocate their use in the design of a language for biological cells. However, under some assumptions, the budding example could be made sufficiently simple to move the analysis on the Continuous Time Markov Chain that can be extracted from the transition system resulting from our quantitative semantics for bigraphs. Thus we can perform some simulations using existing tools like, e.g., the PRISM model checker [17].

Note that removing the rule for the initial bud formation strongly simplifies the CTMC obtained from the stochastic transition system, which can now be extracted by hand. In fact, the restricted set of rules, together with the methodology for counting the occurrences in bigraphs and the procedure given in the previous sub- section, can be used to get a quite simple CTMC which we are then able to simulate using PRISM. Actually, we obtained the following CTMC defined in the PRISM input language.

We start by computing the dimension of the bud after fission (i.e. the number of coat proteins which aggregated to form the bud). The next graph reports the probability of getting a bud whose dimension (i.e. the number of coat proteins assembled around the bud) is given by the value in the axis of abscissa. The study is performed for two different values of the rate at which coat proteins assemble, given by constant rc. The rate rf of the fission rule used for this experiment is 0.5, while rd, the rate of diffusion of particles in and out of the bud, was set to 1.

Another interesting analysis consists in the study of the number of particles present in the bud after fission. The following graph shows how such a value depends on the rates rc and, in particular, rd which models the movement of the particles between the two compartments. Again, we set rf=0.5.

