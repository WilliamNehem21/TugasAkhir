Widening operators have various unpleasant properties. The best known is that they bring imprecision: the result of widening/narrowing iterations may be strictly larger than the least element of the abstract domain that is an inductive invariant, let alone an invariant (in Sec. 5 we shall list some alternative approaches that do not suffer from this inconvenience, at the expense of generality). The contribution of this article is a generic method to reduce some of the imprecision induced by widening.

Program 1 is an abstraction of Program 2: each execution of the latter maps to an execution of the former. Yet, the analysis of the former produces a more precise loop invariant than the analysis of the latter. This is an example of the non- monotonicity of analyzes using widenings, a long-known phenomenon [7, ex. 11]: a more precise abstraction may ultimately lead to less precision in the final analysis result.

8 The standard widening on polyhedra P1oSP2, in intuitive terms, suppresses from P2 constraints not present in P1. In reality, its correct definition contains subtleties regarding polyhedra of dimension less than the dimension of the space, and the original definition [8] had to be corrected [11]. [1] recalls the corrected definition.

9 The fact that widenings followed by reductions with cycles (reduce a using b, then reduce b using a) may not ensure termination is already known. For instance, closure in difference-bound matrices and octagons breaks termination. [15, example 3.7.3, p. 85]

LAO Kernels is a set of benchmarks internally used for the evaluation of com- pilers code generators and optimizations. It is mainly composed of small computa- tional kernels representative of the target applications of STMicroelectronics (audio and video stream processing, embedded device control), associated with a testing harness to be able to run them on the target processor. It contains 63 functions, of which 49 contain at least one loop. Loops have to exhibit some properties, like a non-linear relation between variables in the loop scope, in order to benefit from this method. Stratified analysis finds a more precise invariant for 5 of these functions.

