This paper addresses the graphical representation of static aspects of B specifications, using UML class diagrams. These diagrams can help understand the specification for stakeholders who are not familiar with the B method, such as customers or certification authorities. The paper first discusses some rules for a preliminary derivation of a class diagram. It then studies the consistency of the concepts preliminarily identified from an object oriented point of view. A formal concept analysis technique is used to distinguish between consistent classes, attributes, associations and operations. The proposed technique is to incrementally add operations to the formal specification which automatically result in evolution of the class diagram.

In order to bridge this gap, several research teams have proposed ap- proaches to integrate formal and graphical specifications [14,15]. A possible integration strategy is to give graphical syntax to existing notations, e.g. in the early 90s Dick and Loubersac [5] proposed a graphical syntax for VDM. Another approach is to design industrial languages which integrate formal concepts. This approach underlies the development of several UML notations. For example, UML State Transition diagrams are deeply influenced by several state machine languages, and in particular Statecharts[9]. Also the Object Constraint Language [23] includes concepts from model-based specification languages such as Z[20].

A significant effort has been devoted by the research community in or- der to establish links between UML and formal methods. In particular, sev- eral approaches provide translations from annotated UML diagrams to formal methods [6,11,13,16,18,19]. These approaches aim to take advantage of for- mal methods tools while remaining integrated in a standard industrial process based on UML.

This paper investigates the reverse approach: using graphical notations, such as UML diagrams, as a way to document formal developments. It starts from the fact that several significant formal developments are mainly based on formal methods. For example, the B method has been used in industrial railway[1] and smart card[4] applications. Such critical applications must usu- ally be accepted by independent certification authorities that are not necessar- ily expert in formal methods. Therefore, it makes sense to construct graphical views from the formal developments as an additional documentation. It is expected that these more intuitive representations will be easier to accept by certifiers.

Tools that represent the behaviour of the specifications. [2] is the first proposal for the derivation of a visual representation of the behaviour of a given B specification. This behaviour is described using finite Labelled Transition Systems (LTS). Starting from a user-guided choice of signifi- cant states, proof techniques are used to explore all the valid transitions of the system. The resulting LTS can then be further reused to verify temporal logic properties by model-checking. In the same context [22,8] proposed some derivation rules for the generation of statecharts from B specifications. Finally, in [17] a tool assisting the animation of B specifi- cations is presented, it also helps in the construction of state transitions diagrams. In these diagrams states are valuations of B variables and transitions are some operation call.

This paper studies the first kind of tools which extract a structural view from existing formal specifications in order to ease their understanding and maintenance. The extraction of structural information is a classical problem in the software maintenance community. In fact, understanding how an ap- plication is organized is a major factor when maintaining it especially when its structure is complex and documentation is unavailable or outdated. Most of program comprehension techniques aim to give a modular restructuring of software which eases its maintenance. We believe that similar techniques can be applied to formal specifications.

While the first step is only concerned with the variables of the B specifi- cation, the second step (Sect. 3) also takes into account the operations. A concept dependance technique is used to help locate the appropriate class for each operation.

UML class diagrams and B share similar concepts such as the encapsulation of operations and variables, or the notion of association. This motivates several researches to translate one language into the other. This section will highlight how this overlap of concepts can be exploited to automatically translate B specifications into a UML class diagram.

SOURCES and ADDRESSES. The network resources are essentially comput- ers identified by their IP addresses (variable IpAddress). Users must have a permission to access to a given resource (variable Permitted ). A user can only use one resource at a time. The variable Assigned means that a user is using a resource. Finally, the subset of RESOURCES called Unused gives the set of unused resources. We consider three basic operations:

An association is a bidirectional connection expressing a relationship between classes. It is an abstraction of the possible links existing between objects instances of classes. As we translated abstract sets into classes, associations will be every relation existing between these sets.

In UML some constraints should be expressed on a relation or a group of relations. For example in the AccessControl machine invariant properties define a constraint between the two relations Permitted and Assigned. This constraint could be seen as the traditional subset constraint between two col- lections (also called roles).

The rules given in [21] generate classes for every machine, set, and rela- tion of the B specification. Moreover, these classes are linked by numerous associations. Only boolean and integer variables become attributes of these classes. This results in many more classes than our approach and hence in more complex diagrams.

The previous section has identified a set of class candidates. In this section, we will try to sort out these candidates into potential classes or attributes. In order to evaluate the pertinency of a class candidate, a concept dependance context will be built which relates the class candidates to the operations of the specification.

Our study is focused on the dependance between B operations and data identified in the preliminary class diagram. First, we study the relationship between B operations and classes and associations of the preliminary class diagram in order to determine their pertinence from an object oriented point of view. Then, we decide about the distribution of those elements over the pertinent class diagram entities. Finally, we add the other data of the B specification as attributes of the definitely identified classes.

Pertinency is thus defined on basic of operation pertinency. In order to measure operation pertinency, we use a concept dependance graph. Elements of the preliminary structure and operations form a context called concept dependance context. In the defined context we consider only concepts from the preliminary class diagram which are manipulated by the operations. Concepts correspond thus to either classes or associations.

Although Permitted was a maximal part, it is not a pertinent association because it does not satisfy definition 3.6. Also, following rule 6, USERS can either become an attribute or a type. Since it is a constant set, we felt it should be modelled as a type.

The approach of [21] systematically groups operations of the B machine in the class corresponding to the machine. In the section 4, we will see that our method does not always result in grouping all operations in a single class. We feel that this ability to share operations amongst several classes is definitely needed when B machines get larger.

Although formal methods provide excellent techniques for the precise descrip- tion of systems, understanding these descriptions is often restricted to experts. This paper has presented a technique that helps build a graphical representa- tion of the static aspects of B specifications. These diagrams are expected to be more intuitive and readable than the original formal specification.

This paper has proposed a two-step approach to the construction of a class diagram from a B specification. The first step applies systematic transforma- tion rules to the B specification and produces a preliminary class diagram whose goal is to identify candidate concepts. The second step relates these concepts to the B operations and keeps the most pertinent ones. This second step is original with respect to existing approaches such as [7,21]. We have led several case studies with the three approaches, including the one presented in this paper. In each case, we felt that our approach gave at least as good results as the other ones.

