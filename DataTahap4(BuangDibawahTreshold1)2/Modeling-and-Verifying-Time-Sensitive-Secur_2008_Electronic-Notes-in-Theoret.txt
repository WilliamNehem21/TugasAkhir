and retransmission. R.Corin concerns how to model and verify contiguous time by time automata, and studies attacks in timeout and retransmission in [7]. Gorri- eri studies a real-time process algebra presented for the analysis of time-dependent properties, and focuses on composite results in [13]. Jeremy Y.Lee describes an al- gebra for modeling the real-time aspect of systems in a mobile environment, which is the extended algebra by introducing a timeout operator in [15]. [20] studies a compositional denotational model for Timed CSP, and it focuses on timeout and re- transmission, but not in the characteristic of time stamps. However, those methods all cannot construct counter-examples automatically.

The paper is organized as follows. In Section 2, we introduce the process calculus used to describe security protocols formally and naturally. In Section 3, we discuss the extended model on Horn logic with time constraints, translation of a protocol from the process calculus to the Horn logic, and verification on the Horn logic with time constraints. In Section 4, we discuss the characteristic of constraints in our model and give a method to determine if there is a solution for the constraints. In Section 5, we analyze Denning-Sacco protocol in detail. Section 6 concludes the future work.

This paper is interested in verification of security protocols with time stamps, and discusses how to verify time sensitive security protocols in the model with con- straints on Horn logic. So we are interested in how to consolidate the protocol model on Horn logic with time constraints so as to model and verify time sensi- tive security protocols. For the sake of simplicity, this paper will not introduce the verification on Horn logic in [1,3,4].

The model of roles in security protocols is a group of logic rules. In logic rules, encrypted data is represented as term encrypt(x,y) abbreviated to {x}y , where y is a term like Kas denoted a key shared between a and s, and x is a term. d is a parameter representing network delay. If we want to do anything with some rule, we must be sure that its constraints can be satisfiable.

The translation of a process is a set of Horn clauses with constraints that enable us to prove that it sends certain messages or executes certain events in the constraints. The list C keeps conditions, and when they are satisfiable, the rule may fire. The translation of those events without modifying constraints is the same as [4]. So we will present the last four events in this paper.

Definition 3.10 [Derivation sub-tree] Let P be the extended Horn logic model of a security protocol and F be a closed atom, T is a derivation tree of F whose constraints tag is C. T ' is called a derivation sub-tree of T if T ', whose constraints tag is H correspond expC(C) f ind corr exp(C, fv(T ')) , is obtained by cutting some edges in T and all branches starting from these edges. If T ' has n nodes, then T ' is called an n-nodes derivation sub-tree of T.

From the analysis of our method, there is no problem in verifying time sensitive se- curity protocols in Horn logic model. But it is also important to determine whether the constraints system has a solution or not. Though there are so many methods to solve linear constraints, such as the method of Simplex and the algorithm of Fourier-Motzkin [8][22], these methods pay attention to the general linear systems and are complicated to be implemented. When there are symbolic arguments in constraints system, it is very difficult to determine the solution by these methods. Therefore, this section will discuss the satisfiability of our constraints system.

We would like to thank Prof. Xiaoyu Song for useful discussions about the structure of this paper and useful modifications for its presentation. We would also like to thank the anonymous referees, whose useful comments have greatly improved the quality of this paper.

