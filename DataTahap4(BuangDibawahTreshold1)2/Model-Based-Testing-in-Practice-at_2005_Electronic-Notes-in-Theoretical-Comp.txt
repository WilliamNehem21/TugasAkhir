As part of Microsofts Trustworthy Computing [4] initiative the company has sought many ways to increase reliability. One approach being extensively investigated and used is Model Based Testing. With a Finite State Machine modeling tool (TMT) successfully deployed and in use by many test groups, a need for more powerful and flexible modeling has arisen. Several product groups are exploring the use of the Abstract State Machine Language (AsmL) and its associated test tool (AsmL/T). Results from both approaches have shown an increased ability to find defects earlier, including in the specification and design stages, as well as achieve higher structural code coverage on the actual systems under test.

Most test engineers test software by observing its external behavior, a process called black box testing. In the past most tests have been designed by hand. As the complexity of the software and environment in which Microsoft prod- ucts must operate increases, demand for designing and especially maintaining tests more easily has arisen. While many testers implicitly or explicitly use models in their heads and some even write them down, the lack of automation prevents fully exploiting the Model Based Testing approach.

Directed generates all available test cases up to a certain number of steps. Shortest Path allows you to specify where you want your test case to begin and end, and returns the shortest path between these two points. All Short- est Paths finds all the possible ways to begin and end a test case, and returns the shortest paths between all of these points. ShortestPath-Random or ShortestPath-Directed These queries let you combine two queries. You pick a specific state you would like to get to using a shortest path and then the query creates a random or directed set of test cases from the specific state your picked. You can use these queries to generate test cases that exercise the riskiest areas of your product.

TMT supports simple model checking in the form of assertions. Assertions are statements that the tester makes about their area that should never be broken. Assertions are not only useful for ensuring the quality of the model; but can also be used to ensure the quality of the spec the model was built from.

TMT outputs test cases as XML files called XML Test Cases (xtc). TMT also generates an automation template. The tester writes the automation that will run them. This was the first tool that truly helped with test design automation instead of just test execution automation.

TMT is used by over 20 teams at Microsoft. Time to automate fell by as much as 88%. BizTalk took one week to generate a set of test cases that took eight weeks by hand. Code coverage increased by as much as 50%. One sub- team in Shell in two weeks increased code coverage from 20% to 75%, while the number of test cases increased from about 75 to 2000. Many spec and implementation bugs are uncovered in the course of model creation. [10]

.NET assemblies which can be executed from the command line, linked with other .NET assemblies, or packaged as COM components. AsmL specifica- tions provide a precise, non-ambiguous way to specify a computer system, either software or hardware. Program managers, developers, and testers can all use an AsmL specification to achieve a single, unified understanding. One of the greatest benefits of an AsmL specification is that you can execute it. That means it is useful before you commit yourself to coding the entire system. By exploring your design, you can answer the following questions:

Indigo is based on a number of industry defined standards for Web Services (WS). During the drafting of these standards parts of the Indigo test team modeled the specifications with help from FSE. Modeling the WS-Routing specification [6] in about a week we found twenty issues using the AsmL model which had taken months for authors to find out the same in design / archi- tecture meetings. Modeling the WS-Policy specification [7] found six issues which all got fixed. We found additional issues in revisions of the specification. Modeling the WS Atomic Transactions specification [10] numerous specifica- tion issues were raised. New Passport login protocol modeled in AsmL raised so many specification issues that the specification was rewritten entirely.

In WS-Routing testing of Web Service Extension 1.0 [8], one incompatibility issue was found after it had already been traditionally tested. In an early implementation of WS-Policy by Indigo, AsmL/T parameter generation was used to generate variations of policy which found 13 bugs in the implemen- tation. More than three very insidious bugs were found in the Indigo early implementation of WS-AtomicTransaction.

