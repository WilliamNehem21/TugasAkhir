 AASRI Procedia  9 ( 2014 )  99 – 106 
Available online at www.sciencedirect.com
2212-6716 © 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license 
(http://creativecommons.org/licenses/by-nc-nd/3.0/).
Peer-review under responsibility of Scientific Committee of American Applied Science Research Institute
doi: 10.1016/j.aasri.2014.09.017 
ScienceDirect
2014 AASRI Conference on Circuit and Signal Processing (CSP 2014) 
Application of Nonlinear H∞ Filtering Algorithm for Initial 
Alignment of the Missile-borne SINS 
Zhiqiang Wua, Yu Wanga, Xinhua Zhua,* 
aSchool of Mechanical Engineering, Nanjing University of Science and Technology, Nanjing 210094, China 
 
Abstract 
The H∞ filtering and Unscented Transformation(UT) algorithm are introduced to deal with the initial alignment error of 
missile-borne Strapdown Inertial Navigation System(SINS), which is caused by the nonlinear error model and the 
uncertainty of the disturbance noise. Firstly, on the basis of additional quaternion error, the error model of SINS is built up. 
Secondly, the nonlinear H∞ filter based on UT and H∞ filtering is constructed, which is with nonlinear approximation 
ability and strong robustness. Finally, simulations are made compared with UKF and the nonlinear H∞ filter under the 
conditions of disturbance model of strong wind. The result shows that nonlinear H∞ filter is more stable and faster than 
UKF under the disturbance conditions of strong wind and can effectively improve the accuracy of initial alignment and 
robustness of the algorithm. 
 
© 2014. Published by Elsevier B.V. 
Selection and/or peer review under responsibility of American Applied Science Research Institute 
 
Keyword: Strapdown Inertial Navigation System; initial alignment; additional quaternion error; nolinear H∞ filtering; large initial 
attitude error 
 
 
* Corresponding author. Tel.: +86 13601404770; fax: +86 2584303258. 
E-mail address: zhuxinhua@njust.edu.cn. 
© 2014 The Authors. Published by Elsevier B. V. This is an open access article under the CC BY-NC-ND license 
(http://creativecommons.org/licenses/by-nc-nd/3.0/).
Peer-review under responsibility of Scientific Committee of American Applied Science Research Institute
100  
 Zhiqiang Wu et al. /  AASRI Procedia  9 ( 2014 )  99 – 106 
1. Introduce 
Initial alignment is one of the most momentous technologies in a Strapdown Inertial Navigation 
System(SINS). Under the circumstances of low sensor accuracy and external disturbing motion, one crucial 
problem in initial alignment of missile-borne SINS is how to verify the initial transformational matrix from 
the missile body’s coordinate system to the navigation coordinate system efficiently and accurately. Initial 
alignment of missile-borne SINS can be divided into two categories: autonomous alignment after launch and 
transfer alignment before launch. In both modes, the SINS is in constant motion with drastic posture changes, 
thus frequently influenced by uncertain disturbance. Traditional Kalman Filtering requires the accurate priori 
knowledge of the mathematical model of the studying object and the noise being white noise. However, when 
in missile-borne situation, the noise tends to be colored type. In combination with the error in system model, 
there will be filter divergence if traditional Kalman Filtering is applied. Therefore, the properties of being 
robust and nonlinear are required in the initial alignment of missile-borne SINS. 
A good number of researchers are involved in developing robust nonlinear filtering algorithm. Literature [1] 
deals with the rapid alignment of ship-borne weapon INS with large initial azimuth attitude error under 
complex environment disturbances. Based on the nonlinear error propagation model, velocity plus angular 
rate matching method was applied in the implementation of the alignment. Literature [2] suggests a 
quaternion-based nonlinear error model in rapid transfer alignment. Literatures[3-5] carry out an intensive 
study in H∞ filtering. It is suggested that due to its significant effect in uncertainty disturbed moving-base 
rapid alignment, this filtering is appropriate both for linear and nonlinear models. Moreover, when there is 
colored noise or unmatched models, H∞ filtering still keeps its robustness. Based on the research above, it is 
found that applying H∞ filtering to the initial alignment in SINS is an effective estimating method in that it is 
relatively more rapid, accurate and robust, and is more suited to this application.    
To deal with the problems of nonlinearity of error model and the disturbance-induced uncertainty in noise 
in SINS moving-base initial alignment, a quaternion-based nonlinear error model is introduced, and through 
enhancing the approximation ability of nonlinear model with Unscented Transformation (UT) algorithm and 
increasing the robustness to uncertain noise in filtering process with H∞ algorithm, a new H∞ filtering 
algorithm is put forward. Simulations are made compared to conventional Kalman algorithm in the condition 
of large misalignment angle and strong wind. It is verified that this algorithm is effective in the initial 
alignment of missile-borne SINS. 
2. System Model 
The posture error in navigation system refers to the mal-alignment angle (or misalignment angle) between 
platform coordinate system and navigation coordinate system. In a SINS, quaternion describes the 
transformational relation between carrier coordinate system (system b) and navigation coordinate system 
(system n). Thus, the calculation error of quaternion can be used to decide the mal-alignment angle of the 
carrier. 
Additive quaternion error (AQE), which is the difference between calculative quaternion and actual 
quaternion, can be described as: 
�
�
T
n
b
n
b
q
q
q
q
Q
Q
Q
3
2
1
0
ˆ
�
�
�
�
�
�
�
�
                                                                                      (1) 
In the equation above, 
n
b
Q  is the actual quaternion from the carrier system to navigation system. ˆ n
b
Q  is 
101
 Zhiqiang Wu et al. /  AASRI Procedia  9 ( 2014 )  99 – 106 
the calculative quaternion. 
Considering the short span of the alignment process, the influence of location error is ignored. Meanwhile, 
the measurement error of the accelerometer and gyro can be regarded as the sum of random constant and 
white noise. The posture error equation is: 
�
�
�
�
�
�
n
en
n
b
b
ib
n
b
n
in
b
ib
Y Q
U Q
Q
Q
Q
��
��
� �
�
�
�
ˆ
2
1
ˆ
2
1
2
1
2
1
�
�
�
�
�
                                                     (2) 
In this equation, 
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
0
1
2
3
1
0
3
2
2
3
0
1
3
2
1
0
q
q
q
q
q
q
q
q
q
q
q
q
q
q
q
q
Q
n
b
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
0
0
0
0
x
y
z
x
z
y
y
z
x
z
y
x
b
ib
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
0
0
0
0
E
N
U
E
U
N
N
U
E
U
N
E
n
in
�
�
�
�
�
�
�
�
�
�
�
�
�
 
b
ib
� represents the projection of the angular speed of relative inertial frame (system i) on system b. 
n
in
�  
represents the projection of the angular speed of relative inertial frame (system i) on system n. Equation (2) is 
the linear differential equation of Q
�
, and in the derivation, misalignment angle is not assumed to be a 
minimum. So, the carrier’s posture error propagation characteristic in a large misalignment angle is accurately 
represented in it. 
The speed error equation [8] goes like this: 
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
2[
]
( )
2
(
) (
)
(
)
n
n
b
T
n
b
T
T
T
b
b
b
n
b
n
n
n
n
b
ie
in
en
V
C f
Y
Q
C f Q
Q
Y
Q U
Q
f
C
V
V
�
�
�
�
�
�
�
��
� �
�
�
�
�
� �
�
�
�
�
                                          (3) 
In the equation (3), 
n
b
n
b
n
b
C
C
C
�
�
�
ˆ
illustrates the calculative error of posture matrix, and 
b
n
b f
�C ˆ
 is 
the nonlinear function of Q
�
. 
The speed error in the northeast day coordinate system and the quaternion errors are set to be State 
Variables, while the speed error as measured signal, the system-state equation and measuring equation are 
presented as follows: 
( )
( , )
( )
x t
f x t
Gw t
�
�
      ( )
( )
( )
z t
Hx t
v t
�
�
                                                                                (4) 
( , )
f x t
can be divided into two parts of linear and nonlinear, so equation (4) can be transformed into  
0
( )
( ) ( )
( , )
( )
x t
F t x t
p x t
G
� t
�
�
�
                                                                                                       (5) 
In this equation, 
102  
 Zhiqiang Wu et al. /  AASRI Procedia  9 ( 2014 )  99 – 106 
�
�
b T
z
b
y
b
x
b
z
b
y
b
x
u
n
e
q
q
q
q
V
V
V
x
�
�
�
�
�
�
�
�
�
�
�
�
�
�
3
2
1
0
, 
and 
the 
coefficient matrix 
( )
F0 t
 is the linear part, which is described as: 
�
�
�
�
�
�
�
�
�
�
�
�
�
0
0
0
0
( ˆ )
2
1
0
0
( )
0(22)
(21)
0
0(12)
(11)
0
0
n
b
n
b
U Q
F
F
C
F
F
t
F
                                                                                                            (6) 
In this equation, 
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
� �
�
� �
�
� �
�
�
�
�
0
2
)cos
(2
)
/(
)sin
(2
)cos
(2
)sin
(2
)
/(
)
/(
tan
0(11)
�
�
�
�
�
�
�
�
�
�
�
�
L
h
R
v
L
L
L
h
R
v
h
L R
v
F
M
U
N
U
N
N
�
�
�
� �
T
b
n
b
T
b
n
b
C f Q
Q
Y
C f
F
2 ˆ ˆ ˆ
ˆ
2 ˆ ˆ
0(12)
�
�
� �
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
0
0
)
/(
tan
0
0
)
/(
1
0
)
1/(
0
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
2
1
0
1
2
1
0
3
2
3
0
3
2
1
(0 21)
h
R
L
h
R
h
R
q
q
q
q
q
q
q
q
q
q
q
q
F
N
N
M
���
�
n �
in
b
ib
F
�
�
2
1
2
1
0(22)
�
�
�
The nonlinear part is defined as
( , )
p x t
,
1
ˆ
( , )
(
) (
)
( , )
0
0
T
b
f x t
Y
Q U
Q f
p x t
�
�
�
�
�
�
�
�
� �
�
�
�
�
�
�
�
, and the 
measurement matrix is
�
�
3 3
0
H
� I �
 
3. Nonlinear H∞ Filtering Algorithm 
H∞ filter are applied in the initial alignment of missile-borne SINS. When the missile body is disturbed by 
airflow, the system noise is colored, and modelling error exists. Severe divergence will arise in traditional 
Kalman filtering. However, H∞ filtering still keeps its strong robustness. Therefore, H∞ filtering being 
applied in the initial alignment of missile-borne SINS breaks the restriction of Kalman. H∞ filtering is a much 
more applicable and effective estimating method. 
On the basis of Unscented Transformation and H∞ algorithm, this chapter employs the algorithm idea in 
literature [9] and puts forward a UT and H∞ based algorithm, which is referred to as nonlinear H∞ filter. This 
algorithm uses unscented transformation in nonlinear fitting, and adopts average H∞ algorithm in 
modification, which endow it with better nonlinear approach capacity than Extended Kalman Filter (EKF) and 
stronger robustness than Unscented  Kalman Filter (UKF).   
3.1. Principle of Unscented Transformation 
When parameterizing the statistical property of a random variable with a cluster of discrete sampling 
points, these points are named Sigma Points. Suppose that the input state x is the dimension vector of L, 
Sigma Points can be selected according to the principle below. 
x � x
0
 ;
L
i
P
L
x
x
i
x
i
2,1 ,......,
)
)
( (
�
�
�
�
��
�
;
L
L
L
i
P
L
x
x
i L
x
i
2,......,2
,1
)
)
( (
�
�
�
�
�
�
� ��
�
          (7) 
103
 Zhiqiang Wu et al. /  AASRI Procedia  9 ( 2014 )  99 – 106 
In the equation (7), 
L
K
L
�
�
�
)
� 2 (
�
 is the parameter for distribution. � represents the distribution of 
sampling point near x , whose value range is 
1
10 4
�
� �
�
; K is normally valued 0 and 
xP i
L
)
)
( (
� �
 represents 
the matrix square root line i. Put the selected state vector into the nonlinear function  
f � �
, i.e. 
L
i
f x
Y
i
i
,...,2
2,1,0
),
(
�
�
�
, then weigh the output statistical property of the approximation analysis system. 
�
�
�
L
i
i
m
Wi Y
y
2
0
          
�
�
�
�
�
L
i
T
i
i
c
i
y
y
y Y
Y
W
P
2
0
)
)(
(
 
In the equation above,  
1
2
0
�
�
�
L
i
Wim
�
1
2
0
�
�
�
L
i
Wic
. And the typical initial
m
W0 and
c
W0 are:    
0
W m
L
�
�
�
�
         
2
0
1
Wc
L
�
�
�
�
�
� �
�
�
                                                                                                          (8) 
And,� , the scale parameter, which decides the distribution range of sigma points, is normally valued a 
small positive number. �  is used to describe the distribution of x, which is optimal in normal distribution. 
� � 2
; 
L
i
L
W
W
c
i
im
2,1 ,...2
,)
2(
1
�
�
�
�
�
�
. 
3.2. H∞ Filtering Algorithm 
For the discrete system 
k 1
k
k
k
k
x
F x
G w
� �
�
        
k
k
k
k
y
H x
v
�
�
                                                                                          (9) 
In the equation (9), x  represents the un-estimated state vector. For the easy use of filter, an estimator is 
added. 
k
k
k
z
� L x
          
kL
� I
                                                                                                                       (10) 
For the given positive number � , if �
�
K
K
F
G
 is in full rank, the necessary and sufficient condition of 
the existence of H∞ filter is that the positive definite symmetric matrices must meet the f Riccati equation 
below. 
1
1
1
/
/
1
0,
0,...,
i
i i
i i
i
i
i
i
H
P
P
H
L
R
i
k
L
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
,and 
2
0
0
i
I
R
I
�
�
�
� �
�
�
�
�
 
For a given positive number � , the estimated state of the system vector is[4] 
/
ˆ /
ˆk k
k
k k
z
� L x
                                                                                                                                          (11) 
104  
 Zhiqiang Wu et al. /  AASRI Procedia  9 ( 2014 )  99 – 106 
The recursive formula of 
/
ˆk k
x
 is [4] 
/
/
1
/
1
ˆ
ˆ
ˆ
(
)
k k
k k
k
k
k
k k
x
x
K
y
H x
�
�
�
�
�
     
1
/
/
2
1
(
)
k
k k
k
k
k k
k
K
I
P L L
P H
�
�
�
�
�
�
                                                     (12) 
The formula with time updated is:  
1/
/
ˆ
ˆ
k
k
k
k k
x
F x
�
�
       
1/
/
k
k
k
k k
k
k
k
P
F P F
G G
�
�
�
�
�
 
3.3. Design of nonlinear H∞ Filter   
According to the addictive-quaternion-error-based system equation, when there is a nonlinear section in 
the state equation of the system, dealing with this nonlinear problem using UT avoids the linear errors caused 
by EKF. Then standard H∞ filtering algorithm is applied to get the nonlinear H∞ filtering algorithm, which is 
performed as follows. 
First, initialization, which involves the initial predicted filtering figure, covariance matrix
0P  and the 
system noise covariance matrix 
0
Q . Calculate the sigma points using equation (7), with L=n. 
0
ˆ
X
� x
;
ˆ
( (
)
)
i
x
i
X
x
n
� P
�
�
�
1,2,...,
i
n
�
;
ˆ
( (
)
)
i
x
i n
X
x
n
� P
�
�
�
�
1
,2
,...,2
i
n
n
n
� �
�
 
Second, with the constant use of UT, solve the mean value and covariance of the nonlinear function . 
i. Get the sigma points mapping collection of the nonlinear function.
/
1
/
1
(
)
((
) )
k k
i
k k
i
X
f
X
�
�
�
1,2,...,2
i
n
�
 
ii. Predict the mean value of the nonlinear function
2
/
1
/
1
0
ˆ
(
)
n
m
k k
i
k k
i
i
x
W
X
�
�
�
��
. 
iii. Predict the covariance of the nonlinear function
2
/
1
/
1
/
1
/
1
/
1
0
ˆ
ˆ
[(
)
][(
)
]
n
c
T
k k
i
k k
k k
k k
k k
i
P
W
X
x
X
x
�
�
�
�
�
�
�
�
�
�
. 
Third, calculate the gain matrix of the H∞ filtering. 
i. Get the covariance matrix
kP . 
1
1
/
1
/
1
1
1
1
/
1
1
k
T
T
k
k k
k k
k
k
k
k k
k
H
P
P
P
H
L
R
P
L
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
  ; 
1
/
1
1
1
2
1
0
0
k
T
T
k
k k
k
k
k
H
I
R
P
H
L
L
I
�
�
�
�
�
�
�
�
�
�
�
�
�
� �
�
�
�
�
�
�
�
�
�
�
 
ii. Get the gain of filtering. 
1
(
)
T
T
k
k
k
k
k
k
K
PC
I
C PC
�
�
�
   
Finally, modify the measurement of state. 
/
1
1
/
1
ˆ
ˆ
ˆ
(
)
k
k k
k
k
k
k k
x
x
K
y
C x
�
�
�
�
�
�
      
4. Simulation Result 
Using the nonlinear H∞ filtering algorithm, the initial alignment in large misalignment angle under wind 
disturbance is simulated. In the simulation, suppose that the angle of pitch ranges between 45°±5° and the 
frequency is 2 Hz, and that the roll angleψranges between 0°±3°, and the frequency is 10Hz. The constant 
drift of gyro signal is 0.01°/s; the mean square root of white noise drift is 0.01°/s; the time span for first order 
markov process is 3600s; the square root of white noise is 0.01°/s. The accelerate bias is 10-4g; the mean 
square root of random white noise is 10−4 g; the time span for first order markov process is 1800s; the square 
root of white noise is 10−4 g. The posture updating cycle is 1ms; the filtering cycle is 100ms; 
� � 5
. While 
the wind disturbance is irregular, its scope and frequency range are known. Thus a disturbance model is set 
105
 Zhiqiang Wu et al. /  AASRI Procedia  9 ( 2014 )  99 – 106 
accordingly. Fig. 1 illustrates the results of simulation. 
2.0
0.15sin(2
)
0.2sin(
0.5)
0.5sin(0.5
)
2.7
0.15sin(2
)
0.2sin(
0.5)
0.3sin(0.5
)
x
y
t
t
t
t
t
t
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
�
                                                       (13) 
In Fig. 1, curve 1 presents the filter results of UKF, and curve 2 describes the filter results using nonlinear 
H∞ filter algorithm. The alignment errors brought about by high frequency component in the wind-disturbing 
model are effectively restrained through UKF and nonlinear H∞ filter. The influence of low frequency 
component becomes the major interference source. As shown in Fig. 1, due to the influence of low frequency 
interference, the east misalignment angle errors estimated by UKF shows a diverging trend, which fails to 
achieve stable state even at 200s. By contrast, the nonlinear H∞ filter algorithm becomes stable within 50s, 
with the east misalignment angle errors confined to 4.733´. The north misalignment angle errors estimated 
with UKF are confined quickly, but unstably, with some fluctuations. However, the errors estimated by H∞ 
filter algorithm, though confined to a below-theoretical-accuracy figure of 7.243´, are stable. These results 
demonstrate that if the linearity of the error model is focused while sensor accuracy and the uncertainty of 
noise are neglected, there will be relatively large alignment errors in the initial alignment of missile-borne 
SINS. The result that the accuracy of H∞ filter algorithm is lower than theoretical level demonstrates that the 
robustness of the filter is achieved in the price of sacrificing filtering accuracy. The results of simulation show 
that nonlinear H∞ filter algorithm possesses certain robustness to the external interference. This algorithm can 
meet the requirements of accurate and rapid initial alignment in missile-borne SINS.  
 
 
Fig.1. Curves of UKF and nonlinear H∞ filter under disturbance, (a) eastward misalignment angle error, (b) northward misalignment 
angle error 
5. Conclusion 
Due to the restriction of sensor accuracy and external interference in missile-borne SINS, conventional 
linear error equation and Kalman filter algorithm can no longer deal with the problem of initial alignment. 
This thesis explores the initial alignment if missile-borne SINS. Firstly, addictive-quaternion-error-based 
nonlinear error equation, unscented transformation algorithm and H∞ filter are introduced. To solve the 
problem of linearity of the system equation and external interference, a new nonlinear H∞ filter algorithm is 
then proposed. The digital simulation compares the filter effect of UKF and nonlinear H∞ filter under the 
circumstance of strong wind interference. Results demonstrates that the nonlinear H∞ filter algorithm is 
superior than UKF in terms of accuracy and robustness. 
106  
 Zhiqiang Wu et al. /  AASRI Procedia  9 ( 2014 )  99 – 106 
References 
[1] Xin Liu, Bo Wang, Zhihong Deng. Rapid alignment method of INS with large initial azimuth uncertainty 
under complex dynamic disturbances. Proceeding of the 2012 UKACC International Conference on Control, 
Cardiff UK, 2012: 1070-1075.  
[2] Hao Y, Xiong Z, Wang W, et al. Rapid transfer alignment based on unscented Kalman filter. Proceedings 
of the 2006 American Control Conference. Minneapolis USA, 2006:2215-2220.  
[3] Ryu J H, Kim C S, Lee S H, et a.l. H∞ infinity lateral control of an autonomous vehicle using the RTK-
DGPS. International Journal of Automotive Technology, 2007:8:583- 591. 
[4] ZHANG Tao, XU X iao-su. Research on SINS Initial Alignment and the Methods for the Parameter γ 
Selection Based on H∞ Filtering Technique. Journal of Sichuan University (Engineering Science Edition), 
2009:4:240-245. (in chinese) 
[5] You-chol Lim, Joon Lyou. Transfer alignment error compensator design using H∞ filter. Proceeding of 
American Control Conference. 2002:1460-1465. 
[6] Xiaoying Kong, Eduardo Mario Nebot, Hugh Durrant-Whyte. Development of a non-linear psi-angle 
model for large misalignment errors and its application in INS alignment and calibration. Proceedings of the 
1999 IEEE International Conference on Robotics & Automation, Detroit USA. 1999:1430-1435. 
[7] Yuanxin Wu, etc. Observability of Strapdown INS alignment: a global perspective. IEEE Transactions on 
Aerospace and Electronic Systems, 2012:1:78-102. 
[8] S.P.Dmitriyev, O.A.Stepanov, S.V.Shepel. Nonlinear filtering methods application in INS alignment. 
IEEE Transactions on Aerospace and Electronic Systems, 1997:1:260-271. 
[9] Zhou Benchuan, Cheng Xianghong. Robust UKF algorithm in SINS initial alignment. Journal of  
Southeast University ( English Edition). 2011:1: 56-60. 
[10] Muhammad Ilyas, Yunchun Yang, Ren Zhang. SINS initial alignment using wavelet de-noising method 
for aircraft navigation. Proceedings of the 10th World Congress on Intelligent Control and Automation. 
Beijing China, 2012: 3921-3926.  
[11] Paul D.Groves. Optimising the transfer alignment of weapon INS. The Journal of Navigation 2003:56: 
323-335. 
[12] M.Reinstein. Evaluation of fine alignment algorithm for inertial navigation. Evaluation.2011:7:255-258,  
