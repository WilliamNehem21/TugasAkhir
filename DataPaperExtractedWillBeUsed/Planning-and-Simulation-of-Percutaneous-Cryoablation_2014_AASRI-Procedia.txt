 AASRI Procedia  6 ( 2014 )  118 – 122 
Available online at www.sciencedirect.com
2212-6716 © 2014 The Authors. Published by Elsevier B. V. Open access under CC BY-NC-ND license. 
Peer-review under responsibility of Scientific Committee of American Applied Science Research Institute
doi: 10.1016/j.aasri.2014.05.017 
ScienceDirect
2013 2nd AASRI Conference on Computational Intelligence and Bioinformatics 
Planning and Simulation of Percutaneous Cryoablation 
Riccardo Dodia*, Federica Ferragutib, Asko Ristolainenc, Cristian Secchib,
Alberto Sannaa
aFondazione Centro San Raffaele, eServices for Life and Health, via Olgettina 60, 20132 Milano, Italy 
bUniversity of Modena and Reggio Emilia, Dep. of Sciences and Methods for Engineering, via Amendola 2, 42122 Reggio Emilia, Italy
cTallinn University of Technology, Centre for Biorobotics, Akadeemia tee 15A-111, 12618, Tallinn, Estonia 
Abstract 
New technological methods to assist percutaneous cryoablation procedures are here presented, namely a planning software 
and a simulation algorithm. The first has the role to calculate a feasible displacement of the tools to ensure an effective 
ablation of the lesion, satisfying well-specified procedural constraints. Starting from intra-operative CT scans of the 
patient, a virtual model of the anatomical site is obtained and uploaded. The displacement of the cryoprobes is computed 
in order to cover the whole volume of the tumour with the developed iceball, but minimizing the damage to surrounding 
healthy renal tissue. On the other hand, the simulation algorithm is a graphical tool useful to assess the temperature 
distribution throughout the evolution of the procedure. A discrete iterative function calculates the heat transfer from the 
probes to the surrounding tissue within a specified three-dimensional grid: the isolation of significant isotherms can help 
to assess whether the whole tumour will be frozen or not. By using a real intra-operative dataset of a successful 
percutaneous cryoablation, the volume of the real iceball has been matched with that generated from the simulator, 
showing a good accuracy in terms of dimension and shape. Even though been designed to be integrated within a robotic 
system, this method is usable and extensible for different purposes and adapted to simulate other scenarios or procedures. 
© 2013 Dodi, Ferraguti, Ristolainen, Secchi, Sanna. Published by Elsevier B.V. 
Selection and/or peer review under responsibility of American Applied Science Research Institute 
Keywords: cryoablation; planning; simulation; iceball. 
* Corresponding author. Tel.: +39 02 2643 2919; fax: +39 02 2643 3997. 
E-mail address: dodi.riccardo@hsr.it . 
© 2014 The Authors. Published by Elsevier B. V. Open access under CC BY-NC-ND license. 
Peer-review under responsibility of Scientific Committee of American Applied Science Research Institute
119
 Riccardo Dodi et al. /  AASRI Procedia  6 ( 2014 )  118 – 122 
1. Introduction 
This work has been developed within I-SUR, a FP7 EU-funded research project which aims at developing 
new technologies and methods to assess the feasibility of the introduction of automation principles in surgical 
robotics; one of the chosen case studies is the percutaneous cryoablation of kidney tumours, which requires 
imaging devices (CT, MR or US) to precisely place one or more cryoprobes directly through the skin into the 
lesion. The cryoablation involves cycles of freezing and thaw in order to kill the tumoral cells while 
preserving the healthy tissue and the surrounding anatomical structures (liver, bowel, spleen, ureters) 
according to Clarke et al, 2007 [1]. This technique represents a valuable alternative to the open surgery or 
laparoscopy, ensuring safety with a low morbidity and high efficacy on oncological results, as reported by 
Mues and Landman, 2009 [2]. The main requirement for the correct execution of this procedure is the 
accuracy in the needle displacement: during the planning phase, the optimal target points for the cryoprobes 
must take into account both dimension/location of the lesion and the temperature distribution of the generated 
iceball (irreversible tissue destruction occurs from -20 °C to -40°C). 
The presented methods aim at assisting the operator – i.e. surgeon or interventional radiologist – in the 
decision making relative to the surgical process. Being the insertion automatic (by the robot, as addressed by 
this project) or manual, the planning of needle insertion is a crucial key point of this procedure, directly 
conditioning the final outcome. The planning software proposed in this work represents a useful tool for the 
purpose, especially when the lesion is hard to reach (e.g. under the ribs) or close to other anatomical structures. 
Moreover, a further advantage here presented is the availability of a 3D simulator to assess the evolution of 
iceball formation and the coverage of the lesion at the end of the process, therefore to validate the planned 
displacement of the cryoprobes even before the insertion and beginning of the ablation cycle. 
In Chapter 2 a brief description of the method used to build the 3D model of patient’s anatomy and iceball 
is reported. In Chapters 3 and 4, respectively, the operative principles of both planning software and the 
simulator are shown. 
Nomenclature 
CT 
Computer Tomography 
MR 
Magnetic Resonance 
US 
Ultrasound 
CAD 
Computer Aided Design 
PDE 
Partial Differential Equation 
2. Building Patient’s Model 
Anonymized series of CT scans from a patient going through kidney tumor cryoablation were retrieved 
from the San Raffaele Turro (Milan) database to reconstruct part of the patient’s abdomen for evaluating the 
iceball growth algorithm. The segmentation of the abdomen covered the right kidney and the surrounding 
structures and organs (i.e. part of liver, ribs, intestine and back-bone). Fat, muscles and skin were segmented 
as homogeneous layer. The models of the organs were segmented from the first series where one of the 
cryoablation needles was already inserted into the kidney tumor. This scan was chosen for good visibility of 
the tumor and for matching the CT scan series with the later phase CT scan series by the using the first needle 
position as a reference. The reconstruction of the organs was done by using open source software 3D Slicer 
[3]. The CT scan with the visible first needle was first cropped down (see Fig. 1) for faster segmentation 
process. The segmentation of the organs was done semi-automatically by using simple region growing 
segmentation algorithm and later repairing the results manually. The segmented layers were then assembled 
into 3D models by using Model Maker module in 3D Slicer. 
120  
 Riccardo Dodi et al. /  AASRI Procedia  6 ( 2014 )  118 – 122 
The segmentation of the iceball was done from a CT scan series with 4 visible needles with similar 
technique described before. Because of the movements of the patient throughout the procedure, the CT scans 
were misaligned. The scans were manually aligned (by changing the image origin of the 4-needle scan) 
according to the first inserted needle’s tip and to the edges of the kidney. The model of the iceball aligned to 
other models can be seen (with blue color) in Fig. 2. Finally, two point coordinates of each needle were 
collected from the CT scan to reconstruct the same situation in the iceball growth simulation (see image above 
right lower corner for the visible needle points), as reported in Chapter 4. 
                         
Fig. 1. Cropped volume of the CT scan            Fig. 2. Models of liver, intestine, aorta, backbone and kidney with iceball from the CT data 
3. Planning of Cryoprobes Displacement 
The planning algorithm, based on the approach described in Torricelli et al., 2013 [4], computes the 
number and the best locations for the cryoprobes to generate an iceball that completely freezes the target 
region, i.e. the tumour, while minimizing injury to the healthy tissue external to the target region. Several 
constraints have to be satisfied while performing the insertion of each needle: forbidden regions have to be 
avoided (i.e. ribs and organs), the specific inserting areas, the maximum relative angle between needles, 
collisions avoidance between needles. The operation principles are reported in the Fig. 3. 
Fig. 3. Operational steps of the Planning Software 
First of all, according to tumor and iceball volumes, an approximated minimum number of iceballs is 
calculated and displaced on a circumference inscribed within the longitudinal section of the target. Then 
Bubble Packing method (Rossi et al., 2008 [5]) is applied to solve problems such as overlapping or excessive 
distance among iceballs: spherical elements (“bubbles”) are generated inside the domain and van der Waals–
like forces (proximity-based, inter-bubble) between them are defined. In this way, two adjacent bubbles 
attract each other when too far apart and repel each other when too close. The objective of the Bubble Packing 
phase is to evenly distribute the cryoprobes, in order to shorten the optimization process in the following 
phases of planning. 
A modified version of the Force-Field algorithm proposed by Lung et al., 2004 [6] is then implemented. 
The goal of this phase is to cover the tumour just by translating the iceballs. For safety reasons, the iceball 
must not extend over 10 mm out of the tumor contour to minimize the healthy tissue damaged. At the 
beginning, the anatomical site is discretized into a set of points – named “defective points” – close together: 
each of them applies on the iceballs an attractive or repulsive force in order to lead them into an optimal 
configuration. These points are used to directly drive the cryoprobes location and can be of different types: 
� External defects – Points outside the tumor but inside the iceballs belonging to healthy tissues included in 
the ablation.. 
� Contour defects – Points located within a 10 millimeters thick shell from the tumor contour and inside the 
iceballs representing the limit for healthy tissue damage. 
� Superposition defects –Points located in the intersection area between two or more bubbles representing 
iceballs superposition. 
(a)
Bubble Packing 
(b)
Force Field Analogy
(Ex. Internal defect)
(c)
Orientation Optimization
(d)
Adding Iceball
121
 Riccardo Dodi et al. /  AASRI Procedia  6 ( 2014 )  118 – 122 
� Internal defects – Points located into the tumor but outside the iceballs, representing areas in the target 
excluded by the ablation but to be necessarily included. 
� Surface defects – Points belonging to the surface of the tumor but not yet covered by the iceballs.. 
External, contour and superposition defects apply a repulsive force on the center of the iceball in order to 
translate the cryoprobes towards the center of the tumour, while internal and surface defects apply an 
attractive force in order to attract the cryoprobes to the internal defective region. Since the initial iceball 
number is a minimum, probably the tumor at the end of Force–Field is not completely covered. Anyway, the 
Force–Field simulation stops when all the iceballs movements would increase the value of an objective 
function defined assigning a weight to each defective typology. In this sense, the resulting iceballs 
configuration represents the optimal solution considering only iceballs translation, but the planning objective 
has not been reached, since defective areas can still be present. At this point, the algorithm determines if it 
would be worth pursuing the orientation optimization by analyzing the amount of uncovered surface. If not, 
the algorithm adds another bubble and goes back to Phase 1. 
Next step is Orientation Optimization, targeted to complete the tumor coverage rotating the iceballs 
coming from the Force– Field Analogy and satisfy the constraints to needle insertion by moving the iceballs 
to solve the collisions while maintaining an optimal configuration. The needle shape is considered as a 
straight line passing through the iceball center and the tip. The probe parameters (length and diameter) are 
taken from manufacturer’s datasheet. Depending on the nearest defective region, one iceball is rotated 
towards the center of mass of that area. During iceball rotation, constraints are constantly checked and 
alternative solutions are introduced just in case some of them are not respected. This step ends as soon as the 
whole volume of the target is covered or any other effective options can be implemented. 
If constraints are high demanding or target characteristics prevent an efficient coverage with the current 
configuration, some parts of the tumour may be not covered. In such case, an additional iceball is strategically 
added according to number and position of the areas still to be included in the ablation volume. The new 
bubble is placed in correspondence of the center of mass of all the defective regions and rotated towards the 
nearest one. The previously defined constraints are checked again. Even with the additional iceball, if the 
tumor coverage is not completed or some constraints not satisfied, the planning algorithm starts again from 
the first phase, but adding the further iceball. 
4. Simulation of Iceball Growth 
The model has been made starting from the thermal energy balance for perfused tissue, expressed in the 
following form 
b
m
h
h
T
k
t
C T
�
�
� �
�
�
2
�
                                                                                                                   (1) 
where �� C and k are thermal parameters of tissue, hb is the rate of heat transfer per unit volume of tissue and 
hm is the rate of metabolic heat production per unit volume of tissue. The equation has been simplified through 
simple assumptions coherent to cryoablation procedure: during the freezing phase, capillary blood perfusion 
rate and metabolic heat generation quickly drop to zero, as reported by Shitzer, 2011 [3], thus terms III and IV 
in Equation (1) have been ignored. 
Fig. 4. Superimposition of simulated iceball (blue) on real CT data (green). Cryoprobes are visible inside (red) 
122  
 Riccardo Dodi et al. /  AASRI Procedia  6 ( 2014 )  118 – 122 
In order to easily solve the heat transfer PDE, a finite-difference method has been chosen for 
approximating the spatial derivatives, i.e. a first order forward difference for the first term and a second order 
central difference for the second one. The continuous function then turned into discrete within a 3D grid with 
a sub millimeter resolution. Body temperature has been chosen as initial condition, while the temperature 
profile of the external surface of each probe has been set as boundary condition. To validate this approach, it 
has been chosen to match  the 3D model reconstructed from intra-operative imaging (as reported in Chapter 2) 
with the simulation of iceball growth taking as initial positions the cryoprobes displacement obtained from the 
same CT dataset, discretized and adapted in the computation grid. Even though the -40° isotherm is the one 
interesting for planning purposes, the validation protocol has taken into account just the 0° line because its 
compatibility with CT data. The models are comparable in terms of dimension and shape, as can be seen in 
Fig. 4. 
5. Future Work 
A new methodology to assist and simulate cryosurgical therapies have been presented in this paper. Even if 
designed to be integrated within an autonomous robotic system, the methods are portable and extensible for 
different purposes. For instance, a surgeon can take advantage of the planning software to extrapolate a 
feasible disposition of the tools even for a standard manual insertion; furthermore, for a given configuration of 
the cryoprobes, the mathematic algorithm can calculate the temperature distribution in the surgical site with a 
good accuracy, giving a preliminary preview of the surgical outcome. Being modular and parameterized, such 
model can be adapted to simulate other scenarios (liver, lung, heart, prostate) or procedures (laser or radio 
frequency ablations). 
More activities to improve these methods will be done in next period. For instance, the simulation 
algorithm can be improved adding further parameters, taking into account thermal dynamics and interactions 
simplified so far. Of course, planning software and simulator will be integrated in the same tool in order to 
allow the operator to calculate the probes displacement and assess the therapy outcome without the need of 
intermediate passages. 
References 
[1] Clarke DM, Robilotto AT, Rhee E, et al. Cryoablation of renal cancer: variables involved in freezing-
induced cell death. Technol Cancer Res Treat 2007; 6:69-79. 
[2] Mues AC, Landman J, Current status of ablative therapies for renal tumors. Indian J Urol. 2009 Oct-Dec; 
25(4): 499–507.  
[3] 3D Slicer [Online]. Available: http://www.slicer.org/. [Accessed: 10-Jun-2013].  
[4] Torricelli M, Ferraguti F, Secchi C, An Algorithm for Planning the Number and the Pose of The Iceballs 
in Cryoablation in Proceedings of the 2013 International Conference of the IEEE Engineering in Medicine 
and Biology Society (EMBC), Osaka, Japan, July 2013. 
[5] Rossi MR, Tanaka D, Shimada K, and Rabin Y, Computerized planning of cryosurgery using bubble 
packing: An experimental validation on a phantom material in International Journal of Heat and Mass 
Transfer, vol. 51, no. 23–24, pp. 5671–5678, 2008. 
[6] Lung DC, Stahovich TF, and Rabin Y. Computerized planning for multiprobe cryosurgery using a force–
field analogy in Computer Methods in Biomechanics and Biomedical Engineering, vol. 7, no. 2, pp. 101– 110, 
2004. 
[7] Shitzer A, Cryosurgery: Analysis and Experimentation of Cryoprobes in Phase Changing Media, Journal 
of Heat Transfer, January 2011, Vol. 133. 
