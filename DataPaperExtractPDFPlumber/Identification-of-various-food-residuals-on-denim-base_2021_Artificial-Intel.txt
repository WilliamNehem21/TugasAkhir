ArtificialIntelligenceinAgriculture5(2021)125–132
ContentslistsavailableatScienceDirect
Artificial Intelligence in Agriculture
journal homepage: http://www.keaipublishing.com/en/journals/artificial-
intelligence-in-agriculture/
Identification of various food residuals on denim based on hyperspectral
imaging system and combination optimal strategy
YuzhenChena,ZiyiXua,b,WenchengTangc,d,MenghanHua,⁎ ,DouningTanga,b,GuangtaoZhaic,QingliLia
aShanghaiKeyLaboratoryofMultidimensionalInformationProcessing,SchoolofCommunication&ElectronicEngineering,EastChinaNormalUniversity,Shanghai200062,China
bSchoolofStatistics,EastChinaNormalUniversity,Shanghai200062,China
cInstituteofImageCommunicationandInformationProcessing,ShanghaiJiaoTongUniversity,Shanghai200240,China
dMcCormickSchoolofEngineering,NorthwesternUniversity,Evanston,IL,UnitedStates
a r t i c l e i n f o a b s t r a c t
Articlehistory: Asthescienceandtechnologydevelop,crimemethodsandsceneshavebecomeincreasinglycomplexanddi-
Received12May2021 verse.Traceevidenceanalysishasbecomeamoreandmoreimportantcriminalinvestigationtechnologyandliq-
Receivedinrevisedform20June2021 uidisthemainformoftraceevidence.Foodcanprovidenotonlyenergy,butcluestosolvecrimes.Inthisstudy,
Accepted20June2021
webuildahyperspectralimagingsystemtodetectliquidresiduetraces,includingapplejuice,coffee,cola,milk
Availableonline26June2021 andtea,ondenimswithlight,middleanddarkcolors.Theobtainedhyperspectralimagesarefirstsubjectedto
spectralcalibrationandhyperspectraldatapretreatment.Subsequently,PartialLeastSquares(PLS)isapplied
Keywords:
toselecttheinformativewavelengthsfromthepreprocessedspectra.Formodelingphase,thecombination
Hyperspectralimaging
Foodresidualondenim optimalstrategy,supportvectormachine(SVM)combinedwithrandomforest(RF),isdevelopedtoestablish
Combinationoptimalstrategy classificationmodels.Theexperimentalresultsdemonstratethatthecombinationoptimalmodelcanachieve
Variableselection TPR,FPR,Precision,Recall,F,andAUCof83.5%,2.30%,79.7%,83.5%,81.6%,and94.7%forclassifyingfabricscon-
1
Forensicapplication taminatedbyvariousfoodresiduals.Withrespecttotheclassificationofliquidandfabrictypes,thecombination
optimalmodelalsoyieldssatisfactoryclassificationperformance.Infuturework,wewillexpandthetypesofliq-
uid,andmakeappropriateadjustmenttoalgorithmsforimprovingtherobustnessofclassificationmodels.This
researchmayplayapositiveroleintheconstructionofaharmonioussociety.
©2021TheAuthors.PublishingservicesbyElsevierB.V.onbehalfofKeAiCommunicationsCo.,Ltd.Thisisanopen
accessarticleundertheCCBY-NC-NDlicense(http://creativecommons.org/licenses/by-nc-nd/4.0/).
1.Introduction detectionofliquidtracesatcrimescenes.Tobeetal.introducedthat
thehexagonOBITmethodcouldbeusedforDNAanalysisandthat
The development of science and technology is a double-edged blood could be detected by spraying luminol on suspicious areas
sword.Itdoesbringsecuritytopeople'slife,ontheotherhand,itmay (TobeandDaeid,2009).Blumetal.developedstableDNAmarkers
bealsousedbycriminals,whomaygobeyondtheboundariesoflaw which could reliably identify blood and saliva stains (Blum et al.,
andmorality.Therefore,newtechnologiesshouldbeintroducedtothe 2006).Ferejaetal.developedaluminolelectrochemicalluminescent
explorationofcrimescenestocombattheincreasinglycomplexand biosensor, which could successfully distinguish blood stains from
volatilecrimesituation.Theanalysisoftracematerialevidenceisanim- other stains when embed to a smartphone as the detection device
portanttechniqueincriminalinvestigation(Sumad-on,2021).Onthe (Ferejaetal.,2019).However,chemicaltestingisinevitablydestructive
onehand,thermalresidualisimportanttoanalyzethethermaltracein- anddetrimentaltocrimesceneprotection.Inaddition,mostchemical
formationincrimescenes(Aietal.,2020;Xuetal.,2020;Lietal.,2018), experimentsneedtobecarriedoutinthelaboratory,sotheresultscan-
however,theforensicinvestigatorisoftenaskedtofindtheoriginofa notbedirectlyidentifiedinthecriminalscenes,whichcausesinconve-
certain material, which is found at the crime scene (Klaasse et al., niencetothedetectionofcases.
2021;Palmer,2016).Liquidisthemainformoftracematerialevidence, Asaresult,researchersbegintoapplynon-contact,rapidfieldmea-
includingbeverages,blood,semen,saliva,urineandsweat.Theanalysis surementmethods,suchasnearinfraredspectroscopy(Oravecetal.,
oftracematerialevidencepresentsamajorchallenge,duetothefact 2019;Takamuraetal.,2018),Ramanspectroscopy(DotyandLednev,
thatsomeliquidsleftatcrimescenesareinvisibletothenakedeye 2018a;Rosenblattetal.,2019)andcomputervision,todetectmaterial
andtheamountislimitedoreventiny.Recently,researchershavede- evidenceatcrimescenes.Fornearinfraredspectroscopy,Takamura
veloped many effective chemical experimental methods for the etal.demonstratedadryurinetracedetectionmethodbasedonFourier
transformattenuatedtotalreflectioninfraredspectroscopy,whichfi-
⁎ Correspondingauthor. nallyindicatedthechemicalsourceofgenderdifferenceinurinedonors
E-mailaddress:mhhu@ce.ecnu.edu.cn(M.Hu). (Takamuraetal.,2019).Zhaoetal.proposedanondestructivedetection
https://doi.org/10.1016/j.aiia.2021.06.001
2589-7217/©2021TheAuthors.PublishingservicesbyElsevierB.V.onbehalfofKeAiCommunicationsCo.,Ltd.ThisisanopenaccessarticleundertheCCBY-NC-NDlicense(http://
creativecommons.org/licenses/by-nc-nd/4.0/).Y.Chen,Z.Xu,W.Tangetal. ArtificialIntelligenceinAgriculture5(2021)125–132
method for identifying blood stains based on near-infrared hyper- forthisexperiment,includingapplejuice,Coca-Cola,coffee,oolongtea
spectralspectrumandestablishedabloodmodelwithhighaccuracy andmilk.Cottondenimfabricscoveringlight,mediumanddarkcolors
(Zhaoetal.,2019).IntermsoftheapplicationofRamanspectroscopy arechosentocarrytheseliquids.Tosimulatedifferentresidualtime,
technology,Kyleetal.establishedasupportvectormachinediscrimi- wediluteeachliquidwithdifferentconcentrationscoveringconcentra-
nantanalysismodeltocorrectlypredicttheageofblooddonorswith tionsof100%,50%,and25%.Hence,15experimentalliquidsareob-
highaccuracy(DotyandLednev,2018b).Muroetal.developedanon- tained viz. apple juice, Coca Cola, coffee, oolong tea and milk with
destructivedetectiontechnologyusingRamanspectroscopytodeter- concentrationof100%,50%,and25%,respectively.Thesolutionspre-
minethesexofsalivadonorsatthesceneofacrimewithhighaccuracy paredaboveareusedtocontaminatethethreecolorsoffabricstoget
(Muroetal.,2016).However,thedetectionmethodsmentionedabove 45experimentalgroups.Plus3groupsthatarenotcontaminated,we
lackspatialdimensioninformation.Additionally,researchersapplied eventuallyhave48experimentalgroups.
computervisiontechnologytoidentifyanddetectmaterialevidence. Thesamplesineachoftheexperimentalgroupsareobtainedby
Tarawnehproposedanon-contactrecognitionsystemtoeffectively soakingthecutfabricsinthepreparedsolutions.Thethreecolorsofcot-
identify low quality fingerprints so the problems were solved that tondenimfabricsareallcutintosmallsquareswiththesizeof4cm×4
palmprintrecognitionwasdifficultinlowqualityimages(Tarawneh cm.Fivesamplesarepreparedforeachmaterialconditionmentioned
etal.,2018).Zhuetal.establishedatracedetectiondevicebasedon above.Afterdrying,atotalof240experimentalsamplesincluding15
theprincipleofreflectiontransformationimaging,whichsuggestedan fabricsthatarenotdyedareobtained.Allsamplesareindividuallyen-
importantapplicationprospectincriminalinvestigation(Zhuetal., capsulatedinsealedbagswithlabelednumbers.
2019).Unfortunately,thecomputervisiontechnologylackstheinfor-
mationofspectraldimensionandthecomponentanalysiswhicharere- 2.2.Hyperspectralimagingsystem
sponsivetothespectrum,whichisimportantforcrimesceneanalysis.
Hyperspectralimagingtechnologyiscomposedofimagesandspec- ApushbroomVis–NIRhyperspectralreflectanceimagingsystemis
tra.Thedataacquiredbythistechnologyincludesthreekindsofinfor- appliedtoacquirespectraldataofthefabricsamplespreparedprevi-
mationviz.space,radiationandspectrum.Thetechniqueiswidely ously.TheschematicdiagramofimagingsystemisshowninFig.1.
usedinagriculture(Maheshetal.,2015;Ahmedetal.,2016),medicine Thisimagingsystemismainlycomposedofanimagingspectrograph
(Chiangetal.,2017;Lietal.,2017),remotesensing(Adãoetal.,2017; (ImspectorV10E,SpectralImagingLtd.,Finland)attachedtoa16-bit
Xue and Baofeng, 2017; Duan et al., 2020), textile (Mirschel et al., charge-coupleddetectorcameraof1004(spatial)×1002(spectral)ac-
2019;Ryuetal.,2017),environment(Foglinietal.,2019;Olmosetal., tive pixels (Falcon EM285CL, Raptor Photonics Led., U.K.) and a C-
2019),andchemistry(Robertsetal.,2018;Jia-Huanetal.,2018).In mountlens(ModelXenoplan1.4/17,Jos.SchneiderOptischeWerke
thefieldofmedicalcriminalinvestigation,Przemysetal.introduceda GmbH,Germany),OsramTungstenhalogenlamp,samplestage,and
method for detecting the gunshot residue on the fabric based on computer.
hyperspectraltechnology,whichwasconducivetocollectingevidence Theconventionalline-scanhyperspectralimaginginstrumentsuse
atthecrimescenes(Głombetal.,2018).Majdaetal.proposedamethod thefixedimageacquisitionmoduleandthemovingsamplestagefor
togettheageofbloodstainsbyestimatingthedrydegreeofthemwith dataacquisition.However,inpracticalscenarios,theremaynotbea
thehelpofhyperspectralimagingtechnology,whichcouldquicklyand samplestagethatcanmovelinearlyandreliably.Hence,inourresearch,
effectivelydistinguishbloodstainsbytime(Majdaetal.,2018).Cadd thehyperspectralimagingsystemisspeciallydesignedwhichkeeps
etal.proposedavisiblewavelengthreflectivityhyperspectralimaging boththeimageacquisitionmoduleandthesamplestagefixedwhile
technology,whichcouldclearlyidentifybloodstainsonwhitetiles working.Thisbistatichyperspectralimagingarchitectureisachieved
andevendistinguishfingerprintsinbloodfromavarietyofotherfinger- byaddingaslittothelens,andthemovementofslitcanbecontrolled
printsinredorbrownmedia(Caddetal.,2016).Nakamuraetal.used byalinearmotor(showninthetoprightcornerofFig.1).Thehyper-
hyperspectraltechnologytomeasurethefluorescenceofpotentialfin- cubecanbecollectedbycontrollingtheuniformmovementoftheslit.
gerprints,hence,thevisualidentificationanddetectionofuntreatedfin- Themaximumdistancethattheslitcanreachis16mm.
gerprintsarerealizedsuccessfully(Nakamuraetal.,2015). Inthecurrentwork,themovementspeedofslitissetat0.8mm/s.
Itisnotreportedthathyperspectralimagingtechnologyhasbeen Theexposuretimeandthegainofcameraaresetto30msand1,respec-
usedtodetectliquidfoodresiduesatcrimescenes.Althoughthesuspect tively.Theilluminationintensityofhalogenlampissetat44Klux.The
cannotbeidentifieddirectlyfromtheliquidfoodresidue,theunique- hypercubewiththespectralrangecovering328.81–1113.54nmwith
nessoftheliquidfoodresiduecanalsoprovideindirectevidencefor fullwidthatthehalfmaximumofapproximately0.8nmcanbeob-
thecase.Bydetectingliquidfoodresiduesleftatthescene,thepolice tainedwiththeseimagingparameters.
cangetmoredetailsaboutthecaseandpromotetheinvestigation.Ac-
cordingly,thiswillhelptofightagainsttheevilforces,promotethede- 2.3.Spectralcalibration
velopmentofintelligentpublicsecuritysystem,andcreateagoodpublic
securityenvironmentfortheconstructionofaharmonioussociety. Toreducetheinstabilityoflightsourceinspatialdimension,theob-
Theobjectiveofthisstudyistoinvestigatethepotentialofusing tainedhyperspectralreflectanceimagesarerequiredtobesubjectedto
hyperspectralreflectanceimagingtoestimatevariousfoodresiduals thespectralcalibration.Theequationbelowwasutilizedtocorrectthe
ondenims.Themainstepsareasfollows:(1)establishthehyper- rawhyperspectralimage:
spectralreflectanceimagingtoacquirethemeanpre-processedspectra
ofdenimscontaminatedbyvariousfoodresiduals;(2)selectthewave- R¼ I r−I d ð1Þ
lengthsparticularlyrelatedwiththefoodresidualsusingPartialLeast I w−I d
Squares(PLS)algorithm;(3)developthecombinationoptimalclassi-
fiersforclassifyingandrecognizingvariousfoodresidualsondenims. whereRisthecorrectedhyperspectralreflectanceimage,I standsfor
r
theoriginalhyperspectralreflectanceimage,I representsthereference
w
2.Materialsandmethods whiteimageofthesquarewhitestandardusingthecorrectedexposure
time,I isthereferencedarkimageobtainedusingthecorrectedexpo-
d
2.1.Samplesofliquidresidualsondenim suretime.
If the above equation works, the image subtraction operations
Tosimulatethetracesofvariousliquidsthatmightbeleftatthe shouldbecarriedoutbetweentheimageswiththesameexposure
crimescenes,avarietyofcommondrinksareselectedasthematerials time.Therefore,inEq.1,theimagesinnumeratoranddenominator
126Y.Chen,Z.Xu,W.Tangetal. ArtificialIntelligenceinAgriculture5(2021)125–132
Fig.1.SchematicdiagramoftheproposedpushbroomVis–NIRhyperspectralreflectanceimagingsystem.Oneofthehighlightsofthissystemisthatthesamplestagekeepsstillwhilethe
slitonthelenmovestogetthehyperspectraldataofsample'sdifferentareas.
arerespectivelycapturedunderworkingandcorrectedexposuretime. thenselectsthefivepointsthatpassthroughtheintersectionofthe
I isobtainedwhenthelenscapisclosed,andisusedprimarilytoreduce twodiagonalsatthecenterandthefourcorners,together,asrepresen-
d
theeffectsofdarkcurrentsintheimagingchip.Toguaranteethestabil- tativepixelsoftheimage.
ityofthecalibrationprocess,tenreferencewhiteanddarkimageswere
acquiredeachtime,andthenaveragedforcorrection. 2.5.Characteristicwavelengthselection
2.4.Hyperspectraldatapretreatment Theextractionofcharacteristicwavelengthscangreatlyreducedata
redundancy,retainthemostrepresentativewavelengths,simplifythe
Asdescribedabove,thedistributionoftheliquidonthefabricand model,andspeedupmodelcalculation.PartialLeastSquares(PLS)
thecompositionofthefabricareuniform.Therefore,weignorethespa- removes useless noise and overly tight correlations between data
tialinformationofthecollectedhyperspectraldata,andonlyanalyze by mapping a high-dimensional original feature vector to a low-
the spectral information. However, the spatial information of dimensional new feature vector. Therefore, PLS is widely used to
hyperspectralimageisveryusefulinpracticalapplicationscenarios. modellinearrelationshipsbetweensamples'attributesandfeatures.
Forexample,atanactualcrimescene,thelocationoftheliquidresidue LettheoutputresultsbeY ,andfeaturesX .Theformulascanbe
m×1 m×p
onthefabricisunknowntous,andwecanscantheentirefabricusing expressedasfollows:
hyperspectralimagingsystemtoeventuallyfindtheexactlocationof
theliquidresidue. y¼XWcþe¼Xbþe ð4Þ
Foreachimage,wecollected2000spectra.Sincetherewere5
samplesforeachmaterialcondition,atotalof10,000spectrawere
whereXisthefeaturematrix;WrepresentstheweightmatrixofX;cis
ultimatelyselectedforeachmaterialcondition.Foreachcategory,
the regression coefficient vector and e stands for prediction error.
80%and20%ofspectrawererandomlyselectedascalibrationand
b, which equals (b ,b …b )T represents a vector of coefficients in
predictionsets. 1 2 p
pdimensions.
Toreducethenoisecausedbyimagingequipment,inthisresearch,
Inmatrixb,theabsolutevalueoftheith(1≤i≤p)element∣b∣,indi-
theGaussLowPassFilter(GLPF)ischosentoconvolutethespectral i
cateshowimportanttheithwavelengthistoy.Thebigger∣b∣is,the
valueonthespatialscale,andattenuatethehigh-frequencycompo- i
greateritsinfluenceonyis.Inthisresearch,PLSisemployedtoextract
nents.TheGLPFis:
characteristicwavelengths,andwefinallyextract10,50and100feature
wavelengthstomodel.
−D2ðu,vÞ
Hðu,vÞ¼e 2D2
0
ð2Þ
2.6.Combinationoptimalclassifier
qffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi
Dðu,vÞ¼ ðu−u 0Þ2þðv−v 0Þ2 ð3Þ
Supportvectormachine(SVM)andrandomforest(RF)algorithms
areadoptedtoconstructclassificationmodelswithtrainingdata.Fur-
where(u,v)isthecoordinateofthecurrentpixel.Meantime,D(u,v)is thermore,weexplorethecombinationofSVMandRFtoimprovethe
thedistancebetweenthecurrentpixeltothecenterpixel,whosecoor- performanceoftheultimatemodel.
dinateis(u ,v ).D standsfortheradiusoffilter,anditdependsonthe Randomforest(Breiman,2001)isasupervisedmachinelearningal-
0 0 0
parameterσ. gorithmthatjustemergedinthiscentury.Itfocusesmoreonaccurately
To remove the spatial information, we first cropped the hyper- describingthedataandclassifyingthemintocorrespondingcategories,
spectralimagetopreserveeffectivelycontaminatedareas.Apointsam- aswellassummarizingthedata.ThestandardSVMfocusesmoreon
plingmethodcommonlyusedinbiologicalsamplingcountscalledthe binaryclassification,butithasappliedinmulti-categoryclassification
five-pointsamplingmethodwasthenusedtoselectthevalidpixels. aswell(Belousovetal.,2002).Theoptimizationstrategyisshownin
Thefive-pointsamplingmethodstartsatthecenteroftheimage,and Algorithm1.
127Y.Chen,Z.Xu,W.Tangetal. ArtificialIntelligenceinAgriculture5(2021)125–132
FP
Algorithm1Procedureofcombinationstrategy FPR¼ ð6Þ
FPþTN
3) Precision:precisionisonlyusedtoevaluatedtheclassificationability
ofthepositivesampleswithintherangefrom0to1.Itisobviousthat
thelargerprecisionis,themoreeffectivethesystemis.Itiscom-
putedby:
TP
Precision¼ ð7Þ
TPþFP
4) Recall:itisaratiofrom0to1.Obviously,themoreitiscloseto1,the
betterthesystemis.Thecalculationequationis:
TP
Recall¼ ð8Þ
TPþFN
5) F :itisaharmonicmeanofrecallandprecision.Inthisstudy,we
1
considertheweightofrecallandprecisionthesame,whichmeans
attachingtheweightof0.5toeitherofthem.Itiscalculatedby:
2∗Precision∗Recall
F ¼ ð9Þ
1 PrecisionþRecall
6) ROCCurveandAUC:receiveroperatingcharacteristiccurve(ROC
Curve),isacommonindicatortoevaluatetheadvantagesanddisad-
vantagesofbinaryclassifier.Thex-coordinateisFPR,andthey-
coordinateisTPR.Ingeneral,theclosertheROCcurveistothe
upperleftcorner,thebettertheperformanceoftheclassifieris.
Areaundercurve(AUC)isdefinedastheareaundertheROCCurve.
Basedonthesetproportion,wefirstdividethealldatasetS allintotrain- ThevalueofAUCisgenerallybetween0.5and1,andthegreaterthe
ingsetS train,andtestsetS test.Then,wetrainSVMontheS trainusingthede- valueofAUCis,thebettertheefficiencyoftheclassifieris.
faultparametervaluesofSVMclassifier,andtestsetS isusedtocalculate
test
theevaluationindicatorstoquantizethequalityofthemodel.Aftertraining
andtesting,theclassifiedrightsamplesS andwrongsamplesS are
right wrong 3.Experimentalresultsanddiscussion
respectivelyassignedwiththelabelsofL andL .Basedontheright
right wrong
samplesS rightandtheobtainedSVMclassifier,wedevelopauxiliaryclassi- AllworkhasbeenfinishedinMatlab2014b.Withdataprocessed
fierRFtogettheoptimalclassificationmodel.Itfollowsthecriterionthat
througheachstep,weanalyzetheresultscarefully.
theevaluationvaluesofclassificationmodelcanreachthebest,whichare
calculatedbyclassifiedwrongsamplesS .Morespecifically,weassign
wrong 3.1.Resultsofpretreatment
theparametersgeneratedbyrandomizertoSVM,andthenchangethepa-
rametersofRFtogetthebest-performingmodel.Meanwhile,werecord AfterpretreatmentviaGuassianlowfilteringwithdifferentσ,
everyparameterpair(P SVM,P RF),andeventuallywechoosethebestpair therearedifferentchangesinspectralprofile.Takethehyperspectral
(P (best),P (best))torealizeoptimalmodel.
SVM RF dataofpureliquidCoca-Colaastheexample,asshowninFig.2.It
canbeseenthatthereisanincreasinglyobviouschangeinthede-
2.7.Evaluationindicators tailsofthespectrumasσincreases:asσincreases,thedetailsof
spectralprofilesbecomeless,andthecurvebecomessmootherviz.
Toverifytheefficiencyofthedetectionsystem,evaluationindicators
manysharpburrsvanish.Ontheotherhand,smoothingalsomakes
viz.confusionmatrix,TPR,FPR,precision,recall,F 1,ROCCurve,AUCare thespectrumprofilereducesalotoforiginalfeatures.Therefore,
considered. havingconsideredboththeprocessedimagesandtheclassification
1) ConfusionMatrix:weassumethat“Positive”meansthepositivesam- results,theGuassianlowpassfilterwithσ1isadopted,whichcan
plesand“Negative”meansthenegativesamples.Meanwhile,“True” reachthegoalofreducingtheburrsandretainingnecessaryoriginal
representsthatthepredictionisrightwhile“False”representsthat features.
thepredictioniswrong.Asaresult,“TP”and“TN”meanthatthepos- TheGuassianlowpassfilterwithσ1isusedtoprocessallthesimu-
itivesampleisclassifiedas“Positive”andthenegativesampleisla- lationmaterialsandthecarrierviz.applejuice,Coca-Cola,coffee,oolong
beledas“Negative”,respectively.“FP”and“FN”representthatthe tea,milkandlight,mediumanddarkfabrics,whichareshowninFig.3
negativesampleislabeledas“Positive”andthepositivesampleisclas- andFig.4.
sifiedas“False”.Thefourindicatorsmakeuptheconfusionmatrix. Comparedwiththespectrogramoffabrics,thespectrogramofliq-
2) TPRate(TPR)andFPRate(FPR):itisaratiothatisusedtoestimate uidsismuchmessier.Evenaftertreatment,thereisstillmuchburr
theclassificationabilityofamodelwithintherangefrom0to1.They andsharpbulge,andthecurveismoreirregular.Thespectrogramof
canbecalculatedbythefollowingequation: coffee,inparticular,sharesasimilartrendwithcoke,applejuiceand
tea,perhapsbecauseoftheirclosecolorsimilarity.
TP Amongthesethreekindsoffabrics,itcanbeseenthattherearetwo
TPR¼ ð5Þ
TPþFN peak values in three images. It may be caused by the fact that the
128Y.Chen,Z.Xu,W.Tangetal. ArtificialIntelligenceinAgriculture5(2021)125–132
Fig.2.ThespectralprofilesofCoca-ColaafterpretreatmentviaGuassianlowpassfilteringwithdifferentσ.Specifically,a)istheoriginalspectralprofilewhileb),c)andd)aretheonesthat
areprocessedbytheGuassianlowpassfilterwithσ0.5,1and5,respectively.
components of the fabric are more sensitive to the light of two 3.2.Analysisofcharacteristicwavelengths'results
wavebands.Withcolordeepens,thefirstcrestbeginstograduallyde-
cline,andalmostvanishesintermsofdarkfabric.Thus,wedrawthe Asmentionedabove,weusePLSalgorithmtoextractfeaturewave-
conclusionthatthefirstwavecrestcanmainlydistinguishthethree lengthsafterpretreatment.Weacquire10,50and100characteristic
kindsoffabrics.Meanwhileitmaybethecharacteristicwavelengthof wavelengthsandusethemrespectivelytomodel.Thetop100wave-
thesekindsoffabric. lengthsofcoffeeareelaboratedinFig.5.
Fig.3.ThespectralprofilesofdifferentliquidsprocessedbyGuassianlowpassfilterwithσ1.a),b),c),d)ande)standforthespectralprofilesofCoca-Cola,coffee,applejuice,milkandtea,
respectively.
129Y.Chen,Z.Xu,W.Tangetal. ArtificialIntelligenceinAgriculture5(2021)125–132
Fig.4.Thespectralprofilesoffabrics.a),b)andc)representthelight,mediumanddarkfabrics,respectively.
AswecanseefromFig.5,thefeaturewavelengthsoftop10ap- 3.3.Performanceofclassifiersforliquidcategoryclassification
proximatelyconcentrateat800nmviz.1136cm−1,probablydue
to the functional group C-Os and C–N ‘s stretching mode in TheresultsofliquidcategoryclassificationarepresentedinTable1.
caffeine, which is the main component in coffee. The feature AccordingtoTable1,optimalstrategy,asexpected,performsbetter
wavelength of 700 nm viz. 1428 cm−1 may come from the thanSVMandRFalgorithms.Comparedtootherindicators,itiseasy
functionalgroupC-Hsstretchingmodeincaffeineandsugar.The toobservethattheprecisionofoptimalstrategyreaches96.6%,which
other 5 feature wavelengths are probably from other organic isthehighestandimprovesmostaswell.Almostalltheevaluationindi-
matterincoffee.Forthetop11to50featurewavelengths,itcanbe catorsofoptimalstrategyarepromotedexceptFPR,butitonlydeclines
predictedthatmorecharacteristicsareincluded.Asexpected,for alittle.ItisverylikelythatthecombinationofSVMandRFcanobtaina
therangeof625nmto750nmviz.1333cm−1to1600cm−1,the relativelysatisfyingclassificationmodel.
wavelengthsadditionallystandforC=Cinstretchingmode,while
thewavelengthsof780nmto830nmviz.1204cm−1to1282cm−1
3.4. Performance of classifiers for liquid residue time (concentration)
nm may be attributed to C-Os and C–N ‘s stretching mode of judgment
caffeine.Thesimilarexplanationcanbeappliedtothetop51to
100featurewavelengths. Table2exhibitstheclassificationresultsofliquidresiduetime.What
Thetop10wavelengthsaremorereflectiveofthecharacteris-
staysthesameisthattheoptimalstrategyistheonewhichperforms
ticsofcoffee'sspectrum;thetop50canroughlycoverthecharac- best.Itcanalsobenoticedthattheperformanceofallclassifiersare
teristics; and the top 100 can reflect the characteristics more
specifically.Thecharacteristicwavelengthsofnumber10,50and
100 are identified by the combination classifier, which are used
Table1
byrandomforestandSVMalgorithms.Whenthenumberofchar- IdentificationResultsofLiquidCategorybyVariousClassifiers.
acteristic wavelengths is 50, the classification system performs
best. Under the best circumstance, the TP rate is 83.5%, and the
TPR FPR Precision Recall F1 AUC
FP rate is 2.3% when classifying liquid on denim,which is elabo- SVM 85.1% 1.2% 91.0% 85.1% 90.7% 91.4%
rated in the part ‘Performance of Classifiers for Contaminative RF 84.9% 2.2% 89.5% 84.9% 87.1% 91.2%
OptimalStrategy 86.2% 2.3% 96.6% 86.2% 90.9% 92.2%
DenimClassification’.
Fig.5.Thetop100wavelengthsofliquidcoffee'sspectrum.Thebluestandsforthetop10wavelengths;theredmeanstop11to51andtheblackonerepresentstop51to100.
130Y.Chen,Z.Xu,W.Tangetal. ArtificialIntelligenceinAgriculture5(2021)125–132
Table2 time.Butowingtothefactthatthewholeprojectprocessiscompleted
Classificationresultsofliquidresiduetime(Concentration). inthelaboratory,sosomethingthatmayappearinrealityisnotconsid-
TPR FPR Precision Recall F1 AUC ered.Soinfuturework,weshouldpaymoreattentiontothese:1)the
increaseinthevarietyofliquidandclothwillleadtoadecreaseinthe
SVM 72.0% 6.0% 68.9% 72.0% 70.4% 94.3%
accuracy.Inviewoftherealsituationatthecrimescene,ahighrecall
RF 73.7% 6.5% 66.4% 73.7% 69.9% 89.4%
OptimalStrategy 76.0% 7.8% 68.5% 76.0% 72.1% 93.5% rateisrequired;2)samplecategoriesneedtobeexpanded.Sincethere-
sidualliquidontheclothcanbeidentifiedonlyiftheliquidisincluded
inthedatabase,itisnecessarytoaddmorekindsofliquids;3)theclas-
Table3 sificationaccuracyofdifferentconcentrationsisrelativelylow.Since
classificationResultsofFabricswithLiquidbyVariousClassifiers. whatthehyperspectralreflectsismoreaboutthedifferencebetween
TPR FPR Precision Recall F1 AUC differentcomponents,itisnecessarytoincreasetheaccuracythrough
appropriateadjustment;4)wewillattempttousethedeeplearning
SVM 82.4% 2.7% 78.3% 82.4% 80.3% 93.7%
RF 80.6% 1.8% 82.2% 80.6% 81.4% 91.8%
toconstructclassificationmodel;5)theportabilityofthesystemshould
OptimalStrategy 83.5% 2.3% 79.7% 83.5% 81.6% 94.7% betakenintoconsideration.Currently,thesystemseemsalittletoo
largetotakeintocrimescenes.Wewilltrytousemultispectralimaging
techniquesfortheconstructionofrelevantmodels.
notasgoodastheonesclassifyingtheliquidcategory.Itmaybecaused
bythefollowingreasons:1)excessiveclassificationresultsintheper-
4.Conclusion
formancedegradationoftheclassifier;2)theliquidofthesamecate-
gory but different concentrations consists of essentially the same
Inthiswork,wedevelopthehyperspectralimagingsystemforthe
component,sothehyperspectraldifferencebetweentheliquidsofdif-
detection of liquid residue traces at the crime scene. After gaining
ferentconcentrationsisnotenoughtodistinguishthem;3)theconcen-
hyperspectralimagesandpreprocessing,classifiersviz.SVMandRF,
trationdifferenceisnotsignificantenough,resultinginarelatively
areselectedtoestablishtheclassificationmodels.Basedonthese,the
smalldifferenceafterbeingdried.
optimalcombinationstrategy,SVMcombinedwithRFischosentocon-
Ingeneral,theoverallperformanceofthecombinationmethodim-
structmodel.Thesystemcanachievethetasksofclassifyingliquidcat-
provestheclassificationsystem,whichshowsthefeasibilityofourclas-
egory,liquidconcentration,andevendifferentliquidcategorieson
sificationmodel.
denim.Itcanbeseenfromthefactthatallpositiveindicatorsover
81%,evensomeover91%whentacklingthemostchallengingtask,de-
3.5.Performanceofclassifiersforcontaminativedenimclassification
tectingdifferentliquidcategoriesondenim.Furthermore,thesystem
performs even better when classifying liquid category and liquid
Table3showstheclassificationresultsoffabricswithliquidbyvari-
concentration.
ousmethods.Unsurprisingly,theoptimalstrategyhasthebestresults
onthewhole,whichprovesthecombinationstrategyfeasible.Itis DeclarationofCompetingInterest
worthnotingthatAUCofoptimalstrategyisapproximatelycloseto95%.
To make it clearer, the specific results of optimal strategy are Theauthorsdeclarethatthereisnoconflictofinterestsregarding
displayedinTable4.Itcanbenotedthatthesystemshowsalittlediffer- thepublicationofthispaper.
enceatdifferentcategories.TPRofL-Coffeeisrelativelygood,95.1%,
whileM-Teaonly70.6%.Fortunately,wecanseethattheaverageofall Acknowledgements
indicatorsissatisfactory.Positiveindicatorsareallmorethan81%,espe-
cially AUC is over 91%. The ability of our system to classify multi- ThisworkissponsoredbytheNationalNaturalScienceFoundation
categorysamplesisconsideredtobesatisfied.
ofChina(No.61901172,No.61831015,No.U1908210),theShanghai
SailingProgram(No.19YF1414100),the“ChenguangProgram”sup-
3.6.Futureworkintheresearch portedbyShanghaiEducationDevelopmentFoundationandShanghai
MunicipalEducationCommission(No.19CG27),theScienceandTech-
Theworkcanachievethebasictasksviz.detectingstainedcloth nologyCommissionofShanghaiMunicipality(No.19511120100,No.
withliquid,categoryofliquid,thekindofcloth,andeventheresidue 18DZ2270700,No.18DZ2270800),thefoundationofKeyLaboratory
ofArtificialIntelligence,MinistryofEducation(No.AI2019002),and
Table4 theFundamentalResearchFundsfortheCentralUniversities.
Classificationresultsofliquidtypesandcontaminatedfabrictypesbyoptimization
strategy. References
TPR FPR Precision Recall F1 AUC
Adão,Telmo,Hruška,Jonáš,Pádua,Luís,Bessa,José,Peres,Emanuel,Morais,Raul,Sousa,
L-Apple 84.8% 3.9% 81.6% 84.8% 83.1% 93.4% JoaquimJoão,2017.Hyperspectralimaging:areviewonuav-basedsensors,datapro-
L-Coffee 95.1% 4.1% 86.5% 95.1% 90.0% 96.0% cessingandapplicationsforagricultureandforestry.RemoteSens.9(11),1110.
L-Cola 78.6% 4.5% 75.9% 78.6% 77.2% 91.9% Ahmed,MohammadRaju,Yasmin,Jannat,Mo,Changyeun,Lee,Hoonsoo,Kim,MoonS.,
L-Milk 78.9% 4.0% 77.7% 78.9% 78.3% 92.1% Hong, Soon-Jung, Cho, Byoung-Kwan, et al., 2016. Outdoor applications of
L-Tea 72.1% 3.2% 80.0% 72.1% 75.7% 91.4% hyperspectralimagingtechnologyformonitoringagriculturalcrops:Areview.
M-Apple 72.3% 2.6% 79.7% 76.3% 75.8% 92.7%
J.Biosyst.Eng.41(4),396–407.
M-Coffee 81.5% 3.2% 81.1% 81.5% 81.3% 93.5% Ai,Jin,Hu,Menghan,Zhai,Guangtao,Zhang,Xiao-Ping,Wang,Yunlu,Cai,Liming,Li,
M-Cola 85.2% 2.9% 87.2% 85.2% 86.2% 93.4% Qingli,Sun,WendellQ.,2020.Rapidlydevelopinghumanheatresiduemodelunder
M-Milk 93.0% 0.6% 79.9% 93.0% 85.8% 94.3%
variousconditionsbasedonfluentandthermalvideo.InfraredPhys.Technol.110,
103468.
M-Tea 70.6% 3.2% 77.4% 70.6% 73.8% 91.1%
D-Apple 72.8% 5.4% 82.4% 72.8% 77.8% 87.1% Belousov,A.I.,Verzakov,S.A.,VonFrese,J.,2002.Applicationalaspectsofsupportvector
machines.J.Chemometrics:J.ChemometricsSoc.16(8–10),482–489.
D-Coffee 88.9% 6.8% 85.0% 88.9% 86.9% 91.6%
Blum,L.J.,EsperanÇA,Philippe,Rocquefelte,Stephanie,2006.Anewhigh-performancere-
D-Cola 87.4% 6.9% 87.2% 87.4% 87.3% 89.5%
agentandprocedureforlatentbloodstaindetectionbasedonluminolchemilumines-
D-Milk 94.7% 13.6% 81.5% 94.7% 87.4% 92.4% cence.J.Can.Soc.ForensicSci.39(3),81–99.
D-Tea 80.8% 7.60% 78.4% 74.7% 76.5% 87.5%
Breiman,Leo,2001.Randomforests.Mach.Learn.45(1),5–32.
Average 82.4% 5.2% 81.4% 82.3% 81.5% 91.9%
Cadd,Samuel,Li,Bo,Beveridge,Peter,O’Hare,WilliamT.,Campbell,Andrew,Islam,Meez,
L,MandDmeanslight,middleanddarkfabric. 2016.Thenon-contactdetectionandidentificationofbloodstainedfingerprints
131Y.Chen,Z.Xu,W.Tangetal. ArtificialIntelligenceinAgriculture5(2021)125–132
usingvisiblewavelengthreflectancehyperspectralimaging:Part1.Sci.Justice56(3), hyperspectralimagerwithcontinuouswavegreenlaserforidentificationanddetec-
181–190. tionofuntreatedlatentfingerprintsonwalls.ForensicSci.Int.254,100–105.
Chiang,Nathaniel,Jain,JitendraK.,Sleigh,Jamie,Vasudevan,Thodur,2017.Evaluationof Olmos,Víctor,Marro,Mónica,Loza-Alvarez,Pablo,Raldúa,Demetrio,Prats,Eva,Piña,
hyperspectralimagingtechnologyinpatientswithperipheralvasculardisease. Benjamí,Tauler,Romà,DeJuan,Anna,2019.Assessmentoftissue-specificmultifactor
J.Vasc.Surg.66(4),1192–1201. effectsinenvironmental–omicsstudiesofheterogeneousbiologicalsamples:com-
Doty,KyleC.,Lednev,IgorK.,2018a.Ramanspectroscopyforforensicpurposes:recent bininghyperspectralimageinformationandchemometrics.Talanta194,390–398.
applicationsforserologyandgunshotresidueanalysis.TrACTrendsAnal.Chem. Oravec,Michal,Beganović,Anel,Gál,Lukáš,Čeppan,Michal,Huck,ChristianW.,2019.Fo-
103,215–222. rensicclassificationofblackinkjetprintsusingfouriertransformnear-infraredspec-
Doty,KyleC.,Lednev,IgorK.,2018b.Differentiatingdonoragegroupsbasedonraman troscopyandlineardiscriminantanalysis.ForensicSci.Int.299,128–134.
spectroscopyofbloodstainsforforensicpurposes.ACSCentralSci.4(7),862–867. Palmer,Ray,2016.TheEvaluationofFibreEvidenceintheInvestigationofSeriousCrime.
Duan,Puhong,Lai,Jibao,Kang,Jian,Kang,Xudong,Ghamisi,Pedram,Li,Shutao,2020. PhDThesis.UniversitédeLausanne,FacultédeDroit,desSciencesCriminelles.
Texture-awaretotalvariation-basedremovalofsunglintinhyperspectralimages. Roberts,Jessica,Power,Aoife,Chapman,James,Chandra,Shaneel,Cozzolino,Daniel,2018.
ISPRSJ.Photogramm.RemoteSens.166,359–372. Ashortupdateontheadvantages,applicationsandlimitationsofhyperspectraland
Fereja,TadesseHaile,Kitte,ShimelesAddisu,Gao,Wenyue,Yuan,Fan,Snizhko,Dmytro, chemicalimaginginfoodauthentication.Appl.Sci.8(4),505.
Qi,Liming,Nsabimana,Anaclet,Liu,Zhongyuan,Xu,Guobao,2019.Artesunate- Rosenblatt,Robert,Halámková,Lenka,Doty,KyleC.,deOliveiraJr.,EmanuelA.C.,Lednev,
luminol chemiluminescence system for the detection of hemin. Talanta 204, IgorK.,2019.Ramanspectroscopyforforensicbloodstainidentification:methodval-
379–385. idationvs.environmentalinterferences.ForensicChem.16,100175.
Foglini,Federica,Grande,Valentina,Marchese,Fabio,Bracchi,ValentinaA.,Prampolini, Ryu,Meguya,Balčytis,Armandas,Wang,Xuewen,Vongsvivut,Jitraporn,Hikima,Yuta,Li,
Mariacristina,Angeletti,Lorenzo,Castellan,Giorgio,Chimienti,Giovanni,Hansen, Jingliang,Tobin,MarkJ.,Juodkazis,Saulius,Morikawa,Junko,2017.Orientational
IngridM.,Gudmundsen,Magne,etal.,2019.Applicationofhyperspectralimaging mappingaugmentedsub-wavelengthhyper-spectralimagingofsilk.Sci.Rep.7(1),
tounderwaterhabitatmapping,southernadriaticsea.Sensors19(10),2261. 1–10.
Głomb,Przemysław,Romaszewski,Michał,Cholewa,Michał,Domino,Krzysztof,2018. Sumad-on,Donald,2021.TheMethodsofExtractingTraceEvidenceinCriminalInvestiga-
Applicationofhyperspectralimagingandmachinelearningmethodsforthedetec- tion.AvailableatSSRN3832502..
tionofgunshotresiduepatterns.ForensicSci.Int.290,227–237. Takamura,Ayari,Watanabe,Ken,Akutsu,Tomoko,Ozawa,Takeaki,2018.Softandrobust
Jia-Huan,Qu,Wei,Qingyi,Sun,Da-Wen,2018.Carbondots:principlesandtheirapplica- identificationofbodyfluidusingfouriertransforminfraredspectroscopyandchemo-
tions in food quality and safety detection. Crit. Rev. Food Sci. Nutr. 58 (14), metricstrategiesforforensicanalysis.Sci.Rep.8(1),1–10.
2466–2475. Takamura,Ayari,Halamkova,Lenka,Ozawa,Takeaki,Lednev,IgorK.,2019.Phenotype
Klaasse,JillR.,Alewijnse,LindaC.,vanderWeerdTracebase,Jaap,2021.Adatabasestruc- profilingforforensicpurposes:determiningdonorsexbasedonfouriertransformin-
tureforforensictraceanalysis.Sci.Justice61(4),410–418. fraredspectroscopyofurinetraces.Anal.Chem.91(9),6288–6295.
Li,Duo,Zhang,Xiao-Ping,Hu,Menghan,Zhai,Guangtao,Yang,Xiaokang,2018.Physical Tarawneh,AhmadS.,Chetverikov,Dmitry,Hassanat,AhmadBasheer,2018.Pilotcompar-
passwordbreakingviathermalsequenceanalysis.IEEETrans.Inform.Foren.Security ativestudyofdifferentdeepfeaturesforpalmprintidentificationinlow-qualityim-
14(5),1142–1154. ages.NinthHungarianConferenceonComputerGraphicsandGeometry,Budapest.
Li,Xiang,Li,Wei,Xu,Xiaodong,Wei,Hu.,2017.Cellclassificationusingconvolutional Tobe,ShananS.,Daeid,NiamhNic,2009.Comparisonofpresumptivebloodtestkitsin-
neuralnetworksinmedicalhyperspectralimagery.20172ndInternationalConfer- cludinghexagonobti.J.ForensicSci.54(1),239.
enceonImage,VisionandComputing(ICIVC).IEEE,pp.501–504. Xu,Ziyi,Wang,Quchao,Li,Duo,Hu,Menghan,Yao,Nan,Zhai,Guangtao,2020.Estimating
Mahesh,S.,Jayas,D.S.,Paliwal,J.,White,N.D.G.,2015.Hyperspectralimagingtoclassify departuretimeusingthermalcameraandheattracestrackingtechnique.Sensors20
andmonitorqualityofagriculturalmaterials.J.StoredProd.Res.61,17–26. (3),782.
Majda,Alicja,Wietecha-Posłuszny,Renata,Mendys,Agata,Wójtowicz,Anna,Łydżba- Xue,Jinru,Baofeng,Su.,2017.Significantremotesensingvegetationindices:areviewof
Kopczyńska,Barbara,2018.Hyperspectralimagingandmultivariateanalysisinthe developmentsandapplications.J.Sens.2017.
driedbloodspotsinvestigations.Appl.Phys.A124(4),312. Zhao,Yuefeng,Hu,Nannan,Wang,Yunuan,Liu,Yonglei,Li,Xiaofei,Wang,Jingjing,2019.
Mirschel,Gabriele,Daikos,Olesya,Scherzer,Tom,2019.In-linemonitoringofthethick- Theapplicationofnear-infraredreflectancehyperspectralimagingforthedetection
nessdistributionofadhesivelayersinblacktextilelaminatesbyhyperspectralimag- andextractionofbloodstains.Clust.Comput.22(4),8453–8461.
ing.Comput.Chem.Eng.124,317–325. Zhu,Xinran,Huang,Lihua,Wei,Wei,Guo,Kai,Ling,Liqing,Huang,Huijie,2019.Applica-
Muro,ClaireK.,deSouzaFernandes,Luciana,Lednev,IgorK.,2016.Sexdetermination tionofreflectiontransformimagingintracedetection.14thNationalConferenceon
basedonramanspectroscopyofsalivatracesforforensicpurposes.Anal.Chem.88 LaserTechnologyandOptoelectronics(LTO2019). vol.11170.InternationalSociety
(24),12489–12493. forOpticsandPhotonics,p.111702Q.
Nakamura,Atsushi,Okuda,Hidekazu,Nagaoka,Takashi,Akiba,Norimitsu,Kurosawa,
Kenji,Kuroki,Kenro,Ichikawa,Fumihiko,Torao,Akira,Sota,Takayuki,2015.Portable
132