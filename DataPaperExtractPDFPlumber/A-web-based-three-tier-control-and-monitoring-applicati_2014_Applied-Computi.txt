AppliedComputingandInformatics(2014)10,14–37
King Saud University
Applied Computing and Informatics
www.ksu.edu.sa
www.sciencedirect.com
ORIGINAL ARTICLE
A web-based three-tier control and
monitoring application for integrated
facility management of photovoltaic
systems
Apostolos Meliones a,*, Spyros Apostolacos b,1, Angeliki Nouvaki a
aDepartmentofDigitalSystems,UniversityofPiraeus,80DimitriouandKaraoliStr.,GR-18534,Greece
binAccess,R&DCenter,12SorouStr.,15125Maroussi,Athens,Greece
Received12November2012;revised26April2014;accepted30April2014
Availableonline 10May2014
KEYWORDS Abstract The architecture of a control system can be designed vertically with
the distinction between functional levels. We adopt this layered approach for
Controlcenter;
Controlservice thedesignandimplementationofanetwork-basedcontrolandmonitoringappli-
back-end; cation. In this paper we present the design and implementation of a network-
Controland based management application for controlling and monitoring the input and
monitoringsystem; output data of remote equipment aiming at performance macro-observation,
Integratedfacility alarmdetection,handlingoperationfailures,installationsecurity,accesscontrol,
managementsystem; collectionandrecordingofstatisticaldataandprovisioningofreports.Themain
Solarpark;
services provided to the user and operating over the public internet and/or
Photovoltaicsystem;
mobile network include control, monitoring, notification, reporting and data
Photovoltaicplant
export.Ourproposedsystemconsistsofafront-endforfield(site-level)control
managementsystem
andmonitoringaswellasaserviceback-endwhichundertakestocollect,store
* Correspondingauthor.Tel.:+302104142762;fax:+302104142715.
1Tel.:+302106802300.
E-mailaddresses: meliones@unipi.gr (A. Meliones), spapost@inaccess.com (S. Apostolacos),nouvaki@gmail.
com(A.Nouvaki).
PeerreviewunderresponsibilityofKingSaudUniversity.
Production and hosting by Elsevier
2210-8327ª2014KingSaudUniversity.ProductionandhostingbyElsevierB.V.Allrightsreserved.
http://dx.doi.org/10.1016/j.aci.2014.04.003Integratedfacility management of photovoltaicsystems 15
and manage data from all remote installations. Hierarchical data acquisition
methodology and performance macro-observation are according to the IEC
61724standard.Wehavesuccessfullyusedourcontrolandmonitoringapplica-
tionforintegratedfacilitymanagementofphotovoltaicplantinstallations;nev-
ertheless it can be easily migrated to other renewable energy generation
installationsandremoteautomationapplicationsingeneral.
ª2014KingSaudUniversity.ProductionandhostingbyElsevierB.V.Allrights
reserved.
1. Introduction
Due to the intensifying climate challenge, green growth is expected to be a very
important issue in the next decades. Green growth strategies can help economies
and societies become more resilient as they work to meet demands for food
production, transport, housing, energy and water (Huang and Quibria, 2013;
Ja¨nique, 2012; Hallegate et al., 2012; Toman, 2012; Brown and Southworth,
2008; Gill et al., 2007; Rycrofta et al., 2000). A photovoltaic system (PV System)
consists of one or more solar panels which convert sunlight into electric power.
PV systems present a rapid growth with the installation of hundreds and thou-
sands MWp (megawatt peak) per year and with a significant volume of clean
power contributed to the electrical grid. The research in PV technology and
inverters flourishes (Ekins-Daukes, 2013), while important capital is invested
mainly because of favorable conditions in most markets, such as feed-in tariff,
subsidies etc. (Fthenakis et al., 2009; Bagnall and Boreland, 2008). Combined
with the various initiatives for energy efficiency, the installations of photovoltaic
systems are steadily increasing. Photovoltaics are shifting from being a negligible
power generation technology to a mainstream source of power (Woyte et al.,
2013).
Suchsystems,however,cannotworkefficientlyifoperationsarenotautomated.
Moreover, the need for improved performance of power systems in terms of
reliability and higher productivity has necessitated more and more application
of condition monitoring techniques (Wagle et al., 2008; Trovao et al., 2008).
Therefore, the need of integrated facility management systems which control
and monitor the solar park installations is imperative. The development of auto-
matedapplications intheenergysectoris significant,notonlyin industrybutalso
forend-users.End-usersincreasinglydemandproductsthatuseless energy,which
conflicts with the growing demand for expanded functionality. Control and
automation applications are developing solutions to reduce costs in time, money
and effort of procedures aiming to improve the quality of relevant services and
products. Fig. 1 depicts a PV system involving the photovoltaic and electrical
equipment plus the monitoring system. The photovoltaic equipment comprises
the solar panels, the solar panels mounting system, the inverters and the sensor
box, while a controller implements the monitoring system.16 A.Meliones et al.
Figure1 PVSystemcomponents.
Web-based real-time monitoring systems have been heavily used in the health-
care and industrial sectors for many years and can be studied in order to gain sig-
nificant experience in diverse application requirements. A typical finding is that
severaloftheappliedmonitoringprinciples,conceptsandmechanismscanbeeas-
ily migrated and adapted to other applications. Numerous efforts employing
diverse software, field controller, communication and user interface architectures
havealreadyempoweredusersbygivingthemaccesstoreal-timeenergyplantdata
and quality observations in a fluid and versatile environment (Lahti et al., 2011;
Sa´nchez-Pacheco et al., 2011; Irmak et al., 2013; Konieczny et al., 2012;
Dobriceanuetal.,2009,etc.). A PVplantmanagementsolution aimsatproviding
fundamentalservicesandotherfacilitiestobusinessentitiesinchargeofthesuper-
vision of a number of remote installations. The interaction of the users with the
solution relies on the public internet and the GSM/3G network. In this paper
wepresentthedesignandimplementationofanetwork-basedsolarpark/PVplant
managementapplicationforcontrollingandmonitoringtheinputandoutputdata
of the PV equipment aiming at performance macro-observation, alarm detection,
handling operation failures, installation security, access control, collection and
recording of statistical data and provisioning of reports which are stored locally
or sent automatically to the users. The paper defines a three level architecture
involving the application, equipment, signals, alarms, and implemented services.
The proposed management solution has been designed to provide a number of
services to the end user for all remote installations:Integratedfacility management of photovoltaicsystems 17
(i) A monitoring service, operating over the public internet (Web). The user is
capable,throughanInternetbrowser,togetinformation(parameters,events
and status) regarding the installations of interest to him/her.
(ii) A control service, also operating over the public internet (Web). The user is
capable, through an Internet browser, to control certain aspects of the oper-
ation of the remote installations.
(iii) A notification service, operating both over the Web and the mobile network
and delivering notifications to the mobile phones or e-mails of the users who
have subscribed to the service whenever certain events related to the installa-
tions of interest to them occur.
(iv) A report generation and delivery service, operating over the Web and deliv-
ering reports to the e-mails of users who have subscribed to the service in a
periodical manner. These reports include information on the installations
regarding operational, maintenance and financial aspects.
(v) A graphing service, creating comprehensive graphs of parameters and events
to be presented through the Web interface of the monitoring service or to be
included in reports, created by the report generation and delivery service.
(vi) An export service, allowing the user to store locally in his/her computer data
retained within the PV system management solution.
The rest of the paper is organized as follows. The automation system architec-
ture ispresentedin Section2.The maincontroland automationservicesprovided
are described in Section 3. A description of the solar park installation, the moni-
tored signals and implemented alarms follow in Section 4. Section 5 illustrates the
implemented services via the application screenshots, while Section 6 presents the
technology used to build the proposed application and the database schema.
2. Automation system architecture
Thearchitectureofacontrolsystemcanbedesignedvertically,withthedistinction
between functional levels (Passino, 2005). Our presented architecture shown in
Fig.2consistsofthreelevels.Eachofthemrepresentsanaspectofsystemfunction-
ality,presentingtheincarnationoftheautomationpyramidforasolarparkautoma-
tionsystem(Kastneretal.,2005).Thebottomlevelorthelevelofdevicesinteracts
withtherealworldandisconstitutedbythebasicequipmentofanautomationsys-
tem.Thisincludessensorsorothermeasuremeansaccordingtothefieldofapplica-
tion, actuators, data converters (digital to analog data and reversely) and routers
(Dorf and Bishop, 2010). In addition, PLCs or PACs are employing all necessary
interfacingandstoragefunctionalitydeployedateachinstallationseparately.After
the collection of data through measurement, counting, metering, they are trans-
formedintoarepresentationsuitablefortransmissionandprocessing(seeFig.3).
The role of the field controllers is very important. They recognize failures and
generate alarms derived either directly from signals I/O or complex algebraic,18 A.Meliones et al.
Internet
Wireless network
(2G/3G)
Internet
gateway SMSgateway
Application
Logic Module
Reporting Module
Database
Service Back-
Notification
Communication
Module Control/Data
Center
Private/public
network
Router
LA
N
PLC PLC
PLC
…
Sensors, actuators, Sensors,actuators, Sensors, actuators,
other equipment other equipment other equipment
Figure2 Automationsystemarchitecture.Integratedfacility management of photovoltaicsystems 19
SSttaattee--cchhaannggee eevveennttss
DDeerriivveedd ppaarraammeetteerrss
Calculation Calculation
PPrriimmaarryy MMaaxx//mmiinn … MMaaxx//mmiinn PPrriimmaarryy
ppaarraammeetteerr vvaalluuee vvaalluuee ppaarraammeetteerr
Calculation Calculation
…
RReeaall ttiimmee ddaattaa RReeaall ttiimmee ddaattaa
Calculation Calculation
Acquisition Acquisition
EEqquuiippmmeenntt// … EEqquuiippmmeenntt//
sseennssoorr sseennssoorr
Figure3 Thedataacquisitionmethodologysupportedbythesolution.
combinatorial or sequential functions and processes. Subsequently, they catego-
rize and prioritize, store, generate alerts and reports and communicate the status
of the installation to the management centers. There are important reasons as to
whyanintegratedfacilitymanagementsolution(IFMS)needsastand-aloneinfra-
structure (the site-level control/monitoring system) installed at the field:
(cid:2) Due to the vast variety of equipment that may exist in the installation, it is
expected that the solution has to interface them using an equivalent variety
of physical connection methods and protocols.
(cid:2) Though occasional loss of communication may occur, the nature of the
application does not leave much room for data loss, so storage in the field
is a necessity.
(cid:2) Scarce bandwidth may be available (e.g. communication with the installa-
tionmaybecarriedoutthroughaGPRSconnection),sosomeformofdata
reduction has to be applied.
(cid:2) There are certain requirements that mandate the existence of logic in the
field, which operates irrespective of whether a connection to the outside
world is operational or not.
This infrastructure is essentially a set of programmable networked controllers
employing all necessary interfacing and storage functionality deployed at each
installation separately. Therefore, it undertakes the responsibilities of:
(cid:2) Interfacingwithallequipmentinstalledinthefieldtoacquiredata,irrespec-
tive of the connection method and/or protocol.
(cid:2) Reducing the volume of data to something representative, yet less band-
width hungry.20 A.Meliones et al.
(cid:2) Conveying events that are generated directly by field equipment upon their
occurrence and generating events that are necessary yet not implemented
within the equipment in the field.
(cid:2) Storing all necessary parameters and events in a cyclical manner in the case
of failure of the communication with the outside world.
(cid:2) Implementingallnecessarycontrolloopsthathavetooperatelocallyandin
an independent manner.
ThemiddlelevelistheDataCenterwhichcommunicatesthroughapublicand/
orprivatenetworkwith thebottomlevel.Itis alsoknownas automationlevel.Its
role is to monitor and control all installations in a centralized manner. The main
part of the Data Center is the service back end, which undertakes to collect, store
and manage data from all remote installations. More specifically, the service back
end has the following responsibilities:
(cid:2) To collect, store and manage data from a variety of remote sites.
(cid:2) To transform data and prepare values for vertical access from the manage-
ment level.
(cid:2) To store and manage information regarding the users accessing the service.
(cid:2) To allow the users to configure the service back-end itself or the field-
deployed controllers.
(cid:2) To allow the users to carry out control functions on the installation.
(cid:2) To carry out any post-acquisition calculations that may be necessary.
The back-end is scalable to accommodate any number of measurement points
merely through the addition of new servers and storage subsystems. The service
back-endcanalsoprovideexternalinterfacestoothersoftwareentities,depending
on the customer needs. The service back-end has been designed to provide inter-
operation with a variety of third-party controllers and PLCs. For this reason,
an independent module, denoted as the Communications Adapter Module
(CAM) in the ensuing, has been implemented, which undertakes the task of
acquiring data from the remote installation and feeding them to the service
back-end as well as conveying data from the service back-end to the remote site.
Multiple CAMs are supported. The service back-end also incorporates an Appli-
cation Logic Module (the ALM), which calculates the derived parameters. This
module can be extended at will with new calculation functions. Other service
back-end modules include the Notification Server Module (NSM), which under-
takes the notification of the PV management solution users via SMS or e-mail
as well as the Reporting Server Module (RSM), which handles the generation
and delivery of reports. All necessary data are stored in a database.
Thetoplevelisthemanagementlevel.Atthislevel,informationfromtheentire
systemisaccessible.ThePVmanagementsolutionincludesafront-end,capableof
operation with a standard Web browser (Internet explorer, Mozilla Firefox or
Google Chrome). A unified interface is presented to the operator and end-usersIntegratedfacility management of photovoltaicsystems 21
for manual intervention in the system. It provides vertical access to the values of
theautomation level,includingthe modificationof parameterssuchas timetables.
Alarms are generated for exceptional situations such as technical errors or critical
conditions. The long-term storage of historical data with the ability to give com-
mands for reports and statistics is also part of this level.
3. Main control and automation services
ThePVmanagementsolutionmodelstheremoteinstallationasahierarchicaltree
structure. The nodes of the tree can be broadly categorized either as nodes repre-
senting virtual entities, or nodes representing equipment entities. The former do
not contain actual equipment installed in the field. Such entities are for example
the installation itself, a room etc. These nodes are denoted as virtual segments
in the ensuing. The latter contain a specific piece of equipment installed in the
field. Such entities are for example the numerous sensors/transducers, specific
equipmentetc.Thesenodesaredenotedasassetsegmentsintheensuing.Bothvir-
tual and asset segments are used in the ensuing as placeholders for the data that
are handled by the PV management solution. It has to be noted that certain parts
of the tree may be absent in certain cases. This model can be arbitrarily extended
to match further customer requirements.
3.1. Installation monitoring basics
Themonitoringserviceof thePVmanagementsolutionis basedonthemethodol-
ogy presented in the figure below. The PV management solution supports the col-
lection, storage, visualization and post-processing of the whole history of a large
variety of types of information for each node of the hierarchical model presented
above. These include:
(cid:2)Primary parameters: Primary parameters are calculated as the time-series aver-
age of real-time data after a certain set of validations have been applied. The
span of this average (the recording period) has to be an integer sub-multiple
or multiple of an hour. The PV management solution supports any recording
interval, though it has to be the same for the whole of a single installation.
Daily, monthly and yearly averaged values are also supportedfor each primary
parameter separately. Data acquisition and the calculation of primary parame-
ters are considered to be carried out by field-deployed controllers in order to
reduce the data that are conveyed to the service back-end and minimize band-
width requirements.
(cid:2)Maximum/minimum value parameters: These parameters are assumed to be
calculated in much the same way as primary parameters, except for the opera-
tion applied on the real-time data. Daily, monthly and yearly maximum/
minimum values are also supported. The calculation of maximum/minimum22 A.Meliones et al.
valueparametersis consideredtobecarriedoutbyfield-deployedcontrollersin
ordertoreducethedatathatareconveyedtotheserviceback-endandminimize
bandwidth requirements.
(cid:2) Derived parameters: Derived parameters are calculated using a specific mathe-
matic formula which operates on a specific set of values or vectors of values
of primary (and/or other derived) parameters. The PV management solution
provides the infrastructure that is necessary to carry out all derived parameter
calculations in the service back-end so as to further minimize the necessary
bandwidth and storage at the remote site. In the case that derived parameters
are calculated in the field, they can be considered as primary parameters within
the service back-end. Daily, monthly and yearly values are supported for each
derived parameter separately.
(cid:2) Raw, real-time data: The service back-end has been designed to store raw, real-
time data sets as they are acquired from the field-deployed controllers.
(cid:2) Real-time monitored data: In certain cases, it is necessary to present to the user
thereal-timedataastheyarerecordedbythefield-deployedcontrollers,without
any processing or storage. This functionality has to be supported by the equip-
ment deployed at the installation.
(cid:2) Status, states and state-change events: The concept is presented in detail in the
remaining paragraphs of this section.
Eachparametersampleandeventarecollected,storedandvisualizedwiththeir
acquisition time-stamp and engineering unit. Primary and derived parameters as
well as raw real-time data are collected from the field based on a time schedule,
aligned with the recording period. Status-change events are collected upon their
occurrence and real-time monitored data upon user request.
ThePVmanagementsolutionrecordsandpresentstotheuserthecurrentstatus
of entities that are either internal or external to the solution. The status is consid-
ered to be a powerful tool in terms of the user getting an immediate grasp on
whetheranyentityoftheinstallationbeingmonitoredoreventhePVmanagement
solution itself operate properly or not. Status information actually encodes the
severityoftheconditionofeachentityindependently,whichisanumberonascale
from 0 (everything normal) to 100 (complete disaster). The status update mecha-
nism shall become apparent in the ensuing.
Apart from status information, the PV management solution also supports an
arbitrary number of state-sets per entity. Each state set encodes a set of states,
whicharemutuallyexclusive,i.e.theentitycanbefoundinonlyoneofthem.Each
state of each state set also has a preset severity level associated with it. Changes
among states are triggered by state-change events, which are either directly gener-
ated by sensors and equipment connected to the PV management solution (pri-
mary events), or by the PV management solution itself (derived events). The PV
management solution provides all means necessary for the user to acknowledge
(validate) that he/she has been notified on any specific state-change event andIntegratedfacility management of photovoltaicsystems 23
has taken appropriate actions. This acknowledgement is a simple form of book-
keepingofuseractionsforfurtherinvestigation.Eachstate-changeeventisstored
and presented to the user per state set with a list of data, including the entity gen-
erating the event, the state the event led to in a descriptive form, the event date/
time in the timezoneof theinstallation, thedate/timeof the receptionof the event
in the timezone of the installation, and the event acknowledgment status and
acknowledgment text.
Sinceallentitiesareorganizedinahierarchicalstructure,thecurrentstatusofa
certain entity cannot depend solely on the state (or states) it is into, but the sta-
tusesofallunderlyingentitieswithinthehierarchyareusedaswell.Thisisabasic
concept within the PV management solution, since it enables the efficient notifica-
tionoftheuserifsomethingcallsforhis/herattention.Moreover,thishierarchical
status propagation, as it will be denoted in the ensuing, can help the user realize
the effect that an entity being in a certain state of a certain state set has on the
operation of the installation as a whole.
The status of each entity of the installation hierarchy is always equal to the
maximumseverityofthestatesofallunderlyingentitiesatanygivenpointintime.
The statuses of all involved entities are presented to the user in an easily under-
standable form (e.g. color encoding, based on a set of severity thresholds) so that
his/her attention is drawn not only to a specific event but also to the effect it has
on the operation of the whole installation. The approach is further clarified
through Fig. 4, presenting an exemplary hierarchy with the related statuses and
state-sets for each node. The related severities are also depicted, so that the hier-
archical status propagation is apparent.
3.2. Monitoring service
The main duty of the PV management solution is to provide, in a timely and con-
cisemanner,informationtoitsuserontheoperationofagroupofremotesites.As
far as the monitoring service is concerned, the flow of data through the solution
architecture is presented in Fig. 5. The CAM retrieves information necessary for
the addressing of data items within the site-level control/monitoring system from
the service back-end. It then connects to the field-deployed equipment based on a
schedule, collects the necessary data and submits them to the service back-end,
80
0 51 80
Status
9 51 39 80 State-set
5 9 51 39 21 80
Figure4 Thehierarchicalstatuspropagationconcept.24 A.Meliones et al.
User Interface
Reporting Module
Database Back-end Service Application logic module
NotificationModule
Communication Module
Monitoring & Control System
Figure5 Monitoringservicearchitecture.
which caches them in case some other module requests them and writes them to
the database. The ALM retrieves the necessary primary data to calculate the
derived values, also based on a schedule and submits the results to the service
back-end, which again caches and stores them in the database. The remaining
software modules (the Graphical User Interface, the Reporting Server Module
andtheNotificationServerModule)connecttotheback-end,eitherinascheduled
manner or upon user request and collect data in order to depict them or use them
in reports or notifications.
3.3. Control service
The PV management solution allows the user to issue commands toward the
equipmentwithintheinstallationorthesolutionitself.Thisfunctionalityisimple-
mentedthroughthenotionof settings,whosevaluesareconsideredconstantfrom
thetimetheyaresetuntiltheyarereset.Eachsettingeventisstoredandvisualized
with its timestamp and engineering unit. A user-inserted comment is also stored.
The user is notified whether his/her action has been successful or not as well as
whetherithasbeenappliedyet.Asfarasthecontrolserviceisconcerned,theflow
of data through the solution architecture is presented in Fig. 6. A control
User Interface
Database Back-end Service
Communication Module
Monitoring&ControlSystem
Figure6 Controlservicearchitecture.Integratedfacility management of photovoltaicsystems 25
command is issued via the GUI toward the service back-end. This software mod-
ule stores the command to the database and forwards it to the CAM, which
retrieves information necessary for the addressing of the controls within the
site-level control/monitoring system from the service back-end. It then connects
to the field-deployed equipment and propagates the command. At all times, the
user is notified via the GUI on the progress of the command he/she has issued.
3.4. Notification service
The Notification service informs the user on the occurrence of critical events.
Notification is via emails (internet gateway) or SMS (SMS gateway). The gener-
ation of such notifications is not triggered by individual state-change events but
rather by the status changes of each node of the hierarchy which is affected by
them. More specifically, if the severity of the status goes above a certain user con-
figurable threshold and remains there for a preset period of time, a notification is
generated to alert the user. Additionally, if the status falls below the same thresh-
old, another notification is generated in order to notify the user on the expiration
of the criticality. The user is capable of subscribing to the status changes of and
configuring the severity thresholds for each hierarchy node separately. It is
understandable that if he/she, depending on the subscription he/she has config-
ured, may receive multiple notifications upon occurrence of the same event or
set of events affecting the statuses of a certain set of nodes in the hierarchy.
Moreover, the user is capable of subscribing separately to the positive edge (sta-
tus going above threshold) or the negative edge (status going below threshold)
for each hierarchy node separately. Finally, the PV management solution logs
all notifications sent.
3.5. Reporting service
A very important function is the automatic generation of reports. This service
uses the Web and delivers reports to e-mails or mobile phones of users who have
subscribed to the service. These reports include information on the operation,
maintenance and financial situation of the entire system or specific facilities.
The timing and scope are determined by the administrator and the choices of
the user.
3.6. Data export service
The Data export service allows the user to store locally data that are stored in the
application. The source of data is primary or derived parameters from any mon-
itored entity. The extracted data are in xml file format or graphic representations.
The time frequency of data extraction and export is determined by the user.26 A.Meliones et al.
4. Solar park installation
The operation of solar parks/PV plants is based on the photovoltaic effect. The
photovoltaic effect is the basic physical process in which a photovoltaic cell con-
vertssunlightintoelectricity.Asolarparkconsistsofsolarpanels.Eachpanelisa
set of solar cells and numerous other protective and functional coatings installed
ontoanaluminumframeasameansofsupport.Theyareconnectedinseriesuntil
we get the desired effect on current output and in parallel until they reach the
desired voltage. As a result, solar panel connection is very important during
installation.
Acriticalequipmentofsolarparksisbattery.Thebatterystoressolarenergyto
provide electricity during periods of absence of sun, such as nights and cloudy
days. It must be able to be discharged and recharged. Rechargeable batteries
are a bit more expensive than the reserve batteries. Without batteries, a PVC sys-
temcanprovideelectricityonlywithsunlight.Alongwiththebatterythereshould
be a charge controller. Its role is to provide electricity to the batteries from the
solar panel in a way that prevents the solar panels from overloading the battery.
Lastly,solarparkshavepowerinverters.SolarpanelsgenerateelectricitytoDC
(direct current) power. Some devices are powered directly from the panel. How-
ever, most devices use high voltage AC (alternating current) power. The power
converter performs this procedure. It converts low voltage DC from the battery
to high voltage alternating current AC that is required by most household
appliances.
4.1. Signals
Every control and monitoring application controls a number of signals using the
appropriate sensing elements. Each transducer gives some type of digital (binary
or discrete) or analog (continuous) signal, or more complex signals in the form
of a protocol, e.g. serial. The type of signal depends on the observed physical size
andthetransducerused.Controllersinsideanautomationsystemcancontroland
monitor digital, analog and serial data from sensors, actuators and devices (Nof,
2009). Our implementation for controlling and monitoring the power of a solar
park uses the following signals:
(cid:2) Power signal: It is an analog signal. This paper suggests an implementation
which uses AC power. This consists of three components:
o Real/active power: The amount of energy consumed; measured in Watts.
o Apparentpower:Theamountofenergydeliveredfromasourcetoacharger.
Itmustalwaysbegreaterthanthatneededfromadevicetowork;measured
in Volt-Amperes (va).
o Reactive power: The amount of energy that returns to the source in each
cyclebecauseofthestoredenergy;measuredinreactiveVolt-Amperes(var).Integratedfacility management of photovoltaicsystems 27
(cid:2)Temperaturesignal:Itisananalogsignalusedforcheckingtheproperfunction-
ing of the system in extreme environmental conditions. Sensors measure the
temperatureoftheinstallation,bothinternal(moduletemperature)andexternal
(airtemperature).Theidealtemperatureforsolarpowerplantsis25(cid:2)C(77(cid:2)F).
When temperature increases, the current increases slightly, while the voltage is
reduced too quickly. This results in a lower overall energy output. A general
rule is that the performance of a cell drops by 0.5% per 1(cid:2)C above the 25(cid:2)C.
(cid:2)Humidity signal: It is an analog signal. A sensor measures the humidity of the
environment which is used for monitoring the proper functioning of the system
especially when the signal value goes over/under a specified threshold.
(cid:2)Wind signal: It is an analog signal used for the same reason as humidity signal.
The systemhas beentestedwith real data.Thesewerecollected duringaperiod
of one year from a real PV installation which collected and monitored the above
signals. Fig. 7 depicts the annual power produced in our monitored park in
relation with air temperature and humidity in the park area. The maximum per-
formance is in May, while the minimum appears in mid-December. The perfor-
mance increases during the summer months due to the favorable climate.
Apparently, performance change is proportional to temperature change. Mini-
mum performance has been recorded during the day of the year with minimum
air temperature. This synchronization between the two plots does not happen
for maximum performance. That means that temperature is not the only factor
Figure7 Annualproducedpowervs.airtemperatureandhumidity.28 A.Meliones et al.
affecting the performance of a solar park. Accurate weather data are essential to
the performance evaluation of the solar plant (inAccess, 2013). The total annual
power produced by the solar park reached 1.82MW.
Fig. 8 depicts the power and temperature values across a winter and a summer
day.Recordings on12 August 2010– a hot summer day with an outside tempera-
ture of an average 30(cid:2)C – show a peak of 900KW. Recordings on 12 December
2010 – a cold winter day with an outside temperature of a mere 5(cid:2)C – show that
it is easily and permanently possible to achieve the goal of 70(cid:2)C and a thermal
energy of almost 1.5MWh in the storage units: a very good result for almost the
shortest and coldest day of the year. In both cases, it is observed that the energy
produced (apparent power) by the park is entirely consumed (active power).
4.2. Alarms
Alarmsarebinarysignalswhichdependononeormoresignalsandactivatedbythe
changesoftheirvaluesandsituation.Inthecaseofbinarydigitalsignalsthealarmis
activatedbythestatechangeofthesignal.Incaseofanalogsignals,activationofthe
alarmtakesplacewhenthesignalvalueexceedsorgoesunderathreshold.Oursolar
park control and monitoring application implements the following alarms:
(cid:2) Temperature alarm (air and module alarm): The manufacturer or user sets min-
imum and maximum values for air and module temperature in order to control
the environment of a solar plant system in extreme weather conditions, such as
frosts or large heat waves. Temperature alarms are created when values exceed
these thresholds. The ideal temperature for solar power plants is 25(cid:2)C (77(cid:2)F).
Figure8 ACpowervs.temperature(12Augand12Dec).Integratedfacility management of photovoltaicsystems 29
(cid:2)Power loss alarm: This alarm is activated by a combination of factors. Some of
them are long periods of shadow, battery performance and temperature. As
mentioned before (see temperature signal), the increase in temperature results
in a lower overall energy output.
(cid:2)Batteryalarm:TheamountofkWperhourthatasolarpanelcanproducewith
battery life depends on temperature and on sun exposure. The manufacturer or
user sets minimum/maximum thresholdsand whenthe temperaturevalue is out
ofthisrangeforalongperiodthenabatteryalarmiscreated.Theperformance
ofabatteryisreducedbelowathresholdandbatterystopschargingoveratem-
perature limit.
(cid:2)Mold alarm: It is created with the logic of specified thresholds for valid values,
as described in temperature alarm.
(cid:2)Security alarm: Allows a user to control the installation of any disasters/
violations, through optical fibers applied to solar panels or used for installa-
tion’s fence.
5. Implemented services
The developed PV management solution for controlling and monitoring solar
parks implements a group of services, as these are specified at the previous
sections.
5.1. Surveillance
Every installation has cameras in specified areas according to pairs of coordinates
(south, north, west and east). The user can monitor with live video every plant by
specifyingthedirections/hewishes,andevenhandlingPTZ(pan,tilt,zoom)func-
tionality if available (see Fig. 9).
5.2. Performance
This service is very important because it allows the user to monitor very quickly
the total performance of the park. The user can monitor the current performance
as well as define specific periods of time to view a graph of the recorded values.
This service allows for macro-observation of the performance of the PV system
in field conditions. The user can compare the performance values between days,
months, years or certain time intervals and draw useful conclusions (see
Fig. 10). Performance analysis and evaluation are based on the procedures and
performance indicators defined in the IEC 61724 standard (International
Electrotechnical Commission, 1998; Emery et al., 2013), extended properly to
supportstate-setsandstate-changeevents.Performancemonitoringissignificantly
affected by the quality and calibration interval of the measurement hardware and30 A.Meliones et al.
Figure9 Surveillanceservice.
Figure10 Performanceservice.Integratedfacility management of photovoltaicsystems 31
the professionalism of the installation. The dominant error source in determining
the system power is determining the plane-of-array irradiance (Emery and Smith,
2011).
Following the IEC 61724 directives, the PV Management System acquires real
time measurement data from the PV equipment (DC–DC converter or inverter,
sensors like pyranometer, temperature and humidity sensors etc.) on fixed periods
oftime.Thecompletenessofreal-timedataisdeterminedandusedforfurtherpro-
cessing. Derived parameters are calculated using mathematic formulas that oper-
ateonspecificsetsofvaluesorvectorsofvaluesofprimary(and/orotherderived)
parameterscoveringasetofspecifictimespans(alwaysinmultiplesoftherecord-
ing period), called ‘‘reporting periods’’. IEC61724 presents a number of derived
parameters, related to efficiency, yields, losses and performance ratio which can
be used to monitor the performance of a PV system. The ones selected for the
PV management system are mean array efficiency, array capture losses, and per-
formance ratio.
Mean array efficiency represents the mean energy conversion efficiency of the
PV array, which is useful for comparison with the array efficiency at its nominal
outputpower.Thedifferenceinefficiencyvaluesrepresentsdiode,wiring,andmis-
match losses as well as energy wasted during plant operation. The array capture
losses represent the losses due to array operation and indicate the amount of time
during which the array would be required to operate at its rated power to provide
such losses. The maintenance performance ratio is calculated per PV array, PV
array group and the PV plant as a whole only for values of total irradiance which
are above the standard specified threshold. This threshold is the same for all per-
formance ratio calculations.
The PV management system must be capable of calculating derived parameters
for a variety of time spans, which extend into the past. It is understandable that
since the values of all primary parameters are stored within the solution for every
recordingperiod,itispossibletopost-processthatdatatoproducederivedparam-
eters for any reporting period.
5.3. Data export
Through the dataexport page the user can select one monitoredsignal ora group
of signals, the time period of interest for which a plot shall be produced (‘‘from/
to’’ selection) and the unit (X axis) of representation (days, months, years). The
results are being representedby graphical plots.The user furtherhas the opportu-
nitytostorethesevalueslocallyinanxmlfileorsendthemviaemail(seeFig.11).
5.4. Alarm
The alarm service allows the user to check the thresholds and priority for each
supported signal. The administrator can further set these values. Alarm32 A.Meliones et al.
Figure11 Dataexportservice.
notifications are generated based on these values. Two specific alarms – battery
and performance – are generated automatically by functions inside the service
back-end.Forthesetwoalarmstheusercanonlydefinetheirthresholdinpercent-
agemode,e.g.anotificationisbeinggeneratedwhenbatteryreaches15%ofmax-
imumperformance.Inaddition,thisservicedisplaysagraphicalrepresentationfor
the selected alarm in the specified period allowing the user to easily spot values
exceedingthepredefinedthresholdwhichisdepictedwithabluearea(seeFig.12).
5.5. Notification
The user defines in his/her profile page which type of communication channel will
be used per type of notification and alarm. Three channels are provided by the
system: (i) SMS to receive notifications in a mobile phone. (ii) Email, where the
user receives notifications in the email address filled in the registration form.
(iii) Inbox, which is implemented through a web page of the PV management sys-
tem called ‘Notifications’. This page is accessible through the system environment
of a logged user. It is easy to use and very practical because all the information is
gathered together (see Fig. 13).Integratedfacility management of photovoltaicsystems 33
Figure12 Alarmservice.
Figure13 Notificationinboxservice.
6. Technology framework
The proposed PV management system has been implemented in Visual Studio
2010 with Framework .NET 4. The programming language used is the object-
oriented C# language v4.0. The application consists of three projects. The first
project is a web site where all .aspx pages are implemented. The aspx pages34 A.Meliones et al.
Figure14 DatabaseERdiagram.
comprise the user interface. Each page has its own file code behind which imple-
ments functions of the Application Logic Module.
ThesecondoneisaClassLibraryprojectnamedDBTier.Thisprojectprovides
the Database Access Layer of the PV management solution and establishes the
connection to the system database. It contains files for each database table and
communicates with the Application Logic, Reporting Module and Notification
Module by carrying out insertions and updates or returning feedback via query
results for every function they operate.
The last project is a WCF Service Library project, which implements the Web
Service of the PV management application. WCF is an API in the .NET Frame-
work for building connected, service-oriented applications. Our PV management
applicationhas implemented a Mail SenderWeb Service,which sendsnotification
emails when an alarm is created. For this purpose we used the System.Net.Mail
libraryofthe.NETframework.Thislibrarycontainsclassesinordertosendemail
to a designated SMTP server for delivery. Notification mails include reports as
attachments.
The Visual Studio Integrated Development Environment includes the creation
of WCF Service Library for Web Services implementation. The WCF Service
Library is a compiled component that can be expanded as a Web Service or Win-
dows Service or even as part of a custom application hosting. When the debugger
starts, the WCF Service Host (WcfSvcHost.exe) implements the hosting of the
Web Services projects. Then it opens the WCF Test Client (WcfTestClient.exe)
and displays a list of service endpoints that have been defined in a configurationIntegratedfacility management of photovoltaicsystems 35
file. Therefore, the Wcf Test Client tool helps experience the implementation of
WebServicesandallowstheuserstotesttheirWebServiceswithouthavingtoexe-
cute the web application, and to implement the WcfSvcHost hosting without the
need for setting up of Web Services using the IIS (Internet Information Services)
Microsoft web server.
The Graphical representations of our application were implemented using
Charting Controls which are embedded in Framework 4.0. With these tools we
canspecifythetypeofgraph,theformatofthesourceofdataandthefilterofdata.
The database on the service back-end was implemented in Microsoft SQL
Server 2008 and consists of twelve tables (see Fig. 14):
(cid:2)Park: contains all registered parks.
(cid:2)Panel: contains all registered panels, each connected to a single park.
(cid:2)User: contains data for registered users who have access to a solar park.
(cid:2)Panel data: stores signals’ values. These values derive from the CAM, which
acquires data from the remote installation and calculates values’ average of a
time span of 30s. The values stored are: battery, humidity, wind speed, air
and module temperature, as well as active, reactive and apparent power.
(cid:2)Contact media: contains all available contact media (email-sms-inbox).
(cid:2)UserContactMedia: registers the media by which the user is notified for each
alarm.
(cid:2)Notification:savesallinboxnotificationswhichareautomaticallycreatedbythe
system.
(cid:2)Priorities: contains all available priorities for system’s notification (low-
medium–high).
(cid:2)ParkUser: connects users with parks defining a role for each relation.
(cid:2)Roles: contains the supported user roles of the system.
(cid:2)Thresholds: provide minimum and maximum value for all measured signals.
(cid:2)ParkThreshold: relates each park with its active thresholds.
7. Conclusions
We have developed a flexible modular network-based application which supports
all key services for automatic remote control and management of photovoltaic
parks. Our implemented PV management application fully achieved the system
objectives meeting successfully the initial user requirements. We have presented
in detail a three-tier layered architecture and the according design and implemen-
tation of a modular service back-end system including database, notification,
reporting and arithmetic logic system components. The presented integrated sys-
tem allows the easy and convenient monitoring of a real operational environment
and helps the executives to administer their solar parks. The service back-end can
provide online customized monitoring of signal groups and system status, energy36 A.Meliones et al.
production and environmental benefits in real-time. We have tested our system
with real data collected and monitored during a period of one year from a
2MWp PV plant installation. The monitored panel data included several signals:
active, reactive and apparent power, air and module temperature,battery, humid-
ity and wind speed.
The presented system is a successful paradigm of automation technology and
integration of front- and back-end system components which can be easily
migrated to solar buildings and even entire solar cities for solar energy exploita-
tion, as well as other types of renewable energy generation installations and
remote automation applications. The presented remote installation management
solution targets application areas in need of advanced control and monitoring
functionality, including:
(cid:2) Interfacingwith a variety of equipmentemploying different communication
methods and protocols.
(cid:2) Support of on-site logic and storage to enable remote control loops and
intelligentdatapre-processing(e.g.eventgeneration,algorithmicoperations
on real-time data etc.).
(cid:2) Storage of near real-time historical data (at a defined sampling rate) to a
central location around the clock.
(cid:2) Calculationandstorageofderivedparameters(e.g.keyperformanceindica-
tors) on a scheduled basis.
(cid:2) Hierarchical storage and presentation of data to facilitate post-calculations
and retrieval.
(cid:2) AccesstothestoreddataovertheWebandviaanintuitivefront-endoperat-
ingwithinthebrowserwiththecapabilitytoexportdatatotheoperator’sPC.
(cid:2) Event handling assisted by the concept of status propagation and notifica-
tions in order to readily alert users.
(cid:2) Scalability to any number of measurement points.
Future extensions of the presented work will study more novel approaches for
monitoring the current produced by arrays (strings) of photovoltaic modules
based on Wireless Sensor Networks (WSN) technology to let the creation of a
self-configuring wireless network of low-power and low-cost devices (no wires
fordatatransmissionandforsupplyingpowertothedevices),inordertodramat-
ically reduce the installation cost and time.
References
Bagnall,D.M.,Boreland,M.,2008.Photovoltaictechnologies.EnergyPolicy36(12),4390–4396.
Brown, M.A., Southworth, F., 2008. Mitigating climate change through green buildings and smart growth.
Environ.Planning40(3),653–675.
Dobriceanu,M.,Bitoleanu,A.,Popescu,M.,Subtirelu,E.G.,2009.Electricalstationsreal-timemonitoringusing
combined protection and control systems. IEEE International Symposium on Diagnostics for Electric
Machines,PowerElectronicsandDrives.Integratedfacility management of photovoltaicsystems 37
Dorf,R.C.,Bishop,R.H.,2010.ModernControlSystems,twelvethed.PrenticeHall,ISBN-13:978–0136024583.
Ekins-Daukes, N.J., 2013. Routes to high efficiency photovoltaic power conversion. 39th IEEE Photovoltaic
SpecialistsConference(PVSC),Tampa,FI,USA.
Emery, K., Smith, R., 2011. Monitoring system performance. Photovoltaic module reliability workshop,
NationalRenewableEnergyLab,USA.
Emery, K., Anderberg, A., Campanelli, M., Ciszek, P., Mack, C., Moriarty, T., Osterwald, C., Ottoson, L.,
Rummel, S., Williams, R., 2013. Rating photovoltaics. 39th IEEE Photovoltaic Specialists Conference
(PVSC),Tampa,FI,USA.
Fthenakis, V., Mason, J.E., Zweibel, K., 2009. The technical, geographical, and economic feasibility of solar
energytosupplytheenergyneedsoftheUS.EnergyPolicy37(2),387–399.
Gill,S.E.,Handley,J.F.,Ennos,A.R.,Pauleit,S.,2007.Adaptingcitiesforclimatechange:theroleofthegreen
infrastructure.BuiltEnviron.33(1),115–133.
Hallegate,S.,Heal,G.,Fay,M.,Treguer,D.,2012.Fromgrowthtogreengrowth–aframework,thenational
bureauofeconomicresearch,WorkingPaperNo.17841.
Huang,Y.,Quibria,M.G.,2013.Greengrowth:theoryandevidence,worldinstitutefordevelopmenteconomics
research,WorkingPaperNo.2013/056.
inAccess, 2013. Solar Plant monitoring: the role and importance of weather data in solar plant performance
evaluation. White paper <http://downloads.inaccess.com/role-and-importance-accurate-weather-data-solar-
plant-performance-evaluation>.
International Electrotechnical Commission, 1998. International Standard IEC 61724: Photovoltaic system
performancemonitoring–Guidelinesformeasurement,dataexchangeandanalysis.
Irmak,E.,Bulbul,H.I.,Kose,A.,Calpbinici,2013.Aweb-basedreal-timeindustrialenergymonitoringsystem.
4thInternationalConferenceonPowerEngineering,EnergyandElectricalDrives,Istanbul,Turkey.
Ja¨nique,M.,2012.Greengrowth:fromagrowingeco-industrytoeconomicsustainability.EnergyPolicy48,13–
21.
Kastner, W., Neugschwandtner G., Soucek S., Newman H.M, 2005. Communication systems for building
automationandcontrol.In:ProceedingsoftheIEEE,SpecialIssueonIndustrialCommunicationSystems,93
(6),pp.1178–1203.
Konieczny,F.,Krumsiek,D.,Behr,T.,Kruse,A.,Aron,R.,2012.Methodandcontroldeviceforcontrollingan
automatingsystem.UnitedStatesPatents,US8190274B2.
Lahti, J.P.,Shamsuzzoha, A. Kankaanpaa, T., 2011;Web-basedtechnologiesin power plantautomationand
SCADAsystems:areviewandevaluation.IEEEInternationalConferenceonControlSystem,Computing
andEngineering(ICCSCE),Penang.
Nof,S.Y.(Ed.),2009.SpringerHandbookofAutomation,ISBN978-3-540-78830-0.
Passino, M.K., 2005. Biomimicry for optimization, Control, and Automation. Part I. 7–55, Springer-Verlag,
London,UK.
Rycrofta,M.J.,Israelssonb,S.,Pricec,C.,2000.Theglobalatmosphericelectriccircuit,solaractivityandclimate
change.J.Atmos.Solar-TerrestrialPhys.62(17–18),1563–1576.
Sa´nchez-Pacheco,F.J.,Sotorrio-Ruiz,P.J.,Heredia-Larrubia,J.R.,Pe´rez-Hidalgo,F.,Sidrach-de-Cardona,M.,
2011.LowcostDClinesPLCbasedPhotovoltaicplantsparameterssmartmonitoringcommunicationsand
control module. International Conference on Power Engineering, Energy and Electrical Drives (POWER-
ENG),Malaga.
Toman,M.2012.Greengrowth:anexploratoryreview.WBPolicyResearchWorkingPaper6067.WorldBank.
Trovao,J.P.,Santos,F.M.,Silva,M.J.,Jorge,H.M.,2008.Aweb-basedmonitoringapproachforpowersystems
inindustrialplants.IEEEInternationalSymposiumonIndustrialElectronics,Cambridge,pp.1769–1774.
Wagle, A.M., Lobo, A.M., Santosh Kumar, A., Shubhangi Patil, 2008. Real time web-based condition
monitoringsystemforpowertransformers–casestudy.InternationalConferenceonConditionMonitoring
andDiagnosis,Beijing.
Woyte,A.,Dierckxsens,C.,DeBrabandere,K.,2013.Photovoltaicsinpowersystems:legends,challengesand
solutions,39thIEEEPhotovoltaicSpecialistsConference(PVSC),Tampa,FI,USA.