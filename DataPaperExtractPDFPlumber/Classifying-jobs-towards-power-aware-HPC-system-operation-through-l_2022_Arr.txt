Array15(2022)100179
ContentslistsavailableatScienceDirect
Array
journalhomepage:www.elsevier.com/locate/array
Classifyingjobstowardspower-awareHPCsystemoperationthrough
long-termloganalysis
YuichiTsujitaa,âˆ—,AtsuyaUnoa,RyuichiSekizawab,KeijiYamamotoa,FumichikaSueyasub
aRIKENCenterforComputationalScience,Kobe,Hyogo,Japan
bFujitsuLimited,Tokyo,Japan
A R T I C L E I N F O A B S T R A C T
Keywords: Theefficientutilizationofhigh-performancecomputing(HPC)systemresourcesunderrigorouselectricpower
Classification budgetorI/Oworkloadconstraintsisamongthemostimportantgoalssetbysystemoperatorstodealwith
Machinelearning thedemandingrequirementsofapplicationusers.Inmostcases,theeffectiveutilizationofCPUandmemory
Electricpower devices,whichistightlylinkedtoelectricpowerconsumption,isacounterpartmetricofI/Oactivitiesinmost
FLOPS
HPCjobs.TowardshigherutilizationofHPCsystemsunderstrictelectricpowerconsumptionandI/Oactivity
Memorybandwidth
management constrains, we must be careful to prevent hot-spots from developing in power consumption
FileI/O
or I/O operations that could lead to unstable system operations by exceeding electric power supply or I/O
subsystemcapabilities.Oneofthefeasiblesolutionsisarrangingcomputenodeassignmentnottohavesuch
hot-spots in electric power or I/O operations. To address this issue, we analyzed vast amounts of log data
collected from the K computer and found strong positive correlations between CPU and memory device
utilization rates and electric power consumption levels. On the one hand, we also observed strong negative
correlations and reduced electric power consumption in relation to file I/O activities in a specific compute
node-layout,therebyindicatinguniquecharacteristicsinsomeI/O-intensiveHPCjobsinthenode-layout.Our
investigation revealed that HPC jobs could be divided into two groups when classified in terms of required
electricpowerâ€”jobsconsuminghighelectricpowerlevelsandI/O-intensivejobswithreducedelectricpower
levels. Then, we achieved high levels of accuracy when classifying jobs in terms of electric power levels
using RandomForestClassifier among multiple machine learning classification models provided from
scikit-learn.Theclassificationcanpreventusfromhot-spotsinelectricpowerconsumptionincompute
node assignment in job scheduling. Thus we demonstrated efficient job classifications towards power-aware
systemoperationsinthesupercomputerFugaku,whichisthesuccessortotheKcomputer.
1. Introduction Our current HPC system, the supercomputer Fugaku [1] (here-
inafter, Fugaku), is the successor to the K computer. Compared with
In our current era, high-performance computing (HPC) systems theKcomputer,Fugakuhasadvancedmanagementfunctionsforelec-
with huge numbers of CPU cores are now approaching exascale per- tricpowerconsumptionthatensuremorestableandeffectiveelectric
formance levels. The primary mission of HPC systems is to provide powerusage[2,3].EventhoughtheKcomputerwasdecommissioned
stablecomputingresourceswithhighlevelsofutilizationandusability in August 2019, analyses of its power consumption during HPC job
underspecificconstraintssuchasestablishedpowerconsumptionand
executions have already provided some useful hints for more power-
I/O workload levels. However, increases in computing power require
aware operations using Fugaku. This is because, over its years of the
advanced storage systems of a similar scale with equally high I/O
Kcomputeroperation,wecollectedawidevarietyofsystemlogsand
performancelevels.Additionally,currentandfutureHPCsystemsmust
jobstats,includingperformancecountersrelatedtoCPUandmemory
accommodatewidevarietiesofjobs,includingcompute-,memory-,and
devices, file I/O activities, and even environmental metrics such as
I/O-intensiveapplications.Insuchsituations,wehavefoundthathigh
system board airflow and CPU cooling water temperatures. However,
utilization levels of CPU and memory devices tend to lead to high
electricpowerconsumptionlevels,whileI/O-intensiveoperationstend since the K computer did not have any electric power measurement
toresultinreducedelectricpowerusage. devices in its compute node modules, it was necessary to estimate
âˆ— Correspondingauthor.
E-mailaddress: yuichi.tsujita@riken.jp(Y.Tsujita).
https://doi.org/10.1016/j.array.2022.100179
Received15February2022;Accepted25April2022
Availableonline21May2022
2590-0056/Â©2022TheAuthor(s).PublishedbyElsevierInc.ThisisanopenaccessarticleundertheCCBY-NC-NDlicense(http://creativecommons.org/licenses/by-
nc-nd/4.0/).Y.Tsujitaetal. Array15(2022)100179
computer, the local file system (LFS) was a scratch high-performance
storage space dedicated to file I/O operations during computations,
whiletheglobalfilesystem(GFS)wasusedtostoreprogramsanddata
with high redundancy. An enhanced Lustre file system named Fujitsu
Exabyte File System (FEFS) [8] that was based on Lustre version 1.8
wasusedtobuildbothoftheKcomputerfilesystems.Whencombined
with asynchronous file staging scheme [9], this two-level file system
improvedjobschedulingefficiencyandmitigatedI/Ointerference.
Each compute node in the K computer had about 150GB of local
disk space on the LFS, and every HPC job was assigned to compute
nodeswithguaranteedamountsofavailablediskspace.Freediskspace
up to 100GB per node was set for job scripts using the node-quota
option. However, when the node-quota description was not given in
job scripts, a minimum size (14GB per node) was set as the default.
SpecifiedprogramsordatasetsinajobscriptwerecopiedfromtheGFS
to the assigned disk space on the LFS in the stage-in phase. After job
Fig.1. Kcomputersystemoverview. execution,thespecifiedoutputdatainthescriptwerecopiedbackfrom
theLFStotheGFSinstage-outphase.Whenasynchronousfilestaging
was used in the K computer, successive HPC jobs could jump to the
the electric power of each compute node using the abovementioned stage-inphaseoncetheKcomputerjobschedulersystemfoundenough
temperatureinformationandstatisticalinformationfromourprevious diskspaceforthejobsontargetcomputenodes.Forotherqueuedjobs,
study[4]. the job scheduler system conducted periodic checks of the compute
OurloganalysesregardingjobsexecutedintheKcomputerrevealed nodes until the required disk space was available and then matched
unique correlations among CPU, memory, file I/O activities, and the thosejobstotheappropriatecomputenodes.
computenode-layoutsused.Afterfurtheranalysis,wedeterminedthat Fig. 2 depicts the configuration of compute nodes and I/O nodes
jobs could be split into two groups based on electric power levels in a single cabinet of the K computer associated with the LFS. Every
â€” jobs requiring higher electric power levels due to high CPU and cabinetconsistedoftwosystemracks,andeachsystemrackconsisted
memory device utilization and jobs consuming relatively lower levels of96computenodesandsixI/Onodes.ComputenodesandI/Onodes
ofelectricpowersuchasI/O-intensiveapplications.Thesepreliminary were connected through the Tofu interconnect in a six-dimensional
resultswerereportedinourconferencepaper[5].Additionalanalyses (6D) mesh/torus network represented by ğ‘‹, ğ‘Œ, ğ‘, ğ´, ğµ, and ğ¶. Tofu
weremadebyusinganadditionalclassificationmodeltoexaminethe links of ğ‘‹, ğ‘ and ğµ were connected in a torus configuration, while
usefulnessofourapproach.Wealsomodifiedevaluationschemeforthe thoseofğ‘Œ,ğ´,andğ¶ wereconnectedinameshconfiguration.
classificationmodelsbyintroducingMatthewsCorrelationCoefficients Compute node allocation for each job was configured based on
(MCC)[6].Furthermore,weconductedfactorloadinganalysesofthe the number of compute nodes or the node-layout specified in a job
metrics used to examine contribution rates. Our approach, which we script in a three-dimensional (3D) rather than 6D manner, in which
discussinthispaper,isbasedonthefollowingtwo-stepmethod.First, the first dimension represented ğ‘‹Ã—ğ´, the second represented ğ‘Œ Ã—ğµ,
we analyze correlation coefficients among the metrics used in job andthethirdrepresentedğ‘Ã—ğ¶.Theminimumunitofcomputenode
stats.Then,basedontheresultsobtainedinthefirststep,weperform allocationintheKcomputerconsistedof12computenodesconfigured
classificationsusingthosemetricsandamachinelearning(ML)scheme. by the 2 Ã— 3 Ã— 2 in a 3D way. This layout was also represented by
The classification process leverages useful information towards more 1Ã—1Ã—1Ã—2Ã—3Ã—2 in a 6D expression. Therefore, if a specific node-
effectivepower-awarecomputenodeallocationandjobschedulingthat layoutwasdesired,theusersneededtogivemultiplenumbersof2,3,
isexpectedtobeusefulnotonlyforFugakubutforotherHPCplatforms and 2 in the first, second, and third dimensions in a 3D manner. The
aswell. jobschedulersearchedforfreeadjacentcomputenodesinablock-wise
The rest of this paper is organized as follows. In Section 2, we manner using a variety of 3D patterns in which the number of nodes
present an overview of the K computer, including the file I/O sub- in each axis was an integral multiple of the number of nodes in the
systems and electric power-related metrics. Correlation analysis using corresponding axis in the minimum unit. If a job script specified the
job stats log is then reported in Section 3, followed by a prediction number of nodes or node-layout that did not fit the above condition,
model discussion based on an ML approach in Section 4. We then thejobschedulerattemptedtomeetthenumberofrequiredcompute
discuss related work in Section 5 before finally concluding the paper nodesbyaddingadditionalcomputenodesinawaythatallowedthe
anddiscussingourfutureworkplansinSection6. node-layouttofittheaboveconditions.Thejobscheduleralsoallocated
compute nodes among 3D candidates by rearranging the number of
2. Kcomputeranditselectricpowerlogcollection nodesineachaxisiftherewerenonode-layoutrestrictions.
Note that the ğ‘-link torus configuration depicted by the vertical
2.1. Kcomputeroverview connections in this figure was only available in I/O accesses through
I/O nodes. Once the compute node-layout was fixed, I/O nodes on
Aftersevenyearsofsystemoperations,theKcomputerwasdecom- thesameğ‘-linkswereassignedtohandletheI/Ooperations,andI/O
missionedinAugust2019.Duringitsoperationalperiod,vastamounts paths were routed to the corresponding I/O nodes with the help of
of log data on system operations, facility operations, and job stats IO zoning scheme [10]. This I/O zoning scheme was introduced to
log were collected from the K computer, and were analyzed not only mitigate I/O interference happened at Object Storage Targets (OSTs)
for root-cause information concerning system failures or performance andI/OnodesbyassigningI/OnodesandOSTstothesameğ‘-linkused
degradation but also by researchers searching for ways to improve bythecomputenodes.Inothercases,applicationjobsusedtheğ‘-link
systemoperationquality.Fig.1showsanoverviewoftheKcomputer. in the mesh configuration for inter-node communications. Since I/O
The K computer consisted of 82,944 compute nodes and 5,184 I/O node-layout of the K computer was dependent on the compute node-
nodes.Inoperation,thecomputenodesandI/Onodeswereconnected layout facilitated by the I/O zoning scheme, some I/O-intensive jobs
viahighspeedandlowlatencyinterconnectsnamedTofu[7]developed tendedtospecifyfixed3Dnode-layoutstoguaranteeI/Operformance.
by Fujitsu. In the two-level file system that was introduced for the K In such cases, the most promising way to avoid I/O interference was
2Y.Tsujitaetal. Array15(2022)100179
Fig.2. LFSI/OsubsystemswithcomputenodesandI/OnodesconnectedthroughTofuinterconnects.
foundtobeplacingallthecomputenodesonthesameğ‘-linkbygiving were obtained by ğ‘ƒ [MW] = (ğ‘ƒ [MW] âˆ’ 10[MW])âˆ•82944, where
ğ‘›ğ‘œğ‘‘ğ‘’ ğ¾
32(=16Ã—2)inthelastdimensionofthe3Dnode-layoutinthejob 82,944isthetotalnumberofcomputenodesintheKcomputer.Note
submission.Thisspecificationresultedincomputenodelayoutsranging thatthepowermeasurementwascarriedoutforthepredictionstudy,
fromğ‘ =1to16atğ¶ =0and1withthesamevaluesinğ´,ğµ,ğ‘‹,and and we did not have any electric power data in the usual system
ğ‘Œ withinthesamecabinet. operation. Therefore, we have utilized the above formula to predict
electricpowerduringtheusualsystemoperation.
2.2. Electricpowerlogcollection The disk utilization ratio relative to the allocated disk space pro-
vides another insight into the file I/O status of each job and its
Asmentionedabove,sincetheKcomputerdidnothaveanyelectric associated activities. In general, CPU and memory device utilization,
power measurement devices, we established a prediction model [4] bothofwhicharetightlyassociatedwithelectricpowerconsumption,
using the following two averaged temperature differences among the tendtodecreasewithanincreaseinI/Ooperationworkloadandvice
followingtemperaturesensors: versa. Additionally, the same or similar job scripts are likely to be
usedrepeatedlyinHPCjobs[11].ThisindicatesthatinvestigatingI/O
â€¢ Temperature sensors for CPU and inlet cooling water at each
activitiesfrompastjobstatslogdatacanbeexpectedtoyieldinsights
computenodemodule(ğ›¥ğ‘‡ )
ğ¶ğ‘ƒğ‘ˆ abouttheelectricpowerlevelsofeachjob.Theresultsofsuchanalyses,
â€¢ Temperaturesensorsforinletandoutletofair-flowateachsystem
whencombinedwithjobstatslogdatacollectedfromtheKcomputer,
boardconsistingoffourcomputenodemodules(ğ›¥ğ‘‡ )
ğ‘ğ‘–ğ‘Ÿ canbeexpectedtoprovideusefulinformationtowardsensuringmore
Weobservedthattheconsumedelectricpowerhadstrongcorrelation power-awareHPCsystemoperationsinFugaku.
with ğ›¥ğ‘‡ and ğ›¥ğ‘‡ . Therefore we assumed that the electric power Forsystemoperationanalysis,wecollectedmanymetricsincluding
ğ¶ğ‘ƒğ‘ˆ ğ‘ğ‘–ğ‘Ÿ
was proportional to the two temperature values. We obtained each predicted electric power in the PostgreSQL database. Stored informa-
coefficientasameanvalueusingmeasureddataabout33,500jobsfrom tionwasaccessiblethroughourdashboardservicebuiltbyRedash[12].
April2014toNovember2014.Thefollowingformulawasobtainedto SomeofprincipalmetricsarelistedinTable1.
predicttheelectricpowerusedfortheKcomputer(ğ‘ƒ ğ¾)inourprevious Note that ğ‘ƒ ğ‘›ğ‘œğ‘‘ğ‘’ values were predicted at five-minute increments
study[4]: during each job execution, and the log information kept the maxi-
mum, minimum, and mean values of ğ‘ƒ in ğ‘ƒğ‘šğ‘ğ‘¥, ğ‘ƒğ‘šğ‘–ğ‘›, and ğ‘ƒğ‘šğ‘’ğ‘ğ‘›,
ğ‘ƒ [MW] = 0.802393382361262Ã—ğ›¥ğ‘‡ ğ‘›ğ‘œğ‘‘ğ‘’ ğ‘›ğ‘œğ‘‘ğ‘’ ğ‘›ğ‘œğ‘‘ğ‘’ ğ‘›ğ‘œğ‘‘ğ‘’
ğ¾ ğ¶ğ‘ƒğ‘ˆ respectively.Wecouldhavevariousofflineanalysisbyextractingtarget
+ 0.345223838880426Ã—ğ›¥ğ‘‡ ğ‘ğ‘–ğ‘Ÿ metricsfromtheredashservice.
+ 7.67202252302052
3. CorrelationanalysisofHPCjobactivities
In order to evaluate correctness of the obtained formula, we made
regression analysis between measured electric power and estimated
ThroughourI/Oactivityanalysesusingjobstatslogdatacollected
oneatthespecialrackwhichequippedwithelectricpowermeterfor
fromtheKcomputer,thefollowingquestionsarose:
this analysis. Consequently, we confirmed that the formula achieved
enoughcorrectnessthroughabout13,000jobsfromDecember2014to â€¢ Howmuchoftheallocateddiskspacespecifiedbynode-quotadid
February2015[4]. theusersutilize?
Notethatthe10MWvaluereferredtoelectricpowerwithoutany â€¢ Which metrics were most tightly related to I/O activities and
computation and I/O loads, and it was included in the ğ‘ƒ [4]. In electricpower?
ğ¾
order to characterize each job through electric power fluctuations, â€¢ How can we include electric power awareness when classifying
electric power values per compute node without the 10MW (ğ‘ƒ ) HPCjobsforcomputenodeallocations?
ğ‘›ğ‘œğ‘‘ğ‘’
3Y.Tsujitaetal. Array15(2022)100179
Table1 limit.However,itislimitedbythenode-quota.Inthisstudy,weassume
Listofloginformationcollectedforsystemoperationanalysis. 100MB/sforğµğ‘Šğ‘šğ‘ğ‘¥.
ğ¼âˆ•ğ‘‚
Metric Description It was noted that I/O-intensive jobs tended to require compute
JOB-ID UniqueJOB-IDgivenforeachjob nodes in the fixed 3D node-layout in order to prevent I/O-intensive
User-ID User-IDofthesubmittedjob applicationsfromencounteringI/Ointerferencefromotherjobs.Con-
QUE_CLS Queueclassusedforthejob
sequently, such jobs achieved high I/O bandwidth levels. However,
ğ‘…ğ‘… ğ¸ğ¸ ğ‘„ğ‘„ ğ‘Œğ‘‹ RR ee qq uu ee ss tt ee dd nn uu mm bb ee rr oo ffc coom mppu utte enn oo dd ee ss ii nn TTo off uu ğ‘Œğ‘‹ -- ll ii nn kk dd ii rr ee cc tt ii oo nn the CPU and memory utilization ratios of such jobs were lower than
ğ‘…ğ¸ğ‘„
ğ‘
RequestednumberofcomputenodesinTofuğ‘-linkdirection those in other node-layout cases. Additionally, since jobs set in the
ğ‘ğ· ğ‘‹ AllocatednumberofcomputenodesinTofuğ‘‹-linkdirection fixed 3D node-layout tended to utilize larger amounts of disk space
ğ‘ğ· ğ‘Œ AllocatednumberofcomputenodesinTofuğ‘Œ-linkdirection compared with other node-layout cases, we found some dependency
ğ‘ğ·
ğ‘
AllocatednumberofcomputenodesinTofuğ‘-linkdirection
intherequiredcomputenode-layoutintermsoffileI/O.
ğ‘‡ğ‘™ğ‘–ğ‘šğ‘–ğ‘¡ Elapsedtimelimitforthejob
ğ‘’ğ‘™ğ‘ğ‘ğ‘ ğ‘’ The job stats were analyzed separately based on the requested
ğ‘‡ ğ‘’ğ‘™ğ‘ğ‘ğ‘ ğ‘’ Elapsedtimeoftheexecutedjob
ğ‘ğ‘„ Theallocateddiskspacepercomputenodespecified compute node-layout in one-dimensional (1D), two-dimensional (2D),
bynode-quotaoption and 3D shapes. In the log information, 1D jobs had the number of
ğ‘…ğ‘† ğ¼ ğ¹âˆ•ğ‘‚ T To ht eal rab ty iote os fo sf uf si tl ae inI/ eO
dFLOPSrelativetothepeakFLOPS
nn uod me bs eo rsnl iy ni ğ‘…n ğ¸ğ‘… ğ‘„ğ¸ğ‘„ ağ‘‹ ndan ğ‘…d ğ¸z ğ‘„ero ai nn dğ‘… zğ¸ erğ‘„ oğ‘Œ inan ğ‘…d ğ¸ğ‘… ğ‘„ğ¸ğ‘„ .Lğ‘ a. s2 tlD y,j 3o Dbs joh ba sd ht ah de
ğ‘… ğ‘€ T reh le atir va etio too tf hs eus thta ei on re ed ticm ae lm bao nry dwb ia dn td hwidthutilization the numbers in ğ‘…ğ‘‹ ğ¸ğ‘„ ğ‘‹, ğ‘…ğ¸ğ‘„ğ‘Œ ğ‘Œ, and ğ‘…ğ¸ğ‘„ ğ‘. Sinğ‘ ce the number of 2D
ğ‘ƒ ğ‘›ğ‘š ğ‘œğ‘ ğ‘‘ğ‘¥
ğ‘’
Themaximumvalueofğ‘ƒ
ğ‘›ğ‘œğ‘‘ğ‘’
jobswasnegligiblysmallcomparedwith1Dand3Djobs,weanalyzed
ğ‘ƒ ğ‘›ğ‘š ğ‘œğ‘– ğ‘‘ğ‘› ğ‘’ Theminimumvalueofğ‘ƒ ğ‘›ğ‘œğ‘‘ğ‘’ 1Dand3Djobsfromthelargejobs.The3Djobswerefurtherseparated
ğ‘ƒ ğ‘›ğ‘š ğ‘œğ‘’ ğ‘‘ğ‘ ğ‘’ğ‘› Themeanvalueofğ‘ƒ ğ‘›ğ‘œğ‘‘ğ‘’ intotwogroups,withandwithoutchangesinthecomputenode-layout,
where we describe them as â€˜â€˜3D(malleable)â€™â€™ and â€˜â€˜3D(same)â€™â€™,
respectively.Weseparated3Djobsintothe3D(same)if
In our search for answers, using job stats log data from the second (ğ‘…ğ¸ğ‘„ =ğ‘ğ· )âˆ§(ğ‘…ğ¸ğ‘„ =ğ‘ğ· )âˆ§(ğ‘…ğ¸ğ‘„ =ğ‘ğ· )
ğ‘‹ ğ‘‹ ğ‘Œ ğ‘Œ ğ‘ ğ‘
halftermof2016tothefirsthalftermof2018oftheJapanesefiscal
year,weselectedthefollowingmetricsforeachjobthatranequaltoor Otherwise we separated the job into the 3D(malleable) in this
morethan10minwithoutanyerrorsinthelargestqueueclassnamed study. Correlation analyses were performed among ğ‘… ğ·, ğ‘… ğ¹, and ğ‘… ğ‘€,
â€˜â€˜largeâ€™â€™.Thereweretworeasonsforusinglogdataduringthistwo-year whereğ‘… ğ· representsfileI/Oactivitiesandğ‘… ğ¹ andğ‘… ğ‘€ correspondto
term;thesecondhalftermof2016waschosenasthestarttimebecause computingactivities.Asmentionedpreviously,higherfileI/Oactivities
ofalsomarkedtheestablishmentoftheabovementionedelectricpower inanHPCjobtendtoindicatelowerelectricpowerlevels.Incontrast,
higher computing activities in an HPC job tend to result in increased
predictionprocessusingtemperaturelogdata,whilethefirsthalfterm
electricpower.Forthesecorrelationcoefficientevaluations,weutilized
of 2018 was selected as the end time because we began conducting
aPythonmodule;andtoeliminatethedependencyofindividualcorre-
cooling system examinations (in which cooling water temperatures
lation functions, we utilized the following three correlation functions
wereintentionallychanged)fromthesecondtermof2018.Thismeant
providedbytheSciPy[13]package:
wecouldnotusetheestimationmodeltopredictelectricpowerduring
thatperiod. â€¢ The Pearson product-moment correlation coefficient using
Thefollowingmetricswereusedfromthelogdata: scipy.stats.pearsonr with metrics converted in log-scale
(hereinafter,Pearson(Log))
â€¢ ğ‘ğ‘„:Theallocateddiskspacepernodebynode-quota
â€¢ The Spearmanâ€™s rank-order correlation coefficient using
â€¢ ğ‘ğ· : The number of allocated compute nodes in Tofu ğ‘-link
ğ‘ scipy.stats.spearmanr(hereinafter,Spearman)
direction
â€¢ ğ‘… :Theratioofuseddiskspacerelativetotheassigneddiskspace â€¢ The Kendall rank-order correlation coefficient using
ğ· scipy.stats.kendalltau(hereinafter,Kendall)
specifiedbythenode-quotaoption
â€¢ ğ‘… ğ¼âˆ•ğ‘‚: The ratio of used disk space relative to the maximum Itshouldbenotedthattheconvertedmetricsinlog-scaleareusedfor
achievableamountofI/Osize thePearsonproduct-momentcorrelationevaluationinordertomitigate
â€¢ ğ‘… :TheratioofsustainedFLOPSrelativetothepeakFLOPS theimpactofoutliersashasbeenaddressedinotherstudy[14].
ğ¹
â€¢ ğ‘… :Theratioofsustainedmemorybandwidthutilizationrelative
ğ‘€
tothetheoreticalbandwidth 3.1. Correlationbetweenğ‘… ğ· andğ‘… ğ¹
â€¢ ğ‘ƒğ‘šğ‘ğ‘¥: The maximum electric power per compute node in situa-
ğ‘›ğ‘œğ‘‘ğ‘’
tionswheretheelectricpowerbasementhasbeenremoved SinceitisunderstoodthatI/O-intensiveapplicationstendtolower
CPU utilization rates, we next examined the correlation between ğ‘…
ğ·
Notethattheâ€˜â€˜largeâ€™â€™queueclasscoveredabout90%oftheKcomputer andğ‘… withcoloredplotsdescribingğ‘ğ‘„andğ‘ƒğ‘šğ‘ğ‘¥ inFig.3.
ğ¹ ğ‘›ğ‘œğ‘‘ğ‘’
compute nodes and accepted jobs using from 385 to 36,864 compute InFig.3(a),itcanbeseenthatthehigherğ‘… wehave,thelower
ğ·
nodes. Hereinafter, we describe jobs executed in this queue class as ğ‘… we achieved, and vice versa. It is also noted that several red-
ğ¹
largejobs. colored plots near zero for ğ‘… are jobs that showed low disk space
ğ·
While four of the abovementioned metrics are related to file I/O utilizationeventhoughlargeamountsofdiskspacehadbeenallocated
activities,therestarerelatedtoelectricpower.ThetwofileI/O-related bythehigherğ‘ğ‘„value.Separately,Fig.3(b)indicatesthatsomejobs
metrics,ğ‘… andğ‘… ,areclarifiedasfollows: achieved a higher ratio in ğ‘… while they achieved a quite low ratio
ğ· ğ¼âˆ•ğ‘‚ ğ¹
nearzeroinğ‘… ,thusresultinginhigherelectricpowerconsumption.
ğ· = ğ‘† âˆ•ğ‘ğ· âˆ•ğ‘ğ· âˆ•ğ‘ğ· ğ·
ğ¼âˆ•ğ‘‚ ğ¼âˆ•ğ‘‚ ğ‘‹ ğ‘Œ ğ‘ Figs. 3(c) and 3(d) show that the jobs in this group are localized
ğ‘… ğ· = ğ· ğ¼âˆ•ğ‘‚âˆ•ğ‘ğ‘„ with lowvalues inboth ğ‘… ğ· andğ‘… ğ¹ inthecase of3D(malleable)
ğ‘… = ğ· âˆ•ğ‘šğ‘–ğ‘›(ğ‘ğ‘„,ğµğ‘Šğ‘šğ‘ğ‘¥Ã—ğ‘‡ğ‘™ğ‘–ğ‘šğ‘–ğ‘¡ ) jobs,andthattheğ‘ğ‘„valuesgiveninthiscasearealsosmall.Mean-
ğ¼âˆ•ğ‘‚ ğ¼âˆ•ğ‘‚ ğ¼âˆ•ğ‘‚ ğ‘’ğ‘™ğ‘ğ‘ğ‘ ğ‘’ while,3D(same)jobsinFigs.3(e)and3(f)showtwodistinctgroups.
ğ· ğ¼âˆ•ğ‘‚, ğµğ‘Š ğ¼ğ‘š âˆ•ğ‘ ğ‘‚ğ‘¥, and ğ‘‡ ğ‘’ğ‘™ ğ‘™ğ‘– ğ‘ğ‘š ğ‘ğ‘– ğ‘ ğ‘¡
ğ‘’
are the actual file I/O size per node, max- Here,onegroupconsistsofI/Oorientedjobsspreadingfromzerotoone
imum I/O bandwidth, and elapsed time limit, respectively. Note that inğ‘… andlocalizingaroundzeroinğ‘… ,whiletheothergroupconsists
ğ· ğ¹
ğµğ‘Šğ‘šğ‘ğ‘¥Ã—ğ‘‡ğ‘™ğ‘–ğ‘šğ‘–ğ‘¡ is an achievable maximum I/O size amount if a job of compute-intensive jobs achieving higher ratios in ğ‘… , followed by
ğ¼âˆ•ğ‘‚ ğ‘’ğ‘™ğ‘ğ‘ğ‘ ğ‘’ ğ¹
utilizes 100% of the I/O bandwidth and is within the elapsed time achievinghigherğ‘ƒğ‘šğ‘ğ‘¥,asshowninFig.3(f).
ğ‘›ğ‘œğ‘‘ğ‘’
4Y.Tsujitaetal. Array15(2022)100179
Fig.3. Correlationbetweenğ‘… ğ· andğ‘… ğ¹ withindicatingğ‘ğ‘„andğ‘ƒ ğ‘›ğ‘š ğ‘œğ‘ ğ‘‘ğ‘¥ ğ‘’ ineachcolor-baraboutjobsinthethreenode-layoutcases,1D,3D(malleable),and3D(same). (For
interpretationofthereferencestocolorinthisfigurelegend,thereaderisreferredtothewebversionofthisarticle.)
3.2. Correlationbetweenğ‘… andğ‘… Fig.4(b).Thelowergroupuptoabout30Wcontainedjobsrangingup
ğ· ğ‘€
to0.2inğ‘… ,thenextgroupfromabout30Wtoabout60Wcontained
ğ‘€
Since memory bandwidth utilization is another key metric that jobsrangingfrom0.2to0.5inğ‘… ğ‘€,andthelastgroup,whichexceeded
tightlycorrespondstoelectricpower,weexaminedcorrelationbetween about60Wcontainedjobsexceeding0.5inğ‘… ğ‘€.Thisgroupingscheme
ğ‘… andğ‘… usingcoloredplotsdescribingğ‘ğ‘„andğ‘ƒğ‘šğ‘ğ‘¥,asshownin intermsofğ‘ƒğ‘šğ‘ğ‘¥ isdiscussedingreaterdetailinSection4.1.
ğ· ğ‘€ ğ‘›ğ‘œğ‘‘ğ‘’ ğ‘›ğ‘œğ‘‘ğ‘’
Fig.4. 3D(malleable) jobs are localized in lower ğ‘… as shown in
ğ·
Thecorrelationbetweenğ‘… andğ‘… showssimilarbehavior.Con- Figs.4(c)and(d),wherelowerğ‘ğ‘„valueswerespecifiedandmostof
ğ· ğ¹
cerningthe1DjobsshowninFigs.4(a)and4(b),wecanseethatjobs thejobsachievedlowerğ‘ƒğ‘šğ‘ğ‘¥.Whilethe3D(same)jobsinFigs.4(e)
ğ‘›ğ‘œğ‘‘ğ‘’
with lower ğ‘… tend to achieve higher ratios in ğ‘… , and that such and (f) show two groups; one ranging from zero to one in ğ‘… with a
ğ· ğ‘€ ğ·
higherğ‘… leadstohigherğ‘ƒğ‘šğ‘ğ‘¥.Itisalsonotedthatwecouldseparate lowerratioinğ‘… ,andanotherthatachievedasomewhathigherğ‘ƒğ‘šğ‘ğ‘¥
ğ‘€ ğ‘›ğ‘œğ‘‘ğ‘’ ğ‘€ ğ‘›ğ‘œğ‘‘ğ‘’
the 1D jobs into three groups about the ğ‘ƒğ‘šğ‘ğ‘¥ along ğ‘… , as shown in withanincreaseinğ‘… ataroundzeroinğ‘… .
ğ‘›ğ‘œğ‘‘ğ‘’ ğ‘€ ğ‘€ ğ·
5Y.Tsujitaetal. Array15(2022)100179
Fig. 4. Correlation between ğ‘… ğ· and ğ‘… ğ‘€ with ğ‘ğ‘„ and ğ‘ƒ ğ‘›ğ‘š ğ‘œğ‘ ğ‘‘ğ‘¥ ğ‘’ in each color-bar providing indications about jobs in the three node-layout cases, 1D, 3D(malleable), and
3D(same). (Forinterpretationofthereferencestocolorinthisfigurelegend,thereaderisreferredtothewebversionofthisarticle.)
3.3. Correlationbetweenğ‘… andğ‘… It is notable that linear dependencies were detected between ğ‘…
ğ‘€ ğ¹ ğ‘€
and ğ‘… with several coefficient rates since most of the 1D jobs were
ğ¹
compute-ormemory-intensive.Fig.5(a)showssomejobswithhigher
As described previously, the major sources of electric power con-
sumption by compute nodes are CPU and memory devices, which
valuesmorethan50GB/nodeinğ‘ğ‘„.InFig.5(b),jobsrequiringhigh
means that compute- or memory-intensive HPC jobs tend to consume electric power levels with high utilization ratios in both ğ‘… ğ‘€ and ğ‘… ğ¹
higherlevelsofelectricpower.Weexaminedcorrelationbetweenğ‘… areshowninorange-coloredplots.Here,itcanbeseenthatthecloser
ğ‘€
andğ‘… withcoloredplotsthatindicateğ‘ğ‘„andğ‘ƒğ‘šğ‘ğ‘¥. the linear coefficient rate approaches one, the higher ğ‘ƒğ‘šğ‘ğ‘¥ increases.
ğ¹ ğ‘›ğ‘œğ‘‘ğ‘’ ğ‘›ğ‘œğ‘‘ğ‘’
Fig.5showsthecorrelationsbetweenğ‘… andğ‘… ofeachjobin1D, Wealsonotedthatitispossibletoseparatethe1Djobsintothesame
ğ‘€ ğ¹
3D(malleable), and 3D(same) job cases with the ğ‘ğ‘„ and ğ‘ƒğ‘šğ‘ğ‘¥ threegroupsintermsofğ‘ƒğ‘šğ‘ğ‘¥,aswasdoneinSection3.2.Thiswillbe
ğ‘›ğ‘œğ‘‘ğ‘’ ğ‘›ğ‘œğ‘‘ğ‘’
shownincoloredplots. discussedfurtherinSection4.1.
6Y.Tsujitaetal. Array15(2022)100179
Fig. 5. Correlation between ğ‘… ğ‘€ and ğ‘… ğ¹ with ğ‘ğ‘„ and ğ‘ƒ ğ‘›ğ‘š ğ‘œğ‘ ğ‘‘ğ‘¥ ğ‘’ shown in each color-bar for jobs in the three node-layout cases, 1D, 3D(malleable), and 3D(same). (For
interpretationofthereferencestocolorinthisfigurelegend,thereaderisreferredtothewebversionofthisarticle.)
When compared with the 1D jobs, the number of 3D jobs was itcanbeseenthattherearejobswithhighğ‘ğ‘„ataround0inğ‘… and
ğ¹
smaller, and the 3D job situations were different from the 1D jobs. in the range from 0 to 0.2 in ğ‘… . Meanwhile jobs with higher ğ‘ƒğ‘šğ‘ğ‘¥
ğ‘€ ğ‘›ğ‘œğ‘‘ğ‘’
The figures in this group indicate lower utilization in both ğ‘… and around40Wshowhighervaluesinğ‘… orğ‘… inFig.5(f).Thesejobs
ğ‘€ ğ¹ ğ‘€
ğ‘… .Jobswithğ‘ğ‘„valueshigherthan50GB/nodewereobservedwith aresomewhatmorecompute-ormemory-intensivethanI/O-intensive
ğ¹
lower values in the range from 0 to 0.2 in ğ‘… and ğ‘… , as shown in becauseoftheirverylowğ‘ğ‘„values.
ğ‘€ ğ¹
Fig.5(c).Fig.5(d)showsusthatmostofthejobsconsumedrelatively
lowerelectricpowerandthatjobswithrelativelyhighelectricpower 3.4. Correlationcoefficientsamongmetrics
around40Whadlowğ‘ğ‘„,asshowninFig.5(c).
Ontheotherhand,the3D(same)jobsituationshoweddifferences Duringtheabovementionedcorrelationexaminations,wealsoused
fromthe3D(malleable)jobsituation,anditwasseenthatthereare thePearson(Log),Spearman,andKendallfunctionstoevaluate
jobswithhigherğ‘… thathavelinearrelationshipswithğ‘… .InFig.5(e), the correlation coefficients of six metrics used with the ğ‘ƒğ‘šğ‘ğ‘¥ in each
ğ¹ ğ‘€ ğ‘›ğ‘œğ‘‘ğ‘’
7Y.Tsujitaetal. Array15(2022)100179
Table2
Correlationcoefficients(upper)andp-values(lower)betweeneachmetricused(ğ‘ğ‘„,
ğ‘ğ· ğ‘,ğ‘… ğ·,ğ‘… ğ¼âˆ•ğ‘‚,ğ‘… ğ¹,andğ‘… ğ‘€)andğ‘ƒ ğ‘›ğ‘š ğ‘œğ‘ ğ‘‘ğ‘¥ ğ‘’.
Node-layout Metric Usedcorrelationfunctions
(#Jobs) Pearson(Log) Spearman Kendall
ğ‘ğ‘„ 0.146 0.203 0.161
(ğ‘<0.001) (ğ‘<0.001) (ğ‘<0.001)
ğ‘ğ· ğ‘ âˆ’0.0158 0.0116 0.00704
(ğ‘<0.001) (ğ‘<0.001) (ğ‘<0.001)
1D ğ‘… ğ· âˆ’0.187 âˆ’0.123 âˆ’0.0760
(127,439) (ğ‘<0.001) (ğ‘<0.001) (ğ‘<0.001)
ğ‘… ğ¼âˆ•ğ‘‚ âˆ’0.181 âˆ’0.123 âˆ’0.0760
(ğ‘<0.001) (ğ‘<0.001) (ğ‘<0.001)
ğ‘… ğ¹ 0.649 0.693 0.499
(ğ‘<0.001) (ğ‘<0.001) (ğ‘<0.001)
ğ‘… ğ‘€ 0.749 0.756 0.565
(ğ‘<0.001) (ğ‘<0.001) (ğ‘<0.001)
ğ‘ğ‘„ 0.0266 0.0901 0.0722
(ğ‘<1) (ğ‘<0.001) (ğ‘<0.001) Fig.6. Cumulativedistributionfunctionofthenumberofjobsintermsoftheğ‘ƒ ğ‘›ğ‘š ğ‘œğ‘ ğ‘‘ğ‘¥ ğ‘’
ğ‘ğ· ğ‘ 0.0455 0.239 0.182 forthreecategorizedgroups,ğ‘ƒ ğ‘™ğ‘œğ‘¤,ğ‘ƒ ğ‘šğ‘–ğ‘‘,andğ‘ƒ â„ğ‘–ğ‘”â„,bymeansofğ‘… ğ¹ andğ‘… ğ‘€.
(ğ‘<0.1) (ğ‘<0.001) (ğ‘<0.001)
3D(malleable) ğ‘… ğ· âˆ’0.0247 âˆ’0.0784 âˆ’0.0505
(1,512) (ğ‘<1) (ğ‘<0.01) (ğ‘<0.01) stable system operations. Hence, prior to compute node allocation,
ğ‘… ğ¼âˆ•ğ‘‚ âˆ’0.0254 âˆ’0.0785 âˆ’0.0505 HPC system operations require job predictions to determine whether
(ğ‘<1) (ğ‘<0.01) (ğ‘<0.01) or not each job will consume acceptable levels of electric power to
ğ‘… ğ¹ 0.613 0.662 0.459 prevent compute nodes from developing electric power consumption
(ğ‘<0.001) (ğ‘<0.001) (ğ‘<0.001) hot-spots[15â€“17].Accordingly,weneedthedevelopmentofapredic-
ğ‘… ğ‘€ 0.770 0.773 0.571 tionmodelbasedonjobstatsrecordedinthepastjobexecutionsthat
(ğ‘<0.001) (ğ‘<0.001) (ğ‘<0.001) would identify, in advance, which jobs would consume high levels of
ğ‘ğ‘„ âˆ’0.460 âˆ’0.408 âˆ’0.320 electricpower.
(ğ‘<0.001) (ğ‘<0.001) (ğ‘<0.001)
In the correlation examinations discussed in the previous section,
ğ‘ğ· ğ‘ âˆ’0.620 âˆ’0.701 âˆ’0.561 welearnedthattherearerelativelystrongpositivecorrelationsbetween
(ğ‘<0.001) (ğ‘<0.001) (ğ‘<0.001) ğ‘… andğ‘ƒğ‘šğ‘ğ‘¥ and/orbetweenğ‘… andğ‘ƒğ‘šğ‘ğ‘¥.However,wealsofound
3 (9D 8( 5s )ame) ğ‘… ğ· âˆ’ (ğ‘0 <.50 0.0 001) âˆ’ (ğ‘0 <.43 0.3 001) âˆ’ (ğ‘0 <.28 0.2 001) thğ¹ atthereğ‘›ğ‘œ ağ‘‘ rğ‘’ erelativelystrongnğ‘€ egativeğ‘› cğ‘œ oğ‘‘ rğ‘’ relationsbetweenğ‘… ğ· and
ğ‘… inthe3D(same)jobcase.Basedonthoseresults,weappliedour
ğ¹
ğ‘… ğ¼âˆ•ğ‘‚ âˆ’0.501 âˆ’0.434 âˆ’0.282 job stats log data to an examination of classification models using an
(ğ‘<0.001) (ğ‘<0.001) (ğ‘<0.001)
MLapproach.
ğ‘… ğ¹ 0.745 0.693 0.505
(ğ‘<0.001) (ğ‘<0.001) (ğ‘<0.001)
4.1. Potentialofclassificationlearnedfromcorrelationexamination
ğ‘… ğ‘€ 0.722 0.736 0.520
(ğ‘<0.001) (ğ‘<0.001) (ğ‘<0.001)
Based on the correlation examination of HPC jobs as shown in
Figs.4(b)and5(b),weexaminedtheğ‘ƒğ‘šğ‘ğ‘¥todeterminewhetherornot
ğ‘›ğ‘œğ‘‘ğ‘’
therewasroomtoclassifythejobsintothreegroups.Sinceğ‘… andğ‘…
node-layout case. In this examination, to ensure equal log data infor- ğ¹ ğ‘€
aretightlyrelatedtoğ‘ƒğ‘šğ‘ğ‘¥,weexaminedthefollowingclassificationfor
mation in each metric combination, we excluded log data that were ğ‘›ğ‘œğ‘‘ğ‘’
ğ‘ƒğ‘šğ‘ğ‘¥ intermsofğ‘… andğ‘… :
missing any of the metrics. The results obtained in the cases of 1D, ğ‘›ğ‘œğ‘‘ğ‘’ ğ¹ ğ‘€
3D(malleable),and3D(same)aresummarizedinTable2. â€¢ ğ‘ƒ :ğ‘… â‰¥0.4âˆ§ğ‘… â‰¥0.4
â„ğ‘–ğ‘”â„ ğ¹ ğ‘€
In Table 2, strong or relatively strong positive correlation coeffi-
â€¢ ğ‘ƒ :(ğ‘… â‰¥0.2âˆ§ğ‘… <0.4)âˆ¨(ğ‘… <0.4âˆ§ğ‘… â‰¥0.2)
cients can be observed about ğ‘… and ğ‘… with ğ‘ƒğ‘šğ‘ğ‘¥ in every node- ğ‘šğ‘–ğ‘‘ ğ¹ ğ‘€ ğ¹ ğ‘€
ğ¹ ğ‘€ ğ‘›ğ‘œğ‘‘ğ‘’ â€¢ ğ‘ƒ :ğ‘… <0.2âˆ§ğ‘… <0.2
layoutcasebecausehighutilizationlevelsinmemorydevicesorCPUs ğ‘™ğ‘œğ‘¤ ğ¹ ğ‘€
leadtohighelectricpowerlevels.Amongthethreenode-layoutcases, ğ‘ƒ representsHPCjobsthatconsumedhighlevelsofelectricpower
â„ğ‘–ğ‘”â„
3D(malleable) shows very weak correlation coefficients for the duetohighğ‘… andğ‘… values,whileğ‘ƒ isthegroupconsuminglow
metricsassociatedwithfileI/O(ğ‘ğ‘„,ğ‘ğ· ,ğ‘… ,andğ‘… )withğ‘ƒğ‘šğ‘ğ‘¥ ğ¹ ğ‘€ ğ‘™ğ‘œğ‘¤
ğ‘ ğ· ğ¼âˆ•ğ‘‚ ğ‘›ğ‘œğ‘‘ğ‘’ levels of electric power, in which I/O-intensive jobs were frequently
comparedwiththoseintheothernode-layoutcases.
observed.ğ‘ƒ isanintermediategroupbetweenthosetwogroups.In
ğ‘šğ‘–ğ‘‘
Another significant point is the relatively strong negative correla-
our analysis, the numbers of large jobs categorized in ğ‘ƒ , ğ‘ƒ , and
tion coefficients observed in ğ‘ğ‘„, ğ‘ğ· , and ğ‘… of the 3D(same) ğ‘™ğ‘œğ‘¤ ğ‘šğ‘–ğ‘‘
ğ‘ ğ· ğ‘ƒ were 111,721, 18,700, and 270, respectively. Most of HPC jobs
case.ThisisduetotheI/O-intensivejobsobservedathighfrequency â„ğ‘–ğ‘”â„
wereinğ‘ƒ ,whileverysmallnumberofjobswerecategorizedinğ‘ƒ .
inthisnode-layoutcase.Thiskindofjobsexplicitlyspecifiedthefixed ğ‘™ğ‘œğ‘¤ â„ğ‘–ğ‘”â„
However,impactofsuchhighelectricpowerjobswasverybiginthe
compute node-layout due to its suitability for I/O operations. In such
Kcomputeroperationstokeepstableelectricpowersupplies.
jobs,higherdiskspacewasgiveninğ‘ğ‘„,andahighervalueinğ‘… was
ğ·
Fig.6showsthecumulativedistributionfunctionofthenumberof
observed. Additionally, unlike the other node-layout cases, those jobs
large jobs in the three groups in terms of ğ‘ƒğ‘šğ‘ğ‘¥ based on the above
tendedtouseallthecomputenodesintheTofuğ‘-link. ğ‘›ğ‘œğ‘‘ğ‘’
classifications.
4. Jobclassificationusingmachinelearning Since,ascanbeseeninthisfigure,wecaneasilyseparatejobsin
theğ‘ƒ groupfromtheğ‘ƒ andtheğ‘ƒ groupsat60W,andthere
â„ğ‘–ğ‘”â„ ğ‘šğ‘–ğ‘‘ ğ‘™ğ‘œğ‘¤
Large-scale HPC systems such as Fugaku must accept inflexible issufficientroomtopredicthighpower-consumingHPCjobswithğ‘… ğ¹,
restrictionsintermsofelectricpowermanagementinordertoensure ğ‘… ,andothermetrics.
ğ‘€
8Y.Tsujitaetal. Array15(2022)100179
4.2. Jobclassificationusingimbalanceddatasets Table3
Thenumberofjobsassignedtothetestingdataset.
Based on the cumulative distributed function shown in Fig. 6, Rangeintheğ‘ƒ ğ‘›ğ‘š ğ‘œğ‘ ğ‘‘ğ‘¥ ğ‘’ (W) Node-layout
we further examined electric power classifications for improved com- 1D 3D(malleable) 3D(same) All
pute node assignments in terms of electric power using an ML ap- <60 31,789 â€“ â€“ 32,413
proach, where the following four classification models provided in â‰¥60 71 â€“ â€“ 71
scikit-learn[18]Pythonlibrarywereexamined: <50 31,695 â€“ â€“ 32,319
â‰¥50 165 â€“ â€“ 165
â€¢ LogisticRegression(hereinafter,LOR)
<40 30,857 â€“ 231 31,465
â€¢ DecisionTreeClassifier(hereinafter,DTC) â‰¥40 514 â€“ 16 1,019
â€¢ RandomForestClassifier(hereinafter,RFC)
<30 28,553 364 213 29,129
â€¢ KNeighborsClassifier(hereinafter,KNC) â‰¥30 3,307 14 34 3,355
We used job stats log data recorded in the same period as those
usedinthecorrelationcoefficientexaminations.Morespecifically,we Table4
examinedthefourpredictionmodelsfortheğ‘ƒğ‘šğ‘ğ‘¥usingseveralmetrics GridSearchCV() parameters in each classification model, where num_thread was
ğ‘›ğ‘œğ‘‘ğ‘’
combinationssuchasğ‘… ,ğ‘… ,andğ‘… withthehelpofthecorrelation givenattheexecutionstartupbasedontheavailableCPUresources.
ğ‘€ ğ¹ ğ·
coefficientanalysesreportedinSection3.Trainingandtestingdatasets Usedmodel Argument Specifiedparameter
werepreparedusingtrain_test_split()frommajorgroupdata LOR,DTC, scoring scoring="roc_auc"
consistingofjobinformationwithlowerelectricpowerlevels(X)and RFC,KNC n_jobs n_jobs=num_thread
minor group data consisting of job information with higher electric LOR estimator LogisticRegression()
powerlevels(y),whichwereobtainedbysplittingthelogdatainfor-
param_grid [{â€™Câ€™:[0.001,0.01,0.1,1,10],
mationatthegivenelectricpowerthreshold.Thedatasetpreparation â€™random_stateâ€™:[42],
wasperformedby â€™solverâ€™:[â€™lbfgsâ€™],
â€™max_iterâ€™:[10000]}]
X_train,X_test,y_train,y_test DTC estimator DecisionTreeClassifier()
=train_test_split(X,y,random_state=42, param_grid [{â€™max_depthâ€™:
test_size=0.25,stratify=y) [iforiinrange(1,10,2)]}]
RFC estimator RandomForestClassifier()
X_trainandy_trainaretrainingdatasetsforjobswithlowerand
param_grid [{â€™n_estimatorsâ€™:
higherelectricpowerlevels,respectively,whileX_testandy_test [iforiinrange(100,1001,100)],
aretestingdatasetsforjobswithlowerandhigherelectricpowerlevels, â€™max_depthâ€™:[ifori
respectively. Note that since the stratify specification implies the inrange(15,21,1)],
â€™min_samples_splitâ€™:
same y distribution characteristics for both training and testing, we
[iforiinrange(15,21,1)],
usedthesamedatasetseverytimeweperformedexaminationswiththe â€™criterionâ€™:[â€™giniâ€™,â€™entropyâ€™],
same distribution characteristics. It should be also noted that 75% of â€™random_stateâ€™:[42]}]
thedatawereassignedtothetrainingdataset,andtheremainderwere KNC estimator KNeighborsClassifier()
assignedtothetestingdataset. param_grid [{â€™n_estimatorsâ€™:
Thelargejobscanbedividedintotwogroupseasily,oneinwhich [iforiinrange(1,501,10)],
the ğ‘ƒğ‘šğ‘ğ‘¥ is greater or equal to 60W and another in which the ğ‘ƒğ‘šğ‘ğ‘¥ â€™weightsâ€™:[â€™uniformâ€™,â€™distanceâ€™],
ğ‘›ğ‘œğ‘‘ğ‘’ ğ‘›ğ‘œğ‘‘ğ‘’ â€™metricâ€™:[â€™euclideanâ€™,â€™manhattanâ€™]}]
is less than 60W, as can be seen in Fig. 6. Note that only the 1D job
caseincludesjobsthatexceed60Wintheğ‘ƒğ‘šğ‘ğ‘¥.Weconsider30Was
ğ‘›ğ‘œğ‘‘ğ‘’
ananotherthresholdcandidateintheğ‘ƒğ‘šğ‘ğ‘¥becauseğ‘ƒ jobsarebelow
ğ‘›ğ‘œğ‘‘ğ‘’ ğ‘™ğ‘œğ‘¤
orequalto30WinFig.6.Itisnotedthatsetting30Wforthethreshold Duetotheexistenceofimbalanceddatasetsinwhichthenumberof
inğ‘ƒ ğ‘›ğ‘š ğ‘œğ‘ ğ‘‘ğ‘¥ ğ‘’leadstoamixedsituationbecauseeachjobcaseconsistsofjobs negatives(suchasjobsabove60Winğ‘ƒğ‘šğ‘ğ‘¥)outweighsthenumberof
thatexceed30Wintheğ‘ƒ ğ‘›ğ‘š ğ‘œğ‘ ğ‘‘ğ‘¥ ğ‘’.Weanalyzedtheclassificationmodelsin positives(suchasjobslessthanorequaltğ‘› oğ‘œğ‘‘ 6ğ‘’ 0Winğ‘ƒğ‘šğ‘ğ‘¥),weevaluated
termsofğ‘ƒğ‘šğ‘ğ‘¥ bysetting60Wand30Wintheclassificationthreshold. ğ‘›ğ‘œğ‘‘ğ‘’
ğ‘›ğ‘œğ‘‘ğ‘’ theprecisionâ€“recallareaunderthecurve(PR-AUC)usingthemethods
In both threshold cases, we compared the precision of the models in
described in previous studies on binary classification evaluations of
the three job cases (1D, 3D(malleable), and 3D(same)) and the
imbalanced datasets [20â€“22]. Additionally, the precision, recall, and
jobcaseconsistingofthethreejobcases(hereinafter,All)toexamine
F1-score of the target negatives were used to examine the precision
electric-power-aware compute node allocation in the supercomputer
of the evaluated classification models. The MCC values of the used
Fugaku which is the successor to the K computer. Table 3 shows the
classification models were obtained with the training dataset because
numberofjobsassignedforthetestingdataset.
that value has been shown to be accurate even in an imbalanced
Since the two job cases, â€˜â€˜3D(malleable)â€™â€™ and â€˜â€˜3D(same)â€™â€™,
dataset[23].Inthispaper,theoverallscorewasdefinedintherange
did not have jobs above 50W, we excluded those node layout cases
from0to1whenevaluatingthepredictedclassificationmodelsusing
from the examination when classifying jobs at the threshold levels of
thethreetolerantmeasures,F1-score,PR-AUC,andMCC,asfollows:
60Wand50W,eventhoughbothnodelayoutcaseshadjobsbelowthe
âˆš
thresholdlevels.Thedatasetthatwassplitat40Wdidnothavejobsto ğ‘‚ğ‘£ğ‘’ğ‘Ÿğ‘™ğ‘™ğ‘ ğ‘ğ‘œğ‘Ÿğ‘’= 3ğ¹1-ğ‘ ğ‘ğ‘œğ‘Ÿğ‘’Ã—ğ‘ƒğ‘…-ğ´ğ‘ˆğ¶Ã—(ğ‘€ğ¶ğ¶+1)âˆ•2
beanalyzedattheâ€˜â€˜3D(malleable)â€™â€™layoutduetothesamereason.
In the four classification models, we utilized GridSearchCV() Higher overall scores indicate higher levels of precision for the pre-
[19]tofindtheoptimalparameter-setforeachmodel,andthenused dicted classification models. In this evaluation, we used the over-
thatsetforclassification.Theargumentparametersaresummarizedin all score to measure the classification effectiveness and the essential
Table4. metricsusedintheclassification.
Toimproveanalysisperformance,thenumberofthreadsavailable Fig.7showstheevaluatedvaluesofthethreeclassificationmodels
at a PC server was set for the num_thread to improve analysis perfor- intheğ‘ƒğ‘šğ‘ğ‘¥ at60Wineachnode-layoutcase.
ğ‘›ğ‘œğ‘‘ğ‘’
mance.TheGridSearchCV()providesthebestparametersfromthe Note that only the 1D case has jobs exceeding 60W, while DTC,
setofparametercandidatesgivenintheparam_grid. RFC, and KNC achieve near 1.0 in each measure using only ğ‘… and
ğ¹
9Y.Tsujitaetal. Array15(2022)100179
Fig.7. Scoresofpredictedclassificationmodelswiththethresholdsetat60Wintheğ‘ƒğ‘šğ‘ğ‘¥.
ğ‘›ğ‘œğ‘‘ğ‘’
Fig.8. Overallscoresoftheclassificationmodelswiththethresholdsetat60Wintheğ‘ƒğ‘šğ‘ğ‘¥,wherenumbersinthegraphrepresenteachoverallscore.
ğ‘›ğ‘œğ‘‘ğ‘’
ğ‘… asshowninFigs.7(b),7(c),and7(d),respectively.TheMCCvalue scoresintheAllcase,asshowninFig.8(b).Furthermore,thismodel
ğ‘€
oftheLORmodelisaround0.9withğ‘… andğ‘… .However,sincethis achieved the highest score (0.987) with ğ‘… , ğ‘… , and ğ‘ğ· , which
ğ¹ ğ‘€ ğ¹ ğ‘€ ğ‘
model cannot achieve a score that is comparable to other models, as indicates that it is the best choice in the classification at 60W in the
shown in Fig. 7(a), it cannot be used in the LOR model with fewer ğ‘ƒğ‘šğ‘ğ‘¥.
ğ‘›ğ‘œğ‘‘ğ‘’
metricsfromtheevaluation. Ontheotherhand,aswementionedabove,everyjobcasehasjobs
Although the All case consists of the 3D(malleable) and exceeding30Wintheğ‘ƒğ‘šğ‘ğ‘¥.Fig.9showstheevaluatedvaluesofeach
ğ‘›ğ‘œğ‘‘ğ‘’
3D(same) jobs below 60W, almost the same situation is observed classificationmodelwhenthejobsaresplitatthe30Wintheğ‘ƒğ‘šğ‘ğ‘¥.
ğ‘›ğ‘œğ‘‘ğ‘’
in the evaluated models, as shown in Figs. 7(e), 7(f), 7(g), and 7(h). Overall,theRFCmodelperformedwellcomparedwithothermod-
This is because of the smaller number of jobs (32,413â€“31,789 = 624 els in relation to the two primary metrics related to electric power
from Table 3) in the testing datasets for both 3D(malleable) and used in model predictions, ğ‘… and ğ‘… . However, the precision of
ğ¹ ğ‘€
3D(same). the predicted models in the node-layouts of 3D(malleable) and
Theoverallscoresoftheclassificationmodelsintermsofthemetrics 3D(same) became worse, especially in the 3D(malleable) case,
usedaresummarizedinFig.8. whencomparedwiththecasesof1DorAll.Furthermore,duetothe
Intheoverall1DscoresshowninFig.8(a),theRFCmodelachieved very weak correlation coefficients of metrics associated with file-I/O
the highest score (0.98) for the evaluated models with only ğ‘… and in the 3D(malleable) case reported in Table 2, it was difficult to
ğ¹
ğ‘… . The RFC model also slightly improved scores up to 0.984 by improve the precision of the prediction models in comparison with
ğ‘€
incorporating other metrics such as ğ‘… or ğ‘… and showed similar the other node-layout cases, even though the RFC and the KNC did
ğ· ğ¼âˆ•ğ‘‚
10Y.Tsujitaetal. Array15(2022)100179
Fig.9. Scoresofpredictedclassificationmodelswiththethresholdsetat30Wintheğ‘ƒğ‘šğ‘ğ‘¥.
ğ‘›ğ‘œğ‘‘ğ‘’
improve scores to levels equal to or exceeding 0.8 in F1-score, MCC, Sincemostjobsare1D,wecanseealmostthesamescoresinAll.
andPR-AUC. However,somedegradationinthescoresoccurredifthenumberofjobs
Based on the evaluated scores in F1-score, MCC, and PR-AUC, we in3D(malleable)and3D(same)increasedwhenconsideringthe
summarizedtheoverallscoresofthepredictedclassificationmodelsin
scores in the two cases mentioned above. This indicates that it might
Fig.10.
bebettertoperformjobclassificationseparatelyineachnode-layout.
The RFC achieved the highest values of about 0.945, 0.832, and
0.944inthecasesof1D,3D(malleable),andAll,respectively.In Wealsomadeclassificationat40Wand50W,andtheoverallscores
the3D(same)case,theKNCachievedthehighestscoreof0.942but
ofthemareshowninFigs.11and12,respectively.
the RFC achieved a comparable score of 0.929. In [24], the authors
ComparedwiththeresultsinFigs.10and8,wehavefounddegra-
reported that the RFC model performed well when used to classify a
large imbalanced dataset and we achieved a similar result with our dation in the overall score except the 3D(same) jobs in the case of
imbalanceddataset. 40W.AswehavenoticedaboutFigs.3(e)and3(f)inSection3.1,the
11Y.Tsujitaetal. Array15(2022)100179
Fig.10. Overallscoresofthefourclassificationmodelswiththethresholdsetat30Wintheğ‘ƒğ‘šğ‘ğ‘¥,wherethenumbersinthegraphrepresenteachoverallscore.
ğ‘›ğ‘œğ‘‘ğ‘’
Fig.11. Overallscoresofthefourclassificationmodelswiththethresholdsetat40Wintheğ‘ƒğ‘šğ‘ğ‘¥,wherethenumbersinthegraphrepresenteachoverallscore.
ğ‘›ğ‘œğ‘‘ğ‘’
12Y.Tsujitaetal. Array15(2022)100179
Fig.12. Overallscoresofthefourclassificationmodelswiththethresholdsetat50Wintheğ‘ƒğ‘šğ‘ğ‘¥,wherethenumbersinthegraphrepresenteachoverallscore.
ğ‘›ğ‘œğ‘‘ğ‘’
executedinthe1Dcase,similarbehaviorsforallsixmetricsusedwere
observedintheAllcase.
The behavior of two file I/O-related metrics, ğ‘ğ‘„ and ğ‘ğ· , are
ğ‘
noteworthy because they showed different properties in each node-
layout.Inthecasesof1D,3D(malleable),AllshowninFigs.14(a),
14(b),and14(d),thecontributionratesofğ‘ğ‘„andğ‘ğ· toPC2were
ğ‘
largerthanthosetoPC1,whiletheircontributionratestoPC1increased
inthecaseof3D(same),asshowninFig.14(c).Thisisbecauseofthe
I/O-intensivejobsthatspecifiedhighervaluesinğ‘ğ‘„andwhich,tothe
maximumextentpossible,hadcomputenodesinthesameTofuğ‘-link
ofthe3D(same)node-layout.
From the above analysis in addition to correlation coefficients re-
portedinTable2,wecanstatethefollowing:
â€¢ Computing-relatedmetrics,ğ‘… andğ‘… ,aremajorclassification
Fig. 13. Cumulative contribution rate of principal components in each node-layout ğ¹ ğ‘€
case. metrics.
â€¢ File I/O-related metrics, ğ‘… and ğ‘… , are counterparts to the
ğ· ğ¼âˆ•ğ‘‚
computing-relatedmetrics.
3D(same) jobs had two distinct groups: one group consisted of I/O- â€¢ Other file I/O-related metrics, ğ‘ğ‘„ and ğ‘ğ· ğ‘, show distinct be-
intensivejobs,whileotherhadcompute-intensivejobs.Asaresult,we haviorsinthe3D(same)node-layoutcaseduetothefrequency
haveachievedhigherscoresonlyinthe3D(same)jobs. ofI/O-intensivejobsinthatcase.
Taken together, these results indicate that it is preferable to clas-
4.3. Factorloadingofmetricsinthejobclassification
sify HPC jobs in each compute node-layout rather than to perform
classificationwithoutseparatingthejobsintoeachnode-layout.
In order to examine the contribution rate of the principal com-
ponents and the factor loading of the metrics used in the princi-
5. Relatedwork
pal components, we performed principal component analysis using
sklearn.decomposition.PCA() in scikit-learn after standardiz-
TokeeptheHPCsystemoperationswithinalimitedpowerbudget,
ingeachmetric.Fig.13showscumulativecontributionraterelativeto
thenumberofprincipalcomponentsrangingfromthemostinfluential power management is currently one of the most important issues
principalcomponenttotheleastinfluentialone.Thisfigureshowsthat in HPC system operations. Because of this, power capping has been
wecanachievehigherHPCjobclassificationlevelsofprecisioninthe proposed as a way to control electric power consumption in order to
cases of 3D(malleable) and 3D(same) than can be achieved for facilitatestableHPCsystemoperationsinnumerousstudies[15,16,25].
theAllcase,whichmeansthatwhenperformingjobclassification,it In the K computer operation, we also worked diligently to manage
isbettertosplittheHPCjobsineachnode-layout. system operations within our power budget. Although we did not
Fig. 14 indicates the factor loading of each metric relative to the haveelectricpowermeasurementdevices,full-scalepowerpredictions
twomajorprincipalcomponents,PC1andPC2,ineachnode-layout. were performed for jobs using our prediction models [4] in a few
In Figs. 14(a), 14(b), and 14(d), it can be seen that two file I/O- days of special full-scale job execution period held once per month
relatedmetrics,ğ‘… andğ‘… ,arerelatedtothefirstprincipalcompo- according to the recorded metrics with their smaller jobs. In Fugaku,
ğ· ğ¼âˆ•ğ‘‚
nent,PC1,ataround0.75relativetothesecondprincipalcomponent, whichisthesuccessortotheKcomputer,wehaveimplementedpower
PC2,whileFig.14(c)showsthatthetwometricsarerelatedtobothof control and power measurement functions for its CPUs, memory de-
PC1andPC2around0.5. vices,andcomputenodeperipheralequipment.Alongwiththeadopted
The computing related metrics, ğ‘… and ğ‘… , showed similar be- enhancements, we have also implemented power measurement and
ğ¹ ğ‘€
havior expressing a higher contribution of ğ‘… to PC2, as shown in control features in the operation software [2]. The metrics obtained
ğ¹
Figs. 14(a) and 14(d), while Figs. 14(b) and 14(c) show different the measurement functions are also provided for users in a summary
behavior in each case. When compared with ğ‘… , it can be seen that dataoftheexecutedjobtotunetheirapplications,forinstance.
ğ¹
ğ‘… hasasmallercontributiontobothPC1andPC2inthecasesof1D Another aspect of controlling electric power consumption is I/O
ğ‘€
andAll,asshowninFigs.14(a)and14(d).SincemostHPCjobswere operation management. Due to the negative correlation between I/O
13Y.Tsujitaetal. Array15(2022)100179
Fig.14. FactorloadingofthemetricsusedrelativetoPC1andPC2.
operationsandelectricpower,anothersolutionforpowermanagement configuration where a subset of compute node also acts as I/O node.
ismonitoringI/OactivitiesinHPCjobsandcharacterizingthosejobs AlthoughI/OnodetasksareassignedforextraCPUcoresonsuchnode,
based on their I/O intensity. Numerous studies have focused on log therearerisksthatwemayhaveasortofinterferenceamongjobsshar-
analysis as a way to reveal the I/O activities of HPC jobs [26â€“28]. ingthesameI/Onode,especiallywhensuchI/Onodefailtooperate
Forexample,Liuetal.[26]developedanapplicationcharacterization duetoheavyI/Ooperations.SinceourproposedMLclassificationalso
analysisframeworkthatincludedI/Oactivitiesandsuccessfullyincor- shows inverse proportional among I/O activities and electric power,
porated consideration for I/O activities in job scheduling. Separately, suchmethodologycanbeoneofthesolutionstopreventsuchproblems
Wangetal.[27]proposedamultilateralframeworktoinvestigateI/O incomputenodeallocation.
activities and the root causes of I/O problems, from a comprehensive Here, it should be noted that ML has been actively and widely
analysis of large-scale I/O log data, in which Darshan [29,30] was introduced for huge scale log analysis in HPC systems [33â€“35]. For
introduced to collect I/O performance metrics. Lockwood et al. [28] example, He et al. [33] studied failure prediction by parsing logs,
proposed a holistic analysis framework for use in investigating whole followedbyperformingMLthroughsystemloganalysis.Toaccomplish
HPC systems using numerous analysis and monitoring tools such as this,theyevaluatedthreesupervisedandtwounsupervisedmethodsin
Darshan.However,theabovementionedstudiesdidnotdiscusselectric theirMLanalysis.Separately,Dasetal.[34]proposedaframeworkfor
powerissues,eventhoughtherehavebeenstudiesthatdiscussedpower predictingfailurenodesinHPCsystemsusingtheirtime-basedphrase
managementfromtheviewpointofI/Oactivities[31,32].Forexample, (TBP) prediction scheme. The TBP framework was built with an ML
Manousakisetal.[31]proposedaframeworkthatcanbeusedtomini- techniquecalledLatentDirichletAllocation(LDA)[36]withaTopics
mizeelectricpowerinI/O-intensivejobs,andLeeetal.[32]addressed overTime(TOT)[37]enhancementtotakethetimecorrelationaspect
providingaframeworkthatcanbeusedtosupplymoreelectricpower into consideration. The effectiveness of that framework was demon-
tocompute-intensivejobsusingI/Oawarepowershiftingalgorithms. stratedintheirloganalysisofaCrayHPCsystem.Kimetal.[35]also
Similar to these research efforts, we focused on using several I/O studiedI/OperformancepredictionusinganMLapproachthroughlog
activity metrics to classify HPC jobs in terms of electric power and analysisstudyinwhichtheirframeworkanalyzedpreferablemetricsfor
have observed some specific features of I/O-intensive HPC jobs, such MLthroughcorrelationanalysesconductedbeforetheMLphase.Their
asnode-layoutspecificationsorrequireddiskspaceallocations,through regression-based ML approach achieved higher prediction accuracy
correlationstudiesofthosemetrics.ThroughtheFugakuoperation,we in I/O-intensive applications from a number of different system logs
have faced I/O contentions among jobs. Fugaku has different system and the automatic selection of the best regression algorithm in each
14Y.Tsujitaetal. Array15(2022)100179
prediction.However,inourwork,whichisfocusedonelectricpower Furthermore, in the classification at 30W, that model achieved high
consumption using ML classification models with metrics recorded in scores of up to 0.945, 0.832, and 0.944 among the evaluated models
jobstatslogdata,wefoundthatcorrelationstudiescanproducerela- inthethreenode-layoutcasesof1D,3Dwithlayoutchanges,andall
tivelystrongpositiveassociationsbetweentheutilizationratiosofCPUs node-layoutcases,respectively.AlthoughtheKNCmodelachievedthe
andmemorydevicesandelectricpowerlevelspernode.Additionally, highest score (0.944) in the 3D node-layout without layout changes,
correlation studies between disk utilization ratios and electric power
the RFC model achieved a comparable score. Classifying the jobs at
levelspernodeshowedstrongnegativeassociationsinafixed3Dnode-
50Wor40Wdidnotshowgoodscoresexceptthecomputenodelayout
layoutcasebecauseI/O-intensivejobswerefrequentlyexecutedinthat
of 3D with layout changes because of difficulty in classifying jobs at
node-layout.Basedontheseresults,weappliedanML-basedapproach
those threshold levels among mixed jobs about electric power levels
to classifying jobs in terms of electric power levels per node. The
percomputenode.Overall,wedeterminedthattheRFCwasthebest
major factors used to predict electric power levels are the utilization
modelforuseinourHPCjobclassificationsintermsofelectricpower
ratiosofCPUsandmemorydevices,butadditionalmetricssuchasthe
levelspercomputenodeifweadoptedappropriatethresholdlevelsuch
diskutilizationratiohavealsoimprovedtheprecisionofthepredicted
classification models. Finding preferable metrics through correlation as60Wor30W.
analysisandautomaticselectionofpredictionmodelsappliedin[35] Through an analysis of the contribution rate of principal com-
isaprocessworthbeingintroducedintoourMLscheme. ponents and the factor loading of the metrics used in the principal
One of the remaining that will be discussed in this paper is the components,weobservedthatthecomputing-relatedmetrics,suchas
methodusedtoevaluatepredictedclassificationmodelsforimbalanced utilizationratiosinCPUFLOPSandmemorydevices,arecounterparts
datasets in ML studies. In this context, He and Garcia reported im- ofthetwofileI/O-relatedmetrics,whicharetheratioofdiskutilization
proved precisionâ€“recall curve efficiency, even in imbalanced datasets relativetoallocateddiskspaceandtheratioofuseddiskspacerelative
in their paper [38] in which they clearly discussed the problems that to achievable maximum I/O size amount. The other file I/O-related
occurred in those datasets along with some state-of-the-art solutions
metrics, the size of allocated disk space per node and the number of
for those problems. Separately, Jauk et al. produced a survey paper
nodesintheTofuğ‘-linkdirection,showedfeaturesthatweresimilarto
in which they discussed state-of-the-the-art studies about failure pre-
theotherfileI/O-relatedmetricsinthe3Dnode-layoutwithoutlayout
diction in many leading HPC systems [39]. Although they discussed
changes.ThisisduetothefactthatI/O-intensivejobsspecifiedhigher
effectiveevaluationsamongdifferentclassificationmodelsinreference
values in the assigned disk space per node and in the occupancy in
toimbalanceddatasets,theyonlytouchedbrieflyonstudiesthatpaid
compute nodes on the same Tofu ğ‘-link. Since every metric showed
close attention to the problem, despite the large number of research
differentpropertiesineachnode-layoutcase,notonlyfromthisanal-
paperssurveyed.Additionally,theylimitedtheirremarkstostatingthat
no numerical or statistical analysis studies have yet been conducted ysis but also from our correlation study, we concluded that when it
to address this problem. Contrastingly, in our research, we proposed comestofacilitatingpower-awareHPCsystemoperations,performing
a combined evaluation score by introducing F1-score, PR-AUC, and job classification in each node-layout case is preferable to building a
MCCforuseincomparisonsamongdifferentclassificationmodelsusing jobclassificationmodelwithoutanyattentiontonode-layouts.
imbalanced datasets. Although our proposal works acceptably in our Ourfutureworkwillfocusonautomaticselectionamongevaluated
MLstudyusingKcomputerlogdata,itwillbenecessarytoproposean classificationmodelsbasedontargetmetricslikethoseexploredin[35]
improved oroptimummethod of conductingML-based evaluations of withperiodicalupdatesissuedasweintroduceourapproachinFugaku.
imbalanceddatasetsinthefuture. SinceFugakusupportsanelectricpowermeasurementfunctioninside
its CPU nodes, there is expected to be additional room for improving
6. Conclusions
theprecisionoftheclassificationmodelsused.Sinceweneedtosupply
stable electric power in Fugaku operation, optimization in compute
Herein we reported the analysis of two years of job stats log data
node allocation is one of the important aspects in future advanced
collectedfromtheKcomputertoclassifyHPCjobsintermsofelectric
operation.WeexpectthatclassificationofHPCjobsintermsofelectric
powerlevelspercomputenode.Thisstudyispartofeffortstofacilitate
power at the given threshold level using collected log data prevents
future advanced power-aware compute node allocation in accordance
hot-spots in electric power in system racks containing a large num-
witheffectivejobschedulinginFugaku,whichisthesuccessoroftheK
computer.Ourresultsshowedthatweneedtheabilitytoperformmore ber of compute nodes if such classification is introduced in compute
suitablecomputenodeallocationsinordertomanagepowerconsump- nodeallocationduringjobschedulingwiththejobscriptclassification
tion within controllable conditions and to ensure stable operations in reported in [11]. Within this context, another future work will be
suchsituations. proposingtolerantscoringincomparisonamongvariousclassification
Basedontheabove,westudiedclassificationmethodologyinterms modelsusingimbalanceddatasets.However,toaccomplishthis,itwill
of electric power consumed by compute nodes through correlation benecessarytostudyotherresearchesinleadingHPCsystemsinorder
coefficientanalysisandML-basedclassificationusingassociatedmetrics todetermineoptimalscoringmethods.
in job stat log data and determined that there were relatively strong
correlationsbetweenelectricpowerandCPUandmemorybandwidth
utilization ratios. Additionally, there were relatively strong negative Declarationofcompetinginterest
correlations between metrics related to file I/O and electric power
in the node-layout in which I/O-intensive jobs were most frequently
The authors declare that they have no known competing finan-
executed. Based on this correlation study, we examined four classifi-
cial interests or personal relationships that could have appeared to
cation models provided from scikit-learn and discovered some specific
influencetheworkreportedinthispaper.
results related to allocated compute node-layouts. For example, we
establishedtheoverallscorerangingfrom0to1toevaluatedpredicted
classification models using F1-score, PR-AUC, and MCC, which are
Acknowledgment
tolerant measures even in imbalanced datasets. Through that exam-
ination, we found that the RFC model achieved the highest overall
score(0.98)usingonlyCPUandmemorybandwidthutilizationratios Thisresearchusedsystemlogsandjobstatsdatacollectedfromthe
when classifying at 60W in the maximum electric power per node. KcomputeroperatedbytheRIKENCenterforComputationalScience.
15Y.Tsujitaetal. Array15(2022)100179
References [21] Salfner F, Lenk M, Malek M. A survey of online failure prediction methods.
ACMComputSurv2010;42(3).10:1â€“10:42.http://dx.doi.org/10.1145/1670679.
[1] ThesupercomputerFugaku[cited2022-04-26].[link].URLhttps://www.r-ccs. 1670680.
riken.jp/en/fugaku/. [22] DavisJ,GoadrichM.Therelationshipbetweenprecision-recallandROCcurves.
[2] AkimotoH,OkamotoT,KagamiT,SekiK,SakaiK,ImadeH,ShinoharaM,Sumi- In:Proceedingsofthe23rdInternationalConferenceonMachineLearning.2006,
motoS.FilesystemandpowermanagementenhancedforsupercomputerFugaku. p.233â€“240.http://dx.doi.org/10.1145/1143844.1143874.
Fujitsu Tech Rev 2020;(3). [cited 2022-04-26]. URL https://www.fujitsu.com/ [23] Boughorbel S, Jarray F, El-Anbari M. Optimal classifier for imbalanced data
global/about/resources/publications/technicalreview/2020-03/article05.html. using Matthews Correlation Coefficient metric. PLoS ONE 2017;12(6). 1â€“17.
[3] Uno A, Sueyasu F, Sekizawa R. Operations management software of http://dx.doi.org/10.1371/journal.pone.0177678.
supercomputer Fugaku. Fujitsu Tech Rev 2020;(3). [cited 2022-04-26]. URL [24] SÃ®rbu A, Babaoglu O. Towards operator-less data centers through data-driven,
https://www.fujitsu.com/global/about/resources/publications/technicalreview/ predictive,proactiveautonomics.ClusterComput2016;19.865â€“878.http://dx.
2020-03/article10.html. doi.org/10.1007/s10586-016-0564-y.
[4] UnoA,HidaH,InoueF,IkedaN,TsukamotoT,SueyasuF,MatsushitaS,ShojiF. [25] EllsworthD,PatkiT,SchulzM,RountreeB,MalonyA.Aunifiedplatformfor
Operationofthekcomputerfocusingonsystempowerconsumption.IPSJTrans exploringpowermanagementstrategies.In:Proceedingsofthe4thInternational
AdvComputSyst2015;8(4).13â€“25.(inJapanese). WorkshoponEnergyEfficientSupercomputing.E2SCâ€™16,IEEEPress;2016,p.
[5] TsujitaY,UnoA,SekizawaR,YamamotoK,SueyasuF.Jobclassificationthrough 24â€“30.http://dx.doi.org/10.5555/3018076.3018080.
long-termloganalysistowardspower-awareHPCsystemoperation.In:202129th [26] Liu Y, Gunasekaran R, Ma X, Vazhkudai SS. Server-side log data analytics
EuromicroInternationalConferenceonParallel,DistributedandNetwork-Based for I/O workload characterization and coordination on large shared storage
Processing (PDP). IEEE; 2021, p. 26â€“34. http://dx.doi.org/10.1109/PDP52278. systems.In: ProceedingsoftheInternationalConference forHighPerformance
2021.00014. Computing,Networking,StorageandAnalysis.SCâ€™16,IEEE;2016,p.819â€“829.
[6] MatthewsBW.Comparisonofthepredictedandobservedsecondarystructureof http://dx.doi.org/10.1109/SC.2016.69.
T4phagelysozyme.BiochimBiophysActa(BBA)-ProteinStruct1975;405(2). [27] Wang T, Snydery S, Lockwood GK, Carns P, Wright NJ, Byna S. IOMiner:
442â€“451.http://dx.doi.org/10.1016/0005-2795(75)90109-9. Large-scaleanalyticsframeworkforgainingknowledgefromI/Ologs.In:2018
[7] AjimaY,InoueT,HiramotoS,TakagiY,ShimizuT.TheTofuinterconnect.IEEE IEEEInternationalConferenceonClusterComputing(CLUSTER).IEEE;2018,p.
Micro2012;32(1).21â€“31.http://dx.doi.org/10.1109/MM.2011.98. 466â€“476.http://dx.doi.org/10.1109/CLUSTER.2018.00062.
[8] Sakai K, Sumimoto S, Kurokawa M. High-performance and highly reliable file [28] Lockwood GK, Wright NJ, Snyder S, Carns P, Brown G, Harms K. TOKIO
systemfortheKcomputer.FujitsuSciTechJ2012;48(3).302â€“309. on ClusterStor: Connecting standard tools to enable holistic I/O performance
[9] HiraiK,IguchiY,UnoA,KurokawaM.Operationsmanagementsoftwareforthe analysis.In:2018CrayUserGroupMeeting(CUG).2018.
Kcomputer.FujitsuSciTechJ2012;48(3).310â€“316. [29] DARSHAN [cited 2022-04-26]. [link]. URL https://www.mcs.anl.gov/research/
[10] SumimotoS.AnoverviewofFujitsuâ€™sLustrebasedfilesystem.In:LustreUser projects/darshan/.
Group2011.2011. [30] CarnsP,HarmsK,AllcockW,BaconC,LangS,LathamR,RossR.Understanding
[11] YamamotoK,TsujitaY,UnoA.Classifyingjobsandpredictingapplicationsin andimprovingcomputationalsciencestorageaccessthroughcontinuouscharac-
HPCsystems.In:HighPerformanceComputing-33rdInternationalConference, terization. ACM Trans Storage 2011;7(3). http://dx.doi.org/10.1145/2027066.
ISCHighPerformance2018,Frankfurt,Germany,June24-28,2018,Proceedings. 2027068.
LectureNotesinComputerScience,vol.10876,Springer;2018,p.81â€“99. [31] Manousakis I, Marazakis M, Bilas A. FDIO: A feedback driven controller for
[12] Redash[cited2022-04-26].[link].URLhttps://redash.io/. minimizing energy in I/O-intensive applications. In: Proceedings of the 5th
[13] SciPy[cited2022-04-26].[link].URLhttps://scipy.org/. USENIX Workshop on Hot Topics in Storage and File Systems. HotStorageâ€™13,
[14] You H, Zhang H. Comprehensive workload analysis and modeling of a petas- USENIX Association; 2013, [cited 2022-04-26]. URL https://www.usenix.org/
calesupercomputer.In:JobSchedulingStrategiesforParallelProcessing,16th conference/hotstorage13/workshop-program/presentation/manousakis.
InternationalWorkshop,JSSPP2012,Shanghai,China,May25,2012.Revised [32] LeeS,LowenthalDK,DeSupinskiBR,IslamT,MohrorK,RountreeB,SchulzM.
SelectedPapers.LectureNotesinComputerScience,vol.7698,Springer;2012, I/Oawarepowershifting.In:2016IEEEInternationalParallelandDistributed
p.253â€“271.http://dx.doi.org/10.1007/978-3-642-35867-8_14. Processing Symposium (IPDPS). 2016, p. 740â€“749. http://dx.doi.org/10.1109/
[15] Dutot P, Georgiou Y, Glesser D, Lefevre L, Poquet M, Rais I. Towards energy IPDPS.2016.15.
budgetcontrolinHPC.In:17thIEEE/ACMInternationalSymposiumonCluster, [33] HeS,ZhuJ,HeP,LyuMR.Experiencereport:Systemloganalysisforanomaly
Cloud and Grid Computing (CCGRID). IEEE Press; 2017, p. 381â€“390. http: detection.In:2016IEEE27thInternationalSymposiumonSoftwareReliability
//dx.doi.org/10.1109/CCGRID.2017.16. Engineering(ISSRE).2016,p.207â€“218.http://dx.doi.org/10.1109/ISSRE.2016.
[16] RajagopalD,TafaniD,GeorgiouY,GlesserD,OttM.Anovelapproachforjob 21.
schedulingoptimizationsunderpowercapforARMandIntelHPCsystems.In: [34] DasA,MuellerF,HargroveP,RomanE,BadenS.Doomsday:Predictingwhich
24th IEEE International Conference on High Performance Computing (HiPC). node will fail when on supercomputers. In: Proceedings of the International
IEEE Computer Society; 2017, p. 142â€“151. http://dx.doi.org/10.1109/HiPC. ConferenceonHighPerformanceComputing,Networking,StorageandAnalysis.
2017.00025. SCâ€™18,IEEEPress;2018,p.9:1â€“9:14.http://dx.doi.org/10.1109/SC.2018.00012.
[17] SaillantT,WeillJ-C,MougeotM.Predictingjobpowerconsumptionbasedon [35] Kim S, Sim A, Wu K, Byna S, Son Y, Eom H. Towards HPC I/O performance
RJMSsubmissiondatainHPCsystems.In:HighPerformanceComputing-35th prediction through large-scale log analysis. In: Proceedings of the 29th Inter-
IternationalConference,ISCHighPerformance2020,Frankfurt/Main,Germany, national Symposium on High-Performance Parallel and Distributed Computing.
June22â€“25,2020,proceedings.LectureNotesinComputerScience,vol.12151, HPDCâ€™20,ACM;2020,p.77â€“88.http://dx.doi.org/10.1145/3369583.3392678.
Springer;2020,p.63â€“82.http://dx.doi.org/10.1007/978-3-030-50743-5_4. [36] BleiDM,NgAY,JordanMI.LatentDirichletallocation.JMachLearnRes2003;3.
[18] PedregosaF,VaroquauxG,GramfortA,MichelV,ThirionB,GriselO,BlondelM, 993â€“1022.
Prettenhofer P, Weiss R, Dubourg V, Vanderplas J, Passos A, Cournapeau D, [37] WangX,McCallumA.Topicsovertime:Anon-Markovcontinuous-timemodelof
Brucher M, Perrot M, Duchesnay Ã‰. Scikit-learn: Machine learning in Python. topicaltrends.In:Proceedingsofthe12thACMSIGKDDInternationalConference
J Mach Learn Res 2011;12(85). 2825â€“2830. [cited 2022-04-26]. URL https: on Knowledge Discovery and Data Mining. KDD â€™06, ACM; 2006, p. 424â€“433.
//jmlr.org/papers/v12/pedregosa11a.html. http://dx.doi.org/10.1145/1150402.1150450.
[19] Scikit-learn [cited 2022-04-26]. [link]. URL https://scikit-learn.org/stable/ [38] HeH,GarciaEA.Learningfromimbalanceddata.IEEETransKnowlDataEng
modules/grid_search.html. 2009;21(9).1263â€“1284.http://dx.doi.org/10.1109/TKDE.2008.239.
[20] SaitoT,RehmsmeierM.Theprecision-recallplotismoreinformativethanthe [39] Jauk D, Yang D, Schulz M. Predicting faults in high performance computing
ROCplotwhenevaluatingbinaryclassifiersonimbalanceddatasets.PLoSONE systems:Anin-depthsurveyofthestate-of-the-practice.In:Proceedingsofthe
2015;10(3).1â€“21.http://dx.doi.org/10.1371/journal.pone.0118432. InternationalConferenceforHighPerformanceComputing,Networking,Storage
andAnalysis.SCâ€™19,ACM;2019,http://dx.doi.org/10.1145/3295500.3356185.
16