The primary focus of the network is anonymous communication, which has become increasingly important for both commercial and individual use. The Tor network, which has been operational for many years and consists of thousands of nodes and users, is a widely used open software solution for achieving online anonymity. It employs onion routing, a method of encrypting data at multiple levels, and transmits the data through virtual circuits made up of several Tor relays. Despite its widespread use, the Tor network has been susceptible to various attacks, particularly as its deployment has increased. One such attack, known as a protocol-level attack, exploits specific features or implementation bugs in communication protocols to consume a significant amount of resources from the victim. Such attacks can compromise the anonymity of users within the Tor network.

To address these vulnerabilities, a novel defense mechanism called MIDDRQ is presented in this study. MIDDRQ aims to mitigate protocol-level attacks by introducing measures to verify the integrity of data cells and generate fake traffic within the middle relays. This fake traffic is distributed using a stochastic fair queuing process, which is then controlled by a deficit round-robin (DRR) queuing algorithm to reduce complexity and delay. Experimental results demonstrate that MIDDRQ outperforms existing defense mechanisms against protocol-level attacks in the Tor network.

The proposed defense mechanism leverages indistinguishability obfuscation to ensure the integrity of data cells and generate fake traffic within the middle relays, ultimately preventing protocol-level attacks. The implementation of the stochastic fair queuing model allows for the distribution of fake traffic, while the DRR queuing algorithm effectively controls outgoing connections from the middle relays. Experimental evaluations confirm the superior performance of this defense mechanism compared to existing methods in mitigating protocol-level attacks within the Tor network.