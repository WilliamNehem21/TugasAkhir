The fact that the order of encryption does not affect the result, i.e., encryption is commutative, is a common property exploited in cryptographic protocols and attacks. However, most automatic analysis models for cryptographic protocols cannot handle such encryption functions, as they consider the message space as a free term algebra. In this paper, we introduce an NP decision procedure for assessing the insecurity of protocols employing RSA encryption, a key instance of commutative public key encryption.

While recent work has relaxed the perfect encryption assumption for protocol analysis and developed unification algorithms for handling properties of Diffie-Hellman cryptographic systems, these results do not address the broader insecurity problem. Prior work has shown the decidability of security for protocols using exclusive OR, and we extend this result to protocols based on Diffie-Hellman exponentiation. However, existing approaches either lack a decision procedure or impose significant restrictions on the protocol and intruder model.

We illustrate the application of the commutative properties of public key encryption schemes in cryptographic protocols with examples. For instance, in a protocol developed by Shamir, agents can securely communicate without sharing a symmetric key or knowing each other's public key, due to the commutative nature of encryption.

In our model, a protocol corresponds to a specification in the Alice&Bob notation along with an instantiation, and several sessions are modeled as a single protocol. The extended intruder, referred to as the RSA intruder, is introduced to capture the ability to perform commuting public key encryption. This intruder can both encrypt and decrypt messages, and if e is a set of normalized messages, forge(e) is also a normalized set of messages.

We further define a parameter k in our analysis for simplifying notations, taking into account both complete and partial sessions. This enables us to detect attacks, even with unfinished sessions, by analyzing protocols with some final steps removed.