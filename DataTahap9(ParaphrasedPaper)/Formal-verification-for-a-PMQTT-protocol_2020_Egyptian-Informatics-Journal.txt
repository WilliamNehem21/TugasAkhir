The tool ProVerif, which is based on pi calculus, is used for verifying the authenticity and secrecy properties of cryptographic security protocols, and it can handle an unbounded number of protocol sessions. Additionally, it allows the intruder to monitor and manipulate communication channels between parties, and provides tracing for adversary attacks to identify potential security problems.

The rest of the paper is structured as follows: Section 2 summarizes previous work on enhancing security aspects of the MQTT protocol, while Section 3 introduces the proposed PMQTT protocol and its cryptographic primitives for IoT platforms. Section 4 then discusses the formal verification of PMQTT, demonstrating its secure provision of intended security services. Finally, Section 5 presents conclusions and future research directions regarding the utilization of PMQTT in real MQTT-based IoT platforms.

Regarding the proposed authentication protocol, the modified MQTT connect packet only includes the username without a password field. However, the password is utilized at the client side for generating a digital signature by hashing the MQTT connect packet using SHA-1. The client password is also used at the broker side for hashing the MQTT connect packet, enabling the transfer of the username from the client to the broker in plain text without the need for SSL in the transport layer.

The second stage of the proposed secure protocol involves key establishment and distribution, with the PC and DR collaboratively establishing a symmetric secret session key based on the elliptic curve Diffie Hellman (ECDH) key agreement protocol. This secret key is then used for encrypting and decrypting patient-related data.

The third stage of the proposed protocol comprises end-to-end encrypted data exchange, where the DR and PC exchange ciphered patient status details through the broker, utilizing the established session key from the key establishment and distribution stage for AES encryption.

The proposed authentication approach does not require an additional server for MQTT-based IoT networks, as the existing MQTT broker is responsible for managing the authentication process. Furthermore, the authentication scheme introduces a signature attached to the username in a modified MQTT connect packet, allowing for secure transmission of the username from the client to the broker in plain text without relying on SSL in the transport layer.