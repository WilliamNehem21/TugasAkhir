As a special class of fair exchange protocols [20], a CEM protocol is supposed to guarantee fairness with respect to non-repudiable evidences. Informally, at the end of a fair protocol run, either both parties acquire all the evidences, or no party gets an evidence. A trusted third party (TTP) can be introduced to take charge of the whole procedure and to provide undeniable records of submission (of the sender) and delivery (of the receiver). However in this way, a TTP may easily become a bottleneck, if she has to be involved in a large number of CEM services.

The structure of our protocol consists of an exchange sub-protocol, an abort sub- protocol and a recover sub-protocol. The exchange sub-protocol is executed by the communicating parties to deliver an email as well as exchanging undeniable evidences. The other sub-protocols are launched by a party to contact a TTP to deal with awry situations. Each exchange that uses the protocol is called a protocol round, and one initialisation phase followed by a number of protocol rounds is called a protocol session. Each protocol session belongs to a unique pair of communication parties.

List. 3 models the corresponding behaviours of TTP. TTP is a special player that has to be modelled in a particular way. It must be objective, and cannot act in collusion with protocol participants. We build the model for TTP that strictly

It has been acknowledged that formal verification is important for security protocols, because of the seriousness of security flaws. In this paper, we use the technology of model checking to check automatically whether a given model of CEM protocols satisfy some given specifications. To our knowledge, the literature of formal veri- fications of CEM protocols includes the works of Kremer et al. [13], Cederquist et al. [8] and Abadi and Blanchet [1].

