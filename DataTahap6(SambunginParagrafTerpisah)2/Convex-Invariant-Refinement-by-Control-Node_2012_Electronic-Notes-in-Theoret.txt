We have carried out experiments with PIPS, a source-to-source compiler, and Aspic, an abstract interpre- tation tool, using 71 test cases published by Gonnord, Gulwani, Halbwachs, Jeannet & al. The number of invariants found by these tools goes up from 28 to 69 for PIPS and from 44 to 62 for Aspic when our heuristics is used as a preprocessing step. The total execution time of PIPS is only marginally increased, going up from 76 to 103 s, thus showing the practical interest of our optimization technique.

An alternative approach consists in computing state transformers [20], i.e., trans- fer functions, instead of state predicates. Each program command, elementary or compound statement or procedure call, is approximated by an affine transformer. Each function is analyzed once and its transformer is reused at each call site. Pre- conditions are then propagated using the transformers. Such an approach is useful in order to obtain a modular analyzer and to limit analysis times. Affine trans- formers are commonly used, as they offer good compromise between accuracy and

We propose to address this issue with control graph restructuration. In Section 4, a general control node splitting algorithm is introduced and we discuss how to use it to refine invariants found by convex analysis. The results of our experiments are shown in Section 5, while related work is discussed in Section 6.

Let Gi = Val z Gi. As Gi is the complementary of a convex polyhedron, it is a polyhedron itself so it can be partitioned into a finite set of convex polyhedrons Gi,1,..., Gi,ji [7]. So Pi = {Gi, Gi,1,..., Gi,ji } is a partition of Val. The partition taken on control point k is: if at all, and the memory state on these controls is well known (Theorem 4.1). This assumption proved reasonable in most of our test cases. Despite this, the main drawback of this technique is the important number of created controls and transitions, which limits its application field to transition systems whose average number of transitions per control node is limited.

The algorithms described in this paper have been tested with the program analyzers PIPS 2 [20,26] and Aspic 3 [9], on a set of 71 previously published test cases 4 , most of them taken from references given below in Section 6, a few other from Henzinger & al. [19,4], N. Halbwachs [16,18,17], and some protocol descriptions [25,23,6]. As

Among these 71 cases, PIPS was able to provide the expected cycle invariants directly for 28. Using our restructuration techniques, we were able to run 41 addi- tional cases without suffering accuracy loss on the first group of cases. Finally, it failed on two cases, both with and without restructuration.

Aspic was able to compute the expected cycle invariants for 44 out of our 71 test cases using direct encoding. Unsurprisingly, these results are better than those obtained with PIPS since Aspic is a program devoted to polyhedral invariant com- putation. 21 more test cases are properly analyzed using partitioning techniques, while Aspic still failed on 6 cases.

After restructuration, the resulting systems have typically between 2 and 10 control states, which is in the scope of our analyzers. The subway example [18], more complex, grew much bigger (up to 23 controls) and its analysis, while correct, is very slow compared to what could be achieved with manual control restructuration (10 seconds vs. 0.5 seconds using 5 control states).

102.77 seconds with restructuration (34 % slower). Thus, it appears that the in- crease in time due to restructurations does not necessarily lead to an exponential blowup as feared by Laure Gonnord [10], at least for loops with no more than five cycles.

On the other hand, several techniques improve the computation of loop in- variants without any control flow restructuration. The work of Kelly & al. [24] introduced many concepts and algorithms in the computation of transitive closures. However, they consider a different set of applications and focus mostly on the under- approximation of transitive closures instead of overappromations. Laure Gonnord improves results given by Linear Relation Analysis [8] [16] by identifying categories of loops whose effects can be computed exactly, via abstract accelerations [11,10]. Also, Sven Verdoolaege & al. [29] have developed techniques to compute more ac- curately the transitive closures of a class of parametrized relations that captures Presburger arithmetic and affine transformers on integer variables, with a special focus on the case of parallel paths.

We present a simple algorithm to split control nodes to refine a program control flow graph, over a partition of the set of variable valuations (Section 4.1). Theorems are given about the invariants of created control nodes, and to ensure the restructuration does not change the behavior of the program (Section 4.2).

We also give heuristics concerning the choice of partitions in the case of convex transition systems, based on the transition guards (Section 4.3). This approach is tested on a set of previously published examples, yielding encouraging results (69 examples worked out of 71, Section 5).

Future work will address performance issues. The restructuration given by our heuristics tends to create a large number of controls and transitions, which limits its scope to systems whose number of parallel loops is limited. This complexity is useless in several cases because the same invariant accuracy is obtained with much simpler, manually restructured systems. We were also able to design transition systems on which the proposed partition is not suited, leading to the analyzer failure, while a better, simpler partition choice would have worked. As part of future work, we therefore want to design better partition strategies to handle a wider range of transition systems.

