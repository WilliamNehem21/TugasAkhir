Anonymity means that the identity of the user performing a certain action is maintained secret. The protocols for ensuring anonymity often use random mechanisms which can be described probabilistically. In this paper we propose a notion of weak probabilistic anonymity, where weak refers to the fact that some amount of probabilistic information may be revealed by the protocol. This information can be used by an observer to infer the likeliness that the action has been performed by a certain user. The aim of this work is to study the degree of anonymity that the protocol can still ensure, despite the leakage of information. We illustrate our ideas by using the example of the dining cryptographers with biased coins. We consider both the cases of nondeterministic and probabilistic users. Correspondingly, we propose two notions of weak anonymity and we investigate their respective dependencies on the biased factor of the coins.

be revealed by the protocol. Typical causes may be either the presence of attackers which interfere with the normal execution the protocol, or some unavoidable imper- fection of the internal mechanisms, or may even be inherent to the way the protocol is designed. In any case, the information leaked by the system can be used by an observer to infer the likeliness that the action has been performed by a certain user. The aim of this work is to study the degree of anonymity that the protocol can still ensure, despite the leakage of information.

We consider a more realistic scenario in which some probabilistic information may be leaked by the system. In particular, we consider the case in which this happens due to imperfections in its internal mechanisms. In the case of the DCP, this means to relax the hypothesis of perfect fairness of the coins. It is worth noting that even if an observer does not know a priori whether and how much the coins in the DCP are biased, he may be able to infer it statistically by running the protocol several times [4]. One of the main purposes of this work is to investigate how the biased factor of the coins influences the level of anonymity that the system can still achieve.

In anonymity protocols, depending on the circumstances, the users may be either probabilistic or nondeterministic. Typically the latter applies in dynamic scenarios, when the users change all the time. In the nondeterministic case, the probabilistic aspect of anonymity can only be relative to the probability of the observables, which derives solely from the randomness of the internal mechanisms of the protocol. The natural notion of anonymity is then that the probability of the observables does not give information about the user.

In next section we recall some notions which are used in the rest of the paper: the Probabilistic Automata, the Dining Cryptographers Problem, and the framework for anonymity developed in [4]. In Section 3 we propose a notion of weak anonymity for nondeterministic users, and we study the dependency on the biased factor of the coins for the DCP. In Section 4 we do the same for the case of probabilistic users. In Section 5 we code in PRISM the DCP and the notions of anonymity. Finally, in Section 6 we conclude and discuss some related work.

In this paper we consider systems that can perform both probabilistic and nonde- terministic choices. Intuitively, a probabilistic choice represents a set of alternative transitions, each of them associated to a certain probability of being selected. The sum of all probabilities on the alternatives of the choice must be 1, i.e. they form a probability distribution. Nondeterministic choice is also a set of alternatives, but we have no information on how likely one alternative is selected.

There have been many models proposed in literature that combine both non- deterministic and probabilistic choice. One of the most general is the formalism of probabilistic automata proposed in [14]. We give here a brief and informal descrip- tion of it.

In this paper, we use only a simplified kind of automaton, in which from each node we have either a probabilistic choice or a nondeterministic choice (more pre- cisely, either one step or a set of singleton steps), like in (b). This is not a real restriction since it subsumes the so-called alternated model, in which probabilistic and nondeterministic choices alternate, and which is known to have the same ex- pressive power as the full probabilistic automata. In the particular case that the choices are all probabilistic, like in (c), the automaton is called fully probabilistic.

The general Dining Cryptographers Problem [6] is described as follows: A number of cryptographers, situated in the nodes of a given connected graph, are having a dinner. The representative of their organization (master) may or may not pay the bill of the dinner. If he does not, then he will select exactly one cryptographer and order him to pay the bill. The master will tell secretly each cryptographer whether he has to pay or not. The cryptographers would like to reveal whether the bill is paid by the master or by one of them, but, in the latter case, they wish to keep anonymous the identity of the payer.

Let us consider the DCP on a linear graph consisting of three nodes, i.e. three cryptographers Crypt 0, Crypt 1, and Crypt 2, and two edges, Coin 0 between Crypt 0 and Crypt 1, and Coin1, between Crypt 1 and Crypt 2.

where b0b1b2 refers to the outputs of Crypt 0, Crypt 1 and Crypt 2, respectively. For instance, if Crypt 1 is the payer, then o1 is obtained when both the two coins give 1, o2 is obtained when Coin0 gives 1 and Coin 1 gives 0, etc. In case the master pays, then the possible observables are o5 = 110, o6 = 101, o7 = 011, o8 = 000. For instance, o5 = 110 is obtained when Coin 0 gives 1 and Coin1 gives 0.

DCP is synonymous of nondeterministic users). In general in a system there is also the nondeterminism caused by the different possible interleaving of the various components of the system, but here, for simplicity, we will assume that the order in which the various components of the system (master, cryptographers, coins) execute their operations is fixed. In any case, it can be shown that this latter form of nondeterminism would not affect the properties of the DCP with respect to anonymity.

In the following, we consider the case N = 3. We use the variables crypt0, crypt1, crypt2 to record the values computed by each cryptographer, that are either 0 or 1 and depend on whether the cryptographer is paying and on the sides of the coins the cryptographer can see. Initially, their values are 0. In the model, there are two coins coin0 and coin1. The first is shared shared by Cryptographers 0 and 1, the second is shared by Cryptographers 1 and 2. We use 0 for head, and 1 for tail.

Once toss becomes true, the coins start to flip. With probabilities beta0 and beta1, the side of the coins will be head. With probabilities 1-beta0 and 1-beta1, the side of the coins will be tail. Each time when a coin is flipped, the value of s coin is increased by one.

After all the coins have been flipped (s coin=N-1), the cryptographers calculate the value of their variable crypt0, crypt1 and crypt2. Once a cryptographer has terminated this calculation, the value of s crypt is increased by 1. Since the Cryp- tographers 0 and 2 sit at the two ends of the line, they can only observe one coin: Cryptographer 0 sees Coin 0, and Cryptographer 2 sees Coin 1. If Cryptographer 0 is the payer, he will set the variable crypt0 to 1 if he sees the head of Coin 0, and to 0 otherwise. If Cryptographer 0 is not the payer, he will set crypt0 to 0 if he sees the head of Coin 0, and to 1 otherwise. The code for Cryptographer 2 is similar: just rename crypt0 into crypt2, coin0 into coin1, and s crypt=0 into s crypt=2.

The behavior of Cryptographer 1 is slightly different, since he can observe two coins. If he is the payer, he will set the variable crypt1 to 1 if the two coins have the same side, and to 0 otherwise. If he is not the payer, he will set crypt1 to 0 if the two coins have the same side, and to 1 otherwise.

In the DCP, an external observer can see the values of the variables crypt0, crypt2 and crypt2. Furthermore, the values of the variables in the PRISM model define the states of the system. For example, the following predicate represents the final states in which all cryptographers output 1. We denote it by o1.

We propose two notions of weak probabilistic anonymity, for the cases of nonde- terministic and probabilistic users, respectively. We have applied these two notions to the DCP with biased coins, and we have described the functional dependency of the weakness level on the biased factor of the coins. Furthermore we have coded in PRISM the DCP and the formulas that express weak anonymity.

To our knowledge, the first notion of probabilistic anonymity was proposed (al- though not with an explicit definition) in [6]. That notion corresponds to one of the notions of strong anonymity for probabilistic users investigated in [4], and more precisely, to the one recalled in Definition 2.4. This is the notion for which we have given the weak version in Definition 4.2.

In [11] Reiter and Robin have proposed an hierarchy of notions of probabilistic anonymity in the context of Crowds. We recall that Crowds is a system aimed at protecting the identity of users when sending (originating) messages. This is achieved by forwarding the message to another user selected randomly, which in turn forward the message, and so on, until the message reaches its destination. Part of the users may be corrupted (attackers), and one of the main purposes of the protocol is to protect the identity of the originator of the message from those attackers.

