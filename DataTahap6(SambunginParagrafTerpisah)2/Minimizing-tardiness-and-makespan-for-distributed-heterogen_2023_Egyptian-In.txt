This work aims to deal with the distributed heterogeneous unrelated parallel machine scheduling prob- lem (DHUPMSP) with minimizing total tardiness (TDD) and makespan. To solve this complex combina- torial optimization problem, this work proposed a knowledge and Pareto-based memetic algorithm (KPMA) which contains the following features: 1) four heuristic rules are designed including the shortest processing time rule, the minimum factory workload rule, the minimum machine finish time rule, and the earliest due date rule. Meanwhile, a hybrid heuristic initialization is developed to construct a popu- lation with great convergence and diversity; 2) four problem feature-based heuristic neighborhood struc- tures are designed to increase the success rate of local search; and 3) a simple elite strategy is developed to enhance the usage of historical elite solutions. Finally, to evaluate the performance of KMPA, it is com- pared to five state-of-art and run on 20 instances with different scales. The results of numerical experi- ments show that the proposed hybrid heuristic initialization can efficiently save computation resources to improve the initialized convergence. In addition, the knowledge-based neighborhood structures can vastly accelerate exploration. Moreover, the elite strategy can efficiently improve the diversity of the final non-dominated solutions set. The proposed KPMA has better performance than the state-of-art and has a strong ability to solve DHUPMSP.

The rest parts of this study are organized as follows: The recent works are introduced in Section 2. The problem descrip- tion and MILP model of DHUPMSP are introduced in Section 3. Section 4 illustrates our approach KPMA. The results of detailed numerical experiments are demonstrated in Section 5. Finally, the conclusion of this study and some future directions are sta- ted in Section 6.

DUPMSP aims to parallelly produce all jobs in multiple dis- tributed factories which is harder to solve than UPMSP. Neverthe- less, there are few works for DUPMSP due to its complexity. Hatami proposed four fast and high-performing heuristics for DUPMSP [9]. In [37], a hybrid distribution estimation algorithm was designed to minimize the makespan of DHUPMSP. Zhou designed a VNS-based imperialist competitive memetic search for DHUPMSP and got the best results [38]. Lei developed a division strategy based artificial bee colony algorithm for DHUPMSP with preventive maintenance and the division strategy can efficiently accelerate convergence [15]. Mnch studied DHUPMSP with the total weighted delivery time [39]. Pan designed a two-population co-evolution based on knowledge and feedback for green DHUPMSP [16].

The memetic algorithms have been widely applied in many kinds of shop scheduling problems because MAs can rapidly get close to the real Pareto Front. The framework of MAs is shown in Algorithm 1. The MAs are divided into two steps global search and local search which are efficient to solve shop scheduling prob- lems. Zhang proposed a MA for scheduling hybrid differentiation flowshop to enhance the convergence of co-evolution [40]. Ding applied a hybrid MA for PMSP and got a 100% success rate to update neighborhood solutions [30]. Lei developed a MA for hybrid flow shop scheduling (HFS) which can obtain solutions with great objectives values in short time [41]. Abedi designed a multi- population MA for job-shop scheduling and outperformed other algorithms [42]. Kurdi proposed a semi-constructive crossover based MA with mutation operators for flowshop scheduling and improved the metrics by 37.92% [43]. Shao designed a MA for dis- tributed heterogeneous HFS and obtained the best results [44].

Thus, based on the discussion above, this work proposed a knowledge and Pareto-based MA for solving DHUPMSP. First, the problem features of DHUPMSP are analyzed. Second, based on problem knowledge, four heuristic initialization rules are designed. Next, four neighborhood structures based on problem features are designed to accelerate convergence. Finally, an elite strategy is developed to improve the usage rate of historical elite solutions to increase diversity.

there is no idle time on each machine. F2 = F1 + P2 and F1 = F0 + P1. Then, swap I1 and I2 to process I2 ahead. The new fin- ish time of I1 and I2 is F3 and F4. Meanwhile, F3 > F4; F4 = F0 + P2,

Conclusion2: This conclusion is based on feature 3. Find the job which is over due date and search the front job which has bigger due date on the same machine. Then, moving the over due date job to the searched place can reduce tardiness.

Based on the research gap mentioned in Section 2.4 and prob- lem features stated in Section 3.3, this work proposed a knowl- edge and Pareto-based MA for DHUPMSP. First, the previous works lack efficient initialization which results in a cold-start problem. Four heuristic initialization rules are proposed to con- struct high-quality solutions to enhance convergence. Second, the local search strategies of previous works are based on the random selection which is inefficient and wastes many computa- tion resources. Thus, four heuristic neighborhood structures are designed to increase the success rate of local search. Finally, an

Algorithm 2 states the framework of KPMA. First, KPMA also ini- tialized two swarms P and C. Meanwhile, P is initialized by a hybrid heuristic initialization to get great convergence and diver- sity simultaneously. Second, P will execute NSGA-II [25] for global search. Moreover, after the environmental selection, C obtains non-dominated solutions from P. Then, the variable neighborhood search (VNS) is adopted to rapidly get close to the real Pareto Front. Next, all non-dominated solutions are stored int the elite archive to increase diversity. Finally, the searched optimal Pareto solutions will be output from the elite archive C.

SPT rule: The SPT rule aims to select the shortest processing time machine. Due to problem feature 1 and feature 2, reducing machine processing time can lower the makespan. The SPT rule is stated in Algorithm 3. As for each job, greedily choose the parallel machine with the smallest processing time.

MFW rule is described in Algorithm 4. First, record the processing time of each job on the selected machine in all factories. Second, sort the record and count the job number in each factory. Finally, select the factory with the smallest job number for each job.

MFT rule: The MFT rule aims to balance the workload of each machine. Based on problem feature 1, feature 2 and conclusion 1, balancing the workload of all machines can efficiently reduce the makespan. The MFT rule is stated in Algorithm 6. First, divide all jobs into every heterogeneous factory according to the factory assignment vector. Then, in each factory, calculate the start and finish time of each job. Next, select the machine with the smallest finish time in the selected factory. Finally, update the start and fin- ish time of each job, and the finish time of the selected machine.

to the lower bound of the makespan. Next, the second sub- population adopts MFW to reduce makespan without large step converging. Then, the third sub-population applied the MFT rule to reduce the makespan. Moreover, the fourth sub-population used the EDD rule to get close to the objective space with low TDD. Finally, the rest of the population generated by random rule is evenly distributed in the target space to maintain diversity.

Based on the research gap in Section 2.4, this work proposed a simple elite strategy to increase the diversity. During the evolu- tionary stage and local search stage, store the non-dominated solu- tions to the elite archive. Then, the elite archive only keeps its non- dominated solutions at the end of every generation.

In Section 4, Our approach KPMA is illustrated detailedly. More- over, numerical experiments are executed to test the effectiveness of KPMA in this section. All variant and comparison algorithms are coded in python. The hardware environment is on a CPU of Intel(R) Xeon(R) Gold 6246R with 3.4 GHz and 384G RAM. Moreover, the running environment is Pycharm2021 with python3.8.

The success of KPMA relies on its design. First, the proposed hybrid heuristic initialization provides an initial population with great convergence and diversity which let KPMA be far ahead before starting evolution. Second, the problem features-based vari- able neighborhood makes KPMA efficiently converge and success- fully improves the efficiency of local search. Finally, the elite

This work put forward a knowledge and Pareto-based memetic algorithm for the bi-objective distributed heterogeneous unrelated machine scheduling problem. First, three problem features of DHUPMSP are analyzed and two key conclusions for optimizing DHUPMSP are obtained. Second, a hybrid heuristic initialization fixing four heuristic rules is designed to provide an initial popula- tion with great convergence and diversity simultaneously. Next, four problem feature-based neighborhood structures are proposed to efficiently improve the success rate of local searches to increase convergence. Then, an elite strategy is proposed to improve the usage of historical elite solutions to enhance diversity. Finally, the results of numerical experiments show that KPMA is signifi- cantly superior to the five comparison algorithms in terms of obtaining the Pareto solutions with better convergence and diversity.

Hua Wang: Resources, Project administration, Software, Dat- acuration, Writing - original draft, Writing - review & editing. Rui Li: Resources, Software, Data curation, Writing - original draft, Writing - review & editing. Wenyin Gong: Funding acquisition, Conceptualization, Methodology, Writing - review & editing.

