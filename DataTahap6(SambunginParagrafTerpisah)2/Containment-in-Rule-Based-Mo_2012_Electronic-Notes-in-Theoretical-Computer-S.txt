Recently, there has been substantial interest in using rule-based modelling approaches, such as the Kappa modelling language, to attack the combinatorial intractability of many biochemical systems. These ap- proaches have allowed several novel static analyses to be developed, which motivates broadening their expressivity. In this paper, we build upon prior work giving Kappa an SPO-rewriting semantics to add containment structure, to model the various ways in which biological mixtures are partitioned and enclosed by membranes.

Two examples of the rule-based approach are Kappa and the BNG modelling systems [11,2]. There has been substantial recent work done on applying techniques based on Kappa to managing the combinatorial complexity of biological systems [7,10]. This motivates expanding the expressivity and applicability of the rule-based approach, to bring it to more richly-structured systems.

This partition matters because different compartments can exhibit strongly di- vergent concentrations, and hence divergent chemical behaviours; and because fre- quently, the cell will exploit concentration gradients across membranes. Where a reaction happens turns out to matter to how the system evolves. Nor are the struc- tures static: new compartments can form, compartments can be destroyed, and compartments can merge or bud (hive off from existing compartments).

Any simple formalisation of the complexity of actual eukaryotic cells necessarily approximates; the existing approximation in Kappa modelling is to describe bio- chemical networks as operating in a single well-mixed solution (i.e. one in which there is no structure statistically significant to the probabilities of particular parti- cles interacting.) can be modelled. Finally, we describe how our containment structure dynamics can be dovetailed onto Kappa; the usual stochastics can then be applied to give a model with both stochastic chemical and structural expressiveness. We conclude by giving a brief sketch of present and future work based on this new model.

There are a variety of papers on Kappa; a good recent introduction can be found in [8]. The essential approach in Kappa is to model the state of a well-mixed solution in terms of complexes of agents. The intention is that agents model individual proteins or molecules; each agent has a collection of functional sites associated with it, which may enter into binary links with other sites. The dynamics are given in terms of rules, which may be thought of as locally describing how the solution is affected by describing its effect on any collection of agents matching a given test pattern.

The overall pattern of development for our semantics is first to establish a cat- egory of structures representing Kappa states and rule patterns, which has as mor- phisms structure-preserving maps. This is used to introduce a notion of partial map (using a standard span construction) and is followed by distinguising classes of matchings and action morphisms. We can then model rules using action morphisms, and rule applications as matchings from the left-hand side of the action morphism into an object representing the mixture. We define the result of applying a rule to be the pushout of the action morphism against this matching. Finally, we prove that this pushout always exists. (When we come to define our compartment-modelling structures, we will follow a similar pattern.)

Real biological systems exhibit remarkable complexity in structure and arrange- ment. A common, simplifying pattern is wanted to be the basis of our model. In the simplest, and most common case, one can think of a membrane that encloses a well-mixed region of space, and whose precise shape is unimportant.

We therefore adopt a perspective that views the cell (or subsystem of interest) as a set of regions, each of which may recursively contain other regions, and which assumes the contents of each region to be well-mixed, i.e. to obey standard mass- action dynamics. Each region models one compartment; we model one compartment held inside another through a notion of containment on regions.

We utilise a constrained form of partiality for our actions, where maps must be total on all regions. Maps need not, however, preserve the containments between regions. This choice of partiality, taken together with the rest of the defined dy- namics, ensures that the effect of a rule is confined to the region of the containment structure where it applies.

For example, suppose that we have membranes b and c inside a top-level mem- brane a. We wish to move the membrane c and its contents so that they are inside b. The immediate containment of c inside a will not be preserved, so it will not be present in the domain of definition. If X is the left-hand side of the rule and Y the right-hand side of the rule, we can model this example of motion as follows:

We have presented a natural, conservative extension to the semantics of Kappa to include a simple dynamics of regions. It is hoped that this begins the process of enriching Kappa as a biological modelling language to represent compartments. There are several possible avenues of future research.

