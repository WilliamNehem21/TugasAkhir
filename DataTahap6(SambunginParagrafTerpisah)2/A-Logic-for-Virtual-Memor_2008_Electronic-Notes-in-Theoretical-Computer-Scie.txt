write in this situation can result in the view of memory changing. Most of the time, it does not; in cases when it does, only part of the address space changes. Inferring separation of what may have changed from what has not allows effective reasoning about such memory updates.

As this is a work in progress, we are using a simplified model: we use a sim- ple machine abstraction and do not take into account memory permissions beyond whether a virtual address is mapped/unmapped. As such permissions are merely extra properties of virtual addresses, they can be easily integrated into our logic. Other work [18] has shown how to integrate actual machine encodings with separa- tion logic. We believe our logic can be likewise connected.

As mentioned in the introduction, virtual memory is a hardware-enforced ab- straction allowing each executing process its own view of memory, into which areas of physical memory can be dynamically inserted. It adds a further level of indi- rection: virtual addresses potentially map to physical addresses. Memory access is ordinarily done through virtual addresses only, although hardware devices may modify physical memory directly. Direct memory access can be approximated by using a one-to-one virtual-to-physical map.

The addition of virtual memory to separation logic raises the issue of what exactly it means for two predicates to be separate, as well as what kind of state space we are to divide into sub-states in order to be able to express their disjointness. We want the ability to make statements on three levels: virtual to physical, physical to values and virtual to values. We also wish to preserve the usefulness of separating assertions in this context, as well as staying close to traditional separation logic notation.

We begin with explaining basic notation in Sect. 3. In Sect. 4 we discuss the virtual memory abstraction and our specific instantiation of it. In Sect. 5 we intro- duce our logic, followed by examining its properties in Sect. 6. Finally, we discuss related work in Sect. 7 before concluding.

Using the above, we define an instantiation of a highly simplified machine: each 32-bit pointer points to a 32-bit word in memory for a total of 232 words in an address space. Note that traditional implementations use 8-bit values. Our three machine types are: vptr, pptr and val, representing virtual pointers, physical pointers and values respectively. On this machine, we define the types of the three memory views described in Sect. 2 to be:

The former states that a property not dependent on the area of the heap being modified holds after the update. The latter is a weakest-precondition rule useful for backwards reasoning. It states that if P holds for a heap with the entry p set to v, then P will hold after the update, as that is precisely what heap-update does. Henceforth, we will refer to these as the global and weakest-precondition rules respectively.

At the end of the operation, the address space is unchanged except for all the virtual pointers mapped to the physical address at which the heap was changed (via heap-update-v). As we described in Sect. 5 however, vp cannot alias with any other virtual pointer under separation conjunction, thus the modification of the heap will only be visible through one virtual address: vp.

Separation logic has been successfully applied to the verification of context switching code [10,12]. Tuch et al. demonstrated the extension of separation logic to reasoning about C programs involving pointer manipulation [18]. Presently, our work uses a simplified machine model with only one type and does not involve Hoare logic. We believe our framework supports addition of these extensions.

We have presented an extension of separation logic which allows reasoning about virtual memory and processes running within it. Our logic allows for a convenient representation of predicates on memory at three levels: the virtual map, the physical heap and the virtual address space. The notation abstracts away details to the point of appearing very similar to classical separation logic. Our logic preserves the pure and intuitionistic properties of separation logic, again without exposing the underlying abstraction. Our work has been formalised in the Isabelle/HOL theorem prover.

