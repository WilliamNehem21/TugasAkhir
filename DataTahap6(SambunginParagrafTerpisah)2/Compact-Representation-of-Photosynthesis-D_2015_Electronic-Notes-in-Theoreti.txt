Current coarse-grained mathematical models of photosynthesis [13] cover the known parts of the entire process. They build up the light reactions dynamics from simplified interactions on and inbetween complicated protein complexes involved in the transfer of the energy from light into the cell. Many different local modifications at these protein structures are traversed after reception of the photon. To capture

In [20] we have developed an online repository for mathematical models of pho- tosynthesis. That effort has opened many questions regarding the differing levels of available models and the problem of their formal representation in a single suitably expressive formalism. After several years of interactions with modellers targeting photosynthesis, we now attempt to move towards practical applications of state-of- the-art formal methods in that field.

On the practical side, we employ BioNetGen language (BNGL) and related tools [9,19] to implement the models. We contribute by automatising our reduction procedure in Python. By applying reductions to the considered models we show the power of process-algebraic framework to compactly represent combinatorially exploding systems of light reactions.

There are many applications of rule-based modelling available (see [4] for an overview). However, applications to photosynthesis are very rare. In [21], the authors provide a model of chlorophyll a fluorescence induction kinetics that is simulated in the rule-based framework by means of Monte Carlo simulation. The work is unique in the sense it pioneers rule-based approach for photosynthesis models. The contri- bution brings a stochastic simulation algorithm that reflects the differing context where the context-free rules appear. This is important, since the quantitative rates of electron transfers are modulated by aggregation of several modifications of the protein complex, i.e., the photosystem. The considered model is comparable to Lazar model [15] we use for our case study.

The left hand side El of the rule describes the solution taking part in the reaction and the right hand side Er describes the effects of the rule. The rule can be either a binding rule or a modification rule. A binding (unbinding) rule binds two free sites together (or unbinds two bound sites). A modification rule modifies some internal state [7].

In BNGL, agents are called molecules and they are specified in a similar manner as in the simplified Kappa. An example of a molecule is A(x~n!1) where the site x has an internal state n (separated from the site by a tilde) and a binding state is 1 (separated by the exclamation mark). The BNGL alternatives to agent signa- tures are called molecule types they are defined using the notation demonstrated in the following example: A(x~n~b, y~n~a). Here, the allowed internal states of the individual sites are separated by tildes (site x can have an internal state n or b). Rules are described by the lhs -> rhs notation (or lhs <-> rhs in the case of reversible rules). The individual model components (molecule types, reaction rules, seed species, observables) are in BNGL separated by the begin keyword and end keyword pairs.

Sometimes it may be useful to eliminate a rule from a model. Reasons for doing so can be different. For example, one might want to see how the behaviour of a model changes after the rule is removed. Or if the rule is not reachable in an initialised model then it can be removed to reduce the size of the model description.

We used the library PySB [16] for the specification of the photosynthetic models and to automatise their export to BNGL. The scripts that implement syntactic operations have been written in Python. We used BioNetGen for constructing and simulating the models. The scripts are available at https://github.com/jniznan/ rbm-photosynthesis.

We search the space of possible models that can be constructed by applying syntactic operations to the original model by depth-first search. We stop when we find a model that cannot be further reduced. There can be multiple models that cannot be further reduced. Our algorithm finds only one. We apply the syntactic operations in a given order: (i) context enumeration elimination, (ii) generic/specific context elimination, (iii) rule elimination. This approach is a heuristic that attempts to maximize the number of reductions.

Photosynthesis is well-adapted for spatially and temporally heterogeneous environ- ments [17]. The light conditions under which photosynthesis occurs are constantly changing for many reasons, including day-night cycle, moving clouds or changing seasons. Mechanisms lying behind the adaptability of photosynthesis are not yet fully understood [18]. Evidence confirms that photosynthesis in fluctuating light is more dynamic than simply adapting to the light extremes.

Rules are used to informally capture the model, but no existing formal rule-based language is employed. This fact makes the CMS a perfect candidate for rewriting it into an RBM format. Since the reaction rates are not available the model is worked out at a qualitative level of view.

We have also considered a reduced variant of the model that concentrates on light absorption by electron transfers inside PSII. That allowed the authors [10] to introduce a fully specified kinetic model. By employing the reductions we were able to compact the model rules but not to decrease their number. See [2] for details of the model and its reduction.

We managed to reduce the model significantly. The original ideas of the author are much more obvious in this reduced model. The reduced model is much easier to modify and extend than its original version. We have also elaborated on several variants of PSII part of the model and demonstrated the compositionality of rule- based approach. The details are presented in [2].

We have demonstrated the unsuitability of traditional reaction-based modelling approaches for modelling complex biochemical processes, such as photosynthesis. We explored existing models of photosynthesis and described the simplifications that were made in those models in order to battle the problem of combinatorial explosion. We showed how these simplifications are undesirable. Rule-based modelling allows us to compactly model the processes of photosynthesis in their full mechanistic complexity without the need for such simplifying assumptions.

We set on to naively reformulate selected representative models of photosynthesis as rule-based models. These reformulated models were unnecessarily large, not exploiting the advantages of the rule-based format. Therefore, we formally defined several intuitive syntactic operations that can be used to reduce the size of these models. We provided a case study where we implemented these operations so they can be performed automatically and we managed to achieve large reductions in the size of the models. The order in which we applied the reductions turned out to be satisfactory.

