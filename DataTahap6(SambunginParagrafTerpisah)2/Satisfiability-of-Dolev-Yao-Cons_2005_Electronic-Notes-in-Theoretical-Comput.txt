The remainder of this paper is organized as follows. In section 2, we will briefly recall the usual definitions leading to Dolev-Yao constraints and proper definitions for well-formed and quasi well-formed will be given. Then, in sec- tion 3, we will use a rewrite system to prove that satisfiability of well-formed constraints is decidable. Section 4 will extend this result to the case of quasi well-formed constraint. In section 5, we will quickly explain why satisfiability of our constraints is NP-complete. Section 6 will show how these results could be applied to check opacity with an active intruder. And eventually, section 7 will conclude this paper.

As we have now proper definitions for Dolev-Yao constraints, we will give a very classical example of constraint. To achieve this, it is practical to be able to formalize the classical Dolev-Yao constraint: message m is deducible from the set of message T written T H m. This constraint could be described using constraint with [] by quantifying on the order upon which keys are compromised. m will be deducible iff there exist k1,...,kn distinct keys in T or m such that k1 is deducible without any decoding, k2 deducible using k1 only and so on. At the end, m needs to be deducible from T using only keys k1 to kn.

In this section, we will provide an original decision procedure for satisfiability of well-formed constraints. For such constraints using only H, it is well known that the satisfiability problem is NP-complete: see for example [14], [12] or an extension to XOR in [7]. Our decision procedure will work using a rewriting system over constraints. We will have to prove that our system terminates, that satisfiability for our normal forms is decidable and eventually that our system is correct and complete, i.e. models of a constraint are exactly the models of this constraint once rewritten. Knowing that, we are able to provide a decision procedure for satisfiability which is to rewrite the constraint up to its normal form and then to check satisfiability on this normal form. Compared to other proofs of decidability of satisfiability for this kind of constraints (that are easy to find in the literature, see [12] as a starting point), our main objective is to provide a very simple, yet extensible, decision procedure.

This result is not really new, it could already be found in [1] for instance. However, the demonstration used here seems to be easier to adapt to other cases. In particular, having first order symbols like f , this theorem will apply quite directly to show decidability of opacity in a next section.

In this section, we will give a quick look at how the former method could be used to prove that opacity is decidable when considering Dolev-Yao model. In other papers, we only studied the case of a passive intruder. Here, we will start to extend decidability results to the case of active intruders.

Note that E and E' must have the same length (in fact, as these sets will be supposed similar, this will not be a problem). Moreover, as we want to perform the same operations on both environments, we need the environments to be ordered. They could be represented using lists.

