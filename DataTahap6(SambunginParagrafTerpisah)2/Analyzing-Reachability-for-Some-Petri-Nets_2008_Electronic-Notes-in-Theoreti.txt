Proof. Since by Lemma 3.9, there is a non-deterministic PSPACE algorithm for the problem being considered, we can apply the well known theorem of Savitch to con- clude that there is a deterministic algorithm that solves the problem in PSPACE.

Now, we will prove that the reachability problem in Petri nets with S-variants is PSPACE-hard. Cheng, Esparza and Palsberg [2] gave a reduction from the prob- lem of satisfiability of quantified boolean formulas (QBF-SAT) to the reachability problem in 1-Safe nets. We will use the same reduction and prove that the resulting net has S-variants. This will give us the necessary hardness proof.

Intuitively, NG starts with one token in G in, indicating that testing of G has started. A token in x is T (resp. x is F ) indicates that variable x is assigned to TRUE (resp. FALSE). When NG finishes testing G (using many other places and transitions not mentioned here), it puts a token in G T (resp. G F ) to indicate that G is TRUE (resp. FALSE). We refer the reader to the original paper [2] for further details. The following result shows that NG has S-variants.

Proof. We first check if each transition is progressive. This can be done by for- mulating a linear programming problem that checks whether a transition is part of some semi-positive T-invariant and then testing its feasibility with rational data. With n transitions, n such tests need to be done. Then, we check if removing pro- gressive transitions makes N structurally bounded. This can again be reduced to checking feasibility of a linear programming problem with rational data. Clearly, all the above operations can be done in polynomial time.

v0 fires once to get a token in q0. Transition t0 can now fire n times to put 2n tokens in p0. Transition w0 can now fire once to put a token in s0. Transition u0 can now fire 2n times to put 2n tokens in c0. Transition x0 can now fire once to put a token in e0. Thus, N0 began with one token in b0 and ended with one token in e0, and in the process, number of tokens in c0 was doubled.

To establish that Ni is partially bounded, we need to prove that number of firings of non-progressive transitions is bounded by a function of number of firings of pro- gressive transitions and input size. In what follows, the set of places {p0, c0,..., ci} plays an important role. For convenience of notation, let Ci = {p0, c0,..., ci} and

Every firing of v0, w0 or x0 needs one token to be added to b0. Only transitions that can add tokens to b0 are x1 and r1. Every firing of x1 or r1 needs one token to be added to d1. t1 is the only transition that can add tokens to d1 and t1 can fire at most (nl + k)i times by proposition B.5. Hence, v0, w0 and x0 can fire at most (nl + k)i times.

