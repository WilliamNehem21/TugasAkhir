Abstract Presence of shadow in an image often causes problems in computer vision applications such as object recognition and image segmentation. This paper proposes a method to detect the sha- dow from a single image using fuzzy split and merge approach. Split and merge is a classical algo- rithm used in image segmentation. Predicate function in the classical approach is replaced by a Fuzzy predicate in the proposed approach. The method follows a top down approach of recursively splitting an image into homogeneous quadtree blocks, followed by a bottom up approach by merg- ing adjacent unique regions. The method has been compared with previous approaches and found to be better in performance in terms of accuracy.

Shadows are formed when light from a source is partially or totally blocked. It is difficult to catch images and videos free from shadows. Hence, the only possibility is to remove once it is caught. If we ignore the existence of shadows in images it may introduce serious issues such as alternation of object shape, object merging and object lose in various visual process- additive change in intensities. Many works have been reported in the literature by trying to reduce the additive shadow com- ponent. However, finding the regions affected by shadow needs intelligent shadow segmentation methods, and hence, it is not an easy task. Self-shading, inter-reflection, non-uniform sha- dow, geometry of the object casting shadow, and the artifacts involved in image capturing make the process of shadow detec- tion more complicated.

The rest of the paper is organized as follows: A brief review of some of the important work in shadow detection and removal is carried out in Section 3. The proposed fuzzy split and merge approach and ANFIS architecture are presented in Sections 4 and 5 respectively. Implementation details and experimental results are given in Sections 6 and 7. Finally the paper is concluded in Section 7.

Zhu et al. [9] proposed a learning based method to detect the shadows in single monochromatic image using a shadow invariant, shadow variant and near-black features. This method is based on boosted decision tree classifier which is integrated into a Conditional Random Field (CRF). To make it possible to learn the CRF parameters, they use a Markov Random Field (MRF) model for labeling.

Ruiqi et al. [11] proposed a method for detecting shadows using a relational graph of paired regions. But, this method cannot differentiate between shading differences due to surface orientation changes and due to cast shadows. Also, shadow detection fails in case of multiple light sources.

In [13], trained decision tree classifier is used to detect ground shadow edges in outdoor images. The shadow edges are then grouped by a Conditional Random Field (CRF) based optimization. This method focuses on shadows cast by objects onto the ground plane.

Shadow detection method that works on the basis of the mean value of A and B planes of an LAB image is proposed by Murali and Govindan in [14]. Combining the values from L and B channels, the pixels with values less than a threshold are identified as shadow pixels, and others as non-shadow pix- els. The method works well only for images whose yellow to blue ratio is maintained within a range.

This paper proposes a split and merge approach that uses a fuzzy predicate for shadow detection from a single image. As a first step we perform a top down approach of splitting an image into four quadtree blocks and produce a sparse repre- sentation of the image in tree form. Then a Fuzzy predicate is used to check for any adjacent homogeneous region that can be merged among the quadtree blocks. Adjacent homoge- neous regions are merged and the splitting merging process is repeated recursively. Fuzzy predicate is trained using ANFIS.

Predicate function used in classical split and merge algorithm takes mean and standard deviation as input. Since our fuzzy predicate is tuned to detect shadow it should take other fea- tures as well. We are using local maximum, entropy and edge information of quadtree blocks to detect shadow. Fuzzy pred- icate is implemented using Adaptive Neuro Fuzzy Inference System (ANFIS).

For the training of the network, there is a forward pass and a backward pass. The forward pass propagates the input vec- tor through the network layer by layer. In the backward pass, the error is sent back through the network in a similar manner to back propagation.

