(Modelling phase) A MS model is not necessarily more expressive 3 than a single- scale one only because it is MS. It is well-known that a MS model can be more or less expressive according to what models are taken into account (for each scale) and how they are homogenized (e.g., coupled). Homogenization is in fact a very delicate and complex task - when single-scale models are heterogeneous, as well as when systems to model admit different homogenization techniques - which can lead to loss of information between scales.

schemes, in particular the micro-macro one applied to the bone remodelling [11,5], a biological process which can be considered multiscale, since macroscopic behaviour and microstructure strongly influence each other (see Subection 5.2). We explicitly take inspiration from the CxA paradigm (see Section 3), a similarity which has been already foreseen in [7] where bone remodelling has been modeled by a 2-scale CxA (see Subsection 5.1) and simulated running such a model in BioShape.

BioShape is a spatial 3D simulator which has been engineered in the perspective to be a uniform, particle-based, space- and geometry-oriented multiscale modelling and simulation environment. BioShape is scale-independent since it treats biological entities of any size simply as geometric 3D shapes. A shape can be either a basic one (a polyhedron, a sphere, a cone or a cylinder) or a correctly composed one (an aggregation of shapes glued on common surfaces of contact). Every element involved in the simulated process is a 3D process, i.e., an independent entity that owns a particular 3D shape and a particular behaviour.

Every entity has associated its physical motion law. The behaviour of every entity, i.e., the way it interacts with other entities and with the environment, is defined partially through a process algebra approach, namely, the Shape Calculus [3,2,1], and partially through Java programming. The Shape Calculus is a formal language defining the structure of 3D processes with channels through which they can bind with other compatible entities. The binding can happen only if the two involved processes collide on a certain common surface in which both have active compatible channels (this is called a collision-dependent behaviour). The result is the creation of a new 3D process whose shape is the composition of the shapes of the original processes and the behaviour is a combination of the original ones. A two- phase collision detection algorithm is defined in order to establish whether shapes collide and when the first of such events (called first time of contact) happens within a timestep duration.

communication services - within 3D processes or with system services -, information repositories - such as force fields in space, chemical gradients or perception services - or can represent diffused species, i.e. entities that the modeller chooses to represent not physically, with shapes, but simply as concentrations. This is because, for instance, they are well-diffused in the space or because their magnitude is too small

Inspired by the CxA approach, we enrich the meta-model of BioShape in order to capture within a general scheme a lot of coupling mechanisms. Firstly, we formally describe the components needed to run a model and the main loop of the simulation. Then, we show how two models, specified at different scales, can be connected and made run together implementing a given coupling scheme. Finally, we introduce a general graph of interconnected models running a MS simulation.

An instance W of a given world space template W is determined by fixing a global 3D coordinate system in which the shape is placed, giving the possibility of measuring distances with the given space scale, and making it possible to create 3D processes inside the shape in specified positions. Moreover, an instance P of a 3D process template in P is constructed by creating a copy of the shape and of the behaviour, by giving it a position in the fixed coordinate system of W and by specifying its initial instant velocity. A collection of instances N is a 3D network. A 3D network must always be well-formed, i.e. there not exist two processes whose shapes interpenetrate or are located outside the boundary of W.

As a case study, we take into account the bone remodelling. In the following, we formulate a MS model of the process respectively in terms of CxA (Subsection 5.1) and BioShape (Subsection 5.2), exploiting, in both cases, the corresponding micro- macro coupling scheme.

To each lattice cube in the macro model we associate a micro model, representing a BMU. The micro spatial scale is micrometer, while the time scale is a day. The world space of the micro model is exactly shaped as a lattice cube in the macro model. The shapes that we use in the micro model are exactly those described in the micro model of [5], but here the coupling mechanism comes directly and automatically from the coupling scheme.

A final note is about the implementation of the BioShape meta-model in the simulator. BioShape is engineered to natively run a given model on a certain number of available computational platforms. Thus, this feature can be immediately used to run n models in n nodes, each of which is run on several available platforms. Each model is, in the current version, controlled by a global coordinator software agent that is responsible of the balanced distribution of the calculus on the assigned platforms and is the controller that gives the pace for the steps of the main loop.

