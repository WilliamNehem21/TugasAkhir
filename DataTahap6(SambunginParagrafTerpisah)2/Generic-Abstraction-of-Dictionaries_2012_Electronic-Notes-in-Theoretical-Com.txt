We present a generic abstract domain for analysis of dictionary and array content. Our technique is parametrised by the abstractions of scalars, dictionary keys and dictionary values. It can be instantiated with various existing domains, including non-numerical ones (such as domains for analysis of properties of string variables). It is powerful enough to express relations between container content and scalars.

The analysis is fully automatic. The container is partitioned according to properties of the keys, captured by the underlying key abstraction. The precision and cost of the analysis are customisable and depend on the choice of the abstractions of keys, dictionary elements and scalar variables.

Collections such as dictionaries and arrays are very important building blocks of programs, thus static analysis techniques should be able to reason about the content of such containers. Our goal is to provide a generic solution for modelling arbitrary dictionaries and arrays in static analysis by abstract interpretation [2]. The technique should be fully automatic and it should be possible to adjust its precision/cost ratio. It should be possible to instantiate the technique not only with numerical abstract domains [9,13,15], but also with domains of other types, such as e.g. domains for string analysis [8].

Outline Section 1 introduces a structure to represent a single dictionary. In Sec- tion 2 we show how to use it to build an abstract domain. Examples of the domain are shown in Section 3. Section 4 describes an experiment. Related work is sketched in Section 5. We conclude in Section 6. Proofs and additional examples can be found in an extended version of this work [8].

The lattice D(K , V ) can be used to over-approximate the content of a dictionary, but it does not give any information about which elements must be initialised. We solve this problem by associating with each dictionary also an element of D(K , Bool ) that is used to over-approximate the set of uninitialised dictionary elements. A seg- ment (k, True) means that elements at keys abstracted by k may be uninitialised. If some key is not abstracted by any segment, then the element at this key must be initialised. As False is the bottom in the lattice of booleans, segments (l, False) are automatically removed.

We provide the transfer functions for scalar and dictionary statements. We illustrate the definitions on examples, where all A, K and V are chosen as the domain of intervals with values in Z. For clarity, in each abstract segment we show only the values of the key and value-tracking variables vk and vv.

We have developed a technique for dictionary and array content analysis. The precision/cost of the analysis depends on the choice of abstractions of scalars as well as dictionary keys and values. We have shown examples, in which our approach was applied to analysis of arrays and string-keyed dictionaries. The solution was experimentally evaluated and gave very promising results.

