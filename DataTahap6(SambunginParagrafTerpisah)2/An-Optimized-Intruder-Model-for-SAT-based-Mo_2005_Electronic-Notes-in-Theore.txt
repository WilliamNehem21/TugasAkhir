In the last decade we have witnessed a dramatic speed-up of SAT solvers: problems with thousands of variables are now solved routinely in milliseconds by state-of-the-art SAT solvers. This has led to breakthroughs in important areas such as planning and model-checking. Motivated by these results, in [1,2,3] we proposed reductions of protocol (in)security problems to satisfiability problems in propositional logic that can be used to effectively find attacks on protocols. We have developed a model-checker, SATMC, based on these

Outline of the paper. We start in Section 2 by presenting, via a well-known authentication protocol, our model with particular emphasis to an optimized intruder model based on the concept of axiom. In Section 3 we define the notion of protocol insecurity problem with axioms. Section 4 is devoted to the formal description of the automatic compilation of protocol insecurity problems with axioms into a set of propositional satisfiability problems. Ex- perimental results and some implementation detail are discussed in Section 5. We conclude in Section 6 with some final remarks and a discussion of the future work.

facts. In our setting, we assume that the network is controlled by means of the very general Dolev-Yao intruder [11]. 3 In this model the intruder has the abil- ity to eavesdrop and divert messages as well as that to compose, decompose, encrypt, and decrypt messages (provided the encryption keys are known). Fi- nally, he can send those messages to other participants with a false identity. Besides this, we make the standard assumptions of perfect cryptography i.e. an encrypted message can be decrypted only by using the appropriate decryp- tion key and of strong typing i.e. agents only accept type-correct messages and therefore type confusion is not allowed. 4

where A and B are the roles involved in the protocol; Ka and Kb are the public keys of A and B, respectively; and Na and Nb are nonces 5 generated, respectively, by A and B. Notice that, the above high level protocol specifica- tion describes a kind of template NSPK(A, B, Ka, Kb,Na,Nb) parametrized by some free variables 6 appearing in it. A ground instance of the security pro- tocol template represents a session of the protocol. Successful execution of the NSPK protocol should convince both A and B that they have been talking to each other. The rationale is that only B and A could have formed the appropriate response to the message issued in (1 ) and in (2 ), respectively. In fact, a malicious agent I can deceit bob (an instance of B) into believing that he is talking with alice (instance of A) whereas he is talking with I. This is achieved by executing concurrently two sessions NSPK(alice, I, ka, ki, na, ni) and NSPK(alice, bob, ka, kb, na2, nb) of the protocol and using messages from one session to form messages in the other as illustrated by the following pro-

The fact (1) represents the initial state of the honest agent a that plays the role of initiator in session 1 and knows at the beginning her identity, the identity of intruder (the agent she would like to talk with), her public and private keys, 9 and the intruder public key. Facts (2) represent the initial state of the honest agents a and b involved as initiator and responder, respectively, in session 2. Facts (3) and (4) state the initial freshness of the nonces nc(n1, 1), nc(n1, 2), and nc(n2, 2). Notice that, since we bound the number of parallel sessions also the number of fresh terms to be taken into account in the protocol analyses can be computed and bounded in advance. Facts (5) represent the information initially known by the intruder (commonly, in a asymmetric cryptosystem, its identity, its public and private keys as well as the identities of honest agents and their public keys). Notice that, according to the standard close world assumption all the facts that do not occur in the set representing the initial state are considered false.

Labeled Rewrite Rules. As mentioned above, labeled rewrite rules over sets of facts are used to specify how the transition system evolves. In partic- ular, we distinguish between rules modeling the behavior of honest agents (so called protocol rules) and rules representing the Dolev-Yao intruder (so called intruder rules). These rules will be described in the next sections. Concerning the notation used, let M 1 and M 2 be messages, then the terms {M 1}M2 and and for each possible set of messages {M1,k,... , Mjk,k} (let m be the number of such sets, then k = 1,... ,m and jk > 0) from which the Dolev-Yao intruder would be able to build a message M ' that matches (and complies with the type of) M , we add a new rule of the form

techniques for increasing values of k and the propositional formula generated at each step is fed to a state-of-the-art SAT solver (Chaff, SIM, and SATO are currently supported). As soon as a satisfiable formula is found, the corre- sponding model is translated back into a partial order attack which is reported to the user. Two encoding techniques are currently implemented in SATMC and both have been extended for supporting axioms: the first belongs to the family of so-called linear encodings, the second is the more sophisticated graphplan-based encoding.

We have run our tool against a selection of (flawed) security protocols drawn from the Clark/Jacob library [9]. For each protocol we have automati- cally generated, by means of a translator from IF [4] into the SATMC internal language, two corresponding protocol insecurity problems modeling a scenario with a bounded number of sessions in which the involved principals exchange messages on a channel controlled, respectively, by the Dolev-Yao intruder and by the optimized Dolev-Yao intruder. As explained in Section 2 the opti- mization consists in modeling the intruder ability of decomposing messages by means of axioms instead of rules.

