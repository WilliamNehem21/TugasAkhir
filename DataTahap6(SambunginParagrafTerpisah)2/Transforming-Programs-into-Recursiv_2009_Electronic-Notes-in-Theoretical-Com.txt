This paper presents a new proof-assistant based approach to program verification: programs are translated, via fully-automatic deduction, into tail-recursive function defined in the logic of a theorem prover. This approach improves on well-established methods based on Hoare logic and verification condition generation (VCG) by removing the need to annotate programs with assertions, making the proof natural to the theorem prover and being easier to implement than a trusted VCG. Our tool has been implemented in the HOL4 theorem prover.

We build on work by Camilleri and Melham [1], who define in HOL a big-step operational semantics for such programs. In this presentation we consider states that are (finite) partial functions from variable names (of type :string) to integers (type :int). Let neval and beval define evaluations over expressions.

Assignments update the value of a variable and can always be implemented by a let-expression, e.g. the effect of Assign "b" (Plus (Var "a") (Var "b")) is cap- tured by let b = a + b in (a,b). We express this fact by the following theorem:

To verify a program using a VCG, one starts by annotating the code with asser- tions. For the program above (d program) one needs to invent a precondition, a postcondition and, for the loop, an invariant and a variant (the result is to be a total-correctness specification). Here n is logical variable (the initial values of variable "n").

Representing imperative programs as recursive functions, due to McCarthy [7], was key in this work. Ideas from separation logic [11] were used to aid automation (by keeping specifications free of side conditions); and ideas from decompilation into HOL were used for dealing with loops [9]. Our programming environment is the HOL4 theorem prover [12].

