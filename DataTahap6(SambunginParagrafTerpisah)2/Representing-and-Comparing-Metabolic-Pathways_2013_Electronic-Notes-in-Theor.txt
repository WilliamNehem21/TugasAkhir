We present two tools, MPath2PN and CoMeta, which are part of an ongoing project for representing and comparing metabolic pathways as Petri Nets. MPath2PN is intended to support an automatic translation of metabolic pathways from the major biological databases into corresponding Petri nets expressed in the input formalisms for Petri net tools. CoMeta is devised to compare metabolic pathways of different organisms through their Petri net representation produced by MPath2PN. CoMeta automatically takes the data from the KEGG database and, in the comparison, it considers both homology of reactions and behavioural aspects of the pathways as expressed by the T-invariants of the underlying Petri nets.

The metabolism is the chemical system which generates the amino acids, sugars, lipids, nucleic acids and energy necessary to the life of any organism. Metabolic pathways are subsystems dealing with specific functions. Their comparison in dif- ferent species yields interesting information on evolution and it may help in under- standing the associated functions. This is important for studying diseases and drugs design and for industrial applications. We present two tools which are part of an on- going project for the representation and comparison of metabolic pathways as basic Petri nets. Preliminary prototypes of such tools have been presented respectively in [20] and in [21].

Petri nets (PNs) [28,22] are a well studied formalism offering many tools for visualisation, simulation and analysis (see The Petri net World site [12]). They are well suited for metabolic pathways because of the natural correspondence between PNs and biochemical networks [33,32,23] and indeed they have been largely used for qualitative and quantitative modelling and analysis of metabolic pathways (see e.g. [19] for a survey). In a Petri net places represent molecular species, such as metabolites or enzymes; transitions correspond to chemical reactions; input places represent the substrate or reactants and output places reaction products. The incidence matrix of the PN is identical to the stoichiometric matrix, the number of tokens in each place indicates the amount of substance associated with that place, the flux modes and the conservation relations for metabolites correspond to specific properties of PNs. In particular minimal semi-positive T-invariants correspond to elementary flux modes [34] of a metabolic pathway, i.e., minimal sets of reactions that can operate at a steady state. Minimal T-invariants form a basis for the set of semi-positive T-invariant (Hilbert basis) which is unique and characteristic of the PN.

metabolic pathway into a PN model. It is written in Java and it is conceived to deal with different databases in input, such as KEGG and the BioModels Database, and different PN tools formats in output. In Section 3 we describe CoMeta, a tool which automatically takes the data from the KEGG database and it compares metabolic pathways of different organisms relying on their PN representation. The comparison is based on a similarity measure which considers both homology of reactions and functional aspects of the pathways. The latter are captured by the semi-positive T-invariants of the PNs which correspond to potential fluxes at steady state. Some conclusions are drawn in Section 4.

Automatic translators from metabolic pathways to PN models are offered as specific functionalities in some modelling and analysis tools based on PNs. Snoopy [16,27], a tool for the design and animation of PNs to verify technical systems and validate biosystems, provides translations from SBML to basic PNs, continuous PNs and extended stochastic PNs in a Snoopy-specific format based on XML. Cell Illustrator (CI)[4,30], a tool for modelling and simulating complex biological systems, allows the user to import models in SBML and BioPAX and translates them into CSML, the XML-based format of CI models, which are Petri nets extended with continuous and generic processes and quantities.

In the pre- and post-treatment Java classes can be developed for modifying respec- tively the input and the output files. For example when KEGG data are in input, the KGML file representing a KEGG pathway does not specify the stoichiometric values of reactions. The post-treatment phase can retrieve the missing information from the KEGG web service and add them to the PN model.

Representation of reactions: MPath2PN translations are either reaction-based or enzyme-based. In a reaction-based translation, each reaction, possibly catalysed by various enzymes, is represented by a single transition in the PN. In an enzyme- based translation, each reaction is represented by as many transitions as the number of enzymes catalysing it.

Representation of boundaries: A PN corresponding to a metabolic pathway of an organism can be considered either in isolation, focusing on its internal behaviour, or as an open interactive subsystem of the full metabolic network. MPath2PN offers the option of producing either isolated or open PN models. In the open case, compounds which connect the pathway to the rest of the metabolic net- work are represented as open places, i.e. places where the environment can freely put/remove substances through corresponding input/output transitions. Com-

Most of the reactions in a pathway are reversible. MPath2PN represents a reversible reaction by using two transitions, a forward and a backward one. Such pairs of transitions are recognisable by their identifiers, so that the corresponding cyclic behaviour can be filtered out, if desired, in the PN model analysis.

We presented two tools for the representation and the analysis of metabolic path- ways through Petri nets. MPath2PN is a tool for automatically transforming a metabolic pathway, expressed in one of the various existing databases formats (like KGML or SBML), into a corresponding PN, expressed in one of the formats for PN tools. At present it offers several translations corresponding to different modelling choices, it gets metabolic pathways from KEGG and it generates the correspond- ing PNs encoded in PNML. CoMeta is an interactive tool for comparing metabolic pathways of different organisms. The comparison is based on a distance which may consider both homology of reactions and potential fluxes at steady state.

We are conducting experiments to validate CoMeta and our distance. In [21] we already showed that it produces valid phylogenetic classifications and that other measures in the literature, based on more sophisticated representations of a path- way (e.g., using graphs rather than multisets, or considering compounds besides enzymes), do not necessarily give better results than our measure.

This is an ongoing project and we plan to extend both MPath2PN and CoMeta. We are working on new translations for MPath2PN, i.e. from SBML to extended deterministic stochastic PNs (eDSPNs) and coloured stochastic PNs (SCPNs), ex- pressed in the input language of the tool TimeNET [17]. For CoMeta we are work- ing in various directions. We are performing extensive explorations of the KEGG database to analyse the significance of our distance. We are experimenting with isolated and open PN models to study the effects of the different modelling choices.

E. C. Webb. Enzyme nomenclature 1992: recommendations of the Nomenclature Committee of the International Union of Biochemistry and Molecular Biology on the nomenclature and classification of enzymes. San Diego: Published for the International Union of Biochemistry and Molecular Biology by Academic Press, 1992.

