On the other hand, some security properties cannot be proved to hold by mere inspection of the current state. This is the case of history-dependent properties. An example of scenario in which this happens is when in order to access a resource, a process needs to have been given prior permission to use it [7].

However, in the latter case, this is not possible, as errors are not a property of a single state, but of the whole computation. The most natural way of performing the necessary trace analysis is by somehow remembering along the computation the information that is needed for the characterization of the considered kind of error, tagging the processes with this information. In the previous papers on the subject, such as [7] or [10], the corresponding enriched semantics is defined in an ad hoc way, not relating it in an explicit way with the original semantics, thus making necessary specific non-reusable proofs for the corresponding relation between the original and the enriched semantics.

We propose in this paper a systematic methodology for the treatment of these errors, that begins by defining a tagged language and a unary relation on tagged processes. We will characterize such tagged languages as being quotients of the reachability tree defined by the computations of the original language. From this fact we can conclude that the property characterized by each tagged language is indeed a property of the original one. In this way, we can work in a common framework, instead of defining an ad hoc semantics for each property. In particular, we could again use a type-based analysis to guarantee that no erroneous tagged state is ever reached along the computation.

The first condition is a correctness property for tagged systems: they do not introduce new transitions, that is, all their transitions come from untagged ones. The second is a completeness condition: we have a unique tagged ver- sion for each original transition. Besides, uniqueness states that we cannot separately remember different things about the same past.

