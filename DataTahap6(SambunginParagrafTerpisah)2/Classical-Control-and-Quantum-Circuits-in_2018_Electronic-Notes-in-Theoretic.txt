We describe categorical models of a circuit-based (quantum) functional programming language. We show that enriched categories play a crucial role. Following earlier work on QWire by Paykin et al., we consider both a simple first-order linear language for circuits, and a more powerful host language, such that the circuit language is embedded inside the host language. Our categorical semantics for the host language is standard, and involves cartesian closed categories and monads. We interpret the circuit language not in an ordinary category, but in a category that is enriched in the host category. As an extended example, we recall an earlier result that the category of W*-algebras is dcpo-enriched, and we use this model to extend the circuit language with some recursive types.

and completely positive maps. However, high level languages have more elaborate data structures than bits: they have higher order functions and mixed variance recursive types, and associated with these are elaborate control structures such as higher order recursive functions. These are important, paradigmatic ways of structuring programs.

How should these high level features be integrated with quantum computation? One option is to build a semantic domain that accommodates both quantum com- putation and higher order features. This is an aim of some categorical semantics of the quantum lambda calculus [21,17] and of prior work of the authors [24,26]. This is a fascinating direction, and sheds light, for example, on the structure of the quantum teleportation algorithm (e.g. [21, Ex. 6]). However, the general connection between physics and higher-order quantum functions is yet unclear. Although some recent progress has been made [14], it is still unclear whether higher-order quantum functions of this kind are useful for quantum algorithms.

The host language is a higher order language. The types of the host language do not include the wire types, there is not a type of qubits, and it is not a linear type system. However, there is a special host type Circ(W1, W2) associated to any pair of wire types W1 and W2, whose inhabitants are the circuits with inputs of type W1 and outputs of type W2.

The relevance of Set-enriched copowers to quantum algorithms has previously been suggested by Jacobs [11]. On the other hand, copowers and enrichment play a key role in the non-quantum enriched effect calculus [7,19] and other ar- eas [16,18,23,29]. Nonetheless, our connection with the EWire syntax appears to be novel.

Consider the operational semantics given in Appendix B. Assuming that H is a sound categorical model of the host language, one obtains the following theorem by straightforward induction on typing judgements. (This is similar to the proof in [22, App. B].)

For example, we define a category of quantum computation which only contains matrix algebras and the completely positive unital maps generated by the stabilizer states of the Clifford group [26, Sec. 1.3]. We call this category Clifford; it corre- sponds to stabilizer quantum mechanics [2], which can be efficiently simulated by classical computers.

Proposition 4.3 Consider a categorical model of QWire (C, Dcpo,T ) where C is a small category of quantum computation. Then, the triplet ([Cop, Dcpo], Dcpo,T ) is a categorical model of QWire, where [Cop, Dcpo] is algebraically compact for locally continuous endofunctors.

Summary. We have introduced a new calculus, EWire (Sec. 2), for embedded circuits within an expressive host language. The language includes QWire as an instance (Sec. 2.2). We have proposed a notion of categorical model for EWire (Sec. 3) in which the relationship between the circuit and host language is explained in terms of enriched categories. Our first example of a model is based on the Set- enrichment of C*-algebras. Finally by considering a model of QWire based on W*- algebras and dcpos, we have introduced some recursive types to give a denotational semantics to the Quantum Fourier Transform.

The authors would like to thank Bart Jacobs, Michele Pagani and Shane Mansfield for helpful discussions, but also Bert Lindenhovius, Michael Mislove and Vladimir Zamdzhiev for hosting the first author at Tulane University during the elaboration of this work, and Jennifer Paykin for introducing us to the subtle aspects of QWire. The research leading to these results has received funding from the ERC grant agreement n. 320571, a Royal Society fellowship, and EPSRC grant EP/N007387/1.

