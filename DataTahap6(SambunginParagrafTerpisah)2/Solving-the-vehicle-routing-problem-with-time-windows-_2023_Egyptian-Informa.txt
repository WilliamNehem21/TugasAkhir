The vehicle routing problem with time windows (VRPTW) is a famous problem in logistics and transportation that has many applications in real life. The objective of the problem is to find the minimum distance covered by a set of vehicles that set to start together from the warehouse and visit some prefixed customers within certain time frames. In this paper, an efficient optimization algorithm, called modified football game algorithm (MFGA), is proposed to solve the VRPTW as an NP-hard problem. MFGA imitates the behavior of football players during a game to find the best positions to score a goal under the supervision of a team coach. In the presented algorithm, a new method is presented to create an initial solution for the VRPTW problem. In addition, a more efficient method has been designed to create a new location for the player, which makes the algorithm more efficient. The reliable transportation network is considered one of the basic needs. Some even believe that transportation is one of the basic tools of development. In the past, because transportation was considered a sec- ondary need to fulfill primary needs such as business, travel, employ- ment, etc., it was not properly addressed. But the growth and development of the global economy, the efforts of countries to make optimal use of the capabilities and opportunities at their disposal, and the tightening of competition in global arenas led to the fact that transportation, due to its direct role in reducing the costs of production and access to the market, and finally increasing The ability to compete in the field of international trade, especially for countries with a high volume of foreign trade (exports and imports), has a high position in management, planning and investment, and even research. The effect of such a feature has caused the past attitudes towards transportation to be changed and transportation to be viewed as an important service- economic sector.

of small sizes. These algorithms have poor performances for large-sized problem instances because of high computational time. Therefore, re- searchers prefer to use approximate methods for finding near optimal solutions quickly. Examples of approximate approaches for VRPTW including harmony search algorithm (HAS) [9] memetic algorithm (MA) [10], tabu search (TS) [11], variable neighborhood search (VNS) [12], etc.

Taha et al. [13] presented a combined bat algorithm with a large neighborhood search (LNS) for the VRPTW. In the LNS algorithm, for proper performance in the possible space of the problem and its global search, it used an efficient mechanism called generating a large neigh- borhood, which resulted in obtaining quality solutions to the problem. In [9], a hybrid algorithm based on the adaptive harmony method was proposed to solve the VRPTW. Since the proposed method has a well performance for global search of the solution space, several neighbor search algorithms are used to increase the effectiveness of the solution in local search. Also, a hybrid simulated annealing (SA) method for the multi-objective type VRPTW using multiple temperatures was presented in [14]. In this case, two objectives are considered simultaneously, which include minimizing the distance traveled and balancing the routes. The second goal is to minimize the imbalance in the distance traveled by vehicles as well as the total items received by customers. It is observed that the first balance creates justice among vehicle drivers and, as far as possible, causes their working hours to be similar. The second balance is used, for example, for cases where there is a feeling of relative satisfaction among all customers.

using a new penalty function tried to prevent the time window from being violated. In addition, a multi-graph model for the VRPTW was proposed in [18] and then they used a hybrid algorithm based on large adaptive neighborhood search to solve this problem. Also, a new data structure and dynamic programming were used to set up the multi- graph, which was able to provide very good quality for answering problems. In [5], the VRPTW was solved by an ACO, and to increase its efficiency, they used a saving algorithm [19], local exchange mechanism and local search. Modifications were done to the algorithm that changed the pheromone setting, the presentation of any new method to enhance the solution further, and the use of a candidate list to select the next ant. These modifications enabled the algorithm to have good efficiency in intensification and diversification, thus preventing premature conver- gence and moving from local optimization to global optimization.

The paper is arranged as follows: The FGA is introduced in Section 2 and the proposed MFGA approach is explained in Section 3. In Section 4, the design of experiments and the results of the experiments will be discussed and will be compared via the state-of-the-art methods. Lastly, Section 5 presents the discussions and conclusions.

very important point in the football game, which is also used in the al- gorithm, is that the coach can replace players who are not of well quality with other players during the game. In other words, in the proposed algorithm, a member of the population who does not have a quality objective function value can be removed from the population, and since the coach knows well solutions during the implementation of the algo- rithm, a solution with a good objective function value can be replaced. This strategy continues to reach the optimal point or goal until the end of the game, which is the time of the whole algorithm.

According to the game of football, if a player is not under the orders of his coach, then he/she is either simply walking on the field without a goal or he is moving towards the ball. Of course, in both cases, each player has a goal to reach his best place on the field to have a better position to score. It is noted that during the game, one very important place that other players always wish is the position of the player who has the ball. So, the other goal of the players is to get closer to the player that takes values based on the problem that the algorithm solves. The value of the alpha parameter can be very important for local or global search of the algorithm because by decreasing this value, the algorithm searches locally and the power of the algorithm increases in intensifi- cation, while increasing the algorithm tends to global search or diver- sification. Gradually decreasing this parameter, the algorithm can be changed from global search at the starting of the algorithm to local search finally.

algorithm for traveling salesman problem and vehicle routing problem, although it has not been able to achieve the best solutions [26,27]. It was suggested in [20] and inspired the behavior of football players which try to find the best positions in the game. Unlike other existing algorithms, the FGA uses different strategies to create a balance between combina- tion of diversification and intensification. The FGA algorithm uses the collective intelligence of humans, unlike many algorithms that use an- imal swarm intelligence. In other words, in this algorithm, like a football team whose objective is to score a goal, the goal is to achieve the best possible solution to the problem. In order to be able to use this algorithm in an optimization problem, we need to create a complete simulation between all the components of an optimization problem with a football match as follows:

The FGA is a population-based algorithm and can also be categorized in the memory usage algorithm recently introduced in 2016 to solve optimization problems. In this study, we suggest a modified FGA (MFGA) for solving the VRPTW as a discrete optimization problem. In the proposed MFGA, each player represents a VRPTW solution, each solution has a number of routes, and each route contains a number of customers serviced by a vehicle according to the constraints defined in Section 2. The initial population of players on the ground is randomly generated. To create a solution, we generate an empty route in the first current route that does not violate the VRPTW. Now, among the cus- tomers who have not been met by any vehicle so far, the closest customer is considered to be the last selected customer. Provided that no restrictions are violated, this customer will be added to the relevant route. In some iterations, it may not be possible to add a customer to the current route with the constraints of the problem, where the construc- tion of the desired route is completed. This operation continues for all unmet customers until they all get in the way. As already said, each

duplicate customers is kept and its repetitions are removed from the rest of the routes. For simplicity reasons, we assume that the duplicate customer, appearing in the first route, is kept and the rest are removed from the next routes. Then, lost customers, if available, are added to existing routes, so that missing customers will be added to the first route that can be inserted without violating the constraints. Otherwise, a new route will be created to route it. For example, suppose that we have two

has a better position in the strategy of attack, this strategy cannot be used directly for VRPTW. Since the position of each member in a search space for a continuous problem is a point, but in VRPTW as a discrete problem, the position of each player consists of different points of the customers that together form a solution. For this reason, in the attack strategy for VRPTW, instead of comparing the position of the solutions, we use the comparison the objective function value of the positions. In such a way that the player will be pushed towards a better player whose fitness function difference is less than a specified distance (SD).

In this study, as the coaching is the local search of the algorithm, the famous Hill Climbing (HC) method is used to enhance the MFGA exploitation by applying it to the feasible location constructed in the preceding step. In this step, after constructing any feasible solution, HC is used to improve the solution. HC is aimed to improve the exploitation in the neighborhood of the solution.

The proposed MFGA is coded in MATLAB 7.8 and runs on a PC with Windows 7 operating system, 2.40 GHz three-core Intel (R) processor, and 2 GB of RAM. The performance of metaheuristic methods signifi- cantly depends on proper choice of the most significant parameters, for example, size of the population (N), number of customers (NC), number and h, in our proposed MFGA. The values of NC and NV are determined with respect to the experimental data set and the parameter of h is used to control the intensification and diversification of MFGA directly. That is why choosing the appropriate values for these two parameters is a key value of the parameter setting. Besides, the MFGA performance is evaluated with values of 10, 15, 20 and 25 for parameter N, values of 50,

