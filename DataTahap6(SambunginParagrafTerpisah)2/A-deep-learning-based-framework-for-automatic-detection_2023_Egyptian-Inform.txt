Annually, there are huge numbers of people who contact tuber- culosis (TB) and the mortality rate is high among these patients [1,2]. It is estimated that the number of TB infections reaches 8 million each year. Moreover, the annual number of mortalities in TB disease ranges from 2 to 3 million people [3]. Mycobacterium tuberculosis is the bacteria responsible for causing TB. These bac- teria usually attack the lungs, but sometimes other areas of the body such as the spine, brain, and kidneys. There are two main causes of the occurrence of tuberculosis namely: TB disease and latent TB infection (LTBI). If this disease is not treated properly, it leads to death.

There is a clear weakness in diagnosing TB patients. TB patients can be classified into two different cases, namely, Multidrug resis- tance and Drug sensitivity (DS). In each case, the patient is treated differently. TB specialists face many challenges in differentiating between the two cases. In addition, the rate of error in differentiat- ing between them is large. Moreover, it is difficult for TB specialists to determine the type of TB in an infected person. There are simi- larities in the symptoms that appear in more than one type of TB [11]. Tuberculosis appears in five types, and each type of TB has different patterns and treatment methods. The aim of determining the condition of the TB patient early and determining the type of TB disease in that patient is to reduce the cost of treatment and increase the chances of recovery from this disease.

This section reviews existing works which have targeted TB detection. These reported works mostly operate on 3D CT scans or chest X-ray images. Also, most of them agree that image masks, which are forms of image segmentation filters, are important to enhance accuracy of deep learning models. Several of these works have utilized pre-trained models such as AlexNet, VGG net or ResNet for feature extraction. Most of the datasets were taken from the Image CLEFF competition. Thus our work shares several aspects with the following works.

The work report in [29] utilizes a 7-layer CNN, five of which were Conv2D layers, to classify images into bacillus negative and bacillus suspect. A second network, similar to the first one, was designed to classify, again, the images labelled by the first network as bacillus suspect. The second network classifies bacillus suspect images into either bacillus positive or bacillus negative images. This cascade of classifiers increases the confidence in the output of the model.

Singh et al. [37] have used an anti-aliased CNN to detect TB lesions in the lungs using image segmentation. They have trained and tested their models using Image CLEFF 2019 dataset. The idea is to employ shift invariant network as it has potential to spot the abnormal regions in the CT images.

The work reported in [41] has experimented with three net- works to classify drug resistance in TB patients. The dual attention dilated residual network (DADRN), the Bag of Visual Words and the Sparse Code Book algorithms were used. DADRN was the best per- forming algorithm. The dataset consists of CT images for 400 patients.

Ravi et al [44] used EfficientNetB0, EfficientNetB1, and Effi- cientNetB2 pre-trained neural networks to detect lung diseases based on chest X-ray images. First, the features extracted using the previous three networks were fused together and then passed into a cascade of dense layers. An ensemble classifier, which con- sists of Random Forest and SVM, was used in the first stage and Logistic Regression was used in the second stage. The reported task is a multiclass classification task, where the aim is to classify patients with pneumonia, TB and Covid-19. The best reported accuracy in the case of pneumonia was 98 %, for TB the accuracy

Ying et al. [48] aimed at classifying patients as having nontuber- culous mycobacteria pulmonary disease (NTM-PD) or pulmonary TB (PTB) using T-SPOT test (enzyme-linked test) and deep learning model (based on CT images). The deep learning model uses a U-Net network for image segmentation and Inception-ResNet for image classification. The authors report that the best results achieved when combining the T-SPOT and deep learning methods.

The data provided by Image CLEF-2018 Tuberculosis [17] was used in this paper. It is a well-known dataset and has been used by researchers targeting building computational models for TB analysis. The data consists of 3D CT images stored in NIFTI file for- mat with .nii.gz file extension. The 3D CT images contain image

Several neural networks were experimented with which use only the frames of the images without the masks or gender/age information. VGG16 was used for feature extraction, and several dense/dropout/batch-normalization layers were added to the model to classify the images into MDR or DS in the MDR detection task; and into Infiltrative, Focal, Tuberculoma, Miliary and Fibro- cavernous in the case of the task of TBT classification. It was con- cluded that CT images alone are not sufficient and additional infor- mation, such as image masks and age/gender information, is needed. This leads to the development of multi-modal or multi- channel deep neural networks as will be explained next.

This task aims to classify images to either having MDR or DS. Four deep learning models have been designed; these rely on CNN, VGG19 or Xception networks for feature extraction and rely on a set of convolution and dense layers for classification. These models take the frame, mask and gender/age as input and produce the classification as output.

Multi-channel or multi-modal input has proved superiority to single modality. In this paper, multi-channel or multi-modal sys- tems were built for MDR detection and TBT classification. The three modalities which were available in this dataset are: CT images of the lungs of the patients, image masks and age/gender data. The image mask is necessary to have as the traditional scene of tuber- culosis (active or latent) is insufficient as tuberculosis transfers between both cases constantly. The conventional TB screening (tu- berculin skin test and interferon-gamma release assay) is ineffec- tive. Thus, it was necessary to use supplementary information and TB biomarkers to diagnose tuberculosis, which leads to the need for lung image segmentation (referred to as image mask).

This paper has discussed building deep neural networks for MDR-detection and TBT classification. For the MDR detection task, four neural networks were designed which process the image frame, the mask frame and the gender & age data of patients. The baseline model utilized an CNN network for feature extraction from image and mask frames, it also used dense layers to extract features from gender and age. The three sets of features are con-

As a future work, dataset size should be increased to include new datasets which recently emerged. Other image modalities such as X-rays provide another option for future investigation. Investigating neural networks that can directly handle 3D images is an interesting extension to this work.

