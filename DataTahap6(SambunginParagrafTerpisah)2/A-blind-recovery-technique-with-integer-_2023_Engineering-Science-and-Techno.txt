Visible watermarking is the process of directly modifying image pixels with a watermark. In the case of an invisible watermark, the watermark is inconspicuously inserted [6]. Invisible watermarking techniques have gained popularity due to their imperceptibility. Furthermore, invisible watermarking systems can be classified as (1) fragile, (2) semi-fragile, or (3) robust [7]. Fragile watermarking has a high capability for recovering data from uncompressed images. It is widely used to verify the integrity and authenticity of an image, ensuring that it has not been modified and is authentic [8]. On the other hand, semi-fragile watermark methods maintain a balance between reliability and fragility [9]. They can resist JPG compression to some extent but have limited recovery capabilities. Lastly, the robust watermarking method strikes a balance between imperceptibility and robustness [10]. This approach is commonly used

In 2020, Molina et al. [11] proposed a method for fragile authenti- cation and recovery in image watermarking. They inserted both recov- ery and authentication bits into each block of the image. If any modifications were made to the block, tampering was detected. The authentication bits were inserted in LSB of the cover image, while the recovery bits were placed in different block locations based on a block mapping. If any modifications were made to the current block, the re- covery bits were securely stored in a different location and could be used to recover the current block. The scheme also included an image inpainting process to enhance the quality of the recovered image. During the image inpainting process, the average block was used to replace the tampered data in the post-processing phase. The method was tested on several images and proved effective in detecting tampering and enabling the self-recovery of tampered images. The imperceptibility of the watermarked image produced a PSNR value of 45 dB. Additionally, it demonstrated robustness against various attacks, including cropping, scaling, and JPEG compression, achieving PSNR value ranging from

The recovery process can sometimes encounter a problem called tamper coincidence, which occurs when tampering also affects the location of the recovery bits. Tamper coincidence is a challenge that can arise during the recovery process in image authentication techniques [12]. It refers to a situation in which tampering, or modification of an image also impacts the location of the recovery bits, resulting in their loss. This renders the recovery of the tampered block impossible, as the necessary information is no longer available. To address this issue, Haghighi et al. [13] proposed using multiple sets of recovery data or implementing image inpainting techniques. Multiple recovery data provide additional opportunities to recover the tampered block by using different sets of recovery bits. One scheme [11] even employs three sets of recovery data to offer a third chance for recovery. Image inpainting techniques utilize information from surrounding blocks to restore the tampered block. Another approach [12] uses an image inpainting technique to recover tamper coincidence-affected blocks by utilizing recovery data from surrounding blocks.

This paper presents a method for adding a fragile watermark to im- ages for authentication and blind recovery purposes (BRIWT). The cover image is divided into 2x2 pixels, and authentication bits of its image content are inserted into the LSB. The recovery bits are inserted into the two LSBs at random locations using a secret key. The proposed scheme uses Integer Wavelet Transform (IWT) to generate recovery data, which can replace other techniques that rely on the average block value. The recovery process involves a novel image inpainting technique that considers eight regions of the non-tampered area to replace the tampered data. The structure of this paper is as follows: The second section provides an overview of current fragile watermarking methods. The third section presents the newly proposed method for embedding and extracting a watermark for authentication and recovery. The fourth section showcases the results of tamper localization evaluation and compares the proposed technique with others, highlighting its ability to perform blind recoveries. Finally, Section 5 offers conclusions for this

In 2013, Tong et al. [16] presented a watermarking method using a chaotic block map. The scheme employed a 2x2 pixel block map with chaotic maps to enhance security. Furthermore, the scheme improved recovery results after manipulation by combining the most significant bit (MSB) and least significant bit (LSB) to enhance tampering detection rates and defend against attacks. An optimization technique was also applied to enhance imperceptibility. The overall approach is more secure and exhibits better performance in detecting and recovering from tampering, even in cases where the tampered area is substantial. How- ever, the recovered image still contains traces of tampered regions when the tampering rate is at 10 %.

In 2014, Dadkhah et al. [17] proposed an authentication and self- recovery method using Singular Value Decomposition (SVD). The method creates two separate tamper detection keys using SVD, with each key being unique to each image block and protected through encryption. Additionally, the method employed a block-partitioning technique for 4x4 and 2x2 blocks to enhance tamper localization per- formance. However, the recovered image achieved a PSNR of 22.51 dB for a 10 % tampering rate and 11.40 for a 50 % tampering rate, indi- cating room for improvement.

In 2016, Singh et al. [18] presented a watermarking method for authentication, which involves dividing the image into 2x2 pixels. The scheme utilized the five most significant bits (five-MSB) to generate recovery bits. The method employed a two-level tamper detection mechanism, ensuring a high probability of detecting tampered blocks. The scheme achieved a peak signal-to-noise ratio of 26.55 dB under a 10

In 2018, Tai et al. [20] proposed a technique for adding a type of digital watermark called a fragile watermark to images. This method used IWT to generate the recovery bits, and the actual watermark data was embedded in the LSB. The recovery bits were embedded into another block according to a chaotic map. The method used wavelet transform to replace the average of the recovery data in order to mini- mize the smoothing and blocking effects on the recovered images. The technique for detecting tampering uses a hierarchical strategy for high accuracy and considers the 3x3 block-neighborhood. However, when the tampered area exceeds 50 %, the scheme produces low-quality recovered images.

In 2020, Sarkar et al. [21] introduced a method for detecting and restoring heavily tampered images, which is a challenging problem. They proposed two different approaches for identifying tampered re- gions in an image and restoring them. The first approach is based on a quadruple watermarking method, which involves dividing the image into four parts. A mapping algorithm is used to determine these regions. The second approach is based on wavelet decomposition, which involves embedding two different watermarks for tamper detection and restora- tion. The results showed that the scheme can achieve good restoration for tampering rates less than 50 %. However, if the tampering rate ex- ceeds 50 %, the scheme is unable to recover the image.

bit, applied to each pixel, while the second check bit is created by applying a hashing algorithm to blocks of the image that have been divided. The combination of these two authentication bits helps mini- mize false-negative errors. Additionally, an additional post-processing step called Adaptive Structural Element Calculation is utilized for tamper localization. However, the process of adding the watermark and restoring the image can result in low imperceptibility of the water- marked and recovered images.

In 2022, Lin et al. [24] proposed a method for protecting and restoring digital images that combines the turtle shell algorithm and a compression technique called AMBTC. The method employs a two-layer technique to incorporate recovery bits and validation bits, which are embedded into the image using the AMBTC compression technique. The validation bits are used to identify tampered areas, while the recovery bits are utilized to restore the original image. Experimental results demonstrated that their scheme produces watermarked images with high visual quality. However, using a 4x4 block size may lead to false- positive detection. A single-pixel tampering on such a block can result in a 95 % false-positive detection rate.

The recovery data is embedded into various locations to ensure that even if the current block is tampered with, the recovery data inserted into other blocks will remain intact. The technique for embedding and extracting the watermark is further described in the paper. The process of image authentication and self-recovery encompasses both watermark embedding and watermark extraction.

data. For example, a pixel with an original value of 196 (11000100), and if the watermark data has the value of 3 (11). The traditional embedding method changes the two least significant bits of the original pixel value by the watermark. If the 2 least significant bits are replaced directly, the final pixel value would be 199 (11000111).

location of the det1 matrix indicates that the corresponding block has been tampered with. A value of 0 could mean that the block has not been tampered with or that it has been tampered with but not detected. Using only two authentication bits results in a 25 % chance of tampering remaining undetected. Therefore, a second layer of authentication is necessary.

ted). A high true-positive rate indicates that the watermark detector can correctly identify a significant proportion of watermarked images. FNR is calculated as the number of false negatives (watermarked images that were not detected) divided by the sum of true positives (correctly identified watermarked images) and false negatives. A high false- negative rate indicates that the classifier is missing many true posi-

correctly identify a significant proportion of watermarked images among all the images it predicts as watermarked. The F1-score is a valuable metric when balancing precision and recall is crucial, as in the case of tamper detection. It helps avoid both false positives (non- tampered images incorrectly identified as tampered) and false negatives (tampered images not detected). Accuracy is the ratio of correctly identified tampered images, whether they are tampered or not. A high accuracy indicates that the proposed scheme can correctly identify a significant proportion of tampered and non-tampered locations.

Tamper localization directly affects the quality of the recovered image. High precision in tamper localization results can lead to a high- quality recovered image. The embedded recovery bits are stored in separate locations based on block mapping. However, both the original embedding location and the recovery location may be tampered with, leading to what is referred to as a tamper coincidence problem. When tamper coincidence occurs, the quality of image recovery is compro- mised, resulting in poor quality and artifacts in the image. This issue can be addressed by employing a multi-layer recovery approach and image inpainting.

The limitation of this study lies in the limited embedding capacity for storing recovery bits. Since the proposed BRIWT scheme embeds authentication bits and recovery bits in the 2-LSB of 2x2 block pixels, the BRIWT scheme can only store 6 recovery bits and 2 authentication bits. Increasing the embedding capacity by increasing the block size can store more recovery data, but it may result in a slight decrease in the accuracy and precision of tamper localization. The minimum block size of 2x2 pixels, which embeds 2-LSB and 2 authentication bits, has a significant impact on the high precision and accuracy of tamper localization. The embedding capacity of 2-LSB in the 2x2 block pixels does not signifi- cantly affect the watermarked quality. However, due to the limited number of recovery bits available for embedding in the 2x2 block pixels, it can lead to a decrease in the quality of the recovered image. Having a higher capacity for recovery bits can improve the quality of the recov- ered image from a tampered image, but it will also decrease the accuracy and precision of tamper localization at the same time.

