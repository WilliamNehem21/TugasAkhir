Rule-based languages, such as Kappa and BNGL, allow for the description of very combinatorial models of interactions between proteins. A huge (when not infinite) number of different kinds of bio-molecular compounds may arise due to proteins with multiple binding and phosphorylation sites. Knowing beforehand whether a model may involve an infinite number of different kinds of bio-molecular compounds is crucial for the modeller. On the first hand, having an infinite number of kinds of bio-molecular compounds is sometimes a hint for modelling flaws: forgetting to specify the conflicts among binding rules is a common mistake. On the second hand, it impacts the choice of the semantics for the models (among stochastic,

Rule-based languages, such as Kappa [8] and BNGL [2], propose a transparent way to encode models of interactions between proteins. Systems involving races for shared resources, different time- and concentration-scales, non linear feedback loops may be described by the means of rewrite rules. This allows for the descrip- tion of very combinatorial models. A huge (when not infinite) number of different kinds of bio-molecular compound may arise due to the presence of scaffold and/or proteins with multiple binding and phosphorylation sites. The long term goal is then to understand how the collective behaviour of these proteins emerges from the mechanistic interactions between proteins.

The rest of the paper is organised as follows. Sec. 2 introduces some case studies to provide intuitions about the property that we want to infer, and to highlight the pitfalls that we will have to avoid. Sec. 3 gives some reminders about Kappa. In Sec. 4, we introduce two families of graphs and a procedure to decide whether or not the set of bio-molecular compounds that are compatible with a contact map is the static analysis that is described in [12,3]. Each receptor in a dimer may activate the sites Y48 and Y68 of the other receptor (since we focus only on the binding topology, we omit the details about these activations which are performed by the means of phosphorylation). The site Y68 may bind to the protein Grb2 , which may be, or not, bound to the protein Sos. The site Y48 connects to the protein Grb2 indirectly, thanks to the adapter protein Shc.

On such a rather small model, it is possible to enumerate the different bio- molecular compounds thanks to reaction enumeration engines [2,4]. This model is made of 253 kinds of bio-molecular compound. Taking into account phosphorylation states would lead to a model with 932 kinds of bio-molecular compound. Never- theless, enumeration engines do not scale to large combinatorial networks such as the longer version of the EGF model (including the interactions with the proteins Ras, Erk , and Mapk ) that is described in [5] and that involves about 1019 different kinds of bio-molecular compound [6] or as the model of the interactions found in the cytoplasmic portion of the Structural Interaction Network (cSIN) [9,15] that involves an infinite number of bio-molecular compounds.

Outline. The rest of the paper is organised as follows. In Sec. 3, we give some reminders about Kappa. We focus only on static reasoning about graphs. We do not introduce the notion of rules. We assume that additional constraints about reachable patterns come from a black box that we do not describe in this paper. In Sec. 4, we introduce two notions of graphs: the graph of the sites and the graph of the links. Both notions can be used to reason about the finiteness of the set of bio-molecular compounds in a Kappa model. Yet we will see in Sec. 5, that the graph of the links may be refined to take into account the patterns that may be proved unreachable by an external tool.

In this section, we give some reminders about Kappa. We do not introduce the full semantics of Kappa. Instead, we introduce only the notions of site-graphs and of embeddings among them. We omit the notions of rules and of rule applications. We also omit internal states, since we focus on the topology of the potential bindings between proteins. We refer to [8,11] for a more complete description of Kappa.

Morphisms preserve the type of agents. They also preserve each agent set of sites, but more sites may be documented in the image of the morphism. A site that may be free shall be mapped to a site that may be free. Two sites that may be bound together shall be mapped to two sites that may be bound together.

A chain is formed either of a single agent with at most two sites, or of a linear chain of agents with exactly two extremities. In the former case, each site of the single agent is either free, or in an unspecified binding state. In the latter case, every agent not in the extremities has two sites and these sites are bound whereas every agent on the extremity has exactly one site that is bound and potentially at most one other site (which may be free, or with an unspecified binding state).

The label of an edge must be understood as an explanation about how the link of the source of this edge may be connected to the link of its target within a bio- molecular compound that is potentially reachable. Whenever an edge is labelled with a chain that contains a pattern that is unreachable, this edge may be safely discarded. The longer a chain of agents is, the more constraints it imposes. The second step consists in combining consecutive edges, in order to extend their labels into longer chains. It is worth noticing that given a node in the graph of the links, the target of the label of every incoming edge and the source of the label of every outcoming edge are indeed the same as the pattern that is labelling this node. We will keep this property as a structural invariant of the graph when combining the edges of the graph. Given a node in the graph of the links, an incoming edge and an outcoming edge may be composed by fusing the target of the incoming edge with the source of the outcoming edge to form an edge from the source of the incoming edge to the target of the outcoming edge.

Now we can define precisely the second step: the second step consists in selecting both a node and an incoming edge of this node so as to replace this edge with the set of all the edges that may be obtained by combining it with an outcoming edge of the node that has been selected. This transformation preserves the structural invariant and increases the length of the labels of the edges in the graph. Here again, we can safely discard every edge that is labelled with a chain that contains a pattern that is unreachable.

the binding sites of proteins. The contact map is translated into a classical graph which encodes either the potential succession of sites, or the potential succession of links within bio-molecular compounds. Non trivial strongly connected components in this graph correspond to patterns that may be repeated an arbitrary number of times in the bio-molecular compounds that are reachable in the model. They can be detected using classical depth-first exploration without having to enumerate every elementary cycle [18]. The graph that stands for the potential succession of links in bio-molecular compounds can be refined in order to take into account some additional constraints computed by reachability analysis [6,12,3].

Our approach has been partially integrated in the static analyser KaSa [3]. More precisely, the construction of the graph of the potentially successive links has been implemented as well as the reduction with the static analysis that is described in [12]. This way, the analyser can cope accurately with the constraints involving potential cycles of two proteins. We plan to implement the generalisation that has been proposed in [10] that can handle precisely with models that can generate cyclic structures without creating arbitrary long bio-molecular compounds.

